After initialize model, args.img_channel:3
load model: /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_1_PS_40/model_2000.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
train_data_files nums: 41
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_09012020_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480000436306, gen p mean: 0.830624520778656, mean p set: 0.448, frame p mean: 0.44671741127967834
loss_pred:0.022249216213822365, decouple_loss:0.009912708774209023
The modified gen p mean: 0.44800007343292236, gen p mean: 0.8428590297698975, mean p set: 0.448, frame p mean: 0.4456900656223297
loss_pred:0.021470284089446068, decouple_loss:0.010250983759760857
The modified gen p mean: 0.4480000436306, gen p mean: 0.8371768593788147, mean p set: 0.448, frame p mean: 0.446727991104126
loss_pred:0.02253573201596737, decouple_loss:0.009925182908773422
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480000436306, gen p mean: 0.8680106401443481, mean p set: 0.448, frame p mean: 0.4461852014064789
The modified gen p mean: 0.44800013303756714, gen p mean: 0.8727688789367676, mean p set: 0.448, frame p mean: 0.4471084773540497
The modified gen p mean: 0.44800007343292236, gen p mean: 0.8666019439697266, mean p set: 0.448, frame p mean: 0.4473538100719452
loss_pred:0.18598060309886932, decouple_loss:0.4258762001991272
loss_pred:0.2114243358373642, decouple_loss:0.4254986643791199
loss_pred:0.1963350474834442, decouple_loss:0.42673757672309875
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7814714908599854, mean p set: 0.448, frame p mean: 0.44783270359039307
The modified gen p mean: 0.44800007343292236, gen p mean: 0.7787301540374756, mean p set: 0.448, frame p mean: 0.447179913520813
The modified gen p mean: 0.4480000436306, gen p mean: 0.7805362939834595, mean p set: 0.448, frame p mean: 0.4478321373462677
loss_pred:0.14117328822612762, decouple_loss:0.5170606374740601
loss_pred:0.1493382304906845, decouple_loss:0.5186668038368225
loss_pred:0.14614595472812653, decouple_loss:0.5191213488578796
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479999542236328, gen p mean: 0.8723151683807373, mean p set: 0.448, frame p mean: 0.4467985928058624
The modified gen p mean: 0.4479999840259552, gen p mean: 0.8792519569396973, mean p set: 0.448, frame p mean: 0.4474354088306427
loss_pred:0.07710593938827515, decouple_loss:0.4276374578475952
The modified gen p mean: 0.4479999840259552, gen p mean: 0.8733306527137756, mean p set: 0.448, frame p mean: 0.44667044281959534
loss_pred:0.08127104490995407, decouple_loss:0.43056321144104004
loss_pred:0.08009227365255356, decouple_loss:0.4286510944366455
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479999840259552, gen p mean: 0.9230117797851562, mean p set: 0.448, frame p mean: 0.4468268156051636
The modified gen p mean: 0.4479999840259552, gen p mean: 0.9315697550773621, mean p set: 0.448, frame p mean: 0.44814759492874146
The modified gen p mean: 0.44800007343292236, gen p mean: 0.9224145412445068, mean p set: 0.448, frame p mean: 0.4464755058288574
loss_pred:0.08435995131731033, decouple_loss:0.3397625684738159
loss_pred:0.08318394422531128, decouple_loss:0.33969271183013916
loss_pred:0.09004136919975281, decouple_loss:0.33961567282676697
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479999542236328, gen p mean: 0.9006529450416565, mean p set: 0.448, frame p mean: 0.44661372900009155
The modified gen p mean: 0.4479999840259552, gen p mean: 0.8975065350532532, mean p set: 0.448, frame p mean: 0.44670531153678894
The modified gen p mean: 0.4479999840259552, gen p mean: 0.9038376212120056, mean p set: 0.448, frame p mean: 0.44916677474975586
loss_pred:0.06983671337366104, decouple_loss:0.27936995029449463
loss_pred:0.06468082219362259, decouple_loss:0.27891606092453003
loss_pred:0.06637794524431229, decouple_loss:0.280102401971817
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480000436306, gen p mean: 0.8813877105712891, mean p set: 0.448, frame p mean: 0.44673851132392883
The modified gen p mean: 0.4479999840259552, gen p mean: 0.8764045238494873, mean p set: 0.448, frame p mean: 0.4472814202308655The modified gen p mean: 0.44800007343292236, gen p mean: 0.8766050934791565, mean p set: 0.448, frame p mean: 0.4474690556526184
loss_pred:0.060459498316049576, decouple_loss:0.24083994328975677
loss_pred:0.06197034567594528, decouple_loss:0.2418486773967743loss_pred:0.06250245124101639, decouple_loss:0.24153345823287964
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800007343292236, gen p mean: 0.8513585329055786, mean p set: 0.448, frame p mean: 0.4463586211204529
The modified gen p mean: 0.4479999840259552, gen p mean: 0.8527684807777405, mean p set: 0.448, frame p mean: 0.44846197962760925
loss_pred:0.055122677236795425, decouple_loss:0.21418505907058716
The modified gen p mean: 0.4480000436306, gen p mean: 0.8506976962089539, mean p set: 0.448, frame p mean: 0.4455759823322296
loss_pred:0.05414804071187973, decouple_loss:0.213994562625885
loss_pred:0.05364269018173218, decouple_loss:0.21332025527954102
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7760807275772095, mean p set: 0.448, frame p mean: 0.44706037640571594
The modified gen p mean: 0.44800007343292236, gen p mean: 0.7774564027786255, mean p set: 0.448, frame p mean: 0.4468597173690796
The modified gen p mean: 0.4479999244213104, gen p mean: 0.7736504673957825, mean p set: 0.448, frame p mean: 0.4480447471141815
loss_pred:0.0519840270280838, decouple_loss:0.175509512424469
loss_pred:0.04839230701327324, decouple_loss:0.17527441680431366
loss_pred:0.04778138920664787, decouple_loss:0.17561404407024384
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800007343292236, gen p mean: 0.7398231029510498, mean p set: 0.448, frame p mean: 0.4476744532585144
The modified gen p mean: 0.44800007343292236, gen p mean: 0.7448015213012695, mean p set: 0.448, frame p mean: 0.4474974572658539loss_pred:0.044852934777736664, decouple_loss:0.16504713892936707
The modified gen p mean: 0.44800007343292236, gen p mean: 0.7418278455734253, mean p set: 0.448, frame p mean: 0.4478948414325714
loss_pred:0.04418274387717247, decouple_loss:0.16552868485450745
loss_pred:0.04522605612874031, decouple_loss:0.16640371084213257
2023-04-16 23:41:28 testing...
The modified gen p mean: 0.4480000138282776, gen p mean: 0.35693058371543884, mean p set: 0.448, frame p mean: 0.4499312937259674
loss_pred:0.09766235202550888, decouple_loss:0.16059519350528717
The modified gen p mean: 0.4480000138282776, gen p mean: 0.35798078775405884, mean p set: 0.448, frame p mean: 0.4499579966068268
The modified gen p mean: 0.4480000138282776, gen p mean: 0.3570532500743866, mean p set: 0.448, frame p mean: 0.4493577778339386
loss_pred:0.09691847860813141, decouple_loss:0.15938687324523926
loss_pred:0.09729558974504471, decouple_loss:0.15973450243473053
WV_0_PC_1_EH_1_PS_40, loss: 0.10528741776943207, avg_mse: 0.14745675027370453
current test mse: 0.147457
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7404494285583496, mean p set: 0.448, frame p mean: 0.44587668776512146
The modified gen p mean: 0.4479999840259552, gen p mean: 0.743213951587677, mean p set: 0.448, frame p mean: 0.44705963134765625
The modified gen p mean: 0.4479999840259552, gen p mean: 0.742786169052124, mean p set: 0.448, frame p mean: 0.4467807114124298
loss_pred:0.04278605431318283, decouple_loss:0.1516588181257248
loss_pred:0.04369336739182472, decouple_loss:0.15308311581611633
loss_pred:0.04332692548632622, decouple_loss:0.15028955042362213
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7454848289489746, mean p set: 0.448, frame p mean: 0.4463561773300171
loss_pred:0.04183792695403099, decouple_loss:0.12155354022979736
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7511053681373596, mean p set: 0.448, frame p mean: 0.4470158815383911
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7509542107582092, mean p set: 0.448, frame p mean: 0.4464634358882904
loss_pred:0.04134729504585266, decouple_loss:0.12211677432060242
loss_pred:0.03929516673088074, decouple_loss:0.12079682946205139
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800007343292236, gen p mean: 0.7585605382919312, mean p set: 0.448, frame p mean: 0.4476487636566162
The modified gen p mean: 0.4480000436306, gen p mean: 0.7570807933807373, mean p set: 0.448, frame p mean: 0.4472382068634033
loss_pred:0.03792942687869072, decouple_loss:0.11551223695278168
loss_pred:0.03936202451586723, decouple_loss:0.1165764331817627
The modified gen p mean: 0.44800007343292236, gen p mean: 0.7596444487571716, mean p set: 0.448, frame p mean: 0.447695791721344
loss_pred:0.03869124874472618, decouple_loss:0.1190664991736412
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7618238925933838, mean p set: 0.448, frame p mean: 0.44707292318344116
loss_pred:0.04036416858434677, decouple_loss:0.10673218965530396
The modified gen p mean: 0.4480000436306, gen p mean: 0.7628836035728455, mean p set: 0.448, frame p mean: 0.4478280246257782
loss_pred:0.038546379655599594, decouple_loss:0.1054508313536644
The modified gen p mean: 0.4480000436306, gen p mean: 0.7667106986045837, mean p set: 0.448, frame p mean: 0.44908928871154785
loss_pred:0.038197122514247894, decouple_loss:0.10395640134811401
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480000436306, gen p mean: 0.7708967328071594, mean p set: 0.448, frame p mean: 0.4450109302997589
loss_pred:0.038216110318899155, decouple_loss:0.09134181588888168
The modified gen p mean: 0.44800007343292236, gen p mean: 0.7715278267860413, mean p set: 0.448, frame p mean: 0.4460906982421875
loss_pred:0.03716438636183739, decouple_loss:0.09135594964027405
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7705951929092407, mean p set: 0.448, frame p mean: 0.44511592388153076
loss_pred:0.037039779126644135, decouple_loss:0.09113026410341263
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480000436306, gen p mean: 0.7744752168655396, mean p set: 0.448, frame p mean: 0.4460059404373169
loss_pred:0.034277092665433884, decouple_loss:0.08370700478553772
The modified gen p mean: 0.4480000436306, gen p mean: 0.7738603949546814, mean p set: 0.448, frame p mean: 0.4468384087085724
loss_pred:0.03493271768093109, decouple_loss:0.0826495885848999
The modified gen p mean: 0.44800007343292236, gen p mean: 0.780022919178009, mean p set: 0.448, frame p mean: 0.4462771713733673
loss_pred:0.03341451659798622, decouple_loss:0.08462825417518616
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7693892121315002, mean p set: 0.448, frame p mean: 0.44624295830726624
The modified gen p mean: 0.44800007343292236, gen p mean: 0.7677685022354126, mean p set: 0.448, frame p mean: 0.44779208302497864
loss_pred:0.033226341009140015, decouple_loss:0.0737856850028038
loss_pred:0.03548683226108551, decouple_loss:0.0733204185962677
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7692481279373169, mean p set: 0.448, frame p mean: 0.4472094774246216
loss_pred:0.0348583459854126, decouple_loss:0.07257962971925735
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479999244213104, gen p mean: 0.7567467093467712, mean p set: 0.448, frame p mean: 0.4476858675479889
The modified gen p mean: 0.4480000436306, gen p mean: 0.7573873996734619, mean p set: 0.448, frame p mean: 0.4481070637702942
loss_pred:0.03235326334834099, decouple_loss:0.06868310272693634
loss_pred:0.0329829677939415, decouple_loss:0.06775986403226852
The modified gen p mean: 0.44800007343292236, gen p mean: 0.7554553151130676, mean p set: 0.448, frame p mean: 0.4484039843082428
loss_pred:0.03271152079105377, decouple_loss:0.0681241974234581
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7420405149459839, mean p set: 0.448, frame p mean: 0.44663622975349426
loss_pred:0.03287431225180626, decouple_loss:0.06573940813541412
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7475070357322693, mean p set: 0.448, frame p mean: 0.4468662738800049
The modified gen p mean: 0.4480000436306, gen p mean: 0.7466487288475037, mean p set: 0.448, frame p mean: 0.448051393032074
loss_pred:0.030926303938031197, decouple_loss:0.06611119955778122
loss_pred:0.029657641425728798, decouple_loss:0.0658942237496376
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800007343292236, gen p mean: 0.7416465878486633, mean p set: 0.448, frame p mean: 0.4471392035484314
The modified gen p mean: 0.4479999244213104, gen p mean: 0.7460170984268188, mean p set: 0.448, frame p mean: 0.4474252462387085
loss_pred:0.03077337145805359, decouple_loss:0.06237396225333214
loss_pred:0.032969336956739426, decouple_loss:0.06243098899722099
The modified gen p mean: 0.4480000436306, gen p mean: 0.7476488351821899, mean p set: 0.448, frame p mean: 0.44591379165649414
loss_pred:0.03247822821140289, decouple_loss:0.06184440106153488
2023-04-16 23:43:21 testing...
The modified gen p mean: 0.4480000138282776, gen p mean: 0.3542289137840271, mean p set: 0.448, frame p mean: 0.4499312937259674
loss_pred:0.10742117464542389, decouple_loss:0.08125915378332138
The modified gen p mean: 0.4480000138282776, gen p mean: 0.35692664980888367, mean p set: 0.448, frame p mean: 0.4499579966068268
The modified gen p mean: 0.4480000436306, gen p mean: 0.35471582412719727, mean p set: 0.448, frame p mean: 0.4493577778339386
loss_pred:0.10543735325336456, decouple_loss:0.08208166062831879
loss_pred:0.10573472082614899, decouple_loss:0.08068835735321045
WV_0_PC_1_EH_1_PS_40, loss: 0.11026489734649658, avg_mse: 0.1847698837518692
current test mse: 0.18477
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480000436306, gen p mean: 0.747310221195221, mean p set: 0.448, frame p mean: 0.4481872320175171
loss_pred:0.029948875308036804, decouple_loss:0.05795704945921898
The modified gen p mean: 0.44800013303756714, gen p mean: 0.7494054436683655, mean p set: 0.448, frame p mean: 0.44770875573158264
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7497231960296631, mean p set: 0.448, frame p mean: 0.4476402699947357loss_pred:0.031500741839408875, decouple_loss:0.0575544573366642
loss_pred:0.030999263748526573, decouple_loss:0.0574655756354332
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7524810433387756, mean p set: 0.448, frame p mean: 0.44842734932899475
loss_pred:0.030742868781089783, decouple_loss:0.05555763095617294
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7505417466163635, mean p set: 0.448, frame p mean: 0.44831401109695435
The modified gen p mean: 0.4479999244213104, gen p mean: 0.7506941556930542, mean p set: 0.448, frame p mean: 0.4476161599159241
loss_pred:0.03030557930469513, decouple_loss:0.055237337946891785
loss_pred:0.02886083349585533, decouple_loss:0.05511198565363884
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7511617541313171, mean p set: 0.448, frame p mean: 0.44756215810775757
loss_pred:0.028231335803866386, decouple_loss:0.05193457007408142
The modified gen p mean: 0.4480000436306, gen p mean: 0.7541798949241638, mean p set: 0.448, frame p mean: 0.4473632872104645
The modified gen p mean: 0.4480000436306, gen p mean: 0.7520334720611572, mean p set: 0.448, frame p mean: 0.44847479462623596
loss_pred:0.030637023970484734, decouple_loss:0.052665747702121735
loss_pred:0.02787432074546814, decouple_loss:0.05238325521349907
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800007343292236, gen p mean: 0.7450149655342102, mean p set: 0.448, frame p mean: 0.4481523633003235
loss_pred:0.029985807836055756, decouple_loss:0.05135228484869003
The modified gen p mean: 0.4480000436306, gen p mean: 0.7499305605888367, mean p set: 0.448, frame p mean: 0.44752267003059387
The modified gen p mean: 0.4479999542236328, gen p mean: 0.7475160956382751, mean p set: 0.448, frame p mean: 0.4489237070083618
loss_pred:0.028852976858615875, decouple_loss:0.05184481665492058
loss_pred:0.02861180528998375, decouple_loss:0.05044272914528847
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479999840259552, gen p mean: 0.758916437625885, mean p set: 0.448, frame p mean: 0.4475199580192566
loss_pred:0.028469815850257874, decouple_loss:0.04788024351000786
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7510451078414917, mean p set: 0.448, frame p mean: 0.44800204038619995
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7576857209205627, mean p set: 0.448, frame p mean: 0.4479852318763733
loss_pred:0.029440997168421745, decouple_loss:0.04664321616292
loss_pred:0.028676096349954605, decouple_loss:0.046773914247751236
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480000436306, gen p mean: 0.7735760807991028, mean p set: 0.448, frame p mean: 0.4479290843009949
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7735627293586731, mean p set: 0.448, frame p mean: 0.4489003121852875
loss_pred:0.02854299545288086, decouple_loss:0.0451747328042984
loss_pred:0.030058452859520912, decouple_loss:0.04528434947133064
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7686936259269714, mean p set: 0.448, frame p mean: 0.44759663939476013
loss_pred:0.027331147342920303, decouple_loss:0.04579893499612808
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800007343292236, gen p mean: 0.7740705609321594, mean p set: 0.448, frame p mean: 0.4475027322769165
loss_pred:0.03058347851037979, decouple_loss:0.04051831364631653
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7761918306350708, mean p set: 0.448, frame p mean: 0.44772595167160034
The modified gen p mean: 0.4480000436306, gen p mean: 0.7742262482643127, mean p set: 0.448, frame p mean: 0.44793882966041565
loss_pred:0.02865804359316826, decouple_loss:0.04044121876358986
loss_pred:0.028007691726088524, decouple_loss:0.040194083005189896
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7827261090278625, mean p set: 0.448, frame p mean: 0.448726087808609
loss_pred:0.025783194229006767, decouple_loss:0.04013018682599068
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7766258120536804, mean p set: 0.448, frame p mean: 0.4482075870037079
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7767323851585388, mean p set: 0.448, frame p mean: 0.4482317268848419
loss_pred:0.028509007766842842, decouple_loss:0.040365029126405716
loss_pred:0.028104376047849655, decouple_loss:0.04070579633116722
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7739812135696411, mean p set: 0.448, frame p mean: 0.4476640224456787
loss_pred:0.026799481362104416, decouple_loss:0.03829929977655411
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7778238654136658, mean p set: 0.448, frame p mean: 0.4478655457496643
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7796651721000671, mean p set: 0.448, frame p mean: 0.4479392468929291
loss_pred:0.02858719974756241, decouple_loss:0.038561541587114334
loss_pred:0.027740441262722015, decouple_loss:0.03829716891050339
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479999542236328, gen p mean: 0.7791589498519897, mean p set: 0.448, frame p mean: 0.44830161333084106
loss_pred:0.025983326137065887, decouple_loss:0.037658240646123886
The modified gen p mean: 0.44800007343292236, gen p mean: 0.7807205319404602, mean p set: 0.448, frame p mean: 0.4479323625564575
The modified gen p mean: 0.4479999840259552, gen p mean: 0.776572048664093, mean p set: 0.448, frame p mean: 0.4483315348625183
loss_pred:0.02496732585132122, decouple_loss:0.036254994571208954
loss_pred:0.02792576141655445, decouple_loss:0.03620637208223343
2023-04-16 23:45:51 testing...
The modified gen p mean: 0.4480000138282776, gen p mean: 0.34925979375839233, mean p set: 0.448, frame p mean: 0.4499312937259674
loss_pred:0.13946841657161713, decouple_loss:0.07014705240726471
The modified gen p mean: 0.4480000436306, gen p mean: 0.3499335050582886, mean p set: 0.448, frame p mean: 0.4493577778339386
The modified gen p mean: 0.4480000138282776, gen p mean: 0.35305288434028625, mean p set: 0.448, frame p mean: 0.4499579966068268
loss_pred:0.13742844760417938, decouple_loss:0.06958717852830887
loss_pred:0.13660988211631775, decouple_loss:0.07103098183870316
WV_0_PC_1_EH_1_PS_40, loss: 0.14134834706783295, avg_mse: 0.2613980770111084
current test mse: 0.261398
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7703034281730652, mean p set: 0.448, frame p mean: 0.4484670162200928
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7747001647949219, mean p set: 0.448, frame p mean: 0.44761723279953003
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7781263589859009, mean p set: 0.448, frame p mean: 0.4480353891849518
loss_pred:0.02933959849178791, decouple_loss:0.034320708364248276
loss_pred:0.02699676714837551, decouple_loss:0.03453225642442703
loss_pred:0.027523091062903404, decouple_loss:0.034461136907339096
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800007343292236, gen p mean: 0.7955886721611023, mean p set: 0.448, frame p mean: 0.44806477427482605
loss_pred:0.02569529600441456, decouple_loss:0.03222639858722687
The modified gen p mean: 0.4479999542236328, gen p mean: 0.8037610650062561, mean p set: 0.448, frame p mean: 0.4480753540992737
The modified gen p mean: 0.4479999840259552, gen p mean: 0.8045105934143066, mean p set: 0.448, frame p mean: 0.44773468375205994
loss_pred:0.031305134296417236, decouple_loss:0.032791297882795334
loss_pred:0.02629726007580757, decouple_loss:0.03208952024579048
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479999542236328, gen p mean: 0.7988896369934082, mean p set: 0.448, frame p mean: 0.44771432876586914
loss_pred:0.02566171996295452, decouple_loss:0.03247973322868347
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7894007563591003, mean p set: 0.448, frame p mean: 0.4478909969329834
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7933879494667053, mean p set: 0.448, frame p mean: 0.4477234482765198
loss_pred:0.02657218463718891, decouple_loss:0.032543081790208817
loss_pred:0.026297394186258316, decouple_loss:0.032837577164173126
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479999840259552, gen p mean: 0.786450207233429, mean p set: 0.448, frame p mean: 0.4479657709598541
loss_pred:0.02545548602938652, decouple_loss:0.02969791740179062
The modified gen p mean: 0.44800007343292236, gen p mean: 0.7846354246139526, mean p set: 0.448, frame p mean: 0.44893357157707214
The modified gen p mean: 0.4480000436306, gen p mean: 0.7897427678108215, mean p set: 0.448, frame p mean: 0.4488055408000946
loss_pred:0.02786732092499733, decouple_loss:0.029685625806450844
loss_pred:0.02527005970478058, decouple_loss:0.029757797718048096
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800007343292236, gen p mean: 0.7893386483192444, mean p set: 0.448, frame p mean: 0.44824454188346863
loss_pred:0.026279592886567116, decouple_loss:0.02954050712287426
The modified gen p mean: 0.4479999542236328, gen p mean: 0.7890018224716187, mean p set: 0.448, frame p mean: 0.4482894241809845
The modified gen p mean: 0.4480000436306, gen p mean: 0.7837250828742981, mean p set: 0.448, frame p mean: 0.44767796993255615
loss_pred:0.02712058462202549, decouple_loss:0.030286047607660294
loss_pred:0.025511013343930244, decouple_loss:0.029698943719267845
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480000436306, gen p mean: 0.7795414924621582, mean p set: 0.448, frame p mean: 0.4483380615711212
The modified gen p mean: 0.4480000436306, gen p mean: 0.774297297000885, mean p set: 0.448, frame p mean: 0.4477705657482147
loss_pred:0.02364976517856121, decouple_loss:0.027146460488438606
The modified gen p mean: 0.4479999542236328, gen p mean: 0.7796912789344788, mean p set: 0.448, frame p mean: 0.4483500123023987
loss_pred:0.02735455147922039, decouple_loss:0.027719663456082344
loss_pred:0.027969995513558388, decouple_loss:0.028208713978528976
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800007343292236, gen p mean: 0.7880478501319885, mean p set: 0.448, frame p mean: 0.44788655638694763
The modified gen p mean: 0.44800007343292236, gen p mean: 0.7869349122047424, mean p set: 0.448, frame p mean: 0.44831201434135437
The modified gen p mean: 0.44800007343292236, gen p mean: 0.7903874516487122, mean p set: 0.448, frame p mean: 0.44797980785369873
loss_pred:0.026338068768382072, decouple_loss:0.026379944756627083
loss_pred:0.025390055030584335, decouple_loss:0.027061499655246735
loss_pred:0.023919224739074707, decouple_loss:0.026260532438755035
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480000436306, gen p mean: 0.8060076236724854, mean p set: 0.448, frame p mean: 0.44758766889572144
The modified gen p mean: 0.44800007343292236, gen p mean: 0.7961323857307434, mean p set: 0.448, frame p mean: 0.44793716073036194
loss_pred:0.025331374257802963, decouple_loss:0.025627536699175835
The modified gen p mean: 0.44800007343292236, gen p mean: 0.8014039993286133, mean p set: 0.448, frame p mean: 0.44741538166999817
loss_pred:0.025359351187944412, decouple_loss:0.025630461052060127
loss_pred:0.024675995111465454, decouple_loss:0.02551278844475746
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800007343292236, gen p mean: 0.7932842373847961, mean p set: 0.448, frame p mean: 0.44813814759254456
loss_pred:0.025206973776221275, decouple_loss:0.02633211389183998
The modified gen p mean: 0.4480000436306, gen p mean: 0.7990258932113647, mean p set: 0.448, frame p mean: 0.44803866744041443
The modified gen p mean: 0.44800007343292236, gen p mean: 0.7955325841903687, mean p set: 0.448, frame p mean: 0.44802314043045044
loss_pred:0.02685816027224064, decouple_loss:0.026174206286668777
loss_pred:0.024379104375839233, decouple_loss:0.026330819353461266
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480000436306, gen p mean: 0.7935535311698914, mean p set: 0.448, frame p mean: 0.44815242290496826
The modified gen p mean: 0.44800007343292236, gen p mean: 0.7827885150909424, mean p set: 0.448, frame p mean: 0.44821494817733765
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7915964126586914, mean p set: 0.448, frame p mean: 0.4486043155193329
loss_pred:0.025927457958459854, decouple_loss:0.02398407645523548
loss_pred:0.02440163493156433, decouple_loss:0.023727411404252052
loss_pred:0.02464878372848034, decouple_loss:0.025350185111165047
2023-04-16 23:47:44 testing...
The modified gen p mean: 0.4480000138282776, gen p mean: 0.34339773654937744, mean p set: 0.448, frame p mean: 0.4499312937259674
loss_pred:0.1499854326248169, decouple_loss:0.05727056413888931
The modified gen p mean: 0.4480000138282776, gen p mean: 0.3477453291416168, mean p set: 0.448, frame p mean: 0.4499579966068268
The modified gen p mean: 0.4479999840259552, gen p mean: 0.34398961067199707, mean p set: 0.448, frame p mean: 0.4493577778339386
loss_pred:0.14694218337535858, decouple_loss:0.058789219707250595
loss_pred:0.14800548553466797, decouple_loss:0.057714298367500305
WV_0_PC_1_EH_1_PS_40, loss: 0.15120726823806763, avg_mse: 0.2861453592777252
current test mse: 0.286145
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7889510989189148, mean p set: 0.448, frame p mean: 0.44882404804229736
loss_pred:0.026150263845920563, decouple_loss:0.02170046605169773
The modified gen p mean: 0.4480000436306, gen p mean: 0.7911721467971802, mean p set: 0.448, frame p mean: 0.4480050802230835
loss_pred:0.025737524032592773, decouple_loss:0.021862471476197243
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7861753106117249, mean p set: 0.448, frame p mean: 0.44757404923439026
loss_pred:0.025794900953769684, decouple_loss:0.022527383640408516
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480000436306, gen p mean: 0.7913020849227905, mean p set: 0.448, frame p mean: 0.44846799969673157
The modified gen p mean: 0.4479999542236328, gen p mean: 0.7884113788604736, mean p set: 0.448, frame p mean: 0.4485507607460022
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7907549738883972, mean p set: 0.448, frame p mean: 0.44771572947502136
loss_pred:0.026963770389556885, decouple_loss:0.025754360482096672
loss_pred:0.026017645373940468, decouple_loss:0.02336549386382103
loss_pred:0.025291867554187775, decouple_loss:0.022538641467690468
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479999840259552, gen p mean: 0.7888749837875366, mean p set: 0.448, frame p mean: 0.44771701097488403
The modified gen p mean: 0.4480000436306, gen p mean: 0.7906644940376282, mean p set: 0.448, frame p mean: 0.44719597697257996
loss_pred:0.027537694200873375, decouple_loss:0.02406376414000988
loss_pred:0.026051007211208344, decouple_loss:0.024678340181708336
The modified gen p mean: 0.4480000436306, gen p mean: 0.7916002869606018, mean p set: 0.448, frame p mean: 0.4483417272567749
loss_pred:0.025769922882318497, decouple_loss:0.024048030376434326
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800007343292236, gen p mean: 0.7986785173416138, mean p set: 0.448, frame p mean: 0.44726964831352234
The modified gen p mean: 0.4479999840259552, gen p mean: 0.8021642565727234, mean p set: 0.448, frame p mean: 0.44637998938560486
loss_pred:0.024444663897156715, decouple_loss:0.022361785173416138
The modified gen p mean: 0.4479999840259552, gen p mean: 0.8042423129081726, mean p set: 0.448, frame p mean: 0.44893527030944824
loss_pred:0.02654293179512024, decouple_loss:0.022516397759318352
loss_pred:0.025298019871115685, decouple_loss:0.026493504643440247
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479999542236328, gen p mean: 0.8145030736923218, mean p set: 0.448, frame p mean: 0.44835174083709717
loss_pred:0.023733727633953094, decouple_loss:0.021348413079977036
The modified gen p mean: 0.4479999840259552, gen p mean: 0.8137364983558655, mean p set: 0.448, frame p mean: 0.44707947969436646
The modified gen p mean: 0.4479999840259552, gen p mean: 0.8175045847892761, mean p set: 0.448, frame p mean: 0.4473164677619934
loss_pred:0.024651437997817993, decouple_loss:0.021447276696562767
loss_pred:0.02444436587393284, decouple_loss:0.02204674296081066
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800013303756714, gen p mean: 0.8197049498558044, mean p set: 0.448, frame p mean: 0.44832223653793335
The modified gen p mean: 0.4479999840259552, gen p mean: 0.8181280493736267, mean p set: 0.448, frame p mean: 0.4486171305179596
loss_pred:0.024547215551137924, decouple_loss:0.02384014055132866
The modified gen p mean: 0.4479999840259552, gen p mean: 0.8216947913169861, mean p set: 0.448, frame p mean: 0.4482777714729309
loss_pred:0.02575305476784706, decouple_loss:0.023881880566477776
loss_pred:0.025550000369548798, decouple_loss:0.02383814938366413
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480000436306, gen p mean: 0.80763179063797, mean p set: 0.448, frame p mean: 0.44809311628341675
The modified gen p mean: 0.4480000436306, gen p mean: 0.8085832595825195, mean p set: 0.448, frame p mean: 0.4473503828048706
loss_pred:0.02640967071056366, decouple_loss:0.02795988880097866
loss_pred:0.024381650611758232, decouple_loss:0.02724708616733551
The modified gen p mean: 0.4479999840259552, gen p mean: 0.8083324432373047, mean p set: 0.448, frame p mean: 0.4471953213214874
loss_pred:0.024793637916445732, decouple_loss:0.027004651725292206
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479999542236328, gen p mean: 0.8009538650512695, mean p set: 0.448, frame p mean: 0.447719007730484
loss_pred:0.024073421955108643, decouple_loss:0.02250024490058422
The modified gen p mean: 0.4480000436306, gen p mean: 0.8020359873771667, mean p set: 0.448, frame p mean: 0.4481663107872009
The modified gen p mean: 0.4479999542236328, gen p mean: 0.7969101071357727, mean p set: 0.448, frame p mean: 0.4472760558128357
loss_pred:0.02523506060242653, decouple_loss:0.02202606573700905
loss_pred:0.025242378935217857, decouple_loss:0.024100571870803833
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479999244213104, gen p mean: 0.8074454069137573, mean p set: 0.448, frame p mean: 0.448528915643692
The modified gen p mean: 0.4480000436306, gen p mean: 0.8037152886390686, mean p set: 0.448, frame p mean: 0.4476168155670166
loss_pred:0.024842696264386177, decouple_loss:0.02666720561683178
loss_pred:0.02627350017428398, decouple_loss:0.024652060121297836
The modified gen p mean: 0.4479999840259552, gen p mean: 0.8089141845703125, mean p set: 0.448, frame p mean: 0.4479531943798065
loss_pred:0.024744441732764244, decouple_loss:0.024373268708586693
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479999840259552, gen p mean: 0.8107615113258362, mean p set: 0.448, frame p mean: 0.44834545254707336
loss_pred:0.026906395331025124, decouple_loss:0.02303915284574032
The modified gen p mean: 0.4479999840259552, gen p mean: 0.8075008392333984, mean p set: 0.448, frame p mean: 0.44869598746299744
The modified gen p mean: 0.44800007343292236, gen p mean: 0.81403648853302, mean p set: 0.448, frame p mean: 0.44739124178886414
loss_pred:0.027949444949626923, decouple_loss:0.022604430094361305
loss_pred:0.025838032364845276, decouple_loss:0.02254614606499672
2023-04-16 23:50:17 testing...
The modified gen p mean: 0.4480000138282776, gen p mean: 0.33502674102783203, mean p set: 0.448, frame p mean: 0.4499312937259674
loss_pred:0.16233481466770172, decouple_loss:0.06498484313488007
The modified gen p mean: 0.4480000138282776, gen p mean: 0.3390929400920868, mean p set: 0.448, frame p mean: 0.4499579966068268
The modified gen p mean: 0.4480000138282776, gen p mean: 0.3354884684085846, mean p set: 0.448, frame p mean: 0.4493577778339386
loss_pred:0.1592269092798233, decouple_loss:0.06713876873254776
loss_pred:0.1598380208015442, decouple_loss:0.06586630642414093
WV_0_PC_1_EH_1_PS_40, loss: 0.16376642882823944, avg_mse: 0.31452465057373047
current test mse: 0.314525