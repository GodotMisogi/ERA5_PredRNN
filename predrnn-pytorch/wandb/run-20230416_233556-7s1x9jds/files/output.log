After initialize model, args.img_channel:3
load model: /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_1_PS_40/model_2000.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
train_data_files nums: 41
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_09012020_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798383116722107, gen p mean: 0.8373285531997681, mean p set: 0.4479837417602539, frame p mean: 0.44772595167160034
loss_pred:0.021909339353442192, decouple_loss:0.00997650995850563
The modified gen p mean: 0.44859758019447327, gen p mean: 0.8385187387466431, mean p set: 0.44859760999679565, frame p mean: 0.44810232520103455
loss_pred:0.022632993757724762, decouple_loss:0.009924564510583878
The modified gen p mean: 0.4481072723865509, gen p mean: 0.8402004241943359, mean p set: 0.44810721278190613, frame p mean: 0.4475199580192566
loss_pred:0.02252154052257538, decouple_loss:0.009952362626791
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448543906211853, gen p mean: 0.8551102876663208, mean p set: 0.44854387640953064, frame p mean: 0.44793882966041565
loss_pred:0.2694426476955414, decouple_loss:0.43324586749076843
The modified gen p mean: 0.4485456347465515, gen p mean: 0.8675420880317688, mean p set: 0.44854554533958435, frame p mean: 0.4483380615711212
loss_pred:0.24853822588920593, decouple_loss:0.4325127899646759
The modified gen p mean: 0.4479961395263672, gen p mean: 0.8616929054260254, mean p set: 0.4479960799217224, frame p mean: 0.4478655457496643
loss_pred:0.23782303929328918, decouple_loss:0.4321436583995819
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819334149360657, gen p mean: 0.7729580998420715, mean p set: 0.44819343090057373, frame p mean: 0.44802314043045044
The modified gen p mean: 0.4480293393135071, gen p mean: 0.7782052755355835, mean p set: 0.44802939891815186, frame p mean: 0.4473632872104645loss_pred:0.14792992174625397, decouple_loss:0.528038740158081
loss_pred:0.1414729803800583, decouple_loss:0.5258192420005798
The modified gen p mean: 0.44836536049842834, gen p mean: 0.7771844267845154, mean p set: 0.44836533069610596, frame p mean: 0.44803866744041443
loss_pred:0.14798997342586517, decouple_loss:0.528698742389679
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487065076828003, gen p mean: 0.8722928166389465, mean p set: 0.4487065374851227, frame p mean: 0.4481872320175171
The modified gen p mean: 0.44889724254608154, gen p mean: 0.8716296553611755, mean p set: 0.44889721274375916, frame p mean: 0.44831401109695435
loss_pred:0.07541370391845703, decouple_loss:0.40562641620635986
loss_pred:0.07470189034938812, decouple_loss:0.4021928906440735
The modified gen p mean: 0.4482019543647766, gen p mean: 0.8746427893638611, mean p set: 0.448201984167099, frame p mean: 0.44771432876586914
loss_pred:0.07581225037574768, decouple_loss:0.4038872718811035
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44821566343307495, gen p mean: 0.9318321943283081, mean p set: 0.4482157230377197, frame p mean: 0.44756215810775757
loss_pred:0.06570570915937424, decouple_loss:0.3158871829509735
The modified gen p mean: 0.4483419954776764, gen p mean: 0.9328143000602722, mean p set: 0.448341965675354, frame p mean: 0.44758766889572144
loss_pred:0.06924892216920853, decouple_loss:0.3126647174358368
The modified gen p mean: 0.4484822154045105, gen p mean: 0.9291111826896667, mean p set: 0.4484822154045105, frame p mean: 0.4484670162200928
loss_pred:0.06516081839799881, decouple_loss:0.3152649700641632
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44928401708602905, gen p mean: 0.9068809151649475, mean p set: 0.44928398728370667, frame p mean: 0.4489003121852875
The modified gen p mean: 0.44760605692863464, gen p mean: 0.8973562717437744, mean p set: 0.4476061165332794, frame p mean: 0.44759663939476013
loss_pred:0.06706180423498154, decouple_loss:0.2521367371082306
loss_pred:0.061716072261333466, decouple_loss:0.253741055727005
The modified gen p mean: 0.44859495759010315, gen p mean: 0.9040985107421875, mean p set: 0.4485950171947479, frame p mean: 0.4479657709598541
loss_pred:0.06666524708271027, decouple_loss:0.25272470712661743
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488312005996704, gen p mean: 0.8550614714622498, mean p set: 0.4488312005996704, frame p mean: 0.4482894241809845
The modified gen p mean: 0.44847962260246277, gen p mean: 0.8533847332000732, mean p set: 0.44847962260246277, frame p mean: 0.44788655638694763
loss_pred:0.05897895246744156, decouple_loss:0.2011657953262329
loss_pred:0.060292910784482956, decouple_loss:0.2022986114025116
The modified gen p mean: 0.4480193555355072, gen p mean: 0.8517595529556274, mean p set: 0.4480193257331848, frame p mean: 0.44800204038619995
loss_pred:0.05590060353279114, decouple_loss:0.20080451667308807
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44838470220565796, gen p mean: 0.8634815216064453, mean p set: 0.44838467240333557, frame p mean: 0.44773468375205994
The modified gen p mean: 0.44839832186698914, gen p mean: 0.8658914566040039, mean p set: 0.44839832186698914, frame p mean: 0.4483315348625183
loss_pred:0.05032243952155113, decouple_loss:0.18640972673892975
loss_pred:0.04639590159058571, decouple_loss:0.18545937538146973
The modified gen p mean: 0.4489077031612396, gen p mean: 0.8647552132606506, mean p set: 0.4489077031612396, frame p mean: 0.448726087808609
loss_pred:0.051460422575473785, decouple_loss:0.18663430213928223
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44792646169662476, gen p mean: 0.862168550491333, mean p set: 0.44792643189430237, frame p mean: 0.4475027322769165
The modified gen p mean: 0.44904083013534546, gen p mean: 0.8659448623657227, mean p set: 0.44904080033302307, frame p mean: 0.44824454188346863
loss_pred:0.04614169895648956, decouple_loss:0.1720733344554901
loss_pred:0.04409550130367279, decouple_loss:0.17186109721660614
The modified gen p mean: 0.44964343309402466, gen p mean: 0.8643516898155212, mean p set: 0.4496433436870575, frame p mean: 0.4489237070083618
loss_pred:0.042820047587156296, decouple_loss:0.1712256371974945
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44847774505615234, gen p mean: 0.8348598480224609, mean p set: 0.44847777485847473, frame p mean: 0.4480353891849518
The modified gen p mean: 0.44877514243125916, gen p mean: 0.8329555988311768, mean p set: 0.448775053024292, frame p mean: 0.4482075870037079
loss_pred:0.04220908507704735, decouple_loss:0.14877574145793915
loss_pred:0.04644810035824776, decouple_loss:0.1476851850748062
The modified gen p mean: 0.4482515752315521, gen p mean: 0.8296975493431091, mean p set: 0.4482516348361969, frame p mean: 0.4479852318763733
loss_pred:0.04343748465180397, decouple_loss:0.14666850864887238
2023-04-16 23:38:54 testing...
The modified gen p mean: 0.4502691328525543, gen p mean: 0.33829087018966675, mean p set: 0.4502691626548767, frame p mean: 0.4499312937259674
The modified gen p mean: 0.45035699009895325, gen p mean: 0.33961522579193115, mean p set: 0.45035696029663086, frame p mean: 0.4499579966068268
The modified gen p mean: 0.4500633776187897, gen p mean: 0.339088499546051, mean p set: 0.4500633478164673, frame p mean: 0.4493577778339386
loss_pred:0.12965545058250427, decouple_loss:0.151580810546875
loss_pred:0.1284073442220688, decouple_loss:0.15347954630851746loss_pred:0.1282007098197937, decouple_loss:0.15276971459388733
WV_0_PC_1_EH_1_PS_40, loss: 0.1363850086927414, avg_mse: 0.21794086694717407
current test mse: 0.217941
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482825696468353, gen p mean: 0.8170906901359558, mean p set: 0.44828253984451294, frame p mean: 0.4476402699947357
The modified gen p mean: 0.4483332633972168, gen p mean: 0.8134543895721436, mean p set: 0.4483332633972168, frame p mean: 0.4478909969329834
loss_pred:0.040675289928913116, decouple_loss:0.13226012885570526
loss_pred:0.03786754235625267, decouple_loss:0.13174228370189667
The modified gen p mean: 0.44880878925323486, gen p mean: 0.8192654848098755, mean p set: 0.4488089084625244, frame p mean: 0.4488055408000946
loss_pred:0.03906247392296791, decouple_loss:0.12972424924373627
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484618008136749, gen p mean: 0.8158803582191467, mean p set: 0.44846177101135254, frame p mean: 0.44831201434135437
The modified gen p mean: 0.44843563437461853, gen p mean: 0.8184363842010498, mean p set: 0.44843557476997375, frame p mean: 0.4479290843009949
loss_pred:0.03638235852122307, decouple_loss:0.12557901442050934
loss_pred:0.038370080292224884, decouple_loss:0.12390519678592682
The modified gen p mean: 0.4486706852912903, gen p mean: 0.8168607354164124, mean p set: 0.4486706554889679, frame p mean: 0.44797980785369873
loss_pred:0.03836515173316002, decouple_loss:0.12325608730316162
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476796090602875, gen p mean: 0.8241055011749268, mean p set: 0.4476796090602875, frame p mean: 0.44752267003059387
The modified gen p mean: 0.4482642412185669, gen p mean: 0.8184758424758911, mean p set: 0.44826412200927734, frame p mean: 0.44806477427482605
loss_pred:0.03803490474820137, decouple_loss:0.11004585772752762
loss_pred:0.03517685458064079, decouple_loss:0.11106578260660172
The modified gen p mean: 0.4479988217353821, gen p mean: 0.8187444806098938, mean p set: 0.44799885153770447, frame p mean: 0.44793716073036194
loss_pred:0.03580137714743614, decouple_loss:0.11244872957468033
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44775882363319397, gen p mean: 0.8276326060295105, mean p set: 0.4477587640285492, frame p mean: 0.44741538166999817The modified gen p mean: 0.44828295707702637, gen p mean: 0.8265430331230164, mean p set: 0.44828298687934875, frame p mean: 0.44761723279953003
The modified gen p mean: 0.44831398129463196, gen p mean: 0.8260017037391663, mean p set: 0.4483139216899872, frame p mean: 0.44813814759254456
loss_pred:0.038420483469963074, decouple_loss:0.09994961321353912loss_pred:0.038409266620874405, decouple_loss:0.10063347965478897
loss_pred:0.03415412828326225, decouple_loss:0.10100404918193817
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482753872871399, gen p mean: 0.8504645824432373, mean p set: 0.4482753276824951, frame p mean: 0.44815242290496826
The modified gen p mean: 0.44789713621139526, gen p mean: 0.8436073660850525, mean p set: 0.44789719581604004, frame p mean: 0.4476640224456787loss_pred:0.03294558450579643, decouple_loss:0.09189777076244354
loss_pred:0.03303039073944092, decouple_loss:0.09241241961717606
The modified gen p mean: 0.44843021035194397, gen p mean: 0.8449192047119141, mean p set: 0.44843021035194397, frame p mean: 0.44821494817733765
loss_pred:0.03541436418890953, decouple_loss:0.0921054482460022
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483577311038971, gen p mean: 0.8494717478752136, mean p set: 0.4483576714992523, frame p mean: 0.4477705657482147
The modified gen p mean: 0.44926148653030396, gen p mean: 0.855521559715271, mean p set: 0.44926151633262634, frame p mean: 0.4483500123023987
loss_pred:0.03456709906458855, decouple_loss:0.09009747207164764
loss_pred:0.03181694075465202, decouple_loss:0.0909760519862175
The modified gen p mean: 0.4485936760902405, gen p mean: 0.8517080545425415, mean p set: 0.44859370589256287, frame p mean: 0.44842734932899475
loss_pred:0.03318944573402405, decouple_loss:0.08868203312158585
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790002703666687, gen p mean: 0.8451604247093201, mean p set: 0.4478999972343445, frame p mean: 0.4476161599159241
The modified gen p mean: 0.44819650053977966, gen p mean: 0.8479289412498474, mean p set: 0.44819650053977966, frame p mean: 0.44847479462623596
loss_pred:0.0336228646337986, decouple_loss:0.0831073671579361
loss_pred:0.031665463000535965, decouple_loss:0.08398047834634781
The modified gen p mean: 0.44838592410087585, gen p mean: 0.8440687656402588, mean p set: 0.44838589429855347, frame p mean: 0.4481523633003235
loss_pred:0.03119603358209133, decouple_loss:0.08416250348091125
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481166899204254, gen p mean: 0.8381261229515076, mean p set: 0.4481166899204254, frame p mean: 0.44767796993255615
The modified gen p mean: 0.4492426812648773, gen p mean: 0.8412613272666931, mean p set: 0.4492427408695221, frame p mean: 0.44830161333084106
loss_pred:0.03213849291205406, decouple_loss:0.08101518452167511
loss_pred:0.033252328634262085, decouple_loss:0.08050783723592758
The modified gen p mean: 0.4485490620136261, gen p mean: 0.8408961892127991, mean p set: 0.4485490918159485, frame p mean: 0.4479392468929291
loss_pred:0.032421842217445374, decouple_loss:0.08056812733411789
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480954110622406, gen p mean: 0.8471130132675171, mean p set: 0.448095440864563, frame p mean: 0.4479323625564575
The modified gen p mean: 0.44861388206481934, gen p mean: 0.8458080291748047, mean p set: 0.4486139416694641, frame p mean: 0.4482317268848419
loss_pred:0.028617415577173233, decouple_loss:0.07420631498098373
loss_pred:0.030660660937428474, decouple_loss:0.07470059394836426
The modified gen p mean: 0.44916558265686035, gen p mean: 0.8444016575813293, mean p set: 0.4491655230522156, frame p mean: 0.4486043155193329
loss_pred:0.030511954799294472, decouple_loss:0.07485710829496384
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44859635829925537, gen p mean: 0.8658542037010193, mean p set: 0.44859638810157776, frame p mean: 0.4480753540992737
The modified gen p mean: 0.4489288032054901, gen p mean: 0.8647255897521973, mean p set: 0.44892874360084534, frame p mean: 0.44893357157707214
loss_pred:0.03160066902637482, decouple_loss:0.07000932097434998
loss_pred:0.03169460967183113, decouple_loss:0.07000219076871872
The modified gen p mean: 0.44776955246925354, gen p mean: 0.8629276156425476, mean p set: 0.44776955246925354, frame p mean: 0.4477234482765198
loss_pred:0.030364803969860077, decouple_loss:0.06951507180929184
2023-04-16 23:40:45 testing...
The modified gen p mean: 0.4502691626548767, gen p mean: 0.3266814649105072, mean p set: 0.4502691626548767, frame p mean: 0.4499312937259674
loss_pred:0.1469765156507492, decouple_loss:0.10015101730823517
The modified gen p mean: 0.4500633776187897, gen p mean: 0.3272169232368469, mean p set: 0.4500633478164673, frame p mean: 0.4493577778339386
The modified gen p mean: 0.45035699009895325, gen p mean: 0.33005836606025696, mean p set: 0.45035696029663086, frame p mean: 0.4499579966068268
loss_pred:0.14549225568771362, decouple_loss:0.10085294395685196
loss_pred:0.14467887580394745, decouple_loss:0.10167187452316284
WV_0_PC_1_EH_1_PS_40, loss: 0.1507604867219925, avg_mse: 0.26627984642982483
current test mse: 0.26628
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013126730918884, gen p mean: 0.8487979769706726, mean p set: 0.45013123750686646, frame p mean: 0.45004409551620483
loss_pred:0.029339730739593506, decouple_loss:0.07055817544460297
The modified gen p mean: 0.4488740563392639, gen p mean: 0.8506302833557129, mean p set: 0.4488740861415863, frame p mean: 0.44866254925727844
loss_pred:0.03128612041473389, decouple_loss:0.07245666533708572
The modified gen p mean: 0.4493984580039978, gen p mean: 0.855266273021698, mean p set: 0.4493984878063202, frame p mean: 0.44837310910224915
loss_pred:0.029075531288981438, decouple_loss:0.06873226165771484
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504837393760681, gen p mean: 0.8249207139015198, mean p set: 0.4504837691783905, frame p mean: 0.44978728890419006
The modified gen p mean: 0.4502677917480469, gen p mean: 0.8319920301437378, mean p set: 0.4502677023410797, frame p mean: 0.4491778016090393
loss_pred:0.029787203297019005, decouple_loss:0.071204774081707
loss_pred:0.028407013043761253, decouple_loss:0.06934906542301178
The modified gen p mean: 0.4499141573905945, gen p mean: 0.8293691873550415, mean p set: 0.44991418719291687, frame p mean: 0.4494633674621582
loss_pred:0.030294524505734444, decouple_loss:0.07012199610471725
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45026013255119324, gen p mean: 0.8168894052505493, mean p set: 0.45026013255119324, frame p mean: 0.4497445225715637
The modified gen p mean: 0.4505905508995056, gen p mean: 0.8141569495201111, mean p set: 0.4505905210971832, frame p mean: 0.45014429092407227
The modified gen p mean: 0.44971829652786255, gen p mean: 0.8208317756652832, mean p set: 0.4497183561325073, frame p mean: 0.44880691170692444
loss_pred:0.028561679646372795, decouple_loss:0.06790798157453537
loss_pred:0.029577594250440598, decouple_loss:0.06801504641771317
loss_pred:0.030195584520697594, decouple_loss:0.06674672663211823
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505513906478882, gen p mean: 0.8254927396774292, mean p set: 0.4505513906478882, frame p mean: 0.45024412870407104
The modified gen p mean: 0.44884949922561646, gen p mean: 0.8282067179679871, mean p set: 0.44884949922561646, frame p mean: 0.44835689663887024
The modified gen p mean: 0.45070981979370117, gen p mean: 0.8263213634490967, mean p set: 0.45070981979370117, frame p mean: 0.4504072368144989
loss_pred:0.029743846505880356, decouple_loss:0.058238424360752106
loss_pred:0.03159018233418465, decouple_loss:0.059231918305158615
loss_pred:0.029233960434794426, decouple_loss:0.05924200639128685
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489457905292511, gen p mean: 0.8394221663475037, mean p set: 0.4489458501338959, frame p mean: 0.44867128133773804
The modified gen p mean: 0.4490678906440735, gen p mean: 0.8399516940116882, mean p set: 0.44906798005104065, frame p mean: 0.44794759154319763
loss_pred:0.029435494914650917, decouple_loss:0.05764813348650932
loss_pred:0.02803807705640793, decouple_loss:0.05838626250624657
The modified gen p mean: 0.44813889265060425, gen p mean: 0.8395314812660217, mean p set: 0.44813892245292664, frame p mean: 0.4482429623603821
loss_pred:0.029351141303777695, decouple_loss:0.05857023969292641
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45031705498695374, gen p mean: 0.8500429391860962, mean p set: 0.4503171145915985, frame p mean: 0.44924819469451904
The modified gen p mean: 0.4501366913318634, gen p mean: 0.8521536588668823, mean p set: 0.45013657212257385, frame p mean: 0.4493750035762787
loss_pred:0.026680340990424156, decouple_loss:0.057730626314878464
loss_pred:0.026642978191375732, decouple_loss:0.058369822800159454
The modified gen p mean: 0.449676513671875, gen p mean: 0.8478068113327026, mean p set: 0.4496765732765198, frame p mean: 0.4489264488220215
loss_pred:0.030006328597664833, decouple_loss:0.056879863142967224
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496772885322571, gen p mean: 0.8534417152404785, mean p set: 0.44967731833457947, frame p mean: 0.4490080177783966
The modified gen p mean: 0.4496835768222809, gen p mean: 0.8529931306838989, mean p set: 0.4496835172176361, frame p mean: 0.4485103189945221
loss_pred:0.026716480031609535, decouple_loss:0.053401824086904526
loss_pred:0.02858518622815609, decouple_loss:0.05268354341387749
The modified gen p mean: 0.4496646225452423, gen p mean: 0.856195867061615, mean p set: 0.4496645927429199, frame p mean: 0.4495159685611725
loss_pred:0.030436601489782333, decouple_loss:0.05268748104572296
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508661925792694, gen p mean: 0.8386249542236328, mean p set: 0.4508661925792694, frame p mean: 0.4504217803478241
The modified gen p mean: 0.44922110438346863, gen p mean: 0.841955304145813, mean p set: 0.449221134185791, frame p mean: 0.44890573620796204
loss_pred:0.029737666249275208, decouple_loss:0.05518849194049835
The modified gen p mean: 0.4497663974761963, gen p mean: 0.8426856994628906, mean p set: 0.4497663974761963, frame p mean: 0.4492763578891754
loss_pred:0.027186334133148193, decouple_loss:0.05411567911505699
loss_pred:0.02962017059326172, decouple_loss:0.05481119081377983
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489934742450714, gen p mean: 0.8232083320617676, mean p set: 0.448993444442749, frame p mean: 0.4482154846191406
loss_pred:0.027506476268172264, decouple_loss:0.048856623470783234
The modified gen p mean: 0.45015349984169006, gen p mean: 0.8233099579811096, mean p set: 0.4501534700393677, frame p mean: 0.44923630356788635
The modified gen p mean: 0.44845324754714966, gen p mean: 0.8220619559288025, mean p set: 0.44845327734947205, frame p mean: 0.44817179441452026
loss_pred:0.031768687069416046, decouple_loss:0.04855886101722717
loss_pred:0.026647767052054405, decouple_loss:0.04950834810733795
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494198262691498, gen p mean: 0.8450343608856201, mean p set: 0.4494198262691498, frame p mean: 0.4486393630504608
The modified gen p mean: 0.4485381245613098, gen p mean: 0.8435877561569214, mean p set: 0.4485381245613098, frame p mean: 0.4478552043437958
loss_pred:0.02761511132121086, decouple_loss:0.049222446978092194
The modified gen p mean: 0.44975119829177856, gen p mean: 0.8429808020591736, mean p set: 0.4497511684894562, frame p mean: 0.4493587613105774
loss_pred:0.027094846591353416, decouple_loss:0.050167590379714966
loss_pred:0.0279352068901062, decouple_loss:0.04947271570563316
2023-04-16 23:43:17 testing...
The modified gen p mean: 0.4502691924571991, gen p mean: 0.3273722231388092, mean p set: 0.4502691626548767, frame p mean: 0.4499312937259674
loss_pred:0.15794986486434937, decouple_loss:0.08584959805011749
The modified gen p mean: 0.4500633478164673, gen p mean: 0.3283964991569519, mean p set: 0.4500633478164673, frame p mean: 0.4493577778339386
The modified gen p mean: 0.45035699009895325, gen p mean: 0.33167120814323425, mean p set: 0.45035696029663086, frame p mean: 0.4499579966068268
loss_pred:0.15593020617961884, decouple_loss:0.08702331781387329
loss_pred:0.15501128137111664, decouple_loss:0.08701848983764648
WV_0_PC_1_EH_1_PS_40, loss: 0.16062864661216736, avg_mse: 0.2960112690925598
current test mse: 0.296011
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45017263293266296, gen p mean: 0.8548353910446167, mean p set: 0.45017269253730774, frame p mean: 0.44969022274017334
The modified gen p mean: 0.45077642798423767, gen p mean: 0.8465226292610168, mean p set: 0.4507763385772705, frame p mean: 0.4494830369949341
The modified gen p mean: 0.44949066638946533, gen p mean: 0.8527374267578125, mean p set: 0.44949063658714294, frame p mean: 0.4496670663356781
loss_pred:0.02594652771949768, decouple_loss:0.04543698951601982
loss_pred:0.026838254183530807, decouple_loss:0.045793287456035614
loss_pred:0.027141280472278595, decouple_loss:0.04589264467358589
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44851261377334595, gen p mean: 0.8494523167610168, mean p set: 0.44851261377334595, frame p mean: 0.44927749037742615
The modified gen p mean: 0.44975531101226807, gen p mean: 0.8482409119606018, mean p set: 0.4497552812099457, frame p mean: 0.44941720366477966
loss_pred:0.025402966886758804, decouple_loss:0.04934399574995041
loss_pred:0.026936201378703117, decouple_loss:0.049848489463329315
The modified gen p mean: 0.44951820373535156, gen p mean: 0.8565676808357239, mean p set: 0.4495182931423187, frame p mean: 0.44893479347229004
loss_pred:0.027646396309137344, decouple_loss:0.0503801666200161
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493415355682373, gen p mean: 0.8551301956176758, mean p set: 0.44934147596359253, frame p mean: 0.44912537932395935
loss_pred:0.02755778841674328, decouple_loss:0.04315219074487686
The modified gen p mean: 0.4491119384765625, gen p mean: 0.858147919178009, mean p set: 0.4491119980812073, frame p mean: 0.449093222618103
loss_pred:0.025398313999176025, decouple_loss:0.04401925206184387
The modified gen p mean: 0.4498424530029297, gen p mean: 0.8582597970962524, mean p set: 0.4498424530029297, frame p mean: 0.4485878646373749
loss_pred:0.02587462030351162, decouple_loss:0.043744541704654694
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449747234582901, gen p mean: 0.8407348394393921, mean p set: 0.4497471749782562, frame p mean: 0.4503709673881531
loss_pred:0.02581397257745266, decouple_loss:0.051519062370061874
The modified gen p mean: 0.44959837198257446, gen p mean: 0.8442901372909546, mean p set: 0.44959837198257446, frame p mean: 0.4489680230617523
loss_pred:0.02531507797539234, decouple_loss:0.048347510397434235The modified gen p mean: 0.4510662257671356, gen p mean: 0.8411309719085693, mean p set: 0.45106619596481323, frame p mean: 0.4506770670413971
loss_pred:0.0246978048235178, decouple_loss:0.05125032365322113
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513048529624939, gen p mean: 0.8510004281997681, mean p set: 0.45130491256713867, frame p mean: 0.4502248466014862
loss_pred:0.027838261798024178, decouple_loss:0.041723985224962234
The modified gen p mean: 0.4512900710105896, gen p mean: 0.8530068397521973, mean p set: 0.45129016041755676, frame p mean: 0.4504583775997162
The modified gen p mean: 0.44850999116897583, gen p mean: 0.8526654839515686, mean p set: 0.44850999116897583, frame p mean: 0.4483775496482849
loss_pred:0.026706255972385406, decouple_loss:0.04141426831483841
loss_pred:0.025823445990681648, decouple_loss:0.04174964502453804
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506046175956726, gen p mean: 0.8552782535552979, mean p set: 0.4506046175956726, frame p mean: 0.4505133628845215
loss_pred:0.027959588915109634, decouple_loss:0.04527311027050018
The modified gen p mean: 0.44976741075515747, gen p mean: 0.8600119352340698, mean p set: 0.4497673809528351, frame p mean: 0.44959738850593567
loss_pred:0.027169473469257355, decouple_loss:0.045125361531972885
The modified gen p mean: 0.449954628944397, gen p mean: 0.8502310514450073, mean p set: 0.44995465874671936, frame p mean: 0.4499357044696808
loss_pred:0.02490292862057686, decouple_loss:0.045328423380851746
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493391513824463, gen p mean: 0.847181499004364, mean p set: 0.4493391215801239, frame p mean: 0.44894424080848694
loss_pred:0.02560674026608467, decouple_loss:0.041254349052906036
The modified gen p mean: 0.44870680570602417, gen p mean: 0.8534175753593445, mean p set: 0.44870686531066895, frame p mean: 0.4485492706298828
loss_pred:0.02778131142258644, decouple_loss:0.04171636328101158
The modified gen p mean: 0.45017340779304504, gen p mean: 0.857868492603302, mean p set: 0.4501734673976898, frame p mean: 0.44954004883766174
loss_pred:0.025052329525351524, decouple_loss:0.0417155995965004
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513865113258362, gen p mean: 0.8506627082824707, mean p set: 0.45138660073280334, frame p mean: 0.4502531588077545
The modified gen p mean: 0.4506676495075226, gen p mean: 0.8481761813163757, mean p set: 0.45066767930984497, frame p mean: 0.450268030166626
loss_pred:0.02513454668223858, decouple_loss:0.039530158042907715
loss_pred:0.02459896169602871, decouple_loss:0.039577119052410126
The modified gen p mean: 0.4495089054107666, gen p mean: 0.853227972984314, mean p set: 0.4495089054107666, frame p mean: 0.44918251037597656
loss_pred:0.02571645751595497, decouple_loss:0.039903782308101654
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45114338397979736, gen p mean: 0.8464483618736267, mean p set: 0.451143354177475, frame p mean: 0.4498205780982971
loss_pred:0.026171110570430756, decouple_loss:0.037637270987033844
The modified gen p mean: 0.4493071734905243, gen p mean: 0.849838137626648, mean p set: 0.4493071436882019, frame p mean: 0.4481104910373688
loss_pred:0.025575563311576843, decouple_loss:0.03740495815873146
The modified gen p mean: 0.4499663710594177, gen p mean: 0.8533504009246826, mean p set: 0.44996631145477295, frame p mean: 0.4492467939853668
loss_pred:0.02386213093996048, decouple_loss:0.03773375600576401
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44908788800239563, gen p mean: 0.848840594291687, mean p set: 0.44908788800239563, frame p mean: 0.44875213503837585
loss_pred:0.025738319382071495, decouple_loss:0.03845708444714546
The modified gen p mean: 0.45061901211738586, gen p mean: 0.8438743352890015, mean p set: 0.4506189823150635, frame p mean: 0.4504995346069336
loss_pred:0.02600635401904583, decouple_loss:0.03996829688549042
The modified gen p mean: 0.44885310530662537, gen p mean: 0.8426496386528015, mean p set: 0.44885316491127014, frame p mean: 0.4483903646469116
loss_pred:0.02617880143225193, decouple_loss:0.039261024445295334
2023-04-16 23:45:08 testing...
The modified gen p mean: 0.4502691924571991, gen p mean: 0.3258760869503021, mean p set: 0.4502691626548767, frame p mean: 0.4499312937259674
loss_pred:0.16554121673107147, decouple_loss:0.07915371656417847
The modified gen p mean: 0.4500633478164673, gen p mean: 0.32688966393470764, mean p set: 0.4500633478164673, frame p mean: 0.4493577778339386
The modified gen p mean: 0.45035699009895325, gen p mean: 0.33048489689826965, mean p set: 0.45035696029663086, frame p mean: 0.4499579966068268
loss_pred:0.16339661180973053, decouple_loss:0.07993574440479279
loss_pred:0.1623183786869049, decouple_loss:0.08033551275730133
WV_0_PC_1_EH_1_PS_40, loss: 0.16774249076843262, avg_mse: 0.3152482211589813
current test mse: 0.315248
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44973650574684143, gen p mean: 0.8553974628448486, mean p set: 0.44973650574684143, frame p mean: 0.4492299258708954
loss_pred:0.025622373446822166, decouple_loss:0.03689011186361313
The modified gen p mean: 0.4511021077632904, gen p mean: 0.8498257994651794, mean p set: 0.451102077960968, frame p mean: 0.4510599970817566
loss_pred:0.02570553682744503, decouple_loss:0.036507900804281235
The modified gen p mean: 0.4506320059299469, gen p mean: 0.8491184711456299, mean p set: 0.4506319463253021, frame p mean: 0.45049306750297546
loss_pred:0.024606982246041298, decouple_loss:0.0364932082593441
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500381350517273, gen p mean: 0.8468335270881653, mean p set: 0.4500381648540497, frame p mean: 0.4492245614528656
loss_pred:0.024598799645900726, decouple_loss:0.0360196977853775
The modified gen p mean: 0.44988352060317993, gen p mean: 0.8450511693954468, mean p set: 0.44988352060317993, frame p mean: 0.4494709372520447
The modified gen p mean: 0.4512575566768646, gen p mean: 0.848507821559906, mean p set: 0.4512575566768646, frame p mean: 0.4502459764480591
loss_pred:0.024987882003188133, decouple_loss:0.035994481295347214
loss_pred:0.025337442755699158, decouple_loss:0.03539055213332176
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496990144252777, gen p mean: 0.8669785857200623, mean p set: 0.4496990144252777, frame p mean: 0.45012515783309937
The modified gen p mean: 0.4495888352394104, gen p mean: 0.8651853203773499, mean p set: 0.4495888352394104, frame p mean: 0.44966983795166016
loss_pred:0.025901956483721733, decouple_loss:0.03543385490775108
loss_pred:0.025880413129925728, decouple_loss:0.03538697957992554
The modified gen p mean: 0.4506154954433441, gen p mean: 0.8737816214561462, mean p set: 0.4506154954433441, frame p mean: 0.4498928487300873
loss_pred:0.025375621393322945, decouple_loss:0.03537663817405701
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498341977596283, gen p mean: 0.8590201139450073, mean p set: 0.4498342275619507, frame p mean: 0.4497186541557312
loss_pred:0.02547794207930565, decouple_loss:0.03366032615303993
The modified gen p mean: 0.4507182538509369, gen p mean: 0.8602593541145325, mean p set: 0.4507182538509369, frame p mean: 0.45006850361824036
loss_pred:0.02493848279118538, decouple_loss:0.033318035304546356
The modified gen p mean: 0.44919171929359436, gen p mean: 0.8565579652786255, mean p set: 0.4491916298866272, frame p mean: 0.4486727714538574
loss_pred:0.024831051006913185, decouple_loss:0.03347078710794449
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860947132110596, gen p mean: 0.8516101241111755, mean p set: 0.448609322309494, frame p mean: 0.44873884320259094
loss_pred:0.025459691882133484, decouple_loss:0.03195241466164589
The modified gen p mean: 0.4508231282234192, gen p mean: 0.8557840585708618, mean p set: 0.4508230984210968, frame p mean: 0.45082226395606995
The modified gen p mean: 0.4498307406902313, gen p mean: 0.8548230528831482, mean p set: 0.4498307406902313, frame p mean: 0.44966423511505127
loss_pred:0.026273038238286972, decouple_loss:0.03251006826758385
loss_pred:0.02432246133685112, decouple_loss:0.032590337097644806
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504147171974182, gen p mean: 0.8532001376152039, mean p set: 0.4504148066043854, frame p mean: 0.45037195086479187
loss_pred:0.02531707100570202, decouple_loss:0.0315965935587883
The modified gen p mean: 0.45006561279296875, gen p mean: 0.8602420687675476, mean p set: 0.45006564259529114, frame p mean: 0.4491707980632782
The modified gen p mean: 0.4491927921772003, gen p mean: 0.8608145117759705, mean p set: 0.4491928219795227, frame p mean: 0.44996610283851624
loss_pred:0.023852743208408356, decouple_loss:0.03166911005973816
loss_pred:0.02398611232638359, decouple_loss:0.031655408442020416
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498046934604645, gen p mean: 0.8581783771514893, mean p set: 0.4498046338558197, frame p mean: 0.4488844573497772
loss_pred:0.02304225042462349, decouple_loss:0.03110995516180992
The modified gen p mean: 0.4517152011394501, gen p mean: 0.8563176393508911, mean p set: 0.4517151713371277, frame p mean: 0.45066285133361816
loss_pred:0.0238204225897789, decouple_loss:0.0315457284450531
The modified gen p mean: 0.4502823054790497, gen p mean: 0.8641205430030823, mean p set: 0.4502823054790497, frame p mean: 0.4496632516384125
loss_pred:0.024136411026120186, decouple_loss:0.03157280758023262
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45073747634887695, gen p mean: 0.8552193641662598, mean p set: 0.45073747634887695, frame p mean: 0.44957050681114197
loss_pred:0.024698348715901375, decouple_loss:0.030370300635695457
The modified gen p mean: 0.449953556060791, gen p mean: 0.856073260307312, mean p set: 0.44995349645614624, frame p mean: 0.44958680868148804
loss_pred:0.02549920044839382, decouple_loss:0.03043445199728012
The modified gen p mean: 0.45086121559143066, gen p mean: 0.8535705208778381, mean p set: 0.4508611261844635, frame p mean: 0.4504096210002899
loss_pred:0.025249408558011055, decouple_loss:0.02991933934390545
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45056450366973877, gen p mean: 0.8651401996612549, mean p set: 0.45056453347206116, frame p mean: 0.45054563879966736
loss_pred:0.02534540370106697, decouple_loss:0.03004535846412182
The modified gen p mean: 0.4502556622028351, gen p mean: 0.8580595254898071, mean p set: 0.4502556622028351, frame p mean: 0.45002058148384094
loss_pred:0.024875428527593613, decouple_loss:0.029184363782405853
The modified gen p mean: 0.45130836963653564, gen p mean: 0.8729934692382812, mean p set: 0.4513084292411804, frame p mean: 0.45094457268714905
loss_pred:0.024365561082959175, decouple_loss:0.02949337102472782
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506498873233795, gen p mean: 0.8466965556144714, mean p set: 0.4506498873233795, frame p mean: 0.44993335008621216
loss_pred:0.025278817862272263, decouple_loss:0.030206436291337013
The modified gen p mean: 0.45020678639411926, gen p mean: 0.848293125629425, mean p set: 0.4502067267894745, frame p mean: 0.4503132402896881
loss_pred:0.023634204640984535, decouple_loss:0.030199019238352776
The modified gen p mean: 0.45014679431915283, gen p mean: 0.8537819981575012, mean p set: 0.45014673471450806, frame p mean: 0.44955793023109436
loss_pred:0.02392497844994068, decouple_loss:0.030487947165966034
2023-04-16 23:47:38 testing...
The modified gen p mean: 0.4502691626548767, gen p mean: 0.3240518569946289, mean p set: 0.4502691626548767, frame p mean: 0.4499312937259674
The modified gen p mean: 0.4500633180141449, gen p mean: 0.3250446021556854, mean p set: 0.4500633478164673, frame p mean: 0.4493577778339386
loss_pred:0.17074589431285858, decouple_loss:0.0718870684504509
The modified gen p mean: 0.45035699009895325, gen p mean: 0.3288571834564209, mean p set: 0.45035696029663086, frame p mean: 0.4499579966068268
loss_pred:0.16869790852069855, decouple_loss:0.07330257445573807
loss_pred:0.167794331908226, decouple_loss:0.07390178740024567
WV_0_PC_1_EH_1_PS_40, loss: 0.17273090779781342, avg_mse: 0.32970693707466125
current test mse: 0.329707