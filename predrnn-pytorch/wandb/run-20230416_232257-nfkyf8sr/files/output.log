After initialize model, args.img_channel:3
load model: /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_1_PS_40/model_2000.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
train_data_files nums: 41
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_09012020_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475942850112915, mean_press_set: 0.44759422540664673, frame_press_mean: 0.44739481806755066
loss_pred:0.023724863305687904, decouple_loss:0.009961373172700405
The generated pressure mean: 0.44824889302253723, mean_press_set: 0.44824886322021484, frame_press_mean: 0.4479665160179138
loss_pred:0.0214998796582222, decouple_loss:0.010144488885998726
The generated pressure mean: 0.4479469358921051, mean_press_set: 0.4479469656944275, frame_press_mean: 0.44709721207618713
loss_pred:0.02104620821774006, decouple_loss:0.01008243951946497
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485652446746826, mean_press_set: 0.4485653042793274, frame_press_mean: 0.44744592905044556
loss_pred:0.18777981400489807, decouple_loss:0.423864483833313
The generated pressure mean: 0.4486709535121918, mean_press_set: 0.4486709535121918, frame_press_mean: 0.4482673108577728
The generated pressure mean: 0.4482361972332001, mean_press_set: 0.4482361972332001, frame_press_mean: 0.4480740427970886
loss_pred:0.20506301522254944, decouple_loss:0.4252230226993561
loss_pred:0.18537084758281708, decouple_loss:0.4248742461204529
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469953179359436, mean_press_set: 0.4469953179359436, frame_press_mean: 0.4463701844215393The generated pressure mean: 0.44729676842689514, mean_press_set: 0.44729676842689514, frame_press_mean: 0.4471396207809448
The generated pressure mean: 0.44924309849739075, mean_press_set: 0.44924309849739075, frame_press_mean: 0.44878971576690674
loss_pred:0.11396080255508423, decouple_loss:0.83973628282547
loss_pred:0.11620013415813446, decouple_loss:0.8427504301071167
loss_pred:0.11767005920410156, decouple_loss:0.8433030843734741
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447751522064209, mean_press_set: 0.4477514624595642, frame_press_mean: 0.447624534368515
The generated pressure mean: 0.4478025436401367, mean_press_set: 0.4478025436401367, frame_press_mean: 0.44728830456733704
The generated pressure mean: 0.44739413261413574, mean_press_set: 0.44739410281181335, frame_press_mean: 0.44654789566993713loss_pred:0.08410856872797012, decouple_loss:0.7657003998756409
loss_pred:0.08011428266763687, decouple_loss:0.7633640766143799
loss_pred:0.08367125689983368, decouple_loss:0.7656846046447754
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485275149345398, mean_press_set: 0.4485274851322174, frame_press_mean: 0.4474717378616333
The generated pressure mean: 0.4479517340660095, mean_press_set: 0.44795170426368713, frame_press_mean: 0.4477708041667938
loss_pred:0.06945352256298065, decouple_loss:0.8507609963417053
loss_pred:0.06967560201883316, decouple_loss:0.8523062467575073
The generated pressure mean: 0.44800862669944763, mean_press_set: 0.44800853729248047, frame_press_mean: 0.4473319947719574
loss_pred:0.06581217050552368, decouple_loss:0.8501451015472412
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488697350025177, mean_press_set: 0.4488696753978729, frame_press_mean: 0.448632150888443
The generated pressure mean: 0.4479270279407501, mean_press_set: 0.4479270875453949, frame_press_mean: 0.44767966866493225
loss_pred:0.061098046600818634, decouple_loss:0.8246455788612366
loss_pred:0.05747168883681297, decouple_loss:0.8233050107955933
The generated pressure mean: 0.4483778774738312, mean_press_set: 0.4483778774738312, frame_press_mean: 0.44862696528434753
loss_pred:0.05927778407931328, decouple_loss:0.8254486918449402
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44937288761138916, mean_press_set: 0.44937291741371155, frame_press_mean: 0.448752224445343
The generated pressure mean: 0.44847285747528076, mean_press_set: 0.44847285747528076, frame_press_mean: 0.44802922010421753
loss_pred:0.05175267532467842, decouple_loss:0.7727544903755188
The generated pressure mean: 0.44877952337265015, mean_press_set: 0.44877946376800537, frame_press_mean: 0.44792836904525757
loss_pred:0.054431360214948654, decouple_loss:0.7714744210243225
loss_pred:0.04685240611433983, decouple_loss:0.7715557813644409
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44779157638549805, mean_press_set: 0.44779151678085327, frame_press_mean: 0.44686681032180786
The generated pressure mean: 0.4483802318572998, mean_press_set: 0.4483802020549774, frame_press_mean: 0.44825196266174316
loss_pred:0.045462705194950104, decouple_loss:0.7209856510162354
The generated pressure mean: 0.4492601752281189, mean_press_set: 0.44926023483276367, frame_press_mean: 0.4480963945388794
loss_pred:0.046502694487571716, decouple_loss:0.7183946967124939
loss_pred:0.04567139968276024, decouple_loss:0.7198504209518433
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471086263656616, mean_press_set: 0.447108656167984, frame_press_mean: 0.44773635268211365
The generated pressure mean: 0.44847583770751953, mean_press_set: 0.4484758675098419, frame_press_mean: 0.4480110704898834
The generated pressure mean: 0.44798827171325684, mean_press_set: 0.44798827171325684, frame_press_mean: 0.4481363296508789
loss_pred:0.04105827957391739, decouple_loss:0.6469265818595886
loss_pred:0.04098563641309738, decouple_loss:0.6467629671096802
loss_pred:0.04041504114866257, decouple_loss:0.6512656807899475
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44732150435447693, mean_press_set: 0.4473215639591217, frame_press_mean: 0.44675302505493164
The generated pressure mean: 0.4486168622970581, mean_press_set: 0.4486168920993805, frame_press_mean: 0.4485184848308563
loss_pred:0.04111682251095772, decouple_loss:0.5797288417816162
loss_pred:0.039712611585855484, decouple_loss:0.5779444575309753
The generated pressure mean: 0.4475266933441162, mean_press_set: 0.4475267231464386, frame_press_mean: 0.4469091594219208
loss_pred:0.03803201764822006, decouple_loss:0.5788054466247559
2023-04-16 23:26:03 testing...
The generated pressure mean: 0.4502691328525543, mean_press_set: 0.4502691626548767, frame_press_mean: 0.4499312937259674
loss_pred:0.1330585926771164, decouple_loss:0.4912976026535034
The generated pressure mean: 0.4500633478164673, mean_press_set: 0.4500633478164673, frame_press_mean: 0.4493577778339386
The generated pressure mean: 0.45035696029663086, mean_press_set: 0.45035696029663086, frame_press_mean: 0.4499579966068268
loss_pred:0.13112659752368927, decouple_loss:0.49213388562202454
loss_pred:0.13142824172973633, decouple_loss:0.49161380529403687
WV_0_PC_1_EH_1_PS_40, loss: 0.15645523369312286, avg_mse: 0.2231287658214569
current test mse: 0.223129
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44677627086639404, mean_press_set: 0.44677630066871643, frame_press_mean: 0.44658803939819336
The generated pressure mean: 0.44772064685821533, mean_press_set: 0.44772061705589294, frame_press_mean: 0.44686368107795715
The generated pressure mean: 0.44788962602615356, mean_press_set: 0.4478895962238312, frame_press_mean: 0.4473186135292053
loss_pred:0.03946446627378464, decouple_loss:0.4934688210487366
loss_pred:0.038343314081430435, decouple_loss:0.4913444221019745
loss_pred:0.0363023616373539, decouple_loss:0.4934830069541931
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44725942611694336, mean_press_set: 0.44725939631462097, frame_press_mean: 0.4468550682067871
The generated pressure mean: 0.44765228033065796, mean_press_set: 0.44765228033065796, frame_press_mean: 0.44667041301727295
The generated pressure mean: 0.44790732860565186, mean_press_set: 0.44790735840797424, frame_press_mean: 0.44733986258506775loss_pred:0.0380333848297596, decouple_loss:0.4390462636947632
loss_pred:0.03713880479335785, decouple_loss:0.4407556653022766
loss_pred:0.034967828541994095, decouple_loss:0.43944719433784485
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470299780368805, mean_press_set: 0.4470299780368805, frame_press_mean: 0.44710615277290344
loss_pred:0.03380516916513443, decouple_loss:0.38629570603370667
The generated pressure mean: 0.44864293932914734, mean_press_set: 0.4486429989337921, frame_press_mean: 0.4486229717731476
The generated pressure mean: 0.4475744366645813, mean_press_set: 0.4475743770599365, frame_press_mean: 0.4468880593776703
loss_pred:0.03410615399479866, decouple_loss:0.39326211810112
loss_pred:0.0339912585914135, decouple_loss:0.38638630509376526
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44939661026000977, mean_press_set: 0.4493965804576874, frame_press_mean: 0.44860389828681946
The generated pressure mean: 0.4479384422302246, mean_press_set: 0.44793838262557983, frame_press_mean: 0.44749340415000916
loss_pred:0.03436359390616417, decouple_loss:0.3116645812988281
loss_pred:0.033974699676036835, decouple_loss:0.31137317419052124
The generated pressure mean: 0.4491843581199646, mean_press_set: 0.449184387922287, frame_press_mean: 0.44851380586624146
loss_pred:0.03202619403600693, decouple_loss:0.31150272488594055
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474048912525177, mean_press_set: 0.4474049210548401, frame_press_mean: 0.44710683822631836
The generated pressure mean: 0.44676467776298523, mean_press_set: 0.44676467776298523, frame_press_mean: 0.4468049108982086
loss_pred:0.030268888920545578, decouple_loss:0.30351734161376953
loss_pred:0.03013000451028347, decouple_loss:0.29546380043029785
The generated pressure mean: 0.44832685589790344, mean_press_set: 0.44832685589790344, frame_press_mean: 0.4475933909416199
loss_pred:0.031110310927033424, decouple_loss:0.3058154284954071
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44811123609542847, mean_press_set: 0.4481112062931061, frame_press_mean: 0.4472654461860657The generated pressure mean: 0.44827136397361755, mean_press_set: 0.44827136397361755, frame_press_mean: 0.44716206192970276
The generated pressure mean: 0.44756677746772766, mean_press_set: 0.44756677746772766, frame_press_mean: 0.4473131597042084
loss_pred:0.031246313825249672, decouple_loss:0.3212467133998871loss_pred:0.03320549800992012, decouple_loss:0.31486207246780396
loss_pred:0.030811883509159088, decouple_loss:0.3289104998111725
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44836175441741943, mean_press_set: 0.44836175441741943, frame_press_mean: 0.4475778043270111
The generated pressure mean: 0.44847920536994934, mean_press_set: 0.4484791159629822, frame_press_mean: 0.44783538579940796
loss_pred:0.03044453263282776, decouple_loss:0.2444671392440796
loss_pred:0.03017362952232361, decouple_loss:0.24326778948307037
The generated pressure mean: 0.4474025368690491, mean_press_set: 0.4474024176597595, frame_press_mean: 0.44645047187805176
loss_pred:0.03257903456687927, decouple_loss:0.24819716811180115
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44718122482299805, mean_press_set: 0.4471812844276428, frame_press_mean: 0.4476977586746216
The generated pressure mean: 0.4470025300979614, mean_press_set: 0.44700247049331665, frame_press_mean: 0.4464013874530792
loss_pred:0.028991810977458954, decouple_loss:0.23061856627464294
loss_pred:0.029104186221957207, decouple_loss:0.23760280013084412
The generated pressure mean: 0.4476914405822754, mean_press_set: 0.4476914703845978, frame_press_mean: 0.44727617502212524
loss_pred:0.03538727015256882, decouple_loss:0.23631393909454346
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490177035331726, mean_press_set: 0.4490176737308502, frame_press_mean: 0.4481707215309143
The generated pressure mean: 0.44675156474113464, mean_press_set: 0.44675159454345703, frame_press_mean: 0.44659629464149475
The generated pressure mean: 0.44719958305358887, mean_press_set: 0.4471994936466217, frame_press_mean: 0.44681623578071594
loss_pred:0.029864473268389702, decouple_loss:0.22282429039478302
loss_pred:0.03623113036155701, decouple_loss:0.23035496473312378
loss_pred:0.030311180278658867, decouple_loss:0.2317523956298828
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489627778530121, mean_press_set: 0.4489628076553345, frame_press_mean: 0.448603093624115
The generated pressure mean: 0.4477386474609375, mean_press_set: 0.4477385878562927, frame_press_mean: 0.4470811188220978
The generated pressure mean: 0.44756922125816345, mean_press_set: 0.44756919145584106, frame_press_mean: 0.44717487692832947
loss_pred:0.028317952528595924, decouple_loss:0.16802050173282623
loss_pred:0.03069065511226654, decouple_loss:0.17233321070671082
loss_pred:0.03161562234163284, decouple_loss:0.1701376587152481
2023-04-16 23:27:54 testing...
The generated pressure mean: 0.4502691328525543, mean_press_set: 0.4502691626548767, frame_press_mean: 0.4499312937259674
The generated pressure mean: 0.45035699009895325, mean_press_set: 0.45035696029663086, frame_press_mean: 0.4499579966068268
The generated pressure mean: 0.4500633478164673, mean_press_set: 0.4500633478164673, frame_press_mean: 0.4493577778339386
loss_pred:0.14100021123886108, decouple_loss:0.1852356493473053
loss_pred:0.13835251331329346, decouple_loss:0.18625390529632568
loss_pred:0.13902193307876587, decouple_loss:0.18812331557273865
WV_0_PC_1_EH_1_PS_40, loss: 0.14878509938716888, avg_mse: 0.25081661343574524
current test mse: 0.250817
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495420455932617, mean_press_set: 0.4495420455932617, frame_press_mean: 0.44910958409309387
loss_pred:0.028424501419067383, decouple_loss:0.15568585693836212
The generated pressure mean: 0.44843214750289917, mean_press_set: 0.44843214750289917, frame_press_mean: 0.4481702446937561
loss_pred:0.03046012483537197, decouple_loss:0.15583021938800812
The generated pressure mean: 0.44798383116722107, mean_press_set: 0.44798383116722107, frame_press_mean: 0.4474080801010132
loss_pred:0.030136611312627792, decouple_loss:0.1561400294303894
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44858700037002563, mean_press_set: 0.4485870599746704, frame_press_mean: 0.44808289408683777
The generated pressure mean: 0.4489098787307739, mean_press_set: 0.4489099383354187, frame_press_mean: 0.4484051764011383
The generated pressure mean: 0.44784215092658997, mean_press_set: 0.44784215092658997, frame_press_mean: 0.4479488730430603
loss_pred:0.02676924504339695, decouple_loss:0.14356403052806854
loss_pred:0.027900509536266327, decouple_loss:0.13848108053207397
loss_pred:0.028513047844171524, decouple_loss:0.14598217606544495
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44810155034065247, mean_press_set: 0.4481014907360077, frame_press_mean: 0.4480302929878235
The generated pressure mean: 0.4484385848045349, mean_press_set: 0.4484385848045349, frame_press_mean: 0.44765332341194153
The generated pressure mean: 0.44907814264297485, mean_press_set: 0.4490780532360077, frame_press_mean: 0.4482310712337494
loss_pred:0.029625020921230316, decouple_loss:0.12293042242527008
loss_pred:0.030351731926202774, decouple_loss:0.12167275696992874
loss_pred:0.02805774100124836, decouple_loss:0.12132174521684647
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481188654899597, mean_press_set: 0.44811877608299255, frame_press_mean: 0.44806915521621704
loss_pred:0.02844233065843582, decouple_loss:0.1139659658074379
The generated pressure mean: 0.4479498565196991, mean_press_set: 0.4479498863220215, frame_press_mean: 0.44777098298072815
The generated pressure mean: 0.4498659372329712, mean_press_set: 0.4498658776283264, frame_press_mean: 0.44923800230026245
loss_pred:0.02715192921459675, decouple_loss:0.1143108606338501
loss_pred:0.026897072792053223, decouple_loss:0.11466969549655914
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485073983669281, mean_press_set: 0.4485073983669281, frame_press_mean: 0.4482702314853668
The generated pressure mean: 0.44793596863746643, mean_press_set: 0.44793590903282166, frame_press_mean: 0.4476782977581024
loss_pred:0.027578890323638916, decouple_loss:0.10473521798849106
The generated pressure mean: 0.4495067596435547, mean_press_set: 0.4495067000389099, frame_press_mean: 0.4489174783229828
loss_pred:0.028002751991152763, decouple_loss:0.10332082957029343
loss_pred:0.028173811733722687, decouple_loss:0.10123009234666824
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486030042171478, mean_press_set: 0.44860297441482544, frame_press_mean: 0.44822970032691956
The generated pressure mean: 0.44921019673347473, mean_press_set: 0.44921019673347473, frame_press_mean: 0.4484805166721344
The generated pressure mean: 0.44894081354141235, mean_press_set: 0.44894084334373474, frame_press_mean: 0.44822779297828674
loss_pred:0.027389464899897575, decouple_loss:0.09511687606573105
loss_pred:0.02713618613779545, decouple_loss:0.09637495875358582
loss_pred:0.027124281972646713, decouple_loss:0.09774171561002731
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482528269290924, mean_press_set: 0.4482528567314148, frame_press_mean: 0.4478890895843506
The generated pressure mean: 0.4486045241355896, mean_press_set: 0.4486044645309448, frame_press_mean: 0.44764646887779236
loss_pred:0.026311861351132393, decouple_loss:0.09557898342609406
The generated pressure mean: 0.44759491086006165, mean_press_set: 0.44759488105773926, frame_press_mean: 0.4474624991416931
loss_pred:0.026052284985780716, decouple_loss:0.09227049350738525
loss_pred:0.028233520686626434, decouple_loss:0.09321948885917664
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485081136226654, mean_press_set: 0.4485081434249878, frame_press_mean: 0.44835636019706726
The generated pressure mean: 0.44803714752197266, mean_press_set: 0.44803711771965027, frame_press_mean: 0.4476739466190338
loss_pred:0.027273882180452347, decouple_loss:0.08398836106061935
The generated pressure mean: 0.447716623544693, mean_press_set: 0.44771671295166016, frame_press_mean: 0.4472588002681732
loss_pred:0.02865065075457096, decouple_loss:0.08244863897562027
loss_pred:0.029523056000471115, decouple_loss:0.08624967187643051
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44897952675819397, mean_press_set: 0.4489794969558716, frame_press_mean: 0.44775480031967163
The generated pressure mean: 0.44913309812545776, mean_press_set: 0.449133038520813, frame_press_mean: 0.4486270546913147
loss_pred:0.026275169104337692, decouple_loss:0.07526710629463196
The generated pressure mean: 0.4497954249382019, mean_press_set: 0.4497953951358795, frame_press_mean: 0.44928455352783203
loss_pred:0.025564853101968765, decouple_loss:0.07563222199678421
loss_pred:0.027359740808606148, decouple_loss:0.0778295025229454
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477807581424713, mean_press_set: 0.4477807283401489, frame_press_mean: 0.44739460945129395
The generated pressure mean: 0.4492572247982025, mean_press_set: 0.4492571949958801, frame_press_mean: 0.44882041215896606
The generated pressure mean: 0.448626309633255, mean_press_set: 0.4486263692378998, frame_press_mean: 0.4474411904811859
loss_pred:0.03042427822947502, decouple_loss:0.08088023215532303
loss_pred:0.028650691732764244, decouple_loss:0.07298853993415833
loss_pred:0.02763153240084648, decouple_loss:0.0780469998717308
2023-04-16 23:30:25 testing...
The generated pressure mean: 0.4502691626548767, mean_press_set: 0.4502691626548767, frame_press_mean: 0.4499312937259674
The generated pressure mean: 0.4500633478164673, mean_press_set: 0.4500633478164673, frame_press_mean: 0.4493577778339386
The generated pressure mean: 0.45035699009895325, mean_press_set: 0.45035696029663086, frame_press_mean: 0.4499579966068268
loss_pred:0.15125732123851776, decouple_loss:0.12879660725593567
loss_pred:0.14918719232082367, decouple_loss:0.13393010199069977
loss_pred:0.14808885753154755, decouple_loss:0.12967117130756378
WV_0_PC_1_EH_1_PS_40, loss: 0.15605109930038452, avg_mse: 0.2844233214855194
current test mse: 0.284423
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479329288005829, mean_press_set: 0.4479329288005829, frame_press_mean: 0.44775086641311646
loss_pred:0.025048112496733665, decouple_loss:0.06610795110464096
The generated pressure mean: 0.4482114613056183, mean_press_set: 0.4482114315032959, frame_press_mean: 0.4477621912956238
The generated pressure mean: 0.4488583207130432, mean_press_set: 0.4488582909107208, frame_press_mean: 0.44862663745880127
loss_pred:0.02555064857006073, decouple_loss:0.06631886214017868
loss_pred:0.02575625292956829, decouple_loss:0.06714318692684174
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44777730107307434, mean_press_set: 0.44777724146842957, frame_press_mean: 0.44734543561935425
The generated pressure mean: 0.44776982069015503, mean_press_set: 0.44776979088783264, frame_press_mean: 0.44792357087135315
loss_pred:0.026744553819298744, decouple_loss:0.06290823966264725
The generated pressure mean: 0.4488693177700043, mean_press_set: 0.4488692879676819, frame_press_mean: 0.44842028617858887
loss_pred:0.02703992836177349, decouple_loss:0.061573177576065063
loss_pred:0.02744242176413536, decouple_loss:0.06324632465839386
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44882798194885254, mean_press_set: 0.4488280117511749, frame_press_mean: 0.448022723197937
The generated pressure mean: 0.44784271717071533, mean_press_set: 0.44784268736839294, frame_press_mean: 0.4475926160812378
The generated pressure mean: 0.4488556683063507, mean_press_set: 0.4488556683063507, frame_press_mean: 0.4478098452091217
loss_pred:0.02699659764766693, decouple_loss:0.0606541708111763
loss_pred:0.027002055197954178, decouple_loss:0.060822851955890656
loss_pred:0.0262906551361084, decouple_loss:0.06562867760658264
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481619596481323, mean_press_set: 0.44816192984580994, frame_press_mean: 0.4475092887878418
The generated pressure mean: 0.4485604465007782, mean_press_set: 0.44856035709381104, frame_press_mean: 0.4485723078250885
The generated pressure mean: 0.44865700602531433, mean_press_set: 0.44865697622299194, frame_press_mean: 0.44809916615486145
loss_pred:0.02502814307808876, decouple_loss:0.059932246804237366
loss_pred:0.026222167536616325, decouple_loss:0.060423657298088074
loss_pred:0.025489022955298424, decouple_loss:0.0596892349421978
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44763511419296265, mean_press_set: 0.44763508439064026, frame_press_mean: 0.4475916922092438
The generated pressure mean: 0.4470933675765991, mean_press_set: 0.4470933675765991, frame_press_mean: 0.44728270173072815
The generated pressure mean: 0.44799908995628357, mean_press_set: 0.4479990005493164, frame_press_mean: 0.4471653401851654
loss_pred:0.023763056844472885, decouple_loss:0.0529375784099102
loss_pred:0.025493277236819267, decouple_loss:0.05424670875072479
loss_pred:0.023892240598797798, decouple_loss:0.0549323596060276
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488586187362671, mean_press_set: 0.4488586187362671, frame_press_mean: 0.44794923067092896
loss_pred:0.025554338470101357, decouple_loss:0.05308028310537338
The generated pressure mean: 0.4475710988044739, mean_press_set: 0.4475710391998291, frame_press_mean: 0.44680577516555786
The generated pressure mean: 0.44741255044937134, mean_press_set: 0.4474125802516937, frame_press_mean: 0.44735512137413025
loss_pred:0.024911288172006607, decouple_loss:0.05441201478242874
loss_pred:0.024501901119947433, decouple_loss:0.05345998331904411
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484415054321289, mean_press_set: 0.44844159483909607, frame_press_mean: 0.44713908433914185
loss_pred:0.02542659267783165, decouple_loss:0.06100388243794441
The generated pressure mean: 0.4488039016723633, mean_press_set: 0.4488038718700409, frame_press_mean: 0.44756758213043213
The generated pressure mean: 0.44812890887260437, mean_press_set: 0.44812890887260437, frame_press_mean: 0.44742193818092346
loss_pred:0.02409815974533558, decouple_loss:0.061060305684804916
loss_pred:0.025527073070406914, decouple_loss:0.057333722710609436
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490537643432617, mean_press_set: 0.44905373454093933, frame_press_mean: 0.448464035987854
The generated pressure mean: 0.4477351903915405, mean_press_set: 0.44773516058921814, frame_press_mean: 0.44728806614875793
loss_pred:0.024715567007660866, decouple_loss:0.05713089928030968
The generated pressure mean: 0.4489966928958893, mean_press_set: 0.4489966928958893, frame_press_mean: 0.44859832525253296
loss_pred:0.02617724798619747, decouple_loss:0.05494517832994461
loss_pred:0.02570320852100849, decouple_loss:0.0561111718416214
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44870445132255554, mean_press_set: 0.4487045109272003, frame_press_mean: 0.44813379645347595
The generated pressure mean: 0.4477514326572418, mean_press_set: 0.4477514326572418, frame_press_mean: 0.4482693076133728
The generated pressure mean: 0.4489799439907074, mean_press_set: 0.4489799737930298, frame_press_mean: 0.4481198489665985
loss_pred:0.02552906610071659, decouple_loss:0.04919538274407387
loss_pred:0.024852827191352844, decouple_loss:0.0494534969329834
loss_pred:0.02311132289469242, decouple_loss:0.05251653864979744
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44825831055641174, mean_press_set: 0.44825834035873413, frame_press_mean: 0.447308748960495
The generated pressure mean: 0.4477946162223816, mean_press_set: 0.4477945566177368, frame_press_mean: 0.44740721583366394
loss_pred:0.024679439142346382, decouple_loss:0.04361161217093468
The generated pressure mean: 0.44863519072532654, mean_press_set: 0.4486351013183594, frame_press_mean: 0.44836336374282837
loss_pred:0.024156251922249794, decouple_loss:0.043498799204826355
loss_pred:0.02473204955458641, decouple_loss:0.043004196137189865
2023-04-16 23:32:15 testing...
The generated pressure mean: 0.4502691626548767, mean_press_set: 0.4502691626548767, frame_press_mean: 0.4499312937259674
The generated pressure mean: 0.4500633478164673, mean_press_set: 0.4500633478164673, frame_press_mean: 0.4493577778339386
The generated pressure mean: 0.45035699009895325, mean_press_set: 0.45035696029663086, frame_press_mean: 0.4499579966068268
loss_pred:0.15880779922008514, decouple_loss:0.10321328788995743
loss_pred:0.15667372941970825, decouple_loss:0.10772649943828583
loss_pred:0.15533359348773956, decouple_loss:0.10406969487667084
WV_0_PC_1_EH_1_PS_40, loss: 0.16218852996826172, avg_mse: 0.3020586669445038
current test mse: 0.302059
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44880393147468567, mean_press_set: 0.4488039016723633, frame_press_mean: 0.44818365573883057
loss_pred:0.02270013652741909, decouple_loss:0.043008726090192795
The generated pressure mean: 0.44775012135505676, mean_press_set: 0.4477500915527344, frame_press_mean: 0.44750887155532837
loss_pred:0.02422453463077545, decouple_loss:0.041826676577329636
The generated pressure mean: 0.44845250248908997, mean_press_set: 0.4484524726867676, frame_press_mean: 0.4479449987411499
loss_pred:0.02427028864622116, decouple_loss:0.04195453226566315
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44887542724609375, mean_press_set: 0.448875367641449, frame_press_mean: 0.4484129250049591
The generated pressure mean: 0.44763922691345215, mean_press_set: 0.4476391673088074, frame_press_mean: 0.4478142261505127
The generated pressure mean: 0.4498292803764343, mean_press_set: 0.4498293101787567, frame_press_mean: 0.4488341808319092
loss_pred:0.024782653898000717, decouple_loss:0.042877934873104095
loss_pred:0.023252414539456367, decouple_loss:0.04101242125034332
loss_pred:0.024670574814081192, decouple_loss:0.041620053350925446
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44859424233436584, mean_press_set: 0.44859424233436584, frame_press_mean: 0.4480851888656616
The generated pressure mean: 0.4488346576690674, mean_press_set: 0.4488346576690674, frame_press_mean: 0.4487559199333191
The generated pressure mean: 0.4478446841239929, mean_press_set: 0.4478446841239929, frame_press_mean: 0.4480290412902832
loss_pred:0.0252260472625494, decouple_loss:0.03667610511183739
loss_pred:0.025206930935382843, decouple_loss:0.03863794729113579
loss_pred:0.025077687576413155, decouple_loss:0.03748391941189766
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44691920280456543, mean_press_set: 0.44691917300224304, frame_press_mean: 0.4467465877532959
loss_pred:0.02471732720732689, decouple_loss:0.041391968727111816
The generated pressure mean: 0.44841113686561584, mean_press_set: 0.44841110706329346, frame_press_mean: 0.447671115398407
The generated pressure mean: 0.449961394071579, mean_press_set: 0.4499613046646118, frame_press_mean: 0.4489677846431732
loss_pred:0.024785442277789116, decouple_loss:0.04030916839838028
loss_pred:0.02487974800169468, decouple_loss:0.0374189056456089
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44738274812698364, mean_press_set: 0.44738268852233887, frame_press_mean: 0.4472012221813202
loss_pred:0.025938913226127625, decouple_loss:0.040721628814935684
The generated pressure mean: 0.44899433851242065, mean_press_set: 0.4489942789077759, frame_press_mean: 0.44845283031463623
The generated pressure mean: 0.44895458221435547, mean_press_set: 0.44895458221435547, frame_press_mean: 0.44826439023017883
loss_pred:0.024617260321974754, decouple_loss:0.04315797612071037
loss_pred:0.023648224771022797, decouple_loss:0.04273548349738121
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481569826602936, mean_press_set: 0.44815701246261597, frame_press_mean: 0.44709402322769165
The generated pressure mean: 0.44734877347946167, mean_press_set: 0.4473487436771393, frame_press_mean: 0.44662317633628845
loss_pred:0.025421489030122757, decouple_loss:0.04583385959267616
The generated pressure mean: 0.4496593475341797, mean_press_set: 0.4496593773365021, frame_press_mean: 0.4495544135570526
loss_pred:0.025533968582749367, decouple_loss:0.046569209545850754
loss_pred:0.023463116958737373, decouple_loss:0.040823809802532196
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474049508571625, mean_press_set: 0.44740498065948486, frame_press_mean: 0.447248250246048
The generated pressure mean: 0.44826212525367737, mean_press_set: 0.44826218485832214, frame_press_mean: 0.4483085870742798
loss_pred:0.025450101122260094, decouple_loss:0.03977493569254875
The generated pressure mean: 0.4469338655471802, mean_press_set: 0.44693389534950256, frame_press_mean: 0.4462693929672241
loss_pred:0.02431308664381504, decouple_loss:0.03632669523358345
loss_pred:0.0245484858751297, decouple_loss:0.03963597118854523
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484674632549286, mean_press_set: 0.44846752285957336, frame_press_mean: 0.44766971468925476
loss_pred:0.022643228992819786, decouple_loss:0.03340097516775131
The generated pressure mean: 0.44813868403434753, mean_press_set: 0.44813862442970276, frame_press_mean: 0.44772255420684814
The generated pressure mean: 0.4485248625278473, mean_press_set: 0.4485248327255249, frame_press_mean: 0.4479621648788452
loss_pred:0.02620786614716053, decouple_loss:0.03572167828679085
loss_pred:0.02360839955508709, decouple_loss:0.03284789249300957
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449484258890152, mean_press_set: 0.449484258890152, frame_press_mean: 0.4489623010158539
The generated pressure mean: 0.4486897587776184, mean_press_set: 0.4486897885799408, frame_press_mean: 0.44801974296569824
The generated pressure mean: 0.4484281539916992, mean_press_set: 0.4484281837940216, frame_press_mean: 0.4479350745677948
loss_pred:0.025442223995923996, decouple_loss:0.03180014714598656
loss_pred:0.025316545739769936, decouple_loss:0.030484292656183243
loss_pred:0.02518601343035698, decouple_loss:0.02869778871536255
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447682648897171, mean_press_set: 0.4476827085018158, frame_press_mean: 0.4474979639053345
loss_pred:0.024377994239330292, decouple_loss:0.026256946846842766
The generated pressure mean: 0.4473954439163208, mean_press_set: 0.4473954439163208, frame_press_mean: 0.4471561908721924
The generated pressure mean: 0.4481085538864136, mean_press_set: 0.44810861349105835, frame_press_mean: 0.4476035535335541
loss_pred:0.026101499795913696, decouple_loss:0.027606014162302017
loss_pred:0.023727592080831528, decouple_loss:0.026551950722932816
2023-04-16 23:34:39 testing...
The generated pressure mean: 0.4502691328525543, mean_press_set: 0.4502691626548767, frame_press_mean: 0.4499312937259674
The generated pressure mean: 0.4500633478164673, mean_press_set: 0.4500633478164673, frame_press_mean: 0.4493577778339386
loss_pred:0.16738077998161316, decouple_loss:0.08845452964305878
The generated pressure mean: 0.45035699009895325, mean_press_set: 0.45035696029663086, frame_press_mean: 0.4499579966068268
loss_pred:0.16534589231014252, decouple_loss:0.0927281454205513
loss_pred:0.16373766958713531, decouple_loss:0.08993194997310638
WV_0_PC_1_EH_1_PS_40, loss: 0.17000669240951538, avg_mse: 0.3250497877597809
current test mse: 0.32505