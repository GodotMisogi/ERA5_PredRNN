After initialize model, args.img_channel:3
load model: /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_1_PS_40/model_2000.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
train_data_files nums: 41
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_09012020_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44819769263267517, mean_press_set: 0.44819772243499756
loss_pred:0.023506272584199905, decouple_loss:0.00989450328052044
The generated pressure mean: 0.4474519193172455, mean_press_set: 0.4474518895149231
loss_pred:0.022794222459197044, decouple_loss:0.010000692680478096
The generated pressure mean: 0.4475582242012024, mean_press_set: 0.4475582242012024
loss_pred:0.02082163281738758, decouple_loss:0.009948264807462692
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44850224256515503, mean_press_set: 0.44850221276283264
The generated pressure mean: 0.44735094904899597, mean_press_set: 0.44735097885131836
The generated pressure mean: 0.44677969813346863, mean_press_set: 0.4467797577381134
loss_pred:0.1992671936750412, decouple_loss:0.4576146900653839
loss_pred:0.19598637521266937, decouple_loss:0.4570891857147217
loss_pred:0.19649946689605713, decouple_loss:0.4560713469982147
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44701915979385376, mean_press_set: 0.44701918959617615
The generated pressure mean: 0.4473434090614319, mean_press_set: 0.4473433792591095
loss_pred:0.14020006358623505, decouple_loss:0.841845691204071
loss_pred:0.1491258442401886, decouple_loss:0.8425588011741638
The generated pressure mean: 0.44781917333602905, mean_press_set: 0.44781920313835144
loss_pred:0.13670998811721802, decouple_loss:0.8405953049659729
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44718366861343384, mean_press_set: 0.4471836984157562
loss_pred:0.08647941797971725, decouple_loss:0.8042609691619873
The generated pressure mean: 0.44767504930496216, mean_press_set: 0.44767507910728455
The generated pressure mean: 0.4477064609527588, mean_press_set: 0.4477064609527588
loss_pred:0.08375800400972366, decouple_loss:0.803350567817688
loss_pred:0.08820363879203796, decouple_loss:0.8054491281509399
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475628137588501, mean_press_set: 0.4475627839565277
loss_pred:0.07131201773881912, decouple_loss:0.7308644652366638
The generated pressure mean: 0.4493057429790497, mean_press_set: 0.44930580258369446
The generated pressure mean: 0.4475858807563782, mean_press_set: 0.447585791349411
loss_pred:0.07401080429553986, decouple_loss:0.7303445339202881
loss_pred:0.07282577455043793, decouple_loss:0.7289570569992065
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44654420018196106, mean_press_set: 0.4465442895889282
loss_pred:0.06920657306909561, decouple_loss:0.6976063251495361
The generated pressure mean: 0.4475339949131012, mean_press_set: 0.4475339949131012
The generated pressure mean: 0.44692403078079224, mean_press_set: 0.44692397117614746
loss_pred:0.06722210347652435, decouple_loss:0.6937617659568787
loss_pred:0.07056351006031036, decouple_loss:0.6956873536109924
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466511309146881, mean_press_set: 0.4466512203216553
loss_pred:0.06435578316450119, decouple_loss:0.5179986357688904
The generated pressure mean: 0.448291152715683, mean_press_set: 0.44829118251800537
The generated pressure mean: 0.4472808539867401, mean_press_set: 0.4472809433937073
loss_pred:0.06399057060480118, decouple_loss:0.5193433165550232
loss_pred:0.06471139937639236, decouple_loss:0.5195779204368591
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476586580276489, mean_press_set: 0.4476585388183594
loss_pred:0.05833783000707626, decouple_loss:0.4735296368598938
The generated pressure mean: 0.4478382468223572, mean_press_set: 0.4478381872177124
The generated pressure mean: 0.4466211199760437, mean_press_set: 0.4466211497783661
loss_pred:0.06162416189908981, decouple_loss:0.47330906987190247
loss_pred:0.05909214913845062, decouple_loss:0.4735202193260193
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470230042934418, mean_press_set: 0.44702303409576416
loss_pred:0.05094844102859497, decouple_loss:0.4350561499595642
The generated pressure mean: 0.44734594225883484, mean_press_set: 0.4473459720611572
The generated pressure mean: 0.44772765040397644, mean_press_set: 0.44772762060165405
loss_pred:0.055008094757795334, decouple_loss:0.43462881445884705
loss_pred:0.050371844321489334, decouple_loss:0.43522781133651733
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44738978147506714, mean_press_set: 0.44738972187042236
loss_pred:0.051328666508197784, decouple_loss:0.3553922474384308
The generated pressure mean: 0.44757241010665894, mean_press_set: 0.4475724399089813
The generated pressure mean: 0.4470657408237457, mean_press_set: 0.4470658302307129
loss_pred:0.04799409955739975, decouple_loss:0.35533854365348816
loss_pred:0.0507667139172554, decouple_loss:0.35599109530448914
2023-04-16 23:00:30 testing...
The generated pressure mean: 0.4502691626548767, mean_press_set: 0.4502691626548767
The generated pressure mean: 0.45035699009895325, mean_press_set: 0.45035696029663086
The generated pressure mean: 0.4500633478164673, mean_press_set: 0.4500633478164673
loss_pred:0.1383337527513504, decouple_loss:0.31428489089012146
loss_pred:0.13678815960884094, decouple_loss:0.3143969178199768
loss_pred:0.1377066969871521, decouple_loss:0.31410491466522217
WV_0_PC_1_EH_1_PS_40, loss: 0.15332263708114624, avg_mse: 0.18771983683109283
current test mse: 0.18772
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479914605617523, mean_press_set: 0.4479915201663971
The generated pressure mean: 0.44718730449676514, mean_press_set: 0.44718724489212036
The generated pressure mean: 0.44812750816345215, mean_press_set: 0.4481275677680969
loss_pred:0.04668391868472099, decouple_loss:0.294767826795578
loss_pred:0.04923457279801369, decouple_loss:0.29439234733581543
loss_pred:0.05170513316988945, decouple_loss:0.2952301502227783
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485701620578766, mean_press_set: 0.448570191860199
The generated pressure mean: 0.44780364632606506, mean_press_set: 0.4478035867214203
loss_pred:0.04693105071783066, decouple_loss:0.2375439554452896
loss_pred:0.045638229697942734, decouple_loss:0.23719920217990875
The generated pressure mean: 0.44783174991607666, mean_press_set: 0.44783177971839905
loss_pred:0.0456605926156044, decouple_loss:0.23779624700546265
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44846251606941223, mean_press_set: 0.44846251606941223
The generated pressure mean: 0.4483037292957306, mean_press_set: 0.4483036994934082loss_pred:0.04251600801944733, decouple_loss:0.204708069562912
The generated pressure mean: 0.44724246859550476, mean_press_set: 0.44724246859550476
loss_pred:0.04278786852955818, decouple_loss:0.20436882972717285
loss_pred:0.04452270641922951, decouple_loss:0.2042948454618454
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44673141837120056, mean_press_set: 0.44673141837120056
loss_pred:0.0454583540558815, decouple_loss:0.19005243480205536
The generated pressure mean: 0.4476762115955353, mean_press_set: 0.4476762115955353
The generated pressure mean: 0.44731974601745605, mean_press_set: 0.44731974601745605
loss_pred:0.038440410047769547, decouple_loss:0.19174444675445557
loss_pred:0.041523661464452744, decouple_loss:0.18974405527114868
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465164542198181, mean_press_set: 0.44651639461517334
The generated pressure mean: 0.44652259349823, mean_press_set: 0.4465225338935852
loss_pred:0.04312596842646599, decouple_loss:0.19584421813488007
loss_pred:0.04273391142487526, decouple_loss:0.195625901222229
The generated pressure mean: 0.44890260696411133, mean_press_set: 0.4489026963710785
loss_pred:0.042700767517089844, decouple_loss:0.19645613431930542
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44833290576934814, mean_press_set: 0.44833290576934814
The generated pressure mean: 0.4470011293888092, mean_press_set: 0.44700121879577637
loss_pred:0.04614277184009552, decouple_loss:0.16453216969966888
The generated pressure mean: 0.4474363923072815, mean_press_set: 0.4474363923072815
loss_pred:0.044284623116254807, decouple_loss:0.16461396217346191
loss_pred:0.04163604974746704, decouple_loss:0.16411899030208588
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475935995578766, mean_press_set: 0.447593629360199
loss_pred:0.040284398943185806, decouple_loss:0.1716911792755127
The generated pressure mean: 0.44736889004707336, mean_press_set: 0.447368860244751
The generated pressure mean: 0.44724223017692566, mean_press_set: 0.44724223017692566
loss_pred:0.040515363216400146, decouple_loss:0.17344264686107635
loss_pred:0.039242010563611984, decouple_loss:0.17215044796466827
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446580171585083, mean_press_set: 0.44658011198043823
loss_pred:0.04173838347196579, decouple_loss:0.14763164520263672
The generated pressure mean: 0.4465042054653168, mean_press_set: 0.446504145860672
The generated pressure mean: 0.4480697810649872, mean_press_set: 0.44806966185569763
loss_pred:0.04182271286845207, decouple_loss:0.14788909256458282
loss_pred:0.04090429097414017, decouple_loss:0.1456257849931717
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473950266838074, mean_press_set: 0.447394996881485
The generated pressure mean: 0.44744181632995605, mean_press_set: 0.4474417567253113
loss_pred:0.038319893181324005, decouple_loss:0.12462387979030609
loss_pred:0.03945932537317276, decouple_loss:0.1247558668255806
The generated pressure mean: 0.4474670886993408, mean_press_set: 0.4474670886993408
loss_pred:0.039386287331581116, decouple_loss:0.12420209497213364
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44646430015563965, mean_press_set: 0.4464643895626068
loss_pred:0.038614336401224136, decouple_loss:0.11027207970619202
The generated pressure mean: 0.44856569170951843, mean_press_set: 0.44856566190719604
The generated pressure mean: 0.4474964737892151, mean_press_set: 0.4474965035915375
loss_pred:0.03721754625439644, decouple_loss:0.1101575568318367
loss_pred:0.03909052908420563, decouple_loss:0.11019138246774673
2023-04-16 23:02:22 testing...
The generated pressure mean: 0.4502691626548767, mean_press_set: 0.4502691626548767
The generated pressure mean: 0.45035699009895325, mean_press_set: 0.45035696029663086
loss_pred:0.11913453787565231, decouple_loss:0.11349239200353622
The generated pressure mean: 0.4500633180141449, mean_press_set: 0.4500633478164673
loss_pred:0.11728021502494812, decouple_loss:0.11336931586265564
loss_pred:0.11809898912906647, decouple_loss:0.11335645616054535
WV_0_PC_1_EH_1_PS_40, loss: 0.1238415539264679, avg_mse: 0.16736140847206116
current test mse: 0.167361
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44992345571517944, mean_press_set: 0.4499235153198242
loss_pred:0.041375067085027695, decouple_loss:0.09987986087799072
The generated pressure mean: 0.44902852177619934, mean_press_set: 0.44902855157852173
loss_pred:0.03693392872810364, decouple_loss:0.09966123849153519
The generated pressure mean: 0.44930925965309143, mean_press_set: 0.44930922985076904
loss_pred:0.041471097618341446, decouple_loss:0.10003747791051865
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45006173849105835, mean_press_set: 0.4500616788864136
loss_pred:0.03924001753330231, decouple_loss:0.0921538919210434
The generated pressure mean: 0.44961264729499817, mean_press_set: 0.4496126174926758
The generated pressure mean: 0.44844719767570496, mean_press_set: 0.44844722747802734
loss_pred:0.04083094000816345, decouple_loss:0.09206967055797577
loss_pred:0.03887074813246727, decouple_loss:0.09248955547809601
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44934603571891785, mean_press_set: 0.4493459463119507
loss_pred:0.03885941952466965, decouple_loss:0.08692442625761032
The generated pressure mean: 0.4495595097541809, mean_press_set: 0.4495595097541809
The generated pressure mean: 0.4489619731903076, mean_press_set: 0.44896194338798523
loss_pred:0.03788209706544876, decouple_loss:0.08688846230506897
loss_pred:0.04139183461666107, decouple_loss:0.08674012869596481
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45022737979888916, mean_press_set: 0.45022737979888916
loss_pred:0.03794478997588158, decouple_loss:0.08144474774599075
The generated pressure mean: 0.44987952709198, mean_press_set: 0.44987955689430237
The generated pressure mean: 0.4499533474445343, mean_press_set: 0.4499533474445343
loss_pred:0.03644069284200668, decouple_loss:0.08120802044868469
loss_pred:0.03575483709573746, decouple_loss:0.08379467576742172
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481198787689209, mean_press_set: 0.4481198489665985
loss_pred:0.03557485342025757, decouple_loss:0.0759592056274414
The generated pressure mean: 0.4508883059024811, mean_press_set: 0.4508882462978363
The generated pressure mean: 0.4486345648765564, mean_press_set: 0.448634535074234
loss_pred:0.035094086080789566, decouple_loss:0.07576856017112732
loss_pred:0.03572522848844528, decouple_loss:0.07447727769613266
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44904083013534546, mean_press_set: 0.44904085993766785
loss_pred:0.03512335568666458, decouple_loss:0.07337485998868942
The generated pressure mean: 0.4502703547477722, mean_press_set: 0.4502703547477722
The generated pressure mean: 0.44857698678970337, mean_press_set: 0.4485769271850586
loss_pred:0.03654468432068825, decouple_loss:0.07465381920337677
loss_pred:0.0356825515627861, decouple_loss:0.07603611052036285
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44917967915534973, mean_press_set: 0.44917967915534973
loss_pred:0.03512962907552719, decouple_loss:0.06813594698905945
The generated pressure mean: 0.4498406946659088, mean_press_set: 0.4498407244682312
loss_pred:0.03454572707414627, decouple_loss:0.06885740160942078
The generated pressure mean: 0.4485895037651062, mean_press_set: 0.4485895335674286
loss_pred:0.034060053527355194, decouple_loss:0.06582796573638916
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44820865988731384, mean_press_set: 0.44820865988731384
loss_pred:0.03648995980620384, decouple_loss:0.061703573912382126
The generated pressure mean: 0.4478663504123688, mean_press_set: 0.4478663504123688
loss_pred:0.034100376069545746, decouple_loss:0.06256695836782455
The generated pressure mean: 0.44837453961372375, mean_press_set: 0.44837456941604614
loss_pred:0.033364519476890564, decouple_loss:0.062047768384218216
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506332278251648, mean_press_set: 0.4506332576274872
loss_pred:0.03584495931863785, decouple_loss:0.058957479894161224
The generated pressure mean: 0.44710254669189453, mean_press_set: 0.44710251688957214
The generated pressure mean: 0.44820716977119446, mean_press_set: 0.44820713996887207
loss_pred:0.0394100621342659, decouple_loss:0.058869846165180206
loss_pred:0.03406289219856262, decouple_loss:0.05879375711083412
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449288934469223, mean_press_set: 0.449288934469223
loss_pred:0.0341656468808651, decouple_loss:0.05481954291462898
The generated pressure mean: 0.45068222284317017, mean_press_set: 0.450682133436203
loss_pred:0.03373406082391739, decouple_loss:0.055095549672842026The generated pressure mean: 0.44923681020736694, mean_press_set: 0.4492368996143341
loss_pred:0.031999338418245316, decouple_loss:0.055091165006160736
2023-04-16 23:04:51 testing...
The generated pressure mean: 0.4502691328525543, mean_press_set: 0.4502691626548767
The generated pressure mean: 0.45035699009895325, mean_press_set: 0.45035696029663086
loss_pred:0.11202589422464371, decouple_loss:0.07421678304672241
The generated pressure mean: 0.4500633478164673, mean_press_set: 0.4500633478164673
loss_pred:0.11011430621147156, decouple_loss:0.07459243386983871
loss_pred:0.11037375032901764, decouple_loss:0.07390539348125458
WV_0_PC_1_EH_1_PS_40, loss: 0.1145498976111412, avg_mse: 0.16719508171081543
current test mse: 0.167195
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483489394187927, mean_press_set: 0.4483490288257599
loss_pred:0.03339625149965286, decouple_loss:0.05376473814249039
The generated pressure mean: 0.4492279887199402, mean_press_set: 0.4492279887199402
The generated pressure mean: 0.45063138008117676, mean_press_set: 0.45063140988349915
loss_pred:0.03467641770839691, decouple_loss:0.05452843755483627
loss_pred:0.03334732726216316, decouple_loss:0.0542682409286499
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44975465536117554, mean_press_set: 0.44975459575653076
loss_pred:0.03384646400809288, decouple_loss:0.051285725086927414
The generated pressure mean: 0.45046207308769226, mean_press_set: 0.45046207308769226
The generated pressure mean: 0.44949981570243835, mean_press_set: 0.44949984550476074
loss_pred:0.031460948288440704, decouple_loss:0.051528289914131165
loss_pred:0.03280586004257202, decouple_loss:0.05311088636517525
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44888073205947876, mean_press_set: 0.44888070225715637
loss_pred:0.030172530561685562, decouple_loss:0.04727323725819588
The generated pressure mean: 0.448616087436676, mean_press_set: 0.44861605763435364
The generated pressure mean: 0.4485909342765808, mean_press_set: 0.4485909342765808
loss_pred:0.03167460858821869, decouple_loss:0.04714617133140564
loss_pred:0.03175172209739685, decouple_loss:0.04791174456477165
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44805672764778137, mean_press_set: 0.448056697845459
loss_pred:0.03216685354709625, decouple_loss:0.04738824814558029
The generated pressure mean: 0.4491373896598816, mean_press_set: 0.449137419462204
loss_pred:0.03235240653157234, decouple_loss:0.049240484833717346
The generated pressure mean: 0.448868066072464, mean_press_set: 0.4488680362701416
loss_pred:0.035495806485414505, decouple_loss:0.048965614289045334
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483669698238373, mean_press_set: 0.4483669102191925
The generated pressure mean: 0.4469698965549469, mean_press_set: 0.4469698667526245
loss_pred:0.03186342865228653, decouple_loss:0.05445609986782074
The generated pressure mean: 0.44986850023269653, mean_press_set: 0.4498685300350189
loss_pred:0.03179997578263283, decouple_loss:0.05457048490643501
loss_pred:0.03161967918276787, decouple_loss:0.05450380593538284
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44964301586151123, mean_press_set: 0.44964301586151123
The generated pressure mean: 0.450384259223938, mean_press_set: 0.4503842294216156
The generated pressure mean: 0.4500041902065277, mean_press_set: 0.4500042200088501loss_pred:0.03242597356438637, decouple_loss:0.04872947931289673
loss_pred:0.030574863776564598, decouple_loss:0.04749219864606857
loss_pred:0.03131730109453201, decouple_loss:0.04750923067331314
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477255940437317, mean_press_set: 0.4477255642414093
The generated pressure mean: 0.44932353496551514, mean_press_set: 0.44932347536087036
loss_pred:0.031108342111110687, decouple_loss:0.0421709306538105
loss_pred:0.02975892275571823, decouple_loss:0.04236464202404022
The generated pressure mean: 0.44983839988708496, mean_press_set: 0.44983842968940735
loss_pred:0.03127046674489975, decouple_loss:0.04220934957265854
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494580030441284, mean_press_set: 0.44945788383483887
The generated pressure mean: 0.44968706369400024, mean_press_set: 0.449687123298645
loss_pred:0.028096074238419533, decouple_loss:0.04142279177904129
loss_pred:0.03273943066596985, decouple_loss:0.04257149249315262
The generated pressure mean: 0.44958949089050293, mean_press_set: 0.44958946108818054
loss_pred:0.030594095587730408, decouple_loss:0.04129106551408768
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448985755443573, mean_press_set: 0.44898566603660583
The generated pressure mean: 0.4489430785179138, mean_press_set: 0.448943167924881loss_pred:0.031022870913147926, decouple_loss:0.04524247720837593
loss_pred:0.029183121398091316, decouple_loss:0.043017927557229996
The generated pressure mean: 0.45029914379119873, mean_press_set: 0.45029905438423157
loss_pred:0.029117949306964874, decouple_loss:0.042636383324861526
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44936037063598633, mean_press_set: 0.44936034083366394
The generated pressure mean: 0.44959935545921326, mean_press_set: 0.4495994448661804
loss_pred:0.028200339525938034, decouple_loss:0.053020477294921875
loss_pred:0.0301792174577713, decouple_loss:0.04737967625260353
The generated pressure mean: 0.44900989532470703, mean_press_set: 0.44900989532470703
loss_pred:0.029768915846943855, decouple_loss:0.05321646109223366
2023-04-16 23:06:43 testing...
The generated pressure mean: 0.4502691924571991, mean_press_set: 0.4502691626548767
The generated pressure mean: 0.4500633776187897, mean_press_set: 0.4500633478164673
The generated pressure mean: 0.45035699009895325, mean_press_set: 0.45035696029663086
loss_pred:0.13533426821231842, decouple_loss:0.07812626659870148
loss_pred:0.13212603330612183, decouple_loss:0.0772235319018364
loss_pred:0.13146370649337769, decouple_loss:0.07862395793199539
WV_0_PC_1_EH_1_PS_40, loss: 0.1368742436170578, avg_mse: 0.22850537300109863
current test mse: 0.228505
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44923776388168335, mean_press_set: 0.44923779368400574
loss_pred:0.030412577092647552, decouple_loss:0.04125199839472771
The generated pressure mean: 0.4471745789051056, mean_press_set: 0.447174608707428
loss_pred:0.03151943162083626, decouple_loss:0.04158448055386543
The generated pressure mean: 0.4500916302204132, mean_press_set: 0.45009157061576843
loss_pred:0.029998671263456345, decouple_loss:0.043256018310785294
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494149088859558, mean_press_set: 0.4494149386882782
The generated pressure mean: 0.4495624303817749, mean_press_set: 0.4495624303817749
The generated pressure mean: 0.44802871346473694, mean_press_set: 0.4480287730693817
loss_pred:0.028981776908040047, decouple_loss:0.03674192726612091
loss_pred:0.029711062088608742, decouple_loss:0.035747114568948746
loss_pred:0.029121678322553635, decouple_loss:0.03651675954461098
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45023876428604126, mean_press_set: 0.45023879408836365
The generated pressure mean: 0.4492860436439514, mean_press_set: 0.4492860734462738
The generated pressure mean: 0.4479064345359802, mean_press_set: 0.4479064643383026
loss_pred:0.029305892065167427, decouple_loss:0.03634639456868172
loss_pred:0.030651630833745003, decouple_loss:0.035410452634096146
loss_pred:0.0292232483625412, decouple_loss:0.0376608669757843
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498350918292999, mean_press_set: 0.4498351216316223
loss_pred:0.028405653312802315, decouple_loss:0.044126931577920914
The generated pressure mean: 0.44814348220825195, mean_press_set: 0.44814345240592957
The generated pressure mean: 0.4494234025478363, mean_press_set: 0.4494233727455139
loss_pred:0.029659226536750793, decouple_loss:0.04635890945792198
loss_pred:0.02762838453054428, decouple_loss:0.04639467969536781
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484338164329529, mean_press_set: 0.44843384623527527
loss_pred:0.028090329840779305, decouple_loss:0.04405767098069191
The generated pressure mean: 0.4486738443374634, mean_press_set: 0.44867387413978577
The generated pressure mean: 0.4477481544017792, mean_press_set: 0.447748064994812
loss_pred:0.029465075582265854, decouple_loss:0.04032614827156067
loss_pred:0.026662619784474373, decouple_loss:0.038468729704618454
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494871497154236, mean_press_set: 0.4494871497154236
loss_pred:0.026412321254611015, decouple_loss:0.03400188684463501
The generated pressure mean: 0.4479127526283264, mean_press_set: 0.4479128420352936
The generated pressure mean: 0.4486745297908783, mean_press_set: 0.44867458939552307
loss_pred:0.026424286887049675, decouple_loss:0.03403787687420845
loss_pred:0.02712201699614525, decouple_loss:0.03240266814827919
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493279755115509, mean_press_set: 0.4493279755115509
The generated pressure mean: 0.44867774844169617, mean_press_set: 0.44867774844169617
The generated pressure mean: 0.449554443359375, mean_press_set: 0.449554443359375
loss_pred:0.02488536201417446, decouple_loss:0.02930542081594467
loss_pred:0.02794637903571129, decouple_loss:0.029993979260325432
loss_pred:0.026954317465424538, decouple_loss:0.029633905738592148
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44846272468566895, mean_press_set: 0.44846272468566895
The generated pressure mean: 0.45123034715652466, mean_press_set: 0.45123034715652466
loss_pred:0.025216996669769287, decouple_loss:0.028587864711880684
The generated pressure mean: 0.44833311438560486, mean_press_set: 0.44833314418792725
loss_pred:0.026303371414542198, decouple_loss:0.02879714034497738
loss_pred:0.02793619967997074, decouple_loss:0.030145497992634773
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478965699672699, mean_press_set: 0.4478965699672699
The generated pressure mean: 0.4505176842212677, mean_press_set: 0.4505176842212677
loss_pred:0.02670346572995186, decouple_loss:0.03325944021344185
loss_pred:0.02666868083178997, decouple_loss:0.03518904745578766
The generated pressure mean: 0.44859635829925537, mean_press_set: 0.44859644770622253
loss_pred:0.027144331485033035, decouple_loss:0.03349834680557251
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44917652010917664, mean_press_set: 0.449176549911499
The generated pressure mean: 0.44786569476127625, mean_press_set: 0.44786569476127625
The generated pressure mean: 0.4475933909416199, mean_press_set: 0.4475933015346527
loss_pred:0.026867389678955078, decouple_loss:0.04440715163946152
loss_pred:0.026857372373342514, decouple_loss:0.04590149596333504
loss_pred:0.02726295404136181, decouple_loss:0.049324166029691696
2023-04-16 23:09:13 testing...
The generated pressure mean: 0.4502691328525543, mean_press_set: 0.4502691626548767
The generated pressure mean: 0.45035699009895325, mean_press_set: 0.45035696029663086
loss_pred:0.14677755534648895, decouple_loss:0.07569420337677002
The generated pressure mean: 0.4500633776187897, mean_press_set: 0.4500633478164673
loss_pred:0.14335696399211884, decouple_loss:0.07715186476707458
loss_pred:0.14406134188175201, decouple_loss:0.07539365440607071
WV_0_PC_1_EH_1_PS_40, loss: 0.14853595197200775, avg_mse: 0.26214349269866943
current test mse: 0.262144