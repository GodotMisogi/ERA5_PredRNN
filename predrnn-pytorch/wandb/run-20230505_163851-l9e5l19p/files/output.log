/scratch/09012/haoli1/ERA5/dataset/era5_train_01012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
train_data_files nums: 125
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_09012020_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 3.3080694265663624e-05, gen p mean: 0.0, mean p set: 0.448468953371048
loss_pred:0.2254853993654251, decouple_loss:0.05357023701071739
The modified gen p mean: 0.00013653060887008905, gen p mean: 0.0, mean p set: 0.4487598240375519
loss_pred:0.22042670845985413, decouple_loss:0.053308870643377304
The modified gen p mean: 7.812988042132929e-05, gen p mean: 0.0, mean p set: 0.44944167137145996
loss_pred:0.21549586951732635, decouple_loss:0.05310255289077759
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.0008421465754508972, gen p mean: 0.0, mean p set: 0.44689464569091797
loss_pred:0.22664248943328857, decouple_loss:0.16041240096092224
The modified gen p mean: 0.0007282813894562423, gen p mean: 0.0, mean p set: 0.4479406476020813
loss_pred:0.2240850329399109, decouple_loss:0.1604142189025879
The modified gen p mean: 0.000750233419239521, gen p mean: 0.0, mean p set: 0.4488692581653595
loss_pred:0.22122308611869812, decouple_loss:0.16058330237865448
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.005538269877433777, gen p mean: 0.0, mean p set: 0.4477252662181854
loss_pred:0.21979846060276031, decouple_loss:0.26263776421546936
The modified gen p mean: 0.005584893748164177, gen p mean: 0.0, mean p set: 0.4490565061569214
loss_pred:0.22105944156646729, decouple_loss:0.26508352160453796
The modified gen p mean: 0.005552648566663265, gen p mean: 0.0, mean p set: 0.4488369822502136
loss_pred:0.2205079048871994, decouple_loss:0.26534441113471985
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.012575862929224968, gen p mean: 0.0, mean p set: 0.4487389624118805
loss_pred:0.20584554970264435, decouple_loss:0.3406173288822174The modified gen p mean: 0.012718487530946732, gen p mean: 0.0, mean p set: 0.4480428397655487
loss_pred:0.21413779258728027, decouple_loss:0.34169214963912964
The modified gen p mean: 0.012823546305298805, gen p mean: 0.0, mean p set: 0.4485113322734833
loss_pred:0.20671598613262177, decouple_loss:0.3419995605945587
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.01968449354171753, gen p mean: 0.0, mean p set: 0.44645413756370544
loss_pred:0.20006081461906433, decouple_loss:0.4194565415382385
The modified gen p mean: 0.019739843904972076, gen p mean: 0.0, mean p set: 0.44930681586265564
loss_pred:0.19936895370483398, decouple_loss:0.42689767479896545
The modified gen p mean: 0.019676676020026207, gen p mean: 0.0, mean p set: 0.4486868679523468
loss_pred:0.20071455836296082, decouple_loss:0.42416417598724365
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.024575084447860718, gen p mean: 0.0, mean p set: 0.44841864705085754
loss_pred:0.2015801966190338, decouple_loss:0.31115227937698364
The modified gen p mean: 0.02455633319914341, gen p mean: 0.0, mean p set: 0.4476655125617981
loss_pred:0.19700226187705994, decouple_loss:0.30980435013771057
The modified gen p mean: 0.024618543684482574, gen p mean: 0.0, mean p set: 0.4480399191379547
loss_pred:0.19647981226444244, decouple_loss:0.3103042542934418
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.03755885735154152, gen p mean: 0.0, mean p set: 0.44850867986679077
The modified gen p mean: 0.03756394237279892, gen p mean: 0.0, mean p set: 0.4489506781101227
loss_pred:0.18867449462413788, decouple_loss:0.49217456579208374
loss_pred:0.19554932415485382, decouple_loss:0.48953673243522644
The modified gen p mean: 0.03756173327565193, gen p mean: 0.0, mean p set: 0.4468391239643097
loss_pred:0.1855272352695465, decouple_loss:0.49155712127685547
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.03998574987053871, gen p mean: 0.0, mean p set: 0.44764459133148193
loss_pred:0.1838015913963318, decouple_loss:0.41319212317466736
The modified gen p mean: 0.039995934814214706, gen p mean: 0.0, mean p set: 0.44777119159698486
loss_pred:0.18661627173423767, decouple_loss:0.4102562963962555
The modified gen p mean: 0.04001332446932793, gen p mean: 0.0, mean p set: 0.4489421248435974
loss_pred:0.18613040447235107, decouple_loss:0.4150661528110504
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.042706042528152466, gen p mean: 0.0, mean p set: 0.44794782996177673
loss_pred:0.1896001696586609, decouple_loss:0.3552532196044922
The modified gen p mean: 0.042738910764455795, gen p mean: 0.0, mean p set: 0.44767823815345764
loss_pred:0.18754006922245026, decouple_loss:0.35623452067375183
The modified gen p mean: 0.04271132871508598, gen p mean: 0.0, mean p set: 0.44985130429267883
loss_pred:0.1794770061969757, decouple_loss:0.3566133379936218
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.04469432309269905, gen p mean: 0.0, mean p set: 0.4467865526676178
loss_pred:0.18362000584602356, decouple_loss:0.32079875469207764
The modified gen p mean: 0.04468139633536339, gen p mean: 0.0, mean p set: 0.4475817382335663
loss_pred:0.17381614446640015, decouple_loss:0.324337363243103
The modified gen p mean: 0.04470845311880112, gen p mean: 0.0, mean p set: 0.448919415473938
loss_pred:0.17439639568328857, decouple_loss:0.325232595205307
2023-05-05 16:43:52 testing...
The modified gen p mean: 0.05109301581978798, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.1757369041442871, decouple_loss:0.3324492275714874
The modified gen p mean: 0.0511137992143631, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.1769772619009018, decouple_loss:0.3335820734500885
The modified gen p mean: 0.051136236637830734, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.1860041469335556, decouple_loss:0.3358052372932434
WV_1_PC_0_EH_0_PS_40_6, loss: 0.19627004861831665, avg_mse: 0.1844714730978012
current test mse: 0.184471
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.051108259707689285, gen p mean: 0.0, mean p set: 0.44844329357147217
The modified gen p mean: 0.05110922455787659, gen p mean: 0.0, mean p set: 0.44908660650253296
loss_pred:0.18576380610466003, decouple_loss:0.3337760865688324
loss_pred:0.18890446424484253, decouple_loss:0.33273303508758545
The modified gen p mean: 0.051080372184515, gen p mean: 0.0, mean p set: 0.44847002625465393
loss_pred:0.17447789013385773, decouple_loss:0.33287420868873596
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.05885154753923416, gen p mean: 0.0, mean p set: 0.44584187865257263
loss_pred:0.17463111877441406, decouple_loss:0.27634769678115845
The modified gen p mean: 0.05880112573504448, gen p mean: 0.0, mean p set: 0.4473777115345001
loss_pred:0.17176812887191772, decouple_loss:0.27928152680397034
The modified gen p mean: 0.05885237827897072, gen p mean: 0.0, mean p set: 0.4480014741420746
loss_pred:0.1707698106765747, decouple_loss:0.27839988470077515
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.0677843913435936, gen p mean: 0.0, mean p set: 0.4482314884662628
loss_pred:0.17578881978988647, decouple_loss:0.24998076260089874
The modified gen p mean: 0.06783229112625122, gen p mean: 0.0, mean p set: 0.4494354724884033
loss_pred:0.16863253712654114, decouple_loss:0.2529583275318146
The modified gen p mean: 0.0678003653883934, gen p mean: 0.0, mean p set: 0.4490351974964142
loss_pred:0.16636048257350922, decouple_loss:0.25083497166633606
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.07775676995515823, gen p mean: 0.0, mean p set: 0.4486646354198456
loss_pred:0.16809570789337158, decouple_loss:0.2766556143760681
The modified gen p mean: 0.07776210457086563, gen p mean: 0.0, mean p set: 0.4478928744792938
loss_pred:0.17206278443336487, decouple_loss:0.27354705333709717
The modified gen p mean: 0.0777864009141922, gen p mean: 0.0, mean p set: 0.4481014013290405
loss_pred:0.17388661205768585, decouple_loss:0.2723372280597687
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.08773838728666306, gen p mean: 0.0, mean p set: 0.44951605796813965
The modified gen p mean: 0.08788572251796722, gen p mean: 0.0, mean p set: 0.4479483664035797
loss_pred:0.1649595946073532, decouple_loss:0.2352573275566101
loss_pred:0.163066565990448, decouple_loss:0.23482057452201843
The modified gen p mean: 0.08781906217336655, gen p mean: 0.0, mean p set: 0.44780370593070984
loss_pred:0.15818114578723907, decouple_loss:0.23441727459430695
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.09868663549423218, gen p mean: 0.0, mean p set: 0.44967639446258545
loss_pred:0.15519729256629944, decouple_loss:0.20825518667697906
The modified gen p mean: 0.09871159493923187, gen p mean: 0.0, mean p set: 0.44826918840408325
loss_pred:0.16152451932430267, decouple_loss:0.2074425369501114
The modified gen p mean: 0.09865521639585495, gen p mean: 0.0, mean p set: 0.448184072971344
loss_pred:0.16760487854480743, decouple_loss:0.20497390627861023
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.11122250556945801, gen p mean: 0.0, mean p set: 0.44645223021507263
loss_pred:0.15800732374191284, decouple_loss:0.19893838465213776
The modified gen p mean: 0.11108028888702393, gen p mean: 0.0, mean p set: 0.44827160239219666
loss_pred:0.15804876387119293, decouple_loss:0.2013815939426422
The modified gen p mean: 0.11111544817686081, gen p mean: 0.0, mean p set: 0.44764280319213867
loss_pred:0.15194904804229736, decouple_loss:0.20348383486270905
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.12380179762840271, gen p mean: 0.0, mean p set: 0.44869908690452576
loss_pred:0.16359123587608337, decouple_loss:0.19691351056098938
The modified gen p mean: 0.12376724183559418, gen p mean: 0.0, mean p set: 0.4476326107978821
loss_pred:0.15095406770706177, decouple_loss:0.19412563741207123
The modified gen p mean: 0.12394271790981293, gen p mean: 0.0, mean p set: 0.4464397132396698
loss_pred:0.1532023400068283, decouple_loss:0.19836187362670898
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.13921014964580536, gen p mean: 0.0, mean p set: 0.4492167532444
loss_pred:0.14458473026752472, decouple_loss:0.1810530126094818
The modified gen p mean: 0.13935354351997375, gen p mean: 0.0, mean p set: 0.44889581203460693
loss_pred:0.15887612104415894, decouple_loss:0.18133839964866638
The modified gen p mean: 0.13941575586795807, gen p mean: 0.0, mean p set: 0.4486686885356903
loss_pred:0.15594474971294403, decouple_loss:0.1798817366361618
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.15346913039684296, gen p mean: 0.0, mean p set: 0.4495036005973816
loss_pred:0.1418706476688385, decouple_loss:0.17165611684322357
The modified gen p mean: 0.1533447653055191, gen p mean: 0.0, mean p set: 0.44812238216400146
loss_pred:0.1499282419681549, decouple_loss:0.16879434883594513
The modified gen p mean: 0.15368370711803436, gen p mean: 0.0, mean p set: 0.4461473524570465
loss_pred:0.14811350405216217, decouple_loss:0.1664845496416092
2023-05-05 16:47:37 testing...
The modified gen p mean: 0.16994886100292206, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.14593388140201569, decouple_loss:0.1622704714536667
The modified gen p mean: 0.17026108503341675, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.16998711228370667, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.1385139375925064, decouple_loss:0.16059912741184235
loss_pred:0.13829341530799866, decouple_loss:0.16323372721672058
WV_1_PC_0_EH_0_PS_40_6, loss: 0.14901547133922577, avg_mse: 0.14354930818080902
current test mse: 0.143549
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
NaN value num: 0
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.1697828620672226, gen p mean: 0.0, mean p set: 0.4529705345630646
loss_pred:0.1410703808069229, decouple_loss:0.16246189177036285
The modified gen p mean: 0.16987235844135284, gen p mean: 0.0, mean p set: 0.4502660930156708
loss_pred:0.14419786632061005, decouple_loss:0.1624290943145752
The modified gen p mean: 0.16972410678863525, gen p mean: 0.0, mean p set: 0.45042943954467773
loss_pred:0.14106449484825134, decouple_loss:0.161780446767807
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.18513183295726776, gen p mean: 0.0, mean p set: 0.4513741731643677
The modified gen p mean: 0.1854979544878006, gen p mean: 0.0, mean p set: 0.45222410559654236
loss_pred:0.13502216339111328, decouple_loss:0.15535122156143188
loss_pred:0.13141722977161407, decouple_loss:0.1591874659061432
The modified gen p mean: 0.18511682748794556, gen p mean: 0.0, mean p set: 0.45067140460014343
loss_pred:0.14084117114543915, decouple_loss:0.15867938101291656
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.2002183496952057, gen p mean: 0.0, mean p set: 0.4496016502380371
loss_pred:0.13198424875736237, decouple_loss:0.15158692002296448
The modified gen p mean: 0.20013010501861572, gen p mean: 0.0, mean p set: 0.45101216435432434
loss_pred:0.12765318155288696, decouple_loss:0.1518760621547699
The modified gen p mean: 0.19943007826805115, gen p mean: 0.0, mean p set: 0.45004913210868835
loss_pred:0.12638558447360992, decouple_loss:0.15440446138381958
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.2162131667137146, gen p mean: 0.0, mean p set: 0.4507175385951996
loss_pred:0.12526004016399384, decouple_loss:0.1510535478591919
The modified gen p mean: 0.21648111939430237, gen p mean: 0.0, mean p set: 0.44961294531822205
loss_pred:0.12839765846729279, decouple_loss:0.1509741097688675
The modified gen p mean: 0.21618357300758362, gen p mean: 0.0, mean p set: 0.4495096802711487
loss_pred:0.12377910315990448, decouple_loss:0.1533968597650528
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.22563813626766205, gen p mean: 0.0, mean p set: 0.44999220967292786
loss_pred:0.1235298365354538, decouple_loss:0.14106683433055878
The modified gen p mean: 0.2255915403366089, gen p mean: 0.0, mean p set: 0.450222373008728
loss_pred:0.12008211761713028, decouple_loss:0.14339026808738708
The modified gen p mean: 0.22562706470489502, gen p mean: 0.0, mean p set: 0.44938743114471436
loss_pred:0.11739509552717209, decouple_loss:0.1429065316915512
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.2399926632642746, gen p mean: 0.0, mean p set: 0.45005717873573303
The modified gen p mean: 0.2398206889629364, gen p mean: 0.0, mean p set: 0.4494609236717224loss_pred:0.12019513547420502, decouple_loss:0.13846220076084137
loss_pred:0.12052972614765167, decouple_loss:0.13781824707984924
The modified gen p mean: 0.24008511006832123, gen p mean: 0.0, mean p set: 0.45097923278808594
loss_pred:0.11692102998495102, decouple_loss:0.13851895928382874
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.2531737685203552, gen p mean: 0.0, mean p set: 0.45373791456222534
loss_pred:0.11587253212928772, decouple_loss:0.13479267060756683
The modified gen p mean: 0.2532404661178589, gen p mean: 0.0, mean p set: 0.4497406780719757
loss_pred:0.11328335851430893, decouple_loss:0.13290181756019592
The modified gen p mean: 0.2533186972141266, gen p mean: 0.0, mean p set: 0.4515989124774933
loss_pred:0.11228723078966141, decouple_loss:0.1342204511165619
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.26587754487991333, gen p mean: 0.0, mean p set: 0.4500787556171417
The modified gen p mean: 0.26626163721084595, gen p mean: 0.0, mean p set: 0.450965940952301
loss_pred:0.11367566138505936, decouple_loss:0.1268126517534256
loss_pred:0.10897059738636017, decouple_loss:0.13033944368362427
The modified gen p mean: 0.266043484210968, gen p mean: 0.0, mean p set: 0.4490891993045807
loss_pred:0.10907385498285294, decouple_loss:0.12818795442581177
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.28023532032966614, gen p mean: 0.0, mean p set: 0.4496786296367645
The modified gen p mean: 0.27957046031951904, gen p mean: 0.0, mean p set: 0.4507306218147278
loss_pred:0.10795848071575165, decouple_loss:0.1272185742855072
loss_pred:0.10819648951292038, decouple_loss:0.1266244351863861
The modified gen p mean: 0.2796599268913269, gen p mean: 0.0, mean p set: 0.45097601413726807
loss_pred:0.111826092004776, decouple_loss:0.12444685399532318
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.2878551185131073, gen p mean: 0.0, mean p set: 0.4489399194717407
loss_pred:0.10122720897197723, decouple_loss:0.11983944475650787
The modified gen p mean: 0.28774842619895935, gen p mean: 0.0, mean p set: 0.4496089518070221
loss_pred:0.10556519031524658, decouple_loss:0.11948247998952866
The modified gen p mean: 0.2881326973438263, gen p mean: 0.0, mean p set: 0.45162320137023926
loss_pred:0.10702282190322876, decouple_loss:0.1190885379910469
2023-05-05 16:52:08 testing...
The modified gen p mean: 0.299616277217865, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.10809674113988876, decouple_loss:0.12074442952871323
The modified gen p mean: 0.29950666427612305, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.2993406355381012, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.10355426371097565, decouple_loss:0.12076711654663086
loss_pred:0.10267115384340286, decouple_loss:0.12002582103013992
WV_1_PC_0_EH_0_PS_40_6, loss: 0.11079967021942139, avg_mse: 0.1062612310051918
current test mse: 0.106261
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.3003019392490387, gen p mean: 0.0, mean p set: 0.45125457644462585
loss_pred:0.10255495458841324, decouple_loss:0.11906500160694122
The modified gen p mean: 0.30053332448005676, gen p mean: 0.0, mean p set: 0.45026499032974243
loss_pred:0.10117902606725693, decouple_loss:0.11678031086921692
The modified gen p mean: 0.30030590295791626, gen p mean: 0.0, mean p set: 0.45106494426727295
loss_pred:0.1069277673959732, decouple_loss:0.1193263903260231
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.314100444316864, gen p mean: 0.0, mean p set: 0.4503369629383087
loss_pred:0.10434126853942871, decouple_loss:0.12184115499258041
The modified gen p mean: 0.31374260783195496, gen p mean: 0.0, mean p set: 0.4497094452381134
loss_pred:0.10420946031808853, decouple_loss:0.11895523965358734
The modified gen p mean: 0.31434696912765503, gen p mean: 0.0, mean p set: 0.44929495453834534
loss_pred:0.10020320862531662, decouple_loss:0.1202557310461998
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.32231807708740234, gen p mean: 0.0, mean p set: 0.45194050669670105
loss_pred:0.0967428982257843, decouple_loss:0.11788664013147354
The modified gen p mean: 0.3228563368320465, gen p mean: 0.0, mean p set: 0.4487481415271759
loss_pred:0.09636548161506653, decouple_loss:0.11651794612407684
The modified gen p mean: 0.3229902982711792, gen p mean: 0.0, mean p set: 0.44880592823028564
loss_pred:0.09784643352031708, decouple_loss:0.11307907104492188
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.33059415221214294, gen p mean: 0.0, mean p set: 0.4524822235107422
The modified gen p mean: 0.3308100998401642, gen p mean: 0.0, mean p set: 0.4497845768928528
loss_pred:0.0993601530790329, decouple_loss:0.11480338871479034
loss_pred:0.10073830932378769, decouple_loss:0.11339445412158966
The modified gen p mean: 0.33068230748176575, gen p mean: 0.0, mean p set: 0.4505888819694519
loss_pred:0.099822036921978, decouple_loss:0.11538373678922653
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.3444799482822418, gen p mean: 0.0, mean p set: 0.45127683877944946
loss_pred:0.09495373070240021, decouple_loss:0.11120744794607162
The modified gen p mean: 0.34441444277763367, gen p mean: 0.0, mean p set: 0.45330584049224854
loss_pred:0.09459983557462692, decouple_loss:0.11497694998979568
The modified gen p mean: 0.3438527286052704, gen p mean: 0.0, mean p set: 0.44892165064811707
loss_pred:0.09402012079954147, decouple_loss:0.11167577654123306
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.3474428355693817, gen p mean: 0.0, mean p set: 0.45149263739585876
loss_pred:0.09408831596374512, decouple_loss:0.10807408392429352
The modified gen p mean: 0.34743377566337585, gen p mean: 0.0, mean p set: 0.44914600253105164
loss_pred:0.09089703112840652, decouple_loss:0.10787530988454819
The modified gen p mean: 0.3484642803668976, gen p mean: 0.0, mean p set: 0.45148617029190063
loss_pred:0.09406627714633942, decouple_loss:0.1081908568739891
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.3558463156223297, gen p mean: 0.0, mean p set: 0.4533670246601105
loss_pred:0.09470225870609283, decouple_loss:0.10638519376516342
The modified gen p mean: 0.3556320369243622, gen p mean: 0.0, mean p set: 0.4489029347896576
loss_pred:0.08994797617197037, decouple_loss:0.10532189160585403
The modified gen p mean: 0.3559228479862213, gen p mean: 0.0, mean p set: 0.4495715796947479
loss_pred:0.09573841840028763, decouple_loss:0.10504758358001709
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.36385706067085266, gen p mean: 0.0, mean p set: 0.45220720767974854
loss_pred:0.09077173471450806, decouple_loss:0.10305368155241013
The modified gen p mean: 0.3642052710056305, gen p mean: 0.0, mean p set: 0.4491318166255951
loss_pred:0.08837345987558365, decouple_loss:0.10146678984165192
The modified gen p mean: 0.36435431241989136, gen p mean: 0.0, mean p set: 0.4517059326171875
loss_pred:0.09366454184055328, decouple_loss:0.10193341225385666
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.3716479241847992, gen p mean: 0.0, mean p set: 0.4515543580055237
loss_pred:0.08809676766395569, decouple_loss:0.1031220480799675
The modified gen p mean: 0.37121841311454773, gen p mean: 0.0, mean p set: 0.45147207379341125
loss_pred:0.08739910274744034, decouple_loss:0.10114818811416626
The modified gen p mean: 0.372965931892395, gen p mean: 0.0, mean p set: 0.4493706524372101
loss_pred:0.09001841396093369, decouple_loss:0.10309113562107086
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.37572696805000305, gen p mean: 0.0, mean p set: 0.45030519366264343
loss_pred:0.08856331557035446, decouple_loss:0.10126502066850662
The modified gen p mean: 0.37561219930648804, gen p mean: 0.0, mean p set: 0.4501922130584717
loss_pred:0.09262681007385254, decouple_loss:0.09972037374973297
The modified gen p mean: 0.3760690987110138, gen p mean: 0.0, mean p set: 0.4495759904384613
loss_pred:0.09280098974704742, decouple_loss:0.10023613274097443
2023-05-05 16:55:56 testing...
The modified gen p mean: 0.3810579776763916, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.09239687025547028, decouple_loss:0.09917987883090973
The modified gen p mean: 0.38129982352256775, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.08895622938871384, decouple_loss:0.09953773021697998
The modified gen p mean: 0.38093316555023193, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.08785729110240936, decouple_loss:0.09888981282711029
WV_1_PC_0_EH_0_PS_40_6, loss: 0.09469692409038544, avg_mse: 0.09042319655418396
current test mse: 0.090423
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.38205888867378235, gen p mean: 0.0, mean p set: 0.44788506627082825
loss_pred:0.08567851036787033, decouple_loss:0.10014178603887558
The modified gen p mean: 0.3821200728416443, gen p mean: 0.0, mean p set: 0.44565579295158386
loss_pred:0.0862567275762558, decouple_loss:0.10034850239753723
The modified gen p mean: 0.3803780972957611, gen p mean: 0.0, mean p set: 0.44680705666542053
loss_pred:0.09004233032464981, decouple_loss:0.10206770151853561
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.3918379843235016, gen p mean: 0.0, mean p set: 0.445857435464859
loss_pred:0.0873522087931633, decouple_loss:0.1042615994811058
The modified gen p mean: 0.3912959098815918, gen p mean: 0.0, mean p set: 0.44704607129096985
loss_pred:0.07995890825986862, decouple_loss:0.10030654817819595
The modified gen p mean: 0.3898812234401703, gen p mean: 0.0, mean p set: 0.44728413224220276
loss_pred:0.08599788695573807, decouple_loss:0.09954871982336044
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.3859632909297943, gen p mean: 0.0, mean p set: 0.44807347655296326
loss_pred:0.08444733172655106, decouple_loss:0.1002085879445076
The modified gen p mean: 0.3832470178604126, gen p mean: 0.0, mean p set: 0.44722166657447815
loss_pred:0.08843693137168884, decouple_loss:0.09911294281482697
The modified gen p mean: 0.3849610686302185, gen p mean: 0.0, mean p set: 0.44727569818496704
loss_pred:0.08301666378974915, decouple_loss:0.09830506145954132
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.3970140218734741, gen p mean: 0.0, mean p set: 0.4472668468952179
loss_pred:0.08822459727525711, decouple_loss:0.09496109187602997
The modified gen p mean: 0.3971390426158905, gen p mean: 0.0, mean p set: 0.44647684693336487
loss_pred:0.08511486649513245, decouple_loss:0.09732135385274887
The modified gen p mean: 0.39755502343177795, gen p mean: 0.0, mean p set: 0.44729331135749817
loss_pred:0.08715849369764328, decouple_loss:0.09830013662576675
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4010092616081238, gen p mean: 0.0, mean p set: 0.446846604347229
loss_pred:0.08447225391864777, decouple_loss:0.09800172597169876
The modified gen p mean: 0.4018781781196594, gen p mean: 0.0, mean p set: 0.44699564576148987
loss_pred:0.08792582154273987, decouple_loss:0.09852083772420883
The modified gen p mean: 0.40111589431762695, gen p mean: 0.0, mean p set: 0.4466037154197693
loss_pred:0.08097057044506073, decouple_loss:0.0974108949303627
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.403807669878006, gen p mean: 0.0, mean p set: 0.4465794563293457
loss_pred:0.08355491608381271, decouple_loss:0.09937514364719391
The modified gen p mean: 0.40404942631721497, gen p mean: 0.0, mean p set: 0.4461512565612793
loss_pred:0.08457458019256592, decouple_loss:0.09885012358427048
The modified gen p mean: 0.40343189239501953, gen p mean: 0.0, mean p set: 0.4456845819950104
loss_pred:0.08590023219585419, decouple_loss:0.09994324296712875
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.40672242641448975, gen p mean: 0.0, mean p set: 0.44709545373916626
loss_pred:0.08238501101732254, decouple_loss:0.09507638216018677
The modified gen p mean: 0.4061068594455719, gen p mean: 0.0, mean p set: 0.4480440020561218
loss_pred:0.0787617564201355, decouple_loss:0.09547167271375656
The modified gen p mean: 0.4050465226173401, gen p mean: 0.0, mean p set: 0.44658660888671875
loss_pred:0.08374298363924026, decouple_loss:0.09647335112094879
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4064066410064697, gen p mean: 0.0, mean p set: 0.4471038281917572
loss_pred:0.07987080514431, decouple_loss:0.09070519357919693
The modified gen p mean: 0.4067557454109192, gen p mean: 0.0, mean p set: 0.44746461510658264
loss_pred:0.08293364197015762, decouple_loss:0.09018497169017792
The modified gen p mean: 0.4069230854511261, gen p mean: 0.0, mean p set: 0.4482450783252716
loss_pred:0.08053190261125565, decouple_loss:0.08972743153572083
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4066092073917389, gen p mean: 0.0, mean p set: 0.44719746708869934
loss_pred:0.08341106027364731, decouple_loss:0.08722693473100662
The modified gen p mean: 0.40971681475639343, gen p mean: 0.0, mean p set: 0.44578808546066284
loss_pred:0.08443266153335571, decouple_loss:0.08793353289365768
The modified gen p mean: 0.40826618671417236, gen p mean: 0.0, mean p set: 0.44691362977027893
loss_pred:0.08362416177988052, decouple_loss:0.08601292967796326
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4093031883239746, gen p mean: 0.0, mean p set: 0.447183758020401
loss_pred:0.07973240315914154, decouple_loss:0.08372288942337036
The modified gen p mean: 0.40848293900489807, gen p mean: 0.0, mean p set: 0.44682133197784424
loss_pred:0.08317799121141434, decouple_loss:0.08265543729066849
The modified gen p mean: 0.4080713391304016, gen p mean: 0.0, mean p set: 0.44842633605003357
loss_pred:0.08359629660844803, decouple_loss:0.08205132931470871
2023-05-05 17:00:52 testing...
The modified gen p mean: 0.4136926531791687, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.08621689677238464, decouple_loss:0.08318160474300385
The modified gen p mean: 0.4155832529067993, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.08419674634933472, decouple_loss:0.0828837901353836
The modified gen p mean: 0.4140707552433014, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.08272380381822586, decouple_loss:0.08277222514152527
WV_1_PC_0_EH_0_PS_40_6, loss: 0.08852645009756088, avg_mse: 0.08454868942499161
current test mse: 0.084549
Iteration: 51, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.41521093249320984, gen p mean: 0.0, mean p set: 0.4470020830631256
loss_pred:0.08051968365907669, decouple_loss:0.08158442378044128
The modified gen p mean: 0.414877712726593, gen p mean: 0.0, mean p set: 0.4471500515937805
loss_pred:0.08007970452308655, decouple_loss:0.08170992136001587
The modified gen p mean: 0.4134576916694641, gen p mean: 0.0, mean p set: 0.44728177785873413
loss_pred:0.08309410512447357, decouple_loss:0.08074492961168289
Iteration: 52, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4165193736553192, gen p mean: 0.0, mean p set: 0.446819543838501
loss_pred:0.08229722082614899, decouple_loss:0.07909871637821198
The modified gen p mean: 0.416109561920166, gen p mean: 0.0, mean p set: 0.4473506212234497
loss_pred:0.08262237906455994, decouple_loss:0.0794970691204071
The modified gen p mean: 0.4172818660736084, gen p mean: 0.0, mean p set: 0.44706007838249207
loss_pred:0.07995976507663727, decouple_loss:0.08039677888154984
Iteration: 53, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4118169844150543, gen p mean: 0.0, mean p set: 0.4477251172065735
loss_pred:0.07803699374198914, decouple_loss:0.0791507288813591
The modified gen p mean: 0.4124467670917511, gen p mean: 0.0, mean p set: 0.4489297568798065
loss_pred:0.08007727563381195, decouple_loss:0.07924607396125793
The modified gen p mean: 0.4155431389808655, gen p mean: 0.0, mean p set: 0.44659578800201416
loss_pred:0.08390451222658157, decouple_loss:0.08066056668758392
Iteration: 54, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.41746076941490173, gen p mean: 0.0, mean p set: 0.44726231694221497
loss_pred:0.07840745896100998, decouple_loss:0.07628641277551651
The modified gen p mean: 0.41775181889533997, gen p mean: 0.0, mean p set: 0.44691479206085205
loss_pred:0.07708800584077835, decouple_loss:0.07625436037778854
The modified gen p mean: 0.419838011264801, gen p mean: 0.0, mean p set: 0.44748565554618835
loss_pred:0.0785692036151886, decouple_loss:0.07534793019294739
Iteration: 55, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.42298099398612976, gen p mean: 0.0, mean p set: 0.4473183751106262
loss_pred:0.07905073463916779, decouple_loss:0.07480477541685104
The modified gen p mean: 0.4221607446670532, gen p mean: 0.0, mean p set: 0.44818106293678284
loss_pred:0.07443857938051224, decouple_loss:0.0762312039732933
The modified gen p mean: 0.4222029745578766, gen p mean: 0.0, mean p set: 0.4474301338195801
loss_pred:0.08116089552640915, decouple_loss:0.0772029235959053
Iteration: 56, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4167468845844269, gen p mean: 0.0, mean p set: 0.4471670687198639
loss_pred:0.07211655378341675, decouple_loss:0.0738542228937149
The modified gen p mean: 0.4185182452201843, gen p mean: 0.0, mean p set: 0.44753265380859375
loss_pred:0.07891414314508438, decouple_loss:0.07483750581741333
The modified gen p mean: 0.4156538248062134, gen p mean: 0.0, mean p set: 0.44653791189193726
loss_pred:0.07863437384366989, decouple_loss:0.07437904924154282
Iteration: 57, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.41630834341049194, gen p mean: 0.0, mean p set: 0.44760966300964355
loss_pred:0.07610570639371872, decouple_loss:0.07258995622396469
The modified gen p mean: 0.41577595472335815, gen p mean: 0.0, mean p set: 0.4476316571235657
The modified gen p mean: 0.4167356789112091, gen p mean: 0.0, mean p set: 0.44730156660079956
loss_pred:0.08030927926301956, decouple_loss:0.07252123206853867
loss_pred:0.0776737779378891, decouple_loss:0.07281358540058136
Iteration: 58, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.41548529267311096, gen p mean: 0.0, mean p set: 0.4477333426475525
loss_pred:0.07758577913045883, decouple_loss:0.07158471643924713
The modified gen p mean: 0.41428807377815247, gen p mean: 0.0, mean p set: 0.4473608434200287
loss_pred:0.0806960016489029, decouple_loss:0.07098356634378433
The modified gen p mean: 0.4135197103023529, gen p mean: 0.0, mean p set: 0.4471467435359955
loss_pred:0.07649650424718857, decouple_loss:0.07109473645687103
Iteration: 59, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.417117178440094, gen p mean: 0.0, mean p set: 0.44806838035583496
loss_pred:0.07552453875541687, decouple_loss:0.06930824369192123
The modified gen p mean: 0.4161381721496582, gen p mean: 0.0, mean p set: 0.4475364685058594
loss_pred:0.07508572936058044, decouple_loss:0.06897010654211044
The modified gen p mean: 0.4187333881855011, gen p mean: 0.0, mean p set: 0.4465474784374237
loss_pred:0.07892882078886032, decouple_loss:0.06955933570861816
Iteration: 60, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4195581078529358, gen p mean: 0.0, mean p set: 0.44749704003334045
loss_pred:0.07529483735561371, decouple_loss:0.06986494362354279
The modified gen p mean: 0.4210802912712097, gen p mean: 0.0, mean p set: 0.4474572241306305
loss_pred:0.07897604256868362, decouple_loss:0.069646455347538
The modified gen p mean: 0.4210415184497833, gen p mean: 0.0, mean p set: 0.44782721996307373
loss_pred:0.07973182946443558, decouple_loss:0.06831134110689163
2023-05-05 17:04:42 testing...
The modified gen p mean: 0.4208061397075653, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.08395996689796448, decouple_loss:0.06880413740873337
The modified gen p mean: 0.42122572660446167, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.420144259929657, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.08036084473133087, decouple_loss:0.0682479739189148
loss_pred:0.08202799409627914, decouple_loss:0.06926801800727844
WV_1_PC_0_EH_0_PS_40_6, loss: 0.08555494248867035, avg_mse: 0.08223381638526917
current test mse: 0.082234
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
NaN value num: 0
Iteration: 61, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4224102199077606, gen p mean: 0.0, mean p set: 0.4521242678165436
loss_pred:0.0811963900923729, decouple_loss:0.07140593230724335
The modified gen p mean: 0.4182519316673279, gen p mean: 0.0, mean p set: 0.45036324858665466
loss_pred:0.07797221094369888, decouple_loss:0.06977981328964233
The modified gen p mean: 0.41894397139549255, gen p mean: 0.0, mean p set: 0.4521697759628296
loss_pred:0.08267293125391006, decouple_loss:0.07008407264947891
Iteration: 62, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4142519235610962, gen p mean: 0.0, mean p set: 0.4521923363208771
loss_pred:0.081781305372715, decouple_loss:0.06887684762477875
The modified gen p mean: 0.41563019156455994, gen p mean: 0.0, mean p set: 0.452515572309494
loss_pred:0.08269261568784714, decouple_loss:0.06903641670942307
The modified gen p mean: 0.41412514448165894, gen p mean: 0.0, mean p set: 0.4525927007198334
loss_pred:0.08292576670646667, decouple_loss:0.069068543612957
Iteration: 63, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.41599375009536743, gen p mean: 0.0, mean p set: 0.4494739770889282
loss_pred:0.08094630390405655, decouple_loss:0.06939060986042023
The modified gen p mean: 0.4153345823287964, gen p mean: 0.0, mean p set: 0.4509148597717285
loss_pred:0.07707010954618454, decouple_loss:0.06971987336874008
The modified gen p mean: 0.4179607629776001, gen p mean: 0.0, mean p set: 0.4524637460708618
loss_pred:0.08028259873390198, decouple_loss:0.06916090846061707
Iteration: 64, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4163608253002167, gen p mean: 0.0, mean p set: 0.449949711561203
loss_pred:0.07912919670343399, decouple_loss:0.06771467626094818
The modified gen p mean: 0.4178624749183655, gen p mean: 0.0, mean p set: 0.4527881443500519
loss_pred:0.08196335285902023, decouple_loss:0.06900864094495773
The modified gen p mean: 0.41687119007110596, gen p mean: 0.0, mean p set: 0.4525114893913269
loss_pred:0.08081203699111938, decouple_loss:0.06981708854436874
Iteration: 65, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.41497012972831726, gen p mean: 0.0, mean p set: 0.45218008756637573
loss_pred:0.08129260689020157, decouple_loss:0.06874610483646393
The modified gen p mean: 0.41329583525657654, gen p mean: 0.0, mean p set: 0.4513484537601471
loss_pred:0.07933680713176727, decouple_loss:0.06751027703285217
The modified gen p mean: 0.41174745559692383, gen p mean: 0.0, mean p set: 0.45034095644950867
loss_pred:0.08168776333332062, decouple_loss:0.06764448434114456
Iteration: 66, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4209722876548767, gen p mean: 0.0, mean p set: 0.4524324834346771
loss_pred:0.07871726155281067, decouple_loss:0.06919433176517487
The modified gen p mean: 0.41857871413230896, gen p mean: 0.0, mean p set: 0.44929152727127075
loss_pred:0.0781204029917717, decouple_loss:0.06873821467161179
The modified gen p mean: 0.4185456931591034, gen p mean: 0.0, mean p set: 0.45275044441223145
loss_pred:0.07635214179754257, decouple_loss:0.06967885047197342
Iteration: 67, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4184528589248657, gen p mean: 0.0, mean p set: 0.4495861530303955
loss_pred:0.07904526591300964, decouple_loss:0.06805728375911713
The modified gen p mean: 0.4223386347293854, gen p mean: 0.0, mean p set: 0.45335903763771057
loss_pred:0.07496844232082367, decouple_loss:0.06939513236284256
The modified gen p mean: 0.41986891627311707, gen p mean: 0.0, mean p set: 0.4519013464450836
loss_pred:0.08009267598390579, decouple_loss:0.06590419262647629
Iteration: 68, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.417231023311615, gen p mean: 0.0, mean p set: 0.4503213167190552
loss_pred:0.07812502235174179, decouple_loss:0.06762662529945374
The modified gen p mean: 0.41898638010025024, gen p mean: 0.0, mean p set: 0.452744722366333
loss_pred:0.07835528254508972, decouple_loss:0.06872331351041794
The modified gen p mean: 0.41759178042411804, gen p mean: 0.0, mean p set: 0.45281848311424255
loss_pred:0.07872211933135986, decouple_loss:0.07029718160629272
Iteration: 69, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.41438576579093933, gen p mean: 0.0, mean p set: 0.4504959285259247
loss_pred:0.08143587410449982, decouple_loss:0.07012196630239487
The modified gen p mean: 0.4140438735485077, gen p mean: 0.0, mean p set: 0.4494730830192566
loss_pred:0.07784100621938705, decouple_loss:0.06838099658489227
The modified gen p mean: 0.41462981700897217, gen p mean: 0.0, mean p set: 0.44915124773979187
loss_pred:0.08149546384811401, decouple_loss:0.06898901611566544
Iteration: 70, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4193519353866577, gen p mean: 0.0, mean p set: 0.45195919275283813
loss_pred:0.07719112187623978, decouple_loss:0.06785143911838531
The modified gen p mean: 0.4171021580696106, gen p mean: 0.0, mean p set: 0.44993001222610474
loss_pred:0.078560970723629, decouple_loss:0.06703771650791168
The modified gen p mean: 0.4178282618522644, gen p mean: 0.0, mean p set: 0.4522422254085541
loss_pred:0.07917813211679459, decouple_loss:0.06787445396184921
2023-05-05 17:09:09 testing...
The modified gen p mean: 0.42446744441986084, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.08282776921987534, decouple_loss:0.06874650716781616
The modified gen p mean: 0.4252259135246277, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.42566820979118347, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.07901926338672638, decouple_loss:0.06809733808040619
loss_pred:0.08045472204685211, decouple_loss:0.06875961273908615
WV_1_PC_0_EH_0_PS_40_6, loss: 0.08419397473335266, avg_mse: 0.08098532259464264
current test mse: 0.080985
Iteration: 71, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.423504501581192, gen p mean: 0.0, mean p set: 0.4499017596244812
loss_pred:0.08039065450429916, decouple_loss:0.0667635053396225
The modified gen p mean: 0.42434391379356384, gen p mean: 0.0, mean p set: 0.4493626356124878
loss_pred:0.07979944348335266, decouple_loss:0.06719893217086792
The modified gen p mean: 0.42255279421806335, gen p mean: 0.0, mean p set: 0.44997072219848633
loss_pred:0.07913897931575775, decouple_loss:0.06754854321479797
Iteration: 72, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4240899384021759, gen p mean: 0.0, mean p set: 0.4523504674434662
loss_pred:0.07921403646469116, decouple_loss:0.06834739446640015
The modified gen p mean: 0.42292752861976624, gen p mean: 0.0, mean p set: 0.4507574439048767
loss_pred:0.08120604604482651, decouple_loss:0.06738023459911346
The modified gen p mean: 0.42247703671455383, gen p mean: 0.0, mean p set: 0.4504547715187073
loss_pred:0.08192022144794464, decouple_loss:0.06702025979757309
Iteration: 73, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.41694727540016174, gen p mean: 0.0, mean p set: 0.450737327337265
loss_pred:0.08150187134742737, decouple_loss:0.06652210652828217
The modified gen p mean: 0.4204915761947632, gen p mean: 0.0, mean p set: 0.45188307762145996
loss_pred:0.07857084274291992, decouple_loss:0.06890606135129929
The modified gen p mean: 0.4181705713272095, gen p mean: 0.0, mean p set: 0.4498138427734375
loss_pred:0.07887174934148788, decouple_loss:0.06639041751623154
Iteration: 74, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.41681042313575745, gen p mean: 0.0, mean p set: 0.4503243863582611
loss_pred:0.07823722809553146, decouple_loss:0.06654126942157745
The modified gen p mean: 0.4186028242111206, gen p mean: 0.0, mean p set: 0.44989094138145447
loss_pred:0.07714586704969406, decouple_loss:0.06748005747795105
The modified gen p mean: 0.4158706068992615, gen p mean: 0.0, mean p set: 0.4503864049911499
loss_pred:0.0805358961224556, decouple_loss:0.06680503487586975
Iteration: 75, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.42114946246147156, gen p mean: 0.0, mean p set: 0.45288676023483276
loss_pred:0.07902878522872925, decouple_loss:0.06502079218626022
The modified gen p mean: 0.42011699080467224, gen p mean: 0.0, mean p set: 0.4524017870426178
loss_pred:0.07789725810289383, decouple_loss:0.06534585356712341
The modified gen p mean: 0.4199345111846924, gen p mean: 0.0, mean p set: 0.4497171640396118
loss_pred:0.07690470665693283, decouple_loss:0.06462278217077255
Iteration: 76, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.42375871539115906, gen p mean: 0.0, mean p set: 0.4492310881614685
loss_pred:0.07814724743366241, decouple_loss:0.0645531415939331
The modified gen p mean: 0.42407679557800293, gen p mean: 0.0, mean p set: 0.45274588465690613
loss_pred:0.07805870473384857, decouple_loss:0.0647277683019638
The modified gen p mean: 0.42435598373413086, gen p mean: 0.0, mean p set: 0.4527750313282013
loss_pred:0.07269655913114548, decouple_loss:0.06555956602096558
Iteration: 77, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.42572322487831116, gen p mean: 0.0, mean p set: 0.4502466022968292
loss_pred:0.07859286665916443, decouple_loss:0.06278593093156815
The modified gen p mean: 0.42796507477760315, gen p mean: 0.0, mean p set: 0.4525245130062103
loss_pred:0.08063258975744247, decouple_loss:0.06289893388748169
The modified gen p mean: 0.42576923966407776, gen p mean: 0.0, mean p set: 0.45270055532455444
loss_pred:0.07640828937292099, decouple_loss:0.06451725214719772
Iteration: 78, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.42991960048675537, gen p mean: 0.0, mean p set: 0.45171716809272766
loss_pred:0.07861142605543137, decouple_loss:0.06236959621310234
The modified gen p mean: 0.4280683398246765, gen p mean: 0.0, mean p set: 0.45191019773483276
loss_pred:0.07346305251121521, decouple_loss:0.06262509524822235
The modified gen p mean: 0.42690613865852356, gen p mean: 0.0, mean p set: 0.45074281096458435
loss_pred:0.08073418587446213, decouple_loss:0.06185537576675415
Iteration: 79, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4235915541648865, gen p mean: 0.0, mean p set: 0.4504155218601227
loss_pred:0.07990933954715729, decouple_loss:0.06119675189256668
The modified gen p mean: 0.4262488782405853, gen p mean: 0.0, mean p set: 0.4507834315299988
loss_pred:0.07430851459503174, decouple_loss:0.06212082877755165
The modified gen p mean: 0.4260425269603729, gen p mean: 0.0, mean p set: 0.45021387934684753
loss_pred:0.07628610730171204, decouple_loss:0.06273883581161499
Iteration: 80, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4262518286705017, gen p mean: 0.0, mean p set: 0.45219019055366516
loss_pred:0.0792955532670021, decouple_loss:0.06146219000220299
The modified gen p mean: 0.4257853627204895, gen p mean: 0.0, mean p set: 0.4506973326206207
loss_pred:0.07810021191835403, decouple_loss:0.06169324368238449
The modified gen p mean: 0.4247184097766876, gen p mean: 0.0, mean p set: 0.4506123960018158
loss_pred:0.07910508662462234, decouple_loss:0.061144035309553146
2023-05-05 17:12:54 testing...
The modified gen p mean: 0.42726317048072815, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.07782050967216492, decouple_loss:0.060838378965854645
The modified gen p mean: 0.4276258647441864, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.07932582497596741, decouple_loss:0.062076546251773834
The modified gen p mean: 0.42668402194976807, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.08144117146730423, decouple_loss:0.06237764284014702
WV_1_PC_0_EH_0_PS_40_6, loss: 0.08261738717556, avg_mse: 0.07966049015522003
current test mse: 0.07966
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 81, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4284113645553589, gen p mean: 0.0, mean p set: 0.4491669833660126
The modified gen p mean: 0.42797398567199707, gen p mean: 0.0, mean p set: 0.4482733905315399
loss_pred:0.0770709440112114, decouple_loss:0.062024351209402084
loss_pred:0.07931984215974808, decouple_loss:0.06300105899572372
The modified gen p mean: 0.427813857793808, gen p mean: 0.0, mean p set: 0.4487597644329071
loss_pred:0.07695867121219635, decouple_loss:0.06173304095864296
Iteration: 82, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4291425347328186, gen p mean: 0.0, mean p set: 0.4496401250362396
loss_pred:0.07833218574523926, decouple_loss:0.06165938451886177
The modified gen p mean: 0.4289361536502838, gen p mean: 0.0, mean p set: 0.44951972365379333
loss_pred:0.07672934234142303, decouple_loss:0.061805080622434616
The modified gen p mean: 0.42905980348587036, gen p mean: 0.0, mean p set: 0.4491029977798462
loss_pred:0.08049866557121277, decouple_loss:0.062416426837444305
Iteration: 83, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4299685060977936, gen p mean: 0.0, mean p set: 0.44901883602142334
The modified gen p mean: 0.4284161627292633, gen p mean: 0.0, mean p set: 0.44925159215927124
loss_pred:0.07168228924274445, decouple_loss:0.05961744114756584
loss_pred:0.07402166724205017, decouple_loss:0.06006941199302673
The modified gen p mean: 0.42960184812545776, gen p mean: 0.0, mean p set: 0.4496367573738098
loss_pred:0.08061910420656204, decouple_loss:0.061317089945077896
Iteration: 84, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43127816915512085, gen p mean: 0.0, mean p set: 0.4498789310455322
loss_pred:0.08047138899564743, decouple_loss:0.059359949082136154
The modified gen p mean: 0.4293379783630371, gen p mean: 0.0, mean p set: 0.4493670165538788
loss_pred:0.07228181511163712, decouple_loss:0.05918177217245102
The modified gen p mean: 0.43104660511016846, gen p mean: 0.0, mean p set: 0.4489397704601288
loss_pred:0.07317907363176346, decouple_loss:0.057782746851444244
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 85, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4305732548236847, gen p mean: 0.0, mean p set: 0.4499637186527252
loss_pred:0.07776617258787155, decouple_loss:0.0579514317214489
The modified gen p mean: 0.43008169531822205, gen p mean: 0.0, mean p set: 0.4499538242816925
loss_pred:0.07596313208341599, decouple_loss:0.05834854394197464
The modified gen p mean: 0.42957594990730286, gen p mean: 0.0, mean p set: 0.4495936930179596
loss_pred:0.07387208938598633, decouple_loss:0.05666600540280342
Iteration: 86, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4299570918083191, gen p mean: 0.0, mean p set: 0.4494534134864807
The modified gen p mean: 0.42963916063308716, gen p mean: 0.0, mean p set: 0.44947290420532227
loss_pred:0.07333365082740784, decouple_loss:0.05624934285879135
loss_pred:0.07373133301734924, decouple_loss:0.05733589828014374
The modified gen p mean: 0.4310115575790405, gen p mean: 0.0, mean p set: 0.44951876997947693
loss_pred:0.07585747539997101, decouple_loss:0.05710180103778839
Iteration: 87, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4327852725982666, gen p mean: 0.0, mean p set: 0.4490435719490051
loss_pred:0.07581812888383865, decouple_loss:0.05599871277809143
The modified gen p mean: 0.43308502435684204, gen p mean: 0.0, mean p set: 0.4497752785682678
loss_pred:0.07572640478610992, decouple_loss:0.0564582422375679
The modified gen p mean: 0.4325657784938812, gen p mean: 0.0, mean p set: 0.44942986965179443
loss_pred:0.07641789317131042, decouple_loss:0.0563199520111084
Iteration: 88, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.433025598526001, gen p mean: 0.0, mean p set: 0.4478098452091217
The modified gen p mean: 0.4334523677825928, gen p mean: 0.0, mean p set: 0.448492169380188
loss_pred:0.07422461360692978, decouple_loss:0.05550697445869446
loss_pred:0.07214885950088501, decouple_loss:0.05608692392706871
The modified gen p mean: 0.43462759256362915, gen p mean: 0.0, mean p set: 0.4486114978790283
loss_pred:0.07620908319950104, decouple_loss:0.05519018694758415
Iteration: 89, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43003296852111816, gen p mean: 0.0, mean p set: 0.4483001232147217
loss_pred:0.0739658772945404, decouple_loss:0.0558680035173893
The modified gen p mean: 0.4314480125904083, gen p mean: 0.0, mean p set: 0.4494372606277466
loss_pred:0.07852771878242493, decouple_loss:0.05534587800502777
The modified gen p mean: 0.43148961663246155, gen p mean: 0.0, mean p set: 0.45005539059638977
loss_pred:0.07633201777935028, decouple_loss:0.055290017277002335
Iteration: 90, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4341013431549072, gen p mean: 0.0, mean p set: 0.4498986005783081
loss_pred:0.07794573158025742, decouple_loss:0.05545136705040932
The modified gen p mean: 0.4334951639175415, gen p mean: 0.0, mean p set: 0.44830653071403503
loss_pred:0.07122429460287094, decouple_loss:0.05471346527338028
The modified gen p mean: 0.4329949915409088, gen p mean: 0.0, mean p set: 0.4488733410835266
loss_pred:0.07738319039344788, decouple_loss:0.05491442605853081
2023-05-05 17:17:23 testing...
The modified gen p mean: 0.43349969387054443, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.07904790341854095, decouple_loss:0.05536258593201637
The modified gen p mean: 0.4341435730457306, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4347330629825592, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.07577448338270187, decouple_loss:0.053920600563287735
loss_pred:0.07736688107252121, decouple_loss:0.0554109662771225
WV_1_PC_0_EH_0_PS_40_6, loss: 0.0801413282752037, avg_mse: 0.07722479850053787
current test mse: 0.077225
Iteration: 91, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43419307470321655, gen p mean: 0.0, mean p set: 0.44917774200439453
loss_pred:0.07404103875160217, decouple_loss:0.05386535823345184
The modified gen p mean: 0.43494948744773865, gen p mean: 0.0, mean p set: 0.44956550002098083
loss_pred:0.076894611120224, decouple_loss:0.053876690566539764
The modified gen p mean: 0.4351557195186615, gen p mean: 0.0, mean p set: 0.448577344417572
loss_pred:0.07397426664829254, decouple_loss:0.054019272327423096
Iteration: 92, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43473193049430847, gen p mean: 0.0, mean p set: 0.4480241537094116
loss_pred:0.07564447075128555, decouple_loss:0.0547788068652153
The modified gen p mean: 0.4341859817504883, gen p mean: 0.0, mean p set: 0.4486406445503235
loss_pred:0.07411348819732666, decouple_loss:0.05408153310418129
The modified gen p mean: 0.4343016743659973, gen p mean: 0.0, mean p set: 0.4500062167644501
loss_pred:0.07615367323160172, decouple_loss:0.05433664470911026
Iteration: 93, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4319193661212921, gen p mean: 0.0, mean p set: 0.4486786425113678
loss_pred:0.0762002170085907, decouple_loss:0.05219597369432449
The modified gen p mean: 0.43182477355003357, gen p mean: 0.0, mean p set: 0.4484219551086426
loss_pred:0.07394316047430038, decouple_loss:0.0550464428961277
The modified gen p mean: 0.4318233132362366, gen p mean: 0.0, mean p set: 0.4480302929878235
loss_pred:0.06895837187767029, decouple_loss:0.05341525003314018
Iteration: 94, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4257428050041199, gen p mean: 0.0, mean p set: 0.4494735598564148
loss_pred:0.07312171906232834, decouple_loss:0.05540861934423447
The modified gen p mean: 0.4262544512748718, gen p mean: 0.0, mean p set: 0.44861117005348206
loss_pred:0.0719267874956131, decouple_loss:0.054053232073783875
The modified gen p mean: 0.4251508414745331, gen p mean: 0.0, mean p set: 0.4490050673484802
loss_pred:0.07155752927064896, decouple_loss:0.05612687021493912
Iteration: 95, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4283432364463806, gen p mean: 0.0, mean p set: 0.4498666524887085
loss_pred:0.07529755681753159, decouple_loss:0.052740342915058136
The modified gen p mean: 0.4298142194747925, gen p mean: 0.0, mean p set: 0.4494384229183197
loss_pred:0.07033880054950714, decouple_loss:0.053529925644397736
The modified gen p mean: 0.428120493888855, gen p mean: 0.0, mean p set: 0.44934189319610596
loss_pred:0.07126444578170776, decouple_loss:0.05307534709572792
Iteration: 96, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4360703229904175, gen p mean: 0.0, mean p set: 0.4484536051750183The modified gen p mean: 0.43691912293434143, gen p mean: 0.0, mean p set: 0.449928879737854
loss_pred:0.0714951753616333, decouple_loss:0.05519025772809982
loss_pred:0.07679060101509094, decouple_loss:0.053947433829307556
The modified gen p mean: 0.4352986812591553, gen p mean: 0.0, mean p set: 0.4496358335018158
loss_pred:0.07393865287303925, decouple_loss:0.054621677845716476
Iteration: 97, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4375779926776886, gen p mean: 0.0, mean p set: 0.4494089186191559
loss_pred:0.07189778983592987, decouple_loss:0.052733972668647766
The modified gen p mean: 0.436882346868515, gen p mean: 0.0, mean p set: 0.4480001628398895
loss_pred:0.07315278798341751, decouple_loss:0.0519377663731575
The modified gen p mean: 0.43650907278060913, gen p mean: 0.0, mean p set: 0.4492647647857666
loss_pred:0.06885272264480591, decouple_loss:0.05129190534353256
Iteration: 98, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4340481758117676, gen p mean: 0.0, mean p set: 0.4495360851287842
loss_pred:0.07712125778198242, decouple_loss:0.05241129919886589
The modified gen p mean: 0.43474718928337097, gen p mean: 0.0, mean p set: 0.4488937258720398
loss_pred:0.07671908289194107, decouple_loss:0.052619148045778275
The modified gen p mean: 0.4345038831233978, gen p mean: 0.0, mean p set: 0.44972550868988037
loss_pred:0.07201093435287476, decouple_loss:0.051750484853982925
Iteration: 99, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4329341650009155, gen p mean: 0.0, mean p set: 0.44845834374427795
loss_pred:0.07128571718931198, decouple_loss:0.05179590731859207
The modified gen p mean: 0.43426263332366943, gen p mean: 0.0, mean p set: 0.4493010640144348
loss_pred:0.07505642622709274, decouple_loss:0.051596034318208694
The modified gen p mean: 0.43410176038742065, gen p mean: 0.0, mean p set: 0.4486761689186096
loss_pred:0.072578564286232, decouple_loss:0.0513334795832634
Iteration: 100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4365708827972412, gen p mean: 0.0, mean p set: 0.44836896657943726
loss_pred:0.07456864416599274, decouple_loss:0.050186801701784134
The modified gen p mean: 0.4355631172657013, gen p mean: 0.0, mean p set: 0.4488653242588043
loss_pred:0.07540574669837952, decouple_loss:0.04999969154596329
The modified gen p mean: 0.4364277422428131, gen p mean: 0.0, mean p set: 0.4498598277568817
loss_pred:0.07370424270629883, decouple_loss:0.05165194720029831
2023-05-05 17:21:10 testing...
The modified gen p mean: 0.43756502866744995, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.0755244567990303, decouple_loss:0.050212398171424866
The modified gen p mean: 0.43867069482803345, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.43862518668174744, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.07274647802114487, decouple_loss:0.04905035346746445
loss_pred:0.07382470369338989, decouple_loss:0.05090971291065216
WV_1_PC_0_EH_0_PS_40_6, loss: 0.07653475552797318, avg_mse: 0.07398463040590286
current test mse: 0.073985
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
NaN value num: 0
Iteration: 101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4363235533237457, gen p mean: 0.0, mean p set: 0.4495377540588379
loss_pred:0.07188515365123749, decouple_loss:0.052798058837652206
The modified gen p mean: 0.4361349642276764, gen p mean: 0.0, mean p set: 0.45164522528648376
loss_pred:0.07396799325942993, decouple_loss:0.053574979305267334
The modified gen p mean: 0.4356456696987152, gen p mean: 0.0, mean p set: 0.4495220482349396
loss_pred:0.07474478334188461, decouple_loss:0.051852744072675705
Iteration: 102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.437492698431015, gen p mean: 0.0, mean p set: 0.4499515891075134
loss_pred:0.07332362234592438, decouple_loss:0.05204940587282181
The modified gen p mean: 0.4380207657814026, gen p mean: 0.0, mean p set: 0.448453426361084
loss_pred:0.07130236178636551, decouple_loss:0.05206889286637306
The modified gen p mean: 0.43655043840408325, gen p mean: 0.0, mean p set: 0.4543490707874298
loss_pred:0.07638493180274963, decouple_loss:0.05333438888192177
Iteration: 103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43802154064178467, gen p mean: 0.0, mean p set: 0.44856709241867065
The modified gen p mean: 0.4395686984062195, gen p mean: 0.0, mean p set: 0.4516671597957611
loss_pred:0.07014783471822739, decouple_loss:0.05196842923760414
loss_pred:0.07295211404561996, decouple_loss:0.055265024304389954
The modified gen p mean: 0.439444363117218, gen p mean: 0.0, mean p set: 0.45176732540130615
loss_pred:0.07224220782518387, decouple_loss:0.05499992519617081
Iteration: 104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43781378865242004, gen p mean: 0.0, mean p set: 0.4538205564022064
loss_pred:0.07475266605615616, decouple_loss:0.05880604684352875
The modified gen p mean: 0.4371339976787567, gen p mean: 0.0, mean p set: 0.4540169835090637
loss_pred:0.0743238553404808, decouple_loss:0.05435696989297867
The modified gen p mean: 0.4385843575000763, gen p mean: 0.0, mean p set: 0.452727735042572
loss_pred:0.0734700858592987, decouple_loss:0.05495379492640495
Iteration: 105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4416165351867676, gen p mean: 0.0, mean p set: 0.45009464025497437
loss_pred:0.07106692343950272, decouple_loss:0.05312330275774002
The modified gen p mean: 0.4404298663139343, gen p mean: 0.0, mean p set: 0.4495052993297577
loss_pred:0.07064653933048248, decouple_loss:0.0530722476541996
The modified gen p mean: 0.44277021288871765, gen p mean: 0.0, mean p set: 0.4528384804725647
loss_pred:0.07303827255964279, decouple_loss:0.05532613396644592
Iteration: 106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44223499298095703, gen p mean: 0.0, mean p set: 0.4509917199611664
loss_pred:0.06604407727718353, decouple_loss:0.05462712422013283
The modified gen p mean: 0.4413333833217621, gen p mean: 0.0, mean p set: 0.4518432915210724
loss_pred:0.06766221672296524, decouple_loss:0.053921185433864594
The modified gen p mean: 0.44023293256759644, gen p mean: 0.0, mean p set: 0.4520629048347473
loss_pred:0.067489393055439, decouple_loss:0.0534849539399147
Iteration: 107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4401169717311859, gen p mean: 0.0, mean p set: 0.4498278796672821
loss_pred:0.06921844929456711, decouple_loss:0.05234576389193535
The modified gen p mean: 0.44068804383277893, gen p mean: 0.0, mean p set: 0.45195209980010986
loss_pred:0.069533571600914, decouple_loss:0.054711826145648956
The modified gen p mean: 0.4392889738082886, gen p mean: 0.0, mean p set: 0.4489629566669464
loss_pred:0.06672770529985428, decouple_loss:0.051608216017484665
Iteration: 108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4383458197116852, gen p mean: 0.0, mean p set: 0.4482481777667999
loss_pred:0.06968842446804047, decouple_loss:0.053023166954517365
The modified gen p mean: 0.43927377462387085, gen p mean: 0.0, mean p set: 0.4510028660297394
loss_pred:0.06352662295103073, decouple_loss:0.05333258584141731
The modified gen p mean: 0.43829724192619324, gen p mean: 0.0, mean p set: 0.45162856578826904
loss_pred:0.06620239466428757, decouple_loss:0.052680034190416336
Iteration: 109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43772566318511963, gen p mean: 0.0, mean p set: 0.4533843994140625
loss_pred:0.07072314620018005, decouple_loss:0.05424988269805908
The modified gen p mean: 0.4359290599822998, gen p mean: 0.0, mean p set: 0.45018160343170166
loss_pred:0.06855151802301407, decouple_loss:0.05418027192354202
The modified gen p mean: 0.43861499428749084, gen p mean: 0.0, mean p set: 0.45325586199760437
loss_pred:0.06955201178789139, decouple_loss:0.05466097965836525
Iteration: 110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4335344433784485, gen p mean: 0.0, mean p set: 0.4525880217552185
loss_pred:0.06698033213615417, decouple_loss:0.052335068583488464
The modified gen p mean: 0.43399807810783386, gen p mean: 0.0, mean p set: 0.45157068967819214
loss_pred:0.06621348857879639, decouple_loss:0.05317685380578041
The modified gen p mean: 0.4334120750427246, gen p mean: 0.0, mean p set: 0.45186808705329895
loss_pred:0.06476204842329025, decouple_loss:0.053033746778964996
2023-05-05 17:25:52 testing...
The modified gen p mean: 0.43018409609794617, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.07225669920444489, decouple_loss:0.053391359746456146
The modified gen p mean: 0.42999374866485596, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4305981397628784, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.07016018778085709, decouple_loss:0.05454524606466293
loss_pred:0.06937747448682785, decouple_loss:0.052579738199710846
WV_1_PC_0_EH_0_PS_40_6, loss: 0.07327339053153992, avg_mse: 0.07117071002721786
current test mse: 0.071171
Iteration: 111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43244045972824097, gen p mean: 0.0, mean p set: 0.4532664716243744
loss_pred:0.06955073028802872, decouple_loss:0.05383778735995293
The modified gen p mean: 0.4311140775680542, gen p mean: 0.0, mean p set: 0.4541688859462738
loss_pred:0.07033461332321167, decouple_loss:0.05337902158498764
The modified gen p mean: 0.4312959909439087, gen p mean: 0.0, mean p set: 0.44843316078186035
loss_pred:0.0652107447385788, decouple_loss:0.051883772015571594
Iteration: 112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43180063366889954, gen p mean: 0.0, mean p set: 0.45417720079421997
loss_pred:0.07206632196903229, decouple_loss:0.05433870106935501
The modified gen p mean: 0.43014732003211975, gen p mean: 0.0, mean p set: 0.44952961802482605
loss_pred:0.06735903024673462, decouple_loss:0.052423037588596344
The modified gen p mean: 0.43093574047088623, gen p mean: 0.0, mean p set: 0.44964808225631714
loss_pred:0.0692237988114357, decouple_loss:0.05336838588118553
Iteration: 113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4315427243709564, gen p mean: 0.0, mean p set: 0.44850653409957886
loss_pred:0.06500769406557083, decouple_loss:0.05144185945391655
The modified gen p mean: 0.4331390857696533, gen p mean: 0.0, mean p set: 0.45262470841407776
loss_pred:0.06775736808776855, decouple_loss:0.051947496831417084
The modified gen p mean: 0.4334600865840912, gen p mean: 0.0, mean p set: 0.45075568556785583
loss_pred:0.06441429257392883, decouple_loss:0.05222892761230469
Iteration: 114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4324316382408142, gen p mean: 0.0, mean p set: 0.44942015409469604
loss_pred:0.06892968714237213, decouple_loss:0.051232874393463135
The modified gen p mean: 0.4321620762348175, gen p mean: 0.0, mean p set: 0.450724720954895
loss_pred:0.06351247429847717, decouple_loss:0.05114186555147171
The modified gen p mean: 0.4332267940044403, gen p mean: 0.0, mean p set: 0.4501332640647888
loss_pred:0.0665464848279953, decouple_loss:0.051409583538770676
Iteration: 115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4352012872695923, gen p mean: 0.0, mean p set: 0.4532550275325775
loss_pred:0.06774932146072388, decouple_loss:0.0516383983194828
The modified gen p mean: 0.43431803584098816, gen p mean: 0.0, mean p set: 0.4530285596847534
loss_pred:0.06859999895095825, decouple_loss:0.053518932312726974
The modified gen p mean: 0.432879239320755, gen p mean: 0.0, mean p set: 0.45311251282691956
loss_pred:0.06480885297060013, decouple_loss:0.05117575824260712
Iteration: 116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43975725769996643, gen p mean: 0.0, mean p set: 0.44883227348327637
loss_pred:0.06502678990364075, decouple_loss:0.051063619554042816
The modified gen p mean: 0.4408118426799774, gen p mean: 0.0, mean p set: 0.4539194405078888
loss_pred:0.06683564931154251, decouple_loss:0.05246413126587868
The modified gen p mean: 0.43856558203697205, gen p mean: 0.0, mean p set: 0.45088011026382446
loss_pred:0.06262709945440292, decouple_loss:0.0524161159992218
Iteration: 117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43861111998558044, gen p mean: 0.0, mean p set: 0.4499378204345703
loss_pred:0.06618651747703552, decouple_loss:0.05146817862987518
The modified gen p mean: 0.44053730368614197, gen p mean: 0.0, mean p set: 0.4523541033267975
loss_pred:0.06739670038223267, decouple_loss:0.05084868520498276
The modified gen p mean: 0.4396003484725952, gen p mean: 0.0, mean p set: 0.4524628818035126
loss_pred:0.06500202417373657, decouple_loss:0.05118333175778389
Iteration: 118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4339495301246643, gen p mean: 0.0, mean p set: 0.4508405923843384
loss_pred:0.059300366789102554, decouple_loss:0.05071723833680153
The modified gen p mean: 0.4343462884426117, gen p mean: 0.0, mean p set: 0.45060133934020996
loss_pred:0.06060599908232689, decouple_loss:0.04995966702699661
The modified gen p mean: 0.43426764011383057, gen p mean: 0.0, mean p set: 0.4501151144504547
loss_pred:0.06652015447616577, decouple_loss:0.05021535977721214
Iteration: 119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4300100803375244, gen p mean: 0.0, mean p set: 0.45113280415534973
loss_pred:0.06083768606185913, decouple_loss:0.04900854825973511
The modified gen p mean: 0.43225690722465515, gen p mean: 0.0, mean p set: 0.45210903882980347
loss_pred:0.06584969162940979, decouple_loss:0.05117075517773628
The modified gen p mean: 0.42605748772621155, gen p mean: 0.0, mean p set: 0.4507615268230438
loss_pred:0.06643331050872803, decouple_loss:0.0516594760119915
Iteration: 120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4363035261631012, gen p mean: 0.0, mean p set: 0.45262858271598816
loss_pred:0.06439428776502609, decouple_loss:0.05009876936674118
The modified gen p mean: 0.4360140264034271, gen p mean: 0.0, mean p set: 0.45237189531326294
loss_pred:0.06711049377918243, decouple_loss:0.04934179037809372
The modified gen p mean: 0.4362933933734894, gen p mean: 0.0, mean p set: 0.45197993516921997
loss_pred:0.06347882002592087, decouple_loss:0.05114417523145676
2023-05-05 17:29:40 testing...
The modified gen p mean: 0.436968058347702, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.0691477507352829, decouple_loss:0.05090944841504097
The modified gen p mean: 0.43620508909225464, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.43584901094436646, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.0673278197646141, decouple_loss:0.05133434757590294
loss_pred:0.06690870225429535, decouple_loss:0.05022788047790527
WV_1_PC_0_EH_0_PS_40_6, loss: 0.07033595442771912, avg_mse: 0.06836897134780884
current test mse: 0.068369
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
NaN value num: 0
Iteration: 121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43330568075180054, gen p mean: 0.0, mean p set: 0.4528920352458954
loss_pred:0.06418763846158981, decouple_loss:0.05284622311592102
The modified gen p mean: 0.4379710257053375, gen p mean: 0.0, mean p set: 0.45289722084999084
loss_pred:0.06304332613945007, decouple_loss:0.051134735345840454
The modified gen p mean: 0.43459632992744446, gen p mean: 0.0, mean p set: 0.45393162965774536
loss_pred:0.06818591803312302, decouple_loss:0.052703216671943665
Iteration: 122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4372086822986603, gen p mean: 0.0, mean p set: 0.45228642225265503
The modified gen p mean: 0.43828630447387695, gen p mean: 0.0, mean p set: 0.4526858329772949
loss_pred:0.062307748943567276, decouple_loss:0.05324994772672653
loss_pred:0.06387389451265335, decouple_loss:0.053405240178108215
The modified gen p mean: 0.4391356408596039, gen p mean: 0.0, mean p set: 0.4526466727256775
loss_pred:0.06422218680381775, decouple_loss:0.051051802933216095
Iteration: 123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43353715538978577, gen p mean: 0.0, mean p set: 0.45198309421539307
loss_pred:0.06584392488002777, decouple_loss:0.05241342633962631
The modified gen p mean: 0.43195798993110657, gen p mean: 0.0, mean p set: 0.4523969888687134
The modified gen p mean: 0.43100637197494507, gen p mean: 0.0, mean p set: 0.4531596302986145
loss_pred:0.06469685584306717, decouple_loss:0.052772317081689835
loss_pred:0.06760228425264359, decouple_loss:0.05393858626484871
Iteration: 124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4399319589138031, gen p mean: 0.0, mean p set: 0.45306316018104553
loss_pred:0.061511240899562836, decouple_loss:0.053751930594444275
The modified gen p mean: 0.44062089920043945, gen p mean: 0.0, mean p set: 0.4538623094558716
loss_pred:0.06645660847425461, decouple_loss:0.05354299768805504
The modified gen p mean: 0.43726059794425964, gen p mean: 0.0, mean p set: 0.45241400599479675
loss_pred:0.06194348260760307, decouple_loss:0.0543353296816349
Iteration: 125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4448148310184479, gen p mean: 0.0, mean p set: 0.453777015209198
loss_pred:0.06679654121398926, decouple_loss:0.05518856272101402
The modified gen p mean: 0.4455420970916748, gen p mean: 0.0, mean p set: 0.4537212550640106
loss_pred:0.06779006868600845, decouple_loss:0.05461769923567772
The modified gen p mean: 0.44639748334884644, gen p mean: 0.0, mean p set: 0.4512217342853546
loss_pred:0.062473803758621216, decouple_loss:0.05477786064147949
Iteration: 126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44059357047080994, gen p mean: 0.0, mean p set: 0.45287367701530457
loss_pred:0.06389786303043365, decouple_loss:0.053601935505867004
The modified gen p mean: 0.44141852855682373, gen p mean: 0.0, mean p set: 0.45145025849342346
loss_pred:0.06503281742334366, decouple_loss:0.05409662425518036
The modified gen p mean: 0.4447399973869324, gen p mean: 0.0, mean p set: 0.45403215289115906
loss_pred:0.062144652009010315, decouple_loss:0.05441378057003021
Iteration: 127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44407153129577637, gen p mean: 0.0, mean p set: 0.45256444811820984
loss_pred:0.060458648949861526, decouple_loss:0.05367482453584671
The modified gen p mean: 0.4449566602706909, gen p mean: 0.0, mean p set: 0.4529043138027191
loss_pred:0.06320766359567642, decouple_loss:0.053699031472206116
The modified gen p mean: 0.4424307346343994, gen p mean: 0.0, mean p set: 0.4526461064815521
loss_pred:0.06313752382993698, decouple_loss:0.054052870720624924
Iteration: 128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.42790842056274414, gen p mean: 0.0, mean p set: 0.453741192817688
loss_pred:0.06469187885522842, decouple_loss:0.05520932748913765
The modified gen p mean: 0.4319930970668793, gen p mean: 0.0, mean p set: 0.4519711136817932
loss_pred:0.06980358809232712, decouple_loss:0.05687440186738968
The modified gen p mean: 0.4259527921676636, gen p mean: 0.0, mean p set: 0.45228806138038635
loss_pred:0.06138342618942261, decouple_loss:0.05677761510014534
Iteration: 129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524979889392853, gen p mean: 0.0, mean p set: 0.45114362239837646
loss_pred:0.06157625839114189, decouple_loss:0.05517319589853287
The modified gen p mean: 0.4543107748031616, gen p mean: 0.0, mean p set: 0.4522169232368469
loss_pred:0.06069589778780937, decouple_loss:0.05494847521185875
The modified gen p mean: 0.455660343170166, gen p mean: 0.0, mean p set: 0.4513972997665405
loss_pred:0.06302748620510101, decouple_loss:0.054524440318346024
Iteration: 130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4570882320404053, gen p mean: 0.0, mean p set: 0.4516848623752594
loss_pred:0.0668327584862709, decouple_loss:0.05569317191839218
The modified gen p mean: 0.4530923366546631, gen p mean: 0.0, mean p set: 0.4528461992740631
loss_pred:0.06217839568853378, decouple_loss:0.05498475208878517
The modified gen p mean: 0.45692911744117737, gen p mean: 0.0, mean p set: 0.45358291268348694
loss_pred:0.06085975468158722, decouple_loss:0.05519436299800873
2023-05-05 17:34:08 testing...
The modified gen p mean: 0.4425310492515564, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.06807731091976166, decouple_loss:0.05703253671526909
The modified gen p mean: 0.4433335065841675, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4437330365180969, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.06526206433773041, decouple_loss:0.05797351524233818
loss_pred:0.06597411632537842, decouple_loss:0.05665624886751175
WV_1_PC_0_EH_0_PS_40_6, loss: 0.0692988708615303, avg_mse: 0.06728234142065048
current test mse: 0.067282
Iteration: 131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4404376447200775, gen p mean: 0.0, mean p set: 0.452355295419693
loss_pred:0.059464626014232635, decouple_loss:0.055890779942274094
The modified gen p mean: 0.4443419277667999, gen p mean: 0.0, mean p set: 0.45386558771133423
loss_pred:0.06030154228210449, decouple_loss:0.053176283836364746
The modified gen p mean: 0.4450582265853882, gen p mean: 0.0, mean p set: 0.4531908929347992
loss_pred:0.05928778648376465, decouple_loss:0.05395037680864334
Iteration: 132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4230021834373474, gen p mean: 0.0, mean p set: 0.4531821608543396
loss_pred:0.06232819706201553, decouple_loss:0.05586051195859909
The modified gen p mean: 0.43366771936416626, gen p mean: 0.0, mean p set: 0.45171958208084106
loss_pred:0.06232118606567383, decouple_loss:0.05549367144703865
The modified gen p mean: 0.43579018115997314, gen p mean: 0.0, mean p set: 0.4517561197280884
loss_pred:0.06566981971263885, decouple_loss:0.05632079020142555
Iteration: 133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45085468888282776, gen p mean: 0.0, mean p set: 0.45195239782333374
loss_pred:0.06327420473098755, decouple_loss:0.05427222326397896
The modified gen p mean: 0.44935351610183716, gen p mean: 0.0, mean p set: 0.45221495628356934
loss_pred:0.0620369017124176, decouple_loss:0.05515362694859505
The modified gen p mean: 0.4499061405658722, gen p mean: 0.0, mean p set: 0.4530986547470093
loss_pred:0.06160953640937805, decouple_loss:0.05620412528514862
Iteration: 134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453142911195755, gen p mean: 0.0, mean p set: 0.4519937038421631
loss_pred:0.06105644255876541, decouple_loss:0.05479046329855919
The modified gen p mean: 0.4551340639591217, gen p mean: 0.0, mean p set: 0.45240697264671326
loss_pred:0.0587933287024498, decouple_loss:0.05407313257455826
The modified gen p mean: 0.4554136097431183, gen p mean: 0.0, mean p set: 0.4540221691131592
loss_pred:0.05819808691740036, decouple_loss:0.05588469281792641
Iteration: 135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452642798423767, gen p mean: 0.0, mean p set: 0.452574759721756
loss_pred:0.06161976978182793, decouple_loss:0.05285310000181198
The modified gen p mean: 0.4488643705844879, gen p mean: 0.0, mean p set: 0.4518786072731018
loss_pred:0.06591583043336868, decouple_loss:0.05469988286495209
The modified gen p mean: 0.45096755027770996, gen p mean: 0.0, mean p set: 0.451114296913147
loss_pred:0.06241234019398689, decouple_loss:0.05545340105891228
Iteration: 136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4408632218837738, gen p mean: 0.0, mean p set: 0.45181983709335327
loss_pred:0.06755153834819794, decouple_loss:0.05304189771413803
The modified gen p mean: 0.4399479031562805, gen p mean: 0.0, mean p set: 0.45203232765197754
loss_pred:0.06284896284341812, decouple_loss:0.0537165142595768
The modified gen p mean: 0.44114255905151367, gen p mean: 0.0, mean p set: 0.4508371949195862
loss_pred:0.062178608030080795, decouple_loss:0.053627438843250275
Iteration: 137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4395526945590973, gen p mean: 0.0, mean p set: 0.4525179862976074
loss_pred:0.05765168368816376, decouple_loss:0.05257294699549675
The modified gen p mean: 0.4397352337837219, gen p mean: 0.0, mean p set: 0.4523479640483856
loss_pred:0.06006665527820587, decouple_loss:0.05233100801706314
The modified gen p mean: 0.44246193766593933, gen p mean: 0.0, mean p set: 0.45362168550491333
loss_pred:0.0616738386452198, decouple_loss:0.05227912962436676
Iteration: 138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45622000098228455, gen p mean: 0.0, mean p set: 0.4513482451438904
loss_pred:0.06182612106204033, decouple_loss:0.052326470613479614
The modified gen p mean: 0.4570828676223755, gen p mean: 0.0, mean p set: 0.4511723518371582
loss_pred:0.061701368540525436, decouple_loss:0.053935740143060684
The modified gen p mean: 0.4544762969017029, gen p mean: 0.0, mean p set: 0.4531313478946686
loss_pred:0.06007479503750801, decouple_loss:0.052975594997406006
Iteration: 139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464685320854187, gen p mean: 0.0, mean p set: 0.45172953605651855
loss_pred:0.05868494138121605, decouple_loss:0.05196474865078926
The modified gen p mean: 0.45001083612442017, gen p mean: 0.0, mean p set: 0.4526279866695404
loss_pred:0.0640612319111824, decouple_loss:0.05281377211213112
The modified gen p mean: 0.4408628046512604, gen p mean: 0.0, mean p set: 0.4525260329246521
loss_pred:0.060051120817661285, decouple_loss:0.05306103825569153
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
NaN value num: 0
Iteration: 140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4355142414569855, gen p mean: 0.0, mean p set: 0.45105352997779846
The modified gen p mean: 0.4327073097229004, gen p mean: 0.0, mean p set: 0.45288947224617004
loss_pred:0.05836578086018562, decouple_loss:0.052804723381996155
loss_pred:0.06157796084880829, decouple_loss:0.05246015638113022
The modified gen p mean: 0.4326721429824829, gen p mean: 0.0, mean p set: 0.45338064432144165
loss_pred:0.06295020133256912, decouple_loss:0.05256396904587746
2023-05-05 17:38:45 testing...
The modified gen p mean: 0.4433997571468353, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.06619248539209366, decouple_loss:0.05555132403969765
The modified gen p mean: 0.4461743235588074, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.06329553574323654, decouple_loss:0.05580965057015419
The modified gen p mean: 0.44456422328948975, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.06438324600458145, decouple_loss:0.054295577108860016
WV_1_PC_0_EH_0_PS_40_6, loss: 0.06738470494747162, avg_mse: 0.06571643054485321
current test mse: 0.065716
Iteration: 141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43863746523857117, gen p mean: 0.0, mean p set: 0.4516505002975464
loss_pred:0.05812278389930725, decouple_loss:0.05329341068863869
The modified gen p mean: 0.4439801275730133, gen p mean: 0.0, mean p set: 0.45018270611763
loss_pred:0.060962975025177, decouple_loss:0.05299759283661842
The modified gen p mean: 0.44431495666503906, gen p mean: 0.0, mean p set: 0.4510650634765625
loss_pred:0.0638219341635704, decouple_loss:0.05251271277666092
Iteration: 142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44514477252960205, gen p mean: 0.0, mean p set: 0.4520728290081024
loss_pred:0.05913722887635231, decouple_loss:0.05377725511789322
The modified gen p mean: 0.449270099401474, gen p mean: 0.0, mean p set: 0.45086169242858887
loss_pred:0.05846857652068138, decouple_loss:0.052172206342220306
The modified gen p mean: 0.4481435716152191, gen p mean: 0.0, mean p set: 0.45108428597450256
loss_pred:0.06031850725412369, decouple_loss:0.052598871290683746
Iteration: 143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4417789876461029, gen p mean: 0.0, mean p set: 0.45306864380836487
loss_pred:0.06330277770757675, decouple_loss:0.052378226071596146
The modified gen p mean: 0.4422931969165802, gen p mean: 0.0, mean p set: 0.4524688422679901
loss_pred:0.06039245426654816, decouple_loss:0.05402282625436783
The modified gen p mean: 0.4386577606201172, gen p mean: 0.0, mean p set: 0.4524455666542053
loss_pred:0.059554699808359146, decouple_loss:0.05432122200727463
Iteration: 144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44700926542282104, gen p mean: 0.0, mean p set: 0.4517882466316223
The modified gen p mean: 0.4450082778930664, gen p mean: 0.0, mean p set: 0.45242658257484436
loss_pred:0.06020902097225189, decouple_loss:0.055221181362867355
loss_pred:0.06065692752599716, decouple_loss:0.05322175845503807
The modified gen p mean: 0.44588539004325867, gen p mean: 0.0, mean p set: 0.4532093107700348
loss_pred:0.05862521007657051, decouple_loss:0.054326899349689484
Iteration: 145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45127537846565247, gen p mean: 0.0, mean p set: 0.4537295699119568
loss_pred:0.05901535600423813, decouple_loss:0.054928526282310486
The modified gen p mean: 0.4483845829963684, gen p mean: 0.0, mean p set: 0.4535713791847229
loss_pred:0.058938100934028625, decouple_loss:0.05356810614466667
The modified gen p mean: 0.4514677822589874, gen p mean: 0.0, mean p set: 0.451071560382843
loss_pred:0.059757050126791, decouple_loss:0.05278169736266136
Iteration: 146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45377805829048157, gen p mean: 0.0, mean p set: 0.45086991786956787
loss_pred:0.05969094857573509, decouple_loss:0.05277019366621971
The modified gen p mean: 0.4574218690395355, gen p mean: 0.0, mean p set: 0.45252126455307007
The modified gen p mean: 0.4532845914363861, gen p mean: 0.0, mean p set: 0.45276156067848206
loss_pred:0.056497249752283096, decouple_loss:0.055123940110206604
loss_pred:0.05860743299126625, decouple_loss:0.052795231342315674
Iteration: 147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43425431847572327, gen p mean: 0.0, mean p set: 0.4545804262161255
loss_pred:0.06278758496046066, decouple_loss:0.05357334762811661
The modified gen p mean: 0.4404909610748291, gen p mean: 0.0, mean p set: 0.4504178762435913
loss_pred:0.06274239718914032, decouple_loss:0.052179913967847824
The modified gen p mean: 0.44064927101135254, gen p mean: 0.0, mean p set: 0.451716810464859
loss_pred:0.0575062558054924, decouple_loss:0.052541423588991165
Iteration: 148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4382072687149048, gen p mean: 0.0, mean p set: 0.4523443579673767
loss_pred:0.05948113277554512, decouple_loss:0.05242617428302765
The modified gen p mean: 0.4347487986087799, gen p mean: 0.0, mean p set: 0.45431381464004517
loss_pred:0.06299950927495956, decouple_loss:0.05321653559803963
The modified gen p mean: 0.44235771894454956, gen p mean: 0.0, mean p set: 0.45382463932037354
loss_pred:0.05996726453304291, decouple_loss:0.05155226215720177
Iteration: 149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45745545625686646, gen p mean: 0.0, mean p set: 0.45006391406059265
loss_pred:0.05731295049190521, decouple_loss:0.05628742650151253
The modified gen p mean: 0.45846280455589294, gen p mean: 0.0, mean p set: 0.4498787522315979
loss_pred:0.056294847279787064, decouple_loss:0.05597645416855812
The modified gen p mean: 0.45615240931510925, gen p mean: 0.0, mean p set: 0.4515113830566406
loss_pred:0.06004324555397034, decouple_loss:0.05379156395792961
Iteration: 150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45178553462028503, gen p mean: 0.0, mean p set: 0.45222437381744385
The modified gen p mean: 0.453511506319046, gen p mean: 0.0, mean p set: 0.45231500267982483
loss_pred:0.058896858245134354, decouple_loss:0.05379027500748634
loss_pred:0.0560653991997242, decouple_loss:0.052055809646844864
The modified gen p mean: 0.4521985948085785, gen p mean: 0.0, mean p set: 0.45025137066841125
loss_pred:0.05971139669418335, decouple_loss:0.05503625050187111
2023-05-05 17:42:36 testing...
The modified gen p mean: 0.43986302614212036, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.06368393450975418, decouple_loss:0.05598266050219536
The modified gen p mean: 0.4448336660861969, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4432506561279297, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.060997698456048965, decouple_loss:0.05686740204691887
loss_pred:0.06212447211146355, decouple_loss:0.055331047624349594
WV_1_PC_0_EH_0_PS_40_6, loss: 0.0650717169046402, avg_mse: 0.06308721750974655
current test mse: 0.063087
Iteration: 151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4363754391670227, gen p mean: 0.0, mean p set: 0.4553443193435669
loss_pred:0.06171470135450363, decouple_loss:0.05236463248729706
The modified gen p mean: 0.44332703948020935, gen p mean: 0.0, mean p set: 0.4499439597129822
loss_pred:0.06101273372769356, decouple_loss:0.05223725736141205
The modified gen p mean: 0.43447145819664, gen p mean: 0.0, mean p set: 0.4507260322570801
loss_pred:0.0571957565844059, decouple_loss:0.05464567989110947
Iteration: 152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44782790541648865, gen p mean: 0.0, mean p set: 0.4533047676086426
loss_pred:0.058511268347501755, decouple_loss:0.052473146468400955
The modified gen p mean: 0.44604796171188354, gen p mean: 0.0, mean p set: 0.4528190791606903
loss_pred:0.057919472455978394, decouple_loss:0.05280090123414993
The modified gen p mean: 0.45025986433029175, gen p mean: 0.0, mean p set: 0.4509033262729645
loss_pred:0.06017502397298813, decouple_loss:0.05088070034980774
Iteration: 153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4571160078048706, gen p mean: 0.0, mean p set: 0.4505993127822876
The modified gen p mean: 0.45342379808425903, gen p mean: 0.0, mean p set: 0.45452532172203064
loss_pred:0.060451801866292953, decouple_loss:0.05237023904919624
loss_pred:0.05981653928756714, decouple_loss:0.05261664465069771
The modified gen p mean: 0.4519651532173157, gen p mean: 0.0, mean p set: 0.4527818560600281
loss_pred:0.05724120885133743, decouple_loss:0.05264205113053322
Iteration: 154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45438113808631897, gen p mean: 0.0, mean p set: 0.4519164264202118
loss_pred:0.057665977627038956, decouple_loss:0.05348987132310867
The modified gen p mean: 0.45709946751594543, gen p mean: 0.0, mean p set: 0.45090457797050476
loss_pred:0.05943933129310608, decouple_loss:0.05325901135802269
The modified gen p mean: 0.45669442415237427, gen p mean: 0.0, mean p set: 0.45088624954223633
loss_pred:0.058376245200634, decouple_loss:0.054578449577093124
Iteration: 155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455068111419678, gen p mean: 0.0, mean p set: 0.45321348309516907
loss_pred:0.05722476541996002, decouple_loss:0.053369615226984024
The modified gen p mean: 0.4438406825065613, gen p mean: 0.0, mean p set: 0.45249199867248535
loss_pred:0.058431126177310944, decouple_loss:0.05264229327440262
The modified gen p mean: 0.45042896270751953, gen p mean: 0.0, mean p set: 0.4510363042354584
loss_pred:0.05980182811617851, decouple_loss:0.053033143281936646
Iteration: 156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496863782405853, gen p mean: 0.0, mean p set: 0.4524182975292206
loss_pred:0.05742058530449867, decouple_loss:0.05228826403617859
The modified gen p mean: 0.4424034059047699, gen p mean: 0.0, mean p set: 0.45358556509017944
loss_pred:0.057383038103580475, decouple_loss:0.05248726159334183
The modified gen p mean: 0.44603413343429565, gen p mean: 0.0, mean p set: 0.453921914100647
loss_pred:0.06173001974821091, decouple_loss:0.05166631191968918
Iteration: 157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4542698264122009, gen p mean: 0.0, mean p set: 0.451235830783844
loss_pred:0.057671111077070236, decouple_loss:0.05130334571003914
The modified gen p mean: 0.4441647529602051, gen p mean: 0.0, mean p set: 0.45452621579170227
loss_pred:0.060659635812044144, decouple_loss:0.0517926923930645
The modified gen p mean: 0.4522790014743805, gen p mean: 0.0, mean p set: 0.45209503173828125
loss_pred:0.055410243570804596, decouple_loss:0.05071999877691269
Iteration: 158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521462619304657, gen p mean: 0.0, mean p set: 0.4516817331314087
loss_pred:0.05609985440969467, decouple_loss:0.050485026091337204
The modified gen p mean: 0.44946950674057007, gen p mean: 0.0, mean p set: 0.4512208104133606
loss_pred:0.05627625435590744, decouple_loss:0.0506620928645134
The modified gen p mean: 0.45113781094551086, gen p mean: 0.0, mean p set: 0.45265111327171326
loss_pred:0.05767226591706276, decouple_loss:0.05074407532811165
Iteration: 159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527784585952759, gen p mean: 0.0, mean p set: 0.453065425157547
loss_pred:0.056447602808475494, decouple_loss:0.05034755915403366
The modified gen p mean: 0.4493858814239502, gen p mean: 0.0, mean p set: 0.45165497064590454
loss_pred:0.05638157203793526, decouple_loss:0.051222141832113266
The modified gen p mean: 0.44767841696739197, gen p mean: 0.0, mean p set: 0.4535963535308838
loss_pred:0.05700283497571945, decouple_loss:0.050698842853307724
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
NaN value num: 0
Iteration: 160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44538235664367676, gen p mean: 0.0, mean p set: 0.45169559121131897
loss_pred:0.060239166021347046, decouple_loss:0.05292133614420891
The modified gen p mean: 0.445534884929657, gen p mean: 0.0, mean p set: 0.45193424820899963
The modified gen p mean: 0.4433095157146454, gen p mean: 0.0, mean p set: 0.4529832601547241
loss_pred:0.05687308683991432, decouple_loss:0.051124658435583115
loss_pred:0.05814824625849724, decouple_loss:0.05259249359369278
2023-05-05 17:47:12 testing...
The modified gen p mean: 0.45691853761672974, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.06250961869955063, decouple_loss:0.05321096256375313
The modified gen p mean: 0.4581538438796997, gen p mean: 0.0, mean p set: 0.45035696029663086The modified gen p mean: 0.45826369524002075, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.06098909303545952, decouple_loss:0.05357109010219574
loss_pred:0.060932353138923645, decouple_loss:0.05289473384618759
WV_1_PC_0_EH_0_PS_40_6, loss: 0.06413830816745758, avg_mse: 0.06305965036153793
current test mse: 0.06306
Iteration: 161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45421937108039856, gen p mean: 0.0, mean p set: 0.4508603513240814
loss_pred:0.05937705561518669, decouple_loss:0.050943970680236816
The modified gen p mean: 0.45437484979629517, gen p mean: 0.0, mean p set: 0.4486272633075714
loss_pred:0.05775248259305954, decouple_loss:0.05197176709771156
The modified gen p mean: 0.4505942761898041, gen p mean: 0.0, mean p set: 0.4505075514316559
loss_pred:0.06181378662586212, decouple_loss:0.051836006343364716
Iteration: 162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45803603529930115, gen p mean: 0.0, mean p set: 0.44998228549957275
loss_pred:0.05709795281291008, decouple_loss:0.05156276747584343
The modified gen p mean: 0.45926517248153687, gen p mean: 0.0, mean p set: 0.44957631826400757
loss_pred:0.059614479541778564, decouple_loss:0.05077359080314636
The modified gen p mean: 0.4571124017238617, gen p mean: 0.0, mean p set: 0.45002463459968567
loss_pred:0.05794543772935867, decouple_loss:0.05008099600672722
Iteration: 163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43198296427726746, gen p mean: 0.0, mean p set: 0.45067617297172546
loss_pred:0.05591331422328949, decouple_loss:0.050849899649620056
The modified gen p mean: 0.4296145439147949, gen p mean: 0.0, mean p set: 0.4503673017024994
The modified gen p mean: 0.4319188892841339, gen p mean: 0.0, mean p set: 0.44973790645599365
loss_pred:0.0554833710193634, decouple_loss:0.05088963732123375
loss_pred:0.05522562935948372, decouple_loss:0.04978948459029198
Iteration: 164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43941301107406616, gen p mean: 0.0, mean p set: 0.45085835456848145
loss_pred:0.060117315500974655, decouple_loss:0.05276599898934364
The modified gen p mean: 0.4407554566860199, gen p mean: 0.0, mean p set: 0.4514475464820862
loss_pred:0.05714518576860428, decouple_loss:0.05160783603787422
The modified gen p mean: 0.4402933120727539, gen p mean: 0.0, mean p set: 0.4507381319999695
loss_pred:0.057109519839286804, decouple_loss:0.05134839192032814
Iteration: 165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46646565198898315, gen p mean: 0.0, mean p set: 0.4507634937763214
loss_pred:0.05637453496456146, decouple_loss:0.051516078412532806
The modified gen p mean: 0.4600236117839813, gen p mean: 0.0, mean p set: 0.4527532756328583
loss_pred:0.05697192996740341, decouple_loss:0.05197352543473244
The modified gen p mean: 0.4642464220523834, gen p mean: 0.0, mean p set: 0.45071205496788025
loss_pred:0.05576835572719574, decouple_loss:0.05184914544224739
Iteration: 166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45948922634124756, gen p mean: 0.0, mean p set: 0.450395405292511The modified gen p mean: 0.4591065049171448, gen p mean: 0.0, mean p set: 0.44989991188049316
loss_pred:0.05735590681433678, decouple_loss:0.05069002881646156loss_pred:0.05850708857178688, decouple_loss:0.05067826434969902
The modified gen p mean: 0.45697829127311707, gen p mean: 0.0, mean p set: 0.45137903094291687
loss_pred:0.05581329017877579, decouple_loss:0.05081583559513092
Iteration: 167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4448307454586029, gen p mean: 0.0, mean p set: 0.4513118267059326
loss_pred:0.05848611146211624, decouple_loss:0.05152668058872223
The modified gen p mean: 0.4415646195411682, gen p mean: 0.0, mean p set: 0.45301464200019836
loss_pred:0.05793531611561775, decouple_loss:0.05274111405014992
The modified gen p mean: 0.4419114291667938, gen p mean: 0.0, mean p set: 0.4498359262943268
loss_pred:0.05583857372403145, decouple_loss:0.05110165476799011
Iteration: 168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811710715293884, gen p mean: 0.0, mean p set: 0.4530515968799591The modified gen p mean: 0.4517820179462433, gen p mean: 0.0, mean p set: 0.44979190826416016
loss_pred:0.05608625337481499, decouple_loss:0.051479268819093704
loss_pred:0.05481528490781784, decouple_loss:0.04966479912400246
The modified gen p mean: 0.45540761947631836, gen p mean: 0.0, mean p set: 0.44999533891677856
loss_pred:0.05543599650263786, decouple_loss:0.04921230301260948
Iteration: 169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46157604455947876, gen p mean: 0.0, mean p set: 0.4537885785102844
loss_pred:0.055282410234212875, decouple_loss:0.050578244030475616
The modified gen p mean: 0.4615029990673065, gen p mean: 0.0, mean p set: 0.44996383786201477
loss_pred:0.055993080139160156, decouple_loss:0.05263357236981392
The modified gen p mean: 0.4657834768295288, gen p mean: 0.0, mean p set: 0.4496554732322693
loss_pred:0.05483832582831383, decouple_loss:0.05008576810359955
Iteration: 170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44329574704170227, gen p mean: 0.0, mean p set: 0.45047301054000854
loss_pred:0.05689561739563942, decouple_loss:0.05105419456958771
The modified gen p mean: 0.44814905524253845, gen p mean: 0.0, mean p set: 0.450061172246933
loss_pred:0.06050994619727135, decouple_loss:0.05027220398187637
The modified gen p mean: 0.4430442452430725, gen p mean: 0.0, mean p set: 0.4524524509906769
loss_pred:0.055996090173721313, decouple_loss:0.04949367418885231
2023-05-05 17:51:01 testing...
The modified gen p mean: 0.43436211347579956, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.06081933528184891, decouple_loss:0.05361401289701462
The modified gen p mean: 0.43789029121398926, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.43508633971214294, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.060254454612731934, decouple_loss:0.05206293612718582
loss_pred:0.0593404620885849, decouple_loss:0.05351737514138222
WV_1_PC_0_EH_0_PS_40_6, loss: 0.06279132515192032, avg_mse: 0.06185794994235039
current test mse: 0.061858
Iteration: 171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.42744767665863037, gen p mean: 0.0, mean p set: 0.45104068517684937
loss_pred:0.055846769362688065, decouple_loss:0.04991311952471733
The modified gen p mean: 0.42516911029815674, gen p mean: 0.0, mean p set: 0.4528670310974121
loss_pred:0.05710182338953018, decouple_loss:0.05085769295692444
The modified gen p mean: 0.4253391921520233, gen p mean: 0.0, mean p set: 0.4506552517414093
loss_pred:0.06056353449821472, decouple_loss:0.051784757524728775
Iteration: 172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4448145031929016, gen p mean: 0.0, mean p set: 0.4493563175201416
loss_pred:0.056324973702430725, decouple_loss:0.05144425854086876
The modified gen p mean: 0.44757166504859924, gen p mean: 0.0, mean p set: 0.44917601346969604
loss_pred:0.05505050718784332, decouple_loss:0.048553481698036194
The modified gen p mean: 0.4446829855442047, gen p mean: 0.0, mean p set: 0.44922199845314026
loss_pred:0.0578388087451458, decouple_loss:0.05021711066365242
Iteration: 173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488620460033417, gen p mean: 0.0, mean p set: 0.45213228464126587
loss_pred:0.05736527591943741, decouple_loss:0.051000870764255524
The modified gen p mean: 0.4566921293735504, gen p mean: 0.0, mean p set: 0.4508640468120575
loss_pred:0.05403532460331917, decouple_loss:0.05004226043820381
The modified gen p mean: 0.45763668417930603, gen p mean: 0.0, mean p set: 0.4504907429218292
loss_pred:0.05825129151344299, decouple_loss:0.04920446127653122
Iteration: 174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46003201603889465, gen p mean: 0.0, mean p set: 0.4505055248737335
The modified gen p mean: 0.46052736043930054, gen p mean: 0.0, mean p set: 0.45078805088996887
loss_pred:0.05283490940928459, decouple_loss:0.04943593218922615
loss_pred:0.05487220361828804, decouple_loss:0.04994034767150879
The modified gen p mean: 0.4637640416622162, gen p mean: 0.0, mean p set: 0.4502233564853668
loss_pred:0.05369320511817932, decouple_loss:0.04961289465427399
Iteration: 175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499529004096985, gen p mean: 0.0, mean p set: 0.4495299756526947
loss_pred:0.05621756240725517, decouple_loss:0.048586901277303696
The modified gen p mean: 0.45289427042007446, gen p mean: 0.0, mean p set: 0.45061564445495605
loss_pred:0.054947733879089355, decouple_loss:0.047835659235715866
The modified gen p mean: 0.4518996477127075, gen p mean: 0.0, mean p set: 0.4503227472305298
loss_pred:0.05307958647608757, decouple_loss:0.048303671181201935
Iteration: 176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45007848739624023, gen p mean: 0.0, mean p set: 0.4502647817134857
loss_pred:0.053747594356536865, decouple_loss:0.04734104871749878
The modified gen p mean: 0.44854068756103516, gen p mean: 0.0, mean p set: 0.45221027731895447
loss_pred:0.05650830641388893, decouple_loss:0.047985389828681946
The modified gen p mean: 0.45034271478652954, gen p mean: 0.0, mean p set: 0.4490193724632263
loss_pred:0.056862059980630875, decouple_loss:0.04930708929896355
Iteration: 177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4577223062515259, gen p mean: 0.0, mean p set: 0.45068490505218506
loss_pred:0.05561787635087967, decouple_loss:0.04796585068106651
The modified gen p mean: 0.45934465527534485, gen p mean: 0.0, mean p set: 0.45088836550712585
loss_pred:0.05563473701477051, decouple_loss:0.04841717332601547
The modified gen p mean: 0.456035852432251, gen p mean: 0.0, mean p set: 0.4497922658920288
loss_pred:0.056312136352062225, decouple_loss:0.0467529371380806
Iteration: 178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4537166953086853, gen p mean: 0.0, mean p set: 0.4519580006599426
loss_pred:0.05580327287316322, decouple_loss:0.049518585205078125
The modified gen p mean: 0.4575991630554199, gen p mean: 0.0, mean p set: 0.4503108859062195
loss_pred:0.05154954269528389, decouple_loss:0.04642937332391739
The modified gen p mean: 0.45006421208381653, gen p mean: 0.0, mean p set: 0.4526490569114685
loss_pred:0.05417705327272415, decouple_loss:0.04786767438054085
Iteration: 179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4419589936733246, gen p mean: 0.0, mean p set: 0.4501486122608185
loss_pred:0.05319301784038544, decouple_loss:0.046847667545080185
The modified gen p mean: 0.44617146253585815, gen p mean: 0.0, mean p set: 0.4490962028503418
loss_pred:0.05309845507144928, decouple_loss:0.04578563570976257
The modified gen p mean: 0.442415714263916, gen p mean: 0.0, mean p set: 0.4499586224555969
loss_pred:0.05550605058670044, decouple_loss:0.04726019501686096
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4328653812408447, gen p mean: 0.0, mean p set: 0.4479069411754608
The modified gen p mean: 0.4432010352611542, gen p mean: 0.0, mean p set: 0.44760891795158386
loss_pred:0.060930538922548294, decouple_loss:0.050473105162382126
loss_pred:0.05706312134861946, decouple_loss:0.050428275018930435
The modified gen p mean: 0.44106024503707886, gen p mean: 0.0, mean p set: 0.4482089579105377
loss_pred:0.05904896557331085, decouple_loss:0.05002755671739578
2023-05-05 17:55:31 testing...
The modified gen p mean: 0.4441673457622528, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.05836417153477669, decouple_loss:0.04915986582636833
The modified gen p mean: 0.4503379166126251, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495052397251129, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.05726376920938492, decouple_loss:0.04870785400271416
loss_pred:0.05709989368915558, decouple_loss:0.04978719726204872
WV_1_PC_0_EH_0_PS_40_6, loss: 0.06003686040639877, avg_mse: 0.05919262021780014
current test mse: 0.059193
Iteration: 181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45176637172698975, gen p mean: 0.0, mean p set: 0.44665300846099854
loss_pred:0.058721087872982025, decouple_loss:0.04973626881837845
The modified gen p mean: 0.4495038390159607, gen p mean: 0.0, mean p set: 0.4482399523258209
loss_pred:0.058416321873664856, decouple_loss:0.04774288088083267
The modified gen p mean: 0.44865185022354126, gen p mean: 0.0, mean p set: 0.44877755641937256
loss_pred:0.057216960936784744, decouple_loss:0.047800250351428986
Iteration: 182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4612105190753937, gen p mean: 0.0, mean p set: 0.44879069924354553
loss_pred:0.055382609367370605, decouple_loss:0.04651298746466637
The modified gen p mean: 0.4630031883716583, gen p mean: 0.0, mean p set: 0.44855615496635437
loss_pred:0.05946870893239975, decouple_loss:0.049012452363967896
The modified gen p mean: 0.466641902923584, gen p mean: 0.0, mean p set: 0.4483618438243866
loss_pred:0.05438288301229477, decouple_loss:0.049547161906957626
Iteration: 183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46002063155174255, gen p mean: 0.0, mean p set: 0.44785353541374207
The modified gen p mean: 0.45927414298057556, gen p mean: 0.0, mean p set: 0.44742754101753235
loss_pred:0.055705081671476364, decouple_loss:0.04960091784596443
loss_pred:0.059114351868629456, decouple_loss:0.0518958754837513
The modified gen p mean: 0.45783835649490356, gen p mean: 0.0, mean p set: 0.44771865010261536
loss_pred:0.05848323553800583, decouple_loss:0.05041474848985672
Iteration: 184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44407984614372253, gen p mean: 0.0, mean p set: 0.4477456510066986
loss_pred:0.058008261024951935, decouple_loss:0.05054880306124687
The modified gen p mean: 0.43929538130760193, gen p mean: 0.0, mean p set: 0.4492107927799225
loss_pred:0.05592679604887962, decouple_loss:0.04875651001930237
The modified gen p mean: 0.44750547409057617, gen p mean: 0.0, mean p set: 0.4478210508823395
loss_pred:0.05794461816549301, decouple_loss:0.05040886253118515
Iteration: 185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44432663917541504, gen p mean: 0.0, mean p set: 0.4480433166027069
loss_pred:0.05548684298992157, decouple_loss:0.04804597795009613
The modified gen p mean: 0.4450545310974121, gen p mean: 0.0, mean p set: 0.44754406809806824
loss_pred:0.060770533978939056, decouple_loss:0.048465389758348465
The modified gen p mean: 0.44924163818359375, gen p mean: 0.0, mean p set: 0.4478406012058258
loss_pred:0.05662062019109726, decouple_loss:0.0491466261446476
Iteration: 186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46531108021736145, gen p mean: 0.0, mean p set: 0.44821682572364807
loss_pred:0.05748854577541351, decouple_loss:0.04686352238059044
The modified gen p mean: 0.4614632725715637, gen p mean: 0.0, mean p set: 0.44846081733703613
loss_pred:0.058391671627759933, decouple_loss:0.04751965031027794
The modified gen p mean: 0.4683478772640228, gen p mean: 0.0, mean p set: 0.44660380482673645
loss_pred:0.05671602487564087, decouple_loss:0.0497518852353096
Iteration: 187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4550187289714813, gen p mean: 0.0, mean p set: 0.4488186836242676
loss_pred:0.056879349052906036, decouple_loss:0.04711591824889183
The modified gen p mean: 0.45483264327049255, gen p mean: 0.0, mean p set: 0.4488621652126312
loss_pred:0.05680222064256668, decouple_loss:0.046754781156778336
The modified gen p mean: 0.45171111822128296, gen p mean: 0.0, mean p set: 0.4472944438457489
loss_pred:0.05489621311426163, decouple_loss:0.04647090658545494
Iteration: 188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44372546672821045, gen p mean: 0.0, mean p set: 0.4482308626174927
loss_pred:0.057049863040447235, decouple_loss:0.04731423035264015
The modified gen p mean: 0.44686999917030334, gen p mean: 0.0, mean p set: 0.44792893528938293
loss_pred:0.057658057659864426, decouple_loss:0.04941978305578232
The modified gen p mean: 0.4496747851371765, gen p mean: 0.0, mean p set: 0.44731831550598145
loss_pred:0.05429106950759888, decouple_loss:0.050339728593826294
Iteration: 189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44055435061454773, gen p mean: 0.0, mean p set: 0.4480248689651489
loss_pred:0.05412646383047104, decouple_loss:0.04762426018714905
The modified gen p mean: 0.44075894355773926, gen p mean: 0.0, mean p set: 0.4487457573413849
loss_pred:0.0560125894844532, decouple_loss:0.04622991383075714
The modified gen p mean: 0.4394664466381073, gen p mean: 0.0, mean p set: 0.44770246744155884
loss_pred:0.055840346962213516, decouple_loss:0.048755794763565063
Iteration: 190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680672883987427, gen p mean: 0.0, mean p set: 0.44761648774147034
loss_pred:0.05764109268784523, decouple_loss:0.047646746039390564
The modified gen p mean: 0.4437599778175354, gen p mean: 0.0, mean p set: 0.4482249617576599
loss_pred:0.05675698444247246, decouple_loss:0.048784323036670685
The modified gen p mean: 0.4462936818599701, gen p mean: 0.0, mean p set: 0.4477413594722748
loss_pred:0.05542710795998573, decouple_loss:0.04834674298763275
2023-05-05 17:59:18 testing...
The modified gen p mean: 0.45376166701316833, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.05662870034575462, decouple_loss:0.04861525446176529
The modified gen p mean: 0.45827943086624146, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45882007479667664, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.05543007701635361, decouple_loss:0.04806595668196678
loss_pred:0.055704496800899506, decouple_loss:0.04816872999072075
WV_1_PC_0_EH_0_PS_40_6, loss: 0.058335255831480026, avg_mse: 0.05795416608452797
current test mse: 0.057954
Iteration: 191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45300114154815674, gen p mean: 0.0, mean p set: 0.44831904768943787
loss_pred:0.05612192675471306, decouple_loss:0.047254778444767
The modified gen p mean: 0.4564707279205322, gen p mean: 0.0, mean p set: 0.4486466944217682
loss_pred:0.05334926396608353, decouple_loss:0.04834599047899246
The modified gen p mean: 0.45463865995407104, gen p mean: 0.0, mean p set: 0.4471800923347473
loss_pred:0.057220615446567535, decouple_loss:0.04808178171515465
Iteration: 192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46179378032684326, gen p mean: 0.0, mean p set: 0.4479289650917053
The modified gen p mean: 0.462069034576416, gen p mean: 0.0, mean p set: 0.4480917155742645
loss_pred:0.057042840868234634, decouple_loss:0.04805271327495575
loss_pred:0.0575307235121727, decouple_loss:0.04955223947763443
The modified gen p mean: 0.45326414704322815, gen p mean: 0.0, mean p set: 0.4493890404701233
loss_pred:0.054324671626091, decouple_loss:0.048203643411397934
Iteration: 193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4579964578151703, gen p mean: 0.0, mean p set: 0.4483511745929718
loss_pred:0.0549895204603672, decouple_loss:0.04612391069531441
The modified gen p mean: 0.45706290006637573, gen p mean: 0.0, mean p set: 0.4487678110599518
loss_pred:0.05520191416144371, decouple_loss:0.047267600893974304
The modified gen p mean: 0.4573211371898651, gen p mean: 0.0, mean p set: 0.44802039861679077
loss_pred:0.05192732438445091, decouple_loss:0.04617202654480934
Iteration: 194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44256719946861267, gen p mean: 0.0, mean p set: 0.44828295707702637
loss_pred:0.056899335235357285, decouple_loss:0.04672728106379509
The modified gen p mean: 0.43904224038124084, gen p mean: 0.0, mean p set: 0.44814959168434143
loss_pred:0.05377375707030296, decouple_loss:0.04595331475138664
The modified gen p mean: 0.4391341805458069, gen p mean: 0.0, mean p set: 0.4478645324707031
loss_pred:0.05719404295086861, decouple_loss:0.0475996695458889
Iteration: 195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4362120032310486, gen p mean: 0.0, mean p set: 0.4477475583553314
loss_pred:0.05372651666402817, decouple_loss:0.046024076640605927
The modified gen p mean: 0.438202828168869, gen p mean: 0.0, mean p set: 0.44870179891586304
loss_pred:0.053557660430669785, decouple_loss:0.04729459434747696
The modified gen p mean: 0.4469231069087982, gen p mean: 0.0, mean p set: 0.44904205203056335
loss_pred:0.05766694247722626, decouple_loss:0.047176312655210495
Iteration: 196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487767815589905, gen p mean: 0.0, mean p set: 0.44823944568634033
loss_pred:0.05460711196064949, decouple_loss:0.045717284083366394
The modified gen p mean: 0.4538695216178894, gen p mean: 0.0, mean p set: 0.44706112146377563
loss_pred:0.05486385524272919, decouple_loss:0.04680302366614342
The modified gen p mean: 0.45455288887023926, gen p mean: 0.0, mean p set: 0.4493274986743927
loss_pred:0.05788320675492287, decouple_loss:0.045923877507448196
Iteration: 197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489959478378296, gen p mean: 0.0, mean p set: 0.44819164276123047
loss_pred:0.05294385552406311, decouple_loss:0.04605911299586296
The modified gen p mean: 0.4488321542739868, gen p mean: 0.0, mean p set: 0.4476131498813629
loss_pred:0.055187005549669266, decouple_loss:0.04603923112154007
The modified gen p mean: 0.4463108479976654, gen p mean: 0.0, mean p set: 0.4478244483470917
loss_pred:0.05517996475100517, decouple_loss:0.04598548263311386
Iteration: 198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43770259618759155, gen p mean: 0.0, mean p set: 0.4494889974594116
loss_pred:0.05333204194903374, decouple_loss:0.04542837664484978
The modified gen p mean: 0.4418140649795532, gen p mean: 0.0, mean p set: 0.44806867837905884
loss_pred:0.0560455359518528, decouple_loss:0.04705052450299263
The modified gen p mean: 0.4481559693813324, gen p mean: 0.0, mean p set: 0.4482864737510681
loss_pred:0.055157601833343506, decouple_loss:0.046367038041353226
Iteration: 199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44205790758132935, gen p mean: 0.0, mean p set: 0.4481387734413147
loss_pred:0.056679993867874146, decouple_loss:0.04657513648271561
The modified gen p mean: 0.44625425338745117, gen p mean: 0.0, mean p set: 0.4480080008506775
loss_pred:0.05501860752701759, decouple_loss:0.046463996171951294
The modified gen p mean: 0.4457952678203583, gen p mean: 0.0, mean p set: 0.44745007157325745
loss_pred:0.05411333963274956, decouple_loss:0.04559600353240967
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
NaN value num: 0
Iteration: 200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4543423354625702, gen p mean: 0.0, mean p set: 0.4516025483608246
loss_pred:0.05360517278313637, decouple_loss:0.04826801270246506
The modified gen p mean: 0.45391780138015747, gen p mean: 0.0, mean p set: 0.44922778010368347
The modified gen p mean: 0.45740175247192383, gen p mean: 0.0, mean p set: 0.4495701789855957
loss_pred:0.055736321955919266, decouple_loss:0.047164496034383774
loss_pred:0.05749669671058655, decouple_loss:0.046625226736068726
2023-05-05 18:03:45 testing...
The modified gen p mean: 0.4725174605846405, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.05518690496683121, decouple_loss:0.04597838968038559
The modified gen p mean: 0.47456276416778564, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.47578370571136475, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.05465003103017807, decouple_loss:0.045921437442302704
loss_pred:0.05491811782121658, decouple_loss:0.04549530893564224
WV_1_PC_0_EH_0_PS_40_6, loss: 0.05720826983451843, avg_mse: 0.057043515145778656
current test mse: 0.057044
Iteration: 201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.47831833362579346, gen p mean: 0.0, mean p set: 0.4498332440853119
loss_pred:0.05420209467411041, decouple_loss:0.048141349107027054
The modified gen p mean: 0.47422799468040466, gen p mean: 0.0, mean p set: 0.4498688280582428
loss_pred:0.05591801181435585, decouple_loss:0.04804001748561859
The modified gen p mean: 0.47354331612586975, gen p mean: 0.0, mean p set: 0.44953182339668274
loss_pred:0.05504219979047775, decouple_loss:0.04700334370136261
Iteration: 202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.461775004863739, gen p mean: 0.0, mean p set: 0.4517599642276764
loss_pred:0.05267217755317688, decouple_loss:0.04801827296614647
The modified gen p mean: 0.45807141065597534, gen p mean: 0.0, mean p set: 0.45028162002563477
loss_pred:0.052875373512506485, decouple_loss:0.04778468608856201
The modified gen p mean: 0.4611265957355499, gen p mean: 0.0, mean p set: 0.44951876997947693
loss_pred:0.052960626780986786, decouple_loss:0.04914669692516327
Iteration: 203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43748149275779724, gen p mean: 0.0, mean p set: 0.4533170461654663
loss_pred:0.05390918627381325, decouple_loss:0.05008639395236969
The modified gen p mean: 0.44057583808898926, gen p mean: 0.0, mean p set: 0.4504731595516205
loss_pred:0.05168987065553665, decouple_loss:0.04823483154177666
The modified gen p mean: 0.44306284189224243, gen p mean: 0.0, mean p set: 0.4493304491043091
loss_pred:0.055165573954582214, decouple_loss:0.04771357402205467
Iteration: 204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44657984375953674, gen p mean: 0.0, mean p set: 0.4524591267108917
loss_pred:0.053067732602357864, decouple_loss:0.04757210612297058
The modified gen p mean: 0.44488173723220825, gen p mean: 0.0, mean p set: 0.448142409324646
loss_pred:0.053518641740083694, decouple_loss:0.047470010817050934
The modified gen p mean: 0.44639813899993896, gen p mean: 0.0, mean p set: 0.4519321024417877
loss_pred:0.05606374517083168, decouple_loss:0.04823244735598564
Iteration: 205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4561867117881775, gen p mean: 0.0, mean p set: 0.4498729407787323
loss_pred:0.05463988333940506, decouple_loss:0.04658576473593712
The modified gen p mean: 0.4521700441837311, gen p mean: 0.0, mean p set: 0.45026808977127075
loss_pred:0.050828300416469574, decouple_loss:0.0469755195081234
The modified gen p mean: 0.45361921191215515, gen p mean: 0.0, mean p set: 0.45198073983192444
loss_pred:0.056970588862895966, decouple_loss:0.049489594995975494
Iteration: 206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517545998096466, gen p mean: 0.0, mean p set: 0.4516368806362152
loss_pred:0.05213409289717674, decouple_loss:0.04862508922815323
The modified gen p mean: 0.4529992938041687, gen p mean: 0.0, mean p set: 0.4523191750049591
The modified gen p mean: 0.4500652849674225, gen p mean: 0.0, mean p set: 0.45197638869285583
loss_pred:0.05471149832010269, decouple_loss:0.04816824197769165
loss_pred:0.05265461653470993, decouple_loss:0.04749685153365135
Iteration: 207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510423243045807, gen p mean: 0.0, mean p set: 0.4517160654067993
loss_pred:0.052441950887441635, decouple_loss:0.04750513657927513
The modified gen p mean: 0.4504610598087311, gen p mean: 0.0, mean p set: 0.4518289566040039
loss_pred:0.051320623606443405, decouple_loss:0.04748392105102539
The modified gen p mean: 0.4463442862033844, gen p mean: 0.0, mean p set: 0.45326003432273865
loss_pred:0.05338265001773834, decouple_loss:0.04869715869426727
Iteration: 208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526244103908539, gen p mean: 0.0, mean p set: 0.44940266013145447
loss_pred:0.05408799648284912, decouple_loss:0.04816397279500961
The modified gen p mean: 0.45091310143470764, gen p mean: 0.0, mean p set: 0.4504474103450775
loss_pred:0.05623501539230347, decouple_loss:0.047997258603572845
The modified gen p mean: 0.45234835147857666, gen p mean: 0.0, mean p set: 0.4519873261451721
loss_pred:0.052572134882211685, decouple_loss:0.048711147159338
Iteration: 209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480678141117096, gen p mean: 0.0, mean p set: 0.4512324035167694
loss_pred:0.05334654822945595, decouple_loss:0.04858972877264023
The modified gen p mean: 0.44969308376312256, gen p mean: 0.0, mean p set: 0.449952095746994
loss_pred:0.054586827754974365, decouple_loss:0.047659918665885925
The modified gen p mean: 0.4485265016555786, gen p mean: 0.0, mean p set: 0.4499163329601288
loss_pred:0.054089050740003586, decouple_loss:0.046410057693719864
Iteration: 210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472908675670624, gen p mean: 0.0, mean p set: 0.4510645270347595
loss_pred:0.051694516092538834, decouple_loss:0.0472111776471138
The modified gen p mean: 0.4516873359680176, gen p mean: 0.0, mean p set: 0.4503476321697235
loss_pred:0.05372075363993645, decouple_loss:0.047727879136800766
The modified gen p mean: 0.44889310002326965, gen p mean: 0.0, mean p set: 0.45175832509994507
loss_pred:0.051976487040519714, decouple_loss:0.04750991240143776
2023-05-05 18:07:35 testing...
The modified gen p mean: 0.4441523849964142, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.055674582719802856, decouple_loss:0.04744264483451843
The modified gen p mean: 0.44973883032798767, gen p mean: 0.0, mean p set: 0.45035696029663086The modified gen p mean: 0.4490557312965393, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.054463375359773636, decouple_loss:0.04786181449890137
loss_pred:0.05495675280690193, decouple_loss:0.04755813628435135
WV_1_PC_0_EH_0_PS_40_6, loss: 0.05741261690855026, avg_mse: 0.0572720430791378
current test mse: 0.057272
Iteration: 211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45184722542762756, gen p mean: 0.0, mean p set: 0.4506407380104065
loss_pred:0.05196293815970421, decouple_loss:0.04708756506443024
The modified gen p mean: 0.4466873109340668, gen p mean: 0.0, mean p set: 0.45208731293678284
loss_pred:0.05474977567791939, decouple_loss:0.046934232115745544
The modified gen p mean: 0.44823986291885376, gen p mean: 0.0, mean p set: 0.45262959599494934
loss_pred:0.052530646324157715, decouple_loss:0.04677591100335121
Iteration: 212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.440907746553421, gen p mean: 0.0, mean p set: 0.45022377371788025
loss_pred:0.05482539162039757, decouple_loss:0.04662017151713371
The modified gen p mean: 0.44294577836990356, gen p mean: 0.0, mean p set: 0.4501676559448242
loss_pred:0.054407138377428055, decouple_loss:0.046587686985731125
The modified gen p mean: 0.44808414578437805, gen p mean: 0.0, mean p set: 0.4533640444278717
loss_pred:0.05174519494175911, decouple_loss:0.04674043506383896
Iteration: 213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4586832821369171, gen p mean: 0.0, mean p set: 0.4501752555370331
loss_pred:0.052693482488393784, decouple_loss:0.047160837799310684
The modified gen p mean: 0.45130041241645813, gen p mean: 0.0, mean p set: 0.45087674260139465
loss_pred:0.052015092223882675, decouple_loss:0.04642029106616974
The modified gen p mean: 0.45493435859680176, gen p mean: 0.0, mean p set: 0.44998836517333984
loss_pred:0.05310019105672836, decouple_loss:0.04553092271089554
Iteration: 214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4577721357345581, gen p mean: 0.0, mean p set: 0.4517051577568054
The modified gen p mean: 0.46214261651039124, gen p mean: 0.0, mean p set: 0.4514331519603729
loss_pred:0.05157677084207535, decouple_loss:0.04676566272974014
loss_pred:0.052267976105213165, decouple_loss:0.04706837236881256
The modified gen p mean: 0.4561479091644287, gen p mean: 0.0, mean p set: 0.4518939256668091
loss_pred:0.054187580943107605, decouple_loss:0.047482747584581375
Iteration: 215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45344480872154236, gen p mean: 0.0, mean p set: 0.45162567496299744
loss_pred:0.05085591599345207, decouple_loss:0.046872686594724655The modified gen p mean: 0.4556952714920044, gen p mean: 0.0, mean p set: 0.4509674608707428
loss_pred:0.052842020988464355, decouple_loss:0.04631204158067703
The modified gen p mean: 0.4568421244621277, gen p mean: 0.0, mean p set: 0.4518211781978607
loss_pred:0.055895883589982986, decouple_loss:0.046631962060928345
Iteration: 216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45149967074394226, gen p mean: 0.0, mean p set: 0.4516620337963104
The modified gen p mean: 0.4568942189216614, gen p mean: 0.0, mean p set: 0.4521452486515045
loss_pred:0.05154578015208244, decouple_loss:0.04495689645409584
loss_pred:0.05065983533859253, decouple_loss:0.04505673423409462
The modified gen p mean: 0.44951972365379333, gen p mean: 0.0, mean p set: 0.45039960741996765
loss_pred:0.05224820226430893, decouple_loss:0.04551609233021736
Iteration: 217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44730597734451294, gen p mean: 0.0, mean p set: 0.45195427536964417
loss_pred:0.05121763423085213, decouple_loss:0.04507046565413475
The modified gen p mean: 0.4450320601463318, gen p mean: 0.0, mean p set: 0.45022279024124146
loss_pred:0.05138389766216278, decouple_loss:0.0450141504406929
The modified gen p mean: 0.4439905285835266, gen p mean: 0.0, mean p set: 0.44862014055252075
loss_pred:0.05188567191362381, decouple_loss:0.046092160046100616
Iteration: 218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43755194544792175, gen p mean: 0.0, mean p set: 0.45075374841690063
loss_pred:0.049463625997304916, decouple_loss:0.0454312339425087
The modified gen p mean: 0.44092026352882385, gen p mean: 0.0, mean p set: 0.45029211044311523
loss_pred:0.05240507051348686, decouple_loss:0.0454065166413784
The modified gen p mean: 0.4426719844341278, gen p mean: 0.0, mean p set: 0.4497356712818146
loss_pred:0.05104512348771095, decouple_loss:0.045295119285583496
Iteration: 219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4426474869251251, gen p mean: 0.0, mean p set: 0.45333418250083923
loss_pred:0.05126013234257698, decouple_loss:0.04481125250458717
The modified gen p mean: 0.44132766127586365, gen p mean: 0.0, mean p set: 0.45130327343940735
loss_pred:0.053861357271671295, decouple_loss:0.04464215785264969
The modified gen p mean: 0.443176805973053, gen p mean: 0.0, mean p set: 0.4520314931869507
loss_pred:0.05309396609663963, decouple_loss:0.044245097786188126
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504789113998413, gen p mean: 0.0, mean p set: 0.4482753276824951
loss_pred:0.05430157482624054, decouple_loss:0.04692969471216202
The modified gen p mean: 0.45114073157310486, gen p mean: 0.0, mean p set: 0.44802939891815186
loss_pred:0.055781710892915726, decouple_loss:0.04644324257969856
The modified gen p mean: 0.4502226412296295, gen p mean: 0.0, mean p set: 0.4496433436870575
loss_pred:0.053015079349279404, decouple_loss:0.046654362231492996
2023-05-05 18:12:06 testing...
The modified gen p mean: 0.45476359128952026, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.05521729961037636, decouple_loss:0.046028926968574524
The modified gen p mean: 0.46054932475090027, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.053415339440107346, decouple_loss:0.04711785167455673
The modified gen p mean: 0.4598027765750885, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.05368557199835777, decouple_loss:0.04622331261634827
WV_1_PC_0_EH_0_PS_40_6, loss: 0.05642890930175781, avg_mse: 0.05643191933631897
current test mse: 0.056432
Iteration: 221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4579762816429138, gen p mean: 0.0, mean p set: 0.44810721278190613
loss_pred:0.05434739962220192, decouple_loss:0.047202229499816895
The modified gen p mean: 0.45328038930892944, gen p mean: 0.0, mean p set: 0.44819650053977966
loss_pred:0.052608367055654526, decouple_loss:0.046777889132499695
The modified gen p mean: 0.4562842845916748, gen p mean: 0.0, mean p set: 0.44828298687934875
loss_pred:0.054346006363630295, decouple_loss:0.04691058024764061
Iteration: 222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4613185524940491, gen p mean: 0.0, mean p set: 0.44799885153770447
loss_pred:0.0527980662882328, decouple_loss:0.04760701581835747
The modified gen p mean: 0.4589155316352844, gen p mean: 0.0, mean p set: 0.4485490918159485
loss_pred:0.05472337082028389, decouple_loss:0.04651832580566406
The modified gen p mean: 0.457101434469223, gen p mean: 0.0, mean p set: 0.44859638810157776
loss_pred:0.054091840982437134, decouple_loss:0.04700421169400215
Iteration: 223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448648601770401, gen p mean: 0.0, mean p set: 0.44797900319099426
loss_pred:0.053224317729473114, decouple_loss:0.04683744162321091
The modified gen p mean: 0.4525257349014282, gen p mean: 0.0, mean p set: 0.44819343090057373
loss_pred:0.05386700853705406, decouple_loss:0.04724720120429993
The modified gen p mean: 0.4507071375846863, gen p mean: 0.0, mean p set: 0.4476796090602875
loss_pred:0.053318094462156296, decouple_loss:0.04852874577045441
Iteration: 224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4398428201675415, gen p mean: 0.0, mean p set: 0.4479837417602539
loss_pred:0.05421251431107521, decouple_loss:0.047505613416433334
The modified gen p mean: 0.4477387070655823, gen p mean: 0.0, mean p set: 0.4486706554889679
loss_pred:0.05243449658155441, decouple_loss:0.04871702939271927
The modified gen p mean: 0.43567007780075073, gen p mean: 0.0, mean p set: 0.448775053024292
loss_pred:0.05346350744366646, decouple_loss:0.04686237499117851
Iteration: 225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44332045316696167, gen p mean: 0.0, mean p set: 0.4485950171947479
loss_pred:0.05295325815677643, decouple_loss:0.04726914316415787
The modified gen p mean: 0.447325199842453, gen p mean: 0.0, mean p set: 0.4483576714992523
loss_pred:0.05183488130569458, decouple_loss:0.04711930453777313
The modified gen p mean: 0.4474148154258728, gen p mean: 0.0, mean p set: 0.44843021035194397
loss_pred:0.04953717440366745, decouple_loss:0.04721236601471901
Iteration: 226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44844764471054077, gen p mean: 0.0, mean p set: 0.44826412200927734
loss_pred:0.05005331337451935, decouple_loss:0.046764981001615524
The modified gen p mean: 0.44754335284233093, gen p mean: 0.0, mean p set: 0.44904080033302307
loss_pred:0.05070052668452263, decouple_loss:0.04710741713643074
The modified gen p mean: 0.44993147253990173, gen p mean: 0.0, mean p set: 0.44892874360084534
loss_pred:0.05121629312634468, decouple_loss:0.04682768136262894
Iteration: 227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483378529548645, gen p mean: 0.0, mean p set: 0.4492427408695221
loss_pred:0.05108518898487091, decouple_loss:0.046405039727687836
The modified gen p mean: 0.4447806477546692, gen p mean: 0.0, mean p set: 0.44859760999679565
loss_pred:0.05247829481959343, decouple_loss:0.0469818040728569
The modified gen p mean: 0.44681501388549805, gen p mean: 0.0, mean p set: 0.4479960799217224
loss_pred:0.051046222448349, decouple_loss:0.0464961938560009
Iteration: 228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4434376060962677, gen p mean: 0.0, mean p set: 0.4489077031612396
The modified gen p mean: 0.44764432311058044, gen p mean: 0.0, mean p set: 0.4480193257331848
loss_pred:0.05280245468020439, decouple_loss:0.04672161117196083
loss_pred:0.04987268149852753, decouple_loss:0.045880939811468124
The modified gen p mean: 0.4481920897960663, gen p mean: 0.0, mean p set: 0.44776955246925354
loss_pred:0.05255589261651039, decouple_loss:0.04576254263520241
Iteration: 229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481602609157562, gen p mean: 0.0, mean p set: 0.44854387640953064
The modified gen p mean: 0.4445345103740692, gen p mean: 0.0, mean p set: 0.448341965675354
loss_pred:0.05010585859417915, decouple_loss:0.04638567566871643
loss_pred:0.05217836797237396, decouple_loss:0.04534781724214554
The modified gen p mean: 0.4444420635700226, gen p mean: 0.0, mean p set: 0.4478999972343445
loss_pred:0.05206724628806114, decouple_loss:0.04511118307709694
Iteration: 230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521310031414032, gen p mean: 0.0, mean p set: 0.4488089084625244
The modified gen p mean: 0.44472646713256836, gen p mean: 0.0, mean p set: 0.44846177101135254
loss_pred:0.0527275912463665, decouple_loss:0.046406663954257965
loss_pred:0.051650457084178925, decouple_loss:0.04579896479845047
The modified gen p mean: 0.4422958195209503, gen p mean: 0.0, mean p set: 0.44926151633262634
loss_pred:0.05294476076960564, decouple_loss:0.04599421098828316
2023-05-05 18:15:54 testing...
The modified gen p mean: 0.44841036200523376, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.05370086058974266, decouple_loss:0.04489590972661972
The modified gen p mean: 0.4525001645088196, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.052253808826208115, decouple_loss:0.04550325125455856
The modified gen p mean: 0.45393264293670654, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.05220944434404373, decouple_loss:0.04497012123465538
WV_1_PC_0_EH_0_PS_40_6, loss: 0.054977528750896454, avg_mse: 0.055191997438669205
current test mse: 0.055192
Iteration: 231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480073153972626, gen p mean: 0.0, mean p set: 0.4482516348361969
loss_pred:0.051067937165498734, decouple_loss:0.04422249644994736
The modified gen p mean: 0.4518623650074005, gen p mean: 0.0, mean p set: 0.4481166899204254
loss_pred:0.05114943906664848, decouple_loss:0.04456262290477753
The modified gen p mean: 0.4482579231262207, gen p mean: 0.0, mean p set: 0.44836533069610596
loss_pred:0.051027316600084305, decouple_loss:0.043982911854982376
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46223562955856323, gen p mean: 0.0, mean p set: 0.44928398728370667
loss_pred:0.05277055501937866, decouple_loss:0.045035723596811295
The modified gen p mean: 0.4585261344909668, gen p mean: 0.0, mean p set: 0.44792643189430237
loss_pred:0.05276866629719734, decouple_loss:0.044312991201877594
The modified gen p mean: 0.461498886346817, gen p mean: 0.0, mean p set: 0.44889721274375916
loss_pred:0.04941849410533905, decouple_loss:0.045095041394233704
Iteration: 233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494198262691498, gen p mean: 0.0, mean p set: 0.4482157230377197
loss_pred:0.05168996378779411, decouple_loss:0.04455367848277092
The modified gen p mean: 0.4543711543083191, gen p mean: 0.0, mean p set: 0.4483139216899872
loss_pred:0.05106194317340851, decouple_loss:0.045060060918331146
The modified gen p mean: 0.4524185061454773, gen p mean: 0.0, mean p set: 0.44859370589256287
loss_pred:0.0503939725458622, decouple_loss:0.04565701261162758
Iteration: 234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44465887546539307, gen p mean: 0.0, mean p set: 0.4487065374851227
loss_pred:0.047971248626708984, decouple_loss:0.04436143860220909
The modified gen p mean: 0.44090673327445984, gen p mean: 0.0, mean p set: 0.44838467240333557
loss_pred:0.049830686300992966, decouple_loss:0.044328317046165466
The modified gen p mean: 0.4410921335220337, gen p mean: 0.0, mean p set: 0.44854554533958435
loss_pred:0.04843853414058685, decouple_loss:0.04419741407036781
Iteration: 235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4399130046367645, gen p mean: 0.0, mean p set: 0.4484822154045105
loss_pred:0.05068311095237732, decouple_loss:0.043230846524238586
The modified gen p mean: 0.43250370025634766, gen p mean: 0.0, mean p set: 0.4486139416694641
loss_pred:0.05152157321572304, decouple_loss:0.04329923167824745
The modified gen p mean: 0.4369843602180481, gen p mean: 0.0, mean p set: 0.448095440864563
loss_pred:0.05031165853142738, decouple_loss:0.043278541415929794
Iteration: 236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44546404480934143, gen p mean: 0.0, mean p set: 0.4491655230522156
loss_pred:0.04933419078588486, decouple_loss:0.0423407219350338
The modified gen p mean: 0.4467666745185852, gen p mean: 0.0, mean p set: 0.44828253984451294
loss_pred:0.05066372826695442, decouple_loss:0.04251198470592499
The modified gen p mean: 0.45074719190597534, gen p mean: 0.0, mean p set: 0.44839832186698914
loss_pred:0.05001277104020119, decouple_loss:0.0435650572180748
Iteration: 237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.457463800907135, gen p mean: 0.0, mean p set: 0.4483332633972168
loss_pred:0.04858437925577164, decouple_loss:0.0446748249232769
The modified gen p mean: 0.4569593071937561, gen p mean: 0.0, mean p set: 0.44838589429855347
loss_pred:0.04962673410773277, decouple_loss:0.044602494686841965
The modified gen p mean: 0.45949363708496094, gen p mean: 0.0, mean p set: 0.4488312005996704
loss_pred:0.050400421023368835, decouple_loss:0.042981553822755814
Iteration: 238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466024935245514, gen p mean: 0.0, mean p set: 0.44843557476997375
loss_pred:0.05085515230894089, decouple_loss:0.04427514597773552
The modified gen p mean: 0.44606006145477295, gen p mean: 0.0, mean p set: 0.4476061165332794
loss_pred:0.050504475831985474, decouple_loss:0.04368630051612854
The modified gen p mean: 0.44505828619003296, gen p mean: 0.0, mean p set: 0.4477587640285492
loss_pred:0.05011353641748428, decouple_loss:0.04415937885642052
Iteration: 239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45227116346359253, gen p mean: 0.0, mean p set: 0.448201984167099
loss_pred:0.04935680329799652, decouple_loss:0.043446946889162064
The modified gen p mean: 0.45123371481895447, gen p mean: 0.0, mean p set: 0.44789719581604004
loss_pred:0.05171327292919159, decouple_loss:0.043183181434869766
The modified gen p mean: 0.4498612880706787, gen p mean: 0.0, mean p set: 0.44847777485847473
loss_pred:0.04921385645866394, decouple_loss:0.04295728728175163
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
NaN value num: 0
Iteration: 240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4571002423763275, gen p mean: 0.0, mean p set: 0.45141053199768066
loss_pred:0.05318553000688553, decouple_loss:0.046107031404972076
The modified gen p mean: 0.44756409525871277, gen p mean: 0.0, mean p set: 0.450283020734787
The modified gen p mean: 0.4538607895374298, gen p mean: 0.0, mean p set: 0.4513244926929474
loss_pred:0.056237153708934784, decouple_loss:0.04632986709475517
loss_pred:0.053730472922325134, decouple_loss:0.04678938537836075
2023-05-05 18:20:41 testing...
The modified gen p mean: 0.44408681988716125, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.05237390100955963, decouple_loss:0.043113499879837036
The modified gen p mean: 0.449109822511673, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.050981368869543076, decouple_loss:0.04289800673723221
The modified gen p mean: 0.45030224323272705, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.051684144884347916, decouple_loss:0.04293523356318474
WV_1_PC_0_EH_0_PS_40_6, loss: 0.05382891744375229, avg_mse: 0.0542188361287117
current test mse: 0.054219
Iteration: 241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529772698879242, gen p mean: 0.0, mean p set: 0.4509739875793457
loss_pred:0.04988110810518265, decouple_loss:0.04337696731090546
The modified gen p mean: 0.4492420256137848, gen p mean: 0.0, mean p set: 0.4502687156200409
loss_pred:0.0507667139172554, decouple_loss:0.04607829079031944
The modified gen p mean: 0.45273682475090027, gen p mean: 0.0, mean p set: 0.45083388686180115
loss_pred:0.050134290009737015, decouple_loss:0.04392608255147934
Iteration: 242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527605175971985, gen p mean: 0.0, mean p set: 0.4523037374019623
loss_pred:0.049860499799251556, decouple_loss:0.04412021115422249
The modified gen p mean: 0.4532967805862427, gen p mean: 0.0, mean p set: 0.45144134759902954
loss_pred:0.0540878027677536, decouple_loss:0.04600286856293678
The modified gen p mean: 0.44980353116989136, gen p mean: 0.0, mean p set: 0.45152872800827026
loss_pred:0.05277105048298836, decouple_loss:0.04748693108558655
Iteration: 243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45837733149528503, gen p mean: 0.0, mean p set: 0.4510355293750763
loss_pred:0.05405224487185478, decouple_loss:0.04567248001694679
The modified gen p mean: 0.45408353209495544, gen p mean: 0.0, mean p set: 0.45161738991737366
loss_pred:0.05261818692088127, decouple_loss:0.04690525680780411
The modified gen p mean: 0.4549468755722046, gen p mean: 0.0, mean p set: 0.45139533281326294
loss_pred:0.04888889566063881, decouple_loss:0.04461970180273056
Iteration: 244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4449089765548706, gen p mean: 0.0, mean p set: 0.4512987732887268
loss_pred:0.053170785307884216, decouple_loss:0.04542785882949829
The modified gen p mean: 0.4429580569267273, gen p mean: 0.0, mean p set: 0.45063063502311707
loss_pred:0.0534493625164032, decouple_loss:0.04749671369791031
The modified gen p mean: 0.4456287622451782, gen p mean: 0.0, mean p set: 0.4511867165565491
loss_pred:0.05474559962749481, decouple_loss:0.04508175328373909
Iteration: 245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44447043538093567, gen p mean: 0.0, mean p set: 0.4508259892463684
loss_pred:0.0505777969956398, decouple_loss:0.04657723009586334
The modified gen p mean: 0.44625306129455566, gen p mean: 0.0, mean p set: 0.4518486559391022
loss_pred:0.05163125693798065, decouple_loss:0.045992132276296616
The modified gen p mean: 0.44794028997421265, gen p mean: 0.0, mean p set: 0.4503689110279083
loss_pred:0.05273837223649025, decouple_loss:0.045734092593193054
Iteration: 246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469355046749115, gen p mean: 0.0, mean p set: 0.4516811966896057
loss_pred:0.05521300807595253, decouple_loss:0.04578709229826927
The modified gen p mean: 0.44037964940071106, gen p mean: 0.0, mean p set: 0.45078244805336
loss_pred:0.05023255571722984, decouple_loss:0.04650549218058586
The modified gen p mean: 0.4424428939819336, gen p mean: 0.0, mean p set: 0.4516315758228302
loss_pred:0.05197407677769661, decouple_loss:0.045446548610925674
Iteration: 247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44958359003067017, gen p mean: 0.0, mean p set: 0.45259371399879456
The modified gen p mean: 0.4477154016494751, gen p mean: 0.0, mean p set: 0.45150595903396606
loss_pred:0.051273975521326065, decouple_loss:0.04457845911383629
loss_pred:0.05228157341480255, decouple_loss:0.046940550208091736
The modified gen p mean: 0.45365750789642334, gen p mean: 0.0, mean p set: 0.45218974351882935
loss_pred:0.052838727831840515, decouple_loss:0.04475211352109909
Iteration: 248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4632154703140259, gen p mean: 0.0, mean p set: 0.4520775377750397
loss_pred:0.0518607571721077, decouple_loss:0.045702915638685226
The modified gen p mean: 0.46473509073257446, gen p mean: 0.0, mean p set: 0.4519176781177521
loss_pred:0.05546309053897858, decouple_loss:0.04642130061984062
The modified gen p mean: 0.46425196528434753, gen p mean: 0.0, mean p set: 0.4505978226661682
loss_pred:0.0502869114279747, decouple_loss:0.04674570634961128
Iteration: 249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45035162568092346, gen p mean: 0.0, mean p set: 0.4513457417488098
loss_pred:0.05477321147918701, decouple_loss:0.047088608145713806
The modified gen p mean: 0.4401240348815918, gen p mean: 0.0, mean p set: 0.45300063490867615
loss_pred:0.05157266929745674, decouple_loss:0.04571763798594475
The modified gen p mean: 0.4405088722705841, gen p mean: 0.0, mean p set: 0.45048442482948303
loss_pred:0.049540743231773376, decouple_loss:0.045506320893764496
Iteration: 250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44340401887893677, gen p mean: 0.0, mean p set: 0.4505697786808014
loss_pred:0.05603863671422005, decouple_loss:0.045431360602378845
The modified gen p mean: 0.44217708706855774, gen p mean: 0.0, mean p set: 0.44927823543548584
loss_pred:0.050397176295518875, decouple_loss:0.0452723354101181
The modified gen p mean: 0.45077547430992126, gen p mean: 0.0, mean p set: 0.45208606123924255
loss_pred:0.050915200263261795, decouple_loss:0.04586047679185867
2023-05-05 18:24:32 testing...
The modified gen p mean: 0.45519566535949707, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.05291945859789848, decouple_loss:0.047286417335271835
The modified gen p mean: 0.459562212228775, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.05256086215376854, decouple_loss:0.04733293503522873
The modified gen p mean: 0.4590124785900116, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.05204543471336365, decouple_loss:0.04727105051279068
WV_1_PC_0_EH_0_PS_40_6, loss: 0.054873429238796234, avg_mse: 0.055718373507261276
current test mse: 0.055718
Iteration: 251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4578663110733032, gen p mean: 0.0, mean p set: 0.4492678940296173
loss_pred:0.049143943935632706, decouple_loss:0.04618270695209503
The modified gen p mean: 0.45326143503189087, gen p mean: 0.0, mean p set: 0.45265302062034607
loss_pred:0.04990315064787865, decouple_loss:0.0466085784137249
The modified gen p mean: 0.46057575941085815, gen p mean: 0.0, mean p set: 0.4508335292339325
loss_pred:0.05177411809563637, decouple_loss:0.046907469630241394
Iteration: 252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44834697246551514, gen p mean: 0.0, mean p set: 0.4511551260948181
loss_pred:0.05405622348189354, decouple_loss:0.046706583350896835
The modified gen p mean: 0.4508310556411743, gen p mean: 0.0, mean p set: 0.4511536657810211
loss_pred:0.05189092457294464, decouple_loss:0.04557497054338455
The modified gen p mean: 0.4503908157348633, gen p mean: 0.0, mean p set: 0.4509296715259552
loss_pred:0.055823247879743576, decouple_loss:0.045750692486763
Iteration: 253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4429653584957123, gen p mean: 0.0, mean p set: 0.45135459303855896
loss_pred:0.048131298273801804, decouple_loss:0.04582463949918747
The modified gen p mean: 0.45005738735198975, gen p mean: 0.0, mean p set: 0.45174556970596313
loss_pred:0.05291556939482689, decouple_loss:0.0465116873383522
The modified gen p mean: 0.44534847140312195, gen p mean: 0.0, mean p set: 0.4511035680770874
loss_pred:0.052107073366642, decouple_loss:0.04695160314440727
Iteration: 254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45408135652542114, gen p mean: 0.0, mean p set: 0.4505743086338043
loss_pred:0.05136847123503685, decouple_loss:0.0464467778801918
The modified gen p mean: 0.45280206203460693, gen p mean: 0.0, mean p set: 0.45128458738327026
loss_pred:0.053015269339084625, decouple_loss:0.04562988504767418
The modified gen p mean: 0.4532741606235504, gen p mean: 0.0, mean p set: 0.4495851993560791
loss_pred:0.050059724599123, decouple_loss:0.04580491781234741
Iteration: 255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46026310324668884, gen p mean: 0.0, mean p set: 0.45176616311073303
loss_pred:0.05111722648143768, decouple_loss:0.046887241303920746
The modified gen p mean: 0.4578724801540375, gen p mean: 0.0, mean p set: 0.450858473777771
loss_pred:0.04934083670377731, decouple_loss:0.04463793337345123
The modified gen p mean: 0.4583895206451416, gen p mean: 0.0, mean p set: 0.4513053894042969
loss_pred:0.04772977903485298, decouple_loss:0.04588797315955162
Iteration: 256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43792784214019775, gen p mean: 0.0, mean p set: 0.4507865309715271
loss_pred:0.05025087296962738, decouple_loss:0.04539461061358452
The modified gen p mean: 0.43695586919784546, gen p mean: 0.0, mean p set: 0.4505757987499237
loss_pred:0.04933057725429535, decouple_loss:0.04605667665600777
The modified gen p mean: 0.4373156428337097, gen p mean: 0.0, mean p set: 0.4513612687587738
loss_pred:0.05207332596182823, decouple_loss:0.04599115252494812
Iteration: 257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4356427490711212, gen p mean: 0.0, mean p set: 0.4510516822338104
loss_pred:0.04979153722524643, decouple_loss:0.045217715203762054
The modified gen p mean: 0.4358654320240021, gen p mean: 0.0, mean p set: 0.45229944586753845
loss_pred:0.04889575392007828, decouple_loss:0.04562122002243996
The modified gen p mean: 0.42982181906700134, gen p mean: 0.0, mean p set: 0.4518546462059021
loss_pred:0.05371784791350365, decouple_loss:0.045789532363414764
Iteration: 258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4658960700035095, gen p mean: 0.0, mean p set: 0.4505924582481384
loss_pred:0.05034906417131424, decouple_loss:0.04447795823216438
The modified gen p mean: 0.4675757884979248, gen p mean: 0.0, mean p set: 0.45199018716812134
loss_pred:0.053068920969963074, decouple_loss:0.0450679287314415
The modified gen p mean: 0.4692802131175995, gen p mean: 0.0, mean p set: 0.45139649510383606
loss_pred:0.05078941956162453, decouple_loss:0.04508305713534355
Iteration: 259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45687398314476013, gen p mean: 0.0, mean p set: 0.4510705769062042
loss_pred:0.05135159566998482, decouple_loss:0.04376571625471115
The modified gen p mean: 0.457511842250824, gen p mean: 0.0, mean p set: 0.45139408111572266
loss_pred:0.05213622376322746, decouple_loss:0.04444614425301552
The modified gen p mean: 0.45230990648269653, gen p mean: 0.0, mean p set: 0.4507925808429718
loss_pred:0.051289722323417664, decouple_loss:0.044820256531238556
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
NaN value num: 0
Traceback (most recent call last):
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/run1.py", line 350, in <module>
    train_wrapper(model)
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/run1.py", line 271, in train_wrapper
    ims = train_input_handle.get_batch()
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/data_provider/mnist_new.py", line 133, in get_batch
    input_seq = self.input_batch()
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/data_provider/mnist_new.py", line 128, in input_batch
    input_batch[i, :self.current_input_length, :, :, :] = data_slice
ValueError: could not broadcast input array from shape (56,3,720,1440) into shape (48,3,720,1440)