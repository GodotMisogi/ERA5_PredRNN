After initialize model, args.img_channel:3
load model: /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
train_data_files nums: 125
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_09012020_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44602859020233154, gen p mean: -0.03620661795139313, mean p set: 0.44650891423225403The modified gen p mean: 0.4472615420818329, gen p mean: -0.03966149315237999, mean p set: 0.447741836309433The modified gen p mean: 0.44743624329566956, gen p mean: -0.037289444357156754, mean p set: 0.44791650772094727
loss_pred:0.020181111991405487, decouple_loss:0.001296124653890729
loss_pred:0.019247500225901604, decouple_loss:0.0013477286556735635
loss_pred:0.020031346008181572, decouple_loss:0.0014227782376110554
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788414239883423, gen p mean: -0.03389834240078926, mean p set: 0.4483644366264343
loss_pred:0.022186750546097755, decouple_loss:0.005013202782720327
The modified gen p mean: 0.4469181001186371, gen p mean: -0.033617619425058365, mean p set: 0.4473983943462372The modified gen p mean: 0.447712779045105, gen p mean: -0.03243066743016243, mean p set: 0.4481930732727051
loss_pred:0.022452425211668015, decouple_loss:0.004820480942726135
loss_pred:0.023068279027938843, decouple_loss:0.005041003692895174
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44820907711982727, gen p mean: -0.03244752064347267, mean p set: 0.448689341545105
loss_pred:0.02079674042761326, decouple_loss:0.003620235016569495
The modified gen p mean: 0.44729796051979065, gen p mean: -0.036145903170108795, mean p set: 0.44777825474739075The modified gen p mean: 0.44662222266197205, gen p mean: -0.03655143827199936, mean p set: 0.44710254669189453
loss_pred:0.021449780091643333, decouple_loss:0.0036927375476807356
loss_pred:0.021503731608390808, decouple_loss:0.0036623007617890835
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822707772254944, gen p mean: -0.04111989960074425, mean p set: 0.44870737195014954
loss_pred:0.021429389715194702, decouple_loss:0.003305386286228895
The modified gen p mean: 0.447120726108551, gen p mean: -0.03594331815838814, mean p set: 0.4476010203361511The modified gen p mean: 0.4468635618686676, gen p mean: -0.039678119122982025, mean p set: 0.4473438560962677
loss_pred:0.022366667166352272, decouple_loss:0.0034212437458336353
loss_pred:0.022216495126485825, decouple_loss:0.0033346940763294697
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44696685671806335, gen p mean: -0.019658925011754036, mean p set: 0.44744715094566345
loss_pred:0.024314966052770615, decouple_loss:0.003608575090765953
The modified gen p mean: 0.4484856128692627, gen p mean: -0.0173598974943161, mean p set: 0.4489658772945404The modified gen p mean: 0.4479951858520508, gen p mean: -0.015896882861852646, mean p set: 0.44847550988197327
loss_pred:0.024232106283307076, decouple_loss:0.0038110739551484585
loss_pred:0.023636164143681526, decouple_loss:0.0037313459906727076
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835320115089417, gen p mean: -0.03471454977989197, mean p set: 0.44883349537849426
loss_pred:0.020604876801371574, decouple_loss:0.004673071671277285
The modified gen p mean: 0.44496357440948486, gen p mean: -0.028855634853243828, mean p set: 0.4454438388347626The modified gen p mean: 0.44717904925346375, gen p mean: -0.028560705482959747, mean p set: 0.44765937328338623
loss_pred:0.021288247779011726, decouple_loss:0.004415994510054588
loss_pred:0.020464612171053886, decouple_loss:0.00451317522674799
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473952651023865, gen p mean: -0.04988449066877365, mean p set: 0.4478755593299866
loss_pred:0.024901099503040314, decouple_loss:0.004696979187428951
The modified gen p mean: 0.44554173946380615, gen p mean: -0.05033840239048004, mean p set: 0.44602203369140625The modified gen p mean: 0.4471152424812317, gen p mean: -0.05122273787856102, mean p set: 0.4475955367088318
loss_pred:0.025022150948643684, decouple_loss:0.004487496800720692
loss_pred:0.024255435913801193, decouple_loss:0.004631981253623962
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471989572048187, gen p mean: -0.05624866485595703, mean p set: 0.4476792514324188
loss_pred:0.02775542251765728, decouple_loss:0.0034713426139205694
The modified gen p mean: 0.4475243091583252, gen p mean: -0.04923025891184807, mean p set: 0.4480046033859253The modified gen p mean: 0.44812196493148804, gen p mean: -0.05184445157647133, mean p set: 0.44860225915908813
loss_pred:0.02670464664697647, decouple_loss:0.003239021636545658
loss_pred:0.027047036215662956, decouple_loss:0.003385788993909955
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721081852912903, gen p mean: -0.06111336126923561, mean p set: 0.4476911425590515
loss_pred:0.027582766488194466, decouple_loss:0.0030676452443003654
The modified gen p mean: 0.44798991084098816, gen p mean: -0.06200381740927696, mean p set: 0.44847017526626587The modified gen p mean: 0.4476078748703003, gen p mean: -0.061831969767808914, mean p set: 0.4480881989002228
loss_pred:0.027183065190911293, decouple_loss:0.003056798130273819
loss_pred:0.027627049013972282, decouple_loss:0.0031149601563811302
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811028242111206, gen p mean: -0.07450136542320251, mean p set: 0.44859054684638977
loss_pred:0.02600238099694252, decouple_loss:0.0027810055762529373
The modified gen p mean: 0.4445064067840576, gen p mean: -0.07123614102602005, mean p set: 0.4449867010116577The modified gen p mean: 0.4468125104904175, gen p mean: -0.07401049882173538, mean p set: 0.4472928047180176
loss_pred:0.026712385937571526, decouple_loss:0.002720485208556056
loss_pred:0.026510942727327347, decouple_loss:0.002807616489008069
2023-04-30 03:43:49 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.07416175305843353, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.06857209652662277, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.06949251890182495, mean p set: 0.4500633478164673
loss_pred:0.025256946682929993, decouple_loss:0.0029185935854911804
loss_pred:0.02392691560089588, decouple_loss:0.0029028772842139006
loss_pred:0.024223104119300842, decouple_loss:0.002935890108346939
WV_0_PC_1_EH_0_PS_40, loss: 0.02461494505405426, avg_mse: 0.031590741127729416
current test mse: 0.031591
At step 10, Best test: 0.031591
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_model_test_schedule_sampling_DynaMean.ckpt
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801080226898193, gen p mean: -0.07003691792488098, mean p set: 0.44849109649658203
loss_pred:0.02418632060289383, decouple_loss:0.0030692417640239
The modified gen p mean: 0.4476768970489502, gen p mean: -0.07263188064098358, mean p set: 0.4481572210788727The modified gen p mean: 0.44697442650794983, gen p mean: -0.07413066178560257, mean p set: 0.4474547207355499
loss_pred:0.024787088856101036, decouple_loss:0.0029814185108989477
loss_pred:0.02400888502597809, decouple_loss:0.003066306235268712
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44446447491645813, gen p mean: -0.06596880406141281, mean p set: 0.4449447691440582
loss_pred:0.02461012452840805, decouple_loss:0.0034906966611742973
The modified gen p mean: 0.4468170702457428, gen p mean: -0.07284799963235855, mean p set: 0.4472973346710205The modified gen p mean: 0.4484882354736328, gen p mean: -0.06476189196109772, mean p set: 0.4489684998989105
loss_pred:0.02371339127421379, decouple_loss:0.0035374793224036694
loss_pred:0.023533819243311882, decouple_loss:0.003437828039750457
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44672471284866333, gen p mean: -0.0661778599023819, mean p set: 0.4472050368785858
loss_pred:0.024430956691503525, decouple_loss:0.0035922119859606028
The modified gen p mean: 0.4474976360797882, gen p mean: -0.06670016050338745, mean p set: 0.4479779005050659The modified gen p mean: 0.44804710149765015, gen p mean: -0.06678560376167297, mean p set: 0.44852742552757263
loss_pred:0.024678539484739304, decouple_loss:0.0034004116896539927
loss_pred:0.024598881602287292, decouple_loss:0.003552996087819338
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483972191810608, gen p mean: -0.07545839995145798, mean p set: 0.4488775134086609
loss_pred:0.022401491180062294, decouple_loss:0.0031967079266905785
The modified gen p mean: 0.4472980797290802, gen p mean: -0.07847051322460175, mean p set: 0.4477783739566803The modified gen p mean: 0.44757911562919617, gen p mean: -0.07430361956357956, mean p set: 0.44805940985679626
loss_pred:0.02406134083867073, decouple_loss:0.0031404977198690176
loss_pred:0.02267250418663025, decouple_loss:0.003083436284214258
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4448032081127167, gen p mean: -0.07809850573539734, mean p set: 0.4452835023403168
The modified gen p mean: 0.4468848705291748, gen p mean: -0.07761802524328232, mean p set: 0.4473651349544525
loss_pred:0.022503379732370377, decouple_loss:0.0033770196605473757
loss_pred:0.021803008392453194, decouple_loss:0.0034781266003847122
The modified gen p mean: 0.44837939739227295, gen p mean: -0.07719086110591888, mean p set: 0.44885969161987305
loss_pred:0.022009816020727158, decouple_loss:0.003473196178674698
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471440017223358, gen p mean: -0.07999762147665024, mean p set: 0.4476243257522583
loss_pred:0.02302100509405136, decouple_loss:0.0036902420688420534
The modified gen p mean: 0.4466514587402344, gen p mean: -0.07951266318559647, mean p set: 0.4471317529678345
The modified gen p mean: 0.4474490284919739, gen p mean: -0.08127322793006897, mean p set: 0.4479292929172516
loss_pred:0.022744640707969666, decouple_loss:0.0037036000285297632
loss_pred:0.02137184888124466, decouple_loss:0.0037443542387336493
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44690120220184326, gen p mean: -0.07569651305675507, mean p set: 0.44738152623176575
The modified gen p mean: 0.4465027153491974, gen p mean: -0.07430645078420639, mean p set: 0.4469830095767975
loss_pred:0.02224845252931118, decouple_loss:0.0034586957190185785
loss_pred:0.02212468534708023, decouple_loss:0.0035038364585489035
The modified gen p mean: 0.44742709398269653, gen p mean: -0.0714036226272583, mean p set: 0.44790738821029663
loss_pred:0.020820319652557373, decouple_loss:0.003562087891623378
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44805577397346497, gen p mean: -0.07215351611375809, mean p set: 0.44853606820106506
loss_pred:0.021246176213026047, decouple_loss:0.0036236890591681004
The modified gen p mean: 0.44743895530700684, gen p mean: -0.07579579949378967, mean p set: 0.44791924953460693The modified gen p mean: 0.448246568441391, gen p mean: -0.07203298062086105, mean p set: 0.4487268626689911
loss_pred:0.020975446328520775, decouple_loss:0.0036831314209848642
loss_pred:0.021119024604558945, decouple_loss:0.0036995767150074244
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724640250205994, gen p mean: -0.06436028331518173, mean p set: 0.44772669672966003
The modified gen p mean: 0.4461824595928192, gen p mean: -0.06952964514493942, mean p set: 0.4466627538204193
The modified gen p mean: 0.4477062523365021, gen p mean: -0.06370086967945099, mean p set: 0.4481865465641022
loss_pred:0.020167335867881775, decouple_loss:0.0035004981327801943
loss_pred:0.021417293697595596, decouple_loss:0.0036055538803339005
loss_pred:0.020069578662514687, decouple_loss:0.003547555999830365
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686490297317505, gen p mean: -0.06690600514411926, mean p set: 0.44734519720077515
The modified gen p mean: 0.4467393755912781, gen p mean: -0.06737007945775986, mean p set: 0.4472196698188782
loss_pred:0.02094627358019352, decouple_loss:0.003489944152534008
loss_pred:0.019989926367998123, decouple_loss:0.0034478832967579365
The modified gen p mean: 0.44732797145843506, gen p mean: -0.061275433748960495, mean p set: 0.44780823588371277
loss_pred:0.020038871094584465, decouple_loss:0.0034182171802967787
2023-04-30 03:45:50 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.07009997963905334, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.06398726999759674, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.06487349420785904, mean p set: 0.4500633478164673
loss_pred:0.02100110426545143, decouple_loss:0.0034911110997200012
loss_pred:0.01978415623307228, decouple_loss:0.003570806933566928
loss_pred:0.019928526133298874, decouple_loss:0.0035389040131121874
WV_0_PC_1_EH_0_PS_40, loss: 0.02041461132466793, avg_mse: 0.02849528193473816
current test mse: 0.028495
At step 20, Best test: 0.028495
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
NaN value num: 0
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45025137066841125, gen p mean: -0.06110081076622009, mean p set: 0.45073163509368896
loss_pred:0.02196870744228363, decouple_loss:0.0036434929352253675
The modified gen p mean: 0.44984108209609985, gen p mean: -0.0656561553478241, mean p set: 0.45032137632369995The modified gen p mean: 0.44674253463745117, gen p mean: -0.06310918927192688, mean p set: 0.44722285866737366
loss_pred:0.022051576524972916, decouple_loss:0.003744119545444846
loss_pred:0.020316632464528084, decouple_loss:0.0034840793814510107
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497940242290497, gen p mean: -0.06552062183618546, mean p set: 0.4502742886543274
loss_pred:0.021535754203796387, decouple_loss:0.0033291520085185766
The modified gen p mean: 0.45010796189308167, gen p mean: -0.06341851502656937, mean p set: 0.4505882263183594The modified gen p mean: 0.4502987265586853, gen p mean: -0.06464622169733047, mean p set: 0.4507790505886078
loss_pred:0.021389314904808998, decouple_loss:0.0033600691240280867
loss_pred:0.020719105377793312, decouple_loss:0.0034245739225298166
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487427771091461, gen p mean: -0.07510468363761902, mean p set: 0.4492231011390686
The modified gen p mean: 0.4500325322151184, gen p mean: -0.06776469200849533, mean p set: 0.4505128264427185
loss_pred:0.021257847547531128, decouple_loss:0.0032678155694156885
loss_pred:0.021068530157208443, decouple_loss:0.0032067792490124702
The modified gen p mean: 0.450736403465271, gen p mean: -0.06573496758937836, mean p set: 0.4512166678905487
loss_pred:0.0209110789000988, decouple_loss:0.003208944108337164
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44949010014533997, gen p mean: -0.06970733404159546, mean p set: 0.44997039437294006
The modified gen p mean: 0.45105382800102234, gen p mean: -0.06624294072389603, mean p set: 0.45153409242630005
loss_pred:0.021063396707177162, decouple_loss:0.0031615952029824257
The modified gen p mean: 0.4507276117801666, gen p mean: -0.06803888082504272, mean p set: 0.4512079358100891loss_pred:0.020040057599544525, decouple_loss:0.003255655290558934
loss_pred:0.020438039675354958, decouple_loss:0.00321654393337667
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44963181018829346, gen p mean: -0.06872576475143433, mean p set: 0.45011213421821594
The modified gen p mean: 0.44995397329330444, gen p mean: -0.07283162325620651, mean p set: 0.45043426752090454
The modified gen p mean: 0.4486439526081085, gen p mean: -0.06885528564453125, mean p set: 0.449124276638031
loss_pred:0.020767617970705032, decouple_loss:0.0031640224624425173
loss_pred:0.020242461934685707, decouple_loss:0.0031317465472966433loss_pred:0.02068616822361946, decouple_loss:0.0031739487312734127
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44673827290534973, gen p mean: -0.0769386738538742, mean p set: 0.44721853733062744
loss_pred:0.019221823662519455, decouple_loss:0.002928356872871518
The modified gen p mean: 0.44914600253105164, gen p mean: -0.070485919713974, mean p set: 0.44962626695632935The modified gen p mean: 0.4507257342338562, gen p mean: -0.07471977919340134, mean p set: 0.4512060284614563
loss_pred:0.02067016251385212, decouple_loss:0.0029341215267777443
loss_pred:0.020224086940288544, decouple_loss:0.002941201673820615
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507609009742737, gen p mean: -0.07250593602657318, mean p set: 0.4512411952018738
loss_pred:0.018971147015690804, decouple_loss:0.002981488825753331
The modified gen p mean: 0.44794589281082153, gen p mean: -0.08112339675426483, mean p set: 0.44842615723609924The modified gen p mean: 0.4517248272895813, gen p mean: -0.07384543120861053, mean p set: 0.4522051215171814
loss_pred:0.019455714151263237, decouple_loss:0.0029095474164932966
loss_pred:0.01980598270893097, decouple_loss:0.0029056216590106487
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476175606250763, gen p mean: -0.07438793033361435, mean p set: 0.4480978846549988
The modified gen p mean: 0.44891270995140076, gen p mean: -0.06984224170446396, mean p set: 0.44939300417900085
loss_pred:0.020444529131054878, decouple_loss:0.0027279923669993877
loss_pred:0.02016529068350792, decouple_loss:0.002733648754656315
The modified gen p mean: 0.44841670989990234, gen p mean: -0.0680956020951271, mean p set: 0.44889700412750244
loss_pred:0.020345307886600494, decouple_loss:0.0027203282807022333
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493338465690613, gen p mean: -0.08235419541597366, mean p set: 0.4498141407966614
loss_pred:0.021330585703253746, decouple_loss:0.002959376433864236
The modified gen p mean: 0.44947001338005066, gen p mean: -0.07199358195066452, mean p set: 0.44995033740997314The modified gen p mean: 0.44912129640579224, gen p mean: -0.07195782661437988, mean p set: 0.44960159063339233
loss_pred:0.019959930330514908, decouple_loss:0.002844021888449788
loss_pred:0.02034364826977253, decouple_loss:0.0028606150299310684
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494977295398712, gen p mean: -0.07073365896940231, mean p set: 0.4499780237674713
The modified gen p mean: 0.45077434182167053, gen p mean: -0.0698605477809906, mean p set: 0.45125463604927063
loss_pred:0.02091623656451702, decouple_loss:0.0023835375905036926
loss_pred:0.018698716536164284, decouple_loss:0.0024488100316375494
The modified gen p mean: 0.4490266442298889, gen p mean: -0.06785333901643753, mean p set: 0.4495069682598114
loss_pred:0.021510258316993713, decouple_loss:0.002402630867436528
2023-04-30 03:48:36 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.08271139860153198, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0763755664229393, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.07710731774568558, mean p set: 0.4500633478164673
loss_pred:0.020289812237024307, decouple_loss:0.002437255345284939
loss_pred:0.019135627895593643, decouple_loss:0.0023892750032246113
loss_pred:0.01920415833592415, decouple_loss:0.002380925230681896
WV_0_PC_1_EH_0_PS_40, loss: 0.01966332457959652, avg_mse: 0.027667948976159096
current test mse: 0.027668
At step 30, Best test: 0.027668
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_model_test_schedule_sampling_DynaMean.ckpt
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505627155303955, gen p mean: -0.07608164846897125, mean p set: 0.4510430097579956
loss_pred:0.019781894981861115, decouple_loss:0.002387020969763398
The modified gen p mean: 0.4501286745071411, gen p mean: -0.07317142188549042, mean p set: 0.4506089687347412The modified gen p mean: 0.44839614629745483, gen p mean: -0.08546393364667892, mean p set: 0.44887641072273254
loss_pred:0.02034905180335045, decouple_loss:0.002399510471150279
loss_pred:0.02006922848522663, decouple_loss:0.002334180986508727
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769155979156494, gen p mean: -0.0748666301369667, mean p set: 0.44817185401916504
The modified gen p mean: 0.44911545515060425, gen p mean: -0.07367851585149765, mean p set: 0.44959574937820435
loss_pred:0.020665591582655907, decouple_loss:0.0023532556369900703
loss_pred:0.019999584183096886, decouple_loss:0.0022781305015087128The modified gen p mean: 0.44786569476127625, gen p mean: -0.08397440612316132, mean p set: 0.44834598898887634
loss_pred:0.019678236916661263, decouple_loss:0.002271892037242651
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479712247848511, gen p mean: -0.07701344788074493, mean p set: 0.44845154881477356
The modified gen p mean: 0.4493923783302307, gen p mean: -0.08641473948955536, mean p set: 0.4498726725578308
loss_pred:0.019852375611662865, decouple_loss:0.0023001309018582106
loss_pred:0.021081209182739258, decouple_loss:0.0023361898493021727
The modified gen p mean: 0.4496336579322815, gen p mean: -0.08195753395557404, mean p set: 0.4501139223575592
loss_pred:0.020005183294415474, decouple_loss:0.002264963695779443
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482898414134979, gen p mean: -0.08042731881141663, mean p set: 0.448770135641098
The modified gen p mean: 0.4507928490638733, gen p mean: -0.08231227844953537, mean p set: 0.4512731432914734
loss_pred:0.020061513409018517, decouple_loss:0.0022864381317049265
loss_pred:0.019267523661255836, decouple_loss:0.0023381197825074196
The modified gen p mean: 0.45003268122673035, gen p mean: -0.07881791889667511, mean p set: 0.45051300525665283
loss_pred:0.01936297118663788, decouple_loss:0.0023317625746130943
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485871195793152, gen p mean: -0.08711815625429153, mean p set: 0.4490673840045929
The modified gen p mean: 0.45086026191711426, gen p mean: -0.08000669628381729, mean p set: 0.45134055614471436
loss_pred:0.020427804440259933, decouple_loss:0.0024077717680484056
loss_pred:0.020282989367842674, decouple_loss:0.0023435158655047417
The modified gen p mean: 0.45115989446640015, gen p mean: -0.08369053155183792, mean p set: 0.45164018869400024
loss_pred:0.018520591780543327, decouple_loss:0.002389486413449049
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485575258731842, gen p mean: -0.08859602361917496, mean p set: 0.4490378499031067
The modified gen p mean: 0.44819459319114685, gen p mean: -0.09316762536764145, mean p set: 0.44867488741874695
loss_pred:0.019943660125136375, decouple_loss:0.0023865157272666693
loss_pred:0.019236456602811813, decouple_loss:0.0024185446090996265The modified gen p mean: 0.4484102725982666, gen p mean: -0.08735834807157516, mean p set: 0.4488905668258667
loss_pred:0.01962512731552124, decouple_loss:0.002393739065155387
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471046030521393, gen p mean: -0.08638925850391388, mean p set: 0.44758492708206177
The modified gen p mean: 0.4473506510257721, gen p mean: -0.08502595126628876, mean p set: 0.4478309452533722
loss_pred:0.01864968240261078, decouple_loss:0.0022917105816304684
loss_pred:0.020017094910144806, decouple_loss:0.0022898875176906586
The modified gen p mean: 0.45026329159736633, gen p mean: -0.08766739815473557, mean p set: 0.45074358582496643
loss_pred:0.019373105838894844, decouple_loss:0.002424078993499279
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505573809146881, gen p mean: -0.0779304951429367, mean p set: 0.4510376751422882
The modified gen p mean: 0.4490819573402405, gen p mean: -0.08162326365709305, mean p set: 0.4495622515678406
loss_pred:0.0194567684084177, decouple_loss:0.0021813558414578438
loss_pred:0.020257366821169853, decouple_loss:0.0022179456427693367
The modified gen p mean: 0.4480366110801697, gen p mean: -0.08471260219812393, mean p set: 0.4485168755054474
loss_pred:0.01916522905230522, decouple_loss:0.0022621515672653913
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477318525314331, gen p mean: -0.0842699408531189, mean p set: 0.4482121169567108
The modified gen p mean: 0.4507046639919281, gen p mean: -0.0729759931564331, mean p set: 0.4511849880218506
loss_pred:0.0191293153911829, decouple_loss:0.002255919622257352
loss_pred:0.018709145486354828, decouple_loss:0.0023314370773732662
The modified gen p mean: 0.44873711466789246, gen p mean: -0.0742669552564621, mean p set: 0.44921740889549255
loss_pred:0.02002255991101265, decouple_loss:0.002227884018793702
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476284086704254, gen p mean: -0.06578005850315094, mean p set: 0.4481086730957031
The modified gen p mean: 0.4471445083618164, gen p mean: -0.07041625678539276, mean p set: 0.4476247727870941
loss_pred:0.01996021345257759, decouple_loss:0.002172852400690317
loss_pred:0.01989748515188694, decouple_loss:0.002160934964194894
The modified gen p mean: 0.4480634927749634, gen p mean: -0.07178223878145218, mean p set: 0.4485437870025635
loss_pred:0.019374905154109, decouple_loss:0.0021824094001203775
2023-04-30 03:50:34 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.07507917284965515, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.06892067193984985, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.07008419185876846, mean p set: 0.4500633478164673
loss_pred:0.019491221755743027, decouple_loss:0.0022040430922061205
loss_pred:0.018497439101338387, decouple_loss:0.0020946210715919733
loss_pred:0.018513385206460953, decouple_loss:0.00213125953450799
WV_0_PC_1_EH_0_PS_40, loss: 0.018941182643175125, avg_mse: 0.026939664036035538
current test mse: 0.02694
At step 40, Best test: 0.02694
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
NaN value num: 0
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45179152488708496, gen p mean: -0.06568505614995956, mean p set: 0.45227181911468506
loss_pred:0.019845757633447647, decouple_loss:0.002252731239423156
The modified gen p mean: 0.45147714018821716, gen p mean: -0.06590381264686584, mean p set: 0.4519574046134949The modified gen p mean: 0.44979164004325867, gen p mean: -0.06219533085823059, mean p set: 0.45027193427085876
loss_pred:0.019342508167028427, decouple_loss:0.0022433188278228045loss_pred:0.019007274881005287, decouple_loss:0.0021783611737191677
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45108312368392944, gen p mean: -0.061472337692976, mean p set: 0.45156344771385193
The modified gen p mean: 0.4503987729549408, gen p mean: -0.06024281680583954, mean p set: 0.4508790671825409
The modified gen p mean: 0.45141661167144775, gen p mean: -0.06025705859065056, mean p set: 0.45189690589904785
loss_pred:0.018979717046022415, decouple_loss:0.0020227371715009212
loss_pred:0.019076189026236534, decouple_loss:0.0020060697570443153loss_pred:0.018738679587841034, decouple_loss:0.0020562235731631517
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448866069316864, gen p mean: -0.05854179710149765, mean p set: 0.4493463933467865
The modified gen p mean: 0.45184168219566345, gen p mean: -0.059510111808776855, mean p set: 0.45232194662094116
The modified gen p mean: 0.4504108428955078, gen p mean: -0.0616115927696228, mean p set: 0.4508911669254303loss_pred:0.0202872883528471, decouple_loss:0.00197135703638196
loss_pred:0.019489886239171028, decouple_loss:0.0019671269692480564
loss_pred:0.018988780677318573, decouple_loss:0.0019459450850263238
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960305094718933, gen p mean: -0.054994549602270126, mean p set: 0.45008331537246704
loss_pred:0.017940625548362732, decouple_loss:0.0019396361894905567
The modified gen p mean: 0.45146384835243225, gen p mean: -0.051361482590436935, mean p set: 0.45194414258003235
The modified gen p mean: 0.4499431252479553, gen p mean: -0.05301554128527641, mean p set: 0.4504234194755554
loss_pred:0.02031603641808033, decouple_loss:0.0018778680823743343
loss_pred:0.019167138263583183, decouple_loss:0.0018400464905425906
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493679106235504, gen p mean: -0.05620613321661949, mean p set: 0.4498482048511505
The modified gen p mean: 0.44859978556632996, gen p mean: -0.05743153393268585, mean p set: 0.44908010959625244
loss_pred:0.019039910286664963, decouple_loss:0.0017821432556957006
loss_pred:0.0188142117112875, decouple_loss:0.0018063370371237397
The modified gen p mean: 0.4500294327735901, gen p mean: -0.059945378452539444, mean p set: 0.4505097270011902
loss_pred:0.018387887626886368, decouple_loss:0.001981764566153288
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495231807231903, gen p mean: -0.05815023556351662, mean p set: 0.4500034749507904
loss_pred:0.019449345767498016, decouple_loss:0.001709243981167674
The modified gen p mean: 0.4501669704914093, gen p mean: -0.05512528121471405, mean p set: 0.450647234916687The modified gen p mean: 0.44940727949142456, gen p mean: -0.059504833072423935, mean p set: 0.44988757371902466
loss_pred:0.018616070970892906, decouple_loss:0.0017627881607040763
loss_pred:0.017950017005205154, decouple_loss:0.001841450110077858
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489685595035553, gen p mean: -0.05315569043159485, mean p set: 0.4494488537311554
loss_pred:0.01768389716744423, decouple_loss:0.0018615563167259097
The modified gen p mean: 0.45046067237854004, gen p mean: -0.06309056282043457, mean p set: 0.45094096660614014The modified gen p mean: 0.44975170493125916, gen p mean: -0.05572322756052017, mean p set: 0.45023199915885925
loss_pred:0.017731143161654472, decouple_loss:0.0019330362556502223
loss_pred:0.01827680692076683, decouple_loss:0.0018913288367912173
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486233592033386, gen p mean: -0.05570894107222557, mean p set: 0.44910362362861633
loss_pred:0.017977440729737282, decouple_loss:0.0016814772970974445
The modified gen p mean: 0.45036736130714417, gen p mean: -0.05661854147911072, mean p set: 0.45084765553474426The modified gen p mean: 0.4490245580673218, gen p mean: -0.057828884571790695, mean p set: 0.4495048522949219
loss_pred:0.01785142533481121, decouple_loss:0.0016937950858846307
loss_pred:0.018493158742785454, decouple_loss:0.001804647850804031
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45234426856040955, gen p mean: -0.05751257389783859, mean p set: 0.45282456278800964
loss_pred:0.019126908853650093, decouple_loss:0.0018975508864969015
The modified gen p mean: 0.450987309217453, gen p mean: -0.05436989292502403, mean p set: 0.4514676034450531The modified gen p mean: 0.45040997862815857, gen p mean: -0.0551193542778492, mean p set: 0.45089030265808105
loss_pred:0.01924406737089157, decouple_loss:0.001838994910940528
loss_pred:0.019427336752414703, decouple_loss:0.001794998999685049
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45104214549064636, gen p mean: -0.06275961548089981, mean p set: 0.4515224099159241
loss_pred:0.019199073314666748, decouple_loss:0.001821974408812821
The modified gen p mean: 0.45020562410354614, gen p mean: -0.06037743762135506, mean p set: 0.45068594813346863The modified gen p mean: 0.4522383213043213, gen p mean: -0.06288205087184906, mean p set: 0.4527186155319214
loss_pred:0.018067585304379463, decouple_loss:0.0017648692009970546
loss_pred:0.018445825204253197, decouple_loss:0.0018036135006695986
2023-04-30 03:53:21 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.07533307373523712, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.07043789327144623, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.06949494779109955, mean p set: 0.45035696029663086
loss_pred:0.01928308792412281, decouple_loss:0.0017202598974108696
loss_pred:0.018244152888655663, decouple_loss:0.001697394996881485
loss_pred:0.018210740759968758, decouple_loss:0.001748255337588489
WV_0_PC_1_EH_0_PS_40, loss: 0.01866542547941208, avg_mse: 0.026633230969309807
current test mse: 0.026633
At step 50, Best test: 0.026633
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_model_test_schedule_sampling_DynaMean.ckpt
Iteration: 51, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521111845970154, gen p mean: -0.06066042184829712, mean p set: 0.4525914490222931
loss_pred:0.01909245364367962, decouple_loss:0.0015929978108033538
The modified gen p mean: 0.44990274310112, gen p mean: -0.07291866093873978, mean p set: 0.4503830373287201The modified gen p mean: 0.44886985421180725, gen p mean: -0.06445888429880142, mean p set: 0.44935014843940735
loss_pred:0.01765257865190506, decouple_loss:0.0016605114797130227
loss_pred:0.016908181831240654, decouple_loss:0.0015814431244507432
Iteration: 52, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44922390580177307, gen p mean: -0.06835624575614929, mean p set: 0.4497041702270508
The modified gen p mean: 0.452014684677124, gen p mean: -0.07005508989095688, mean p set: 0.4524949789047241
loss_pred:0.01723814755678177, decouple_loss:0.0016830572858452797
loss_pred:0.01834592968225479, decouple_loss:0.0017928526503965259
The modified gen p mean: 0.45059144496917725, gen p mean: -0.06542511284351349, mean p set: 0.45107173919677734
loss_pred:0.018079344183206558, decouple_loss:0.0016995840705931187
Iteration: 53, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495670199394226, gen p mean: -0.0657644271850586, mean p set: 0.4500472843647003
loss_pred:0.01870671473443508, decouple_loss:0.001632055384106934
The modified gen p mean: 0.45300352573394775, gen p mean: -0.0637575015425682, mean p set: 0.45348381996154785The modified gen p mean: 0.4496305584907532, gen p mean: -0.06731616705656052, mean p set: 0.45011085271835327
loss_pred:0.018864639103412628, decouple_loss:0.0015925088664516807
loss_pred:0.019046494737267494, decouple_loss:0.0015577571466565132
Iteration: 54, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452693909406662, gen p mean: -0.065839484333992, mean p set: 0.4531742036342621
loss_pred:0.018931690603494644, decouple_loss:0.0015544748166576028
The modified gen p mean: 0.44940486550331116, gen p mean: -0.06652577966451645, mean p set: 0.44988515973091125The modified gen p mean: 0.4485670328140259, gen p mean: -0.062399089336395264, mean p set: 0.44904735684394836
loss_pred:0.018061770126223564, decouple_loss:0.0015683911042287946
loss_pred:0.017149314284324646, decouple_loss:0.0015232282457873225
Iteration: 55, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496549963951111, gen p mean: -0.06277699768543243, mean p set: 0.45013532042503357
The modified gen p mean: 0.4490223824977875, gen p mean: -0.0653887540102005, mean p set: 0.4495026767253876
loss_pred:0.01913241297006607, decouple_loss:0.001523369923233986
The modified gen p mean: 0.45180878043174744, gen p mean: -0.06619289517402649, mean p set: 0.45228907465934753
loss_pred:0.0171495471149683, decouple_loss:0.0015230223070830107
loss_pred:0.0187242329120636, decouple_loss:0.0017175123794004321
Iteration: 56, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505055248737335, gen p mean: -0.0695001408457756, mean p set: 0.450985848903656
The modified gen p mean: 0.44958770275115967, gen p mean: -0.0663578137755394, mean p set: 0.45006799697875977
loss_pred:0.01793050765991211, decouple_loss:0.0014799005584791303
loss_pred:0.017359791323542595, decouple_loss:0.0014209122164174914
The modified gen p mean: 0.4496084749698639, gen p mean: -0.06213962659239769, mean p set: 0.4500887989997864
loss_pred:0.01795126497745514, decouple_loss:0.0013936815084889531
Iteration: 57, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44874706864356995, gen p mean: -0.06734544783830643, mean p set: 0.44922736287117004
The modified gen p mean: 0.44906169176101685, gen p mean: -0.06557688862085342, mean p set: 0.44954198598861694
loss_pred:0.018344590440392494, decouple_loss:0.0015824284637346864
loss_pred:0.018317805603146553, decouple_loss:0.001407643430866301
The modified gen p mean: 0.44924798607826233, gen p mean: -0.0667189508676529, mean p set: 0.4497282803058624
loss_pred:0.01780853047966957, decouple_loss:0.0014790534041821957
Iteration: 58, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45205265283584595, gen p mean: -0.059070125222206116, mean p set: 0.45253291726112366
loss_pred:0.018039878457784653, decouple_loss:0.0013763067545369267
The modified gen p mean: 0.45179903507232666, gen p mean: -0.06184546649456024, mean p set: 0.45227932929992676The modified gen p mean: 0.4515248239040375, gen p mean: -0.06153292581439018, mean p set: 0.45200514793395996
loss_pred:0.018805937841534615, decouple_loss:0.0013704809825867414
loss_pred:0.01856887899339199, decouple_loss:0.0013375006383284926
Iteration: 59, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505070447921753, gen p mean: -0.05994157865643501, mean p set: 0.4509873688220978
loss_pred:0.017704425379633904, decouple_loss:0.0013435190776363015
The modified gen p mean: 0.44939979910850525, gen p mean: -0.05844721570611, mean p set: 0.44988009333610535The modified gen p mean: 0.4499739408493042, gen p mean: -0.0641147643327713, mean p set: 0.4504542350769043
loss_pred:0.018116420134902, decouple_loss:0.0014311133418232203
loss_pred:0.016767697408795357, decouple_loss:0.001445902162231505
Iteration: 60, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45123106241226196, gen p mean: -0.05546071380376816, mean p set: 0.45171138644218445
loss_pred:0.01827114447951317, decouple_loss:0.0013144664699211717
The modified gen p mean: 0.45238858461380005, gen p mean: -0.05106551945209503, mean p set: 0.45286887884140015The modified gen p mean: 0.4519023895263672, gen p mean: -0.05916436389088631, mean p set: 0.4523826837539673
loss_pred:0.017609409987926483, decouple_loss:0.0013913873117417097
loss_pred:0.018022479489445686, decouple_loss:0.001415391219779849
2023-04-30 03:55:21 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.06409832090139389, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.058226339519023895, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05908491462469101, mean p set: 0.4500633478164673
loss_pred:0.01902184635400772, decouple_loss:0.0015754386549815536
loss_pred:0.017948022112250328, decouple_loss:0.0015327348373830318
loss_pred:0.01803375780582428, decouple_loss:0.0014790191780775785
WV_0_PC_1_EH_0_PS_40, loss: 0.018410995602607727, avg_mse: 0.026364846155047417
current test mse: 0.026365
At step 60, Best test: 0.026365
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 61, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466274380683899, gen p mean: -0.05854423716664314, mean p set: 0.44710773229599
loss_pred:0.01633833348751068, decouple_loss:0.0015660976059734821
The modified gen p mean: 0.4472739100456238, gen p mean: -0.055501826107501984, mean p set: 0.4477542042732239The modified gen p mean: 0.44646063446998596, gen p mean: -0.05884849652647972, mean p set: 0.44694095849990845
loss_pred:0.01706617884337902, decouple_loss:0.0015186774544417858loss_pred:0.016917411237955093, decouple_loss:0.0015233069425448775
Iteration: 62, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44587817788124084, gen p mean: -0.061644069850444794, mean p set: 0.44635844230651855
loss_pred:0.016032269224524498, decouple_loss:0.0014489523600786924
The modified gen p mean: 0.4474528133869171, gen p mean: -0.06335364282131195, mean p set: 0.4479331374168396The modified gen p mean: 0.4481351971626282, gen p mean: -0.05752234905958176, mean p set: 0.44861549139022827
loss_pred:0.015935096889734268, decouple_loss:0.001440772321075201
loss_pred:0.01590985432267189, decouple_loss:0.0014544249279424548
Iteration: 63, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760170578956604, gen p mean: -0.05931885913014412, mean p set: 0.44808200001716614
loss_pred:0.014538795687258244, decouple_loss:0.0013861075276508927
The modified gen p mean: 0.44622603058815, gen p mean: -0.057676516473293304, mean p set: 0.4467063546180725The modified gen p mean: 0.44721493124961853, gen p mean: -0.06213126704096794, mean p set: 0.44769522547721863
loss_pred:0.015464711003005505, decouple_loss:0.0014238570583984256
loss_pred:0.015696534886956215, decouple_loss:0.0014897638466209173
Iteration: 64, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840073585510254, gen p mean: -0.05719520524144173, mean p set: 0.448881059885025
The modified gen p mean: 0.44828417897224426, gen p mean: -0.05433870851993561, mean p set: 0.44876447319984436
loss_pred:0.015385170467197895, decouple_loss:0.001444624736905098
loss_pred:0.01499397587031126, decouple_loss:0.0015201809583231807
The modified gen p mean: 0.4461059272289276, gen p mean: -0.05697839707136154, mean p set: 0.4465861916542053
loss_pred:0.014973597601056099, decouple_loss:0.0014583066804334521
Iteration: 65, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44691744446754456, gen p mean: -0.05734040588140488, mean p set: 0.44739776849746704
loss_pred:0.015140479430556297, decouple_loss:0.0015632028225809336
The modified gen p mean: 0.44754672050476074, gen p mean: -0.06011083722114563, mean p set: 0.44802701473236084The modified gen p mean: 0.445803701877594, gen p mean: -0.05576924979686737, mean p set: 0.4462839961051941
loss_pred:0.015025710687041283, decouple_loss:0.0016054732259362936
loss_pred:0.013936842791736126, decouple_loss:0.0017648584907874465
Iteration: 66, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44720014929771423, gen p mean: -0.05963338911533356, mean p set: 0.4476804733276367
loss_pred:0.015462244860827923, decouple_loss:0.0017148898914456367
The modified gen p mean: 0.447457492351532, gen p mean: -0.0617409273982048, mean p set: 0.44793781638145447The modified gen p mean: 0.4464516043663025, gen p mean: -0.05638856068253517, mean p set: 0.4469318985939026
loss_pred:0.01536885928362608, decouple_loss:0.0017111495835706592
loss_pred:0.014846749603748322, decouple_loss:0.0015871961368247867
Iteration: 67, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790756702423096, gen p mean: -0.0649569183588028, mean p set: 0.44838783144950867
loss_pred:0.014581305906176567, decouple_loss:0.001585918478667736
The modified gen p mean: 0.44696521759033203, gen p mean: -0.05772783234715462, mean p set: 0.44744551181793213The modified gen p mean: 0.4459763467311859, gen p mean: -0.06350786983966827, mean p set: 0.446456640958786
loss_pred:0.014418081380426884, decouple_loss:0.0015465531032532454
loss_pred:0.014084186404943466, decouple_loss:0.0015503024915233254
Iteration: 68, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464872479438782, gen p mean: -0.066867895424366, mean p set: 0.44696754217147827
loss_pred:0.013345044106245041, decouple_loss:0.0015876723919063807
The modified gen p mean: 0.4458503723144531, gen p mean: -0.06467538326978683, mean p set: 0.4463306665420532The modified gen p mean: 0.4478619396686554, gen p mean: -0.06443776935338974, mean p set: 0.4483422338962555
loss_pred:0.014097732491791248, decouple_loss:0.0016711062053218484
loss_pred:0.014314093627035618, decouple_loss:0.0015502870082855225
Iteration: 69, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478778541088104, gen p mean: -0.06453374028205872, mean p set: 0.4483581483364105
loss_pred:0.013683016411960125, decouple_loss:0.0015676907496526837
The modified gen p mean: 0.44497737288475037, gen p mean: -0.06886762380599976, mean p set: 0.4454576373100281The modified gen p mean: 0.44723257422447205, gen p mean: -0.06491163372993469, mean p set: 0.44771286845207214
loss_pred:0.014159132726490498, decouple_loss:0.0016272718785330653
loss_pred:0.013885321095585823, decouple_loss:0.0016308898339048028
Iteration: 70, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722050428390503, gen p mean: -0.062144480645656586, mean p set: 0.4477007985115051
loss_pred:0.014135192148387432, decouple_loss:0.001531810499727726
The modified gen p mean: 0.4485483765602112, gen p mean: -0.05851387977600098, mean p set: 0.4490286707878113
The modified gen p mean: 0.44713258743286133, gen p mean: -0.06331722438335419, mean p set: 0.4476129114627838
loss_pred:0.014557003043591976, decouple_loss:0.0015433842781931162
loss_pred:0.01450746413320303, decouple_loss:0.0016625890275463462
2023-04-30 03:58:04 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.06260304898023605, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05818052962422371, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05840778350830078, mean p set: 0.4500633478164673
loss_pred:0.01988964155316353, decouple_loss:0.0016562441596761346
loss_pred:0.018819816410541534, decouple_loss:0.0016296599060297012
loss_pred:0.01891423761844635, decouple_loss:0.0016126985428854823
WV_0_PC_1_EH_0_PS_40, loss: 0.019289543852210045, avg_mse: 0.028102358803153038
current test mse: 0.028102
Iteration: 71, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796085357666016, gen p mean: -0.06038341298699379, mean p set: 0.44844114780426025The modified gen p mean: 0.44727274775505066, gen p mean: -0.060892365872859955, mean p set: 0.44775307178497314
The modified gen p mean: 0.4455007314682007, gen p mean: -0.06836545467376709, mean p set: 0.44598105549812317
loss_pred:0.013690214604139328, decouple_loss:0.001599963754415512
loss_pred:0.013160038739442825, decouple_loss:0.00155839161016047
loss_pred:0.013831534422934055, decouple_loss:0.0015400308184325695
Iteration: 72, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474099576473236, gen p mean: -0.05552861467003822, mean p set: 0.4478902518749237
loss_pred:0.01420687884092331, decouple_loss:0.0015653148293495178
The modified gen p mean: 0.44681262969970703, gen p mean: -0.05229640007019043, mean p set: 0.44729292392730713The modified gen p mean: 0.4477289915084839, gen p mean: -0.0587194450199604, mean p set: 0.448209285736084
loss_pred:0.013662216253578663, decouple_loss:0.0015794640639796853
loss_pred:0.014387914910912514, decouple_loss:0.0015916230622678995
Iteration: 73, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469771385192871, gen p mean: -0.05656573921442032, mean p set: 0.4474574029445648
The modified gen p mean: 0.4462986886501312, gen p mean: -0.05400887876749039, mean p set: 0.4467789828777313
loss_pred:0.013724078424274921, decouple_loss:0.001595102483406663
loss_pred:0.013714108616113663, decouple_loss:0.0016255625523626804
The modified gen p mean: 0.44668105244636536, gen p mean: -0.05537325143814087, mean p set: 0.44716131687164307
loss_pred:0.014243777841329575, decouple_loss:0.0017312736017629504
Iteration: 74, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44668179750442505, gen p mean: -0.0543879009783268, mean p set: 0.44716206192970276
The modified gen p mean: 0.4462679922580719, gen p mean: -0.05484189838171005, mean p set: 0.446748286485672
loss_pred:0.013765505515038967, decouple_loss:0.001593327266164124
loss_pred:0.013674633577466011, decouple_loss:0.0016006422229111195
The modified gen p mean: 0.44642341136932373, gen p mean: -0.04987325891852379, mean p set: 0.44690370559692383
loss_pred:0.013864192180335522, decouple_loss:0.0015245588729158044
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 75, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466102123260498, gen p mean: -0.05567095801234245, mean p set: 0.4470905363559723
loss_pred:0.013059791177511215, decouple_loss:0.0016473670257255435
The modified gen p mean: 0.4490334689617157, gen p mean: -0.05355837941169739, mean p set: 0.4495137631893158The modified gen p mean: 0.4465464651584625, gen p mean: -0.05488374084234238, mean p set: 0.4470267593860626
loss_pred:0.013602489605545998, decouple_loss:0.0017172313528135419
loss_pred:0.013587117195129395, decouple_loss:0.0015634712763130665
Iteration: 76, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469371438026428, gen p mean: -0.05493596941232681, mean p set: 0.44741740822792053
loss_pred:0.014020856469869614, decouple_loss:0.0014041742542758584
The modified gen p mean: 0.44644805788993835, gen p mean: -0.05972055345773697, mean p set: 0.44692835211753845The modified gen p mean: 0.44673678278923035, gen p mean: -0.050434429198503494, mean p set: 0.44721704721450806
loss_pred:0.013446950353682041, decouple_loss:0.001418456668034196
loss_pred:0.012963073328137398, decouple_loss:0.0014237683499231935
Iteration: 77, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477178752422333, gen p mean: -0.060178570449352264, mean p set: 0.4481981694698334
loss_pred:0.013798096217215061, decouple_loss:0.0015847355825826526
The modified gen p mean: 0.44710928201675415, gen p mean: -0.05928780138492584, mean p set: 0.44758957624435425The modified gen p mean: 0.44669926166534424, gen p mean: -0.05777714028954506, mean p set: 0.44717955589294434
loss_pred:0.012988508678972721, decouple_loss:0.001556273433379829
loss_pred:0.013403641991317272, decouple_loss:0.001524449442513287
Iteration: 78, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44632357358932495, gen p mean: -0.0564638115465641, mean p set: 0.44680383801460266
loss_pred:0.013387327082455158, decouple_loss:0.0014195297844707966
The modified gen p mean: 0.44660383462905884, gen p mean: -0.05966184660792351, mean p set: 0.44708412885665894The modified gen p mean: 0.44786348938941956, gen p mean: -0.056146103888750076, mean p set: 0.44834378361701965
loss_pred:0.012972289696335793, decouple_loss:0.0015047662891447544
loss_pred:0.012945633381605148, decouple_loss:0.0013662005076184869
Iteration: 79, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475288987159729, gen p mean: -0.0516023114323616, mean p set: 0.448009192943573
loss_pred:0.01386308018118143, decouple_loss:0.0015256283804774284
The modified gen p mean: 0.44783398509025574, gen p mean: -0.05583355948328972, mean p set: 0.44831427931785583
The modified gen p mean: 0.4485968351364136, gen p mean: -0.06028689444065094, mean p set: 0.44907715916633606
loss_pred:0.013191108591854572, decouple_loss:0.001537587959319353
loss_pred:0.013362755067646503, decouple_loss:0.0015072067035362124
Iteration: 80, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455787241458893, gen p mean: -0.058355703949928284, mean p set: 0.4460590183734894
loss_pred:0.012971041724085808, decouple_loss:0.0014511110493913293
The modified gen p mean: 0.44501030445098877, gen p mean: -0.06643842160701752, mean p set: 0.44549062848091125The modified gen p mean: 0.4481019079685211, gen p mean: -0.06269775331020355, mean p set: 0.44858217239379883
loss_pred:0.013039548881351948, decouple_loss:0.0013706504832953215
loss_pred:0.013155912049114704, decouple_loss:0.0013181413523852825
2023-04-30 03:59:58 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0627070888876915, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05728904530405998, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05779990553855896, mean p set: 0.4500633478164673
loss_pred:0.019548986107110977, decouple_loss:0.0015635829186066985
loss_pred:0.01852451264858246, decouple_loss:0.0015456939581781626
loss_pred:0.018547173589468002, decouple_loss:0.0015686382539570332
WV_0_PC_1_EH_0_PS_40, loss: 0.018951524049043655, avg_mse: 0.02759561687707901
current test mse: 0.027596
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
NaN value num: 0
Iteration: 81, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522389769554138, gen p mean: -0.05350396782159805, mean p set: 0.45271924138069153
loss_pred:0.020828694105148315, decouple_loss:0.0016245173756033182
The modified gen p mean: 0.4530556797981262, gen p mean: -0.05561555549502373, mean p set: 0.4535359740257263The modified gen p mean: 0.4497220814228058, gen p mean: -0.060470834374427795, mean p set: 0.4502023756504059
loss_pred:0.0211930051445961, decouple_loss:0.0016755801625549793
loss_pred:0.019693691283464432, decouple_loss:0.0015275198966264725
Iteration: 82, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513130187988281, gen p mean: -0.05460526421666145, mean p set: 0.4517933130264282
loss_pred:0.020385440438985825, decouple_loss:0.0015913277165964246
The modified gen p mean: 0.44985446333885193, gen p mean: -0.05600960925221443, mean p set: 0.450334757566452The modified gen p mean: 0.45236918330192566, gen p mean: -0.062046222388744354, mean p set: 0.45284944772720337
loss_pred:0.020867399871349335, decouple_loss:0.0016316869296133518
loss_pred:0.02041677199304104, decouple_loss:0.0017806452233344316
Iteration: 83, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520719647407532, gen p mean: -0.050686657428741455, mean p set: 0.45255225896835327
loss_pred:0.01910865306854248, decouple_loss:0.0015722435200586915
The modified gen p mean: 0.4524233043193817, gen p mean: -0.051962196826934814, mean p set: 0.4529035687446594The modified gen p mean: 0.4525023102760315, gen p mean: -0.05414013937115669, mean p set: 0.4529826045036316
loss_pred:0.02109784632921219, decouple_loss:0.0015671408036723733
loss_pred:0.02035333216190338, decouple_loss:0.0015617412282153964
Iteration: 84, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516293406486511, gen p mean: -0.051067352294921875, mean p set: 0.45210960507392883
loss_pred:0.019162507727742195, decouple_loss:0.0018822483252733946
The modified gen p mean: 0.45018839836120605, gen p mean: -0.054032258689403534, mean p set: 0.45066869258880615The modified gen p mean: 0.4515971541404724, gen p mean: -0.05442596226930618, mean p set: 0.4520774781703949
loss_pred:0.020770780742168427, decouple_loss:0.001871565356850624
loss_pred:0.020056147128343582, decouple_loss:0.001970244338735938
Iteration: 85, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513815939426422, gen p mean: -0.04612160101532936, mean p set: 0.4518618583679199
loss_pred:0.019551854580640793, decouple_loss:0.0016014069551602006
The modified gen p mean: 0.4523659944534302, gen p mean: -0.05192478001117706, mean p set: 0.45284631848335266The modified gen p mean: 0.45063936710357666, gen p mean: -0.05475901439785957, mean p set: 0.45111966133117676
loss_pred:0.02011736109852791, decouple_loss:0.001510691363364458
loss_pred:0.019592391327023506, decouple_loss:0.0014970264164730906
Iteration: 86, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45230579376220703, gen p mean: -0.04527244344353676, mean p set: 0.45278608798980713
loss_pred:0.02099071629345417, decouple_loss:0.0015274625038728118
The modified gen p mean: 0.45107221603393555, gen p mean: -0.05635371804237366, mean p set: 0.45155251026153564The modified gen p mean: 0.45062485337257385, gen p mean: -0.05382927879691124, mean p set: 0.4511050879955292
loss_pred:0.020079592242836952, decouple_loss:0.0014733466086909175
loss_pred:0.019860703498125076, decouple_loss:0.0015331062022596598
Iteration: 87, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45016443729400635, gen p mean: -0.04815009608864784, mean p set: 0.45064473152160645
loss_pred:0.02011985518038273, decouple_loss:0.0016108423005789518
The modified gen p mean: 0.45134252309799194, gen p mean: -0.04691753163933754, mean p set: 0.45182281732559204The modified gen p mean: 0.45240479707717896, gen p mean: -0.043677203357219696, mean p set: 0.45288509130477905
loss_pred:0.01888485625386238, decouple_loss:0.0016503379447385669
loss_pred:0.01949029043316841, decouple_loss:0.0016027380479499698
Iteration: 88, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503428041934967, gen p mean: -0.04625212773680687, mean p set: 0.4508230984210968
loss_pred:0.02012203447520733, decouple_loss:0.001739478437229991
The modified gen p mean: 0.4515398144721985, gen p mean: -0.043538134545087814, mean p set: 0.4520201086997986The modified gen p mean: 0.4530668556690216, gen p mean: -0.05248439311981201, mean p set: 0.4535471498966217
loss_pred:0.01907441020011902, decouple_loss:0.001640218310058117
loss_pred:0.019079377874732018, decouple_loss:0.0016617457149550319
Iteration: 89, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525221884250641, gen p mean: -0.0419328510761261, mean p set: 0.4530024528503418
loss_pred:0.01958843693137169, decouple_loss:0.0014536886010318995
The modified gen p mean: 0.45281991362571716, gen p mean: -0.04564713314175606, mean p set: 0.4533001780509949The modified gen p mean: 0.4526446461677551, gen p mean: -0.04410454258322716, mean p set: 0.4531249403953552
loss_pred:0.01955939456820488, decouple_loss:0.0014445050619542599
loss_pred:0.019626891240477562, decouple_loss:0.0014212167588993907
Iteration: 90, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45259809494018555, gen p mean: -0.05369705334305763, mean p set: 0.45307838916778564
loss_pred:0.018983352929353714, decouple_loss:0.0017885739216580987
The modified gen p mean: 0.44991931319236755, gen p mean: -0.04300734028220177, mean p set: 0.45039960741996765The modified gen p mean: 0.45154711604118347, gen p mean: -0.038323745131492615, mean p set: 0.45202744007110596
loss_pred:0.01992955431342125, decouple_loss:0.0017887273570522666
loss_pred:0.01941402442753315, decouple_loss:0.0017181957373395562
2023-04-30 04:02:48 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.050006087869405746, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04473188519477844, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04542694613337517, mean p set: 0.4500633478164673
loss_pred:0.018980927765369415, decouple_loss:0.0015282814856618643
loss_pred:0.017925404012203217, decouple_loss:0.0015484881587326527
loss_pred:0.017969615757465363, decouple_loss:0.0015470338985323906
WV_0_PC_1_EH_0_PS_40, loss: 0.018369046971201897, avg_mse: 0.02637549303472042
current test mse: 0.026375
Iteration: 91, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45225995779037476, gen p mean: -0.04450329765677452, mean p set: 0.45274025201797485
The modified gen p mean: 0.4527330696582794, gen p mean: -0.04667112976312637, mean p set: 0.45321333408355713
The modified gen p mean: 0.4519454538822174, gen p mean: -0.036985162645578384, mean p set: 0.4524257183074951
loss_pred:0.02021099627017975, decouple_loss:0.0014512267662212253
loss_pred:0.01958288624882698, decouple_loss:0.0014846451813355088
loss_pred:0.019356846809387207, decouple_loss:0.0014581800205633044
Iteration: 92, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511075019836426, gen p mean: -0.045193590223789215, mean p set: 0.45158782601356506
loss_pred:0.01926952414214611, decouple_loss:0.001474596094340086
The modified gen p mean: 0.4519249200820923, gen p mean: -0.05330300331115723, mean p set: 0.45240524411201477The modified gen p mean: 0.44984734058380127, gen p mean: -0.043471477925777435, mean p set: 0.45032763481140137
loss_pred:0.019067691639065742, decouple_loss:0.0014296300942078233
loss_pred:0.01961466297507286, decouple_loss:0.0015131487743929029
Iteration: 93, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45109429955482483, gen p mean: -0.048049185425043106, mean p set: 0.45157456398010254
The modified gen p mean: 0.45213136076927185, gen p mean: -0.0425737090408802, mean p set: 0.45261165499687195
loss_pred:0.019276609644293785, decouple_loss:0.0013298791600391269
loss_pred:0.01811322756111622, decouple_loss:0.0014188133645802736
The modified gen p mean: 0.45180806517601013, gen p mean: -0.04918573051691055, mean p set: 0.4522883892059326
loss_pred:0.018949167802929878, decouple_loss:0.001337365829385817
Iteration: 94, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45186764001846313, gen p mean: -0.052865203469991684, mean p set: 0.45234790444374084
The modified gen p mean: 0.4498354196548462, gen p mean: -0.04909731447696686, mean p set: 0.4503157436847687
loss_pred:0.019025519490242004, decouple_loss:0.0013448671670630574
loss_pred:0.018880782648921013, decouple_loss:0.0013709123013541102
The modified gen p mean: 0.45097616314888, gen p mean: -0.047155603766441345, mean p set: 0.4514564573764801
loss_pred:0.019121605902910233, decouple_loss:0.0014706705696880817
Iteration: 95, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45179077982902527, gen p mean: -0.05422630533576012, mean p set: 0.45227110385894775
loss_pred:0.01923741213977337, decouple_loss:0.0013067186810076237
The modified gen p mean: 0.451688677072525, gen p mean: -0.04746045917272568, mean p set: 0.4521689713001251The modified gen p mean: 0.4516649544239044, gen p mean: -0.049834560602903366, mean p set: 0.4521452486515045
loss_pred:0.019135521724820137, decouple_loss:0.0014396290061995387
loss_pred:0.01923501491546631, decouple_loss:0.0012963858898729086
Iteration: 96, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507010281085968, gen p mean: -0.053711626678705215, mean p set: 0.4511813521385193
loss_pred:0.018725011497735977, decouple_loss:0.001284387311898172
The modified gen p mean: 0.4530324935913086, gen p mean: -0.05054015293717384, mean p set: 0.4535127878189087The modified gen p mean: 0.4502890110015869, gen p mean: -0.055539220571517944, mean p set: 0.450769305229187
loss_pred:0.01960909180343151, decouple_loss:0.0014380017528310418
loss_pred:0.018689095973968506, decouple_loss:0.0013775891857221723
Iteration: 97, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45113012194633484, gen p mean: -0.058864764869213104, mean p set: 0.4516104459762573
loss_pred:0.019415201619267464, decouple_loss:0.0012407979229465127
The modified gen p mean: 0.45123711228370667, gen p mean: -0.05100468546152115, mean p set: 0.45171743631362915The modified gen p mean: 0.45037195086479187, gen p mean: -0.05723729729652405, mean p set: 0.4508522152900696
loss_pred:0.019248390570282936, decouple_loss:0.0011979033006355166
loss_pred:0.019082415848970413, decouple_loss:0.0012309547746554017
Iteration: 98, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519554674625397, gen p mean: -0.05329488590359688, mean p set: 0.45243576169013977
loss_pred:0.019421355798840523, decouple_loss:0.0013373459223657846
The modified gen p mean: 0.45221346616744995, gen p mean: -0.05113422870635986, mean p set: 0.45269373059272766The modified gen p mean: 0.4531138837337494, gen p mean: -0.05080466344952583, mean p set: 0.4535941779613495
loss_pred:0.01933186873793602, decouple_loss:0.0013250038027763367
loss_pred:0.019515251740813255, decouple_loss:0.0012991467956453562
Iteration: 99, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491223990917206, gen p mean: -0.052015479654073715, mean p set: 0.4496026933193207
loss_pred:0.019699715077877045, decouple_loss:0.0012709947768598795
The modified gen p mean: 0.45204871892929077, gen p mean: -0.050020549446344376, mean p set: 0.4525289833545685The modified gen p mean: 0.4527319073677063, gen p mean: -0.052278850227594376, mean p set: 0.453212171792984
loss_pred:0.019233761355280876, decouple_loss:0.0012649997370317578
loss_pred:0.019308919087052345, decouple_loss:0.0012796832015737891
Iteration: 100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498312473297119, gen p mean: -0.05677623301744461, mean p set: 0.4503115713596344
loss_pred:0.018513327464461327, decouple_loss:0.0013371423119679093
The modified gen p mean: 0.45337700843811035, gen p mean: -0.05070854723453522, mean p set: 0.45385733246803284The modified gen p mean: 0.45212918519973755, gen p mean: -0.052721474319696426, mean p set: 0.45260950922966003
loss_pred:0.01955234445631504, decouple_loss:0.0012925557093694806
loss_pred:0.01972333714365959, decouple_loss:0.0012325053103268147
2023-04-30 04:04:42 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05550011992454529, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.050412725657224655, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05094824358820915, mean p set: 0.4500633478164673
loss_pred:0.019138576462864876, decouple_loss:0.0012724651023745537
loss_pred:0.018053947016596794, decouple_loss:0.0012953549157828093
loss_pred:0.018031999468803406, decouple_loss:0.001294666901230812
WV_0_PC_1_EH_0_PS_40, loss: 0.018472548574209213, avg_mse: 0.026628807187080383
current test mse: 0.026629
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481750428676605, gen p mean: -0.055527567863464355, mean p set: 0.4486553370952606
loss_pred:0.015622240491211414, decouple_loss:0.0013181241229176521
The modified gen p mean: 0.4485883116722107, gen p mean: -0.05232609808444977, mean p set: 0.4490686058998108The modified gen p mean: 0.4484126567840576, gen p mean: -0.05428311601281166, mean p set: 0.4488929510116577
loss_pred:0.01650751382112503, decouple_loss:0.001305726240389049
loss_pred:0.015739858150482178, decouple_loss:0.001232912647537887
Iteration: 102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501950442790985, gen p mean: -0.04838902875781059, mean p set: 0.4506753385066986
loss_pred:0.016420481726527214, decouple_loss:0.001307598315179348
The modified gen p mean: 0.44793662428855896, gen p mean: -0.04359728470444679, mean p set: 0.44841691851615906The modified gen p mean: 0.4486697316169739, gen p mean: -0.055642206221818924, mean p set: 0.449150025844574
loss_pred:0.01533539593219757, decouple_loss:0.0013416401343420148
loss_pred:0.015971394255757332, decouple_loss:0.0013682651333510876
Iteration: 103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497270882129669, gen p mean: -0.042207010090351105, mean p set: 0.450207382440567
The modified gen p mean: 0.4485201835632324, gen p mean: -0.04370831698179245, mean p set: 0.44900044798851013
loss_pred:0.01567806303501129, decouple_loss:0.0014079557731747627
loss_pred:0.015599273145198822, decouple_loss:0.0013996176421642303
The modified gen p mean: 0.4489496946334839, gen p mean: -0.04133857041597366, mean p set: 0.449429988861084
loss_pred:0.016083430498838425, decouple_loss:0.001354982960037887
Iteration: 104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481617510318756, gen p mean: -0.037986110895872116, mean p set: 0.4486420452594757
The modified gen p mean: 0.44761672616004944, gen p mean: -0.03610086068511009, mean p set: 0.4480970501899719
loss_pred:0.015420904383063316, decouple_loss:0.0013733874075114727
loss_pred:0.014677489176392555, decouple_loss:0.0013216673396527767
The modified gen p mean: 0.4478321671485901, gen p mean: -0.036740563809871674, mean p set: 0.4483124613761902
loss_pred:0.014596989378333092, decouple_loss:0.001383948139846325
Iteration: 105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44971179962158203, gen p mean: -0.04041074961423874, mean p set: 0.45019209384918213
The modified gen p mean: 0.4481826722621918, gen p mean: -0.040435317903757095, mean p set: 0.44866296648979187
loss_pred:0.014915460720658302, decouple_loss:0.0014650060329586267
loss_pred:0.015041043050587177, decouple_loss:0.0014597304398193955
The modified gen p mean: 0.44835829734802246, gen p mean: -0.043967317789793015, mean p set: 0.44883859157562256
loss_pred:0.014368707314133644, decouple_loss:0.001358900568448007
Iteration: 106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477083086967468, gen p mean: -0.03421357274055481, mean p set: 0.4481886029243469
The modified gen p mean: 0.4494444727897644, gen p mean: -0.04009007662534714, mean p set: 0.4499247372150421
The modified gen p mean: 0.4492274522781372, gen p mean: -0.041680656373500824, mean p set: 0.4497077465057373
loss_pred:0.014689411036670208, decouple_loss:0.0014503758866339922
loss_pred:0.014353073202073574, decouple_loss:0.001496790093369782loss_pred:0.014810132794082165, decouple_loss:0.0014774472219869494
Iteration: 107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473377764225006, gen p mean: -0.04667509347200394, mean p set: 0.4478180706501007
The modified gen p mean: 0.44923079013824463, gen p mean: -0.036241233348846436, mean p set: 0.44971105456352234
loss_pred:0.014623974449932575, decouple_loss:0.0015138199087232351
loss_pred:0.014802226796746254, decouple_loss:0.0014521791599690914
The modified gen p mean: 0.44877612590789795, gen p mean: -0.0448249951004982, mean p set: 0.44925642013549805
loss_pred:0.01463303528726101, decouple_loss:0.0013923392398282886
Iteration: 108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476868510246277, gen p mean: -0.047148797661066055, mean p set: 0.4481671154499054
loss_pred:0.014013705775141716, decouple_loss:0.0018152929842472076
The modified gen p mean: 0.44944050908088684, gen p mean: -0.05157660320401192, mean p set: 0.44992080330848694The modified gen p mean: 0.44884926080703735, gen p mean: -0.05148282274603844, mean p set: 0.44932955503463745
loss_pred:0.014309834688901901, decouple_loss:0.0017549340846017003
loss_pred:0.01463481318205595, decouple_loss:0.0017269329400733113
Iteration: 109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448650598526001, gen p mean: -0.0566205196082592, mean p set: 0.44913092255592346
The modified gen p mean: 0.44882193207740784, gen p mean: -0.05329560115933418, mean p set: 0.44930222630500793
loss_pred:0.013976305723190308, decouple_loss:0.0016591944731771946
loss_pred:0.014292921870946884, decouple_loss:0.001707904739305377
The modified gen p mean: 0.44792136549949646, gen p mean: -0.05487018823623657, mean p set: 0.44840162992477417
loss_pred:0.013998589478433132, decouple_loss:0.0016289276536554098
Iteration: 110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485422968864441, gen p mean: -0.056042589247226715, mean p set: 0.4490225911140442
loss_pred:0.01398573536425829, decouple_loss:0.0017995513044297695
The modified gen p mean: 0.4491707384586334, gen p mean: -0.06318975985050201, mean p set: 0.4496510326862335The modified gen p mean: 0.44784510135650635, gen p mean: -0.05576075240969658, mean p set: 0.44832542538642883
loss_pred:0.01373529713600874, decouple_loss:0.0018324784468859434
loss_pred:0.013711621053516865, decouple_loss:0.0020247965585440397
2023-04-30 04:07:17 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.056952327489852905, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.051692280918359756, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830237865448, gen p mean: -0.052639275789260864, mean p set: 0.4500633478164673
loss_pred:0.019699987024068832, decouple_loss:0.001718225423246622
loss_pred:0.01858915574848652, decouple_loss:0.0016908185789361596
loss_pred:0.018591023981571198, decouple_loss:0.0016704673180356622
WV_0_PC_1_EH_0_PS_40, loss: 0.01904471591114998, avg_mse: 0.02751436084508896
current test mse: 0.027514
Iteration: 111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44782355427742004, gen p mean: -0.05312887951731682, mean p set: 0.44830384850502014
The modified gen p mean: 0.4484025537967682, gen p mean: -0.05172649770975113, mean p set: 0.4488828480243683
loss_pred:0.013677840121090412, decouple_loss:0.001700019696727395
The modified gen p mean: 0.4474453926086426, gen p mean: -0.061946649104356766, mean p set: 0.4479256868362427
loss_pred:0.013354707509279251, decouple_loss:0.00173845118843019
loss_pred:0.0135531947016716, decouple_loss:0.0017703212797641754
Iteration: 112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44895660877227783, gen p mean: -0.053322743624448776, mean p set: 0.44943690299987793
loss_pred:0.013215722516179085, decouple_loss:0.0021085788030177355
The modified gen p mean: 0.4480856657028198, gen p mean: -0.05239781364798546, mean p set: 0.4485659599304199The modified gen p mean: 0.44858604669570923, gen p mean: -0.05864166095852852, mean p set: 0.4490663409233093
loss_pred:0.01337476633489132, decouple_loss:0.002033354016020894
loss_pred:0.01341598853468895, decouple_loss:0.0020708516240119934
Iteration: 113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487597942352295, gen p mean: -0.054497066885232925, mean p set: 0.4492400586605072
loss_pred:0.014034225605428219, decouple_loss:0.002178394701331854
The modified gen p mean: 0.4491414725780487, gen p mean: -0.04859818518161774, mean p set: 0.4496217370033264The modified gen p mean: 0.44786936044692993, gen p mean: -0.052972208708524704, mean p set: 0.44834965467453003
loss_pred:0.01356023270636797, decouple_loss:0.002214382402598858
loss_pred:0.013571705669164658, decouple_loss:0.002209937199950218
Iteration: 114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44897907972335815, gen p mean: -0.0534137561917305, mean p set: 0.44945937395095825
The modified gen p mean: 0.4471559524536133, gen p mean: -0.05408712849020958, mean p set: 0.4476362466812134
loss_pred:0.012951196171343327, decouple_loss:0.0019998576026409864
loss_pred:0.013649322092533112, decouple_loss:0.0019234877545386553The modified gen p mean: 0.4479890763759613, gen p mean: -0.05693105608224869, mean p set: 0.448469340801239
loss_pred:0.013129960745573044, decouple_loss:0.001960426103323698
Iteration: 115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474776089191437, gen p mean: -0.05414402112364769, mean p set: 0.4479579031467438
loss_pred:0.013317576609551907, decouple_loss:0.0019439070019870996
The modified gen p mean: 0.44868406653404236, gen p mean: -0.04740366339683533, mean p set: 0.44916436076164246The modified gen p mean: 0.44857487082481384, gen p mean: -0.04486705735325813, mean p set: 0.44905519485473633
loss_pred:0.013033188879489899, decouple_loss:0.0019001379841938615
loss_pred:0.013183658942580223, decouple_loss:0.0018378908280283213
Iteration: 116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484231472015381, gen p mean: -0.045534923672676086, mean p set: 0.4489034116268158
The modified gen p mean: 0.44808343052864075, gen p mean: -0.045325424522161484, mean p set: 0.44856372475624084loss_pred:0.01315261609852314, decouple_loss:0.0016329273348674178
The modified gen p mean: 0.4479454457759857, gen p mean: -0.05049257352948189, mean p set: 0.4484257698059082
loss_pred:0.013321712613105774, decouple_loss:0.0016108877025544643
loss_pred:0.013202499598264694, decouple_loss:0.0016840229509398341
Iteration: 117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476096034049988, gen p mean: -0.04193151369690895, mean p set: 0.4480898678302765
The modified gen p mean: 0.44881999492645264, gen p mean: -0.04480636864900589, mean p set: 0.44930025935173035
loss_pred:0.013197965919971466, decouple_loss:0.002121487632393837
loss_pred:0.013015556149184704, decouple_loss:0.0018780265236273408
The modified gen p mean: 0.44849711656570435, gen p mean: -0.04161470755934715, mean p set: 0.44897738099098206
loss_pred:0.01313228253275156, decouple_loss:0.0020498461090028286
Iteration: 118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488055408000946, gen p mean: -0.04256273806095123, mean p set: 0.4492858350276947
The modified gen p mean: 0.4480079710483551, gen p mean: -0.04068564623594284, mean p set: 0.4484882652759552
The modified gen p mean: 0.44840681552886963, gen p mean: -0.04286948963999748, mean p set: 0.4488871097564697
loss_pred:0.012990595772862434, decouple_loss:0.00164405582472682
loss_pred:0.013190746307373047, decouple_loss:0.0016417268197983503loss_pred:0.013030650094151497, decouple_loss:0.0016168025322258472
Iteration: 119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483506977558136, gen p mean: -0.04127120226621628, mean p set: 0.4488309919834137
loss_pred:0.013429582118988037, decouple_loss:0.001610392821021378
The modified gen p mean: 0.44917911291122437, gen p mean: -0.0405142642557621, mean p set: 0.44965940713882446The modified gen p mean: 0.4487152099609375, gen p mean: -0.03406555578112602, mean p set: 0.44919553399086
loss_pred:0.012896664440631866, decouple_loss:0.0017295613652095199
loss_pred:0.013506240211427212, decouple_loss:0.0016778265126049519
Iteration: 120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487764537334442, gen p mean: -0.04006524756550789, mean p set: 0.4492567181587219
The modified gen p mean: 0.44945159554481506, gen p mean: -0.04126206412911415, mean p set: 0.44993188977241516
loss_pred:0.013083210214972496, decouple_loss:0.0015249560819938779
loss_pred:0.012909088283777237, decouple_loss:0.0015601776540279388
The modified gen p mean: 0.4499695599079132, gen p mean: -0.04407379776239395, mean p set: 0.4504498541355133
loss_pred:0.013237967155873775, decouple_loss:0.0014410704607143998
2023-04-30 04:09:11 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04544979706406593, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04130983352661133, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04188065230846405, mean p set: 0.4500633478164673
loss_pred:0.019694989547133446, decouple_loss:0.0016385541530326009
loss_pred:0.01854458823800087, decouple_loss:0.0015808885218575597
loss_pred:0.018563266843557358, decouple_loss:0.0016861694166436791
WV_0_PC_1_EH_0_PS_40, loss: 0.019016042351722717, avg_mse: 0.027718044817447662
current test mse: 0.027718
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473407566547394, gen p mean: -0.0422065295279026, mean p set: 0.4478210508823395
loss_pred:0.013631938025355339, decouple_loss:0.001576214679516852
The modified gen p mean: 0.44829726219177246, gen p mean: -0.0432915985584259, mean p set: 0.44877755641937256The modified gen p mean: 0.4482654631137848, gen p mean: -0.0427931509912014, mean p set: 0.4487457573413849
loss_pred:0.01370631530880928, decouple_loss:0.0015355831710621715loss_pred:0.013610580936074257, decouple_loss:0.001567545346915722
Iteration: 122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44873046875, gen p mean: -0.04097544774413109, mean p set: 0.4492107927799225
loss_pred:0.013818779028952122, decouple_loss:0.0014935623621568084
The modified gen p mean: 0.4477446377277374, gen p mean: -0.04570290818810463, mean p set: 0.4482249617576599The modified gen p mean: 0.4489087164402008, gen p mean: -0.04237140715122223, mean p set: 0.4493890404701233
loss_pred:0.013715920969843864, decouple_loss:0.0015186949167400599
loss_pred:0.013082689605653286, decouple_loss:0.001457643578760326
Iteration: 123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822147488594055, gen p mean: -0.04167342931032181, mean p set: 0.44870179891586304
loss_pred:0.013299289159476757, decouple_loss:0.0016413258854299784
The modified gen p mean: 0.4475277066230774, gen p mean: -0.04740116372704506, mean p set: 0.4480080008506775The modified gen p mean: 0.4477505385875702, gen p mean: -0.04521466791629791, mean p set: 0.4482308626174927
loss_pred:0.013430409133434296, decouple_loss:0.0016377242282032967
loss_pred:0.013463105075061321, decouple_loss:0.0017658654833212495
Iteration: 124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44766926765441895, gen p mean: -0.04435114562511444, mean p set: 0.44814959168434143
loss_pred:0.012967009097337723, decouple_loss:0.0013868488604202867
The modified gen p mean: 0.44833844900131226, gen p mean: -0.04194863885641098, mean p set: 0.4488186836242676The modified gen p mean: 0.447806179523468, gen p mean: -0.04493423178792, mean p set: 0.4482864737510681
loss_pred:0.013404997996985912, decouple_loss:0.0015277167549356818
loss_pred:0.013143064454197884, decouple_loss:0.0014416524209082127
Iteration: 125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474487006664276, gen p mean: -0.04904145747423172, mean p set: 0.4479289650917053
loss_pred:0.013337443582713604, decouple_loss:0.0016485715750604868
The modified gen p mean: 0.44744864106178284, gen p mean: -0.04756603762507439, mean p set: 0.44792893528938293The modified gen p mean: 0.44761139154434204, gen p mean: -0.048113781958818436, mean p set: 0.4480917155742645
loss_pred:0.013509951531887054, decouple_loss:0.0015692816814407706
loss_pred:0.013594952411949635, decouple_loss:0.0016793080139905214
Iteration: 126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723832607269287, gen p mean: -0.04859670624136925, mean p set: 0.44771865010261536
loss_pred:0.012938596308231354, decouple_loss:0.0013894682051613927
The modified gen p mean: 0.4477365016937256, gen p mean: -0.0463467575609684, mean p set: 0.44821682572364807The modified gen p mean: 0.4478815495967865, gen p mean: -0.0392727367579937, mean p set: 0.4483618438243866
loss_pred:0.013090219348669052, decouple_loss:0.0013135839253664017
loss_pred:0.013472875580191612, decouple_loss:0.0013096408220008016
Iteration: 127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44612351059913635, gen p mean: -0.043822456151247025, mean p set: 0.44660380482673645
loss_pred:0.013427045196294785, decouple_loss:0.001518133212812245
The modified gen p mean: 0.4480758309364319, gen p mean: -0.04506181553006172, mean p set: 0.44855615496635437The modified gen p mean: 0.4475630223751068, gen p mean: -0.048133864998817444, mean p set: 0.4480433166027069
loss_pred:0.01313843484967947, decouple_loss:0.001532520866021514
loss_pred:0.012863365933299065, decouple_loss:0.0015682365046814084
Iteration: 128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481663703918457, gen p mean: -0.04090861231088638, mean p set: 0.4486466944217682
The modified gen p mean: 0.4476584792137146, gen p mean: -0.04945981130003929, mean p set: 0.4481387734413147
loss_pred:0.013177121058106422, decouple_loss:0.0014160508289933205
loss_pred:0.012986347079277039, decouple_loss:0.001518912729807198
The modified gen p mean: 0.44783878326416016, gen p mean: -0.048707738518714905, mean p set: 0.44831904768943787
loss_pred:0.013135626912117004, decouple_loss:0.0014999484410509467
Iteration: 129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44683799147605896, gen p mean: -0.04086553305387497, mean p set: 0.44731831550598145
loss_pred:0.013273532502353191, decouple_loss:0.0016089710406959057
The modified gen p mean: 0.4473441243171692, gen p mean: -0.04628019407391548, mean p set: 0.4478244483470917The modified gen p mean: 0.44737324118614197, gen p mean: -0.04592343419790268, mean p set: 0.44785353541374207
loss_pred:0.012977399863302708, decouple_loss:0.0014645595801994205
loss_pred:0.013107397593557835, decouple_loss:0.0015306267887353897
Iteration: 130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477596580982208, gen p mean: -0.04579012840986252, mean p set: 0.4482399523258209
The modified gen p mean: 0.44754457473754883, gen p mean: -0.04267654940485954, mean p set: 0.4480248689651489
loss_pred:0.013311659917235374, decouple_loss:0.001270670210942626
loss_pred:0.012660632841289043, decouple_loss:0.0013281818246468902
The modified gen p mean: 0.4471362233161926, gen p mean: -0.047392286360263824, mean p set: 0.44761648774147034
loss_pred:0.012841081246733665, decouple_loss:0.0014577882830053568
2023-04-30 04:12:05 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04497366026043892, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04128153622150421, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04180976375937462, mean p set: 0.4500633478164673
loss_pred:0.01963876746594906, decouple_loss:0.0014899062225595117
loss_pred:0.018477434292435646, decouple_loss:0.0014725826913490891
loss_pred:0.018581658601760864, decouple_loss:0.0014051052276045084
WV_0_PC_1_EH_0_PS_40, loss: 0.018972080200910568, avg_mse: 0.027744043618440628
current test mse: 0.027744
Iteration: 131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472672641277313, gen p mean: -0.04226319491863251, mean p set: 0.4477475583553314
The modified gen p mean: 0.44831040501594543, gen p mean: -0.04408346861600876, mean p set: 0.44879069924354553
The modified gen p mean: 0.44838187098503113, gen p mean: -0.041337594389915466, mean p set: 0.4488621652126312
loss_pred:0.01280052401125431, decouple_loss:0.0013602356193587184
loss_pred:0.012886111624538898, decouple_loss:0.0014496318763121963loss_pred:0.013507838360965252, decouple_loss:0.001434348989278078
Iteration: 132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490087032318115, gen p mean: -0.04269096627831459, mean p set: 0.4494889974594116
loss_pred:0.012884349562227726, decouple_loss:0.0012049118522554636
The modified gen p mean: 0.44771137833595276, gen p mean: -0.042741063982248306, mean p set: 0.44819164276123047The modified gen p mean: 0.4472610652446747, gen p mean: -0.0437941774725914, mean p set: 0.4477413594722748
loss_pred:0.012562667950987816, decouple_loss:0.0013125151162967086
loss_pred:0.013004067353904247, decouple_loss:0.0012833616929128766
Iteration: 133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780266284942627, gen p mean: -0.04954036697745323, mean p set: 0.44828295707702637
loss_pred:0.013007249683141708, decouple_loss:0.0012970803072676063
The modified gen p mean: 0.44712862372398376, gen p mean: -0.03922814875841141, mean p set: 0.44760891795158386The modified gen p mean: 0.4488472044467926, gen p mean: -0.04336521774530411, mean p set: 0.4493274986743927
loss_pred:0.013005051761865616, decouple_loss:0.0013062921352684498
loss_pred:0.013231470249593258, decouple_loss:0.0014114801306277514
Iteration: 134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694724678993225, gen p mean: -0.0476374477148056, mean p set: 0.44742754101753235
loss_pred:0.012448698282241821, decouple_loss:0.0013346896739676595
The modified gen p mean: 0.447384238243103, gen p mean: -0.04934873804450035, mean p set: 0.4478645324707031The modified gen p mean: 0.4482875466346741, gen p mean: -0.04386039823293686, mean p set: 0.4487678110599518
loss_pred:0.012585634365677834, decouple_loss:0.0013097726041451097
loss_pred:0.012651265598833561, decouple_loss:0.0012237816117703915
Iteration: 135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44617268443107605, gen p mean: -0.042083486914634705, mean p set: 0.44665300846099854
loss_pred:0.013021447695791721, decouple_loss:0.0012532748514786363
The modified gen p mean: 0.4472653269767761, gen p mean: -0.04433372989296913, mean p set: 0.4477456510066986
The modified gen p mean: 0.4465808570384979, gen p mean: -0.04255673661828041, mean p set: 0.44706112146377563
loss_pred:0.013131553307175636, decouple_loss:0.0013085647951811552
loss_pred:0.013038448058068752, decouple_loss:0.0013034139992669225
Iteration: 136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474266767501831, gen p mean: -0.04661447927355766, mean p set: 0.4479069411754608
loss_pred:0.012937051244080067, decouple_loss:0.001158497529104352
The modified gen p mean: 0.44798049330711365, gen p mean: -0.04750105366110802, mean p set: 0.44846081733703613The modified gen p mean: 0.44775915145874023, gen p mean: -0.04653574526309967, mean p set: 0.44823944568634033
loss_pred:0.013127109035849571, decouple_loss:0.0011868575820699334
loss_pred:0.012622126378118992, decouple_loss:0.0013147580903023481
Iteration: 137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475400745868683, gen p mean: -0.04565373808145523, mean p set: 0.44802039861679077
loss_pred:0.01242466177791357, decouple_loss:0.0013009354006499052
The modified gen p mean: 0.44706377387046814, gen p mean: -0.04882971569895744, mean p set: 0.44754406809806824
The modified gen p mean: 0.44696977734565735, gen p mean: -0.04823153465986252, mean p set: 0.44745007157325745
loss_pred:0.012577403336763382, decouple_loss:0.001329133752733469
loss_pred:0.01278332807123661, decouple_loss:0.001366624142974615
Iteration: 138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478708803653717, gen p mean: -0.04486599192023277, mean p set: 0.4483511745929718
loss_pred:0.012765594758093357, decouple_loss:0.001096866326406598
The modified gen p mean: 0.4477286636829376, gen p mean: -0.04648173600435257, mean p set: 0.4482089579105377The modified gen p mean: 0.44722220301628113, gen p mean: -0.046343881636857986, mean p set: 0.44770246744155884
loss_pred:0.012998159043490887, decouple_loss:0.0010735405376181006
loss_pred:0.012543126940727234, decouple_loss:0.0011218998115509748
Iteration: 139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856175780296326, gen p mean: -0.04712824895977974, mean p set: 0.44904205203056335
loss_pred:0.012570682913064957, decouple_loss:0.0012883221497759223
The modified gen p mean: 0.44758838415145874, gen p mean: -0.04889962449669838, mean p set: 0.44806867837905884
The modified gen p mean: 0.4471328556537628, gen p mean: -0.05101446807384491, mean p set: 0.4476131498813629
loss_pred:0.012705426663160324, decouple_loss:0.0012787702726200223
loss_pred:0.012273404747247696, decouple_loss:0.0012638319749385118
Iteration: 140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669976830482483, gen p mean: -0.04996415227651596, mean p set: 0.4471800923347473
The modified gen p mean: 0.4468141198158264, gen p mean: -0.050096772611141205, mean p set: 0.4472944438457489
loss_pred:0.01294632162898779, decouple_loss:0.0010759260039776564
loss_pred:0.012926322408020496, decouple_loss:0.0011356937466189265
The modified gen p mean: 0.4473603069782257, gen p mean: -0.05091742426156998, mean p set: 0.4478406012058258
loss_pred:0.013251991011202335, decouple_loss:0.0010713543742895126
2023-04-30 04:13:59 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.051396433264017105, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.047886162996292114, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04847051575779915, mean p set: 0.4500633478164673
loss_pred:0.019503310322761536, decouple_loss:0.0012708751019090414
loss_pred:0.01840316131711006, decouple_loss:0.00132635363843292
loss_pred:0.018507858738303185, decouple_loss:0.001322878641076386
WV_0_PC_1_EH_0_PS_40, loss: 0.01887011155486107, avg_mse: 0.027611056342720985
current test mse: 0.027611
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
NaN value num: 0
Iteration: 141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44838863611221313, gen p mean: -0.04382361099123955, mean p set: 0.44886893033981323
loss_pred:0.019754264503717422, decouple_loss:0.0015849388437345624
The modified gen p mean: 0.45012202858924866, gen p mean: -0.048756085336208344, mean p set: 0.45060229301452637The modified gen p mean: 0.4500276744365692, gen p mean: -0.0461120679974556, mean p set: 0.4505079984664917
loss_pred:0.0197637677192688, decouple_loss:0.0015985200880095363
loss_pred:0.019441548734903336, decouple_loss:0.001454880810342729
Iteration: 142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448612242937088, gen p mean: -0.042936887592077255, mean p set: 0.4490925371646881
The modified gen p mean: 0.44774141907691956, gen p mean: -0.03463415428996086, mean p set: 0.44822174310684204
loss_pred:0.01869792304933071, decouple_loss:0.0013345017796382308
loss_pred:0.019901001825928688, decouple_loss:0.0012867910554632545
The modified gen p mean: 0.44859281182289124, gen p mean: -0.03934403136372566, mean p set: 0.44907310605049133
loss_pred:0.019165197387337685, decouple_loss:0.0012997050071135163
Iteration: 143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497023820877075, gen p mean: -0.03667367994785309, mean p set: 0.4501826763153076
loss_pred:0.017947131767868996, decouple_loss:0.0013914898736402392
The modified gen p mean: 0.4477819502353668, gen p mean: -0.03698538988828659, mean p set: 0.44826221466064453The modified gen p mean: 0.449121356010437, gen p mean: -0.04078929126262665, mean p set: 0.4496016502380371
loss_pred:0.01957482285797596, decouple_loss:0.001613415195606649
loss_pred:0.019827544689178467, decouple_loss:0.001410644268617034
Iteration: 144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489588439464569, gen p mean: -0.042670637369155884, mean p set: 0.449439138174057
loss_pred:0.01877211220562458, decouple_loss:0.00122980703599751
The modified gen p mean: 0.44791412353515625, gen p mean: -0.04217473417520523, mean p set: 0.44839444756507874The modified gen p mean: 0.44734182953834534, gen p mean: -0.04103345796465874, mean p set: 0.44782212376594543
loss_pred:0.017960630357265472, decouple_loss:0.0012871203944087029
loss_pred:0.0189646165817976, decouple_loss:0.0012283285614103079
Iteration: 145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503135085105896, gen p mean: -0.0420515201985836, mean p set: 0.4507937431335449
loss_pred:0.018136266618967056, decouple_loss:0.0014033819315955043
The modified gen p mean: 0.4501386284828186, gen p mean: -0.041475288569927216, mean p set: 0.4506188929080963The modified gen p mean: 0.4484219253063202, gen p mean: -0.03836749866604805, mean p set: 0.4489021897315979
loss_pred:0.01867428794503212, decouple_loss:0.0013288978952914476
loss_pred:0.017999008297920227, decouple_loss:0.0012896994594484568
Iteration: 146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485941231250763, gen p mean: -0.046354226768016815, mean p set: 0.4490744471549988
The modified gen p mean: 0.44850990176200867, gen p mean: -0.04708220809698105, mean p set: 0.44899022579193115
loss_pred:0.01857641525566578, decouple_loss:0.0012562498450279236
loss_pred:0.018305134028196335, decouple_loss:0.0013200779212638736
The modified gen p mean: 0.4505457878112793, gen p mean: -0.043173648416996, mean p set: 0.4510261118412018
loss_pred:0.017987489700317383, decouple_loss:0.0013084207894280553
Iteration: 147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474698603153229, gen p mean: -0.04021482169628143, mean p set: 0.447950154542923
loss_pred:0.018073709681630135, decouple_loss:0.0014646934578195214
The modified gen p mean: 0.44740962982177734, gen p mean: -0.0434841550886631, mean p set: 0.44788995385169983The modified gen p mean: 0.44817742705345154, gen p mean: -0.039021287113428116, mean p set: 0.44865772128105164
loss_pred:0.017558414489030838, decouple_loss:0.001404370879754424
loss_pred:0.01825721748173237, decouple_loss:0.0014080266701057553
Iteration: 148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507506787776947, gen p mean: -0.039271946996450424, mean p set: 0.4512310028076172
loss_pred:0.017267141491174698, decouple_loss:0.0012499294243752956
The modified gen p mean: 0.4506208598613739, gen p mean: -0.03582627326250076, mean p set: 0.4511011838912964The modified gen p mean: 0.448388010263443, gen p mean: -0.036038607358932495, mean p set: 0.4488682746887207
loss_pred:0.017690537497401237, decouple_loss:0.0012385488953441381
loss_pred:0.018402716144919395, decouple_loss:0.0013624023413285613
Iteration: 149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447441041469574, gen p mean: -0.039680685847997665, mean p set: 0.4479213356971741
The modified gen p mean: 0.4506320655345917, gen p mean: -0.03182757645845413, mean p set: 0.45111238956451416
loss_pred:0.017564989626407623, decouple_loss:0.00152484024874866
The modified gen p mean: 0.4478376805782318, gen p mean: -0.04109139367938042, mean p set: 0.4483179748058319
loss_pred:0.01920328661799431, decouple_loss:0.0015221104258671403
loss_pred:0.018456479534506798, decouple_loss:0.0015085925115272403
Iteration: 150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478347897529602, gen p mean: -0.03814711421728134, mean p set: 0.4483151137828827
loss_pred:0.0181768499314785, decouple_loss:0.0016388316871598363
The modified gen p mean: 0.4500086307525635, gen p mean: -0.03737685829401016, mean p set: 0.4504888951778412The modified gen p mean: 0.450177401304245, gen p mean: -0.039982400834560394, mean p set: 0.4506576955318451
loss_pred:0.017489057034254074, decouple_loss:0.0016290792264044285
loss_pred:0.018058471381664276, decouple_loss:0.0016729882918298244
2023-04-30 04:16:30 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04899430274963379, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987669587135315, gen p mean: -0.04438871890306473, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.045391082763671875, mean p set: 0.4500633478164673
loss_pred:0.018833180889487267, decouple_loss:0.0014623175375163555
loss_pred:0.01776386983692646, decouple_loss:0.0013498639455065131
loss_pred:0.017780287191271782, decouple_loss:0.0013969115680083632
WV_0_PC_1_EH_0_PS_40, loss: 0.018195930868387222, avg_mse: 0.02613469958305359
current test mse: 0.026135
At step 150, Best test: 0.026135
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_model_test_schedule_sampling_DynaMean.ckpt
Iteration: 151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45023879408836365, gen p mean: -0.04293530434370041, mean p set: 0.45071908831596375
loss_pred:0.01874605379998684, decouple_loss:0.0015097272116690874
The modified gen p mean: 0.45007216930389404, gen p mean: -0.042977746576070786, mean p set: 0.45055249333381653The modified gen p mean: 0.4498419165611267, gen p mean: -0.04073216766119003, mean p set: 0.4503222107887268
loss_pred:0.017670515924692154, decouple_loss:0.001356321619823575
loss_pred:0.018674232065677643, decouple_loss:0.0013832546537742019
Iteration: 152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498848617076874, gen p mean: -0.04077543318271637, mean p set: 0.4503651261329651
loss_pred:0.018371013924479485, decouple_loss:0.0014221047749742866
The modified gen p mean: 0.44942229986190796, gen p mean: -0.04132426157593727, mean p set: 0.44990259408950806The modified gen p mean: 0.45010942220687866, gen p mean: -0.037984348833560944, mean p set: 0.45058971643447876
loss_pred:0.01803778111934662, decouple_loss:0.001511924434453249
loss_pred:0.017534559592604637, decouple_loss:0.0014462058898061514
Iteration: 153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502868950366974, gen p mean: -0.031958144158124924, mean p set: 0.4507671892642975
The modified gen p mean: 0.4477876126766205, gen p mean: -0.037183936685323715, mean p set: 0.4482679069042206
loss_pred:0.018299907445907593, decouple_loss:0.0013146452838554978
loss_pred:0.017971742898225784, decouple_loss:0.0013090138090774417
The modified gen p mean: 0.44833797216415405, gen p mean: -0.032546818256378174, mean p set: 0.44881829619407654
loss_pred:0.01848527044057846, decouple_loss:0.0013405103236436844
Iteration: 154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44726622104644775, gen p mean: -0.0337953083217144, mean p set: 0.44774648547172546
The modified gen p mean: 0.44747990369796753, gen p mean: -0.03532715141773224, mean p set: 0.4479601979255676
loss_pred:0.01708119548857212, decouple_loss:0.0013466725358739495
loss_pred:0.016984358429908752, decouple_loss:0.0013775879051536322
The modified gen p mean: 0.4481814205646515, gen p mean: -0.03193928301334381, mean p set: 0.4486616849899292
loss_pred:0.019055726006627083, decouple_loss:0.0013599396916106343
Iteration: 155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481179416179657, gen p mean: -0.025633620098233223, mean p set: 0.4485982656478882
loss_pred:0.019058799371123314, decouple_loss:0.0012504305923357606
The modified gen p mean: 0.4484798312187195, gen p mean: -0.025006389245390892, mean p set: 0.44896015524864197The modified gen p mean: 0.45067405700683594, gen p mean: -0.025416623800992966, mean p set: 0.45115435123443604
loss_pred:0.018908193334937096, decouple_loss:0.001253685331903398
loss_pred:0.01872093975543976, decouple_loss:0.0012755227508023381
Iteration: 156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471459686756134, gen p mean: -0.03313365578651428, mean p set: 0.4476262331008911
loss_pred:0.016775943338871002, decouple_loss:0.001277485745958984
The modified gen p mean: 0.4497668147087097, gen p mean: -0.026889367029070854, mean p set: 0.4502470791339874The modified gen p mean: 0.4473850131034851, gen p mean: -0.025724194943904877, mean p set: 0.4478653073310852
loss_pred:0.018488610163331032, decouple_loss:0.0012491258094087243
loss_pred:0.018739361315965652, decouple_loss:0.001228490611538291
Iteration: 157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481842517852783, gen p mean: -0.0350937582552433, mean p set: 0.44866451621055603
loss_pred:0.01755763776600361, decouple_loss:0.0012613150756806135
The modified gen p mean: 0.44900304079055786, gen p mean: -0.03192637860774994, mean p set: 0.44948336482048035
The modified gen p mean: 0.44965460896492004, gen p mean: -0.028794776648283005, mean p set: 0.45013487339019775
loss_pred:0.01886741816997528, decouple_loss:0.001207507448270917
loss_pred:0.018365727737545967, decouple_loss:0.0013256627134978771
Iteration: 158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502808153629303, gen p mean: -0.0345977246761322, mean p set: 0.4507611393928528
The modified gen p mean: 0.45001155138015747, gen p mean: -0.039611831307411194, mean p set: 0.45049184560775757
loss_pred:0.0182848758995533, decouple_loss:0.00127286440692842
loss_pred:0.018580932170152664, decouple_loss:0.0011347117833793163
The modified gen p mean: 0.45033779740333557, gen p mean: -0.034084297716617584, mean p set: 0.45081809163093567
loss_pred:0.017629850655794144, decouple_loss:0.0012817647075280547
Iteration: 159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839757680892944, gen p mean: -0.03706502914428711, mean p set: 0.44887787103652954
loss_pred:0.018641304224729538, decouple_loss:0.0011841561645269394
The modified gen p mean: 0.44968754053115845, gen p mean: -0.03251280635595322, mean p set: 0.45016783475875854The modified gen p mean: 0.45040223002433777, gen p mean: -0.03575051948428154, mean p set: 0.45088252425193787
loss_pred:0.01729673333466053, decouple_loss:0.0012045938055962324
loss_pred:0.017846470698714256, decouple_loss:0.001225320971570909
Iteration: 160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752296805381775, gen p mean: -0.040542248636484146, mean p set: 0.44800323247909546
loss_pred:0.018003106117248535, decouple_loss:0.0012031369842588902
The modified gen p mean: 0.44985494017601013, gen p mean: -0.03414588049054146, mean p set: 0.45033523440361023The modified gen p mean: 0.4498942792415619, gen p mean: -0.038318343460559845, mean p set: 0.4503746032714844
loss_pred:0.01820455677807331, decouple_loss:0.0011981767602264881
loss_pred:0.018050719052553177, decouple_loss:0.0011679508024826646
2023-04-30 04:18:29 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04858691990375519, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04368430748581886, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04458186402916908, mean p set: 0.4500633478164673
loss_pred:0.01861712895333767, decouple_loss:0.0013412712141871452
loss_pred:0.017523296177387238, decouple_loss:0.0012141588376834989
loss_pred:0.01766253635287285, decouple_loss:0.0012254389002919197
WV_0_PC_1_EH_0_PS_40, loss: 0.017997335642576218, avg_mse: 0.025804946199059486
current test mse: 0.025805
At step 160, Best test: 0.025805
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
NaN value num: 0
Iteration: 161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45251452922821045, gen p mean: -0.04482468590140343, mean p set: 0.45299485325813293
loss_pred:0.018094323575496674, decouple_loss:0.00124979333486408
The modified gen p mean: 0.45041948556900024, gen p mean: -0.04401564970612526, mean p set: 0.45089974999427795The modified gen p mean: 0.4495936632156372, gen p mean: -0.04062116891145706, mean p set: 0.4500739574432373
loss_pred:0.017659490928053856, decouple_loss:0.0012238905765116215
loss_pred:0.01789030060172081, decouple_loss:0.0012416938552632928
Iteration: 162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45049503445625305, gen p mean: -0.04448695108294487, mean p set: 0.45097532868385315
The modified gen p mean: 0.45071595907211304, gen p mean: -0.050957515835762024, mean p set: 0.45119625329971313
loss_pred:0.017895424738526344, decouple_loss:0.001149274641647935
loss_pred:0.018809715285897255, decouple_loss:0.0012434135423973203
The modified gen p mean: 0.4483598470687866, gen p mean: -0.0480625294148922, mean p set: 0.4488401710987091
loss_pred:0.01818196102976799, decouple_loss:0.0011741872876882553
Iteration: 163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493951201438904, gen p mean: -0.04297909885644913, mean p set: 0.4498754143714905
The modified gen p mean: 0.4499675929546356, gen p mean: -0.04596371576189995, mean p set: 0.4504478871822357
loss_pred:0.018786638975143433, decouple_loss:0.0012527811340987682
loss_pred:0.01877729780972004, decouple_loss:0.001257991068996489
The modified gen p mean: 0.4500119090080261, gen p mean: -0.044238582253456116, mean p set: 0.4504922032356262
loss_pred:0.018128113821148872, decouple_loss:0.0011952529894188046
Iteration: 164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506535530090332, gen p mean: -0.044486235827207565, mean p set: 0.4511338472366333
The modified gen p mean: 0.45197778940200806, gen p mean: -0.04665425419807434, mean p set: 0.45245808362960815
loss_pred:0.017678676173090935, decouple_loss:0.0011712516425177455
loss_pred:0.016906289383769035, decouple_loss:0.0012902711750939488
The modified gen p mean: 0.450252503156662, gen p mean: -0.04457199573516846, mean p set: 0.4507328271865845
loss_pred:0.01775968074798584, decouple_loss:0.0012244838289916515
Iteration: 165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490398168563843, gen p mean: -0.04622757434844971, mean p set: 0.4495201110839844
loss_pred:0.01794721931219101, decouple_loss:0.0011672978289425373
The modified gen p mean: 0.4503566026687622, gen p mean: -0.0441955141723156, mean p set: 0.4508368670940399The modified gen p mean: 0.45196977257728577, gen p mean: -0.04676925390958786, mean p set: 0.45245006680488586
loss_pred:0.017285289242863655, decouple_loss:0.001167664653621614
loss_pred:0.01738799549639225, decouple_loss:0.0011641134042292833
Iteration: 166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527561664581299, gen p mean: -0.044220518320798874, mean p set: 0.45323646068573
loss_pred:0.016819657757878304, decouple_loss:0.001133248209953308
The modified gen p mean: 0.449357271194458, gen p mean: -0.04742039740085602, mean p set: 0.4498375654220581The modified gen p mean: 0.44934824109077454, gen p mean: -0.042288146913051605, mean p set: 0.449828565120697
loss_pred:0.018169645220041275, decouple_loss:0.0011432523606345057
loss_pred:0.01828477904200554, decouple_loss:0.001168602961115539
Iteration: 167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45283302664756775, gen p mean: -0.046571824699640274, mean p set: 0.45331335067749023
loss_pred:0.01687796041369438, decouple_loss:0.0011432195315137506
The modified gen p mean: 0.45188695192337036, gen p mean: -0.04791944846510887, mean p set: 0.45236724615097046The modified gen p mean: 0.4533085525035858, gen p mean: -0.04372485354542732, mean p set: 0.4537888467311859
loss_pred:0.017457352951169014, decouple_loss:0.001221415470354259
loss_pred:0.01781749352812767, decouple_loss:0.0012137797893956304
Iteration: 168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45086926221847534, gen p mean: -0.04904453083872795, mean p set: 0.45134952664375305
loss_pred:0.01868531107902527, decouple_loss:0.0012026659678667784
The modified gen p mean: 0.44932544231414795, gen p mean: -0.048996131867170334, mean p set: 0.44980570673942566The modified gen p mean: 0.4498851001262665, gen p mean: -0.04609271138906479, mean p set: 0.4503653943538666
loss_pred:0.01792864128947258, decouple_loss:0.0011222047032788396
loss_pred:0.017647210508584976, decouple_loss:0.0011853976175189018
Iteration: 169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504432678222656, gen p mean: -0.045228805392980576, mean p set: 0.4509235620498657
The modified gen p mean: 0.4500582218170166, gen p mean: -0.04370887205004692, mean p set: 0.4505384862422943
loss_pred:0.018187658861279488, decouple_loss:0.0010590868769213557
loss_pred:0.017668230459094048, decouple_loss:0.001100092544220388
The modified gen p mean: 0.45096173882484436, gen p mean: -0.045787565410137177, mean p set: 0.45144200325012207
loss_pred:0.017904728651046753, decouple_loss:0.0010186630534008145
Iteration: 170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488624632358551, gen p mean: -0.043361369520425797, mean p set: 0.4493427276611328
The modified gen p mean: 0.4494931697845459, gen p mean: -0.0426478274166584, mean p set: 0.4499734938144684
loss_pred:0.018535463139414787, decouple_loss:0.0012239424977451563
loss_pred:0.01859935373067856, decouple_loss:0.0011351401917636395The modified gen p mean: 0.45110011100769043, gen p mean: -0.04087454453110695, mean p set: 0.4515804052352905
loss_pred:0.017366936430335045, decouple_loss:0.0012307646684348583
2023-04-30 04:21:04 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0467156320810318, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.042091723531484604, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.042781148105859756, mean p set: 0.4500633478164673
loss_pred:0.01870010979473591, decouple_loss:0.0011830184375867248
loss_pred:0.017543407157063484, decouple_loss:0.0012731278548017144
loss_pred:0.017632311210036278, decouple_loss:0.0012455671094357967
WV_0_PC_1_EH_0_PS_40, loss: 0.018020303919911385, avg_mse: 0.025857072323560715
current test mse: 0.025857
Iteration: 171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490213394165039, gen p mean: -0.04676206409931183, mean p set: 0.4495016634464264
The modified gen p mean: 0.449384868144989, gen p mean: -0.04195640981197357, mean p set: 0.4498651623725891The modified gen p mean: 0.44856002926826477, gen p mean: -0.04452865570783615, mean p set: 0.44904032349586487
loss_pred:0.01851990446448326, decouple_loss:0.001094522885978222
loss_pred:0.018979234620928764, decouple_loss:0.0011411340674385428
loss_pred:0.018034156411886215, decouple_loss:0.0011702863266691566
Iteration: 172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498934745788574, gen p mean: -0.04433456063270569, mean p set: 0.45037373900413513
The modified gen p mean: 0.4501342177391052, gen p mean: -0.04317517951130867, mean p set: 0.45061448216438293
loss_pred:0.01735987327992916, decouple_loss:0.0012271509040147066
loss_pred:0.017449794337153435, decouple_loss:0.0010974705219268799
The modified gen p mean: 0.4480801820755005, gen p mean: -0.044651053845882416, mean p set: 0.44856053590774536
loss_pred:0.018610654398798943, decouple_loss:0.0010700796265155077
Iteration: 173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529532790184021, gen p mean: -0.03969913348555565, mean p set: 0.4534335732460022
The modified gen p mean: 0.45096853375434875, gen p mean: -0.047401055693626404, mean p set: 0.45144885778427124
The modified gen p mean: 0.4495699405670166, gen p mean: -0.042102083563804626, mean p set: 0.4500502049922943
loss_pred:0.01673567108809948, decouple_loss:0.0010908250696957111
loss_pred:0.017558908089995384, decouple_loss:0.0010561615927144885loss_pred:0.018264034762978554, decouple_loss:0.0011243700282648206
Iteration: 174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501848816871643, gen p mean: -0.05005631223320961, mean p set: 0.450665146112442
The modified gen p mean: 0.4485224783420563, gen p mean: -0.046600598841905594, mean p set: 0.44900277256965637
The modified gen p mean: 0.44982409477233887, gen p mean: -0.043061718344688416, mean p set: 0.45030441880226135
loss_pred:0.01738225668668747, decouple_loss:0.001079289591871202
loss_pred:0.017804112285375595, decouple_loss:0.0010371253592893481
loss_pred:0.01846064254641533, decouple_loss:0.0010981118539348245
Iteration: 175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44985833764076233, gen p mean: -0.046010274440050125, mean p set: 0.4503386318683624
The modified gen p mean: 0.4525958001613617, gen p mean: -0.04532182216644287, mean p set: 0.4530760943889618
The modified gen p mean: 0.4485822319984436, gen p mean: -0.045436713844537735, mean p set: 0.4490624964237213
loss_pred:0.018452374264597893, decouple_loss:0.0011280047474429011
loss_pred:0.01621381752192974, decouple_loss:0.0011459238594397902loss_pred:0.017883650958538055, decouple_loss:0.0012352135963737965
Iteration: 176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496776759624481, gen p mean: -0.04320259019732475, mean p set: 0.45015794038772583
loss_pred:0.018119141459465027, decouple_loss:0.0010586214484646916
The modified gen p mean: 0.4509352147579193, gen p mean: -0.04109889641404152, mean p set: 0.4514155089855194
The modified gen p mean: 0.4487227201461792, gen p mean: -0.04748695716261864, mean p set: 0.4492030143737793
loss_pred:0.018277177587151527, decouple_loss:0.0011808054987341166
loss_pred:0.017293469980359077, decouple_loss:0.0010712716029956937
Iteration: 177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510343670845032, gen p mean: -0.042855631560087204, mean p set: 0.45151469111442566
loss_pred:0.017880162224173546, decouple_loss:0.0009626794490031898
The modified gen p mean: 0.45101550221443176, gen p mean: -0.0436425656080246, mean p set: 0.45149579644203186The modified gen p mean: 0.45205241441726685, gen p mean: -0.0423959381878376, mean p set: 0.45253270864486694
loss_pred:0.01769533008337021, decouple_loss:0.0010218063835054636
loss_pred:0.017759298905730247, decouple_loss:0.0009616798488423228
Iteration: 178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45289766788482666, gen p mean: -0.043690554797649384, mean p set: 0.45337799191474915
loss_pred:0.016755618155002594, decouple_loss:0.0011435032356530428
The modified gen p mean: 0.4481806755065918, gen p mean: -0.04527640715241432, mean p set: 0.4486609697341919The modified gen p mean: 0.4500754475593567, gen p mean: -0.04086649790406227, mean p set: 0.4505557417869568
loss_pred:0.017579346895217896, decouple_loss:0.0010942750377580523
loss_pred:0.017872754484415054, decouple_loss:0.001075400155968964
Iteration: 179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502849876880646, gen p mean: -0.0394427627325058, mean p set: 0.4507652819156647
loss_pred:0.017896242439746857, decouple_loss:0.0010507237166166306
The modified gen p mean: 0.4524904787540436, gen p mean: -0.04351980611681938, mean p set: 0.4529707729816437The modified gen p mean: 0.4505613148212433, gen p mean: -0.04354884475469589, mean p set: 0.45104163885116577
loss_pred:0.01732681319117546, decouple_loss:0.0010729043278843164
loss_pred:0.017704831436276436, decouple_loss:0.0011491370387375355
Iteration: 180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45044654607772827, gen p mean: -0.04148755222558975, mean p set: 0.45092687010765076
The modified gen p mean: 0.44955775141716003, gen p mean: -0.04983459413051605, mean p set: 0.45003804564476013
loss_pred:0.017467351630330086, decouple_loss:0.0009646785329096019
loss_pred:0.017439788207411766, decouple_loss:0.0010188367450609803
The modified gen p mean: 0.44972747564315796, gen p mean: -0.0428895466029644, mean p set: 0.45020779967308044
loss_pred:0.017551515251398087, decouple_loss:0.0010782753815874457
2023-04-30 04:22:58 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.044262319803237915, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03937971219420433, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.040065065026283264, mean p set: 0.4500633478164673
loss_pred:0.018578900024294853, decouple_loss:0.0012227913830429316
loss_pred:0.017513496801257133, decouple_loss:0.001214608084410429
loss_pred:0.017632458359003067, decouple_loss:0.0012100610183551908
WV_0_PC_1_EH_0_PS_40, loss: 0.017969075590372086, avg_mse: 0.025800706818699837
current test mse: 0.025801
At step 180, Best test: 0.025801
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
NaN value num: 0
Iteration: 181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494033455848694, gen p mean: -0.04195529222488403, mean p set: 0.4498836398124695
loss_pred:0.017317282035946846, decouple_loss:0.0012386749731376767
The modified gen p mean: 0.4517834484577179, gen p mean: -0.04129182547330856, mean p set: 0.452263742685318The modified gen p mean: 0.45151445269584656, gen p mean: -0.044220540672540665, mean p set: 0.45199474692344666
loss_pred:0.017406003549695015, decouple_loss:0.0011667453218251467
loss_pred:0.017328305169939995, decouple_loss:0.0012099931482225657
Iteration: 182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452109694480896, gen p mean: -0.041390519589185715, mean p set: 0.4525899887084961
loss_pred:0.017648059874773026, decouple_loss:0.0010983103420585394
The modified gen p mean: 0.45031842589378357, gen p mean: -0.042573731392621994, mean p set: 0.45079872012138367The modified gen p mean: 0.4502943754196167, gen p mean: -0.03912073001265526, mean p set: 0.4507746696472168
loss_pred:0.018488815054297447, decouple_loss:0.0011358296032994986
loss_pred:0.018473796546459198, decouple_loss:0.0010973506141453981
Iteration: 183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45099058747291565, gen p mean: -0.03994612768292427, mean p set: 0.45147088170051575
loss_pred:0.017304306849837303, decouple_loss:0.0010316012194380164
The modified gen p mean: 0.4510711133480072, gen p mean: -0.03905675560235977, mean p set: 0.4515514075756073
The modified gen p mean: 0.4505032002925873, gen p mean: -0.037229325622320175, mean p set: 0.4509834945201874
loss_pred:0.017664657905697823, decouple_loss:0.0010188132291659713
loss_pred:0.018153080716729164, decouple_loss:0.0009957040892913938
Iteration: 184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493584632873535, gen p mean: -0.042363788932561874, mean p set: 0.4498387575149536
The modified gen p mean: 0.4514254331588745, gen p mean: -0.0370316356420517, mean p set: 0.451905757188797
loss_pred:0.018018661066889763, decouple_loss:0.001034638611599803
loss_pred:0.017871620133519173, decouple_loss:0.0010655425721779466
The modified gen p mean: 0.451815128326416, gen p mean: -0.03994166851043701, mean p set: 0.4522954225540161
loss_pred:0.017561180517077446, decouple_loss:0.0011084636207669973
Iteration: 185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533882737159729, gen p mean: -0.03511510044336319, mean p set: 0.453868567943573
loss_pred:0.01744818687438965, decouple_loss:0.0011193564860150218
The modified gen p mean: 0.45193731784820557, gen p mean: -0.03516930714249611, mean p set: 0.45241761207580566The modified gen p mean: 0.4494931697845459, gen p mean: -0.03874986246228218, mean p set: 0.449973464012146
loss_pred:0.017637033015489578, decouple_loss:0.0010358458384871483
loss_pred:0.017781205475330353, decouple_loss:0.0010384805500507355
Iteration: 186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45034050941467285, gen p mean: -0.03611413389444351, mean p set: 0.45082080364227295
loss_pred:0.01715126261115074, decouple_loss:0.0009996106382459402
The modified gen p mean: 0.45118770003318787, gen p mean: -0.033486876636743546, mean p set: 0.45166799426078796The modified gen p mean: 0.45179039239883423, gen p mean: -0.03425607457756996, mean p set: 0.4522706866264343
loss_pred:0.018092826008796692, decouple_loss:0.001012904685921967
loss_pred:0.0178641639649868, decouple_loss:0.0010293466039001942
Iteration: 187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508478045463562, gen p mean: -0.0372052900493145, mean p set: 0.4513280689716339
loss_pred:0.017297454178333282, decouple_loss:0.0010012481361627579
The modified gen p mean: 0.4504394233226776, gen p mean: -0.038747962564229965, mean p set: 0.4509196877479553The modified gen p mean: 0.45086970925331116, gen p mean: -0.03444666415452957, mean p set: 0.45135000348091125
loss_pred:0.017936021089553833, decouple_loss:0.0010641468688845634
loss_pred:0.017547236755490303, decouple_loss:0.0009596087620593607
Iteration: 188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499562680721283, gen p mean: -0.0365891233086586, mean p set: 0.4504365921020508
loss_pred:0.017072642222046852, decouple_loss:0.0010925800306722522
The modified gen p mean: 0.4508407711982727, gen p mean: -0.03362823650240898, mean p set: 0.4513210654258728The modified gen p mean: 0.45180270075798035, gen p mean: -0.03484344482421875, mean p set: 0.45228299498558044
loss_pred:0.018302753567695618, decouple_loss:0.0010519823990762234
loss_pred:0.017481287941336632, decouple_loss:0.0010900950292125344
Iteration: 189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527937173843384, gen p mean: -0.03922698274254799, mean p set: 0.4532740116119385
loss_pred:0.017269864678382874, decouple_loss:0.0009760256507433951
The modified gen p mean: 0.4511820375919342, gen p mean: -0.03917263448238373, mean p set: 0.4516623318195343The modified gen p mean: 0.44968274235725403, gen p mean: -0.03658212348818779, mean p set: 0.4501630365848541
loss_pred:0.017282729968428612, decouple_loss:0.0010011360282078385
loss_pred:0.01705579087138176, decouple_loss:0.0010240029077976942
Iteration: 190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516625702381134, gen p mean: -0.043174393475055695, mean p set: 0.4521428644657135
loss_pred:0.016909483820199966, decouple_loss:0.0009596399613656104
The modified gen p mean: 0.4517233073711395, gen p mean: -0.03869905695319176, mean p set: 0.452203631401062The modified gen p mean: 0.45246824622154236, gen p mean: -0.03994427248835564, mean p set: 0.45294854044914246
loss_pred:0.01788613200187683, decouple_loss:0.0009309648885391653
loss_pred:0.016978483647108078, decouple_loss:0.0009684503893367946
2023-04-30 04:25:43 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04608532413840294, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04115203768014908, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04199274256825447, mean p set: 0.4500633478164673
loss_pred:0.018647773191332817, decouple_loss:0.0010988679714500904
loss_pred:0.017506826668977737, decouple_loss:0.0010779782896861434
loss_pred:0.01766321063041687, decouple_loss:0.0010910930577665567
WV_0_PC_1_EH_0_PS_40, loss: 0.017993737012147903, avg_mse: 0.02587924711406231
current test mse: 0.025879
Iteration: 191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517621099948883, gen p mean: -0.04055941104888916, mean p set: 0.4522424042224884
The modified gen p mean: 0.4516680836677551, gen p mean: -0.05102891847491264, mean p set: 0.4521483778953552
The modified gen p mean: 0.4498148262500763, gen p mean: -0.040783967822790146, mean p set: 0.4502951502799988
loss_pred:0.01712854951620102, decouple_loss:0.0009690224542282522
loss_pred:0.017231682315468788, decouple_loss:0.000960921635851264
loss_pred:0.01798032410442829, decouple_loss:0.0010588669683784246
Iteration: 192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44939762353897095, gen p mean: -0.042302846908569336, mean p set: 0.44987794756889343
loss_pred:0.0178925022482872, decouple_loss:0.0009527544025331736
The modified gen p mean: 0.45050284266471863, gen p mean: -0.04433995485305786, mean p set: 0.4509831368923187The modified gen p mean: 0.4525103271007538, gen p mean: -0.04002497345209122, mean p set: 0.4529906213283539
loss_pred:0.01789739355444908, decouple_loss:0.0009597516618669033
loss_pred:0.017131568863987923, decouple_loss:0.0009713242179714143
Iteration: 193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45053043961524963, gen p mean: -0.042254287749528885, mean p set: 0.45101073384284973
loss_pred:0.01783330924808979, decouple_loss:0.000936551601625979
The modified gen p mean: 0.453704297542572, gen p mean: -0.03835650160908699, mean p set: 0.45418456196784973The modified gen p mean: 0.4500633776187897, gen p mean: -0.04199547320604324, mean p set: 0.45054367184638977
loss_pred:0.01751602813601494, decouple_loss:0.0008755335584282875
loss_pred:0.016831858083605766, decouple_loss:0.0008642315515317023
Iteration: 194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44928792119026184, gen p mean: -0.0406855009496212, mean p set: 0.4497682452201843
loss_pred:0.017705710604786873, decouple_loss:0.0009120642207562923
The modified gen p mean: 0.44962504506111145, gen p mean: -0.04161004349589348, mean p set: 0.45010536909103394The modified gen p mean: 0.4515419900417328, gen p mean: -0.04198504611849785, mean p set: 0.4520223140716553
loss_pred:0.017168939113616943, decouple_loss:0.0009093396365642548
loss_pred:0.01779266633093357, decouple_loss:0.0008973708027042449
Iteration: 195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497741162776947, gen p mean: -0.04557684063911438, mean p set: 0.4502543807029724
loss_pred:0.018098637461662292, decouple_loss:0.0009286444401368499
The modified gen p mean: 0.4520490765571594, gen p mean: -0.03813144937157631, mean p set: 0.4525294005870819The modified gen p mean: 0.4495964050292969, gen p mean: -0.038827501237392426, mean p set: 0.45007672905921936
loss_pred:0.017449477687478065, decouple_loss:0.0008710652473382652
loss_pred:0.01726466789841652, decouple_loss:0.0008344849920831621
Iteration: 196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45203569531440735, gen p mean: -0.03788278251886368, mean p set: 0.45251601934432983
loss_pred:0.017319869250059128, decouple_loss:0.0009301250684075058
The modified gen p mean: 0.45172128081321716, gen p mean: -0.03827118128538132, mean p set: 0.45220157504081726The modified gen p mean: 0.4508695602416992, gen p mean: -0.03552517667412758, mean p set: 0.4513498842716217
loss_pred:0.017068659886717796, decouple_loss:0.0009251012234017253
loss_pred:0.016997095197439194, decouple_loss:0.001016059541143477
Iteration: 197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45313552021980286, gen p mean: -0.03877952694892883, mean p set: 0.45361581444740295
loss_pred:0.01738397404551506, decouple_loss:0.0009095848654396832
The modified gen p mean: 0.45117947459220886, gen p mean: -0.041982680559158325, mean p set: 0.4516597390174866The modified gen p mean: 0.4498800039291382, gen p mean: -0.03979097306728363, mean p set: 0.4503602981567383
loss_pred:0.01690787822008133, decouple_loss:0.0009874021634459496
loss_pred:0.017379403114318848, decouple_loss:0.0009389373008161783
Iteration: 198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510924220085144, gen p mean: -0.03828982636332512, mean p set: 0.4515727162361145
loss_pred:0.01714540459215641, decouple_loss:0.0008735372102819383
The modified gen p mean: 0.4499293267726898, gen p mean: -0.04086964949965477, mean p set: 0.4504096210002899The modified gen p mean: 0.45124033093452454, gen p mean: -0.04597574099898338, mean p set: 0.45172062516212463
loss_pred:0.017863379791378975, decouple_loss:0.0009689538273960352
loss_pred:0.018055614084005356, decouple_loss:0.0008624761831015348
Iteration: 199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45142194628715515, gen p mean: -0.04523646831512451, mean p set: 0.45190224051475525
loss_pred:0.017931027337908745, decouple_loss:0.000989178312011063
The modified gen p mean: 0.44945886731147766, gen p mean: -0.03709907457232475, mean p set: 0.44993916153907776The modified gen p mean: 0.4502983093261719, gen p mean: -0.034668371081352234, mean p set: 0.450778603553772
loss_pred:0.017243586480617523, decouple_loss:0.000942554441280663
loss_pred:0.017885690554976463, decouple_loss:0.0008335734019055963
Iteration: 200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45108267664909363, gen p mean: -0.035192783921957016, mean p set: 0.4515630006790161
loss_pred:0.017009301111102104, decouple_loss:0.0009145880467258394
The modified gen p mean: 0.44981104135513306, gen p mean: -0.03881325572729111, mean p set: 0.45029133558273315The modified gen p mean: 0.4513101875782013, gen p mean: -0.035978611558675766, mean p set: 0.4517904818058014
loss_pred:0.01793249137699604, decouple_loss:0.0008604684844613075
loss_pred:0.01815023459494114, decouple_loss:0.0008883588598109782
2023-04-30 04:27:37 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04189048707485199, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.036980874836444855, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.03769427165389061, mean p set: 0.4500633478164673
loss_pred:0.018593132495880127, decouple_loss:0.000961220299359411
loss_pred:0.017529943957924843, decouple_loss:0.0009722347022034228
loss_pred:0.017613431438803673, decouple_loss:0.0010076743783429265
WV_0_PC_1_EH_0_PS_40, loss: 0.01796118915081024, avg_mse: 0.025823140516877174
current test mse: 0.025823
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
NaN value num: 0
Iteration: 201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526750147342682, gen p mean: -0.0340438187122345, mean p set: 0.4531553387641907
loss_pred:0.01834741234779358, decouple_loss:0.0009906749473884702
The modified gen p mean: 0.4530549943447113, gen p mean: -0.03528517112135887, mean p set: 0.4535352885723114The modified gen p mean: 0.45184892416000366, gen p mean: -0.02737656980752945, mean p set: 0.45232921838760376
loss_pred:0.018484262749552727, decouple_loss:0.0010569127043709159loss_pred:0.018591543659567833, decouple_loss:0.0010357594583183527
Iteration: 202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4545176923274994, gen p mean: -0.03555768355727196, mean p set: 0.4549979567527771
loss_pred:0.018632182851433754, decouple_loss:0.0009265189291909337
The modified gen p mean: 0.45171183347702026, gen p mean: -0.03273017331957817, mean p set: 0.45219212770462036The modified gen p mean: 0.45166417956352234, gen p mean: -0.03410518169403076, mean p set: 0.45214447379112244
loss_pred:0.017994491383433342, decouple_loss:0.0009208567789755762
loss_pred:0.018896613270044327, decouple_loss:0.0009502286557108164
Iteration: 203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45110735297203064, gen p mean: -0.02720446139574051, mean p set: 0.45158764719963074
loss_pred:0.0186762772500515, decouple_loss:0.0009508993243798614
The modified gen p mean: 0.45203304290771484, gen p mean: -0.03006713278591633, mean p set: 0.45251336693763733The modified gen p mean: 0.45224201679229736, gen p mean: -0.029419733211398125, mean p set: 0.45272231101989746
loss_pred:0.019262030720710754, decouple_loss:0.0009378526010550559
loss_pred:0.0178691316395998, decouple_loss:0.0008689853711985052
Iteration: 204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45258578658103943, gen p mean: -0.03762255609035492, mean p set: 0.4530661106109619
loss_pred:0.017888186499476433, decouple_loss:0.0009020473808050156
The modified gen p mean: 0.45258259773254395, gen p mean: -0.035681452602148056, mean p set: 0.45306292176246643The modified gen p mean: 0.45173004269599915, gen p mean: -0.032463181763887405, mean p set: 0.45221033692359924
loss_pred:0.018821556121110916, decouple_loss:0.0010178886586800218
loss_pred:0.018110034987330437, decouple_loss:0.0009000023128464818
Iteration: 205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4538276195526123, gen p mean: -0.034121837466955185, mean p set: 0.4543079137802124
loss_pred:0.01855665072798729, decouple_loss:0.0011018406366929412
The modified gen p mean: 0.45290395617485046, gen p mean: -0.03478638082742691, mean p set: 0.4533842206001282The modified gen p mean: 0.45128047466278076, gen p mean: -0.03568483889102936, mean p set: 0.45176076889038086
loss_pred:0.018951933830976486, decouple_loss:0.001108386437408626
loss_pred:0.01699022762477398, decouple_loss:0.000984370126388967
Iteration: 206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4539492726325989, gen p mean: -0.04108935594558716, mean p set: 0.454429566860199
loss_pred:0.017949160188436508, decouple_loss:0.0009784720605239272
The modified gen p mean: 0.4523218870162964, gen p mean: -0.03620554506778717, mean p set: 0.4528021812438965The modified gen p mean: 0.45357224345207214, gen p mean: -0.040142785757780075, mean p set: 0.45405256748199463
loss_pred:0.018474234268069267, decouple_loss:0.0009670451981946826
loss_pred:0.018863148987293243, decouple_loss:0.0009668960701674223
Iteration: 207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45353958010673523, gen p mean: -0.039888329803943634, mean p set: 0.4540198743343353
loss_pred:0.01823887974023819, decouple_loss:0.0010542712407186627
The modified gen p mean: 0.45230743288993835, gen p mean: -0.039777208119630814, mean p set: 0.45278772711753845The modified gen p mean: 0.4503503441810608, gen p mean: -0.03448863700032234, mean p set: 0.4508306682109833
loss_pred:0.018773939460515976, decouple_loss:0.0011339851189404726
loss_pred:0.019312672317028046, decouple_loss:0.0011026466963812709
Iteration: 208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45474687218666077, gen p mean: -0.04159960150718689, mean p set: 0.45522719621658325
The modified gen p mean: 0.4519030749797821, gen p mean: -0.03739922121167183, mean p set: 0.452383428812027
loss_pred:0.01852206327021122, decouple_loss:0.0009302168618887663
loss_pred:0.018874727189540863, decouple_loss:0.001028365222737193
The modified gen p mean: 0.45176437497138977, gen p mean: -0.03978443890810013, mean p set: 0.4522446393966675
loss_pred:0.01888561062514782, decouple_loss:0.0010143943363800645
Iteration: 209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527387320995331, gen p mean: -0.04323914647102356, mean p set: 0.4532190263271332
The modified gen p mean: 0.4525487720966339, gen p mean: -0.044730741530656815, mean p set: 0.4530290365219116
loss_pred:0.017748937010765076, decouple_loss:0.0009892255766317248
loss_pred:0.017758360132575035, decouple_loss:0.001006158534437418
The modified gen p mean: 0.4509492516517639, gen p mean: -0.040545906871557236, mean p set: 0.4514295160770416
loss_pred:0.018412195146083832, decouple_loss:0.0010172248585149646
Iteration: 210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532589316368103, gen p mean: -0.04321695864200592, mean p set: 0.4537392258644104
The modified gen p mean: 0.45336225628852844, gen p mean: -0.041385672986507416, mean p set: 0.4538425803184509
loss_pred:0.01834830455482006, decouple_loss:0.0010415167780593038
loss_pred:0.018674930557608604, decouple_loss:0.0009923055768013
The modified gen p mean: 0.4519352316856384, gen p mean: -0.038830213248729706, mean p set: 0.4524155259132385
loss_pred:0.01769246719777584, decouple_loss:0.0009639302734285593
2023-04-30 04:30:08 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05274283513426781, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04789647087454796, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.048394471406936646, mean p set: 0.4500633478164673
loss_pred:0.01868879608809948, decouple_loss:0.0011317920871078968
loss_pred:0.017556127160787582, decouple_loss:0.001128068775869906
loss_pred:0.017707062885165215, decouple_loss:0.0010852798586711287
WV_0_PC_1_EH_0_PS_40, loss: 0.018039748072624207, avg_mse: 0.025955045595765114
current test mse: 0.025955
Iteration: 211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526388943195343, gen p mean: -0.042702171951532364, mean p set: 0.453119158744812
The modified gen p mean: 0.4519208073616028, gen p mean: -0.043190497905015945, mean p set: 0.4524010717868805
The modified gen p mean: 0.45364445447921753, gen p mean: -0.04158809781074524, mean p set: 0.45412477850914
loss_pred:0.018460292369127274, decouple_loss:0.0010431036353111267
loss_pred:0.018639037385582924, decouple_loss:0.0010287086479365826
loss_pred:0.018282519653439522, decouple_loss:0.0010216654045507312
Iteration: 212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515564441680908, gen p mean: -0.04009333625435829, mean p set: 0.45203670859336853
loss_pred:0.01873781345784664, decouple_loss:0.0009213251178152859
The modified gen p mean: 0.45225897431373596, gen p mean: -0.0460699088871479, mean p set: 0.45273926854133606
The modified gen p mean: 0.45303645730018616, gen p mean: -0.04241622984409332, mean p set: 0.45351678133010864
loss_pred:0.01790786348283291, decouple_loss:0.0010143974795937538
loss_pred:0.017696715891361237, decouple_loss:0.0010758104035630822
Iteration: 213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519190490245819, gen p mean: -0.039126429706811905, mean p set: 0.452399343252182
loss_pred:0.018159454688429832, decouple_loss:0.0009834992233663797
The modified gen p mean: 0.4528390169143677, gen p mean: -0.044159192591905594, mean p set: 0.45331934094429016The modified gen p mean: 0.4527120292186737, gen p mean: -0.04551338031888008, mean p set: 0.4531923532485962
loss_pred:0.0179307721555233, decouple_loss:0.0009759540553204715
loss_pred:0.017989784479141235, decouple_loss:0.0010063369991257787
Iteration: 214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515621066093445, gen p mean: -0.03545768931508064, mean p set: 0.4520424008369446
loss_pred:0.01900274120271206, decouple_loss:0.0010377499274909496
The modified gen p mean: 0.4531635046005249, gen p mean: -0.03906757012009621, mean p set: 0.4536438286304474The modified gen p mean: 0.45160800218582153, gen p mean: -0.04228885471820831, mean p set: 0.45208826661109924
loss_pred:0.01867830939590931, decouple_loss:0.0010977095225825906
loss_pred:0.017220327630639076, decouple_loss:0.0009863614104688168
Iteration: 215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45108649134635925, gen p mean: -0.04339257627725601, mean p set: 0.45156678557395935
loss_pred:0.018739944323897362, decouple_loss:0.0010608425363898277
The modified gen p mean: 0.45436638593673706, gen p mean: -0.04643029347062111, mean p set: 0.45484670996665955The modified gen p mean: 0.4518159031867981, gen p mean: -0.04400422424077988, mean p set: 0.4522961974143982
loss_pred:0.018651580438017845, decouple_loss:0.0010463347425684333
loss_pred:0.01789086125791073, decouple_loss:0.001101240748539567
Iteration: 216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518929421901703, gen p mean: -0.042807962745428085, mean p set: 0.4523732364177704
loss_pred:0.01891300641000271, decouple_loss:0.0010114704491570592
The modified gen p mean: 0.45369771122932434, gen p mean: -0.04133133590221405, mean p set: 0.45417800545692444The modified gen p mean: 0.4543944001197815, gen p mean: -0.04537293687462807, mean p set: 0.4548746943473816
loss_pred:0.018160197883844376, decouple_loss:0.0009617694304324687
loss_pred:0.018064239993691444, decouple_loss:0.001014447072520852
Iteration: 217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45232123136520386, gen p mean: -0.039340078830718994, mean p set: 0.45280152559280396
loss_pred:0.018485937267541885, decouple_loss:0.001010047155432403
The modified gen p mean: 0.45178577303886414, gen p mean: -0.0385705940425396, mean p set: 0.4522660970687866The modified gen p mean: 0.4524392783641815, gen p mean: -0.04539310559630394, mean p set: 0.4529195725917816
loss_pred:0.018321428447961807, decouple_loss:0.0009608409600332379
loss_pred:0.018513323739171028, decouple_loss:0.0009683821117505431
Iteration: 218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525024890899658, gen p mean: -0.04522072523832321, mean p set: 0.45298275351524353
loss_pred:0.018858008086681366, decouple_loss:0.0009268781286664307
The modified gen p mean: 0.45458200573921204, gen p mean: -0.04950034245848656, mean p set: 0.45506227016448975The modified gen p mean: 0.453336626291275, gen p mean: -0.043533165007829666, mean p set: 0.4538169205188751
loss_pred:0.017229175195097923, decouple_loss:0.0009684109827503562
loss_pred:0.018373791128396988, decouple_loss:0.0009743628324940801
Iteration: 219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45200395584106445, gen p mean: -0.044537756592035294, mean p set: 0.45248425006866455
loss_pred:0.01885206066071987, decouple_loss:0.000957162119448185
The modified gen p mean: 0.45314475893974304, gen p mean: -0.04745177924633026, mean p set: 0.45362505316734314The modified gen p mean: 0.45329633355140686, gen p mean: -0.04470379278063774, mean p set: 0.45377665758132935
loss_pred:0.019505534321069717, decouple_loss:0.001015120418742299
loss_pred:0.017870455980300903, decouple_loss:0.0010028627002611756
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
NaN value num: 0
Iteration: 220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497283101081848, gen p mean: -0.04395174980163574, mean p set: 0.4502086043357849
loss_pred:0.01749853976070881, decouple_loss:0.0010376039426773787
The modified gen p mean: 0.4514588415622711, gen p mean: -0.03993483632802963, mean p set: 0.4519391357898712The modified gen p mean: 0.45068731904029846, gen p mean: -0.043136127293109894, mean p set: 0.45116758346557617
loss_pred:0.01679486781358719, decouple_loss:0.001128005445934832
loss_pred:0.01738034002482891, decouple_loss:0.0010832175612449646
2023-04-30 04:32:41 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05597814917564392, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.049475014209747314, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05101240798830986, mean p set: 0.4500633478164673
loss_pred:0.019034309312701225, decouple_loss:0.0011056819930672646
loss_pred:0.017784444615244865, decouple_loss:0.0010502710938453674
loss_pred:0.017967654392123222, decouple_loss:0.0010727685876190662
WV_0_PC_1_EH_0_PS_40, loss: 0.01831594854593277, avg_mse: 0.02638697810471058
current test mse: 0.026387
Iteration: 221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503079950809479, gen p mean: -0.04818735644221306, mean p set: 0.450788289308548
The modified gen p mean: 0.45129311084747314, gen p mean: -0.05087185651063919, mean p set: 0.45177337527275085
The modified gen p mean: 0.4510365128517151, gen p mean: -0.04658709466457367, mean p set: 0.4515168070793152
loss_pred:0.017317548394203186, decouple_loss:0.0010172391775995493
loss_pred:0.017326293513178825, decouple_loss:0.0009722714312374592loss_pred:0.018224911764264107, decouple_loss:0.0009910481749102473
Iteration: 222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511014521121979, gen p mean: -0.04569875821471214, mean p set: 0.4515817165374756
loss_pred:0.018487542867660522, decouple_loss:0.0011103424476459622
The modified gen p mean: 0.45068755745887756, gen p mean: -0.044217776507139206, mean p set: 0.45116788148880005The modified gen p mean: 0.45076966285705566, gen p mean: -0.042659636586904526, mean p set: 0.45124995708465576
loss_pred:0.018396874889731407, decouple_loss:0.0012057701824232936
loss_pred:0.017785677686333656, decouple_loss:0.001185333589091897
Iteration: 223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518243372440338, gen p mean: -0.04822787642478943, mean p set: 0.4523046314716339
The modified gen p mean: 0.4511606693267822, gen p mean: -0.044322419911623, mean p set: 0.45164093375205994
loss_pred:0.019346140325069427, decouple_loss:0.0012036976404488087
loss_pred:0.018290072679519653, decouple_loss:0.0011999885318800807
The modified gen p mean: 0.4502285420894623, gen p mean: -0.04332008585333824, mean p set: 0.4507088363170624
loss_pred:0.019304534420371056, decouple_loss:0.0012240029172971845
Iteration: 224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520137310028076, gen p mean: -0.043153874576091766, mean p set: 0.4524940252304077
The modified gen p mean: 0.4515930414199829, gen p mean: -0.04515324532985687, mean p set: 0.4520733654499054
loss_pred:0.018767453730106354, decouple_loss:0.0013544574612751603
loss_pred:0.019403934478759766, decouple_loss:0.0012514278059825301
The modified gen p mean: 0.45045846700668335, gen p mean: -0.04759256914258003, mean p set: 0.45093876123428345
loss_pred:0.01948692835867405, decouple_loss:0.0013110149884596467
Iteration: 225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45086032152175903, gen p mean: -0.04680405184626579, mean p set: 0.45134058594703674
loss_pred:0.01890699192881584, decouple_loss:0.0013222657144069672
The modified gen p mean: 0.4504479169845581, gen p mean: -0.050981707870960236, mean p set: 0.4509281814098358The modified gen p mean: 0.4525086283683777, gen p mean: -0.04600152000784874, mean p set: 0.4529889225959778
loss_pred:0.019278813153505325, decouple_loss:0.0012848718324676156
loss_pred:0.01866229809820652, decouple_loss:0.0014502061530947685
Iteration: 226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45046862959861755, gen p mean: -0.041675206273794174, mean p set: 0.45094895362854004
loss_pred:0.018399566411972046, decouple_loss:0.0012091400567442179
The modified gen p mean: 0.45172634720802307, gen p mean: -0.04673536494374275, mean p set: 0.45220664143562317The modified gen p mean: 0.4506170451641083, gen p mean: -0.04370961710810661, mean p set: 0.45109736919403076
loss_pred:0.01861371472477913, decouple_loss:0.0012231142027303576
loss_pred:0.018081404268741608, decouple_loss:0.0012297765351831913
Iteration: 227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514724612236023, gen p mean: -0.044330596923828125, mean p set: 0.4519527554512024
loss_pred:0.01789345219731331, decouple_loss:0.0012796504888683558
The modified gen p mean: 0.451322078704834, gen p mean: -0.04111630469560623, mean p set: 0.4518023431301117The modified gen p mean: 0.4497826397418976, gen p mean: -0.04053245112299919, mean p set: 0.45026299357414246
loss_pred:0.018985744565725327, decouple_loss:0.0012165997177362442
loss_pred:0.01782732456922531, decouple_loss:0.0013078959891572595
Iteration: 228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44994911551475525, gen p mean: -0.04423364996910095, mean p set: 0.45042940974235535
loss_pred:0.01916082575917244, decouple_loss:0.0013407921651378274
The modified gen p mean: 0.4522443115711212, gen p mean: -0.04860148951411247, mean p set: 0.4527246057987213The modified gen p mean: 0.45170214772224426, gen p mean: -0.045386798679828644, mean p set: 0.45218244194984436
loss_pred:0.018436886370182037, decouple_loss:0.0013876750599592924
loss_pred:0.017567358911037445, decouple_loss:0.001399821019731462
Iteration: 229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45102256536483765, gen p mean: -0.04944824054837227, mean p set: 0.45150282979011536
loss_pred:0.018088286742568016, decouple_loss:0.0013816108694300056
The modified gen p mean: 0.452824205160141, gen p mean: -0.049014583230018616, mean p set: 0.4533045291900635The modified gen p mean: 0.45126569271087646, gen p mean: -0.05298643186688423, mean p set: 0.4517459571361542
loss_pred:0.017955636605620384, decouple_loss:0.001406357972882688
loss_pred:0.0178371611982584, decouple_loss:0.0013507838593795896
Iteration: 230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45057961344718933, gen p mean: -0.04989835247397423, mean p set: 0.4510599374771118
loss_pred:0.018092503771185875, decouple_loss:0.0012848156038671732
The modified gen p mean: 0.45191967487335205, gen p mean: -0.05067731812596321, mean p set: 0.45239993929862976The modified gen p mean: 0.4496269226074219, gen p mean: -0.05351737141609192, mean p set: 0.45010724663734436
loss_pred:0.01816914975643158, decouple_loss:0.0014132289215922356
loss_pred:0.01820799894630909, decouple_loss:0.001336456392891705
2023-04-30 04:34:35 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.054911594837903976, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05051174387335777, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05123232677578926, mean p set: 0.4500633478164673
loss_pred:0.019296741113066673, decouple_loss:0.0013431814732030034
loss_pred:0.018078891560435295, decouple_loss:0.0012686331756412983
loss_pred:0.018186055123806, decouple_loss:0.0012900794390588999
WV_0_PC_1_EH_0_PS_40, loss: 0.01858559437096119, avg_mse: 0.026753302663564682
current test mse: 0.026753
Iteration: 231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518909454345703, gen p mean: -0.042856842279434204, mean p set: 0.4523712396621704
The modified gen p mean: 0.44996029138565063, gen p mean: -0.04829687625169754, mean p set: 0.45044055581092834
The modified gen p mean: 0.4500848352909088, gen p mean: -0.05012150853872299, mean p set: 0.4505651295185089
loss_pred:0.01781325601041317, decouple_loss:0.0012873233063146472
loss_pred:0.018409963697195053, decouple_loss:0.0012587358942255378
loss_pred:0.018637649714946747, decouple_loss:0.0013067317195236683
Iteration: 232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45187821984291077, gen p mean: -0.03495211526751518, mean p set: 0.45235851407051086
loss_pred:0.01813998818397522, decouple_loss:0.0014062266563996673
The modified gen p mean: 0.4504152834415436, gen p mean: -0.03616317734122276, mean p set: 0.4508955478668213The modified gen p mean: 0.4492797553539276, gen p mean: -0.034034907817840576, mean p set: 0.4497600495815277
loss_pred:0.017939096316695213, decouple_loss:0.0013825565110892057
loss_pred:0.017092784866690636, decouple_loss:0.0014018520014360547
Iteration: 233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511999487876892, gen p mean: -0.0280537698417902, mean p set: 0.4516802132129669
loss_pred:0.016895391047000885, decouple_loss:0.0015553346602246165
The modified gen p mean: 0.45181411504745483, gen p mean: -0.027482876554131508, mean p set: 0.45229440927505493The modified gen p mean: 0.451941579580307, gen p mean: -0.029551027342677116, mean p set: 0.4524218738079071
loss_pred:0.018497150391340256, decouple_loss:0.0015317407669499516
loss_pred:0.017364146187901497, decouple_loss:0.0016305772587656975
Iteration: 234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533810317516327, gen p mean: -0.0312778577208519, mean p set: 0.4538613259792328
loss_pred:0.017627596855163574, decouple_loss:0.0014340906636789441
The modified gen p mean: 0.4520318806171417, gen p mean: -0.030304642394185066, mean p set: 0.45251214504241943
The modified gen p mean: 0.45056813955307007, gen p mean: -0.03450888767838478, mean p set: 0.45104846358299255
loss_pred:0.01803232729434967, decouple_loss:0.0014947138261049986
loss_pred:0.01761627569794655, decouple_loss:0.0014216534327715635
Iteration: 235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45121800899505615, gen p mean: -0.03064294159412384, mean p set: 0.45169830322265625
loss_pred:0.017601722851395607, decouple_loss:0.0014598984271287918
The modified gen p mean: 0.4518912136554718, gen p mean: -0.03551804646849632, mean p set: 0.4523715376853943The modified gen p mean: 0.4518422484397888, gen p mean: -0.035661481320858, mean p set: 0.4523225724697113
loss_pred:0.017174631357192993, decouple_loss:0.00148441968485713
loss_pred:0.01689291186630726, decouple_loss:0.0014951865887269378
Iteration: 236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45107418298721313, gen p mean: -0.04163426533341408, mean p set: 0.45155444741249084
loss_pred:0.017161237075924873, decouple_loss:0.001389603829011321
The modified gen p mean: 0.45287272334098816, gen p mean: -0.04009000211954117, mean p set: 0.45335304737091064The modified gen p mean: 0.45082539319992065, gen p mean: -0.0395134761929512, mean p set: 0.45130568742752075
loss_pred:0.01852693222463131, decouple_loss:0.0014506304869428277
loss_pred:0.017412660643458366, decouple_loss:0.0014035748317837715
Iteration: 237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512845575809479, gen p mean: -0.04423872381448746, mean p set: 0.45176488161087036
loss_pred:0.017727797850966454, decouple_loss:0.0013641456607729197
The modified gen p mean: 0.45319584012031555, gen p mean: -0.041084516793489456, mean p set: 0.45367616415023804The modified gen p mean: 0.45262861251831055, gen p mean: -0.04484504833817482, mean p set: 0.45310890674591064
loss_pred:0.017527300864458084, decouple_loss:0.001350301317870617
loss_pred:0.01806729845702648, decouple_loss:0.0013907760148867965
Iteration: 238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521043300628662, gen p mean: -0.0457904115319252, mean p set: 0.4525846242904663
The modified gen p mean: 0.44986605644226074, gen p mean: -0.045079249888658524, mean p set: 0.45034632086753845
loss_pred:0.01757104881107807, decouple_loss:0.0012885311152786016
loss_pred:0.01718391478061676, decouple_loss:0.001310360967181623
The modified gen p mean: 0.45220863819122314, gen p mean: -0.04627319052815437, mean p set: 0.45268896222114563
loss_pred:0.01702994480729103, decouple_loss:0.001359438174404204
Iteration: 239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45255526900291443, gen p mean: -0.04379909485578537, mean p set: 0.45303553342819214
loss_pred:0.01723841391503811, decouple_loss:0.0013181577669456601
The modified gen p mean: 0.4518289268016815, gen p mean: -0.043798789381980896, mean p set: 0.4523092210292816The modified gen p mean: 0.45080626010894775, gen p mean: -0.04750934988260269, mean p set: 0.45128652453422546
loss_pred:0.017447011545300484, decouple_loss:0.0012878606794402003
loss_pred:0.017341647297143936, decouple_loss:0.0013949824497103691
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
NaN value num: 0
Iteration: 240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753193855285645, gen p mean: -0.05268183350563049, mean p set: 0.44801223278045654
loss_pred:0.01957816071808338, decouple_loss:0.0013429919490590692
The modified gen p mean: 0.4469979405403137, gen p mean: -0.0512431301176548, mean p set: 0.4474782347679138The modified gen p mean: 0.4461558759212494, gen p mean: -0.05222410336136818, mean p set: 0.4466361403465271
loss_pred:0.018623000010848045, decouple_loss:0.0013556922785937786
loss_pred:0.01882774382829666, decouple_loss:0.0013852939009666443
2023-04-30 04:37:07 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.049232084304094315, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04487261548638344, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.045334815979003906, mean p set: 0.4500633478164673
loss_pred:0.018950121477246284, decouple_loss:0.0013667196035385132
loss_pred:0.017831439152359962, decouple_loss:0.0013238524552434683
loss_pred:0.017932182177901268, decouple_loss:0.0012917937710881233
WV_0_PC_1_EH_0_PS_40, loss: 0.018304288387298584, avg_mse: 0.02619834616780281
current test mse: 0.026198
Iteration: 241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480167329311371, gen p mean: -0.04584150388836861, mean p set: 0.4484969973564148
The modified gen p mean: 0.44828104972839355, gen p mean: -0.044556017965078354, mean p set: 0.44876134395599365The modified gen p mean: 0.4463682174682617, gen p mean: -0.04913395270705223, mean p set: 0.4468485414981842
loss_pred:0.0178068820387125, decouple_loss:0.0013161038514226675
loss_pred:0.020033594220876694, decouple_loss:0.0013595368945971131
loss_pred:0.02031524106860161, decouple_loss:0.001319944392889738
Iteration: 242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708576798439026, gen p mean: -0.04493829980492592, mean p set: 0.44756606221199036
loss_pred:0.018165837973356247, decouple_loss:0.0013024703366681933
The modified gen p mean: 0.44600510597229004, gen p mean: -0.04336671531200409, mean p set: 0.44648540019989014The modified gen p mean: 0.4484891891479492, gen p mean: -0.04566752165555954, mean p set: 0.4489694833755493
loss_pred:0.019493406638503075, decouple_loss:0.0013423921773210168
loss_pred:0.019695594906806946, decouple_loss:0.0013789678923785686
Iteration: 243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44636473059654236, gen p mean: -0.046167660504579544, mean p set: 0.44684502482414246
The modified gen p mean: 0.4461723566055298, gen p mean: -0.0477290041744709, mean p set: 0.4466526508331299
loss_pred:0.017920706421136856, decouple_loss:0.0012876413529738784
loss_pred:0.018386637791991234, decouple_loss:0.0013422210467979312
The modified gen p mean: 0.44829297065734863, gen p mean: -0.0407441183924675, mean p set: 0.44877323508262634
loss_pred:0.01916986145079136, decouple_loss:0.0013240758562460542
Iteration: 244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473405182361603, gen p mean: -0.04627946391701698, mean p set: 0.4478208124637604
loss_pred:0.019134540110826492, decouple_loss:0.001283220131881535
The modified gen p mean: 0.44731974601745605, gen p mean: -0.045261405408382416, mean p set: 0.44780007004737854The modified gen p mean: 0.4487491250038147, gen p mean: -0.043550241738557816, mean p set: 0.4492294192314148
loss_pred:0.018500158563256264, decouple_loss:0.0013483843067660928
loss_pred:0.019621504470705986, decouple_loss:0.0012984859058633447
Iteration: 245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44628268480300903, gen p mean: -0.04180539399385452, mean p set: 0.4467630088329315
The modified gen p mean: 0.44708535075187683, gen p mean: -0.0446612723171711, mean p set: 0.44756564497947693
loss_pred:0.018761074170470238, decouple_loss:0.0014069961616769433
loss_pred:0.017730196937918663, decouple_loss:0.0013729745987802744
The modified gen p mean: 0.44618138670921326, gen p mean: -0.04135805368423462, mean p set: 0.44666171073913574
loss_pred:0.018520431593060493, decouple_loss:0.0012943989131599665
Iteration: 246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477706551551819, gen p mean: -0.04486681520938873, mean p set: 0.448250949382782
loss_pred:0.019234128296375275, decouple_loss:0.0012621884234249592
The modified gen p mean: 0.4462626874446869, gen p mean: -0.043398577719926834, mean p set: 0.446742981672287The modified gen p mean: 0.4462166130542755, gen p mean: -0.04455490782856941, mean p set: 0.4466968774795532
loss_pred:0.018747365102171898, decouple_loss:0.0012184170773252845
loss_pred:0.018772270530462265, decouple_loss:0.0012926047202199697
Iteration: 247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469245672225952, gen p mean: -0.04790206626057625, mean p set: 0.4474048614501953
loss_pred:0.018356088548898697, decouple_loss:0.001241008983924985
The modified gen p mean: 0.44763386249542236, gen p mean: -0.050161369144916534, mean p set: 0.44811415672302246The modified gen p mean: 0.4473278820514679, gen p mean: -0.041840922087430954, mean p set: 0.4478082060813904
loss_pred:0.018517766147851944, decouple_loss:0.0012833626242354512
loss_pred:0.01923336461186409, decouple_loss:0.0013587529538199306
Iteration: 248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487219452857971, gen p mean: -0.051203493028879166, mean p set: 0.4492022693157196
loss_pred:0.019546758383512497, decouple_loss:0.001313743181526661
The modified gen p mean: 0.4468817412853241, gen p mean: -0.051606450229883194, mean p set: 0.4473620653152466The modified gen p mean: 0.4470100402832031, gen p mean: -0.046751298010349274, mean p set: 0.4474903643131256
loss_pred:0.018863115459680557, decouple_loss:0.0012235465692356229
loss_pred:0.018035979941487312, decouple_loss:0.0012817608658224344
Iteration: 249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44622454047203064, gen p mean: -0.05033578723669052, mean p set: 0.44670480489730835
loss_pred:0.017994210124015808, decouple_loss:0.0011706334771588445
The modified gen p mean: 0.44780921936035156, gen p mean: -0.04954926297068596, mean p set: 0.44828951358795166
The modified gen p mean: 0.44634461402893066, gen p mean: -0.053246911615133286, mean p set: 0.4468248784542084
loss_pred:0.018168164417147636, decouple_loss:0.001162524102255702
loss_pred:0.01801532693207264, decouple_loss:0.0011533371871337295
Iteration: 250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469218850135803, gen p mean: -0.049591872841119766, mean p set: 0.4474022090435028
loss_pred:0.019211113452911377, decouple_loss:0.0012755102943629026
The modified gen p mean: 0.44689828157424927, gen p mean: -0.051568008959293365, mean p set: 0.44737857580184937The modified gen p mean: 0.4477894604206085, gen p mean: -0.05195000767707825, mean p set: 0.44826972484588623
loss_pred:0.01891486905515194, decouple_loss:0.001237537246197462
loss_pred:0.01761583238840103, decouple_loss:0.0012560978066176176
2023-04-30 04:39:01 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.058552972972393036, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.052738919854164124, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05376620218157768, mean p set: 0.4500633478164673
loss_pred:0.01871952787041664, decouple_loss:0.0011675490532070398
loss_pred:0.017667852342128754, decouple_loss:0.0011808547424152493
loss_pred:0.01774834655225277, decouple_loss:0.0011265665525570512
WV_0_PC_1_EH_0_PS_40, loss: 0.018103158101439476, avg_mse: 0.025963149964809418
current test mse: 0.025963
Iteration: 251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44858792424201965, gen p mean: -0.05151106417179108, mean p set: 0.44906821846961975
The modified gen p mean: 0.44659125804901123, gen p mean: -0.05684627220034599, mean p set: 0.44707152247428894
The modified gen p mean: 0.4489080309867859, gen p mean: -0.052565064281225204, mean p set: 0.449388325214386
loss_pred:0.017910407856106758, decouple_loss:0.0011435234919190407
loss_pred:0.01821742206811905, decouple_loss:0.0011425403645262122
loss_pred:0.018821969628334045, decouple_loss:0.0011481594992801547
Iteration: 252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483528137207031, gen p mean: -0.0513603575527668, mean p set: 0.44883307814598083
loss_pred:0.01959265023469925, decouple_loss:0.0010598786175251007
The modified gen p mean: 0.4482387900352478, gen p mean: -0.05365115404129028, mean p set: 0.4487190544605255The modified gen p mean: 0.4475116431713104, gen p mean: -0.05506224185228348, mean p set: 0.44799190759658813
loss_pred:0.019325075671076775, decouple_loss:0.0011606434127315879
loss_pred:0.01753166876733303, decouple_loss:0.0010813790140673518
Iteration: 253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462824761867523, gen p mean: -0.056319285184144974, mean p set: 0.4467627704143524
The modified gen p mean: 0.4467674791812897, gen p mean: -0.04964829981327057, mean p set: 0.44724777340888977
The modified gen p mean: 0.44886305928230286, gen p mean: -0.05507485195994377, mean p set: 0.44934335350990295
loss_pred:0.018212195485830307, decouple_loss:0.0010503515368327498
loss_pred:0.017865551635622978, decouple_loss:0.0010609830496832728
loss_pred:0.019490385428071022, decouple_loss:0.0011236232239753008
Iteration: 254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475215971469879, gen p mean: -0.05174998939037323, mean p set: 0.448001891374588
The modified gen p mean: 0.4481840431690216, gen p mean: -0.05044636130332947, mean p set: 0.4486643373966217
The modified gen p mean: 0.44682130217552185, gen p mean: -0.05547770485281944, mean p set: 0.44730156660079956
loss_pred:0.019332561641931534, decouple_loss:0.001072328886948526
loss_pred:0.019504552707076073, decouple_loss:0.0010570382000878453loss_pred:0.01865505799651146, decouple_loss:0.0010438153985887766
Iteration: 255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445794939994812, gen p mean: -0.055478595197200775, mean p set: 0.4462752044200897
The modified gen p mean: 0.4477754533290863, gen p mean: -0.05264171585440636, mean p set: 0.4482557475566864
The modified gen p mean: 0.4469447135925293, gen p mean: -0.04546613618731499, mean p set: 0.4474250078201294
loss_pred:0.018503686413168907, decouple_loss:0.0009918906725943089
loss_pred:0.019041432067751884, decouple_loss:0.0010358807630836964loss_pred:0.018634669482707977, decouple_loss:0.0010373520199209452
Iteration: 256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44614875316619873, gen p mean: -0.05499544367194176, mean p set: 0.44662904739379883
loss_pred:0.018059568479657173, decouple_loss:0.0009975219145417213
The modified gen p mean: 0.44673365354537964, gen p mean: -0.04535326734185219, mean p set: 0.4472139775753021The modified gen p mean: 0.44678714871406555, gen p mean: -0.04815435782074928, mean p set: 0.44726744294166565
loss_pred:0.017760422080755234, decouple_loss:0.0010347140487283468
loss_pred:0.017916616052389145, decouple_loss:0.0010149343870580196
Iteration: 257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460732042789459, gen p mean: -0.04731617495417595, mean p set: 0.446553498506546
loss_pred:0.018035421147942543, decouple_loss:0.0010107887210324407
The modified gen p mean: 0.4462904930114746, gen p mean: -0.05000641942024231, mean p set: 0.4467707574367523The modified gen p mean: 0.44592970609664917, gen p mean: -0.051200997084379196, mean p set: 0.44641000032424927
loss_pred:0.018287718296051025, decouple_loss:0.0009975582361221313
loss_pred:0.01841473951935768, decouple_loss:0.0009926751954481006
Iteration: 258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776710867881775, gen p mean: -0.05055646598339081, mean p set: 0.44824743270874023
The modified gen p mean: 0.44834721088409424, gen p mean: -0.04828919097781181, mean p set: 0.44882747530937195
loss_pred:0.019194336608052254, decouple_loss:0.0009859519777819514
loss_pred:0.018985090777277946, decouple_loss:0.001007639104500413
The modified gen p mean: 0.4468585252761841, gen p mean: -0.050149835646152496, mean p set: 0.4473387897014618
loss_pred:0.01791214570403099, decouple_loss:0.0010121872182935476
Iteration: 259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466864764690399, gen p mean: -0.044231437146663666, mean p set: 0.4471668004989624
loss_pred:0.01869974471628666, decouple_loss:0.001018368056975305
The modified gen p mean: 0.44634953141212463, gen p mean: -0.05147760733962059, mean p set: 0.44682982563972473The modified gen p mean: 0.44714465737342834, gen p mean: -0.0440756231546402, mean p set: 0.44762495160102844
loss_pred:0.017542367801070213, decouple_loss:0.0010422493796795607
loss_pred:0.018300099298357964, decouple_loss:0.0009727167198434472
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
NaN value num: 0
Iteration: 260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503200948238373, gen p mean: -0.043820273131132126, mean p set: 0.45080041885375977
loss_pred:0.01835833676159382, decouple_loss:0.0012405376182869077
The modified gen p mean: 0.44911253452301025, gen p mean: -0.046431854367256165, mean p set: 0.44959282875061035The modified gen p mean: 0.4495428502559662, gen p mean: -0.0421513207256794, mean p set: 0.4500231444835663
loss_pred:0.018118830397725105, decouple_loss:0.0012041670270264149
loss_pred:0.018851475790143013, decouple_loss:0.0011710076360031962
2023-04-30 04:41:31 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05001126229763031, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04577159881591797, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04495694115757942, mean p set: 0.45035696029663086
loss_pred:0.01856863871216774, decouple_loss:0.0011960762785747647
loss_pred:0.01763848215341568, decouple_loss:0.0010859911562874913
loss_pred:0.01752752996981144, decouple_loss:0.001106139738112688
WV_0_PC_1_EH_0_PS_40, loss: 0.01796802133321762, avg_mse: 0.02578376978635788
current test mse: 0.025784
At step 260, Best test: 0.025784
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_model_test_schedule_sampling_DynaMean.ckpt
Iteration: 261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451753169298172, gen p mean: -0.038549937307834625, mean p set: 0.4522334337234497
loss_pred:0.017782583832740784, decouple_loss:0.0011141548166051507
The modified gen p mean: 0.4514252245426178, gen p mean: -0.03812018781900406, mean p set: 0.4519054889678955The modified gen p mean: 0.45118024945259094, gen p mean: -0.04160206764936447, mean p set: 0.45166051387786865
loss_pred:0.017379166558384895, decouple_loss:0.0010777389397844672
loss_pred:0.017163168638944626, decouple_loss:0.0011448853183537722
Iteration: 262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452254056930542, gen p mean: -0.04331277310848236, mean p set: 0.4527343511581421
loss_pred:0.01749679632484913, decouple_loss:0.0011022354010492563
The modified gen p mean: 0.4508156180381775, gen p mean: -0.05130068585276604, mean p set: 0.4512959122657776The modified gen p mean: 0.4496479630470276, gen p mean: -0.03937781602144241, mean p set: 0.4501282274723053
loss_pred:0.018215540796518326, decouple_loss:0.0010888949036598206
loss_pred:0.01666666753590107, decouple_loss:0.0011076482478529215
Iteration: 263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500044584274292, gen p mean: -0.04244793951511383, mean p set: 0.4504847228527069
loss_pred:0.01768370531499386, decouple_loss:0.001078785746358335
The modified gen p mean: 0.4509732723236084, gen p mean: -0.03838799148797989, mean p set: 0.4514535665512085
The modified gen p mean: 0.4516717195510864, gen p mean: -0.03971808776259422, mean p set: 0.4521520435810089
loss_pred:0.01735842414200306, decouple_loss:0.0010818628361448646
loss_pred:0.017522629350423813, decouple_loss:0.0010720957070589066
Iteration: 264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45247066020965576, gen p mean: -0.041466839611530304, mean p set: 0.45295095443725586
loss_pred:0.017054954543709755, decouple_loss:0.001124287024140358
The modified gen p mean: 0.4532754719257355, gen p mean: -0.04163483902812004, mean p set: 0.45375576615333557
The modified gen p mean: 0.4516910910606384, gen p mean: -0.04247176647186279, mean p set: 0.4521713852882385
loss_pred:0.01685604639351368, decouple_loss:0.0010532813612371683
loss_pred:0.016908952966332436, decouple_loss:0.0010995481861755252
Iteration: 265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45269447565078735, gen p mean: -0.039761271327733994, mean p set: 0.45317476987838745
loss_pred:0.01664876565337181, decouple_loss:0.001098523149266839
The modified gen p mean: 0.45258569717407227, gen p mean: -0.038906846195459366, mean p set: 0.45306602120399475
The modified gen p mean: 0.45276182889938354, gen p mean: -0.038081105798482895, mean p set: 0.45324212312698364
loss_pred:0.017573583871126175, decouple_loss:0.0010637413943186402
loss_pred:0.016367260366678238, decouple_loss:0.0010789120569825172
Iteration: 266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501611590385437, gen p mean: -0.030328460037708282, mean p set: 0.4506414532661438
loss_pred:0.017583729699254036, decouple_loss:0.001077429624274373
The modified gen p mean: 0.4524647891521454, gen p mean: -0.03208961710333824, mean p set: 0.45294511318206787The modified gen p mean: 0.4519517719745636, gen p mean: -0.02977738156914711, mean p set: 0.4524320662021637
loss_pred:0.01714511588215828, decouple_loss:0.0009838325204327703
loss_pred:0.01660386472940445, decouple_loss:0.000965480285231024
Iteration: 267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525507092475891, gen p mean: -0.035756222903728485, mean p set: 0.4530309736728668
loss_pred:0.01742560788989067, decouple_loss:0.0011116686509922147
The modified gen p mean: 0.45268043875694275, gen p mean: -0.030788930132985115, mean p set: 0.45316070318222046
The modified gen p mean: 0.4528537690639496, gen p mean: -0.028818443417549133, mean p set: 0.4533340632915497
loss_pred:0.017178548499941826, decouple_loss:0.0010285972384735942
loss_pred:0.017426947131752968, decouple_loss:0.0010014181025326252
Iteration: 268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45263397693634033, gen p mean: -0.03714075684547424, mean p set: 0.45311427116394043
loss_pred:0.016866367310285568, decouple_loss:0.0010785408085212111
The modified gen p mean: 0.4525910019874573, gen p mean: -0.030709078535437584, mean p set: 0.4530712962150574The modified gen p mean: 0.45117950439453125, gen p mean: -0.029848717153072357, mean p set: 0.45165982842445374
loss_pred:0.01698184944689274, decouple_loss:0.0009911381639540195
loss_pred:0.01769477128982544, decouple_loss:0.0010006354423239827
Iteration: 269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535921514034271, gen p mean: -0.039934564381837845, mean p set: 0.4540724456310272
loss_pred:0.01754980906844139, decouple_loss:0.0010587222641333938
The modified gen p mean: 0.4506045877933502, gen p mean: -0.042048510164022446, mean p set: 0.45108485221862793The modified gen p mean: 0.45204970240592957, gen p mean: -0.030094822868704796, mean p set: 0.45252999663352966
loss_pred:0.01724376529455185, decouple_loss:0.0010726668406277895
loss_pred:0.017677411437034607, decouple_loss:0.0009691183804534376
Iteration: 270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500288963317871, gen p mean: -0.035876207053661346, mean p set: 0.4505091905593872
loss_pred:0.01864892803132534, decouple_loss:0.0010646850569173694
The modified gen p mean: 0.45113781094551086, gen p mean: -0.044151198118925095, mean p set: 0.4516180753707886The modified gen p mean: 0.45261350274086, gen p mean: -0.03142819181084633, mean p set: 0.4530937969684601
loss_pred:0.017437176778912544, decouple_loss:0.0011213818797841668
loss_pred:0.017939111217856407, decouple_loss:0.0010558853391557932
2023-04-30 04:43:30 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.0450027771294117, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03942449018359184, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.03990082070231438, mean p set: 0.4500633478164673
loss_pred:0.01919030398130417, decouple_loss:0.0012048782082274556
loss_pred:0.018084976822137833, decouple_loss:0.0011270230170339346
loss_pred:0.01820499077439308, decouple_loss:0.0011641362216323614
WV_0_PC_1_EH_0_PS_40, loss: 0.018551692366600037, avg_mse: 0.026839813217520714
current test mse: 0.02684
Iteration: 271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45232534408569336, gen p mean: -0.04174740985035896, mean p set: 0.45280560851097107
The modified gen p mean: 0.45129069685935974, gen p mean: -0.037598103284835815, mean p set: 0.45177099108695984
The modified gen p mean: 0.4509032368659973, gen p mean: -0.04587485268712044, mean p set: 0.4513835310935974
loss_pred:0.017673291265964508, decouple_loss:0.0010778044816106558
loss_pred:0.017093254253268242, decouple_loss:0.0010150129674002528loss_pred:0.017614416778087616, decouple_loss:0.0009571058908477426
Iteration: 272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515306353569031, gen p mean: -0.042685333639383316, mean p set: 0.4520109295845032
loss_pred:0.017326779663562775, decouple_loss:0.0011475031496956944
The modified gen p mean: 0.44975897669792175, gen p mean: -0.036898210644721985, mean p set: 0.45023927092552185
The modified gen p mean: 0.45394575595855713, gen p mean: -0.035252492874860764, mean p set: 0.4544260501861572
loss_pred:0.01773349940776825, decouple_loss:0.0010744293686002493
loss_pred:0.018265116959810257, decouple_loss:0.0010240182746201754
Iteration: 273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.455077588558197, gen p mean: -0.0383182093501091, mean p set: 0.4555578827857971
The modified gen p mean: 0.45326367020606995, gen p mean: -0.04023315757513046, mean p set: 0.45374393463134766
loss_pred:0.017757868394255638, decouple_loss:0.0010564946569502354
loss_pred:0.016843685880303383, decouple_loss:0.0010745108593255281
The modified gen p mean: 0.4519859254360199, gen p mean: -0.03614189103245735, mean p set: 0.45246621966362
loss_pred:0.017349904403090477, decouple_loss:0.0010471894638612866
Iteration: 274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45206841826438904, gen p mean: -0.03430668264627457, mean p set: 0.45254871249198914
The modified gen p mean: 0.4511440098285675, gen p mean: -0.036779992282390594, mean p set: 0.4516242742538452
The modified gen p mean: 0.45280054211616516, gen p mean: -0.033700741827487946, mean p set: 0.45328083634376526
loss_pred:0.017928918823599815, decouple_loss:0.0009775995276868343
loss_pred:0.017114412039518356, decouple_loss:0.0010291335638612509loss_pred:0.017076503485441208, decouple_loss:0.0009521952597424388
Iteration: 275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508725702762604, gen p mean: -0.03762093558907509, mean p set: 0.4513528347015381
loss_pred:0.01838197372853756, decouple_loss:0.001092011108994484
The modified gen p mean: 0.45212826132774353, gen p mean: -0.04093120992183685, mean p set: 0.45260855555534363The modified gen p mean: 0.44949814677238464, gen p mean: -0.03918557986617088, mean p set: 0.44997847080230713
loss_pred:0.018029721453785896, decouple_loss:0.0010938275372609496
loss_pred:0.01672000251710415, decouple_loss:0.0010877378517761827
Iteration: 276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450425922870636, gen p mean: -0.038773782551288605, mean p set: 0.4509062170982361
loss_pred:0.017986955121159554, decouple_loss:0.0011240997118875384
The modified gen p mean: 0.4516836702823639, gen p mean: -0.03296082094311714, mean p set: 0.4521639347076416The modified gen p mean: 0.4513115882873535, gen p mean: -0.03500344231724739, mean p set: 0.4517918825149536
loss_pred:0.017054568976163864, decouple_loss:0.0010744609171524644
loss_pred:0.017675280570983887, decouple_loss:0.0010875783627852798
Iteration: 277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507342576980591, gen p mean: -0.03808658942580223, mean p set: 0.4512145519256592
loss_pred:0.017909061163663864, decouple_loss:0.001347775454632938
The modified gen p mean: 0.4511748254299164, gen p mean: -0.03914539888501167, mean p set: 0.4516550898551941The modified gen p mean: 0.44926100969314575, gen p mean: -0.041455987840890884, mean p set: 0.44974127411842346
loss_pred:0.017661143094301224, decouple_loss:0.0013126814737915993
loss_pred:0.01742119900882244, decouple_loss:0.0013722212752327323
Iteration: 278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45100846886634827, gen p mean: -0.03918091580271721, mean p set: 0.45148876309394836
loss_pred:0.017838655039668083, decouple_loss:0.0016323210438713431
The modified gen p mean: 0.4520549774169922, gen p mean: -0.042114876210689545, mean p set: 0.4525352716445923The modified gen p mean: 0.45209187269210815, gen p mean: -0.04253407195210457, mean p set: 0.45257216691970825
loss_pred:0.01816205494105816, decouple_loss:0.0017004624241963029
loss_pred:0.017306244000792503, decouple_loss:0.0018857157556340098
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
NaN value num: 0
Iteration: 279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45141032338142395, gen p mean: -0.0486077181994915, mean p set: 0.45189061760902405
loss_pred:0.0176270492374897, decouple_loss:0.0015954357804730535
The modified gen p mean: 0.4523903429508209, gen p mean: -0.04796913266181946, mean p set: 0.452870637178421The modified gen p mean: 0.4534645974636078, gen p mean: -0.04641716554760933, mean p set: 0.4539449214935303
loss_pred:0.017527995631098747, decouple_loss:0.0015032959636300802
loss_pred:0.01853686198592186, decouple_loss:0.0015171115519478917
Iteration: 280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45077621936798096, gen p mean: -0.04689003527164459, mean p set: 0.45125651359558105
The modified gen p mean: 0.4538275897502899, gen p mean: -0.043277446180582047, mean p set: 0.4543078541755676
loss_pred:0.017267543822526932, decouple_loss:0.001979039516299963
loss_pred:0.017894579097628593, decouple_loss:0.0018014450324699283
The modified gen p mean: 0.4529622793197632, gen p mean: -0.045036010444164276, mean p set: 0.4534425735473633
loss_pred:0.017874684184789658, decouple_loss:0.0019170823507010937
2023-04-30 04:46:02 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05288948118686676, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.048325762152671814, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.048946693539619446, mean p set: 0.4500633478164673
loss_pred:0.01918831467628479, decouple_loss:0.0021186196245253086
loss_pred:0.018072161823511124, decouple_loss:0.0022148843854665756
loss_pred:0.01822170615196228, decouple_loss:0.002157057635486126
WV_0_PC_1_EH_0_PS_40, loss: 0.018602237105369568, avg_mse: 0.026631170883774757
current test mse: 0.026631
Iteration: 281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45203670859336853, gen p mean: -0.03835294023156166, mean p set: 0.452517032623291
The modified gen p mean: 0.4525321125984192, gen p mean: -0.054352566599845886, mean p set: 0.4530124366283417
The modified gen p mean: 0.45203450322151184, gen p mean: -0.048859063535928726, mean p set: 0.45251479744911194
loss_pred:0.01787305809557438, decouple_loss:0.0020433454774320126
loss_pred:0.01772846281528473, decouple_loss:0.001985808601602912
loss_pred:0.0176633782684803, decouple_loss:0.0021622376516461372
Iteration: 282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527053236961365, gen p mean: -0.05154244601726532, mean p set: 0.4531856179237366
loss_pred:0.017552750185132027, decouple_loss:0.0016302751610055566
The modified gen p mean: 0.45029470324516296, gen p mean: -0.04915199056267738, mean p set: 0.45077502727508545The modified gen p mean: 0.4527682662010193, gen p mean: -0.047312960028648376, mean p set: 0.4532485604286194
loss_pred:0.018602648749947548, decouple_loss:0.0015382206765934825
loss_pred:0.018590062856674194, decouple_loss:0.0014922781847417355
Iteration: 283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45258426666259766, gen p mean: -0.044605664908885956, mean p set: 0.45306456089019775
The modified gen p mean: 0.45303037762641907, gen p mean: -0.04013305529952049, mean p set: 0.45351067185401917
loss_pred:0.017764655873179436, decouple_loss:0.0019440262112766504
loss_pred:0.01774265617132187, decouple_loss:0.0017543142894282937
The modified gen p mean: 0.4520688056945801, gen p mean: -0.04202359542250633, mean p set: 0.45254912972450256
loss_pred:0.017511285841464996, decouple_loss:0.0018767723813652992
Iteration: 284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500974416732788, gen p mean: -0.0455925315618515, mean p set: 0.4505777657032013
The modified gen p mean: 0.4513205289840698, gen p mean: -0.044058091938495636, mean p set: 0.4518008232116699
loss_pred:0.01798793114721775, decouple_loss:0.0015363309066742659
loss_pred:0.01775107905268669, decouple_loss:0.0016358402790501714
The modified gen p mean: 0.45305898785591125, gen p mean: -0.04474987834692001, mean p set: 0.45353925228118896
loss_pred:0.0174749493598938, decouple_loss:0.0017694386187940836
Iteration: 285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509139657020569, gen p mean: -0.03931823745369911, mean p set: 0.451394259929657
The modified gen p mean: 0.45286643505096436, gen p mean: -0.04204254969954491, mean p set: 0.45334672927856445
loss_pred:0.01775791123509407, decouple_loss:0.0014661275781691074
loss_pred:0.018064236268401146, decouple_loss:0.001497509889304638
The modified gen p mean: 0.45246604084968567, gen p mean: -0.03186582028865814, mean p set: 0.45294633507728577
loss_pred:0.017931373789906502, decouple_loss:0.001454781275242567
Iteration: 286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521520137786865, gen p mean: -0.04225616157054901, mean p set: 0.4526323080062866
loss_pred:0.01792065240442753, decouple_loss:0.0015308577567338943
The modified gen p mean: 0.4508713483810425, gen p mean: -0.04723437502980232, mean p set: 0.4513516426086426The modified gen p mean: 0.44957488775253296, gen p mean: -0.04733516648411751, mean p set: 0.45005518198013306
loss_pred:0.017811033874750137, decouple_loss:0.001416898099705577
loss_pred:0.01772560551762581, decouple_loss:0.0014684619382023811
Iteration: 287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45132339000701904, gen p mean: -0.04454496502876282, mean p set: 0.45180368423461914
loss_pred:0.017240118235349655, decouple_loss:0.0014304178766906261
The modified gen p mean: 0.4525904357433319, gen p mean: -0.053652361035346985, mean p set: 0.453070729970932The modified gen p mean: 0.4548882842063904, gen p mean: -0.045583575963974, mean p set: 0.45536860823631287
loss_pred:0.017110925167798996, decouple_loss:0.0014013584004715085
loss_pred:0.01734074391424656, decouple_loss:0.0014658430591225624
Iteration: 288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45280522108078003, gen p mean: -0.0495155043900013, mean p set: 0.45328548550605774
loss_pred:0.017578205093741417, decouple_loss:0.0014110542833805084
The modified gen p mean: 0.4493550658226013, gen p mean: -0.04903949424624443, mean p set: 0.4498353600502014The modified gen p mean: 0.4523267447948456, gen p mean: -0.04660018905997276, mean p set: 0.4528070092201233
loss_pred:0.018138810992240906, decouple_loss:0.001283143414184451
loss_pred:0.017565935850143433, decouple_loss:0.0013151057064533234
Iteration: 289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45037293434143066, gen p mean: -0.05178075656294823, mean p set: 0.45085322856903076
loss_pred:0.018383633345365524, decouple_loss:0.001307257916778326
The modified gen p mean: 0.4509826600551605, gen p mean: -0.0448385588824749, mean p set: 0.4514629542827606The modified gen p mean: 0.45025011897087097, gen p mean: -0.05130382254719734, mean p set: 0.45073044300079346
loss_pred:0.017409566789865494, decouple_loss:0.001284585683606565
loss_pred:0.01769273914396763, decouple_loss:0.001313558081164956
Iteration: 290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451680064201355, gen p mean: -0.05085855349898338, mean p set: 0.4521603584289551
loss_pred:0.017487745732069016, decouple_loss:0.0012948771473020315
The modified gen p mean: 0.451323926448822, gen p mean: -0.045661561191082, mean p set: 0.4518042206764221The modified gen p mean: 0.4524965286254883, gen p mean: -0.045176610350608826, mean p set: 0.452976793050766
loss_pred:0.017767423763871193, decouple_loss:0.0013162198010832071
loss_pred:0.017149752005934715, decouple_loss:0.00131751608569175
2023-04-30 04:47:56 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05548867583274841, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0501205250620842, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.050454072654247284, mean p set: 0.4500633478164673
loss_pred:0.01887376233935356, decouple_loss:0.001321994001045823
loss_pred:0.017806526273489, decouple_loss:0.0013187866425141692
loss_pred:0.01791396737098694, decouple_loss:0.0012955233687534928
WV_0_PC_1_EH_0_PS_40, loss: 0.018263690173625946, avg_mse: 0.026180651038885117
current test mse: 0.026181
Iteration: 291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507061839103699, gen p mean: -0.05440392345190048, mean p set: 0.4511864483356476
The modified gen p mean: 0.45311006903648376, gen p mean: -0.05195973068475723, mean p set: 0.45359036326408386
The modified gen p mean: 0.4539056420326233, gen p mean: -0.05296530947089195, mean p set: 0.4543859660625458
loss_pred:0.01696862280368805, decouple_loss:0.0012279547518119216
loss_pred:0.018207071349024773, decouple_loss:0.0012302061077207327
loss_pred:0.018355315551161766, decouple_loss:0.0012918275315314531
Iteration: 292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45473605394363403, gen p mean: -0.04736419394612312, mean p set: 0.4552163779735565
loss_pred:0.017839858308434486, decouple_loss:0.001331755076535046
The modified gen p mean: 0.4524695873260498, gen p mean: -0.05936610326170921, mean p set: 0.4529498815536499The modified gen p mean: 0.45142698287963867, gen p mean: -0.048934370279312134, mean p set: 0.45190730690956116
loss_pred:0.017477478832006454, decouple_loss:0.0013656215742230415
loss_pred:0.016622330993413925, decouple_loss:0.0014526735758408904
Iteration: 293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45109182596206665, gen p mean: -0.04539113864302635, mean p set: 0.45157214999198914
The modified gen p mean: 0.452595055103302, gen p mean: -0.045763049274683, mean p set: 0.4530753493309021
loss_pred:0.017835989594459534, decouple_loss:0.0012899949215352535
loss_pred:0.017528308555483818, decouple_loss:0.0012426077155396342
The modified gen p mean: 0.45163533091545105, gen p mean: -0.04482869431376457, mean p set: 0.45211559534072876
loss_pred:0.01751980371773243, decouple_loss:0.0012994268909096718
Iteration: 294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45129314064979553, gen p mean: -0.05085042491555214, mean p set: 0.451773464679718
The modified gen p mean: 0.44968923926353455, gen p mean: -0.04844851419329643, mean p set: 0.45016953349113464
loss_pred:0.01773427426815033, decouple_loss:0.0012410774361342192
loss_pred:0.017453331500291824, decouple_loss:0.0011937603121623397
The modified gen p mean: 0.45100727677345276, gen p mean: -0.050902120769023895, mean p set: 0.45148760080337524
loss_pred:0.01749589666724205, decouple_loss:0.0012663510860875249
Iteration: 295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45300841331481934, gen p mean: -0.04115195572376251, mean p set: 0.45348870754241943
The modified gen p mean: 0.45218992233276367, gen p mean: -0.03373994678258896, mean p set: 0.45267021656036377
The modified gen p mean: 0.45283243060112, gen p mean: -0.03719437122344971, mean p set: 0.4533127248287201
loss_pred:0.017251567915081978, decouple_loss:0.0014418282080441713
loss_pred:0.01734013482928276, decouple_loss:0.001297767972573638
loss_pred:0.01756463013589382, decouple_loss:0.0013070062268525362
Iteration: 296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45167723298072815, gen p mean: -0.04099726304411888, mean p set: 0.45215752720832825
The modified gen p mean: 0.45154979825019836, gen p mean: -0.041537389159202576, mean p set: 0.45203009247779846
loss_pred:0.017579833045601845, decouple_loss:0.0012698250357061625
loss_pred:0.017062604427337646, decouple_loss:0.0012754170456901193
The modified gen p mean: 0.4518226385116577, gen p mean: -0.04260630160570145, mean p set: 0.4523029327392578
loss_pred:0.017410021275281906, decouple_loss:0.0013754620449617505
Iteration: 297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524969756603241, gen p mean: -0.03894851356744766, mean p set: 0.4529772400856018
The modified gen p mean: 0.45221641659736633, gen p mean: -0.041000913828611374, mean p set: 0.45269668102264404
loss_pred:0.017232660204172134, decouple_loss:0.0011856146156787872
loss_pred:0.01732494868338108, decouple_loss:0.001153963035903871
The modified gen p mean: 0.45238539576530457, gen p mean: -0.035387445241212845, mean p set: 0.4528656601905823
loss_pred:0.01730825938284397, decouple_loss:0.0011434050975367427
Iteration: 298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45179104804992676, gen p mean: -0.03785425052046776, mean p set: 0.45227131247520447
loss_pred:0.017086394131183624, decouple_loss:0.001304352656006813
The modified gen p mean: 0.4508593678474426, gen p mean: -0.039542023092508316, mean p set: 0.45133963227272034The modified gen p mean: 0.45566442608833313, gen p mean: -0.037914808839559555, mean p set: 0.45614469051361084
loss_pred:0.017382320016622543, decouple_loss:0.001276754424907267
loss_pred:0.017053313553333282, decouple_loss:0.0012299510417506099
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44880369305610657, gen p mean: -0.03992864862084389, mean p set: 0.44928398728370667
loss_pred:0.016158709302544594, decouple_loss:0.0013249146286398172
The modified gen p mean: 0.4475157856941223, gen p mean: -0.03970605507493019, mean p set: 0.4479960799217224The modified gen p mean: 0.4481903612613678, gen p mean: -0.04343501478433609, mean p set: 0.4486706554889679
loss_pred:0.016031941398978233, decouple_loss:0.0012741718674078584
loss_pred:0.015025123953819275, decouple_loss:0.0013210686156526208
Iteration: 300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798144698143005, gen p mean: -0.04046832025051117, mean p set: 0.44846177101135254
The modified gen p mean: 0.44778382778167725, gen p mean: -0.04060619696974754, mean p set: 0.44826412200927734
loss_pred:0.015447317622601986, decouple_loss:0.0013991447631269693
loss_pred:0.01544740330427885, decouple_loss:0.0014106497401371598
The modified gen p mean: 0.4479498863220215, gen p mean: -0.03906097635626793, mean p set: 0.44843021035194397
loss_pred:0.015562601387500763, decouple_loss:0.001349330646917224
2023-04-30 04:50:27 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04821795970201492, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04305436462163925, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.042653996497392654, mean p set: 0.4500633478164673
loss_pred:0.018861789256334305, decouple_loss:0.001228397130034864
loss_pred:0.017805783078074455, decouple_loss:0.0012277917703613639
loss_pred:0.0178273506462574, decouple_loss:0.001226799446158111
WV_0_PC_1_EH_0_PS_40, loss: 0.01822635903954506, avg_mse: 0.02618711069226265
current test mse: 0.026187
Iteration: 301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741690158843994, gen p mean: -0.044326234608888626, mean p set: 0.44789719581604004
The modified gen p mean: 0.4480687975883484, gen p mean: -0.04456586763262749, mean p set: 0.4485490918159485
The modified gen p mean: 0.4478335976600647, gen p mean: -0.044460542500019073, mean p set: 0.4483139216899872
loss_pred:0.015271305106580257, decouple_loss:0.0011921649565920234
loss_pred:0.015249715186655521, decouple_loss:0.0011800510110333562
loss_pred:0.016248352825641632, decouple_loss:0.0011810514843091369
Iteration: 302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795531034469604, gen p mean: -0.04888712987303734, mean p set: 0.44843557476997375
loss_pred:0.015029171481728554, decouple_loss:0.001308154547587037
The modified gen p mean: 0.448762446641922, gen p mean: -0.04462221637368202, mean p set: 0.4492427408695221The modified gen p mean: 0.44811344146728516, gen p mean: -0.045209288597106934, mean p set: 0.44859370589256287
loss_pred:0.015177481807768345, decouple_loss:0.0013759996509179473
loss_pred:0.015082835219800472, decouple_loss:0.001351426588371396
Iteration: 303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799748063087463, gen p mean: -0.05267607793211937, mean p set: 0.44847777485847473
loss_pred:0.014661496505141258, decouple_loss:0.0012911263620480895
The modified gen p mean: 0.44841691851615906, gen p mean: -0.04513543099164963, mean p set: 0.44889721274375916
The modified gen p mean: 0.4491630792617798, gen p mean: -0.0471445731818676, mean p set: 0.4496433436870575
loss_pred:0.014943347312510014, decouple_loss:0.0012588759418576956
loss_pred:0.014339014887809753, decouple_loss:0.0013048449764028192
Iteration: 304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751855731010437, gen p mean: -0.04834649711847305, mean p set: 0.44799885153770447
loss_pred:0.014297081157565117, decouple_loss:0.0012544735800474882
The modified gen p mean: 0.44868525862693787, gen p mean: -0.045806240290403366, mean p set: 0.4491655230522156The modified gen p mean: 0.44749870896339417, gen p mean: -0.04813380166888237, mean p set: 0.44797900319099426
loss_pred:0.014557093381881714, decouple_loss:0.001287034247070551
loss_pred:0.014849434606730938, decouple_loss:0.0012882682494819164
Iteration: 305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728925824165344, gen p mean: -0.05093615874648094, mean p set: 0.44776955246925354
loss_pred:0.01435015071183443, decouple_loss:0.0013124799588695168
The modified gen p mean: 0.4475390315055847, gen p mean: -0.046414025127887726, mean p set: 0.4480193257331848The modified gen p mean: 0.4477713406085968, gen p mean: -0.0491284616291523, mean p set: 0.4482516348361969
loss_pred:0.014693506062030792, decouple_loss:0.0013779165456071496
loss_pred:0.01449156180024147, decouple_loss:0.001285129226744175
Iteration: 306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790560007095337, gen p mean: -0.04464728757739067, mean p set: 0.44838589429855347
The modified gen p mean: 0.448133647441864, gen p mean: -0.04876011237502098, mean p set: 0.4486139416694641
loss_pred:0.014392630197107792, decouple_loss:0.0014342456124722958
loss_pred:0.014009599573910236, decouple_loss:0.0013601856771856546
The modified gen p mean: 0.4478616714477539, gen p mean: -0.04788905382156372, mean p set: 0.448341965675354
loss_pred:0.014367181807756424, decouple_loss:0.0013784215552732348
Iteration: 307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44754910469055176, gen p mean: -0.050720538944005966, mean p set: 0.44802939891815186
loss_pred:0.014185163192451, decouple_loss:0.0013210318284109235
The modified gen p mean: 0.4478529691696167, gen p mean: -0.04452402517199516, mean p set: 0.4483332633972168The modified gen p mean: 0.44878125190734863, gen p mean: -0.05086876451969147, mean p set: 0.44926151633262634
loss_pred:0.014071699231863022, decouple_loss:0.0012798922834917903
loss_pred:0.013785368762910366, decouple_loss:0.0014020268572494388
Iteration: 308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799932837486267, gen p mean: -0.04807812348008156, mean p set: 0.44847962260246277
The modified gen p mean: 0.447795033454895, gen p mean: -0.049972567707300186, mean p set: 0.4482753276824951
loss_pred:0.014670515432953835, decouple_loss:0.0014149061171337962
loss_pred:0.01446930319070816, decouple_loss:0.0015112851979210973
The modified gen p mean: 0.44806358218193054, gen p mean: -0.04549575597047806, mean p set: 0.44854387640953064
loss_pred:0.014226234517991543, decouple_loss:0.0014617025153711438
Iteration: 309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477216899394989, gen p mean: -0.04749458655714989, mean p set: 0.448201984167099
The modified gen p mean: 0.4481160640716553, gen p mean: -0.05002574622631073, mean p set: 0.44859638810157776
loss_pred:0.013363644480705261, decouple_loss:0.0015042403247207403
loss_pred:0.014399699866771698, decouple_loss:0.0013224034337326884
The modified gen p mean: 0.44719934463500977, gen p mean: -0.049869537353515625, mean p set: 0.4476796090602875
loss_pred:0.014011825434863567, decouple_loss:0.0014547101454809308
Iteration: 310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773542881011963, gen p mean: -0.05006128549575806, mean p set: 0.4482157230377197
The modified gen p mean: 0.44811734557151794, gen p mean: -0.047146983444690704, mean p set: 0.44859760999679565
The modified gen p mean: 0.44780224561691284, gen p mean: -0.04842444136738777, mean p set: 0.44828253984451294loss_pred:0.013492432422935963, decouple_loss:0.0014257191214710474
loss_pred:0.014580197632312775, decouple_loss:0.001413854886777699
loss_pred:0.013808279298245907, decouple_loss:0.0013986543053761125
2023-04-30 04:52:20 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04984459653496742, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04451512545347214, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.044916801154613495, mean p set: 0.4500633478164673
loss_pred:0.019562872126698494, decouple_loss:0.0014270502142608166
loss_pred:0.018432708457112312, decouple_loss:0.0014184305910021067
loss_pred:0.018556809052824974, decouple_loss:0.0014316746965050697
WV_0_PC_1_EH_0_PS_40, loss: 0.01892208307981491, avg_mse: 0.02754388004541397
current test mse: 0.027544
Iteration: 311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806525111198425, gen p mean: -0.04744289815425873, mean p set: 0.44854554533958435
The modified gen p mean: 0.44788506627082825, gen p mean: -0.04880190268158913, mean p set: 0.44836533069610596The modified gen p mean: 0.44771313667297363, gen p mean: -0.04912405088543892, mean p set: 0.44819343090057373
loss_pred:0.013812064193189144, decouple_loss:0.0014434834010899067
loss_pred:0.012999285012483597, decouple_loss:0.0013390282401815057
loss_pred:0.013916709460318089, decouple_loss:0.0013495407765731215
Iteration: 312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475034475326538, gen p mean: -0.05142034590244293, mean p set: 0.4479837417602539
loss_pred:0.013944833539426327, decouple_loss:0.0013661920092999935
The modified gen p mean: 0.44791802763938904, gen p mean: -0.046599309891462326, mean p set: 0.44839832186698914The modified gen p mean: 0.44844841957092285, gen p mean: -0.04690323397517204, mean p set: 0.44892874360084534
loss_pred:0.01331755518913269, decouple_loss:0.001443672925233841
loss_pred:0.013820718042552471, decouple_loss:0.0013689246261492372
Iteration: 313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483509063720703, gen p mean: -0.04776346683502197, mean p set: 0.4488312005996704
The modified gen p mean: 0.4482947587966919, gen p mean: -0.0486932098865509, mean p set: 0.448775053024292
loss_pred:0.013097655028104782, decouple_loss:0.0013687529135495424
loss_pred:0.01435240637511015, decouple_loss:0.0013226901646703482
The modified gen p mean: 0.4474197030067444, gen p mean: -0.048415668308734894, mean p set: 0.4478999972343445
loss_pred:0.013682659715414047, decouple_loss:0.0014310493133962154
Iteration: 314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484274089336395, gen p mean: -0.05067441985011101, mean p set: 0.4489077031612396
The modified gen p mean: 0.4483286142349243, gen p mean: -0.0449235774576664, mean p set: 0.4488089084625244
loss_pred:0.012997807003557682, decouple_loss:0.0013497871113941073
loss_pred:0.013942164368927479, decouple_loss:0.0014325621305033565
The modified gen p mean: 0.448001891374588, gen p mean: -0.044882725924253464, mean p set: 0.4484822154045105
loss_pred:0.013589185662567616, decouple_loss:0.0012918474385514855
Iteration: 315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476151466369629, gen p mean: -0.04859280586242676, mean p set: 0.448095440864563
The modified gen p mean: 0.4482262134552002, gen p mean: -0.04234937205910683, mean p set: 0.4487065374851227
loss_pred:0.012918316759169102, decouple_loss:0.001320920535363257
loss_pred:0.013534714467823505, decouple_loss:0.001357173197902739
The modified gen p mean: 0.44780269265174866, gen p mean: -0.04679657891392708, mean p set: 0.44828298687934875
loss_pred:0.013787752948701382, decouple_loss:0.00131911039352417
Iteration: 316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44787734746932983, gen p mean: -0.04521036520600319, mean p set: 0.4483576714992523
loss_pred:0.013795156031847, decouple_loss:0.0013607615837827325
The modified gen p mean: 0.4476363956928253, gen p mean: -0.04431384056806564, mean p set: 0.4481166899204254The modified gen p mean: 0.4481147229671478, gen p mean: -0.04692654684185982, mean p set: 0.4485950171947479
loss_pred:0.013880484737455845, decouple_loss:0.0013844433706253767
loss_pred:0.013749860227108002, decouple_loss:0.0013424881035462022
Iteration: 317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771623611450195, gen p mean: -0.04473200440406799, mean p set: 0.44819650053977966
loss_pred:0.012911537662148476, decouple_loss:0.0012839731061831117
The modified gen p mean: 0.44744616746902466, gen p mean: -0.044578298926353455, mean p set: 0.44792643189430237The modified gen p mean: 0.448560506105423, gen p mean: -0.04345959052443504, mean p set: 0.44904080033302307
loss_pred:0.01358231995254755, decouple_loss:0.0011965596349909902
loss_pred:0.012724513188004494, decouple_loss:0.0013014853466302156
Iteration: 318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479043781757355, gen p mean: -0.04547175392508507, mean p set: 0.44838467240333557
loss_pred:0.012945801019668579, decouple_loss:0.0012607852695509791
The modified gen p mean: 0.44762691855430603, gen p mean: -0.047463931143283844, mean p set: 0.44810721278190613The modified gen p mean: 0.4472784698009491, gen p mean: -0.04564109072089195, mean p set: 0.4477587640285492
loss_pred:0.013038299046456814, decouple_loss:0.0012328608427196741
loss_pred:0.013203530572354794, decouple_loss:0.0012591941049322486
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478108584880829, gen p mean: -0.0432690791785717, mean p set: 0.44829118251800537
loss_pred:0.01323425117880106, decouple_loss:0.0012087817303836346
The modified gen p mean: 0.44724732637405396, gen p mean: -0.04536397382616997, mean p set: 0.44772762060165405The modified gen p mean: 0.4459841251373291, gen p mean: -0.043315961956977844, mean p set: 0.4464643895626068
loss_pred:0.013486957177519798, decouple_loss:0.0012743547558784485
loss_pred:0.012908208183944225, decouple_loss:0.0012320766691118479
Iteration: 320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44676217436790466, gen p mean: -0.04334716126322746, mean p set: 0.44724246859550476
loss_pred:0.013065320439636707, decouple_loss:0.0011974836234003305
The modified gen p mean: 0.4471054971218109, gen p mean: -0.04468477889895439, mean p set: 0.447585791349411The modified gen p mean: 0.4470162093639374, gen p mean: -0.043834660202264786, mean p set: 0.4474965035915375
loss_pred:0.01304557267576456, decouple_loss:0.0011460368987172842
loss_pred:0.013525101356208324, decouple_loss:0.0011720315087586641
2023-04-30 04:54:57 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.046486787497997284, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04150160029530525, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04202578216791153, mean p set: 0.4500633478164673
loss_pred:0.019423440098762512, decouple_loss:0.0012858627596870065
loss_pred:0.018285728991031647, decouple_loss:0.0013394654961302876
loss_pred:0.01838776282966137, decouple_loss:0.0013576967176049948
WV_0_PC_1_EH_0_PS_40, loss: 0.018765360116958618, avg_mse: 0.02735001966357231
current test mse: 0.02735
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460422694683075, gen p mean: -0.04251872003078461, mean p set: 0.4465225338935852
The modified gen p mean: 0.4471959173679352, gen p mean: -0.04535289853811264, mean p set: 0.4476762115955353
The modified gen p mean: 0.4480898678302765, gen p mean: -0.04694593697786331, mean p set: 0.448570191860199
loss_pred:0.013459921814501286, decouple_loss:0.0012350165052339435
loss_pred:0.013333212584257126, decouple_loss:0.0013390687527135015loss_pred:0.013013342395424843, decouple_loss:0.0012634448939934373
Iteration: 322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44603610038757324, gen p mean: -0.046406105160713196, mean p set: 0.44651639461517334
loss_pred:0.013264458626508713, decouple_loss:0.0012025445466861129
The modified gen p mean: 0.44785258173942566, gen p mean: -0.049360767006874084, mean p set: 0.44833290576934814The modified gen p mean: 0.4470779299736023, gen p mean: -0.0508645623922348, mean p set: 0.4475582242012024
loss_pred:0.012703023850917816, decouple_loss:0.00121889088768512
loss_pred:0.01325272861868143, decouple_loss:0.0011679771123453975
Iteration: 323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808536767959595, gen p mean: -0.04615726321935654, mean p set: 0.44856566190719604
The modified gen p mean: 0.44708243012428284, gen p mean: -0.048121508210897446, mean p set: 0.4475627839565277
loss_pred:0.012761706486344337, decouple_loss:0.0012755063362419605
loss_pred:0.01232523936778307, decouple_loss:0.0011498468229547143
The modified gen p mean: 0.4460238814353943, gen p mean: -0.0481807217001915, mean p set: 0.446504145860672
loss_pred:0.013103341683745384, decouple_loss:0.0012094056000933051
Iteration: 324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44644370675086975, gen p mean: -0.04728228971362114, mean p set: 0.44692397117614746
loss_pred:0.013195708394050598, decouple_loss:0.0011525523150339723
The modified gen p mean: 0.4460639953613281, gen p mean: -0.044783443212509155, mean p set: 0.4465442895889282The modified gen p mean: 0.44676199555397034, gen p mean: -0.0488889105618, mean p set: 0.44724223017692566
loss_pred:0.013133400119841099, decouple_loss:0.001178041915409267
loss_pred:0.013060837052762508, decouple_loss:0.001128983567468822
Iteration: 325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478234350681305, gen p mean: -0.0478070005774498, mean p set: 0.4483036994934082
The modified gen p mean: 0.44709211587905884, gen p mean: -0.04913727566599846, mean p set: 0.4475724399089813
loss_pred:0.012576003558933735, decouple_loss:0.0011208802461624146
loss_pred:0.012802083045244217, decouple_loss:0.001098134322091937
The modified gen p mean: 0.4473578929901123, gen p mean: -0.05047077685594559, mean p set: 0.4478381872177124
loss_pred:0.012978345155715942, decouple_loss:0.001119653694331646
Iteration: 326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44683948159217834, gen p mean: -0.051132652908563614, mean p set: 0.44731974601745605
The modified gen p mean: 0.4469614624977112, gen p mean: -0.048486072570085526, mean p set: 0.4474417567253113
loss_pred:0.012788079679012299, decouple_loss:0.0011130387429147959
loss_pred:0.01297501940280199, decouple_loss:0.0011928427265956998
The modified gen p mean: 0.4469716250896454, gen p mean: -0.04838090017437935, mean p set: 0.4474518895149231
loss_pred:0.013024948537349701, decouple_loss:0.0012443517334759235
Iteration: 327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475112557411194, gen p mean: -0.04710887745022774, mean p set: 0.4479915201663971
The modified gen p mean: 0.44882553815841675, gen p mean: -0.05435562506318092, mean p set: 0.44930580258369446
loss_pred:0.012701568193733692, decouple_loss:0.0011848517460748553
The modified gen p mean: 0.4471133053302765, gen p mean: -0.050856225192546844, mean p set: 0.447593629360199
loss_pred:0.012706536799669266, decouple_loss:0.0012719400692731142
loss_pred:0.012955513782799244, decouple_loss:0.001181329134851694
Iteration: 328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461408257484436, gen p mean: -0.04523364454507828, mean p set: 0.4466211497783661
The modified gen p mean: 0.44735151529312134, gen p mean: -0.0490388385951519, mean p set: 0.44783177971839905
The modified gen p mean: 0.4458525478839874, gen p mean: -0.04972660169005394, mean p set: 0.4463328719139099
loss_pred:0.012946158647537231, decouple_loss:0.001161211752332747
loss_pred:0.013311020098626614, decouple_loss:0.0011081609409302473loss_pred:0.012938326224684715, decouple_loss:0.0011234573321416974
Iteration: 329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758936762809753, gen p mean: -0.04782312735915184, mean p set: 0.44806966185569763
The modified gen p mean: 0.4461709260940552, gen p mean: -0.04392332211136818, mean p set: 0.4466512203216553
loss_pred:0.012860178016126156, decouple_loss:0.001155009726062417
loss_pred:0.013375946320593357, decouple_loss:0.001137922634370625
The modified gen p mean: 0.4476472735404968, gen p mean: -0.04624253511428833, mean p set: 0.4481275677680969
loss_pred:0.012960693798959255, decouple_loss:0.0010922827059403062
Iteration: 330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471782445907593, gen p mean: -0.04786396771669388, mean p set: 0.4476585388183594
loss_pred:0.01287360955029726, decouple_loss:0.0011748360702767968
The modified gen p mean: 0.4467034637928009, gen p mean: -0.04531124606728554, mean p set: 0.4471836984157562The modified gen p mean: 0.44670695066452026, gen p mean: -0.04491283372044563, mean p set: 0.44718724489212036
loss_pred:0.013082078658044338, decouple_loss:0.001144695794209838
loss_pred:0.013150417245924473, decouple_loss:0.0011272344272583723
2023-04-30 04:56:51 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04707910865545273, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04233003407716751, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04287215322256088, mean p set: 0.4500633478164673
loss_pred:0.019396957010030746, decouple_loss:0.001264578546397388
loss_pred:0.01833609864115715, decouple_loss:0.0012770368484780192
loss_pred:0.018413463607430458, decouple_loss:0.0012868760386481881
WV_0_PC_1_EH_0_PS_40, loss: 0.018779315054416656, avg_mse: 0.02742924727499485
current test mse: 0.027429
Iteration: 331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470537006855011, gen p mean: -0.04533294960856438, mean p set: 0.4475339949131012
The modified gen p mean: 0.44625112414360046, gen p mean: -0.042831674218177795, mean p set: 0.44673141837120056
The modified gen p mean: 0.4469868242740631, gen p mean: -0.046425819396972656, mean p set: 0.4474670886993408
loss_pred:0.012738126330077648, decouple_loss:0.0011726338416337967
loss_pred:0.013005108572542667, decouple_loss:0.0012443820014595985
loss_pred:0.013442844152450562, decouple_loss:0.0011188253993168473
Iteration: 332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468006491661072, gen p mean: -0.04454057663679123, mean p set: 0.4472809433937073
loss_pred:0.01306824292987585, decouple_loss:0.0011163800954818726
The modified gen p mean: 0.44771745800971985, gen p mean: -0.04507588595151901, mean p set: 0.44819772243499756The modified gen p mean: 0.44653886556625366, gen p mean: -0.04349642992019653, mean p set: 0.44701918959617615
loss_pred:0.01302433107048273, decouple_loss:0.0011504222638905048
loss_pred:0.013490727171301842, decouple_loss:0.0010695733362808824
Iteration: 333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465855360031128, gen p mean: -0.0451786108314991, mean p set: 0.4470658302307129
The modified gen p mean: 0.4468885660171509, gen p mean: -0.04236651957035065, mean p set: 0.447368860244751
loss_pred:0.01307224202901125, decouple_loss:0.0010770144872367382
loss_pred:0.013152837753295898, decouple_loss:0.0010966737754642963
The modified gen p mean: 0.44687071442604065, gen p mean: -0.04471026360988617, mean p set: 0.44735097885131836
loss_pred:0.012613312341272831, decouple_loss:0.0010768502252176404
Iteration: 334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686564803123474, gen p mean: -0.042189352214336395, mean p set: 0.4473459720611572
The modified gen p mean: 0.4469093978404999, gen p mean: -0.04500194266438484, mean p set: 0.44738972187042236
loss_pred:0.012915682047605515, decouple_loss:0.001282748649828136
loss_pred:0.013086061924695969, decouple_loss:0.0011193209793418646
The modified gen p mean: 0.44609978795051575, gen p mean: -0.03966502472758293, mean p set: 0.44658011198043823
loss_pred:0.01307558175176382, decouple_loss:0.0011154081439599395
Iteration: 335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469147026538849, gen p mean: -0.044071048498153687, mean p set: 0.447394996881485
loss_pred:0.01286773569881916, decouple_loss:0.0010268701007589698
The modified gen p mean: 0.4473232924938202, gen p mean: -0.04692156985402107, mean p set: 0.4478035867214203The modified gen p mean: 0.44798219203948975, gen p mean: -0.044899679720401764, mean p set: 0.44846251606941223
loss_pred:0.012680118903517723, decouple_loss:0.001055912347510457
loss_pred:0.012455294840037823, decouple_loss:0.001003554672934115
Iteration: 336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484224021434784, gen p mean: -0.0489654615521431, mean p set: 0.4489026963710785
loss_pred:0.012509217485785484, decouple_loss:0.0010681917192414403
The modified gen p mean: 0.44654273986816406, gen p mean: -0.04566129669547081, mean p set: 0.44702303409576416The modified gen p mean: 0.4465208947658539, gen p mean: -0.04745473712682724, mean p set: 0.44700121879577637
loss_pred:0.012648271396756172, decouple_loss:0.0011095204390585423
loss_pred:0.012871070764958858, decouple_loss:0.0010524372337386012
Iteration: 337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719478487968445, gen p mean: -0.04536940157413483, mean p set: 0.44767507910728455
loss_pred:0.01212395541369915, decouple_loss:0.0010376694845035672
The modified gen p mean: 0.4468630850315094, gen p mean: -0.04088396951556206, mean p set: 0.4473433792591095The modified gen p mean: 0.44802191853523254, gen p mean: -0.047196164727211, mean p set: 0.44850221276283264
loss_pred:0.012737089768052101, decouple_loss:0.0011083054123446345
loss_pred:0.012583439238369465, decouple_loss:0.0010720061836764216
Iteration: 338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733890891075134, gen p mean: -0.044035423547029495, mean p set: 0.44781920313835144
loss_pred:0.013106642290949821, decouple_loss:0.000995965558104217
The modified gen p mean: 0.4472261667251587, gen p mean: -0.04008789733052254, mean p set: 0.4477064609527588The modified gen p mean: 0.4469561278820038, gen p mean: -0.04003382474184036, mean p set: 0.4474363923072815
loss_pred:0.012762004509568214, decouple_loss:0.0010251726489514112
loss_pred:0.012768430635333061, decouple_loss:0.001074843225069344
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
NaN value num: 0
Iteration: 339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494318962097168, gen p mean: -0.046986959874629974, mean p set: 0.4499121904373169
loss_pred:0.018751615658402443, decouple_loss:0.001107919029891491
The modified gen p mean: 0.4483759105205536, gen p mean: -0.03965028002858162, mean p set: 0.4488562047481537The modified gen p mean: 0.4497392177581787, gen p mean: -0.04885658994317055, mean p set: 0.4502195119857788
loss_pred:0.018376683816313744, decouple_loss:0.0010396689176559448
loss_pred:0.019756244495511055, decouple_loss:0.0010518468916416168
Iteration: 340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44803908467292786, gen p mean: -0.0417412631213665, mean p set: 0.44851937890052795
loss_pred:0.019495069980621338, decouple_loss:0.0010322415037080646
The modified gen p mean: 0.44939807057380676, gen p mean: -0.04200223460793495, mean p set: 0.4498783349990845The modified gen p mean: 0.44711536169052124, gen p mean: -0.04413153976202011, mean p set: 0.44759565591812134
loss_pred:0.018886951729655266, decouple_loss:0.001082985196262598
loss_pred:0.018387475982308388, decouple_loss:0.0010745434556156397
2023-04-30 04:59:32 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05109523609280586, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04641573876142502, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0471753366291523, mean p set: 0.4500633478164673
loss_pred:0.018799137324094772, decouple_loss:0.001262249075807631
loss_pred:0.017788322642445564, decouple_loss:0.001199175720103085
loss_pred:0.017853671684861183, decouple_loss:0.0011972212232649326
WV_0_PC_1_EH_0_PS_40, loss: 0.01820802316069603, avg_mse: 0.02626347914338112
current test mse: 0.026263
Iteration: 341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480273425579071, gen p mean: -0.046469394117593765, mean p set: 0.4485076069831848
The modified gen p mean: 0.44992712140083313, gen p mean: -0.05084715783596039, mean p set: 0.4504074156284332
The modified gen p mean: 0.4483935832977295, gen p mean: -0.04859120026230812, mean p set: 0.4488738775253296
loss_pred:0.018126100301742554, decouple_loss:0.0010718760313466191
loss_pred:0.019229739904403687, decouple_loss:0.0011921031400561333loss_pred:0.018385296687483788, decouple_loss:0.0012292099418118596
Iteration: 342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447353333234787, gen p mean: -0.04543638229370117, mean p set: 0.4478336274623871
loss_pred:0.019567178562283516, decouple_loss:0.0011499287793412805
The modified gen p mean: 0.44936156272888184, gen p mean: -0.056497201323509216, mean p set: 0.44984182715415955The modified gen p mean: 0.4487382471561432, gen p mean: -0.05202816054224968, mean p set: 0.4492185115814209
loss_pred:0.018298249691724777, decouple_loss:0.0012876065447926521
loss_pred:0.018300093710422516, decouple_loss:0.0011514879297465086
Iteration: 343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480580687522888, gen p mean: -0.04656466469168663, mean p set: 0.4485383629798889
loss_pred:0.017756154760718346, decouple_loss:0.0012299033114686608
The modified gen p mean: 0.4486355185508728, gen p mean: -0.0533529669046402, mean p set: 0.4491157829761505
The modified gen p mean: 0.44823142886161804, gen p mean: -0.04767373576760292, mean p set: 0.44871172308921814
loss_pred:0.019211692735552788, decouple_loss:0.0012065351475030184
loss_pred:0.017452731728553772, decouple_loss:0.001256078016012907
Iteration: 344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44792935252189636, gen p mean: -0.052012864500284195, mean p set: 0.44840967655181885
The modified gen p mean: 0.44805678725242615, gen p mean: -0.05036913976073265, mean p set: 0.44853708148002625
loss_pred:0.01783810742199421, decouple_loss:0.001333627849817276
loss_pred:0.0189801175147295, decouple_loss:0.0013199695385992527
The modified gen p mean: 0.449124813079834, gen p mean: -0.05707480013370514, mean p set: 0.4496051073074341
loss_pred:0.017915915697813034, decouple_loss:0.0013827151851728559
Iteration: 345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495101273059845, gen p mean: -0.05575774982571602, mean p set: 0.4499904215335846
loss_pred:0.017386075109243393, decouple_loss:0.001202107290737331
The modified gen p mean: 0.4492662847042084, gen p mean: -0.05791512131690979, mean p set: 0.44974657893180847The modified gen p mean: 0.44844934344291687, gen p mean: -0.05488329753279686, mean p set: 0.44892963767051697
loss_pred:0.018601570278406143, decouple_loss:0.001257253810763359
loss_pred:0.019138697534799576, decouple_loss:0.001275865244679153
Iteration: 346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488072991371155, gen p mean: -0.05634550750255585, mean p set: 0.4492875933647156
The modified gen p mean: 0.44786274433135986, gen p mean: -0.05260077863931656, mean p set: 0.44834303855895996
loss_pred:0.0177889633923769, decouple_loss:0.0013203670969232917
loss_pred:0.01762782782316208, decouple_loss:0.0013161334209144115
The modified gen p mean: 0.44883784651756287, gen p mean: -0.05464879795908928, mean p set: 0.44931817054748535
loss_pred:0.01867368444800377, decouple_loss:0.0012568753445520997
Iteration: 347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477604627609253, gen p mean: -0.052145231515169144, mean p set: 0.448240727186203
loss_pred:0.017729010432958603, decouple_loss:0.0013033687137067318
The modified gen p mean: 0.4494950771331787, gen p mean: -0.05949194356799126, mean p set: 0.4499753415584564
The modified gen p mean: 0.44767630100250244, gen p mean: -0.048872388899326324, mean p set: 0.44815659523010254
loss_pred:0.0176395196467638, decouple_loss:0.001322382246144116
loss_pred:0.01879652962088585, decouple_loss:0.0013033727882429957
Iteration: 348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44859200716018677, gen p mean: -0.04810416325926781, mean p set: 0.4490722715854645
loss_pred:0.01833932287991047, decouple_loss:0.0011189371580258012
The modified gen p mean: 0.44754359126091003, gen p mean: -0.04969051852822304, mean p set: 0.44802385568618774The modified gen p mean: 0.4486146867275238, gen p mean: -0.05401760712265968, mean p set: 0.4490949809551239
loss_pred:0.017624367028474808, decouple_loss:0.0011635393602773547
loss_pred:0.018826652318239212, decouple_loss:0.0011872982140630484
Iteration: 349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758620858192444, gen p mean: -0.049178607761859894, mean p set: 0.44806647300720215
The modified gen p mean: 0.4481610059738159, gen p mean: -0.05060366168618202, mean p set: 0.448641300201416
loss_pred:0.0172377098351717, decouple_loss:0.0013105383841320872
loss_pred:0.017286129295825958, decouple_loss:0.0012425092281773686
The modified gen p mean: 0.44775399565696716, gen p mean: -0.04440825805068016, mean p set: 0.4482342600822449
loss_pred:0.017959410324692726, decouple_loss:0.001242476049810648
Iteration: 350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835373759269714, gen p mean: -0.053512439131736755, mean p set: 0.44883406162261963
The modified gen p mean: 0.448249876499176, gen p mean: -0.051046065986156464, mean p set: 0.4487301707267761
loss_pred:0.01806640438735485, decouple_loss:0.0011539787519723177
loss_pred:0.018473206087946892, decouple_loss:0.0011727976379916072
The modified gen p mean: 0.4477972388267517, gen p mean: -0.046495914459228516, mean p set: 0.4482775628566742
loss_pred:0.01840885356068611, decouple_loss:0.0012239784700796008
2023-04-30 05:01:26 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.049719784408807755, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.044462673366069794, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.045513253659009933, mean p set: 0.4500633478164673
loss_pred:0.018554702401161194, decouple_loss:0.0012083409819751978
loss_pred:0.017530864104628563, decouple_loss:0.0011868064757436514
loss_pred:0.017547672614455223, decouple_loss:0.0011975480010733008
WV_0_PC_1_EH_0_PS_40, loss: 0.01793762296438217, avg_mse: 0.025702903047204018
current test mse: 0.025703
At step 350, Best test: 0.025703
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_model_test_schedule_sampling_DynaMean.ckpt
Iteration: 351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783738255500793, gen p mean: -0.046852171421051025, mean p set: 0.44831764698028564
loss_pred:0.017720986157655716, decouple_loss:0.0011803109664469957
The modified gen p mean: 0.4481784403324127, gen p mean: -0.04444100707769394, mean p set: 0.4486587643623352The modified gen p mean: 0.4483061730861664, gen p mean: -0.04650622978806496, mean p set: 0.4487864673137665
loss_pred:0.017845584079623222, decouple_loss:0.0012847331818193197
loss_pred:0.017925672233104706, decouple_loss:0.001196673489175737
Iteration: 352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791170954704285, gen p mean: -0.04639029875397682, mean p set: 0.44839203357696533
loss_pred:0.017975913360714912, decouple_loss:0.0011243171757087111
The modified gen p mean: 0.45010989904403687, gen p mean: -0.05182917043566704, mean p set: 0.4505901634693146
The modified gen p mean: 0.4480110704898834, gen p mean: -0.047743700444698334, mean p set: 0.44849133491516113
loss_pred:0.017872869968414307, decouple_loss:0.0011276031145825982
loss_pred:0.017233937978744507, decouple_loss:0.0011623783502727747
Iteration: 353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482074975967407, gen p mean: -0.04572295397520065, mean p set: 0.4486878216266632
loss_pred:0.017791390419006348, decouple_loss:0.0012282378738746047
The modified gen p mean: 0.4468841552734375, gen p mean: -0.04505857452750206, mean p set: 0.44736447930336The modified gen p mean: 0.4485088586807251, gen p mean: -0.04648025333881378, mean p set: 0.4489891827106476
loss_pred:0.018599284812808037, decouple_loss:0.0011950848856940866
loss_pred:0.018438395112752914, decouple_loss:0.0012057117419317365
Iteration: 354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467676877975464, gen p mean: -0.04700279235839844, mean p set: 0.4472479820251465
loss_pred:0.018370937556028366, decouple_loss:0.0011221066815778613
The modified gen p mean: 0.44820448756217957, gen p mean: -0.04793844744563103, mean p set: 0.44868478178977966The modified gen p mean: 0.4476093649864197, gen p mean: -0.047538015991449356, mean p set: 0.4480896592140198
loss_pred:0.01858164370059967, decouple_loss:0.0011735260486602783
loss_pred:0.018181420862674713, decouple_loss:0.0012701763771474361
Iteration: 355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496183693408966, gen p mean: -0.05005834251642227, mean p set: 0.4500986337661743
loss_pred:0.017503254115581512, decouple_loss:0.0011080430122092366
The modified gen p mean: 0.44791704416275024, gen p mean: -0.04557406157255173, mean p set: 0.44839733839035034The modified gen p mean: 0.44783344864845276, gen p mean: -0.048864468932151794, mean p set: 0.44831374287605286
loss_pred:0.0177545715123415, decouple_loss:0.0011600771686062217
loss_pred:0.01762285828590393, decouple_loss:0.001210734830237925
Iteration: 356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802042841911316, gen p mean: -0.05266203731298447, mean p set: 0.44850072264671326
loss_pred:0.018346888944506645, decouple_loss:0.0010958072962239385
The modified gen p mean: 0.4480516016483307, gen p mean: -0.049665920436382294, mean p set: 0.4485318660736084The modified gen p mean: 0.44861724972724915, gen p mean: -0.04943762719631195, mean p set: 0.44909751415252686
loss_pred:0.017665041610598564, decouple_loss:0.001102246344089508
loss_pred:0.01822357252240181, decouple_loss:0.0011129578342661262
Iteration: 357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802823662757874, gen p mean: -0.04592757299542427, mean p set: 0.44850850105285645
loss_pred:0.018378252163529396, decouple_loss:0.0011179327266290784
The modified gen p mean: 0.44731348752975464, gen p mean: -0.04658014699816704, mean p set: 0.44779375195503235The modified gen p mean: 0.44782301783561707, gen p mean: -0.04891994968056679, mean p set: 0.44830331206321716
loss_pred:0.018344055861234665, decouple_loss:0.001168998540379107
loss_pred:0.018358035013079643, decouple_loss:0.001137648825533688
Iteration: 358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490705728530884, gen p mean: -0.04900867119431496, mean p set: 0.4495508372783661
loss_pred:0.017973683774471283, decouple_loss:0.0012330792378634214
The modified gen p mean: 0.4478890895843506, gen p mean: -0.043938539922237396, mean p set: 0.4483693838119507The modified gen p mean: 0.4479466378688812, gen p mean: -0.046284373849630356, mean p set: 0.44842690229415894
loss_pred:0.017783595249056816, decouple_loss:0.0011144328163936734
loss_pred:0.01701202802360058, decouple_loss:0.0010621401015669107
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
NaN value num: 0
Iteration: 359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472602307796478, gen p mean: -0.04930740222334862, mean p set: 0.4477405250072479
loss_pred:0.017105521634221077, decouple_loss:0.0011263192864134908
The modified gen p mean: 0.447578489780426, gen p mean: -0.04518907144665718, mean p set: 0.44805875420570374The modified gen p mean: 0.4473206698894501, gen p mean: -0.04620591923594475, mean p set: 0.44780099391937256
loss_pred:0.01726328581571579, decouple_loss:0.0010728305205702782
loss_pred:0.016930464655160904, decouple_loss:0.0010706190951168537
Iteration: 360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480491578578949, gen p mean: -0.04074147343635559, mean p set: 0.4485294818878174
loss_pred:0.018250219523906708, decouple_loss:0.0010955873876810074
The modified gen p mean: 0.4472832977771759, gen p mean: -0.04395989701151848, mean p set: 0.4477635622024536The modified gen p mean: 0.4494279623031616, gen p mean: -0.052616290748119354, mean p set: 0.44990822672843933
loss_pred:0.0173767302185297, decouple_loss:0.0010559988440945745
loss_pred:0.017571061849594116, decouple_loss:0.0011264249915257096
2023-04-30 05:04:07 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04742521420121193, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04228535294532776, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04325839504599571, mean p set: 0.4500633478164673
loss_pred:0.018477750942111015, decouple_loss:0.0010747530031949282
loss_pred:0.0174767654389143, decouple_loss:0.0010363869369029999
loss_pred:0.017475688830018044, decouple_loss:0.0010205244179815054
WV_0_PC_1_EH_0_PS_40, loss: 0.017862264066934586, avg_mse: 0.02564357966184616
current test mse: 0.025644
At step 360, Best test: 0.025644
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_model_test_schedule_sampling_DynaMean.ckpt
Iteration: 361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44905388355255127, gen p mean: -0.048760637640953064, mean p set: 0.44953420758247375
loss_pred:0.01764948107302189, decouple_loss:0.0010566693963482976
The modified gen p mean: 0.44729548692703247, gen p mean: -0.043415721505880356, mean p set: 0.44777578115463257The modified gen p mean: 0.4470658302307129, gen p mean: -0.03824763372540474, mean p set: 0.447546124458313
loss_pred:0.01703512854874134, decouple_loss:0.0009919072035700083loss_pred:0.0184696726500988, decouple_loss:0.0009579779580235481
Iteration: 362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471486806869507, gen p mean: -0.03989714756608009, mean p set: 0.44762900471687317
loss_pred:0.017082061618566513, decouple_loss:0.0010521538788452744
The modified gen p mean: 0.4470890462398529, gen p mean: -0.05152098089456558, mean p set: 0.447569340467453The modified gen p mean: 0.4461573362350464, gen p mean: -0.04493458941578865, mean p set: 0.44663766026496887
loss_pred:0.01724259741604328, decouple_loss:0.0010113529860973358
loss_pred:0.017391754314303398, decouple_loss:0.0010253371438011527
Iteration: 363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44558024406433105, gen p mean: -0.04566275700926781, mean p set: 0.44606053829193115
The modified gen p mean: 0.44671186804771423, gen p mean: -0.04620489105582237, mean p set: 0.44719216227531433
loss_pred:0.01676117815077305, decouple_loss:0.0010079602943733335
loss_pred:0.016888124868273735, decouple_loss:0.0009585393709130585
The modified gen p mean: 0.4477144181728363, gen p mean: -0.04217643663287163, mean p set: 0.4481947124004364
loss_pred:0.01830391399562359, decouple_loss:0.0009316662326455116
Iteration: 364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760647416114807, gen p mean: -0.04593180865049362, mean p set: 0.44808676838874817
The modified gen p mean: 0.44721198081970215, gen p mean: -0.04564749449491501, mean p set: 0.44769227504730225
loss_pred:0.01682484894990921, decouple_loss:0.0009859333513304591
loss_pred:0.01672476716339588, decouple_loss:0.001067370641976595
The modified gen p mean: 0.4456823468208313, gen p mean: -0.04686962068080902, mean p set: 0.4461626410484314
loss_pred:0.016533853486180305, decouple_loss:0.0009994402062147856
Iteration: 365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661176204681396, gen p mean: -0.04945038631558418, mean p set: 0.44709208607673645
The modified gen p mean: 0.4464568793773651, gen p mean: -0.04510614648461342, mean p set: 0.4469371736049652
loss_pred:0.017351921647787094, decouple_loss:0.000996036222204566
loss_pred:0.016934556886553764, decouple_loss:0.001023355289362371
The modified gen p mean: 0.4473946988582611, gen p mean: -0.04633847624063492, mean p set: 0.4478749632835388
loss_pred:0.017005406320095062, decouple_loss:0.000967120926361531
Iteration: 366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465195834636688, gen p mean: -0.04882580041885376, mean p set: 0.44699984788894653
The modified gen p mean: 0.44848689436912537, gen p mean: -0.05267171934247017, mean p set: 0.44896718859672546
loss_pred:0.017155712470412254, decouple_loss:0.0010723215527832508
loss_pred:0.01741623505949974, decouple_loss:0.0010979464277625084
The modified gen p mean: 0.4463948905467987, gen p mean: -0.04728983715176582, mean p set: 0.4468752145767212
loss_pred:0.016897495836019516, decouple_loss:0.0010219773976132274
Iteration: 367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469406008720398, gen p mean: -0.052080050110816956, mean p set: 0.4474208950996399
loss_pred:0.017069758847355843, decouple_loss:0.0009577635210007429
The modified gen p mean: 0.44758978486061096, gen p mean: -0.041943714022636414, mean p set: 0.44807007908821106The modified gen p mean: 0.4472357928752899, gen p mean: -0.04509948194026947, mean p set: 0.4477160573005676
loss_pred:0.01745743304491043, decouple_loss:0.0009867096086964011
loss_pred:0.01705326698720455, decouple_loss:0.0009423624142073095
Iteration: 368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463563859462738, gen p mean: -0.04412294179201126, mean p set: 0.4468367099761963
The modified gen p mean: 0.4475298523902893, gen p mean: -0.03879283368587494, mean p set: 0.4480101466178894
loss_pred:0.016984883695840836, decouple_loss:0.0009249050635844469
loss_pred:0.017304878681898117, decouple_loss:0.0009209324489347637
The modified gen p mean: 0.4484092891216278, gen p mean: -0.046151574701070786, mean p set: 0.4488895833492279
loss_pred:0.017232593148946762, decouple_loss:0.0010774176334962249
Iteration: 369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471362829208374, gen p mean: -0.048270128667354584, mean p set: 0.4476166069507599
The modified gen p mean: 0.4472377598285675, gen p mean: -0.03781384602189064, mean p set: 0.4477180242538452
loss_pred:0.017389386892318726, decouple_loss:0.0009767099982127547
loss_pred:0.018238212913274765, decouple_loss:0.0009347955347038805
The modified gen p mean: 0.44731464982032776, gen p mean: -0.041012901812791824, mean p set: 0.44779494404792786
loss_pred:0.017591174691915512, decouple_loss:0.0009360513067804277
Iteration: 370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772693514823914, gen p mean: -0.0432959608733654, mean p set: 0.44820722937583923
loss_pred:0.017830008640885353, decouple_loss:0.0009452113881707191
The modified gen p mean: 0.446994811296463, gen p mean: -0.04400179535150528, mean p set: 0.4474751055240631The modified gen p mean: 0.4471758306026459, gen p mean: -0.041727542877197266, mean p set: 0.44765612483024597
loss_pred:0.0164488535374403, decouple_loss:0.0010040666675195098
loss_pred:0.01684710569679737, decouple_loss:0.0010981609812006354
2023-04-30 05:06:06 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04724675416946411, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04208698868751526, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.043040476739406586, mean p set: 0.4500633478164673
loss_pred:0.018429439514875412, decouple_loss:0.0009618483018130064
loss_pred:0.017444344237446785, decouple_loss:0.0010066288523375988
loss_pred:0.017490485683083534, decouple_loss:0.0009754258790053427
WV_0_PC_1_EH_0_PS_40, loss: 0.017837155610322952, avg_mse: 0.025608491152524948
current test mse: 0.025608
At step 370, Best test: 0.025608
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_model_test_schedule_sampling_DynaMean.ckpt
Iteration: 371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44615963101387024, gen p mean: -0.04492640495300293, mean p set: 0.4466399550437927
loss_pred:0.017155185341835022, decouple_loss:0.0009867532644420862
The modified gen p mean: 0.4478931128978729, gen p mean: -0.048345793038606644, mean p set: 0.448373407125473The modified gen p mean: 0.4473946988582611, gen p mean: -0.04680231586098671, mean p set: 0.4478749930858612
loss_pred:0.01749110221862793, decouple_loss:0.0009424060117453337
loss_pred:0.017489679157733917, decouple_loss:0.0009000540594570339
Iteration: 372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474044740200043, gen p mean: -0.04936109110713005, mean p set: 0.44788476824760437
loss_pred:0.016264669597148895, decouple_loss:0.0009607907850295305
The modified gen p mean: 0.4470345973968506, gen p mean: -0.051652126014232635, mean p set: 0.4475148916244507The modified gen p mean: 0.44694894552230835, gen p mean: -0.04892631247639656, mean p set: 0.44742920994758606
loss_pred:0.017129454761743546, decouple_loss:0.0009845077292993665
loss_pred:0.017003966495394707, decouple_loss:0.0009832135401666164
Iteration: 373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474177360534668, gen p mean: -0.05114053562283516, mean p set: 0.4478980302810669
loss_pred:0.01713952235877514, decouple_loss:0.0010040003107860684
The modified gen p mean: 0.4461892247200012, gen p mean: -0.05253535136580467, mean p set: 0.4466695487499237The modified gen p mean: 0.4459533095359802, gen p mean: -0.049296751618385315, mean p set: 0.4464336037635803
loss_pred:0.01684955134987831, decouple_loss:0.0009683939279057086
loss_pred:0.017243795096874237, decouple_loss:0.000942765676882118
Iteration: 374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473939538002014, gen p mean: -0.05555335432291031, mean p set: 0.4478742182254791
loss_pred:0.017688609659671783, decouple_loss:0.001053983229212463
The modified gen p mean: 0.44694972038269043, gen p mean: -0.045721642673015594, mean p set: 0.44742998480796814The modified gen p mean: 0.4471409320831299, gen p mean: -0.054488714784383774, mean p set: 0.44762122631073
loss_pred:0.01833287812769413, decouple_loss:0.000941507809329778
loss_pred:0.01727408543229103, decouple_loss:0.0010008285753428936
Iteration: 375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476718306541443, gen p mean: -0.05628674849867821, mean p set: 0.448152095079422
loss_pred:0.0170199703425169, decouple_loss:0.0009109255624935031
The modified gen p mean: 0.44675564765930176, gen p mean: -0.05628224462270737, mean p set: 0.44723597168922424The modified gen p mean: 0.44772329926490784, gen p mean: -0.06057637184858322, mean p set: 0.44820359349250793
loss_pred:0.017241591587662697, decouple_loss:0.000918865785934031
loss_pred:0.017174886539578438, decouple_loss:0.000972794194240123
Iteration: 376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44735077023506165, gen p mean: -0.05300366133451462, mean p set: 0.44783106446266174
loss_pred:0.01708168163895607, decouple_loss:0.0009546548826619983
The modified gen p mean: 0.44622308015823364, gen p mean: -0.05858081951737404, mean p set: 0.44670340418815613The modified gen p mean: 0.44786348938941956, gen p mean: -0.05584568530321121, mean p set: 0.44834375381469727
loss_pred:0.01802741549909115, decouple_loss:0.0010550684528425336
loss_pred:0.016952237114310265, decouple_loss:0.0009347374434582889
Iteration: 377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44698768854141235, gen p mean: -0.056165169924497604, mean p set: 0.44746798276901245
loss_pred:0.01703965663909912, decouple_loss:0.0009140537586063147
The modified gen p mean: 0.4484701454639435, gen p mean: -0.051103249192237854, mean p set: 0.4489504396915436The modified gen p mean: 0.4475497901439667, gen p mean: -0.053331952542066574, mean p set: 0.44803011417388916
loss_pred:0.017750393599271774, decouple_loss:0.0008494057692587376
loss_pred:0.018280483782291412, decouple_loss:0.0009607445681467652
Iteration: 378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768059253692627, gen p mean: -0.053029049187898636, mean p set: 0.448160856962204
loss_pred:0.017555035650730133, decouple_loss:0.0009837094694375992
The modified gen p mean: 0.44681090116500854, gen p mean: -0.0553307980298996, mean p set: 0.44729119539260864The modified gen p mean: 0.44653427600860596, gen p mean: -0.05180886387825012, mean p set: 0.44701457023620605
loss_pred:0.0169275663793087, decouple_loss:0.0009543896885588765
loss_pred:0.017340023070573807, decouple_loss:0.0009923548204824328
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
NaN value num: 0
Iteration: 379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502795934677124, gen p mean: -0.04295044019818306, mean p set: 0.4507599174976349
loss_pred:0.017393868416547775, decouple_loss:0.0011441332753747702
The modified gen p mean: 0.45166248083114624, gen p mean: -0.05151280388236046, mean p set: 0.4521428048610687The modified gen p mean: 0.4535878896713257, gen p mean: -0.040477268397808075, mean p set: 0.45406821370124817
loss_pred:0.016392629593610764, decouple_loss:0.0011623334139585495
loss_pred:0.017625244334340096, decouple_loss:0.001109172124415636
Iteration: 380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535704255104065, gen p mean: -0.04082362726330757, mean p set: 0.4540506899356842
loss_pred:0.017502181231975555, decouple_loss:0.0009738386725075543
The modified gen p mean: 0.4498867690563202, gen p mean: -0.04091636463999748, mean p set: 0.4503670632839203The modified gen p mean: 0.4536437690258026, gen p mean: -0.04831293970346451, mean p set: 0.4541240334510803
loss_pred:0.017282890155911446, decouple_loss:0.0009724394185468554
loss_pred:0.01722647435963154, decouple_loss:0.0010034547885879874
2023-04-30 05:08:42 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.050863467156887054, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04571933671832085, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04672536626458168, mean p set: 0.4500633478164673
loss_pred:0.01847873441874981, decouple_loss:0.0010956641053780913
loss_pred:0.017507458105683327, decouple_loss:0.0010537455091252923
loss_pred:0.017471687868237495, decouple_loss:0.0010505655081942677
WV_0_PC_1_EH_0_PS_40, loss: 0.017872627824544907, avg_mse: 0.025652706623077393
current test mse: 0.025653
Iteration: 381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536525011062622, gen p mean: -0.05140820890665054, mean p set: 0.4541327655315399
The modified gen p mean: 0.45226365327835083, gen p mean: -0.039238091558218, mean p set: 0.4527439475059509
The modified gen p mean: 0.4512980282306671, gen p mean: -0.04425852745771408, mean p set: 0.4517782926559448
loss_pred:0.017521053552627563, decouple_loss:0.0009941664757207036
loss_pred:0.017392434179782867, decouple_loss:0.00120481476187706loss_pred:0.01736476831138134, decouple_loss:0.0010193402413278818
Iteration: 382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507077634334564, gen p mean: -0.04626820981502533, mean p set: 0.4511880576610565
loss_pred:0.017750564962625504, decouple_loss:0.000999509240500629
The modified gen p mean: 0.45352116227149963, gen p mean: -0.038966502994298935, mean p set: 0.45400142669677734The modified gen p mean: 0.452810138463974, gen p mean: -0.03847375512123108, mean p set: 0.4532904326915741
loss_pred:0.01735822483897209, decouple_loss:0.0009451252408325672
loss_pred:0.01739816926419735, decouple_loss:0.0009933155961334705
Iteration: 383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45269879698753357, gen p mean: -0.036263223737478256, mean p set: 0.45317909121513367
loss_pred:0.01744573563337326, decouple_loss:0.0010857144370675087
The modified gen p mean: 0.4503451883792877, gen p mean: -0.04091614484786987, mean p set: 0.4508254826068878The modified gen p mean: 0.45104438066482544, gen p mean: -0.03872266784310341, mean p set: 0.4515247046947479
loss_pred:0.01751388981938362, decouple_loss:0.001134897000156343
loss_pred:0.017516249790787697, decouple_loss:0.0010946481488645077
Iteration: 384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45349135994911194, gen p mean: -0.033444445580244064, mean p set: 0.45397165417671204
loss_pred:0.01691698469221592, decouple_loss:0.0011080163531005383
The modified gen p mean: 0.4519471526145935, gen p mean: -0.03610117360949516, mean p set: 0.452427476644516The modified gen p mean: 0.4521459639072418, gen p mean: -0.03321290761232376, mean p set: 0.4526262879371643
loss_pred:0.017093168571591377, decouple_loss:0.0010469036642462015
loss_pred:0.016912782564759254, decouple_loss:0.0011031277244910598
Iteration: 385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45069363713264465, gen p mean: -0.03164433315396309, mean p set: 0.45117396116256714
loss_pred:0.017170237377285957, decouple_loss:0.0011444868287071586
The modified gen p mean: 0.45330971479415894, gen p mean: -0.03347765654325485, mean p set: 0.45378997921943665The modified gen p mean: 0.4527287781238556, gen p mean: -0.037874720990657806, mean p set: 0.4532091021537781
loss_pred:0.01781296543776989, decouple_loss:0.0010730363428592682
loss_pred:0.01694759540259838, decouple_loss:0.0011244808556511998
Iteration: 386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4538218379020691, gen p mean: -0.03326850011944771, mean p set: 0.4543021321296692
loss_pred:0.016980750486254692, decouple_loss:0.0010995457414537668
The modified gen p mean: 0.452887624502182, gen p mean: -0.03706514835357666, mean p set: 0.4533679187297821The modified gen p mean: 0.45416638255119324, gen p mean: -0.04103023558855057, mean p set: 0.45464667677879333
loss_pred:0.016779759898781776, decouple_loss:0.0011209374060854316
loss_pred:0.017055857926607132, decouple_loss:0.0011544470908120275
Iteration: 387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524848759174347, gen p mean: -0.0373547300696373, mean p set: 0.4529651403427124
loss_pred:0.016667556017637253, decouple_loss:0.0011097392998635769
The modified gen p mean: 0.453026682138443, gen p mean: -0.03252424672245979, mean p set: 0.4535069465637207The modified gen p mean: 0.4525458514690399, gen p mean: -0.04367318004369736, mean p set: 0.45302614569664
loss_pred:0.016902277246117592, decouple_loss:0.001275449525564909
loss_pred:0.0167144276201725, decouple_loss:0.0011144893942400813
Iteration: 388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45210379362106323, gen p mean: -0.03873761370778084, mean p set: 0.45258408784866333
loss_pred:0.01741907373070717, decouple_loss:0.0011176542611792684
The modified gen p mean: 0.4519036114215851, gen p mean: -0.03645089641213417, mean p set: 0.4523839056491852The modified gen p mean: 0.4525628387928009, gen p mean: -0.038769252598285675, mean p set: 0.453043133020401
loss_pred:0.016957396641373634, decouple_loss:0.0011678216978907585
loss_pred:0.01693788915872574, decouple_loss:0.0010415600845590234
Iteration: 389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518735706806183, gen p mean: -0.04348599538207054, mean p set: 0.4523538649082184
loss_pred:0.017098596319556236, decouple_loss:0.0009893084643408656
The modified gen p mean: 0.45251134037971497, gen p mean: -0.03750018775463104, mean p set: 0.45299163460731506The modified gen p mean: 0.4527757465839386, gen p mean: -0.04537701979279518, mean p set: 0.4532560408115387
loss_pred:0.016433773562312126, decouple_loss:0.0010831051040440798
loss_pred:0.01667116768658161, decouple_loss:0.0011635742848739028
Iteration: 390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529880881309509, gen p mean: -0.043296847492456436, mean p set: 0.4534684121608734
loss_pred:0.016953427344560623, decouple_loss:0.001054749940522015
The modified gen p mean: 0.4504817724227905, gen p mean: -0.04182916134595871, mean p set: 0.450962096452713The modified gen p mean: 0.45072656869888306, gen p mean: -0.0471077524125576, mean p set: 0.45120686292648315
loss_pred:0.017317431047558784, decouple_loss:0.00105261558201164
loss_pred:0.01694229058921337, decouple_loss:0.0010656779631972313
2023-04-30 05:10:36 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.057195570319890976, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.052292756736278534, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05315636843442917, mean p set: 0.4500633478164673
loss_pred:0.01854630932211876, decouple_loss:0.0010704005835577846
loss_pred:0.01749640889465809, decouple_loss:0.0010626438306644559
loss_pred:0.017549514770507812, decouple_loss:0.0010616134386509657
WV_0_PC_1_EH_0_PS_40, loss: 0.017917320132255554, avg_mse: 0.02572505921125412
current test mse: 0.025725
Iteration: 391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529775083065033, gen p mean: -0.05059518665075302, mean p set: 0.4534578025341034
The modified gen p mean: 0.453730970621109, gen p mean: -0.05894891545176506, mean p set: 0.4542112350463867
The modified gen p mean: 0.45130714774131775, gen p mean: -0.05469278246164322, mean p set: 0.45178741216659546
loss_pred:0.016603605821728706, decouple_loss:0.0010933937737718225
loss_pred:0.016809294000267982, decouple_loss:0.0009476558188907802
loss_pred:0.017324144020676613, decouple_loss:0.0010209697065874934
Iteration: 392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535066783428192, gen p mean: -0.047788381576538086, mean p set: 0.4539869725704193
loss_pred:0.017496157437562943, decouple_loss:0.0009620727505534887
The modified gen p mean: 0.45126619935035706, gen p mean: -0.05372164025902748, mean p set: 0.45174646377563477The modified gen p mean: 0.45190176367759705, gen p mean: -0.04962654039263725, mean p set: 0.45238205790519714
loss_pred:0.017327966168522835, decouple_loss:0.0009569685789756477
loss_pred:0.01737845316529274, decouple_loss:0.0009264022810384631
Iteration: 393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529445171356201, gen p mean: -0.050971370190382004, mean p set: 0.4534248113632202
loss_pred:0.017187921330332756, decouple_loss:0.0009348951862193644
The modified gen p mean: 0.4523571729660034, gen p mean: -0.04719124734401703, mean p set: 0.4528374671936035The modified gen p mean: 0.4524954557418823, gen p mean: -0.05068790167570114, mean p set: 0.45297572016716003
loss_pred:0.01718069054186344, decouple_loss:0.0009557484881952405
loss_pred:0.017821868881583214, decouple_loss:0.00095508829690516
Iteration: 394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521556794643402, gen p mean: -0.04690150171518326, mean p set: 0.45263591408729553
loss_pred:0.016807518899440765, decouple_loss:0.0009505355847068131
The modified gen p mean: 0.45323196053504944, gen p mean: -0.04704366251826286, mean p set: 0.45371225476264954The modified gen p mean: 0.451273113489151, gen p mean: -0.0562654584646225, mean p set: 0.4517534077167511
loss_pred:0.017246143892407417, decouple_loss:0.0008915828075259924
loss_pred:0.016783220693469048, decouple_loss:0.0010053085861727595
Iteration: 395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45227381587028503, gen p mean: -0.04914449527859688, mean p set: 0.4527541399002075
loss_pred:0.01765655167400837, decouple_loss:0.000906685832887888
The modified gen p mean: 0.4534977674484253, gen p mean: -0.048300519585609436, mean p set: 0.4539780914783478The modified gen p mean: 0.45276474952697754, gen p mean: -0.051455192267894745, mean p set: 0.45324504375457764
loss_pred:0.017320416867733, decouple_loss:0.0009683850803412497
loss_pred:0.017119988799095154, decouple_loss:0.0009530428214929998
Iteration: 396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45204904675483704, gen p mean: -0.04576028138399124, mean p set: 0.4525293707847595
loss_pred:0.01728099212050438, decouple_loss:0.0009657640475779772
The modified gen p mean: 0.4518187940120697, gen p mean: -0.04682430252432823, mean p set: 0.4522990584373474The modified gen p mean: 0.4511784315109253, gen p mean: -0.04368642345070839, mean p set: 0.4516587555408478
loss_pred:0.016535915434360504, decouple_loss:0.0009436121326871216
loss_pred:0.017157908529043198, decouple_loss:0.0009352924535050988
Iteration: 397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500243663787842, gen p mean: -0.04008026421070099, mean p set: 0.4505046308040619
loss_pred:0.016848383471369743, decouple_loss:0.0009623942896723747
The modified gen p mean: 0.4511004686355591, gen p mean: -0.04173841327428818, mean p set: 0.4515807330608368The modified gen p mean: 0.45062190294265747, gen p mean: -0.03618433699011803, mean p set: 0.4511021673679352
loss_pred:0.017047615721821785, decouple_loss:0.0009519399027340114
loss_pred:0.017481381073594093, decouple_loss:0.0009634299203753471
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
NaN value num: 0
Iteration: 398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45226413011550903, gen p mean: -0.03935335576534271, mean p set: 0.4527444541454315
loss_pred:0.01719669997692108, decouple_loss:0.0008845978300087154
The modified gen p mean: 0.45276230573654175, gen p mean: -0.03948422893881798, mean p set: 0.45324259996414185The modified gen p mean: 0.4527140259742737, gen p mean: -0.03892040252685547, mean p set: 0.4531942903995514
loss_pred:0.01622873917222023, decouple_loss:0.0009213158627972007
loss_pred:0.017396343871951103, decouple_loss:0.0009263228857889771
Iteration: 399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45097970962524414, gen p mean: -0.037867266684770584, mean p set: 0.45146000385284424
loss_pred:0.016966426745057106, decouple_loss:0.0010999784572049975
The modified gen p mean: 0.45048317313194275, gen p mean: -0.04389750584959984, mean p set: 0.45096346735954285The modified gen p mean: 0.4524080753326416, gen p mean: -0.040466271340847015, mean p set: 0.4528883397579193
loss_pred:0.017954012379050255, decouple_loss:0.0010123359970748425
loss_pred:0.017057327553629875, decouple_loss:0.0009411476203240454
Iteration: 400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522089660167694, gen p mean: -0.042017862200737, mean p set: 0.4526892900466919
loss_pred:0.01725304126739502, decouple_loss:0.0008620912558399141
The modified gen p mean: 0.4510240852832794, gen p mean: -0.04650329053401947, mean p set: 0.4515043795108795The modified gen p mean: 0.45272040367126465, gen p mean: -0.04140367731451988, mean p set: 0.45320072770118713
loss_pred:0.01801348477602005, decouple_loss:0.001023799297399819
loss_pred:0.01698567532002926, decouple_loss:0.0010054950835183263
2023-04-30 05:13:04 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.051309600472450256, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04627002775669098, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.047187089920043945, mean p set: 0.4500633478164673
loss_pred:0.018528008833527565, decouple_loss:0.001122383284382522
loss_pred:0.017505571246147156, decouple_loss:0.001009116880595684
loss_pred:0.017540890723466873, decouple_loss:0.001029675593599677
WV_0_PC_1_EH_0_PS_40, loss: 0.017910843715071678, avg_mse: 0.02574228122830391
current test mse: 0.025742
Iteration: 401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45131009817123413, gen p mean: -0.04283720627427101, mean p set: 0.4517904222011566
The modified gen p mean: 0.45347920060157776, gen p mean: -0.04403861239552498, mean p set: 0.45395946502685547
The modified gen p mean: 0.4539129436016083, gen p mean: -0.040509507060050964, mean p set: 0.45439326763153076
loss_pred:0.016876637935638428, decouple_loss:0.0011046332074329257
loss_pred:0.018085945397615433, decouple_loss:0.0009473759564571083
loss_pred:0.0166112519800663, decouple_loss:0.0009722014074213803
Iteration: 402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4543343782424927, gen p mean: -0.0436210073530674, mean p set: 0.4548146724700928
loss_pred:0.016581375151872635, decouple_loss:0.0009750135941430926
The modified gen p mean: 0.4522281885147095, gen p mean: -0.04814504086971283, mean p set: 0.45270848274230957The modified gen p mean: 0.45169582962989807, gen p mean: -0.04327736049890518, mean p set: 0.4521760940551758
loss_pred:0.01746879518032074, decouple_loss:0.0011050977045670152
loss_pred:0.01752789318561554, decouple_loss:0.0011365259997546673
Iteration: 403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513258635997772, gen p mean: -0.052681855857372284, mean p set: 0.45180612802505493
loss_pred:0.01781727932393551, decouple_loss:0.0009330405155196786
The modified gen p mean: 0.4510827362537384, gen p mean: -0.04977821558713913, mean p set: 0.4515630006790161
The modified gen p mean: 0.4521689713001251, gen p mean: -0.04888174310326576, mean p set: 0.45264923572540283
loss_pred:0.017099302262067795, decouple_loss:0.000915170181542635
loss_pred:0.018296606838703156, decouple_loss:0.0010271116625517607
Iteration: 404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521506130695343, gen p mean: -0.04780389741063118, mean p set: 0.4526309072971344
loss_pred:0.017167193815112114, decouple_loss:0.0010930286953225732
The modified gen p mean: 0.45270636677742004, gen p mean: -0.04884784296154976, mean p set: 0.45318663120269775The modified gen p mean: 0.4513745903968811, gen p mean: -0.050343193113803864, mean p set: 0.4518548846244812
loss_pred:0.017620749771595, decouple_loss:0.0011464187409728765
loss_pred:0.016776954755187035, decouple_loss:0.0010670500341802835
Iteration: 405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513583779335022, gen p mean: -0.05178056284785271, mean p set: 0.4518386423587799
loss_pred:0.017653364688158035, decouple_loss:0.0009072216344065964
The modified gen p mean: 0.45249706506729126, gen p mean: -0.045725055038928986, mean p set: 0.45297735929489136The modified gen p mean: 0.4506838619709015, gen p mean: -0.045320458710193634, mean p set: 0.4511641561985016
loss_pred:0.016262046992778778, decouple_loss:0.0009971578838303685
loss_pred:0.016662226989865303, decouple_loss:0.0010448383400216699
Iteration: 406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45082202553749084, gen p mean: -0.04621889069676399, mean p set: 0.45130228996276855
loss_pred:0.016381140798330307, decouple_loss:0.0009731512400321662
The modified gen p mean: 0.4522453546524048, gen p mean: -0.04992034286260605, mean p set: 0.4527256488800049The modified gen p mean: 0.4528239965438843, gen p mean: -0.044021327048540115, mean p set: 0.4533042907714844
loss_pred:0.01729396916925907, decouple_loss:0.0009441513102501631
loss_pred:0.01650027558207512, decouple_loss:0.0009681520168669522
Iteration: 407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509720802307129, gen p mean: -0.04397543892264366, mean p set: 0.451452374458313
loss_pred:0.01725933887064457, decouple_loss:0.0009450397919863462
The modified gen p mean: 0.4511820375919342, gen p mean: -0.044119928032159805, mean p set: 0.4516623318195343The modified gen p mean: 0.45180991291999817, gen p mean: -0.044069815427064896, mean p set: 0.45229020714759827
loss_pred:0.017513325437903404, decouple_loss:0.0009616395109333098
loss_pred:0.017767513170838356, decouple_loss:0.0010006616357713938
Iteration: 408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45246726274490356, gen p mean: -0.04851044714450836, mean p set: 0.45294755697250366
loss_pred:0.01678508333861828, decouple_loss:0.000974230351857841
The modified gen p mean: 0.4505382776260376, gen p mean: -0.04519304260611534, mean p set: 0.4510186016559601The modified gen p mean: 0.4528367817401886, gen p mean: -0.04676947370171547, mean p set: 0.4533170461654663
loss_pred:0.01752328872680664, decouple_loss:0.0010608708253130317
loss_pred:0.01650034822523594, decouple_loss:0.0010150584857910872
Iteration: 409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511546194553375, gen p mean: -0.044832177460193634, mean p set: 0.4516349136829376
loss_pred:0.017923539504408836, decouple_loss:0.0010145333362743258
The modified gen p mean: 0.4514199197292328, gen p mean: -0.03817391395568848, mean p set: 0.4519002437591553The modified gen p mean: 0.4508156180381775, gen p mean: -0.038882430642843246, mean p set: 0.4512959122657776
loss_pred:0.0161789171397686, decouple_loss:0.0010425059590488672
loss_pred:0.01653108187019825, decouple_loss:0.0010534191969782114
Iteration: 410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527190923690796, gen p mean: -0.041686248034238815, mean p set: 0.4531993865966797
loss_pred:0.01657448522746563, decouple_loss:0.000964693957939744
The modified gen p mean: 0.45134875178337097, gen p mean: -0.032923340797424316, mean p set: 0.45182904601097107The modified gen p mean: 0.45271340012550354, gen p mean: -0.03875350207090378, mean p set: 0.45319366455078125
loss_pred:0.01822616159915924, decouple_loss:0.0009583546780049801
loss_pred:0.01575215347111225, decouple_loss:0.0009101420291699469
2023-04-30 05:14:58 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04792214184999466, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04301547259092331, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.043979451060295105, mean p set: 0.4500633478164673
loss_pred:0.018542755395174026, decouple_loss:0.0011631775414571166
loss_pred:0.017517508938908577, decouple_loss:0.001079373061656952
loss_pred:0.017526479437947273, decouple_loss:0.0010748467175289989
WV_0_PC_1_EH_0_PS_40, loss: 0.017917538061738014, avg_mse: 0.02574586682021618
current test mse: 0.025746
Iteration: 411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45398029685020447, gen p mean: -0.03786971792578697, mean p set: 0.45446059107780457
The modified gen p mean: 0.45211371779441833, gen p mean: -0.03798797354102135, mean p set: 0.4525940418243408
The modified gen p mean: 0.45221826434135437, gen p mean: -0.039042986929416656, mean p set: 0.45269855856895447
loss_pred:0.016491945832967758, decouple_loss:0.0009898663265630603
loss_pred:0.016206732019782066, decouple_loss:0.0010627028532326221loss_pred:0.017111225053668022, decouple_loss:0.000951077847275883
Iteration: 412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45233041048049927, gen p mean: -0.04251668602228165, mean p set: 0.45281070470809937
loss_pred:0.017261849716305733, decouple_loss:0.0009188175899907947
The modified gen p mean: 0.453058660030365, gen p mean: -0.04240977764129639, mean p set: 0.4535389542579651The modified gen p mean: 0.4529424011707306, gen p mean: -0.04198535159230232, mean p set: 0.4534226953983307
loss_pred:0.016592038795351982, decouple_loss:0.0009799976833164692
loss_pred:0.017073070630431175, decouple_loss:0.0009882500162348151
Iteration: 413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520118534564972, gen p mean: -0.046023957431316376, mean p set: 0.4524921178817749
loss_pred:0.01681816205382347, decouple_loss:0.0010090897558256984
The modified gen p mean: 0.45220547914505005, gen p mean: -0.04220921918749809, mean p set: 0.45268580317497253The modified gen p mean: 0.45227065682411194, gen p mean: -0.03888026624917984, mean p set: 0.45275095105171204
loss_pred:0.016176028177142143, decouple_loss:0.0010671984637156129
loss_pred:0.017875494435429573, decouple_loss:0.0009985334472730756
Iteration: 414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508700668811798, gen p mean: -0.041148193180561066, mean p set: 0.4513503611087799
loss_pred:0.01771283522248268, decouple_loss:0.0009044262696988881
The modified gen p mean: 0.45169728994369507, gen p mean: -0.038671717047691345, mean p set: 0.4521775543689728The modified gen p mean: 0.45151379704475403, gen p mean: -0.03901888430118561, mean p set: 0.4519941210746765
loss_pred:0.017864655703306198, decouple_loss:0.0009018746204674244
loss_pred:0.01723298244178295, decouple_loss:0.0009135049767792225
Iteration: 415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505690634250641, gen p mean: -0.038326945155858994, mean p set: 0.4510493874549866
loss_pred:0.018420666456222534, decouple_loss:0.0009709966252557933
The modified gen p mean: 0.4508441090583801, gen p mean: -0.04776985943317413, mean p set: 0.4513244330883026The modified gen p mean: 0.4536548852920532, gen p mean: -0.04185514897108078, mean p set: 0.4541351795196533
loss_pred:0.016324270516633987, decouple_loss:0.0009320293320342898
loss_pred:0.017764929682016373, decouple_loss:0.0009761438122950494
Iteration: 416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45104166865348816, gen p mean: -0.04909196496009827, mean p set: 0.45152196288108826
loss_pred:0.01761382818222046, decouple_loss:0.0009830368217080832
The modified gen p mean: 0.45096471905708313, gen p mean: -0.04639117047190666, mean p set: 0.4514450132846832The modified gen p mean: 0.4498565196990967, gen p mean: -0.047037068754434586, mean p set: 0.4503368139266968
loss_pred:0.01751864142715931, decouple_loss:0.0008677743026055396
loss_pred:0.01744864135980606, decouple_loss:0.0009209570707753301
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450771301984787, gen p mean: -0.04461997374892235, mean p set: 0.4512515664100647
loss_pred:0.015283082611858845, decouple_loss:0.0012192846043035388
The modified gen p mean: 0.45044636726379395, gen p mean: -0.047825660556554794, mean p set: 0.45092666149139404The modified gen p mean: 0.45058080554008484, gen p mean: -0.046600230038166046, mean p set: 0.45106109976768494
loss_pred:0.014753066003322601, decouple_loss:0.0009364320430904627
loss_pred:0.01518678292632103, decouple_loss:0.0009256862686015666
Iteration: 418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475288987159729, gen p mean: -0.045429643243551254, mean p set: 0.448009192943573
loss_pred:0.014879361726343632, decouple_loss:0.0009574294672347605
The modified gen p mean: 0.45016369223594666, gen p mean: -0.047073833644390106, mean p set: 0.45064398646354675The modified gen p mean: 0.4504186511039734, gen p mean: -0.0472790002822876, mean p set: 0.4508989155292511
loss_pred:0.014601519331336021, decouple_loss:0.0009131719707511365
loss_pred:0.014227548614144325, decouple_loss:0.0009200620115734637
Iteration: 419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495620131492615, gen p mean: -0.045966219156980515, mean p set: 0.4500423073768616
loss_pred:0.015089720487594604, decouple_loss:0.0010840013856068254
The modified gen p mean: 0.45011699199676514, gen p mean: -0.04837207868695259, mean p set: 0.4505973160266876The modified gen p mean: 0.4479568898677826, gen p mean: -0.050557080656290054, mean p set: 0.44843724370002747
loss_pred:0.014965934678912163, decouple_loss:0.0010471974965184927
loss_pred:0.014846442267298698, decouple_loss:0.0010441767517477274
Iteration: 420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472403824329376, gen p mean: -0.0474768802523613, mean p set: 0.4477207064628601
loss_pred:0.014349167235195637, decouple_loss:0.0010878767352551222
The modified gen p mean: 0.4499109387397766, gen p mean: -0.04515650123357773, mean p set: 0.4503912329673767The modified gen p mean: 0.4500688910484314, gen p mean: -0.04548267647624016, mean p set: 0.4505492150783539
loss_pred:0.013881915248930454, decouple_loss:0.0011431851889938116
loss_pred:0.014174371026456356, decouple_loss:0.0011731458362191916
2023-04-30 05:17:50 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.047783464193344116, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04291035979986191, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04353051260113716, mean p set: 0.4500633478164673
loss_pred:0.0187750943005085, decouple_loss:0.0012002642033621669
loss_pred:0.01770460605621338, decouple_loss:0.00120950723066926
loss_pred:0.01774735376238823, decouple_loss:0.001162880682386458
WV_0_PC_1_EH_0_PS_40, loss: 0.018135229125618935, avg_mse: 0.026111796498298645
current test mse: 0.026112
Iteration: 421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498547613620758, gen p mean: -0.0419132262468338, mean p set: 0.4503350555896759
The modified gen p mean: 0.4494165778160095, gen p mean: -0.04620107635855675, mean p set: 0.4498968720436096
The modified gen p mean: 0.44910553097724915, gen p mean: -0.04663567245006561, mean p set: 0.44958579540252686
loss_pred:0.014902754686772823, decouple_loss:0.0011803689412772655
loss_pred:0.014262684620916843, decouple_loss:0.0012010637437924743
loss_pred:0.01381278783082962, decouple_loss:0.0012522503966465592
Iteration: 422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502202570438385, gen p mean: -0.04284735396504402, mean p set: 0.4507005214691162
loss_pred:0.013779498636722565, decouple_loss:0.0011656178394332528
The modified gen p mean: 0.45020556449890137, gen p mean: -0.043097518384456635, mean p set: 0.4506858289241791The modified gen p mean: 0.45034259557724, gen p mean: -0.04629043862223625, mean p set: 0.4508228898048401
loss_pred:0.013811931945383549, decouple_loss:0.0011621946468949318
loss_pred:0.013991394080221653, decouple_loss:0.001346608973108232
Iteration: 423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489338994026184, gen p mean: -0.04338683933019638, mean p set: 0.4494141638278961
loss_pred:0.014738157391548157, decouple_loss:0.0011760522611439228
The modified gen p mean: 0.4493190050125122, gen p mean: -0.04436627775430679, mean p set: 0.4497992694377899The modified gen p mean: 0.44836828112602234, gen p mean: -0.04586290568113327, mean p set: 0.44884857535362244
loss_pred:0.014049110002815723, decouple_loss:0.0012238351628184319
loss_pred:0.01358100026845932, decouple_loss:0.0012673260644078255
Iteration: 424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448871374130249, gen p mean: -0.04448579251766205, mean p set: 0.4493516683578491
loss_pred:0.014023364521563053, decouple_loss:0.0014242409961298108
The modified gen p mean: 0.4472036063671112, gen p mean: -0.04400189593434334, mean p set: 0.4476839303970337The modified gen p mean: 0.4487534165382385, gen p mean: -0.0403742715716362, mean p set: 0.4492337107658386
loss_pred:0.013498199172317982, decouple_loss:0.0013268559705466032
loss_pred:0.013522903434932232, decouple_loss:0.001270444830879569
Iteration: 425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499286115169525, gen p mean: -0.04473605006933212, mean p set: 0.450408935546875
loss_pred:0.013124843128025532, decouple_loss:0.0014559653354808688
The modified gen p mean: 0.449405699968338, gen p mean: -0.048723332583904266, mean p set: 0.4498860538005829The modified gen p mean: 0.4494454860687256, gen p mean: -0.045897625386714935, mean p set: 0.4499257802963257
loss_pred:0.013721460476517677, decouple_loss:0.0013975726906210184
loss_pred:0.013793881051242352, decouple_loss:0.001523060374893248
Iteration: 426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502430558204651, gen p mean: -0.040522702038288116, mean p set: 0.4507233798503876
loss_pred:0.014084185473620892, decouple_loss:0.0014032338513061404
The modified gen p mean: 0.4490104019641876, gen p mean: -0.04227965697646141, mean p set: 0.44949066638946533The modified gen p mean: 0.44892197847366333, gen p mean: -0.045729391276836395, mean p set: 0.4494022727012634
loss_pred:0.014348180964589119, decouple_loss:0.0014634940307587385
loss_pred:0.014795874245464802, decouple_loss:0.0013090606080368161
Iteration: 427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496975243091583, gen p mean: -0.0417594313621521, mean p set: 0.4501778185367584
loss_pred:0.013832299038767815, decouple_loss:0.0014559869887307286
The modified gen p mean: 0.4496532380580902, gen p mean: -0.04600100591778755, mean p set: 0.4501335322856903The modified gen p mean: 0.4475174844264984, gen p mean: -0.04377361759543419, mean p set: 0.4479977786540985
loss_pred:0.013557723723351955, decouple_loss:0.001744380104355514
loss_pred:0.013661078177392483, decouple_loss:0.0016160887898877263
Iteration: 428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44891074299812317, gen p mean: -0.04967852681875229, mean p set: 0.44939103722572327
loss_pred:0.013757445849478245, decouple_loss:0.0016944071976467967
The modified gen p mean: 0.4494415521621704, gen p mean: -0.05242854729294777, mean p set: 0.4499218463897705The modified gen p mean: 0.45028233528137207, gen p mean: -0.048746127635240555, mean p set: 0.45076262950897217
loss_pred:0.013784840703010559, decouple_loss:0.0016724355518817902
loss_pred:0.013348168693482876, decouple_loss:0.0015980940079316497
Iteration: 429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490760862827301, gen p mean: -0.052253756672143936, mean p set: 0.4495563805103302
loss_pred:0.013715973123908043, decouple_loss:0.001597724505700171
The modified gen p mean: 0.4502854347229004, gen p mean: -0.04449569806456566, mean p set: 0.4507656991481781The modified gen p mean: 0.44787970185279846, gen p mean: -0.045726384967565536, mean p set: 0.44835996627807617
loss_pred:0.01342655997723341, decouple_loss:0.001523512415587902
loss_pred:0.013864175416529179, decouple_loss:0.001549385953694582
Iteration: 430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44825124740600586, gen p mean: -0.047249648720026016, mean p set: 0.44873154163360596
loss_pred:0.013325330801308155, decouple_loss:0.0017609625356271863
The modified gen p mean: 0.4505392014980316, gen p mean: -0.04451674968004227, mean p set: 0.4510194957256317The modified gen p mean: 0.447736918926239, gen p mean: -0.04601036012172699, mean p set: 0.4482172131538391
loss_pred:0.013156057335436344, decouple_loss:0.0015930254012346268
loss_pred:0.013465296477079391, decouple_loss:0.0017071733018383384
2023-04-30 05:19:44 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.051797978579998016, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04699568450450897, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830237865448, gen p mean: -0.04743311181664467, mean p set: 0.4500633478164673
loss_pred:0.01957445964217186, decouple_loss:0.0015643708175048232
loss_pred:0.018423637375235558, decouple_loss:0.0015403998550027609
loss_pred:0.018519451841711998, decouple_loss:0.0014931432669982314
WV_0_PC_1_EH_0_PS_40, loss: 0.01891581527888775, avg_mse: 0.027547219768166542
current test mse: 0.027547
Iteration: 431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490041136741638, gen p mean: -0.05639209970831871, mean p set: 0.4494844079017639
The modified gen p mean: 0.4496974050998688, gen p mean: -0.04935181885957718, mean p set: 0.45017769932746887
The modified gen p mean: 0.44959110021591187, gen p mean: -0.04658516123890877, mean p set: 0.45007139444351196
loss_pred:0.01346178911626339, decouple_loss:0.0015424394514411688
loss_pred:0.013615495525300503, decouple_loss:0.0015276969643309712
loss_pred:0.013036087155342102, decouple_loss:0.0015722764655947685
Iteration: 432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505947232246399, gen p mean: -0.05188458785414696, mean p set: 0.4510750472545624
loss_pred:0.013164502568542957, decouple_loss:0.0015487093478441238
The modified gen p mean: 0.4500133991241455, gen p mean: -0.04579686373472214, mean p set: 0.4504936933517456The modified gen p mean: 0.449002742767334, gen p mean: -0.05187626928091049, mean p set: 0.4494830369949341
loss_pred:0.013012848794460297, decouple_loss:0.0015869461931288242
loss_pred:0.012606585398316383, decouple_loss:0.0015540162567049265
Iteration: 433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494202435016632, gen p mean: -0.044107675552368164, mean p set: 0.4499005675315857
The modified gen p mean: 0.4493323266506195, gen p mean: -0.05046386644244194, mean p set: 0.4498126208782196
loss_pred:0.012856435030698776, decouple_loss:0.0013533529127016664
loss_pred:0.013300121761858463, decouple_loss:0.0014735746663063765
The modified gen p mean: 0.44905534386634827, gen p mean: -0.04437355697154999, mean p set: 0.44953563809394836
loss_pred:0.01297911349684, decouple_loss:0.0014503920683637261
Iteration: 434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44922763109207153, gen p mean: -0.047685202211141586, mean p set: 0.449707955121994
The modified gen p mean: 0.44951102137565613, gen p mean: -0.046044815331697464, mean p set: 0.4499913156032562
loss_pred:0.013016548939049244, decouple_loss:0.0014843845274299383
loss_pred:0.012779713608324528, decouple_loss:0.0014613645616918802
The modified gen p mean: 0.4504387676715851, gen p mean: -0.045607585459947586, mean p set: 0.4509190618991852
loss_pred:0.013291636481881142, decouple_loss:0.001483419444411993
Iteration: 435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487708508968353, gen p mean: -0.04679998382925987, mean p set: 0.4492511451244354
loss_pred:0.01348094828426838, decouple_loss:0.001419536885805428
The modified gen p mean: 0.4484518766403198, gen p mean: -0.04513014107942581, mean p set: 0.4489321708679199The modified gen p mean: 0.448622465133667, gen p mean: -0.04619458690285683, mean p set: 0.4491027593612671
loss_pred:0.013069788925349712, decouple_loss:0.0013792020035907626
loss_pred:0.013439778238534927, decouple_loss:0.0013849386014044285
Iteration: 436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449152410030365, gen p mean: -0.05301285162568092, mean p set: 0.4496326744556427
loss_pred:0.013045690953731537, decouple_loss:0.0013816887512803078
The modified gen p mean: 0.4484119117259979, gen p mean: -0.046168167144060135, mean p set: 0.44889214634895325The modified gen p mean: 0.4483104348182678, gen p mean: -0.04643140360713005, mean p set: 0.4487907588481903
loss_pred:0.013319630175828934, decouple_loss:0.0014969230396673083
loss_pred:0.013388341292738914, decouple_loss:0.0014392138691619039
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
NaN value num: 0
Iteration: 437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502499997615814, gen p mean: -0.05041983723640442, mean p set: 0.4507302939891815
loss_pred:0.01960362307727337, decouple_loss:0.001806371845304966
The modified gen p mean: 0.45021581649780273, gen p mean: -0.05613037198781967, mean p set: 0.45069611072540283The modified gen p mean: 0.4498160481452942, gen p mean: -0.04578791558742523, mean p set: 0.4502963423728943
loss_pred:0.019017251208424568, decouple_loss:0.002053710864856839
loss_pred:0.018536318093538284, decouple_loss:0.0013949464773759246
Iteration: 438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019635558128357, gen p mean: -0.045105867087841034, mean p set: 0.4506766200065613
loss_pred:0.018637092784047127, decouple_loss:0.0015879193088039756
The modified gen p mean: 0.45033878087997437, gen p mean: -0.043386828154325485, mean p set: 0.45081907510757446
The modified gen p mean: 0.4509749412536621, gen p mean: -0.04123110696673393, mean p set: 0.4514552056789398
loss_pred:0.0188724584877491, decouple_loss:0.0016167652793228626
loss_pred:0.01971907913684845, decouple_loss:0.0016300430288538337
Iteration: 439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450664222240448, gen p mean: -0.03825705125927925, mean p set: 0.4511445164680481
loss_pred:0.019353220239281654, decouple_loss:0.0016553369350731373
The modified gen p mean: 0.4503313899040222, gen p mean: -0.03538786247372627, mean p set: 0.4508116841316223The modified gen p mean: 0.44987475872039795, gen p mean: -0.041004396975040436, mean p set: 0.45035505294799805
loss_pred:0.01917252503335476, decouple_loss:0.0016646904405206442
loss_pred:0.01898137293756008, decouple_loss:0.0017017557984218001
Iteration: 440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45062705874443054, gen p mean: -0.040047261863946915, mean p set: 0.451107382774353
loss_pred:0.01833212934434414, decouple_loss:0.001694643055088818
The modified gen p mean: 0.45052289962768555, gen p mean: -0.037482425570487976, mean p set: 0.45100319385528564The modified gen p mean: 0.44861987233161926, gen p mean: -0.03599333018064499, mean p set: 0.44910016655921936
loss_pred:0.018277861177921295, decouple_loss:0.0015923725441098213
loss_pred:0.01843831315636635, decouple_loss:0.001604059711098671
2023-04-30 05:22:17 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04204206168651581, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.037552207708358765, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.03811085969209671, mean p set: 0.4500633478164673
loss_pred:0.01899680495262146, decouple_loss:0.0015180170303210616
loss_pred:0.017911272123456, decouple_loss:0.0015834191581234336
loss_pred:0.017980482429265976, decouple_loss:0.0015519342850893736
WV_0_PC_1_EH_0_PS_40, loss: 0.018373742699623108, avg_mse: 0.0263690035790205
current test mse: 0.026369
Iteration: 441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497581422328949, gen p mean: -0.03835620731115341, mean p set: 0.450238436460495
The modified gen p mean: 0.4493718147277832, gen p mean: -0.04035215452313423, mean p set: 0.4498521387577057
The modified gen p mean: 0.4486290216445923, gen p mean: -0.04149460047483444, mean p set: 0.4491093158721924
loss_pred:0.018987881019711494, decouple_loss:0.0014798124320805073
loss_pred:0.01837148703634739, decouple_loss:0.0015031503280624747
loss_pred:0.019010253250598907, decouple_loss:0.0015195065643638372
Iteration: 442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44924396276474, gen p mean: -0.04656859487295151, mean p set: 0.4497242569923401
loss_pred:0.019459309056401253, decouple_loss:0.0017173116793856025
The modified gen p mean: 0.44914960861206055, gen p mean: -0.04569561779499054, mean p set: 0.44962990283966064The modified gen p mean: 0.44930556416511536, gen p mean: -0.04658619686961174, mean p set: 0.44978588819503784
loss_pred:0.019424477592110634, decouple_loss:0.0016822422621771693
loss_pred:0.019544469192624092, decouple_loss:0.0017484251875430346
Iteration: 443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502987563610077, gen p mean: -0.051154185086488724, mean p set: 0.4507790505886078
loss_pred:0.018903065472841263, decouple_loss:0.0018855739617720246
The modified gen p mean: 0.4498560428619385, gen p mean: -0.048527318984270096, mean p set: 0.4503363370895386The modified gen p mean: 0.45072245597839355, gen p mean: -0.05337962135672569, mean p set: 0.45120275020599365
loss_pred:0.01888522319495678, decouple_loss:0.00168409023899585
loss_pred:0.018015194684267044, decouple_loss:0.0019529438577592373
Iteration: 444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498802423477173, gen p mean: -0.051110122352838516, mean p set: 0.4503605365753174
loss_pred:0.01793409325182438, decouple_loss:0.0015745001146569848
The modified gen p mean: 0.450836181640625, gen p mean: -0.05191461741924286, mean p set: 0.4513164758682251The modified gen p mean: 0.45012757182121277, gen p mean: -0.05098281800746918, mean p set: 0.45060789585113525
loss_pred:0.018320076167583466, decouple_loss:0.001551916589960456
loss_pred:0.01847255416214466, decouple_loss:0.0015173206338658929
Iteration: 445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45012181997299194, gen p mean: -0.05899285897612572, mean p set: 0.45060214400291443
loss_pred:0.018389033153653145, decouple_loss:0.0016020520124584436
The modified gen p mean: 0.4505431056022644, gen p mean: -0.05918382480740547, mean p set: 0.4510233402252197The modified gen p mean: 0.45092812180519104, gen p mean: -0.05906933173537254, mean p set: 0.45140841603279114
loss_pred:0.018361050635576248, decouple_loss:0.0015478016575798392
loss_pred:0.018544068560004234, decouple_loss:0.0015652368310838938
Iteration: 446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45072975754737854, gen p mean: -0.06096993014216423, mean p set: 0.451210081577301
The modified gen p mean: 0.4512108862400055, gen p mean: -0.05858505889773369, mean p set: 0.451691210269928
loss_pred:0.017951687797904015, decouple_loss:0.0015491344965994358
loss_pred:0.017802752554416656, decouple_loss:0.0015190966660156846
The modified gen p mean: 0.45071253180503845, gen p mean: -0.06119223311543465, mean p set: 0.45119279623031616
loss_pred:0.017949460074305534, decouple_loss:0.0015664644306525588
Iteration: 447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504499137401581, gen p mean: -0.06298674643039703, mean p set: 0.4509302079677582
loss_pred:0.01794574223458767, decouple_loss:0.0016354173421859741
The modified gen p mean: 0.45036381483078003, gen p mean: -0.052040521055459976, mean p set: 0.45084407925605774The modified gen p mean: 0.44876593351364136, gen p mean: -0.056185320019721985, mean p set: 0.44924622774124146
loss_pred:0.018838513642549515, decouple_loss:0.0014823394594714046
loss_pred:0.018069777637720108, decouple_loss:0.0015349092427641153
Iteration: 448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504632353782654, gen p mean: -0.05510507896542549, mean p set: 0.4509435296058655
loss_pred:0.018088871613144875, decouple_loss:0.001333363470621407
The modified gen p mean: 0.4509217143058777, gen p mean: -0.05577175319194794, mean p set: 0.4514020085334778The modified gen p mean: 0.4475768506526947, gen p mean: -0.05049508437514305, mean p set: 0.4480571150779724
loss_pred:0.01795385591685772, decouple_loss:0.0014054374769330025
loss_pred:0.018058519810438156, decouple_loss:0.0014549416955560446
Iteration: 449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491533041000366, gen p mean: -0.04934852942824364, mean p set: 0.4496335983276367
loss_pred:0.017460128292441368, decouple_loss:0.0013215874787420034
The modified gen p mean: 0.4507967233657837, gen p mean: -0.054960526525974274, mean p set: 0.4512770175933838The modified gen p mean: 0.44932565093040466, gen p mean: -0.049994096159935, mean p set: 0.4498059153556824
loss_pred:0.01800723187625408, decouple_loss:0.0013876117300242186
loss_pred:0.01828724704682827, decouple_loss:0.0013585493434220552
Iteration: 450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977468252182007, gen p mean: -0.050357937812805176, mean p set: 0.45025497674942017
loss_pred:0.018023977056145668, decouple_loss:0.0014555390225723386
The modified gen p mean: 0.45064085721969604, gen p mean: -0.05443451926112175, mean p set: 0.45112112164497375The modified gen p mean: 0.4502270221710205, gen p mean: -0.05244893208146095, mean p set: 0.4507073163986206
loss_pred:0.01743609458208084, decouple_loss:0.0016333401435986161
loss_pred:0.018539782613515854, decouple_loss:0.0015956686111167073
2023-04-30 05:24:10 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05008628964424133, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.045320089906454086, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04563345015048981, mean p set: 0.4500633478164673
loss_pred:0.018680736422538757, decouple_loss:0.001369146048091352
loss_pred:0.017615370452404022, decouple_loss:0.001359450863674283
loss_pred:0.017709482461214066, decouple_loss:0.001387427095323801
WV_0_PC_1_EH_0_PS_40, loss: 0.018070463091135025, avg_mse: 0.025862686336040497
current test mse: 0.025863
Iteration: 451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508408308029175, gen p mean: -0.05027233809232712, mean p set: 0.4513210952281952
The modified gen p mean: 0.4488905966281891, gen p mean: -0.04748295992612839, mean p set: 0.4493708908557892
The modified gen p mean: 0.4487893879413605, gen p mean: -0.0467563271522522, mean p set: 0.4492696523666382
loss_pred:0.017839478328824043, decouple_loss:0.0012762350961565971
loss_pred:0.017833145335316658, decouple_loss:0.001366008073091507
loss_pred:0.018635883927345276, decouple_loss:0.001228741486556828
Iteration: 452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45086774230003357, gen p mean: -0.0479455441236496, mean p set: 0.45134806632995605
loss_pred:0.0181430596858263, decouple_loss:0.0013431294355541468
The modified gen p mean: 0.4503542184829712, gen p mean: -0.04461408033967018, mean p set: 0.4508344829082489The modified gen p mean: 0.4474261403083801, gen p mean: -0.04402565211057663, mean p set: 0.4479064345359802
loss_pred:0.0177872683852911, decouple_loss:0.0013296849792823195
loss_pred:0.01777307689189911, decouple_loss:0.0013126746052876115
Iteration: 453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490281939506531, gen p mean: -0.04561200365424156, mean p set: 0.4495084881782532
loss_pred:0.01782011054456234, decouple_loss:0.001345306634902954
The modified gen p mean: 0.45106905698776245, gen p mean: -0.0477515384554863, mean p set: 0.45154935121536255The modified gen p mean: 0.45143359899520874, gen p mean: -0.048815030604600906, mean p set: 0.45191389322280884
loss_pred:0.018688073381781578, decouple_loss:0.0013996248599141836
loss_pred:0.017848696559667587, decouple_loss:0.0013891394482925534
Iteration: 454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018118619918823, gen p mean: -0.04819177836179733, mean p set: 0.45066148042678833
loss_pred:0.0175369530916214, decouple_loss:0.0012259104987606406
The modified gen p mean: 0.4486198127269745, gen p mean: -0.045469049364328384, mean p set: 0.4491001069545746The modified gen p mean: 0.4506102502346039, gen p mean: -0.051446132361888885, mean p set: 0.451090544462204
loss_pred:0.01756701059639454, decouple_loss:0.0012400728883221745
loss_pred:0.01727919466793537, decouple_loss:0.0012876985128968954
Iteration: 455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498402774333954, gen p mean: -0.05211937054991722, mean p set: 0.4503205716609955
loss_pred:0.017849110066890717, decouple_loss:0.0012662728549912572
The modified gen p mean: 0.4497682750225067, gen p mean: -0.04327383637428284, mean p set: 0.4502485692501068The modified gen p mean: 0.44862794876098633, gen p mean: -0.050498247146606445, mean p set: 0.44910821318626404
loss_pred:0.018011560663580894, decouple_loss:0.0012799024116247892
loss_pred:0.018316887319087982, decouple_loss:0.0013099941425025463
Iteration: 456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491064250469208, gen p mean: -0.044443681836128235, mean p set: 0.44958674907684326
loss_pred:0.018261902034282684, decouple_loss:0.0011836193734779954
The modified gen p mean: 0.45089563727378845, gen p mean: -0.04860858619213104, mean p set: 0.45137593150138855The modified gen p mean: 0.4492305517196655, gen p mean: -0.042757075279951096, mean p set: 0.449710875749588
loss_pred:0.018444012850522995, decouple_loss:0.001276504946872592
loss_pred:0.018360506743192673, decouple_loss:0.0011925717117264867
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
NaN value num: 0
Iteration: 457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466509222984314, gen p mean: -0.044400110840797424, mean p set: 0.4471311867237091
loss_pred:0.01739571802318096, decouple_loss:0.0012719347141683102
The modified gen p mean: 0.4467600882053375, gen p mean: -0.043725594878196716, mean p set: 0.4472403824329376The modified gen p mean: 0.44701701402664185, gen p mean: -0.04688356816768646, mean p set: 0.44749733805656433
loss_pred:0.018153846263885498, decouple_loss:0.001287048333324492
loss_pred:0.018395358696579933, decouple_loss:0.0012804740108549595
Iteration: 458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463377296924591, gen p mean: -0.049141962081193924, mean p set: 0.4468180239200592
loss_pred:0.01818128488957882, decouple_loss:0.001131259254179895
The modified gen p mean: 0.44619181752204895, gen p mean: -0.04171348363161087, mean p set: 0.44667208194732666The modified gen p mean: 0.448067307472229, gen p mean: -0.04298410937190056, mean p set: 0.4485476016998291
loss_pred:0.017233502119779587, decouple_loss:0.0011425813427194953
loss_pred:0.017742013558745384, decouple_loss:0.0012395813828334212
Iteration: 459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459577202796936, gen p mean: -0.0432094968855381, mean p set: 0.4464380145072937
loss_pred:0.017126116901636124, decouple_loss:0.0011296443408355117
The modified gen p mean: 0.44637051224708557, gen p mean: -0.04231861233711243, mean p set: 0.4468507766723633The modified gen p mean: 0.4458196759223938, gen p mean: -0.0397464893758297, mean p set: 0.4462999701499939
loss_pred:0.01723717898130417, decouple_loss:0.0011375655885785818
loss_pred:0.018298381939530373, decouple_loss:0.0012365520233288407
Iteration: 460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44649064540863037, gen p mean: -0.041612181812524796, mean p set: 0.4469709098339081
loss_pred:0.017597291618585587, decouple_loss:0.0011857179924845695
The modified gen p mean: 0.4462193250656128, gen p mean: -0.04295576736330986, mean p set: 0.4466996490955353The modified gen p mean: 0.44573476910591125, gen p mean: -0.042995382100343704, mean p set: 0.44621503353118896
loss_pred:0.018366394564509392, decouple_loss:0.001166528440080583
loss_pred:0.017541876062750816, decouple_loss:0.0010984402615576982
2023-04-30 05:26:42 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04435126855969429, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0393405444920063, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04029819741845131, mean p set: 0.4500633478164673
loss_pred:0.018559230491518974, decouple_loss:0.0012004690943285823
loss_pred:0.017402036115527153, decouple_loss:0.0011588620254769921
loss_pred:0.017550602555274963, decouple_loss:0.0011607095366343856
WV_0_PC_1_EH_0_PS_40, loss: 0.017895959317684174, avg_mse: 0.025643158704042435
current test mse: 0.025643
Iteration: 461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465961754322052, gen p mean: -0.04073623567819595, mean p set: 0.4470764696598053
The modified gen p mean: 0.4472256004810333, gen p mean: -0.04473339766263962, mean p set: 0.44770586490631104
The modified gen p mean: 0.44582054018974304, gen p mean: -0.0436210073530674, mean p set: 0.44630083441734314
loss_pred:0.01816652901470661, decouple_loss:0.0010907225077971816
loss_pred:0.017740823328495026, decouple_loss:0.0010507559636607766loss_pred:0.017492106184363365, decouple_loss:0.0011480095563456416
Iteration: 462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44685351848602295, gen p mean: -0.042835306376218796, mean p set: 0.44733378291130066
loss_pred:0.018491022288799286, decouple_loss:0.0011055440409108996
The modified gen p mean: 0.4474465847015381, gen p mean: -0.04651696979999542, mean p set: 0.44792690873146057The modified gen p mean: 0.4455968141555786, gen p mean: -0.04451393336057663, mean p set: 0.4460771083831787
loss_pred:0.017715368419885635, decouple_loss:0.0011979732662439346
loss_pred:0.01753338798880577, decouple_loss:0.001050201477482915
Iteration: 463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44586387276649475, gen p mean: -0.0456036739051342, mean p set: 0.44634416699409485
loss_pred:0.01806734874844551, decouple_loss:0.0010700852144509554
The modified gen p mean: 0.4475557506084442, gen p mean: -0.04659462347626686, mean p set: 0.4480360448360443The modified gen p mean: 0.44793447852134705, gen p mean: -0.05231674015522003, mean p set: 0.44841480255126953
loss_pred:0.017295440658926964, decouple_loss:0.0011214431142434478
loss_pred:0.017039749771356583, decouple_loss:0.0010849804384633899
Iteration: 464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461541473865509, gen p mean: -0.046423427760601044, mean p set: 0.4466344118118286
loss_pred:0.017817560583353043, decouple_loss:0.0011403969256207347
The modified gen p mean: 0.44588515162467957, gen p mean: -0.049047429114580154, mean p set: 0.44636544585227966The modified gen p mean: 0.4468127191066742, gen p mean: -0.04841884970664978, mean p set: 0.4472929835319519
loss_pred:0.017839759588241577, decouple_loss:0.0010148792061954737
loss_pred:0.017053479328751564, decouple_loss:0.0010079627390950918
Iteration: 465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475141763687134, gen p mean: -0.04802265018224716, mean p set: 0.4479944705963135
The modified gen p mean: 0.4488474428653717, gen p mean: -0.046332672238349915, mean p set: 0.4493277370929718
loss_pred:0.018093964084982872, decouple_loss:0.0012099248124286532
loss_pred:0.016802426427602768, decouple_loss:0.0012161352206021547
The modified gen p mean: 0.44578951597213745, gen p mean: -0.04675083979964256, mean p set: 0.44626984000205994
loss_pred:0.018009889870882034, decouple_loss:0.001203371211886406
Iteration: 466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463740587234497, gen p mean: -0.05175676569342613, mean p set: 0.4468543529510498
loss_pred:0.017971254885196686, decouple_loss:0.001026986283250153
The modified gen p mean: 0.4468720257282257, gen p mean: -0.05158739164471626, mean p set: 0.4473523199558258The modified gen p mean: 0.4469824731349945, gen p mean: -0.048351965844631195, mean p set: 0.4474627375602722
loss_pred:0.0168022308498621, decouple_loss:0.001032332656905055
loss_pred:0.01826813817024231, decouple_loss:0.0010628732852637768
Iteration: 467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456685483455658, gen p mean: -0.05063650757074356, mean p set: 0.4461488425731659
loss_pred:0.017682768404483795, decouple_loss:0.0009877115953713655
The modified gen p mean: 0.4454819858074188, gen p mean: -0.050380121916532516, mean p set: 0.4459622800350189The modified gen p mean: 0.4486481547355652, gen p mean: -0.05115877836942673, mean p set: 0.44912847876548767
loss_pred:0.01685134880244732, decouple_loss:0.0009616351453587413
loss_pred:0.01757119968533516, decouple_loss:0.00103492580819875
Iteration: 468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459913671016693, gen p mean: -0.05341503396630287, mean p set: 0.4464716613292694
loss_pred:0.01720362715423107, decouple_loss:0.000999016803689301
The modified gen p mean: 0.44600093364715576, gen p mean: -0.05441725254058838, mean p set: 0.44648122787475586
The modified gen p mean: 0.44609305262565613, gen p mean: -0.05277829244732857, mean p set: 0.4465733468532562
loss_pred:0.017824633046984673, decouple_loss:0.0010308921337127686
loss_pred:0.017896676436066628, decouple_loss:0.0010566160781309009
Iteration: 469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44712796807289124, gen p mean: -0.0591026209294796, mean p set: 0.44760826230049133
loss_pred:0.017460599541664124, decouple_loss:0.0010661195265129209
The modified gen p mean: 0.4469850957393646, gen p mean: -0.054508309811353683, mean p set: 0.4474653899669647The modified gen p mean: 0.44811761379241943, gen p mean: -0.04942326247692108, mean p set: 0.44859790802001953
loss_pred:0.01809307187795639, decouple_loss:0.0010316951666027308
loss_pred:0.01707172952592373, decouple_loss:0.0010215381626039743
Iteration: 470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44633492827415466, gen p mean: -0.04623560234904289, mean p set: 0.4468151926994324
loss_pred:0.01744394563138485, decouple_loss:0.0009394966764375567
The modified gen p mean: 0.4462442696094513, gen p mean: -0.050258710980415344, mean p set: 0.4467245936393738The modified gen p mean: 0.44694778323173523, gen p mean: -0.04767756164073944, mean p set: 0.4474280774593353
loss_pred:0.017788495868444443, decouple_loss:0.0009784100111573935
loss_pred:0.0179913192987442, decouple_loss:0.0009791237534955144
2023-04-30 05:28:35 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.047370124608278275, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0421786904335022, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.043060533702373505, mean p set: 0.4500633478164673
loss_pred:0.018533844500780106, decouple_loss:0.0010351489763706923
loss_pred:0.0174156092107296, decouple_loss:0.0010464824736118317
loss_pred:0.017496123909950256, decouple_loss:0.0010334743419662118
WV_0_PC_1_EH_0_PS_40, loss: 0.017867110669612885, avg_mse: 0.025635359808802605
current test mse: 0.025635
Iteration: 471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44563257694244385, gen p mean: -0.045090366154909134, mean p set: 0.44611287117004395
The modified gen p mean: 0.4461958110332489, gen p mean: -0.04956568777561188, mean p set: 0.4466760754585266
The modified gen p mean: 0.44646114110946655, gen p mean: -0.0422285757958889, mean p set: 0.44694146513938904
loss_pred:0.017327716574072838, decouple_loss:0.0009344025747850537
loss_pred:0.017974384129047394, decouple_loss:0.0010298205306753516
loss_pred:0.017588399350643158, decouple_loss:0.0010086111724376678
Iteration: 472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469037353992462, gen p mean: -0.04664396494626999, mean p set: 0.4473839998245239
loss_pred:0.016953714191913605, decouple_loss:0.0009599896729923785
The modified gen p mean: 0.4456902742385864, gen p mean: -0.04508664086461067, mean p set: 0.4461705982685089The modified gen p mean: 0.44659650325775146, gen p mean: -0.046364475041627884, mean p set: 0.44707679748535156
loss_pred:0.01761097088456154, decouple_loss:0.0010108129354193807
loss_pred:0.018001757562160492, decouple_loss:0.0009687748970463872
Iteration: 473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464409351348877, gen p mean: -0.04642738029360771, mean p set: 0.4469212293624878
loss_pred:0.01728571578860283, decouple_loss:0.001038938295096159
The modified gen p mean: 0.44649001955986023, gen p mean: -0.04150569438934326, mean p set: 0.4469703137874603The modified gen p mean: 0.44824230670928955, gen p mean: -0.04844307154417038, mean p set: 0.44872260093688965
loss_pred:0.017713047564029694, decouple_loss:0.001033214619383216
loss_pred:0.016823720186948776, decouple_loss:0.0010292999213561416
Iteration: 474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680672883987427, gen p mean: -0.04925639554858208, mean p set: 0.44728702306747437
The modified gen p mean: 0.44762691855430603, gen p mean: -0.0471220389008522, mean p set: 0.44810721278190613
The modified gen p mean: 0.446292519569397, gen p mean: -0.04678814485669136, mean p set: 0.44677287340164185
loss_pred:0.017631111666560173, decouple_loss:0.0010068690171465278
loss_pred:0.017090080305933952, decouple_loss:0.0010045598028227687loss_pred:0.017743796110153198, decouple_loss:0.0010196702787652612
Iteration: 475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44643571972846985, gen p mean: -0.04495256021618843, mean p set: 0.44691601395606995
loss_pred:0.018260428681969643, decouple_loss:0.0009531115065328777
The modified gen p mean: 0.44668060541152954, gen p mean: -0.043180059641599655, mean p set: 0.44716089963912964The modified gen p mean: 0.44628211855888367, gen p mean: -0.04417167603969574, mean p set: 0.4467623829841614
loss_pred:0.018324516713619232, decouple_loss:0.0009650922147557139
loss_pred:0.01736333779990673, decouple_loss:0.0009050852386280894
Iteration: 476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445686012506485, gen p mean: -0.04562601447105408, mean p set: 0.4461663067340851
loss_pred:0.01784653216600418, decouple_loss:0.0009387384634464979
The modified gen p mean: 0.44696301221847534, gen p mean: -0.048423800617456436, mean p set: 0.44744330644607544The modified gen p mean: 0.4474918842315674, gen p mean: -0.04527859762310982, mean p set: 0.4479721784591675
loss_pred:0.01687225140631199, decouple_loss:0.0009347996674478054
loss_pred:0.016921518370509148, decouple_loss:0.0009734114282764494
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853314757347107, gen p mean: -0.04134036600589752, mean p set: 0.44901344180107117
loss_pred:0.016197569668293, decouple_loss:0.0009535768185742199
The modified gen p mean: 0.4490126073360443, gen p mean: -0.039618611335754395, mean p set: 0.4494929015636444The modified gen p mean: 0.4486909806728363, gen p mean: -0.040912557393312454, mean p set: 0.4491713047027588
loss_pred:0.01606554351747036, decouple_loss:0.000893649528734386
loss_pred:0.016000110656023026, decouple_loss:0.0010381180327385664
Iteration: 478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45011135935783386, gen p mean: -0.04663848131895065, mean p set: 0.45059165358543396
loss_pred:0.0158084686845541, decouple_loss:0.0009770517935976386
The modified gen p mean: 0.44885823130607605, gen p mean: -0.04539823532104492, mean p set: 0.44933852553367615
The modified gen p mean: 0.44955405592918396, gen p mean: -0.042896121740341187, mean p set: 0.45003435015678406
loss_pred:0.014695814810693264, decouple_loss:0.001033334992825985
loss_pred:0.015077554620802402, decouple_loss:0.0009471686789765954
Iteration: 479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45006632804870605, gen p mean: -0.03548192232847214, mean p set: 0.45054665207862854
loss_pred:0.015229691751301289, decouple_loss:0.00107975781429559
The modified gen p mean: 0.4495351314544678, gen p mean: -0.0367036834359169, mean p set: 0.4500153958797455The modified gen p mean: 0.45004016160964966, gen p mean: -0.03842845931649208, mean p set: 0.450520396232605
loss_pred:0.014826926402747631, decouple_loss:0.001052388921380043
loss_pred:0.015229659155011177, decouple_loss:0.0011806844267994165
Iteration: 480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479248821735382, gen p mean: -0.03326989710330963, mean p set: 0.4484051764011383
loss_pred:0.015126826241612434, decouple_loss:0.0010277157416567206
The modified gen p mean: 0.44943416118621826, gen p mean: -0.041070349514484406, mean p set: 0.44991445541381836The modified gen p mean: 0.4510590434074402, gen p mean: -0.03181002289056778, mean p set: 0.4515393376350403
loss_pred:0.014941131696105003, decouple_loss:0.0010435653384774923
loss_pred:0.015255306847393513, decouple_loss:0.0012157211313024163
2023-04-30 05:31:07 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.03844858705997467, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.033924732357263565, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.03459717333316803, mean p set: 0.4500633478164673
loss_pred:0.019000759348273277, decouple_loss:0.00125962495803833
loss_pred:0.017831293866038322, decouple_loss:0.0011866874992847443
loss_pred:0.0179195087403059, decouple_loss:0.0012301042443141341
WV_0_PC_1_EH_0_PS_40, loss: 0.018311794847249985, avg_mse: 0.026433000341057777
current test mse: 0.026433
Iteration: 481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496171176433563, gen p mean: -0.03409990668296814, mean p set: 0.4500974118709564
The modified gen p mean: 0.44852790236473083, gen p mean: -0.03808978945016861, mean p set: 0.4490082263946533
The modified gen p mean: 0.4487936794757843, gen p mean: -0.031207505613565445, mean p set: 0.4492739737033844
loss_pred:0.015155713073909283, decouple_loss:0.001129508251324296
loss_pred:0.014489682391285896, decouple_loss:0.0010986352572217584
loss_pred:0.014095648191869259, decouple_loss:0.001195481396280229
Iteration: 482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44851455092430115, gen p mean: -0.03276324272155762, mean p set: 0.44899484515190125
loss_pred:0.0154672060161829, decouple_loss:0.0011632591485977173
The modified gen p mean: 0.449035108089447, gen p mean: -0.028550846502184868, mean p set: 0.4495154023170471The modified gen p mean: 0.449282169342041, gen p mean: -0.03295544534921646, mean p set: 0.4497624933719635
loss_pred:0.014926865696907043, decouple_loss:0.0011931097833439708
loss_pred:0.014520288445055485, decouple_loss:0.0012003480223938823
Iteration: 483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488747715950012, gen p mean: -0.03834119439125061, mean p set: 0.4493550956249237
loss_pred:0.014668810181319714, decouple_loss:0.0013697086833417416
The modified gen p mean: 0.4483445882797241, gen p mean: -0.03509464114904404, mean p set: 0.4488248825073242The modified gen p mean: 0.4483950436115265, gen p mean: -0.03356504812836647, mean p set: 0.4488753378391266
loss_pred:0.014624157920479774, decouple_loss:0.0012672585435211658
loss_pred:0.014788606204092503, decouple_loss:0.0013312475057318807
Iteration: 484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478103518486023, gen p mean: -0.043528761714696884, mean p set: 0.44829061627388
loss_pred:0.01404746063053608, decouple_loss:0.0012790185865014791
The modified gen p mean: 0.448900431394577, gen p mean: -0.035954833030700684, mean p set: 0.4493807256221771The modified gen p mean: 0.44784530997276306, gen p mean: -0.04442525655031204, mean p set: 0.44832560420036316
loss_pred:0.014349913224577904, decouple_loss:0.001294612535275519
loss_pred:0.013801125809550285, decouple_loss:0.0014458042569458485
Iteration: 485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479655921459198, gen p mean: -0.04883865267038345, mean p set: 0.4484458863735199
loss_pred:0.014063425362110138, decouple_loss:0.001351254410110414
The modified gen p mean: 0.4480951428413391, gen p mean: -0.0445726215839386, mean p set: 0.4485754370689392
The modified gen p mean: 0.44800862669944763, gen p mean: -0.0478673130273819, mean p set: 0.44848892092704773
loss_pred:0.014616643078625202, decouple_loss:0.0014217335265129805
loss_pred:0.014582839794456959, decouple_loss:0.0013987553538754582
Iteration: 486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493091106414795, gen p mean: -0.047425419092178345, mean p set: 0.4497894048690796
loss_pred:0.013816856779158115, decouple_loss:0.001418375177308917
The modified gen p mean: 0.4490712583065033, gen p mean: -0.05078738555312157, mean p set: 0.4495515525341034The modified gen p mean: 0.44823217391967773, gen p mean: -0.053821414709091187, mean p set: 0.44871246814727783
loss_pred:0.01369045116007328, decouple_loss:0.0015220872592180967
loss_pred:0.014231677167117596, decouple_loss:0.0014378917403519154
Iteration: 487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499236047267914, gen p mean: -0.05307711288332939, mean p set: 0.4504038989543915
loss_pred:0.014044743031263351, decouple_loss:0.0014067012816667557
The modified gen p mean: 0.45069214701652527, gen p mean: -0.04727744311094284, mean p set: 0.451172411441803
The modified gen p mean: 0.44893208146095276, gen p mean: -0.05004141479730606, mean p set: 0.44941237568855286
loss_pred:0.014222740195691586, decouple_loss:0.0015154194552451372
loss_pred:0.01434622798115015, decouple_loss:0.0014581974828615785
Iteration: 488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494500756263733, gen p mean: -0.057763416320085526, mean p set: 0.4499303698539734
loss_pred:0.014740850776433945, decouple_loss:0.0014115077210590243
The modified gen p mean: 0.44923946261405945, gen p mean: -0.04945897310972214, mean p set: 0.44971972703933716The modified gen p mean: 0.44982975721359253, gen p mean: -0.051972243934869766, mean p set: 0.450310081243515
loss_pred:0.01394857931882143, decouple_loss:0.0013332664966583252
loss_pred:0.014317761175334454, decouple_loss:0.0014456941280514002
Iteration: 489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44956347346305847, gen p mean: -0.04641442000865936, mean p set: 0.45004376769065857
loss_pred:0.013399447314441204, decouple_loss:0.001434342935681343
The modified gen p mean: 0.44948524236679077, gen p mean: -0.04621417820453644, mean p set: 0.44996556639671326The modified gen p mean: 0.44879260659217834, gen p mean: -0.04770057648420334, mean p set: 0.44927287101745605
loss_pred:0.013899242505431175, decouple_loss:0.001466761459596455
loss_pred:0.014279940165579319, decouple_loss:0.0014832288725301623
Iteration: 490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44861987233161926, gen p mean: -0.03931469842791557, mean p set: 0.44910016655921936
loss_pred:0.014200588688254356, decouple_loss:0.0014313088031485677
The modified gen p mean: 0.4490033984184265, gen p mean: -0.04453570768237114, mean p set: 0.4494836926460266The modified gen p mean: 0.4479435980319977, gen p mean: -0.04404284432530403, mean p set: 0.44842392206192017
loss_pred:0.013093546032905579, decouple_loss:0.0015547069488093257
loss_pred:0.013401678763329983, decouple_loss:0.0014322551432996988
2023-04-30 05:33:01 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0419938862323761, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0376286655664444, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.03797031193971634, mean p set: 0.4500633478164673
loss_pred:0.019365476444363594, decouple_loss:0.0016803661128506064
loss_pred:0.01823650300502777, decouple_loss:0.001535938703455031
loss_pred:0.018386784940958023, decouple_loss:0.0015386973973363638
WV_0_PC_1_EH_0_PS_40, loss: 0.018742172047495842, avg_mse: 0.027274558320641518
current test mse: 0.027275
Iteration: 491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491003453731537, gen p mean: -0.03880857303738594, mean p set: 0.4495806396007538
The modified gen p mean: 0.4494502544403076, gen p mean: -0.03648187965154648, mean p set: 0.4499305486679077
The modified gen p mean: 0.4475609362125397, gen p mean: -0.04431689530611038, mean p set: 0.4480412006378174
loss_pred:0.013684842735528946, decouple_loss:0.0015836387174203992
loss_pred:0.0134520772844553, decouple_loss:0.0015190828125923872
loss_pred:0.013371113687753677, decouple_loss:0.0015195595333352685
Iteration: 492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849181175231934, gen p mean: -0.036105964332818985, mean p set: 0.44897210597991943
loss_pred:0.01398114487528801, decouple_loss:0.0014534734655171633
The modified gen p mean: 0.4492962062358856, gen p mean: -0.03466325253248215, mean p set: 0.44977647066116333The modified gen p mean: 0.44937968254089355, gen p mean: -0.031363535672426224, mean p set: 0.44986000657081604
loss_pred:0.013812799006700516, decouple_loss:0.0013472948921844363
loss_pred:0.013803720474243164, decouple_loss:0.0013807336799800396
Iteration: 493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862130284309387, gen p mean: -0.03762916475534439, mean p set: 0.44910159707069397
loss_pred:0.013852751813828945, decouple_loss:0.0013451635604724288
The modified gen p mean: 0.44823336601257324, gen p mean: -0.039460279047489166, mean p set: 0.4487136900424957The modified gen p mean: 0.44916248321533203, gen p mean: -0.03283822536468506, mean p set: 0.44964277744293213
loss_pred:0.014296169392764568, decouple_loss:0.001502519240602851
loss_pred:0.014193790033459663, decouple_loss:0.001437967293895781
Iteration: 494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478776156902313, gen p mean: -0.039855703711509705, mean p set: 0.4483579099178314
loss_pred:0.013149729929864407, decouple_loss:0.0013596644857898355
The modified gen p mean: 0.4498286545276642, gen p mean: -0.036759838461875916, mean p set: 0.4503089487552643The modified gen p mean: 0.44875583052635193, gen p mean: -0.04159814491868019, mean p set: 0.449236124753952
loss_pred:0.013031684793531895, decouple_loss:0.0013103735400363803
loss_pred:0.013358267955482006, decouple_loss:0.001351304934360087
Iteration: 495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802820682525635, gen p mean: -0.04560223966836929, mean p set: 0.44850850105285645
loss_pred:0.013257206417620182, decouple_loss:0.0013026875676587224
The modified gen p mean: 0.44786709547042847, gen p mean: -0.042829521000385284, mean p set: 0.44834738969802856The modified gen p mean: 0.4492180645465851, gen p mean: -0.04395459592342377, mean p set: 0.4496983587741852
loss_pred:0.013225909322500229, decouple_loss:0.0013031121343374252
loss_pred:0.014045416377484798, decouple_loss:0.0013398927403613925
Iteration: 496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44851556420326233, gen p mean: -0.03929648548364639, mean p set: 0.4489958584308624
The modified gen p mean: 0.44827431440353394, gen p mean: -0.04743743687868118, mean p set: 0.4487546384334564
loss_pred:0.013927595689892769, decouple_loss:0.0013106645783409476
loss_pred:0.014027068391442299, decouple_loss:0.0013151055900380015
The modified gen p mean: 0.4490082561969757, gen p mean: -0.04200420901179314, mean p set: 0.4494885504245758
loss_pred:0.014456597156822681, decouple_loss:0.0013457398163154721
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
NaN value num: 0
Iteration: 497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45120471715927124, gen p mean: -0.0381721593439579, mean p set: 0.45168498158454895
loss_pred:0.019434509798884392, decouple_loss:0.001435440848581493
The modified gen p mean: 0.45307889580726624, gen p mean: -0.0422762930393219, mean p set: 0.45355919003486633The modified gen p mean: 0.4505513906478882, gen p mean: -0.042070142924785614, mean p set: 0.4510316848754883
loss_pred:0.01966668851673603, decouple_loss:0.0013340850127860904
loss_pred:0.018334290012717247, decouple_loss:0.001420525717549026
Iteration: 498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530724287033081, gen p mean: -0.04178424924612045, mean p set: 0.4535527229309082
loss_pred:0.01969429850578308, decouple_loss:0.0013948117848485708
The modified gen p mean: 0.4534457325935364, gen p mean: -0.043865498155355453, mean p set: 0.4539260268211365The modified gen p mean: 0.4533480405807495, gen p mean: -0.03775378316640854, mean p set: 0.4538283348083496
loss_pred:0.018084581941366196, decouple_loss:0.001483831088989973
loss_pred:0.01905367709696293, decouple_loss:0.0013192782644182444
Iteration: 499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4537471532821655, gen p mean: -0.03852985426783562, mean p set: 0.45422741770744324
loss_pred:0.01831144280731678, decouple_loss:0.0013830227544531226
The modified gen p mean: 0.4496065676212311, gen p mean: -0.04340898245573044, mean p set: 0.4500868618488312The modified gen p mean: 0.4508505165576935, gen p mean: -0.03393131121993065, mean p set: 0.4513308107852936
loss_pred:0.0168162751942873, decouple_loss:0.0014575500972568989
loss_pred:0.018261386081576347, decouple_loss:0.0014100815169513226
Iteration: 500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533970057964325, gen p mean: -0.031759291887283325, mean p set: 0.4538773000240326
loss_pred:0.01974390633404255, decouple_loss:0.0014697815058752894
The modified gen p mean: 0.4523985683917999, gen p mean: -0.0339333713054657, mean p set: 0.45287883281707764The modified gen p mean: 0.45190173387527466, gen p mean: -0.03430972248315811, mean p set: 0.45238202810287476
loss_pred:0.016849851235747337, decouple_loss:0.0015338683733716607
loss_pred:0.016949230805039406, decouple_loss:0.0015584451612085104
2023-04-30 05:35:35 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.041689563542604446, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.037317391484975815, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.03757388889789581, mean p set: 0.4500633478164673
loss_pred:0.018846213817596436, decouple_loss:0.0014422143576666713
loss_pred:0.017768897116184235, decouple_loss:0.00137127039488405
loss_pred:0.017921609804034233, decouple_loss:0.0013526373077183962
WV_0_PC_1_EH_0_PS_40, loss: 0.018248341977596283, avg_mse: 0.026234813034534454
current test mse: 0.026235
Iteration: 501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451791375875473, gen p mean: -0.026627253741025925, mean p set: 0.45227164030075073
The modified gen p mean: 0.4514559805393219, gen p mean: -0.03473818674683571, mean p set: 0.451936274766922
The modified gen p mean: 0.44963768124580383, gen p mean: -0.038029469549655914, mean p set: 0.45011797547340393
loss_pred:0.016649862751364708, decouple_loss:0.0013511766446754336
loss_pred:0.019786382094025612, decouple_loss:0.0013779083965346217
loss_pred:0.01847456954419613, decouple_loss:0.0013772150268778205
Iteration: 502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521256983280182, gen p mean: -0.03621852397918701, mean p set: 0.4526059925556183
loss_pred:0.018901653587818146, decouple_loss:0.0014502130215987563
The modified gen p mean: 0.4525775909423828, gen p mean: -0.03357991576194763, mean p set: 0.4530578553676605The modified gen p mean: 0.4501403272151947, gen p mean: -0.03494769707322121, mean p set: 0.4506206214427948
loss_pred:0.016523975878953934, decouple_loss:0.0014445629203692079
loss_pred:0.019198961555957794, decouple_loss:0.0014325742376968265
Iteration: 503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45099908113479614, gen p mean: -0.03722134605050087, mean p set: 0.45147937536239624
loss_pred:0.017301643267273903, decouple_loss:0.0014114322839304805
The modified gen p mean: 0.4541676640510559, gen p mean: -0.03533249720931053, mean p set: 0.454647958278656The modified gen p mean: 0.45349958539009094, gen p mean: -0.036859337240457535, mean p set: 0.45397984981536865
loss_pred:0.01769176311790943, decouple_loss:0.0014220301527529955
loss_pred:0.016812827438116074, decouple_loss:0.0014490204630419612
Iteration: 504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45206931233406067, gen p mean: -0.03706064075231552, mean p set: 0.45254963636398315
loss_pred:0.01856471598148346, decouple_loss:0.001418950967490673
The modified gen p mean: 0.4529207944869995, gen p mean: -0.040915440768003464, mean p set: 0.4534010887145996The modified gen p mean: 0.45042169094085693, gen p mean: -0.04161503165960312, mean p set: 0.45090195536613464
loss_pred:0.017840469256043434, decouple_loss:0.0014817774062976241
loss_pred:0.017744481563568115, decouple_loss:0.0013901039492338896
Iteration: 505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495961666107178, gen p mean: -0.0433836430311203, mean p set: 0.4500764310359955
loss_pred:0.017729919403791428, decouple_loss:0.0014393383171409369
The modified gen p mean: 0.451896607875824, gen p mean: -0.04566836357116699, mean p set: 0.4523768723011017The modified gen p mean: 0.4518018662929535, gen p mean: -0.03757095709443092, mean p set: 0.452282190322876
loss_pred:0.01664046384394169, decouple_loss:0.0013429200043901801
loss_pred:0.01752226985991001, decouple_loss:0.001313496264629066
Iteration: 506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498823881149292, gen p mean: -0.049396809190511703, mean p set: 0.4503626525402069
loss_pred:0.017098834738135338, decouple_loss:0.0014733078423887491
The modified gen p mean: 0.4499393403530121, gen p mean: -0.051755886524915695, mean p set: 0.4504196047782898The modified gen p mean: 0.45113590359687805, gen p mean: -0.04649904742836952, mean p set: 0.45161619782447815
loss_pred:0.01626800373196602, decouple_loss:0.0014548469334840775
loss_pred:0.018353287130594254, decouple_loss:0.0013663072604686022
Iteration: 507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507195055484772, gen p mean: -0.04831605777144432, mean p set: 0.4511997699737549
loss_pred:0.017129365354776382, decouple_loss:0.0013541055377572775
The modified gen p mean: 0.4515368342399597, gen p mean: -0.04834995046257973, mean p set: 0.4520170986652374The modified gen p mean: 0.45300745964050293, gen p mean: -0.050858024507761, mean p set: 0.453487753868103
loss_pred:0.018052460625767708, decouple_loss:0.00134594168048352
loss_pred:0.018372269347310066, decouple_loss:0.0014262186596170068
Iteration: 508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508812725543976, gen p mean: -0.05204766243696213, mean p set: 0.45136159658432007
loss_pred:0.017228249460458755, decouple_loss:0.0013255850644782186
The modified gen p mean: 0.454966276884079, gen p mean: -0.05250684544444084, mean p set: 0.45544660091400146The modified gen p mean: 0.4548651874065399, gen p mean: -0.05323995649814606, mean p set: 0.45534548163414
loss_pred:0.017530901357531548, decouple_loss:0.001321168732829392
loss_pred:0.01694021187722683, decouple_loss:0.0013077033217996359
Iteration: 509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45329105854034424, gen p mean: -0.05562423914670944, mean p set: 0.4537713825702667
loss_pred:0.017859939485788345, decouple_loss:0.0012028043856844306
The modified gen p mean: 0.4521179795265198, gen p mean: -0.04887718707323074, mean p set: 0.45259830355644226The modified gen p mean: 0.45127907395362854, gen p mean: -0.05588671937584877, mean p set: 0.45175933837890625
loss_pred:0.018071921542286873, decouple_loss:0.0012374952202662826
loss_pred:0.016846947371959686, decouple_loss:0.001198178855702281
Iteration: 510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530890882015228, gen p mean: -0.05627264082431793, mean p set: 0.4535693824291229
loss_pred:0.01773689314723015, decouple_loss:0.001285224687308073
The modified gen p mean: 0.450214147567749, gen p mean: -0.05663930997252464, mean p set: 0.4506944417953491The modified gen p mean: 0.4514514207839966, gen p mean: -0.05739065259695053, mean p set: 0.4519317150115967
loss_pred:0.01761368103325367, decouple_loss:0.001330409082584083
loss_pred:0.01897842437028885, decouple_loss:0.0014007918071001768
2023-04-30 05:37:28 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.06259773671627045, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05754833668470383, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.058131713420152664, mean p set: 0.4500633478164673
loss_pred:0.018610963597893715, decouple_loss:0.0013946896651759744
loss_pred:0.0174858495593071, decouple_loss:0.0014514143113046885
loss_pred:0.017681756988167763, decouple_loss:0.0014297489542514086
WV_0_PC_1_EH_0_PS_40, loss: 0.01799745485186577, avg_mse: 0.025830881670117378
current test mse: 0.025831
Iteration: 511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45375755429267883, gen p mean: -0.054543402045965195, mean p set: 0.4542378783226013
The modified gen p mean: 0.4529380202293396, gen p mean: -0.04988308995962143, mean p set: 0.4534182846546173
The modified gen p mean: 0.4519538879394531, gen p mean: -0.0534849651157856, mean p set: 0.4524341821670532
loss_pred:0.017008114606142044, decouple_loss:0.0012895835097879171
loss_pred:0.01783425360918045, decouple_loss:0.001320274081081152
loss_pred:0.01895083673298359, decouple_loss:0.0013275910168886185
Iteration: 512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45238861441612244, gen p mean: -0.0483584888279438, mean p set: 0.45286890864372253
loss_pred:0.019597915932536125, decouple_loss:0.0012263443786650896
The modified gen p mean: 0.4527311623096466, gen p mean: -0.05160141736268997, mean p set: 0.4532114863395691The modified gen p mean: 0.4521729052066803, gen p mean: -0.05406325310468674, mean p set: 0.452653169631958
loss_pred:0.018388736993074417, decouple_loss:0.0012482487363740802
loss_pred:0.01780174858868122, decouple_loss:0.0012278460199013352
Iteration: 513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45041540265083313, gen p mean: -0.047533560544252396, mean p set: 0.4508957266807556
loss_pred:0.01692899875342846, decouple_loss:0.001313831890001893
The modified gen p mean: 0.452873170375824, gen p mean: -0.05189900100231171, mean p set: 0.4533534646034241The modified gen p mean: 0.4531858265399933, gen p mean: -0.046836018562316895, mean p set: 0.45366615056991577
loss_pred:0.01790946163237095, decouple_loss:0.0012550493702292442
loss_pred:0.019084492698311806, decouple_loss:0.0012073864927515388
Iteration: 514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506078064441681, gen p mean: -0.042616117745637894, mean p set: 0.4510881304740906
loss_pred:0.017473408952355385, decouple_loss:0.0011635415721684694
The modified gen p mean: 0.45320290327072144, gen p mean: -0.049825411289930344, mean p set: 0.4536832273006439The modified gen p mean: 0.4519626796245575, gen p mean: -0.041200075298547745, mean p set: 0.4524429440498352
loss_pred:0.017189111560583115, decouple_loss:0.0013280955608934164
loss_pred:0.017166849225759506, decouple_loss:0.0012103209737688303
Iteration: 515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502507448196411, gen p mean: -0.04080085828900337, mean p set: 0.4507310390472412
loss_pred:0.01741764135658741, decouple_loss:0.0012213403824716806
The modified gen p mean: 0.4504041075706482, gen p mean: -0.042986344546079636, mean p set: 0.4508844316005707The modified gen p mean: 0.4540480673313141, gen p mean: -0.038984525948762894, mean p set: 0.4545283913612366
loss_pred:0.01666463539004326, decouple_loss:0.0013591445749625564
loss_pred:0.01653445139527321, decouple_loss:0.0012750346213579178
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
NaN value num: 0
Iteration: 516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45058420300483704, gen p mean: -0.04218703880906105, mean p set: 0.4510645270347595
loss_pred:0.017201418057084084, decouple_loss:0.0012023256858810782
The modified gen p mean: 0.4509528577327728, gen p mean: -0.036372262984514236, mean p set: 0.4514331519603729The modified gen p mean: 0.45114535093307495, gen p mean: -0.03964228555560112, mean p set: 0.45162567496299744
loss_pred:0.016715437173843384, decouple_loss:0.001154898083768785
loss_pred:0.018035471439361572, decouple_loss:0.0011631029192358255
Iteration: 517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493529200553894, gen p mean: -0.03835182636976242, mean p set: 0.4498332440853119
The modified gen p mean: 0.44905152916908264, gen p mean: -0.039432987570762634, mean p set: 0.44953182339668274
loss_pred:0.01718367077410221, decouple_loss:0.0013456126907840371
loss_pred:0.01692517288029194, decouple_loss:0.001310347463004291
The modified gen p mean: 0.4494718015193939, gen p mean: -0.04372257739305496, mean p set: 0.449952095746994
loss_pred:0.016587194055318832, decouple_loss:0.001270573353394866
Iteration: 518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476621448993683, gen p mean: -0.04468608275055885, mean p set: 0.448142409324646
The modified gen p mean: 0.45150044560432434, gen p mean: -0.040361836552619934, mean p set: 0.45198073983192444
loss_pred:0.017599107697606087, decouple_loss:0.001215095748193562
loss_pred:0.017173292115330696, decouple_loss:0.0012875624233856797
The modified gen p mean: 0.45160701870918274, gen p mean: -0.04274795949459076, mean p set: 0.45208731293678284
loss_pred:0.017078688368201256, decouple_loss:0.001226199558004737
Iteration: 519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451507031917572, gen p mean: -0.04195934906601906, mean p set: 0.4519873261451721
loss_pred:0.017868058755993843, decouple_loss:0.0011397270718589425
The modified gen p mean: 0.44969499111175537, gen p mean: -0.044200971722602844, mean p set: 0.4501752555370331The modified gen p mean: 0.4490898847579956, gen p mean: -0.042584873735904694, mean p set: 0.4495701789855957
loss_pred:0.01705291122198105, decouple_loss:0.001113630598410964
loss_pred:0.01760733686387539, decouple_loss:0.001148469396866858
Iteration: 520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496873617172241, gen p mean: -0.051096782088279724, mean p set: 0.4501676559448242
loss_pred:0.01754048280417919, decouple_loss:0.0012437611585482955
The modified gen p mean: 0.44925540685653687, gen p mean: -0.04335704445838928, mean p set: 0.4497356712818146The modified gen p mean: 0.45082294940948486, gen p mean: -0.04792211204767227, mean p set: 0.45130327343940735
loss_pred:0.016658667474985123, decouple_loss:0.0011687841033563018
loss_pred:0.01682610623538494, decouple_loss:0.0013481115456670523
2023-04-30 05:40:04 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05297223478555679, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.048533663153648376, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.048562657088041306, mean p set: 0.4500633478164673
loss_pred:0.018523817881941795, decouple_loss:0.0012595758307725191
loss_pred:0.0174118522554636, decouple_loss:0.001174724893644452
loss_pred:0.017588414251804352, decouple_loss:0.0012152754934504628
WV_0_PC_1_EH_0_PS_40, loss: 0.017902188003063202, avg_mse: 0.02567196451127529
current test mse: 0.025672
Iteration: 521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448747456073761, gen p mean: -0.05334310233592987, mean p set: 0.44922778010368347
The modified gen p mean: 0.4513408839702606, gen p mean: -0.05030687525868416, mean p set: 0.4518211781978607
The modified gen p mean: 0.45214930176734924, gen p mean: -0.051720403134822845, mean p set: 0.45262959599494934
loss_pred:0.016652535647153854, decouple_loss:0.0011477527441456914
loss_pred:0.01717650145292282, decouple_loss:0.001205700682476163
loss_pred:0.017590530216693878, decouple_loss:0.0011985626770183444
Iteration: 522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513486921787262, gen p mean: -0.04729274660348892, mean p set: 0.4518289566040039
loss_pred:0.016269471496343613, decouple_loss:0.001261078636161983
The modified gen p mean: 0.45285388827323914, gen p mean: -0.05111851915717125, mean p set: 0.45333418250083923The modified gen p mean: 0.4493885040283203, gen p mean: -0.04945730045437813, mean p set: 0.4498688280582428
loss_pred:0.017090218141674995, decouple_loss:0.001309358747676015
loss_pred:0.016337696462869644, decouple_loss:0.0012071268865838647
Iteration: 523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45141366124153137, gen p mean: -0.051265817135572433, mean p set: 0.4518939256668091
loss_pred:0.016790103167295456, decouple_loss:0.0012349615572020411
The modified gen p mean: 0.4498673677444458, gen p mean: -0.05357149988412857, mean p set: 0.4503476321697235The modified gen p mean: 0.4511222541332245, gen p mean: -0.053322575986385345, mean p set: 0.4516025483608246
loss_pred:0.017832046374678612, decouple_loss:0.0011399416252970695
loss_pred:0.01659277267754078, decouple_loss:0.001112144673243165
Iteration: 524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45277976989746094, gen p mean: -0.0541241317987442, mean p set: 0.45326003432273865
loss_pred:0.016665751114487648, decouple_loss:0.001207448192872107
The modified gen p mean: 0.45145177841186523, gen p mean: -0.05259097367525101, mean p set: 0.4519321024417877The modified gen p mean: 0.44950807094573975, gen p mean: -0.05119821056723595, mean p set: 0.44998836517333984
loss_pred:0.016757789999246597, decouple_loss:0.0012835902161896229
loss_pred:0.016720816493034363, decouple_loss:0.0011503846617415547
Iteration: 525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44974344968795776, gen p mean: -0.0582476444542408, mean p set: 0.45022377371788025
loss_pred:0.016609711572527885, decouple_loss:0.0010807212674990296
The modified gen p mean: 0.451551228761673, gen p mean: -0.052897412329912186, mean p set: 0.4520314931869507The modified gen p mean: 0.4512780010700226, gen p mean: -0.0500539094209671, mean p set: 0.45175832509994507
loss_pred:0.016739889979362488, decouple_loss:0.0009994449792429805
loss_pred:0.017048629000782967, decouple_loss:0.0009834144730120897
Iteration: 526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45147398114204407, gen p mean: -0.0477406270802021, mean p set: 0.45195427536964417
loss_pred:0.01611037366092205, decouple_loss:0.0011008111760020256
The modified gen p mean: 0.4494360387325287, gen p mean: -0.04860350862145424, mean p set: 0.4499163329601288The modified gen p mean: 0.4498012959957123, gen p mean: -0.04921070486307144, mean p set: 0.45028162002563477
loss_pred:0.01775439828634262, decouple_loss:0.0010250762570649385
loss_pred:0.01752382516860962, decouple_loss:0.001058264635503292
Iteration: 527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516649544239044, gen p mean: -0.045883264392614365, mean p set: 0.4521452486515045
The modified gen p mean: 0.4528837502002716, gen p mean: -0.047193337231874466, mean p set: 0.4533640444278717loss_pred:0.016964474692940712, decouple_loss:0.0010644245194271207
The modified gen p mean: 0.4512357711791992, gen p mean: -0.040703557431697845, mean p set: 0.4517160654067993
loss_pred:0.01654076762497425, decouple_loss:0.0011458653025329113
loss_pred:0.017208563163876534, decouple_loss:0.0010666805319488049
Iteration: 528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512248635292053, gen p mean: -0.040403690189123154, mean p set: 0.4517051577568054
loss_pred:0.016597265377640724, decouple_loss:0.0009650054853409529
The modified gen p mean: 0.4504871964454651, gen p mean: -0.04753583297133446, mean p set: 0.4509674608707428The modified gen p mean: 0.44978782534599304, gen p mean: -0.04175616055727005, mean p set: 0.45026808977127075
loss_pred:0.016738874837756157, decouple_loss:0.0009602285572327673
loss_pred:0.01735646277666092, decouple_loss:0.0009503781329840422
Iteration: 529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507520794868469, gen p mean: -0.03828935697674751, mean p set: 0.4512324035167694
loss_pred:0.016849659383296967, decouple_loss:0.0010429412359371781
The modified gen p mean: 0.44813987612724304, gen p mean: -0.047428570687770844, mean p set: 0.44862014055252075The modified gen p mean: 0.44991931319236755, gen p mean: -0.0435667484998703, mean p set: 0.45039960741996765
loss_pred:0.016893934458494186, decouple_loss:0.0011444197734817863
loss_pred:0.01726084202528, decouple_loss:0.0012007756158709526
Iteration: 530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44981178641319275, gen p mean: -0.04802699014544487, mean p set: 0.45029211044311523
loss_pred:0.01709063909947872, decouple_loss:0.0010889305267482996
The modified gen p mean: 0.4499928653240204, gen p mean: -0.04321817681193352, mean p set: 0.4504731595516205The modified gen p mean: 0.448850154876709, gen p mean: -0.049069155007600784, mean p set: 0.4493304491043091
loss_pred:0.017128104344010353, decouple_loss:0.0010548082645982504
loss_pred:0.016942985355854034, decouple_loss:0.0010474291630089283
2023-04-30 05:41:57 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05002186447381973, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.044944215565919876, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04549844563007355, mean p set: 0.4500633478164673
loss_pred:0.018440689891576767, decouple_loss:0.0011151909129694104
loss_pred:0.017319539561867714, decouple_loss:0.00114338134881109
loss_pred:0.017469238489866257, decouple_loss:0.0011793432058766484
WV_0_PC_1_EH_0_PS_40, loss: 0.017800455912947655, avg_mse: 0.025533147156238556
current test mse: 0.025533
At step 530, Best test: 0.025533
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_model_test_schedule_sampling_DynaMean.ckpt
Iteration: 531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493926763534546, gen p mean: -0.04358302056789398, mean p set: 0.4498729407787323
loss_pred:0.01742861047387123, decouple_loss:0.0010741199366748333
The modified gen p mean: 0.451978862285614, gen p mean: -0.04571666568517685, mean p set: 0.4524591267108917The modified gen p mean: 0.4502734839916229, gen p mean: -0.04594235122203827, mean p set: 0.45075374841690063
loss_pred:0.01667206734418869, decouple_loss:0.001062594586983323loss_pred:0.017410539090633392, decouple_loss:0.001101615489460528
Iteration: 532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518388509750366, gen p mean: -0.04785280302166939, mean p set: 0.4523191750049591
loss_pred:0.017309917137026787, decouple_loss:0.0011314942967146635
The modified gen p mean: 0.4511565864086151, gen p mean: -0.04711093753576279, mean p set: 0.4516368806362152
The modified gen p mean: 0.45118170976638794, gen p mean: -0.04756103456020355, mean p set: 0.4516620337963104
loss_pred:0.01641455478966236, decouple_loss:0.0011000576196238399
loss_pred:0.017420073971152306, decouple_loss:0.001074135536327958
Iteration: 533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512796401977539, gen p mean: -0.04686737060546875, mean p set: 0.4517599642276764
loss_pred:0.01631317473948002, decouple_loss:0.0009627592517063022
The modified gen p mean: 0.4528367221355438, gen p mean: -0.05120773985981941, mean p set: 0.4533170461654663The modified gen p mean: 0.4501604437828064, gen p mean: -0.04654606059193611, mean p set: 0.4506407380104065
loss_pred:0.016673466190695763, decouple_loss:0.0009706109412945807
loss_pred:0.0162240881472826, decouple_loss:0.0009991124970838428
Iteration: 534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45149609446525574, gen p mean: -0.043793193995952606, mean p set: 0.45197638869285583
loss_pred:0.01635095477104187, decouple_loss:0.0010587990982457995
The modified gen p mean: 0.44974252581596375, gen p mean: -0.050370216369628906, mean p set: 0.45022279024124146The modified gen p mean: 0.44903847575187683, gen p mean: -0.04807113856077194, mean p set: 0.44951876997947693
loss_pred:0.016941620036959648, decouple_loss:0.001072381972335279
loss_pred:0.016530411317944527, decouple_loss:0.001020869822241366
Iteration: 535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45039644837379456, gen p mean: -0.0508849062025547, mean p set: 0.45087674260139465
loss_pred:0.017650559544563293, decouple_loss:0.000992474495433271
The modified gen p mean: 0.44892239570617676, gen p mean: -0.05022621527314186, mean p set: 0.44940266013145447The modified gen p mean: 0.44996708631515503, gen p mean: -0.05791939049959183, mean p set: 0.4504474103450775
loss_pred:0.016363954171538353, decouple_loss:0.0010148450965061784
loss_pred:0.016411906108260155, decouple_loss:0.0009747652802616358
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
NaN value num: 0
Iteration: 536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701382517814636, gen p mean: -0.04834076017141342, mean p set: 0.4474940896034241
loss_pred:0.018444683402776718, decouple_loss:0.0011007963912561536
The modified gen p mean: 0.44744303822517395, gen p mean: -0.04828835278749466, mean p set: 0.44792336225509644The modified gen p mean: 0.44767722487449646, gen p mean: -0.05203975364565849, mean p set: 0.44815748929977417
loss_pred:0.018214169889688492, decouple_loss:0.0010772544192150235
loss_pred:0.01864895597100258, decouple_loss:0.0010248968610540032
Iteration: 537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448393851518631, gen p mean: -0.049893829971551895, mean p set: 0.44887417554855347
loss_pred:0.0177552979439497, decouple_loss:0.0011046394938603044
The modified gen p mean: 0.4478950798511505, gen p mean: -0.05244101583957672, mean p set: 0.4483753740787506The modified gen p mean: 0.44846218824386597, gen p mean: -0.0476917028427124, mean p set: 0.44894248247146606
loss_pred:0.018626421689987183, decouple_loss:0.001095522427931428
loss_pred:0.017034368589520454, decouple_loss:0.0011313384165987372
Iteration: 538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475019574165344, gen p mean: -0.04289006069302559, mean p set: 0.4479822516441345
loss_pred:0.018650095909833908, decouple_loss:0.0010343666654080153
The modified gen p mean: 0.44793790578842163, gen p mean: -0.04799328371882439, mean p set: 0.44841820001602173The modified gen p mean: 0.4483610987663269, gen p mean: -0.044669970870018005, mean p set: 0.4488413631916046
loss_pred:0.017440665513277054, decouple_loss:0.001029020408168435
loss_pred:0.018456507474184036, decouple_loss:0.0010653655044734478
Iteration: 539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846972823143005, gen p mean: -0.04605701565742493, mean p set: 0.44895002245903015
loss_pred:0.01845257543027401, decouple_loss:0.0009645919781178236
The modified gen p mean: 0.4476719796657562, gen p mean: -0.04829080402851105, mean p set: 0.4481523036956787The modified gen p mean: 0.44805869460105896, gen p mean: -0.045974936336278915, mean p set: 0.44853898882865906
loss_pred:0.017988234758377075, decouple_loss:0.0010031708516180515
loss_pred:0.01834714412689209, decouple_loss:0.0009709139703772962
Iteration: 540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474272131919861, gen p mean: -0.04064260423183441, mean p set: 0.4479075074195862
loss_pred:0.018460389226675034, decouple_loss:0.0009767665760591626
The modified gen p mean: 0.44737720489501953, gen p mean: -0.048163868486881256, mean p set: 0.44785749912261963The modified gen p mean: 0.44836854934692383, gen p mean: -0.04468359053134918, mean p set: 0.4488488733768463
loss_pred:0.018589580431580544, decouple_loss:0.0009342702687717974
loss_pred:0.018464846536517143, decouple_loss:0.0009626720566302538
2023-04-30 05:44:33 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04743718355894089, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.042051397264003754, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.042876482009887695, mean p set: 0.4500633478164673
loss_pred:0.01841079816222191, decouple_loss:0.0009919741423800588
loss_pred:0.0173659585416317, decouple_loss:0.0009846206521615386
loss_pred:0.017442788928747177, decouple_loss:0.0009733584010973573
WV_0_PC_1_EH_0_PS_40, loss: 0.017789015546441078, avg_mse: 0.02553172968327999
current test mse: 0.025532
At step 540, Best test: 0.025532
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_model_test_schedule_sampling_DynaMean.ckpt
Iteration: 541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479680359363556, gen p mean: -0.04789601266384125, mean p set: 0.4484483003616333
loss_pred:0.018317539244890213, decouple_loss:0.0009044689359143376
The modified gen p mean: 0.4485129415988922, gen p mean: -0.04845013469457626, mean p set: 0.4489932656288147The modified gen p mean: 0.4473279118537903, gen p mean: -0.046834055334329605, mean p set: 0.4478082060813904
loss_pred:0.01747451350092888, decouple_loss:0.0009539840975776315
loss_pred:0.01836567558348179, decouple_loss:0.000844804395455867
Iteration: 542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489119350910187, gen p mean: -0.05433225631713867, mean p set: 0.4493922293186188
loss_pred:0.01807771809399128, decouple_loss:0.0009290609159506857
The modified gen p mean: 0.4475323259830475, gen p mean: -0.04560179263353348, mean p set: 0.4480125904083252The modified gen p mean: 0.447767436504364, gen p mean: -0.04835990071296692, mean p set: 0.4482477605342865
loss_pred:0.018118493258953094, decouple_loss:0.0008768367697484791
loss_pred:0.017962180078029633, decouple_loss:0.0009285795968025923
Iteration: 543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476569890975952, gen p mean: -0.051490385085344315, mean p set: 0.4481372833251953
The modified gen p mean: 0.447792649269104, gen p mean: -0.05092944949865341, mean p set: 0.4482729434967041
loss_pred:0.01898994855582714, decouple_loss:0.0009678519563749433
loss_pred:0.017930136993527412, decouple_loss:0.0010186899453401566The modified gen p mean: 0.4473387598991394, gen p mean: -0.04899728298187256, mean p set: 0.4478190541267395
loss_pred:0.018320472911000252, decouple_loss:0.0010308290366083384
Iteration: 544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469981789588928, gen p mean: -0.0547628328204155, mean p set: 0.4474784731864929
The modified gen p mean: 0.4488667845726013, gen p mean: -0.0575285479426384, mean p set: 0.4493470788002014
loss_pred:0.01812848076224327, decouple_loss:0.000982728903181851
loss_pred:0.017793083563447, decouple_loss:0.0010478381300345063
The modified gen p mean: 0.4477475881576538, gen p mean: -0.05692555755376816, mean p set: 0.4482278525829315
loss_pred:0.018085340037941933, decouple_loss:0.0010174488415941596
Iteration: 545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482339322566986, gen p mean: -0.054687660187482834, mean p set: 0.4487142562866211
The modified gen p mean: 0.44797033071517944, gen p mean: -0.0558977909386158, mean p set: 0.44845062494277954
loss_pred:0.01865263096988201, decouple_loss:0.0008955637458711863
loss_pred:0.01790546625852585, decouple_loss:0.0009475911501795053
The modified gen p mean: 0.44901150465011597, gen p mean: -0.05969355255365372, mean p set: 0.44949179887771606
loss_pred:0.018399568274617195, decouple_loss:0.0009610067936591804
Iteration: 546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474294185638428, gen p mean: -0.05090099200606346, mean p set: 0.4479096829891205
loss_pred:0.018724195659160614, decouple_loss:0.0008838470675982535
The modified gen p mean: 0.44896137714385986, gen p mean: -0.05602438375353813, mean p set: 0.4494416415691376The modified gen p mean: 0.4478349983692169, gen p mean: -0.05673670768737793, mean p set: 0.4483153223991394
loss_pred:0.018575850874185562, decouple_loss:0.0009348284220322967
loss_pred:0.01799716241657734, decouple_loss:0.0009939377196133137
Iteration: 547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765704870224, gen p mean: -0.059095852077007294, mean p set: 0.4481373429298401
loss_pred:0.017165517434477806, decouple_loss:0.0010311859659850597
The modified gen p mean: 0.4484975039958954, gen p mean: -0.05555742606520653, mean p set: 0.44897785782814026The modified gen p mean: 0.44755542278289795, gen p mean: -0.06004948541522026, mean p set: 0.44803571701049805
loss_pred:0.017553003504872322, decouple_loss:0.0010043163783848286
loss_pred:0.018124667927622795, decouple_loss:0.0010723297018557787
Iteration: 548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488697052001953, gen p mean: -0.05735726282000542, mean p set: 0.449349969625473
loss_pred:0.017533406615257263, decouple_loss:0.0009341462864540517
The modified gen p mean: 0.44756460189819336, gen p mean: -0.050099801272153854, mean p set: 0.44804492592811584The modified gen p mean: 0.44819241762161255, gen p mean: -0.047275520861148834, mean p set: 0.44867268204689026
loss_pred:0.017849566414952278, decouple_loss:0.0008767295512370765
loss_pred:0.01823890022933483, decouple_loss:0.0009237646590918303
Iteration: 549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729772210121155, gen p mean: -0.05037536844611168, mean p set: 0.44777801632881165
loss_pred:0.017801305279135704, decouple_loss:0.0011054022470489144
The modified gen p mean: 0.4484626352787018, gen p mean: -0.050654903054237366, mean p set: 0.44894295930862427The modified gen p mean: 0.4483512341976166, gen p mean: -0.054875459522008896, mean p set: 0.44883155822753906
loss_pred:0.01731404848396778, decouple_loss:0.001063871430233121
loss_pred:0.018542949110269547, decouple_loss:0.0010556034976616502
Iteration: 550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815874099731445, gen p mean: -0.052336134016513824, mean p set: 0.44863903522491455
loss_pred:0.01797824539244175, decouple_loss:0.0009108451777137816
The modified gen p mean: 0.4480227828025818, gen p mean: -0.048394057899713516, mean p set: 0.4485030770301819The modified gen p mean: 0.44823214411735535, gen p mean: -0.050032492727041245, mean p set: 0.44871240854263306
loss_pred:0.01760188862681389, decouple_loss:0.0009136602166108787
loss_pred:0.01815367490053177, decouple_loss:0.0009551545954309404
2023-04-30 05:46:31 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05059855431318283, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.045233599841594696, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04595761373639107, mean p set: 0.4500633478164673
loss_pred:0.018335388973355293, decouple_loss:0.0010910936398431659
loss_pred:0.017351437360048294, decouple_loss:0.0010662118438631296
loss_pred:0.017416246235370636, decouple_loss:0.001029475242830813
WV_0_PC_1_EH_0_PS_40, loss: 0.01775413751602173, avg_mse: 0.025475217029452324
current test mse: 0.025475
At step 550, Best test: 0.025475
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_model_test_schedule_sampling_DynaMean.ckpt
Iteration: 551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846925139427185, gen p mean: -0.04997037723660469, mean p set: 0.44894954562187195
loss_pred:0.01789182424545288, decouple_loss:0.0009402217110618949
The modified gen p mean: 0.44726303219795227, gen p mean: -0.045971911400556564, mean p set: 0.44774329662323The modified gen p mean: 0.4477936327457428, gen p mean: -0.04608801379799843, mean p set: 0.4482739567756653
loss_pred:0.017733024433255196, decouple_loss:0.0011206401977688074loss_pred:0.01800984889268875, decouple_loss:0.0009770090691745281
Iteration: 552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760873913764954, gen p mean: -0.05245388671755791, mean p set: 0.44808903336524963
loss_pred:0.017768464982509613, decouple_loss:0.0010414732387289405
The modified gen p mean: 0.44838833808898926, gen p mean: -0.040661945939064026, mean p set: 0.44886863231658936
The modified gen p mean: 0.44793978333473206, gen p mean: -0.051368437707424164, mean p set: 0.44842007756233215
loss_pred:0.0180402509868145, decouple_loss:0.0010073366574943066
loss_pred:0.01764797233045101, decouple_loss:0.001045596320182085
Iteration: 553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44850581884384155, gen p mean: -0.04628968611359596, mean p set: 0.44898611307144165
The modified gen p mean: 0.44795748591423035, gen p mean: -0.0475955493748188, mean p set: 0.44843775033950806
loss_pred:0.01845582015812397, decouple_loss:0.0008741000201553106
loss_pred:0.0180894173681736, decouple_loss:0.0010023643262684345
The modified gen p mean: 0.4475163221359253, gen p mean: -0.050388287752866745, mean p set: 0.447996586561203
loss_pred:0.018179280683398247, decouple_loss:0.0008747201645746827
Iteration: 554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486573338508606, gen p mean: -0.04788452014327049, mean p set: 0.4491376578807831
The modified gen p mean: 0.44800901412963867, gen p mean: -0.048795685172080994, mean p set: 0.44848933815956116
The modified gen p mean: 0.4482515752315521, gen p mean: -0.04787440970540047, mean p set: 0.4487318992614746
loss_pred:0.018681341782212257, decouple_loss:0.0009360599797219038
loss_pred:0.017818555235862732, decouple_loss:0.0009471855591982603
loss_pred:0.018317272886633873, decouple_loss:0.0009291926398873329
Iteration: 555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480712413787842, gen p mean: -0.053252797573804855, mean p set: 0.44855156540870667
The modified gen p mean: 0.4472518265247345, gen p mean: -0.048016298562288284, mean p set: 0.4477321207523346
loss_pred:0.017527766525745392, decouple_loss:0.000980157870799303
loss_pred:0.01868268847465515, decouple_loss:0.0009031763183884323
The modified gen p mean: 0.4476783871650696, gen p mean: -0.05426180362701416, mean p set: 0.44815871119499207
loss_pred:0.01789938658475876, decouple_loss:0.0008860693196766078
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
NaN value num: 0
Iteration: 556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44992557168006897, gen p mean: -0.03738211840391159, mean p set: 0.45040586590766907
loss_pred:0.017657756805419922, decouple_loss:0.0011823984095826745
The modified gen p mean: 0.4504564106464386, gen p mean: -0.03967100754380226, mean p set: 0.4509367048740387The modified gen p mean: 0.45307406783103943, gen p mean: -0.04270704463124275, mean p set: 0.4535543620586395
loss_pred:0.017263256013393402, decouple_loss:0.0010767908534035087
loss_pred:0.017689980566501617, decouple_loss:0.00103478180244565
Iteration: 557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509282410144806, gen p mean: -0.047440677881240845, mean p set: 0.4514085352420807
loss_pred:0.01706811599433422, decouple_loss:0.001016557333059609
The modified gen p mean: 0.4509286880493164, gen p mean: -0.04358134791254997, mean p set: 0.4514089822769165The modified gen p mean: 0.45099154114723206, gen p mean: -0.04453648626804352, mean p set: 0.45147183537483215
loss_pred:0.017930306494235992, decouple_loss:0.0010068831034004688
loss_pred:0.017358800396323204, decouple_loss:0.0010586549760773778
Iteration: 558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45241662859916687, gen p mean: -0.0422893762588501, mean p set: 0.4528968930244446
The modified gen p mean: 0.45018839836120605, gen p mean: -0.04573723301291466, mean p set: 0.45066869258880615
loss_pred:0.016768505796790123, decouple_loss:0.0010856545995920897
loss_pred:0.017992952838540077, decouple_loss:0.000979823642410338
The modified gen p mean: 0.45111164450645447, gen p mean: -0.04658536612987518, mean p set: 0.45159196853637695
loss_pred:0.01794315315783024, decouple_loss:0.0009450376383028924
Iteration: 559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511336088180542, gen p mean: -0.043796420097351074, mean p set: 0.4516139328479767
loss_pred:0.018033495172858238, decouple_loss:0.0009642636287026107
The modified gen p mean: 0.4516814053058624, gen p mean: -0.0368754081428051, mean p set: 0.4521616995334625The modified gen p mean: 0.4506165087223053, gen p mean: -0.042207617312669754, mean p set: 0.4510968327522278
loss_pred:0.01833147183060646, decouple_loss:0.0011084064608439803
loss_pred:0.01794692687690258, decouple_loss:0.0009845469612628222
Iteration: 560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010122656822205, gen p mean: -0.03654947504401207, mean p set: 0.45058155059814453
The modified gen p mean: 0.45073381066322327, gen p mean: -0.039596956223249435, mean p set: 0.45121413469314575
loss_pred:0.017500581219792366, decouple_loss:0.0011031811591237783
loss_pred:0.017476456239819527, decouple_loss:0.0009628384141251445
The modified gen p mean: 0.45110297203063965, gen p mean: -0.04047168046236038, mean p set: 0.45158323645591736
loss_pred:0.01843140833079815, decouple_loss:0.0010271905921399593
2023-04-30 05:49:07 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05195920914411545, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0465131513774395, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.047102801501750946, mean p set: 0.4500633478164673
loss_pred:0.018532026559114456, decouple_loss:0.001114735845476389
loss_pred:0.017550155520439148, decouple_loss:0.0011314436560496688
loss_pred:0.01755538210272789, decouple_loss:0.0011122594587504864
WV_0_PC_1_EH_0_PS_40, loss: 0.017935162410140038, avg_mse: 0.02577044814825058
current test mse: 0.02577
Iteration: 561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45081135630607605, gen p mean: -0.03719104826450348, mean p set: 0.45129165053367615
The modified gen p mean: 0.4505290985107422, gen p mean: -0.04714888706803322, mean p set: 0.4510093629360199
The modified gen p mean: 0.4510781764984131, gen p mean: -0.04118211939930916, mean p set: 0.4515584707260132
loss_pred:0.017350314185023308, decouple_loss:0.0010516924085095525
loss_pred:0.017232123762369156, decouple_loss:0.0010787929641082883loss_pred:0.018435893580317497, decouple_loss:0.001062302035279572
Iteration: 562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497269093990326, gen p mean: -0.040557920932769775, mean p set: 0.4502072036266327
loss_pred:0.01768537424504757, decouple_loss:0.0009374560904689133
The modified gen p mean: 0.4529097080230713, gen p mean: -0.03754531964659691, mean p set: 0.4533900320529938The modified gen p mean: 0.451174259185791, gen p mean: -0.03920621797442436, mean p set: 0.4516545534133911
loss_pred:0.01823236793279648, decouple_loss:0.001030744519084692
loss_pred:0.01697496324777603, decouple_loss:0.0010131857125088573
Iteration: 563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45102861523628235, gen p mean: -0.03796824440360069, mean p set: 0.45150890946388245
The modified gen p mean: 0.452144593000412, gen p mean: -0.03898255154490471, mean p set: 0.4526248872280121
loss_pred:0.016900889575481415, decouple_loss:0.001026491867378354
loss_pred:0.017815563827753067, decouple_loss:0.0010541975498199463
The modified gen p mean: 0.4518786370754242, gen p mean: -0.038065649569034576, mean p set: 0.4523589313030243
loss_pred:0.01723514497280121, decouple_loss:0.001100802910514176
Iteration: 564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517934322357178, gen p mean: -0.03864390775561333, mean p set: 0.4522736966609955
The modified gen p mean: 0.4512689709663391, gen p mean: -0.036247655749320984, mean p set: 0.4517492651939392
loss_pred:0.01717788726091385, decouple_loss:0.0009754154016263783
loss_pred:0.01689603365957737, decouple_loss:0.0010213549248874187
The modified gen p mean: 0.45104217529296875, gen p mean: -0.033800773322582245, mean p set: 0.45152246952056885
loss_pred:0.018554404377937317, decouple_loss:0.0011074076173827052
Iteration: 565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515930414199829, gen p mean: -0.03563513234257698, mean p set: 0.452073335647583
loss_pred:0.017475510016083717, decouple_loss:0.0010399918537586927
The modified gen p mean: 0.45135343074798584, gen p mean: -0.03542645648121834, mean p set: 0.4518337547779083The modified gen p mean: 0.4501418471336365, gen p mean: -0.03292569890618324, mean p set: 0.4506221413612366
loss_pred:0.017753954976797104, decouple_loss:0.001014756504446268
loss_pred:0.017554141581058502, decouple_loss:0.0010718744015321136
Iteration: 566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517216682434082, gen p mean: -0.034865327179431915, mean p set: 0.4522019624710083
The modified gen p mean: 0.4524185061454773, gen p mean: -0.02958832122385502, mean p set: 0.452898770570755
The modified gen p mean: 0.45051705837249756, gen p mean: -0.036300964653491974, mean p set: 0.45099735260009766
loss_pred:0.017836028710007668, decouple_loss:0.0009867174085229635
loss_pred:0.01680346392095089, decouple_loss:0.0009851993527263403loss_pred:0.01768169179558754, decouple_loss:0.0010078696068376303
Iteration: 567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45107710361480713, gen p mean: -0.03607479855418205, mean p set: 0.4515573978424072
The modified gen p mean: 0.45152682065963745, gen p mean: -0.042590975761413574, mean p set: 0.45200711488723755
loss_pred:0.01686025783419609, decouple_loss:0.001110411831177771
loss_pred:0.018128065392374992, decouple_loss:0.0010474714217707515
The modified gen p mean: 0.4507963955402374, gen p mean: -0.03874660283327103, mean p set: 0.4512766897678375
loss_pred:0.017642997205257416, decouple_loss:0.0010081700747832656
Iteration: 568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502286911010742, gen p mean: -0.037897031754255295, mean p set: 0.4507089853286743
The modified gen p mean: 0.4507935345172882, gen p mean: -0.0374368354678154, mean p set: 0.4512738585472107
loss_pred:0.01719607785344124, decouple_loss:0.0009623835212551057
loss_pred:0.01790432073175907, decouple_loss:0.001032927306368947
The modified gen p mean: 0.45104271173477173, gen p mean: -0.04359090328216553, mean p set: 0.4515230059623718
loss_pred:0.01694824919104576, decouple_loss:0.0009220076608471572
Iteration: 569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45177724957466125, gen p mean: -0.04538794234395027, mean p set: 0.45225754380226135
loss_pred:0.01819189265370369, decouple_loss:0.0010578952496871352
The modified gen p mean: 0.4502018094062805, gen p mean: -0.04614729806780815, mean p set: 0.450682133436203The modified gen p mean: 0.4496847987174988, gen p mean: -0.045148979872465134, mean p set: 0.45016512274742126
loss_pred:0.017951281741261482, decouple_loss:0.0009369569015689194
loss_pred:0.017770661041140556, decouple_loss:0.000958719290792942
Iteration: 570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45098811388015747, gen p mean: -0.052581537514925, mean p set: 0.45146840810775757
The modified gen p mean: 0.45123547315597534, gen p mean: -0.051765162497758865, mean p set: 0.4517157971858978
loss_pred:0.01785484328866005, decouple_loss:0.0009601066703908145
loss_pred:0.01800299808382988, decouple_loss:0.0009910966036841273
The modified gen p mean: 0.45027273893356323, gen p mean: -0.045922741293907166, mean p set: 0.45075303316116333
loss_pred:0.017063455656170845, decouple_loss:0.001046095392666757
2023-04-30 05:51:01 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.06135932356119156, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05599725991487503, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05644628033041954, mean p set: 0.4500633478164673
loss_pred:0.018532143905758858, decouple_loss:0.0010334864491596818
loss_pred:0.017469029873609543, decouple_loss:0.0010017274180427194
loss_pred:0.017524290829896927, decouple_loss:0.0010215208167210221
WV_0_PC_1_EH_0_PS_40, loss: 0.01789276860654354, avg_mse: 0.025707155466079712
current test mse: 0.025707
Iteration: 571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451937735080719, gen p mean: -0.04662778228521347, mean p set: 0.4524179995059967
The modified gen p mean: 0.45015791058540344, gen p mean: -0.05413978919386864, mean p set: 0.45063820481300354loss_pred:0.017572080716490746, decouple_loss:0.0010317392880097032
The modified gen p mean: 0.4516751766204834, gen p mean: -0.049360472708940506, mean p set: 0.4521554708480835
loss_pred:0.017414642497897148, decouple_loss:0.0009464036556892097
loss_pred:0.017725665122270584, decouple_loss:0.0009307905565947294
Iteration: 572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508490264415741, gen p mean: -0.04833205044269562, mean p set: 0.4513293206691742
The modified gen p mean: 0.45146703720092773, gen p mean: -0.052742037922143936, mean p set: 0.4519473612308502
loss_pred:0.01713910698890686, decouple_loss:0.0009784360881894827
The modified gen p mean: 0.4504019021987915, gen p mean: -0.05923893302679062, mean p set: 0.450882226228714loss_pred:0.01809385046362877, decouple_loss:0.0010467251995578408
loss_pred:0.016528362408280373, decouple_loss:0.0009693565079942346
Iteration: 573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45237085223197937, gen p mean: -0.05394525080919266, mean p set: 0.45285114645957947
The modified gen p mean: 0.45139825344085693, gen p mean: -0.05079115554690361, mean p set: 0.45187854766845703
The modified gen p mean: 0.450790673494339, gen p mean: -0.05171770602464676, mean p set: 0.4512709379196167
loss_pred:0.017043519765138626, decouple_loss:0.0009968978120014071
loss_pred:0.017943283542990685, decouple_loss:0.0009601577767170966loss_pred:0.017379213124513626, decouple_loss:0.0009868013439700007
Iteration: 574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505322277545929, gen p mean: -0.047520361840724945, mean p set: 0.4510124921798706The modified gen p mean: 0.45063239336013794, gen p mean: -0.053870126605033875, mean p set: 0.45111268758773804
The modified gen p mean: 0.4514961838722229, gen p mean: -0.040985893458127975, mean p set: 0.451976478099823
loss_pred:0.01646515727043152, decouple_loss:0.0009403915028087795loss_pred:0.017427392303943634, decouple_loss:0.0009002709994092584
loss_pred:0.017845934256911278, decouple_loss:0.0010185366263613105
Iteration: 575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505757689476013, gen p mean: -0.04124784097075462, mean p set: 0.4510560631752014
The modified gen p mean: 0.4515869617462158, gen p mean: -0.04644782841205597, mean p set: 0.45206722617149353
loss_pred:0.017045071348547935, decouple_loss:0.000972551351878792
loss_pred:0.01778380200266838, decouple_loss:0.0010030751582235098
The modified gen p mean: 0.4519047737121582, gen p mean: -0.04083683341741562, mean p set: 0.4523850381374359
loss_pred:0.017662817612290382, decouple_loss:0.0010296456748619676
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465150237083435, gen p mean: -0.04581475257873535, mean p set: 0.4469953179359436
loss_pred:0.015122930519282818, decouple_loss:0.0009909803047776222
The modified gen p mean: 0.44681647419929504, gen p mean: -0.05292306840419769, mean p set: 0.44729676842689514The modified gen p mean: 0.4478975534439087, gen p mean: -0.04220345988869667, mean p set: 0.4483778774738312
loss_pred:0.015320655889809132, decouple_loss:0.0010365198832005262
loss_pred:0.015302528627216816, decouple_loss:0.0010153916664421558
Iteration: 577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462844133377075, gen p mean: -0.04240219295024872, mean p set: 0.44676467776298523
The modified gen p mean: 0.4483894109725952, gen p mean: -0.041761815547943115, mean p set: 0.4488696753978729
The modified gen p mean: 0.448482483625412, gen p mean: -0.04693194478750229, mean p set: 0.4489628076553345
loss_pred:0.01482979767024517, decouple_loss:0.0009872319642454386
loss_pred:0.015102232806384563, decouple_loss:0.0009989076061174273loss_pred:0.014904157258570194, decouple_loss:0.000978971365839243
Iteration: 578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717198610305786, gen p mean: -0.04802731052041054, mean p set: 0.44765228033065796
The modified gen p mean: 0.446549654006958, gen p mean: -0.043288469314575195, mean p set: 0.4470299780368805
The modified gen p mean: 0.44691383838653564, gen p mean: -0.04282786697149277, mean p set: 0.44739410281181335
loss_pred:0.01478761900216341, decouple_loss:0.0013586743734776974
loss_pred:0.015152622014284134, decouple_loss:0.001091290032491088
loss_pred:0.015445513650774956, decouple_loss:0.001206038985401392
Iteration: 579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474467933177948, gen p mean: -0.04346703365445137, mean p set: 0.4479270875453949
loss_pred:0.014171255752444267, decouple_loss:0.001174856093712151
The modified gen p mean: 0.4470464587211609, gen p mean: -0.044142238795757294, mean p set: 0.4475267231464386The modified gen p mean: 0.4480850100517273, gen p mean: -0.04006914049386978, mean p set: 0.4485653042793274
loss_pred:0.014369838871061802, decouple_loss:0.0012104177149012685
loss_pred:0.014729623682796955, decouple_loss:0.0011553482618182898
Iteration: 580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725826382637024, gen p mean: -0.04869375005364418, mean p set: 0.4477385878562927
The modified gen p mean: 0.44709405303001404, gen p mean: -0.041862182319164276, mean p set: 0.4475743770599365
loss_pred:0.014214695431292057, decouple_loss:0.0013309245696291327
loss_pred:0.014737647958099842, decouple_loss:0.0012644804082810879
The modified gen p mean: 0.44752824306488037, gen p mean: -0.044348280876874924, mean p set: 0.44800853729248047
loss_pred:0.01418017316609621, decouple_loss:0.001259661396034062
2023-04-30 05:53:44 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.044833578169345856, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.039928507059812546, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.040154799818992615, mean p set: 0.4500633478164673
loss_pred:0.01895109936594963, decouple_loss:0.0012394230579957366
loss_pred:0.017857050523161888, decouple_loss:0.001218195422552526
loss_pred:0.017924660816788673, decouple_loss:0.0012495710980147123
WV_0_PC_1_EH_0_PS_40, loss: 0.018306057900190353, avg_mse: 0.026420004665851593
current test mse: 0.02642
Iteration: 581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466283321380615, gen p mean: -0.03763508051633835, mean p set: 0.447108656167984
The modified gen p mean: 0.44829919934272766, gen p mean: -0.03700927272439003, mean p set: 0.44877946376800537
The modified gen p mean: 0.44876283407211304, gen p mean: -0.03196336328983307, mean p set: 0.44924309849739075
loss_pred:0.013850482180714607, decouple_loss:0.0012150417314842343
loss_pred:0.013994760811328888, decouple_loss:0.0012191733112558722
loss_pred:0.014755611307919025, decouple_loss:0.0012041219742968678
Iteration: 582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474093019962311, gen p mean: -0.04013529047369957, mean p set: 0.4478895962238312
loss_pred:0.013608050532639027, decouple_loss:0.0013288235059008002
The modified gen p mean: 0.44742709398269653, gen p mean: -0.046036358922719955, mean p set: 0.44790735840797424
The modified gen p mean: 0.4479955732822418, gen p mean: -0.04735859856009483, mean p set: 0.4484758675098419
loss_pred:0.013961941935122013, decouple_loss:0.0013341063167899847
loss_pred:0.014048825018107891, decouple_loss:0.0013701764401048422
Iteration: 583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779103994369507, gen p mean: -0.049450650811195374, mean p set: 0.44827136397361755
loss_pred:0.013715426437556744, decouple_loss:0.0014275240246206522
The modified gen p mean: 0.44784659147262573, gen p mean: -0.04392809793353081, mean p set: 0.44832685589790344The modified gen p mean: 0.4468412697315216, gen p mean: -0.04982626438140869, mean p set: 0.4473215639591217
loss_pred:0.013710619881749153, decouple_loss:0.0013906409731134772
loss_pred:0.014147238805890083, decouple_loss:0.0013849955284968019
Iteration: 584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853731989860535, gen p mean: -0.04697095975279808, mean p set: 0.4490176737308502
loss_pred:0.014073746278882027, decouple_loss:0.0014834761386737227
The modified gen p mean: 0.44776856899261475, gen p mean: -0.053534649312496185, mean p set: 0.44824886322021484The modified gen p mean: 0.4469221234321594, gen p mean: -0.047324854880571365, mean p set: 0.4474024176597595
loss_pred:0.013710652478039265, decouple_loss:0.0014021696988493204
loss_pred:0.013836272060871124, decouple_loss:0.0014971188502386212
Iteration: 585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724032282829285, gen p mean: -0.05138172209262848, mean p set: 0.44772061705589294
loss_pred:0.01371605135500431, decouple_loss:0.0013982673408463597
The modified gen p mean: 0.4478999376296997, gen p mean: -0.045861221849918365, mean p set: 0.4483802020549774The modified gen p mean: 0.44819068908691406, gen p mean: -0.04646352678537369, mean p set: 0.4486709535121918
loss_pred:0.013901809230446815, decouple_loss:0.0014480178942903876
loss_pred:0.013420016504824162, decouple_loss:0.0013633357593789697
Iteration: 586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481627345085144, gen p mean: -0.0442410446703434, mean p set: 0.4486429989337921
loss_pred:0.014053171500563622, decouple_loss:0.0014478990342468023
The modified gen p mean: 0.44750797748565674, gen p mean: -0.0482526458799839, mean p set: 0.44798827171325684The modified gen p mean: 0.4480471909046173, gen p mean: -0.05488348379731178, mean p set: 0.4485274851322174
loss_pred:0.013310255482792854, decouple_loss:0.001417292864061892
loss_pred:0.013885690830647945, decouple_loss:0.00151540688239038
Iteration: 587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799885153770447, gen p mean: -0.05391958728432655, mean p set: 0.4484791159629822
loss_pred:0.013641907833516598, decouple_loss:0.0014750782866030931
The modified gen p mean: 0.44763094186782837, gen p mean: -0.04968709126114845, mean p set: 0.4481112062931061The modified gen p mean: 0.4473112225532532, gen p mean: -0.05051814019680023, mean p set: 0.44779151678085327
loss_pred:0.013936497271060944, decouple_loss:0.0014386946568265557
loss_pred:0.013754154555499554, decouple_loss:0.0014148341724649072
Iteration: 588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472111463546753, gen p mean: -0.05021721124649048, mean p set: 0.4476914703845978
loss_pred:0.01357181090861559, decouple_loss:0.0013931154971942306
The modified gen p mean: 0.44747141003608704, gen p mean: -0.05238080769777298, mean p set: 0.44795170426368713The modified gen p mean: 0.4487040936946869, gen p mean: -0.04531193524599075, mean p set: 0.449184387922287
loss_pred:0.013674057088792324, decouple_loss:0.0013890871778130531
loss_pred:0.013569401577115059, decouple_loss:0.0013626187574118376
Iteration: 589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481365978717804, gen p mean: -0.04856174439191818, mean p set: 0.4486168920993805
loss_pred:0.013607961125671864, decouple_loss:0.0014505949802696705
The modified gen p mean: 0.44652220606803894, gen p mean: -0.05051126331090927, mean p set: 0.44700247049331665The modified gen p mean: 0.44889259338378906, gen p mean: -0.03903907164931297, mean p set: 0.44937291741371155
loss_pred:0.013650184497237206, decouple_loss:0.0014848954742774367
loss_pred:0.013620668090879917, decouple_loss:0.0014385669492185116
Iteration: 590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467009902000427, gen p mean: -0.0393441766500473, mean p set: 0.4471812844276428
loss_pred:0.013498806394636631, decouple_loss:0.001411961391568184
The modified gen p mean: 0.4467791020870209, gen p mean: -0.047116030007600784, mean p set: 0.44725939631462097The modified gen p mean: 0.44627130031585693, gen p mean: -0.03977544605731964, mean p set: 0.44675159454345703
loss_pred:0.01337434258311987, decouple_loss:0.001399849890731275
loss_pred:0.013778459280729294, decouple_loss:0.0014790876302868128
2023-04-30 05:55:37 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04539058357477188, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.040231745690107346, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04053131118416786, mean p set: 0.4500633478164673
loss_pred:0.019466090947389603, decouple_loss:0.0014349784469231963
loss_pred:0.018305230885744095, decouple_loss:0.0014658193103969097
loss_pred:0.018366750329732895, decouple_loss:0.001481098122894764
WV_0_PC_1_EH_0_PS_40, loss: 0.01878572255373001, avg_mse: 0.02736230567097664
current test mse: 0.027362
Iteration: 591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788146018981934, gen p mean: -0.04551014304161072, mean p set: 0.44836175441741943
The modified gen p mean: 0.446719229221344, gen p mean: -0.04619734734296799, mean p set: 0.4471994936466217
The modified gen p mean: 0.44799262285232544, gen p mean: -0.039572618901729584, mean p set: 0.44847285747528076
loss_pred:0.013378501869738102, decouple_loss:0.0014607026241719723
loss_pred:0.013598842546343803, decouple_loss:0.0013974492903798819
loss_pred:0.013668759725987911, decouple_loss:0.0013843901688233018
Iteration: 592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472711682319641, gen p mean: -0.04276340454816818, mean p set: 0.4477514624595642
loss_pred:0.01292616967111826, decouple_loss:0.0013124776305630803
The modified gen p mean: 0.44708892703056335, gen p mean: -0.040378961712121964, mean p set: 0.44756919145584106The modified gen p mean: 0.4462960362434387, gen p mean: -0.04506249353289604, mean p set: 0.44677630066871643
loss_pred:0.013745304197072983, decouple_loss:0.0013880232581868768
loss_pred:0.01358859520405531, decouple_loss:0.0013939155032858253
Iteration: 593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732221961021423, gen p mean: -0.04927767440676689, mean p set: 0.4478025436401367
loss_pred:0.012923144735395908, decouple_loss:0.0013549495488405228
The modified gen p mean: 0.4489162862300873, gen p mean: -0.040688369423151016, mean p set: 0.4493965804576874The modified gen p mean: 0.44711393117904663, gen p mean: -0.050001103430986404, mean p set: 0.44759422540664673
loss_pred:0.013024871237576008, decouple_loss:0.001301411772146821
loss_pred:0.013289799913764, decouple_loss:0.001319146598689258
Iteration: 594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470864534378052, gen p mean: -0.05336269736289978, mean p set: 0.44756677746772766
loss_pred:0.013191833160817623, decouple_loss:0.001393795944750309
The modified gen p mean: 0.44745805859565735, gen p mean: -0.05186929926276207, mean p set: 0.44793838262557983
The modified gen p mean: 0.4474667012691498, gen p mean: -0.04872162267565727, mean p set: 0.4479469656944275
loss_pred:0.013292222283780575, decouple_loss:0.0014262725599110126
loss_pred:0.012982816435396671, decouple_loss:0.001419579959474504
Iteration: 595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477559030056, gen p mean: -0.053461953997612, mean p set: 0.4482361972332001
loss_pred:0.013029948808252811, decouple_loss:0.0012781964614987373
The modified gen p mean: 0.44692462682724, gen p mean: -0.04877260699868202, mean p set: 0.4474049210548401The modified gen p mean: 0.44877997040748596, gen p mean: -0.052351951599121094, mean p set: 0.44926023483276367
loss_pred:0.013272535055875778, decouple_loss:0.0013146440032869577
loss_pred:0.013287563808262348, decouple_loss:0.0012447843328118324
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490264058113098, gen p mean: -0.047734472900629044, mean p set: 0.4495067000389099
loss_pred:0.012903223745524883, decouple_loss:0.001276311813853681
The modified gen p mean: 0.4482242166996002, gen p mean: -0.05613157898187637, mean p set: 0.4487045109272003The modified gen p mean: 0.4475187361240387, gen p mean: -0.05235329270362854, mean p set: 0.4479990005493164
loss_pred:0.013153988867998123, decouple_loss:0.001235378673300147
loss_pred:0.012716935016214848, decouple_loss:0.0012845502933487296
Iteration: 597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446932315826416, gen p mean: -0.05244843289256096, mean p set: 0.4474125802516937
The modified gen p mean: 0.44729694724082947, gen p mean: -0.05108059197664261, mean p set: 0.44777724146842957
The modified gen p mean: 0.4483779966831207, gen p mean: -0.0490632988512516, mean p set: 0.4488582909107208
loss_pred:0.01280614547431469, decouple_loss:0.001217743381857872
loss_pred:0.013635652139782906, decouple_loss:0.0012547062942758203
loss_pred:0.013244355097413063, decouple_loss:0.001268219668418169
Iteration: 598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477311670780182, gen p mean: -0.051720935851335526, mean p set: 0.4482114315032959
loss_pred:0.012650472111999989, decouple_loss:0.0012975111603736877
The modified gen p mean: 0.4474526047706604, gen p mean: -0.04915383458137512, mean p set: 0.4479329288005829The modified gen p mean: 0.44723644852638245, gen p mean: -0.04667682573199272, mean p set: 0.44771671295166016
loss_pred:0.01360509917140007, decouple_loss:0.0013150157174095511
loss_pred:0.01273518055677414, decouple_loss:0.0012642999645322561
Iteration: 599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473142623901367, gen p mean: -0.0421416200697422, mean p set: 0.4477945566177368
The modified gen p mean: 0.4471547603607178, gen p mean: -0.04454338550567627, mean p set: 0.44763508439064026
loss_pred:0.013329442590475082, decouple_loss:0.001280028373003006
loss_pred:0.012862071394920349, decouple_loss:0.001212644507177174
The modified gen p mean: 0.44849923253059387, gen p mean: -0.047360826283693314, mean p set: 0.4489794969558716
loss_pred:0.013046971522271633, decouple_loss:0.0012413400691002607
Iteration: 600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449061781167984, gen p mean: -0.03921937942504883, mean p set: 0.4495420455932617
loss_pred:0.01281348243355751, decouple_loss:0.001261907978914678
The modified gen p mean: 0.4493151307106018, gen p mean: -0.03827647492289543, mean p set: 0.4497953951358795The modified gen p mean: 0.4483235776424408, gen p mean: -0.043154455721378326, mean p set: 0.4488038718700409
loss_pred:0.01334691233932972, decouple_loss:0.0012833341024816036
loss_pred:0.012541989795863628, decouple_loss:0.0012342303525656462
2023-04-30 05:58:08 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04407066851854324, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.03963436186313629, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03944140300154686, mean p set: 0.45035696029663086
loss_pred:0.019411783665418625, decouple_loss:0.0013333444949239492
loss_pred:0.018332062289118767, decouple_loss:0.001367467804811895
loss_pred:0.018297743052244186, decouple_loss:0.0013461548369377851
WV_0_PC_1_EH_0_PS_40, loss: 0.018747981637716293, avg_mse: 0.02738949842751026
current test mse: 0.027389
Iteration: 601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796130061149597, gen p mean: -0.044989388436079025, mean p set: 0.44844159483909607
The modified gen p mean: 0.44817665219306946, gen p mean: -0.04437563568353653, mean p set: 0.44865697622299194
loss_pred:0.012553193606436253, decouple_loss:0.0013820447493344545
The modified gen p mean: 0.4481548070907593, gen p mean: -0.042136020958423615, mean p set: 0.4486351013183594
loss_pred:0.013029543682932854, decouple_loss:0.001296370755881071
loss_pred:0.012657221406698227, decouple_loss:0.0013118920614942908
Iteration: 602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474695920944214, gen p mean: -0.04135433956980705, mean p set: 0.4479498863220215
The modified gen p mean: 0.4493856132030487, gen p mean: -0.035021718591451645, mean p set: 0.4498658776283264
The modified gen p mean: 0.44777804613113403, gen p mean: -0.03961890563368797, mean p set: 0.44825834035873413
loss_pred:0.012621976435184479, decouple_loss:0.0012182099744677544
loss_pred:0.013285098597407341, decouple_loss:0.001177976024337113loss_pred:0.012982185930013657, decouple_loss:0.0012764352140948176
Iteration: 603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483889937400818, gen p mean: -0.049621183425188065, mean p set: 0.4488692879676819
The modified gen p mean: 0.4485163986682892, gen p mean: -0.042308561503887177, mean p set: 0.4489966928958893
loss_pred:0.012965047731995583, decouple_loss:0.0012303079711273313
loss_pred:0.01322594378143549, decouple_loss:0.0012095356360077858
The modified gen p mean: 0.44736239314079285, gen p mean: -0.04377877712249756, mean p set: 0.44784268736839294
loss_pred:0.013495373539626598, decouple_loss:0.001155636040493846
Iteration: 604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446613073348999, gen p mean: -0.04427343234419823, mean p set: 0.4470933675765991
The modified gen p mean: 0.4479518532752991, gen p mean: -0.04694261774420738, mean p set: 0.44843214750289917
loss_pred:0.012740599922835827, decouple_loss:0.0012548394734039903
loss_pred:0.012578926049172878, decouple_loss:0.0012540577445179224
The modified gen p mean: 0.4477725327014923, gen p mean: -0.04228011146187782, mean p set: 0.4482528567314148
loss_pred:0.012613636441528797, decouple_loss:0.0011236752616241574
Iteration: 605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480278789997101, gen p mean: -0.04538321867585182, mean p set: 0.4485081434249878
loss_pred:0.013080007396638393, decouple_loss:0.0010987097630277276
The modified gen p mean: 0.4470907747745514, gen p mean: -0.047815900295972824, mean p set: 0.4475710391998291The modified gen p mean: 0.44725489616394043, gen p mean: -0.04471071437001228, mean p set: 0.44773516058921814
loss_pred:0.012422587722539902, decouple_loss:0.0011140020797029138
loss_pred:0.013209577649831772, decouple_loss:0.0011770178098231554
Iteration: 606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481242001056671, gen p mean: -0.04546697810292244, mean p set: 0.4486044645309448
loss_pred:0.012409881688654423, decouple_loss:0.0011772935977205634
The modified gen p mean: 0.4487769305706024, gen p mean: -0.046488191932439804, mean p set: 0.4492571949958801The modified gen p mean: 0.4479582905769348, gen p mean: -0.04429886117577553, mean p set: 0.4484385848045349
loss_pred:0.012838960625231266, decouple_loss:0.0012133460259065032
loss_pred:0.01258440874516964, decouple_loss:0.0012604291550815105
Iteration: 607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44711458683013916, gen p mean: -0.044908344745635986, mean p set: 0.44759488105773926
loss_pred:0.013169611804187298, decouple_loss:0.0011016441276296973
The modified gen p mean: 0.4481460154056549, gen p mean: -0.04632514342665672, mean p set: 0.4486263692378998The modified gen p mean: 0.448378324508667, gen p mean: -0.043934017419815063, mean p set: 0.4488586187362671
loss_pred:0.013011598959565163, decouple_loss:0.0011171435471624136
loss_pred:0.012791312299668789, decouple_loss:0.0010934753809124231
Iteration: 608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846054911613464, gen p mean: -0.04932107776403427, mean p set: 0.44894084334373474
loss_pred:0.012534343637526035, decouple_loss:0.0011503020068630576
The modified gen p mean: 0.4483753740787506, gen p mean: -0.04456901550292969, mean p set: 0.4488556683063507The modified gen p mean: 0.4484296441078186, gen p mean: -0.048221003264188766, mean p set: 0.4489099383354187
loss_pred:0.012805012986063957, decouple_loss:0.001132489531300962
loss_pred:0.012302575632929802, decouple_loss:0.0012036629486829042
Iteration: 609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763848185539246, gen p mean: -0.04528221860527992, mean p set: 0.44811877608299255
loss_pred:0.012404882349073887, decouple_loss:0.0010501253418624401
The modified gen p mean: 0.44762122631073, gen p mean: -0.04598722979426384, mean p set: 0.4481014907360077The modified gen p mean: 0.44834771752357483, gen p mean: -0.04791731759905815, mean p set: 0.4488280117511749
loss_pred:0.012589503079652786, decouple_loss:0.0010819913586601615
loss_pred:0.012777624651789665, decouple_loss:0.001106148469261825
Iteration: 610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750353693962097, gen p mean: -0.042748257517814636, mean p set: 0.44798383116722107
loss_pred:0.013426181860268116, decouple_loss:0.001022925483994186
The modified gen p mean: 0.44808003306388855, gen p mean: -0.04270820692181587, mean p set: 0.44856035709381104The modified gen p mean: 0.4481067359447479, gen p mean: -0.04474077746272087, mean p set: 0.4485870599746704
loss_pred:0.012544950470328331, decouple_loss:0.001029132166877389
loss_pred:0.012144464999437332, decouple_loss:0.001088832737877965
2023-04-30 06:00:01 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04404819756746292, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.039834704250097275, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.03997538983821869, mean p set: 0.4500633478164673
loss_pred:0.01940689980983734, decouple_loss:0.0011192962992936373
loss_pred:0.018254665657877922, decouple_loss:0.00115097314119339
loss_pred:0.018278485164046288, decouple_loss:0.0011135011445730925
WV_0_PC_1_EH_0_PS_40, loss: 0.018703078851103783, avg_mse: 0.027360156178474426
current test mse: 0.02736
Iteration: 611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44857344031333923, gen p mean: -0.041726067662239075, mean p set: 0.44905373454093933
The modified gen p mean: 0.44745561480522156, gen p mean: -0.0401795394718647, mean p set: 0.44793590903282166
loss_pred:0.012924901209771633, decouple_loss:0.0010357571300119162
The modified gen p mean: 0.4473004639148712, gen p mean: -0.04114359989762306, mean p set: 0.4477807283401489
loss_pred:0.012680880725383759, decouple_loss:0.0011265156790614128
loss_pred:0.01293540932238102, decouple_loss:0.0010281425202265382
Iteration: 612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476816654205322, gen p mean: -0.038923002779483795, mean p set: 0.44816192984580994
The modified gen p mean: 0.4485977590084076, gen p mean: -0.037313032895326614, mean p set: 0.4490780532360077
The modified gen p mean: 0.44755682349205017, gen p mean: -0.03769896924495697, mean p set: 0.44803711771965027
loss_pred:0.012417994439601898, decouple_loss:0.001012798398733139
loss_pred:0.013049997389316559, decouple_loss:0.001039684284478426loss_pred:0.0128892557695508, decouple_loss:0.0009783098939806223
Iteration: 613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764864444732666, gen p mean: -0.041304923593997955, mean p set: 0.44812890887260437
loss_pred:0.012984675355255604, decouple_loss:0.0010203211568295956
The modified gen p mean: 0.44728949666023254, gen p mean: -0.04173926264047623, mean p set: 0.44776979088783264The modified gen p mean: 0.44812262058258057, gen p mean: -0.045073382556438446, mean p set: 0.44860297441482544
loss_pred:0.01238277181982994, decouple_loss:0.0009771257173269987
loss_pred:0.012365186586976051, decouple_loss:0.0009601667406968772
Iteration: 614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480270743370056, gen p mean: -0.04622501879930496, mean p set: 0.4485073983669281
The modified gen p mean: 0.4486527442932129, gen p mean: -0.04642805829644203, mean p set: 0.449133038520813loss_pred:0.0123404860496521, decouple_loss:0.0011428713332861662
The modified gen p mean: 0.44736185669898987, gen p mean: -0.041938554495573044, mean p set: 0.44784215092658997
loss_pred:0.012729684822261333, decouple_loss:0.0011174646206200123
loss_pred:0.012428965419530869, decouple_loss:0.001086540287360549
Iteration: 615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472711682319641, gen p mean: -0.03980299085378647, mean p set: 0.4477514326572418
loss_pred:0.012981071136891842, decouple_loss:0.001070536905899644
The modified gen p mean: 0.4484996795654297, gen p mean: -0.05258176103234291, mean p set: 0.4489799737930298The modified gen p mean: 0.44872990250587463, gen p mean: -0.045621275901794434, mean p set: 0.44921019673347473
loss_pred:0.012586819007992744, decouple_loss:0.0010043283691629767
loss_pred:0.012565012089908123, decouple_loss:0.0010572205064818263
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
NaN value num: 0
Iteration: 616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519236981868744, gen p mean: -0.04261314868927002, mean p set: 0.4524039626121521
loss_pred:0.01820610649883747, decouple_loss:0.0012395982630550861
The modified gen p mean: 0.4497902989387512, gen p mean: -0.040167007595300674, mean p set: 0.4502705931663513The modified gen p mean: 0.45007872581481934, gen p mean: -0.043775323778390884, mean p set: 0.45055902004241943
loss_pred:0.017991293221712112, decouple_loss:0.001254012226127088
loss_pred:0.018714167177677155, decouple_loss:0.0012546211946755648
Iteration: 617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45024290680885315, gen p mean: -0.03840643912553787, mean p set: 0.45072323083877563
The modified gen p mean: 0.45263898372650146, gen p mean: -0.03930835425853729, mean p set: 0.45311927795410156
loss_pred:0.01745770312845707, decouple_loss:0.0013541106600314379
loss_pred:0.018440144136548042, decouple_loss:0.001239200122654438
The modified gen p mean: 0.44960248470306396, gen p mean: -0.03910668566823006, mean p set: 0.45008277893066406
loss_pred:0.018664587289094925, decouple_loss:0.0012573602143675089
Iteration: 618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45138290524482727, gen p mean: -0.046447061002254486, mean p set: 0.45186319947242737
The modified gen p mean: 0.45068982243537903, gen p mean: -0.039367225021123886, mean p set: 0.4511701166629791
loss_pred:0.018368298187851906, decouple_loss:0.001251228735782206
loss_pred:0.01758551225066185, decouple_loss:0.001220676931552589
The modified gen p mean: 0.45299434661865234, gen p mean: -0.04429687559604645, mean p set: 0.45347464084625244
loss_pred:0.018187977373600006, decouple_loss:0.0012168082175776362
Iteration: 619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44915416836738586, gen p mean: -0.04408203065395355, mean p set: 0.44963446259498596
loss_pred:0.01774972304701805, decouple_loss:0.00128040905110538
The modified gen p mean: 0.450313001871109, gen p mean: -0.04028257355093956, mean p set: 0.4507932960987091
The modified gen p mean: 0.45005980134010315, gen p mean: -0.0413980670273304, mean p set: 0.45054012537002563
loss_pred:0.018809420987963676, decouple_loss:0.001254177768714726
loss_pred:0.017419422045350075, decouple_loss:0.0011869821464642882
Iteration: 620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494567811489105, gen p mean: -0.04104006290435791, mean p set: 0.449937105178833
The modified gen p mean: 0.45062196254730225, gen p mean: -0.0384238176047802, mean p set: 0.45110225677490234
The modified gen p mean: 0.4499615430831909, gen p mean: -0.03937762603163719, mean p set: 0.450441837310791loss_pred:0.016809094697237015, decouple_loss:0.0014165141619741917
loss_pred:0.017520012333989143, decouple_loss:0.0014828956918790936
loss_pred:0.017679743468761444, decouple_loss:0.001445574569515884
2023-04-30 06:02:31 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.052343133836984634, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04760526493191719, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04811060056090355, mean p set: 0.4500633478164673
loss_pred:0.018751831725239754, decouple_loss:0.0014200019650161266
loss_pred:0.017619524151086807, decouple_loss:0.0014283140189945698
loss_pred:0.01771511323750019, decouple_loss:0.0013585302513092756
WV_0_PC_1_EH_0_PS_40, loss: 0.018098939210176468, avg_mse: 0.026000425219535828
current test mse: 0.026
Iteration: 621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525906443595886, gen p mean: -0.05254753306508064, mean p set: 0.4530709385871887
The modified gen p mean: 0.45041683316230774, gen p mean: -0.0415177121758461, mean p set: 0.4508971571922302
The modified gen p mean: 0.45261839032173157, gen p mean: -0.042688529938459396, mean p set: 0.45309871435165405
loss_pred:0.01791541278362274, decouple_loss:0.0013780195731669664
loss_pred:0.017590278759598732, decouple_loss:0.0013885711086913943loss_pred:0.01742013916373253, decouple_loss:0.0013738310663029552
Iteration: 622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504302144050598, gen p mean: -0.04635480046272278, mean p set: 0.4509105384349823
loss_pred:0.01791897974908352, decouple_loss:0.0012984861386939883
The modified gen p mean: 0.44951656460762024, gen p mean: -0.043185628950595856, mean p set: 0.44999685883522034The modified gen p mean: 0.45049917697906494, gen p mean: -0.04350791126489639, mean p set: 0.45097947120666504
loss_pred:0.016910359263420105, decouple_loss:0.0013446906814351678
loss_pred:0.017829060554504395, decouple_loss:0.0013067078543826938
Iteration: 623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518849551677704, gen p mean: -0.05087055265903473, mean p set: 0.4523652195930481
loss_pred:0.01822587102651596, decouple_loss:0.0012921526795253158
The modified gen p mean: 0.4526252746582031, gen p mean: -0.045723143965005875, mean p set: 0.4531055688858032The modified gen p mean: 0.449970006942749, gen p mean: -0.04316126927733421, mean p set: 0.4504503011703491
loss_pred:0.018324680626392365, decouple_loss:0.0012893378734588623
loss_pred:0.018101688474416733, decouple_loss:0.0012736624339595437
Iteration: 624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45054343342781067, gen p mean: -0.04578382149338722, mean p set: 0.4510236978530884
loss_pred:0.01712016947567463, decouple_loss:0.001253146561793983
The modified gen p mean: 0.4494049847126007, gen p mean: -0.04491131752729416, mean p set: 0.4498852789402008The modified gen p mean: 0.4520683288574219, gen p mean: -0.05031052976846695, mean p set: 0.4525485932826996
loss_pred:0.01831728219985962, decouple_loss:0.00129349110648036
loss_pred:0.01781768910586834, decouple_loss:0.001351165003143251
Iteration: 625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45139601826667786, gen p mean: -0.045945905148983, mean p set: 0.45187634229660034
loss_pred:0.017568383365869522, decouple_loss:0.0012711603194475174
The modified gen p mean: 0.4502231180667877, gen p mean: -0.04245733842253685, mean p set: 0.4507034122943878
The modified gen p mean: 0.45090562105178833, gen p mean: -0.043455660343170166, mean p set: 0.4513859152793884
loss_pred:0.017462514340877533, decouple_loss:0.0012418330879881978
loss_pred:0.01819504424929619, decouple_loss:0.001255597802810371
Iteration: 626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44920673966407776, gen p mean: -0.05912322551012039, mean p set: 0.44968703389167786
loss_pred:0.018037814646959305, decouple_loss:0.001361554255709052
The modified gen p mean: 0.45142993330955505, gen p mean: -0.047847047448158264, mean p set: 0.45191025733947754The modified gen p mean: 0.4514337182044983, gen p mean: -0.05259087681770325, mean p set: 0.4519140422344208
loss_pred:0.017107443884015083, decouple_loss:0.0012579323956742883
loss_pred:0.018085824325680733, decouple_loss:0.0012832579668611288
Iteration: 627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44935160875320435, gen p mean: -0.04649077355861664, mean p set: 0.44983193278312683
loss_pred:0.019107311964035034, decouple_loss:0.0012950273230671883
The modified gen p mean: 0.45019471645355225, gen p mean: -0.04863927140831947, mean p set: 0.45067504048347473The modified gen p mean: 0.4496537744998932, gen p mean: -0.054286710917949677, mean p set: 0.4501340985298157
loss_pred:0.01781638339161873, decouple_loss:0.0012888837372884154
loss_pred:0.017078617587685585, decouple_loss:0.0012697831261903048
Iteration: 628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45292118191719055, gen p mean: -0.049975648522377014, mean p set: 0.45340150594711304
loss_pred:0.017976077273488045, decouple_loss:0.001493327785283327
The modified gen p mean: 0.4504378139972687, gen p mean: -0.05344998463988304, mean p set: 0.4509181082248688The modified gen p mean: 0.45077091455459595, gen p mean: -0.0526849664747715, mean p set: 0.45125120878219604
loss_pred:0.017806315794587135, decouple_loss:0.0013472269056364894
loss_pred:0.01806616224348545, decouple_loss:0.0013282311847433448
Iteration: 629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45020055770874023, gen p mean: -0.04757045954465866, mean p set: 0.45068085193634033
loss_pred:0.01708110049366951, decouple_loss:0.0013381493045017123
The modified gen p mean: 0.45108309388160706, gen p mean: -0.05156221613287926, mean p set: 0.45156341791152954The modified gen p mean: 0.45007607340812683, gen p mean: -0.050747063010931015, mean p set: 0.4505563974380493
loss_pred:0.01784428581595421, decouple_loss:0.0012597955064848065
loss_pred:0.018831435590982437, decouple_loss:0.0013003587955608964
Iteration: 630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492179751396179, gen p mean: -0.05500395968556404, mean p set: 0.4496982991695404
loss_pred:0.017386889085173607, decouple_loss:0.0014328371034935117
The modified gen p mean: 0.4500267803668976, gen p mean: -0.04899394512176514, mean p set: 0.4505070447921753The modified gen p mean: 0.4503708779811859, gen p mean: -0.05098608881235123, mean p set: 0.4508511424064636
loss_pred:0.019403770565986633, decouple_loss:0.001466113142669201
loss_pred:0.017908886075019836, decouple_loss:0.0014032770413905382
2023-04-30 06:04:25 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.052542105317115784, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04652094841003418, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04745382443070412, mean p set: 0.4500633478164673
loss_pred:0.018874427303671837, decouple_loss:0.0015992848202586174
loss_pred:0.017768314108252525, decouple_loss:0.0015859573613852262
loss_pred:0.01781637594103813, decouple_loss:0.0015496322885155678
WV_0_PC_1_EH_0_PS_40, loss: 0.01823195442557335, avg_mse: 0.026039747521281242
current test mse: 0.02604
Iteration: 631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450580358505249, gen p mean: -0.041345443576574326, mean p set: 0.4510606527328491
The modified gen p mean: 0.4504571557044983, gen p mean: -0.045122113078832626, mean p set: 0.450937420129776
The modified gen p mean: 0.45000267028808594, gen p mean: -0.043603986501693726, mean p set: 0.4504829943180084
loss_pred:0.016723286360502243, decouple_loss:0.0014304419746622443
loss_pred:0.01770600490272045, decouple_loss:0.0014448363799601793
loss_pred:0.01802331954240799, decouple_loss:0.0014903729315847158
Iteration: 632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532533288002014, gen p mean: -0.03924092277884483, mean p set: 0.4537335932254791
loss_pred:0.01775291934609413, decouple_loss:0.0015124698402360082
The modified gen p mean: 0.4521403908729553, gen p mean: -0.045392923057079315, mean p set: 0.45262065529823303
The modified gen p mean: 0.45159539580345154, gen p mean: -0.0375690795481205, mean p set: 0.45207569003105164
loss_pred:0.01727154292166233, decouple_loss:0.001406881958246231
loss_pred:0.017696060240268707, decouple_loss:0.00145126658026129
Iteration: 633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45077022910118103, gen p mean: -0.030826043337583542, mean p set: 0.4512505531311035
loss_pred:0.018518581986427307, decouple_loss:0.0013603498227894306
The modified gen p mean: 0.4504399001598358, gen p mean: -0.03653440997004509, mean p set: 0.4509201943874359The modified gen p mean: 0.453255295753479, gen p mean: -0.03315284475684166, mean p set: 0.4537356197834015
loss_pred:0.017882630228996277, decouple_loss:0.0015152273699641228
loss_pred:0.01754062995314598, decouple_loss:0.0014174450188875198
Iteration: 634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45270365476608276, gen p mean: -0.038315288722515106, mean p set: 0.45318400859832764
loss_pred:0.018231716006994247, decouple_loss:0.0013918749755248427
The modified gen p mean: 0.4513232707977295, gen p mean: -0.038819409906864166, mean p set: 0.4518035352230072The modified gen p mean: 0.4517694115638733, gen p mean: -0.03334087133407593, mean p set: 0.4522497057914734
loss_pred:0.017819732427597046, decouple_loss:0.0013648162130266428
loss_pred:0.017781175673007965, decouple_loss:0.0013808284420520067
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44908517599105835, gen p mean: -0.04060567915439606, mean p set: 0.44956550002098083
loss_pred:0.015445366501808167, decouple_loss:0.0017045800341293216
The modified gen p mean: 0.44751986861228943, gen p mean: -0.04180468991398811, mean p set: 0.4480001628398895The modified gen p mean: 0.44903847575187683, gen p mean: -0.037542931735515594, mean p set: 0.44951876997947693
loss_pred:0.01567711867392063, decouple_loss:0.0016487303655594587
loss_pred:0.01521041989326477, decouple_loss:0.0017155887326225638
Iteration: 636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44899260997772217, gen p mean: -0.03785804286599159, mean p set: 0.44947290420532227
loss_pred:0.014623231254518032, decouple_loss:0.0014761192724108696
The modified gen p mean: 0.4484134614467621, gen p mean: -0.03988441079854965, mean p set: 0.4488937258720398The modified gen p mean: 0.4490557909011841, gen p mean: -0.04155392572283745, mean p set: 0.4495360851287842
loss_pred:0.015524419955909252, decouple_loss:0.0015148535603657365
loss_pred:0.015665974467992783, decouple_loss:0.0015225233510136604
Iteration: 637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819584488868713, gen p mean: -0.043318793177604675, mean p set: 0.4486761689186096
The modified gen p mean: 0.4479416310787201, gen p mean: -0.038697171956300735, mean p set: 0.4484219551086426
loss_pred:0.014504960738122463, decouple_loss:0.001619525719434023
loss_pred:0.014581764116883278, decouple_loss:0.0015850169584155083
The modified gen p mean: 0.4481603503227234, gen p mean: -0.03287404403090477, mean p set: 0.4486406445503235
loss_pred:0.015295272693037987, decouple_loss:0.0015645476523786783
Iteration: 638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448131263256073, gen p mean: -0.039629191160202026, mean p set: 0.4486114978790283
The modified gen p mean: 0.448279470205307, gen p mean: -0.040538717061281204, mean p set: 0.4487597644329071
loss_pred:0.01460193656384945, decouple_loss:0.0016771748196333647
loss_pred:0.014616853557527065, decouple_loss:0.0015476180706173182
The modified gen p mean: 0.4477930963039398, gen p mean: -0.04067671298980713, mean p set: 0.4482733905315399
loss_pred:0.014630796387791634, decouple_loss:0.0015557592269033194
Iteration: 639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487845003604889, gen p mean: -0.04540610685944557, mean p set: 0.4492647647857666
loss_pred:0.013880213722586632, decouple_loss:0.0018050229409709573
The modified gen p mean: 0.4491555690765381, gen p mean: -0.04528656229376793, mean p set: 0.4496358335018158The modified gen p mean: 0.4483930170536041, gen p mean: -0.0480504110455513, mean p set: 0.4488733410835266
loss_pred:0.014141665771603584, decouple_loss:0.0017735700821503997
loss_pred:0.014520525000989437, decouple_loss:0.0016967845149338245
Iteration: 640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494182765483856, gen p mean: -0.04969005286693573, mean p set: 0.4498986005783081
loss_pred:0.014041821472346783, decouple_loss:0.0016812040703371167
The modified gen p mean: 0.449386328458786, gen p mean: -0.05171915143728256, mean p set: 0.4498666524887085The modified gen p mean: 0.44877126812934875, gen p mean: -0.0484110526740551, mean p set: 0.44925159215927124
loss_pred:0.014401968568563461, decouple_loss:0.0017033106414601207
loss_pred:0.013893265277147293, decouple_loss:0.0017390686552971601
2023-04-30 06:06:56 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05010444298386574, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04536465182900429, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0455218143761158, mean p set: 0.4500633478164673
loss_pred:0.019497554749250412, decouple_loss:0.00178746716119349
loss_pred:0.01839909330010414, decouple_loss:0.0018628626130521297
loss_pred:0.018543055281043053, decouple_loss:0.0018881381256505847
WV_0_PC_1_EH_0_PS_40, loss: 0.01890554279088974, avg_mse: 0.027426276355981827
current test mse: 0.027426
Iteration: 641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489569664001465, gen p mean: -0.051423460245132446, mean p set: 0.4494372606277466
The modified gen p mean: 0.4485247731208801, gen p mean: -0.04496845230460167, mean p set: 0.4490050673484802
The modified gen p mean: 0.4483850598335266, gen p mean: -0.05040966719388962, mean p set: 0.4488653242588043
loss_pred:0.013765225186944008, decouple_loss:0.0017581856809556484
loss_pred:0.01369940210133791, decouple_loss:0.001908409409224987loss_pred:0.014298886992037296, decouple_loss:0.0017096411902457476
Iteration: 642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491598308086395, gen p mean: -0.046802449971437454, mean p set: 0.4496401250362396
loss_pred:0.01372669730335474, decouple_loss:0.0018093220423907042
The modified gen p mean: 0.4479733109474182, gen p mean: -0.04442274570465088, mean p set: 0.4484536051750183The modified gen p mean: 0.4481983482837677, gen p mean: -0.04481833428144455, mean p set: 0.4486786425113678
loss_pred:0.01446167565882206, decouple_loss:0.0017330151749774814
loss_pred:0.014290811493992805, decouple_loss:0.0016607351135462523
Iteration: 643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484595060348511, gen p mean: -0.04545608162879944, mean p set: 0.4489397704601288
The modified gen p mean: 0.4475499987602234, gen p mean: -0.038796547800302505, mean p set: 0.4480302929878235
loss_pred:0.013256832025945187, decouple_loss:0.001945295836776495
loss_pred:0.013910719193518162, decouple_loss:0.0017495739739388227
The modified gen p mean: 0.4489932358264923, gen p mean: -0.04944026097655296, mean p set: 0.4494735598564148
loss_pred:0.013658997602760792, decouple_loss:0.0017921378603205085
Iteration: 644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494486153125763, gen p mean: -0.048809800297021866, mean p set: 0.449928879737854
The modified gen p mean: 0.4490394592285156, gen p mean: -0.046213001012802124, mean p set: 0.44951972365379333
loss_pred:0.013723299838602543, decouple_loss:0.0017707274528220296
loss_pred:0.013595030643045902, decouple_loss:0.0018114045960828662
The modified gen p mean: 0.44809702038764954, gen p mean: -0.049652744084596634, mean p set: 0.448577344417572
loss_pred:0.013332796283066273, decouple_loss:0.001736883306875825
Iteration: 645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488207697868347, gen p mean: -0.048839420080184937, mean p set: 0.4493010640144348
The modified gen p mean: 0.4478198289871216, gen p mean: -0.046539660543203354, mean p set: 0.4483001232147217
loss_pred:0.01370225753635168, decouple_loss:0.00174101407174021
loss_pred:0.01382637768983841, decouple_loss:0.0017236493295058608
The modified gen p mean: 0.4491133987903595, gen p mean: -0.04599003493785858, mean p set: 0.4495936930179596
loss_pred:0.0133849261328578, decouple_loss:0.0017107371240854263
Iteration: 646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44782623648643494, gen p mean: -0.037141453474760056, mean p set: 0.44830653071403503
The modified gen p mean: 0.4489580988883972, gen p mean: -0.04127935692667961, mean p set: 0.4494384229183197
loss_pred:0.01367907878011465, decouple_loss:0.0018840916454792023
loss_pred:0.013223005458712578, decouple_loss:0.0019242017297074199
The modified gen p mean: 0.44856327772140503, gen p mean: -0.048475004732608795, mean p set: 0.4490435719490051
loss_pred:0.013667193241417408, decouple_loss:0.0017924568383023143
Iteration: 647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486227035522461, gen p mean: -0.04708942398428917, mean p set: 0.4491029977798462
The modified gen p mean: 0.4486387372016907, gen p mean: -0.04374031350016594, mean p set: 0.44911903142929077
loss_pred:0.01345602422952652, decouple_loss:0.0016235358780249953
loss_pred:0.013525743968784809, decouple_loss:0.001612368505448103
The modified gen p mean: 0.4489286243915558, gen p mean: -0.046684395521879196, mean p set: 0.4494089186191559
loss_pred:0.013466320931911469, decouple_loss:0.0015633681323379278
Iteration: 648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44886156916618347, gen p mean: -0.045062899589538574, mean p set: 0.44934189319610596
The modified gen p mean: 0.4480119049549103, gen p mean: -0.04029938578605652, mean p set: 0.448492169380188
loss_pred:0.013435653410851955, decouple_loss:0.0016383385518565774
loss_pred:0.013792655430734158, decouple_loss:0.0016278796829283237
The modified gen p mean: 0.44813084602355957, gen p mean: -0.04827135428786278, mean p set: 0.44861117005348206
loss_pred:0.013562181033194065, decouple_loss:0.0016914786538109183
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494735300540924, gen p mean: -0.043634168803691864, mean p set: 0.4499538242816925
The modified gen p mean: 0.4489731192588806, gen p mean: -0.04577118158340454, mean p set: 0.4494534134864807
loss_pred:0.013608435168862343, decouple_loss:0.0016049384139478207
loss_pred:0.013051018118858337, decouple_loss:0.0015718461945652962
The modified gen p mean: 0.4475438594818115, gen p mean: -0.04995577409863472, mean p set: 0.4480241537094116
loss_pred:0.01361316628754139, decouple_loss:0.0016023723874241114
Iteration: 650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473295211791992, gen p mean: -0.045117393136024475, mean p set: 0.4478098452091217
The modified gen p mean: 0.4495258927345276, gen p mean: -0.05203644186258316, mean p set: 0.4500062167644501
loss_pred:0.01397812832146883, decouple_loss:0.0014056486543267965
loss_pred:0.013769606128334999, decouple_loss:0.001489426358602941
The modified gen p mean: 0.4495750963687897, gen p mean: -0.04780072718858719, mean p set: 0.45005539059638977
loss_pred:0.013227395713329315, decouple_loss:0.0014553375076502562
2023-04-30 06:08:49 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04626874253153801, mean p set: 0.4502691626548767
The modified gen p mean: 0.4498766362667084, gen p mean: -0.04106852412223816, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.041518259793519974, mean p set: 0.4500633478164673
loss_pred:0.019375579431653023, decouple_loss:0.0015115279238671064
loss_pred:0.018239976838231087, decouple_loss:0.0015749039594084024
loss_pred:0.018365126103162766, decouple_loss:0.0015206232201308012
WV_0_PC_1_EH_0_PS_40, loss: 0.018737010657787323, avg_mse: 0.027281012386083603
current test mse: 0.027281
Iteration: 651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44924524426460266, gen p mean: -0.04373767971992493, mean p set: 0.44972550868988037
The modified gen p mean: 0.44915643334388733, gen p mean: -0.04772940278053284, mean p set: 0.4496367573738098
The modified gen p mean: 0.4486866891384125, gen p mean: -0.040945786982774734, mean p set: 0.4491669833660126
loss_pred:0.013283793814480305, decouple_loss:0.0014884896809235215
loss_pred:0.013506653718650341, decouple_loss:0.0014368362026289105
loss_pred:0.01303640753030777, decouple_loss:0.0014452053001150489
Iteration: 652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948339462280273, gen p mean: -0.04347983002662659, mean p set: 0.4499637186527252
loss_pred:0.01325670164078474, decouple_loss:0.0014288281090557575
The modified gen p mean: 0.44894957542419434, gen p mean: -0.0455542653799057, mean p set: 0.44942986965179443The modified gen p mean: 0.4492949843406677, gen p mean: -0.04180426895618439, mean p set: 0.4497752785682678
loss_pred:0.013515481725335121, decouple_loss:0.0013905036030337214
loss_pred:0.013022208586335182, decouple_loss:0.0014809585409238935
Iteration: 653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853851199150085, gen p mean: -0.037495892494916916, mean p set: 0.44901883602142334
loss_pred:0.012852936051785946, decouple_loss:0.0014110576594248414
The modified gen p mean: 0.4493795335292816, gen p mean: -0.04392712190747261, mean p set: 0.4498598277568817The modified gen p mean: 0.4493986666202545, gen p mean: -0.043802518397569656, mean p set: 0.4498789310455322
loss_pred:0.013229986652731895, decouple_loss:0.0013465842930600047
loss_pred:0.013161228969693184, decouple_loss:0.0013661017874255776
Iteration: 654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488867223262787, gen p mean: -0.039079152047634125, mean p set: 0.4493670165538788
The modified gen p mean: 0.44797807931900024, gen p mean: -0.042756520211696625, mean p set: 0.44845834374427795
loss_pred:0.013080786913633347, decouple_loss:0.0012765248538926244
loss_pred:0.013317501172423363, decouple_loss:0.0013481492642313242
The modified gen p mean: 0.44788870215415955, gen p mean: -0.03752628341317177, mean p set: 0.44836896657943726
loss_pred:0.013697611168026924, decouple_loss:0.0013630789471790195
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44648075103759766, gen p mean: -0.04163016751408577, mean p set: 0.44696107506752014
loss_pred:0.01352668646723032, decouple_loss:0.001324447337538004
The modified gen p mean: 0.4466645419597626, gen p mean: -0.04160917177796364, mean p set: 0.44714486598968506The modified gen p mean: 0.4472917318344116, gen p mean: -0.039885781705379486, mean p set: 0.4477720260620117
loss_pred:0.013525689952075481, decouple_loss:0.0012133605778217316
loss_pred:0.013380318880081177, decouple_loss:0.0012288527796044946
Iteration: 656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879624247550964, gen p mean: -0.04470044746994972, mean p set: 0.44927650690078735
loss_pred:0.012938212603330612, decouple_loss:0.0012737425277009606
The modified gen p mean: 0.44775256514549255, gen p mean: -0.04657156765460968, mean p set: 0.44823282957077026The modified gen p mean: 0.44720175862312317, gen p mean: -0.04020484909415245, mean p set: 0.44768208265304565
loss_pred:0.013112306594848633, decouple_loss:0.0012734918855130672
loss_pred:0.013706914149224758, decouple_loss:0.0013614350464195013
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476628601551056, gen p mean: -0.042099304497241974, mean p set: 0.4481431543827057
loss_pred:0.013054360635578632, decouple_loss:0.001319803879596293
The modified gen p mean: 0.4486105442047119, gen p mean: -0.04627488926053047, mean p set: 0.449090838432312The modified gen p mean: 0.4478265643119812, gen p mean: -0.041670579463243484, mean p set: 0.4483067989349365
loss_pred:0.012787479907274246, decouple_loss:0.0013057705946266651
loss_pred:0.014000322669744492, decouple_loss:0.001236246433109045
Iteration: 658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480348825454712, gen p mean: -0.042487889528274536, mean p set: 0.4485151767730713
loss_pred:0.012819902040064335, decouple_loss:0.0012117349542677402
The modified gen p mean: 0.4463931620121002, gen p mean: -0.04548779875040054, mean p set: 0.44687342643737793The modified gen p mean: 0.44811418652534485, gen p mean: -0.043185990303754807, mean p set: 0.44859448075294495
loss_pred:0.013888581655919552, decouple_loss:0.001198577112518251
loss_pred:0.013595301657915115, decouple_loss:0.0012774023925885558
Iteration: 659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466207027435303, gen p mean: -0.042439162731170654, mean p set: 0.44710099697113037
loss_pred:0.012533563189208508, decouple_loss:0.0012572514824569225
The modified gen p mean: 0.44574248790740967, gen p mean: -0.04326357692480087, mean p set: 0.4462227523326874The modified gen p mean: 0.44639071822166443, gen p mean: -0.04302902892231941, mean p set: 0.44687098264694214
loss_pred:0.012638120912015438, decouple_loss:0.0013104076497256756
loss_pred:0.012933794409036636, decouple_loss:0.0013324745232239366
Iteration: 660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470219612121582, gen p mean: -0.04440201446413994, mean p set: 0.4475022256374359
The modified gen p mean: 0.44825175404548645, gen p mean: -0.041336387395858765, mean p set: 0.44873204827308655
loss_pred:0.012912290170788765, decouple_loss:0.001301619573496282
loss_pred:0.01262224093079567, decouple_loss:0.0013357892166823149
The modified gen p mean: 0.4470670819282532, gen p mean: -0.04170995578169823, mean p set: 0.44754740595817566
loss_pred:0.013246141374111176, decouple_loss:0.0014645025366917253
2023-04-30 06:11:20 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04467150196433067, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.040019016712903976, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.039701834321022034, mean p set: 0.45035696029663086
loss_pred:0.01938553713262081, decouple_loss:0.001361725153401494
loss_pred:0.018443170934915543, decouple_loss:0.001210013753734529loss_pred:0.018293777480721474, decouple_loss:0.0012271929299458861
WV_0_PC_1_EH_0_PS_40, loss: 0.018770812079310417, avg_mse: 0.027434837073087692
current test mse: 0.027435
Iteration: 661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484339952468872, gen p mean: -0.047412242740392685, mean p set: 0.4489142596721649
The modified gen p mean: 0.4470917880535126, gen p mean: -0.04291760176420212, mean p set: 0.44757208228111267
The modified gen p mean: 0.44880780577659607, gen p mean: -0.046210575848817825, mean p set: 0.44928810000419617
loss_pred:0.013086063787341118, decouple_loss:0.0012776725925505161
loss_pred:0.012862194329500198, decouple_loss:0.0012421126011759043
loss_pred:0.012563034892082214, decouple_loss:0.0011764124501496553
Iteration: 662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481533467769623, gen p mean: -0.04608269780874252, mean p set: 0.4486336410045624
The modified gen p mean: 0.44699421525001526, gen p mean: -0.04412851110100746, mean p set: 0.44747447967529297
loss_pred:0.01289471983909607, decouple_loss:0.0013378991279751062
The modified gen p mean: 0.448044091463089, gen p mean: -0.04211912304162979, mean p set: 0.4485243558883667loss_pred:0.013080214150249958, decouple_loss:0.0015102402539923787
loss_pred:0.012550842016935349, decouple_loss:0.001424433314241469
Iteration: 663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44644472002983093, gen p mean: -0.043400414288043976, mean p set: 0.4469250440597534
loss_pred:0.013488393276929855, decouple_loss:0.0012984462082386017
The modified gen p mean: 0.44865885376930237, gen p mean: -0.04902033507823944, mean p set: 0.44913914799690247The modified gen p mean: 0.44653376936912537, gen p mean: -0.044132739305496216, mean p set: 0.44701406359672546
loss_pred:0.013219311833381653, decouple_loss:0.001252669608220458
loss_pred:0.013078692369163036, decouple_loss:0.0012651414144784212
Iteration: 664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466317892074585, gen p mean: -0.0437457300722599, mean p set: 0.4471120834350586
loss_pred:0.013085607439279556, decouple_loss:0.0011580243008211255
The modified gen p mean: 0.4467603862285614, gen p mean: -0.04188484326004982, mean p set: 0.4472406804561615The modified gen p mean: 0.44881632924079895, gen p mean: -0.04653426259756088, mean p set: 0.44929662346839905
loss_pred:0.013127382844686508, decouple_loss:0.0011719014728441834
loss_pred:0.012707957066595554, decouple_loss:0.0012043101014569402
Iteration: 665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729161262512207, gen p mean: -0.04042357951402664, mean p set: 0.44777190685272217
loss_pred:0.012591661885380745, decouple_loss:0.001376529922708869
The modified gen p mean: 0.4462290108203888, gen p mean: -0.044550687074661255, mean p set: 0.4467092752456665The modified gen p mean: 0.44603413343429565, gen p mean: -0.04640256613492966, mean p set: 0.44651445746421814
loss_pred:0.012194876559078693, decouple_loss:0.0014563532313331962
loss_pred:0.013324640691280365, decouple_loss:0.0016295656096190214
Iteration: 666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482642710208893, gen p mean: -0.04384490102529526, mean p set: 0.4487445652484894
loss_pred:0.01296408474445343, decouple_loss:0.0012616768945008516
The modified gen p mean: 0.4479070007801056, gen p mean: -0.04663141444325447, mean p set: 0.4483872950077057The modified gen p mean: 0.4459710121154785, gen p mean: -0.045034926384687424, mean p set: 0.4464513063430786
loss_pred:0.012725631706416607, decouple_loss:0.0012686230475082994
loss_pred:0.013345086947083473, decouple_loss:0.0013233721256256104
Iteration: 667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755735993385315, gen p mean: -0.041141923516988754, mean p set: 0.44803762435913086
loss_pred:0.012983645312488079, decouple_loss:0.001327879261225462
The modified gen p mean: 0.4472421705722809, gen p mean: -0.041221294552087784, mean p set: 0.44772249460220337The modified gen p mean: 0.44615438580513, gen p mean: -0.043078549206256866, mean p set: 0.4466347098350525
loss_pred:0.012801232747733593, decouple_loss:0.0014981274725869298
loss_pred:0.0132163530215621, decouple_loss:0.0013870475813746452
Iteration: 668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478665292263031, gen p mean: -0.040424544364213943, mean p set: 0.4483468234539032
loss_pred:0.012520752847194672, decouple_loss:0.0011745237279683352
The modified gen p mean: 0.44770726561546326, gen p mean: -0.04404575005173683, mean p set: 0.44818755984306335The modified gen p mean: 0.44694459438323975, gen p mean: -0.0445648655295372, mean p set: 0.44742488861083984
loss_pred:0.013414242304861546, decouple_loss:0.0012335750507190824
loss_pred:0.012625412084162235, decouple_loss:0.0012264216784387827
Iteration: 669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44523462653160095, gen p mean: -0.04431137815117836, mean p set: 0.44571492075920105
loss_pred:0.012208202853798866, decouple_loss:0.0013056829338893294
The modified gen p mean: 0.4455767571926117, gen p mean: -0.04336170479655266, mean p set: 0.4460570514202118The modified gen p mean: 0.4468749761581421, gen p mean: -0.03889787197113037, mean p set: 0.4473552703857422
loss_pred:0.012116877362132072, decouple_loss:0.00129896670114249
loss_pred:0.012831315398216248, decouple_loss:0.0014469204470515251
Iteration: 670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669008255004883, gen p mean: -0.041819024831056595, mean p set: 0.44717034697532654
The modified gen p mean: 0.447226345539093, gen p mean: -0.040394581854343414, mean p set: 0.4477066397666931
loss_pred:0.013040154241025448, decouple_loss:0.0015191936399787664
loss_pred:0.013274269178509712, decouple_loss:0.0014096884988248348
The modified gen p mean: 0.44708535075187683, gen p mean: -0.037522587925195694, mean p set: 0.4475656747817993
loss_pred:0.012964755296707153, decouple_loss:0.0013734792592003942
2023-04-30 06:13:13 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.040698956698179245, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03627355024218559, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.03666387498378754, mean p set: 0.4500633478164673
loss_pred:0.019282782450318336, decouple_loss:0.0014994499506428838
loss_pred:0.01814604364335537, decouple_loss:0.0014486692380160093
loss_pred:0.01829780451953411, decouple_loss:0.001386706018820405
WV_0_PC_1_EH_0_PS_40, loss: 0.01864778995513916, avg_mse: 0.02719978243112564
current test mse: 0.0272
Iteration: 671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481518268585205, gen p mean: -0.03953518718481064, mean p set: 0.4486321210861206
The modified gen p mean: 0.44730597734451294, gen p mean: -0.03936053067445755, mean p set: 0.44778627157211304
The modified gen p mean: 0.4475003480911255, gen p mean: -0.039208825677633286, mean p set: 0.4479806125164032
loss_pred:0.012876677326858044, decouple_loss:0.0013761516893282533
loss_pred:0.012762953527271748, decouple_loss:0.0014421714004129171
loss_pred:0.012964807450771332, decouple_loss:0.0014187201159074903
Iteration: 672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799819588661194, gen p mean: -0.0389302633702755, mean p set: 0.44847849011421204
loss_pred:0.01263263076543808, decouple_loss:0.0012317918008193374
The modified gen p mean: 0.4481727182865143, gen p mean: -0.04021086171269417, mean p set: 0.4486530125141144The modified gen p mean: 0.44795510172843933, gen p mean: -0.037994660437107086, mean p set: 0.44843539595603943
loss_pred:0.0124546242877841, decouple_loss:0.0012524116318672895
loss_pred:0.013867294415831566, decouple_loss:0.001228376175276935
Iteration: 673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723355770111084, gen p mean: -0.03789646923542023, mean p set: 0.4477138817310333
The modified gen p mean: 0.44901183247566223, gen p mean: -0.04426724091172218, mean p set: 0.44949212670326233
loss_pred:0.012766449712216854, decouple_loss:0.0014320916961878538
loss_pred:0.012596438638865948, decouple_loss:0.0015358851524069905
The modified gen p mean: 0.4474366009235382, gen p mean: -0.03778201714158058, mean p set: 0.4479168951511383
loss_pred:0.012344220653176308, decouple_loss:0.0013039616169407964
Iteration: 674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465906620025635, gen p mean: -0.04387286305427551, mean p set: 0.4470709264278412
The modified gen p mean: 0.44767576456069946, gen p mean: -0.04004960134625435, mean p set: 0.44815605878829956
loss_pred:0.013155405409634113, decouple_loss:0.0010922923684120178
loss_pred:0.012469660490751266, decouple_loss:0.0011377575574442744
The modified gen p mean: 0.4483518600463867, gen p mean: -0.041188087314367294, mean p set: 0.4488321542739868
loss_pred:0.012519503012299538, decouple_loss:0.0011047318112105131
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488367736339569, gen p mean: -0.04505843669176102, mean p set: 0.449317067861557
loss_pred:0.01261537242680788, decouple_loss:0.001441745669580996
The modified gen p mean: 0.4493180513381958, gen p mean: -0.04599043354392052, mean p set: 0.4497983753681183The modified gen p mean: 0.44960033893585205, gen p mean: -0.0373656302690506, mean p set: 0.45008060336112976
loss_pred:0.01319084595888853, decouple_loss:0.0015202867798507214
loss_pred:0.013286305591464043, decouple_loss:0.0014001114759594202
Iteration: 676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481185972690582, gen p mean: -0.04194539785385132, mean p set: 0.4485989212989807
loss_pred:0.013730409555137157, decouple_loss:0.0015366459265351295
The modified gen p mean: 0.44753149151802063, gen p mean: -0.045101020485162735, mean p set: 0.4480117857456207The modified gen p mean: 0.4482285976409912, gen p mean: -0.04167165234684944, mean p set: 0.4487088918685913
loss_pred:0.012988907285034657, decouple_loss:0.0014789302367717028
loss_pred:0.012890750542283058, decouple_loss:0.0014617887791246176
Iteration: 677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753068685531616, gen p mean: -0.04296809807419777, mean p set: 0.44801095128059387
The modified gen p mean: 0.44984617829322815, gen p mean: -0.03976193070411682, mean p set: 0.45032650232315063
loss_pred:0.013008627109229565, decouple_loss:0.0012087905779480934
The modified gen p mean: 0.4479621946811676, gen p mean: -0.04622078686952591, mean p set: 0.4484424889087677loss_pred:0.013141291216015816, decouple_loss:0.0011166075710207224
loss_pred:0.013128841295838356, decouple_loss:0.0011086770100519061
Iteration: 678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725847244262695, gen p mean: -0.042540304362773895, mean p set: 0.44773876667022705
loss_pred:0.013005838729441166, decouple_loss:0.001488490728661418
The modified gen p mean: 0.44838017225265503, gen p mean: -0.038792114704847336, mean p set: 0.4488604962825775The modified gen p mean: 0.4478338658809662, gen p mean: -0.04472757875919342, mean p set: 0.4483141601085663
loss_pred:0.012931972742080688, decouple_loss:0.0015137315494939685
loss_pred:0.01325220800936222, decouple_loss:0.0015598125755786896
Iteration: 679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483799636363983, gen p mean: -0.042110372334718704, mean p set: 0.4488602578639984
loss_pred:0.012842761352658272, decouple_loss:0.001316905952990055
The modified gen p mean: 0.4487735629081726, gen p mean: -0.042252104729413986, mean p set: 0.4492538273334503The modified gen p mean: 0.4472748637199402, gen p mean: -0.04527590051293373, mean p set: 0.4477550983428955
loss_pred:0.012905840761959553, decouple_loss:0.001256540883332491
loss_pred:0.013039898127317429, decouple_loss:0.0011813450837507844
Iteration: 680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480086863040924, gen p mean: -0.04007937014102936, mean p set: 0.4484889805316925
The modified gen p mean: 0.44762134552001953, gen p mean: -0.04127153009176254, mean p set: 0.44810163974761963
The modified gen p mean: 0.4472012519836426, gen p mean: -0.03963029012084007, mean p set: 0.44768157601356506
loss_pred:0.01310427114367485, decouple_loss:0.0014524847501888871
loss_pred:0.012834570370614529, decouple_loss:0.0014849696308374405
loss_pred:0.012825356796383858, decouple_loss:0.0012936561834067106
2023-04-30 06:15:44 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.03980397805571556, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.035876400768756866, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.036284543573856354, mean p set: 0.4500633478164673
loss_pred:0.01936582289636135, decouple_loss:0.0014193253591656685
loss_pred:0.01823686994612217, decouple_loss:0.0013352896785363555
loss_pred:0.018343640491366386, decouple_loss:0.0014675370184704661
WV_0_PC_1_EH_0_PS_40, loss: 0.018719147890806198, avg_mse: 0.02736722119152546
current test mse: 0.027367
Iteration: 681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799748063087463, gen p mean: -0.04154330492019653, mean p set: 0.44847777485847473
The modified gen p mean: 0.4486769437789917, gen p mean: -0.03044014237821102, mean p set: 0.4491572082042694
The modified gen p mean: 0.4487232267856598, gen p mean: -0.038011882454156876, mean p set: 0.4492034912109375
loss_pred:0.013029059395194054, decouple_loss:0.001283967518247664
loss_pred:0.013389638625085354, decouple_loss:0.0013404716737568378
loss_pred:0.012978601269423962, decouple_loss:0.0012890060897916555
Iteration: 682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495009481906891, gen p mean: -0.04227600246667862, mean p set: 0.4499812126159668
The modified gen p mean: 0.44893890619277954, gen p mean: -0.040861647576093674, mean p set: 0.44941920042037964
loss_pred:0.012536275200545788, decouple_loss:0.0016682296991348267
loss_pred:0.013355029746890068, decouple_loss:0.0015056340489536524
The modified gen p mean: 0.44853904843330383, gen p mean: -0.039420027285814285, mean p set: 0.44901934266090393
loss_pred:0.012871792539954185, decouple_loss:0.0014412800082936883
Iteration: 683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477007985115051, gen p mean: -0.04006391763687134, mean p set: 0.4481810927391052
The modified gen p mean: 0.44864317774772644, gen p mean: -0.0431637279689312, mean p set: 0.44912344217300415
loss_pred:0.013652808032929897, decouple_loss:0.0017124585574492812
loss_pred:0.012059432454407215, decouple_loss:0.0013578449143096805
The modified gen p mean: 0.4483950734138489, gen p mean: -0.042788680642843246, mean p set: 0.44887539744377136
loss_pred:0.01244326587766409, decouple_loss:0.0015760003589093685
Iteration: 684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494490623474121, gen p mean: -0.043918851763010025, mean p set: 0.4499293565750122
The modified gen p mean: 0.44788190722465515, gen p mean: -0.04587008059024811, mean p set: 0.44836223125457764
The modified gen p mean: 0.4487558901309967, gen p mean: -0.03761792927980423, mean p set: 0.4492361843585968
loss_pred:0.013235369697213173, decouple_loss:0.0011364960810169578
loss_pred:0.013010186143219471, decouple_loss:0.0012315016938373446
loss_pred:0.012613008730113506, decouple_loss:0.0013837168226018548
Iteration: 685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476511776447296, gen p mean: -0.04618481174111366, mean p set: 0.4481314718723297
The modified gen p mean: 0.44836118817329407, gen p mean: -0.04274486005306244, mean p set: 0.44884148240089417
loss_pred:0.013268501497805119, decouple_loss:0.001201294595375657
loss_pred:0.012573915533721447, decouple_loss:0.0014541588025167584
The modified gen p mean: 0.44853323698043823, gen p mean: -0.047321852296590805, mean p set: 0.44901350140571594
loss_pred:0.012403802946209908, decouple_loss:0.0014270396204665303
Iteration: 686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44885775446891785, gen p mean: -0.05006081238389015, mean p set: 0.44933804869651794
The modified gen p mean: 0.44756239652633667, gen p mean: -0.03465333953499794, mean p set: 0.44804272055625916
loss_pred:0.012217273935675621, decouple_loss:0.0010302362497895956
loss_pred:0.012924186885356903, decouple_loss:0.0011902468977496028
The modified gen p mean: 0.44714075326919556, gen p mean: -0.046832773834466934, mean p set: 0.44762104749679565
loss_pred:0.012976155616343021, decouple_loss:0.001201185630634427
Iteration: 687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44759809970855713, gen p mean: -0.04538857191801071, mean p set: 0.4480784237384796
loss_pred:0.01301261130720377, decouple_loss:0.0012599005131050944
The modified gen p mean: 0.44893336296081543, gen p mean: -0.04334622621536255, mean p set: 0.4494136571884155
The modified gen p mean: 0.44782161712646484, gen p mean: -0.04486095532774925, mean p set: 0.44830194115638733
loss_pred:0.012196588329970837, decouple_loss:0.0009985566139221191
loss_pred:0.01258617453277111, decouple_loss:0.001260582241229713
Iteration: 688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484681785106659, gen p mean: -0.043041013181209564, mean p set: 0.448948472738266
The modified gen p mean: 0.4480818510055542, gen p mean: -0.03326922282576561, mean p set: 0.4485621154308319
loss_pred:0.01285423245280981, decouple_loss:0.0011753571452572942
loss_pred:0.012842100113630295, decouple_loss:0.0010858960449695587
The modified gen p mean: 0.44741275906562805, gen p mean: -0.04242181032896042, mean p set: 0.44789305329322815
loss_pred:0.013416698202490807, decouple_loss:0.0011039607925340533
Iteration: 689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44718945026397705, gen p mean: -0.04144754633307457, mean p set: 0.44766971468925476
loss_pred:0.013268805108964443, decouple_loss:0.0010854373686015606
The modified gen p mean: 0.4492121636867523, gen p mean: -0.03974943980574608, mean p set: 0.4496924579143524The modified gen p mean: 0.4494127631187439, gen p mean: -0.03950178623199463, mean p set: 0.449893057346344
loss_pred:0.012578973546624184, decouple_loss:0.0013053022557869554
loss_pred:0.012855999171733856, decouple_loss:0.0011795987375080585
Iteration: 690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492904543876648, gen p mean: -0.04244612902402878, mean p set: 0.4497707486152649
loss_pred:0.012755806557834148, decouple_loss:0.0010553053580224514
The modified gen p mean: 0.44861671328544617, gen p mean: -0.03794831410050392, mean p set: 0.44909700751304626The modified gen p mean: 0.4488871693611145, gen p mean: -0.035669583827257156, mean p set: 0.4493674635887146
loss_pred:0.013069613836705685, decouple_loss:0.0011082871351391077
loss_pred:0.012473737820982933, decouple_loss:0.0010541747324168682
2023-04-30 06:17:37 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04059132933616638, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03674447908997536, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.03676960617303848, mean p set: 0.4500633478164673
loss_pred:0.01940811797976494, decouple_loss:0.0010989345610141754
loss_pred:0.018247215077280998, decouple_loss:0.001094165025278926
loss_pred:0.018399322405457497, decouple_loss:0.001071461825631559
WV_0_PC_1_EH_0_PS_40, loss: 0.01873929612338543, avg_mse: 0.02744823880493641
current test mse: 0.027448
Iteration: 691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486500322818756, gen p mean: -0.03965487703680992, mean p set: 0.4491303265094757
The modified gen p mean: 0.44788235425949097, gen p mean: -0.04150170460343361, mean p set: 0.44836267828941345
The modified gen p mean: 0.4490025043487549, gen p mean: -0.0345211923122406, mean p set: 0.449482798576355
loss_pred:0.013044863007962704, decouple_loss:0.0011577694676816463
loss_pred:0.012377032078802586, decouple_loss:0.0010909978300333023
loss_pred:0.012963438406586647, decouple_loss:0.0011312984861433506
Iteration: 692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44782891869544983, gen p mean: -0.04288351163268089, mean p set: 0.4483092129230499
The modified gen p mean: 0.44979754090309143, gen p mean: -0.041661880910396576, mean p set: 0.4502778649330139
loss_pred:0.012521239928901196, decouple_loss:0.001130062504671514
loss_pred:0.013281259685754776, decouple_loss:0.0011374994646757841
The modified gen p mean: 0.448137491941452, gen p mean: -0.04107435792684555, mean p set: 0.4486178159713745
loss_pred:0.012590832076966763, decouple_loss:0.0012030755169689655
Iteration: 693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44682610034942627, gen p mean: -0.045030172914266586, mean p set: 0.44730639457702637
The modified gen p mean: 0.44869518280029297, gen p mean: -0.04403716325759888, mean p set: 0.44917547702789307
loss_pred:0.012702266685664654, decouple_loss:0.001136770355515182
loss_pred:0.012939494103193283, decouple_loss:0.001286776619963348
The modified gen p mean: 0.4494132995605469, gen p mean: -0.04445508122444153, mean p set: 0.449893593788147
loss_pred:0.0128639442846179, decouple_loss:0.0012008254416286945
Iteration: 694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822728633880615, gen p mean: -0.03451112285256386, mean p set: 0.44870755076408386
loss_pred:0.012446917593479156, decouple_loss:0.0012640014756470919
The modified gen p mean: 0.44900354743003845, gen p mean: -0.046265266835689545, mean p set: 0.44948384165763855The modified gen p mean: 0.44885721802711487, gen p mean: -0.038702938705682755, mean p set: 0.44933751225471497
loss_pred:0.012920046225190163, decouple_loss:0.0011937926756218076
loss_pred:0.012902352027595043, decouple_loss:0.0012335708597674966
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
NaN value num: 0
Iteration: 695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505431652069092, gen p mean: -0.04474039748311043, mean p set: 0.4510234594345093
loss_pred:0.01918875426054001, decouple_loss:0.001303827972151339
The modified gen p mean: 0.4505285322666168, gen p mean: -0.03997037559747696, mean p set: 0.4510088264942169The modified gen p mean: 0.45181918144226074, gen p mean: -0.03607362136244774, mean p set: 0.4522995054721832
loss_pred:0.017518790438771248, decouple_loss:0.0012604512739926577
loss_pred:0.017799267545342445, decouple_loss:0.0013829551171511412
Iteration: 696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44910693168640137, gen p mean: -0.03968746215105057, mean p set: 0.44958722591400146
loss_pred:0.018361138179898262, decouple_loss:0.0013176098000258207
The modified gen p mean: 0.4485863447189331, gen p mean: -0.04567115381360054, mean p set: 0.4490666687488556The modified gen p mean: 0.4514055550098419, gen p mean: -0.03939341381192207, mean p set: 0.451885849237442
loss_pred:0.01833798550069332, decouple_loss:0.0014526117593050003
loss_pred:0.017895134165883064, decouple_loss:0.0012833686778321862
Iteration: 697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904351234436035, gen p mean: -0.03904275223612785, mean p set: 0.44952380657196045
loss_pred:0.017629949375987053, decouple_loss:0.0013427914818748832
The modified gen p mean: 0.4485812485218048, gen p mean: -0.03269495442509651, mean p set: 0.4490615427494049The modified gen p mean: 0.448527067899704, gen p mean: -0.03821583092212677, mean p set: 0.44900739192962646
loss_pred:0.018960019573569298, decouple_loss:0.001239545876160264
loss_pred:0.01819302700459957, decouple_loss:0.0012758222874253988
Iteration: 698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500126540660858, gen p mean: -0.04011800140142441, mean p set: 0.4504929184913635
The modified gen p mean: 0.4500460922718048, gen p mean: -0.03447442874312401, mean p set: 0.4505264163017273
loss_pred:0.017885247245430946, decouple_loss:0.0015077304560691118
loss_pred:0.01682189479470253, decouple_loss:0.0016629844903945923
The modified gen p mean: 0.45216304063796997, gen p mean: -0.03375695273280144, mean p set: 0.45264333486557007
loss_pred:0.01709190383553505, decouple_loss:0.0014440091326832771
Iteration: 699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490102231502533, gen p mean: -0.04388866201043129, mean p set: 0.4494905471801758
The modified gen p mean: 0.4501246213912964, gen p mean: -0.038373127579689026, mean p set: 0.45060494542121887
loss_pred:0.017234716564416885, decouple_loss:0.001615104149095714
loss_pred:0.017971506342291832, decouple_loss:0.0016227677697315812The modified gen p mean: 0.45248979330062866, gen p mean: -0.03646260127425194, mean p set: 0.45297008752822876
loss_pred:0.017171597108244896, decouple_loss:0.0013882676139473915
Iteration: 700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497821629047394, gen p mean: -0.04375961795449257, mean p set: 0.45026248693466187
loss_pred:0.018235748633742332, decouple_loss:0.0015532684046775103
The modified gen p mean: 0.44890162348747253, gen p mean: -0.0376257486641407, mean p set: 0.449381947517395
The modified gen p mean: 0.4493712782859802, gen p mean: -0.041016124188899994, mean p set: 0.4498515725135803
loss_pred:0.017821617424488068, decouple_loss:0.0014858210925012827
loss_pred:0.017027147114276886, decouple_loss:0.0015294228214770555
2023-04-30 06:20:06 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.04735827445983887, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04295533522963524, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04310358688235283, mean p set: 0.4500633478164673
loss_pred:0.018654610961675644, decouple_loss:0.0013536768965423107
loss_pred:0.01752457208931446, decouple_loss:0.0013574897311627865
loss_pred:0.017652003094553947, decouple_loss:0.0013168251607567072
WV_0_PC_1_EH_0_PS_40, loss: 0.018010862171649933, avg_mse: 0.02587338536977768
current test mse: 0.025873
Iteration: 701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45227617025375366, gen p mean: -0.036822449415922165, mean p set: 0.45275649428367615
The modified gen p mean: 0.4502885341644287, gen p mean: -0.04278209060430527, mean p set: 0.4507688283920288
The modified gen p mean: 0.44949978590011597, gen p mean: -0.03734971582889557, mean p set: 0.4499800503253937
loss_pred:0.018330560997128487, decouple_loss:0.0013225959846749902
loss_pred:0.017024023458361626, decouple_loss:0.001307159778662026
loss_pred:0.017882023006677628, decouple_loss:0.0013142484240233898
Iteration: 702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478793740272522, gen p mean: -0.03999532759189606, mean p set: 0.4483596682548523
loss_pred:0.01823524571955204, decouple_loss:0.0014314951840788126
The modified gen p mean: 0.45140236616134644, gen p mean: -0.04559623822569847, mean p set: 0.4518826901912689The modified gen p mean: 0.44982659816741943, gen p mean: -0.04602830484509468, mean p set: 0.45030689239501953
loss_pred:0.01779610849916935, decouple_loss:0.0013815922429785132
loss_pred:0.016974451020359993, decouple_loss:0.0014007705030962825
Iteration: 703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500935971736908, gen p mean: -0.051581233739852905, mean p set: 0.4505738615989685
loss_pred:0.016927096992731094, decouple_loss:0.0013670331100001931
The modified gen p mean: 0.44863754510879517, gen p mean: -0.04653988778591156, mean p set: 0.44911783933639526The modified gen p mean: 0.45017823576927185, gen p mean: -0.04623614251613617, mean p set: 0.45065850019454956
loss_pred:0.016911664977669716, decouple_loss:0.0013282286236062646
loss_pred:0.016953840851783752, decouple_loss:0.0013692282373085618
Iteration: 704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513235092163086, gen p mean: -0.046419452875852585, mean p set: 0.4518038034439087
The modified gen p mean: 0.45145854353904724, gen p mean: -0.045100536197423935, mean p set: 0.45193883776664734
loss_pred:0.01666678674519062, decouple_loss:0.0013021125923842192
loss_pred:0.016933893784880638, decouple_loss:0.0012519974261522293
The modified gen p mean: 0.44975748658180237, gen p mean: -0.05119405314326286, mean p set: 0.45023781061172485
loss_pred:0.017224736511707306, decouple_loss:0.0012101692846044898
Iteration: 705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513724744319916, gen p mean: -0.04405243694782257, mean p set: 0.4518527686595917
loss_pred:0.017111998051404953, decouple_loss:0.0014398957137018442
The modified gen p mean: 0.44860783219337463, gen p mean: -0.054304011166095734, mean p set: 0.44908812642097473The modified gen p mean: 0.4500269293785095, gen p mean: -0.04365096613764763, mean p set: 0.4505072236061096
loss_pred:0.016575999557971954, decouple_loss:0.001304778503254056
loss_pred:0.01684185490012169, decouple_loss:0.0013181801186874509
Iteration: 706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45199522376060486, gen p mean: -0.04829860478639603, mean p set: 0.45247551798820496
loss_pred:0.016987208276987076, decouple_loss:0.0012164710788056254
The modified gen p mean: 0.4476179778575897, gen p mean: -0.05393976345658302, mean p set: 0.44809824228286743The modified gen p mean: 0.44997966289520264, gen p mean: -0.04288845881819725, mean p set: 0.45045995712280273
loss_pred:0.017103411257267, decouple_loss:0.001236061449162662
loss_pred:0.016577258706092834, decouple_loss:0.0011872445465996861
Iteration: 707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493011236190796, gen p mean: -0.041317351162433624, mean p set: 0.4497814178466797
The modified gen p mean: 0.4490277171134949, gen p mean: -0.04976397380232811, mean p set: 0.4495079815387726
loss_pred:0.01760431006550789, decouple_loss:0.0011495526414364576
loss_pred:0.01700410805642605, decouple_loss:0.0012707371497526765
The modified gen p mean: 0.4499203860759735, gen p mean: -0.042580075562000275, mean p set: 0.4504006803035736
loss_pred:0.017157673835754395, decouple_loss:0.0012126507936045527
Iteration: 708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45108187198638916, gen p mean: -0.04520561546087265, mean p set: 0.45156213641166687
loss_pred:0.018080413341522217, decouple_loss:0.0012445144820958376
The modified gen p mean: 0.4501555562019348, gen p mean: -0.045663680881261826, mean p set: 0.4506358802318573The modified gen p mean: 0.44900238513946533, gen p mean: -0.05094672739505768, mean p set: 0.4494827091693878
loss_pred:0.017829863354563713, decouple_loss:0.0011840276420116425
loss_pred:0.017394432798027992, decouple_loss:0.0011812960729002953
Iteration: 709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504621624946594, gen p mean: -0.04423172399401665, mean p set: 0.4509424567222595
loss_pred:0.017187900841236115, decouple_loss:0.0012139175087213516
The modified gen p mean: 0.4497230052947998, gen p mean: -0.0496157668530941, mean p set: 0.4502033293247223The modified gen p mean: 0.45092496275901794, gen p mean: -0.04542470723390579, mean p set: 0.45140528678894043
loss_pred:0.016537239775061607, decouple_loss:0.0012143409112468362
loss_pred:0.017009980976581573, decouple_loss:0.0011555461678653955
Iteration: 710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44976598024368286, gen p mean: -0.05154382809996605, mean p set: 0.45024624466896057
loss_pred:0.0168004110455513, decouple_loss:0.0012187586398795247
The modified gen p mean: 0.44945916533470154, gen p mean: -0.053193628787994385, mean p set: 0.44993945956230164The modified gen p mean: 0.4517676532268524, gen p mean: -0.04633218050003052, mean p set: 0.4522479474544525
loss_pred:0.01658184826374054, decouple_loss:0.0011218732688575983
loss_pred:0.016659481450915337, decouple_loss:0.0012346607400104403
2023-04-30 06:22:00 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05261201411485672, mean p set: 0.4502691626548767
The modified gen p mean: 0.4498766362667084, gen p mean: -0.04802190884947777, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04832910746335983, mean p set: 0.4500633478164673
loss_pred:0.018539434298872948, decouple_loss:0.0011735772714018822
loss_pred:0.017451219260692596, decouple_loss:0.0012099231826141477
loss_pred:0.017530087381601334, decouple_loss:0.0011907758889719844
WV_0_PC_1_EH_0_PS_40, loss: 0.01789981871843338, avg_mse: 0.025691093876957893
current test mse: 0.025691
Iteration: 711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45283541083335876, gen p mean: -0.04022861272096634, mean p set: 0.4533156752586365
The modified gen p mean: 0.4504455626010895, gen p mean: -0.04552198201417923, mean p set: 0.4509258568286896
loss_pred:0.017309866845607758, decouple_loss:0.0012271441519260406
The modified gen p mean: 0.45104700326919556, gen p mean: -0.04464017599821091, mean p set: 0.45152729749679565
loss_pred:0.017254669219255447, decouple_loss:0.001231821603141725
loss_pred:0.01718175783753395, decouple_loss:0.0011167451739311218
Iteration: 712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45141148567199707, gen p mean: -0.042401108890771866, mean p set: 0.4518917500972748
The modified gen p mean: 0.4503028690814972, gen p mean: -0.04178612679243088, mean p set: 0.4507831633090973
loss_pred:0.016635125502943993, decouple_loss:0.0012053726240992546
loss_pred:0.01773650385439396, decouple_loss:0.0011694409186020494
The modified gen p mean: 0.4514411389827728, gen p mean: -0.04504219815135002, mean p set: 0.4519214332103729
loss_pred:0.016468070447444916, decouple_loss:0.001161737833172083
Iteration: 713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477841854095459, gen p mean: -0.042113929986953735, mean p set: 0.4482645094394684The modified gen p mean: 0.44969338178634644, gen p mean: -0.04419894888997078, mean p set: 0.45017367601394653
The modified gen p mean: 0.44928374886512756, gen p mean: -0.04272468388080597, mean p set: 0.44976404309272766
loss_pred:0.017888600006699562, decouple_loss:0.0011154825333505869
loss_pred:0.016821885481476784, decouple_loss:0.0011790278367698193
loss_pred:0.017107795923948288, decouple_loss:0.0010651735356077552
Iteration: 714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521656334400177, gen p mean: -0.037414584308862686, mean p set: 0.4526459276676178
The modified gen p mean: 0.44915926456451416, gen p mean: -0.03475813940167427, mean p set: 0.44963955879211426
The modified gen p mean: 0.44893306493759155, gen p mean: -0.04824117571115494, mean p set: 0.44941338896751404
loss_pred:0.0168710108846426, decouple_loss:0.0011220334563404322
loss_pred:0.017387259751558304, decouple_loss:0.001138488412834704loss_pred:0.0166962668299675, decouple_loss:0.0012390156043693423
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
NaN value num: 0
Iteration: 715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520479142665863, gen p mean: -0.03954222798347473, mean p set: 0.4525282084941864
loss_pred:0.01702963002026081, decouple_loss:0.0011369814164936543
The modified gen p mean: 0.4522381126880646, gen p mean: -0.029074694961309433, mean p set: 0.4527184069156647The modified gen p mean: 0.45138242840766907, gen p mean: -0.02872125245630741, mean p set: 0.4518626928329468
loss_pred:0.01812649890780449, decouple_loss:0.0011169877834618092
loss_pred:0.017966385930776596, decouple_loss:0.0010783335892483592
Iteration: 716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451951801776886, gen p mean: -0.025580918416380882, mean p set: 0.45243212580680847
loss_pred:0.0175487007945776, decouple_loss:0.0011287432862445712
The modified gen p mean: 0.4511058032512665, gen p mean: -0.029248472303152084, mean p set: 0.4515860676765442
The modified gen p mean: 0.4496256113052368, gen p mean: -0.02604864351451397, mean p set: 0.4501059055328369
loss_pred:0.017152564600110054, decouple_loss:0.0011766874231398106
loss_pred:0.018269425258040428, decouple_loss:0.0011898871744051576
Iteration: 717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45171889662742615, gen p mean: -0.026105590164661407, mean p set: 0.45219916105270386
loss_pred:0.018540840595960617, decouple_loss:0.0011066627921536565
The modified gen p mean: 0.45159995555877686, gen p mean: -0.023438211530447006, mean p set: 0.45208021998405457The modified gen p mean: 0.4510997235774994, gen p mean: -0.024006152525544167, mean p set: 0.4515799880027771
loss_pred:0.01818842813372612, decouple_loss:0.001107476418837905
loss_pred:0.017072388902306557, decouple_loss:0.0010485121747478843
Iteration: 718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520340859889984, gen p mean: -0.023566240444779396, mean p set: 0.4525144100189209
The modified gen p mean: 0.451391339302063, gen p mean: -0.024397829547524452, mean p set: 0.4518716335296631
loss_pred:0.017987504601478577, decouple_loss:0.001268033985979855
loss_pred:0.017829997465014458, decouple_loss:0.0010654949583113194
The modified gen p mean: 0.4520275294780731, gen p mean: -0.02911427617073059, mean p set: 0.4525078237056732
loss_pred:0.017701735720038414, decouple_loss:0.0010641654953360558
Iteration: 719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452006995677948, gen p mean: -0.028910398483276367, mean p set: 0.4524872899055481
The modified gen p mean: 0.4521905481815338, gen p mean: -0.030256379395723343, mean p set: 0.4526708424091339
loss_pred:0.017637308686971664, decouple_loss:0.0011201222660019994
loss_pred:0.017809059470891953, decouple_loss:0.0010955816833302379
The modified gen p mean: 0.4515107572078705, gen p mean: -0.029012063518166542, mean p set: 0.4519910514354706
loss_pred:0.01747303269803524, decouple_loss:0.001114426413550973
Iteration: 720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45196521282196045, gen p mean: -0.04151078313589096, mean p set: 0.45244550704956055
The modified gen p mean: 0.4516157805919647, gen p mean: -0.0313500314950943, mean p set: 0.45209604501724243
loss_pred:0.01711856573820114, decouple_loss:0.0010609865421429276
loss_pred:0.01792716793715954, decouple_loss:0.0010478479089215398
The modified gen p mean: 0.45116686820983887, gen p mean: -0.030664866790175438, mean p set: 0.45164716243743896
loss_pred:0.017522552981972694, decouple_loss:0.0010713743977248669
2023-04-30 06:24:28 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.048787202686071396, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04417959973216057, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.044739700853824615, mean p set: 0.4500633478164673
loss_pred:0.018499797210097313, decouple_loss:0.001155370962806046
loss_pred:0.01745450496673584, decouple_loss:0.0011282928753644228
loss_pred:0.01751089282333851, decouple_loss:0.0011192905949428678
WV_0_PC_1_EH_0_PS_40, loss: 0.017878448590636253, avg_mse: 0.025671513751149178
current test mse: 0.025672
Iteration: 721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505445659160614, gen p mean: -0.03669460490345955, mean p set: 0.4510248601436615
The modified gen p mean: 0.4515424966812134, gen p mean: -0.04081840068101883, mean p set: 0.4520227611064911
loss_pred:0.017773335799574852, decouple_loss:0.0010843555210158229
The modified gen p mean: 0.452153742313385, gen p mean: -0.03359533101320267, mean p set: 0.4526340067386627
loss_pred:0.017482208088040352, decouple_loss:0.0010651559568941593
loss_pred:0.01772395148873329, decouple_loss:0.0012096310965716839
Iteration: 722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45163705945014954, gen p mean: -0.03986562788486481, mean p set: 0.45211732387542725
The modified gen p mean: 0.4515676498413086, gen p mean: -0.0395665168762207, mean p set: 0.4520479440689087
loss_pred:0.018131263554096222, decouple_loss:0.0011761095374822617
loss_pred:0.0170521792024374, decouple_loss:0.001141529530286789
The modified gen p mean: 0.4527052342891693, gen p mean: -0.040337543934583664, mean p set: 0.4531855285167694
loss_pred:0.01792539469897747, decouple_loss:0.001084239687770605
Iteration: 723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45213308930397034, gen p mean: -0.04256787896156311, mean p set: 0.45261338353157043
The modified gen p mean: 0.45136353373527527, gen p mean: -0.04454679414629936, mean p set: 0.45184382796287537
The modified gen p mean: 0.4512491226196289, gen p mean: -0.04310905933380127, mean p set: 0.451729416847229
loss_pred:0.018113579601049423, decouple_loss:0.0010510412976145744
loss_pred:0.017070643603801727, decouple_loss:0.0011139275738969445loss_pred:0.017950186505913734, decouple_loss:0.001059077330864966
Iteration: 724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508665204048157, gen p mean: -0.05145920813083649, mean p set: 0.45134681463241577
The modified gen p mean: 0.4500552713871002, gen p mean: -0.045768968760967255, mean p set: 0.45053553581237793The modified gen p mean: 0.44973111152648926, gen p mean: -0.04514370858669281, mean p set: 0.45021140575408936
loss_pred:0.01721704751253128, decouple_loss:0.0010734453098848462
loss_pred:0.018062060698866844, decouple_loss:0.0010909190168604255
loss_pred:0.018106231465935707, decouple_loss:0.0010259313276037574
Iteration: 725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45214134454727173, gen p mean: -0.04363800957798958, mean p set: 0.4526216387748718
loss_pred:0.017945023253560066, decouple_loss:0.0010562328388914466
The modified gen p mean: 0.45119529962539673, gen p mean: -0.04702213779091835, mean p set: 0.4516755938529968
The modified gen p mean: 0.45300525426864624, gen p mean: -0.04617796465754509, mean p set: 0.4534855782985687
loss_pred:0.01755519211292267, decouple_loss:0.0010408491361886263
loss_pred:0.01768318936228752, decouple_loss:0.000998889678157866
Iteration: 726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505494236946106, gen p mean: -0.04800119623541832, mean p set: 0.4510296881198883
loss_pred:0.018451163545250893, decouple_loss:0.0011004472617059946
The modified gen p mean: 0.4516770541667938, gen p mean: -0.04679257795214653, mean p set: 0.4521573483943939
The modified gen p mean: 0.45157450437545776, gen p mean: -0.04550066217780113, mean p set: 0.45205479860305786
loss_pred:0.01709151081740856, decouple_loss:0.0010051224380731583
loss_pred:0.017885833978652954, decouple_loss:0.001029167789965868
Iteration: 727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515194892883301, gen p mean: -0.043607886880636215, mean p set: 0.45199981331825256
The modified gen p mean: 0.451847106218338, gen p mean: -0.04820831120014191, mean p set: 0.4523273706436157
loss_pred:0.01718107983469963, decouple_loss:0.0010271792998537421
loss_pred:0.01765030063688755, decouple_loss:0.0011855649063363671
The modified gen p mean: 0.45000511407852173, gen p mean: -0.04731175675988197, mean p set: 0.4504854083061218
loss_pred:0.018492767587304115, decouple_loss:0.001039368798956275
Iteration: 728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45136523246765137, gen p mean: -0.049917589873075485, mean p set: 0.4518454968929291
The modified gen p mean: 0.4494275152683258, gen p mean: -0.04434526711702347, mean p set: 0.4499078094959259
loss_pred:0.017494147643446922, decouple_loss:0.0009526802459731698
loss_pred:0.017914358526468277, decouple_loss:0.000996613409370184
The modified gen p mean: 0.4525078535079956, gen p mean: -0.043318334966897964, mean p set: 0.4529881477355957
loss_pred:0.018112339079380035, decouple_loss:0.001197081757709384
Iteration: 729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452606737613678, gen p mean: -0.04790093004703522, mean p set: 0.4530870020389557
The modified gen p mean: 0.45156458020210266, gen p mean: -0.04498559236526489, mean p set: 0.45204487442970276
loss_pred:0.017627064138650894, decouple_loss:0.0010641006520017982
loss_pred:0.01706126146018505, decouple_loss:0.0010413959389552474
The modified gen p mean: 0.45160794258117676, gen p mean: -0.04575828090310097, mean p set: 0.45208823680877686
loss_pred:0.017116354778409004, decouple_loss:0.0010868632234632969
Iteration: 730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45201826095581055, gen p mean: -0.047139182686805725, mean p set: 0.45249855518341064
The modified gen p mean: 0.4515809118747711, gen p mean: -0.045194923877716064, mean p set: 0.4520612061023712
loss_pred:0.017810609191656113, decouple_loss:0.0009753188351169229
loss_pred:0.017709501087665558, decouple_loss:0.0010390931274741888
The modified gen p mean: 0.45214712619781494, gen p mean: -0.047310423105955124, mean p set: 0.45262742042541504
loss_pred:0.01767495647072792, decouple_loss:0.001024369616061449
2023-04-30 06:26:22 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05754000321030617, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05294967070221901, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.053311362862586975, mean p set: 0.4500633478164673
loss_pred:0.018505677580833435, decouple_loss:0.0010566567070782185
loss_pred:0.01742919348180294, decouple_loss:0.0010973605094477534
loss_pred:0.01757226139307022, decouple_loss:0.001067152014002204
WV_0_PC_1_EH_0_PS_40, loss: 0.017889397218823433, avg_mse: 0.025699947029352188
current test mse: 0.0257
Iteration: 731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523071050643921, gen p mean: -0.04577402397990227, mean p set: 0.4527874290943146
The modified gen p mean: 0.4520988166332245, gen p mean: -0.04532057046890259, mean p set: 0.452579140663147
The modified gen p mean: 0.45138177275657654, gen p mean: -0.04621075093746185, mean p set: 0.45186206698417664
loss_pred:0.018220001831650734, decouple_loss:0.0009713700274005532
loss_pred:0.018204504624009132, decouple_loss:0.0010247771861031651
loss_pred:0.018065843731164932, decouple_loss:0.0010813688859343529
Iteration: 732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45214730501174927, gen p mean: -0.03874746337532997, mean p set: 0.452627569437027
loss_pred:0.01815585047006607, decouple_loss:0.001198511803522706
The modified gen p mean: 0.4518471956253052, gen p mean: -0.05160842835903168, mean p set: 0.4523274898529053The modified gen p mean: 0.45109444856643677, gen p mean: -0.04336543008685112, mean p set: 0.45157474279403687
loss_pred:0.017571421340107918, decouple_loss:0.001054319553077221
loss_pred:0.017469046637415886, decouple_loss:0.001083145383745432
Iteration: 733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013341307640076, gen p mean: -0.044553451240062714, mean p set: 0.45061367750167847
loss_pred:0.017932990565896034, decouple_loss:0.0010216996306553483
The modified gen p mean: 0.4505528211593628, gen p mean: -0.04439856484532356, mean p set: 0.4510330855846405The modified gen p mean: 0.45151031017303467, gen p mean: -0.043243538588285446, mean p set: 0.4519905745983124
loss_pred:0.01783457212150097, decouple_loss:0.0010720685822889209
loss_pred:0.017476117238402367, decouple_loss:0.0010550544830039144
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784584641456604, gen p mean: -0.052050989121198654, mean p set: 0.44832614064216614
loss_pred:0.0145255783572793, decouple_loss:0.0012022398877888918
The modified gen p mean: 0.44812801480293274, gen p mean: -0.053822118788957596, mean p set: 0.44860827922821045The modified gen p mean: 0.44732123613357544, gen p mean: -0.05860386788845062, mean p set: 0.44780153036117554
loss_pred:0.015162430703639984, decouple_loss:0.0011365502141416073
loss_pred:0.015704454854130745, decouple_loss:0.0011868614237755537
Iteration: 735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461926221847534, gen p mean: -0.05644376575946808, mean p set: 0.44667288661003113
loss_pred:0.01444623339921236, decouple_loss:0.0010865327203646302
The modified gen p mean: 0.4464249908924103, gen p mean: -0.050526414066553116, mean p set: 0.4469052851200104The modified gen p mean: 0.4476127028465271, gen p mean: -0.0464916005730629, mean p set: 0.4480930268764496
loss_pred:0.014799078926444054, decouple_loss:0.0011133780935779214
loss_pred:0.015392027795314789, decouple_loss:0.0011045871069654822
Iteration: 736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463234841823578, gen p mean: -0.052288398146629333, mean p set: 0.4468037486076355
loss_pred:0.014903501607477665, decouple_loss:0.0012934611877426505
The modified gen p mean: 0.4462664723396301, gen p mean: -0.04737866669893265, mean p set: 0.4467467665672302The modified gen p mean: 0.44667744636535645, gen p mean: -0.05051591992378235, mean p set: 0.44715774059295654
loss_pred:0.014530043117702007, decouple_loss:0.0013507789699360728
loss_pred:0.014455297030508518, decouple_loss:0.00130474753677845
Iteration: 737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483368694782257, gen p mean: -0.0411602258682251, mean p set: 0.4488171935081482
loss_pred:0.014011251740157604, decouple_loss:0.001237070420756936
The modified gen p mean: 0.44786497950553894, gen p mean: -0.03905472904443741, mean p set: 0.44834527373313904The modified gen p mean: 0.4473423361778259, gen p mean: -0.044637471437454224, mean p set: 0.447822630405426
loss_pred:0.01486285775899887, decouple_loss:0.0013978476636111736
loss_pred:0.013972394168376923, decouple_loss:0.001256391522474587
Iteration: 738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458562433719635, gen p mean: -0.041805729269981384, mean p set: 0.446336567401886
loss_pred:0.013914329931139946, decouple_loss:0.0014231849927455187
The modified gen p mean: 0.4473123550415039, gen p mean: -0.04612452909350395, mean p set: 0.4477926790714264
The modified gen p mean: 0.44772395491600037, gen p mean: -0.033745177090168, mean p set: 0.44820424914360046
loss_pred:0.014179483987390995, decouple_loss:0.0014365901006385684
loss_pred:0.014291797764599323, decouple_loss:0.0015230069402605295
Iteration: 739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476921856403351, gen p mean: -0.03640109673142433, mean p set: 0.44817250967025757
loss_pred:0.014005666598677635, decouple_loss:0.0014082129346206784
The modified gen p mean: 0.4480590224266052, gen p mean: -0.03483901172876358, mean p set: 0.4485393166542053The modified gen p mean: 0.4479922950267792, gen p mean: -0.03651530668139458, mean p set: 0.4484725892543793
loss_pred:0.01380179449915886, decouple_loss:0.0014450766611844301
loss_pred:0.013588743284344673, decouple_loss:0.0014662510948255658
Iteration: 740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466818571090698, gen p mean: -0.03953026235103607, mean p set: 0.4471621811389923
loss_pred:0.014270076528191566, decouple_loss:0.0014960513217374682
The modified gen p mean: 0.44763290882110596, gen p mean: -0.040497247129678726, mean p set: 0.44811320304870605The modified gen p mean: 0.4478653371334076, gen p mean: -0.03912975266575813, mean p set: 0.4483456313610077
loss_pred:0.014322216622531414, decouple_loss:0.0017518678214401007
loss_pred:0.014096713624894619, decouple_loss:0.0015263993991538882
2023-04-30 06:28:52 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.0393085852265358, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.034777186810970306, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0357641875743866, mean p set: 0.4500633478164673
loss_pred:0.01934044621884823, decouple_loss:0.0015729557489976287
loss_pred:0.0183116365224123, decouple_loss:0.0015253211604431272
loss_pred:0.01846785470843315, decouple_loss:0.0015283534303307533
WV_0_PC_1_EH_0_PS_40, loss: 0.018783755600452423, avg_mse: 0.02723076567053795
current test mse: 0.027231
Iteration: 741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460369944572449, gen p mean: -0.0379362478852272, mean p set: 0.44651728868484497
The modified gen p mean: 0.44733601808547974, gen p mean: -0.04093499109148979, mean p set: 0.44781628251075745
The modified gen p mean: 0.44804468750953674, gen p mean: -0.039635077118873596, mean p set: 0.44852498173713684
loss_pred:0.014316102489829063, decouple_loss:0.0014052435290068388
loss_pred:0.013655325397849083, decouple_loss:0.001474111108109355
loss_pred:0.01405361108481884, decouple_loss:0.0014456345234066248
Iteration: 742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468432366847992, gen p mean: -0.042902812361717224, mean p set: 0.4473235309123993
loss_pred:0.014362027868628502, decouple_loss:0.0015060059959068894
The modified gen p mean: 0.44744789600372314, gen p mean: -0.03731337562203407, mean p set: 0.44792816042900085The modified gen p mean: 0.44762372970581055, gen p mean: -0.044462911784648895, mean p set: 0.44810402393341064
loss_pred:0.01388027798384428, decouple_loss:0.0015948807122185826
loss_pred:0.013911823742091656, decouple_loss:0.0014982505235821009
Iteration: 743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44606471061706543, gen p mean: -0.051198560744524, mean p set: 0.4465450048446655
loss_pred:0.014139030128717422, decouple_loss:0.0016035280423238873
The modified gen p mean: 0.44725465774536133, gen p mean: -0.04898771643638611, mean p set: 0.44773492217063904The modified gen p mean: 0.4475368559360504, gen p mean: -0.044341690838336945, mean p set: 0.4480171501636505
loss_pred:0.014133850112557411, decouple_loss:0.0015628121327608824
loss_pred:0.014635837636888027, decouple_loss:0.0016120275249704719
Iteration: 744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481574296951294, gen p mean: -0.05782272666692734, mean p set: 0.4486377537250519
The modified gen p mean: 0.4467615783214569, gen p mean: -0.05785715579986572, mean p set: 0.447241872549057
loss_pred:0.014129065908491611, decouple_loss:0.0015804521972313523
loss_pred:0.01420419942587614, decouple_loss:0.001631144667044282
The modified gen p mean: 0.4473298192024231, gen p mean: -0.055637139827013016, mean p set: 0.4478101134300232
loss_pred:0.014186273328959942, decouple_loss:0.0016290972707793117
Iteration: 745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472847878932953, gen p mean: -0.050430409610271454, mean p set: 0.4477651119232178
loss_pred:0.013825112022459507, decouple_loss:0.001696481485851109
The modified gen p mean: 0.4466300308704376, gen p mean: -0.05781596153974533, mean p set: 0.4471103250980377The modified gen p mean: 0.447773814201355, gen p mean: -0.05948328226804733, mean p set: 0.4482541084289551
loss_pred:0.014476832933723927, decouple_loss:0.0015902481973171234
loss_pred:0.01382806058973074, decouple_loss:0.001612187596037984
Iteration: 746, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727715849876404, gen p mean: -0.05589167773723602, mean p set: 0.44775745272636414
loss_pred:0.013778497464954853, decouple_loss:0.001792603638023138
The modified gen p mean: 0.4486514627933502, gen p mean: -0.05058973655104637, mean p set: 0.4491317868232727The modified gen p mean: 0.4466927945613861, gen p mean: -0.054332200437784195, mean p set: 0.4471730887889862
loss_pred:0.014218890108168125, decouple_loss:0.0018534916453063488
loss_pred:0.013522992841899395, decouple_loss:0.0018557565053924918
Iteration: 747, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751399755477905, gen p mean: -0.04346272721886635, mean p set: 0.44799429178237915
loss_pred:0.013239795342087746, decouple_loss:0.001592774293385446
The modified gen p mean: 0.4466976225376129, gen p mean: -0.04430380463600159, mean p set: 0.447177916765213The modified gen p mean: 0.4480939507484436, gen p mean: -0.047774799168109894, mean p set: 0.4485742151737213
loss_pred:0.01330596674233675, decouple_loss:0.0015801690751686692
loss_pred:0.013467613607645035, decouple_loss:0.0016096309991553426
Iteration: 748, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733962416648865, gen p mean: -0.04562482237815857, mean p set: 0.44781988859176636
loss_pred:0.013840916566550732, decouple_loss:0.0015187151730060577
The modified gen p mean: 0.447194367647171, gen p mean: -0.04156649857759476, mean p set: 0.4476746618747711The modified gen p mean: 0.44811680912971497, gen p mean: -0.04496292397379875, mean p set: 0.4485970735549927
loss_pred:0.013801150023937225, decouple_loss:0.001541491481475532
loss_pred:0.012989647686481476, decouple_loss:0.0015348574379459023
Iteration: 749, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476579427719116, gen p mean: -0.04423096030950546, mean p set: 0.4481382668018341
loss_pred:0.013002660125494003, decouple_loss:0.001745412009768188
The modified gen p mean: 0.44827932119369507, gen p mean: -0.046948544681072235, mean p set: 0.44875964522361755The modified gen p mean: 0.44782304763793945, gen p mean: -0.0485805906355381, mean p set: 0.44830334186553955
loss_pred:0.013229562900960445, decouple_loss:0.0017248530639335513
loss_pred:0.013405943289399147, decouple_loss:0.0016996745252981782
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 750, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455784261226654, gen p mean: -0.03630605712532997, mean p set: 0.4460587203502655
loss_pred:0.01332453265786171, decouple_loss:0.0017339927144348621
The modified gen p mean: 0.44792696833610535, gen p mean: -0.04107147455215454, mean p set: 0.44840726256370544The modified gen p mean: 0.4471665024757385, gen p mean: -0.03424856439232826, mean p set: 0.44764673709869385
loss_pred:0.013410118408501148, decouple_loss:0.0015267707640305161
loss_pred:0.013422831892967224, decouple_loss:0.0016555103939026594
2023-04-30 06:30:46 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04181567206978798, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03714987635612488, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830237865448, gen p mean: -0.037235110998153687, mean p set: 0.4500633478164673
loss_pred:0.01949811354279518, decouple_loss:0.0017071383772417903
loss_pred:0.01849137805402279, decouple_loss:0.0017353425500914454
loss_pred:0.018555358052253723, decouple_loss:0.0017538295360282063
WV_0_PC_1_EH_0_PS_40, loss: 0.018934888765215874, avg_mse: 0.02756638452410698
current test mse: 0.027566
Iteration: 751, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481970965862274, gen p mean: -0.03588484972715378, mean p set: 0.4486773908138275
The modified gen p mean: 0.4470152258872986, gen p mean: -0.04288271442055702, mean p set: 0.4474954903125763
The modified gen p mean: 0.4474705159664154, gen p mean: -0.03632138669490814, mean p set: 0.4479508101940155
loss_pred:0.013626818545162678, decouple_loss:0.001581479562446475
loss_pred:0.0131633086130023, decouple_loss:0.00158176408149302loss_pred:0.013894474133849144, decouple_loss:0.001477933139540255
Iteration: 752, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795340299606323, gen p mean: -0.04251746088266373, mean p set: 0.44843369722366333
loss_pred:0.013195455074310303, decouple_loss:0.0015068865614011884
The modified gen p mean: 0.4483192265033722, gen p mean: -0.03694109246134758, mean p set: 0.4487995207309723
The modified gen p mean: 0.44665244221687317, gen p mean: -0.039782121777534485, mean p set: 0.44713273644447327
loss_pred:0.01312803290784359, decouple_loss:0.0015852360520511866
loss_pred:0.013549596071243286, decouple_loss:0.0015866964822635055
Iteration: 753, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44809916615486145, gen p mean: -0.04257320612668991, mean p set: 0.44857946038246155
loss_pred:0.012916969135403633, decouple_loss:0.0014086866285651922
The modified gen p mean: 0.44784218072891235, gen p mean: -0.03803854063153267, mean p set: 0.44832247495651245The modified gen p mean: 0.4481734037399292, gen p mean: -0.042357541620731354, mean p set: 0.4486536979675293
loss_pred:0.0135738430544734, decouple_loss:0.001471313531510532
loss_pred:0.012830333784222603, decouple_loss:0.0014439304359257221
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
NaN value num: 0
Iteration: 754, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45160356163978577, gen p mean: -0.039943449199199677, mean p set: 0.4520838260650635
loss_pred:0.018922194838523865, decouple_loss:0.0016005951911211014
The modified gen p mean: 0.45160067081451416, gen p mean: -0.036787938326597214, mean p set: 0.45208099484443665The modified gen p mean: 0.4516027867794037, gen p mean: -0.03490665182471275, mean p set: 0.4520830810070038
loss_pred:0.019409289583563805, decouple_loss:0.001633581006899476
loss_pred:0.019354717805981636, decouple_loss:0.0015943789621815085
Iteration: 755, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45154112577438354, gen p mean: -0.0395219549536705, mean p set: 0.45202142000198364
loss_pred:0.019358254969120026, decouple_loss:0.0016740950522944331
The modified gen p mean: 0.45117104053497314, gen p mean: -0.04272598400712013, mean p set: 0.45165136456489563The modified gen p mean: 0.4532906711101532, gen p mean: -0.04026685655117035, mean p set: 0.4537709653377533
loss_pred:0.018501175567507744, decouple_loss:0.001706539886072278
loss_pred:0.018757272511720657, decouple_loss:0.0016815440030768514
Iteration: 756, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45079344511032104, gen p mean: -0.040027834475040436, mean p set: 0.45127376914024353
loss_pred:0.01945415325462818, decouple_loss:0.0015957953874021769
The modified gen p mean: 0.4525368809700012, gen p mean: -0.040228471159935, mean p set: 0.45301714539527893The modified gen p mean: 0.45021459460258484, gen p mean: -0.040867239236831665, mean p set: 0.4506949186325073
loss_pred:0.019120048731565475, decouple_loss:0.0016770719084888697
loss_pred:0.01957732066512108, decouple_loss:0.0016518250340595841
Iteration: 757, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505062401294708, gen p mean: -0.04355712607502937, mean p set: 0.45098650455474854
loss_pred:0.01751992665231228, decouple_loss:0.001662657829001546
The modified gen p mean: 0.4514380693435669, gen p mean: -0.04984273761510849, mean p set: 0.451918363571167The modified gen p mean: 0.45226433873176575, gen p mean: -0.039326611906290054, mean p set: 0.45274466276168823
loss_pred:0.018208814784884453, decouple_loss:0.0017079561948776245
loss_pred:0.018882829695940018, decouple_loss:0.0016702251741662621
Iteration: 758, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450717568397522, gen p mean: -0.03398244455456734, mean p set: 0.45119786262512207
loss_pred:0.018559172749519348, decouple_loss:0.0017343892250210047
The modified gen p mean: 0.4538593888282776, gen p mean: -0.043647367507219315, mean p set: 0.4543396830558777The modified gen p mean: 0.4522475302219391, gen p mean: -0.038324691355228424, mean p set: 0.4527277946472168
loss_pred:0.018369212746620178, decouple_loss:0.0016548560233786702
loss_pred:0.019129768013954163, decouple_loss:0.0016344154719263315
Iteration: 759, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45161208510398865, gen p mean: -0.04202646017074585, mean p set: 0.45209240913391113
loss_pred:0.01793445087969303, decouple_loss:0.0016120848013088107
The modified gen p mean: 0.4506472647190094, gen p mean: -0.035597626119852066, mean p set: 0.4511275291442871The modified gen p mean: 0.45174500346183777, gen p mean: -0.03895748406648636, mean p set: 0.45222529768943787
loss_pred:0.018947022035717964, decouple_loss:0.0016361366724595428
loss_pred:0.018956635147333145, decouple_loss:0.0016566725680604577
Iteration: 760, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45270445942878723, gen p mean: -0.04667307808995247, mean p set: 0.45318475365638733
loss_pred:0.01696454919874668, decouple_loss:0.0015611890703439713
The modified gen p mean: 0.4506503641605377, gen p mean: -0.04526934027671814, mean p set: 0.4511306881904602The modified gen p mean: 0.4532153904438019, gen p mean: -0.04002812132239342, mean p set: 0.453695684671402
loss_pred:0.017607364803552628, decouple_loss:0.001619379734620452
loss_pred:0.017701013013720512, decouple_loss:0.001542126527056098
2023-04-30 06:33:15 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05305911600589752, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.048436488956213, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04876300320029259, mean p set: 0.4500633478164673
loss_pred:0.018820075318217278, decouple_loss:0.0015707842539995909
loss_pred:0.017720451578497887, decouple_loss:0.0016006814548745751
loss_pred:0.017885858193039894, decouple_loss:0.001581304706633091
WV_0_PC_1_EH_0_PS_40, loss: 0.01822134107351303, avg_mse: 0.026203949004411697
current test mse: 0.026204
Iteration: 761, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511440396308899, gen p mean: -0.04834815487265587, mean p set: 0.45162433385849
The modified gen p mean: 0.4514700770378113, gen p mean: -0.04735703393816948, mean p set: 0.45195040106773376
The modified gen p mean: 0.4522683322429657, gen p mean: -0.04590967670083046, mean p set: 0.4527485966682434
loss_pred:0.017501018941402435, decouple_loss:0.0015555638819932938
loss_pred:0.018968839198350906, decouple_loss:0.0015610760310664773
loss_pred:0.01813039369881153, decouple_loss:0.0014507464366033673
Iteration: 762, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45201635360717773, gen p mean: -0.04046599566936493, mean p set: 0.4524966776371002
The modified gen p mean: 0.4513148069381714, gen p mean: -0.04292713850736618, mean p set: 0.4517951011657715loss_pred:0.01882491447031498, decouple_loss:0.0014742277562618256
The modified gen p mean: 0.4513789713382721, gen p mean: -0.042772915214300156, mean p set: 0.4518592655658722
loss_pred:0.018566997721791267, decouple_loss:0.0014842995442450047
loss_pred:0.01899559423327446, decouple_loss:0.0014913592021912336
Iteration: 763, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512425363063812, gen p mean: -0.05427176132798195, mean p set: 0.4517228305339813
The modified gen p mean: 0.4511788487434387, gen p mean: -0.05608148127794266, mean p set: 0.4516591429710388
loss_pred:0.0185951367020607, decouple_loss:0.0014445873675867915
loss_pred:0.017768481746315956, decouple_loss:0.0016290661878883839
The modified gen p mean: 0.452554315328598, gen p mean: -0.05768141150474548, mean p set: 0.4530346095561981
loss_pred:0.01754886284470558, decouple_loss:0.0016047455137595534
Iteration: 764, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510784447193146, gen p mean: -0.05196410045027733, mean p set: 0.4515587389469147
The modified gen p mean: 0.45016083121299744, gen p mean: -0.051225341856479645, mean p set: 0.45064112544059753
The modified gen p mean: 0.45244091749191284, gen p mean: -0.04372689500451088, mean p set: 0.45292118191719055
loss_pred:0.018104178830981255, decouple_loss:0.0013227370800450444
loss_pred:0.01879137195646763, decouple_loss:0.0013839484890922904
loss_pred:0.018686378374695778, decouple_loss:0.001346542383544147
Iteration: 765, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505658447742462, gen p mean: -0.05463610589504242, mean p set: 0.4510461390018463
The modified gen p mean: 0.45226389169692993, gen p mean: -0.054322823882102966, mean p set: 0.45274418592453003loss_pred:0.018843894824385643, decouple_loss:0.001446296228095889
The modified gen p mean: 0.45178964734077454, gen p mean: -0.056776173412799835, mean p set: 0.45226994156837463
loss_pred:0.017004476860165596, decouple_loss:0.0014977286336943507
loss_pred:0.016980400308966637, decouple_loss:0.0014495416544377804
Iteration: 766, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45111456513404846, gen p mean: -0.057724665850400925, mean p set: 0.45159485936164856
loss_pred:0.01696016825735569, decouple_loss:0.001332379993982613
The modified gen p mean: 0.45021769404411316, gen p mean: -0.0592462383210659, mean p set: 0.45069798827171326The modified gen p mean: 0.45112621784210205, gen p mean: -0.05580464005470276, mean p set: 0.45160651206970215
loss_pred:0.016734695062041283, decouple_loss:0.0013472851132974029
loss_pred:0.018518391996622086, decouple_loss:0.0013242982095107436
Iteration: 767, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45327654480934143, gen p mean: -0.0621364489197731, mean p set: 0.4537568688392639
loss_pred:0.017345361411571503, decouple_loss:0.0013191875768825412
The modified gen p mean: 0.45397210121154785, gen p mean: -0.059556376188993454, mean p set: 0.45445236563682556The modified gen p mean: 0.45239225029945374, gen p mean: -0.05893399193882942, mean p set: 0.45287254452705383
loss_pred:0.017978666350245476, decouple_loss:0.0013189956080168486
loss_pred:0.017809472978115082, decouple_loss:0.001324251526966691
Iteration: 768, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511578679084778, gen p mean: -0.05398118123412132, mean p set: 0.4516381621360779
The modified gen p mean: 0.45145928859710693, gen p mean: -0.05782080069184303, mean p set: 0.45193958282470703
loss_pred:0.018249208107590675, decouple_loss:0.0013511681463569403
loss_pred:0.01740068756043911, decouple_loss:0.0014171766815707088
The modified gen p mean: 0.44989460706710815, gen p mean: -0.06172209233045578, mean p set: 0.45037490129470825
loss_pred:0.01825628988444805, decouple_loss:0.0013883813517168164
Iteration: 769, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534396529197693, gen p mean: -0.06012127548456192, mean p set: 0.4539199471473694
The modified gen p mean: 0.4507308900356293, gen p mean: -0.05048922449350357, mean p set: 0.45121118426322937
The modified gen p mean: 0.45206692814826965, gen p mean: -0.058204781264066696, mean p set: 0.45254722237586975
loss_pred:0.01700708270072937, decouple_loss:0.0012067161733284593
loss_pred:0.018267523497343063, decouple_loss:0.0013774295803159475
loss_pred:0.01717304065823555, decouple_loss:0.0012374002253636718
Iteration: 770, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45204421877861023, gen p mean: -0.057873424142599106, mean p set: 0.4525245428085327
The modified gen p mean: 0.45070749521255493, gen p mean: -0.060435809195041656, mean p set: 0.45118778944015503
loss_pred:0.016948025673627853, decouple_loss:0.0012845851015299559
loss_pred:0.017739305272698402, decouple_loss:0.001250149216502905
The modified gen p mean: 0.4506746828556061, gen p mean: -0.05451010540127754, mean p set: 0.4511549472808838
loss_pred:0.01837511546909809, decouple_loss:0.0012626529205590487
2023-04-30 06:35:08 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.06083594262599945, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05661853030323982, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0569855272769928, mean p set: 0.4500633478164673
loss_pred:0.018665069714188576, decouple_loss:0.0013551826123148203
loss_pred:0.01752852089703083, decouple_loss:0.0013929808046668768
loss_pred:0.01769336499273777, decouple_loss:0.0014118333347141743
WV_0_PC_1_EH_0_PS_40, loss: 0.01803165301680565, avg_mse: 0.02588953636586666
current test mse: 0.02589
Iteration: 771, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512234926223755, gen p mean: -0.05629545450210571, mean p set: 0.4517037868499756
The modified gen p mean: 0.45178738236427307, gen p mean: -0.05426373705267906, mean p set: 0.45226770639419556
loss_pred:0.018404901027679443, decouple_loss:0.0011921266559511423
The modified gen p mean: 0.45156583189964294, gen p mean: -0.055771354585886, mean p set: 0.45204612612724304
loss_pred:0.017250411212444305, decouple_loss:0.0012291445164009929
loss_pred:0.01724926382303238, decouple_loss:0.0012001044815406203
Iteration: 772, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514194428920746, gen p mean: -0.047392331063747406, mean p set: 0.4518997073173523
The modified gen p mean: 0.45175787806510925, gen p mean: -0.05389292910695076, mean p set: 0.45223820209503174
loss_pred:0.01872306503355503, decouple_loss:0.0012105908244848251
loss_pred:0.017874231562018394, decouple_loss:0.0010882701026275754
The modified gen p mean: 0.4514394700527191, gen p mean: -0.04805466905236244, mean p set: 0.4519197940826416
loss_pred:0.01786300353705883, decouple_loss:0.0011992842191830277
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
NaN value num: 0
Iteration: 773, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488820433616638, gen p mean: -0.051484689116477966, mean p set: 0.4493623375892639
loss_pred:0.01867334172129631, decouple_loss:0.0013796656858175993
The modified gen p mean: 0.4487350285053253, gen p mean: -0.05631896108388901, mean p set: 0.4492153227329254The modified gen p mean: 0.4484826624393463, gen p mean: -0.052679721266031265, mean p set: 0.448962926864624
loss_pred:0.019448453560471535, decouple_loss:0.0014716138830408454
loss_pred:0.019626552239060402, decouple_loss:0.0014671806711703539
Iteration: 774, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44718053936958313, gen p mean: -0.04898952320218086, mean p set: 0.4476608335971832
The modified gen p mean: 0.4474298357963562, gen p mean: -0.05719989910721779, mean p set: 0.4479101598262787
The modified gen p mean: 0.4475539028644562, gen p mean: -0.05100175365805626, mean p set: 0.4480341970920563loss_pred:0.01751651056110859, decouple_loss:0.001240038312971592
loss_pred:0.019687728956341743, decouple_loss:0.0011970542836934328
loss_pred:0.020202327519655228, decouple_loss:0.0012233625166118145
Iteration: 775, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723373651504517, gen p mean: -0.05121682211756706, mean p set: 0.44771403074264526
The modified gen p mean: 0.44745978713035583, gen p mean: -0.05225708335638046, mean p set: 0.4479401111602783
loss_pred:0.01889711804687977, decouple_loss:0.0013365894556045532
The modified gen p mean: 0.44613581895828247, gen p mean: -0.05460658296942711, mean p set: 0.44661614298820496
loss_pred:0.019626662135124207, decouple_loss:0.0014148526825010777
loss_pred:0.019827982410788536, decouple_loss:0.0013239388354122639
Iteration: 776, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465455710887909, gen p mean: -0.055267661809921265, mean p set: 0.447025865316391
loss_pred:0.017607681453227997, decouple_loss:0.0012018936686217785
The modified gen p mean: 0.44743454456329346, gen p mean: -0.05493288114666939, mean p set: 0.44791483879089355The modified gen p mean: 0.4470826983451843, gen p mean: -0.053371574729681015, mean p set: 0.4475629925727844
loss_pred:0.019789956510066986, decouple_loss:0.0012169828405603766
loss_pred:0.018363390117883682, decouple_loss:0.0012197867035865784
Iteration: 777, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44814085960388184, gen p mean: -0.05541357025504112, mean p set: 0.44862115383148193
The modified gen p mean: 0.4483150541782379, gen p mean: -0.05332915484905243, mean p set: 0.448795348405838
loss_pred:0.01871146820485592, decouple_loss:0.001265985076315701
loss_pred:0.01845569908618927, decouple_loss:0.0011270031100139022
The modified gen p mean: 0.44829297065734863, gen p mean: -0.051885753870010376, mean p set: 0.44877323508262634
loss_pred:0.018726248294115067, decouple_loss:0.001163220964372158
Iteration: 778, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470619559288025, gen p mean: -0.059061575680971146, mean p set: 0.4475422501564026
loss_pred:0.018940486013889313, decouple_loss:0.001305874902755022
The modified gen p mean: 0.44806668162345886, gen p mean: -0.05798391252756119, mean p set: 0.44854697585105896The modified gen p mean: 0.447444349527359, gen p mean: -0.05963294208049774, mean p set: 0.4479246735572815
loss_pred:0.01916687563061714, decouple_loss:0.0011658015428110957
loss_pred:0.01937398500740528, decouple_loss:0.001121763838455081
Iteration: 779, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815242290496826, gen p mean: -0.06201557815074921, mean p set: 0.44863274693489075
loss_pred:0.01851806789636612, decouple_loss:0.0011394451139494777
The modified gen p mean: 0.4470864534378052, gen p mean: -0.06176934018731117, mean p set: 0.44756677746772766The modified gen p mean: 0.4473735988140106, gen p mean: -0.0651024654507637, mean p set: 0.4478538930416107
loss_pred:0.018858246505260468, decouple_loss:0.0012384523870423436
loss_pred:0.018111512064933777, decouple_loss:0.0011291379341855645
Iteration: 780, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476057291030884, gen p mean: -0.06459902226924896, mean p set: 0.44808605313301086
loss_pred:0.01921188272535801, decouple_loss:0.0011286743683740497
The modified gen p mean: 0.4468608498573303, gen p mean: -0.06333566457033157, mean p set: 0.4473411440849304The modified gen p mean: 0.44564110040664673, gen p mean: -0.06551288068294525, mean p set: 0.44612136483192444
loss_pred:0.018530355766415596, decouple_loss:0.0011877039214596152
loss_pred:0.019369633868336678, decouple_loss:0.0011746855452656746
2023-04-30 06:37:39 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.06529437750577927, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.06045759469270706, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.061107393354177475, mean p set: 0.4500633478164673
loss_pred:0.01855495013296604, decouple_loss:0.0012049780925735831
loss_pred:0.01750854030251503, decouple_loss:0.001133291982114315
loss_pred:0.017592808231711388, decouple_loss:0.0011093647917732596
WV_0_PC_1_EH_0_PS_40, loss: 0.017942894250154495, avg_mse: 0.02575649507343769
current test mse: 0.025756
Iteration: 781, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44809791445732117, gen p mean: -0.06030862033367157, mean p set: 0.44857820868492126
The modified gen p mean: 0.44758620858192444, gen p mean: -0.05986237898468971, mean p set: 0.4480665326118469
The modified gen p mean: 0.44669753313064575, gen p mean: -0.06310141831636429, mean p set: 0.44717782735824585
loss_pred:0.017711427062749863, decouple_loss:0.001024383120238781
loss_pred:0.01863849349319935, decouple_loss:0.0010741320438683033
loss_pred:0.018079575151205063, decouple_loss:0.001012771506793797
Iteration: 782, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446166068315506, gen p mean: -0.05972595140337944, mean p set: 0.4466463625431061
loss_pred:0.019258996471762657, decouple_loss:0.0010904001537710428
The modified gen p mean: 0.4469808340072632, gen p mean: -0.0564347468316555, mean p set: 0.4474611282348633The modified gen p mean: 0.44587668776512146, gen p mean: -0.060842353850603104, mean p set: 0.44635701179504395
loss_pred:0.0189035814255476, decouple_loss:0.0011359729105606675
loss_pred:0.01775261200964451, decouple_loss:0.0011478712549433112
Iteration: 783, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470779299736023, gen p mean: -0.05936769023537636, mean p set: 0.4475582540035248
loss_pred:0.0194267425686121, decouple_loss:0.001199130667373538
The modified gen p mean: 0.44696420431137085, gen p mean: -0.057485323399305344, mean p set: 0.44744452834129333The modified gen p mean: 0.44831228256225586, gen p mean: -0.05131958797574043, mean p set: 0.44879260659217834
loss_pred:0.01896003633737564, decouple_loss:0.0011834148317575455
loss_pred:0.018646758049726486, decouple_loss:0.0011014111805707216
Iteration: 784, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474761188030243, gen p mean: -0.05306026712059975, mean p set: 0.4479564428329468
loss_pred:0.01890483871102333, decouple_loss:0.0011267423396930099
The modified gen p mean: 0.4466773569583893, gen p mean: -0.05629324913024902, mean p set: 0.4471576511859894The modified gen p mean: 0.4476653039455414, gen p mean: -0.05608874559402466, mean p set: 0.4481455683708191
loss_pred:0.01867300644516945, decouple_loss:0.0011511585908010602
loss_pred:0.01908097043633461, decouple_loss:0.0012474760878831148
Iteration: 785, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447206974029541, gen p mean: -0.05409413203597069, mean p set: 0.4476872384548187
loss_pred:0.018423937261104584, decouple_loss:0.001132095931097865
The modified gen p mean: 0.44838374853134155, gen p mean: -0.04798927903175354, mean p set: 0.44886404275894165The modified gen p mean: 0.44649913907051086, gen p mean: -0.05802695080637932, mean p set: 0.44697946310043335
loss_pred:0.018999215215444565, decouple_loss:0.001047034515067935
loss_pred:0.018864598125219345, decouple_loss:0.0010881191119551659
Iteration: 786, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478066861629486, gen p mean: -0.05011996254324913, mean p set: 0.4482869803905487
loss_pred:0.018485305830836296, decouple_loss:0.0010695437667891383
The modified gen p mean: 0.44833511114120483, gen p mean: -0.05247322469949722, mean p set: 0.44881540536880493The modified gen p mean: 0.44908756017684937, gen p mean: -0.049748219549655914, mean p set: 0.44956785440444946
loss_pred:0.018493494018912315, decouple_loss:0.0010627179872244596
loss_pred:0.018677277490496635, decouple_loss:0.0010381035972386599
Iteration: 787, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464946985244751, gen p mean: -0.04984825477004051, mean p set: 0.4469749927520752
loss_pred:0.01914226822555065, decouple_loss:0.0012081061722710729
The modified gen p mean: 0.44929271936416626, gen p mean: -0.050519317388534546, mean p set: 0.44977301359176636The modified gen p mean: 0.4455741345882416, gen p mean: -0.05234169214963913, mean p set: 0.4460543990135193
loss_pred:0.018904924392700195, decouple_loss:0.0012155523290857673
loss_pred:0.018443820998072624, decouple_loss:0.0011296242009848356
Iteration: 788, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44712480902671814, gen p mean: -0.05404689908027649, mean p set: 0.44760507345199585
loss_pred:0.017229726538062096, decouple_loss:0.001045254641212523
The modified gen p mean: 0.448380708694458, gen p mean: -0.05753479525446892, mean p set: 0.4488610029220581The modified gen p mean: 0.4473145008087158, gen p mean: -0.04952669516205788, mean p set: 0.44779476523399353
loss_pred:0.019447267055511475, decouple_loss:0.0011022522812709212
loss_pred:0.017078395932912827, decouple_loss:0.0010405601933598518
Iteration: 789, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474543035030365, gen p mean: -0.05459143966436386, mean p set: 0.4479345977306366
loss_pred:0.01844579540193081, decouple_loss:0.001127429073676467
The modified gen p mean: 0.4472741186618805, gen p mean: -0.0576891228556633, mean p set: 0.4477544128894806The modified gen p mean: 0.44716793298721313, gen p mean: -0.054893817752599716, mean p set: 0.44764822721481323
loss_pred:0.018180428072810173, decouple_loss:0.0011979455593973398
loss_pred:0.018709121271967888, decouple_loss:0.0011597268749028444
Iteration: 790, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461888074874878, gen p mean: -0.05860719084739685, mean p set: 0.4466691315174103
loss_pred:0.018769528716802597, decouple_loss:0.0012197125470265746
The modified gen p mean: 0.4465150833129883, gen p mean: -0.05607324466109276, mean p set: 0.4469953775405884The modified gen p mean: 0.4472392201423645, gen p mean: -0.05876777693629265, mean p set: 0.4477194845676422
loss_pred:0.019129976630210876, decouple_loss:0.001198764075525105
loss_pred:0.017764659598469734, decouple_loss:0.0012021278962492943
2023-04-30 06:39:32 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05896501988172531, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05465136095881462, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.055303383618593216, mean p set: 0.4500633478164673
loss_pred:0.018481597304344177, decouple_loss:0.0010707376059144735
loss_pred:0.01745687611401081, decouple_loss:0.0010727881453931332
loss_pred:0.017578303813934326, decouple_loss:0.0010810253443196416
WV_0_PC_1_EH_0_PS_40, loss: 0.01789266988635063, avg_mse: 0.025698993355035782
current test mse: 0.025699
Iteration: 791, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818711280822754, gen p mean: -0.055694229900836945, mean p set: 0.44866740703582764
The modified gen p mean: 0.44771137833595276, gen p mean: -0.05589427798986435, mean p set: 0.44819167256355286
The modified gen p mean: 0.4467078745365143, gen p mean: -0.05901540443301201, mean p set: 0.4471881687641144
loss_pred:0.01868499256670475, decouple_loss:0.0010442319326102734
loss_pred:0.018124790862202644, decouple_loss:0.0010907732648774981
loss_pred:0.01893831603229046, decouple_loss:0.0010776612907648087
Iteration: 792, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470103681087494, gen p mean: -0.05544868856668472, mean p set: 0.4474906623363495
loss_pred:0.017045030370354652, decouple_loss:0.0013492105063050985
The modified gen p mean: 0.4475901424884796, gen p mean: -0.05990121513605118, mean p set: 0.4480704367160797The modified gen p mean: 0.44675466418266296, gen p mean: -0.06006172299385071, mean p set: 0.4472349286079407
loss_pred:0.01870126649737358, decouple_loss:0.001361409667879343
loss_pred:0.017970053479075432, decouple_loss:0.001347673824056983
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 793, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474121034145355, gen p mean: -0.053894441574811935, mean p set: 0.447892427444458
loss_pred:0.015811864286661148, decouple_loss:0.001050713355652988
The modified gen p mean: 0.44781047105789185, gen p mean: -0.05675825849175453, mean p set: 0.44829073548316956The modified gen p mean: 0.44800907373428345, gen p mean: -0.05448654294013977, mean p set: 0.44848933815956116
loss_pred:0.015011440962553024, decouple_loss:0.001067370641976595
loss_pred:0.01572371833026409, decouple_loss:0.0010778589639812708
Iteration: 794, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810551404953003, gen p mean: -0.05203905329108238, mean p set: 0.44858577847480774
loss_pred:0.015039756894111633, decouple_loss:0.0012695117620751262
The modified gen p mean: 0.44816282391548157, gen p mean: -0.05185942351818085, mean p set: 0.44864311814308167The modified gen p mean: 0.44733431935310364, gen p mean: -0.049564581364393234, mean p set: 0.44781461358070374
loss_pred:0.014752709306776524, decouple_loss:0.0013761176960542798
loss_pred:0.0156861525028944, decouple_loss:0.0013426798395812511
Iteration: 795, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44872283935546875, gen p mean: -0.04787657409906387, mean p set: 0.44920313358306885
The modified gen p mean: 0.4474535882472992, gen p mean: -0.049756571650505066, mean p set: 0.4479339122772217
loss_pred:0.014471923001110554, decouple_loss:0.0013022733619436622
loss_pred:0.014868101105093956, decouple_loss:0.0012429747730493546
The modified gen p mean: 0.4484468400478363, gen p mean: -0.04334740713238716, mean p set: 0.4489271342754364
loss_pred:0.014560599811375141, decouple_loss:0.0012857707915827632
Iteration: 796, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44824519753456116, gen p mean: -0.03680141642689705, mean p set: 0.44872552156448364
The modified gen p mean: 0.44791844487190247, gen p mean: -0.039024122059345245, mean p set: 0.44839873909950256
loss_pred:0.015012528747320175, decouple_loss:0.001223572064191103
loss_pred:0.015171576291322708, decouple_loss:0.0011922746198251843
The modified gen p mean: 0.4461670517921448, gen p mean: -0.04294750839471817, mean p set: 0.44664737582206726
loss_pred:0.014609081670641899, decouple_loss:0.0012561092153191566
Iteration: 797, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783008098602295, gen p mean: -0.03327387943863869, mean p set: 0.44831034541130066
The modified gen p mean: 0.4476214051246643, gen p mean: -0.03625272586941719, mean p set: 0.4481017291545868
loss_pred:0.014672208577394485, decouple_loss:0.001234766561537981
loss_pred:0.014062745496630669, decouple_loss:0.0012855823151767254
The modified gen p mean: 0.4482780992984772, gen p mean: -0.033635541796684265, mean p set: 0.4487583637237549
loss_pred:0.014555058442056179, decouple_loss:0.0012334336061030626
Iteration: 798, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44809165596961975, gen p mean: -0.03297252207994461, mean p set: 0.44857192039489746The modified gen p mean: 0.4479132294654846, gen p mean: -0.035533029586076736, mean p set: 0.4483935534954071
The modified gen p mean: 0.4470321238040924, gen p mean: -0.03724817559123039, mean p set: 0.4475124180316925
loss_pred:0.013594217598438263, decouple_loss:0.001291822292841971loss_pred:0.01435621827840805, decouple_loss:0.001222218619659543
loss_pred:0.014346304349601269, decouple_loss:0.0012513237306848168
Iteration: 799, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477509558200836, gen p mean: -0.03266605734825134, mean p set: 0.44823122024536133The modified gen p mean: 0.4472324848175049, gen p mean: -0.04084150493144989, mean p set: 0.447712779045105
The modified gen p mean: 0.4478384852409363, gen p mean: -0.03764645382761955, mean p set: 0.44831880927085876
loss_pred:0.014206834137439728, decouple_loss:0.001322085503488779loss_pred:0.014117673970758915, decouple_loss:0.0013736528344452381
loss_pred:0.014031951315701008, decouple_loss:0.0013097921619191766
Iteration: 800, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482143223285675, gen p mean: -0.037214040756225586, mean p set: 0.44869464635849
The modified gen p mean: 0.4478556215763092, gen p mean: -0.034846533089876175, mean p set: 0.4483359158039093
loss_pred:0.013793069869279861, decouple_loss:0.0013952790759503841
loss_pred:0.013769255951046944, decouple_loss:0.0014234590344130993
The modified gen p mean: 0.44795534014701843, gen p mean: -0.03959060460329056, mean p set: 0.4484356641769409
loss_pred:0.014375990256667137, decouple_loss:0.0014128235634416342
2023-04-30 06:42:06 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04108982905745506, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.038232263177633286, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.03701205551624298, mean p set: 0.4500633478164673
loss_pred:0.019408879801630974, decouple_loss:0.0014121087733656168
loss_pred:0.018270738422870636, decouple_loss:0.0014917668886482716
loss_pred:0.01841682568192482, decouple_loss:0.001419946551322937
WV_0_PC_1_EH_0_PS_40, loss: 0.01877087727189064, avg_mse: 0.02729983814060688
current test mse: 0.0273
Iteration: 801, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822442531585693, gen p mean: -0.036856070160865784, mean p set: 0.44870471954345703
The modified gen p mean: 0.44637301564216614, gen p mean: -0.04367658123373985, mean p set: 0.44685330986976624
The modified gen p mean: 0.44797733426094055, gen p mean: -0.03754442557692528, mean p set: 0.44845762848854065
loss_pred:0.013425277546048164, decouple_loss:0.0014305239310488105
loss_pred:0.013766749761998653, decouple_loss:0.001473073847591877
loss_pred:0.013856952078640461, decouple_loss:0.0013682943535968661
Iteration: 802, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477875530719757, gen p mean: -0.04216955229640007, mean p set: 0.4482678174972534
loss_pred:0.013452027924358845, decouple_loss:0.0013725360622629523
The modified gen p mean: 0.447857141494751, gen p mean: -0.04211057722568512, mean p set: 0.4483374059200287The modified gen p mean: 0.4474637806415558, gen p mean: -0.03878716751933098, mean p set: 0.4479440450668335
loss_pred:0.01373561192303896, decouple_loss:0.0013243486173450947
loss_pred:0.013246514834463596, decouple_loss:0.0014281568583101034
Iteration: 803, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44700318574905396, gen p mean: -0.04673127830028534, mean p set: 0.44748347997665405
The modified gen p mean: 0.44890785217285156, gen p mean: -0.04000008851289749, mean p set: 0.44938814640045166loss_pred:0.01360947173088789, decouple_loss:0.001457794802263379
The modified gen p mean: 0.4482062757015228, gen p mean: -0.04292970523238182, mean p set: 0.4486865699291229
loss_pred:0.014032932929694653, decouple_loss:0.00144871324300766
loss_pred:0.013409089297056198, decouple_loss:0.0014380295760929585
Iteration: 804, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480210542678833, gen p mean: -0.04300691559910774, mean p set: 0.4485013484954834The modified gen p mean: 0.4478549063205719, gen p mean: -0.044993806630373, mean p set: 0.448335200548172
loss_pred:0.013517551124095917, decouple_loss:0.001671328442171216
loss_pred:0.013073448091745377, decouple_loss:0.0014638453722000122
The modified gen p mean: 0.44832268357276917, gen p mean: -0.04482044279575348, mean p set: 0.4488029479980469
loss_pred:0.01323589589446783, decouple_loss:0.0015133708948269486
Iteration: 805, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471515715122223, gen p mean: -0.04144088178873062, mean p set: 0.4476318955421448
loss_pred:0.013806440867483616, decouple_loss:0.0014395606704056263
The modified gen p mean: 0.44811657071113586, gen p mean: -0.04745566472411156, mean p set: 0.4485968351364136The modified gen p mean: 0.4473591446876526, gen p mean: -0.04754069447517395, mean p set: 0.4478394687175751
loss_pred:0.01303049549460411, decouple_loss:0.001361785689368844
loss_pred:0.013395286165177822, decouple_loss:0.0014373494777828455
Iteration: 806, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480619728565216, gen p mean: -0.04168613627552986, mean p set: 0.4485422670841217
loss_pred:0.01326596550643444, decouple_loss:0.0014812240842729807
The modified gen p mean: 0.44692251086235046, gen p mean: -0.04743116721510887, mean p set: 0.44740280508995056The modified gen p mean: 0.4473022222518921, gen p mean: -0.04901912063360214, mean p set: 0.4477825164794922
loss_pred:0.01351909339427948, decouple_loss:0.0014563592849299312
loss_pred:0.013603192754089832, decouple_loss:0.0014580530114471912
Iteration: 807, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802403450012207, gen p mean: -0.0453496128320694, mean p set: 0.44850432872772217
loss_pred:0.01284879818558693, decouple_loss:0.0014572999207302928
The modified gen p mean: 0.44762372970581055, gen p mean: -0.04356691986322403, mean p set: 0.44810402393341064The modified gen p mean: 0.4487875998020172, gen p mean: -0.04612673074007034, mean p set: 0.4492678940296173
loss_pred:0.012864651158452034, decouple_loss:0.0015003385487943888
loss_pred:0.012865801341831684, decouple_loss:0.0014362017391249537
Iteration: 808, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479690492153168, gen p mean: -0.03978366404771805, mean p set: 0.4484493136405945
loss_pred:0.013030619360506535, decouple_loss:0.0013781235320493579
The modified gen p mean: 0.44853079319000244, gen p mean: -0.04082610458135605, mean p set: 0.4490111172199249The modified gen p mean: 0.44830814003944397, gen p mean: -0.04348263144493103, mean p set: 0.44878846406936646
loss_pred:0.01286433544009924, decouple_loss:0.0013994913315400481
loss_pred:0.013092280365526676, decouple_loss:0.0014219445874914527
Iteration: 809, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752660393714905, gen p mean: -0.03956889361143112, mean p set: 0.44800689816474915
loss_pred:0.013301200233399868, decouple_loss:0.0013845480279996991
The modified gen p mean: 0.44879159331321716, gen p mean: -0.0422571524977684, mean p set: 0.44927188754081726
The modified gen p mean: 0.44888073205947876, gen p mean: -0.04391361027956009, mean p set: 0.44936102628707886
loss_pred:0.0129428431391716, decouple_loss:0.0014018617803230882
loss_pred:0.012775853276252747, decouple_loss:0.0014103138819336891
Iteration: 810, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44676509499549866, gen p mean: -0.03828142583370209, mean p set: 0.44724538922309875
loss_pred:0.013995496556162834, decouple_loss:0.001265993225388229
The modified gen p mean: 0.4481227993965149, gen p mean: -0.03891924396157265, mean p set: 0.448603093624115The modified gen p mean: 0.44781357049942017, gen p mean: -0.041459523141384125, mean p set: 0.4482938349246979
loss_pred:0.013125205412507057, decouple_loss:0.001340913469903171
loss_pred:0.013194803148508072, decouple_loss:0.00131579814478755
2023-04-30 06:44:00 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.03814064338803291, mean p set: 0.4502691626548767
The modified gen p mean: 0.4498766362667084, gen p mean: -0.03401347994804382, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830237865448, gen p mean: -0.03420593962073326, mean p set: 0.4500633478164673
loss_pred:0.019372569397091866, decouple_loss:0.0013949242420494556
loss_pred:0.01823691837489605, decouple_loss:0.0014262620825320482
loss_pred:0.018351834267377853, decouple_loss:0.0014321199851110578
WV_0_PC_1_EH_0_PS_40, loss: 0.01872466318309307, avg_mse: 0.027317631989717484
current test mse: 0.027318
Iteration: 811, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478228688240051, gen p mean: -0.03323236480355263, mean p set: 0.4483031630516052
The modified gen p mean: 0.44863346219062805, gen p mean: -0.03768102452158928, mean p set: 0.44911372661590576
The modified gen p mean: 0.44657102227211, gen p mean: -0.04006730765104294, mean p set: 0.4470512866973877
loss_pred:0.013168426230549812, decouple_loss:0.001360149122774601
loss_pred:0.013483169488608837, decouple_loss:0.0013178105000406504
loss_pred:0.013111384585499763, decouple_loss:0.001392864272929728
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 812, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474068880081177, gen p mean: -0.03163808211684227, mean p set: 0.4478871822357178
loss_pred:0.013790372759103775, decouple_loss:0.0012646547984331846
The modified gen p mean: 0.44816482067108154, gen p mean: -0.03296931833028793, mean p set: 0.44864511489868164The modified gen p mean: 0.44823944568634033, gen p mean: -0.03617086634039879, mean p set: 0.44871973991394043
loss_pred:0.013041667640209198, decouple_loss:0.0012758108787238598
loss_pred:0.013279908336699009, decouple_loss:0.0012796270893886685
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
NaN value num: 0
Iteration: 813, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511503577232361, gen p mean: -0.02583041787147522, mean p set: 0.45163068175315857
loss_pred:0.01889561116695404, decouple_loss:0.0015907702036201954
The modified gen p mean: 0.45063990354537964, gen p mean: -0.03230686113238335, mean p set: 0.4511202275753021The modified gen p mean: 0.4512149691581726, gen p mean: -0.02578720822930336, mean p set: 0.4516952931880951
loss_pred:0.018406536430120468, decouple_loss:0.0016333243111148477
loss_pred:0.01883024536073208, decouple_loss:0.0014190194196999073
Iteration: 814, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45130670070648193, gen p mean: -0.02438977174460888, mean p set: 0.45178699493408203
The modified gen p mean: 0.4496927261352539, gen p mean: -0.027928972616791725, mean p set: 0.450173020362854
loss_pred:0.019376304000616074, decouple_loss:0.0014487634180113673
loss_pred:0.01865060068666935, decouple_loss:0.0015217120526358485
The modified gen p mean: 0.4505957067012787, gen p mean: -0.03300128132104874, mean p set: 0.4510760009288788
loss_pred:0.018641462549567223, decouple_loss:0.0013443989446386695
Iteration: 815, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45004430413246155, gen p mean: -0.02597246691584587, mean p set: 0.45052459836006165
loss_pred:0.01843779906630516, decouple_loss:0.0014139016857370734
The modified gen p mean: 0.45078355073928833, gen p mean: -0.025963587686419487, mean p set: 0.4512638449668884The modified gen p mean: 0.4523179829120636, gen p mean: -0.0255220215767622, mean p set: 0.4527982771396637
loss_pred:0.018310660496354103, decouple_loss:0.0014629404759034514
loss_pred:0.01933339051902294, decouple_loss:0.00142934441100806
Iteration: 816, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45038220286369324, gen p mean: -0.025242730975151062, mean p set: 0.45086249709129333
loss_pred:0.01781417243182659, decouple_loss:0.0016049878904595971
The modified gen p mean: 0.45269036293029785, gen p mean: -0.02397625893354416, mean p set: 0.45317062735557556
The modified gen p mean: 0.44943222403526306, gen p mean: -0.026691647246479988, mean p set: 0.44991254806518555
loss_pred:0.018963631242513657, decouple_loss:0.001535880728624761
loss_pred:0.018392229452729225, decouple_loss:0.001448694383725524
Iteration: 817, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494194984436035, gen p mean: -0.029211413115262985, mean p set: 0.449899822473526
loss_pred:0.01812692917883396, decouple_loss:0.00124373659491539
The modified gen p mean: 0.4497205913066864, gen p mean: -0.028939060866832733, mean p set: 0.4502009153366089The modified gen p mean: 0.45096656680107117, gen p mean: -0.027553295716643333, mean p set: 0.45144689083099365
loss_pred:0.018650460988283157, decouple_loss:0.0013220893451943994
loss_pred:0.01893731579184532, decouple_loss:0.0013470309786498547
Iteration: 818, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509578347206116, gen p mean: -0.026596907526254654, mean p set: 0.45143812894821167
The modified gen p mean: 0.4503265619277954, gen p mean: -0.032226331532001495, mean p set: 0.4508068561553955
loss_pred:0.018745800480246544, decouple_loss:0.0013300048885867
loss_pred:0.01873651146888733, decouple_loss:0.0013356056297197938The modified gen p mean: 0.4517497420310974, gen p mean: -0.027326980605721474, mean p set: 0.4522300362586975
loss_pred:0.019514478743076324, decouple_loss:0.001348019577562809
Iteration: 819, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508208632469177, gen p mean: -0.02767549268901348, mean p set: 0.45130112767219543
The modified gen p mean: 0.44944486021995544, gen p mean: -0.031099896878004074, mean p set: 0.44992515444755554
loss_pred:0.018433334305882454, decouple_loss:0.0014334149891510606
loss_pred:0.01864471845328808, decouple_loss:0.001258505624718964
The modified gen p mean: 0.4519239068031311, gen p mean: -0.03075222671031952, mean p set: 0.4524042010307312
loss_pred:0.017298683524131775, decouple_loss:0.0013836530270054936
Iteration: 820, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44982588291168213, gen p mean: -0.04142611101269722, mean p set: 0.45030614733695984
loss_pred:0.018354853615164757, decouple_loss:0.0012296629138290882
The modified gen p mean: 0.4507615268230438, gen p mean: -0.03201042115688324, mean p set: 0.4512418508529663
The modified gen p mean: 0.4518752694129944, gen p mean: -0.0353081189095974, mean p set: 0.4523555636405945
loss_pred:0.01803899183869362, decouple_loss:0.0012323103146627545
loss_pred:0.017373738810420036, decouple_loss:0.0012132215779274702
2023-04-30 06:46:37 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.048954032361507416, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04427146911621094, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.045001108199357986, mean p set: 0.4500633478164673
loss_pred:0.018624858930706978, decouple_loss:0.0013549128780141473
loss_pred:0.017524410039186478, decouple_loss:0.0013544661924242973
loss_pred:0.017663445323705673, decouple_loss:0.0012926720082759857
WV_0_PC_1_EH_0_PS_40, loss: 0.018004272133111954, avg_mse: 0.02587500773370266
current test mse: 0.025875
Iteration: 821, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45255059003829956, gen p mean: -0.040586795657873154, mean p set: 0.45303085446357727
The modified gen p mean: 0.45012736320495605, gen p mean: -0.044434815645217896, mean p set: 0.45060768723487854
The modified gen p mean: 0.45141705870628357, gen p mean: -0.03887428715825081, mean p set: 0.45189735293388367
loss_pred:0.019283441826701164, decouple_loss:0.0011890189489349723
loss_pred:0.018135996535420418, decouple_loss:0.0011871916940435767loss_pred:0.018463443964719772, decouple_loss:0.001126925810240209
Iteration: 822, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514906108379364, gen p mean: -0.04190865904092789, mean p set: 0.4519709050655365
loss_pred:0.018300654366612434, decouple_loss:0.001186356064863503
The modified gen p mean: 0.4514372944831848, gen p mean: -0.04247477278113365, mean p set: 0.4519175887107849The modified gen p mean: 0.44965270161628723, gen p mean: -0.04361758381128311, mean p set: 0.45013299584388733
loss_pred:0.018312109634280205, decouple_loss:0.0011593140661716461
loss_pred:0.01792691834270954, decouple_loss:0.0011841381201520562
Iteration: 823, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512809216976166, gen p mean: -0.04462981969118118, mean p set: 0.4517611861228943
The modified gen p mean: 0.45083531737327576, gen p mean: -0.04351567104458809, mean p set: 0.45131561160087585
loss_pred:0.018250303342938423, decouple_loss:0.001189181231893599
loss_pred:0.01786532811820507, decouple_loss:0.0012244811514392495
The modified gen p mean: 0.4503616392612457, gen p mean: -0.05442678555846214, mean p set: 0.4508419334888458
loss_pred:0.018231866881251335, decouple_loss:0.0012599858455359936
Iteration: 824, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45183250308036804, gen p mean: -0.05083988234400749, mean p set: 0.45231279730796814
loss_pred:0.01908227801322937, decouple_loss:0.001240001292899251
The modified gen p mean: 0.45209643244743347, gen p mean: -0.04618914797902107, mean p set: 0.45257672667503357The modified gen p mean: 0.45006638765335083, gen p mean: -0.05436025187373161, mean p set: 0.4505466818809509
loss_pred:0.01853436417877674, decouple_loss:0.0012282063253223896
loss_pred:0.017466947436332703, decouple_loss:0.0011638684663921595
Iteration: 825, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451535165309906, gen p mean: -0.048524409532547, mean p set: 0.4520154595375061
The modified gen p mean: 0.4508119225502014, gen p mean: -0.05395606905221939, mean p set: 0.4512922167778015
loss_pred:0.01860589161515236, decouple_loss:0.0011697686277329922
loss_pred:0.018939267843961716, decouple_loss:0.0012035855324938893
The modified gen p mean: 0.4502672851085663, gen p mean: -0.054402682930231094, mean p set: 0.45074760913848877
loss_pred:0.018260397017002106, decouple_loss:0.0011926788138225675
Iteration: 826, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45153141021728516, gen p mean: -0.04641135409474373, mean p set: 0.45201170444488525
loss_pred:0.017276205122470856, decouple_loss:0.0011677322909235954
The modified gen p mean: 0.4512348175048828, gen p mean: -0.04637952521443367, mean p set: 0.4517151117324829The modified gen p mean: 0.4509640336036682, gen p mean: -0.04636366665363312, mean p set: 0.4514442980289459
loss_pred:0.0178983211517334, decouple_loss:0.0011365343816578388
loss_pred:0.01786188967525959, decouple_loss:0.001160474494099617
Iteration: 827, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44983214139938354, gen p mean: -0.053640369325876236, mean p set: 0.45031243562698364
loss_pred:0.017881548032164574, decouple_loss:0.001244010985828936
The modified gen p mean: 0.4508418142795563, gen p mean: -0.0498032309114933, mean p set: 0.45132210850715637The modified gen p mean: 0.45210567116737366, gen p mean: -0.05492914840579033, mean p set: 0.45258599519729614
loss_pred:0.018818723037838936, decouple_loss:0.0012549750972539186
loss_pred:0.0186481811106205, decouple_loss:0.0013211823534220457
Iteration: 828, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44971582293510437, gen p mean: -0.055989231914281845, mean p set: 0.4501960873603821
The modified gen p mean: 0.45085176825523376, gen p mean: -0.048705220222473145, mean p set: 0.45133206248283386
loss_pred:0.018184971064329147, decouple_loss:0.001243286533281207
loss_pred:0.01812324859201908, decouple_loss:0.0012060960289090872The modified gen p mean: 0.44986769556999207, gen p mean: -0.05593240261077881, mean p set: 0.45034801959991455
loss_pred:0.018416795879602432, decouple_loss:0.0013251699274405837
Iteration: 829, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508407413959503, gen p mean: -0.044837355613708496, mean p set: 0.451321005821228
The modified gen p mean: 0.45233821868896484, gen p mean: -0.04761224612593651, mean p set: 0.45281848311424255
loss_pred:0.017909608781337738, decouple_loss:0.0012663339730352163
loss_pred:0.017161650583148003, decouple_loss:0.0013102643424645066
The modified gen p mean: 0.4519759714603424, gen p mean: -0.045977216213941574, mean p set: 0.4524562954902649
loss_pred:0.017661530524492264, decouple_loss:0.001331865438260138
Iteration: 830, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496115744113922, gen p mean: -0.05349477007985115, mean p set: 0.4500918984413147
loss_pred:0.0180668905377388, decouple_loss:0.0012209509732201695
The modified gen p mean: 0.4517272710800171, gen p mean: -0.04675775766372681, mean p set: 0.4522075653076172The modified gen p mean: 0.45010122656822205, gen p mean: -0.04929516837000847, mean p set: 0.45058155059814453
loss_pred:0.017561644315719604, decouple_loss:0.0012143882922828197
loss_pred:0.01855579949915409, decouple_loss:0.0013049395056441426
2023-04-30 06:48:31 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.054283104836940765, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04984934628009796, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05028953403234482, mean p set: 0.4500633478164673
loss_pred:0.018533550202846527, decouple_loss:0.0013190419413149357
loss_pred:0.017442358657717705, decouple_loss:0.0013368148356676102
loss_pred:0.01762695424258709, decouple_loss:0.0013218434760347009
WV_0_PC_1_EH_0_PS_40, loss: 0.017933916300535202, avg_mse: 0.02577279321849346
current test mse: 0.025773
Iteration: 831, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508074223995209, gen p mean: -0.05147223547101021, mean p set: 0.4512876868247986
The modified gen p mean: 0.4518773853778839, gen p mean: -0.04307305067777634, mean p set: 0.452357679605484
The modified gen p mean: 0.45073339343070984, gen p mean: -0.051272861659526825, mean p set: 0.4512137174606323
loss_pred:0.018765764310956, decouple_loss:0.0011270011309534311
loss_pred:0.01870157942175865, decouple_loss:0.0011270907707512379
loss_pred:0.017435286194086075, decouple_loss:0.0010969792492687702
Iteration: 832, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497329592704773, gen p mean: -0.04766801372170448, mean p set: 0.4502132534980774
The modified gen p mean: 0.4501001536846161, gen p mean: -0.04958837851881981, mean p set: 0.45058050751686096loss_pred:0.018403446301817894, decouple_loss:0.0012648663250729442
The modified gen p mean: 0.4493287205696106, gen p mean: -0.04676128178834915, mean p set: 0.4498090147972107
loss_pred:0.01872212626039982, decouple_loss:0.001333725405856967
loss_pred:0.01890011504292488, decouple_loss:0.0013589145382866263
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
NaN value num: 0
Iteration: 833, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44997432827949524, gen p mean: -0.04137234762310982, mean p set: 0.45045459270477295
loss_pred:0.016967616975307465, decouple_loss:0.0010886036325246096
The modified gen p mean: 0.44983574748039246, gen p mean: -0.04207490757107735, mean p set: 0.45031604170799255The modified gen p mean: 0.4492345154285431, gen p mean: -0.04507702961564064, mean p set: 0.4497148096561432
loss_pred:0.018301470205187798, decouple_loss:0.0011837969068437815
loss_pred:0.017904531210660934, decouple_loss:0.0011851056478917599
Iteration: 834, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45282161235809326, gen p mean: -0.039590343832969666, mean p set: 0.45330190658569336
loss_pred:0.01747307740151882, decouple_loss:0.0013443167554214597
The modified gen p mean: 0.45316675305366516, gen p mean: -0.039664093405008316, mean p set: 0.45364704728126526The modified gen p mean: 0.4514254629611969, gen p mean: -0.04288322851061821, mean p set: 0.451905757188797
loss_pred:0.017549894750118256, decouple_loss:0.0013101838994771242
loss_pred:0.017646731808781624, decouple_loss:0.0011456692591309547
Iteration: 835, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45048776268959045, gen p mean: -0.04134436324238777, mean p set: 0.45096808671951294
loss_pred:0.0172813069075346, decouple_loss:0.0012051399098709226
The modified gen p mean: 0.44992244243621826, gen p mean: -0.035443976521492004, mean p set: 0.45040273666381836The modified gen p mean: 0.44934505224227905, gen p mean: -0.036715682595968246, mean p set: 0.44982537627220154
loss_pred:0.017727883532643318, decouple_loss:0.0010991080198436975
loss_pred:0.018050746992230415, decouple_loss:0.0012191359419375658
Iteration: 836, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503084123134613, gen p mean: -0.03832414746284485, mean p set: 0.4507887363433838
loss_pred:0.01694067008793354, decouple_loss:0.0012054976541548967
The modified gen p mean: 0.44972240924835205, gen p mean: -0.03842291235923767, mean p set: 0.45020267367362976The modified gen p mean: 0.4498113691806793, gen p mean: -0.04216017201542854, mean p set: 0.4502916932106018
loss_pred:0.018970349803566933, decouple_loss:0.001248705550096929
loss_pred:0.018176164478063583, decouple_loss:0.0012723098043352365
Iteration: 837, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489035904407501, gen p mean: -0.04428288713097572, mean p set: 0.4493838846683502
loss_pred:0.01824854500591755, decouple_loss:0.0011726279044523835
The modified gen p mean: 0.45171695947647095, gen p mean: -0.033393681049346924, mean p set: 0.45219725370407104The modified gen p mean: 0.44876691699028015, gen p mean: -0.04215678200125694, mean p set: 0.44924721121788025
loss_pred:0.01754550077021122, decouple_loss:0.001321272924542427
loss_pred:0.01740989089012146, decouple_loss:0.001161377178505063
Iteration: 838, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502153694629669, gen p mean: -0.03693876415491104, mean p set: 0.450695663690567
loss_pred:0.018103808164596558, decouple_loss:0.00124124635476619
The modified gen p mean: 0.4530009925365448, gen p mean: -0.036356862634420395, mean p set: 0.4534813165664673The modified gen p mean: 0.4506075978279114, gen p mean: -0.037802159786224365, mean p set: 0.4510878920555115
loss_pred:0.018553679808974266, decouple_loss:0.0012126205256208777
loss_pred:0.018164826557040215, decouple_loss:0.0012761791003867984
Iteration: 839, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512633979320526, gen p mean: -0.036796703934669495, mean p set: 0.4517436623573303
loss_pred:0.018496714532375336, decouple_loss:0.001196849625557661
The modified gen p mean: 0.45217227935791016, gen p mean: -0.03562036529183388, mean p set: 0.45265257358551025
The modified gen p mean: 0.4495389461517334, gen p mean: -0.0344458669424057, mean p set: 0.4500192403793335
loss_pred:0.01739373244345188, decouple_loss:0.0012256237678229809
loss_pred:0.017583800479769707, decouple_loss:0.0010277663823217154
Iteration: 840, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451625794172287, gen p mean: -0.03820124268531799, mean p set: 0.4521060883998871
loss_pred:0.018045002594590187, decouple_loss:0.0011200668523088098
The modified gen p mean: 0.45273956656455994, gen p mean: -0.035958435386419296, mean p set: 0.4532198905944824The modified gen p mean: 0.4501339793205261, gen p mean: -0.03382449969649315, mean p set: 0.45061424374580383
loss_pred:0.018301358446478844, decouple_loss:0.0011478681117296219
loss_pred:0.017503540962934494, decouple_loss:0.0010866058291867375
2023-04-30 06:51:09 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04711385816335678, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04238240793347359, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0428401343524456, mean p set: 0.4500633478164673
loss_pred:0.0185822956264019, decouple_loss:0.0012115560239180923
loss_pred:0.017486246302723885, decouple_loss:0.0011824923567473888
loss_pred:0.01761910691857338, decouple_loss:0.0012272201711311936
WV_0_PC_1_EH_0_PS_40, loss: 0.017956238240003586, avg_mse: 0.025830673053860664
current test mse: 0.025831
Iteration: 841, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491724371910095, gen p mean: -0.0376553013920784, mean p set: 0.4496527314186096
The modified gen p mean: 0.45007792115211487, gen p mean: -0.034561656415462494, mean p set: 0.4505581855773926
The modified gen p mean: 0.4502222239971161, gen p mean: -0.03585268557071686, mean p set: 0.4507025480270386
loss_pred:0.01832933910191059, decouple_loss:0.0012086270144209266
loss_pred:0.017973491922020912, decouple_loss:0.0011408805148676038
loss_pred:0.017658522352576256, decouple_loss:0.0011319612385705113
Iteration: 842, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44726434350013733, gen p mean: -0.04887721687555313, mean p set: 0.4477446675300598
The modified gen p mean: 0.4501267969608307, gen p mean: -0.048465874046087265, mean p set: 0.4506070911884308
loss_pred:0.017073549330234528, decouple_loss:0.001399844535626471
loss_pred:0.017826342955231667, decouple_loss:0.001246089581400156
The modified gen p mean: 0.44892454147338867, gen p mean: -0.046555325388908386, mean p set: 0.4494048058986664
loss_pred:0.017143869772553444, decouple_loss:0.0013046609237790108
Iteration: 843, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488403797149658, gen p mean: -0.04583578184247017, mean p set: 0.4493206739425659
The modified gen p mean: 0.4511922299861908, gen p mean: -0.045419707894325256, mean p set: 0.4516725242137909
loss_pred:0.017337601631879807, decouple_loss:0.0010487540857866406
loss_pred:0.018009470775723457, decouple_loss:0.001078957226127386
The modified gen p mean: 0.44970130920410156, gen p mean: -0.040107838809490204, mean p set: 0.45018163323402405
loss_pred:0.017760949209332466, decouple_loss:0.0011853885371237993
Iteration: 844, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495340585708618, gen p mean: -0.0419955737888813, mean p set: 0.4500143229961395
loss_pred:0.017534544691443443, decouple_loss:0.0012863553129136562
The modified gen p mean: 0.4485595226287842, gen p mean: -0.05299081653356552, mean p set: 0.44903984665870667The modified gen p mean: 0.44869181513786316, gen p mean: -0.04795028641819954, mean p set: 0.44917213916778564
loss_pred:0.017324792221188545, decouple_loss:0.001120865112170577
loss_pred:0.017286861315369606, decouple_loss:0.001154729281552136
Iteration: 845, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972774386405945, gen p mean: -0.05536913126707077, mean p set: 0.45020797848701477
loss_pred:0.017983270809054375, decouple_loss:0.001177499070763588
The modified gen p mean: 0.45039209723472595, gen p mean: -0.03944355621933937, mean p set: 0.45087239146232605The modified gen p mean: 0.44873306155204773, gen p mean: -0.04922446981072426, mean p set: 0.44921332597732544
loss_pred:0.017599783837795258, decouple_loss:0.0010488502448424697
loss_pred:0.01787334866821766, decouple_loss:0.0011066538281738758
Iteration: 846, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44949871301651, gen p mean: -0.04575944319367409, mean p set: 0.4499790072441101The modified gen p mean: 0.4505919814109802, gen p mean: -0.05115137994289398, mean p set: 0.4510722756385803
loss_pred:0.018087003380060196, decouple_loss:0.0011908684391528368
loss_pred:0.017219914123415947, decouple_loss:0.0012394038494676352
The modified gen p mean: 0.45304596424102783, gen p mean: -0.04804321378469467, mean p set: 0.45352625846862793
loss_pred:0.01766100712120533, decouple_loss:0.0011894250055775046
Iteration: 847, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44984570145606995, gen p mean: -0.041425418108701706, mean p set: 0.45032599568367004
The modified gen p mean: 0.4496883451938629, gen p mean: -0.04019434377551079, mean p set: 0.4501686692237854
loss_pred:0.017281489446759224, decouple_loss:0.0011063091224059463
loss_pred:0.01753479801118374, decouple_loss:0.0011360595235601068
The modified gen p mean: 0.4527161717414856, gen p mean: -0.0442049503326416, mean p set: 0.4531964957714081
loss_pred:0.01799306645989418, decouple_loss:0.0012222900986671448
Iteration: 848, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526509642601013, gen p mean: -0.047108348459005356, mean p set: 0.4531312584877014
loss_pred:0.01804927922785282, decouple_loss:0.001294171903282404
The modified gen p mean: 0.4496876001358032, gen p mean: -0.050033941864967346, mean p set: 0.45016786456108093The modified gen p mean: 0.4507034122943878, gen p mean: -0.04470580443739891, mean p set: 0.4511836767196655
loss_pred:0.01814100705087185, decouple_loss:0.0011540361447259784
loss_pred:0.018344901502132416, decouple_loss:0.0011143832234665751
Iteration: 849, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451553612947464, gen p mean: -0.04380709305405617, mean p set: 0.4520338773727417
loss_pred:0.017948126420378685, decouple_loss:0.0012179006589576602
The modified gen p mean: 0.45297864079475403, gen p mean: -0.0467330627143383, mean p set: 0.4534589648246765The modified gen p mean: 0.4497637450695038, gen p mean: -0.05353841558098793, mean p set: 0.4502440094947815
loss_pred:0.01852388121187687, decouple_loss:0.001160662155598402
loss_pred:0.017285646870732307, decouple_loss:0.0012443644227460027
Iteration: 850, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45358121395111084, gen p mean: -0.04863421246409416, mean p set: 0.45406150817871094
loss_pred:0.016980115324258804, decouple_loss:0.0011176817351952195
The modified gen p mean: 0.4523540735244751, gen p mean: -0.04296765476465225, mean p set: 0.4528343677520752The modified gen p mean: 0.4498523473739624, gen p mean: -0.047611381858587265, mean p set: 0.4503326416015625
loss_pred:0.017549162730574608, decouple_loss:0.0011331257410347462
loss_pred:0.01860053278505802, decouple_loss:0.001165318302810192
2023-04-30 06:53:03 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.053164977580308914, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04855940490961075, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04919959604740143, mean p set: 0.4500633478164673
loss_pred:0.018562816083431244, decouple_loss:0.0012314040213823318
loss_pred:0.01750412955880165, decouple_loss:0.0012482531601563096
loss_pred:0.017601216211915016, decouple_loss:0.0012322480324655771
WV_0_PC_1_EH_0_PS_40, loss: 0.017951253801584244, avg_mse: 0.025829480960965157
current test mse: 0.025829
Iteration: 851, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846272468566895, gen p mean: -0.05360747128725052, mean p set: 0.44894298911094666
The modified gen p mean: 0.45256516337394714, gen p mean: -0.04347693547606468, mean p set: 0.45304545760154724
The modified gen p mean: 0.4500858783721924, gen p mean: -0.044258516281843185, mean p set: 0.4505661725997925
loss_pred:0.016818895936012268, decouple_loss:0.0011013095499947667
loss_pred:0.01660274714231491, decouple_loss:0.001125074690207839
loss_pred:0.017595883458852768, decouple_loss:0.0013012359850108624
Iteration: 852, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44918400049209595, gen p mean: -0.043552495539188385, mean p set: 0.44966429471969604
loss_pred:0.01817123219370842, decouple_loss:0.0011228944640606642
The modified gen p mean: 0.44933873414993286, gen p mean: -0.051425836980342865, mean p set: 0.44981902837753296The modified gen p mean: 0.44980499148368835, gen p mean: -0.04355402663350105, mean p set: 0.45028528571128845
loss_pred:0.01709732785820961, decouple_loss:0.0009897641139104962
loss_pred:0.017277279868721962, decouple_loss:0.0012066198978573084
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 853, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44805780053138733, gen p mean: -0.04649094492197037, mean p set: 0.44853806495666504
loss_pred:0.014741904102265835, decouple_loss:0.0011877184733748436
The modified gen p mean: 0.4487673342227936, gen p mean: -0.05022251605987549, mean p set: 0.44924765825271606The modified gen p mean: 0.4478552043437958, gen p mean: -0.04936937242746353, mean p set: 0.4483354985713959
loss_pred:0.014675247482955456, decouple_loss:0.0012261720839887857
loss_pred:0.015163029544055462, decouple_loss:0.0011991451028734446
Iteration: 854, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486353397369385, gen p mean: -0.051682621240615845, mean p set: 0.4491156041622162
The modified gen p mean: 0.4480783939361572, gen p mean: -0.04996078461408615, mean p set: 0.44855865836143494
The modified gen p mean: 0.44863730669021606, gen p mean: -0.049974169582128525, mean p set: 0.44911760091781616
loss_pred:0.01498975045979023, decouple_loss:0.001200315193273127
loss_pred:0.014965699054300785, decouple_loss:0.0012205259408801794loss_pred:0.015136822126805782, decouple_loss:0.0011939420364797115
Iteration: 855, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44889020919799805, gen p mean: -0.05699392408132553, mean p set: 0.44937053322792053
The modified gen p mean: 0.4477640688419342, gen p mean: -0.053997769951820374, mean p set: 0.4482443630695343
loss_pred:0.01481869351118803, decouple_loss:0.0011539405677467585
loss_pred:0.014819357544183731, decouple_loss:0.0010624497663229704
The modified gen p mean: 0.4475170075893402, gen p mean: -0.05606275424361229, mean p set: 0.4479973018169403
loss_pred:0.014581202529370785, decouple_loss:0.001142509514465928
Iteration: 856, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487855136394501, gen p mean: -0.05885022506117821, mean p set: 0.44926580786705017
loss_pred:0.014425801113247871, decouple_loss:0.0013733968371525407
The modified gen p mean: 0.4480121433734894, gen p mean: -0.0591757632791996, mean p set: 0.4484924077987671The modified gen p mean: 0.44869399070739746, gen p mean: -0.0607643723487854, mean p set: 0.44917428493499756
loss_pred:0.014302453957498074, decouple_loss:0.0013303840532898903
loss_pred:0.014136578887701035, decouple_loss:0.0012961227912455797
Iteration: 857, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44868943095207214, gen p mean: -0.05850277468562126, mean p set: 0.44916975498199463
The modified gen p mean: 0.4480448067188263, gen p mean: -0.05936736240983009, mean p set: 0.4485251009464264
loss_pred:0.01437710877507925, decouple_loss:0.0013316469267010689
loss_pred:0.01411379687488079, decouple_loss:0.0013705827295780182
The modified gen p mean: 0.44839170575141907, gen p mean: -0.05997711792588234, mean p set: 0.44887199997901917
loss_pred:0.013911607675254345, decouple_loss:0.0013471943093463778
Iteration: 858, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473727345466614, gen p mean: -0.05444694310426712, mean p set: 0.44785305857658386
The modified gen p mean: 0.4471951127052307, gen p mean: -0.050988126546144485, mean p set: 0.4476754069328308
loss_pred:0.014198647812008858, decouple_loss:0.0013471863931044936
loss_pred:0.01410825178027153, decouple_loss:0.0013759483117610216
The modified gen p mean: 0.44855940341949463, gen p mean: -0.051717888563871384, mean p set: 0.4490397274494171
loss_pred:0.014158117584884167, decouple_loss:0.0014655636623501778
Iteration: 859, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44666147232055664, gen p mean: -0.04567928984761238, mean p set: 0.44714176654815674
The modified gen p mean: 0.4487454891204834, gen p mean: -0.043722525238990784, mean p set: 0.4492258131504059
loss_pred:0.014017251320183277, decouple_loss:0.0016288963379338384
loss_pred:0.013669189997017384, decouple_loss:0.0015100399032235146
The modified gen p mean: 0.4473927617073059, gen p mean: -0.036478493362665176, mean p set: 0.447873055934906
loss_pred:0.01408119685947895, decouple_loss:0.0016604190459474921
Iteration: 860, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482080042362213, gen p mean: -0.037275530397892, mean p set: 0.4486883282661438
The modified gen p mean: 0.44955798983573914, gen p mean: -0.04262971878051758, mean p set: 0.45003825426101685
loss_pred:0.013466090895235538, decouple_loss:0.0014396626502275467
loss_pred:0.013599934056401253, decouple_loss:0.0014691767282783985
The modified gen p mean: 0.4482119381427765, gen p mean: -0.038380205631256104, mean p set: 0.4486922323703766
loss_pred:0.014035511761903763, decouple_loss:0.0013595568016171455
2023-04-30 06:55:35 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.040975626558065414, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03601781651377678, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.03501412644982338, mean p set: 0.4500633478164673
loss_pred:0.019477494060993195, decouple_loss:0.0016216321382671595
loss_pred:0.018283890560269356, decouple_loss:0.0015975278802216053
loss_pred:0.018404774367809296, decouple_loss:0.0016801792662590742
WV_0_PC_1_EH_0_PS_40, loss: 0.018803708255290985, avg_mse: 0.027370035648345947
current test mse: 0.02737
Iteration: 861, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44903212785720825, gen p mean: -0.03457149118185043, mean p set: 0.44951245188713074
The modified gen p mean: 0.44808676838874817, gen p mean: -0.04054754227399826, mean p set: 0.44856706261634827
The modified gen p mean: 0.44725608825683594, gen p mean: -0.04167173430323601, mean p set: 0.4477364122867584
loss_pred:0.014039886184036732, decouple_loss:0.0015901651931926608
loss_pred:0.013248809613287449, decouple_loss:0.001639851019717753
loss_pred:0.013887566514313221, decouple_loss:0.0016829902306199074
Iteration: 862, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478801488876343, gen p mean: -0.04115942120552063, mean p set: 0.4483604431152344
loss_pred:0.013635709881782532, decouple_loss:0.0015932165551930666
The modified gen p mean: 0.44758477807044983, gen p mean: -0.037275530397892, mean p set: 0.4480650722980499
The modified gen p mean: 0.4485745131969452, gen p mean: -0.040565043687820435, mean p set: 0.4490547776222229
loss_pred:0.013438541442155838, decouple_loss:0.0016741181025281549
loss_pred:0.0134564358741045, decouple_loss:0.001578686060383916
Iteration: 863, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492049813270569, gen p mean: -0.048788659274578094, mean p set: 0.449685275554657
The modified gen p mean: 0.44635310769081116, gen p mean: -0.04792493209242821, mean p set: 0.44683340191841125
loss_pred:0.013675223104655743, decouple_loss:0.0015810903860256076
loss_pred:0.013758944347500801, decouple_loss:0.0017223544418811798
The modified gen p mean: 0.4481388330459595, gen p mean: -0.05009175091981888, mean p set: 0.44861912727355957
loss_pred:0.013833411037921906, decouple_loss:0.0017107278108596802
Iteration: 864, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482963979244232, gen p mean: -0.04773462563753128, mean p set: 0.4487766921520233
The modified gen p mean: 0.447951078414917, gen p mean: -0.04579900577664375, mean p set: 0.4484313726425171
loss_pred:0.013600891456007957, decouple_loss:0.0014677050057798624
loss_pred:0.01354171335697174, decouple_loss:0.001458193059079349
The modified gen p mean: 0.4483334720134735, gen p mean: -0.04211847484111786, mean p set: 0.4488137364387512
loss_pred:0.013479598797857761, decouple_loss:0.0015376394148916006
Iteration: 865, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44847413897514343, gen p mean: -0.0469333715736866, mean p set: 0.44895440340042114
The modified gen p mean: 0.44858911633491516, gen p mean: -0.04627581313252449, mean p set: 0.44906941056251526
loss_pred:0.013375457376241684, decouple_loss:0.0016159332590177655
loss_pred:0.013432691805064678, decouple_loss:0.0016052701976150274
The modified gen p mean: 0.4487054944038391, gen p mean: -0.0459037721157074, mean p set: 0.4491857588291168
loss_pred:0.013563438318669796, decouple_loss:0.001758031197823584
Iteration: 866, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862884283065796, gen p mean: -0.04614266753196716, mean p set: 0.44910916686058044
loss_pred:0.013748927973210812, decouple_loss:0.0014774604933336377
The modified gen p mean: 0.4477236270904541, gen p mean: -0.03677847608923912, mean p set: 0.4482038617134094The modified gen p mean: 0.44823095202445984, gen p mean: -0.04138587787747383, mean p set: 0.44871124625205994
loss_pred:0.013572586700320244, decouple_loss:0.001545275910757482
loss_pred:0.0137332733720541, decouple_loss:0.0015168883837759495
Iteration: 867, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756248593330383, gen p mean: -0.04399869218468666, mean p set: 0.44804278016090393
loss_pred:0.0138980932533741, decouple_loss:0.0015053714159876108
The modified gen p mean: 0.4495488703250885, gen p mean: -0.0504797138273716, mean p set: 0.450029194355011The modified gen p mean: 0.4489459991455078, gen p mean: -0.04317595437169075, mean p set: 0.4494262933731079
loss_pred:0.013703541830182076, decouple_loss:0.0014879596419632435
loss_pred:0.01357683353126049, decouple_loss:0.0015159565955400467
Iteration: 868, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485088884830475, gen p mean: -0.04996804893016815, mean p set: 0.44898921251296997
loss_pred:0.013001706451177597, decouple_loss:0.0016397908329963684
The modified gen p mean: 0.4484032988548279, gen p mean: -0.04679112508893013, mean p set: 0.4488835632801056
The modified gen p mean: 0.4479963183403015, gen p mean: -0.04738476127386093, mean p set: 0.4484765827655792
loss_pred:0.013378657400608063, decouple_loss:0.0016663254937157035
loss_pred:0.01303488202393055, decouple_loss:0.0016430511604994535
Iteration: 869, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448984295129776, gen p mean: -0.04564347490668297, mean p set: 0.4494645595550537
loss_pred:0.013272876851260662, decouple_loss:0.0014859536895528436
The modified gen p mean: 0.44862380623817444, gen p mean: -0.04485398530960083, mean p set: 0.44910410046577454The modified gen p mean: 0.4477487802505493, gen p mean: -0.04479982703924179, mean p set: 0.4482291042804718
loss_pred:0.013634007424116135, decouple_loss:0.0014779666671529412
loss_pred:0.013560454361140728, decouple_loss:0.001540740835480392
Iteration: 870, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44933342933654785, gen p mean: -0.04516279697418213, mean p set: 0.44981372356414795
loss_pred:0.013076011091470718, decouple_loss:0.001565581071190536
The modified gen p mean: 0.449144572019577, gen p mean: -0.04605045169591904, mean p set: 0.4496248662471771The modified gen p mean: 0.4474312961101532, gen p mean: -0.044101595878601074, mean p set: 0.4479115903377533
loss_pred:0.013362102210521698, decouple_loss:0.0016458265017718077
loss_pred:0.013182778842747211, decouple_loss:0.0016256181988865137
2023-04-30 06:57:28 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.047889310866594315, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.043675344437360764, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.043985214084386826, mean p set: 0.4500633478164673
loss_pred:0.019338183104991913, decouple_loss:0.0015672186855226755
loss_pred:0.018161939457058907, decouple_loss:0.0015626673121005297
loss_pred:0.018332919105887413, decouple_loss:0.0016057307366281748
WV_0_PC_1_EH_0_PS_40, loss: 0.018689943477511406, avg_mse: 0.027123620733618736
current test mse: 0.027124
Iteration: 871, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494702219963074, gen p mean: -0.04406249150633812, mean p set: 0.44995051622390747
The modified gen p mean: 0.4481961727142334, gen p mean: -0.04763125628232956, mean p set: 0.4486764669418335
The modified gen p mean: 0.448775053024292, gen p mean: -0.04466836899518967, mean p set: 0.4492553174495697
loss_pred:0.013107680715620518, decouple_loss:0.0015128609957173467
loss_pred:0.013476337306201458, decouple_loss:0.0015049709472805262
loss_pred:0.013045024126768112, decouple_loss:0.0015396103262901306
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 872, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44871985912323, gen p mean: -0.04532847926020622, mean p set: 0.4492001235485077
loss_pred:0.013116233050823212, decouple_loss:0.0014765731757506728
The modified gen p mean: 0.44877079129219055, gen p mean: -0.04612687602639198, mean p set: 0.44925105571746826The modified gen p mean: 0.44882646203041077, gen p mean: -0.05027122423052788, mean p set: 0.44930675625801086
loss_pred:0.013044703751802444, decouple_loss:0.0014334599254652858
loss_pred:0.013186978176236153, decouple_loss:0.001471489667892456
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
NaN value num: 0
Iteration: 873, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45122531056404114, gen p mean: -0.04676102474331856, mean p set: 0.45170560479164124
loss_pred:0.01802031137049198, decouple_loss:0.0017967154271900654
The modified gen p mean: 0.45183253288269043, gen p mean: -0.047319334000349045, mean p set: 0.4523128271102905The modified gen p mean: 0.45202934741973877, gen p mean: -0.048439886420965195, mean p set: 0.4525096118450165
loss_pred:0.018249386921525, decouple_loss:0.0017730742692947388
loss_pred:0.018877631053328514, decouple_loss:0.0017850719159469008
Iteration: 874, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496181607246399, gen p mean: -0.03598194196820259, mean p set: 0.4500984251499176
The modified gen p mean: 0.4517357647418976, gen p mean: -0.04050277918577194, mean p set: 0.4522160291671753
loss_pred:0.01795613020658493, decouple_loss:0.0016950465505942702
loss_pred:0.018048454076051712, decouple_loss:0.0016374862752854824
The modified gen p mean: 0.4506036043167114, gen p mean: -0.04015780985355377, mean p set: 0.4510838985443115
loss_pred:0.018516939133405685, decouple_loss:0.0017049247398972511
Iteration: 875, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525480270385742, gen p mean: -0.03477448970079422, mean p set: 0.4530283212661743
loss_pred:0.018074912950396538, decouple_loss:0.0017373348819091916
The modified gen p mean: 0.4518691301345825, gen p mean: -0.03957749903202057, mean p set: 0.452349454164505The modified gen p mean: 0.4516639709472656, gen p mean: -0.03197956830263138, mean p set: 0.4521442651748657
loss_pred:0.01768297702074051, decouple_loss:0.001830949098803103
loss_pred:0.017874540761113167, decouple_loss:0.001743221189826727
Iteration: 876, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515172839164734, gen p mean: -0.025086943060159683, mean p set: 0.4519975483417511
loss_pred:0.01750062219798565, decouple_loss:0.0014713393757119775
The modified gen p mean: 0.4519600570201874, gen p mean: -0.030027499422430992, mean p set: 0.4524403214454651The modified gen p mean: 0.4519064128398895, gen p mean: -0.029615826904773712, mean p set: 0.452386736869812
loss_pred:0.018684130162000656, decouple_loss:0.0014897937653586268
loss_pred:0.018008798360824585, decouple_loss:0.0014995126985013485
Iteration: 877, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508105218410492, gen p mean: -0.023016532883048058, mean p set: 0.4512908160686493
loss_pred:0.017400717362761497, decouple_loss:0.0016253495123237371
The modified gen p mean: 0.4539630711078644, gen p mean: -0.02111629955470562, mean p set: 0.4544433653354645The modified gen p mean: 0.4537601172924042, gen p mean: -0.02107207477092743, mean p set: 0.4542403817176819
loss_pred:0.01792151667177677, decouple_loss:0.0015936311101540923
loss_pred:0.01865462400019169, decouple_loss:0.0015904729953035712
Iteration: 878, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517442584037781, gen p mean: -0.021621592342853546, mean p set: 0.4522245526313782
The modified gen p mean: 0.450985848903656, gen p mean: -0.017758464440703392, mean p set: 0.4514661431312561
loss_pred:0.01742621511220932, decouple_loss:0.0017248134827241302
loss_pred:0.018084993585944176, decouple_loss:0.0017562167486175895
The modified gen p mean: 0.4496695399284363, gen p mean: -0.01307337824255228, mean p set: 0.4501498341560364
loss_pred:0.01756778359413147, decouple_loss:0.0016705913003534079
Iteration: 879, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45253291726112366, gen p mean: -0.01623670756816864, mean p set: 0.45301321148872375
The modified gen p mean: 0.4516013264656067, gen p mean: -0.01888946257531643, mean p set: 0.4520816504955292
loss_pred:0.018389537930488586, decouple_loss:0.0015589179238304496
loss_pred:0.018301941454410553, decouple_loss:0.001574395108036697
The modified gen p mean: 0.4520858824253082, gen p mean: -0.017046406865119934, mean p set: 0.4525661766529083
loss_pred:0.017637383192777634, decouple_loss:0.0015754607738927007
Iteration: 880, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45040854811668396, gen p mean: -0.019495319575071335, mean p set: 0.45088884234428406
The modified gen p mean: 0.45147353410720825, gen p mean: -0.01772407256066799, mean p set: 0.45195385813713074
loss_pred:0.01878543011844158, decouple_loss:0.0018947434145957232
loss_pred:0.01838921196758747, decouple_loss:0.001741635031066835
The modified gen p mean: 0.4527859091758728, gen p mean: -0.019360428676009178, mean p set: 0.4532662332057953
loss_pred:0.017760759219527245, decouple_loss:0.001812719856388867
2023-04-30 06:59:58 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.028966810554265976, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.02490284852683544, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.024946819990873337, mean p set: 0.4500633478164673
loss_pred:0.01876303181052208, decouple_loss:0.0018193641444668174
loss_pred:0.0176985003054142, decouple_loss:0.0017817661864683032
loss_pred:0.017823582515120506, decouple_loss:0.001736367936246097
WV_0_PC_1_EH_0_PS_40, loss: 0.0181839969009161, avg_mse: 0.02616066485643387
current test mse: 0.026161
Iteration: 881, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45095574855804443, gen p mean: -0.02253677509725094, mean p set: 0.45143604278564453
The modified gen p mean: 0.4518813490867615, gen p mean: -0.02463308908045292, mean p set: 0.4523616135120392The modified gen p mean: 0.453398197889328, gen p mean: -0.02124345488846302, mean p set: 0.4538784623146057
loss_pred:0.017345121130347252, decouple_loss:0.0015690180007368326
loss_pred:0.01736856810748577, decouple_loss:0.0015059664146974683
loss_pred:0.018160218372941017, decouple_loss:0.0015087054343894124
Iteration: 882, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511350989341736, gen p mean: -0.031143352389335632, mean p set: 0.4516153931617737
loss_pred:0.018074745312333107, decouple_loss:0.0015261222142726183
The modified gen p mean: 0.4505375027656555, gen p mean: -0.022686384618282318, mean p set: 0.451017826795578The modified gen p mean: 0.451686829328537, gen p mean: -0.03417332097887993, mean p set: 0.4521671235561371
loss_pred:0.017472682520747185, decouple_loss:0.0015643995720893145
loss_pred:0.017410434782505035, decouple_loss:0.0016398356528952718
Iteration: 883, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517925977706909, gen p mean: -0.04123121127486229, mean p set: 0.45227286219596863
loss_pred:0.017598353326320648, decouple_loss:0.0015715090557932854
The modified gen p mean: 0.4518463611602783, gen p mean: -0.034615408629179, mean p set: 0.4523266553878784The modified gen p mean: 0.44897574186325073, gen p mean: -0.028484994545578957, mean p set: 0.44945603609085083
loss_pred:0.01733117178082466, decouple_loss:0.0015142560005187988
loss_pred:0.01798509806394577, decouple_loss:0.0013904576189815998
Iteration: 884, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511801600456238, gen p mean: -0.042976103723049164, mean p set: 0.4516604542732239
loss_pred:0.017368663102388382, decouple_loss:0.001306125894188881
The modified gen p mean: 0.4520367681980133, gen p mean: -0.04583629593253136, mean p set: 0.4525170624256134The modified gen p mean: 0.45124661922454834, gen p mean: -0.04249496012926102, mean p set: 0.45172688364982605
loss_pred:0.01770877279341221, decouple_loss:0.001404285547323525
loss_pred:0.01882299780845642, decouple_loss:0.001417535007931292
Iteration: 885, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505755603313446, gen p mean: -0.0506320595741272, mean p set: 0.4510558545589447
loss_pred:0.018604176118969917, decouple_loss:0.0013871189439669251
The modified gen p mean: 0.45169639587402344, gen p mean: -0.04996441677212715, mean p set: 0.45217666029930115The modified gen p mean: 0.45329049229621887, gen p mean: -0.045337218791246414, mean p set: 0.45377078652381897
loss_pred:0.017409969121217728, decouple_loss:0.001530051464214921
loss_pred:0.017116235569119453, decouple_loss:0.0014729147078469396
Iteration: 886, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514986574649811, gen p mean: -0.05043904855847359, mean p set: 0.4519789516925812
loss_pred:0.01815897785127163, decouple_loss:0.0014084215508773923
The modified gen p mean: 0.4516017436981201, gen p mean: -0.04954927787184715, mean p set: 0.4520820379257202The modified gen p mean: 0.4501783847808838, gen p mean: -0.042491521686315536, mean p set: 0.4506586492061615
loss_pred:0.018127096816897392, decouple_loss:0.0013959365896880627
loss_pred:0.01715730130672455, decouple_loss:0.0015841233544051647
Iteration: 887, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45270365476608276, gen p mean: -0.048333413898944855, mean p set: 0.45318397879600525
loss_pred:0.01772044226527214, decouple_loss:0.0013238969258964062
The modified gen p mean: 0.4528464674949646, gen p mean: -0.05062016844749451, mean p set: 0.4533267617225647The modified gen p mean: 0.4513707756996155, gen p mean: -0.05545267090201378, mean p set: 0.4518510699272156
loss_pred:0.01736557111144066, decouple_loss:0.0013000572798773646
loss_pred:0.018361229449510574, decouple_loss:0.0014467572327703238
Iteration: 888, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44999122619628906, gen p mean: -0.04869549721479416, mean p set: 0.45047152042388916
loss_pred:0.016844771802425385, decouple_loss:0.0013250666670501232
The modified gen p mean: 0.44998785853385925, gen p mean: -0.04544680193066597, mean p set: 0.45046815276145935
The modified gen p mean: 0.451240211725235, gen p mean: -0.0524187870323658, mean p set: 0.4517205059528351
loss_pred:0.017178302630782127, decouple_loss:0.00133910879958421
loss_pred:0.018520526587963104, decouple_loss:0.001313734333962202
Iteration: 889, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513400197029114, gen p mean: -0.048355456441640854, mean p set: 0.4518203139305115
loss_pred:0.018202733248472214, decouple_loss:0.0013860662002116442
The modified gen p mean: 0.45082810521125793, gen p mean: -0.05114530771970749, mean p set: 0.45130833983421326The modified gen p mean: 0.4510897696018219, gen p mean: -0.04963055998086929, mean p set: 0.4515700936317444
loss_pred:0.0175861194729805, decouple_loss:0.0017571724019944668
loss_pred:0.016901258379220963, decouple_loss:0.0013854039134457707
Iteration: 890, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513089656829834, gen p mean: -0.04647194594144821, mean p set: 0.4517892897129059
loss_pred:0.01722218282520771, decouple_loss:0.0013583522522822022
The modified gen p mean: 0.4501592516899109, gen p mean: -0.043975651264190674, mean p set: 0.4506395757198334The modified gen p mean: 0.4489378333091736, gen p mean: -0.04118756204843521, mean p set: 0.4494180977344513
loss_pred:0.017504312098026276, decouple_loss:0.0013492703437805176
loss_pred:0.016850125044584274, decouple_loss:0.001466643763706088
2023-04-30 07:01:52 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05490100383758545, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05038502812385559, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.050419799983501434, mean p set: 0.4500633478164673
loss_pred:0.018640879541635513, decouple_loss:0.0015054718824103475
loss_pred:0.017609242349863052, decouple_loss:0.0014290555845946074
loss_pred:0.017698511481285095, decouple_loss:0.001504087820649147
WV_0_PC_1_EH_0_PS_40, loss: 0.018056854605674744, avg_mse: 0.025979449972510338
current test mse: 0.025979
Iteration: 891, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525426924228668, gen p mean: -0.04924727976322174, mean p set: 0.4530230164527893
The modified gen p mean: 0.4507720172405243, gen p mean: -0.045445531606674194, mean p set: 0.4512523412704468
The modified gen p mean: 0.45302072167396545, gen p mean: -0.048654813319444656, mean p set: 0.45350101590156555
loss_pred:0.017753571271896362, decouple_loss:0.0013259504921734333
loss_pred:0.017346061766147614, decouple_loss:0.0013374213594943285
loss_pred:0.017690597102046013, decouple_loss:0.0013642959529533982
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 892, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487113654613495, gen p mean: -0.04977837949991226, mean p set: 0.4491916298866272
loss_pred:0.01567121408879757, decouple_loss:0.0017019424121826887
The modified gen p mean: 0.45010730624198914, gen p mean: -0.051511529833078384, mean p set: 0.45058757066726685The modified gen p mean: 0.44947320222854614, gen p mean: -0.0503595769405365, mean p set: 0.44995349645614624
loss_pred:0.015821442008018494, decouple_loss:0.0016611850587651134
loss_pred:0.01534975040704012, decouple_loss:0.0016584631521254778
Iteration: 893, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491356611251831, gen p mean: -0.05314919725060463, mean p set: 0.4496159553527832
loss_pred:0.015442069619894028, decouple_loss:0.0014344681985676289
The modified gen p mean: 0.4501695930957794, gen p mean: -0.05173356458544731, mean p set: 0.4506498873233795The modified gen p mean: 0.44904807209968567, gen p mean: -0.050988394767045975, mean p set: 0.44952836632728577
loss_pred:0.01524727325886488, decouple_loss:0.0014533656649291515
loss_pred:0.01580909453332424, decouple_loss:0.0014355721650645137
Iteration: 894, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013517141342163, gen p mean: -0.05580286681652069, mean p set: 0.4506154954433441
loss_pred:0.015316980890929699, decouple_loss:0.0015464650932699442
The modified gen p mean: 0.4506217837333679, gen p mean: -0.049426838755607605, mean p set: 0.451102077960968The modified gen p mean: 0.4494397044181824, gen p mean: -0.04978369548916817, mean p set: 0.4499199688434601
loss_pred:0.014618178829550743, decouple_loss:0.001448381575755775
loss_pred:0.015144174918532372, decouple_loss:0.0014684596098959446
Iteration: 895, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508281350135803, gen p mean: -0.056697946041822433, mean p set: 0.4513084292411804
loss_pred:0.014878081157803535, decouple_loss:0.0013982229866087437
The modified gen p mean: 0.4493340849876404, gen p mean: -0.051835812628269196, mean p set: 0.4498143792152405
The modified gen p mean: 0.4498622715473175, gen p mean: -0.05116965249180794, mean p set: 0.4503425657749176
loss_pred:0.015092193149030209, decouple_loss:0.0014049296732991934
loss_pred:0.014805758371949196, decouple_loss:0.00140760641079396
Iteration: 896, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44861218333244324, gen p mean: -0.04958067834377289, mean p set: 0.4490925073623657
loss_pred:0.015184731222689152, decouple_loss:0.0015010582283139229
The modified gen p mean: 0.4487125277519226, gen p mean: -0.052734099328517914, mean p set: 0.4491928219795227The modified gen p mean: 0.449248343706131, gen p mean: -0.04995385557413101, mean p set: 0.44972866773605347
loss_pred:0.014282377436757088, decouple_loss:0.0015529969241470098
loss_pred:0.01504924800246954, decouple_loss:0.0015529193915426731
Iteration: 897, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45015162229537964, gen p mean: -0.050382912158966064, mean p set: 0.4506319463253021
loss_pred:0.014866788871586323, decouple_loss:0.0014064607676118612
The modified gen p mean: 0.4501456022262573, gen p mean: -0.05008814111351967, mean p set: 0.45062586665153503The modified gen p mean: 0.4504680633544922, gen p mean: -0.053672049194574356, mean p set: 0.4509483277797699
loss_pred:0.015390191227197647, decouple_loss:0.0014931537443771958
loss_pred:0.014523202553391457, decouple_loss:0.0013819087762385607
Iteration: 898, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502379894256592, gen p mean: -0.0512317419052124, mean p set: 0.4507182538509369
loss_pred:0.014474987983703613, decouple_loss:0.0014001026283949614
The modified gen p mean: 0.44958531856536865, gen p mean: -0.05159090831875801, mean p set: 0.45006564259529114The modified gen p mean: 0.4482152760028839, gen p mean: -0.05128655210137367, mean p set: 0.4486955404281616
loss_pred:0.014654277823865414, decouple_loss:0.001386465155519545
loss_pred:0.014830484986305237, decouple_loss:0.00155846297275275
Iteration: 899, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492187201976776, gen p mean: -0.04976779222488403, mean p set: 0.4496990144252777
loss_pred:0.015209859237074852, decouple_loss:0.001483236439526081
The modified gen p mean: 0.44872456789016724, gen p mean: -0.04916771873831749, mean p set: 0.4492048919200897The modified gen p mean: 0.4512348771095276, gen p mean: -0.047222673892974854, mean p set: 0.4517151713371277
loss_pred:0.014170181006193161, decouple_loss:0.0015003499574959278
loss_pred:0.014474974013864994, decouple_loss:0.0014708386734127998
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 900, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503428041934967, gen p mean: -0.049644120037555695, mean p set: 0.4508230984210968
loss_pred:0.014500279910862446, decouple_loss:0.00136973662301898
The modified gen p mean: 0.4507904052734375, gen p mean: -0.05020511895418167, mean p set: 0.45127072930336
The modified gen p mean: 0.44966641068458557, gen p mean: -0.04511527344584465, mean p set: 0.45014673471450806
loss_pred:0.014669593423604965, decouple_loss:0.0014072172343730927
loss_pred:0.014345240779221058, decouple_loss:0.0014589582569897175
2023-04-30 07:04:22 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04672376066446304, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04269343987107277, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04275276139378548, mean p set: 0.4500633478164673
loss_pred:0.019184498116374016, decouple_loss:0.0014222371391952038
loss_pred:0.01802372932434082, decouple_loss:0.0013742789160460234
loss_pred:0.01813236065208912, decouple_loss:0.0014001767849549651
WV_0_PC_1_EH_0_PS_40, loss: 0.01851680874824524, avg_mse: 0.02689269557595253
current test mse: 0.026893
Iteration: 901, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45044729113578796, gen p mean: -0.0402555987238884, mean p set: 0.45092761516571045
The modified gen p mean: 0.4496549367904663, gen p mean: -0.042464978992938995, mean p set: 0.450135201215744
The modified gen p mean: 0.4501035213470459, gen p mean: -0.05070905387401581, mean p set: 0.450583815574646
loss_pred:0.015025428496301174, decouple_loss:0.0013363573234528303
loss_pred:0.014116584323346615, decouple_loss:0.0014100511325523257loss_pred:0.01425223983824253, decouple_loss:0.0013947163242846727
Iteration: 902, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44868531823158264, gen p mean: -0.04217379912734032, mean p set: 0.4491656422615051
loss_pred:0.014474949799478054, decouple_loss:0.0014812012668699026
The modified gen p mean: 0.4494032561779022, gen p mean: -0.04126493260264397, mean p set: 0.44988352060317993
The modified gen p mean: 0.44969961047172546, gen p mean: -0.04307522624731064, mean p set: 0.45017993450164795
loss_pred:0.014374172315001488, decouple_loss:0.0014538553077727556
loss_pred:0.014134763740003109, decouple_loss:0.001525232451967895
Iteration: 903, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505953788757324, gen p mean: -0.04170848801732063, mean p set: 0.4510757029056549
loss_pred:0.0146193727850914, decouple_loss:0.0013852366246283054
The modified gen p mean: 0.44940632581710815, gen p mean: -0.043226808309555054, mean p set: 0.44988662004470825The modified gen p mean: 0.449353963136673, gen p mean: -0.04147442430257797, mean p set: 0.4498342275619507
loss_pred:0.013953614048659801, decouple_loss:0.0014062923146411777
loss_pred:0.014760088175535202, decouple_loss:0.0014014062471687794
Iteration: 904, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498880207538605, gen p mean: -0.04293037950992584, mean p set: 0.45036831498146057
loss_pred:0.014293109066784382, decouple_loss:0.0013985984260216355
The modified gen p mean: 0.4507772922515869, gen p mean: -0.04165688902139664, mean p set: 0.4512575566768646The modified gen p mean: 0.45008423924446106, gen p mean: -0.04672854393720627, mean p set: 0.45056453347206116
loss_pred:0.014842728152871132, decouple_loss:0.0014262201730161905
loss_pred:0.014041841961443424, decouple_loss:0.0013981502270326018
Iteration: 905, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502818286418915, gen p mean: -0.039544954895973206, mean p set: 0.4507621228694916
loss_pred:0.014579130336642265, decouple_loss:0.0014432440511882305
The modified gen p mean: 0.4493504762649536, gen p mean: -0.04445822164416313, mean p set: 0.4498307406902313The modified gen p mean: 0.45025718212127686, gen p mean: -0.04305970296263695, mean p set: 0.45073747634887695
loss_pred:0.013628430664539337, decouple_loss:0.0014012596802785993
loss_pred:0.014559851959347725, decouple_loss:0.0014962170971557498
Iteration: 906, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489012658596039, gen p mean: -0.043899863958358765, mean p set: 0.4493815302848816
loss_pred:0.014573559165000916, decouple_loss:0.0014269966632127762
The modified gen p mean: 0.4507172703742981, gen p mean: -0.04207782819867134, mean p set: 0.4511975646018982The modified gen p mean: 0.4498020112514496, gen p mean: -0.04357369244098663, mean p set: 0.4502823054790497
loss_pred:0.014211282134056091, decouple_loss:0.0013657963136211038
loss_pred:0.013912073336541653, decouple_loss:0.0014061835827305913
Iteration: 907, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491085708141327, gen p mean: -0.04189607501029968, mean p set: 0.4495888352394104
loss_pred:0.014104937203228474, decouple_loss:0.0013611471513286233
The modified gen p mean: 0.450380802154541, gen p mean: -0.04301277920603752, mean p set: 0.4508611261844635The modified gen p mean: 0.4493243396282196, gen p mean: -0.04380429536104202, mean p set: 0.4498046338558197
loss_pred:0.01434475090354681, decouple_loss:0.001443036599084735
loss_pred:0.014286157675087452, decouple_loss:0.0014497226802632213
Iteration: 908, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481290280818939, gen p mean: -0.04578711465001106, mean p set: 0.448609322309494
loss_pred:0.0145201925188303, decouple_loss:0.001359917689114809
The modified gen p mean: 0.45068731904029846, gen p mean: -0.04501332342624664, mean p set: 0.45116761326789856The modified gen p mean: 0.4505214989185333, gen p mean: -0.05150090157985687, mean p set: 0.4510018229484558
loss_pred:0.014667687006294727, decouple_loss:0.0012935271952301264
loss_pred:0.014933299273252487, decouple_loss:0.0014081792905926704
Iteration: 909, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495578706264496, gen p mean: -0.045060012489557266, mean p set: 0.4500381648540497
loss_pred:0.01371119823306799, decouple_loss:0.0012600751360878348
The modified gen p mean: 0.449350506067276, gen p mean: -0.04083796218037605, mean p set: 0.4498307704925537The modified gen p mean: 0.4499345123767853, gen p mean: -0.04130338504910469, mean p set: 0.4504148066043854
loss_pred:0.014159761369228363, decouple_loss:0.001266324776224792
loss_pred:0.014616693370044231, decouple_loss:0.0012408985057845712
Iteration: 910, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497264325618744, gen p mean: -0.04698146879673004, mean p set: 0.4502067267894745
The modified gen p mean: 0.44925618171691895, gen p mean: -0.046882301568984985, mean p set: 0.44973650574684143
loss_pred:0.014070576056838036, decouple_loss:0.0012505721533671021
loss_pred:0.014078556559979916, decouple_loss:0.001192232477478683
The modified gen p mean: 0.4497753381729126, gen p mean: -0.04382854327559471, mean p set: 0.4502556622028351
loss_pred:0.014404048211872578, decouple_loss:0.0012789887841790915
2023-04-30 07:06:16 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04693588986992836, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04269132763147354, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04299687221646309, mean p set: 0.4500633478164673
loss_pred:0.018951473757624626, decouple_loss:0.0012929413933306932
loss_pred:0.017890002578496933, decouple_loss:0.0013589560985565186
loss_pred:0.017989138141274452, decouple_loss:0.0012774694478139281
WV_0_PC_1_EH_0_PS_40, loss: 0.018342360854148865, avg_mse: 0.026619596406817436
current test mse: 0.02662
Iteration: 911, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019662380218506, gen p mean: -0.04114249348640442, mean p set: 0.45067691802978516
The modified gen p mean: 0.4496612548828125, gen p mean: -0.04870086535811424, mean p set: 0.4501415491104126
The modified gen p mean: 0.4489690959453583, gen p mean: -0.04437088221311569, mean p set: 0.44944941997528076
loss_pred:0.014107217080891132, decouple_loss:0.0012087738141417503
loss_pred:0.014730725437402725, decouple_loss:0.0013055894523859024loss_pred:0.013995417393743992, decouple_loss:0.001325138844549656
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
NaN value num: 0
Iteration: 912, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469752311706543, gen p mean: -0.0422915481030941, mean p set: 0.4474555552005768
loss_pred:0.019012290984392166, decouple_loss:0.0011924909194931388
The modified gen p mean: 0.4470379650592804, gen p mean: -0.04825819656252861, mean p set: 0.4475182592868805The modified gen p mean: 0.4471263885498047, gen p mean: -0.04350091889500618, mean p set: 0.4476066827774048
loss_pred:0.01872064732015133, decouple_loss:0.0012059645960107446
loss_pred:0.019145533442497253, decouple_loss:0.0012487575877457857
Iteration: 913, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478020966053009, gen p mean: -0.049517709761857986, mean p set: 0.4482823610305786
loss_pred:0.018313225358724594, decouple_loss:0.001314543653279543
The modified gen p mean: 0.44800689816474915, gen p mean: -0.04121779650449753, mean p set: 0.44848719239234924The modified gen p mean: 0.4477015435695648, gen p mean: -0.04441310837864876, mean p set: 0.4481818377971649
loss_pred:0.018689412623643875, decouple_loss:0.0012570179533213377
loss_pred:0.018527595326304436, decouple_loss:0.001261622877791524
Iteration: 914, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464642107486725, gen p mean: -0.04915953055024147, mean p set: 0.4469445049762726
loss_pred:0.018177740275859833, decouple_loss:0.001331330044195056
The modified gen p mean: 0.44664090871810913, gen p mean: -0.044589702039957047, mean p set: 0.44712120294570923The modified gen p mean: 0.44781437516212463, gen p mean: -0.04290120676159859, mean p set: 0.44829463958740234
loss_pred:0.01911242865025997, decouple_loss:0.0012322330148890615
loss_pred:0.018824024125933647, decouple_loss:0.001390054589137435
Iteration: 915, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470159113407135, gen p mean: -0.04543180391192436, mean p set: 0.4474962055683136
loss_pred:0.01861390843987465, decouple_loss:0.0013978980714455247
The modified gen p mean: 0.4454883337020874, gen p mean: -0.04447881504893303, mean p set: 0.4459685981273651The modified gen p mean: 0.4463730454444885, gen p mean: -0.04892634227871895, mean p set: 0.446853369474411
loss_pred:0.01827508583664894, decouple_loss:0.0013484683586284518
loss_pred:0.01831941492855549, decouple_loss:0.0013641590485349298
Iteration: 916, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484342038631439, gen p mean: -0.044231757521629333, mean p set: 0.448914498090744
loss_pred:0.01832803338766098, decouple_loss:0.001339961076155305
The modified gen p mean: 0.44673311710357666, gen p mean: -0.04791322350502014, mean p set: 0.44721341133117676
The modified gen p mean: 0.4464631974697113, gen p mean: -0.04285838454961777, mean p set: 0.4469434916973114
loss_pred:0.018231095746159554, decouple_loss:0.0013207768788561225
loss_pred:0.01861868053674698, decouple_loss:0.0012193185975775123
Iteration: 917, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741547107696533, gen p mean: -0.0501357726752758, mean p set: 0.44789573550224304
loss_pred:0.0184171199798584, decouple_loss:0.001199028454720974
The modified gen p mean: 0.4461911916732788, gen p mean: -0.04838653653860092, mean p set: 0.4466714859008789The modified gen p mean: 0.4461131691932678, gen p mean: -0.048615358769893646, mean p set: 0.4465934634208679
loss_pred:0.018040213733911514, decouple_loss:0.0011644514743238688
loss_pred:0.017598574981093407, decouple_loss:0.0012547667138278484
Iteration: 918, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460989236831665, gen p mean: -0.04621570184826851, mean p set: 0.4465792179107666
loss_pred:0.018263032659888268, decouple_loss:0.0012949741212651134
The modified gen p mean: 0.446698933839798, gen p mean: -0.05034946650266647, mean p set: 0.44717922806739807The modified gen p mean: 0.4471037983894348, gen p mean: -0.050396934151649475, mean p set: 0.4475840926170349
loss_pred:0.018569355830550194, decouple_loss:0.0012655528262257576
loss_pred:0.0177703108638525, decouple_loss:0.0012661176733672619
Iteration: 919, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794201850891113, gen p mean: -0.05361107364296913, mean p set: 0.44842231273651123
loss_pred:0.018613286316394806, decouple_loss:0.0012590137775987387
The modified gen p mean: 0.4464390277862549, gen p mean: -0.049339622259140015, mean p set: 0.4469192922115326The modified gen p mean: 0.44686761498451233, gen p mean: -0.05322278290987015, mean p set: 0.4473479390144348
loss_pred:0.019294926896691322, decouple_loss:0.0013462721835821867
loss_pred:0.018351612612605095, decouple_loss:0.0013536951737478375
Iteration: 920, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801345467567444, gen p mean: -0.05041911080479622, mean p set: 0.44849371910095215
The modified gen p mean: 0.44760680198669434, gen p mean: -0.05343565344810486, mean p set: 0.4480871260166168
loss_pred:0.01827574148774147, decouple_loss:0.0011506039882078767
loss_pred:0.017823737114667892, decouple_loss:0.0012213554000481963
The modified gen p mean: 0.4472610652446747, gen p mean: -0.04687263071537018, mean p set: 0.44774138927459717
loss_pred:0.018727630376815796, decouple_loss:0.0011619249125942588
2023-04-30 07:08:45 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05352894589304924, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04879045858979225, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04922766610980034, mean p set: 0.4500633478164673
loss_pred:0.018467532470822334, decouple_loss:0.0012737511424347758
loss_pred:0.017424488440155983, decouple_loss:0.0012488755164667964
loss_pred:0.017526919022202492, decouple_loss:0.001208992674946785
WV_0_PC_1_EH_0_PS_40, loss: 0.017868507653474808, avg_mse: 0.02563297562301159
current test mse: 0.025633
Iteration: 921, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44770678877830505, gen p mean: -0.052238594740629196, mean p set: 0.44818708300590515
The modified gen p mean: 0.44699329137802124, gen p mean: -0.059218522161245346, mean p set: 0.44747358560562134
The modified gen p mean: 0.44728416204452515, gen p mean: -0.054393522441387177, mean p set: 0.44776445627212524
loss_pred:0.01874125935137272, decouple_loss:0.0012154851574450731
loss_pred:0.01782870478928089, decouple_loss:0.0013072581496089697
loss_pred:0.017777683213353157, decouple_loss:0.0013282623840495944
Iteration: 922, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478701055049896, gen p mean: -0.05340833589434624, mean p set: 0.4483503997325897
loss_pred:0.017681971192359924, decouple_loss:0.0012258202768862247
The modified gen p mean: 0.4469386339187622, gen p mean: -0.04733695089817047, mean p set: 0.4474189281463623The modified gen p mean: 0.4473395347595215, gen p mean: -0.04922695830464363, mean p set: 0.4478198289871216
loss_pred:0.017521291971206665, decouple_loss:0.0011774038430303335
loss_pred:0.017984554171562195, decouple_loss:0.0012179194018244743
Iteration: 923, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460814893245697, gen p mean: -0.055021461099386215, mean p set: 0.4465617835521698
loss_pred:0.01741333305835724, decouple_loss:0.0012142057530581951
The modified gen p mean: 0.44737508893013, gen p mean: -0.05820883437991142, mean p set: 0.4478553533554077The modified gen p mean: 0.4456179440021515, gen p mean: -0.05091334134340286, mean p set: 0.446098268032074
loss_pred:0.01794147863984108, decouple_loss:0.0012502880999818444
loss_pred:0.018374664708971977, decouple_loss:0.001239523640833795
Iteration: 924, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478500783443451, gen p mean: -0.051033489406108856, mean p set: 0.4483303725719452
The modified gen p mean: 0.44642043113708496, gen p mean: -0.05155639350414276, mean p set: 0.44690072536468506
loss_pred:0.01802285946905613, decouple_loss:0.0012499727308750153
loss_pred:0.0176018588244915, decouple_loss:0.0013120024232193828
The modified gen p mean: 0.44679510593414307, gen p mean: -0.05290266126394272, mean p set: 0.44727540016174316
loss_pred:0.017828552052378654, decouple_loss:0.0012617985485121608
Iteration: 925, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791150093078613, gen p mean: -0.051215123385190964, mean p set: 0.44839179515838623
loss_pred:0.01763729937374592, decouple_loss:0.0011517420643940568
The modified gen p mean: 0.4472595155239105, gen p mean: -0.05129960924386978, mean p set: 0.4477398097515106The modified gen p mean: 0.4465689957141876, gen p mean: -0.048536207526922226, mean p set: 0.44704926013946533
loss_pred:0.018663877621293068, decouple_loss:0.0011303656501695514
loss_pred:0.01848495565354824, decouple_loss:0.0011918832315132022
Iteration: 926, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456441104412079, gen p mean: -0.048387560993433, mean p set: 0.4461243748664856
The modified gen p mean: 0.4476120173931122, gen p mean: -0.05240187421441078, mean p set: 0.4480923116207123
The modified gen p mean: 0.4459565281867981, gen p mean: -0.05218437686562538, mean p set: 0.4464368224143982
loss_pred:0.01771155372262001, decouple_loss:0.0012029786594212055
loss_pred:0.017726484686136246, decouple_loss:0.0011570585193112493
loss_pred:0.018140407279133797, decouple_loss:0.0012170025147497654
Iteration: 927, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479556977748871, gen p mean: -0.04671068117022514, mean p set: 0.4484359920024872
loss_pred:0.017598669975996017, decouple_loss:0.0011198781430721283
The modified gen p mean: 0.44780200719833374, gen p mean: -0.046249907463788986, mean p set: 0.44828227162361145The modified gen p mean: 0.44815319776535034, gen p mean: -0.0520685613155365, mean p set: 0.44863349199295044
loss_pred:0.017608536407351494, decouple_loss:0.0012062566820532084
loss_pred:0.018869102001190186, decouple_loss:0.0012211874127388
Iteration: 928, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44698628783226013, gen p mean: -0.05498262867331505, mean p set: 0.44746658205986023
The modified gen p mean: 0.44674113392829895, gen p mean: -0.047572676092386246, mean p set: 0.44722142815589905
loss_pred:0.018291641026735306, decouple_loss:0.0011749701807275414
loss_pred:0.018613476306200027, decouple_loss:0.0011633244575932622
The modified gen p mean: 0.4473837912082672, gen p mean: -0.04872964695096016, mean p set: 0.4478640854358673
loss_pred:0.01827053166925907, decouple_loss:0.0012061992892995477
Iteration: 929, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44826653599739075, gen p mean: -0.04775261878967285, mean p set: 0.44874683022499084
The modified gen p mean: 0.4462970495223999, gen p mean: -0.04167647287249565, mean p set: 0.44677734375
The modified gen p mean: 0.4477238655090332, gen p mean: -0.04632225260138512, mean p set: 0.4482041299343109
loss_pred:0.017667807638645172, decouple_loss:0.0012589789694175124
loss_pred:0.017742151394486427, decouple_loss:0.0013114565517753363
loss_pred:0.01736893132328987, decouple_loss:0.0012230861466377974
Iteration: 930, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44687533378601074, gen p mean: -0.04382621869444847, mean p set: 0.44735562801361084
The modified gen p mean: 0.4473097324371338, gen p mean: -0.04441330209374428, mean p set: 0.4477900266647339
loss_pred:0.017442163079977036, decouple_loss:0.0011442301329225302
loss_pred:0.017757859081029892, decouple_loss:0.0011684137862175703
The modified gen p mean: 0.4464874863624573, gen p mean: -0.04045036435127258, mean p set: 0.4469677805900574
loss_pred:0.01795284077525139, decouple_loss:0.0010714181698858738
2023-04-30 07:10:39 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04921157658100128, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04437214136123657, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0450701080262661, mean p set: 0.4500633478164673
loss_pred:0.018369294703006744, decouple_loss:0.0011895180214196444
loss_pred:0.017335696145892143, decouple_loss:0.001161712920293212
loss_pred:0.017393510788679123, decouple_loss:0.0011799102649092674
WV_0_PC_1_EH_0_PS_40, loss: 0.017758352681994438, avg_mse: 0.025425652042031288
current test mse: 0.025426
At step 930, Best test: 0.025426
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_model_test_schedule_sampling_DynaMean.ckpt
Iteration: 931, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486715495586395, gen p mean: -0.04784441366791725, mean p set: 0.44915181398391724
loss_pred:0.018310075625777245, decouple_loss:0.0012645337264984846
The modified gen p mean: 0.44809529185295105, gen p mean: -0.04593082517385483, mean p set: 0.44857561588287354The modified gen p mean: 0.44695407152175903, gen p mean: -0.044949423521757126, mean p set: 0.44743436574935913
loss_pred:0.01772652007639408, decouple_loss:0.001166969072073698
loss_pred:0.017168723046779633, decouple_loss:0.0012188296532258391
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 932, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795140624046326, gen p mean: -0.04763191193342209, mean p set: 0.44843170046806335
loss_pred:0.01452340092509985, decouple_loss:0.0012756709475070238
The modified gen p mean: 0.44881510734558105, gen p mean: -0.05088939517736435, mean p set: 0.44929543137550354The modified gen p mean: 0.4464145600795746, gen p mean: -0.053375378251075745, mean p set: 0.4468948543071747
loss_pred:0.014359883032739162, decouple_loss:0.0013967149425297976
loss_pred:0.014819028787314892, decouple_loss:0.0016230227192863822
Iteration: 933, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480031430721283, gen p mean: -0.04908588528633118, mean p set: 0.4484834671020508
The modified gen p mean: 0.4494439661502838, gen p mean: -0.05550087243318558, mean p set: 0.4499242305755615
loss_pred:0.01470262836664915, decouple_loss:0.0011433623731136322
loss_pred:0.014420667663216591, decouple_loss:0.0012405564775690436
The modified gen p mean: 0.44904133677482605, gen p mean: -0.054507385939359665, mean p set: 0.44952166080474854
loss_pred:0.014474339783191681, decouple_loss:0.0011609646026045084
Iteration: 934, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468289911746979, gen p mean: -0.05881761386990547, mean p set: 0.447309285402298
The modified gen p mean: 0.4466298222541809, gen p mean: -0.0543675497174263, mean p set: 0.447110116481781
loss_pred:0.013842647895216942, decouple_loss:0.0014072124613448977
loss_pred:0.014943864196538925, decouple_loss:0.0013047262327745557
The modified gen p mean: 0.448089063167572, gen p mean: -0.05303815379738808, mean p set: 0.4485693573951721
loss_pred:0.013919854536652565, decouple_loss:0.0013150338781997561
Iteration: 935, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466460347175598, gen p mean: -0.055658627301454544, mean p set: 0.4471263289451599
The modified gen p mean: 0.44856446981430054, gen p mean: -0.056556593626737595, mean p set: 0.44904476404190063
loss_pred:0.013648142106831074, decouple_loss:0.001374966581352055
loss_pred:0.014486636966466904, decouple_loss:0.0014270475367084146
The modified gen p mean: 0.44970178604125977, gen p mean: -0.054595205932855606, mean p set: 0.45018208026885986
loss_pred:0.0132251912727952, decouple_loss:0.0014744087820872664
Iteration: 936, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44891947507858276, gen p mean: -0.052958983927965164, mean p set: 0.44939976930618286
The modified gen p mean: 0.4475904405117035, gen p mean: -0.05821264535188675, mean p set: 0.4480707347393036
loss_pred:0.013908933848142624, decouple_loss:0.0017416032496839762
loss_pred:0.014775766059756279, decouple_loss:0.0015682996017858386
The modified gen p mean: 0.44793441891670227, gen p mean: -0.0513191819190979, mean p set: 0.44841471314430237
loss_pred:0.014278790913522243, decouple_loss:0.0014555518282577395
Iteration: 937, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475768804550171, gen p mean: -0.05717964842915535, mean p set: 0.4480571746826172
loss_pred:0.013752381317317486, decouple_loss:0.0017384501406922936
The modified gen p mean: 0.44691556692123413, gen p mean: -0.05445702373981476, mean p set: 0.4473958909511566The modified gen p mean: 0.4471645653247833, gen p mean: -0.053289223462343216, mean p set: 0.4476448595523834
loss_pred:0.013789902441203594, decouple_loss:0.0018121239263564348
loss_pred:0.01395332906395197, decouple_loss:0.001731982221826911
Iteration: 938, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477677047252655, gen p mean: -0.05537726730108261, mean p set: 0.4482479691505432
The modified gen p mean: 0.4485396146774292, gen p mean: -0.05334063991904259, mean p set: 0.4490198791027069
loss_pred:0.013788227923214436, decouple_loss:0.0014377315528690815
loss_pred:0.014108105562627316, decouple_loss:0.001447223825380206
The modified gen p mean: 0.44702863693237305, gen p mean: -0.05554843321442604, mean p set: 0.44750893115997314
loss_pred:0.013237671926617622, decouple_loss:0.0014350446872413158
Iteration: 939, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44588345289230347, gen p mean: -0.050298526883125305, mean p set: 0.44636374711990356
loss_pred:0.013269435614347458, decouple_loss:0.0018265802646055818
The modified gen p mean: 0.44614341855049133, gen p mean: -0.05244138836860657, mean p set: 0.4466237425804138The modified gen p mean: 0.4495560824871063, gen p mean: -0.04962095990777016, mean p set: 0.4500364065170288
loss_pred:0.013224806636571884, decouple_loss:0.0017991936765611172
loss_pred:0.01319021638482809, decouple_loss:0.0017269446980208158
Iteration: 940, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448035329580307, gen p mean: -0.04836702719330788, mean p set: 0.4485156238079071
The modified gen p mean: 0.4501623511314392, gen p mean: -0.05071564391255379, mean p set: 0.4506426155567169
loss_pred:0.012891401536762714, decouple_loss:0.0017002056119963527
loss_pred:0.012935367412865162, decouple_loss:0.00201625213958323
The modified gen p mean: 0.4484303593635559, gen p mean: -0.04754510521888733, mean p set: 0.4489106833934784
loss_pred:0.013625155203044415, decouple_loss:0.0018340969691053033
2023-04-30 07:13:15 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04794871062040329, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04388461634516716, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.044436659663915634, mean p set: 0.4500633478164673
loss_pred:0.019400188699364662, decouple_loss:0.0022196245845407248
loss_pred:0.018227005377411842, decouple_loss:0.0024290524888783693
loss_pred:0.018431533128023148, decouple_loss:0.002300573978573084
WV_0_PC_1_EH_0_PS_40, loss: 0.018802063539624214, avg_mse: 0.027300896123051643
current test mse: 0.027301
Iteration: 941, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762858748435974, gen p mean: -0.04399624094367027, mean p set: 0.4481089115142822
The modified gen p mean: 0.44617778062820435, gen p mean: -0.04538014531135559, mean p set: 0.44665804505348206
The modified gen p mean: 0.4480734169483185, gen p mean: -0.04353928938508034, mean p set: 0.4485537111759186
loss_pred:0.014181858859956264, decouple_loss:0.0021915531251579523
loss_pred:0.013938800431787968, decouple_loss:0.0022408964578062296loss_pred:0.013155529275536537, decouple_loss:0.0024564459454268217
Iteration: 942, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474222660064697, gen p mean: -0.04780452325940132, mean p set: 0.4479025602340698
loss_pred:0.013031790032982826, decouple_loss:0.0020948578603565693
The modified gen p mean: 0.44753527641296387, gen p mean: -0.04224251210689545, mean p set: 0.4480155408382416
The modified gen p mean: 0.44812512397766113, gen p mean: -0.04196270927786827, mean p set: 0.44860541820526123
loss_pred:0.013293364085257053, decouple_loss:0.002304334193468094
loss_pred:0.014300812967121601, decouple_loss:0.0020540596451610327
Iteration: 943, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483294188976288, gen p mean: -0.040276605635881424, mean p set: 0.4488097131252289
loss_pred:0.013409237377345562, decouple_loss:0.0017379969358444214
The modified gen p mean: 0.44784078001976013, gen p mean: -0.04136307165026665, mean p set: 0.44832107424736023The modified gen p mean: 0.4472527801990509, gen p mean: -0.04135962575674057, mean p set: 0.4477330446243286
loss_pred:0.013957446441054344, decouple_loss:0.0018612055573612452
loss_pred:0.013183319009840488, decouple_loss:0.0019092692527920008
Iteration: 944, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470553696155548, gen p mean: -0.04315710812807083, mean p set: 0.4475356340408325
loss_pred:0.01300047803670168, decouple_loss:0.001960889669135213
The modified gen p mean: 0.44678202271461487, gen p mean: -0.03667239472270012, mean p set: 0.44726231694221497The modified gen p mean: 0.4482189118862152, gen p mean: -0.037280816584825516, mean p set: 0.4486992359161377
loss_pred:0.013395204208791256, decouple_loss:0.002190829487517476
loss_pred:0.013965079560875893, decouple_loss:0.001964922994375229
Iteration: 945, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479919672012329, gen p mean: -0.03948020190000534, mean p set: 0.448472261428833
loss_pred:0.012662957422435284, decouple_loss:0.0018789253663271666
The modified gen p mean: 0.4491856098175049, gen p mean: -0.041457295417785645, mean p set: 0.449665904045105The modified gen p mean: 0.4476761221885681, gen p mean: -0.038851603865623474, mean p set: 0.4481564164161682
loss_pred:0.013082610443234444, decouple_loss:0.0018793086055666208
loss_pred:0.012643588706851006, decouple_loss:0.0017915702192112803
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 946, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44852301478385925, gen p mean: -0.040571361780166626, mean p set: 0.44900330901145935
The modified gen p mean: 0.4483628273010254, gen p mean: -0.04258798807859421, mean p set: 0.4488431215286255
loss_pred:0.01278614904731512, decouple_loss:0.0016559490468353033
loss_pred:0.012774810194969177, decouple_loss:0.001662378548644483
The modified gen p mean: 0.44771867990493774, gen p mean: -0.042936258018016815, mean p set: 0.44819900393486023
loss_pred:0.012917013838887215, decouple_loss:0.001653769169934094
Iteration: 947, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468879699707031, gen p mean: -0.042703334242105484, mean p set: 0.447368323802948
loss_pred:0.01299053430557251, decouple_loss:0.00180097296833992
The modified gen p mean: 0.4492429792881012, gen p mean: -0.04284484311938286, mean p set: 0.4497232735157013The modified gen p mean: 0.4468555450439453, gen p mean: -0.04408121109008789, mean p set: 0.4473358392715454
loss_pred:0.012796631082892418, decouple_loss:0.001967170974239707
loss_pred:0.012908762320876122, decouple_loss:0.0017054642084985971
Iteration: 948, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474042057991028, gen p mean: -0.045860860496759415, mean p set: 0.4478845000267029
The modified gen p mean: 0.4482412040233612, gen p mean: -0.04529751464724541, mean p set: 0.4487214982509613loss_pred:0.012901308946311474, decouple_loss:0.0014989922055974603
The modified gen p mean: 0.4477846324443817, gen p mean: -0.044222641736269, mean p set: 0.4482649564743042
loss_pred:0.013095567002892494, decouple_loss:0.0015156475128605962
loss_pred:0.013134905137121677, decouple_loss:0.0014828033745288849
Iteration: 949, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447710245847702, gen p mean: -0.04121815413236618, mean p set: 0.4481905400753021
The modified gen p mean: 0.4482154846191406, gen p mean: -0.042738206684589386, mean p set: 0.44869574904441833
The modified gen p mean: 0.4483945965766907, gen p mean: -0.04074542596936226, mean p set: 0.4488748610019684
loss_pred:0.013105785474181175, decouple_loss:0.001525028725154698
loss_pred:0.013387090526521206, decouple_loss:0.0015020291320979595
loss_pred:0.013127072714269161, decouple_loss:0.0015364413848146796
Iteration: 950, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500880539417267, gen p mean: -0.043250102549791336, mean p set: 0.4505683481693268
loss_pred:0.01249984186142683, decouple_loss:0.001572091830894351
The modified gen p mean: 0.44707077741622925, gen p mean: -0.044014785438776016, mean p set: 0.44755110144615173The modified gen p mean: 0.4471322298049927, gen p mean: -0.044767241925001144, mean p set: 0.4476125240325928
loss_pred:0.013204529881477356, decouple_loss:0.0015254543395712972
loss_pred:0.012897356413304806, decouple_loss:0.0018623315263539553
2023-04-30 07:15:10 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04399850219488144, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.039618026465177536, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04031836986541748, mean p set: 0.4500633478164673
loss_pred:0.01930941268801689, decouple_loss:0.0015159996692091227
loss_pred:0.018148738890886307, decouple_loss:0.0015752364415675402
loss_pred:0.01834229566156864, decouple_loss:0.001551724737510085
WV_0_PC_1_EH_0_PS_40, loss: 0.01867753267288208, avg_mse: 0.027224965393543243
current test mse: 0.027225
Iteration: 951, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478377103805542, gen p mean: -0.04694623127579689, mean p set: 0.4483180344104767
The modified gen p mean: 0.447005033493042, gen p mean: -0.04513969644904137, mean p set: 0.4474853575229645
The modified gen p mean: 0.4482479393482208, gen p mean: -0.04203309491276741, mean p set: 0.4487282633781433
loss_pred:0.012662813998758793, decouple_loss:0.0014868424041196704
loss_pred:0.013810195028781891, decouple_loss:0.0015072933165356517
loss_pred:0.013133284635841846, decouple_loss:0.001566469669342041
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
NaN value num: 0
Iteration: 952, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501437544822693, gen p mean: -0.03238597512245178, mean p set: 0.4506239891052246
loss_pred:0.017974909394979477, decouple_loss:0.0018566374201327562
The modified gen p mean: 0.45019397139549255, gen p mean: -0.02921573631465435, mean p set: 0.45067429542541504The modified gen p mean: 0.45013922452926636, gen p mean: -0.032653771340847015, mean p set: 0.45061951875686646
loss_pred:0.0180800948292017, decouple_loss:0.0016656259540468454
loss_pred:0.018141550943255424, decouple_loss:0.001873288187198341
Iteration: 953, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860726594924927, gen p mean: -0.02667211927473545, mean p set: 0.44908758997917175
loss_pred:0.018627407029271126, decouple_loss:0.0016906318487599492
The modified gen p mean: 0.45127686858177185, gen p mean: -0.024593587964773178, mean p set: 0.45175716280937195The modified gen p mean: 0.4495130479335785, gen p mean: -0.030217280611395836, mean p set: 0.4499933123588562
loss_pred:0.017678380012512207, decouple_loss:0.0016450599068775773
loss_pred:0.018187085166573524, decouple_loss:0.0016875611618161201
Iteration: 954, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44889456033706665, gen p mean: -0.028819642961025238, mean p set: 0.44937488436698914
loss_pred:0.017595192417502403, decouple_loss:0.0017814469756558537
The modified gen p mean: 0.44997742772102356, gen p mean: -0.02598348818719387, mean p set: 0.45045775175094604
The modified gen p mean: 0.45103394985198975, gen p mean: -0.02878246270120144, mean p set: 0.45151427388191223
loss_pred:0.017487671226263046, decouple_loss:0.0017452810425311327
loss_pred:0.01877569407224655, decouple_loss:0.001638021320104599
Iteration: 955, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44897350668907166, gen p mean: -0.028982704505324364, mean p set: 0.44945380091667175
loss_pred:0.01778387278318405, decouple_loss:0.0016043336363509297
The modified gen p mean: 0.4508129358291626, gen p mean: -0.03133353590965271, mean p set: 0.4512932300567627The modified gen p mean: 0.4482422471046448, gen p mean: -0.02391943894326687, mean p set: 0.4487225413322449
loss_pred:0.017134368419647217, decouple_loss:0.0016366086201742291
loss_pred:0.017410356551408768, decouple_loss:0.0016857340233400464
Iteration: 956, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44985517859458923, gen p mean: -0.03510414808988571, mean p set: 0.45033547282218933
loss_pred:0.017803259193897247, decouple_loss:0.0017812075093388557
The modified gen p mean: 0.44992145895957947, gen p mean: -0.02966831438243389, mean p set: 0.45040175318717957The modified gen p mean: 0.44940176606178284, gen p mean: -0.0315491259098053, mean p set: 0.4498820900917053
loss_pred:0.017421388998627663, decouple_loss:0.0017047130968421698
loss_pred:0.017243079841136932, decouple_loss:0.001516766962595284
Iteration: 957, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44983842968940735, gen p mean: -0.03047705441713333, mean p set: 0.45031872391700745
loss_pred:0.017439795657992363, decouple_loss:0.0015238717896863818
The modified gen p mean: 0.44822803139686584, gen p mean: -0.025616323575377464, mean p set: 0.44870832562446594
The modified gen p mean: 0.4485991299152374, gen p mean: -0.030219487845897675, mean p set: 0.4490794241428375
loss_pred:0.018128283321857452, decouple_loss:0.0016840649768710136
loss_pred:0.017763568088412285, decouple_loss:0.0015191020211204886
Iteration: 958, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498642385005951, gen p mean: -0.04022449254989624, mean p set: 0.4503445625305176
loss_pred:0.017635522410273552, decouple_loss:0.001588460523635149
The modified gen p mean: 0.4488689601421356, gen p mean: -0.0348181277513504, mean p set: 0.4493492543697357The modified gen p mean: 0.45010191202163696, gen p mean: -0.03555717319250107, mean p set: 0.45058220624923706
loss_pred:0.017585832625627518, decouple_loss:0.0014112084172666073
loss_pred:0.017704438418149948, decouple_loss:0.0014428331051021814
Iteration: 959, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503362476825714, gen p mean: -0.027677826583385468, mean p set: 0.4508165121078491
loss_pred:0.01728964038193226, decouple_loss:0.0014331014826893806
The modified gen p mean: 0.44882988929748535, gen p mean: -0.030472280457615852, mean p set: 0.44931018352508545The modified gen p mean: 0.4509466290473938, gen p mean: -0.02808401547372341, mean p set: 0.4514269232749939
loss_pred:0.0177910253405571, decouple_loss:0.0014122319407761097
loss_pred:0.01777908205986023, decouple_loss:0.0016175565542653203
Iteration: 960, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511813223361969, gen p mean: -0.03252899646759033, mean p set: 0.451661616563797
loss_pred:0.018050137907266617, decouple_loss:0.0013721726136282086
The modified gen p mean: 0.451181560754776, gen p mean: -0.036414749920368195, mean p set: 0.4516618549823761The modified gen p mean: 0.4501728117465973, gen p mean: -0.03665928915143013, mean p set: 0.4506531357765198
loss_pred:0.017375919967889786, decouple_loss:0.0013873310526832938
loss_pred:0.017426947131752968, decouple_loss:0.0014702705666422844
2023-04-30 07:17:39 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04422461614012718, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04025569558143616, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04079951345920563, mean p set: 0.4500633478164673
loss_pred:0.01857186295092106, decouple_loss:0.0016827654326334596
loss_pred:0.017431408166885376, decouple_loss:0.0015081189339980483
loss_pred:0.017647139728069305, decouple_loss:0.001554672373458743
WV_0_PC_1_EH_0_PS_40, loss: 0.017962563782930374, avg_mse: 0.025790728628635406
current test mse: 0.025791
Iteration: 961, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502236843109131, gen p mean: -0.04136602208018303, mean p set: 0.4507039785385132
The modified gen p mean: 0.450810045003891, gen p mean: -0.0364704392850399, mean p set: 0.4512903094291687
loss_pred:0.017069591209292412, decouple_loss:0.001408647163771093
The modified gen p mean: 0.44987753033638, gen p mean: -0.04424336925148964, mean p set: 0.4503578245639801
loss_pred:0.017826227471232414, decouple_loss:0.0014179341960698366
loss_pred:0.017848189920186996, decouple_loss:0.0016116074984893203
Iteration: 962, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508385956287384, gen p mean: -0.034446727484464645, mean p set: 0.4513188898563385
The modified gen p mean: 0.44998276233673096, gen p mean: -0.03425951674580574, mean p set: 0.45046308636665344
loss_pred:0.017425216734409332, decouple_loss:0.0014947907766327262
loss_pred:0.017162088304758072, decouple_loss:0.0014990117633715272
The modified gen p mean: 0.450148344039917, gen p mean: -0.03416856378316879, mean p set: 0.4506286382675171
loss_pred:0.01688305474817753, decouple_loss:0.0014004153199493885
Iteration: 963, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499850869178772, gen p mean: -0.03592713549733162, mean p set: 0.4504653811454773
The modified gen p mean: 0.4498046040534973, gen p mean: -0.030751751735806465, mean p set: 0.4502848982810974
The modified gen p mean: 0.4501136243343353, gen p mean: -0.03008892387151718, mean p set: 0.4505939483642578
loss_pred:0.016817891970276833, decouple_loss:0.001231087138876319
loss_pred:0.017277944833040237, decouple_loss:0.0013050965499132872loss_pred:0.017446858808398247, decouple_loss:0.001302311196923256
Iteration: 964, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44883400201797485, gen p mean: -0.032472338527441025, mean p set: 0.44931429624557495
loss_pred:0.01795496977865696, decouple_loss:0.0013222654815763235
The modified gen p mean: 0.45004984736442566, gen p mean: -0.03863286226987839, mean p set: 0.45053014159202576The modified gen p mean: 0.4482896029949188, gen p mean: -0.03659319877624512, mean p set: 0.4487698972225189
loss_pred:0.0180007703602314, decouple_loss:0.0012777228839695454
loss_pred:0.016983339563012123, decouple_loss:0.0013508796691894531
Iteration: 965, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45036405324935913, gen p mean: -0.041386380791664124, mean p set: 0.4508443772792816
The modified gen p mean: 0.45075955986976624, gen p mean: -0.0422823503613472, mean p set: 0.4512398838996887
loss_pred:0.016988907009363174, decouple_loss:0.0013561273226514459
loss_pred:0.01800791546702385, decouple_loss:0.0013229722389951348
The modified gen p mean: 0.4502759873867035, gen p mean: -0.03640426695346832, mean p set: 0.4507562518119812
loss_pred:0.01752912998199463, decouple_loss:0.001272281282581389
Iteration: 966, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509267508983612, gen p mean: -0.03670168295502663, mean p set: 0.4514070451259613
loss_pred:0.01802481710910797, decouple_loss:0.0012899735011160374
The modified gen p mean: 0.4485201835632324, gen p mean: -0.03666997700929642, mean p set: 0.4490005075931549The modified gen p mean: 0.4504992663860321, gen p mean: -0.04346395283937454, mean p set: 0.4509795904159546
loss_pred:0.017546214163303375, decouple_loss:0.0012619515182450414
loss_pred:0.017100434750318527, decouple_loss:0.0012232341105118394
Iteration: 967, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44945964217185974, gen p mean: -0.04523922875523567, mean p set: 0.44993993639945984
The modified gen p mean: 0.44957005977630615, gen p mean: -0.042408183217048645, mean p set: 0.45005032420158386
The modified gen p mean: 0.4495947062969208, gen p mean: -0.04465329274535179, mean p set: 0.4500750005245209
loss_pred:0.01781371608376503, decouple_loss:0.0012340991524979472
loss_pred:0.01681002974510193, decouple_loss:0.0011849509319290519loss_pred:0.01762247644364834, decouple_loss:0.0011676547583192587
Iteration: 968, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860315322875977, gen p mean: -0.03924160823225975, mean p set: 0.44908347725868225
The modified gen p mean: 0.45016369223594666, gen p mean: -0.03965075686573982, mean p set: 0.45064401626586914
loss_pred:0.01705230586230755, decouple_loss:0.0011822977103292942
The modified gen p mean: 0.44861555099487305, gen p mean: -0.04215840622782707, mean p set: 0.44909584522247314
loss_pred:0.017179565504193306, decouple_loss:0.0011101666605100036
loss_pred:0.01711881347000599, decouple_loss:0.0011843512766063213
Iteration: 969, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488926827907562, gen p mean: -0.03995269909501076, mean p set: 0.44937294721603394
The modified gen p mean: 0.44935667514801025, gen p mean: -0.038375429809093475, mean p set: 0.44983693957328796
loss_pred:0.016671624034643173, decouple_loss:0.0011211801320314407
loss_pred:0.01757882721722126, decouple_loss:0.0011493705678731203
The modified gen p mean: 0.45019635558128357, gen p mean: -0.04300786554813385, mean p set: 0.45067667961120605
loss_pred:0.016794392839074135, decouple_loss:0.0012175556039437652
Iteration: 970, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483577311038971, gen p mean: -0.03559921309351921, mean p set: 0.4488380551338196
loss_pred:0.017279986292123795, decouple_loss:0.0011691992403939366
The modified gen p mean: 0.45051082968711853, gen p mean: -0.03680916875600815, mean p set: 0.45099109411239624The modified gen p mean: 0.45031073689460754, gen p mean: -0.03822968155145645, mean p set: 0.45079106092453003
loss_pred:0.016934523358941078, decouple_loss:0.0011743721552193165
loss_pred:0.016843998804688454, decouple_loss:0.0011476274812594056
2023-04-30 07:19:33 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04148401319980621, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.037148479372262955, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.037795793265104294, mean p set: 0.4500633478164673
loss_pred:0.0184960775077343, decouple_loss:0.0015529984375461936
loss_pred:0.017377397045493126, decouple_loss:0.0013715637614950538
loss_pred:0.017564935609698296, decouple_loss:0.0014707681257277727
WV_0_PC_1_EH_0_PS_40, loss: 0.01788606122136116, avg_mse: 0.025677023455500603
current test mse: 0.025677
Iteration: 971, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45033565163612366, gen p mean: -0.035225801169872284, mean p set: 0.45081597566604614
The modified gen p mean: 0.45056435465812683, gen p mean: -0.038334302604198456, mean p set: 0.45104461908340454
The modified gen p mean: 0.4490130841732025, gen p mean: -0.035462357103824615, mean p set: 0.449493408203125
loss_pred:0.017317116260528564, decouple_loss:0.0011567893670871854
loss_pred:0.017042726278305054, decouple_loss:0.0010822763433679938loss_pred:0.017255064100027084, decouple_loss:0.0011520648840814829
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
NaN value num: 0
Iteration: 972, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44956880807876587, gen p mean: -0.025681763887405396, mean p set: 0.45004913210868835
loss_pred:0.018037650734186172, decouple_loss:0.0013738946290686727
The modified gen p mean: 0.44890713691711426, gen p mean: -0.030332427471876144, mean p set: 0.44938743114471436The modified gen p mean: 0.4492603838443756, gen p mean: -0.0325687900185585, mean p set: 0.4497406780719757
loss_pred:0.016929395496845245, decouple_loss:0.0012030031066387892
loss_pred:0.016644682735204697, decouple_loss:0.001230932306498289
Iteration: 973, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495984613895416, gen p mean: -0.03211973235011101, mean p set: 0.4500787556171417
The modified gen p mean: 0.4491286873817444, gen p mean: -0.030031176283955574, mean p set: 0.4496089518070221
loss_pred:0.017974602058529854, decouple_loss:0.001217487151734531
loss_pred:0.018284589052200317, decouple_loss:0.0014785337261855602
The modified gen p mean: 0.44844138622283936, gen p mean: -0.02870171330869198, mean p set: 0.44892165064811707
loss_pred:0.01755440980195999, decouple_loss:0.0013408968225121498
Iteration: 974, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482678472995758, gen p mean: -0.030801136046648026, mean p set: 0.4487481415271759
The modified gen p mean: 0.4502372443675995, gen p mean: -0.03116719238460064, mean p set: 0.4507175385951996
loss_pred:0.017698116600513458, decouple_loss:0.0012226904509589076
loss_pred:0.017399253323674202, decouple_loss:0.0013013811549171805
The modified gen p mean: 0.4510059058666229, gen p mean: -0.02882060594856739, mean p set: 0.45148617029190063
loss_pred:0.01795940473675728, decouple_loss:0.0012672438751906157
Iteration: 975, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484226107597351, gen p mean: -0.033951468765735626, mean p set: 0.4489029347896576
loss_pred:0.016311276704072952, decouple_loss:0.0013433900894597173
The modified gen p mean: 0.4504856467247009, gen p mean: -0.028521418571472168, mean p set: 0.450965940952301The modified gen p mean: 0.4492291510105133, gen p mean: -0.03357350081205368, mean p set: 0.4497094452381134
loss_pred:0.0179964117705822, decouple_loss:0.0013500325148925185
loss_pred:0.017291048541665077, decouple_loss:0.0012851409846916795
Iteration: 976, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520019292831421, gen p mean: -0.03903956711292267, mean p set: 0.4524822235107422
The modified gen p mean: 0.4528867304325104, gen p mean: -0.03854778781533241, mean p set: 0.4533670246601105
loss_pred:0.017535246908664703, decouple_loss:0.0012227011611685157
loss_pred:0.01767554320394993, decouple_loss:0.0012173464056104422
The modified gen p mean: 0.45053184032440186, gen p mean: -0.037015400826931, mean p set: 0.45101216435432434
loss_pred:0.01707526296377182, decouple_loss:0.0011842246167361736
Iteration: 977, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44913262128829956, gen p mean: -0.04457542672753334, mean p set: 0.44961294531822205
loss_pred:0.017241518944501877, decouple_loss:0.0012535047717392445
The modified gen p mean: 0.4490913152694702, gen p mean: -0.04306510463356972, mean p set: 0.4495715796947479The modified gen p mean: 0.449121356010437, gen p mean: -0.04487098753452301, mean p set: 0.4496016502380371
loss_pred:0.017330719158053398, decouple_loss:0.0012009463971480727
loss_pred:0.017597606405615807, decouple_loss:0.001252872054465115
Iteration: 978, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44994911551475525, gen p mean: -0.04818045347929001, mean p set: 0.45042943954467773
The modified gen p mean: 0.44902944564819336, gen p mean: -0.045707494020462036, mean p set: 0.4495096802711487
loss_pred:0.017438305541872978, decouple_loss:0.0012403960572555661
loss_pred:0.01756446436047554, decouple_loss:0.001235754694789648
The modified gen p mean: 0.448651522397995, gen p mean: -0.04796505346894264, mean p set: 0.4491318166255951
loss_pred:0.016366595402359962, decouple_loss:0.0012912967940792441
Iteration: 979, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490957260131836, gen p mean: -0.052835553884506226, mean p set: 0.4495759904384613
loss_pred:0.018149718642234802, decouple_loss:0.0011449471348896623
The modified gen p mean: 0.44978469610214233, gen p mean: -0.05052068084478378, mean p set: 0.45026499032974243The modified gen p mean: 0.45114290714263916, gen p mean: -0.05000782757997513, mean p set: 0.45162320137023926
loss_pred:0.016329819336533546, decouple_loss:0.0011507462477311492
loss_pred:0.017416035756468773, decouple_loss:0.001291749649681151
Iteration: 980, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484596252441406, gen p mean: -0.050132982432842255, mean p set: 0.4489399194717407
The modified gen p mean: 0.44974204897880554, gen p mean: -0.051096584647893906, mean p set: 0.450222373008728
loss_pred:0.016405347734689713, decouple_loss:0.0012154304422438145
loss_pred:0.017208684235811234, decouple_loss:0.0012307018041610718
The modified gen p mean: 0.45058462023735046, gen p mean: -0.05826548486948013, mean p set: 0.45106494426727295
loss_pred:0.017174415290355682, decouple_loss:0.0012418940896168351
2023-04-30 07:22:03 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0598270557820797, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05536342039704323, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05611107498407364, mean p set: 0.4500633478164673
loss_pred:0.018474385142326355, decouple_loss:0.0013026674278080463
loss_pred:0.01732465997338295, decouple_loss:0.0012384719448164105
loss_pred:0.017538955435156822, decouple_loss:0.0012762832920998335
WV_0_PC_1_EH_0_PS_40, loss: 0.017842959612607956, avg_mse: 0.025602266192436218
current test mse: 0.025602
Iteration: 981, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45107409358024597, gen p mean: -0.04260360449552536, mean p set: 0.4515543580055237
The modified gen p mean: 0.4486089050769806, gen p mean: -0.04833410680294037, mean p set: 0.4490891993045807
The modified gen p mean: 0.4504956901073456, gen p mean: -0.04905332624912262, mean p set: 0.45097601413726807
loss_pred:0.017934538424015045, decouple_loss:0.0012282530078664422
loss_pred:0.01811990514397621, decouple_loss:0.0013035181909799576
loss_pred:0.01764799654483795, decouple_loss:0.0012805230217054486
Iteration: 982, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832563400268555, gen p mean: -0.05026015639305115, mean p set: 0.44880592823028564
loss_pred:0.01682949811220169, decouple_loss:0.0012545555364340544
The modified gen p mean: 0.45174384117126465, gen p mean: -0.04634018987417221, mean p set: 0.45222410559654236The modified gen p mean: 0.4489806890487671, gen p mean: -0.05088639631867409, mean p set: 0.4494609236717224
loss_pred:0.017877569422125816, decouple_loss:0.0013157144421711564
loss_pred:0.017375607043504715, decouple_loss:0.001293887966312468
Iteration: 983, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497857987880707, gen p mean: -0.05229157954454422, mean p set: 0.4502660930156708
The modified gen p mean: 0.45077425241470337, gen p mean: -0.04663782939314842, mean p set: 0.45125457644462585
loss_pred:0.01703428477048874, decouple_loss:0.0011474768398329616
loss_pred:0.017294147983193398, decouple_loss:0.0011257156729698181
The modified gen p mean: 0.45049893856048584, gen p mean: -0.04809275269508362, mean p set: 0.45097923278808594
loss_pred:0.01694079488515854, decouple_loss:0.001097965519875288
Iteration: 984, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512256383895874, gen p mean: -0.0462254136800766, mean p set: 0.4517059326171875
The modified gen p mean: 0.4517269432544708, gen p mean: -0.0426132008433342, mean p set: 0.45220720767974854
loss_pred:0.01819222792983055, decouple_loss:0.0013038591714575887
loss_pred:0.01764531619846821, decouple_loss:0.0013466523960232735
The modified gen p mean: 0.4498249292373657, gen p mean: -0.048044603317976, mean p set: 0.45030519366264343
loss_pred:0.016914600506424904, decouple_loss:0.0013032034039497375
Iteration: 985, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44971194863319397, gen p mean: -0.04840104654431343, mean p set: 0.4501922130584717
The modified gen p mean: 0.4528255760669708, gen p mean: -0.04404909908771515, mean p set: 0.45330584049224854
The modified gen p mean: 0.44957685470581055, gen p mean: -0.05258295312523842, mean p set: 0.45005717873573303loss_pred:0.01700141653418541, decouple_loss:0.001107987598516047
loss_pred:0.01805303245782852, decouple_loss:0.0011562310392037034
loss_pred:0.017223646864295006, decouple_loss:0.0010679493425413966
Iteration: 986, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45325762033462524, gen p mean: -0.045839786529541016, mean p set: 0.45373791456222534
loss_pred:0.018194297328591347, decouple_loss:0.001253392081707716
The modified gen p mean: 0.4488903284072876, gen p mean: -0.04649949446320534, mean p set: 0.4493706524372101
The modified gen p mean: 0.44866570830345154, gen p mean: -0.0437263660132885, mean p set: 0.44914600253105164
loss_pred:0.017037663608789444, decouple_loss:0.001246787142008543
loss_pred:0.017623767256736755, decouple_loss:0.0011810350697487593
Iteration: 987, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45099177956581116, gen p mean: -0.039333444088697433, mean p set: 0.45147207379341125
loss_pred:0.018000029027462006, decouple_loss:0.0011345123639330268
The modified gen p mean: 0.4524902403354645, gen p mean: -0.04907327890396118, mean p set: 0.4529705345630646The modified gen p mean: 0.45101234316825867, gen p mean: -0.04514598101377487, mean p set: 0.45149263739585876
loss_pred:0.016708509996533394, decouple_loss:0.0011489097960293293
loss_pred:0.017132144421339035, decouple_loss:0.0011778714833781123
Iteration: 988, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45079657435417175, gen p mean: -0.0464412122964859, mean p set: 0.45127683877944946
loss_pred:0.016912367194890976, decouple_loss:0.0011593532981351018
The modified gen p mean: 0.4508938789367676, gen p mean: -0.0452096052467823, mean p set: 0.4513741731643677The modified gen p mean: 0.4511186480522156, gen p mean: -0.043777935206890106, mean p set: 0.4515989124774933
loss_pred:0.01813516393303871, decouple_loss:0.0012941216118633747
loss_pred:0.017375022172927856, decouple_loss:0.0012081506429240108
Iteration: 989, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45146024227142334, gen p mean: -0.0372563898563385, mean p set: 0.45194050669670105
loss_pred:0.017412353307008743, decouple_loss:0.0012056310661137104
The modified gen p mean: 0.44881460070610046, gen p mean: -0.044090636074543, mean p set: 0.44929495453834534The modified gen p mean: 0.4501086175441742, gen p mean: -0.04511572793126106, mean p set: 0.4505888819694519
loss_pred:0.01702321693301201, decouple_loss:0.001132706180214882
loss_pred:0.017748260870575905, decouple_loss:0.001190169365145266
Iteration: 990, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493042528629303, gen p mean: -0.04755619913339615, mean p set: 0.4497845768928528
loss_pred:0.018081407994031906, decouple_loss:0.0011222215835005045
The modified gen p mean: 0.4491983652114868, gen p mean: -0.04389230161905289, mean p set: 0.4496786296367645The modified gen p mean: 0.449856698513031, gen p mean: -0.050093092024326324, mean p set: 0.4503369629383087
loss_pred:0.016832569614052773, decouple_loss:0.0012015673564746976
loss_pred:0.016804851591587067, decouple_loss:0.0012131243711337447
2023-04-30 07:23:57 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05508611723780632, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05060744285583496, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05127336084842682, mean p set: 0.4500633478164673
loss_pred:0.018447404727339745, decouple_loss:0.0013782279565930367
loss_pred:0.017317868769168854, decouple_loss:0.0012711959425359964
loss_pred:0.01752466894686222, decouple_loss:0.0013115315232425928
WV_0_PC_1_EH_0_PS_40, loss: 0.017829332500696182, avg_mse: 0.025572672486305237
current test mse: 0.025573
Iteration: 991, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44951194524765015, gen p mean: -0.04391254484653473, mean p set: 0.44999220967292786
The modified gen p mean: 0.4502502977848053, gen p mean: -0.043144162744283676, mean p set: 0.4507306218147278
The modified gen p mean: 0.45019111037254333, gen p mean: -0.05214127525687218, mean p set: 0.45067140460014343
loss_pred:0.017032625153660774, decouple_loss:0.001180811203084886
loss_pred:0.017322616651654243, decouple_loss:0.0011285138316452503
loss_pred:0.017363417893648148, decouple_loss:0.001153073157183826
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
NaN value num: 0
Iteration: 992, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509691596031189, gen p mean: -0.04010328650474548, mean p set: 0.451449453830719
loss_pred:0.016843290999531746, decouple_loss:0.0012130760587751865
The modified gen p mean: 0.4508785307407379, gen p mean: -0.0456034317612648, mean p set: 0.451358824968338The modified gen p mean: 0.450015127658844, gen p mean: -0.042582713067531586, mean p set: 0.4504954218864441
loss_pred:0.01751701533794403, decouple_loss:0.0010967445559799671
loss_pred:0.0174306258559227, decouple_loss:0.00120355689432472
Iteration: 993, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505440890789032, gen p mean: -0.0461961030960083, mean p set: 0.4510243833065033
loss_pred:0.017584722489118576, decouple_loss:0.0010844898642972112
The modified gen p mean: 0.4504777491092682, gen p mean: -0.04106464236974716, mean p set: 0.4509580433368683The modified gen p mean: 0.45170366764068604, gen p mean: -0.04716023802757263, mean p set: 0.45218396186828613
loss_pred:0.01716167852282524, decouple_loss:0.0010331140365451574
loss_pred:0.018308687955141068, decouple_loss:0.001174650271423161
Iteration: 994, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509449005126953, gen p mean: -0.039427828043699265, mean p set: 0.4514252245426178
loss_pred:0.01726931519806385, decouple_loss:0.0010415281867608428
The modified gen p mean: 0.4520995318889618, gen p mean: -0.04754357039928436, mean p set: 0.4525797963142395The modified gen p mean: 0.45124179124832153, gen p mean: -0.04917559400200844, mean p set: 0.451722115278244
loss_pred:0.016818447038531303, decouple_loss:0.001070657279342413
loss_pred:0.018022537231445312, decouple_loss:0.0011029239976778626
Iteration: 995, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510102868080139, gen p mean: -0.03929203376173973, mean p set: 0.451490581035614
loss_pred:0.017248796299099922, decouple_loss:0.0011036101495847106
The modified gen p mean: 0.4512133300304413, gen p mean: -0.04607030376791954, mean p set: 0.4516936242580414The modified gen p mean: 0.45153576135635376, gen p mean: -0.039801809936761856, mean p set: 0.45201605558395386
loss_pred:0.01755555160343647, decouple_loss:0.0010796859860420227
loss_pred:0.018108654767274857, decouple_loss:0.001056340872310102
Iteration: 996, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522620439529419, gen p mean: -0.04425351694226265, mean p set: 0.452742338180542
loss_pred:0.01633831486105919, decouple_loss:0.0010003788629546762
The modified gen p mean: 0.4504963755607605, gen p mean: -0.040685832500457764, mean p set: 0.4509766697883606The modified gen p mean: 0.45238882303237915, gen p mean: -0.043243613094091415, mean p set: 0.45286911725997925
loss_pred:0.017502613365650177, decouple_loss:0.000950695073697716
loss_pred:0.016818484291434288, decouple_loss:0.0010458127362653613
Iteration: 997, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451000839471817, gen p mean: -0.04454167187213898, mean p set: 0.4514811336994171
loss_pred:0.017715459689497948, decouple_loss:0.001020560972392559
The modified gen p mean: 0.4499052166938782, gen p mean: -0.04081060364842415, mean p set: 0.45038551092147827The modified gen p mean: 0.450273722410202, gen p mean: -0.040533922612667084, mean p set: 0.4507540166378021
loss_pred:0.016747180372476578, decouple_loss:0.0010107356356456876
loss_pred:0.017195675522089005, decouple_loss:0.0010112733580172062
Iteration: 998, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503312408924103, gen p mean: -0.04005950689315796, mean p set: 0.4508115351200104
loss_pred:0.01667240634560585, decouple_loss:0.001062844879925251
The modified gen p mean: 0.45107388496398926, gen p mean: -0.03732733428478241, mean p set: 0.45155417919158936The modified gen p mean: 0.45031309127807617, gen p mean: -0.043416716158390045, mean p set: 0.4507933557033539
loss_pred:0.017748743295669556, decouple_loss:0.001010627020150423
loss_pred:0.01710912212729454, decouple_loss:0.0009868451161310077
Iteration: 999, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452606201171875, gen p mean: -0.03759727627038956, mean p set: 0.4530864953994751
The modified gen p mean: 0.4506543278694153, gen p mean: -0.03878498822450638, mean p set: 0.4511346220970154
loss_pred:0.01744758151471615, decouple_loss:0.001101042376831174
loss_pred:0.017539044842123985, decouple_loss:0.0010029443074017763
The modified gen p mean: 0.45068854093551636, gen p mean: -0.04269632697105408, mean p set: 0.45116883516311646
loss_pred:0.017822163179516792, decouple_loss:0.0010654957732185721
Iteration: 1000, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451369047164917, gen p mean: -0.03492446616292, mean p set: 0.4518493115901947
loss_pred:0.0174693763256073, decouple_loss:0.0010484305676072836
The modified gen p mean: 0.4517129063606262, gen p mean: -0.03550698980689049, mean p set: 0.4521932005882263The modified gen p mean: 0.4513828158378601, gen p mean: -0.04261523857712746, mean p set: 0.4518631398677826
loss_pred:0.017997311428189278, decouple_loss:0.0012118741869926453
loss_pred:0.01755247451364994, decouple_loss:0.0010014268336817622
2023-04-30 07:26:24 itr: 1000
training loss: [0.01805791 0.01760255 0.0175218 ]
2023-04-30 07:26:24 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04780597239732742, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04290993511676788, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0436229482293129, mean p set: 0.4500633478164673
loss_pred:0.018472855910658836, decouple_loss:0.0012498217402026057
loss_pred:0.01735680177807808, decouple_loss:0.0012007808545604348
loss_pred:0.017532143741846085, decouple_loss:0.001229100045748055
WV_0_PC_1_EH_0_PS_40, loss: 0.01784859597682953, avg_mse: 0.025638848543167114
current test mse: 0.025639
Iteration: 1001, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45170968770980835, gen p mean: -0.03159187734127045, mean p set: 0.45218998193740845
The modified gen p mean: 0.45106467604637146, gen p mean: -0.03930264338850975, mean p set: 0.45154494047164917
The modified gen p mean: 0.4517829120159149, gen p mean: -0.037616875022649765, mean p set: 0.452263206243515
loss_pred:0.016919884830713272, decouple_loss:0.0009759904933162034
loss_pred:0.01631006971001625, decouple_loss:0.0010345479240640998
loss_pred:0.017345983535051346, decouple_loss:0.0009291853639297187
Iteration: 1002, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494660496711731, gen p mean: -0.04272371530532837, mean p set: 0.4499463438987732
The modified gen p mean: 0.45130977034568787, gen p mean: -0.03498181328177452, mean p set: 0.45179006457328796
loss_pred:0.01767629012465477, decouple_loss:0.0010590205201879144
loss_pred:0.017064223065972328, decouple_loss:0.0009806868620216846
The modified gen p mean: 0.45086175203323364, gen p mean: -0.04128999635577202, mean p set: 0.45134201645851135
loss_pred:0.01734115742146969, decouple_loss:0.0010760752484202385
Iteration: 1003, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45306816697120667, gen p mean: -0.043261151760816574, mean p set: 0.45354846119880676
loss_pred:0.016447100788354874, decouple_loss:0.001018680282868445
The modified gen p mean: 0.4506767988204956, gen p mean: -0.03926439583301544, mean p set: 0.4511570930480957The modified gen p mean: 0.4502072036266327, gen p mean: -0.03845997899770737, mean p set: 0.4506874978542328
loss_pred:0.017947716638445854, decouple_loss:0.0009757093503139913
loss_pred:0.01805444434285164, decouple_loss:0.0010010882979258895
Iteration: 1004, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45175155997276306, gen p mean: -0.04189817234873772, mean p set: 0.45223185420036316
The modified gen p mean: 0.45092010498046875, gen p mean: -0.04387591779232025, mean p set: 0.45140039920806885loss_pred:0.01686692237854004, decouple_loss:0.0012184251099824905
The modified gen p mean: 0.45045387744903564, gen p mean: -0.04561880603432655, mean p set: 0.45093417167663574
loss_pred:0.01686025597155094, decouple_loss:0.0011172142112627625
loss_pred:0.01713884249329567, decouple_loss:0.0011024021077901125
Iteration: 1005, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45241865515708923, gen p mean: -0.042419157922267914, mean p set: 0.45289894938468933
loss_pred:0.016783002763986588, decouple_loss:0.0010367634240537882
The modified gen p mean: 0.451595664024353, gen p mean: -0.041688282042741776, mean p set: 0.4520759880542755The modified gen p mean: 0.45108503103256226, gen p mean: -0.04353173077106476, mean p set: 0.45156532526016235
loss_pred:0.016875460743904114, decouple_loss:0.0010079563362523913
loss_pred:0.016358312219381332, decouple_loss:0.0010153931798413396
Iteration: 1006, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530012309551239, gen p mean: -0.04244174063205719, mean p set: 0.453481525182724
loss_pred:0.016084717586636543, decouple_loss:0.0011132449144497514
The modified gen p mean: 0.45241329073905945, gen p mean: -0.04522031173110008, mean p set: 0.45289358496665955The modified gen p mean: 0.44944626092910767, gen p mean: -0.04095179960131645, mean p set: 0.44992655515670776
loss_pred:0.016387928277254105, decouple_loss:0.0011244328925386071
loss_pred:0.017397930845618248, decouple_loss:0.001010771607980132
Iteration: 1007, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498281180858612, gen p mean: -0.04143048822879791, mean p set: 0.4503083825111389
loss_pred:0.01752970740199089, decouple_loss:0.001018604962155223
The modified gen p mean: 0.44963374733924866, gen p mean: -0.04398277774453163, mean p set: 0.45011407136917114The modified gen p mean: 0.45014870166778564, gen p mean: -0.041771624237298965, mean p set: 0.45062902569770813
loss_pred:0.017331959679722786, decouple_loss:0.0011530268238857388
loss_pred:0.016806377097964287, decouple_loss:0.00104905990883708
Iteration: 1008, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516170918941498, gen p mean: -0.03240249678492546, mean p set: 0.4520973861217499
loss_pred:0.01724371500313282, decouple_loss:0.0010107174748554826
The modified gen p mean: 0.45014965534210205, gen p mean: -0.040215324610471725, mean p set: 0.45062994956970215The modified gen p mean: 0.4509936571121216, gen p mean: -0.03700963035225868, mean p set: 0.4514739513397217
loss_pred:0.01734246499836445, decouple_loss:0.0010246175806969404
loss_pred:0.017767086625099182, decouple_loss:0.0009645684622228146
Iteration: 1009, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451759397983551, gen p mean: -0.035793982446193695, mean p set: 0.4522396922111511
loss_pred:0.01690267212688923, decouple_loss:0.0009466548799537122
The modified gen p mean: 0.45239830017089844, gen p mean: -0.03754637762904167, mean p set: 0.4528786242008209The modified gen p mean: 0.4500358998775482, gen p mean: -0.03827851265668869, mean p set: 0.4505161941051483
loss_pred:0.01704247295856476, decouple_loss:0.0010136628989130259
loss_pred:0.01698368228971958, decouple_loss:0.0010064917150884867
Iteration: 1010, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45029667019844055, gen p mean: -0.045078571885824203, mean p set: 0.45077693462371826
loss_pred:0.01652064546942711, decouple_loss:0.0009487116476520896
The modified gen p mean: 0.45134708285331726, gen p mean: -0.03645921126008034, mean p set: 0.45182737708091736The modified gen p mean: 0.45127439498901367, gen p mean: -0.04105588421225548, mean p set: 0.45175471901893616
loss_pred:0.01673070527613163, decouple_loss:0.0009905261686071754
loss_pred:0.017070114612579346, decouple_loss:0.0009722367976792157
2023-04-30 07:28:18 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.050920840352773666, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04599498212337494, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0465693362057209, mean p set: 0.4500633478164673
loss_pred:0.018370436504483223, decouple_loss:0.001200784812681377
loss_pred:0.01731753535568714, decouple_loss:0.0011578307021409273
loss_pred:0.017466513440012932, decouple_loss:0.0011397632770240307
WV_0_PC_1_EH_0_PS_40, loss: 0.01777646876871586, avg_mse: 0.02549375593662262
current test mse: 0.025494
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
Traceback (most recent call last):
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/run1.py", line 338, in <module>
    train_wrapper(model)
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/run1.py", line 259, in train_wrapper
    train_input_handle = datasets_factory.data_provider(
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/data_provider/datasets_factory.py", line 48, in data_provider
    train_input_handle = datasets_map[dataset_name].InputHandle(train_input_param)
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/data_provider/mnist_new.py", line 26, in __init__
    self.load()
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/data_provider/mnist_new.py", line 31, in load
    self.data['clips'] = dat_1['clips']
  File "/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/numpy/lib/npyio.py", line 260, in __getitem__
    raise KeyError("%s is not a file in the archive" % key)
KeyError: 'clips is not a file in the archive'