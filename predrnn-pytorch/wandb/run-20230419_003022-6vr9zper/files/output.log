After initialize model, args.img_channel:3
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
train_data_files nums: 40
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493323266506195, gen p mean: -0.0018774010241031647, mean p set: 0.4498126208782196
loss_pred:0.16836173832416534, decouple_loss:0.10227862745523453
The modified gen p mean: 0.4490041136741638, gen p mean: -0.0021262720692902803, mean p set: 0.4494844079017639
loss_pred:0.17159584164619446, decouple_loss:0.0924403965473175
The modified gen p mean: 0.447736918926239, gen p mean: -0.0019564067479223013, mean p set: 0.4482172131538391
loss_pred:0.16045169532299042, decouple_loss:0.09544996917247772
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505947232246399, gen p mean: 0.005759313702583313, mean p set: 0.4510750472545624
The modified gen p mean: 0.45024311542510986, gen p mean: 0.005738421808928251, mean p set: 0.4507233798503876
loss_pred:0.17668123543262482, decouple_loss:0.5331199169158936
The modified gen p mean: 0.45020556449890137, gen p mean: 0.005885713268071413, mean p set: 0.4506858289241791
loss_pred:0.17311497032642365, decouple_loss:0.5388506650924683
loss_pred:0.17397978901863098, decouple_loss:0.5351577997207642
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795694947242737, gen p mean: -0.0082006910815835, mean p set: 0.44843724370002747
loss_pred:0.17618118226528168, decouple_loss:0.7553277015686035
The modified gen p mean: 0.450771301984787, gen p mean: -0.008289249613881111, mean p set: 0.4512515664100647
The modified gen p mean: 0.449002742767334, gen p mean: -0.008329511620104313, mean p set: 0.4494830369949341
loss_pred:0.17358709871768951, decouple_loss:0.7576990723609924
loss_pred:0.18136125802993774, decouple_loss:0.755416989326477
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498547911643982, gen p mean: -0.00534813292324543, mean p set: 0.4503350555896759
The modified gen p mean: 0.4494415521621704, gen p mean: -0.005507203284651041, mean p set: 0.4499218463897705
loss_pred:0.18054410815238953, decouple_loss:0.6217875480651855
loss_pred:0.18631547689437866, decouple_loss:0.6182464361190796
The modified gen p mean: 0.4483683109283447, gen p mean: -0.005486455280333757, mean p set: 0.44884857535362244
loss_pred:0.18522700667381287, decouple_loss:0.6142294406890869
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45028233528137207, gen p mean: -0.009426496922969818, mean p set: 0.45076262950897217
loss_pred:0.1494310200214386, decouple_loss:0.7697509527206421
The modified gen p mean: 0.4505392014980316, gen p mean: -0.00939400214701891, mean p set: 0.4510194957256317
loss_pred:0.14962215721607208, decouple_loss:0.7749782800674438
The modified gen p mean: 0.44892197847366333, gen p mean: -0.009412230923771858, mean p set: 0.4494022727012634
loss_pred:0.15327748656272888, decouple_loss:0.7730381488800049
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499109387397766, gen p mean: -0.006060976069420576, mean p set: 0.4503912329673767
The modified gen p mean: 0.4501170217990875, gen p mean: -0.006065672729164362, mean p set: 0.4505973160266876
loss_pred:0.13930369913578033, decouple_loss:0.762980580329895
loss_pred:0.14260773360729218, decouple_loss:0.7652217745780945
The modified gen p mean: 0.448622465133667, gen p mean: -0.006041462998837233, mean p set: 0.4491027593612671
loss_pred:0.1393296867609024, decouple_loss:0.7682244181632996
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724041223526, gen p mean: -0.004383562132716179, mean p set: 0.4477207064628601
The modified gen p mean: 0.4494454860687256, gen p mean: -0.004376315977424383, mean p set: 0.4499257802963257
loss_pred:0.12443222850561142, decouple_loss:0.7630859017372131
loss_pred:0.13145124912261963, decouple_loss:0.7621275186538696
The modified gen p mean: 0.44891074299812317, gen p mean: -0.00437128683552146, mean p set: 0.44939103722572327
loss_pred:0.1309729367494583, decouple_loss:0.7638682126998901
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491523504257202, gen p mean: -0.007069836836308241, mean p set: 0.4496326744556427
The modified gen p mean: 0.44875338673591614, gen p mean: -0.007056757342070341, mean p set: 0.4492337107658386
loss_pred:0.12062505632638931, decouple_loss:0.7502491474151611
loss_pred:0.11644653230905533, decouple_loss:0.750146746635437
The modified gen p mean: 0.4478796720504761, gen p mean: -0.007084659766405821, mean p set: 0.44835996627807617
loss_pred:0.11770007014274597, decouple_loss:0.7513322234153748
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494165778160095, gen p mean: -0.004976905416697264, mean p set: 0.4498968720436096
The modified gen p mean: 0.4494202435016632, gen p mean: -0.004988295491784811, mean p set: 0.4499005675315857
loss_pred:0.11043515801429749, decouple_loss:0.697301983833313
loss_pred:0.10681096464395523, decouple_loss:0.7020788788795471
The modified gen p mean: 0.4496532082557678, gen p mean: -0.004978214856237173, mean p set: 0.4501335322856903
loss_pred:0.11030387133359909, decouple_loss:0.6954774260520935
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475174844264984, gen p mean: -0.003204719629138708, mean p set: 0.4479977786540985
loss_pred:0.09986420720815659, decouple_loss:0.6351363062858582
The modified gen p mean: 0.450418621301651, gen p mean: -0.0032432912848889828, mean p set: 0.4508989155292511
loss_pred:0.10164681822061539, decouple_loss:0.6455547213554382
The modified gen p mean: 0.44901034235954285, gen p mean: -0.0032584520522505045, mean p set: 0.44949066638946533
loss_pred:0.09995470941066742, decouple_loss:0.6511307954788208
2023-04-19 00:33:27 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.004028596915304661, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.004030359443277121, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.004030582495033741, mean p set: 0.44879910349845886
loss_pred:0.09464596211910248, decouple_loss:0.6280051469802856
loss_pred:0.097311832010746, decouple_loss:0.624947726726532
loss_pred:0.09612289071083069, decouple_loss:0.6245146989822388
WV_0_PC_1_EH_0_PS_40, loss: 0.12731802463531494, avg_mse: 0.09653069823980331
current test mse: 0.096531
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44910553097724915, gen p mean: -0.0040267156437039375, mean p set: 0.44958579540252686
The modified gen p mean: 0.4490760564804077, gen p mean: -0.004024576395750046, mean p set: 0.4495563805103302
loss_pred:0.09880426526069641, decouple_loss:0.6295552849769592
loss_pred:0.10131944715976715, decouple_loss:0.6302335262298584
The modified gen p mean: 0.44841182231903076, gen p mean: -0.004022521898150444, mean p set: 0.44889214634895325
loss_pred:0.09590891003608704, decouple_loss:0.6312233209609985
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489338994026184, gen p mean: -0.0037505279760807753, mean p set: 0.4494141638278961
The modified gen p mean: 0.4502202570438385, gen p mean: -0.003781653242185712, mean p set: 0.4507005214691162
loss_pred:0.09743988513946533, decouple_loss:0.547640323638916
loss_pred:0.09480645507574081, decouple_loss:0.5510147213935852
The modified gen p mean: 0.4483104348182678, gen p mean: -0.0037377646658569574, mean p set: 0.4487907588481903
loss_pred:0.09302632510662079, decouple_loss:0.5481374859809875
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472036361694336, gen p mean: -0.001999159809201956, mean p set: 0.4476839303970337
The modified gen p mean: 0.44905537366867065, gen p mean: -0.0019486671080812812, mean p set: 0.44953563809394836
loss_pred:0.094020314514637, decouple_loss:0.5209072828292847
loss_pred:0.08900562673807144, decouple_loss:0.5237386226654053
The modified gen p mean: 0.44951102137565613, gen p mean: -0.001954201841726899, mean p set: 0.4499913156032562
loss_pred:0.08989912271499634, decouple_loss:0.5226874947547913
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496974050998688, gen p mean: -0.0018545417115092278, mean p set: 0.45017769932746887
loss_pred:0.0891927033662796, decouple_loss:0.4520074129104614
The modified gen p mean: 0.45058080554008484, gen p mean: -0.0017985461745411158, mean p set: 0.45106109976768494
loss_pred:0.09064328670501709, decouple_loss:0.45530635118484497
The modified gen p mean: 0.4495620131492615, gen p mean: -0.002038002945482731, mean p set: 0.4500423073768616
loss_pred:0.09006040543317795, decouple_loss:0.45095282793045044
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484518766403198, gen p mean: -0.00019540530047379434, mean p set: 0.4489321708679199
The modified gen p mean: 0.4494057595729828, gen p mean: -0.00029073868063278496, mean p set: 0.4498860538005829
loss_pred:0.08978953212499619, decouple_loss:0.48529908061027527
loss_pred:0.0927671566605568, decouple_loss:0.49519479274749756
The modified gen p mean: 0.4493190050125122, gen p mean: -0.00020198669517412782, mean p set: 0.4497992694377899
loss_pred:0.09387887269258499, decouple_loss:0.4849450886249542
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502853751182556, gen p mean: 0.0011206403141841292, mean p set: 0.4507656991481781
The modified gen p mean: 0.4495910704135895, gen p mean: 0.0011228235671296716, mean p set: 0.45007139444351196
loss_pred:0.08808387815952301, decouple_loss:0.4398413896560669
loss_pred:0.08568543195724487, decouple_loss:0.4415932297706604
The modified gen p mean: 0.45016369223594666, gen p mean: 0.0011201603338122368, mean p set: 0.45064398646354675
loss_pred:0.08810564130544662, decouple_loss:0.43854185938835144
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499286413192749, gen p mean: 0.0018065337790176272, mean p set: 0.450408935546875
The modified gen p mean: 0.4504387676715851, gen p mean: 0.0017882309621199965, mean p set: 0.4509190618991852
loss_pred:0.08921930938959122, decouple_loss:0.40695852041244507
loss_pred:0.08701948076486588, decouple_loss:0.40770161151885986
The modified gen p mean: 0.4500133991241455, gen p mean: 0.001765314838849008, mean p set: 0.4504936933517456
loss_pred:0.08654674142599106, decouple_loss:0.40331754088401794
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500688910484314, gen p mean: 0.0018104829359799623, mean p set: 0.4505492150783539
The modified gen p mean: 0.4475288987159729, gen p mean: 0.001783645013347268, mean p set: 0.448009192943573
loss_pred:0.08604723960161209, decouple_loss:0.36812564730644226
loss_pred:0.08422962576150894, decouple_loss:0.36599647998809814
The modified gen p mean: 0.4487708508968353, gen p mean: 0.0017400546930730343, mean p set: 0.4492511451244354
loss_pred:0.08569047600030899, decouple_loss:0.36561450362205505
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45044636726379395, gen p mean: 0.0015162295894697309, mean p set: 0.45092666149139404
loss_pred:0.08571425825357437, decouple_loss:0.33685004711151123
The modified gen p mean: 0.4492276608943939, gen p mean: 0.0015467661432921886, mean p set: 0.449707955121994
loss_pred:0.08825965970754623, decouple_loss:0.32932600378990173
The modified gen p mean: 0.4503425657749176, gen p mean: 0.0014978509861975908, mean p set: 0.4508228898048401
loss_pred:0.08638601750135422, decouple_loss:0.3362659513950348
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448871374130249, gen p mean: 0.0014938113745301962, mean p set: 0.4493516683578491
loss_pred:0.08701544255018234, decouple_loss:0.3081355690956116
The modified gen p mean: 0.4496975243091583, gen p mean: 0.0014456530334427953, mean p set: 0.4501778185367584
loss_pred:0.08271367847919464, decouple_loss:0.3099806606769562
The modified gen p mean: 0.44825124740600586, gen p mean: 0.0014866756973788142, mean p set: 0.44873154163360596
loss_pred:0.08758271485567093, decouple_loss:0.30632203817367554
2023-04-19 00:35:21 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: 0.0018209554255008698, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: 0.0018148142844438553, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: 0.001833201851695776, mean p set: 0.44879910349845886
loss_pred:0.08219955116510391, decouple_loss:0.2758406698703766
loss_pred:0.08416324108839035, decouple_loss:0.2744196951389313
loss_pred:0.08358212560415268, decouple_loss:0.2744545638561249
WV_0_PC_1_EH_0_PS_40, loss: 0.09706022590398788, avg_mse: 0.08353797346353531
current test mse: 0.083538
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44843602180480957, gen p mean: 0.0019261777633801103, mean p set: 0.44891637563705444
loss_pred:0.08795543760061264, decouple_loss:0.27959996461868286
The modified gen p mean: 0.44823938608169556, gen p mean: 0.001925150048919022, mean p set: 0.44871968030929565
loss_pred:0.08629487454891205, decouple_loss:0.27636662125587463
The modified gen p mean: 0.4489436149597168, gen p mean: 0.0018894500099122524, mean p set: 0.4494239091873169
loss_pred:0.08534752577543259, decouple_loss:0.2776601314544678
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447664350271225, gen p mean: 0.0021577272564172745, mean p set: 0.4481446146965027
loss_pred:0.0873025432229042, decouple_loss:0.25444716215133667
The modified gen p mean: 0.4480161666870117, gen p mean: 0.0021765681449323893, mean p set: 0.4484964609146118
The modified gen p mean: 0.4476427733898163, gen p mean: 0.00216420809738338, mean p set: 0.4481230676174164
loss_pred:0.08618652820587158, decouple_loss:0.25326207280158997
loss_pred:0.08511445671319962, decouple_loss:0.25449755787849426
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505738317966461, gen p mean: 0.0020463471300899982, mean p set: 0.4510541558265686
loss_pred:0.08621064573526382, decouple_loss:0.24985243380069733
The modified gen p mean: 0.4493885636329651, gen p mean: 0.002038792008534074, mean p set: 0.4498688280582428
The modified gen p mean: 0.4493597745895386, gen p mean: 0.0020477627404034138, mean p set: 0.44984006881713867
loss_pred:0.08983669430017471, decouple_loss:0.25067073106765747
loss_pred:0.0847974568605423, decouple_loss:0.2497062236070633
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44761529564857483, gen p mean: 0.0030770008452236652, mean p set: 0.4480955898761749
loss_pred:0.08483053743839264, decouple_loss:0.276751846075058
The modified gen p mean: 0.44889312982559204, gen p mean: 0.00310182711109519, mean p set: 0.44937342405319214
loss_pred:0.08751582354307175, decouple_loss:0.2822043001651764
The modified gen p mean: 0.4472561478614807, gen p mean: 0.0031093035358935595, mean p set: 0.4477364122867584
loss_pred:0.08572693914175034, decouple_loss:0.2750358581542969
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481634199619293, gen p mean: 0.003125161398202181, mean p set: 0.4486437141895294
loss_pred:0.08620564639568329, decouple_loss:0.25136950612068176
The modified gen p mean: 0.4474274516105652, gen p mean: 0.0030927553307265043, mean p set: 0.4479077458381653
The modified gen p mean: 0.44824087619781494, gen p mean: 0.003077980363741517, mean p set: 0.44872117042541504
loss_pred:0.08277805149555206, decouple_loss:0.24753744900226593
loss_pred:0.08448512852191925, decouple_loss:0.24865762889385223
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480254054069519, gen p mean: 0.00261117797344923, mean p set: 0.448505699634552
loss_pred:0.0831330344080925, decouple_loss:0.21409384906291962
The modified gen p mean: 0.44887322187423706, gen p mean: 0.002554969396442175, mean p set: 0.44935348629951477
loss_pred:0.08352159708738327, decouple_loss:0.21656827628612518
The modified gen p mean: 0.44745132327079773, gen p mean: 0.0025529104750603437, mean p set: 0.4479316174983978
loss_pred:0.08463191986083984, decouple_loss:0.21823415160179138
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486350119113922, gen p mean: 0.0022571429144591093, mean p set: 0.4491152763366699
The modified gen p mean: 0.44854146242141724, gen p mean: 0.00225181900896132, mean p set: 0.44902175664901733
loss_pred:0.08164095878601074, decouple_loss:0.22280554473400116
loss_pred:0.08183225989341736, decouple_loss:0.2235020250082016
The modified gen p mean: 0.44775041937828064, gen p mean: 0.002264064969494939, mean p set: 0.44823071360588074
loss_pred:0.0823439359664917, decouple_loss:0.22450198233127594
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44861480593681335, gen p mean: 0.002464184071868658, mean p set: 0.44909510016441345
loss_pred:0.08220404386520386, decouple_loss:0.1973537653684616
The modified gen p mean: 0.447870135307312, gen p mean: 0.0024661317002028227, mean p set: 0.4483504593372345
loss_pred:0.08525106310844421, decouple_loss:0.19731074571609497
The modified gen p mean: 0.44815993309020996, gen p mean: 0.0024452670477330685, mean p set: 0.44864022731781006
loss_pred:0.08093300461769104, decouple_loss:0.19679348170757294
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815656542778015, gen p mean: 0.002794856671243906, mean p set: 0.44863688945770264
loss_pred:0.08322930335998535, decouple_loss:0.1773490309715271
The modified gen p mean: 0.44936537742614746, gen p mean: 0.0027724653482437134, mean p set: 0.44984567165374756
The modified gen p mean: 0.44702979922294617, gen p mean: 0.002828482538461685, mean p set: 0.4475100636482239
loss_pred:0.08235480636358261, decouple_loss:0.1777014136314392
loss_pred:0.08276750892400742, decouple_loss:0.17700539529323578
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472508132457733, gen p mean: 0.0028378774877637625, mean p set: 0.4477311074733734
loss_pred:0.08019659668207169, decouple_loss:0.1778976172208786
The modified gen p mean: 0.4469038248062134, gen p mean: 0.002853099489584565, mean p set: 0.44738414883613586
loss_pred:0.08336255699396133, decouple_loss:0.17671653628349304
The modified gen p mean: 0.44853872060775757, gen p mean: 0.002819098299369216, mean p set: 0.44901901483535767
loss_pred:0.07909500598907471, decouple_loss:0.17687495052814484
2023-04-19 00:37:56 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: 0.0025417127180844545, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: 0.0025515134911984205, mean p set: 0.4498290419578552
The modified gen p mean: 0.44831880927085876, gen p mean: 0.0025665389839559793, mean p set: 0.44879910349845886
loss_pred:0.07834968715906143, decouple_loss:0.15850192308425903
loss_pred:0.08032077550888062, decouple_loss:0.15715134143829346
loss_pred:0.07989559322595596, decouple_loss:0.15732917189598083
WV_0_PC_1_EH_0_PS_40, loss: 0.08740505576133728, avg_mse: 0.07955319434404373
current test mse: 0.079553
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488052427768707, gen p mean: 0.0026608954649418592, mean p set: 0.4492855668067932
loss_pred:0.08361396938562393, decouple_loss:0.1589251458644867
The modified gen p mean: 0.45050033926963806, gen p mean: 0.0026414350140839815, mean p set: 0.45098060369491577
loss_pred:0.08554178476333618, decouple_loss:0.1602705866098404
The modified gen p mean: 0.4490232765674591, gen p mean: 0.0026027397252619267, mean p set: 0.4495035707950592
loss_pred:0.08324925601482391, decouple_loss:0.15952034294605255
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497413635253906, gen p mean: 0.0018906178884208202, mean p set: 0.4502216577529907
The modified gen p mean: 0.4484662413597107, gen p mean: 0.0018149814568459988, mean p set: 0.4489465653896332
loss_pred:0.0816047340631485, decouple_loss:0.1485525667667389
loss_pred:0.07995039969682693, decouple_loss:0.15082566440105438
The modified gen p mean: 0.44846776127815247, gen p mean: 0.0018433260265737772, mean p set: 0.44894805550575256
loss_pred:0.07671356946229935, decouple_loss:0.15192297101020813
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481416344642639, gen p mean: 0.0012868873309344053, mean p set: 0.448621928691864
loss_pred:0.07971449196338654, decouple_loss:0.14358475804328918
The modified gen p mean: 0.4481697380542755, gen p mean: 0.0012815342051908374, mean p set: 0.448650062084198
The modified gen p mean: 0.4489331543445587, gen p mean: 0.001352375140413642, mean p set: 0.4494134187698364
loss_pred:0.0813024565577507, decouple_loss:0.14340442419052124
loss_pred:0.08255891501903534, decouple_loss:0.1421443223953247
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448375940322876, gen p mean: 0.000824200629722327, mean p set: 0.4488562345504761
The modified gen p mean: 0.4477349817752838, gen p mean: 0.000779707741457969, mean p set: 0.4482152760028839
The modified gen p mean: 0.4482167363166809, gen p mean: 0.0008212436223402619, mean p set: 0.4486970603466034
loss_pred:0.07929040491580963, decouple_loss:0.1310935914516449
loss_pred:0.0805027186870575, decouple_loss:0.13034772872924805
loss_pred:0.08099602907896042, decouple_loss:0.13083070516586304
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482134282588959, gen p mean: 8.477702067466453e-05, mean p set: 0.44869375228881836
The modified gen p mean: 0.44682058691978455, gen p mean: 5.81161912123207e-05, mean p set: 0.44730088114738464
The modified gen p mean: 0.4491654634475708, gen p mean: 9.015542309498414e-05, mean p set: 0.4496456980705261
loss_pred:0.07811331748962402, decouple_loss:0.12604175508022308
loss_pred:0.08006951957941055, decouple_loss:0.12555807828903198
loss_pred:0.08145889639854431, decouple_loss:0.12801139056682587
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480617344379425, gen p mean: -0.0010144759435206652, mean p set: 0.4485420286655426
The modified gen p mean: 0.4489864110946655, gen p mean: -0.001124705420807004, mean p set: 0.4494667053222656
loss_pred:0.07600633054971695, decouple_loss:0.11810969561338425
The modified gen p mean: 0.44795912504196167, gen p mean: -0.0010833588894456625, mean p set: 0.44843941926956177
loss_pred:0.08173725008964539, decouple_loss:0.11723463982343674
loss_pred:0.081740602850914, decouple_loss:0.11698323488235474
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44833943247795105, gen p mean: -0.0025143660604953766, mean p set: 0.44881969690322876
The modified gen p mean: 0.4490513503551483, gen p mean: -0.0024902024306356907, mean p set: 0.449531614780426
The modified gen p mean: 0.44841325283050537, gen p mean: -0.002495778491720557, mean p set: 0.44889357686042786
loss_pred:0.07883665710687637, decouple_loss:0.11401990801095963
loss_pred:0.07834922522306442, decouple_loss:0.11215729266405106
loss_pred:0.08190982788801193, decouple_loss:0.11163902282714844
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44872400164604187, gen p mean: -0.003882098477333784, mean p set: 0.4492042660713196
loss_pred:0.08106403797864914, decouple_loss:0.10582170635461807
The modified gen p mean: 0.4484531581401825, gen p mean: -0.003876633243635297, mean p set: 0.4489334523677826
loss_pred:0.08319029957056046, decouple_loss:0.10619090497493744
The modified gen p mean: 0.4474150240421295, gen p mean: -0.0038199962582439184, mean p set: 0.4478953182697296
loss_pred:0.07835294306278229, decouple_loss:0.10679447650909424
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477507472038269, gen p mean: -0.005267024971544743, mean p set: 0.448231041431427
The modified gen p mean: 0.44679588079452515, gen p mean: -0.005208973772823811, mean p set: 0.44727620482444763
loss_pred:0.07842987030744553, decouple_loss:0.10113923996686935
loss_pred:0.07733031362295151, decouple_loss:0.10044676810503006
The modified gen p mean: 0.44844579696655273, gen p mean: -0.005216884892433882, mean p set: 0.44892609119415283
loss_pred:0.07948730885982513, decouple_loss:0.10103674978017807
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476039409637451, gen p mean: -0.006821538787335157, mean p set: 0.4480842351913452The modified gen p mean: 0.44884786009788513, gen p mean: -0.006838566157966852, mean p set: 0.44932815432548523
The modified gen p mean: 0.44832900166511536, gen p mean: -0.006743185687810183, mean p set: 0.44880932569503784
loss_pred:0.08173608779907227, decouple_loss:0.09617120027542114loss_pred:0.07827551662921906, decouple_loss:0.096162348985672
loss_pred:0.07723765820264816, decouple_loss:0.0947866216301918
2023-04-19 00:39:50 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.008943994529545307, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.009047014638781548, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.009068701416254044, mean p set: 0.44879910349845886
loss_pred:0.07506898790597916, decouple_loss:0.08929696679115295
loss_pred:0.07675047218799591, decouple_loss:0.08998706191778183
loss_pred:0.07668457925319672, decouple_loss:0.08995275944471359
WV_0_PC_1_EH_0_PS_40, loss: 0.0806552991271019, avg_mse: 0.07594067603349686
current test mse: 0.075941
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485644996166229, gen p mean: -0.009007464163005352, mean p set: 0.44904476404190063
loss_pred:0.07877475023269653, decouple_loss:0.09022382646799088
The modified gen p mean: 0.44970178604125977, gen p mean: -0.009002510458230972, mean p set: 0.45018208026885986
loss_pred:0.07728293538093567, decouple_loss:0.09107133001089096
The modified gen p mean: 0.4471322298049927, gen p mean: -0.009078488685190678, mean p set: 0.4476125240325928
loss_pred:0.07857674360275269, decouple_loss:0.0910043716430664
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484303593635559, gen p mean: -0.010584455914795399, mean p set: 0.4489106833934784
loss_pred:0.07474515587091446, decouple_loss:0.0879221111536026
The modified gen p mean: 0.447837769985199, gen p mean: -0.010674262419342995, mean p set: 0.4483180344104767
The modified gen p mean: 0.4468880295753479, gen p mean: -0.010766486637294292, mean p set: 0.447368323802948
loss_pred:0.07777401804924011, decouple_loss:0.08744563907384872
loss_pred:0.07668515294790268, decouple_loss:0.08670249581336975
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447710245847702, gen p mean: -0.012843306176364422, mean p set: 0.4481905400753021
loss_pred:0.07475106418132782, decouple_loss:0.08154555410146713
The modified gen p mean: 0.4466460347175598, gen p mean: -0.012907065451145172, mean p set: 0.4471263289451599
The modified gen p mean: 0.448089063167572, gen p mean: -0.012915395200252533, mean p set: 0.4485693573951721
loss_pred:0.07866202294826508, decouple_loss:0.08180536329746246
loss_pred:0.0768871083855629, decouple_loss:0.08151037245988846
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468555450439453, gen p mean: -0.014454538933932781, mean p set: 0.4473358392715454
loss_pred:0.07578635215759277, decouple_loss:0.07789747416973114
The modified gen p mean: 0.4482479691505432, gen p mean: -0.014401717111468315, mean p set: 0.4487282633781433
The modified gen p mean: 0.44812512397766113, gen p mean: -0.0144211919978261, mean p set: 0.44860541820526123
loss_pred:0.07652011513710022, decouple_loss:0.07826271653175354
loss_pred:0.07564177364110947, decouple_loss:0.07825426757335663
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476760923862457, gen p mean: -0.01581568457186222, mean p set: 0.4481564164161682
loss_pred:0.07466337829828262, decouple_loss:0.07594221830368042
The modified gen p mean: 0.4461434781551361, gen p mean: -0.015993235632777214, mean p set: 0.4466237425804138
loss_pred:0.07703756541013718, decouple_loss:0.07654237747192383
The modified gen p mean: 0.4472527801990509, gen p mean: -0.015824802219867706, mean p set: 0.4477330446243286
loss_pred:0.07498358935117722, decouple_loss:0.07525567710399628
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702860713005066, gen p mean: -0.016590731218457222, mean p set: 0.44750893115997314
loss_pred:0.07719340920448303, decouple_loss:0.07270178943872452
The modified gen p mean: 0.44793441891670227, gen p mean: -0.016522228717803955, mean p set: 0.44841471314430237
The modified gen p mean: 0.4477846920490265, gen p mean: -0.016500132158398628, mean p set: 0.4482649564743042
loss_pred:0.07361475378274918, decouple_loss:0.07388057559728622
loss_pred:0.07454734295606613, decouple_loss:0.07365687936544418
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474222660064697, gen p mean: -0.018401628360152245, mean p set: 0.4479025602340698
loss_pred:0.07647339254617691, decouple_loss:0.07245033234357834
The modified gen p mean: 0.4480734169483185, gen p mean: -0.01813831925392151, mean p set: 0.4485537111759186
The modified gen p mean: 0.447005033493042, gen p mean: -0.018544727936387062, mean p set: 0.4474853575229645
loss_pred:0.07554719597101212, decouple_loss:0.07170790433883667
loss_pred:0.077516108751297, decouple_loss:0.07285255193710327
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466298222541809, gen p mean: -0.019929910078644753, mean p set: 0.447110116481781
loss_pred:0.07519567757844925, decouple_loss:0.0690433531999588
The modified gen p mean: 0.4501623511314392, gen p mean: -0.019655104726552963, mean p set: 0.4506426155567169
The modified gen p mean: 0.4468289613723755, gen p mean: -0.020162291824817657, mean p set: 0.447309285402298
loss_pred:0.07418753951787949, decouple_loss:0.06946713477373123
loss_pred:0.07728122174739838, decouple_loss:0.0688866451382637
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44852301478385925, gen p mean: -0.021748824045062065, mean p set: 0.44900330901145935
The modified gen p mean: 0.44944387674331665, gen p mean: -0.021223457530140877, mean p set: 0.4499242305755615
loss_pred:0.0744391605257988, decouple_loss:0.06639789044857025
loss_pred:0.0734366849064827, decouple_loss:0.06563352793455124
The modified gen p mean: 0.44588345289230347, gen p mean: -0.02196766622364521, mean p set: 0.44636374711990356
loss_pred:0.07483281195163727, decouple_loss:0.06610210984945297
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44617775082588196, gen p mean: -0.022854603826999664, mean p set: 0.44665804505348206
loss_pred:0.07471553236246109, decouple_loss:0.06432898342609406
The modified gen p mean: 0.4480352997779846, gen p mean: -0.022743647918105125, mean p set: 0.4485156238079071
The modified gen p mean: 0.44771867990493774, gen p mean: -0.022547036409378052, mean p set: 0.44819900393486023
loss_pred:0.07339030504226685, decouple_loss:0.06260236352682114
loss_pred:0.07406274974346161, decouple_loss:0.06367607414722443
2023-04-19 00:42:30 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.025034155696630478, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.02523449994623661, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.025308338925242424, mean p set: 0.44879910349845886
loss_pred:0.07206585258245468, decouple_loss:0.059501972049474716
loss_pred:0.07370145618915558, decouple_loss:0.05935884267091751
loss_pred:0.07377872616052628, decouple_loss:0.0594535656273365
WV_0_PC_1_EH_0_PS_40, loss: 0.07615391910076141, avg_mse: 0.07310830801725388
current test mse: 0.073108
Iteration: 51, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485395848751068, gen p mean: -0.02510121650993824, mean p set: 0.4490198791027069
The modified gen p mean: 0.4491856098175049, gen p mean: -0.02515321597456932, mean p set: 0.449665904045105
loss_pred:0.07418242841959, decouple_loss:0.05968310683965683
The modified gen p mean: 0.4469155967235565, gen p mean: -0.024869341403245926, mean p set: 0.4473958909511566
loss_pred:0.07436469942331314, decouple_loss:0.05909404158592224
loss_pred:0.07344572246074677, decouple_loss:0.05944294109940529
Iteration: 52, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44707077741622925, gen p mean: -0.027450500056147575, mean p set: 0.44755110144615173
The modified gen p mean: 0.44904136657714844, gen p mean: -0.027184152975678444, mean p set: 0.44952166080474854
The modified gen p mean: 0.4483294188976288, gen p mean: -0.027406955137848854, mean p set: 0.4488097131252289
loss_pred:0.07149184495210648, decouple_loss:0.05686735361814499
loss_pred:0.07198434323072433, decouple_loss:0.05677369236946106
loss_pred:0.0737115740776062, decouple_loss:0.05705560743808746
Iteration: 53, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762858748435974, gen p mean: -0.02962830848991871, mean p set: 0.4481089115142822
The modified gen p mean: 0.4482154846191406, gen p mean: -0.029507381841540337, mean p set: 0.44869574904441833
The modified gen p mean: 0.4482189118862152, gen p mean: -0.029427651315927505, mean p set: 0.4486992359161377
loss_pred:0.07389986515045166, decouple_loss:0.062156517058610916
loss_pred:0.07296290993690491, decouple_loss:0.05940430611371994
loss_pred:0.0721314549446106, decouple_loss:0.06046828255057335
Iteration: 54, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470553696155548, gen p mean: -0.03205142170190811, mean p set: 0.4475356340408325
The modified gen p mean: 0.4479919672012329, gen p mean: -0.031780023127794266, mean p set: 0.448472261428833
The modified gen p mean: 0.4500880837440491, gen p mean: -0.032152384519577026, mean p set: 0.4505683481693268
loss_pred:0.07631570845842361, decouple_loss:0.058966781944036484
loss_pred:0.07164569944143295, decouple_loss:0.060603782534599304
loss_pred:0.0724218338727951, decouple_loss:0.05945965275168419
Iteration: 55, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482412040233612, gen p mean: -0.033395715057849884, mean p set: 0.4487214982509613
The modified gen p mean: 0.4475904405117035, gen p mean: -0.033471815288066864, mean p set: 0.4480707347393036
The modified gen p mean: 0.44795140624046326, gen p mean: -0.03384345397353172, mean p set: 0.44843170046806335
loss_pred:0.07228725403547287, decouple_loss:0.06076464429497719
loss_pred:0.07430730015039444, decouple_loss:0.061506085097789764
loss_pred:0.07253317534923553, decouple_loss:0.05913866311311722
Iteration: 56, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678202271461487, gen p mean: -0.036197513341903687, mean p set: 0.44726231694221497
The modified gen p mean: 0.4477676451206207, gen p mean: -0.0363411046564579, mean p set: 0.4482479691505432
The modified gen p mean: 0.4471645653247833, gen p mean: -0.03632723540067673, mean p set: 0.4476448595523834
loss_pred:0.07303057610988617, decouple_loss:0.05613867938518524
loss_pred:0.0705782026052475, decouple_loss:0.055564139038324356
loss_pred:0.06994236260652542, decouple_loss:0.055677276104688644
Iteration: 57, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44881513714790344, gen p mean: -0.03927011415362358, mean p set: 0.44929543137550354
The modified gen p mean: 0.4480031430721283, gen p mean: -0.039685823023319244, mean p set: 0.4484834671020508loss_pred:0.07173241674900055, decouple_loss:0.054039664566516876
loss_pred:0.07184755802154541, decouple_loss:0.05461352318525314
The modified gen p mean: 0.4483628273010254, gen p mean: -0.0393320769071579, mean p set: 0.4488431215286255
loss_pred:0.07131798565387726, decouple_loss:0.054053813219070435
Iteration: 58, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474042057991028, gen p mean: -0.041008464992046356, mean p set: 0.4478845000267029
The modified gen p mean: 0.4492430090904236, gen p mean: -0.04047505557537079, mean p set: 0.4497232735157013
The modified gen p mean: 0.4495560824871063, gen p mean: -0.040989574044942856, mean p set: 0.4500364065170288
loss_pred:0.07556695491075516, decouple_loss:0.052383918315172195
loss_pred:0.06971583515405655, decouple_loss:0.05158913880586624
loss_pred:0.07132821530103683, decouple_loss:0.05193914473056793
Iteration: 59, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823968410491943, gen p mean: -0.0422443225979805, mean p set: 0.44871997833251953
The modified gen p mean: 0.4483945965766907, gen p mean: -0.04185931757092476, mean p set: 0.4488748610019684
loss_pred:0.0718928724527359, decouple_loss:0.050356052815914154
The modified gen p mean: 0.4475352168083191, gen p mean: -0.04194817692041397, mean p set: 0.4480155408382416
loss_pred:0.07164683938026428, decouple_loss:0.05208031088113785
loss_pred:0.07226528972387314, decouple_loss:0.051022015511989594
Iteration: 60, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464145600795746, gen p mean: -0.046042654663324356, mean p set: 0.4468948543071747
The modified gen p mean: 0.4475768804550171, gen p mean: -0.04598649963736534, mean p set: 0.4480571746826172
loss_pred:0.07357213646173477, decouple_loss:0.0487443208694458
The modified gen p mean: 0.44891947507858276, gen p mean: -0.04555662348866463, mean p set: 0.44939976930618286
loss_pred:0.07350975275039673, decouple_loss:0.04860248416662216
loss_pred:0.07082647830247879, decouple_loss:0.05031523108482361
2023-04-19 00:44:24 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.050025977194309235, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.05029715225100517, mean p set: 0.4498290419578552
The modified gen p mean: 0.44831880927085876, gen p mean: -0.050403062254190445, mean p set: 0.44879910349845886
loss_pred:0.06936433166265488, decouple_loss:0.05091940984129906
loss_pred:0.07146289944648743, decouple_loss:0.05036172643303871
loss_pred:0.07168281823396683, decouple_loss:0.05160389468073845
WV_0_PC_1_EH_0_PS_40, loss: 0.07338476181030273, avg_mse: 0.07073464244604111
current test mse: 0.070735
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 61, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468989074230194, gen p mean: -0.050116267055273056, mean p set: 0.4473792016506195
loss_pred:0.0742468386888504, decouple_loss:0.051622554659843445
The modified gen p mean: 0.44741091132164, gen p mean: -0.049922432750463486, mean p set: 0.4478912055492401
loss_pred:0.07257483899593353, decouple_loss:0.053267862647771835
The modified gen p mean: 0.44764891266822815, gen p mean: -0.04982038959860802, mean p set: 0.44812917709350586
loss_pred:0.07194627821445465, decouple_loss:0.05329960957169533
Iteration: 62, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44774553179740906, gen p mean: -0.051820117980241776, mean p set: 0.44822585582733154
loss_pred:0.07541859894990921, decouple_loss:0.05401922017335892
The modified gen p mean: 0.4474720358848572, gen p mean: -0.05186602100729942, mean p set: 0.4479523003101349
The modified gen p mean: 0.44735175371170044, gen p mean: -0.05148182809352875, mean p set: 0.44783204793930054
loss_pred:0.07593509554862976, decouple_loss:0.05460887774825096
loss_pred:0.07231555879116058, decouple_loss:0.05552598461508751
Iteration: 63, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797784090042114, gen p mean: -0.05185217782855034, mean p set: 0.44845813512802124
The modified gen p mean: 0.44857919216156006, gen p mean: -0.05195476859807968, mean p set: 0.44905948638916016
loss_pred:0.07228218764066696, decouple_loss:0.055128313601017
loss_pred:0.07580496370792389, decouple_loss:0.05338653549551964
The modified gen p mean: 0.44757816195487976, gen p mean: -0.051848869770765305, mean p set: 0.44805845618247986
loss_pred:0.0721314325928688, decouple_loss:0.05348488315939903
Iteration: 64, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750165939331055, gen p mean: -0.05651681125164032, mean p set: 0.44798195362091064
The modified gen p mean: 0.4470285177230835, gen p mean: -0.056872330605983734, mean p set: 0.4475088119506836
loss_pred:0.07310705631971359, decouple_loss:0.05087854713201523
loss_pred:0.07378411293029785, decouple_loss:0.04942328855395317
The modified gen p mean: 0.44962751865386963, gen p mean: -0.0566956102848053, mean p set: 0.45010778307914734
loss_pred:0.07320106029510498, decouple_loss:0.04947798699140549
Iteration: 65, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486341178417206, gen p mean: -0.06340622156858444, mean p set: 0.4491144120693207
The modified gen p mean: 0.44780397415161133, gen p mean: -0.06306452304124832, mean p set: 0.4482842683792114
The modified gen p mean: 0.449092298746109, gen p mean: -0.06350864470005035, mean p set: 0.4495725929737091
loss_pred:0.0729789286851883, decouple_loss:0.07240813225507736
loss_pred:0.07443712651729584, decouple_loss:0.0709366574883461
loss_pred:0.07124774158000946, decouple_loss:0.07257750630378723
Iteration: 66, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797438383102417, gen p mean: -0.06567659229040146, mean p set: 0.44845467805862427
The modified gen p mean: 0.44704321026802063, gen p mean: -0.0652189552783966, mean p set: 0.4475235044956207
loss_pred:0.07146160304546356, decouple_loss:0.04877869412302971
loss_pred:0.06922142952680588, decouple_loss:0.048661813139915466
The modified gen p mean: 0.447274774312973, gen p mean: -0.06567838788032532, mean p set: 0.44775503873825073
loss_pred:0.07193328440189362, decouple_loss:0.049025919288396835
Iteration: 67, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473133385181427, gen p mean: -0.06820869445800781, mean p set: 0.4477936327457428
loss_pred:0.07054406404495239, decouple_loss:0.05620570853352547
The modified gen p mean: 0.44668814539909363, gen p mean: -0.06851733475923538, mean p set: 0.4471684396266937
loss_pred:0.07320836931467056, decouple_loss:0.06226346641778946
The modified gen p mean: 0.4475351870059967, gen p mean: -0.0678572803735733, mean p set: 0.4480154812335968
loss_pred:0.07069851458072662, decouple_loss:0.063726045191288
Iteration: 68, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471355676651001, gen p mean: -0.0757657065987587, mean p set: 0.4476158618927002
The modified gen p mean: 0.44720175862312317, gen p mean: -0.07529302686452866, mean p set: 0.44768205285072327
loss_pred:0.07185932248830795, decouple_loss:0.050783250480890274
loss_pred:0.07166492938995361, decouple_loss:0.05149699002504349
The modified gen p mean: 0.4482946991920471, gen p mean: -0.07576452195644379, mean p set: 0.4487749934196472
loss_pred:0.0683232769370079, decouple_loss:0.052157141268253326
Iteration: 69, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776228070259094, gen p mean: -0.08334822952747345, mean p set: 0.44824254512786865
The modified gen p mean: 0.4488285779953003, gen p mean: -0.08245937526226044, mean p set: 0.449308842420578
loss_pred:0.07503978908061981, decouple_loss:0.050166625529527664
loss_pred:0.06836959719657898, decouple_loss:0.04712796211242676
The modified gen p mean: 0.44768840074539185, gen p mean: -0.08287004381418228, mean p set: 0.44816869497299194
loss_pred:0.0715978592634201, decouple_loss:0.04674149304628372
Iteration: 70, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773584604263306, gen p mean: -0.08420785516500473, mean p set: 0.44821614027023315
loss_pred:0.06888324022293091, decouple_loss:0.05157162621617317
The modified gen p mean: 0.4481147825717926, gen p mean: -0.08447253704071045, mean p set: 0.4485950767993927
The modified gen p mean: 0.44870510697364807, gen p mean: -0.08449551463127136, mean p set: 0.44918543100357056
loss_pred:0.06931255012750626, decouple_loss:0.04898039624094963
loss_pred:0.06692250072956085, decouple_loss:0.0524737574160099
2023-04-19 00:47:03 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.0874558687210083, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.08776085078716278, mean p set: 0.4498290419578552
The modified gen p mean: 0.44831880927085876, gen p mean: -0.08782636374235153, mean p set: 0.44879910349845886
loss_pred:0.0669289231300354, decouple_loss:0.053190864622592926
loss_pred:0.06886908411979675, decouple_loss:0.05243741720914841
loss_pred:0.06827182322740555, decouple_loss:0.05284895747900009
WV_0_PC_1_EH_0_PS_40, loss: 0.07066456973552704, avg_mse: 0.0679379552602768
current test mse: 0.067938
Iteration: 71, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808363914489746, gen p mean: -0.08855223655700684, mean p set: 0.44856393337249756
loss_pred:0.07116729766130447, decouple_loss:0.05121013894677162
The modified gen p mean: 0.4467989206314087, gen p mean: -0.08790580928325653, mean p set: 0.4472792148590088
The modified gen p mean: 0.4476890563964844, gen p mean: -0.08721895515918732, mean p set: 0.4481693506240845loss_pred:0.07073812931776047, decouple_loss:0.05234129726886749
loss_pred:0.06789688020944595, decouple_loss:0.04946180433034897
Iteration: 72, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478875398635864, gen p mean: -0.08689353615045547, mean p set: 0.44836780428886414
loss_pred:0.06988419592380524, decouple_loss:0.05210834741592407
The modified gen p mean: 0.4470593333244324, gen p mean: -0.08763822168111801, mean p set: 0.44753962755203247
The modified gen p mean: 0.4475812017917633, gen p mean: -0.08798328787088394, mean p set: 0.4480615258216858
loss_pred:0.06877055019140244, decouple_loss:0.05235300585627556
loss_pred:0.07031799107789993, decouple_loss:0.05004989355802536
Iteration: 73, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815152883529663, gen p mean: -0.09111665934324265, mean p set: 0.44863179326057434
The modified gen p mean: 0.44766753911972046, gen p mean: -0.09139787405729294, mean p set: 0.44814783334732056
loss_pred:0.06465605646371841, decouple_loss:0.04678579792380333
loss_pred:0.0718010738492012, decouple_loss:0.04619516432285309
The modified gen p mean: 0.44812625646591187, gen p mean: -0.09159733355045319, mean p set: 0.44860655069351196
loss_pred:0.06953155249357224, decouple_loss:0.04596251621842384
Iteration: 74, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479402005672455, gen p mean: -0.09454388916492462, mean p set: 0.44842052459716797
loss_pred:0.06628881394863129, decouple_loss:0.04813369736075401
The modified gen p mean: 0.4480414092540741, gen p mean: -0.09481817483901978, mean p set: 0.4485217034816742
loss_pred:0.06456106901168823, decouple_loss:0.04972701892256737
The modified gen p mean: 0.4478502869606018, gen p mean: -0.09407939016819, mean p set: 0.4483305513858795
loss_pred:0.06660930812358856, decouple_loss:0.04497813060879707
Iteration: 75, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481607973575592, gen p mean: -0.09789908677339554, mean p set: 0.4486410617828369
The modified gen p mean: 0.44769522547721863, gen p mean: -0.09825151413679123, mean p set: 0.4481755197048187
loss_pred:0.06658592075109482, decouple_loss:0.051721811294555664
loss_pred:0.06738115102052689, decouple_loss:0.050279513001441956
The modified gen p mean: 0.4490791857242584, gen p mean: -0.09821026027202606, mean p set: 0.4495594799518585
loss_pred:0.07000065594911575, decouple_loss:0.05220596119761467
Iteration: 76, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471810758113861, gen p mean: -0.10376115143299103, mean p set: 0.4476613700389862
loss_pred:0.06947746127843857, decouple_loss:0.04832244664430618The modified gen p mean: 0.44720330834388733, gen p mean: -0.10371069610118866, mean p set: 0.4476836025714874
The modified gen p mean: 0.44778740406036377, gen p mean: -0.10406023263931274, mean p set: 0.4482676684856415
loss_pred:0.06930610537528992, decouple_loss:0.05067368596792221
loss_pred:0.07068042457103729, decouple_loss:0.04832755774259567
Iteration: 77, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715616106987, gen p mean: -0.10387617349624634, mean p set: 0.4476364552974701
The modified gen p mean: 0.4473905563354492, gen p mean: -0.1047186329960823, mean p set: 0.4478708505630493
loss_pred:0.06673693656921387, decouple_loss:0.043822500854730606
loss_pred:0.0683489590883255, decouple_loss:0.04590076580643654
The modified gen p mean: 0.4494800865650177, gen p mean: -0.1047050952911377, mean p set: 0.4499603509902954
loss_pred:0.06698141992092133, decouple_loss:0.04435095563530922
Iteration: 78, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446834534406662, gen p mean: -0.10648089647293091, mean p set: 0.4473148286342621
The modified gen p mean: 0.44653695821762085, gen p mean: -0.10583911836147308, mean p set: 0.44701725244522095
loss_pred:0.0686342865228653, decouple_loss:0.05768587440252304
loss_pred:0.06767711788415909, decouple_loss:0.06024076044559479
The modified gen p mean: 0.4486345052719116, gen p mean: -0.10619692504405975, mean p set: 0.4491148293018341
loss_pred:0.06566397845745087, decouple_loss:0.06048335134983063
Iteration: 79, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471130669116974, gen p mean: -0.1142195388674736, mean p set: 0.4475933611392975
loss_pred:0.06662032753229141, decouple_loss:0.049249403178691864
The modified gen p mean: 0.4478897452354431, gen p mean: -0.11458967626094818, mean p set: 0.4483700692653656
The modified gen p mean: 0.4481104910373688, gen p mean: -0.11473040282726288, mean p set: 0.44859078526496887
loss_pred:0.061925169080495834, decouple_loss:0.0479450449347496
loss_pred:0.06597130745649338, decouple_loss:0.051252514123916626
Iteration: 80, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765564799308777, gen p mean: -0.12305698543787003, mean p set: 0.44813597202301025
loss_pred:0.0660262331366539, decouple_loss:0.061158161610364914
The modified gen p mean: 0.4485374093055725, gen p mean: -0.12413130700588226, mean p set: 0.4490176737308502
The modified gen p mean: 0.4473233222961426, gen p mean: -0.12362966686487198, mean p set: 0.44780364632606506
loss_pred:0.0678890272974968, decouple_loss:0.05922921001911163
loss_pred:0.06729597598314285, decouple_loss:0.05791579559445381
2023-04-19 00:48:57 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.12631447613239288, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.12663660943508148, mean p set: 0.4498290419578552
The modified gen p mean: 0.44831880927085876, gen p mean: -0.12662850320339203, mean p set: 0.44879910349845886
loss_pred:0.06344127655029297, decouple_loss:0.048048973083496094
loss_pred:0.06567233800888062, decouple_loss:0.04779506102204323
loss_pred:0.065237857401371, decouple_loss:0.04751352220773697
WV_0_PC_1_EH_0_PS_40, loss: 0.06717311590909958, avg_mse: 0.06452837586402893
current test mse: 0.064528
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 81, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468684494495392, gen p mean: -0.12565690279006958, mean p set: 0.4473487436771393
loss_pred:0.0682063028216362, decouple_loss:0.04934963211417198
The modified gen p mean: 0.44645360112190247, gen p mean: -0.12663842737674713, mean p set: 0.44693389534950256
loss_pred:0.06444087624549866, decouple_loss:0.046841174364089966
The modified gen p mean: 0.44765836000442505, gen p mean: -0.12605717778205872, mean p set: 0.44813862442970276
loss_pred:0.06566363573074341, decouple_loss:0.04764377698302269
Iteration: 82, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476199746131897, gen p mean: -0.12390844523906708, mean p set: 0.4481002688407898
loss_pred:0.06849430501461029, decouple_loss:0.05107387900352478
The modified gen p mean: 0.4471588730812073, gen p mean: -0.1252029985189438, mean p set: 0.4476391673088074
The modified gen p mean: 0.44643887877464294, gen p mean: -0.12362142652273178, mean p set: 0.44691917300224304
loss_pred:0.0673326849937439, decouple_loss:0.055122293531894684
loss_pred:0.06721983104944229, decouple_loss:0.05438865348696709
Iteration: 83, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483950734138489, gen p mean: -0.12506140768527985, mean p set: 0.448875367641449
The modified gen p mean: 0.44617441296577454, gen p mean: -0.1242847889661789, mean p set: 0.44665467739105225
loss_pred:0.06840740144252777, decouple_loss:0.050200723111629486
loss_pred:0.06499282270669937, decouple_loss:0.049103885889053345
The modified gen p mean: 0.4489873945713043, gen p mean: -0.12502634525299072, mean p set: 0.4494676887989044
loss_pred:0.06874147057533264, decouple_loss:0.05055328831076622
Iteration: 84, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44738584756851196, gen p mean: -0.1286214292049408, mean p set: 0.4478660821914673
The modified gen p mean: 0.4483235776424408, gen p mean: -0.12953568994998932, mean p set: 0.4488039016723633
loss_pred:0.0673149973154068, decouple_loss:0.05364168435335159
loss_pred:0.06144143268465996, decouple_loss:0.053058601915836334
The modified gen p mean: 0.44668376445770264, gen p mean: -0.12921440601348877, mean p set: 0.44716405868530273
loss_pred:0.06401944905519485, decouple_loss:0.05188516527414322
Iteration: 85, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472024142742157, gen p mean: -0.1361737698316574, mean p set: 0.4476827085018158
loss_pred:0.06451037526130676, decouple_loss:0.05592164769768715
The modified gen p mean: 0.4479721784591675, gen p mean: -0.13565082848072052, mean p set: 0.4484524726867676
The modified gen p mean: 0.4480445384979248, gen p mean: -0.13774748146533966, mean p set: 0.4485248327255249
loss_pred:0.06605938076972961, decouple_loss:0.056745756417512894
loss_pred:0.06542656570672989, decouple_loss:0.05736463516950607
Iteration: 86, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448159396648407, gen p mean: -0.13523438572883606, mean p set: 0.4486396908760071
loss_pred:0.06471607089042664, decouple_loss:0.05071845278143883
The modified gen p mean: 0.44690242409706116, gen p mean: -0.13461078703403473, mean p set: 0.44738268852233887
The modified gen p mean: 0.44751372933387756, gen p mean: -0.13483282923698425, mean p set: 0.4479939937591553
loss_pred:0.06381306052207947, decouple_loss:0.04988841712474823
loss_pred:0.06626594066619873, decouple_loss:0.05018961429595947
Iteration: 87, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486221969127655, gen p mean: -0.13206109404563904, mean p set: 0.4491024613380432
loss_pred:0.06503169238567352, decouple_loss:0.05669011175632477
The modified gen p mean: 0.44828876852989197, gen p mean: -0.13227222859859467, mean p set: 0.44876906275749207
The modified gen p mean: 0.44793081283569336, gen p mean: -0.13110464811325073, mean p set: 0.44841110706329346
loss_pred:0.06337936967611313, decouple_loss:0.05382108688354492
loss_pred:0.06643753498792648, decouple_loss:0.05869722366333008
Iteration: 88, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485139846801758, gen p mean: -0.1346283257007599, mean p set: 0.4489942789077759
loss_pred:0.06703076511621475, decouple_loss:0.05547109246253967
The modified gen p mean: 0.44797995686531067, gen p mean: -0.13484366238117218, mean p set: 0.44846025109291077
The modified gen p mean: 0.4472668766975403, gen p mean: -0.13316145539283752, mean p set: 0.447747141122818
loss_pred:0.06092645972967148, decouple_loss:0.05516226962208748
loss_pred:0.062528096139431, decouple_loss:0.057073090225458145
Iteration: 89, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477499723434448, gen p mean: -0.14426134526729584, mean p set: 0.4482302665710449
The modified gen p mean: 0.44779494404792786, gen p mean: -0.14303389191627502, mean p set: 0.44827526807785034
loss_pred:0.060763049870729446, decouple_loss:0.05533287674188614
loss_pred:0.06303660571575165, decouple_loss:0.058539919555187225
The modified gen p mean: 0.4479027986526489, gen p mean: -0.14318397641181946, mean p set: 0.4483831226825714
loss_pred:0.06417275220155716, decouple_loss:0.05841775983572006
Iteration: 90, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798722863197327, gen p mean: -0.15506146848201752, mean p set: 0.44846752285957336
loss_pred:0.06274168938398361, decouple_loss:0.04903968796133995
The modified gen p mean: 0.4484352171421051, gen p mean: -0.15586869418621063, mean p set: 0.4489155113697052
The modified gen p mean: 0.4472697675228119, gen p mean: -0.15344826877117157, mean p set: 0.4477500915527344
loss_pred:0.067137211561203, decouple_loss:0.04961740970611572
loss_pred:0.06367897242307663, decouple_loss:0.04725029319524765
2023-04-19 00:51:30 testing...
The modified gen p mean: 0.44943100214004517, gen p mean: -0.15515263378620148, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.15538208186626434, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.1553608626127243, mean p set: 0.44879910349845886
loss_pred:0.06209583207964897, decouple_loss:0.05367117002606392
loss_pred:0.06432481855154037, decouple_loss:0.05368872359395027
loss_pred:0.06318175047636032, decouple_loss:0.05405034124851227
WV_0_PC_1_EH_0_PS_40, loss: 0.06589096784591675, avg_mse: 0.06339358538389206
current test mse: 0.063394
Iteration: 91, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483543634414673, gen p mean: -0.15729449689388275, mean p set: 0.4488346576690674
The modified gen p mean: 0.4490039348602295, gen p mean: -0.15737101435661316, mean p set: 0.449484258890152
loss_pred:0.0662543848156929, decouple_loss:0.05624114349484444
loss_pred:0.06471152603626251, decouple_loss:0.05584122613072395
The modified gen p mean: 0.44762831926345825, gen p mean: -0.1546718031167984, mean p set: 0.44810861349105835
loss_pred:0.06280140578746796, decouple_loss:0.05564774200320244
Iteration: 92, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467870593070984, gen p mean: -0.1472160369157791, mean p set: 0.4472673535346985
The modified gen p mean: 0.44802576303482056, gen p mean: -0.14857152104377747, mean p set: 0.44850608706474304
loss_pred:0.06312451511621475, decouple_loss:0.04480133578181267
loss_pred:0.060366589576005936, decouple_loss:0.04578947275876999
The modified gen p mean: 0.44847428798675537, gen p mean: -0.14846065640449524, mean p set: 0.44895458221435547
loss_pred:0.06240245699882507, decouple_loss:0.044450514018535614
Iteration: 93, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481048285961151, gen p mean: -0.14840689301490784, mean p set: 0.4485850930213928
The modified gen p mean: 0.4466054439544678, gen p mean: -0.1474733203649521, mean p set: 0.4470857083797455
loss_pred:0.05924384295940399, decouple_loss:0.05358061566948891
loss_pred:0.06203416734933853, decouple_loss:0.05361773818731308
The modified gen p mean: 0.44811391830444336, gen p mean: -0.14778584241867065, mean p set: 0.44859424233436584
loss_pred:0.06309476494789124, decouple_loss:0.05570375919342041
Iteration: 94, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778189063072205, gen p mean: -0.15377099812030792, mean p set: 0.44826218485832214The modified gen p mean: 0.4469769597053528, gen p mean: -0.15306100249290466, mean p set: 0.4474572539329529
loss_pred:0.06272297352552414, decouple_loss:0.04835178703069687loss_pred:0.062108222395181656, decouple_loss:0.04871242120862007
The modified gen p mean: 0.44781970977783203, gen p mean: -0.15301793813705444, mean p set: 0.44829997420310974
loss_pred:0.06374718248844147, decouple_loss:0.05069435387849808
Iteration: 95, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477563202381134, gen p mean: -0.16063494980335236, mean p set: 0.4482366442680359
The modified gen p mean: 0.4482094943523407, gen p mean: -0.15902327001094818, mean p set: 0.4486897885799408
loss_pred:0.06147562712430954, decouple_loss:0.04475590959191322
loss_pred:0.06206091120839119, decouple_loss:0.04424815997481346
The modified gen p mean: 0.44692468643188477, gen p mean: -0.1584744155406952, mean p set: 0.44740498065948486
loss_pred:0.06076135113835335, decouple_loss:0.04561573266983032
Iteration: 96, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479478597640991, gen p mean: -0.15887221693992615, mean p set: 0.4484281837940216
The modified gen p mean: 0.44948098063468933, gen p mean: -0.16077128052711487, mean p set: 0.4499613046646118
loss_pred:0.06291639059782028, decouple_loss:0.04497997835278511
loss_pred:0.06663837283849716, decouple_loss:0.04632917046546936
The modified gen p mean: 0.44826120138168335, gen p mean: -0.15867315232753754, mean p set: 0.44874149560928345
loss_pred:0.05862889811396599, decouple_loss:0.045951664447784424
Iteration: 97, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44713103771209717, gen p mean: -0.15822051465511322, mean p set: 0.44761136174201965
loss_pred:0.05871794745326042, decouple_loss:0.04509151726961136
The modified gen p mean: 0.4475749433040619, gen p mean: -0.15802282094955444, mean p set: 0.4480552673339844
loss_pred:0.060952167958021164, decouple_loss:0.04284286871552467
The modified gen p mean: 0.44743579626083374, gen p mean: -0.15928977727890015, mean p set: 0.44791606068611145
loss_pred:0.06219957023859024, decouple_loss:0.04757411405444145
Iteration: 98, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449179083108902, gen p mean: -0.16065838932991028, mean p set: 0.4496593773365021
The modified gen p mean: 0.44736436009407043, gen p mean: -0.15972118079662323, mean p set: 0.4478446841239929
loss_pred:0.0640464574098587, decouple_loss:0.04254600778222084
loss_pred:0.06105212867259979, decouple_loss:0.04257785901427269
The modified gen p mean: 0.4476766884326935, gen p mean: -0.1589762419462204, mean p set: 0.44815701246261597
loss_pred:0.06362646818161011, decouple_loss:0.04150250926613808
Iteration: 99, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977760314941406, gen p mean: -0.1580837368965149, mean p set: 0.45025789737701416
The modified gen p mean: 0.44857507944107056, gen p mean: -0.155583456158638, mean p set: 0.44905540347099304
loss_pred:0.06506657600402832, decouple_loss:0.039981115609407425
loss_pred:0.06398218125104904, decouple_loss:0.047680873423814774
The modified gen p mean: 0.44687357544898987, gen p mean: -0.15573938190937042, mean p set: 0.44735386967658997
loss_pred:0.06274363398551941, decouple_loss:0.04382137581706047
Iteration: 100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449349045753479, gen p mean: -0.1601325422525406, mean p set: 0.4498293101787567
loss_pred:0.06347491592168808, decouple_loss:0.038839299231767654
The modified gen p mean: 0.4469151496887207, gen p mean: -0.1583317071199417, mean p set: 0.4473954439163208
The modified gen p mean: 0.4479162395000458, gen p mean: -0.16024424135684967, mean p set: 0.4483965039253235
loss_pred:0.06349724531173706, decouple_loss:0.03940563276410103
loss_pred:0.06011087819933891, decouple_loss:0.03912661597132683
2023-04-19 00:53:24 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.16094687581062317, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.1610942780971527, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.16079817712306976, mean p set: 0.44879910349845886
loss_pred:0.061377909034490585, decouple_loss:0.0409608818590641
loss_pred:0.06305273622274399, decouple_loss:0.04094421863555908
loss_pred:0.061947550624608994, decouple_loss:0.040685560554265976
WV_0_PC_1_EH_0_PS_40, loss: 0.06416924297809601, avg_mse: 0.06221157684922218
current test mse: 0.062212
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478103518486023, gen p mean: -0.16139262914657593, mean p set: 0.44829061627388
loss_pred:0.061357513070106506, decouple_loss:0.040080003440380096
The modified gen p mean: 0.44851556420326233, gen p mean: -0.1608637124300003, mean p set: 0.4489958584308624
loss_pred:0.06565656512975693, decouple_loss:0.04213685542345047
The modified gen p mean: 0.4478776156902313, gen p mean: -0.16048794984817505, mean p set: 0.4483579099178314
loss_pred:0.06089959293603897, decouple_loss:0.04080799221992493
Iteration: 102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491003453731537, gen p mean: -0.15691544115543365, mean p set: 0.4495806396007538
loss_pred:0.061524298042058945, decouple_loss:0.03788037225604057
The modified gen p mean: 0.44893208146095276, gen p mean: -0.155329167842865, mean p set: 0.44941237568855286
The modified gen p mean: 0.44827431440353394, gen p mean: -0.15473809838294983, mean p set: 0.4487546384334564
loss_pred:0.064726822078228, decouple_loss:0.036703068763017654
loss_pred:0.06768051534891129, decouple_loss:0.036566007882356644
Iteration: 103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493091106414795, gen p mean: -0.14635729789733887, mean p set: 0.4497894048690796
loss_pred:0.06059938296675682, decouple_loss:0.03903169557452202
The modified gen p mean: 0.45006632804870605, gen p mean: -0.14425496757030487, mean p set: 0.45054665207862854
loss_pred:0.06398840248584747, decouple_loss:0.038136374205350876
The modified gen p mean: 0.44885823130607605, gen p mean: -0.14472436904907227, mean p set: 0.44933852553367615
loss_pred:0.06094343960285187, decouple_loss:0.03964966535568237
Iteration: 104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494502544403076, gen p mean: -0.1392725557088852, mean p set: 0.4499305486679077
loss_pred:0.05943938344717026, decouple_loss:0.039036404341459274
The modified gen p mean: 0.4496171176433563, gen p mean: -0.13865873217582703, mean p set: 0.4500974118709564
loss_pred:0.06383269280195236, decouple_loss:0.0406838096678257
The modified gen p mean: 0.44955405592918396, gen p mean: -0.13924945890903473, mean p set: 0.45003435015678406
loss_pred:0.05972013249993324, decouple_loss:0.03871183469891548
Iteration: 105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862130284309387, gen p mean: -0.14291344583034515, mean p set: 0.44910159707069397
loss_pred:0.06410136818885803, decouple_loss:0.039249077439308167
The modified gen p mean: 0.44786709547042847, gen p mean: -0.14138993620872498, mean p set: 0.44834738969802856
loss_pred:0.06088821589946747, decouple_loss:0.03737475723028183
The modified gen p mean: 0.44802823662757874, gen p mean: -0.14211827516555786, mean p set: 0.44850850105285645
loss_pred:0.0608128122985363, decouple_loss:0.03785930946469307
Iteration: 106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510590434074402, gen p mean: -0.14984992146492004, mean p set: 0.4515393376350403
loss_pred:0.062108274549245834, decouple_loss:0.03975538909435272
The modified gen p mean: 0.4492394030094147, gen p mean: -0.1499568372964859, mean p set: 0.44971972703933716
loss_pred:0.059551090002059937, decouple_loss:0.03941281512379646
The modified gen p mean: 0.44982975721359253, gen p mean: -0.15123394131660461, mean p set: 0.450310081243515
loss_pred:0.06391598284244537, decouple_loss:0.04484451562166214
Iteration: 107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498286545276642, gen p mean: -0.15298466384410858, mean p set: 0.4503089487552643
loss_pred:0.058945391327142715, decouple_loss:0.038391564041376114
The modified gen p mean: 0.4490082561969757, gen p mean: -0.15341536700725555, mean p set: 0.4494885504245758
loss_pred:0.06376711279153824, decouple_loss:0.04053251072764397
The modified gen p mean: 0.4500400722026825, gen p mean: -0.15230593085289001, mean p set: 0.450520396232605
loss_pred:0.06250572204589844, decouple_loss:0.0388028547167778
Iteration: 108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506920874118805, gen p mean: -0.14452864229679108, mean p set: 0.451172411441803
The modified gen p mean: 0.4490033984184265, gen p mean: -0.1446375548839569, mean p set: 0.4494836926460266
loss_pred:0.06260504573583603, decouple_loss:0.037078771740198135
loss_pred:0.05881497263908386, decouple_loss:0.038397859781980515
The modified gen p mean: 0.45011135935783386, gen p mean: -0.14492133259773254, mean p set: 0.45059165358543396
loss_pred:0.06234689801931381, decouple_loss:0.03731594979763031
Iteration: 109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784530997276306, gen p mean: -0.1394292414188385, mean p set: 0.44832560420036316
The modified gen p mean: 0.4494500458240509, gen p mean: -0.14203372597694397, mean p set: 0.4499303698539734loss_pred:0.061698053032159805, decouple_loss:0.03732043877243996
loss_pred:0.06499242037534714, decouple_loss:0.03820635378360748
The modified gen p mean: 0.4483445882797241, gen p mean: -0.14062780141830444, mean p set: 0.4488248825073242
loss_pred:0.06498220562934875, decouple_loss:0.03627382591366768
Iteration: 110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492962062358856, gen p mean: -0.1382434070110321, mean p set: 0.44977647066116333
The modified gen p mean: 0.4479655921459198, gen p mean: -0.1372273564338684, mean p set: 0.4484458863735199
loss_pred:0.06216844543814659, decouple_loss:0.03556958585977554
loss_pred:0.06138549745082855, decouple_loss:0.038618046790361404
The modified gen p mean: 0.44937968254089355, gen p mean: -0.1381683051586151, mean p set: 0.44986000657081604
loss_pred:0.06232890859246254, decouple_loss:0.035362713038921356
2023-04-19 00:55:58 testing...
The modified gen p mean: 0.44943100214004517, gen p mean: -0.13915765285491943, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.13899879157543182, mean p set: 0.4498290419578552
The modified gen p mean: 0.44831880927085876, gen p mean: -0.13886307179927826, mean p set: 0.44879910349845886
loss_pred:0.06152772903442383, decouple_loss:0.0358257032930851
loss_pred:0.06313027441501617, decouple_loss:0.03568805009126663
loss_pred:0.06164999678730965, decouple_loss:0.03539663553237915
WV_0_PC_1_EH_0_PS_40, loss: 0.06388451159000397, avg_mse: 0.06222423166036606
current test mse: 0.062224
Iteration: 111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44956347346305847, gen p mean: -0.1402856558561325, mean p set: 0.45004376769065857
The modified gen p mean: 0.4495351314544678, gen p mean: -0.13964827358722687, mean p set: 0.4500153958797455
loss_pred:0.060122378170490265, decouple_loss:0.036168940365314484
loss_pred:0.060635220259428024, decouple_loss:0.03561515733599663
The modified gen p mean: 0.4479248821735382, gen p mean: -0.13999409973621368, mean p set: 0.4484051764011383
loss_pred:0.06476978957653046, decouple_loss:0.03639081493020058
Iteration: 112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44861987233161926, gen p mean: -0.12971056997776031, mean p set: 0.44910016655921936
The modified gen p mean: 0.44823339581489563, gen p mean: -0.12906309962272644, mean p set: 0.4487136900424957
loss_pred:0.0603945329785347, decouple_loss:0.03563704714179039
loss_pred:0.06600669026374817, decouple_loss:0.035027019679546356
The modified gen p mean: 0.4475609362125397, gen p mean: -0.12944762408733368, mean p set: 0.4480412006378174
loss_pred:0.061757735908031464, decouple_loss:0.036026593297719955
Iteration: 113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44875583052635193, gen p mean: -0.13040967285633087, mean p set: 0.449236124753952
The modified gen p mean: 0.4483950734138489, gen p mean: -0.12988729774951935, mean p set: 0.4488753378391266
loss_pred:0.059409383684396744, decouple_loss:0.03524332866072655
loss_pred:0.06225061044096947, decouple_loss:0.035225994884967804
The modified gen p mean: 0.4499236047267914, gen p mean: -0.1298171579837799, mean p set: 0.4504038989543915
loss_pred:0.06089983880519867, decouple_loss:0.03580685332417488
Iteration: 114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849181175231934, gen p mean: -0.13871730864048004, mean p set: 0.44897210597991943
The modified gen p mean: 0.448874831199646, gen p mean: -0.13806594908237457, mean p set: 0.4493550956249237
loss_pred:0.06405669450759888, decouple_loss:0.03675489500164986
loss_pred:0.06302716583013535, decouple_loss:0.035736117511987686
The modified gen p mean: 0.44851458072662354, gen p mean: -0.13847443461418152, mean p set: 0.44899484515190125
loss_pred:0.06313750892877579, decouple_loss:0.03320041298866272
Iteration: 115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948524236679077, gen p mean: -0.14048121869564056, mean p set: 0.44996556639671326
loss_pred:0.06377501785755157, decouple_loss:0.04399089515209198
The modified gen p mean: 0.4485279321670532, gen p mean: -0.13876119256019592, mean p set: 0.4490082263946533
loss_pred:0.06018485128879547, decouple_loss:0.03993602842092514
The modified gen p mean: 0.449035108089447, gen p mean: -0.13977442681789398, mean p set: 0.4495154023170471
loss_pred:0.06153449788689613, decouple_loss:0.038888175040483475
Iteration: 116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486909806728363, gen p mean: -0.12975823879241943, mean p set: 0.4491713047027588
The modified gen p mean: 0.44853314757347107, gen p mean: -0.13174580037593842, mean p set: 0.44901344180107117
loss_pred:0.06251580268144608, decouple_loss:0.035339631140232086
loss_pred:0.0627305805683136, decouple_loss:0.03760865703225136
The modified gen p mean: 0.44943416118621826, gen p mean: -0.13093777000904083, mean p set: 0.44991445541381836
loss_pred:0.06086418405175209, decouple_loss:0.03652867674827576
Iteration: 117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487936794757843, gen p mean: -0.1243898868560791, mean p set: 0.4492739737033844
loss_pred:0.06207247078418732, decouple_loss:0.03306974098086357
The modified gen p mean: 0.4492180645465851, gen p mean: -0.12435653805732727, mean p set: 0.4496983587741852
loss_pred:0.0647626668214798, decouple_loss:0.03292950987815857
The modified gen p mean: 0.4479435980319977, gen p mean: -0.12571725249290466, mean p set: 0.44842392206192017
loss_pred:0.05987504869699478, decouple_loss:0.032595016062259674
Iteration: 118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490712583065033, gen p mean: -0.1286853700876236, mean p set: 0.4495515525341034
The modified gen p mean: 0.4480951428413391, gen p mean: -0.12726038694381714, mean p set: 0.4485754370689392
loss_pred:0.05753256753087044, decouple_loss:0.03356866165995598
loss_pred:0.06438328325748444, decouple_loss:0.033428385853767395
The modified gen p mean: 0.44800865650177, gen p mean: -0.1281564086675644, mean p set: 0.44848892092704773
loss_pred:0.0641527995467186, decouple_loss:0.03600529953837395
Iteration: 119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449282169342041, gen p mean: -0.1320754736661911, mean p set: 0.4497624933719635
The modified gen p mean: 0.44879260659217834, gen p mean: -0.13273824751377106, mean p set: 0.44927287101745605
loss_pred:0.061567507684230804, decouple_loss:0.033978015184402466
loss_pred:0.06282781064510345, decouple_loss:0.0342269092798233
The modified gen p mean: 0.4490126073360443, gen p mean: -0.13317526876926422, mean p set: 0.4494929015636444
loss_pred:0.05823212489485741, decouple_loss:0.033514223992824554
Iteration: 120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44916248321533203, gen p mean: -0.13694976270198822, mean p set: 0.44964277744293213
The modified gen p mean: 0.44823217391967773, gen p mean: -0.13502348959445953, mean p set: 0.44871246814727783
loss_pred:0.06297647953033447, decouple_loss:0.03465893492102623
loss_pred:0.061517175287008286, decouple_loss:0.033610373735427856
The modified gen p mean: 0.448900431394577, gen p mean: -0.1344384253025055, mean p set: 0.4493807256221771
loss_pred:0.06251348555088043, decouple_loss:0.03308062627911568
2023-04-19 00:57:52 testing...
The modified gen p mean: 0.44943100214004517, gen p mean: -0.12976227700710297, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.12974052131175995, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.12945203483104706, mean p set: 0.44879910349845886
loss_pred:0.060101497918367386, decouple_loss:0.03359042853116989
loss_pred:0.061643410474061966, decouple_loss:0.0330258384346962
loss_pred:0.060445480048656464, decouple_loss:0.03340702876448631
WV_0_PC_1_EH_0_PS_40, loss: 0.06239718943834305, avg_mse: 0.06112687289714813
current test mse: 0.061127
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44720447063446045, gen p mean: -0.13022546470165253, mean p set: 0.44768473505973816
loss_pred:0.06185054033994675, decouple_loss:0.03487784042954445
The modified gen p mean: 0.4480394124984741, gen p mean: -0.12896907329559326, mean p set: 0.4485197067260742
loss_pred:0.05915464460849762, decouple_loss:0.033783070743083954
The modified gen p mean: 0.44812914729118347, gen p mean: -0.12994928658008575, mean p set: 0.44860947132110596
loss_pred:0.059631165117025375, decouple_loss:0.03318016976118088
Iteration: 122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44711413979530334, gen p mean: -0.12514103949069977, mean p set: 0.44759440422058105
loss_pred:0.06080089882016182, decouple_loss:0.03188858926296234
The modified gen p mean: 0.4478238523006439, gen p mean: -0.12595438957214355, mean p set: 0.448304146528244
The modified gen p mean: 0.44782400131225586, gen p mean: -0.12479649484157562, mean p set: 0.44830429553985596
loss_pred:0.06269224733114243, decouple_loss:0.03176674246788025
loss_pred:0.060934245586395264, decouple_loss:0.03211790323257446
Iteration: 123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486684203147888, gen p mean: -0.12573328614234924, mean p set: 0.4491487443447113
loss_pred:0.062337569892406464, decouple_loss:0.035839684307575226
The modified gen p mean: 0.4467315375804901, gen p mean: -0.12482556700706482, mean p set: 0.4472118318080902
The modified gen p mean: 0.447172075510025, gen p mean: -0.12577250599861145, mean p set: 0.4476523995399475
loss_pred:0.06209500506520271, decouple_loss:0.037064287811517715
loss_pred:0.06299961358308792, decouple_loss:0.037319574505090714
Iteration: 124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473575949668884, gen p mean: -0.12477820366621017, mean p set: 0.4478378891944885
loss_pred:0.059410955756902695, decouple_loss:0.034271929413080215
The modified gen p mean: 0.44782301783561707, gen p mean: -0.12375171482563019, mean p set: 0.44830334186553955
The modified gen p mean: 0.4479628801345825, gen p mean: -0.12539902329444885, mean p set: 0.448443204164505loss_pred:0.06256598979234695, decouple_loss:0.0342777818441391
loss_pred:0.05864984542131424, decouple_loss:0.03602342680096626
Iteration: 125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469960927963257, gen p mean: -0.12029742449522018, mean p set: 0.4474763870239258
loss_pred:0.060401756316423416, decouple_loss:0.034449294209480286
The modified gen p mean: 0.4469423294067383, gen p mean: -0.12024106085300446, mean p set: 0.447422593832016
The modified gen p mean: 0.44876834750175476, gen p mean: -0.12138115614652634, mean p set: 0.44924864172935486
loss_pred:0.059860710054636, decouple_loss:0.03484729304909706
loss_pred:0.062054343521595, decouple_loss:0.041920535266399384
Iteration: 126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44848939776420593, gen p mean: -0.1167462170124054, mean p set: 0.44896969199180603
The modified gen p mean: 0.4481221139431, gen p mean: -0.11662615835666656, mean p set: 0.4486024081707001
The modified gen p mean: 0.4472287595272064, gen p mean: -0.11628901213407516, mean p set: 0.4477090537548065
loss_pred:0.06200021132826805, decouple_loss:0.0407041534781456
loss_pred:0.06108233332633972, decouple_loss:0.038895390927791595
loss_pred:0.059134285897016525, decouple_loss:0.040053173899650574
Iteration: 127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446898490190506, gen p mean: -0.11405040323734283, mean p set: 0.4473787844181061
loss_pred:0.059919796884059906, decouple_loss:0.03591161593794823
The modified gen p mean: 0.44760164618492126, gen p mean: -0.11370527744293213, mean p set: 0.448081910610199
The modified gen p mean: 0.4477773904800415, gen p mean: -0.11377584934234619, mean p set: 0.4482576549053192
loss_pred:0.06290478259325027, decouple_loss:0.03476022183895111
loss_pred:0.059818461537361145, decouple_loss:0.03500974923372269
Iteration: 128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482623338699341, gen p mean: -0.11312014609575272, mean p set: 0.4487426280975342
loss_pred:0.06298013776540756, decouple_loss:0.03456058353185654
The modified gen p mean: 0.44818034768104553, gen p mean: -0.11440656334161758, mean p set: 0.44866064190864563
The modified gen p mean: 0.447181761264801, gen p mean: -0.11235538125038147, mean p set: 0.4476620554924011
loss_pred:0.05990340933203697, decouple_loss:0.03341612219810486
loss_pred:0.0595700778067112, decouple_loss:0.03486846387386322
Iteration: 129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484303593635559, gen p mean: -0.11484859883785248, mean p set: 0.448910653591156
loss_pred:0.0588463693857193, decouple_loss:0.03499425947666168
The modified gen p mean: 0.4465717077255249, gen p mean: -0.1142614483833313, mean p set: 0.4470519721508026The modified gen p mean: 0.4481261670589447, gen p mean: -0.11415132135152817, mean p set: 0.4486064314842224
loss_pred:0.05980595201253891, decouple_loss:0.035140007734298706
loss_pred:0.0564488060772419, decouple_loss:0.03580687195062637
Iteration: 130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472768306732178, gen p mean: -0.12012152373790741, mean p set: 0.4477570950984955
loss_pred:0.05959351360797882, decouple_loss:0.03264075517654419
The modified gen p mean: 0.4477587044239044, gen p mean: -0.12005248665809631, mean p set: 0.4482389986515045
The modified gen p mean: 0.4480065703392029, gen p mean: -0.12042862176895142, mean p set: 0.448486864566803
loss_pred:0.059295404702425, decouple_loss:0.0315009281039238
loss_pred:0.05944707244634628, decouple_loss:0.03335068002343178
2023-04-19 01:00:34 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.1256387084722519, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.12551991641521454, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.12514998018741608, mean p set: 0.44879910349845886
loss_pred:0.05902229994535446, decouple_loss:0.03263348713517189
loss_pred:0.06039465218782425, decouple_loss:0.03197072446346283
loss_pred:0.05934479832649231, decouple_loss:0.03151759132742882
WV_0_PC_1_EH_0_PS_40, loss: 0.06118928641080856, avg_mse: 0.059983979910612106
current test mse: 0.059984
Iteration: 131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741079211235046, gen p mean: -0.12628620862960815, mean p set: 0.44789108633995056
loss_pred:0.0657254308462143, decouple_loss:0.03641108423471451
The modified gen p mean: 0.4464516043663025, gen p mean: -0.12569861114025116, mean p set: 0.4469318985939026
The modified gen p mean: 0.448211133480072, gen p mean: -0.12537680566310883, mean p set: 0.44869139790534973
loss_pred:0.06268012523651123, decouple_loss:0.03283990919589996
loss_pred:0.056210845708847046, decouple_loss:0.03332337737083435
Iteration: 132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472237229347229, gen p mean: -0.12574027478694916, mean p set: 0.4477039873600006
loss_pred:0.0563412643969059, decouple_loss:0.03453924134373665
The modified gen p mean: 0.44735005497932434, gen p mean: -0.12707355618476868, mean p set: 0.44783034920692444
loss_pred:0.06052282080054283, decouple_loss:0.034257881343364716
The modified gen p mean: 0.44752365350723267, gen p mean: -0.12732680141925812, mean p set: 0.44800394773483276
loss_pred:0.06003449112176895, decouple_loss:0.035209041088819504
Iteration: 133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488455355167389, gen p mean: -0.12505608797073364, mean p set: 0.449325829744339
loss_pred:0.059026118367910385, decouple_loss:0.034665949642658234
The modified gen p mean: 0.44840559363365173, gen p mean: -0.12499289214611053, mean p set: 0.44888588786125183
The modified gen p mean: 0.4485773742198944, gen p mean: -0.12554451823234558, mean p set: 0.4490576982498169
loss_pred:0.05855783820152283, decouple_loss:0.03496509790420532
loss_pred:0.05919290706515312, decouple_loss:0.03219537064433098
Iteration: 134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44917985796928406, gen p mean: -0.11932452023029327, mean p set: 0.44966015219688416
loss_pred:0.05774959549307823, decouple_loss:0.037337955087423325
The modified gen p mean: 0.447144091129303, gen p mean: -0.11798668652772903, mean p set: 0.44762441515922546
The modified gen p mean: 0.44710662961006165, gen p mean: -0.11791058629751205, mean p set: 0.44758692383766174
loss_pred:0.059363823384046555, decouple_loss:0.03919226676225662
loss_pred:0.06352878361940384, decouple_loss:0.04193904623389244
Iteration: 135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44666987657546997, gen p mean: -0.10822753608226776, mean p set: 0.4471501410007477
loss_pred:0.0608137845993042, decouple_loss:0.03509572148323059
The modified gen p mean: 0.4468585252761841, gen p mean: -0.11028839647769928, mean p set: 0.4473388195037842
The modified gen p mean: 0.44752150774002075, gen p mean: -0.11078571528196335, mean p set: 0.44800183176994324loss_pred:0.06227518245577812, decouple_loss:0.034821320325136185
loss_pred:0.05951046943664551, decouple_loss:0.03521539643406868
Iteration: 136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476369321346283, gen p mean: -0.10734042525291443, mean p set: 0.4481172263622284
loss_pred:0.06138158589601517, decouple_loss:0.044467102736234665
The modified gen p mean: 0.44832539558410645, gen p mean: -0.10947815328836441, mean p set: 0.44880568981170654
loss_pred:0.05900861322879791, decouple_loss:0.04537488892674446
The modified gen p mean: 0.44849157333374023, gen p mean: -0.1083030253648758, mean p set: 0.44897186756134033
loss_pred:0.06298322975635529, decouple_loss:0.04354133829474449
Iteration: 137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472235441207886, gen p mean: -0.11375962197780609, mean p set: 0.44770386815071106
loss_pred:0.058657750487327576, decouple_loss:0.036753036081790924
The modified gen p mean: 0.4489342272281647, gen p mean: -0.11384090781211853, mean p set: 0.44941452145576477The modified gen p mean: 0.446647047996521, gen p mean: -0.1135232150554657, mean p set: 0.4471273422241211
loss_pred:0.05957142636179924, decouple_loss:0.0414184145629406
loss_pred:0.06080975756049156, decouple_loss:0.0363052561879158
Iteration: 138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479084014892578, gen p mean: -0.11998768895864487, mean p set: 0.4483886957168579
loss_pred:0.0599994957447052, decouple_loss:0.037873078137636185
The modified gen p mean: 0.44715961813926697, gen p mean: -0.11801706254482269, mean p set: 0.4476398825645447
The modified gen p mean: 0.4480511248111725, gen p mean: -0.11804834008216858, mean p set: 0.44853144884109497
loss_pred:0.05900486558675766, decouple_loss:0.04051302373409271
loss_pred:0.06074853986501694, decouple_loss:0.03861997649073601
Iteration: 139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447221040725708, gen p mean: -0.12130973488092422, mean p set: 0.4477013349533081
loss_pred:0.06002844497561455, decouple_loss:0.03520254045724869
The modified gen p mean: 0.4477115571498871, gen p mean: -0.12191910296678543, mean p set: 0.4481918513774872
loss_pred:0.05888774245977402, decouple_loss:0.035696107894182205
The modified gen p mean: 0.4480860233306885, gen p mean: -0.1221005916595459, mean p set: 0.4485662877559662
loss_pred:0.05791361257433891, decouple_loss:0.03524666652083397
Iteration: 140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447517991065979, gen p mean: -0.12368570268154144, mean p set: 0.4479982852935791
The modified gen p mean: 0.44746920466423035, gen p mean: -0.12419687956571579, mean p set: 0.44794946908950806
loss_pred:0.0546097457408905, decouple_loss:0.036619577556848526
loss_pred:0.05874833092093468, decouple_loss:0.039886459708213806
The modified gen p mean: 0.44689860939979553, gen p mean: -0.12421967089176178, mean p set: 0.44737890362739563
loss_pred:0.05921775475144386, decouple_loss:0.034295704215765
2023-04-19 01:02:27 testing...
The modified gen p mean: 0.44943100214004517, gen p mean: -0.12370581179857254, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.12344768643379211, mean p set: 0.4498290419578552
The modified gen p mean: 0.44831880927085876, gen p mean: -0.12323693931102753, mean p set: 0.44879910349845886
loss_pred:0.058770716190338135, decouple_loss:0.03634404391050339
loss_pred:0.059914350509643555, decouple_loss:0.03547144681215286
loss_pred:0.05885446444153786, decouple_loss:0.035930633544921875
WV_0_PC_1_EH_0_PS_40, loss: 0.060975611209869385, avg_mse: 0.05987204238772392
current test mse: 0.059872
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458150565624237, gen p mean: -0.1223386898636818, mean p set: 0.4462953209877014
loss_pred:0.061481770128011703, decouple_loss:0.03557698428630829
The modified gen p mean: 0.44795098900794983, gen p mean: -0.1251150667667389, mean p set: 0.4484312832355499
loss_pred:0.06421823054552078, decouple_loss:0.03611942008137703
The modified gen p mean: 0.4474034011363983, gen p mean: -0.12240132689476013, mean p set: 0.447883665561676
loss_pred:0.06155524402856827, decouple_loss:0.03519127145409584
Iteration: 142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44666650891304016, gen p mean: -0.12150948494672775, mean p set: 0.44714680314064026
The modified gen p mean: 0.4469921588897705, gen p mean: -0.12104970216751099, mean p set: 0.4474724233150482
loss_pred:0.061352234333753586, decouple_loss:0.03347422182559967
loss_pred:0.06205509603023529, decouple_loss:0.03467614948749542
The modified gen p mean: 0.44668835401535034, gen p mean: -0.12078974395990372, mean p set: 0.44716861844062805
loss_pred:0.059662170708179474, decouple_loss:0.03558509424328804
Iteration: 143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44651859998703003, gen p mean: -0.11665162444114685, mean p set: 0.4469989240169525
The modified gen p mean: 0.44695645570755005, gen p mean: -0.11651009321212769, mean p set: 0.44743674993515015
loss_pred:0.060158152133226395, decouple_loss:0.036374133080244064
loss_pred:0.06022362411022186, decouple_loss:0.043071746826171875
The modified gen p mean: 0.4455907940864563, gen p mean: -0.11677075177431107, mean p set: 0.4460710883140564
loss_pred:0.059521906077861786, decouple_loss:0.03728831931948662
Iteration: 144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462556838989258, gen p mean: -0.10622625797986984, mean p set: 0.4467359483242035
The modified gen p mean: 0.446501761674881, gen p mean: -0.10624575614929199, mean p set: 0.44698208570480347
loss_pred:0.058399077504873276, decouple_loss:0.03476755693554878
loss_pred:0.05880383774638176, decouple_loss:0.03461460396647453
The modified gen p mean: 0.4459882080554962, gen p mean: -0.10601978749036789, mean p set: 0.4464685022830963
loss_pred:0.05897153913974762, decouple_loss:0.03619568794965744
Iteration: 145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467817544937134, gen p mean: -0.09857417643070221, mean p set: 0.44726207852363586
The modified gen p mean: 0.44624581933021545, gen p mean: -0.09835093468427658, mean p set: 0.44672611355781555
loss_pred:0.05914006009697914, decouple_loss:0.03782057762145996
loss_pred:0.05914973095059395, decouple_loss:0.03506159782409668
The modified gen p mean: 0.44708752632141113, gen p mean: -0.09877505153417587, mean p set: 0.44756782054901123
loss_pred:0.05870169401168823, decouple_loss:0.03720405697822571
Iteration: 146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710981845855713, gen p mean: -0.09416603296995163, mean p set: 0.4475901126861572
loss_pred:0.06051799654960632, decouple_loss:0.03829318657517433
The modified gen p mean: 0.447590172290802, gen p mean: -0.09398822486400604, mean p set: 0.4480704963207245
loss_pred:0.06042419373989105, decouple_loss:0.03725717216730118
The modified gen p mean: 0.44720005989074707, gen p mean: -0.09387541562318802, mean p set: 0.44768035411834717
loss_pred:0.057426437735557556, decouple_loss:0.03872494027018547
Iteration: 147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701579213142395, gen p mean: -0.09235426783561707, mean p set: 0.44749605655670166
loss_pred:0.05855276435613632, decouple_loss:0.04111913591623306
The modified gen p mean: 0.4463469684123993, gen p mean: -0.09214390814304352, mean p set: 0.4468272626399994
loss_pred:0.05742936581373215, decouple_loss:0.04155125468969345
The modified gen p mean: 0.44704368710517883, gen p mean: -0.09256422519683838, mean p set: 0.44752398133277893
loss_pred:0.05848716199398041, decouple_loss:0.04518517479300499
Iteration: 148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784975051879883, gen p mean: -0.09501593559980392, mean p set: 0.4483300447463989
loss_pred:0.059770334511995316, decouple_loss:0.0391012541949749
The modified gen p mean: 0.4473629295825958, gen p mean: -0.09489413350820541, mean p set: 0.4478432536125183
loss_pred:0.060464367270469666, decouple_loss:0.0357544906437397
The modified gen p mean: 0.4466029703617096, gen p mean: -0.09490163624286652, mean p set: 0.4470832645893097
loss_pred:0.05697059631347656, decouple_loss:0.03826357424259186
Iteration: 149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461185932159424, gen p mean: -0.09731578826904297, mean p set: 0.44659891724586487
The modified gen p mean: 0.44697436690330505, gen p mean: -0.09770943224430084, mean p set: 0.44745466113090515
loss_pred:0.057195547968149185, decouple_loss:0.03720761463046074
loss_pred:0.060264475643634796, decouple_loss:0.03490765020251274
The modified gen p mean: 0.44626617431640625, gen p mean: -0.09701213240623474, mean p set: 0.44674646854400635
loss_pred:0.058174505829811096, decouple_loss:0.04134408384561539
Iteration: 150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477161765098572, gen p mean: -0.1028747707605362, mean p set: 0.44819650053977966
loss_pred:0.0545152947306633, decouple_loss:0.03488856926560402
The modified gen p mean: 0.4476163387298584, gen p mean: -0.10235635936260223, mean p set: 0.4480966627597809
loss_pred:0.05586053431034088, decouple_loss:0.03575196862220764
The modified gen p mean: 0.44677552580833435, gen p mean: -0.10276487469673157, mean p set: 0.44725584983825684
loss_pred:0.05880073085427284, decouple_loss:0.03918806463479996
2023-04-19 01:05:01 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.10780801624059677, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.10741152614355087, mean p set: 0.4498290419578552
The modified gen p mean: 0.44831880927085876, gen p mean: -0.10704095661640167, mean p set: 0.44879910349845886
loss_pred:0.055880192667245865, decouple_loss:0.03323817253112793
loss_pred:0.05723688006401062, decouple_loss:0.033527590334415436
loss_pred:0.056858841329813004, decouple_loss:0.03441885486245155
WV_0_PC_1_EH_0_PS_40, loss: 0.05834504961967468, avg_mse: 0.05713915824890137
current test mse: 0.057139
Iteration: 151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472411274909973, gen p mean: -0.10780024528503418, mean p set: 0.4477214217185974
The modified gen p mean: 0.44652870297431946, gen p mean: -0.10726741701364517, mean p set: 0.44700896739959717
loss_pred:0.058027345687150955, decouple_loss:0.04087729752063751
loss_pred:0.05473240092396736, decouple_loss:0.03822755813598633
The modified gen p mean: 0.4466501772403717, gen p mean: -0.10714828968048096, mean p set: 0.4471304714679718
loss_pred:0.058777350932359695, decouple_loss:0.04200686514377594
Iteration: 152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44697147607803345, gen p mean: -0.11170007288455963, mean p set: 0.44745174050331116
loss_pred:0.05903520807623863, decouple_loss:0.03803959861397743
The modified gen p mean: 0.44654762744903564, gen p mean: -0.1104554757475853, mean p set: 0.44702792167663574
loss_pred:0.05834455415606499, decouple_loss:0.03693026676774025
The modified gen p mean: 0.447532594203949, gen p mean: -0.11022159457206726, mean p set: 0.4480128884315491
loss_pred:0.05961143597960472, decouple_loss:0.036216363310813904
Iteration: 153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44590479135513306, gen p mean: -0.10896308720111847, mean p set: 0.44638508558273315
The modified gen p mean: 0.4465055465698242, gen p mean: -0.11025407165288925, mean p set: 0.4469858705997467
loss_pred:0.057531315833330154, decouple_loss:0.03373437374830246
loss_pred:0.05681569501757622, decouple_loss:0.035885825753211975
The modified gen p mean: 0.44630759954452515, gen p mean: -0.11035818606615067, mean p set: 0.44678789377212524
loss_pred:0.05656394734978676, decouple_loss:0.0348852165043354
Iteration: 154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463847279548645, gen p mean: -0.10671911388635635, mean p set: 0.4468649923801422
loss_pred:0.05574022978544235, decouple_loss:0.03425116091966629
The modified gen p mean: 0.4475697875022888, gen p mean: -0.10707194358110428, mean p set: 0.4480500817298889
The modified gen p mean: 0.4470585584640503, gen p mean: -0.10671240836381912, mean p set: 0.4475388824939728
loss_pred:0.05688650906085968, decouple_loss:0.035331305116415024
loss_pred:0.05617978423833847, decouple_loss:0.037053558975458145
Iteration: 155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44622835516929626, gen p mean: -0.10398589819669724, mean p set: 0.446708619594574
loss_pred:0.059407275170087814, decouple_loss:0.034612029790878296
The modified gen p mean: 0.44725653529167175, gen p mean: -0.10500560700893402, mean p set: 0.44773682951927185
loss_pred:0.05587781220674515, decouple_loss:0.03367074579000473
The modified gen p mean: 0.4474699795246124, gen p mean: -0.10606994479894638, mean p set: 0.4479503035545349
loss_pred:0.05514531955122948, decouple_loss:0.032013241201639175
Iteration: 156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476061463356018, gen p mean: -0.10499909520149231, mean p set: 0.4480864405632019
The modified gen p mean: 0.44697561860084534, gen p mean: -0.10294565558433533, mean p set: 0.44745591282844543
loss_pred:0.05871026590466499, decouple_loss:0.034475892782211304
The modified gen p mean: 0.44658491015434265, gen p mean: -0.10245469957590103, mean p set: 0.44706523418426514loss_pred:0.05627671256661415, decouple_loss:0.035814277827739716
loss_pred:0.05814320966601372, decouple_loss:0.03372906520962715
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724833965301514, gen p mean: -0.10272583365440369, mean p set: 0.44772863388061523
loss_pred:0.05576753616333008, decouple_loss:0.03127140924334526
The modified gen p mean: 0.4467221796512604, gen p mean: -0.10139813274145126, mean p set: 0.4472024440765381
The modified gen p mean: 0.4475097954273224, gen p mean: -0.10273044556379318, mean p set: 0.4479900598526001
loss_pred:0.05862110108137131, decouple_loss:0.032863568514585495
loss_pred:0.055701833218336105, decouple_loss:0.032052867114543915
Iteration: 158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44607841968536377, gen p mean: -0.10147605836391449, mean p set: 0.4465586841106415
loss_pred:0.05295029655098915, decouple_loss:0.03658439964056015
The modified gen p mean: 0.44661709666252136, gen p mean: -0.10145238786935806, mean p set: 0.44709739089012146
The modified gen p mean: 0.44674399495124817, gen p mean: -0.10081630945205688, mean p set: 0.44722431898117065
loss_pred:0.05613831803202629, decouple_loss:0.03488968312740326
loss_pred:0.05794121325016022, decouple_loss:0.04020996019244194
Iteration: 159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456627666950226, gen p mean: -0.10232003778219223, mean p set: 0.4461430609226227
The modified gen p mean: 0.4472186267375946, gen p mean: -0.10295736789703369, mean p set: 0.4476989209651947
loss_pred:0.05579868704080582, decouple_loss:0.03482150286436081
loss_pred:0.05695325881242752, decouple_loss:0.036429665982723236
The modified gen p mean: 0.44773462414741516, gen p mean: -0.1033889651298523, mean p set: 0.44821488857269287
loss_pred:0.05269033834338188, decouple_loss:0.041485097259283066
Iteration: 160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474562704563141, gen p mean: -0.1049700677394867, mean p set: 0.4479365348815918
loss_pred:0.056085254997015, decouple_loss:0.035843249410390854
The modified gen p mean: 0.445743203163147, gen p mean: -0.10459204763174057, mean p set: 0.44622352719306946
The modified gen p mean: 0.4464870095252991, gen p mean: -0.10464660078287125, mean p set: 0.44696730375289917
loss_pred:0.055556077510118484, decouple_loss:0.033277709037065506
loss_pred:0.05700770020484924, decouple_loss:0.033661022782325745
2023-04-19 01:06:54 testing...
The modified gen p mean: 0.44943100214004517, gen p mean: -0.10161897540092468, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.10072248429059982, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.10012193769216537, mean p set: 0.44879910349845886
loss_pred:0.05467097461223602, decouple_loss:0.03316982835531235
loss_pred:0.05598988011479378, decouple_loss:0.033516574651002884
loss_pred:0.055524419993162155, decouple_loss:0.034304555505514145
WV_0_PC_1_EH_0_PS_40, loss: 0.0570782795548439, avg_mse: 0.05613427236676216
current test mse: 0.056134
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479621648788452, gen p mean: -0.10155964642763138, mean p set: 0.4484424889087677
loss_pred:0.05742579698562622, decouple_loss:0.0364476777613163
The modified gen p mean: 0.44893893599510193, gen p mean: -0.09966371953487396, mean p set: 0.44941920042037964
loss_pred:0.06059892475605011, decouple_loss:0.037094686180353165
The modified gen p mean: 0.4488367736339569, gen p mean: -0.10147891193628311, mean p set: 0.449317067861557
loss_pred:0.05964769050478935, decouple_loss:0.03555027022957802
Iteration: 162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714081287384033, gen p mean: -0.09455558657646179, mean p set: 0.44762104749679565
loss_pred:0.05746247619390488, decouple_loss:0.033931996673345566
The modified gen p mean: 0.4486500322818756, gen p mean: -0.09573376178741455, mean p set: 0.4491303265094757
The modified gen p mean: 0.44753149151802063, gen p mean: -0.09564641118049622, mean p set: 0.4480117857456207
loss_pred:0.0592147558927536, decouple_loss:0.03464763984084129
loss_pred:0.05637676268815994, decouple_loss:0.03388897702097893
Iteration: 163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788235425949097, gen p mean: -0.10130917280912399, mean p set: 0.44836267828941345
The modified gen p mean: 0.4494127631187439, gen p mean: -0.10316117852926254, mean p set: 0.449893057346344
loss_pred:0.055789247155189514, decouple_loss:0.033483803272247314
The modified gen p mean: 0.4480817914009094, gen p mean: -0.09996484220027924, mean p set: 0.4485621154308319
loss_pred:0.057160984724760056, decouple_loss:0.03417562320828438
loss_pred:0.059986211359500885, decouple_loss:0.03680615499615669
Iteration: 164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487558901309967, gen p mean: -0.10834044218063354, mean p set: 0.4492361843585968
The modified gen p mean: 0.44984617829322815, gen p mean: -0.10986971855163574, mean p set: 0.45032650232315063
loss_pred:0.060327012091875076, decouple_loss:0.036880262196063995
loss_pred:0.056322842836380005, decouple_loss:0.035486359149217606
The modified gen p mean: 0.44759809970855713, gen p mean: -0.10919095575809479, mean p set: 0.4480784237384796
loss_pred:0.056970931589603424, decouple_loss:0.03300140053033829
Iteration: 165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487232267856598, gen p mean: -0.10946939140558243, mean p set: 0.4492034912109375
The modified gen p mean: 0.4471893906593323, gen p mean: -0.11107692122459412, mean p set: 0.44766971468925476
loss_pred:0.0587015300989151, decouple_loss:0.03411135822534561
loss_pred:0.05571717768907547, decouple_loss:0.03643817827105522
The modified gen p mean: 0.4492904543876648, gen p mean: -0.11382003128528595, mean p set: 0.4497707486152649
loss_pred:0.0567612387239933, decouple_loss:0.03956974297761917
Iteration: 166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497976005077362, gen p mean: -0.10777657479047775, mean p set: 0.4502778649330139
The modified gen p mean: 0.4483802318572998, gen p mean: -0.11114031821489334, mean p set: 0.4488604962825775
loss_pred:0.057206954807043076, decouple_loss:0.03318904712796211
loss_pred:0.05877520889043808, decouple_loss:0.03367890417575836
The modified gen p mean: 0.4478338658809662, gen p mean: -0.11406540125608444, mean p set: 0.4483141601085663
loss_pred:0.05818919837474823, decouple_loss:0.034626785665750504
Iteration: 167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762134552001953, gen p mean: -0.10887538641691208, mean p set: 0.44810163974761963The modified gen p mean: 0.44869518280029297, gen p mean: -0.11004707217216492, mean p set: 0.44917547702789307
loss_pred:0.057063888758420944, decouple_loss:0.0358540378510952
loss_pred:0.05573106184601784, decouple_loss:0.03235112130641937
The modified gen p mean: 0.44853323698043823, gen p mean: -0.10638678818941116, mean p set: 0.44901350140571594
loss_pred:0.05481329932808876, decouple_loss:0.0329759418964386
Iteration: 168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799745082855225, gen p mean: -0.10780207067728043, mean p set: 0.44847777485847473
loss_pred:0.05785771831870079, decouple_loss:0.03692397475242615
The modified gen p mean: 0.4475306272506714, gen p mean: -0.1086481362581253, mean p set: 0.44801095128059387
loss_pred:0.05465395748615265, decouple_loss:0.03249168395996094
The modified gen p mean: 0.44885778427124023, gen p mean: -0.11124040186405182, mean p set: 0.44933804869651794
loss_pred:0.05467379838228226, decouple_loss:0.037120040506124496
Iteration: 169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44861671328544617, gen p mean: -0.11621619015932083, mean p set: 0.44909700751304626
The modified gen p mean: 0.44741275906562805, gen p mean: -0.11132454872131348, mean p set: 0.44789305329322815
loss_pred:0.056698936969041824, decouple_loss:0.03245387598872185
loss_pred:0.05535011738538742, decouple_loss:0.03264988213777542
The modified gen p mean: 0.4495009481906891, gen p mean: -0.1147928535938263, mean p set: 0.4499812126159668
loss_pred:0.05722549930214882, decouple_loss:0.0341486781835556
Iteration: 170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480086863040924, gen p mean: -0.11184946447610855, mean p set: 0.4484889805316925
loss_pred:0.0570705384016037, decouple_loss:0.030164066702127457
The modified gen p mean: 0.4486769139766693, gen p mean: -0.11212277412414551, mean p set: 0.4491572082042694
loss_pred:0.058201055973768234, decouple_loss:0.032712191343307495
The modified gen p mean: 0.4483799636363983, gen p mean: -0.11230047047138214, mean p set: 0.4488602578639984
loss_pred:0.05675428733229637, decouple_loss:0.034640613943338394
2023-04-19 01:09:27 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.09683198481798172, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.09646009653806686, mean p set: 0.4498290419578552
The modified gen p mean: 0.44831880927085876, gen p mean: -0.09655167162418365, mean p set: 0.44879910349845886
loss_pred:0.05519542098045349, decouple_loss:0.0351446233689785
loss_pred:0.05682678148150444, decouple_loss:0.03426395729184151
loss_pred:0.05585736408829689, decouple_loss:0.034395888447761536
WV_0_PC_1_EH_0_PS_40, loss: 0.057689931243658066, avg_mse: 0.057350438088178635
current test mse: 0.05735
Iteration: 171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900357723236084, gen p mean: -0.09680072963237762, mean p set: 0.44948384165763855
loss_pred:0.05932017043232918, decouple_loss:0.030419908463954926
The modified gen p mean: 0.4483950734138489, gen p mean: -0.09704434126615524, mean p set: 0.44887539744377136
loss_pred:0.05405944585800171, decouple_loss:0.029966020956635475
The modified gen p mean: 0.44893336296081543, gen p mean: -0.09903141111135483, mean p set: 0.4494136571884155
loss_pred:0.055150650441646576, decouple_loss:0.03380687162280083
Iteration: 172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478819668292999, gen p mean: -0.09277403354644775, mean p set: 0.44836223125457764
loss_pred:0.05685585364699364, decouple_loss:0.031248901039361954
The modified gen p mean: 0.44864314794540405, gen p mean: -0.0981656014919281, mean p set: 0.44912344217300415
loss_pred:0.053534284234046936, decouple_loss:0.033042240887880325
The modified gen p mean: 0.44682610034942627, gen p mean: -0.09400276094675064, mean p set: 0.44730639457702637
loss_pred:0.05609527602791786, decouple_loss:0.029312681406736374
Iteration: 173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490025043487549, gen p mean: -0.09171739220619202, mean p set: 0.449482798576355
loss_pred:0.0564645454287529, decouple_loss:0.03822097182273865
The modified gen p mean: 0.4481185972690582, gen p mean: -0.08943965286016464, mean p set: 0.4485989212989807The modified gen p mean: 0.4493180513381958, gen p mean: -0.09412331134080887, mean p set: 0.4497983753681183
loss_pred:0.05603092908859253, decouple_loss:0.033252324908971786
loss_pred:0.05652995407581329, decouple_loss:0.03380270674824715
Iteration: 174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482285976409912, gen p mean: -0.08609028905630112, mean p set: 0.4487088918685913
loss_pred:0.05690624192357063, decouple_loss:0.03185692057013512
The modified gen p mean: 0.44720131158828735, gen p mean: -0.0855608582496643, mean p set: 0.44768157601356506
The modified gen p mean: 0.4484682083129883, gen p mean: -0.0853159949183464, mean p set: 0.448948472738266
loss_pred:0.055071376264095306, decouple_loss:0.02943774126470089
loss_pred:0.05361854285001755, decouple_loss:0.029969265684485435
Iteration: 175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44885721802711487, gen p mean: -0.08972591906785965, mean p set: 0.44933751225471497
loss_pred:0.05581158399581909, decouple_loss:0.028800755739212036
The modified gen p mean: 0.448227196931839, gen p mean: -0.08893830329179764, mean p set: 0.44870755076408386
The modified gen p mean: 0.44853904843330383, gen p mean: -0.09052173048257828, mean p set: 0.44901934266090393
loss_pred:0.05547059699892998, decouple_loss:0.03261543810367584
loss_pred:0.057107727974653244, decouple_loss:0.034545619040727615
Iteration: 176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494490623474121, gen p mean: -0.09731186181306839, mean p set: 0.4499293565750122
The modified gen p mean: 0.44960033893585205, gen p mean: -0.09856567531824112, mean p set: 0.45008060336112976
loss_pred:0.0556522011756897, decouple_loss:0.03141825273633003
loss_pred:0.054960109293460846, decouple_loss:0.031226567924022675
The modified gen p mean: 0.4481375217437744, gen p mean: -0.09902652353048325, mean p set: 0.4486178159713745
loss_pred:0.053973760455846786, decouple_loss:0.030081238597631454
Iteration: 177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756239652633667, gen p mean: -0.09307529032230377, mean p set: 0.44804272055625916
loss_pred:0.055507592856884, decouple_loss:0.03096836805343628
The modified gen p mean: 0.4472748041152954, gen p mean: -0.09573903679847717, mean p set: 0.4477550983428955
loss_pred:0.05459641292691231, decouple_loss:0.027650142088532448
The modified gen p mean: 0.44782891869544983, gen p mean: -0.09595251828432083, mean p set: 0.4483092129230499
loss_pred:0.056725431233644485, decouple_loss:0.028037158772349358
Iteration: 178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477007985115051, gen p mean: -0.08491810411214828, mean p set: 0.4481810927391052
loss_pred:0.055052075535058975, decouple_loss:0.030100425705313683
The modified gen p mean: 0.44782161712646484, gen p mean: -0.08588868379592896, mean p set: 0.44830194115638733
loss_pred:0.05501280725002289, decouple_loss:0.029456852003932
The modified gen p mean: 0.447651207447052, gen p mean: -0.085682213306427, mean p set: 0.4481314718723297
loss_pred:0.055912625044584274, decouple_loss:0.030644003301858902
Iteration: 179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488871693611145, gen p mean: -0.08560756593942642, mean p set: 0.4493674635887146
loss_pred:0.05434688553214073, decouple_loss:0.03264646604657173
The modified gen p mean: 0.44725844264030457, gen p mean: -0.08190875500440598, mean p set: 0.44773876667022705
The modified gen p mean: 0.4492121636867523, gen p mean: -0.0827927365899086, mean p set: 0.4496924579143524
loss_pred:0.054824262857437134, decouple_loss:0.03090365044772625
loss_pred:0.05431680381298065, decouple_loss:0.032255180180072784
Iteration: 180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487735331058502, gen p mean: -0.08647099882364273, mean p set: 0.4492538273334503
loss_pred:0.05286846309900284, decouple_loss:0.032778963446617126
The modified gen p mean: 0.44836118817329407, gen p mean: -0.08797099441289902, mean p set: 0.44884148240089417
loss_pred:0.054041314870119095, decouple_loss:0.03428283706307411
The modified gen p mean: 0.4494132697582245, gen p mean: -0.08848155289888382, mean p set: 0.449893593788147
loss_pred:0.05374489724636078, decouple_loss:0.0375785268843174
2023-04-19 01:11:20 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.08610387146472931, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.08635437488555908, mean p set: 0.4498290419578552
The modified gen p mean: 0.44831880927085876, gen p mean: -0.08630596846342087, mean p set: 0.44879910349845886
loss_pred:0.053693827241659164, decouple_loss:0.03453623503446579
loss_pred:0.05508909374475479, decouple_loss:0.03283155709505081
loss_pred:0.05448402836918831, decouple_loss:0.032066088169813156
WV_0_PC_1_EH_0_PS_40, loss: 0.056079547852277756, avg_mse: 0.05597876012325287
current test mse: 0.055979
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458253085613251, gen p mean: -0.08699729293584824, mean p set: 0.44630563259124756
loss_pred:0.054134272038936615, decouple_loss:0.031384438276290894
The modified gen p mean: 0.44620752334594727, gen p mean: -0.08704042434692383, mean p set: 0.44668781757354736
loss_pred:0.05570657551288605, decouple_loss:0.03151942044496536
The modified gen p mean: 0.44677528738975525, gen p mean: -0.08729942888021469, mean p set: 0.44725558161735535
loss_pred:0.055742982774972916, decouple_loss:0.031737200915813446
Iteration: 182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44664016366004944, gen p mean: -0.07524008303880692, mean p set: 0.44712045788764954
loss_pred:0.053669705986976624, decouple_loss:0.03276216983795166
The modified gen p mean: 0.44582653045654297, gen p mean: -0.07217647135257721, mean p set: 0.44630685448646545
loss_pred:0.05672233924269676, decouple_loss:0.036291319876909256
The modified gen p mean: 0.44734594225883484, gen p mean: -0.07429469376802444, mean p set: 0.44782623648643494
loss_pred:0.05470147728919983, decouple_loss:0.0394575372338295
Iteration: 183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44704756140708923, gen p mean: -0.0604686364531517, mean p set: 0.44752782583236694
loss_pred:0.0570094920694828, decouple_loss:0.032862789928913116
The modified gen p mean: 0.44883668422698975, gen p mean: -0.059654660522937775, mean p set: 0.44931700825691223
The modified gen p mean: 0.4475928544998169, gen p mean: -0.06236407533288002, mean p set: 0.448073148727417
loss_pred:0.05454825982451439, decouple_loss:0.03568015620112419
loss_pred:0.05587553232908249, decouple_loss:0.033021893352270126
Iteration: 184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44647496938705444, gen p mean: -0.07453212887048721, mean p set: 0.44695523381233215
loss_pred:0.05393150821328163, decouple_loss:0.04150676354765892
The modified gen p mean: 0.4478110074996948, gen p mean: -0.07519055902957916, mean p set: 0.4482913017272949
loss_pred:0.0547301210463047, decouple_loss:0.03853482007980347
The modified gen p mean: 0.44746020436286926, gen p mean: -0.07851282507181168, mean p set: 0.44794052839279175
loss_pred:0.05225645378232002, decouple_loss:0.045195892453193665
Iteration: 185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44641295075416565, gen p mean: -0.07531541585922241, mean p set: 0.44689324498176575
loss_pred:0.05560210347175598, decouple_loss:0.03408167511224747
The modified gen p mean: 0.4483022391796112, gen p mean: -0.07411596924066544, mean p set: 0.4487825632095337
The modified gen p mean: 0.44751569628715515, gen p mean: -0.07915666699409485, mean p set: 0.44799599051475525
loss_pred:0.05341874808073044, decouple_loss:0.03249893710017204
loss_pred:0.05440583825111389, decouple_loss:0.038622260093688965
Iteration: 186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479667544364929, gen p mean: -0.06418095529079437, mean p set: 0.4484470784664154
loss_pred:0.05544505640864372, decouple_loss:0.03682127967476845
The modified gen p mean: 0.44662079215049744, gen p mean: -0.07040388882160187, mean p set: 0.4471011161804199
The modified gen p mean: 0.44904762506484985, gen p mean: -0.0628814697265625, mean p set: 0.44952791929244995
loss_pred:0.05614032223820686, decouple_loss:0.0351167768239975
loss_pred:0.05319911986589432, decouple_loss:0.04030374810099602
Iteration: 187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480065703392029, gen p mean: -0.08403757959604263, mean p set: 0.448486864566803
loss_pred:0.055098168551921844, decouple_loss:0.03627496212720871
The modified gen p mean: 0.44879674911499023, gen p mean: -0.08222373574972153, mean p set: 0.44927704334259033
The modified gen p mean: 0.44627130031585693, gen p mean: -0.08650746941566467, mean p set: 0.44675159454345703
loss_pred:0.05280065909028053, decouple_loss:0.04066755622625351
loss_pred:0.05298412963747978, decouple_loss:0.035923443734645844
Iteration: 188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468763768672943, gen p mean: -0.08213362097740173, mean p set: 0.4473566710948944
loss_pred:0.05247115716338158, decouple_loss:0.0370153933763504
The modified gen p mean: 0.4474453032016754, gen p mean: -0.08337003737688065, mean p set: 0.4479255974292755
The modified gen p mean: 0.4462599456310272, gen p mean: -0.081598199903965, mean p set: 0.4467402696609497
loss_pred:0.05509437248110771, decouple_loss:0.0341629721224308
loss_pred:0.055052440613508224, decouple_loss:0.03217323124408722
Iteration: 189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710493087768555, gen p mean: -0.07368286699056625, mean p set: 0.44758522510528564
The modified gen p mean: 0.4466908872127533, gen p mean: -0.0721621960401535, mean p set: 0.4471711814403534
The modified gen p mean: 0.44817230105400085, gen p mean: -0.07553929090499878, mean p set: 0.44865259528160095
loss_pred:0.05397475138306618, decouple_loss:0.03470072150230408
loss_pred:0.05398205667734146, decouple_loss:0.03335688263177872
loss_pred:0.05337696522474289, decouple_loss:0.03420131653547287
Iteration: 190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448574036359787, gen p mean: -0.08672899752855301, mean p set: 0.4490543007850647
loss_pred:0.052772559225559235, decouple_loss:0.04559110105037689
The modified gen p mean: 0.44632503390312195, gen p mean: -0.0939531922340393, mean p set: 0.44680535793304443
The modified gen p mean: 0.4463035762310028, gen p mean: -0.09386248141527176, mean p set: 0.4467838406562805
loss_pred:0.052628226578235626, decouple_loss:0.037683166563510895
loss_pred:0.052195798605680466, decouple_loss:0.0374874472618103
2023-04-19 01:13:56 testing...
The modified gen p mean: 0.44943100214004517, gen p mean: -0.08518999814987183, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.08497545123100281, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.08523218333721161, mean p set: 0.44879910349845886
loss_pred:0.05116932839155197, decouple_loss:0.03484280779957771
loss_pred:0.0525079183280468, decouple_loss:0.03372190147638321
loss_pred:0.05243212729692459, decouple_loss:0.03259963169693947
WV_0_PC_1_EH_0_PS_40, loss: 0.053722530603408813, avg_mse: 0.05364498868584633
current test mse: 0.053645
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467659592628479, gen p mean: -0.08407128602266312, mean p set: 0.447246253490448
loss_pred:0.05147295445203781, decouple_loss:0.034358829259872437
The modified gen p mean: 0.4460310637950897, gen p mean: -0.0852666050195694, mean p set: 0.44651132822036743The modified gen p mean: 0.4467124044895172, gen p mean: -0.08836280554533005, mean p set: 0.4471926689147949
loss_pred:0.052152302116155624, decouple_loss:0.03312953934073448
loss_pred:0.052957259118556976, decouple_loss:0.0340639092028141
Iteration: 192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44691959023475647, gen p mean: -0.07739642262458801, mean p set: 0.4473998546600342
loss_pred:0.053022678941488266, decouple_loss:0.04684048518538475
The modified gen p mean: 0.44885823130607605, gen p mean: -0.07458388060331345, mean p set: 0.44933852553367615
The modified gen p mean: 0.44646888971328735, gen p mean: -0.07566571235656738, mean p set: 0.44694921374320984loss_pred:0.05295715481042862, decouple_loss:0.044078536331653595
loss_pred:0.052079349756240845, decouple_loss:0.04544917494058609
Iteration: 193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459315538406372, gen p mean: -0.08322879672050476, mean p set: 0.4464118480682373
The modified gen p mean: 0.44739651679992676, gen p mean: -0.08171543478965759, mean p set: 0.44787678122520447
loss_pred:0.052392810583114624, decouple_loss:0.03548741340637207
loss_pred:0.05343218892812729, decouple_loss:0.03319837525486946
The modified gen p mean: 0.4464486241340637, gen p mean: -0.08304432034492493, mean p set: 0.4469289183616638
loss_pred:0.051394544541835785, decouple_loss:0.03749864920973778
Iteration: 194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760069251060486, gen p mean: -0.07561076432466507, mean p set: 0.44808098673820496
The modified gen p mean: 0.4459937512874603, gen p mean: -0.07084338366985321, mean p set: 0.44647401571273804
loss_pred:0.05138252303004265, decouple_loss:0.03870130702853203
The modified gen p mean: 0.44859594106674194, gen p mean: -0.07296175509691238, mean p set: 0.44907623529434204
loss_pred:0.05252525582909584, decouple_loss:0.042809683829545975
loss_pred:0.05366534739732742, decouple_loss:0.050693001598119736
Iteration: 195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44667908549308777, gen p mean: -0.08068306744098663, mean p set: 0.44715940952301025
loss_pred:0.0505828931927681, decouple_loss:0.034026775509119034
The modified gen p mean: 0.44810667634010315, gen p mean: -0.0748981311917305, mean p set: 0.44858697056770325
The modified gen p mean: 0.4472636580467224, gen p mean: -0.08016235381364822, mean p set: 0.4477439522743225
loss_pred:0.04902827367186546, decouple_loss:0.03521409630775452
loss_pred:0.05314699932932854, decouple_loss:0.03316526114940643
Iteration: 196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468236267566681, gen p mean: -0.09353190660476685, mean p set: 0.4473038911819458
The modified gen p mean: 0.4473477303981781, gen p mean: -0.08738934248685837, mean p set: 0.4478280544281006
The modified gen p mean: 0.4481782019138336, gen p mean: -0.09143103659152985, mean p set: 0.4486584961414337loss_pred:0.04949013888835907, decouple_loss:0.042357053607702255
loss_pred:0.049615278840065, decouple_loss:0.04101698473095894
loss_pred:0.05058005079627037, decouple_loss:0.04193035140633583
Iteration: 197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44568493962287903, gen p mean: -0.08690379559993744, mean p set: 0.4461652636528015
The modified gen p mean: 0.44525769352912903, gen p mean: -0.0905170738697052, mean p set: 0.44573795795440674
loss_pred:0.053084611892700195, decouple_loss:0.03659326955676079
The modified gen p mean: 0.44820311665534973, gen p mean: -0.08421722054481506, mean p set: 0.44868341088294983
loss_pred:0.05154213309288025, decouple_loss:0.03685665875673294
loss_pred:0.050203196704387665, decouple_loss:0.03214097395539284
Iteration: 198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44577547907829285, gen p mean: -0.07689712941646576, mean p set: 0.44625577330589294
The modified gen p mean: 0.4461468458175659, gen p mean: -0.07486489415168762, mean p set: 0.4466271698474884
loss_pred:0.05126520246267319, decouple_loss:0.04088478162884712
The modified gen p mean: 0.4472138285636902, gen p mean: -0.0747985765337944, mean p set: 0.4476941227912903
loss_pred:0.051058579236269, decouple_loss:0.040867194533348083
loss_pred:0.05301053822040558, decouple_loss:0.03998706117272377
Iteration: 199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474707841873169, gen p mean: -0.07312474399805069, mean p set: 0.447951078414917
The modified gen p mean: 0.44609498977661133, gen p mean: -0.06710595637559891, mean p set: 0.4465752840042114
loss_pred:0.05205635353922844, decouple_loss:0.03287852555513382
loss_pred:0.05112255737185478, decouple_loss:0.03926406800746918
The modified gen p mean: 0.4452894926071167, gen p mean: -0.07829339057207108, mean p set: 0.4457697868347168
loss_pred:0.0502864271402359, decouple_loss:0.03355281427502632
Iteration: 200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468863308429718, gen p mean: -0.0933748185634613, mean p set: 0.4473665952682495
loss_pred:0.05125755816698074, decouple_loss:0.038460683077573776
The modified gen p mean: 0.4473292827606201, gen p mean: -0.09645608812570572, mean p set: 0.4478095471858978
The modified gen p mean: 0.44625359773635864, gen p mean: -0.09270596504211426, mean p set: 0.44673389196395874
loss_pred:0.04911277815699577, decouple_loss:0.03846317157149315
loss_pred:0.04990987107157707, decouple_loss:0.03825473040342331
2023-04-19 01:15:49 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.08145338296890259, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.08021340519189835, mean p set: 0.4498290419578552
The modified gen p mean: 0.44831880927085876, gen p mean: -0.08016487210988998, mean p set: 0.44879910349845886
loss_pred:0.04993759095668793, decouple_loss:0.032915957272052765
loss_pred:0.05084596201777458, decouple_loss:0.03333935886621475
loss_pred:0.0507659986615181, decouple_loss:0.03435225039720535
WV_0_PC_1_EH_0_PS_40, loss: 0.05219331011176109, avg_mse: 0.05252252519130707
current test mse: 0.052523
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772136211395264, gen p mean: -0.07918629795312881, mean p set: 0.44820162653923035
loss_pred:0.05223598703742027, decouple_loss:0.03499548137187958
The modified gen p mean: 0.44720011949539185, gen p mean: -0.08371131867170334, mean p set: 0.44768041372299194
The modified gen p mean: 0.44698387384414673, gen p mean: -0.08058442920446396, mean p set: 0.4474641680717468
loss_pred:0.05160599574446678, decouple_loss:0.032069019973278046
loss_pred:0.05407414957880974, decouple_loss:0.03237971290946007
Iteration: 202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448035329580307, gen p mean: -0.08320478349924088, mean p set: 0.4485156238079071
The modified gen p mean: 0.4469631314277649, gen p mean: -0.08338215947151184, mean p set: 0.447443425655365
loss_pred:0.04886135086417198, decouple_loss:0.03680700436234474
loss_pred:0.04964496195316315, decouple_loss:0.03443361818790436
The modified gen p mean: 0.4476320445537567, gen p mean: -0.08133812248706818, mean p set: 0.4481123387813568
loss_pred:0.05042935907840729, decouple_loss:0.035168763250112534
Iteration: 203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477905035018921, gen p mean: -0.10301853716373444, mean p set: 0.4482708275318146
loss_pred:0.05430470034480095, decouple_loss:0.030958836898207664
The modified gen p mean: 0.4476644992828369, gen p mean: -0.10453470051288605, mean p set: 0.4481448233127594
loss_pred:0.054063618183135986, decouple_loss:0.0317428782582283
The modified gen p mean: 0.44719043374061584, gen p mean: -0.10453308373689651, mean p set: 0.44767072796821594
loss_pred:0.05236368253827095, decouple_loss:0.030432818457484245
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475800395011902, gen p mean: -0.08186353743076324, mean p set: 0.4480603337287903
loss_pred:0.05441170185804367, decouple_loss:0.03291710838675499
The modified gen p mean: 0.4475264549255371, gen p mean: -0.08080311119556427, mean p set: 0.4480067491531372
The modified gen p mean: 0.4477413594722748, gen p mean: -0.07893463224172592, mean p set: 0.4482216238975525
loss_pred:0.05316394567489624, decouple_loss:0.03148500993847847
loss_pred:0.05182749778032303, decouple_loss:0.03246663138270378
Iteration: 205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800668954849243, gen p mean: -0.050842151045799255, mean p set: 0.44848695397377014
loss_pred:0.052981626242399216, decouple_loss:0.031198399141430855
The modified gen p mean: 0.4473235309123993, gen p mean: -0.046946559101343155, mean p set: 0.4478038251399994
The modified gen p mean: 0.4483295977115631, gen p mean: -0.04667804390192032, mean p set: 0.4488099217414856
loss_pred:0.050601109862327576, decouple_loss:0.034287936985492706
loss_pred:0.05300131067633629, decouple_loss:0.033564839512109756
Iteration: 206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475240707397461, gen p mean: -0.06103747710585594, mean p set: 0.4480043649673462
loss_pred:0.0514080710709095, decouple_loss:0.030297039076685905
The modified gen p mean: 0.4476197063922882, gen p mean: -0.061678074300289154, mean p set: 0.4481000304222107
The modified gen p mean: 0.44701892137527466, gen p mean: -0.06323080509901047, mean p set: 0.44749921560287476
loss_pred:0.050933703780174255, decouple_loss:0.02961546741425991
loss_pred:0.05155932903289795, decouple_loss:0.03013434447348118
Iteration: 207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744566082954407, gen p mean: -0.06329059600830078, mean p set: 0.44792598485946655
loss_pred:0.0494319349527359, decouple_loss:0.030596863478422165
The modified gen p mean: 0.44758734107017517, gen p mean: -0.06522603332996368, mean p set: 0.44806763529777527
The modified gen p mean: 0.4476642608642578, gen p mean: -0.06442690640687943, mean p set: 0.4481445848941803
loss_pred:0.05294985696673393, decouple_loss:0.03297014907002449
loss_pred:0.048658620566129684, decouple_loss:0.030191922560334206
Iteration: 208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44654354453086853, gen p mean: -0.06567437201738358, mean p set: 0.44702383875846863
loss_pred:0.04862748086452484, decouple_loss:0.03201422095298767
The modified gen p mean: 0.44723114371299744, gen p mean: -0.06636948883533478, mean p set: 0.44771143794059753
The modified gen p mean: 0.4485894441604614, gen p mean: -0.06438430398702621, mean p set: 0.4490697383880615
loss_pred:0.05064220353960991, decouple_loss:0.02907697670161724
loss_pred:0.048385139554739, decouple_loss:0.029440173879265785
Iteration: 209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44748654961586, gen p mean: -0.07105934619903564, mean p set: 0.4479668438434601
loss_pred:0.051703717559576035, decouple_loss:0.028624501079320908
The modified gen p mean: 0.4469161927700043, gen p mean: -0.07599148154258728, mean p set: 0.44739648699760437
The modified gen p mean: 0.44776326417922974, gen p mean: -0.07564715296030045, mean p set: 0.44824355840682983
loss_pred:0.0521799772977829, decouple_loss:0.02904326468706131
loss_pred:0.0501762330532074, decouple_loss:0.027870090678334236
Iteration: 210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477625787258148, gen p mean: -0.07825911790132523, mean p set: 0.4482428729534149
The modified gen p mean: 0.44785475730895996, gen p mean: -0.07019620388746262, mean p set: 0.44833505153656006
loss_pred:0.05151411145925522, decouple_loss:0.03043062798678875
The modified gen p mean: 0.446276992559433, gen p mean: -0.07908649742603302, mean p set: 0.4467572569847107
loss_pred:0.05024568736553192, decouple_loss:0.030954057350754738
loss_pred:0.0470263734459877, decouple_loss:0.03192072734236717
2023-04-19 01:18:21 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.07112085819244385, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.06993325799703598, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.0698477253317833, mean p set: 0.44879910349845886
loss_pred:0.04871794208884239, decouple_loss:0.02717556245625019
loss_pred:0.04971050098538399, decouple_loss:0.02680017799139023
loss_pred:0.04930954799056053, decouple_loss:0.027074219658970833
WV_0_PC_1_EH_0_PS_40, loss: 0.05059682950377464, avg_mse: 0.05174403637647629
current test mse: 0.051744
Iteration: 211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733738899230957, gen p mean: -0.0640016719698906, mean p set: 0.44781771302223206
The modified gen p mean: 0.44752684235572815, gen p mean: -0.07404032349586487, mean p set: 0.44800713658332825
loss_pred:0.04984920471906662, decouple_loss:0.028346100822091103
loss_pred:0.04918753728270531, decouple_loss:0.025986317545175552
The modified gen p mean: 0.44707900285720825, gen p mean: -0.06366386264562607, mean p set: 0.44755926728248596
loss_pred:0.05095997080206871, decouple_loss:0.028239889070391655
Iteration: 212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468156695365906, gen p mean: -0.06753097474575043, mean p set: 0.44729599356651306
loss_pred:0.047485966235399246, decouple_loss:0.026288054883480072
The modified gen p mean: 0.4471185505390167, gen p mean: -0.0656769797205925, mean p set: 0.4475988745689392
The modified gen p mean: 0.44745901226997375, gen p mean: -0.06664714217185974, mean p set: 0.44793930649757385
loss_pred:0.05007898807525635, decouple_loss:0.02871653065085411
loss_pred:0.049770962446928024, decouple_loss:0.02584327943623066
Iteration: 213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475373327732086, gen p mean: -0.0540822334587574, mean p set: 0.4480176270008087
loss_pred:0.04915814474225044, decouple_loss:0.025526700541377068
The modified gen p mean: 0.44729742407798767, gen p mean: -0.05821118876338005, mean p set: 0.44777771830558777
loss_pred:0.04890613630414009, decouple_loss:0.02765893004834652
The modified gen p mean: 0.448141485452652, gen p mean: -0.06027696281671524, mean p set: 0.4486217796802521
loss_pred:0.04897017031908035, decouple_loss:0.0296818558126688
Iteration: 214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478148818016052, gen p mean: -0.054200559854507446, mean p set: 0.4482952058315277
loss_pred:0.049454521387815475, decouple_loss:0.024144141003489494
The modified gen p mean: 0.44677072763442993, gen p mean: -0.05415653437376022, mean p set: 0.44725102186203003
The modified gen p mean: 0.44858667254447937, gen p mean: -0.04822772368788719, mean p set: 0.4490669369697571
loss_pred:0.04708743840456009, decouple_loss:0.023994656279683113
loss_pred:0.04785928875207901, decouple_loss:0.025846948847174644
Iteration: 215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44735559821128845, gen p mean: -0.09241461753845215, mean p set: 0.44783589243888855
loss_pred:0.047128960490226746, decouple_loss:0.026072049513459206
The modified gen p mean: 0.44601359963417053, gen p mean: -0.08981450647115707, mean p set: 0.44649389386177063
The modified gen p mean: 0.44665274024009705, gen p mean: -0.09170222282409668, mean p set: 0.44713303446769714
loss_pred:0.046541713178157806, decouple_loss:0.025874650105834007
loss_pred:0.04671819135546684, decouple_loss:0.026174351572990417
Iteration: 216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719043374061584, gen p mean: -0.08505299687385559, mean p set: 0.44767072796821594
loss_pred:0.04958037659525871, decouple_loss:0.024802369996905327
The modified gen p mean: 0.4471842646598816, gen p mean: -0.08554844558238983, mean p set: 0.4476645588874817
loss_pred:0.04932509735226631, decouple_loss:0.024224499240517616
The modified gen p mean: 0.4475558400154114, gen p mean: -0.08203887939453125, mean p set: 0.4480361342430115
loss_pred:0.04955616965889931, decouple_loss:0.025343043729662895
Iteration: 217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471528232097626, gen p mean: -0.05597565323114395, mean p set: 0.44763314723968506
loss_pred:0.04877782240509987, decouple_loss:0.028013229370117188
The modified gen p mean: 0.4479086697101593, gen p mean: -0.052695728838443756, mean p set: 0.4483889639377594
The modified gen p mean: 0.4463063180446625, gen p mean: -0.057578328996896744, mean p set: 0.44678664207458496
loss_pred:0.04744022712111473, decouple_loss:0.027155160903930664
loss_pred:0.048013318330049515, decouple_loss:0.026736339554190636
Iteration: 218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760948419570923, gen p mean: -0.04675188660621643, mean p set: 0.4480897784233093
loss_pred:0.047888465225696564, decouple_loss:0.02785724401473999
The modified gen p mean: 0.4477926790714264, gen p mean: -0.05575418844819069, mean p set: 0.4482730031013489
The modified gen p mean: 0.4472668766975403, gen p mean: -0.050651032477617264, mean p set: 0.44774720072746277loss_pred:0.046157676726579666, decouple_loss:0.026338061317801476
loss_pred:0.04672824963927269, decouple_loss:0.025960905477404594
Iteration: 219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471803605556488, gen p mean: -0.06370443105697632, mean p set: 0.4476606547832489
loss_pred:0.049076300114393234, decouple_loss:0.026326127350330353
The modified gen p mean: 0.4481312930583954, gen p mean: -0.06116381287574768, mean p set: 0.4486115872859955
loss_pred:0.048569872975349426, decouple_loss:0.026772305369377136
The modified gen p mean: 0.4471006393432617, gen p mean: -0.06809443235397339, mean p set: 0.44758090376853943
loss_pred:0.0489824078977108, decouple_loss:0.025934621691703796
Iteration: 220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473910927772522, gen p mean: -0.052807293832302094, mean p set: 0.4478713572025299
loss_pred:0.05004139244556427, decouple_loss:0.023814931511878967
The modified gen p mean: 0.4474899470806122, gen p mean: -0.057104140520095825, mean p set: 0.4479702413082123
The modified gen p mean: 0.4472975432872772, gen p mean: -0.05820957571268082, mean p set: 0.4477778375148773
loss_pred:0.046785078942775726, decouple_loss:0.02444840967655182
loss_pred:0.046236034482717514, decouple_loss:0.02426864579319954
2023-04-19 01:20:13 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.05236804485321045, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.05054272711277008, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.0512426383793354, mean p set: 0.44879910349845886
loss_pred:0.047762639820575714, decouple_loss:0.026028962805867195
loss_pred:0.04853273555636406, decouple_loss:0.026111885905265808
loss_pred:0.048543255776166916, decouple_loss:0.02683568373322487
WV_0_PC_1_EH_0_PS_40, loss: 0.04959581792354584, avg_mse: 0.05101510137319565
current test mse: 0.051015
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464106261730194, gen p mean: -0.05308723449707031, mean p set: 0.4468908905982971
loss_pred:0.04606835916638374, decouple_loss:0.029584934934973717
The modified gen p mean: 0.4466387629508972, gen p mean: -0.05383596941828728, mean p set: 0.4471190571784973
loss_pred:0.046175967901945114, decouple_loss:0.02786165475845337
The modified gen p mean: 0.44781818985939026, gen p mean: -0.052576880902051926, mean p set: 0.44829845428466797
loss_pred:0.04722750186920166, decouple_loss:0.02870996855199337
Iteration: 222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474863111972809, gen p mean: -0.05829441174864769, mean p set: 0.447966605424881
loss_pred:0.044402752071619034, decouple_loss:0.025965988636016846
The modified gen p mean: 0.44633227586746216, gen p mean: -0.05088040977716446, mean p set: 0.44681257009506226
loss_pred:0.04751478135585785, decouple_loss:0.02580111287534237
The modified gen p mean: 0.4465515613555908, gen p mean: -0.051350854337215424, mean p set: 0.4470318555831909
loss_pred:0.04609365016222, decouple_loss:0.025191841647028923
Iteration: 223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468054175376892, gen p mean: -0.0645671933889389, mean p set: 0.4472857117652893
loss_pred:0.0466313362121582, decouple_loss:0.024763405323028564
The modified gen p mean: 0.4461483955383301, gen p mean: -0.06345897167921066, mean p set: 0.4466286599636078
loss_pred:0.045672930777072906, decouple_loss:0.023981284350156784
The modified gen p mean: 0.4482708275318146, gen p mean: -0.0689663290977478, mean p set: 0.44875115156173706
loss_pred:0.047080203890800476, decouple_loss:0.026227036491036415
Iteration: 224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455258548259735, gen p mean: -0.058329787105321884, mean p set: 0.4460061490535736
loss_pred:0.04897558316588402, decouple_loss:0.02689356915652752
The modified gen p mean: 0.44735249876976013, gen p mean: -0.06335277855396271, mean p set: 0.44783279299736023
loss_pred:0.04551547020673752, decouple_loss:0.024081280454993248
The modified gen p mean: 0.4455268085002899, gen p mean: -0.056907135993242264, mean p set: 0.44600710272789
loss_pred:0.047817155718803406, decouple_loss:0.02713974379003048
Iteration: 225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717806577682495, gen p mean: -0.0500047504901886, mean p set: 0.44765836000442505
loss_pred:0.04463851824402809, decouple_loss:0.024807259440422058
The modified gen p mean: 0.44729194045066833, gen p mean: -0.05084677413105965, mean p set: 0.44777220487594604
The modified gen p mean: 0.4458523094654083, gen p mean: -0.05020346865057945, mean p set: 0.4463326036930084
loss_pred:0.046723976731300354, decouple_loss:0.026626301929354668
loss_pred:0.04529482498764992, decouple_loss:0.02380627766251564
Iteration: 226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469894468784332, gen p mean: -0.058039743453264236, mean p set: 0.4474697411060333
loss_pred:0.045327868312597275, decouple_loss:0.02327229455113411
The modified gen p mean: 0.4454604387283325, gen p mean: -0.058418892323970795, mean p set: 0.44594070315361023
loss_pred:0.04611758515238762, decouple_loss:0.023012999445199966
The modified gen p mean: 0.4476753771305084, gen p mean: -0.061004120856523514, mean p set: 0.4481556713581085
loss_pred:0.046053554862737656, decouple_loss:0.025118816643953323
Iteration: 227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487743079662323, gen p mean: -0.05713875591754913, mean p set: 0.4492546021938324
loss_pred:0.045775119215250015, decouple_loss:0.02459738589823246
The modified gen p mean: 0.44738298654556274, gen p mean: -0.051582690328359604, mean p set: 0.44786328077316284
loss_pred:0.04643527418375015, decouple_loss:0.028707122430205345
The modified gen p mean: 0.4471036195755005, gen p mean: -0.053827036172151566, mean p set: 0.4475838840007782
loss_pred:0.04573403671383858, decouple_loss:0.0244413074105978
Iteration: 228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446135550737381, gen p mean: -0.07212122529745102, mean p set: 0.4466158449649811
loss_pred:0.04572002962231636, decouple_loss:0.026841824874281883
The modified gen p mean: 0.4470798075199127, gen p mean: -0.07671735435724258, mean p set: 0.4475601017475128
loss_pred:0.04786529019474983, decouple_loss:0.027094220742583275
The modified gen p mean: 0.4472388029098511, gen p mean: -0.07620198279619217, mean p set: 0.44771912693977356
loss_pred:0.04791110008955002, decouple_loss:0.025773778557777405
Iteration: 229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44670215249061584, gen p mean: -0.042319588363170624, mean p set: 0.44718244671821594
loss_pred:0.04580225422978401, decouple_loss:0.026427030563354492
The modified gen p mean: 0.4467404782772064, gen p mean: -0.038929589092731476, mean p set: 0.4472208023071289
loss_pred:0.04507122188806534, decouple_loss:0.028224583715200424
The modified gen p mean: 0.4469175338745117, gen p mean: -0.03840081766247749, mean p set: 0.44739779829978943
loss_pred:0.04783153533935547, decouple_loss:0.02942608669400215
Iteration: 230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465046525001526, gen p mean: -0.062391169369220734, mean p set: 0.4469849467277527
The modified gen p mean: 0.44827795028686523, gen p mean: -0.06346285343170166, mean p set: 0.44875821471214294
loss_pred:0.04486899450421333, decouple_loss:0.024118680506944656
loss_pred:0.046068225055933, decouple_loss:0.02604207769036293
The modified gen p mean: 0.4473675787448883, gen p mean: -0.06544303148984909, mean p set: 0.4478478729724884
loss_pred:0.04430448263883591, decouple_loss:0.024700798094272614
2023-04-19 01:22:50 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.08447811007499695, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.08210340142250061, mean p set: 0.4498290419578552
The modified gen p mean: 0.44831880927085876, gen p mean: -0.08150406181812286, mean p set: 0.44879910349845886
loss_pred:0.04729894548654556, decouple_loss:0.02600458823144436
loss_pred:0.04795234277844429, decouple_loss:0.02457377128303051
loss_pred:0.04809162765741348, decouple_loss:0.02360263280570507
WV_0_PC_1_EH_0_PS_40, loss: 0.049017325043678284, avg_mse: 0.05086575821042061
current test mse: 0.050866
Iteration: 231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44655048847198486, gen p mean: -0.07979980111122131, mean p set: 0.44703078269958496
loss_pred:0.04738814756274223, decouple_loss:0.02312692068517208
The modified gen p mean: 0.4473969638347626, gen p mean: -0.07904759049415588, mean p set: 0.44787725806236267
loss_pred:0.047447096556425095, decouple_loss:0.023609602823853493
The modified gen p mean: 0.44630926847457886, gen p mean: -0.07935058325529099, mean p set: 0.44678959250450134
loss_pred:0.04505487531423569, decouple_loss:0.023138580843806267
Iteration: 232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466874897480011, gen p mean: -0.07213136553764343, mean p set: 0.4471677839756012
loss_pred:0.04466046765446663, decouple_loss:0.024111822247505188
The modified gen p mean: 0.447671502828598, gen p mean: -0.07338611036539078, mean p set: 0.44815176725387573
loss_pred:0.04626556113362312, decouple_loss:0.02260022610425949
The modified gen p mean: 0.4478625953197479, gen p mean: -0.0723508819937706, mean p set: 0.44834285974502563
loss_pred:0.04518676549196243, decouple_loss:0.023479724302887917
Iteration: 233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475334584712982, gen p mean: -0.06512720137834549, mean p set: 0.4480137526988983
loss_pred:0.04452504217624664, decouple_loss:0.02352040633559227
The modified gen p mean: 0.4468916654586792, gen p mean: -0.06592237204313278, mean p set: 0.4473719894886017
loss_pred:0.04735557362437248, decouple_loss:0.02297937124967575
The modified gen p mean: 0.44916796684265137, gen p mean: -0.07140178978443146, mean p set: 0.44964826107025146
loss_pred:0.042883142828941345, decouple_loss:0.02509826235473156
Iteration: 234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446512371301651, gen p mean: -0.061576612293720245, mean p set: 0.4469926357269287
The modified gen p mean: 0.44768601655960083, gen p mean: -0.06344276666641235, mean p set: 0.4481663107872009
loss_pred:0.04699580371379852, decouple_loss:0.022847827523946762
loss_pred:0.04617099463939667, decouple_loss:0.023723682388663292
The modified gen p mean: 0.44714266061782837, gen p mean: -0.06037701293826103, mean p set: 0.44762295484542847
loss_pred:0.04664136469364166, decouple_loss:0.023176897317171097
Iteration: 235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661250710487366, gen p mean: -0.04702851548790932, mean p set: 0.44709280133247375
The modified gen p mean: 0.44697314500808716, gen p mean: -0.045741692185401917, mean p set: 0.44745346903800964
loss_pred:0.04547181725502014, decouple_loss:0.022133806720376015
loss_pred:0.046382978558540344, decouple_loss:0.0234143678098917
The modified gen p mean: 0.4470362365245819, gen p mean: -0.048929110169410706, mean p set: 0.447516530752182
loss_pred:0.046412769705057144, decouple_loss:0.022512611001729965
Iteration: 236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797658920288086, gen p mean: -0.04676138609647751, mean p set: 0.44845691323280334
The modified gen p mean: 0.4466509521007538, gen p mean: -0.049097247421741486, mean p set: 0.4471312463283539
loss_pred:0.045547209680080414, decouple_loss:0.02181900665163994
loss_pred:0.04369761422276497, decouple_loss:0.0240864846855402
The modified gen p mean: 0.447029709815979, gen p mean: -0.043170809745788574, mean p set: 0.4475100040435791
loss_pred:0.04338541254401207, decouple_loss:0.02247391827404499
Iteration: 237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44645535945892334, gen p mean: -0.051512882113456726, mean p set: 0.44693562388420105
The modified gen p mean: 0.44876816868782043, gen p mean: -0.05243442580103874, mean p set: 0.44924843311309814
loss_pred:0.04418467730283737, decouple_loss:0.024875804781913757
loss_pred:0.04313602298498154, decouple_loss:0.02313936874270439
The modified gen p mean: 0.4480457603931427, gen p mean: -0.051643338054418564, mean p set: 0.4485260546207428
loss_pred:0.04547837749123573, decouple_loss:0.024233734235167503
Iteration: 238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815972447395325, gen p mean: -0.06491313129663467, mean p set: 0.44864004850387573
The modified gen p mean: 0.44844359159469604, gen p mean: -0.0650034099817276, mean p set: 0.44892388582229614loss_pred:0.045909784734249115, decouple_loss:0.02317403443157673
loss_pred:0.046864304691553116, decouple_loss:0.023246947675943375
The modified gen p mean: 0.44786641001701355, gen p mean: -0.06353987753391266, mean p set: 0.44834670424461365
loss_pred:0.04436734691262245, decouple_loss:0.02434668131172657
Iteration: 239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44692403078079224, gen p mean: -0.036354511976242065, mean p set: 0.44740432500839233
loss_pred:0.04441250115633011, decouple_loss:0.027955029159784317
The modified gen p mean: 0.44737598299980164, gen p mean: -0.0352189727127552, mean p set: 0.44785624742507935
loss_pred:0.042728155851364136, decouple_loss:0.027108417823910713
The modified gen p mean: 0.44839704036712646, gen p mean: -0.03769936040043831, mean p set: 0.44887736439704895
loss_pred:0.04505373165011406, decouple_loss:0.0257469080388546
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44644027948379517, gen p mean: -0.048071954399347305, mean p set: 0.44692057371139526
loss_pred:0.04543086513876915, decouple_loss:0.02272620052099228
The modified gen p mean: 0.4475764334201813, gen p mean: -0.05020013451576233, mean p set: 0.448056697845459
loss_pred:0.04574648663401604, decouple_loss:0.02328070066869259
The modified gen p mean: 0.44925034046173096, gen p mean: -0.057688869535923004, mean p set: 0.44973060488700867
loss_pred:0.042806368321180344, decouple_loss:0.022940117865800858
2023-04-19 01:24:44 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.066946841776371, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.06465473026037216, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.06474964320659637, mean p set: 0.44879910349845886
loss_pred:0.04646197333931923, decouple_loss:0.02417520247399807
loss_pred:0.04722454771399498, decouple_loss:0.023125166073441505
loss_pred:0.04729708656668663, decouple_loss:0.022996587678790092
WV_0_PC_1_EH_0_PS_40, loss: 0.04816615581512451, avg_mse: 0.0504319928586483
current test mse: 0.050432
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483192265033722, gen p mean: -0.06187836453318596, mean p set: 0.4487995207309723
loss_pred:0.045724328607320786, decouple_loss:0.02548483945429325
The modified gen p mean: 0.44733601808547974, gen p mean: -0.06794458627700806, mean p set: 0.44781628251075745
loss_pred:0.04462866857647896, decouple_loss:0.024425609037280083
The modified gen p mean: 0.4481970965862274, gen p mean: -0.06319813430309296, mean p set: 0.4486773908138275
loss_pred:0.04464169591665268, decouple_loss:0.025447625666856766
Iteration: 242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460369944572449, gen p mean: -0.06697773933410645, mean p set: 0.44651728868484497
loss_pred:0.04468515142798424, decouple_loss:0.025177963078022003
The modified gen p mean: 0.4481734335422516, gen p mean: -0.06735348701477051, mean p set: 0.4486536979675293
loss_pred:0.044856179505586624, decouple_loss:0.02459920197725296
The modified gen p mean: 0.44725462794303894, gen p mean: -0.06698168069124222, mean p set: 0.44773492217063904
loss_pred:0.0442417748272419, decouple_loss:0.025052381679415703
Iteration: 243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481574296951294, gen p mean: -0.04891831800341606, mean p set: 0.4486377537250519
The modified gen p mean: 0.44784218072891235, gen p mean: -0.046523068100214005, mean p set: 0.44832247495651245
loss_pred:0.0451691597700119, decouple_loss:0.02352880872786045
loss_pred:0.04604414477944374, decouple_loss:0.02361847646534443
The modified gen p mean: 0.4478653371334076, gen p mean: -0.048655908554792404, mean p set: 0.4483456313610077
loss_pred:0.04654988646507263, decouple_loss:0.023627255111932755
Iteration: 244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44804468750953674, gen p mean: -0.03299236297607422, mean p set: 0.44852498173713684
The modified gen p mean: 0.44809389114379883, gen p mean: -0.03357724845409393, mean p set: 0.4485742151737213
loss_pred:0.045523859560489655, decouple_loss:0.023160811513662338
loss_pred:0.04373342543840408, decouple_loss:0.025540681555867195
The modified gen p mean: 0.4479922950267792, gen p mean: -0.03223773092031479, mean p set: 0.4484725892543793
loss_pred:0.04390564560890198, decouple_loss:0.024937517940998077
Iteration: 245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751396775245667, gen p mean: -0.05333654582500458, mean p set: 0.44799429178237915
The modified gen p mean: 0.44667744636535645, gen p mean: -0.052770230919122696, mean p set: 0.44715774059295654
loss_pred:0.043097060173749924, decouple_loss:0.02479798160493374
loss_pred:0.04475448653101921, decouple_loss:0.024522559717297554
The modified gen p mean: 0.44727715849876404, gen p mean: -0.05387640744447708, mean p set: 0.44775745272636414
loss_pred:0.04503701627254486, decouple_loss:0.02876926213502884
Iteration: 246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44782301783561707, gen p mean: -0.06136535853147507, mean p set: 0.44830334186553955
loss_pred:0.04605928063392639, decouple_loss:0.02373153530061245
The modified gen p mean: 0.44716647267341614, gen p mean: -0.0546608604490757, mean p set: 0.44764673709869385
loss_pred:0.04378249868750572, decouple_loss:0.02289508655667305
The modified gen p mean: 0.44786497950553894, gen p mean: -0.054734207689762115, mean p set: 0.44834527373313904
loss_pred:0.0442206971347332, decouple_loss:0.023176994174718857
Iteration: 247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466976225376129, gen p mean: -0.038933079689741135, mean p set: 0.447177916765213
loss_pred:0.04483701288700104, decouple_loss:0.028423501178622246
The modified gen p mean: 0.44795340299606323, gen p mean: -0.03770511597394943, mean p set: 0.44843369722366333
The modified gen p mean: 0.4468432366847992, gen p mean: -0.038565944880247116, mean p set: 0.4473235309123993
loss_pred:0.043910279870033264, decouple_loss:0.028678379952907562
loss_pred:0.04593586549162865, decouple_loss:0.02784813940525055
Iteration: 248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448651522397995, gen p mean: -0.04902829974889755, mean p set: 0.4491317868232727
loss_pred:0.04392632842063904, decouple_loss:0.027755720540881157
The modified gen p mean: 0.4458562433719635, gen p mean: -0.04815831407904625, mean p set: 0.446336567401886
The modified gen p mean: 0.4466300308704376, gen p mean: -0.0451698862016201, mean p set: 0.4471103250980377
loss_pred:0.04577264562249184, decouple_loss:0.02800166979432106
loss_pred:0.045934077352285385, decouple_loss:0.026580987498164177
Iteration: 249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732123613357544, gen p mean: -0.05261689051985741, mean p set: 0.44780153036117554
loss_pred:0.045620497316122055, decouple_loss:0.02819734252989292
The modified gen p mean: 0.44827932119369507, gen p mean: -0.05072455480694771, mean p set: 0.44875964522361755
loss_pred:0.042755190283060074, decouple_loss:0.027531586587429047
The modified gen p mean: 0.44769221544265747, gen p mean: -0.04795362055301666, mean p set: 0.44817250967025757
loss_pred:0.046220794320106506, decouple_loss:0.025647282600402832
Iteration: 250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812795519828796, gen p mean: -0.04419147968292236, mean p set: 0.44860827922821045
loss_pred:0.0445670448243618, decouple_loss:0.031258292496204376
The modified gen p mean: 0.4476579427719116, gen p mean: -0.04963933676481247, mean p set: 0.4481382668018341
loss_pred:0.04404288902878761, decouple_loss:0.033855583518743515
The modified gen p mean: 0.4466927945613861, gen p mean: -0.04489518702030182, mean p set: 0.4471730887889862
loss_pred:0.04539243504405022, decouple_loss:0.03464168310165405
2023-04-19 01:27:22 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.053824782371520996, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.0527903251349926, mean p set: 0.4498290419578552
The modified gen p mean: 0.44831880927085876, gen p mean: -0.05312468111515045, mean p set: 0.44879910349845886
loss_pred:0.046452056616544724, decouple_loss:0.029250776395201683
loss_pred:0.047724246978759766, decouple_loss:0.027839362621307373
loss_pred:0.04715154692530632, decouple_loss:0.02724631130695343
WV_0_PC_1_EH_0_PS_40, loss: 0.048514895141124725, avg_mse: 0.0507647730410099
current test mse: 0.050765
Iteration: 251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44606471061706543, gen p mean: -0.05515620484948158, mean p set: 0.4465450048446655
The modified gen p mean: 0.4470152258872986, gen p mean: -0.05136776715517044, mean p set: 0.4474954903125763
The modified gen p mean: 0.44763290882110596, gen p mean: -0.055514171719551086, mean p set: 0.44811320304870605loss_pred:0.04532383382320404, decouple_loss:0.02611139975488186loss_pred:0.04466407746076584, decouple_loss:0.025111917406320572
loss_pred:0.04309402033686638, decouple_loss:0.02684641070663929
Iteration: 252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44809916615486145, gen p mean: -0.06127055361866951, mean p set: 0.44857946038246155
loss_pred:0.043361347168684006, decouple_loss:0.028890589252114296
The modified gen p mean: 0.4480590224266052, gen p mean: -0.06112527474761009, mean p set: 0.4485393166542053
loss_pred:0.04461386427283287, decouple_loss:0.033344727009534836
The modified gen p mean: 0.44665244221687317, gen p mean: -0.06196267902851105, mean p set: 0.44713273644447327
loss_pred:0.04441094025969505, decouple_loss:0.03049289993941784
Iteration: 253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466818571090698, gen p mean: -0.04403655603528023, mean p set: 0.4471621811389923
The modified gen p mean: 0.4464249908924103, gen p mean: -0.0427645668387413, mean p set: 0.4469052851200104
loss_pred:0.04667361453175545, decouple_loss:0.025819599628448486
loss_pred:0.045051392167806625, decouple_loss:0.025802455842494965
The modified gen p mean: 0.4475368559360504, gen p mean: -0.04368272423744202, mean p set: 0.4480171501636505
loss_pred:0.04365403577685356, decouple_loss:0.02700331062078476
Iteration: 254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471943974494934, gen p mean: -0.02839883230626583, mean p set: 0.4476746618747711
loss_pred:0.042813755571842194, decouple_loss:0.028302691876888275
The modified gen p mean: 0.44619259238243103, gen p mean: -0.032323386520147324, mean p set: 0.44667288661003113
loss_pred:0.04377393051981926, decouple_loss:0.026996707543730736
The modified gen p mean: 0.44777384400367737, gen p mean: -0.028434917330741882, mean p set: 0.4482541084289551
loss_pred:0.04415834695100784, decouple_loss:0.03130022808909416
Iteration: 255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811680912971497, gen p mean: -0.03956827148795128, mean p set: 0.4485970735549927
loss_pred:0.04349691793322563, decouple_loss:0.025586269795894623
The modified gen p mean: 0.4483369290828705, gen p mean: -0.04039060324430466, mean p set: 0.4488171935081482
loss_pred:0.043019212782382965, decouple_loss:0.025303451344370842
The modified gen p mean: 0.4467615783214569, gen p mean: -0.04217255115509033, mean p set: 0.447241872549057
loss_pred:0.044088829308748245, decouple_loss:0.029023151844739914
Iteration: 256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44792693853378296, gen p mean: -0.05918221175670624, mean p set: 0.44840726256370544
loss_pred:0.043773751705884933, decouple_loss:0.023427100852131844
The modified gen p mean: 0.4473423361778259, gen p mean: -0.06084761396050453, mean p set: 0.447822630405426
loss_pred:0.04380878061056137, decouple_loss:0.023371342569589615
The modified gen p mean: 0.4474705159664154, gen p mean: -0.058169931173324585, mean p set: 0.4479508101940155
loss_pred:0.04371428117156029, decouple_loss:0.024361848831176758
Iteration: 257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473123550415039, gen p mean: -0.04653388634324074, mean p set: 0.4477926790714264
loss_pred:0.04372447356581688, decouple_loss:0.02779778465628624
The modified gen p mean: 0.44784584641456604, gen p mean: -0.04760591313242912, mean p set: 0.44832614064216614
loss_pred:0.042073607444763184, decouple_loss:0.02758016437292099
The modified gen p mean: 0.4473298192024231, gen p mean: -0.04579625651240349, mean p set: 0.4478101134300232
loss_pred:0.04253330081701279, decouple_loss:0.028727924451231956
Iteration: 258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762372970581055, gen p mean: -0.036504149436950684, mean p set: 0.44810402393341064
loss_pred:0.04385058209300041, decouple_loss:0.02756771631538868
The modified gen p mean: 0.44772395491600037, gen p mean: -0.03733311966061592, mean p set: 0.44820424914360046
loss_pred:0.04364372044801712, decouple_loss:0.026660755276679993
The modified gen p mean: 0.4462664723396301, gen p mean: -0.03948936238884926, mean p set: 0.4467467665672302
loss_pred:0.042889539152383804, decouple_loss:0.02452419139444828
Iteration: 259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476127028465271, gen p mean: -0.04377893730998039, mean p set: 0.4480930268764496
loss_pred:0.043325141072273254, decouple_loss:0.02347901649773121
The modified gen p mean: 0.4463234841823578, gen p mean: -0.04662147909402847, mean p set: 0.4468037486076355
loss_pred:0.04313056915998459, decouple_loss:0.022035738453269005
The modified gen p mean: 0.4486333727836609, gen p mean: -0.04506480321288109, mean p set: 0.449113667011261
loss_pred:0.04596097022294998, decouple_loss:0.023064909502863884
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733956456184387, gen p mean: -0.05634189024567604, mean p set: 0.44781988859176636
loss_pred:0.04548400267958641, decouple_loss:0.02413043938577175
The modified gen p mean: 0.44744783639907837, gen p mean: -0.05737287178635597, mean p set: 0.44792816042900085
loss_pred:0.04390210658311844, decouple_loss:0.024545278400182724
The modified gen p mean: 0.4455784261226654, gen p mean: -0.05303584039211273, mean p set: 0.4460587203502655
loss_pred:0.04396607726812363, decouple_loss:0.024214409291744232
2023-04-19 01:29:15 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.050704922527074814, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.04967375844717026, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.04944147914648056, mean p set: 0.44879910349845886
loss_pred:0.04676789045333862, decouple_loss:0.029708942398428917
loss_pred:0.04777201637625694, decouple_loss:0.028106458485126495
loss_pred:0.04721634089946747, decouple_loss:0.027403580024838448
WV_0_PC_1_EH_0_PS_40, loss: 0.048672400414943695, avg_mse: 0.05175185948610306
current test mse: 0.051752
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
Iteration: 261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44546782970428467, gen p mean: -0.050338875502347946, mean p set: 0.4459480941295624
loss_pred:0.04336503893136978, decouple_loss:0.0270360317081213
The modified gen p mean: 0.44722798466682434, gen p mean: -0.04911932349205017, mean p set: 0.44770827889442444
The modified gen p mean: 0.44418948888778687, gen p mean: -0.04779169708490372, mean p set: 0.44466984272003174
loss_pred:0.0459994412958622, decouple_loss:0.026390008628368378
loss_pred:0.04676704853773117, decouple_loss:0.025035522878170013
Iteration: 262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471549987792969, gen p mean: -0.040203697979450226, mean p set: 0.44763532280921936
loss_pred:0.04551472142338753, decouple_loss:0.023152275010943413
The modified gen p mean: 0.4456939697265625, gen p mean: -0.042948249727487564, mean p set: 0.446174293756485
The modified gen p mean: 0.44652271270751953, gen p mean: -0.04039011523127556, mean p set: 0.447003036737442
loss_pred:0.044158779084682465, decouple_loss:0.023349709808826447
loss_pred:0.044630106538534164, decouple_loss:0.025459501892328262
Iteration: 263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44558167457580566, gen p mean: -0.03794068843126297, mean p set: 0.44606199860572815
loss_pred:0.04430472105741501, decouple_loss:0.02697640098631382
The modified gen p mean: 0.44565340876579285, gen p mean: -0.03528552129864693, mean p set: 0.44613370299339294The modified gen p mean: 0.44716018438339233, gen p mean: -0.03439544141292572, mean p set: 0.4476405084133148
loss_pred:0.04240201413631439, decouple_loss:0.02620229497551918
loss_pred:0.044312041252851486, decouple_loss:0.025009773671627045
Iteration: 264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476238787174225, gen p mean: -0.03646107017993927, mean p set: 0.4481041729450226
loss_pred:0.04627060145139694, decouple_loss:0.02273695357143879
The modified gen p mean: 0.44630181789398193, gen p mean: -0.035578321665525436, mean p set: 0.44678211212158203
The modified gen p mean: 0.4464186728000641, gen p mean: -0.034515395760536194, mean p set: 0.4468989372253418
loss_pred:0.04492245241999626, decouple_loss:0.02351793833076954
loss_pred:0.04613533616065979, decouple_loss:0.02329121343791485
Iteration: 265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44671282172203064, gen p mean: -0.04469764232635498, mean p set: 0.44719311594963074
loss_pred:0.044473785907030106, decouple_loss:0.024579260498285294
The modified gen p mean: 0.44583043456077576, gen p mean: -0.047058675438165665, mean p set: 0.44631072878837585
The modified gen p mean: 0.44692474603652954, gen p mean: -0.046081870794296265, mean p set: 0.447405070066452
loss_pred:0.04178531467914581, decouple_loss:0.027381859719753265
loss_pred:0.04392392188310623, decouple_loss:0.027263939380645752
Iteration: 266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447144091129303, gen p mean: -0.052064161747694016, mean p set: 0.4476243555545807
loss_pred:0.04315429925918579, decouple_loss:0.032003264874219894
The modified gen p mean: 0.44659748673439026, gen p mean: -0.050182048231363297, mean p set: 0.44707778096199036
The modified gen p mean: 0.44683507084846497, gen p mean: -0.04820408672094345, mean p set: 0.44731536507606506
loss_pred:0.04415612295269966, decouple_loss:0.029475023970007896
loss_pred:0.044995781034231186, decouple_loss:0.029445266351103783
Iteration: 267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470645785331726, gen p mean: -0.04806441441178322, mean p set: 0.4475449025630951
The modified gen p mean: 0.44591376185417175, gen p mean: -0.0496169850230217, mean p set: 0.44639402627944946loss_pred:0.04496060684323311, decouple_loss:0.025202015414834023
The modified gen p mean: 0.4464435279369354, gen p mean: -0.04663942754268646, mean p set: 0.4469238221645355
loss_pred:0.042834144085645676, decouple_loss:0.024002544581890106
loss_pred:0.045665014535188675, decouple_loss:0.024620480835437775
Iteration: 268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44547614455223083, gen p mean: -0.05053752288222313, mean p set: 0.44595643877983093
loss_pred:0.04342150315642357, decouple_loss:0.028565436601638794
The modified gen p mean: 0.4459589421749115, gen p mean: -0.04945744201540947, mean p set: 0.4464392364025116
The modified gen p mean: 0.44592511653900146, gen p mean: -0.04938027635216713, mean p set: 0.44640541076660156
loss_pred:0.042121436446905136, decouple_loss:0.02827020362019539
loss_pred:0.04245549812912941, decouple_loss:0.030148465186357498
Iteration: 269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44705435633659363, gen p mean: -0.03863511234521866, mean p set: 0.4475346803665161
loss_pred:0.04686044529080391, decouple_loss:0.023761363700032234
The modified gen p mean: 0.4470517337322235, gen p mean: -0.042319703847169876, mean p set: 0.4475320279598236
The modified gen p mean: 0.4471542239189148, gen p mean: -0.040257640182971954, mean p set: 0.4476345181465149
loss_pred:0.04237821325659752, decouple_loss:0.025308780372142792
loss_pred:0.044251058250665665, decouple_loss:0.024373583495616913
Iteration: 270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44681504368782043, gen p mean: -0.038080669939517975, mean p set: 0.44729533791542053
loss_pred:0.04402529448270798, decouple_loss:0.025209739804267883
The modified gen p mean: 0.4449183940887451, gen p mean: -0.03597760945558548, mean p set: 0.4453986883163452
loss_pred:0.045690104365348816, decouple_loss:0.0247025229036808
The modified gen p mean: 0.44563719630241394, gen p mean: -0.03777751326560974, mean p set: 0.44611749053001404
loss_pred:0.04230523854494095, decouple_loss:0.02354864589869976
2023-04-19 01:31:49 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.034149087965488434, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.033229608088731766, mean p set: 0.4498290419578552
The modified gen p mean: 0.44831880927085876, gen p mean: -0.03302125632762909, mean p set: 0.44879910349845886
loss_pred:0.04610872268676758, decouple_loss:0.033718325197696686
loss_pred:0.04664187878370285, decouple_loss:0.030705029144883156
loss_pred:0.04630361124873161, decouple_loss:0.02889118157327175
WV_0_PC_1_EH_0_PS_40, loss: 0.047906648367643356, avg_mse: 0.050777725875377655
current test mse: 0.050778
Iteration: 271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44587963819503784, gen p mean: -0.03498951718211174, mean p set: 0.4463599622249603
The modified gen p mean: 0.4460996687412262, gen p mean: -0.03543713688850403, mean p set: 0.4465799629688263
loss_pred:0.044049471616744995, decouple_loss:0.02614610083401203
loss_pred:0.04215095192193985, decouple_loss:0.02924519218504429
The modified gen p mean: 0.4465303421020508, gen p mean: -0.03722940385341644, mean p set: 0.4470106363296509
loss_pred:0.04411054030060768, decouple_loss:0.023009728640317917
Iteration: 272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457946717739105, gen p mean: -0.03616832196712494, mean p set: 0.446274995803833
loss_pred:0.0455784797668457, decouple_loss:0.023621082305908203
The modified gen p mean: 0.44647565484046936, gen p mean: -0.036888811737298965, mean p set: 0.44695594906806946
The modified gen p mean: 0.4473856985569, gen p mean: -0.03685963153839111, mean p set: 0.4478660225868225
loss_pred:0.04287586361169815, decouple_loss:0.023683695122599602
loss_pred:0.0460154227912426, decouple_loss:0.02367592789232731
Iteration: 273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4451724886894226, gen p mean: -0.04042280465364456, mean p set: 0.4456527829170227
loss_pred:0.04461519792675972, decouple_loss:0.024930091574788094
The modified gen p mean: 0.4466024339199066, gen p mean: -0.04094505310058594, mean p set: 0.4470827281475067
loss_pred:0.04270966723561287, decouple_loss:0.02622063085436821
The modified gen p mean: 0.44665977358818054, gen p mean: -0.03932778164744377, mean p set: 0.44714006781578064
loss_pred:0.043115101754665375, decouple_loss:0.02704208344221115
Iteration: 274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701582193374634, gen p mean: -0.03471481055021286, mean p set: 0.44749611616134644
loss_pred:0.044883109629154205, decouple_loss:0.02663290686905384
The modified gen p mean: 0.4463280737400055, gen p mean: -0.03343284875154495, mean p set: 0.4468083381652832
loss_pred:0.043141577392816544, decouple_loss:0.031032744795084
The modified gen p mean: 0.44717806577682495, gen p mean: -0.03379315510392189, mean p set: 0.44765836000442505
loss_pred:0.0450255386531353, decouple_loss:0.031785111874341965
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44618159532546997, gen p mean: -0.03724537789821625, mean p set: 0.44666188955307007
loss_pred:0.042777568101882935, decouple_loss:0.023858850821852684
The modified gen p mean: 0.44599515199661255, gen p mean: -0.03610176965594292, mean p set: 0.44647544622421265
The modified gen p mean: 0.44696277379989624, gen p mean: -0.03648655489087105, mean p set: 0.44744303822517395
loss_pred:0.045707110315561295, decouple_loss:0.025719448924064636
loss_pred:0.04388804733753204, decouple_loss:0.02397569827735424
Iteration: 276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465557038784027, gen p mean: -0.046269550919532776, mean p set: 0.4470359981060028
loss_pred:0.04153255745768547, decouple_loss:0.028059808537364006
The modified gen p mean: 0.4465615153312683, gen p mean: -0.04287099838256836, mean p set: 0.4470418095588684
The modified gen p mean: 0.446176677942276, gen p mean: -0.04065916687250137, mean p set: 0.4466569721698761
loss_pred:0.04327787458896637, decouple_loss:0.028856011107563972
loss_pred:0.044762615114450455, decouple_loss:0.026628131046891212
Iteration: 277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44706955552101135, gen p mean: -0.04536351561546326, mean p set: 0.44754984974861145
loss_pred:0.042984478175640106, decouple_loss:0.026471514254808426
The modified gen p mean: 0.44675591588020325, gen p mean: -0.04415994882583618, mean p set: 0.44723621010780334
The modified gen p mean: 0.4479641318321228, gen p mean: -0.04195510968565941, mean p set: 0.4484444558620453
loss_pred:0.04263058304786682, decouple_loss:0.02551044151186943
loss_pred:0.04555106535553932, decouple_loss:0.02811421826481819
Iteration: 278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725629687309265, gen p mean: -0.045896366238594055, mean p set: 0.44773659110069275
The modified gen p mean: 0.44704344868659973, gen p mean: -0.04768374562263489, mean p set: 0.44752374291419983
loss_pred:0.04226768761873245, decouple_loss:0.027706943452358246
loss_pred:0.04489177092909813, decouple_loss:0.02580384910106659
The modified gen p mean: 0.44665905833244324, gen p mean: -0.04547183960676193, mean p set: 0.44713932275772095
loss_pred:0.04314107075333595, decouple_loss:0.025848088786005974
Iteration: 279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476493299007416, gen p mean: -0.04261567443609238, mean p set: 0.44812965393066406
The modified gen p mean: 0.4467942416667938, gen p mean: -0.04549021273851395, mean p set: 0.4472745358943939
loss_pred:0.04423847794532776, decouple_loss:0.025556663051247597
loss_pred:0.04269992187619209, decouple_loss:0.02491014264523983
The modified gen p mean: 0.44556576013565063, gen p mean: -0.04559988155961037, mean p set: 0.44604605436325073
loss_pred:0.042818840593099594, decouple_loss:0.024347590282559395
Iteration: 280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465024769306183, gen p mean: -0.041914619505405426, mean p set: 0.446982741355896
loss_pred:0.04280299320816994, decouple_loss:0.02729327604174614
The modified gen p mean: 0.44647130370140076, gen p mean: -0.03864599019289017, mean p set: 0.44695156812667847
The modified gen p mean: 0.4463682472705841, gen p mean: -0.04354897886514664, mean p set: 0.4468485414981842
loss_pred:0.041732728481292725, decouple_loss:0.025845201686024666
loss_pred:0.04278940707445145, decouple_loss:0.0274334866553545
2023-04-19 01:33:42 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.039834342896938324, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.0386410728096962, mean p set: 0.4498290419578552
The modified gen p mean: 0.44831880927085876, gen p mean: -0.03891375660896301, mean p set: 0.44879910349845886
loss_pred:0.04485789313912392, decouple_loss:0.029091114178299904
loss_pred:0.045450080186128616, decouple_loss:0.026885421946644783
loss_pred:0.045550741255283356, decouple_loss:0.02568836882710457
WV_0_PC_1_EH_0_PS_40, loss: 0.0466473214328289, avg_mse: 0.049289166927337646
current test mse: 0.049289
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466868042945862, gen p mean: -0.0373942069709301, mean p set: 0.4471670687198639
loss_pred:0.04242922365665436, decouple_loss:0.02763814479112625
The modified gen p mean: 0.4470561444759369, gen p mean: -0.03776362165808678, mean p set: 0.4475364685058594
loss_pred:0.03968266770243645, decouple_loss:0.02566046267747879
The modified gen p mean: 0.44700536131858826, gen p mean: -0.04002638906240463, mean p set: 0.44748565554618835
loss_pred:0.041053563356399536, decouple_loss:0.02417696639895439
Iteration: 282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758808612823486, gen p mean: -0.0204603374004364, mean p set: 0.44806838035583496
loss_pred:0.03993295133113861, decouple_loss:0.02427244558930397
The modified gen p mean: 0.446666419506073, gen p mean: -0.023392604663968086, mean p set: 0.4471467435359955
loss_pred:0.040430136024951935, decouple_loss:0.023421620950102806
The modified gen p mean: 0.4456709921360016, gen p mean: -0.023421378806233406, mean p set: 0.4461512565612793
loss_pred:0.042620811611413956, decouple_loss:0.023420870304107666
Iteration: 283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468805491924286, gen p mean: -0.019439326599240303, mean p set: 0.4473608434200287
The modified gen p mean: 0.44759318232536316, gen p mean: -0.02404608018696308, mean p set: 0.44807347655296326
loss_pred:0.04324276000261307, decouple_loss:0.02339470572769642
loss_pred:0.04153961315751076, decouple_loss:0.024908628314733505
The modified gen p mean: 0.44698435068130493, gen p mean: -0.020867345854640007, mean p set: 0.44746461510658264
loss_pred:0.041842859238386154, decouple_loss:0.023303449153900146
Iteration: 284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461154639720917, gen p mean: -0.037749502807855606, mean p set: 0.44659578800201416
The modified gen p mean: 0.4451754689216614, gen p mean: -0.03311467543244362, mean p set: 0.44565579295158386
loss_pred:0.04185246676206589, decouple_loss:0.026037098839879036
loss_pred:0.04088675230741501, decouple_loss:0.028093352913856506
The modified gen p mean: 0.4461234509944916, gen p mean: -0.03430844098329544, mean p set: 0.4466037154197693
loss_pred:0.04147212579846382, decouple_loss:0.02424611896276474
Iteration: 285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4453771114349365, gen p mean: -0.04840819165110588, mean p set: 0.445857435464859
The modified gen p mean: 0.44740480184555054, gen p mean: -0.04620122164487839, mean p set: 0.44788506627082825
loss_pred:0.04274829104542732, decouple_loss:0.02708122693002224
loss_pred:0.041978489607572556, decouple_loss:0.024536633864045143
The modified gen p mean: 0.44605761766433716, gen p mean: -0.04643350467085838, mean p set: 0.44653791189193726
loss_pred:0.042111609131097794, decouple_loss:0.025800593197345734
Iteration: 286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44530779123306274, gen p mean: -0.042973462492227554, mean p set: 0.44578808546066284
The modified gen p mean: 0.4466151297092438, gen p mean: -0.04073317348957062, mean p set: 0.44709545373916626
loss_pred:0.041210614144802094, decouple_loss:0.023794211447238922
loss_pred:0.04011772945523262, decouple_loss:0.02487793006002903
The modified gen p mean: 0.44634103775024414, gen p mean: -0.03920697420835495, mean p set: 0.44682133197784424
loss_pred:0.04110575094819069, decouple_loss:0.026866145431995392
Iteration: 287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459965229034424, gen p mean: -0.04534672573208809, mean p set: 0.44647684693336487
loss_pred:0.043551985174417496, decouple_loss:0.021298760548233986
The modified gen p mean: 0.4463663399219513, gen p mean: -0.046560049057006836, mean p set: 0.446846604347229
The modified gen p mean: 0.44705235958099365, gen p mean: -0.05098797753453255, mean p set: 0.44753265380859375
loss_pred:0.042242202907800674, decouple_loss:0.022100934758782387
loss_pred:0.039331160485744476, decouple_loss:0.021862318739295006
Iteration: 288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756370782852173, gen p mean: -0.05384090542793274, mean p set: 0.4480440020561218
loss_pred:0.03859523683786392, decouple_loss:0.02204855903983116
The modified gen p mean: 0.44643449783325195, gen p mean: -0.05473000928759575, mean p set: 0.44691479206085205
The modified gen p mean: 0.44701677560806274, gen p mean: -0.05499345064163208, mean p set: 0.44749704003334045
loss_pred:0.0416899211704731, decouple_loss:0.023485148325562477
loss_pred:0.04170042648911476, decouple_loss:0.023783819749951363
Iteration: 289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460991322994232, gen p mean: -0.05297916382551193, mean p set: 0.4465794563293457
The modified gen p mean: 0.4452042877674103, gen p mean: -0.0556936040520668, mean p set: 0.4456845819950104
loss_pred:0.04221927374601364, decouple_loss:0.029615182429552078
loss_pred:0.04237474873661995, decouple_loss:0.027322372421622276
The modified gen p mean: 0.4467865228652954, gen p mean: -0.05338447540998459, mean p set: 0.4472668468952179
loss_pred:0.04037453606724739, decouple_loss:0.027500219643115997
Iteration: 290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468380808830261, gen p mean: -0.04017861559987068, mean p set: 0.4473183751106262
The modified gen p mean: 0.44680145382881165, gen p mean: -0.0419793576002121, mean p set: 0.44728177785873413
loss_pred:0.0402865968644619, decouple_loss:0.026431143283843994
loss_pred:0.04019901156425476, decouple_loss:0.024471675977110863
The modified gen p mean: 0.44734692573547363, gen p mean: -0.040618278086185455, mean p set: 0.44782721996307373
loss_pred:0.04011048749089241, decouple_loss:0.025484178215265274
2023-04-19 01:36:22 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.04093755781650543, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.03959009796380997, mean p set: 0.4498290419578552
The modified gen p mean: 0.44831880927085876, gen p mean: -0.0397208072245121, mean p set: 0.44879910349845886
loss_pred:0.04394545778632164, decouple_loss:0.02386534959077835
loss_pred:0.044610969722270966, decouple_loss:0.02367648296058178
loss_pred:0.04433311149477959, decouple_loss:0.024128198623657227
WV_0_PC_1_EH_0_PS_40, loss: 0.04549100995063782, avg_mse: 0.04810909181833267
current test mse: 0.048109
Iteration: 291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678202271461487, gen p mean: -0.04215408116579056, mean p set: 0.44726231694221497
loss_pred:0.040155258029699326, decouple_loss:0.02355584129691124
The modified gen p mean: 0.44681304693222046, gen p mean: -0.04047370329499245, mean p set: 0.44729331135749817
The modified gen p mean: 0.4466697573661804, gen p mean: -0.04038923606276512, mean p set: 0.4471500515937805
loss_pred:0.04167495295405388, decouple_loss:0.024006346240639687
loss_pred:0.04035448282957077, decouple_loss:0.022813541814684868
Iteration: 292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44657978415489197, gen p mean: -0.04474331811070442, mean p set: 0.44706007838249207
loss_pred:0.04008469358086586, decouple_loss:0.028799202293157578
The modified gen p mean: 0.4469769299030304, gen p mean: -0.04432575777173042, mean p set: 0.4474572241306305
The modified gen p mean: 0.446519672870636, gen p mean: -0.04464055970311165, mean p set: 0.4469999372959137
loss_pred:0.04028277099132538, decouple_loss:0.027328481897711754
loss_pred:0.040680307894945145, decouple_loss:0.031176263466477394
Iteration: 293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466235041618347, gen p mean: -0.04072036221623421, mean p set: 0.4471038281917572
loss_pred:0.04014301672577858, decouple_loss:0.02514817751944065
The modified gen p mean: 0.44712939858436584, gen p mean: -0.035216156393289566, mean p set: 0.44760966300964355
loss_pred:0.04119915887713432, decouple_loss:0.023026298731565475
The modified gen p mean: 0.4463392496109009, gen p mean: -0.03965054079890251, mean p set: 0.446819543838501
loss_pred:0.04119415581226349, decouple_loss:0.02567121759057045
Iteration: 294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44671717286109924, gen p mean: -0.03514309599995613, mean p set: 0.44719746708869934
loss_pred:0.0430012047290802, decouple_loss:0.024428701028227806
The modified gen p mean: 0.4477007985115051, gen p mean: -0.03416420891880989, mean p set: 0.44818106293678284
The modified gen p mean: 0.4467034637928009, gen p mean: -0.03773430362343788, mean p set: 0.447183758020401
loss_pred:0.0404658168554306, decouple_loss:0.024755826219916344
loss_pred:0.04077672213315964, decouple_loss:0.02357373759150505
Iteration: 295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468703269958496, gen p mean: -0.04391104355454445, mean p set: 0.4473506212234497
loss_pred:0.04079333692789078, decouple_loss:0.031132439151406288
The modified gen p mean: 0.4477648138999939, gen p mean: -0.041218552738428116, mean p set: 0.4482450783252716
The modified gen p mean: 0.44656574726104736, gen p mean: -0.04302721843123436, mean p set: 0.44704607129096985
loss_pred:0.03940408676862717, decouple_loss:0.03259654715657234
loss_pred:0.04019602760672569, decouple_loss:0.02939460054039955
Iteration: 296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472530484199524, gen p mean: -0.04873939976096153, mean p set: 0.4477333426475525
loss_pred:0.04152548685669899, decouple_loss:0.02177930809557438
The modified gen p mean: 0.44632676243782043, gen p mean: -0.054719533771276474, mean p set: 0.44680705666542053
The modified gen p mean: 0.4484494924545288, gen p mean: -0.05104862153530121, mean p set: 0.4489297568798065
loss_pred:0.04065224155783653, decouple_loss:0.02285207435488701
loss_pred:0.039753202348947525, decouple_loss:0.02273188717663288
Iteration: 297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44651535153388977, gen p mean: -0.03811484947800636, mean p set: 0.44699564576148987
loss_pred:0.0406559593975544, decouple_loss:0.02423541061580181
The modified gen p mean: 0.44682130217552185, gen p mean: -0.04000274837017059, mean p set: 0.44730156660079956
The modified gen p mean: 0.44643330574035645, gen p mean: -0.03811314329504967, mean p set: 0.44691362977027893
loss_pred:0.04049212485551834, decouple_loss:0.026198606938123703
loss_pred:0.0407908596098423, decouple_loss:0.023218074813485146
Iteration: 298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715139269828796, gen p mean: -0.024040203541517258, mean p set: 0.4476316571235657
loss_pred:0.04029330611228943, decouple_loss:0.023647353053092957
The modified gen p mean: 0.44610628485679626, gen p mean: -0.030554963275790215, mean p set: 0.44658660888671875
The modified gen p mean: 0.44679540395736694, gen p mean: -0.02670248970389366, mean p set: 0.44727569818496704
loss_pred:0.04112911596894264, decouple_loss:0.022398347035050392
loss_pred:0.040291111916303635, decouple_loss:0.022589271888136864
Iteration: 299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446067214012146, gen p mean: -0.043351076543331146, mean p set: 0.4465474784374237
loss_pred:0.03978900611400604, decouple_loss:0.021731801331043243
The modified gen p mean: 0.44674137234687805, gen p mean: -0.04280334711074829, mean p set: 0.44722166657447815
The modified gen p mean: 0.44680383801460266, gen p mean: -0.04499555006623268, mean p set: 0.44728413224220276
loss_pred:0.04065918177366257, decouple_loss:0.02188599854707718
loss_pred:0.03953759744763374, decouple_loss:0.021400095894932747
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472448229789734, gen p mean: -0.03493546321988106, mean p set: 0.4477251172065735
loss_pred:0.04038510471582413, decouple_loss:0.01965762861073017
The modified gen p mean: 0.4465217888355255, gen p mean: -0.039135221391916275, mean p set: 0.4470020830631256
loss_pred:0.03903531655669212, decouple_loss:0.020618561655282974
The modified gen p mean: 0.4479460120201111, gen p mean: -0.038290854543447495, mean p set: 0.44842633605003357
loss_pred:0.04047005623579025, decouple_loss:0.022239070385694504
2023-04-19 01:38:15 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.014230065979063511, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.013720349408686161, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.013590088114142418, mean p set: 0.44879910349845886
loss_pred:0.04515821859240532, decouple_loss:0.02570606954395771
loss_pred:0.04513217881321907, decouple_loss:0.0253742802888155
loss_pred:0.04519297927618027, decouple_loss:0.025357432663440704
WV_0_PC_1_EH_0_PS_40, loss: 0.04643508791923523, avg_mse: 0.0503503791987896
current test mse: 0.05035
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44711393117904663, gen p mean: -0.018518509343266487, mean p set: 0.44759422540664673
loss_pred:0.043085191398859024, decouple_loss:0.024386543780565262
The modified gen p mean: 0.44876283407211304, gen p mean: -0.016840994358062744, mean p set: 0.44924309849739075
loss_pred:0.04492175951600075, decouple_loss:0.024652378633618355
The modified gen p mean: 0.44848254323005676, gen p mean: -0.021677138283848763, mean p set: 0.4489628076553345
loss_pred:0.043493300676345825, decouple_loss:0.023336630314588547
Iteration: 302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44691383838653564, gen p mean: -0.05702587589621544, mean p set: 0.44739410281181335
loss_pred:0.0419042631983757, decouple_loss:0.02569117397069931
The modified gen p mean: 0.4479925334453583, gen p mean: -0.05770222842693329, mean p set: 0.44847285747528076
loss_pred:0.043724097311496735, decouple_loss:0.025754094123840332
The modified gen p mean: 0.4467009902000427, gen p mean: -0.058452144265174866, mean p set: 0.4471812844276428
loss_pred:0.04124198481440544, decouple_loss:0.025082679465413094
Iteration: 303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750797748565674, gen p mean: -0.07146336883306503, mean p set: 0.44798827171325684
The modified gen p mean: 0.44652220606803894, gen p mean: -0.07501357048749924, mean p set: 0.44700247049331665
loss_pred:0.04079326242208481, decouple_loss:0.024567075073719025
loss_pred:0.04299656301736832, decouple_loss:0.02490048110485077
The modified gen p mean: 0.44717198610305786, gen p mean: -0.07454633712768555, mean p set: 0.44765228033065796
loss_pred:0.04305269196629524, decouple_loss:0.02446863241493702
Iteration: 304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474581182003021, gen p mean: -0.04202984273433685, mean p set: 0.44793838262557983
loss_pred:0.04242084175348282, decouple_loss:0.026374399662017822
The modified gen p mean: 0.44677913188934326, gen p mean: -0.04081541672348976, mean p set: 0.44725939631462097
loss_pred:0.04213846102356911, decouple_loss:0.02794455550611019
The modified gen p mean: 0.4477559030056, gen p mean: -0.040758077055215836, mean p set: 0.4482361972332001
loss_pred:0.04274206608533859, decouple_loss:0.026250498369336128
Iteration: 305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479988217353821, gen p mean: -0.021302876994013786, mean p set: 0.4484791159629822
loss_pred:0.041638944298028946, decouple_loss:0.031418029218912125
The modified gen p mean: 0.44708892703056335, gen p mean: -0.019609615206718445, mean p set: 0.44756919145584106
loss_pred:0.043959129601716995, decouple_loss:0.03278343752026558
The modified gen p mean: 0.4481906294822693, gen p mean: -0.02235480584204197, mean p set: 0.4486709535121918
loss_pred:0.040301382541656494, decouple_loss:0.03158145770430565
Iteration: 306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485373795032501, gen p mean: -0.03216072544455528, mean p set: 0.4490176737308502
loss_pred:0.042765840888023376, decouple_loss:0.024316895753145218
The modified gen p mean: 0.4462844133377075, gen p mean: -0.03169267997145653, mean p set: 0.44676467776298523
loss_pred:0.04126664251089096, decouple_loss:0.024967340752482414
The modified gen p mean: 0.4487040936946869, gen p mean: -0.03185277059674263, mean p set: 0.449184387922287
loss_pred:0.042640894651412964, decouple_loss:0.024484874680638313
Iteration: 307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724029302597046, gen p mean: -0.04703139513731003, mean p set: 0.44772061705589294
The modified gen p mean: 0.4481365978717804, gen p mean: -0.0484156608581543, mean p set: 0.4486168920993805
loss_pred:0.042419008910655975, decouple_loss:0.029114320874214172
loss_pred:0.043159715831279755, decouple_loss:0.031715892255306244
The modified gen p mean: 0.4472111463546753, gen p mean: -0.043823909014463425, mean p set: 0.4476914703845978
loss_pred:0.04284774884581566, decouple_loss:0.02924204058945179
Iteration: 308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473112225532532, gen p mean: -0.047087956219911575, mean p set: 0.44779151678085327
loss_pred:0.042611364275217056, decouple_loss:0.024469120427966118
The modified gen p mean: 0.4466283321380615, gen p mean: -0.04661351814866066, mean p set: 0.447108656167984
The modified gen p mean: 0.4482991695404053, gen p mean: -0.046083781868219376, mean p set: 0.44877946376800537loss_pred:0.04125228896737099, decouple_loss:0.023782221600413322
loss_pred:0.0387374572455883, decouple_loss:0.025455398485064507
Iteration: 309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478975534439087, gen p mean: -0.03340364247560501, mean p set: 0.4483778774738312
loss_pred:0.04248666763305664, decouple_loss:0.023129990324378014
The modified gen p mean: 0.44779109954833984, gen p mean: -0.03780146315693855, mean p set: 0.44827136397361755
loss_pred:0.04015294089913368, decouple_loss:0.02669212594628334
The modified gen p mean: 0.4470464587211609, gen p mean: -0.036222100257873535, mean p set: 0.4475267231464386
loss_pred:0.0420505553483963, decouple_loss:0.024444658309221268
Iteration: 310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742709398269653, gen p mean: -0.027679016813635826, mean p set: 0.44790735840797424
loss_pred:0.041824813932180405, decouple_loss:0.025934698060154915
The modified gen p mean: 0.4469221234321594, gen p mean: -0.028466738760471344, mean p set: 0.4474024176597595
loss_pred:0.04216600954532623, decouple_loss:0.026575855910778046
The modified gen p mean: 0.446549654006958, gen p mean: -0.025469951331615448, mean p set: 0.4470299780368805
loss_pred:0.042154960334300995, decouple_loss:0.02536323107779026
2023-04-19 01:40:50 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.02833741344511509, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.027160288766026497, mean p set: 0.4498290419578552
The modified gen p mean: 0.44831880927085876, gen p mean: -0.026617784053087234, mean p set: 0.44879910349845886
loss_pred:0.04498559981584549, decouple_loss:0.026270508766174316
loss_pred:0.0456773117184639, decouple_loss:0.025556987151503563
loss_pred:0.04535297304391861, decouple_loss:0.024924693629145622
WV_0_PC_1_EH_0_PS_40, loss: 0.04661783203482628, avg_mse: 0.050742074847221375
current test mse: 0.050742
Iteration: 311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732221961021423, gen p mean: -0.030209461227059364, mean p set: 0.4478025436401367
The modified gen p mean: 0.4474093019962311, gen p mean: -0.02835855260491371, mean p set: 0.4478895962238312
loss_pred:0.04100452736020088, decouple_loss:0.02605157159268856
loss_pred:0.04018508642911911, decouple_loss:0.026786062866449356
The modified gen p mean: 0.4474467933177948, gen p mean: -0.029383042827248573, mean p set: 0.4479270875453949
loss_pred:0.04087456315755844, decouple_loss:0.02551891840994358
Iteration: 312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44889262318611145, gen p mean: -0.030218910425901413, mean p set: 0.44937291741371155The modified gen p mean: 0.4472711682319641, gen p mean: -0.03167053312063217, mean p set: 0.4477514624595642
loss_pred:0.04030684009194374, decouple_loss:0.023049572482705116
loss_pred:0.04006975516676903, decouple_loss:0.02284868061542511
The modified gen p mean: 0.44784659147262573, gen p mean: -0.03184839338064194, mean p set: 0.44832685589790344
loss_pred:0.03940533846616745, decouple_loss:0.022017544135451317
Iteration: 313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480850100517273, gen p mean: -0.03553532063961029, mean p set: 0.4485653042793274
loss_pred:0.03972015157341957, decouple_loss:0.021290291100740433
The modified gen p mean: 0.44681647419929504, gen p mean: -0.03630172088742256, mean p set: 0.44729676842689514
loss_pred:0.04233097285032272, decouple_loss:0.021372489631175995
The modified gen p mean: 0.44752824306488037, gen p mean: -0.03823705390095711, mean p set: 0.44800853729248047
loss_pred:0.044489871710538864, decouple_loss:0.020946156233549118
Iteration: 314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480471909046173, gen p mean: -0.0315556675195694, mean p set: 0.4485274851322174
loss_pred:0.043131425976753235, decouple_loss:0.027812534943223
The modified gen p mean: 0.447630912065506, gen p mean: -0.026079123839735985, mean p set: 0.4481112062931061
loss_pred:0.043021563440561295, decouple_loss:0.02706037648022175
The modified gen p mean: 0.448162704706192, gen p mean: -0.026081297546625137, mean p set: 0.4486429989337921
loss_pred:0.042837291955947876, decouple_loss:0.028504421934485435
Iteration: 315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487799406051636, gen p mean: -0.0351390466094017, mean p set: 0.44926023483276367
loss_pred:0.04155360907316208, decouple_loss:0.0233877282589674
The modified gen p mean: 0.4474667012691498, gen p mean: -0.033715080469846725, mean p set: 0.4479469656944275
loss_pred:0.04031291976571083, decouple_loss:0.023427734151482582
The modified gen p mean: 0.44891631603240967, gen p mean: -0.030955949798226357, mean p set: 0.4493965804576874
loss_pred:0.0408567376434803, decouple_loss:0.024230996146798134
Iteration: 316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725826382637024, gen p mean: -0.0452745296061039, mean p set: 0.4477385878562927
loss_pred:0.0417930893599987, decouple_loss:0.029947645962238312
The modified gen p mean: 0.44747141003608704, gen p mean: -0.04349440708756447, mean p set: 0.44795170426368713
The modified gen p mean: 0.4468412697315216, gen p mean: -0.046914033591747284, mean p set: 0.4473215639591217
loss_pred:0.04387363791465759, decouple_loss:0.029926886782050133
loss_pred:0.04118214547634125, decouple_loss:0.02955634519457817
Iteration: 317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469245970249176, gen p mean: -0.04433692991733551, mean p set: 0.4474049210548401
loss_pred:0.04116618633270264, decouple_loss:0.02732924185693264
The modified gen p mean: 0.4483893811702728, gen p mean: -0.04479106888175011, mean p set: 0.4488696753978729
loss_pred:0.04129531607031822, decouple_loss:0.026267362758517265
The modified gen p mean: 0.44776859879493713, gen p mean: -0.04685075953602791, mean p set: 0.44824886322021484
loss_pred:0.043174516409635544, decouple_loss:0.026890169829130173
Iteration: 318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446719229221344, gen p mean: -0.054089393466711044, mean p set: 0.4471994936466217
loss_pred:0.040513843297958374, decouple_loss:0.026431575417518616
The modified gen p mean: 0.44788146018981934, gen p mean: -0.0510653555393219, mean p set: 0.44836175441741943
The modified gen p mean: 0.44627127051353455, gen p mean: -0.04675164073705673, mean p set: 0.44675159454345703
loss_pred:0.04044662415981293, decouple_loss:0.028563285246491432
loss_pred:0.04102897271513939, decouple_loss:0.02840599976480007
Iteration: 319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478999376296997, gen p mean: -0.04734902083873749, mean p set: 0.4483802020549774
loss_pred:0.04279136285185814, decouple_loss:0.029828481376171112
The modified gen p mean: 0.4479955732822418, gen p mean: -0.05171763896942139, mean p set: 0.4484758675098419
The modified gen p mean: 0.4465150237083435, gen p mean: -0.04854661598801613, mean p set: 0.4469953179359436
loss_pred:0.039622023701667786, decouple_loss:0.028898417949676514
loss_pred:0.04088325798511505, decouple_loss:0.029160592705011368
Iteration: 320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470864534378052, gen p mean: -0.048268698155879974, mean p set: 0.44756677746772766
loss_pred:0.04303809627890587, decouple_loss:0.027051914483308792
The modified gen p mean: 0.44629597663879395, gen p mean: -0.05119495093822479, mean p set: 0.44677630066871643
loss_pred:0.04122060164809227, decouple_loss:0.02628280594944954
The modified gen p mean: 0.44709405303001404, gen p mean: -0.046565014868974686, mean p set: 0.4475743770599365
loss_pred:0.04200250655412674, decouple_loss:0.026039309799671173
2023-04-19 01:42:42 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.0445929616689682, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.0437677800655365, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.043011244386434555, mean p set: 0.44879910349845886
loss_pred:0.04471430554986, decouple_loss:0.030654575675725937
loss_pred:0.045068807899951935, decouple_loss:0.03008929081261158
loss_pred:0.04511290416121483, decouple_loss:0.02925081178545952
WV_0_PC_1_EH_0_PS_40, loss: 0.046465255320072174, avg_mse: 0.0503758080303669
current test mse: 0.050376
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471951127052307, gen p mean: -0.045281704515218735, mean p set: 0.4476754069328308
loss_pred:0.040226049721241, decouple_loss:0.028690040111541748
The modified gen p mean: 0.4487855136394501, gen p mean: -0.04823915287852287, mean p set: 0.44926580786705017
loss_pred:0.04013454541563988, decouple_loss:0.028240928426384926
The modified gen p mean: 0.4486353099346161, gen p mean: -0.048013705760240555, mean p set: 0.4491156041622162
loss_pred:0.040194321423769, decouple_loss:0.02942553721368313
Iteration: 322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823089241981506, gen p mean: -0.03436696156859398, mean p set: 0.44871124625205994
loss_pred:0.04008059948682785, decouple_loss:0.023285657167434692
The modified gen p mean: 0.44862884283065796, gen p mean: -0.041289959102869034, mean p set: 0.44910916686058044
loss_pred:0.040168583393096924, decouple_loss:0.024072356522083282
The modified gen p mean: 0.44808676838874817, gen p mean: -0.03965083137154579, mean p set: 0.44856706261634827
loss_pred:0.040974173694849014, decouple_loss:0.023961728438735008
Iteration: 323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486939609050751, gen p mean: -0.03632288798689842, mean p set: 0.44917428493499756
loss_pred:0.04031965136528015, decouple_loss:0.03112686425447464
The modified gen p mean: 0.44858911633491516, gen p mean: -0.03906159847974777, mean p set: 0.44906941056251526
loss_pred:0.04009334743022919, decouple_loss:0.03191179409623146
The modified gen p mean: 0.4478552043437958, gen p mean: -0.03617367520928383, mean p set: 0.4483354985713959
loss_pred:0.03977382928133011, decouple_loss:0.032379087060689926
Iteration: 324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877079129219055, gen p mean: -0.04846026375889778, mean p set: 0.44925105571746826
loss_pred:0.04021592065691948, decouple_loss:0.02533666044473648
The modified gen p mean: 0.4484032988548279, gen p mean: -0.047674838453531265, mean p set: 0.4488835632801056
loss_pred:0.03868546709418297, decouple_loss:0.025232847779989243
The modified gen p mean: 0.4482119381427765, gen p mean: -0.047588761895895004, mean p set: 0.4486922323703766
loss_pred:0.03983118385076523, decouple_loss:0.02506445161998272
Iteration: 325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475848078727722, gen p mean: -0.042938195168972015, mean p set: 0.4480650722980499
loss_pred:0.039310913532972336, decouple_loss:0.027337322011590004
The modified gen p mean: 0.44847413897514343, gen p mean: -0.04805520176887512, mean p set: 0.44895440340042114
The modified gen p mean: 0.4488264322280884, gen p mean: -0.04585033655166626, mean p set: 0.44930675625801086
loss_pred:0.04023314267396927, decouple_loss:0.02673138678073883
loss_pred:0.039282169193029404, decouple_loss:0.027568478137254715
Iteration: 326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481961727142334, gen p mean: -0.03873410075902939, mean p set: 0.4486764669418335
The modified gen p mean: 0.4487454891204834, gen p mean: -0.03927373141050339, mean p set: 0.4492258131504059
loss_pred:0.03952664136886597, decouple_loss:0.026272546499967575
The modified gen p mean: 0.44868943095207214, gen p mean: -0.03552701324224472, mean p set: 0.44916975498199463loss_pred:0.03894022852182388, decouple_loss:0.02521943487226963
loss_pred:0.04102034121751785, decouple_loss:0.026316042989492416
Iteration: 327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485744833946228, gen p mean: -0.046466659754514694, mean p set: 0.4490547776222229
loss_pred:0.039035845547914505, decouple_loss:0.02258170396089554
The modified gen p mean: 0.4474312961101532, gen p mean: -0.04585019871592522, mean p set: 0.4479115903377533
loss_pred:0.039008114486932755, decouple_loss:0.02233130857348442
The modified gen p mean: 0.4485594928264618, gen p mean: -0.04480143263936043, mean p set: 0.4490397274494171
loss_pred:0.039197180420160294, decouple_loss:0.022877931594848633
Iteration: 328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491446018218994, gen p mean: -0.04895050823688507, mean p set: 0.4496248662471771
loss_pred:0.03953970968723297, decouple_loss:0.023835640400648117
The modified gen p mean: 0.44903212785720825, gen p mean: -0.04767923429608345, mean p set: 0.44951245188713074
loss_pred:0.03801841661334038, decouple_loss:0.026065092533826828
The modified gen p mean: 0.44955798983573914, gen p mean: -0.051341116428375244, mean p set: 0.45003825426101685
loss_pred:0.03907840698957443, decouple_loss:0.024260684847831726
Iteration: 329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485089182853699, gen p mean: -0.053561020642519, mean p set: 0.44898921251296997
loss_pred:0.03803490474820137, decouple_loss:0.02125527523458004
The modified gen p mean: 0.448012113571167, gen p mean: -0.0516001395881176, mean p set: 0.4484924077987671
loss_pred:0.03885587677359581, decouple_loss:0.022709958255290985
The modified gen p mean: 0.4489460289478302, gen p mean: -0.04722411930561066, mean p set: 0.4494262933731079
loss_pred:0.03921644017100334, decouple_loss:0.026107601821422577
Iteration: 330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44807833433151245, gen p mean: -0.0476449579000473, mean p set: 0.44855865836143494
The modified gen p mean: 0.4492049813270569, gen p mean: -0.04882572218775749, mean p set: 0.449685275554657
loss_pred:0.04064737632870674, decouple_loss:0.02365667000412941
The modified gen p mean: 0.447951078414917, gen p mean: -0.051828738301992416, mean p set: 0.4484313726425171
loss_pred:0.038956932723522186, decouple_loss:0.02298772521317005
loss_pred:0.03858580067753792, decouple_loss:0.024471504613757133
2023-04-19 01:45:18 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.03612891957163811, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.03574599698185921, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.03464876860380173, mean p set: 0.44879910349845886
loss_pred:0.042817771434783936, decouple_loss:0.022695306688547134
loss_pred:0.0431968979537487, decouple_loss:0.022396018728613853
loss_pred:0.04291288182139397, decouple_loss:0.022270120680332184
WV_0_PC_1_EH_0_PS_40, loss: 0.044098541140556335, avg_mse: 0.047556374222040176
current test mse: 0.047556
Iteration: 331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495489001274109, gen p mean: -0.03778396174311638, mean p set: 0.450029194355011
The modified gen p mean: 0.4480448067188263, gen p mean: -0.03800707682967186, mean p set: 0.4485251009464264
loss_pred:0.03788172826170921, decouple_loss:0.021558424457907677
loss_pred:0.037700459361076355, decouple_loss:0.022997619584202766
The modified gen p mean: 0.4472561478614807, gen p mean: -0.03769152984023094, mean p set: 0.4477364122867584
loss_pred:0.04077848792076111, decouple_loss:0.02274935133755207
Iteration: 332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44889020919799805, gen p mean: -0.036505721509456635, mean p set: 0.44937053322792053
The modified gen p mean: 0.4482963979244232, gen p mean: -0.038909316062927246, mean p set: 0.4487766921520233
loss_pred:0.04059934988617897, decouple_loss:0.02428463287651539
loss_pred:0.03934919834136963, decouple_loss:0.022997593507170677
The modified gen p mean: 0.4479963183403015, gen p mean: -0.03617629408836365, mean p set: 0.4484765827655792
loss_pred:0.03849908709526062, decouple_loss:0.0229117963463068
Iteration: 333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44870543479919434, gen p mean: -0.04166971519589424, mean p set: 0.4491857588291168
loss_pred:0.03918740898370743, decouple_loss:0.02194102108478546
The modified gen p mean: 0.44666147232055664, gen p mean: -0.04178129509091377, mean p set: 0.44714176654815674
The modified gen p mean: 0.4494702219963074, gen p mean: -0.03734617307782173, mean p set: 0.44995051622390747
loss_pred:0.038352709263563156, decouple_loss:0.022888366132974625
loss_pred:0.03920646756887436, decouple_loss:0.022856805473566055
Iteration: 334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44635310769081116, gen p mean: -0.04429711028933525, mean p set: 0.44683340191841125
loss_pred:0.03912064805626869, decouple_loss:0.020458582788705826
The modified gen p mean: 0.44933342933654785, gen p mean: -0.04437914490699768, mean p set: 0.44981372356414795
loss_pred:0.0386430099606514, decouple_loss:0.02069919928908348
The modified gen p mean: 0.4482080042362213, gen p mean: -0.045368533581495285, mean p set: 0.4486883282661438
loss_pred:0.038143742829561234, decouple_loss:0.02159271202981472
Iteration: 335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876736402511597, gen p mean: -0.051670726388692856, mean p set: 0.44924765825271606
loss_pred:0.03828532248735428, decouple_loss:0.022250499576330185
The modified gen p mean: 0.44756248593330383, gen p mean: -0.050899479538202286, mean p set: 0.44804278016090393
The modified gen p mean: 0.4475170075893402, gen p mean: -0.0507030226290226, mean p set: 0.4479973018169403
loss_pred:0.039047714322805405, decouple_loss:0.024136461317539215
loss_pred:0.03927101939916611, decouple_loss:0.022288786247372627
Iteration: 336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477640688419342, gen p mean: -0.04942091181874275, mean p set: 0.4482443630695343
loss_pred:0.03947038576006889, decouple_loss:0.023339418694376945
The modified gen p mean: 0.4483334422111511, gen p mean: -0.04750371724367142, mean p set: 0.4488137364387512
The modified gen p mean: 0.44805780053138733, gen p mean: -0.050631795078516006, mean p set: 0.44853806495666504
loss_pred:0.037454478442668915, decouple_loss:0.024112915620207787
loss_pred:0.037621550261974335, decouple_loss:0.020541688427329063
Iteration: 337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448775053024292, gen p mean: -0.040797457098960876, mean p set: 0.4492553174495697
loss_pred:0.037512797862291336, decouple_loss:0.024591105058789253
The modified gen p mean: 0.4473927617073059, gen p mean: -0.0355389229953289, mean p set: 0.447873055934906
The modified gen p mean: 0.4473727345466614, gen p mean: -0.04026792570948601, mean p set: 0.44785305857658386
loss_pred:0.039418622851371765, decouple_loss:0.02324574999511242
loss_pred:0.03858698531985283, decouple_loss:0.021460922434926033
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489842355251312, gen p mean: -0.040238622575998306, mean p set: 0.4494645595550537
loss_pred:0.03843161463737488, decouple_loss:0.021218029782176018
The modified gen p mean: 0.44772353768348694, gen p mean: -0.035988885909318924, mean p set: 0.4482038617134094
The modified gen p mean: 0.4487197995185852, gen p mean: -0.04096706956624985, mean p set: 0.4492001235485077
loss_pred:0.03809443116188049, decouple_loss:0.02165110409259796
loss_pred:0.038062144070863724, decouple_loss:0.021536409854888916
Iteration: 339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477488100528717, gen p mean: -0.0436934232711792, mean p set: 0.4482291042804718
The modified gen p mean: 0.44863730669021606, gen p mean: -0.0428784042596817, mean p set: 0.44911760091781616
loss_pred:0.03920959308743477, decouple_loss:0.020337125286459923
loss_pred:0.03825926408171654, decouple_loss:0.020967544987797737
The modified gen p mean: 0.44862377643585205, gen p mean: -0.04342600330710411, mean p set: 0.44910410046577454
loss_pred:0.038111016154289246, decouple_loss:0.020722098648548126
Iteration: 340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478801488876343, gen p mean: -0.031768251210451126, mean p set: 0.4483604431152344
The modified gen p mean: 0.44839170575141907, gen p mean: -0.03636172041296959, mean p set: 0.44887199997901917
loss_pred:0.03713499754667282, decouple_loss:0.020960191264748573
The modified gen p mean: 0.4487270712852478, gen p mean: -0.03436318784952164, mean p set: 0.4492073655128479
loss_pred:0.03769177198410034, decouple_loss:0.022269146516919136
loss_pred:0.0366806797683239, decouple_loss:0.021391406655311584
2023-04-19 01:47:11 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.027545897290110588, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.027461862191557884, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.026005640625953674, mean p set: 0.44879910349845886
loss_pred:0.041699785739183426, decouple_loss:0.020768573507666588
loss_pred:0.04220711067318916, decouple_loss:0.020230785012245178
loss_pred:0.042067546397447586, decouple_loss:0.01972365565598011
WV_0_PC_1_EH_0_PS_40, loss: 0.04300352931022644, avg_mse: 0.046335432678461075
current test mse: 0.046335
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819584488868713, gen p mean: -0.02993718720972538, mean p set: 0.4486761689186096
loss_pred:0.038391780108213425, decouple_loss:0.019049055874347687
The modified gen p mean: 0.4479732811450958, gen p mean: -0.02640105038881302, mean p set: 0.4484536051750183
loss_pred:0.03941411152482033, decouple_loss:0.02168724499642849
The modified gen p mean: 0.449418306350708, gen p mean: -0.031179621815681458, mean p set: 0.4498986005783081
loss_pred:0.03958911821246147, decouple_loss:0.019515613093972206
Iteration: 342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877126812934875, gen p mean: -0.041098639369010925, mean p set: 0.44925159215927124
loss_pred:0.03929128125309944, decouple_loss:0.01904413476586342
The modified gen p mean: 0.4491564631462097, gen p mean: -0.04306093975901604, mean p set: 0.4496367573738098
loss_pred:0.0380031056702137, decouple_loss:0.019269676879048347
The modified gen p mean: 0.4489731192588806, gen p mean: -0.04028496518731117, mean p set: 0.4494534134864807
loss_pred:0.038201358169317245, decouple_loss:0.019507255405187607
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494735300540924, gen p mean: -0.03392826020717621, mean p set: 0.4499538242816925
loss_pred:0.038863055408000946, decouple_loss:0.018175778910517693
The modified gen p mean: 0.4489286243915558, gen p mean: -0.03444147855043411, mean p set: 0.4494089186191559
The modified gen p mean: 0.44782623648643494, gen p mean: -0.029509665444493294, mean p set: 0.44830653071403503
loss_pred:0.03851768374443054, decouple_loss:0.018607255071401596
loss_pred:0.0378740131855011, decouple_loss:0.019224019721150398
Iteration: 344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484134614467621, gen p mean: -0.05009467899799347, mean p set: 0.4488937258720398
loss_pred:0.03934936970472336, decouple_loss:0.019970308989286423
The modified gen p mean: 0.4486974775791168, gen p mean: -0.04880281537771225, mean p set: 0.44917774200439453
loss_pred:0.03879687190055847, decouple_loss:0.019901005551218987
The modified gen p mean: 0.4487845003604889, gen p mean: -0.04868575558066368, mean p set: 0.4492647647857666
loss_pred:0.0369841530919075, decouple_loss:0.01866753026843071
Iteration: 345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495750665664673, gen p mean: -0.057518113404512405, mean p set: 0.45005539059638977
loss_pred:0.03758116066455841, decouple_loss:0.02059064991772175
The modified gen p mean: 0.4483930170536041, gen p mean: -0.055098310112953186, mean p set: 0.4488733410835266
The modified gen p mean: 0.4493795335292816, gen p mean: -0.05768776684999466, mean p set: 0.4498598277568817
loss_pred:0.039248816668987274, decouple_loss:0.022575953975319862
loss_pred:0.037891823798418045, decouple_loss:0.025321904569864273
Iteration: 346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788870215415955, gen p mean: -0.05674117058515549, mean p set: 0.44836896657943726
loss_pred:0.03992167115211487, decouple_loss:0.02411445416510105
The modified gen p mean: 0.44903847575187683, gen p mean: -0.05515997111797333, mean p set: 0.44951876997947693
The modified gen p mean: 0.44886156916618347, gen p mean: -0.05667438358068466, mean p set: 0.44934189319610596
loss_pred:0.0379791334271431, decouple_loss:0.021985920146107674
loss_pred:0.03907059505581856, decouple_loss:0.02033800259232521
Iteration: 347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490557909011841, gen p mean: -0.04847244173288345, mean p set: 0.4495360851287842
loss_pred:0.04151264205574989, decouple_loss:0.020275572314858437The modified gen p mean: 0.4475499987602234, gen p mean: -0.04666292294859886, mean p set: 0.4480302929878235
The modified gen p mean: 0.44813117384910583, gen p mean: -0.04965970665216446, mean p set: 0.4486114978790283
loss_pred:0.038666341453790665, decouple_loss:0.021241575479507446
loss_pred:0.03861850127577782, decouple_loss:0.01914910413324833
Iteration: 348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485247731208801, gen p mean: -0.04629700630903244, mean p set: 0.4490050673484802
loss_pred:0.042139213532209396, decouple_loss:0.024259064346551895
The modified gen p mean: 0.44924524426460266, gen p mean: -0.04650035500526428, mean p set: 0.44972550868988037
The modified gen p mean: 0.4489932358264923, gen p mean: -0.045662276446819305, mean p set: 0.4494735598564148
loss_pred:0.040586743503808975, decouple_loss:0.022671302780508995
loss_pred:0.03920013830065727, decouple_loss:0.025972502306103706
Iteration: 349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478198289871216, gen p mean: -0.039011191576719284, mean p set: 0.4483001232147217
loss_pred:0.041523389518260956, decouple_loss:0.02640399895608425
The modified gen p mean: 0.4491555094718933, gen p mean: -0.03886394575238228, mean p set: 0.4496358335018158
The modified gen p mean: 0.44952592253685, gen p mean: -0.04317920655012131, mean p set: 0.4500062167644501
loss_pred:0.039644815027713776, decouple_loss:0.02734239026904106
loss_pred:0.04158204793930054, decouple_loss:0.025266015902161598
Iteration: 350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44899266958236694, gen p mean: -0.026777584105730057, mean p set: 0.44947290420532227
The modified gen p mean: 0.4483850300312042, gen p mean: -0.028839878737926483, mean p set: 0.4488653242588043
The modified gen p mean: 0.4491598308086395, gen p mean: -0.027692677453160286, mean p set: 0.4496401250362396
loss_pred:0.03762857988476753, decouple_loss:0.019746914505958557
loss_pred:0.03775250166654587, decouple_loss:0.020130839198827744
loss_pred:0.038363948464393616, decouple_loss:0.02050263062119484
2023-04-19 01:49:48 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.027540216222405434, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.027189580723643303, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.025950642302632332, mean p set: 0.44879910349845886
loss_pred:0.04217506945133209, decouple_loss:0.02198432758450508loss_pred:0.04254482313990593, decouple_loss:0.022132253274321556
loss_pred:0.04288295656442642, decouple_loss:0.02253873273730278
WV_0_PC_1_EH_0_PS_40, loss: 0.04364520311355591, avg_mse: 0.04752834513783455
current test mse: 0.047528
Iteration: 351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779306650161743, gen p mean: -0.022371063008904457, mean p set: 0.4482733905315399
The modified gen p mean: 0.4490394592285156, gen p mean: -0.026238368824124336, mean p set: 0.44951972365379333
loss_pred:0.040287308394908905, decouple_loss:0.02111727185547352
loss_pred:0.03829316794872284, decouple_loss:0.021287430077791214
The modified gen p mean: 0.4484594762325287, gen p mean: -0.023573413491249084, mean p set: 0.4489397704601288
loss_pred:0.038800571113824844, decouple_loss:0.025898199528455734
Iteration: 352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797804951667786, gen p mean: -0.030904175713658333, mean p set: 0.44845834374427795The modified gen p mean: 0.44908520579338074, gen p mean: -0.03045571595430374, mean p set: 0.44956550002098083
loss_pred:0.03953590989112854, decouple_loss:0.024015136063098907
loss_pred:0.03941168263554573, decouple_loss:0.02559284120798111
The modified gen p mean: 0.44856327772140503, gen p mean: -0.03479069098830223, mean p set: 0.4490435719490051
loss_pred:0.038454897701740265, decouple_loss:0.025065913796424866
Iteration: 353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44939860701560974, gen p mean: -0.04214739799499512, mean p set: 0.4498789310455322
loss_pred:0.03785371780395508, decouple_loss:0.023251354694366455
The modified gen p mean: 0.4492949843406677, gen p mean: -0.040012504905462265, mean p set: 0.4497752785682678
loss_pred:0.03780023008584976, decouple_loss:0.024111436679959297
The modified gen p mean: 0.4491133987903595, gen p mean: -0.039457280188798904, mean p set: 0.4495936930179596
loss_pred:0.03897224739193916, decouple_loss:0.02471650019288063
Iteration: 354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486387372016907, gen p mean: -0.04421676695346832, mean p set: 0.44911903142929077
The modified gen p mean: 0.4489580988883972, gen p mean: -0.04554840177297592, mean p set: 0.4494384229183197
loss_pred:0.03820345923304558, decouple_loss:0.021567121148109436
loss_pred:0.03739357739686966, decouple_loss:0.020607123151421547
The modified gen p mean: 0.44809702038764954, gen p mean: -0.04787404462695122, mean p set: 0.448577344417572
loss_pred:0.037953298538923264, decouple_loss:0.019996117800474167
Iteration: 355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481983184814453, gen p mean: -0.03857017308473587, mean p set: 0.4486786425113678
loss_pred:0.03844738006591797, decouple_loss:0.022748898714780807
The modified gen p mean: 0.4475438594818115, gen p mean: -0.04018942266702652, mean p set: 0.4480241537094116
loss_pred:0.03884352371096611, decouple_loss:0.020192943513393402
The modified gen p mean: 0.4489569664001465, gen p mean: -0.04239865764975548, mean p set: 0.4494372606277466
loss_pred:0.03844530135393143, decouple_loss:0.020941179245710373
Iteration: 356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494485557079315, gen p mean: -0.04126398637890816, mean p set: 0.449928879737854
loss_pred:0.038569189608097076, decouple_loss:0.021146230399608612
The modified gen p mean: 0.4486227035522461, gen p mean: -0.04086143150925636, mean p set: 0.4491029977798462
loss_pred:0.03792136162519455, decouple_loss:0.02130095474421978
The modified gen p mean: 0.44813087582588196, gen p mean: -0.04176699370145798, mean p set: 0.44861117005348206
loss_pred:0.03745785355567932, decouple_loss:0.021018458530306816
Iteration: 357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488207697868347, gen p mean: -0.05568557605147362, mean p set: 0.4493010640144348
The modified gen p mean: 0.4479416608810425, gen p mean: -0.05146152153611183, mean p set: 0.4484219551086426
loss_pred:0.03790944814682007, decouple_loss:0.01972639560699463
loss_pred:0.03823687881231308, decouple_loss:0.02002989873290062
The modified gen p mean: 0.4486866891384125, gen p mean: -0.053457990288734436, mean p set: 0.4491669833660126
loss_pred:0.03675154969096184, decouple_loss:0.02002524770796299
Iteration: 358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853857159614563, gen p mean: -0.05607546865940094, mean p set: 0.44901883602142334
The modified gen p mean: 0.4480119049549103, gen p mean: -0.054668501019477844, mean p set: 0.448492169380188
loss_pred:0.036520831286907196, decouple_loss:0.020612245425581932
loss_pred:0.03807874396443367, decouple_loss:0.02102850005030632
The modified gen p mean: 0.4473295211791992, gen p mean: -0.05752798169851303, mean p set: 0.4478098452091217
loss_pred:0.040027547627687454, decouple_loss:0.01993216574192047
Iteration: 359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44894957542419434, gen p mean: -0.052219707518815994, mean p set: 0.44942986965179443
The modified gen p mean: 0.44948339462280273, gen p mean: -0.049180950969457626, mean p set: 0.4499637186527252
loss_pred:0.037533313035964966, decouple_loss:0.02060875855386257
loss_pred:0.03704151511192322, decouple_loss:0.021308740600943565
The modified gen p mean: 0.4488867223262787, gen p mean: -0.04848121106624603, mean p set: 0.4493670165538788
loss_pred:0.03504805639386177, decouple_loss:0.02082548663020134
Iteration: 360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449386328458786, gen p mean: -0.0432780422270298, mean p set: 0.4498666524887085
loss_pred:0.039485178887844086, decouple_loss:0.022905344143509865
The modified gen p mean: 0.4481603503227234, gen p mean: -0.03848284110426903, mean p set: 0.4486406445503235
loss_pred:0.03822827711701393, decouple_loss:0.022663326933979988
The modified gen p mean: 0.4482795000076294, gen p mean: -0.0410839319229126, mean p set: 0.4487597644329071
loss_pred:0.03826858848333359, decouple_loss:0.02088683843612671
2023-04-19 01:51:41 testing...
The modified gen p mean: 0.44943100214004517, gen p mean: -0.04926014691591263, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.04831980913877487, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.04731294885277748, mean p set: 0.44879910349845886
loss_pred:0.04110327735543251, decouple_loss:0.020076323300600052
loss_pred:0.04162339121103287, decouple_loss:0.019381364807486534
loss_pred:0.041511498391628265, decouple_loss:0.019506681710481644
WV_0_PC_1_EH_0_PS_40, loss: 0.042395465075969696, avg_mse: 0.04603591188788414
current test mse: 0.046036
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473591446876526, gen p mean: -0.049714554101228714, mean p set: 0.4478394687175751
loss_pred:0.038444533944129944, decouple_loss:0.020069235935807228
The modified gen p mean: 0.44853079319000244, gen p mean: -0.04633650556206703, mean p set: 0.4490111172199249
loss_pred:0.03665986657142639, decouple_loss:0.019783250987529755
The modified gen p mean: 0.44810548424720764, gen p mean: -0.04865363612771034, mean p set: 0.44858577847480774
loss_pred:0.03745825216174126, decouple_loss:0.019955582916736603
Iteration: 362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44830814003944397, gen p mean: -0.05186910182237625, mean p set: 0.44878846406936646
loss_pred:0.0361793227493763, decouple_loss:0.0224393829703331
The modified gen p mean: 0.44800901412963867, gen p mean: -0.05015578493475914, mean p set: 0.44848933815956116
loss_pred:0.036536406725645065, decouple_loss:0.022705985233187675
The modified gen p mean: 0.4480210542678833, gen p mean: -0.05310526490211487, mean p set: 0.4485013484954834
loss_pred:0.03740205615758896, decouple_loss:0.020238451659679413
Iteration: 363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44827800989151, gen p mean: -0.03954652324318886, mean p set: 0.4487583637237549
The modified gen p mean: 0.44811657071113586, gen p mean: -0.04227442666888237, mean p set: 0.4485968351364136
loss_pred:0.03766963630914688, decouple_loss:0.019632060080766678
loss_pred:0.03698989748954773, decouple_loss:0.02182563953101635
The modified gen p mean: 0.44762372970581055, gen p mean: -0.04275991767644882, mean p set: 0.44810402393341064
loss_pred:0.03653079271316528, decouple_loss:0.020606528967618942
Iteration: 364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482062757015228, gen p mean: -0.0396457202732563, mean p set: 0.4486865699291229
The modified gen p mean: 0.44692251086235046, gen p mean: -0.03821714594960213, mean p set: 0.44740280508995056
loss_pred:0.03763897344470024, decouple_loss:0.018709205090999603
loss_pred:0.03656407445669174, decouple_loss:0.019034329801797867
The modified gen p mean: 0.44676509499549866, gen p mean: -0.03501038998365402, mean p set: 0.44724538922309875
loss_pred:0.03797176852822304, decouple_loss:0.01893177628517151
Iteration: 365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781047105789185, gen p mean: -0.04614868760108948, mean p set: 0.44829073548316956
The modified gen p mean: 0.44752660393714905, gen p mean: -0.0464092455804348, mean p set: 0.44800689816474915
loss_pred:0.037977512925863266, decouple_loss:0.019740497693419456
loss_pred:0.036961477249860764, decouple_loss:0.02099289931356907
The modified gen p mean: 0.44616711139678955, gen p mean: -0.04672134667634964, mean p set: 0.44664737582206726
loss_pred:0.03706332668662071, decouple_loss:0.0200655497610569
Iteration: 366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879159331321716, gen p mean: -0.04648321121931076, mean p set: 0.44927188754081726
The modified gen p mean: 0.44816282391548157, gen p mean: -0.04126899316906929, mean p set: 0.44864311814308167
loss_pred:0.036594897508621216, decouple_loss:0.020719235762953758
loss_pred:0.03708295151591301, decouple_loss:0.020633287727832794
The modified gen p mean: 0.44888070225715637, gen p mean: -0.04583405330777168, mean p set: 0.44936102628707886
loss_pred:0.0358334444463253, decouple_loss:0.022401904687285423
Iteration: 367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822442531585693, gen p mean: -0.03901376202702522, mean p set: 0.44870471954345703
loss_pred:0.037237171083688736, decouple_loss:0.01971396617591381
The modified gen p mean: 0.44791844487190247, gen p mean: -0.03848232328891754, mean p set: 0.44839873909950256
The modified gen p mean: 0.44890785217285156, gen p mean: -0.038218945264816284, mean p set: 0.44938814640045166
loss_pred:0.036671970039606094, decouple_loss:0.020501283928751945
loss_pred:0.037394482642412186, decouple_loss:0.020312126725912094
Iteration: 368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477509558200836, gen p mean: -0.035468485206365585, mean p set: 0.44823122024536133
The modified gen p mean: 0.44733431935310364, gen p mean: -0.032290149480104446, mean p set: 0.44781461358070374
loss_pred:0.036669231951236725, decouple_loss:0.018375582993030548
loss_pred:0.03706640377640724, decouple_loss:0.018389884382486343
The modified gen p mean: 0.4476214051246643, gen p mean: -0.038236912339925766, mean p set: 0.4481017291545868
loss_pred:0.03608821704983711, decouple_loss:0.01982985809445381
Iteration: 369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472324848175049, gen p mean: -0.041874296963214874, mean p set: 0.447712779045105
loss_pred:0.03685947507619858, decouple_loss:0.02033289149403572
The modified gen p mean: 0.4478228688240051, gen p mean: -0.0357595831155777, mean p set: 0.4483031630516052
The modified gen p mean: 0.44740691781044006, gen p mean: -0.0355939082801342, mean p set: 0.4478871822357178
loss_pred:0.035998787730932236, decouple_loss:0.02003622055053711
loss_pred:0.037216294556856155, decouple_loss:0.020071828737854958
Iteration: 370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44700318574905396, gen p mean: -0.04913780465722084, mean p set: 0.44748347997665405
The modified gen p mean: 0.4484468698501587, gen p mean: -0.04383355751633644, mean p set: 0.4489271342754364
loss_pred:0.03623291477560997, decouple_loss:0.020321009680628777
loss_pred:0.03488367050886154, decouple_loss:0.021518675610423088
The modified gen p mean: 0.44816482067108154, gen p mean: -0.04835401102900505, mean p set: 0.44864511489868164
loss_pred:0.03644309937953949, decouple_loss:0.021650757640600204
2023-04-19 01:54:26 testing...
The modified gen p mean: 0.44943100214004517, gen p mean: -0.041815176606178284, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.040668535977602005, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.03944949060678482, mean p set: 0.44879910349845886
loss_pred:0.04030131548643112, decouple_loss:0.021646879613399506
loss_pred:0.04058082401752472, decouple_loss:0.020534051582217216
loss_pred:0.04063031077384949, decouple_loss:0.020207535475492477
WV_0_PC_1_EH_0_PS_40, loss: 0.041543956845998764, avg_mse: 0.04492117464542389
current test mse: 0.044921
Iteration: 371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797733426094055, gen p mean: -0.0358964167535305, mean p set: 0.44845762848854065
loss_pred:0.034679099917411804, decouple_loss:0.01937468722462654
The modified gen p mean: 0.4482143521308899, gen p mean: -0.039713989943265915, mean p set: 0.44869464635849
The modified gen p mean: 0.4478549659252167, gen p mean: -0.04037311673164368, mean p set: 0.448335200548172
loss_pred:0.03579329326748848, decouple_loss:0.019056154415011406
loss_pred:0.034916285425424576, decouple_loss:0.019359232857823372
Iteration: 372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44809165596961975, gen p mean: -0.03829502686858177, mean p set: 0.44857192039489746
loss_pred:0.03683442622423172, decouple_loss:0.018954021856188774
The modified gen p mean: 0.44783854484558105, gen p mean: -0.03988725319504738, mean p set: 0.44831880927085876
The modified gen p mean: 0.4480619728565216, gen p mean: -0.036261435598134995, mean p set: 0.4485422670841217
loss_pred:0.03670782968401909, decouple_loss:0.01919950731098652
loss_pred:0.036381516605615616, decouple_loss:0.01876392588019371
Iteration: 373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471516013145447, gen p mean: -0.041625771671533585, mean p set: 0.4476318955421448
The modified gen p mean: 0.4481227993965149, gen p mean: -0.048673827201128006, mean p set: 0.448603093624115
loss_pred:0.03721147030591965, decouple_loss:0.0188578050583601
loss_pred:0.035545721650123596, decouple_loss:0.02176777273416519
The modified gen p mean: 0.44657102227211, gen p mean: -0.04751579836010933, mean p set: 0.4470512866973877
loss_pred:0.03644927218556404, decouple_loss:0.01943057030439377
Iteration: 374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44637301564216614, gen p mean: -0.04035523161292076, mean p set: 0.44685330986976624
loss_pred:0.03632761538028717, decouple_loss:0.020319467410445213
The modified gen p mean: 0.4487875998020172, gen p mean: -0.04173829033970833, mean p set: 0.4492678940296173
loss_pred:0.03663566708564758, decouple_loss:0.020619390532374382
The modified gen p mean: 0.4474121332168579, gen p mean: -0.03661781921982765, mean p set: 0.447892427444458
loss_pred:0.03604745864868164, decouple_loss:0.01979791186749935
Iteration: 375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44824522733688354, gen p mean: -0.04197366163134575, mean p set: 0.44872552156448364
The modified gen p mean: 0.4479690492153168, gen p mean: -0.041700299829244614, mean p set: 0.4484493136405945loss_pred:0.036988839507102966, decouple_loss:0.019104141741991043
loss_pred:0.03691999614238739, decouple_loss:0.01805483177304268
The modified gen p mean: 0.4470321238040924, gen p mean: -0.043333929032087326, mean p set: 0.4475124180316925
loss_pred:0.03630998358130455, decouple_loss:0.018772413954138756
Iteration: 376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778746366500854, gen p mean: -0.03886573389172554, mean p set: 0.4482678174972534
The modified gen p mean: 0.4479553699493408, gen p mean: -0.035546962171792984, mean p set: 0.4484356641769409
loss_pred:0.03828844800591469, decouple_loss:0.01927480474114418
loss_pred:0.03777569904923439, decouple_loss:0.018463874235749245
The modified gen p mean: 0.44783008098602295, gen p mean: -0.03639991208910942, mean p set: 0.44831034541130066
loss_pred:0.03706755116581917, decouple_loss:0.01856590434908867
Iteration: 377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745364785194397, gen p mean: -0.04415202885866165, mean p set: 0.4479339122772217
loss_pred:0.036690376698970795, decouple_loss:0.019801065325737
The modified gen p mean: 0.4478570818901062, gen p mean: -0.04367953911423683, mean p set: 0.4483374059200287
loss_pred:0.036111414432525635, decouple_loss:0.020318416878581047
The modified gen p mean: 0.448758602142334, gen p mean: -0.03964841365814209, mean p set: 0.4492388963699341
loss_pred:0.03647683933377266, decouple_loss:0.01898794062435627
Iteration: 378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44872283935546875, gen p mean: -0.035926662385463715, mean p set: 0.44920313358306885
The modified gen p mean: 0.4478135406970978, gen p mean: -0.032886601984500885, mean p set: 0.4482938349246979
loss_pred:0.0348508358001709, decouple_loss:0.02286659926176071
loss_pred:0.03608078137040138, decouple_loss:0.02208818681538105
The modified gen p mean: 0.44863346219062805, gen p mean: -0.03610290214419365, mean p set: 0.44911372661590576
loss_pred:0.03534162789583206, decouple_loss:0.02275381051003933
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447463721036911, gen p mean: -0.03787856176495552, mean p set: 0.4479440450668335
The modified gen p mean: 0.4478556215763092, gen p mean: -0.03897499293088913, mean p set: 0.4483359158039093
loss_pred:0.036007337272167206, decouple_loss:0.020994529128074646
loss_pred:0.03623100370168686, decouple_loss:0.019546112045645714
The modified gen p mean: 0.44823944568634033, gen p mean: -0.040639568120241165, mean p set: 0.44871973991394043
loss_pred:0.035328757017850876, decouple_loss:0.02091323584318161
Iteration: 380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802403450012207, gen p mean: -0.052570659667253494, mean p set: 0.44850432872772217
loss_pred:0.03573942556977272, decouple_loss:0.022699380293488503
The modified gen p mean: 0.44832268357276917, gen p mean: -0.049416109919548035, mean p set: 0.4488029479980469
loss_pred:0.03543233126401901, decouple_loss:0.022821402177214622
The modified gen p mean: 0.447913259267807, gen p mean: -0.049960047006607056, mean p set: 0.4483935534954071
loss_pred:0.03672575578093529, decouple_loss:0.02529219724237919
2023-04-19 01:56:19 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.04832370579242706, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.047321438789367676, mean p set: 0.4498290419578552
The modified gen p mean: 0.44831880927085876, gen p mean: -0.04587594419717789, mean p set: 0.44879910349845886
loss_pred:0.04073109105229378, decouple_loss:0.025809474289417267
loss_pred:0.040935203433036804, decouple_loss:0.026153748854994774
loss_pred:0.04117782041430473, decouple_loss:0.026133155450224876
WV_0_PC_1_EH_0_PS_40, loss: 0.042249646037817, avg_mse: 0.0460214801132679
current test mse: 0.046021
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680145382881165, gen p mean: -0.046340830624103546, mean p set: 0.44728177785873413
loss_pred:0.03842117264866829, decouple_loss:0.025455251336097717
The modified gen p mean: 0.44776543974876404, gen p mean: -0.047399118542671204, mean p set: 0.4482457637786865
The modified gen p mean: 0.44851794838905334, gen p mean: -0.04639049991965294, mean p set: 0.44899824261665344
loss_pred:0.04031849652528763, decouple_loss:0.02457592822611332
loss_pred:0.03844290226697922, decouple_loss:0.02508644200861454
Iteration: 382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477772116661072, gen p mean: -0.051555830985307693, mean p set: 0.4482575058937073
The modified gen p mean: 0.44685888290405273, gen p mean: -0.048343293368816376, mean p set: 0.44733917713165283
loss_pred:0.03919856622815132, decouple_loss:0.022382372990250587
The modified gen p mean: 0.4483170509338379, gen p mean: -0.051341261714696884, mean p set: 0.448797345161438
loss_pred:0.03742364048957825, decouple_loss:0.021074481308460236
loss_pred:0.039713893085718155, decouple_loss:0.022357849404215813
Iteration: 383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44705289602279663, gen p mean: -0.053063519299030304, mean p set: 0.44753316044807434
The modified gen p mean: 0.44629183411598206, gen p mean: -0.053287386894226074, mean p set: 0.44677209854125977
loss_pred:0.03902655467391014, decouple_loss:0.023626454174518585
loss_pred:0.037449318915605545, decouple_loss:0.024328382685780525
The modified gen p mean: 0.4468691349029541, gen p mean: -0.053847286850214005, mean p set: 0.4473494589328766
loss_pred:0.03992800787091255, decouple_loss:0.022636806592345238
Iteration: 384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463586211204529, gen p mean: -0.04724965989589691, mean p set: 0.4468388855457306
The modified gen p mean: 0.4469186067581177, gen p mean: -0.04742932319641113, mean p set: 0.4473989009857178
loss_pred:0.03740466386079788, decouple_loss:0.022255729883909225
loss_pred:0.03706512600183487, decouple_loss:0.02219845913350582
The modified gen p mean: 0.446621298789978, gen p mean: -0.0465681292116642, mean p set: 0.4471015930175781
loss_pred:0.03963465243577957, decouple_loss:0.022479865700006485
Iteration: 385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475051760673523, gen p mean: -0.038352735340595245, mean p set: 0.44798544049263The modified gen p mean: 0.4492480754852295, gen p mean: -0.03979434072971344, mean p set: 0.4497283697128296
loss_pred:0.037511520087718964, decouple_loss:0.02078528143465519
loss_pred:0.038232434540987015, decouple_loss:0.022877629846334457
The modified gen p mean: 0.44687673449516296, gen p mean: -0.03811592236161232, mean p set: 0.4473569989204407
loss_pred:0.036417052149772644, decouple_loss:0.021371379494667053
Iteration: 386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44651761651039124, gen p mean: -0.03144488483667374, mean p set: 0.44699788093566895
The modified gen p mean: 0.4470483064651489, gen p mean: -0.026587357744574547, mean p set: 0.44752857089042664
loss_pred:0.037650804966688156, decouple_loss:0.022243108600378036
loss_pred:0.03732609376311302, decouple_loss:0.025028295814990997
The modified gen p mean: 0.44666460156440735, gen p mean: -0.026347694918513298, mean p set: 0.44714486598968506
loss_pred:0.03705519810318947, decouple_loss:0.025371626019477844
Iteration: 387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466681480407715, gen p mean: -0.021553175523877144, mean p set: 0.4471484422683716
The modified gen p mean: 0.4464671313762665, gen p mean: -0.027073552832007408, mean p set: 0.4469473958015442
loss_pred:0.03824343532323837, decouple_loss:0.02211403287947178
loss_pred:0.03923648223280907, decouple_loss:0.02173507958650589
The modified gen p mean: 0.4469279646873474, gen p mean: -0.02549930475652218, mean p set: 0.4474082589149475
loss_pred:0.039252154529094696, decouple_loss:0.02229725569486618
Iteration: 388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481349587440491, gen p mean: -0.02770855464041233, mean p set: 0.44861525297164917
loss_pred:0.03865984454751015, decouple_loss:0.023128611966967583
The modified gen p mean: 0.4474845826625824, gen p mean: -0.030560575425624847, mean p set: 0.4479648470878601
The modified gen p mean: 0.4486178457736969, gen p mean: -0.029306961223483086, mean p set: 0.449098140001297loss_pred:0.038878485560417175, decouple_loss:0.023620275780558586
loss_pred:0.03803125023841858, decouple_loss:0.023364827036857605
Iteration: 389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44754257798194885, gen p mean: -0.0298637505620718, mean p set: 0.44802284240722656
The modified gen p mean: 0.44798144698143005, gen p mean: -0.03055395558476448, mean p set: 0.44846174120903015
loss_pred:0.0383356437087059, decouple_loss:0.021101457998156548
loss_pred:0.03639058768749237, decouple_loss:0.020727336406707764
The modified gen p mean: 0.44759413599967957, gen p mean: -0.03277324140071869, mean p set: 0.44807443022727966
loss_pred:0.03610409423708916, decouple_loss:0.02120848372578621
Iteration: 390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44690874218940735, gen p mean: -0.02086464874446392, mean p set: 0.44738900661468506
The modified gen p mean: 0.4473802447319031, gen p mean: -0.02244364656507969, mean p set: 0.4478605389595032
loss_pred:0.03718530014157295, decouple_loss:0.023169374093413353
loss_pred:0.03780382499098778, decouple_loss:0.02421949990093708
The modified gen p mean: 0.4480169117450714, gen p mean: -0.024867620319128036, mean p set: 0.4484971761703491
loss_pred:0.03693481534719467, decouple_loss:0.024227159097790718
2023-04-19 01:59:02 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.023593785241246223, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.02377587929368019, mean p set: 0.4498290419578552
The modified gen p mean: 0.44831880927085876, gen p mean: -0.023055631667375565, mean p set: 0.44879910349845886
loss_pred:0.043030835688114166, decouple_loss:0.02480093389749527
loss_pred:0.04329267516732216, decouple_loss:0.025156855583190918
loss_pred:0.04312412068247795, decouple_loss:0.024949343875050545
WV_0_PC_1_EH_0_PS_40, loss: 0.044397663325071335, avg_mse: 0.05010601505637169
current test mse: 0.050106
Iteration: 391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44941359758377075, gen p mean: -0.02579662762582302, mean p set: 0.44989389181137085
loss_pred:0.03846282884478569, decouple_loss:0.023382145911455154
The modified gen p mean: 0.44655951857566833, gen p mean: -0.03100496530532837, mean p set: 0.44703981280326843
The modified gen p mean: 0.4466017484664917, gen p mean: -0.027991360053420067, mean p set: 0.4470820426940918
loss_pred:0.03739551454782486, decouple_loss:0.026019694283604622
loss_pred:0.03695720061659813, decouple_loss:0.02572445385158062
Iteration: 392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755110144615173, gen p mean: -0.0344088077545166, mean p set: 0.44803139567375183
loss_pred:0.037780266255140305, decouple_loss:0.0232373233884573
The modified gen p mean: 0.4469491243362427, gen p mean: -0.03675045818090439, mean p set: 0.4474294185638428
The modified gen p mean: 0.4482465088367462, gen p mean: -0.03630685806274414, mean p set: 0.4487267732620239
loss_pred:0.03617211431264877, decouple_loss:0.023131294175982475
loss_pred:0.03750695288181305, decouple_loss:0.023460019379854202
Iteration: 393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473516047000885, gen p mean: -0.03683045506477356, mean p set: 0.4478318989276886
loss_pred:0.03891751170158386, decouple_loss:0.02505526877939701
The modified gen p mean: 0.4483056962490082, gen p mean: -0.04169874265789986, mean p set: 0.4487859904766083
loss_pred:0.03734009712934494, decouple_loss:0.025092486292123795
The modified gen p mean: 0.4476531147956848, gen p mean: -0.04096643254160881, mean p set: 0.44813334941864014
loss_pred:0.03801579773426056, decouple_loss:0.023790748789906502
Iteration: 394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762569665908813, gen p mean: -0.040321364998817444, mean p set: 0.4481060206890106
loss_pred:0.03738245368003845, decouple_loss:0.02256287820637226
The modified gen p mean: 0.44960805773735046, gen p mean: -0.04417821019887924, mean p set: 0.4500883221626282
loss_pred:0.03625193238258362, decouple_loss:0.0228719599545002
The modified gen p mean: 0.4484936594963074, gen p mean: -0.04403137415647507, mean p set: 0.44897395372390747
loss_pred:0.03703748807311058, decouple_loss:0.021980909630656242
Iteration: 395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472801983356476, gen p mean: -0.04642503336071968, mean p set: 0.4477604627609253
loss_pred:0.03624637424945831, decouple_loss:0.024964269250631332
The modified gen p mean: 0.4480094313621521, gen p mean: -0.04903149604797363, mean p set: 0.4484897553920746
The modified gen p mean: 0.44703516364097595, gen p mean: -0.04631473496556282, mean p set: 0.44751542806625366
loss_pred:0.038175731897354126, decouple_loss:0.026295624673366547
loss_pred:0.0360882505774498, decouple_loss:0.02524898760020733
Iteration: 396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464806616306305, gen p mean: -0.043623168021440506, mean p set: 0.4469609558582306
The modified gen p mean: 0.44772204756736755, gen p mean: -0.04440790414810181, mean p set: 0.44820234179496765
The modified gen p mean: 0.4475826025009155, gen p mean: -0.04749571904540062, mean p set: 0.4480628967285156
loss_pred:0.03512081503868103, decouple_loss:0.02307763509452343
loss_pred:0.036958642303943634, decouple_loss:0.023610370233654976loss_pred:0.03620443865656853, decouple_loss:0.022725971415638924
Iteration: 397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44696342945098877, gen p mean: -0.05138300731778145, mean p set: 0.44744372367858887
loss_pred:0.037055037915706635, decouple_loss:0.02680693194270134
The modified gen p mean: 0.4476337432861328, gen p mean: -0.051801618188619614, mean p set: 0.4481140077114105
The modified gen p mean: 0.4490155279636383, gen p mean: -0.052960410714149475, mean p set: 0.4494958221912384
loss_pred:0.03633957728743553, decouple_loss:0.026078563183546066
loss_pred:0.03724295273423195, decouple_loss:0.02871503122150898
Iteration: 398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44842371344566345, gen p mean: -0.04863869771361351, mean p set: 0.44890403747558594
loss_pred:0.03596333786845207, decouple_loss:0.023539582267403603
The modified gen p mean: 0.44723808765411377, gen p mean: -0.046605128794908524, mean p set: 0.4477183520793915
The modified gen p mean: 0.4476301968097687, gen p mean: -0.0500718429684639, mean p set: 0.4481104910373688
loss_pred:0.03741303086280823, decouple_loss:0.0251096710562706
loss_pred:0.035752445459365845, decouple_loss:0.025142505764961243
Iteration: 399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484513998031616, gen p mean: -0.04502829909324646, mean p set: 0.4489316940307617
loss_pred:0.03647320345044136, decouple_loss:0.020911196246743202
The modified gen p mean: 0.4463418126106262, gen p mean: -0.04806890711188316, mean p set: 0.4468221068382263
The modified gen p mean: 0.44688501954078674, gen p mean: -0.0479673370718956, mean p set: 0.44736534357070923
loss_pred:0.03651422634720802, decouple_loss:0.02591390162706375
loss_pred:0.03875958174467087, decouple_loss:0.02566937357187271
Iteration: 400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44689786434173584, gen p mean: -0.03645436093211174, mean p set: 0.44737815856933594
loss_pred:0.03622264042496681, decouple_loss:0.023427816107869148
The modified gen p mean: 0.44716107845306396, gen p mean: -0.03781004622578621, mean p set: 0.4476413428783417
The modified gen p mean: 0.4466789960861206, gen p mean: -0.04128046706318855, mean p set: 0.4471592903137207
loss_pred:0.03657196834683418, decouple_loss:0.023609165102243423
loss_pred:0.035240840166807175, decouple_loss:0.025980476289987564
2023-04-19 02:00:55 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.027830233797430992, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.027768278494477272, mean p set: 0.4498290419578552
The modified gen p mean: 0.44831880927085876, gen p mean: -0.026788532733917236, mean p set: 0.44879910349845886
loss_pred:0.04252007603645325, decouple_loss:0.02510516531765461
loss_pred:0.04326508194208145, decouple_loss:0.024036558344960213
loss_pred:0.043073870241642, decouple_loss:0.023712903261184692
WV_0_PC_1_EH_0_PS_40, loss: 0.044167257845401764, avg_mse: 0.050148747861385345
current test mse: 0.050149
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44814372062683105, gen p mean: -0.028895322233438492, mean p set: 0.44862401485443115
loss_pred:0.03762343153357506, decouple_loss:0.021544430404901505
The modified gen p mean: 0.4468085765838623, gen p mean: -0.028420835733413696, mean p set: 0.4472888708114624
loss_pred:0.03933895379304886, decouple_loss:0.02130095474421978
The modified gen p mean: 0.44735538959503174, gen p mean: -0.03321860358119011, mean p set: 0.4478357136249542
loss_pred:0.03557354211807251, decouple_loss:0.024418579414486885
Iteration: 402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473671317100525, gen p mean: -0.04750112444162369, mean p set: 0.4478473961353302
loss_pred:0.03997049853205681, decouple_loss:0.021774685010313988
The modified gen p mean: 0.44660720229148865, gen p mean: -0.047811105847358704, mean p set: 0.44708749651908875
loss_pred:0.039523813873529434, decouple_loss:0.022452043369412422
The modified gen p mean: 0.44795045256614685, gen p mean: -0.04753666743636131, mean p set: 0.44843074679374695
loss_pred:0.038864556699991226, decouple_loss:0.022834869101643562
Iteration: 403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44681665301322937, gen p mean: -0.04097716510295868, mean p set: 0.4472969174385071
The modified gen p mean: 0.44754332304000854, gen p mean: -0.037074122577905655, mean p set: 0.44802361726760864
loss_pred:0.03763844817876816, decouple_loss:0.022128820419311523
loss_pred:0.0409538634121418, decouple_loss:0.021724652498960495
The modified gen p mean: 0.44832292199134827, gen p mean: -0.03766985237598419, mean p set: 0.44880321621894836
loss_pred:0.03752134367823601, decouple_loss:0.02365933731198311
Iteration: 404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723570346832275, gen p mean: -0.04436558112502098, mean p set: 0.44771599769592285
The modified gen p mean: 0.44862884283065796, gen p mean: -0.04305865243077278, mean p set: 0.44910916686058044
loss_pred:0.03948017209768295, decouple_loss:0.02301451936364174
The modified gen p mean: 0.44745659828186035, gen p mean: -0.044791314750909805, mean p set: 0.44793686270713806
loss_pred:0.038375381380319595, decouple_loss:0.021401261910796165
loss_pred:0.03745882213115692, decouple_loss:0.022977422922849655
Iteration: 405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44688132405281067, gen p mean: -0.051620084792375565, mean p set: 0.44736161828041077
The modified gen p mean: 0.4471207857131958, gen p mean: -0.048484090715646744, mean p set: 0.4476010799407959
loss_pred:0.03634686395525932, decouple_loss:0.022011172026395798
loss_pred:0.03752274438738823, decouple_loss:0.0229050200432539
The modified gen p mean: 0.44820713996887207, gen p mean: -0.045972734689712524, mean p set: 0.44868743419647217
loss_pred:0.03609248623251915, decouple_loss:0.022750910371541977
Iteration: 406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473111629486084, gen p mean: -0.046635713428258896, mean p set: 0.4477914571762085
The modified gen p mean: 0.4480040669441223, gen p mean: -0.043726950883865356, mean p set: 0.4484843611717224loss_pred:0.03793531656265259, decouple_loss:0.024914152920246124
The modified gen p mean: 0.4485521912574768, gen p mean: -0.04861930012702942, mean p set: 0.4490325152873993
loss_pred:0.03709646314382553, decouple_loss:0.024109886959195137
loss_pred:0.03809879720211029, decouple_loss:0.024644596502184868
Iteration: 407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482698440551758, gen p mean: -0.03873506188392639, mean p set: 0.4487501382827759
loss_pred:0.0365535207092762, decouple_loss:0.02196960151195526
The modified gen p mean: 0.44689297676086426, gen p mean: -0.03839625418186188, mean p set: 0.44737330079078674
loss_pred:0.03579512611031532, decouple_loss:0.02169182151556015
The modified gen p mean: 0.4481635093688965, gen p mean: -0.0332864373922348, mean p set: 0.4486437737941742
loss_pred:0.037104908376932144, decouple_loss:0.021869655698537827
Iteration: 408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474269449710846, gen p mean: -0.05033357813954353, mean p set: 0.4479072690010071
The modified gen p mean: 0.4472900927066803, gen p mean: -0.04767272621393204, mean p set: 0.4477703869342804
loss_pred:0.03502867743372917, decouple_loss:0.025239815935492516
loss_pred:0.03772290423512459, decouple_loss:0.026365816593170166
The modified gen p mean: 0.44622576236724854, gen p mean: -0.04370434209704399, mean p set: 0.44670602679252625
loss_pred:0.037721581757068634, decouple_loss:0.02702828124165535
Iteration: 409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44693994522094727, gen p mean: -0.06221917271614075, mean p set: 0.44742023944854736
loss_pred:0.03712452948093414, decouple_loss:0.023231858387589455
The modified gen p mean: 0.44699323177337646, gen p mean: -0.060336340218782425, mean p set: 0.44747352600097656
The modified gen p mean: 0.44823771715164185, gen p mean: -0.059962935745716095, mean p set: 0.44871804118156433
loss_pred:0.03689202293753624, decouple_loss:0.02517957054078579
loss_pred:0.03754761070013046, decouple_loss:0.022351769730448723
Iteration: 410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44653046131134033, gen p mean: -0.06546539813280106, mean p set: 0.44701075553894043
The modified gen p mean: 0.44732606410980225, gen p mean: -0.06481604278087616, mean p set: 0.44780635833740234
loss_pred:0.03632764890789986, decouple_loss:0.025107895955443382
loss_pred:0.03724784031510353, decouple_loss:0.02491101436316967
The modified gen p mean: 0.4476637840270996, gen p mean: -0.06284980475902557, mean p set: 0.4481441080570221
loss_pred:0.03545743599534035, decouple_loss:0.025307228788733482
2023-04-19 02:03:29 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.06255007535219193, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.061472587287425995, mean p set: 0.4498290419578552
The modified gen p mean: 0.44831880927085876, gen p mean: -0.05999211221933365, mean p set: 0.44879910349845886
loss_pred:0.04136453941464424, decouple_loss:0.026348549872636795
loss_pred:0.04206887260079384, decouple_loss:0.025281088426709175
loss_pred:0.042001426219940186, decouple_loss:0.025226658210158348
WV_0_PC_1_EH_0_PS_40, loss: 0.043092548847198486, avg_mse: 0.04807376489043236
current test mse: 0.048074
Iteration: 411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44734081625938416, gen p mean: -0.05887779965996742, mean p set: 0.44782111048698425
loss_pred:0.03830941393971443, decouple_loss:0.02570224180817604
The modified gen p mean: 0.44682765007019043, gen p mean: -0.060703620314598083, mean p set: 0.4473079442977905
The modified gen p mean: 0.4468052387237549, gen p mean: -0.059752583503723145, mean p set: 0.44728556275367737
loss_pred:0.03589600324630737, decouple_loss:0.027807027101516724
loss_pred:0.03742393106222153, decouple_loss:0.02492070198059082
Iteration: 412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769397377967834, gen p mean: -0.05893159285187721, mean p set: 0.44817429780960083
The modified gen p mean: 0.4466507136821747, gen p mean: -0.06212792918086052, mean p set: 0.4471310079097748
loss_pred:0.035452067852020264, decouple_loss:0.022150708362460136
loss_pred:0.035463202744722366, decouple_loss:0.021784165874123573
The modified gen p mean: 0.4484044313430786, gen p mean: -0.05974321812391281, mean p set: 0.4488847255706787
loss_pred:0.03459449112415314, decouple_loss:0.02351655438542366
Iteration: 413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44675448536872864, gen p mean: -0.05790376663208008, mean p set: 0.44723477959632874
loss_pred:0.036935556679964066, decouple_loss:0.025076042860746384
The modified gen p mean: 0.44761157035827637, gen p mean: -0.05499563738703728, mean p set: 0.4480918347835541
loss_pred:0.03799585998058319, decouple_loss:0.025487108156085014
The modified gen p mean: 0.4479466378688812, gen p mean: -0.056826818734407425, mean p set: 0.4484269320964813
loss_pred:0.03456965833902359, decouple_loss:0.025150295346975327
Iteration: 414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474378228187561, gen p mean: -0.05550090968608856, mean p set: 0.4479181170463562
loss_pred:0.03583143278956413, decouple_loss:0.022876620292663574
The modified gen p mean: 0.44815999269485474, gen p mean: -0.056985240429639816, mean p set: 0.44864028692245483
loss_pred:0.037025462836027145, decouple_loss:0.02340921387076378
The modified gen p mean: 0.4477618634700775, gen p mean: -0.05783252418041229, mean p set: 0.4482421875
loss_pred:0.03750917315483093, decouple_loss:0.024640394374728203
Iteration: 415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472196400165558, gen p mean: -0.05693662911653519, mean p set: 0.4476999342441559
loss_pred:0.03628435730934143, decouple_loss:0.022389598190784454
The modified gen p mean: 0.4493085741996765, gen p mean: -0.061353664845228195, mean p set: 0.4497888684272766
loss_pred:0.03349604830145836, decouple_loss:0.02549799345433712
The modified gen p mean: 0.447664350271225, gen p mean: -0.05325392261147499, mean p set: 0.4481446444988251
loss_pred:0.03654192388057709, decouple_loss:0.02408512867987156
Iteration: 416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472491145133972, gen p mean: -0.05368144437670708, mean p set: 0.4477294087409973
loss_pred:0.038396164774894714, decouple_loss:0.023285770788788795
The modified gen p mean: 0.4478319585323334, gen p mean: -0.05299336835741997, mean p set: 0.4483122229576111
loss_pred:0.03529690206050873, decouple_loss:0.022679578512907028
The modified gen p mean: 0.4470902383327484, gen p mean: -0.05278889462351799, mean p set: 0.4475705623626709
loss_pred:0.03530247509479523, decouple_loss:0.02305501513183117
Iteration: 417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468839466571808, gen p mean: -0.059057801961898804, mean p set: 0.44736430048942566
loss_pred:0.035583630204200745, decouple_loss:0.02214621938765049
The modified gen p mean: 0.4481145441532135, gen p mean: -0.05532577633857727, mean p set: 0.4485948383808136
loss_pred:0.03594471141695976, decouple_loss:0.020603744313120842
The modified gen p mean: 0.4473397433757782, gen p mean: -0.05310848727822304, mean p set: 0.4478200376033783
loss_pred:0.035768769681453705, decouple_loss:0.020786751061677933
Iteration: 418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467688500881195, gen p mean: -0.06609303504228592, mean p set: 0.4472491443157196
loss_pred:0.035558540374040604, decouple_loss:0.021794607862830162
The modified gen p mean: 0.4472769796848297, gen p mean: -0.06412643194198608, mean p set: 0.4477572739124298
loss_pred:0.03686794638633728, decouple_loss:0.02114235982298851
The modified gen p mean: 0.4472962021827698, gen p mean: -0.06675413250923157, mean p set: 0.4477764964103699
loss_pred:0.03663593530654907, decouple_loss:0.021715544164180756
Iteration: 419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773995876312256, gen p mean: -0.06609263271093369, mean p set: 0.44822028279304504
The modified gen p mean: 0.44882383942604065, gen p mean: -0.0671156793832779, mean p set: 0.44930416345596313
loss_pred:0.03468936309218407, decouple_loss:0.02368258684873581
loss_pred:0.03435565531253815, decouple_loss:0.0233418308198452
The modified gen p mean: 0.4466067850589752, gen p mean: -0.06041473522782326, mean p set: 0.4470870792865753
loss_pred:0.035994816571474075, decouple_loss:0.021643225103616714
Iteration: 420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794484972953796, gen p mean: -0.050395287573337555, mean p set: 0.44842514395713806
The modified gen p mean: 0.4471854269504547, gen p mean: -0.050981130450963974, mean p set: 0.4476657211780548
loss_pred:0.036201734095811844, decouple_loss:0.02131713181734085
loss_pred:0.03454550728201866, decouple_loss:0.021394850686192513
The modified gen p mean: 0.44747069478034973, gen p mean: -0.04789162427186966, mean p set: 0.4479510188102722
loss_pred:0.03509289398789406, decouple_loss:0.02036822959780693
2023-04-19 02:05:22 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.05013195425271988, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.04972720891237259, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.04837731271982193, mean p set: 0.44879910349845886
loss_pred:0.03976687788963318, decouple_loss:0.02414935827255249
loss_pred:0.04040726274251938, decouple_loss:0.023311419412493706
loss_pred:0.04024696350097656, decouple_loss:0.022945398464798927
WV_0_PC_1_EH_0_PS_40, loss: 0.04131380468606949, avg_mse: 0.0454711876809597
current test mse: 0.045471
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455007314682007, gen p mean: -0.05136984959244728, mean p set: 0.44598105549812317
loss_pred:0.03720901906490326, decouple_loss:0.022515496239066124
The modified gen p mean: 0.44828417897224426, gen p mean: -0.04937998205423355, mean p set: 0.44876447319984436
loss_pred:0.03381642326712608, decouple_loss:0.02327677793800831
The modified gen p mean: 0.44660383462905884, gen p mean: -0.05107910558581352, mean p set: 0.44708412885665894
loss_pred:0.03517599776387215, decouple_loss:0.0227543693035841
Iteration: 422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464516043663025, gen p mean: -0.04806087166070938, mean p set: 0.4469318985939026
The modified gen p mean: 0.44669926166534424, gen p mean: -0.05267009511590004, mean p set: 0.44717955589294434loss_pred:0.03560388460755348, decouple_loss:0.01995675265789032
loss_pred:0.034837473183870316, decouple_loss:0.02000349760055542
The modified gen p mean: 0.4481351971626282, gen p mean: -0.046397507190704346, mean p set: 0.44861549139022827
loss_pred:0.034167610108852386, decouple_loss:0.019327227026224136
Iteration: 423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462679922580719, gen p mean: -0.04727041348814964, mean p set: 0.446748286485672The modified gen p mean: 0.4477178752422333, gen p mean: -0.048490092158317566, mean p set: 0.4481981694698334
loss_pred:0.035061195492744446, decouple_loss:0.025673460215330124
loss_pred:0.03637397289276123, decouple_loss:0.026840204373002052
The modified gen p mean: 0.44840073585510254, gen p mean: -0.04943282902240753, mean p set: 0.448881059885025
loss_pred:0.03487430512905121, decouple_loss:0.02287089079618454
Iteration: 424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474099576473236, gen p mean: -0.04873320087790489, mean p set: 0.4478902518749237
loss_pred:0.035027261823415756, decouple_loss:0.022241732105612755
The modified gen p mean: 0.447457492351532, gen p mean: -0.050268348306417465, mean p set: 0.44793781638145447
loss_pred:0.03746241331100464, decouple_loss:0.022296331822872162
The modified gen p mean: 0.44646063446998596, gen p mean: -0.047318097203969955, mean p set: 0.44694095849990845
loss_pred:0.036241255700588226, decouple_loss:0.02329978533089161
Iteration: 425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44644808769226074, gen p mean: -0.05191625654697418, mean p set: 0.44692835211753845
loss_pred:0.034525711089372635, decouple_loss:0.020020825788378716
The modified gen p mean: 0.44710928201675415, gen p mean: -0.04910501465201378, mean p set: 0.44758957624435425
loss_pred:0.034957949072122574, decouple_loss:0.020768018439412117
The modified gen p mean: 0.44681262969970703, gen p mean: -0.04495951905846596, mean p set: 0.44729292392730713
loss_pred:0.03613763302564621, decouple_loss:0.019636215642094612
Iteration: 426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478619396686554, gen p mean: -0.04601605609059334, mean p set: 0.4483422338962555
The modified gen p mean: 0.44610586762428284, gen p mean: -0.04681577906012535, mean p set: 0.4465861916542053
loss_pred:0.03498629108071327, decouple_loss:0.02539474330842495
loss_pred:0.03636119142174721, decouple_loss:0.025936011224985123
The modified gen p mean: 0.44810187816619873, gen p mean: -0.046446576714515686, mean p set: 0.44858217239379883
loss_pred:0.033271677792072296, decouple_loss:0.02567274123430252
Iteration: 427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478340148925781, gen p mean: -0.050167061388492584, mean p set: 0.44831427931785583
loss_pred:0.0349108912050724, decouple_loss:0.01976528950035572
The modified gen p mean: 0.4469771385192871, gen p mean: -0.05319469794631004, mean p set: 0.4474574029445648
loss_pred:0.035115525126457214, decouple_loss:0.020024573430418968
The modified gen p mean: 0.44859689474105835, gen p mean: -0.05401582270860672, mean p set: 0.44907715916633606
loss_pred:0.0334676131606102, decouple_loss:0.01998392678797245
Iteration: 428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722050428390503, gen p mean: -0.05776701867580414, mean p set: 0.4477007985115051
loss_pred:0.034939978271722794, decouple_loss:0.02094646356999874
The modified gen p mean: 0.4465464651584625, gen p mean: -0.05889130383729935, mean p set: 0.4470267593860626
loss_pred:0.036011695861816406, decouple_loss:0.0205592829734087
The modified gen p mean: 0.4459763467311859, gen p mean: -0.060866937041282654, mean p set: 0.446456640958786
loss_pred:0.03364527225494385, decouple_loss:0.020485643297433853
Iteration: 429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458503723144531, gen p mean: -0.05360783264040947, mean p set: 0.4463306665420532
loss_pred:0.03431667760014534, decouple_loss:0.020672285929322243
The modified gen p mean: 0.44854840636253357, gen p mean: -0.05311497673392296, mean p set: 0.4490286707878113
loss_pred:0.03512699902057648, decouple_loss:0.018686417490243912
The modified gen p mean: 0.44622603058815, gen p mean: -0.05333036556839943, mean p set: 0.4467063546180725
loss_pred:0.03471197560429573, decouple_loss:0.019530605524778366
Iteration: 430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786348938941956, gen p mean: -0.05526989325881004, mean p set: 0.44834378361701965
loss_pred:0.033991068601608276, decouple_loss:0.020604252815246582
The modified gen p mean: 0.44668105244636536, gen p mean: -0.05790214240550995, mean p set: 0.44716131687164307
loss_pred:0.03726980462670326, decouple_loss:0.01979907415807247
The modified gen p mean: 0.445803701877594, gen p mean: -0.05356955528259277, mean p set: 0.4462839961051941
loss_pred:0.0338643379509449, decouple_loss:0.019544236361980438
2023-04-19 02:08:02 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.05212836340069771, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.051886603236198425, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.05033551901578903, mean p set: 0.44879910349845886
loss_pred:0.03971424326300621, decouple_loss:0.018806075677275658
loss_pred:0.040048111230134964, decouple_loss:0.018218401819467545
loss_pred:0.04011908173561096, decouple_loss:0.01801275461912155
WV_0_PC_1_EH_0_PS_40, loss: 0.04087776690721512, avg_mse: 0.0455407090485096
current test mse: 0.045541
Iteration: 431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44673678278923035, gen p mean: -0.04975013807415962, mean p set: 0.44721704721450806
loss_pred:0.03442133963108063, decouple_loss:0.018133221194148064
The modified gen p mean: 0.44754672050476074, gen p mean: -0.05443096533417702, mean p set: 0.44802701473236084
loss_pred:0.03339924290776253, decouple_loss:0.01815413311123848
The modified gen p mean: 0.4470152258872986, gen p mean: -0.05497375875711441, mean p set: 0.4474954903125763
loss_pred:0.03462005779147148, decouple_loss:0.017258303239941597
Iteration: 432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44693711400032043, gen p mean: -0.0493599995970726, mean p set: 0.44741740822792053
loss_pred:0.03561484441161156, decouple_loss:0.018841197714209557
The modified gen p mean: 0.44713258743286133, gen p mean: -0.04950238764286041, mean p set: 0.4476129114627838
loss_pred:0.035632647573947906, decouple_loss:0.02082168310880661
The modified gen p mean: 0.44691744446754456, gen p mean: -0.05386248230934143, mean p set: 0.44739776849746704
loss_pred:0.03411836177110672, decouple_loss:0.02021002396941185
Iteration: 433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796088337898254, gen p mean: -0.06021156162023544, mean p set: 0.44844114780426025
loss_pred:0.034689124673604965, decouple_loss:0.017773905768990517
The modified gen p mean: 0.4462986886501312, gen p mean: -0.05837724730372429, mean p set: 0.4467789828777313
The modified gen p mean: 0.44497737288475037, gen p mean: -0.0601484589278698, mean p set: 0.4454576373100281
loss_pred:0.03480832278728485, decouple_loss:0.017486784607172012
loss_pred:0.03413740545511246, decouple_loss:0.018486086279153824
Iteration: 434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760170578956604, gen p mean: -0.058741457760334015, mean p set: 0.44808200001716614
loss_pred:0.03260146453976631, decouple_loss:0.018109707161784172
The modified gen p mean: 0.44790753722190857, gen p mean: -0.060241762548685074, mean p set: 0.44838783144950867
loss_pred:0.033158574253320694, decouple_loss:0.01890099048614502
The modified gen p mean: 0.44696521759033203, gen p mean: -0.05421176180243492, mean p set: 0.44744551181793213
loss_pred:0.03424326702952385, decouple_loss:0.01827389746904373
Iteration: 435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474528133869171, gen p mean: -0.05144742876291275, mean p set: 0.4479331374168396
loss_pred:0.035163044929504395, decouple_loss:0.019327420741319656
The modified gen p mean: 0.44632357358932495, gen p mean: -0.048730816692113876, mean p set: 0.44680383801460266
loss_pred:0.0334998220205307, decouple_loss:0.02228666841983795
The modified gen p mean: 0.4478778541088104, gen p mean: -0.049888912588357925, mean p set: 0.4483581483364105
loss_pred:0.03270190209150314, decouple_loss:0.020943347364664078
Iteration: 436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44587817788124084, gen p mean: -0.05309908092021942, mean p set: 0.44635844230651855
loss_pred:0.034905027598142624, decouple_loss:0.01940784603357315
The modified gen p mean: 0.4477289915084839, gen p mean: -0.05521517992019653, mean p set: 0.448209285736084
loss_pred:0.03408949822187424, decouple_loss:0.019218770787119865
The modified gen p mean: 0.4466102123260498, gen p mean: -0.05770034343004227, mean p set: 0.4470905363559723
loss_pred:0.033182837069034576, decouple_loss:0.019526677206158638
Iteration: 437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455787241458893, gen p mean: -0.05594298988580704, mean p set: 0.4460590183734894
The modified gen p mean: 0.4466274380683899, gen p mean: -0.055234283208847046, mean p set: 0.44710773229599
loss_pred:0.03362027555704117, decouple_loss:0.0187232606112957
loss_pred:0.03465225175023079, decouple_loss:0.017406487837433815
The modified gen p mean: 0.447200208902359, gen p mean: -0.05634919926524162, mean p set: 0.4476804733276367
loss_pred:0.03693796694278717, decouple_loss:0.021055085584521294
Iteration: 438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44642341136932373, gen p mean: -0.047653552144765854, mean p set: 0.44690370559692383
loss_pred:0.03571362793445587, decouple_loss:0.017161192372441292
The modified gen p mean: 0.44668179750442505, gen p mean: -0.04953697323799133, mean p set: 0.44716206192970276
loss_pred:0.03471379354596138, decouple_loss:0.0187375545501709
The modified gen p mean: 0.44721493124961853, gen p mean: -0.05416834354400635, mean p set: 0.44769522547721863
loss_pred:0.03452298045158386, decouple_loss:0.017922313883900642
Iteration: 439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475288987159729, gen p mean: -0.05234701931476593, mean p set: 0.448009192943573
loss_pred:0.03674022853374481, decouple_loss:0.018852349370718002
The modified gen p mean: 0.4464872479438782, gen p mean: -0.05755903571844101, mean p set: 0.44696754217147827
loss_pred:0.03397471830248833, decouple_loss:0.02026892453432083
The modified gen p mean: 0.44727274775505066, gen p mean: -0.05604858323931694, mean p set: 0.44775307178497314
loss_pred:0.03256704658269882, decouple_loss:0.01918026991188526
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490334689617157, gen p mean: -0.0569334402680397, mean p set: 0.4495137631893158
The modified gen p mean: 0.44723257422447205, gen p mean: -0.057279326021671295, mean p set: 0.44771286845207214
loss_pred:0.034473419189453125, decouple_loss:0.017809949815273285
loss_pred:0.033718667924404144, decouple_loss:0.01730537600815296
The modified gen p mean: 0.44501030445098877, gen p mean: -0.05770077928900719, mean p set: 0.44549062848091125
loss_pred:0.03422141820192337, decouple_loss:0.01705063134431839
2023-04-19 02:09:56 testing...
The modified gen p mean: 0.44943100214004517, gen p mean: -0.05700967088341713, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.056828856468200684, mean p set: 0.4498290419578552
The modified gen p mean: 0.44831880927085876, gen p mean: -0.055021267384290695, mean p set: 0.44879910349845886
loss_pred:0.03925491124391556, decouple_loss:0.01995088718831539
loss_pred:0.03911932185292244, decouple_loss:0.01981637068092823
loss_pred:0.039408985525369644, decouple_loss:0.01924721896648407
WV_0_PC_1_EH_0_PS_40, loss: 0.04024465009570122, avg_mse: 0.04449236020445824
current test mse: 0.044492
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472489058971405, gen p mean: -0.05854116007685661, mean p set: 0.447729229927063
loss_pred:0.03517242893576622, decouple_loss:0.01841929368674755
The modified gen p mean: 0.44725489616394043, gen p mean: -0.05895170196890831, mean p set: 0.4477352201938629
loss_pred:0.035311806946992874, decouple_loss:0.018750809133052826
The modified gen p mean: 0.44793903827667236, gen p mean: -0.058888521045446396, mean p set: 0.44841933250427246
loss_pred:0.03576841205358505, decouple_loss:0.019745327532291412
Iteration: 442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484071731567383, gen p mean: -0.05402570962905884, mean p set: 0.44888749718666077
loss_pred:0.03378748521208763, decouple_loss:0.017448753118515015
The modified gen p mean: 0.4474979639053345, gen p mean: -0.055912453681230545, mean p set: 0.44797828793525696
loss_pred:0.03532705456018448, decouple_loss:0.01900310441851616
The modified gen p mean: 0.447325736284256, gen p mean: -0.05653110891580582, mean p set: 0.4478060305118561
loss_pred:0.034389935433864594, decouple_loss:0.01836608350276947
Iteration: 443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484719932079315, gen p mean: -0.056462980806827545, mean p set: 0.448952317237854
loss_pred:0.03362931311130524, decouple_loss:0.017386341467499733
The modified gen p mean: 0.4465268552303314, gen p mean: -0.058308448642492294, mean p set: 0.4470071494579315
loss_pred:0.0336294025182724, decouple_loss:0.018895819783210754
The modified gen p mean: 0.4474668800830841, gen p mean: -0.05707345902919769, mean p set: 0.4479471743106842
loss_pred:0.0354013592004776, decouple_loss:0.016882356256246567
Iteration: 444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483828842639923, gen p mean: -0.05699104815721512, mean p set: 0.4488631784915924
loss_pred:0.035790830850601196, decouple_loss:0.019955003634095192
The modified gen p mean: 0.447247713804245, gen p mean: -0.05518641322851181, mean p set: 0.4477280378341675
The modified gen p mean: 0.44594743847846985, gen p mean: -0.057948801666498184, mean p set: 0.44642776250839233
loss_pred:0.0337785929441452, decouple_loss:0.018689699470996857
loss_pred:0.03573855757713318, decouple_loss:0.017733989283442497
Iteration: 445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479029178619385, gen p mean: -0.057301752269268036, mean p set: 0.44838324189186096
loss_pred:0.03351834416389465, decouple_loss:0.02079806663095951
The modified gen p mean: 0.44755229353904724, gen p mean: -0.05573107302188873, mean p set: 0.44803258776664734
The modified gen p mean: 0.44736284017562866, gen p mean: -0.0585920475423336, mean p set: 0.44784313440322876
loss_pred:0.033515606075525284, decouple_loss:0.02058650553226471
loss_pred:0.03502418100833893, decouple_loss:0.019427627325057983
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474934935569763, gen p mean: -0.0517452135682106, mean p set: 0.44797375798225403
loss_pred:0.035787004977464676, decouple_loss:0.021447014063596725
The modified gen p mean: 0.446433961391449, gen p mean: -0.051939986646175385, mean p set: 0.44691428542137146
loss_pred:0.03444819897413254, decouple_loss:0.02388370782136917
The modified gen p mean: 0.44717884063720703, gen p mean: -0.0518113374710083, mean p set: 0.44765913486480713
loss_pred:0.034275904297828674, decouple_loss:0.021365737542510033
Iteration: 447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476871192455292, gen p mean: -0.05439973622560501, mean p set: 0.44816744327545166
The modified gen p mean: 0.44754186272621155, gen p mean: -0.0514160692691803, mean p set: 0.44802215695381165
loss_pred:0.03587862476706505, decouple_loss:0.020198838785290718
loss_pred:0.0333307683467865, decouple_loss:0.01947585679590702
The modified gen p mean: 0.4460480511188507, gen p mean: -0.052008770406246185, mean p set: 0.4465283155441284
loss_pred:0.03402550518512726, decouple_loss:0.019861476495862007
Iteration: 448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772443175315857, gen p mean: -0.048783980309963226, mean p set: 0.44820475578308105
loss_pred:0.03429802507162094, decouple_loss:0.016998684033751488
The modified gen p mean: 0.4480936527252197, gen p mean: -0.0479215644299984, mean p set: 0.4485739767551422
loss_pred:0.03317854925990105, decouple_loss:0.01678098551928997
The modified gen p mean: 0.4480712115764618, gen p mean: -0.04857511445879936, mean p set: 0.4485515058040619
loss_pred:0.035347770899534225, decouple_loss:0.01687561348080635
Iteration: 449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819462299346924, gen p mean: -0.048488423228263855, mean p set: 0.4486749470233917
loss_pred:0.03486327454447746, decouple_loss:0.017456093803048134
The modified gen p mean: 0.44698426127433777, gen p mean: -0.048616088926792145, mean p set: 0.44746458530426025
loss_pred:0.034219756722450256, decouple_loss:0.016825443133711815
The modified gen p mean: 0.44764432311058044, gen p mean: -0.04817594215273857, mean p set: 0.44812464714050293
loss_pred:0.03420491889119148, decouple_loss:0.016619933769106865
Iteration: 450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44671371579170227, gen p mean: -0.051335856318473816, mean p set: 0.44719401001930237
loss_pred:0.034619349986314774, decouple_loss:0.01770235411822796
The modified gen p mean: 0.4473837912082672, gen p mean: -0.048067718744277954, mean p set: 0.4478640854358673
The modified gen p mean: 0.4480925500392914, gen p mean: -0.05050330236554146, mean p set: 0.4485728442668915
loss_pred:0.0341988243162632, decouple_loss:0.01984569802880287
loss_pred:0.03327726945281029, decouple_loss:0.019241537898778915
2023-04-19 02:12:39 testing...
The modified gen p mean: 0.44943100214004517, gen p mean: -0.04533686861395836, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.04507898539304733, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.043519098311662674, mean p set: 0.44879910349845886
loss_pred:0.03874076530337334, decouple_loss:0.01844274438917637
loss_pred:0.0391136035323143, decouple_loss:0.018018361181020737
loss_pred:0.03909984230995178, decouple_loss:0.017662398517131805
WV_0_PC_1_EH_0_PS_40, loss: 0.03988679498434067, avg_mse: 0.04449091851711273
current test mse: 0.044491
Iteration: 451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463503658771515, gen p mean: -0.04760921746492386, mean p set: 0.4468306601047516
The modified gen p mean: 0.4479878544807434, gen p mean: -0.04349703714251518, mean p set: 0.4484681785106659
loss_pred:0.031885016709566116, decouple_loss:0.016791507601737976
loss_pred:0.03537739813327789, decouple_loss:0.017033997923135757
The modified gen p mean: 0.44731026887893677, gen p mean: -0.04659948870539665, mean p set: 0.44779056310653687
loss_pred:0.032694704830646515, decouple_loss:0.016730934381484985
Iteration: 452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677478075027466, gen p mean: -0.0484662801027298, mean p set: 0.44725507497787476
The modified gen p mean: 0.4466010630130768, gen p mean: -0.04730839282274246, mean p set: 0.4470813572406769
loss_pred:0.033960483968257904, decouple_loss:0.019608641043305397
loss_pred:0.034010905772447586, decouple_loss:0.016525274142622948
The modified gen p mean: 0.44760996103286743, gen p mean: -0.04721406102180481, mean p set: 0.44809025526046753
loss_pred:0.0334603488445282, decouple_loss:0.01793336123228073
Iteration: 453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477332532405853, gen p mean: -0.05183745175600052, mean p set: 0.4482135772705078
loss_pred:0.03511826694011688, decouple_loss:0.020458390936255455
The modified gen p mean: 0.4479389786720276, gen p mean: -0.05241216719150543, mean p set: 0.4484192430973053
The modified gen p mean: 0.4482315480709076, gen p mean: -0.04910678789019585, mean p set: 0.4487118422985077loss_pred:0.03444281592965126, decouple_loss:0.022904712706804276
loss_pred:0.033039260655641556, decouple_loss:0.02202930487692356
Iteration: 454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485853910446167, gen p mean: -0.039553023874759674, mean p set: 0.4490656852722168
loss_pred:0.03358565270900726, decouple_loss:0.018187157809734344
The modified gen p mean: 0.44836685061454773, gen p mean: -0.039735399186611176, mean p set: 0.44884711503982544
The modified gen p mean: 0.44676148891448975, gen p mean: -0.04086975008249283, mean p set: 0.44724181294441223
loss_pred:0.034194622188806534, decouple_loss:0.01924651861190796
loss_pred:0.032959550619125366, decouple_loss:0.01820025034248829
Iteration: 455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478013217449188, gen p mean: -0.04203468933701515, mean p set: 0.4482816159725189
loss_pred:0.03316676244139671, decouple_loss:0.01711023412644863
The modified gen p mean: 0.4475243091583252, gen p mean: -0.04457634314894676, mean p set: 0.4480046033859253
The modified gen p mean: 0.4477153718471527, gen p mean: -0.04383238032460213, mean p set: 0.4481956660747528
loss_pred:0.032598115503787994, decouple_loss:0.01788712851703167
loss_pred:0.03357423469424248, decouple_loss:0.018443549051880836
Iteration: 456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473014771938324, gen p mean: -0.05280980467796326, mean p set: 0.4477818012237549
loss_pred:0.033848680555820465, decouple_loss:0.02223966456949711
The modified gen p mean: 0.4472237229347229, gen p mean: -0.052260544151067734, mean p set: 0.4477040469646454
The modified gen p mean: 0.4468335509300232, gen p mean: -0.05345799773931503, mean p set: 0.4473138451576233
loss_pred:0.03295456990599632, decouple_loss:0.022760266438126564
loss_pred:0.033587533980607986, decouple_loss:0.02329615317285061
Iteration: 457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661808013916016, gen p mean: -0.04449323192238808, mean p set: 0.44709837436676025The modified gen p mean: 0.4462706446647644, gen p mean: -0.047140106558799744, mean p set: 0.4467509686946869
The modified gen p mean: 0.4461376368999481, gen p mean: -0.04497111588716507, mean p set: 0.4466179311275482
loss_pred:0.03303039073944092, decouple_loss:0.018180422484874725
loss_pred:0.03363683074712753, decouple_loss:0.018310336396098137
loss_pred:0.03406047448515892, decouple_loss:0.018650254234671593
Iteration: 458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708606600761414, gen p mean: -0.04618246853351593, mean p set: 0.44756636023521423
loss_pred:0.03270654380321503, decouple_loss:0.016651257872581482
The modified gen p mean: 0.44788992404937744, gen p mean: -0.043340183794498444, mean p set: 0.44837021827697754
The modified gen p mean: 0.4481610953807831, gen p mean: -0.04091157764196396, mean p set: 0.4486413896083832
loss_pred:0.03486237674951553, decouple_loss:0.018846673890948296
loss_pred:0.03180700168013573, decouple_loss:0.01855585165321827
Iteration: 459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473322331905365, gen p mean: -0.05618266761302948, mean p set: 0.4478125274181366
The modified gen p mean: 0.44711533188819885, gen p mean: -0.05676926299929619, mean p set: 0.44759562611579895
The modified gen p mean: 0.44779473543167114, gen p mean: -0.05511987954378128, mean p set: 0.44827502965927124
loss_pred:0.032038453966379166, decouple_loss:0.019282232969999313
loss_pred:0.03385660797357559, decouple_loss:0.023062411695718765
loss_pred:0.032846469432115555, decouple_loss:0.02028864622116089
Iteration: 460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476853609085083, gen p mean: -0.056936439126729965, mean p set: 0.4481656849384308
The modified gen p mean: 0.44761785864830017, gen p mean: -0.05212255194783211, mean p set: 0.44809815287590027
loss_pred:0.034136466681957245, decouple_loss:0.01901167444884777
loss_pred:0.03265581279993057, decouple_loss:0.019149184226989746
The modified gen p mean: 0.44590359926223755, gen p mean: -0.05700141191482544, mean p set: 0.44638389348983765
loss_pred:0.03317379951477051, decouple_loss:0.018767790868878365
2023-04-19 02:14:31 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.05095074325799942, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.05046418681740761, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.049230072647333145, mean p set: 0.44879910349845886
loss_pred:0.038472022861242294, decouple_loss:0.021602066233754158
loss_pred:0.03838726878166199, decouple_loss:0.021740583702921867
loss_pred:0.038726806640625, decouple_loss:0.02128041721880436
WV_0_PC_1_EH_0_PS_40, loss: 0.039605751633644104, avg_mse: 0.04389007017016411
current test mse: 0.04389
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474325478076935, gen p mean: -0.04557766020298004, mean p set: 0.4479128420352936
loss_pred:0.03312449902296066, decouple_loss:0.019702844321727753
The modified gen p mean: 0.44841745495796204, gen p mean: -0.04774259030818939, mean p set: 0.44889771938323975
loss_pred:0.034156933426856995, decouple_loss:0.01992648094892502
The modified gen p mean: 0.4474261701107025, gen p mean: -0.049927785992622375, mean p set: 0.4479064643383026
loss_pred:0.0352611318230629, decouple_loss:0.019219113513827324
Iteration: 462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499562680721283, gen p mean: -0.04777943715453148, mean p set: 0.4504365622997284
The modified gen p mean: 0.4476599097251892, gen p mean: -0.05120207741856575, mean p set: 0.4481402039527893
The modified gen p mean: 0.4490821361541748, gen p mean: -0.05307144299149513, mean p set: 0.4495624303817749
loss_pred:0.03462569788098335, decouple_loss:0.02103072591125965
loss_pred:0.03349780663847923, decouple_loss:0.018518822267651558
loss_pred:0.03582512214779854, decouple_loss:0.022550759837031364
Iteration: 463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811609387397766, gen p mean: -0.04900627210736275, mean p set: 0.44859644770622253
loss_pred:0.03414749354124069, decouple_loss:0.024501727893948555
The modified gen p mean: 0.44975507259368896, gen p mean: -0.04664772376418114, mean p set: 0.4502353370189667
loss_pred:0.035020481795072556, decouple_loss:0.02456013299524784
The modified gen p mean: 0.4487262964248657, gen p mean: -0.05474955961108208, mean p set: 0.44920656085014343
loss_pred:0.035199105739593506, decouple_loss:0.025515669956803322
Iteration: 464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488476812839508, gen p mean: -0.04745933786034584, mean p set: 0.4493279755115509
loss_pred:0.03151682764291763, decouple_loss:0.023504098877310753
The modified gen p mean: 0.4466943144798279, gen p mean: -0.04697846621274948, mean p set: 0.447174608707428
loss_pred:0.03544082120060921, decouple_loss:0.02347157709300518
The modified gen p mean: 0.4501930773258209, gen p mean: -0.038099512457847595, mean p set: 0.45067334175109863
loss_pred:0.032460570335388184, decouple_loss:0.022153301164507866
Iteration: 465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840124249458313, gen p mean: -0.04273867607116699, mean p set: 0.4488815367221832
The modified gen p mean: 0.44836610555648804, gen p mean: -0.04781755805015564, mean p set: 0.44884639978408813
The modified gen p mean: 0.448194295167923, gen p mean: -0.042158953845500946, mean p set: 0.44867458939552307
loss_pred:0.03624669089913368, decouple_loss:0.0221977811306715
loss_pred:0.03451172262430191, decouple_loss:0.021428052335977554
loss_pred:0.034983109682798386, decouple_loss:0.022205932065844536
Iteration: 466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972044229507446, gen p mean: -0.05482013151049614, mean p set: 0.45020073652267456
The modified gen p mean: 0.4507500231266022, gen p mean: -0.04719589650630951, mean p set: 0.45123034715652466
The modified gen p mean: 0.4488906264305115, gen p mean: -0.05254055932164192, mean p set: 0.4493709206581116
loss_pred:0.03374402970075607, decouple_loss:0.02656516619026661
loss_pred:0.03434775769710541, decouple_loss:0.02600220777094364
loss_pred:0.03513932228088379, decouple_loss:0.02866610512137413
Iteration: 467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473476707935333, gen p mean: -0.04860448092222214, mean p set: 0.44782793521881104
loss_pred:0.03362567722797394, decouple_loss:0.022100523114204407
The modified gen p mean: 0.4467901289463043, gen p mean: -0.05543623864650726, mean p set: 0.4472704529762268
loss_pred:0.03522200882434845, decouple_loss:0.02284865640103817
The modified gen p mean: 0.44738537073135376, gen p mean: -0.0477706603705883, mean p set: 0.44786569476127625
loss_pred:0.03341567888855934, decouple_loss:0.021913964301347733
Iteration: 468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819745421409607, gen p mean: -0.041012272238731384, mean p set: 0.44867774844169617
The modified gen p mean: 0.4472678005695343, gen p mean: -0.034975312650203705, mean p set: 0.447748064994812
loss_pred:0.035817522555589676, decouple_loss:0.03287683054804802
loss_pred:0.03379954770207405, decouple_loss:0.031081603839993477
The modified gen p mean: 0.4475484788417816, gen p mean: -0.03704269230365753, mean p set: 0.4480287730693817
loss_pred:0.0346674807369709, decouple_loss:0.03100723773241043
Iteration: 469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474162757396698, gen p mean: -0.043207455426454544, mean p set: 0.4478965699672699
The modified gen p mean: 0.44819363951683044, gen p mean: -0.04668828099966049, mean p set: 0.44867387413978577
loss_pred:0.034218862652778625, decouple_loss:0.021622931584715843
loss_pred:0.03594103455543518, decouple_loss:0.023811684921383858
The modified gen p mean: 0.4489430785179138, gen p mean: -0.04843054339289665, mean p set: 0.4494233727455139
loss_pred:0.03458579257130623, decouple_loss:0.023150375112891197
Iteration: 470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44915971159935, gen p mean: -0.06479053199291229, mean p set: 0.4496400058269501
loss_pred:0.03452952206134796, decouple_loss:0.03128032386302948
The modified gen p mean: 0.4476976692676544, gen p mean: -0.06039862707257271, mean p set: 0.4481779932975769
The modified gen p mean: 0.4489038288593292, gen p mean: -0.06063514202833176, mean p set: 0.4493841528892517
loss_pred:0.036590199917554855, decouple_loss:0.02985502779483795
loss_pred:0.03621216490864754, decouple_loss:0.025115469470620155
2023-04-19 02:17:05 testing...
The modified gen p mean: 0.44943100214004517, gen p mean: -0.041341494768857956, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.041500359773635864, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.040175341069698334, mean p set: 0.44879910349845886
loss_pred:0.0424414724111557, decouple_loss:0.022735830396413803
loss_pred:0.043015655130147934, decouple_loss:0.02242949604988098
loss_pred:0.042857348918914795, decouple_loss:0.022067638114094734
WV_0_PC_1_EH_0_PS_40, loss: 0.043892040848731995, avg_mse: 0.05124511942267418
current test mse: 0.051245
Iteration: 471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862741231918335, gen p mean: -0.042990993708372116, mean p set: 0.44910773634910583
The modified gen p mean: 0.4472696781158447, gen p mean: -0.04282870516180992, mean p set: 0.4477499723434448loss_pred:0.033241793513298035, decouple_loss:0.02323327027261257
loss_pred:0.03772589564323425, decouple_loss:0.022235559299588203
The modified gen p mean: 0.44975847005844116, gen p mean: -0.047136057168245316, mean p set: 0.45023879408836365
loss_pred:0.03610236197710037, decouple_loss:0.021821610629558563
Iteration: 472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490741789340973, gen p mean: -0.032554078847169876, mean p set: 0.449554443359375
The modified gen p mean: 0.4486962556838989, gen p mean: -0.03644925728440285, mean p set: 0.449176549911499
loss_pred:0.03400808572769165, decouple_loss:0.033451247960329056
loss_pred:0.034963253885507584, decouple_loss:0.027963226661086082
The modified gen p mean: 0.4493548274040222, gen p mean: -0.03659140318632126, mean p set: 0.4498351216316223
loss_pred:0.034013405442237854, decouple_loss:0.026217428967356682
Iteration: 473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472569227218628, gen p mean: -0.0408722423017025, mean p set: 0.4477371871471405
loss_pred:0.033511023968458176, decouple_loss:0.019811421632766724
The modified gen p mean: 0.448076993227005, gen p mean: -0.043955475091934204, mean p set: 0.4485572874546051
loss_pred:0.0344717912375927, decouple_loss:0.020223943516612053
The modified gen p mean: 0.447856068611145, gen p mean: -0.04317396506667137, mean p set: 0.4483363628387451
loss_pred:0.035155415534973145, decouple_loss:0.01992090977728367
Iteration: 474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489346742630005, gen p mean: -0.06506834924221039, mean p set: 0.4494149386882782
loss_pred:0.03428415581583977, decouple_loss:0.0260828398168087
The modified gen p mean: 0.44961124658584595, gen p mean: -0.06284306943416595, mean p set: 0.45009157061576843
loss_pred:0.033931054174900055, decouple_loss:0.021402632817626
The modified gen p mean: 0.451656699180603, gen p mean: -0.058552686125040054, mean p set: 0.4521370232105255
loss_pred:0.03583484888076782, decouple_loss:0.021682200953364372
Iteration: 475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44979915022850037, gen p mean: -0.06402702629566193, mean p set: 0.4502794146537781
loss_pred:0.03558293730020523, decouple_loss:0.021612029522657394
The modified gen p mean: 0.44839346408843994, gen p mean: -0.06202270835638046, mean p set: 0.44887375831604004
loss_pred:0.036480195820331573, decouple_loss:0.02125869132578373
The modified gen p mean: 0.44755735993385315, gen p mean: -0.06024004518985748, mean p set: 0.44803765416145325
loss_pred:0.03370635211467743, decouple_loss:0.02094060182571411
Iteration: 476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488057792186737, gen p mean: -0.04882824048399925, mean p set: 0.4492860734462738
loss_pred:0.03477942571043968, decouple_loss:0.033958517014980316
The modified gen p mean: 0.4500373601913452, gen p mean: -0.048143304884433746, mean p set: 0.4505176842212677
The modified gen p mean: 0.4471129775047302, gen p mean: -0.05450212582945824, mean p set: 0.4475933015346527
loss_pred:0.033715613186359406, decouple_loss:0.03315890580415726
loss_pred:0.0345253124833107, decouple_loss:0.02448047325015068
Iteration: 477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44766318798065186, gen p mean: -0.04663863405585289, mean p set: 0.44814345240592957
loss_pred:0.03466744348406792, decouple_loss:0.026115307584404945
The modified gen p mean: 0.4490068554878235, gen p mean: -0.05321938917040825, mean p set: 0.4494871497154236
loss_pred:0.031565360724925995, decouple_loss:0.025642573833465576
The modified gen p mean: 0.4479535222053528, gen p mean: -0.047885600477457047, mean p set: 0.44843384623527527
loss_pred:0.03578935191035271, decouple_loss:0.02555609494447708
Iteration: 478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469147026538849, gen p mean: -0.06293376535177231, mean p set: 0.447394996881485
loss_pred:0.033168528228998184, decouple_loss:0.0255237128585577
The modified gen p mean: 0.448757529258728, gen p mean: -0.06379827111959457, mean p set: 0.44923779368400574
loss_pred:0.03515855595469475, decouple_loss:0.020913194864988327
The modified gen p mean: 0.44912394881248474, gen p mean: -0.07084851711988449, mean p set: 0.4496042728424072
loss_pred:0.03142609819769859, decouple_loss:0.023363612592220306
Iteration: 479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44837772846221924, gen p mean: -0.07310342788696289, mean p set: 0.44885799288749695
loss_pred:0.03538177162408829, decouple_loss:0.021985484287142754
The modified gen p mean: 0.44862765073776245, gen p mean: -0.07588143646717072, mean p set: 0.44910797476768494
loss_pred:0.032898902893066406, decouple_loss:0.02323581650853157
The modified gen p mean: 0.44856274127960205, gen p mean: -0.07108362019062042, mean p set: 0.44904303550720215
loss_pred:0.03342745080590248, decouple_loss:0.02307429164648056
Iteration: 480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785282015800476, gen p mean: -0.06197075545787811, mean p set: 0.44833314418792725
loss_pred:0.033685337752103806, decouple_loss:0.02057930827140808
The modified gen p mean: 0.44798243045806885, gen p mean: -0.06477503478527069, mean p set: 0.44846272468566895
loss_pred:0.031061388552188873, decouple_loss:0.021971218287944794
The modified gen p mean: 0.4474971890449524, gen p mean: -0.0637323409318924, mean p set: 0.4479774832725525
loss_pred:0.03275284171104431, decouple_loss:0.020336883142590523
2023-04-19 02:18:57 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.058524277061223984, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.0584760420024395, mean p set: 0.4498290419578552
The modified gen p mean: 0.44831880927085876, gen p mean: -0.057151563465595245, mean p set: 0.44879910349845886
loss_pred:0.03987158462405205, decouple_loss:0.021281428635120392
loss_pred:0.04027124494314194, decouple_loss:0.021616166457533836
loss_pred:0.04050806164741516, decouple_loss:0.021437518298625946
WV_0_PC_1_EH_0_PS_40, loss: 0.04128921777009964, avg_mse: 0.04712223634123802
current test mse: 0.047122
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44821032881736755, gen p mean: -0.059247907251119614, mean p set: 0.44869065284729004
loss_pred:0.03435691073536873, decouple_loss:0.021690769121050835
The modified gen p mean: 0.44753408432006836, gen p mean: -0.05592023953795433, mean p set: 0.44801437854766846
loss_pred:0.034260477870702744, decouple_loss:0.020449118688702583
The modified gen p mean: 0.4487041234970093, gen p mean: -0.06178290769457817, mean p set: 0.449184387922287
loss_pred:0.03370290994644165, decouple_loss:0.020831508561968803
Iteration: 482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494333267211914, gen p mean: -0.06226492300629616, mean p set: 0.4499136209487915
loss_pred:0.033598609268665314, decouple_loss:0.025250473991036415
The modified gen p mean: 0.4478175938129425, gen p mean: -0.06504181027412415, mean p set: 0.4482978880405426
loss_pred:0.034542012959718704, decouple_loss:0.023069432005286217
The modified gen p mean: 0.4483109414577484, gen p mean: -0.061781201511621475, mean p set: 0.4487912356853485
loss_pred:0.03526695817708969, decouple_loss:0.020027995109558105
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44558775424957275, gen p mean: -0.06229768693447113, mean p set: 0.44606801867485046
loss_pred:0.034629322588443756, decouple_loss:0.018406519666314125
The modified gen p mean: 0.44861432909965515, gen p mean: -0.06008228287100792, mean p set: 0.44909462332725525
loss_pred:0.03304338455200195, decouple_loss:0.018013738095760345
The modified gen p mean: 0.4461553692817688, gen p mean: -0.06496611982584, mean p set: 0.4466356933116913
loss_pred:0.034340180456638336, decouple_loss:0.017819464206695557
Iteration: 484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446424663066864, gen p mean: -0.06050243601202965, mean p set: 0.4469049572944641
loss_pred:0.03350318968296051, decouple_loss:0.021384326741099358
The modified gen p mean: 0.4483659267425537, gen p mean: -0.06048295274376869, mean p set: 0.4488462209701538
loss_pred:0.032686151564121246, decouple_loss:0.02052180841565132
The modified gen p mean: 0.44623613357543945, gen p mean: -0.05866002291440964, mean p set: 0.44671642780303955
loss_pred:0.03287282586097717, decouple_loss:0.02115550823509693
Iteration: 485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468082785606384, gen p mean: -0.058142583817243576, mean p set: 0.4472885727882385
loss_pred:0.03332427144050598, decouple_loss:0.02247151918709278
The modified gen p mean: 0.4474954903125763, gen p mean: -0.05430128425359726, mean p set: 0.4479758143424988
loss_pred:0.0338163748383522, decouple_loss:0.021293524652719498
The modified gen p mean: 0.4471273124217987, gen p mean: -0.058890022337436676, mean p set: 0.4476076066493988
loss_pred:0.03356452286243439, decouple_loss:0.022060571238398552
Iteration: 486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446617990732193, gen p mean: -0.05647275596857071, mean p set: 0.44709834456443787
loss_pred:0.03374025225639343, decouple_loss:0.017330043017864227
The modified gen p mean: 0.4480317533016205, gen p mean: -0.0519900880753994, mean p set: 0.4485120475292206
loss_pred:0.03484182804822922, decouple_loss:0.017535602673888206
The modified gen p mean: 0.44803327322006226, gen p mean: -0.050964999943971634, mean p set: 0.44851356744766235
loss_pred:0.03448197618126869, decouple_loss:0.017930762842297554
Iteration: 487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461471736431122, gen p mean: -0.05966596677899361, mean p set: 0.4466274678707123
loss_pred:0.03286480903625488, decouple_loss:0.0216583963483572
The modified gen p mean: 0.44608765840530396, gen p mean: -0.05950368940830231, mean p set: 0.44656795263290405
loss_pred:0.03367738798260689, decouple_loss:0.02132386341691017
The modified gen p mean: 0.4485139846801758, gen p mean: -0.0551203154027462, mean p set: 0.4489942789077759
loss_pred:0.034517351537942886, decouple_loss:0.022033611312508583
Iteration: 488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473932087421417, gen p mean: -0.06532792001962662, mean p set: 0.4478735327720642
loss_pred:0.03459802642464638, decouple_loss:0.019147204235196114
The modified gen p mean: 0.44784674048423767, gen p mean: -0.06175626069307327, mean p set: 0.44832706451416016
loss_pred:0.031997837126255035, decouple_loss:0.01949477195739746
The modified gen p mean: 0.4478420615196228, gen p mean: -0.061515673995018005, mean p set: 0.4483223557472229
loss_pred:0.03315544128417969, decouple_loss:0.019080519676208496
Iteration: 489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44688740372657776, gen p mean: -0.058192793279886246, mean p set: 0.44736772775650024
loss_pred:0.033037927001714706, decouple_loss:0.0197130274027586
The modified gen p mean: 0.44778165221214294, gen p mean: -0.05929875001311302, mean p set: 0.44826194643974304
loss_pred:0.03362074866890907, decouple_loss:0.01897718943655491
The modified gen p mean: 0.4454862177371979, gen p mean: -0.062192484736442566, mean p set: 0.445966511964798
loss_pred:0.03424696624279022, decouple_loss:0.01886073499917984
Iteration: 490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736161828041077, gen p mean: -0.05746746063232422, mean p set: 0.44784191250801086
The modified gen p mean: 0.44732388854026794, gen p mean: -0.05243626981973648, mean p set: 0.44780421257019043
loss_pred:0.03288063034415245, decouple_loss:0.020768621936440468
loss_pred:0.032587237656116486, decouple_loss:0.02081426978111267
The modified gen p mean: 0.4472886323928833, gen p mean: -0.05356474593281746, mean p set: 0.4477689266204834
loss_pred:0.033463869243860245, decouple_loss:0.022346587851643562
2023-04-19 02:22:13 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.05409182235598564, mean p set: 0.4499112665653229
The modified gen p mean: 0.44934871792793274, gen p mean: -0.053816039115190506, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.052716609090566635, mean p set: 0.44879910349845886
loss_pred:0.038504984229803085, decouple_loss:0.01849491521716118
loss_pred:0.038726311177015305, decouple_loss:0.018139561638236046
loss_pred:0.0387503020465374, decouple_loss:0.017873063683509827
WV_0_PC_1_EH_0_PS_40, loss: 0.03956899046897888, avg_mse: 0.04472336545586586
current test mse: 0.044723
Iteration: 491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760698080062866, gen p mean: -0.055779121816158295, mean p set: 0.448087215423584
loss_pred:0.032042209059000015, decouple_loss:0.01838148571550846
The modified gen p mean: 0.4461551308631897, gen p mean: -0.055818285793066025, mean p set: 0.4466353952884674
The modified gen p mean: 0.44727686047554016, gen p mean: -0.05549660325050354, mean p set: 0.44775715470314026
loss_pred:0.0334467887878418, decouple_loss:0.01815897971391678
loss_pred:0.032110877335071564, decouple_loss:0.018683036789298058
Iteration: 492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493890404701233, gen p mean: -0.05117829144001007, mean p set: 0.449869304895401
loss_pred:0.034326985478401184, decouple_loss:0.018836023285984993
The modified gen p mean: 0.4476727545261383, gen p mean: -0.0550626665353775, mean p set: 0.4481530487537384
The modified gen p mean: 0.4474327862262726, gen p mean: -0.050452183932065964, mean p set: 0.4479130506515503
loss_pred:0.03181080147624016, decouple_loss:0.020324699580669403
loss_pred:0.03252056986093521, decouple_loss:0.01901693269610405
Iteration: 493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471665024757385, gen p mean: -0.051258474588394165, mean p set: 0.447646826505661
loss_pred:0.03465073183178902, decouple_loss:0.017480123788118362
The modified gen p mean: 0.44697925448417664, gen p mean: -0.05182749032974243, mean p set: 0.44745954871177673
The modified gen p mean: 0.4468348026275635, gen p mean: -0.052448105067014694, mean p set: 0.4473150670528412
loss_pred:0.03359150514006615, decouple_loss:0.016919881105422974
loss_pred:0.032743316143751144, decouple_loss:0.01738608628511429
Iteration: 494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475298225879669, gen p mean: -0.0512491874396801, mean p set: 0.44801008701324463
loss_pred:0.03193577751517296, decouple_loss:0.018496310338377953
The modified gen p mean: 0.44713956117630005, gen p mean: -0.051749467849731445, mean p set: 0.44761988520622253
The modified gen p mean: 0.44930770993232727, gen p mean: -0.050417106598615646, mean p set: 0.449787974357605
loss_pred:0.03280987963080406, decouple_loss:0.018132487311959267
loss_pred:0.032243914902210236, decouple_loss:0.018220417201519012
Iteration: 495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448018342256546, gen p mean: -0.05591575801372528, mean p set: 0.4484986364841461
loss_pred:0.03244864568114281, decouple_loss:0.01779106818139553
The modified gen p mean: 0.44854751229286194, gen p mean: -0.050502609461545944, mean p set: 0.44902777671813965
loss_pred:0.03382023796439171, decouple_loss:0.01848398521542549
The modified gen p mean: 0.4483940899372101, gen p mean: -0.051908135414123535, mean p set: 0.44887441396713257
loss_pred:0.03322885185480118, decouple_loss:0.017278321087360382
Iteration: 496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719722867012024, gen p mean: -0.05878542736172676, mean p set: 0.44767752289772034
loss_pred:0.03277796506881714, decouple_loss:0.01708654686808586
The modified gen p mean: 0.4469814896583557, gen p mean: -0.057550352066755295, mean p set: 0.4474617540836334The modified gen p mean: 0.44773584604263306, gen p mean: -0.05843645706772804, mean p set: 0.44821611046791077
loss_pred:0.03256170079112053, decouple_loss:0.0174398235976696
loss_pred:0.03341376781463623, decouple_loss:0.01847635582089424
Iteration: 497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476143717765808, gen p mean: -0.059952039271593094, mean p set: 0.4480946362018585
loss_pred:0.033232200890779495, decouple_loss:0.015963982790708542
The modified gen p mean: 0.4483204185962677, gen p mean: -0.057454802095890045, mean p set: 0.4488007128238678
The modified gen p mean: 0.44982993602752686, gen p mean: -0.057482846081256866, mean p set: 0.45031026005744934
loss_pred:0.033147022128105164, decouple_loss:0.01639924757182598
loss_pred:0.03385677561163902, decouple_loss:0.016714410856366158
Iteration: 498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44692885875701904, gen p mean: -0.06716181337833405, mean p set: 0.44740915298461914
loss_pred:0.03263217583298683, decouple_loss:0.016097377985715866
The modified gen p mean: 0.447794646024704, gen p mean: -0.061696700751781464, mean p set: 0.44827497005462646
The modified gen p mean: 0.44760459661483765, gen p mean: -0.06573711335659027, mean p set: 0.44808489084243774loss_pred:0.032956186681985855, decouple_loss:0.01685870811343193
loss_pred:0.032285600900650024, decouple_loss:0.01604752242565155
Iteration: 499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44679683446884155, gen p mean: -0.06736306846141815, mean p set: 0.44727712869644165
loss_pred:0.03230335935950279, decouple_loss:0.01540227048099041
The modified gen p mean: 0.44909846782684326, gen p mean: -0.06524796783924103, mean p set: 0.44957879185676575
The modified gen p mean: 0.4474140405654907, gen p mean: -0.06142266094684601, mean p set: 0.44789430499076843
loss_pred:0.032435569912195206, decouple_loss:0.015328007750213146
loss_pred:0.032300129532814026, decouple_loss:0.016864897683262825
Iteration: 500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44852012395858765, gen p mean: -0.061845649033784866, mean p set: 0.44900041818618774
loss_pred:0.031196536496281624, decouple_loss:0.015266899950802326
The modified gen p mean: 0.44727858901023865, gen p mean: -0.06358829885721207, mean p set: 0.44775891304016113
The modified gen p mean: 0.4487951695919037, gen p mean: -0.05747973918914795, mean p set: 0.4492754638195038
loss_pred:0.032493047416210175, decouple_loss:0.016704699024558067
loss_pred:0.034872133284807205, decouple_loss:0.015930458903312683
2023-04-19 02:24:06 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.05864505469799042, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.05830873176455498, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.057101596146821976, mean p set: 0.44879910349845886
loss_pred:0.038171615451574326, decouple_loss:0.015731029212474823
loss_pred:0.03851419687271118, decouple_loss:0.015537204220890999
loss_pred:0.03893040865659714, decouple_loss:0.0155847929418087
WV_0_PC_1_EH_0_PS_40, loss: 0.03931962698698044, avg_mse: 0.04470350593328476
current test mse: 0.044704
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481538236141205, gen p mean: -0.05771921947598457, mean p set: 0.44863414764404297
loss_pred:0.03335016593337059, decouple_loss:0.017466435208916664
The modified gen p mean: 0.44889628887176514, gen p mean: -0.05787527561187744, mean p set: 0.4493766129016876
loss_pred:0.03473217785358429, decouple_loss:0.018580134958028793
The modified gen p mean: 0.44661128520965576, gen p mean: -0.05788477882742882, mean p set: 0.44709157943725586
loss_pred:0.033437054604291916, decouple_loss:0.0169108584523201
Iteration: 502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876593351364136, gen p mean: -0.0608617439866066, mean p set: 0.44924619793891907
The modified gen p mean: 0.44738543033599854, gen p mean: -0.06378781795501709, mean p set: 0.44786572456359863loss_pred:0.03494667261838913, decouple_loss:0.017393456771969795
The modified gen p mean: 0.44693154096603394, gen p mean: -0.06475555896759033, mean p set: 0.44741183519363403
loss_pred:0.031958818435668945, decouple_loss:0.01769961230456829
loss_pred:0.03198689594864845, decouple_loss:0.016933809965848923
Iteration: 503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449720174074173, gen p mean: -0.06224645674228668, mean p set: 0.45020049810409546
loss_pred:0.03398115932941437, decouple_loss:0.01783563382923603
The modified gen p mean: 0.4483198821544647, gen p mean: -0.06639701873064041, mean p set: 0.44880014657974243
The modified gen p mean: 0.44693100452423096, gen p mean: -0.06548794358968735, mean p set: 0.44741132855415344
loss_pred:0.03286849334836006, decouple_loss:0.01673378050327301
loss_pred:0.032944194972515106, decouple_loss:0.02220137231051922
Iteration: 504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793716073036194, gen p mean: -0.05344248563051224, mean p set: 0.44841745495796204
loss_pred:0.03216240555047989, decouple_loss:0.018803665414452553
The modified gen p mean: 0.4472804069519043, gen p mean: -0.052419766783714294, mean p set: 0.447760671377182
The modified gen p mean: 0.44601893424987793, gen p mean: -0.0536196231842041, mean p set: 0.4464992880821228
loss_pred:0.03373764082789421, decouple_loss:0.017308026552200317
loss_pred:0.03452104702591896, decouple_loss:0.01840503141283989
Iteration: 505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464573562145233, gen p mean: -0.04726726934313774, mean p set: 0.4469376802444458
loss_pred:0.03288985788822174, decouple_loss:0.018244512379169464
The modified gen p mean: 0.4482777714729309, gen p mean: -0.04947087913751602, mean p set: 0.4487580358982086
The modified gen p mean: 0.4501919448375702, gen p mean: -0.04957696050405502, mean p set: 0.4506722390651703
loss_pred:0.03414035961031914, decouple_loss:0.018346911296248436
loss_pred:0.03305288404226303, decouple_loss:0.02008962072432041
Iteration: 506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472601115703583, gen p mean: -0.05150458961725235, mean p set: 0.4477404057979584
loss_pred:0.032521601766347885, decouple_loss:0.018667209893465042
The modified gen p mean: 0.4500364661216736, gen p mean: -0.04775603488087654, mean p set: 0.4505167305469513The modified gen p mean: 0.4492303431034088, gen p mean: -0.052534069865942, mean p set: 0.4497106075286865
loss_pred:0.034222349524497986, decouple_loss:0.01693396084010601
loss_pred:0.033971864730119705, decouple_loss:0.017520487308502197
Iteration: 507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488517940044403, gen p mean: -0.05437757819890976, mean p set: 0.4493320882320404
The modified gen p mean: 0.4491988718509674, gen p mean: -0.05448814481496811, mean p set: 0.4496791362762451
The modified gen p mean: 0.44900283217430115, gen p mean: -0.04965737462043762, mean p set: 0.44948315620422363
loss_pred:0.03451124578714371, decouple_loss:0.020200690254569054
loss_pred:0.03479814529418945, decouple_loss:0.018974224105477333
loss_pred:0.03413984179496765, decouple_loss:0.01828121766448021
Iteration: 508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790494441986084, gen p mean: -0.04059974104166031, mean p set: 0.44838523864746094
loss_pred:0.03353731706738472, decouple_loss:0.019934365525841713
The modified gen p mean: 0.4491006135940552, gen p mean: -0.04305105283856392, mean p set: 0.4495809078216553
The modified gen p mean: 0.44871610403060913, gen p mean: -0.046090636402368546, mean p set: 0.4491964280605316
loss_pred:0.033192262053489685, decouple_loss:0.019305048510432243
loss_pred:0.032438695430755615, decouple_loss:0.01880723051726818
Iteration: 509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44830477237701416, gen p mean: -0.04114258661866188, mean p set: 0.44878509640693665
loss_pred:0.0337129645049572, decouple_loss:0.020288163796067238
The modified gen p mean: 0.4473118782043457, gen p mean: -0.042757797986269, mean p set: 0.4477921724319458
The modified gen p mean: 0.44937461614608765, gen p mean: -0.038425471633672714, mean p set: 0.44985491037368774
loss_pred:0.0327218659222126, decouple_loss:0.01927383802831173
loss_pred:0.0342748686671257, decouple_loss:0.01665348932147026
Iteration: 510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488295018672943, gen p mean: -0.05044297128915787, mean p set: 0.4493098258972168
loss_pred:0.032100286334753036, decouple_loss:0.023236360400915146
The modified gen p mean: 0.4488774538040161, gen p mean: -0.05010184273123741, mean p set: 0.4493577182292938
The modified gen p mean: 0.44858017563819885, gen p mean: -0.044408075511455536, mean p set: 0.44906049966812134
loss_pred:0.03304756432771683, decouple_loss:0.02265828661620617
loss_pred:0.03376012295484543, decouple_loss:0.02217363566160202
2023-04-19 02:26:40 testing...
The modified gen p mean: 0.44943100214004517, gen p mean: -0.045924048870801926, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.04564792290329933, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.04441198334097862, mean p set: 0.44879910349845886
loss_pred:0.03954260051250458, decouple_loss:0.01872055046260357
loss_pred:0.03953059762716293, decouple_loss:0.018314775079488754
loss_pred:0.040104079991579056, decouple_loss:0.018418552353978157
WV_0_PC_1_EH_0_PS_40, loss: 0.04064999148249626, avg_mse: 0.047022297978401184
current test mse: 0.047022
Iteration: 511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701385498046875, gen p mean: -0.044887881726026535, mean p set: 0.44749414920806885
The modified gen p mean: 0.4461825489997864, gen p mean: -0.04127461090683937, mean p set: 0.4466628134250641
loss_pred:0.03714641556143761, decouple_loss:0.019253898411989212
loss_pred:0.03272391855716705, decouple_loss:0.018023641780018806
The modified gen p mean: 0.4479438364505768, gen p mean: -0.0430072620511055, mean p set: 0.44842419028282166
loss_pred:0.03188636526465416, decouple_loss:0.01903737336397171
Iteration: 512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44705820083618164, gen p mean: -0.0365213006734848, mean p set: 0.44753846526145935
loss_pred:0.03520292416214943, decouple_loss:0.019884495064616203
The modified gen p mean: 0.4474874436855316, gen p mean: -0.03880112245678902, mean p set: 0.4479677379131317
loss_pred:0.032498229295015335, decouple_loss:0.02047601342201233
The modified gen p mean: 0.4468691051006317, gen p mean: -0.03705821931362152, mean p set: 0.4473493695259094
loss_pred:0.032986052334308624, decouple_loss:0.020201897248625755
Iteration: 513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750961661338806, gen p mean: -0.04163900390267372, mean p set: 0.44798991084098816
loss_pred:0.03224834054708481, decouple_loss:0.01782972924411297
The modified gen p mean: 0.4476604163646698, gen p mean: -0.041529640555381775, mean p set: 0.4481406807899475
loss_pred:0.03415414318442345, decouple_loss:0.01935119740664959
The modified gen p mean: 0.4478943645954132, gen p mean: -0.039776548743247986, mean p set: 0.4483746588230133
loss_pred:0.03260527551174164, decouple_loss:0.018588557839393616
Iteration: 514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783085584640503, gen p mean: -0.04154696315526962, mean p set: 0.4483111500740051
loss_pred:0.034240588545799255, decouple_loss:0.02067406103014946
The modified gen p mean: 0.44775640964508057, gen p mean: -0.0459742397069931, mean p set: 0.44823670387268066
loss_pred:0.03316926583647728, decouple_loss:0.020514288917183876
The modified gen p mean: 0.4487685561180115, gen p mean: -0.04901470988988876, mean p set: 0.44924888014793396
loss_pred:0.03574351966381073, decouple_loss:0.019128141924738884
Iteration: 515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482327103614807, gen p mean: -0.0496329627931118, mean p set: 0.4487130343914032
loss_pred:0.03251568600535393, decouple_loss:0.021084876731038094
The modified gen p mean: 0.4480293095111847, gen p mean: -0.0456087626516819, mean p set: 0.4485096037387848
The modified gen p mean: 0.4471632242202759, gen p mean: -0.04482758790254593, mean p set: 0.4476434886455536
loss_pred:0.03487102687358856, decouple_loss:0.023305781185626984
loss_pred:0.034300465136766434, decouple_loss:0.018677398562431335
Iteration: 516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473694860935211, gen p mean: -0.04643290862441063, mean p set: 0.44784975051879883
loss_pred:0.0325331948697567, decouple_loss:0.019004588946700096
The modified gen p mean: 0.4474087059497833, gen p mean: -0.04651045799255371, mean p set: 0.4478890001773834
The modified gen p mean: 0.4484160840511322, gen p mean: -0.04597814008593559, mean p set: 0.4488963484764099
loss_pred:0.03288787230849266, decouple_loss:0.018421979621052742
loss_pred:0.034424737095832825, decouple_loss:0.01994585432112217
Iteration: 517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464013874530792, gen p mean: -0.054191771894693375, mean p set: 0.4468816816806793
loss_pred:0.035468026995658875, decouple_loss:0.02095099352300167
The modified gen p mean: 0.4476581811904907, gen p mean: -0.050698135048151016, mean p set: 0.4481384754180908
The modified gen p mean: 0.4482394754886627, gen p mean: -0.051703523844480515, mean p set: 0.4487197697162628
loss_pred:0.032646141946315765, decouple_loss:0.01740601658821106
loss_pred:0.034161899238824844, decouple_loss:0.022904908284544945
Iteration: 518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447195440530777, gen p mean: -0.05089230090379715, mean p set: 0.4476757347583771
loss_pred:0.031334009021520615, decouple_loss:0.01809050142765045
The modified gen p mean: 0.4493301808834076, gen p mean: -0.047739747911691666, mean p set: 0.4498105049133301
The modified gen p mean: 0.4473456144332886, gen p mean: -0.04533327743411064, mean p set: 0.44782590866088867
loss_pred:0.03366861864924431, decouple_loss:0.018937457352876663
loss_pred:0.034151993691921234, decouple_loss:0.017591480165719986
Iteration: 519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44921791553497314, gen p mean: -0.04816595837473869, mean p set: 0.44969815015792847
loss_pred:0.03461563587188721, decouple_loss:0.0171346515417099
The modified gen p mean: 0.4481850862503052, gen p mean: -0.04852226376533508, mean p set: 0.44866541028022766
The modified gen p mean: 0.4492894113063812, gen p mean: -0.04963492602109909, mean p set: 0.44976967573165894
loss_pred:0.03401762247085571, decouple_loss:0.01706533506512642
loss_pred:0.03305697441101074, decouple_loss:0.01771688461303711
Iteration: 520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44704604148864746, gen p mean: -0.05953646078705788, mean p set: 0.44752633571624756
loss_pred:0.031872887164354324, decouple_loss:0.016430111601948738
The modified gen p mean: 0.4485984742641449, gen p mean: -0.05762508884072304, mean p set: 0.449078768491745
The modified gen p mean: 0.44902482628822327, gen p mean: -0.055598147213459015, mean p set: 0.44950512051582336loss_pred:0.033481501042842865, decouple_loss:0.016334770247340202
loss_pred:0.03358299285173416, decouple_loss:0.016657838597893715
2023-04-19 02:28:33 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.059639375656843185, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.059601522982120514, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.058867473155260086, mean p set: 0.44879910349845886
loss_pred:0.038905464112758636, decouple_loss:0.019278673455119133
loss_pred:0.039096564054489136, decouple_loss:0.019587820395827293
loss_pred:0.039235919713974, decouple_loss:0.01917487196624279
WV_0_PC_1_EH_0_PS_40, loss: 0.04004667326807976, avg_mse: 0.04585191607475281
current test mse: 0.045852
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477216899394989, gen p mean: -0.0622447170317173, mean p set: 0.448201984167099
loss_pred:0.03128105401992798, decouple_loss:0.019649730995297432
The modified gen p mean: 0.4479043781757355, gen p mean: -0.0617167204618454, mean p set: 0.44838467240333557
The modified gen p mean: 0.44811609387397766, gen p mean: -0.06129723787307739, mean p set: 0.44859638810157776
loss_pred:0.03153306618332863, decouple_loss:0.01981293596327305
loss_pred:0.033628568053245544, decouple_loss:0.020261475816369057
Iteration: 522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483286142349243, gen p mean: -0.05729326605796814, mean p set: 0.4488089084625244
loss_pred:0.033764440566301346, decouple_loss:0.022562816739082336
The modified gen p mean: 0.4476363956928253, gen p mean: -0.060647521167993546, mean p set: 0.4481166899204254
loss_pred:0.03548574820160866, decouple_loss:0.02257908508181572
The modified gen p mean: 0.44791799783706665, gen p mean: -0.0584954172372818, mean p set: 0.44839832186698914
loss_pred:0.03365792706608772, decouple_loss:0.02381862886250019
Iteration: 523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481147229671478, gen p mean: -0.05830030143260956, mean p set: 0.4485950171947479
The modified gen p mean: 0.44811341166496277, gen p mean: -0.054301027208566666, mean p set: 0.44859370589256287
loss_pred:0.03359704464673996, decouple_loss:0.01940700225532055
loss_pred:0.033434636890888214, decouple_loss:0.017926042899489403
The modified gen p mean: 0.44799932837486267, gen p mean: -0.05854382738471031, mean p set: 0.44847962260246277
loss_pred:0.03678851202130318, decouple_loss:0.01896987296640873
Iteration: 524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478529691696167, gen p mean: -0.05559450387954712, mean p set: 0.4483332633972168The modified gen p mean: 0.44811734557151794, gen p mean: -0.05723586678504944, mean p set: 0.44859760999679565
loss_pred:0.03217931464314461, decouple_loss:0.01881972886621952
loss_pred:0.034818973392248154, decouple_loss:0.019097324460744858
The modified gen p mean: 0.4480019211769104, gen p mean: -0.05667354539036751, mean p set: 0.4484822154045105
loss_pred:0.03331888094544411, decouple_loss:0.01910972222685814
Iteration: 525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778382778167725, gen p mean: -0.060478173196315765, mean p set: 0.44826412200927734
The modified gen p mean: 0.44795531034469604, gen p mean: -0.06481023132801056, mean p set: 0.44843557476997375
loss_pred:0.03219353407621384, decouple_loss:0.020382659509778023
loss_pred:0.03257860988378525, decouple_loss:0.01915057562291622
The modified gen p mean: 0.44878119230270386, gen p mean: -0.06525202095508575, mean p set: 0.44926151633262634
loss_pred:0.03270791471004486, decouple_loss:0.021063577383756638
Iteration: 526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476151466369629, gen p mean: -0.06902462989091873, mean p set: 0.448095440864563
The modified gen p mean: 0.447795033454895, gen p mean: -0.06991200894117355, mean p set: 0.4482753276824951
loss_pred:0.03252363204956055, decouple_loss:0.017501579597592354
loss_pred:0.034587692469358444, decouple_loss:0.017768124118447304
The modified gen p mean: 0.44741690158843994, gen p mean: -0.06464820355176926, mean p set: 0.44789719581604004
loss_pred:0.03367210179567337, decouple_loss:0.01774611882865429
Iteration: 527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482262134552002, gen p mean: -0.05719221755862236, mean p set: 0.4487065374851227
loss_pred:0.03150944784283638, decouple_loss:0.021460628136992455
The modified gen p mean: 0.4477713406085968, gen p mean: -0.06357274949550629, mean p set: 0.4482516348361969
loss_pred:0.03340566158294678, decouple_loss:0.02110466919839382
The modified gen p mean: 0.44754910469055176, gen p mean: -0.06542784720659256, mean p set: 0.44802939891815186
loss_pred:0.032717060297727585, decouple_loss:0.023828495293855667
Iteration: 528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483509063720703, gen p mean: -0.05850980058312416, mean p set: 0.4488312005996704
loss_pred:0.030802298337221146, decouple_loss:0.01757500134408474
The modified gen p mean: 0.44744616746902466, gen p mean: -0.05752858519554138, mean p set: 0.44792643189430237
The modified gen p mean: 0.44780224561691284, gen p mean: -0.06109984219074249, mean p set: 0.44828253984451294
loss_pred:0.033450450748205185, decouple_loss:0.01674344576895237
loss_pred:0.03233947604894638, decouple_loss:0.016402404755353928
Iteration: 529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448762446641922, gen p mean: -0.059561777859926224, mean p set: 0.4492427408695221
loss_pred:0.03221632167696953, decouple_loss:0.01972738280892372
The modified gen p mean: 0.447199285030365, gen p mean: -0.06528185307979584, mean p set: 0.4476796090602875
loss_pred:0.03231160342693329, decouple_loss:0.019146820530295372
The modified gen p mean: 0.44794991612434387, gen p mean: -0.059004224836826324, mean p set: 0.44843021035194397
loss_pred:0.032774120569229126, decouple_loss:0.02194053679704666
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475034475326538, gen p mean: -0.06786751002073288, mean p set: 0.4479837417602539
loss_pred:0.03262082859873772, decouple_loss:0.017580024898052216
The modified gen p mean: 0.44806361198425293, gen p mean: -0.06474950909614563, mean p set: 0.44854387640953064
loss_pred:0.03275545313954353, decouple_loss:0.0170864537358284
The modified gen p mean: 0.44880369305610657, gen p mean: -0.06387315690517426, mean p set: 0.44928398728370667
loss_pred:0.03390267491340637, decouple_loss:0.01706472598016262
2023-04-19 02:31:15 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.0678793340921402, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.06782945245504379, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.0667133554816246, mean p set: 0.44879910349845886
loss_pred:0.039416901767253876, decouple_loss:0.019541971385478973
loss_pred:0.039619818329811096, decouple_loss:0.020300623029470444
loss_pred:0.03980123624205589, decouple_loss:0.02010994218289852
WV_0_PC_1_EH_0_PS_40, loss: 0.040611863136291504, avg_mse: 0.04710822179913521
current test mse: 0.047108
Iteration: 531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478335976600647, gen p mean: -0.06329962611198425, mean p set: 0.4483139216899872
loss_pred:0.03200362250208855, decouple_loss:0.01854792609810829
The modified gen p mean: 0.448133647441864, gen p mean: -0.06761988252401352, mean p set: 0.4486139416694641
loss_pred:0.03219223394989967, decouple_loss:0.02021530084311962
The modified gen p mean: 0.4475157856941223, gen p mean: -0.06513270735740662, mean p set: 0.4479960799217224
loss_pred:0.03216148167848587, decouple_loss:0.019952040165662766
Iteration: 532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841691851615906, gen p mean: -0.058543235063552856, mean p set: 0.44889721274375916
loss_pred:0.0318838395178318, decouple_loss:0.01846558414399624
The modified gen p mean: 0.4486851990222931, gen p mean: -0.06081695482134819, mean p set: 0.4491655230522156
The modified gen p mean: 0.4472784698009491, gen p mean: -0.0625542476773262, mean p set: 0.4477587640285492
loss_pred:0.03158793970942497, decouple_loss:0.016744481399655342
loss_pred:0.03120369091629982, decouple_loss:0.016316497698426247
Iteration: 533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771313667297363, gen p mean: -0.05863829702138901, mean p set: 0.44819343090057373
The modified gen p mean: 0.4478616714477539, gen p mean: -0.062149036675691605, mean p set: 0.448341965675354
loss_pred:0.0320177860558033, decouple_loss:0.01647782139480114
loss_pred:0.032669223845005035, decouple_loss:0.016054075211286545
The modified gen p mean: 0.44799745082855225, gen p mean: -0.060464635491371155, mean p set: 0.44847777485847473
loss_pred:0.032613612711429596, decouple_loss:0.01629842072725296
Iteration: 534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491630792617798, gen p mean: -0.06083420291543007, mean p set: 0.4496433436870575
The modified gen p mean: 0.44771623611450195, gen p mean: -0.06302615255117416, mean p set: 0.44819650053977966
loss_pred:0.032399728894233704, decouple_loss:0.017295513302087784
loss_pred:0.03142557665705681, decouple_loss:0.015679506585001945
The modified gen p mean: 0.4471258223056793, gen p mean: -0.06319994479417801, mean p set: 0.4476061165332794
loss_pred:0.03317676857113838, decouple_loss:0.017315125092864037
Iteration: 535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798147678375244, gen p mean: -0.053762342780828476, mean p set: 0.44846177101135254
The modified gen p mean: 0.44780266284942627, gen p mean: -0.05407099425792694, mean p set: 0.44828298687934875
loss_pred:0.03210556507110596, decouple_loss:0.016793249174952507
loss_pred:0.03381521254777908, decouple_loss:0.015430666506290436
The modified gen p mean: 0.4484484791755676, gen p mean: -0.055083807557821274, mean p set: 0.44892874360084534
loss_pred:0.031865935772657394, decouple_loss:0.01583225652575493
Iteration: 536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480687975883484, gen p mean: -0.05545568838715553, mean p set: 0.4485490918159485
The modified gen p mean: 0.44787734746932983, gen p mean: -0.056074708700180054, mean p set: 0.4483576714992523
loss_pred:0.033352792263031006, decouple_loss:0.014736562967300415
The modified gen p mean: 0.44790560007095337, gen p mean: -0.05614415928721428, mean p set: 0.44838589429855347
loss_pred:0.0324193611741066, decouple_loss:0.015120734460651875
loss_pred:0.031156854704022408, decouple_loss:0.01505338679999113
Iteration: 537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728928804397583, gen p mean: -0.06329051405191422, mean p set: 0.44776955246925354
The modified gen p mean: 0.4484274089336395, gen p mean: -0.0669657438993454, mean p set: 0.4489077031612396loss_pred:0.03109283372759819, decouple_loss:0.015684379264712334
loss_pred:0.031056450679898262, decouple_loss:0.015005899593234062
The modified gen p mean: 0.4475390315055847, gen p mean: -0.05965966358780861, mean p set: 0.4480193257331848
loss_pred:0.03186443820595741, decouple_loss:0.015725184231996536
Iteration: 538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749870896339417, gen p mean: -0.06648100167512894, mean p set: 0.44797900319099426
The modified gen p mean: 0.44806525111198425, gen p mean: -0.06670206785202026, mean p set: 0.44854554533958435
loss_pred:0.032260678708553314, decouple_loss:0.015012413263320923
loss_pred:0.02964537777006626, decouple_loss:0.016564110293984413
The modified gen p mean: 0.44788503646850586, gen p mean: -0.06885518878698349, mean p set: 0.44836533069610596
loss_pred:0.03256896510720253, decouple_loss:0.015497313812375069
Iteration: 539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762691855430603, gen p mean: -0.06682581454515457, mean p set: 0.44810721278190613
The modified gen p mean: 0.44751855731010437, gen p mean: -0.06291958689689636, mean p set: 0.44799885153770447
loss_pred:0.031207343563437462, decouple_loss:0.016484081745147705
loss_pred:0.031686101108789444, decouple_loss:0.014785644598305225
The modified gen p mean: 0.4474197328090668, gen p mean: -0.06518390774726868, mean p set: 0.4478999972343445
loss_pred:0.03195462375879288, decouple_loss:0.015003855340182781
Iteration: 540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481903612613678, gen p mean: -0.0632917582988739, mean p set: 0.4486706554889679
The modified gen p mean: 0.44773542881011963, gen p mean: -0.06573875993490219, mean p set: 0.4482157230377197
loss_pred:0.03146136924624443, decouple_loss:0.014754406176507473
loss_pred:0.03176654502749443, decouple_loss:0.013917800970375538
The modified gen p mean: 0.4482947587966919, gen p mean: -0.06611967831850052, mean p set: 0.448775053024292
loss_pred:0.03359797224402428, decouple_loss:0.01470242626965046
2023-04-19 02:33:08 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.06710100173950195, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.06695698201656342, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.0655393972992897, mean p set: 0.44879910349845886
loss_pred:0.03766024112701416, decouple_loss:0.01670192927122116
loss_pred:0.037274230271577835, decouple_loss:0.015611057169735432
loss_pred:0.03797387704253197, decouple_loss:0.0152633897960186
WV_0_PC_1_EH_0_PS_40, loss: 0.03842905908823013, avg_mse: 0.043607670813798904
current test mse: 0.043608
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472956657409668, gen p mean: -0.06565447896718979, mean p set: 0.4477759599685669
loss_pred:0.03347700089216232, decouple_loss:0.014456640928983688
The modified gen p mean: 0.4482475817203522, gen p mean: -0.06393621116876602, mean p set: 0.44872787594795227
loss_pred:0.03382769599556923, decouple_loss:0.016864491626620293
The modified gen p mean: 0.4467913806438446, gen p mean: -0.06634090840816498, mean p set: 0.4472716748714447
loss_pred:0.03283635899424553, decouple_loss:0.014578687027096748
Iteration: 542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44703614711761475, gen p mean: -0.0568394735455513, mean p set: 0.44751641154289246
loss_pred:0.033349666744470596, decouple_loss:0.0153588205575943
The modified gen p mean: 0.447295606136322, gen p mean: -0.05533604696393013, mean p set: 0.4477759003639221
The modified gen p mean: 0.44755247235298157, gen p mean: -0.06090996041893959, mean p set: 0.4480327367782593
loss_pred:0.03483759984374046, decouple_loss:0.01775486208498478
loss_pred:0.03290648013353348, decouple_loss:0.01707945391535759
Iteration: 543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794782996177673, gen p mean: -0.05974452942609787, mean p set: 0.44842812418937683
The modified gen p mean: 0.447307288646698, gen p mean: -0.059735007584095, mean p set: 0.4477875828742981
loss_pred:0.03261125832796097, decouple_loss:0.016240624710917473
loss_pred:0.034174900501966476, decouple_loss:0.015718000009655952
The modified gen p mean: 0.44737738370895386, gen p mean: -0.06320826709270477, mean p set: 0.44785767793655396
loss_pred:0.034299127757549286, decouple_loss:0.01616888865828514
Iteration: 544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474721848964691, gen p mean: -0.05504519119858742, mean p set: 0.4479525089263916
The modified gen p mean: 0.44875603914260864, gen p mean: -0.05439847335219383, mean p set: 0.44923636317253113
The modified gen p mean: 0.44814738631248474, gen p mean: -0.05104576051235199, mean p set: 0.44862768054008484loss_pred:0.03336721658706665, decouple_loss:0.014592157676815987
loss_pred:0.03190363571047783, decouple_loss:0.015468749217689037
loss_pred:0.032774798572063446, decouple_loss:0.016156956553459167
Iteration: 545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466248154640198, gen p mean: -0.053331032395362854, mean p set: 0.4471050798892975
The modified gen p mean: 0.446856826543808, gen p mean: -0.05651645362377167, mean p set: 0.4473371207714081
The modified gen p mean: 0.44717469811439514, gen p mean: -0.058357469737529755, mean p set: 0.44765499234199524
loss_pred:0.032467037439346313, decouple_loss:0.015164108946919441
loss_pred:0.0307661984115839, decouple_loss:0.01562868058681488
loss_pred:0.033213939517736435, decouple_loss:0.015101490542292595
Iteration: 546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463751018047333, gen p mean: -0.061320606619119644, mean p set: 0.4468553960323334
loss_pred:0.032960496842861176, decouple_loss:0.01885480061173439
The modified gen p mean: 0.4465309977531433, gen p mean: -0.05564774200320244, mean p set: 0.4470112919807434
loss_pred:0.03161570429801941, decouple_loss:0.017418721690773964
The modified gen p mean: 0.44719362258911133, gen p mean: -0.05136562138795853, mean p set: 0.4476739168167114
loss_pred:0.03330926597118378, decouple_loss:0.0177056472748518
Iteration: 547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44695714116096497, gen p mean: -0.043195199221372604, mean p set: 0.44743743538856506
The modified gen p mean: 0.44660335779190063, gen p mean: -0.044458966702222824, mean p set: 0.44708362221717834
loss_pred:0.03282040357589722, decouple_loss:0.016448644921183586
The modified gen p mean: 0.44691500067710876, gen p mean: -0.045685410499572754, mean p set: 0.44739529490470886loss_pred:0.032313063740730286, decouple_loss:0.015384391881525517
loss_pred:0.031974297016859055, decouple_loss:0.015699824318289757
Iteration: 548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476989805698395, gen p mean: -0.04398571699857712, mean p set: 0.44817930459976196
loss_pred:0.032485540956258774, decouple_loss:0.01609410159289837
The modified gen p mean: 0.44609716534614563, gen p mean: -0.0449356809258461, mean p set: 0.4465774595737457
loss_pred:0.032894574105739594, decouple_loss:0.015662677586078644
The modified gen p mean: 0.4472036063671112, gen p mean: -0.04463261738419533, mean p set: 0.4476839005947113
loss_pred:0.03134685754776001, decouple_loss:0.015435304492712021
Iteration: 549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44665172696113586, gen p mean: -0.044667769223451614, mean p set: 0.44713205099105835
The modified gen p mean: 0.4473174512386322, gen p mean: -0.04595493525266647, mean p set: 0.4477977156639099
loss_pred:0.03180892765522003, decouple_loss:0.016632867977023125
loss_pred:0.03333715721964836, decouple_loss:0.01845594123005867
The modified gen p mean: 0.44784802198410034, gen p mean: -0.04684945195913315, mean p set: 0.44832831621170044
loss_pred:0.03181367367506027, decouple_loss:0.015835700556635857
Iteration: 550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715994596481323, gen p mean: -0.045358918607234955, mean p set: 0.44764021039009094
loss_pred:0.03286701813340187, decouple_loss:0.015018300153315067
The modified gen p mean: 0.4471668004989624, gen p mean: -0.04179580137133598, mean p set: 0.4476470947265625
The modified gen p mean: 0.4482124447822571, gen p mean: -0.04108043760061264, mean p set: 0.4486927390098572
loss_pred:0.033035922795534134, decouple_loss:0.016665207222104073
loss_pred:0.03245173394680023, decouple_loss:0.0158343855291605
2023-04-19 02:35:40 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.04689975455403328, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.04743027687072754, mean p set: 0.4498290419578552
The modified gen p mean: 0.44831880927085876, gen p mean: -0.046209465712308884, mean p set: 0.44879910349845886
loss_pred:0.037466272711753845, decouple_loss:0.01792236603796482
loss_pred:0.03773140534758568, decouple_loss:0.018596159294247627
loss_pred:0.03789889067411423, decouple_loss:0.01827499084174633
WV_0_PC_1_EH_0_PS_40, loss: 0.03861208260059357, avg_mse: 0.043889641761779785
current test mse: 0.04389
Iteration: 551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44640475511550903, gen p mean: -0.04415903612971306, mean p set: 0.44688504934310913
loss_pred:0.032116539776325226, decouple_loss:0.017318157479166985
The modified gen p mean: 0.44766607880592346, gen p mean: -0.040723998099565506, mean p set: 0.44814640283584595
The modified gen p mean: 0.44720712304115295, gen p mean: -0.040219746530056, mean p set: 0.44768741726875305
loss_pred:0.03199196979403496, decouple_loss:0.016753189265727997
loss_pred:0.031213246285915375, decouple_loss:0.015889741480350494
Iteration: 552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716647267341614, gen p mean: -0.0436859130859375, mean p set: 0.44764676690101624
loss_pred:0.031817879527807236, decouple_loss:0.015792185440659523
The modified gen p mean: 0.44614535570144653, gen p mean: -0.051201965659856796, mean p set: 0.44662564992904663
The modified gen p mean: 0.4460698366165161, gen p mean: -0.048204388469457626, mean p set: 0.4465501010417938
loss_pred:0.033164527267217636, decouple_loss:0.017944982275366783
loss_pred:0.032510798424482346, decouple_loss:0.017942799255251884
Iteration: 553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812074303627014, gen p mean: -0.04469815641641617, mean p set: 0.44860100746154785
loss_pred:0.032674238085746765, decouple_loss:0.014956888742744923
The modified gen p mean: 0.4466308355331421, gen p mean: -0.05114206299185753, mean p set: 0.4471111297607422
loss_pred:0.03248254582285881, decouple_loss:0.01572147011756897
The modified gen p mean: 0.448038786649704, gen p mean: -0.04963330179452896, mean p set: 0.4485190510749817
loss_pred:0.033429622650146484, decouple_loss:0.014806518331170082
Iteration: 554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44667771458625793, gen p mean: -0.04967623949050903, mean p set: 0.44715800881385803
loss_pred:0.03107091784477234, decouple_loss:0.014462053775787354
The modified gen p mean: 0.4467073082923889, gen p mean: -0.05379496514797211, mean p set: 0.4471876323223114
loss_pred:0.03331194072961807, decouple_loss:0.014809918589890003
The modified gen p mean: 0.4466235339641571, gen p mean: -0.052391938865184784, mean p set: 0.4471038579940796
loss_pred:0.03542977571487427, decouple_loss:0.015713758766651154
Iteration: 555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471932649612427, gen p mean: -0.05385280027985573, mean p set: 0.4476735293865204
loss_pred:0.03252154216170311, decouple_loss:0.016056202352046967
The modified gen p mean: 0.448147714138031, gen p mean: -0.05418631061911583, mean p set: 0.4486280083656311
loss_pred:0.03402091935276985, decouple_loss:0.01693154126405716
The modified gen p mean: 0.44684135913848877, gen p mean: -0.054805509746074677, mean p set: 0.44732168316841125
loss_pred:0.03178376331925392, decouple_loss:0.017201773822307587
Iteration: 556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753625988960266, gen p mean: -0.05655713751912117, mean p set: 0.44801655411720276
loss_pred:0.030854711309075356, decouple_loss:0.01810379885137081
The modified gen p mean: 0.4473952651023865, gen p mean: -0.058929529041051865, mean p set: 0.4478755593299866
loss_pred:0.03103034943342209, decouple_loss:0.020996760576963425
The modified gen p mean: 0.44840213656425476, gen p mean: -0.05392846837639809, mean p set: 0.44888240098953247
loss_pred:0.032556455582380295, decouple_loss:0.017548182979226112
Iteration: 557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469364583492279, gen p mean: -0.05453375354409218, mean p set: 0.447416752576828
loss_pred:0.0325460322201252, decouple_loss:0.016287220641970634
The modified gen p mean: 0.446953147649765, gen p mean: -0.05828762426972389, mean p set: 0.4474334716796875
loss_pred:0.03252151235938072, decouple_loss:0.015489581972360611
The modified gen p mean: 0.4470263123512268, gen p mean: -0.05649879574775696, mean p set: 0.4475066065788269
loss_pred:0.03020952083170414, decouple_loss:0.016263354569673538
Iteration: 558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669535756111145, gen p mean: -0.05510665476322174, mean p set: 0.44717565178871155
loss_pred:0.033039722591638565, decouple_loss:0.015358112752437592
The modified gen p mean: 0.4465223252773285, gen p mean: -0.05119272693991661, mean p set: 0.4470026195049286
loss_pred:0.03417474403977394, decouple_loss:0.015501562505960464
The modified gen p mean: 0.4478078782558441, gen p mean: -0.05544525012373924, mean p set: 0.4482881724834442
loss_pred:0.03260565921664238, decouple_loss:0.017111007124185562
Iteration: 559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482123553752899, gen p mean: -0.05203505977988243, mean p set: 0.44869264960289
loss_pred:0.03296588361263275, decouple_loss:0.015292947180569172
The modified gen p mean: 0.4472768306732178, gen p mean: -0.05128801614046097, mean p set: 0.4477570950984955
The modified gen p mean: 0.446893572807312, gen p mean: -0.059702061116695404, mean p set: 0.4473738372325897
loss_pred:0.032532334327697754, decouple_loss:0.01511118933558464
loss_pred:0.03065216727554798, decouple_loss:0.015883363783359528
Iteration: 560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44738903641700745, gen p mean: -0.04908298701047897, mean p set: 0.44786933064460754
loss_pred:0.0323735773563385, decouple_loss:0.016174526885151863
The modified gen p mean: 0.4474543333053589, gen p mean: -0.05467711761593819, mean p set: 0.447934627532959
The modified gen p mean: 0.44818082451820374, gen p mean: -0.05492158606648445, mean p set: 0.4486611485481262
loss_pred:0.0323287770152092, decouple_loss:0.015520645305514336
loss_pred:0.030909257009625435, decouple_loss:0.016053104773163795
2023-04-19 02:37:34 testing...
The modified gen p mean: 0.44943100214004517, gen p mean: -0.047163352370262146, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.0475793182849884, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.04670245572924614, mean p set: 0.44879910349845886
loss_pred:0.038525693118572235, decouple_loss:0.01627546176314354
loss_pred:0.03899766132235527, decouple_loss:0.015850475057959557
loss_pred:0.03906237706542015, decouple_loss:0.01575590670108795
WV_0_PC_1_EH_0_PS_40, loss: 0.03965994343161583, avg_mse: 0.04613754525780678
current test mse: 0.046138
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472866356372833, gen p mean: -0.04843878746032715, mean p set: 0.4477669298648834
loss_pred:0.03228699043393135, decouple_loss:0.015360882505774498
The modified gen p mean: 0.4468739926815033, gen p mean: -0.045210305601358414, mean p set: 0.4473542869091034
loss_pred:0.03234683722257614, decouple_loss:0.01487029530107975
The modified gen p mean: 0.4474269449710846, gen p mean: -0.04695473238825798, mean p set: 0.4479072690010071
loss_pred:0.033197127282619476, decouple_loss:0.015953892841935158
Iteration: 562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474744498729706, gen p mean: -0.04943375289440155, mean p set: 0.4479547441005707
The modified gen p mean: 0.4469078779220581, gen p mean: -0.05336591973900795, mean p set: 0.4473881721496582
loss_pred:0.030406814068555832, decouple_loss:0.015551891177892685
loss_pred:0.03246447816491127, decouple_loss:0.016554784029722214
The modified gen p mean: 0.4467921853065491, gen p mean: -0.049050942063331604, mean p set: 0.44727250933647156
loss_pred:0.031453635543584824, decouple_loss:0.015205907635390759
Iteration: 563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44838905334472656, gen p mean: -0.05606437101960182, mean p set: 0.44886934757232666
The modified gen p mean: 0.44597822427749634, gen p mean: -0.052325211465358734, mean p set: 0.44645851850509644
loss_pred:0.032488077878952026, decouple_loss:0.015229509212076664
loss_pred:0.033063795417547226, decouple_loss:0.01529751904308796The modified gen p mean: 0.4476260542869568, gen p mean: -0.05433598905801773, mean p set: 0.4481063485145569
loss_pred:0.03353805094957352, decouple_loss:0.014599807560443878
Iteration: 564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478985369205475, gen p mean: -0.052093733102083206, mean p set: 0.4483788311481476
The modified gen p mean: 0.44865262508392334, gen p mean: -0.04883348196744919, mean p set: 0.44913291931152344
The modified gen p mean: 0.4484599530696869, gen p mean: -0.05603422969579697, mean p set: 0.448940247297287
loss_pred:0.0326591432094574, decouple_loss:0.015092547051608562
loss_pred:0.03387841582298279, decouple_loss:0.016344694420695305
loss_pred:0.03290906921029091, decouple_loss:0.01466350071132183
Iteration: 565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477022588253021, gen p mean: -0.049537885934114456, mean p set: 0.4481825828552246
The modified gen p mean: 0.4478236734867096, gen p mean: -0.05183623358607292, mean p set: 0.4483039677143097
loss_pred:0.03331904858350754, decouple_loss:0.013918180949985981
The modified gen p mean: 0.44812050461769104, gen p mean: -0.04908912628889084, mean p set: 0.44860079884529114
loss_pred:0.029782384634017944, decouple_loss:0.014374496415257454
loss_pred:0.03341332823038101, decouple_loss:0.01471836119890213
Iteration: 566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448173850774765, gen p mean: -0.04653787612915039, mean p set: 0.4486541748046875
The modified gen p mean: 0.44730570912361145, gen p mean: -0.04892643913626671, mean p set: 0.44778600335121155
loss_pred:0.03343874588608742, decouple_loss:0.014740796759724617
loss_pred:0.03214022517204285, decouple_loss:0.016254520043730736
The modified gen p mean: 0.44790807366371155, gen p mean: -0.045850250869989395, mean p set: 0.44838836789131165
loss_pred:0.031942933797836304, decouple_loss:0.016420437023043633
Iteration: 567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472869336605072, gen p mean: -0.05009889602661133, mean p set: 0.4477671980857849
The modified gen p mean: 0.44732311367988586, gen p mean: -0.05103393271565437, mean p set: 0.44780340790748596The modified gen p mean: 0.44720256328582764, gen p mean: -0.05373864248394966, mean p set: 0.4476828873157501
loss_pred:0.03139656409621239, decouple_loss:0.015527463518083096
loss_pred:0.0320911630988121, decouple_loss:0.016398681327700615
loss_pred:0.03193118795752525, decouple_loss:0.01617787778377533
Iteration: 568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765475392341614, gen p mean: -0.05281023681163788, mean p set: 0.44813501834869385
The modified gen p mean: 0.448669970035553, gen p mean: -0.05282288417220116, mean p set: 0.4491502642631531
loss_pred:0.03254978358745575, decouple_loss:0.01506153866648674
The modified gen p mean: 0.447234183549881, gen p mean: -0.050973787903785706, mean p set: 0.4477144777774811
loss_pred:0.03338177874684334, decouple_loss:0.015612514689564705
loss_pred:0.03215571865439415, decouple_loss:0.015682276338338852
Iteration: 569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474908113479614, gen p mean: -0.05299801751971245, mean p set: 0.4479711353778839
The modified gen p mean: 0.44849735498428345, gen p mean: -0.052743636071681976, mean p set: 0.44897761940956116
loss_pred:0.031825847923755646, decouple_loss:0.014627712778747082
The modified gen p mean: 0.44812095165252686, gen p mean: -0.052949029952287674, mean p set: 0.44860121607780457
loss_pred:0.030351929366588593, decouple_loss:0.015185203403234482
loss_pred:0.030075376853346825, decouple_loss:0.015088299289345741
Iteration: 570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769424200057983, gen p mean: -0.057855360209941864, mean p set: 0.44817450642585754
loss_pred:0.03166966512799263, decouple_loss:0.014557929709553719
The modified gen p mean: 0.4474409520626068, gen p mean: -0.05789139121770859, mean p set: 0.4479212760925293
The modified gen p mean: 0.4477179944515228, gen p mean: -0.05485685169696808, mean p set: 0.4481982886791229
loss_pred:0.031017137691378593, decouple_loss:0.015285556204617023
loss_pred:0.032454077154397964, decouple_loss:0.015581728890538216
2023-04-19 02:40:04 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.06089000776410103, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.06082300841808319, mean p set: 0.4498290419578552
The modified gen p mean: 0.44831880927085876, gen p mean: -0.059650126844644547, mean p set: 0.44879910349845886
loss_pred:0.037519022822380066, decouple_loss:0.017490509897470474
loss_pred:0.037462204694747925, decouple_loss:0.017035091295838356
loss_pred:0.03787942975759506, decouple_loss:0.01641254499554634
WV_0_PC_1_EH_0_PS_40, loss: 0.03846919164061546, avg_mse: 0.043998464941978455
current test mse: 0.043998
Iteration: 571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477033317089081, gen p mean: -0.058987636119127274, mean p set: 0.4481835961341858
loss_pred:0.03171342611312866, decouple_loss:0.01571480557322502
The modified gen p mean: 0.4469599425792694, gen p mean: -0.06078217551112175, mean p set: 0.4474402070045471
loss_pred:0.032292623072862625, decouple_loss:0.015283842571079731
The modified gen p mean: 0.447037011384964, gen p mean: -0.06042782589793205, mean p set: 0.4475173056125641
loss_pred:0.031676940619945526, decouple_loss:0.01624392345547676
Iteration: 572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44889017939567566, gen p mean: -0.0565275102853775, mean p set: 0.44937047362327576
loss_pred:0.03401637449860573, decouple_loss:0.014905694872140884
The modified gen p mean: 0.44647812843322754, gen p mean: -0.057330477982759476, mean p set: 0.44695839285850525
The modified gen p mean: 0.4476092755794525, gen p mean: -0.05470933020114899, mean p set: 0.4480895698070526
loss_pred:0.03229909762740135, decouple_loss:0.013899466954171658
loss_pred:0.031536974012851715, decouple_loss:0.014085890725255013
Iteration: 573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446853905916214, gen p mean: -0.060017917305231094, mean p set: 0.4473342299461365
The modified gen p mean: 0.446382999420166, gen p mean: -0.05623561143875122, mean p set: 0.4468632936477661
loss_pred:0.031995922327041626, decouple_loss:0.017207585275173187
loss_pred:0.031034287065267563, decouple_loss:0.016691749915480614
The modified gen p mean: 0.44628408551216125, gen p mean: -0.05773445591330528, mean p set: 0.44676437973976135
loss_pred:0.03158668428659439, decouple_loss:0.016550907865166664
Iteration: 574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44803979992866516, gen p mean: -0.06276331841945648, mean p set: 0.44852009415626526
The modified gen p mean: 0.4456293284893036, gen p mean: -0.05671399459242821, mean p set: 0.4461096227169037
The modified gen p mean: 0.4469403624534607, gen p mean: -0.058824602514505386, mean p set: 0.4474206268787384
loss_pred:0.032383713871240616, decouple_loss:0.017191262915730476
loss_pred:0.03148948401212692, decouple_loss:0.01691020280122757
loss_pred:0.0316409133374691, decouple_loss:0.017915306612849236
Iteration: 575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477330446243286, gen p mean: -0.05920857563614845, mean p set: 0.4482133686542511
The modified gen p mean: 0.4465479552745819, gen p mean: -0.061706867069005966, mean p set: 0.4470282196998596
The modified gen p mean: 0.4475523829460144, gen p mean: -0.05677200108766556, mean p set: 0.4480327069759369
loss_pred:0.03254200145602226, decouple_loss:0.016897771507501602
loss_pred:0.03185947611927986, decouple_loss:0.018272466957569122
loss_pred:0.03210380673408508, decouple_loss:0.017011940479278564
Iteration: 576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486413598060608, gen p mean: -0.051701031625270844, mean p set: 0.4491216838359833
The modified gen p mean: 0.4477849304676056, gen p mean: -0.052280113101005554, mean p set: 0.4482652246952057
loss_pred:0.031655192375183105, decouple_loss:0.016350286081433296
The modified gen p mean: 0.44743579626083374, gen p mean: -0.05517876148223877, mean p set: 0.44791606068611145
loss_pred:0.03234775736927986, decouple_loss:0.016292091459035873
loss_pred:0.0322268046438694, decouple_loss:0.015445724129676819
Iteration: 577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480159282684326, gen p mean: -0.05093779414892197, mean p set: 0.4484962224960327
The modified gen p mean: 0.44752028584480286, gen p mean: -0.05343734472990036, mean p set: 0.44800058007240295
loss_pred:0.03266289830207825, decouple_loss:0.01624942012131214
loss_pred:0.03065352514386177, decouple_loss:0.016698438674211502
The modified gen p mean: 0.4467793107032776, gen p mean: -0.05236729606986046, mean p set: 0.4472596049308777
loss_pred:0.03205188363790512, decouple_loss:0.017030762508511543
Iteration: 578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478202760219574, gen p mean: -0.05819012597203255, mean p set: 0.4483005702495575
The modified gen p mean: 0.4470200538635254, gen p mean: -0.05861832946538925, mean p set: 0.4475003480911255
loss_pred:0.03220323473215103, decouple_loss:0.01784602366387844
loss_pred:0.03139001131057739, decouple_loss:0.02078000269830227
The modified gen p mean: 0.4471847116947174, gen p mean: -0.05957901105284691, mean p set: 0.4476650059223175
loss_pred:0.0322345569729805, decouple_loss:0.018888523802161217
Iteration: 579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741910696029663, gen p mean: -0.06277356296777725, mean p set: 0.44789940118789673
The modified gen p mean: 0.44869041442871094, gen p mean: -0.05839246138930321, mean p set: 0.44917070865631104
loss_pred:0.033245425671339035, decouple_loss:0.017193898558616638
The modified gen p mean: 0.44773608446121216, gen p mean: -0.06113012135028839, mean p set: 0.44821637868881226
loss_pred:0.032675594091415405, decouple_loss:0.017412034794688225
loss_pred:0.0317208357155323, decouple_loss:0.017247123643755913
Iteration: 580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44789817929267883, gen p mean: -0.06233718991279602, mean p set: 0.44837847352027893
loss_pred:0.031771183013916016, decouple_loss:0.015367989428341389
The modified gen p mean: 0.44876790046691895, gen p mean: -0.06385981291532516, mean p set: 0.44924822449684143
The modified gen p mean: 0.44814231991767883, gen p mean: -0.0640101507306099, mean p set: 0.44862261414527893
loss_pred:0.03322586044669151, decouple_loss:0.017048457637429237
loss_pred:0.030100176110863686, decouple_loss:0.015539359301328659
2023-04-19 02:41:58 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.07342766225337982, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.07263519614934921, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.07201674580574036, mean p set: 0.44879910349845886
loss_pred:0.04385410249233246, decouple_loss:0.01939365826547146
loss_pred:0.04388463497161865, decouple_loss:0.0197304617613554
loss_pred:0.044257741421461105, decouple_loss:0.0196955855935812
WV_0_PC_1_EH_0_PS_40, loss: 0.04497915506362915, avg_mse: 0.0564376525580883
current test mse: 0.056438
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44817665219306946, gen p mean: -0.06620868295431137, mean p set: 0.44865697622299194
loss_pred:0.03315069526433945, decouple_loss:0.01763404719531536
The modified gen p mean: 0.4480270743370056, gen p mean: -0.07131548225879669, mean p set: 0.4485073983669281
loss_pred:0.031129099428653717, decouple_loss:0.017284955829381943
The modified gen p mean: 0.4485163986682892, gen p mean: -0.06775759160518646, mean p set: 0.4489966928958893
loss_pred:0.031951308250427246, decouple_loss:0.01710798405110836
Iteration: 582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486527442932129, gen p mean: -0.0590265728533268, mean p set: 0.449133038520813
The modified gen p mean: 0.44745561480522156, gen p mean: -0.055833328515291214, mean p set: 0.44793590903282166
loss_pred:0.030626075342297554, decouple_loss:0.017761293798685074
loss_pred:0.030844463035464287, decouple_loss:0.017058253288269043
The modified gen p mean: 0.44711458683013916, gen p mean: -0.056155975908041, mean p set: 0.44759488105773926
loss_pred:0.031186606734991074, decouple_loss:0.01721668615937233
Iteration: 583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481242001056671, gen p mean: -0.050642114132642746, mean p set: 0.4486044645309448
loss_pred:0.03159191086888313, decouple_loss:0.01684713363647461
The modified gen p mean: 0.4493151009082794, gen p mean: -0.051680177450180054, mean p set: 0.4497953951358795
loss_pred:0.031065363436937332, decouple_loss:0.017930174246430397
The modified gen p mean: 0.4481548070907593, gen p mean: -0.05171220749616623, mean p set: 0.4486351013183594
loss_pred:0.031288959085941315, decouple_loss:0.01625714637339115
Iteration: 584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763848185539246, gen p mean: -0.05659576505422592, mean p set: 0.44811877608299255
loss_pred:0.030021732673048973, decouple_loss:0.020216738805174828
The modified gen p mean: 0.44715479016304016, gen p mean: -0.05657819285988808, mean p set: 0.44763508439064026
loss_pred:0.031945206224918365, decouple_loss:0.018623869866132736
The modified gen p mean: 0.4477725327014923, gen p mean: -0.0535663478076458, mean p set: 0.4482528567314148
loss_pred:0.02997616119682789, decouple_loss:0.0186579842120409
Iteration: 585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725483655929565, gen p mean: -0.05805417522788048, mean p set: 0.44773516058921814
loss_pred:0.03260738402605057, decouple_loss:0.017680153250694275
The modified gen p mean: 0.44755682349205017, gen p mean: -0.056806325912475586, mean p set: 0.44803711771965027
loss_pred:0.03150881826877594, decouple_loss:0.017016954720020294
The modified gen p mean: 0.44877690076828003, gen p mean: -0.0595226027071476, mean p set: 0.4492571949958801
loss_pred:0.03163529932498932, decouple_loss:0.017658527940511703
Iteration: 586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44857344031333923, gen p mean: -0.06001092866063118, mean p set: 0.44905373454093933
loss_pred:0.032365284860134125, decouple_loss:0.017105193808674812
The modified gen p mean: 0.446932315826416, gen p mean: -0.05915213003754616, mean p set: 0.4474125802516937
loss_pred:0.030651433393359184, decouple_loss:0.016704795882105827
The modified gen p mean: 0.4483889937400818, gen p mean: -0.06482142210006714, mean p set: 0.4488692879676819
loss_pred:0.03075014427304268, decouple_loss:0.018321260809898376
Iteration: 587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481460154056549, gen p mean: -0.06391710042953491, mean p set: 0.4486263692378998
loss_pred:0.031392961740493774, decouple_loss:0.020023461431264877
The modified gen p mean: 0.4479518532752991, gen p mean: -0.06841941177845001, mean p set: 0.44843214750289917
loss_pred:0.030624492093920708, decouple_loss:0.018917379900813103
The modified gen p mean: 0.447469562292099, gen p mean: -0.06299605220556259, mean p set: 0.4479498863220215
loss_pred:0.029801955446600914, decouple_loss:0.01858799159526825
Iteration: 588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822418689727783, gen p mean: -0.06717794388532639, mean p set: 0.4487045109272003
loss_pred:0.03187227249145508, decouple_loss:0.01687854900956154
The modified gen p mean: 0.4490264058113098, gen p mean: -0.06600835919380188, mean p set: 0.4495067000389099
loss_pred:0.03074292466044426, decouple_loss:0.017829127609729767
The modified gen p mean: 0.44812262058258057, gen p mean: -0.06875994801521301, mean p set: 0.44860297441482544
loss_pred:0.029727760702371597, decouple_loss:0.016580618917942047
Iteration: 589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485977590084076, gen p mean: -0.06351689994335175, mean p set: 0.4490780532360077
loss_pred:0.03172684460878372, decouple_loss:0.016823476180434227
The modified gen p mean: 0.44872990250587463, gen p mean: -0.06260289251804352, mean p set: 0.44921019673347473
loss_pred:0.029959162697196007, decouple_loss:0.01607629470527172
The modified gen p mean: 0.44834771752357483, gen p mean: -0.06297241896390915, mean p set: 0.4488280117511749
loss_pred:0.030790608376264572, decouple_loss:0.015839451923966408
Iteration: 590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729694724082947, gen p mean: -0.057009655982255936, mean p set: 0.44777724146842957
The modified gen p mean: 0.4474526643753052, gen p mean: -0.05739711970090866, mean p set: 0.4479329288005829
loss_pred:0.031503379344940186, decouple_loss:0.018951039761304855
loss_pred:0.031662605702877045, decouple_loss:0.017597274854779243
The modified gen p mean: 0.4475187361240387, gen p mean: -0.05768663063645363, mean p set: 0.4479990005493164
loss_pred:0.030793704092502594, decouple_loss:0.017854388803243637
2023-04-19 02:44:30 testing...
The modified gen p mean: 0.44943100214004517, gen p mean: -0.06974806636571884, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.06954361498355865, mean p set: 0.4498290419578552
The modified gen p mean: 0.44831880927085876, gen p mean: -0.06826996803283691, mean p set: 0.44879910349845886
loss_pred:0.037781864404678345, decouple_loss:0.01829560659825802
loss_pred:0.0377376526594162, decouple_loss:0.017600079998373985
loss_pred:0.03820256143808365, decouple_loss:0.017266610637307167
WV_0_PC_1_EH_0_PS_40, loss: 0.038793399930000305, avg_mse: 0.04488873854279518
current test mse: 0.044889
Iteration: 591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484991729259491, gen p mean: -0.06663907319307327, mean p set: 0.4489794969558716
loss_pred:0.030389009043574333, decouple_loss:0.017908629029989243
The modified gen p mean: 0.44762122631073, gen p mean: -0.0659937858581543, mean p set: 0.4481014907360077
The modified gen p mean: 0.44750353693962097, gen p mean: -0.06370582431554794, mean p set: 0.44798383116722107
loss_pred:0.0303942933678627, decouple_loss:0.016803612932562828
loss_pred:0.03288878872990608, decouple_loss:0.0166118573397398
Iteration: 592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484296441078186, gen p mean: -0.06903102993965149, mean p set: 0.4489099383354187
loss_pred:0.029995575547218323, decouple_loss:0.01575048267841339
The modified gen p mean: 0.4472711682319641, gen p mean: -0.06401605159044266, mean p set: 0.4477514326572418
The modified gen p mean: 0.44736239314079285, gen p mean: -0.06676904857158661, mean p set: 0.44784268736839294
loss_pred:0.030979488044977188, decouple_loss:0.015617547556757927
loss_pred:0.031846147030591965, decouple_loss:0.015459306538105011
Iteration: 593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476485848426819, gen p mean: -0.06070340424776077, mean p set: 0.44812890887260437
loss_pred:0.031401317566633224, decouple_loss:0.016570772975683212
The modified gen p mean: 0.44768163561820984, gen p mean: -0.0598725862801075, mean p set: 0.44816192984580994
The modified gen p mean: 0.44808006286621094, gen p mean: -0.06342122703790665, mean p set: 0.44856035709381104
loss_pred:0.030596058815717697, decouple_loss:0.015923377126455307
loss_pred:0.03137202933430672, decouple_loss:0.016588393598794937
Iteration: 594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477311372756958, gen p mean: -0.06439919769763947, mean p set: 0.4482114315032959
loss_pred:0.030277784913778305, decouple_loss:0.01593305543065071
The modified gen p mean: 0.4484996795654297, gen p mean: -0.06686921417713165, mean p set: 0.4489799737930298
loss_pred:0.03069431520998478, decouple_loss:0.015537112951278687
The modified gen p mean: 0.4493856132030487, gen p mean: -0.060531340539455414, mean p set: 0.4498658776283264
loss_pred:0.030457736924290657, decouple_loss:0.016333410516381264
Iteration: 595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736185669898987, gen p mean: -0.06496600061655045, mean p set: 0.44784215092658997
loss_pred:0.030988454818725586, decouple_loss:0.01563304103910923
The modified gen p mean: 0.4481067359447479, gen p mean: -0.069891057908535, mean p set: 0.4485870599746704
The modified gen p mean: 0.44730043411254883, gen p mean: -0.06693670898675919, mean p set: 0.4477807283401489
loss_pred:0.029637128114700317, decouple_loss:0.01503052283078432
loss_pred:0.031025325879454613, decouple_loss:0.014865066856145859
Iteration: 596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480278193950653, gen p mean: -0.06371953338384628, mean p set: 0.4485081434249878
loss_pred:0.03069296106696129, decouple_loss:0.014954372309148312
The modified gen p mean: 0.44796133041381836, gen p mean: -0.06587913632392883, mean p set: 0.44844159483909607
loss_pred:0.03054780699312687, decouple_loss:0.014382963068783283
The modified gen p mean: 0.44728949666023254, gen p mean: -0.06457895785570145, mean p set: 0.44776979088783264
loss_pred:0.030552847310900688, decouple_loss:0.014605488628149033
Iteration: 597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449061781167984, gen p mean: -0.061361342668533325, mean p set: 0.4495420455932617
loss_pred:0.031111083924770355, decouple_loss:0.015018721111118793
The modified gen p mean: 0.44777804613113403, gen p mean: -0.06260691583156586, mean p set: 0.44825834035873413
loss_pred:0.031177034601569176, decouple_loss:0.015021479688584805
The modified gen p mean: 0.446613073348999, gen p mean: -0.06263869255781174, mean p set: 0.4470933675765991
loss_pred:0.03090437687933445, decouple_loss:0.01434191782027483
Iteration: 598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473142623901367, gen p mean: -0.06262592226266861, mean p set: 0.4477945566177368
loss_pred:0.032826978713274, decouple_loss:0.016180893406271935
The modified gen p mean: 0.448378324508667, gen p mean: -0.06559333950281143, mean p set: 0.4488586187362671
The modified gen p mean: 0.44846057891845703, gen p mean: -0.06816545873880386, mean p set: 0.44894084334373474
loss_pred:0.03173680230975151, decouple_loss:0.014881362207233906
loss_pred:0.03103320673108101, decouple_loss:0.016445159912109375
Iteration: 599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447090744972229, gen p mean: -0.06800270080566406, mean p set: 0.4475710391998291
loss_pred:0.03003278747200966, decouple_loss:0.016812916845083237
The modified gen p mean: 0.4483779966831207, gen p mean: -0.06509668380022049, mean p set: 0.4488582909107208
loss_pred:0.03069997951388359, decouple_loss:0.016499340534210205
The modified gen p mean: 0.4479582905769348, gen p mean: -0.06369827687740326, mean p set: 0.4484385848045349
loss_pred:0.030488958582282066, decouple_loss:0.018343281000852585
Iteration: 600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483753740787506, gen p mean: -0.059126559644937515, mean p set: 0.4488556683063507
loss_pred:0.030852286145091057, decouple_loss:0.016318175941705704
The modified gen p mean: 0.4483235776424408, gen p mean: -0.06186585873365402, mean p set: 0.4488038718700409
loss_pred:0.030121902003884315, decouple_loss:0.01599709317088127
The modified gen p mean: 0.44723638892173767, gen p mean: -0.057875651866197586, mean p set: 0.44771671295166016
loss_pred:0.0330723337829113, decouple_loss:0.01616009697318077
2023-04-19 02:46:23 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.06835313141345978, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.06854462623596191, mean p set: 0.4498290419578552
The modified gen p mean: 0.44831880927085876, gen p mean: -0.06717537343502045, mean p set: 0.44879910349845886
loss_pred:0.03781738132238388, decouple_loss:0.017361881211400032
loss_pred:0.03810853511095047, decouple_loss:0.01745401881635189
loss_pred:0.03845818340778351, decouple_loss:0.017073413357138634
WV_0_PC_1_EH_0_PS_40, loss: 0.03899285942316055, avg_mse: 0.04541551694273949
current test mse: 0.045416
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470917880535126, gen p mean: -0.06691046059131622, mean p set: 0.44757208228111267
loss_pred:0.02983102761209011, decouple_loss:0.015250585973262787
The modified gen p mean: 0.4478665292263031, gen p mean: -0.06890911608934402, mean p set: 0.4483468234539032
loss_pred:0.03053300268948078, decouple_loss:0.015494130551815033
The modified gen p mean: 0.44653376936912537, gen p mean: -0.0697718933224678, mean p set: 0.44701406359672546
loss_pred:0.03210704028606415, decouple_loss:0.01852654106914997
Iteration: 602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811418652534485, gen p mean: -0.0674203485250473, mean p set: 0.44859448075294495
The modified gen p mean: 0.4462290108203888, gen p mean: -0.06945161521434784, mean p set: 0.4467092752456665
loss_pred:0.032408706843853, decouple_loss:0.01838747225701809
The modified gen p mean: 0.448044091463089, gen p mean: -0.0679616779088974, mean p set: 0.4485243558883667
loss_pred:0.03298916295170784, decouple_loss:0.020604480057954788
loss_pred:0.03052891232073307, decouple_loss:0.02126593515276909
Iteration: 603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729161262512207, gen p mean: -0.055155396461486816, mean p set: 0.44777190685272217The modified gen p mean: 0.4475002884864807, gen p mean: -0.05783861503005028, mean p set: 0.4479806125164032
loss_pred:0.029834352433681488, decouple_loss:0.01618483103811741
loss_pred:0.031103774905204773, decouple_loss:0.016171770170331
The modified gen p mean: 0.4455767571926117, gen p mean: -0.05946853756904602, mean p set: 0.4460570514202118
loss_pred:0.02858489193022251, decouple_loss:0.01799599640071392
Iteration: 604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767576456069946, gen p mean: -0.05804969370365143, mean p set: 0.44815605878829956
loss_pred:0.030738508328795433, decouple_loss:0.022227225825190544
The modified gen p mean: 0.4481518566608429, gen p mean: -0.05634385347366333, mean p set: 0.4486321210861206
The modified gen p mean: 0.4479070007801056, gen p mean: -0.057512909173965454, mean p set: 0.4483872950077057
loss_pred:0.030113819986581802, decouple_loss:0.021104812622070312
loss_pred:0.030349090695381165, decouple_loss:0.024136943742632866
Iteration: 605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480348825454712, gen p mean: -0.06635212153196335, mean p set: 0.4485151767730713
The modified gen p mean: 0.4470219612121582, gen p mean: -0.07103478908538818, mean p set: 0.4475022256374359
loss_pred:0.03036336973309517, decouple_loss:0.015801114961504936
loss_pred:0.029058102518320084, decouple_loss:0.01658361777663231
The modified gen p mean: 0.44825175404548645, gen p mean: -0.06887587159872055, mean p set: 0.44873204827308655
loss_pred:0.029569389298558235, decouple_loss:0.01582665555179119
Iteration: 606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44523462653160095, gen p mean: -0.07410885393619537, mean p set: 0.44571492075920105The modified gen p mean: 0.44724223017692566, gen p mean: -0.07485302537679672, mean p set: 0.44772249460220337
loss_pred:0.029506737366318703, decouple_loss:0.016755590215325356
loss_pred:0.031068595126271248, decouple_loss:0.01582825556397438
The modified gen p mean: 0.4481727182865143, gen p mean: -0.0713689997792244, mean p set: 0.4486530125141144
loss_pred:0.03403635323047638, decouple_loss:0.015934642404317856
Iteration: 607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459710121154785, gen p mean: -0.06272147595882416, mean p set: 0.4464513063430786
loss_pred:0.03191440925002098, decouple_loss:0.017381932586431503
The modified gen p mean: 0.4476628601551056, gen p mean: -0.06015055999159813, mean p set: 0.4481431543827057The modified gen p mean: 0.44615438580513, gen p mean: -0.05866515636444092, mean p set: 0.4466347098350525
loss_pred:0.02996433526277542, decouple_loss:0.015137727372348309
loss_pred:0.032434891909360886, decouple_loss:0.01627425290644169
Iteration: 608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466645419597626, gen p mean: -0.06441015750169754, mean p set: 0.44714486598968506
The modified gen p mean: 0.44879624247550964, gen p mean: -0.06698376685380936, mean p set: 0.44927650690078735
loss_pred:0.032252538949251175, decouple_loss:0.014610354788601398
loss_pred:0.029726991429924965, decouple_loss:0.016010109335184097
The modified gen p mean: 0.4484339952468872, gen p mean: -0.06541286408901215, mean p set: 0.4489142596721649
loss_pred:0.03223821893334389, decouple_loss:0.015875795856118202
Iteration: 609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669002294540405, gen p mean: -0.06841209530830383, mean p set: 0.44717034697532654
The modified gen p mean: 0.4466317892074585, gen p mean: -0.06526383012533188, mean p set: 0.4471120834350586
The modified gen p mean: 0.4466206729412079, gen p mean: -0.0664191022515297, mean p set: 0.44710099697113037
loss_pred:0.031812556087970734, decouple_loss:0.01637609675526619
loss_pred:0.03188581019639969, decouple_loss:0.014995376579463482
loss_pred:0.030099960044026375, decouple_loss:0.014737050049006939
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478265047073364, gen p mean: -0.06764530390501022, mean p set: 0.4483067989349365
The modified gen p mean: 0.44639071822166443, gen p mean: -0.06974252313375473, mean p set: 0.44687098264694214The modified gen p mean: 0.4470670819282532, gen p mean: -0.0732741504907608, mean p set: 0.44754740595817566
loss_pred:0.03293111175298691, decouple_loss:0.01542273536324501
loss_pred:0.030790602788329124, decouple_loss:0.014171292074024677
loss_pred:0.031464654952287674, decouple_loss:0.015688586980104446
2023-04-19 02:49:00 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.06041281670331955, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.06032024696469307, mean p set: 0.4498290419578552
The modified gen p mean: 0.44831880927085876, gen p mean: -0.05910022184252739, mean p set: 0.44879910349845886
loss_pred:0.03634805232286453, decouple_loss:0.01719915308058262
loss_pred:0.03668094053864479, decouple_loss:0.01622135192155838
loss_pred:0.03674553707242012, decouple_loss:0.01621490716934204
WV_0_PC_1_EH_0_PS_40, loss: 0.03741876780986786, avg_mse: 0.042724207043647766
current test mse: 0.042724
Iteration: 611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44880780577659607, gen p mean: -0.06001210957765579, mean p set: 0.44928810000419617
loss_pred:0.03105943277478218, decouple_loss:0.01579539105296135
The modified gen p mean: 0.44770726561546326, gen p mean: -0.061937324702739716, mean p set: 0.44818755984306335
The modified gen p mean: 0.4468749463558197, gen p mean: -0.062193721532821655, mean p set: 0.4473552703857422
loss_pred:0.03037002868950367, decouple_loss:0.01654692180454731
loss_pred:0.030234629288315773, decouple_loss:0.01638154126703739
Iteration: 612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481533467769623, gen p mean: -0.05667984113097191, mean p set: 0.4486336410045624
loss_pred:0.032393522560596466, decouple_loss:0.015418141148984432
The modified gen p mean: 0.44639313220977783, gen p mean: -0.05659246817231178, mean p set: 0.44687342643737793
The modified gen p mean: 0.4490118622779846, gen p mean: -0.0545850545167923, mean p set: 0.44949212670326233
loss_pred:0.03158528357744217, decouple_loss:0.016396721825003624
loss_pred:0.030439579859375954, decouple_loss:0.016078075394034386
Iteration: 613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467603862285614, gen p mean: -0.059716325253248215, mean p set: 0.4472406804561615
loss_pred:0.030944252386689186, decouple_loss:0.014367371797561646
The modified gen p mean: 0.44775256514549255, gen p mean: -0.06684515625238419, mean p set: 0.44823282957077026
The modified gen p mean: 0.44723355770111084, gen p mean: -0.06333445757627487, mean p set: 0.4477138817310333
loss_pred:0.03093487024307251, decouple_loss:0.014710032381117344
loss_pred:0.02939562126994133, decouple_loss:0.014150625094771385
Iteration: 614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708535075187683, gen p mean: -0.06641529500484467, mean p set: 0.4475656747817993
loss_pred:0.03015260584652424, decouple_loss:0.014803064987063408
The modified gen p mean: 0.4457424283027649, gen p mean: -0.06590210646390915, mean p set: 0.4462227523326874
The modified gen p mean: 0.44720178842544556, gen p mean: -0.062470100820064545, mean p set: 0.44768208265304565
loss_pred:0.029571855440735817, decouple_loss:0.01768593303859234
loss_pred:0.029503602534532547, decouple_loss:0.015983525663614273
Iteration: 615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447226345539093, gen p mean: -0.05428704246878624, mean p set: 0.4477066397666931
loss_pred:0.03136840835213661, decouple_loss:0.021191135048866272
The modified gen p mean: 0.44795510172843933, gen p mean: -0.0576227605342865, mean p set: 0.44843539595603943
The modified gen p mean: 0.44730597734451294, gen p mean: -0.05743476375937462, mean p set: 0.44778627157211304
loss_pred:0.028443174436688423, decouple_loss:0.01825495809316635
loss_pred:0.031960379332304, decouple_loss:0.018675778061151505
Iteration: 616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44881632924079895, gen p mean: -0.044687893241643906, mean p set: 0.44929662346839905
The modified gen p mean: 0.44603416323661804, gen p mean: -0.04568338394165039, mean p set: 0.44651445746421814loss_pred:0.030820775777101517, decouple_loss:0.01695488765835762
loss_pred:0.029969051480293274, decouple_loss:0.017146233469247818
The modified gen p mean: 0.4474366009235382, gen p mean: -0.041051629930734634, mean p set: 0.4479168951511383
loss_pred:0.028984207659959793, decouple_loss:0.016031919047236443
Iteration: 617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44648075103759766, gen p mean: -0.048229653388261795, mean p set: 0.44696107506752014
loss_pred:0.0311087928712368, decouple_loss:0.01591816172003746
The modified gen p mean: 0.4475573003292084, gen p mean: -0.0490090511739254, mean p set: 0.44803762435913086The modified gen p mean: 0.44799819588661194, gen p mean: -0.04945150762796402, mean p set: 0.44847849011421204
loss_pred:0.029976442456245422, decouple_loss:0.015832481905817986
loss_pred:0.02994176372885704, decouple_loss:0.015624528750777245
Iteration: 618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694462418556213, gen p mean: -0.061294250190258026, mean p set: 0.44742488861083984
The modified gen p mean: 0.4486105442047119, gen p mean: -0.06115877255797386, mean p set: 0.449090838432312loss_pred:0.03186002001166344, decouple_loss:0.017420070245862007The modified gen p mean: 0.4483518600463867, gen p mean: -0.05680515244603157, mean p set: 0.4488321542739868
loss_pred:0.02943621203303337, decouple_loss:0.01765385828912258
loss_pred:0.02969800867140293, decouple_loss:0.01558317057788372
Iteration: 619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464447498321533, gen p mean: -0.059316981583833694, mean p set: 0.4469250440597534
The modified gen p mean: 0.4482642710208893, gen p mean: -0.059458665549755096, mean p set: 0.4487445652484894
loss_pred:0.031954869627952576, decouple_loss:0.016756344586610794
The modified gen p mean: 0.44699421525001526, gen p mean: -0.05652070790529251, mean p set: 0.44747447967529297
loss_pred:0.03092566318809986, decouple_loss:0.014883795753121376
loss_pred:0.030851775780320168, decouple_loss:0.015417146496474743
Iteration: 620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44865891337394714, gen p mean: -0.05138558894395828, mean p set: 0.44913914799690247
The modified gen p mean: 0.4465906620025635, gen p mean: -0.05143188685178757, mean p set: 0.4470709264278412
loss_pred:0.03117147833108902, decouple_loss:0.014639027416706085
The modified gen p mean: 0.44601142406463623, gen p mean: -0.047572169452905655, mean p set: 0.44649171829223633
loss_pred:0.032232318073511124, decouple_loss:0.015564664267003536
loss_pred:0.03090403415262699, decouple_loss:0.014537676237523556
2023-04-19 02:50:52 testing...
The modified gen p mean: 0.44943100214004517, gen p mean: -0.05152954161167145, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.0519954115152359, mean p set: 0.4498290419578552
The modified gen p mean: 0.44831880927085876, gen p mean: -0.05066661909222603, mean p set: 0.44879910349845886
loss_pred:0.03718254715204239, decouple_loss:0.015822729095816612
loss_pred:0.03728845342993736, decouple_loss:0.01592813804745674
loss_pred:0.03727542981505394, decouple_loss:0.015701899304986
WV_0_PC_1_EH_0_PS_40, loss: 0.038039691746234894, avg_mse: 0.044162921607494354
current test mse: 0.044163
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492749869823456, gen p mean: -0.04813709110021591, mean p set: 0.4497552812099457
loss_pred:0.030691320076584816, decouple_loss:0.016855623573064804
The modified gen p mean: 0.44858768582344055, gen p mean: -0.04916515201330185, mean p set: 0.44906798005104065
The modified gen p mean: 0.4492380619049072, gen p mean: -0.05149316042661667, mean p set: 0.4497183561325073
loss_pred:0.034180670976638794, decouple_loss:0.016614871099591255
loss_pred:0.03362250700592995, decouple_loss:0.01700049266219139
Iteration: 622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44943392276763916, gen p mean: -0.05932262912392616, mean p set: 0.44991418719291687
loss_pred:0.03237134590744972, decouple_loss:0.0160109493881464
The modified gen p mean: 0.4497874081134796, gen p mean: -0.06244742497801781, mean p set: 0.4502677023410797
The modified gen p mean: 0.4480297267436981, gen p mean: -0.059674642980098724, mean p set: 0.44850999116897583
loss_pred:0.03337977081537247, decouple_loss:0.017502589151263237
loss_pred:0.03239937871694565, decouple_loss:0.01746263913810253
Iteration: 623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449203222990036, gen p mean: -0.05747460201382637, mean p set: 0.4496835172176361
loss_pred:0.030196771025657654, decouple_loss:0.01654784381389618
The modified gen p mean: 0.44965627789497375, gen p mean: -0.05802684277296066, mean p set: 0.45013657212257385
loss_pred:0.03270478919148445, decouple_loss:0.0175954420119524
The modified gen p mean: 0.44797298312187195, gen p mean: -0.05562315881252289, mean p set: 0.44845327734947205
loss_pred:0.03153509646654129, decouple_loss:0.017328957095742226
Iteration: 624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490286111831665, gen p mean: -0.062463048845529556, mean p set: 0.4495089054107666
The modified gen p mean: 0.45090633630752563, gen p mean: -0.05962179973721504, mean p set: 0.45138660073280334
loss_pred:0.03163609653711319, decouple_loss:0.0160638727247715
loss_pred:0.030956968665122986, decouple_loss:0.017202826216816902
The modified gen p mean: 0.4489181935787201, gen p mean: -0.06434357911348343, mean p set: 0.4493984878063202
loss_pred:0.031930141150951385, decouple_loss:0.015719929710030556
Iteration: 625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491843283176422, gen p mean: -0.062174927443265915, mean p set: 0.4496645927429199
The modified gen p mean: 0.4501242935657501, gen p mean: -0.0576481968164444, mean p set: 0.4506046175956726
loss_pred:0.030956780537962914, decouple_loss:0.016478950157761574
loss_pred:0.03154955431818962, decouple_loss:0.016304973512887955
The modified gen p mean: 0.44969239830970764, gen p mean: -0.06157471239566803, mean p set: 0.45017269253730774
loss_pred:0.031719278544187546, decouple_loss:0.01681273616850376
Iteration: 626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492669105529785, gen p mean: -0.056243713945150375, mean p set: 0.4497471749782562
loss_pred:0.03078577294945717, decouple_loss:0.015735477209091187
The modified gen p mean: 0.4492708742618561, gen p mean: -0.05680098384618759, mean p set: 0.4497511684894562
loss_pred:0.031224608421325684, decouple_loss:0.015586006455123425
The modified gen p mean: 0.4488268494606018, gen p mean: -0.056953396648168564, mean p set: 0.4493071436882019
loss_pred:0.031524188816547394, decouple_loss:0.016128351911902428
Iteration: 627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483937919139862, gen p mean: -0.05399196967482567, mean p set: 0.4488740861415863
loss_pred:0.030795656144618988, decouple_loss:0.017200501635670662
The modified gen p mean: 0.45011022686958313, gen p mean: -0.05308220162987709, mean p set: 0.4505905210971832
loss_pred:0.03029668517410755, decouple_loss:0.016853563487529755
The modified gen p mean: 0.4500035047531128, gen p mean: -0.054634466767311096, mean p set: 0.4504837691783905
loss_pred:0.03195091336965561, decouple_loss:0.01727500930428505
Iteration: 628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44965094327926636, gen p mean: -0.05106385052204132, mean p set: 0.45013123750686646
The modified gen p mean: 0.44919702410697937, gen p mean: -0.0532616525888443, mean p set: 0.44967731833457947
loss_pred:0.03082158975303173, decouple_loss:0.017549656331539154
loss_pred:0.03102855011820793, decouple_loss:0.01563936285674572
The modified gen p mean: 0.4502960443496704, gen p mean: -0.050206176936626434, mean p set: 0.4507763385772705
loss_pred:0.03118707239627838, decouple_loss:0.019048655405640602
Iteration: 629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484655559062958, gen p mean: -0.055061083287000656, mean p set: 0.4489458501338959
loss_pred:0.029935522004961967, decouple_loss:0.01836487092077732
The modified gen p mean: 0.44919630885124207, gen p mean: -0.051393453031778336, mean p set: 0.4496765732765198
loss_pred:0.0315234437584877, decouple_loss:0.016587845981121063
The modified gen p mean: 0.4485131502151489, gen p mean: -0.05112713947892189, mean p set: 0.448993444442749
loss_pred:0.030772725120186806, decouple_loss:0.017361052334308624
Iteration: 630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44837287068367004, gen p mean: -0.053193964064121246, mean p set: 0.44885316491127014
loss_pred:0.03158589452505112, decouple_loss:0.021148016676306725
The modified gen p mean: 0.44948598742485046, gen p mean: -0.05752265453338623, mean p set: 0.44996631145477295
The modified gen p mean: 0.4492861032485962, gen p mean: -0.05514700710773468, mean p set: 0.4497663974761963
loss_pred:0.030081210657954216, decouple_loss:0.020342091098427773
loss_pred:0.03150549903512001, decouple_loss:0.019243625923991203
2023-04-19 02:53:23 testing...
The modified gen p mean: 0.44943100214004517, gen p mean: -0.05859600007534027, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.05891166254878044, mean p set: 0.4498290419578552
The modified gen p mean: 0.44831880927085876, gen p mean: -0.057673752307891846, mean p set: 0.44879910349845886
loss_pred:0.03719872981309891, decouple_loss:0.01846693828701973
loss_pred:0.03747114911675453, decouple_loss:0.018377788364887238
loss_pred:0.03792433813214302, decouple_loss:0.01839108020067215
WV_0_PC_1_EH_0_PS_40, loss: 0.03845200315117836, avg_mse: 0.04473956674337387
current test mse: 0.04474
Iteration: 631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822654128074646, gen p mean: -0.05462074652314186, mean p set: 0.44870686531066895
loss_pred:0.031689103692770004, decouple_loss:0.017237382009625435
The modified gen p mean: 0.4480578601360321, gen p mean: -0.05365853011608124, mean p set: 0.4485381245613098
The modified gen p mean: 0.4488588571548462, gen p mean: -0.05443855747580528, mean p set: 0.4493391215801239
loss_pred:0.03335030376911163, decouple_loss:0.017415320500731468
loss_pred:0.0314321331679821, decouple_loss:0.01571575738489628
Iteration: 632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506630599498749, gen p mean: -0.049864839762449265, mean p set: 0.451143354177475
loss_pred:0.03181781992316246, decouple_loss:0.01670696772634983
The modified gen p mean: 0.4502295255661011, gen p mean: -0.050129927694797516, mean p set: 0.45070981979370117
The modified gen p mean: 0.44903796911239624, gen p mean: -0.05423378199338913, mean p set: 0.4495182931423187
loss_pred:0.030825166031718254, decouple_loss:0.01565180905163288
loss_pred:0.030846331268548965, decouple_loss:0.01660170964896679
Iteration: 633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496931731700897, gen p mean: -0.05384446680545807, mean p set: 0.4501734673976898
loss_pred:0.03206956386566162, decouple_loss:0.01651926524937153
The modified gen p mean: 0.44893956184387207, gen p mean: -0.05266547203063965, mean p set: 0.4494198262691498
The modified gen p mean: 0.4476586580276489, gen p mean: -0.051374029368162155, mean p set: 0.44813892245292664
loss_pred:0.030635012313723564, decouple_loss:0.016164196655154228
loss_pred:0.033480480313301086, decouple_loss:0.01609835959970951
Iteration: 634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497798681259155, gen p mean: -0.05850157141685486, mean p set: 0.45026013255119324
loss_pred:0.03148220106959343, decouple_loss:0.01433106791228056
The modified gen p mean: 0.4496731758117676, gen p mean: -0.05645760893821716, mean p set: 0.4501534700393677
The modified gen p mean: 0.4508245587348938, gen p mean: -0.057825006544589996, mean p set: 0.45130491256713867
loss_pred:0.03159996122121811, decouple_loss:0.014238569885492325
loss_pred:0.032011326402425766, decouple_loss:0.015741687268018723
Iteration: 635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836920499801636, gen p mean: -0.05968185141682625, mean p set: 0.44884949922561646
loss_pred:0.03115694411098957, decouple_loss:0.015919337049126625
The modified gen p mean: 0.44860759377479553, gen p mean: -0.05752864480018616, mean p set: 0.44908788800239563
The modified gen p mean: 0.44863173365592957, gen p mean: -0.055811986327171326, mean p set: 0.4491119980812073
loss_pred:0.03134310245513916, decouple_loss:0.01735529489815235
loss_pred:0.032612886279821396, decouple_loss:0.017881039530038834
Iteration: 636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018741488456726, gen p mean: -0.05677499622106552, mean p set: 0.45066767930984497
loss_pred:0.03188265115022659, decouple_loss:0.01843276619911194
The modified gen p mean: 0.45080986618995667, gen p mean: -0.055893078446388245, mean p set: 0.45129016041755676
The modified gen p mean: 0.449287086725235, gen p mean: -0.058111339807510376, mean p set: 0.4497673809528351
loss_pred:0.030957065522670746, decouple_loss:0.01598745957016945
loss_pred:0.030613237991929054, decouple_loss:0.015580856241285801
Iteration: 637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44874081015586853, gen p mean: -0.06279028952121735, mean p set: 0.449221134185791
The modified gen p mean: 0.4500710964202881, gen p mean: -0.060505617409944534, mean p set: 0.4505513906478882
loss_pred:0.030291343107819557, decouple_loss:0.016259007155895233
loss_pred:0.032527998089790344, decouple_loss:0.01743110828101635
The modified gen p mean: 0.4494743347167969, gen p mean: -0.059559352695941925, mean p set: 0.44995465874671936
loss_pred:0.03153170645236969, decouple_loss:0.016326788812875748
Iteration: 638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45058590173721313, gen p mean: -0.05435197800397873, mean p set: 0.45106619596481323
loss_pred:0.030644889920949936, decouple_loss:0.02033347077667713
The modified gen p mean: 0.44886115193367004, gen p mean: -0.05750931426882744, mean p set: 0.44934147596359253
The modified gen p mean: 0.44803234934806824, gen p mean: -0.056592486798763275, mean p set: 0.44851261377334595loss_pred:0.03232498839497566, decouple_loss:0.01921680010855198
loss_pred:0.029238970950245857, decouple_loss:0.02094200812280178
Iteration: 639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498368203639984, gen p mean: -0.05596350505948067, mean p set: 0.4503171145915985
The modified gen p mean: 0.450138658285141, gen p mean: -0.05563455820083618, mean p set: 0.4506189823150635
loss_pred:0.030606132000684738, decouple_loss:0.01566583290696144
loss_pred:0.031029928475618362, decouple_loss:0.01747506484389305
The modified gen p mean: 0.44911807775497437, gen p mean: -0.05680334195494652, mean p set: 0.44959837198257446
loss_pred:0.03068842552602291, decouple_loss:0.016191065311431885
Iteration: 640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44901034235954285, gen p mean: -0.057719260454177856, mean p set: 0.44949063658714294
The modified gen p mean: 0.4503858983516693, gen p mean: -0.052414420992136, mean p set: 0.4508661925792694
loss_pred:0.029901450499892235, decouple_loss:0.016613731160759926
loss_pred:0.030611135065555573, decouple_loss:0.019305510446429253
The modified gen p mean: 0.4493621289730072, gen p mean: -0.055646732449531555, mean p set: 0.4498424530029297
loss_pred:0.03062516450881958, decouple_loss:0.019106177613139153
2023-04-19 02:55:16 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.05683575198054314, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.05685669183731079, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.055487655103206635, mean p set: 0.44879910349845886
loss_pred:0.03688277304172516, decouple_loss:0.022472046315670013
loss_pred:0.03669252246618271, decouple_loss:0.023261185735464096
loss_pred:0.03702930733561516, decouple_loss:0.02303285524249077
WV_0_PC_1_EH_0_PS_40, loss: 0.038014303892850876, avg_mse: 0.043680932372808456
current test mse: 0.043681
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479285478591919, gen p mean: -0.05556762218475342, mean p set: 0.448408842086792
loss_pred:0.030847901478409767, decouple_loss:0.02040666714310646
The modified gen p mean: 0.4490843415260315, gen p mean: -0.057314708828926086, mean p set: 0.4495646357536316
The modified gen p mean: 0.44748514890670776, gen p mean: -0.05735304206609726, mean p set: 0.44796544313430786
loss_pred:0.029757380485534668, decouple_loss:0.020185839384794235
loss_pred:0.029927734285593033, decouple_loss:0.02085236646234989
Iteration: 642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447777658700943, gen p mean: -0.06721697747707367, mean p set: 0.4482579529285431
loss_pred:0.03044998086988926, decouple_loss:0.016002025455236435
The modified gen p mean: 0.44962185621261597, gen p mean: -0.0714886412024498, mean p set: 0.4501021206378937
The modified gen p mean: 0.4481053054332733, gen p mean: -0.06949928402900696, mean p set: 0.4485855996608734
loss_pred:0.029115421697497368, decouple_loss:0.01547639723867178
loss_pred:0.03034820780158043, decouple_loss:0.015410476364195347
Iteration: 643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488388001918793, gen p mean: -0.06786157190799713, mean p set: 0.449319064617157
loss_pred:0.030504142865538597, decouple_loss:0.0172068253159523
The modified gen p mean: 0.4482608735561371, gen p mean: -0.07620655000209808, mean p set: 0.4487411379814148
The modified gen p mean: 0.4475911557674408, gen p mean: -0.07152677327394485, mean p set: 0.4480714499950409
loss_pred:0.0288867000490427, decouple_loss:0.01948784664273262
loss_pred:0.028536252677440643, decouple_loss:0.017577091231942177
Iteration: 644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484059512615204, gen p mean: -0.06236371770501137, mean p set: 0.4488862454891205
loss_pred:0.030067557469010353, decouple_loss:0.01833154819905758
The modified gen p mean: 0.44872066378593445, gen p mean: -0.06308005750179291, mean p set: 0.44920095801353455
The modified gen p mean: 0.4480462074279785, gen p mean: -0.0640891045331955, mean p set: 0.4485265016555786
loss_pred:0.031110886484384537, decouple_loss:0.01800096407532692
loss_pred:0.02989613264799118, decouple_loss:0.016666332259774208
Iteration: 645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44707104563713074, gen p mean: -0.06753071397542953, mean p set: 0.44755133986473083
loss_pred:0.028119586408138275, decouple_loss:0.01560867391526699
The modified gen p mean: 0.4483461380004883, gen p mean: -0.06702139973640442, mean p set: 0.4488264322280884
loss_pred:0.030246302485466003, decouple_loss:0.015093965455889702
The modified gen p mean: 0.44847527146339417, gen p mean: -0.06400620192289352, mean p set: 0.44895556569099426
loss_pred:0.030907990410923958, decouple_loss:0.015944257378578186
Iteration: 646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44923385977745056, gen p mean: -0.0724501684308052, mean p set: 0.44971415400505066
loss_pred:0.031234821304678917, decouple_loss:0.016640033572912216
The modified gen p mean: 0.4502047896385193, gen p mean: -0.0679742619395256, mean p set: 0.450685054063797
The modified gen p mean: 0.44850489497184753, gen p mean: -0.06760551035404205, mean p set: 0.44898515939712524loss_pred:0.03184008225798607, decouple_loss:0.016967209056019783
loss_pred:0.03042479045689106, decouple_loss:0.01714768260717392
Iteration: 647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487585425376892, gen p mean: -0.05660390853881836, mean p set: 0.4492388665676117
loss_pred:0.030723435804247856, decouple_loss:0.01921282522380352
The modified gen p mean: 0.4483553469181061, gen p mean: -0.05538836121559143, mean p set: 0.44883567094802856
The modified gen p mean: 0.44796425104141235, gen p mean: -0.05690263584256172, mean p set: 0.44844454526901245
loss_pred:0.03122369945049286, decouple_loss:0.018381014466285706
loss_pred:0.031146371737122536, decouple_loss:0.018044017255306244
Iteration: 648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788697361946106, gen p mean: -0.06708244979381561, mean p set: 0.44836726784706116
loss_pred:0.028812667354941368, decouple_loss:0.015777066349983215
The modified gen p mean: 0.44732072949409485, gen p mean: -0.06170762702822685, mean p set: 0.44780102372169495
loss_pred:0.030637430027127266, decouple_loss:0.015509243123233318
The modified gen p mean: 0.4487915635108948, gen p mean: -0.06573636084794998, mean p set: 0.4492718279361725
loss_pred:0.030645953491330147, decouple_loss:0.01662261225283146
Iteration: 649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44761234521865845, gen p mean: -0.06683450192213058, mean p set: 0.44809263944625854
loss_pred:0.030195077881217003, decouple_loss:0.017443209886550903
The modified gen p mean: 0.4481866657733917, gen p mean: -0.06958455592393875, mean p set: 0.44866693019866943
loss_pred:0.031099319458007812, decouple_loss:0.01800423301756382
The modified gen p mean: 0.44865861535072327, gen p mean: -0.06435985863208771, mean p set: 0.44913890957832336
loss_pred:0.030866196379065514, decouple_loss:0.017701923847198486
Iteration: 650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463944733142853, gen p mean: -0.06342592090368271, mean p set: 0.4468747675418854
loss_pred:0.03112826496362686, decouple_loss:0.02042515017092228
The modified gen p mean: 0.4483340084552765, gen p mean: -0.05629802122712135, mean p set: 0.4488143026828766
loss_pred:0.030209429562091827, decouple_loss:0.018879786133766174
The modified gen p mean: 0.44871824979782104, gen p mean: -0.05833880230784416, mean p set: 0.44919851422309875
loss_pred:0.03149324655532837, decouple_loss:0.01964247040450573
2023-04-19 02:57:49 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.0613347664475441, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.06163269281387329, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.060427840799093246, mean p set: 0.44879910349845886
loss_pred:0.03748566284775734, decouple_loss:0.017838140949606895
loss_pred:0.038138747215270996, decouple_loss:0.018190711736679077
loss_pred:0.03806758299469948, decouple_loss:0.01781644858419895
WV_0_PC_1_EH_0_PS_40, loss: 0.03879475221037865, avg_mse: 0.045747414231300354
current test mse: 0.045747
Iteration: 651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482864737510681, gen p mean: -0.06544220447540283, mean p set: 0.4487667679786682
loss_pred:0.029552552849054337, decouple_loss:0.015796637162566185
The modified gen p mean: 0.4473828077316284, gen p mean: -0.061091404408216476, mean p set: 0.4478631317615509
The modified gen p mean: 0.4465106427669525, gen p mean: -0.06633994728326797, mean p set: 0.446990966796875
loss_pred:0.03047453798353672, decouple_loss:0.015396656468510628
loss_pred:0.029640205204486847, decouple_loss:0.015784725546836853
Iteration: 652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727644324302673, gen p mean: -0.07367239147424698, mean p set: 0.44775673747062683
loss_pred:0.03012627176940441, decouple_loss:0.02130977250635624
The modified gen p mean: 0.44806262850761414, gen p mean: -0.06899514049291611, mean p set: 0.44854292273521423
The modified gen p mean: 0.4487621486186981, gen p mean: -0.0646405965089798, mean p set: 0.4492424428462982
loss_pred:0.033261410892009735, decouple_loss:0.02209540642797947
loss_pred:0.03134528547525406, decouple_loss:0.021355722099542618
Iteration: 653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487471878528595, gen p mean: -0.05678030103445053, mean p set: 0.4492274820804596
loss_pred:0.02978171780705452, decouple_loss:0.015836527571082115
The modified gen p mean: 0.44648706912994385, gen p mean: -0.058130666613578796, mean p set: 0.44696733355522156
loss_pred:0.02911418117582798, decouple_loss:0.015932926908135414
The modified gen p mean: 0.4475422203540802, gen p mean: -0.05541633442044258, mean p set: 0.4480225145816803
loss_pred:0.03333921730518341, decouple_loss:0.015318174846470356
Iteration: 654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018258690834045, gen p mean: -0.04845043271780014, mean p set: 0.45066288113594055
loss_pred:0.030520865693688393, decouple_loss:0.019610095769166946
The modified gen p mean: 0.44782358407974243, gen p mean: -0.04618381708860397, mean p set: 0.44830387830734253
loss_pred:0.030562670901417732, decouple_loss:0.02271757833659649
The modified gen p mean: 0.44940853118896484, gen p mean: -0.04538466036319733, mean p set: 0.44988885521888733
loss_pred:0.030051670968532562, decouple_loss:0.020925337448716164
Iteration: 655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486162066459656, gen p mean: -0.04969484731554985, mean p set: 0.4490965008735657
loss_pred:0.03203212842345238, decouple_loss:0.015520431101322174
The modified gen p mean: 0.4481760263442993, gen p mean: -0.05081787332892418, mean p set: 0.4486563205718994
loss_pred:0.030259959399700165, decouple_loss:0.015016504563391209
The modified gen p mean: 0.4478696584701538, gen p mean: -0.05059414729475975, mean p set: 0.4483499228954315
loss_pred:0.030131718143820763, decouple_loss:0.015657545998692513
Iteration: 656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448636531829834, gen p mean: -0.054852139204740524, mean p set: 0.4491168260574341
loss_pred:0.03146541863679886, decouple_loss:0.016031237319111824
The modified gen p mean: 0.44810235500335693, gen p mean: -0.053053468465805054, mean p set: 0.4485826790332794
The modified gen p mean: 0.44837528467178345, gen p mean: -0.05605985224246979, mean p set: 0.44885557889938354
loss_pred:0.029715929180383682, decouple_loss:0.015938669443130493
loss_pred:0.03140208125114441, decouple_loss:0.016846265643835068
Iteration: 657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44656041264533997, gen p mean: -0.05446253716945648, mean p set: 0.44704070687294006
loss_pred:0.03056773915886879, decouple_loss:0.017650220543146133
The modified gen p mean: 0.44756534695625305, gen p mean: -0.05664397031068802, mean p set: 0.44804564118385315
loss_pred:0.03007817454636097, decouple_loss:0.01848452165722847
The modified gen p mean: 0.4483143091201782, gen p mean: -0.053111348301172256, mean p set: 0.44879457354545593
loss_pred:0.029957406222820282, decouple_loss:0.016491640359163284
Iteration: 658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44615504145622253, gen p mean: -0.054352860897779465, mean p set: 0.44663533568382263
The modified gen p mean: 0.44935524463653564, gen p mean: -0.04915023222565651, mean p set: 0.44983553886413574
loss_pred:0.030038533732295036, decouple_loss:0.01531060878187418
loss_pred:0.029435621574521065, decouple_loss:0.01611892133951187
The modified gen p mean: 0.4476674795150757, gen p mean: -0.05284731090068817, mean p set: 0.4481477439403534
loss_pred:0.030666200444102287, decouple_loss:0.014483144506812096
Iteration: 659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828712940216064, gen p mean: -0.0579618364572525, mean p set: 0.44876742362976074
loss_pred:0.0305034089833498, decouple_loss:0.017576631158590317
The modified gen p mean: 0.4482540488243103, gen p mean: -0.058912236243486404, mean p set: 0.4487343728542328
loss_pred:0.03127183020114899, decouple_loss:0.016779273748397827
The modified gen p mean: 0.4477931559085846, gen p mean: -0.05936400219798088, mean p set: 0.4482734203338623
loss_pred:0.02887214720249176, decouple_loss:0.01692242920398712
Iteration: 660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508858025074005, gen p mean: -0.06250510364770889, mean p set: 0.4513660967350006
The modified gen p mean: 0.4477505087852478, gen p mean: -0.06453939527273178, mean p set: 0.4482307732105255
loss_pred:0.030580848455429077, decouple_loss:0.014526410959661007
loss_pred:0.02902938611805439, decouple_loss:0.01405907142907381
The modified gen p mean: 0.4467921853065491, gen p mean: -0.06616377085447311, mean p set: 0.4472724497318268
loss_pred:0.029895827174186707, decouple_loss:0.014645480550825596
2023-04-19 02:59:42 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.06669528782367706, mean p set: 0.4499112665653229
The modified gen p mean: 0.4493487477302551, gen p mean: -0.06638754159212112, mean p set: 0.4498290419578552
The modified gen p mean: 0.4483187794685364, gen p mean: -0.06545364111661911, mean p set: 0.44879910349845886
loss_pred:0.03709452226758003, decouple_loss:0.01898578740656376
loss_pred:0.03716195747256279, decouple_loss:0.01946493424475193
loss_pred:0.03758108988404274, decouple_loss:0.01910879649221897
WV_0_PC_1_EH_0_PS_40, loss: 0.0382385179400444, avg_mse: 0.04473305121064186
current test mse: 0.044733
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44910916686058044, gen p mean: -0.061844464391469955, mean p set: 0.44958946108818054
loss_pred:0.030548127368092537, decouple_loss:0.017891384661197662
The modified gen p mean: 0.4476395547389984, gen p mean: -0.06219332665205002, mean p set: 0.4481198489665985
loss_pred:0.029779141768813133, decouple_loss:0.017228851094841957
The modified gen p mean: 0.4485054016113281, gen p mean: -0.06472594290971756, mean p set: 0.44898566603660583
loss_pred:0.030355304479599, decouple_loss:0.017655491828918457
Iteration: 662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44882893562316895, gen p mean: -0.05642572045326233, mean p set: 0.44930922985076904
loss_pred:0.03076520934700966, decouple_loss:0.01596374437212944
The modified gen p mean: 0.44952392578125, gen p mean: -0.05730302631855011, mean p set: 0.4500042200088501
The modified gen p mean: 0.4499039351940155, gen p mean: -0.05657622590661049, mean p set: 0.4503842294216156
loss_pred:0.030735036358237267, decouple_loss:0.01536087691783905
loss_pred:0.0326412133872509, decouple_loss:0.015709873288869858
Iteration: 663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44901958107948303, gen p mean: -0.050645411014556885, mean p set: 0.44949984550476074
loss_pred:0.03154909983277321, decouple_loss:0.013709111139178276
The modified gen p mean: 0.44854825735092163, gen p mean: -0.05194966495037079, mean p set: 0.44902855157852173
The modified gen p mean: 0.4494432210922241, gen p mean: -0.04776471108198166, mean p set: 0.4499235153198242
loss_pred:0.030051177367568016, decouple_loss:0.016273699700832367
loss_pred:0.032194629311561584, decouple_loss:0.015389345586299896
