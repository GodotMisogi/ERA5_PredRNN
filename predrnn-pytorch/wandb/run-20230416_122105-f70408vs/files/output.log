After initialize model, args.img_channel:30
load model: /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_1_PS_40/model_2000.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
train_data_files nums: 41
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_09012020_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44855597615242004
loss_pred:0.02231593057513237, decouple_loss:0.009223366156220436
The generated pressure mean: 0.4476657509803772
loss_pred:0.01950760744512081, decouple_loss:0.00899757631123066
The generated pressure mean: 0.4464261829853058
loss_pred:0.02000531367957592, decouple_loss:0.008633297868072987
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44782087206840515
loss_pred:0.13685674965381622, decouple_loss:0.47984376549720764
The generated pressure mean: 0.44711625576019287
loss_pred:0.13899949193000793, decouple_loss:0.480974018573761
The generated pressure mean: 0.44752955436706543
loss_pred:0.15524806082248688, decouple_loss:0.4906487762928009
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448663592338562
loss_pred:0.07931400835514069, decouple_loss:0.48906463384628296
The generated pressure mean: 0.4470173418521881
loss_pred:0.08247826248407364, decouple_loss:0.4975817799568176
The generated pressure mean: 0.44816309213638306
loss_pred:0.08569368720054626, decouple_loss:0.5049822330474854
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44839712977409363
loss_pred:0.06606003642082214, decouple_loss:0.7194747924804688
The generated pressure mean: 0.4474393427371979
loss_pred:0.0637880340218544, decouple_loss:0.7117822170257568
The generated pressure mean: 0.4478968679904938
loss_pred:0.06560347974300385, decouple_loss:0.7275427579879761
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479125738143921
loss_pred:0.05104340240359306, decouple_loss:0.5597691535949707
The generated pressure mean: 0.4477519690990448
loss_pred:0.05285288766026497, decouple_loss:0.5527886152267456
The generated pressure mean: 0.447444349527359
loss_pred:0.05075777322053909, decouple_loss:0.5454695224761963
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493992030620575
loss_pred:0.054409828037023544, decouple_loss:0.42725351452827454
The generated pressure mean: 0.4475899040699005
loss_pred:0.05495046451687813, decouple_loss:0.4193992018699646
The generated pressure mean: 0.4474130868911743
loss_pred:0.05187441408634186, decouple_loss:0.4207477867603302
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44765162467956543
loss_pred:0.04734669253230095, decouple_loss:0.33570629358291626
The generated pressure mean: 0.44776850938796997
loss_pred:0.044490884989500046, decouple_loss:0.33593571186065674
The generated pressure mean: 0.44655776023864746
loss_pred:0.046513769775629044, decouple_loss:0.3420109450817108
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44727715849876404
loss_pred:0.04625779390335083, decouple_loss:0.25929543375968933
The generated pressure mean: 0.4467446506023407
loss_pred:0.045688021928071976, decouple_loss:0.262225866317749
The generated pressure mean: 0.44762736558914185
loss_pred:0.046605534851551056, decouple_loss:0.26245367527008057
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471592903137207
loss_pred:0.046053413301706314, decouple_loss:0.23429206013679504
The generated pressure mean: 0.4484262764453888
loss_pred:0.0401269793510437, decouple_loss:0.2325294464826584
The generated pressure mean: 0.4472806751728058
loss_pred:0.043530769646167755, decouple_loss:0.2345285415649414
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467145502567291
loss_pred:0.045443709939718246, decouple_loss:0.20328018069267273
The generated pressure mean: 0.44756051898002625
loss_pred:0.04191741719841957, decouple_loss:0.2054576873779297
The generated pressure mean: 0.4470946192741394
loss_pred:0.04171813651919365, decouple_loss:0.20446796715259552
2023-04-16 12:24:18 testing...
The generated pressure mean: 0.45025351643562317
loss_pred:0.09040404111146927, decouple_loss:0.18344010412693024
The generated pressure mean: 0.4503258466720581
loss_pred:0.08774237334728241, decouple_loss:0.18775101006031036
The generated pressure mean: 0.4500330686569214
loss_pred:0.08829379081726074, decouple_loss:0.18740414083003998
WV_1_PC_1_EH_1_PS_40, loss: 0.09812332689762115, avg_mse: 0.13090983033180237
current test mse: 0.13091
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44661587476730347
The generated pressure mean: 0.4477695822715759loss_pred:0.03761538118124008, decouple_loss:0.18059717118740082
loss_pred:0.03756803646683693, decouple_loss:0.1827056109905243
The generated pressure mean: 0.447483092546463
loss_pred:0.038686901330947876, decouple_loss:0.1830335557460785
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474368095397949
loss_pred:0.03793910890817642, decouple_loss:0.15102100372314453
The generated pressure mean: 0.44733569025993347
loss_pred:0.037691596895456314, decouple_loss:0.1494978368282318
The generated pressure mean: 0.4482910633087158
loss_pred:0.038351260125637054, decouple_loss:0.14835862815380096
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44822096824645996
The generated pressure mean: 0.4473358392715454loss_pred:0.03691868856549263, decouple_loss:0.12758032977581024
loss_pred:0.033312082290649414, decouple_loss:0.1263662725687027
The generated pressure mean: 0.4465975761413574
loss_pred:0.03514574468135834, decouple_loss:0.12778271734714508
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483846426010132
loss_pred:0.0354330912232399, decouple_loss:0.11390355229377747
The generated pressure mean: 0.4476562738418579
loss_pred:0.033006682991981506, decouple_loss:0.11071912944316864
The generated pressure mean: 0.44687312841415405
loss_pred:0.034174125641584396, decouple_loss:0.1142219752073288
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474884271621704
loss_pred:0.03357760235667229, decouple_loss:0.10208714008331299
The generated pressure mean: 0.4475453197956085
loss_pred:0.0323403924703598, decouple_loss:0.10215946286916733
The generated pressure mean: 0.44767922163009644
loss_pred:0.03380537033081055, decouple_loss:0.10181568562984467
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466734826564789
loss_pred:0.03456486389040947, decouple_loss:0.09077958762645721
The generated pressure mean: 0.4468247890472412
loss_pred:0.03292844817042351, decouple_loss:0.0913485661149025
The generated pressure mean: 0.4486589729785919
loss_pred:0.032977063208818436, decouple_loss:0.09042563289403915
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447112500667572
The generated pressure mean: 0.44793158769607544
loss_pred:0.03165170177817345, decouple_loss:0.08230897039175034
loss_pred:0.031964585185050964, decouple_loss:0.08427662402391434
The generated pressure mean: 0.44746217131614685
loss_pred:0.03175870701670647, decouple_loss:0.08209309726953506
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44792506098747253The generated pressure mean: 0.44779983162879944
loss_pred:0.029866652563214302, decouple_loss:0.07641145586967468
loss_pred:0.030866920948028564, decouple_loss:0.07744674384593964
The generated pressure mean: 0.44737422466278076
loss_pred:0.029990360140800476, decouple_loss:0.07549255341291428
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44899603724479675
The generated pressure mean: 0.44808492064476013
loss_pred:0.028444770723581314, decouple_loss:0.06973352283239365
loss_pred:0.02900749258697033, decouple_loss:0.0707719698548317
The generated pressure mean: 0.44753509759902954
loss_pred:0.028766576200723648, decouple_loss:0.07111717760562897
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476870000362396
loss_pred:0.02837550640106201, decouple_loss:0.06583019345998764
The generated pressure mean: 0.44663766026496887
loss_pred:0.028960831463336945, decouple_loss:0.06708722561597824
The generated pressure mean: 0.4466097950935364
loss_pred:0.02928186021745205, decouple_loss:0.06682839244604111
2023-04-16 12:26:23 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.105049267411232, decouple_loss:0.08664406090974808
The generated pressure mean: 0.4500308632850647
loss_pred:0.10354176163673401, decouple_loss:0.0874498188495636
The generated pressure mean: 0.45032474398612976
loss_pred:0.10219107568264008, decouple_loss:0.09201595187187195
WV_1_PC_1_EH_1_PS_40, loss: 0.10802920907735825, avg_mse: 0.1736377626657486
current test mse: 0.173638
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472253620624542
loss_pred:0.028098387643694878, decouple_loss:0.06433771550655365
The generated pressure mean: 0.4466707408428192
loss_pred:0.029952924698591232, decouple_loss:0.06610382348299026
The generated pressure mean: 0.44812607765197754
loss_pred:0.030316395685076714, decouple_loss:0.06576134264469147
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44786927103996277
loss_pred:0.02767498418688774, decouple_loss:0.06364380568265915
The generated pressure mean: 0.4484216570854187
loss_pred:0.0283979419618845, decouple_loss:0.06296766549348831
The generated pressure mean: 0.4466433823108673
loss_pred:0.028642263263463974, decouple_loss:0.06145308539271355
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469783306121826
The generated pressure mean: 0.4477403461933136
loss_pred:0.025543738156557083, decouple_loss:0.0596238449215889
loss_pred:0.027427105233073235, decouple_loss:0.06186610832810402
The generated pressure mean: 0.44751012325286865
loss_pred:0.02657298371195793, decouple_loss:0.06145825982093811
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44717687368392944
loss_pred:0.026760898530483246, decouple_loss:0.051837921142578125
The generated pressure mean: 0.4486944377422333
loss_pred:0.02883681282401085, decouple_loss:0.055380139499902725
The generated pressure mean: 0.44743040204048157
loss_pred:0.029457684606313705, decouple_loss:0.05338408052921295
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44741496443748474
loss_pred:0.024556301534175873, decouple_loss:0.05795590206980705
The generated pressure mean: 0.4472043812274933
loss_pred:0.02646492049098015, decouple_loss:0.05519885569810867
The generated pressure mean: 0.4472689926624298
loss_pred:0.02842269092798233, decouple_loss:0.05334070697426796
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470959007740021
loss_pred:0.026297487318515778, decouple_loss:0.054598238319158554
The generated pressure mean: 0.44773364067077637
loss_pred:0.026216981932520866, decouple_loss:0.055299606174230576
The generated pressure mean: 0.44710469245910645
loss_pred:0.02598762698471546, decouple_loss:0.05633044242858887
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44778087735176086
loss_pred:0.023349162191152573, decouple_loss:0.045445773750543594
The generated pressure mean: 0.4481099545955658
loss_pred:0.024652911350131035, decouple_loss:0.04698074981570244
The generated pressure mean: 0.4477401077747345
loss_pred:0.02628280781209469, decouple_loss:0.04573341831564903
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44932979345321655
loss_pred:0.024543847888708115, decouple_loss:0.04963459074497223
The generated pressure mean: 0.4476098418235779
loss_pred:0.027121109887957573, decouple_loss:0.05240017548203468
The generated pressure mean: 0.44760003685951233
loss_pred:0.024791542440652847, decouple_loss:0.0484805591404438
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44838154315948486
The generated pressure mean: 0.4478692412376404
loss_pred:0.024853060021996498, decouple_loss:0.04699494689702988
loss_pred:0.03189753741025925, decouple_loss:0.04654933884739876
The generated pressure mean: 0.4486124515533447
loss_pred:0.025210026651620865, decouple_loss:0.047354768961668015
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44796282052993774
loss_pred:0.028792329132556915, decouple_loss:0.03917188569903374
The generated pressure mean: 0.44785046577453613
loss_pred:0.026087775826454163, decouple_loss:0.04069766029715538
The generated pressure mean: 0.44752684235572815
loss_pred:0.02584872953593731, decouple_loss:0.040645781904459
2023-04-16 12:29:04 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.10445811599493027, decouple_loss:0.07587509602308273
The generated pressure mean: 0.45032379031181335
loss_pred:0.1029069721698761, decouple_loss:0.07675646245479584
The generated pressure mean: 0.45003077387809753
loss_pred:0.10428977012634277, decouple_loss:0.07724310457706451
WV_1_PC_1_EH_1_PS_40, loss: 0.10771620273590088, avg_mse: 0.18175791203975677
current test mse: 0.181758
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478910565376282
The generated pressure mean: 0.44795098900794983
loss_pred:0.025384726002812386, decouple_loss:0.04212939739227295
loss_pred:0.02528255060315132, decouple_loss:0.041408974677324295
The generated pressure mean: 0.4487544000148773
loss_pred:0.025439366698265076, decouple_loss:0.04010070115327835
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44728097319602966
loss_pred:0.02515617571771145, decouple_loss:0.039643097668886185
The generated pressure mean: 0.4472512900829315
loss_pred:0.024592801928520203, decouple_loss:0.043770890682935715
The generated pressure mean: 0.44897568225860596
loss_pred:0.02558170072734356, decouple_loss:0.04273102059960365
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479689300060272
The generated pressure mean: 0.4473649859428406
loss_pred:0.023381194099783897, decouple_loss:0.03657156229019165
loss_pred:0.024411583319306374, decouple_loss:0.03729616105556488
The generated pressure mean: 0.448721319437027
loss_pred:0.023003701120615005, decouple_loss:0.035454630851745605
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44804587960243225
loss_pred:0.024466708302497864, decouple_loss:0.03569168597459793
The generated pressure mean: 0.44878605008125305
loss_pred:0.023130835965275764, decouple_loss:0.04124412685632706
The generated pressure mean: 0.4477483332157135
loss_pred:0.024296920746564865, decouple_loss:0.03645794466137886
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44882118701934814
loss_pred:0.023964734748005867, decouple_loss:0.03780016675591469
The generated pressure mean: 0.4467189610004425
loss_pred:0.02667226828634739, decouple_loss:0.03690037131309509
The generated pressure mean: 0.44719719886779785
loss_pred:0.024567967280745506, decouple_loss:0.03818314149975777
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485214948654175
loss_pred:0.0249598678201437, decouple_loss:0.03590298071503639
The generated pressure mean: 0.447467178106308
loss_pred:0.02362365648150444, decouple_loss:0.034969836473464966
The generated pressure mean: 0.4477667808532715
loss_pred:0.02319960482418537, decouple_loss:0.0332433320581913
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44748860597610474
loss_pred:0.022183099761605263, decouple_loss:0.032661791890859604
The generated pressure mean: 0.44802790880203247
loss_pred:0.023187540471553802, decouple_loss:0.031396426260471344
The generated pressure mean: 0.44719842076301575
loss_pred:0.02234668843448162, decouple_loss:0.03263041377067566
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469487965106964The generated pressure mean: 0.44776737689971924
loss_pred:0.023973001167178154, decouple_loss:0.03499265015125275loss_pred:0.023775719106197357, decouple_loss:0.03671012446284294
The generated pressure mean: 0.448239803314209
loss_pred:0.025955043733119965, decouple_loss:0.0357760526239872
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482727646827698
loss_pred:0.023002633824944496, decouple_loss:0.02949700318276882
The generated pressure mean: 0.44872117042541504
loss_pred:0.023165041580796242, decouple_loss:0.03575032204389572
The generated pressure mean: 0.4477772116661072
loss_pred:0.023263640701770782, decouple_loss:0.030458921566605568
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475308358669281
loss_pred:0.023047279566526413, decouple_loss:0.029486842453479767
The generated pressure mean: 0.448786199092865
loss_pred:0.02169141359627247, decouple_loss:0.02897459827363491
The generated pressure mean: 0.44788092374801636
loss_pred:0.024155516177415848, decouple_loss:0.030468493700027466
2023-04-16 12:31:09 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.11618231236934662, decouple_loss:0.06314673274755478
The generated pressure mean: 0.45032089948654175
loss_pred:0.11373413354158401, decouple_loss:0.06398478150367737
The generated pressure mean: 0.4500323534011841
loss_pred:0.1150122582912445, decouple_loss:0.06423244625329971
WV_1_PC_1_EH_1_PS_40, loss: 0.11816563457250595, avg_mse: 0.2115248292684555
current test mse: 0.211525
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489860236644745
loss_pred:0.024068154394626617, decouple_loss:0.02644047699868679
The generated pressure mean: 0.4497664272785187
loss_pred:0.023382533341646194, decouple_loss:0.027346447110176086
The generated pressure mean: 0.44767922163009644
loss_pred:0.022360624745488167, decouple_loss:0.02750917337834835
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477818012237549
loss_pred:0.023124005645513535, decouple_loss:0.027855781838297844
The generated pressure mean: 0.44842100143432617
loss_pred:0.022681403905153275, decouple_loss:0.029559416696429253
The generated pressure mean: 0.44813889265060425
loss_pred:0.023124676197767258, decouple_loss:0.028925925493240356
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483031928539276
loss_pred:0.02616974711418152, decouple_loss:0.02703774720430374
The generated pressure mean: 0.4481777548789978
loss_pred:0.02406338043510914, decouple_loss:0.02598818764090538
The generated pressure mean: 0.44772204756736755
loss_pred:0.02565055340528488, decouple_loss:0.025098107755184174
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4509533643722534
loss_pred:0.023308755829930305, decouple_loss:0.02611926756799221
The generated pressure mean: 0.44916167855262756
loss_pred:0.021920450031757355, decouple_loss:0.026316551491618156
The generated pressure mean: 0.4488525688648224
loss_pred:0.02443390153348446, decouple_loss:0.025367682799696922
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44882696866989136
loss_pred:0.022382859140634537, decouple_loss:0.02816212922334671
The generated pressure mean: 0.45003047585487366
loss_pred:0.021982895210385323, decouple_loss:0.026146581396460533
The generated pressure mean: 0.4479124844074249
loss_pred:0.020760908722877502, decouple_loss:0.025251479819417
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476814270019531
loss_pred:0.02187449485063553, decouple_loss:0.029962852597236633
The generated pressure mean: 0.4489031732082367
loss_pred:0.02573627047240734, decouple_loss:0.027903098613023758
The generated pressure mean: 0.4485109746456146
loss_pred:0.022755920886993408, decouple_loss:0.028611240908503532
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44918206334114075
loss_pred:0.021840937435626984, decouple_loss:0.023966845124959946
The generated pressure mean: 0.4487389624118805
loss_pred:0.02383348159492016, decouple_loss:0.024376042187213898
The generated pressure mean: 0.4492783546447754
loss_pred:0.02304958365857601, decouple_loss:0.022702988237142563
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491823613643646
loss_pred:0.023804068565368652, decouple_loss:0.022901499643921852
The generated pressure mean: 0.4478532373905182
loss_pred:0.022061150521039963, decouple_loss:0.02155420556664467
The generated pressure mean: 0.44976097345352173
loss_pred:0.024209389463067055, decouple_loss:0.02138083428144455
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44878891110420227
loss_pred:0.022978613153100014, decouple_loss:0.021455254405736923
The generated pressure mean: 0.44898754358291626
loss_pred:0.02338986098766327, decouple_loss:0.01990664377808571
The generated pressure mean: 0.4488624632358551
loss_pred:0.023640848696231842, decouple_loss:0.020393460988998413
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44931477308273315
loss_pred:0.022735606878995895, decouple_loss:0.021983163431286812
The generated pressure mean: 0.44825607538223267
loss_pred:0.02109052985906601, decouple_loss:0.021763699129223824
The generated pressure mean: 0.4479862153530121
loss_pred:0.021701447665691376, decouple_loss:0.02180548384785652
2023-04-16 12:33:48 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.12318669259548187, decouple_loss:0.06289833784103394
The generated pressure mean: 0.45032423734664917
loss_pred:0.1213502287864685, decouple_loss:0.0630471259355545
The generated pressure mean: 0.45003148913383484
loss_pred:0.12323950231075287, decouple_loss:0.06356668472290039
WV_1_PC_1_EH_1_PS_40, loss: 0.12575069069862366, avg_mse: 0.23100249469280243
current test mse: 0.231002
Iteration: 51, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502795934677124
loss_pred:0.022247314453125, decouple_loss:0.025585506111383438
The generated pressure mean: 0.4488202929496765
loss_pred:0.022629136219620705, decouple_loss:0.025467975065112114
The generated pressure mean: 0.44898465275764465
loss_pred:0.02205202728509903, decouple_loss:0.027253011241555214
Iteration: 52, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482022523880005
loss_pred:0.022332601249217987, decouple_loss:0.021636418998241425
The generated pressure mean: 0.44893285632133484
loss_pred:0.021184587851166725, decouple_loss:0.024060800671577454
The generated pressure mean: 0.4480917751789093
loss_pred:0.022579291835427284, decouple_loss:0.024381935596466064
Iteration: 53, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449093222618103
loss_pred:0.021652068942785263, decouple_loss:0.02294045500457287
The generated pressure mean: 0.44777047634124756
loss_pred:0.023597903549671173, decouple_loss:0.02122480794787407
The generated pressure mean: 0.44904664158821106
loss_pred:0.020500032231211662, decouple_loss:0.02441060170531273
Iteration: 54, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45052990317344666
loss_pred:0.02250709757208824, decouple_loss:0.020579440519213676
The generated pressure mean: 0.4482886493206024
loss_pred:0.0217722300440073, decouple_loss:0.021223008632659912
The generated pressure mean: 0.4481179118156433
loss_pred:0.021708611398935318, decouple_loss:0.020860595628619194
Iteration: 55, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487118721008301
loss_pred:0.021430201828479767, decouple_loss:0.023226412013173103
The generated pressure mean: 0.44839760661125183
loss_pred:0.02172083780169487, decouple_loss:0.02151356264948845
The generated pressure mean: 0.449017196893692
loss_pred:0.022452859207987785, decouple_loss:0.021053913980722427
Iteration: 56, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44862568378448486
loss_pred:0.021591246128082275, decouple_loss:0.018928425386548042
The generated pressure mean: 0.44834861159324646
loss_pred:0.021811626851558685, decouple_loss:0.02080964855849743
The generated pressure mean: 0.4487012028694153
loss_pred:0.021633638069033623, decouple_loss:0.0189790241420269
Iteration: 57, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44834861159324646
loss_pred:0.02026510424911976, decouple_loss:0.017760563641786575
The generated pressure mean: 0.4488047659397125
loss_pred:0.022785905748605728, decouple_loss:0.018359526991844177
The generated pressure mean: 0.448668509721756
loss_pred:0.021895738318562508, decouple_loss:0.019950035959482193
Iteration: 58, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479871392250061
loss_pred:0.021570637822151184, decouple_loss:0.017196478322148323
The generated pressure mean: 0.447951078414917
loss_pred:0.022482629865407944, decouple_loss:0.016593841835856438
The generated pressure mean: 0.4484298527240753
loss_pred:0.021649757400155067, decouple_loss:0.01760886050760746
Iteration: 59, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448081374168396
The generated pressure mean: 0.4492354691028595
loss_pred:0.02337043546140194, decouple_loss:0.01856563612818718
loss_pred:0.02467929944396019, decouple_loss:0.01798797957599163
The generated pressure mean: 0.44861507415771484
loss_pred:0.021458817645907402, decouple_loss:0.018763095140457153
Iteration: 60, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500839114189148
loss_pred:0.023249369114637375, decouple_loss:0.017179107293486595
The generated pressure mean: 0.4486011862754822
loss_pred:0.02128872461616993, decouple_loss:0.017940403893589973
The generated pressure mean: 0.44796881079673767
loss_pred:0.020797038450837135, decouple_loss:0.018018236383795738
2023-04-16 12:35:55 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.1266094148159027, decouple_loss:0.05148141831159592
The generated pressure mean: 0.45032528042793274
loss_pred:0.1251634657382965, decouple_loss:0.05271303653717041
The generated pressure mean: 0.45003172755241394
loss_pred:0.12654365599155426, decouple_loss:0.052980534732341766
WV_1_PC_1_EH_1_PS_40, loss: 0.1287251114845276, avg_mse: 0.24113821983337402
current test mse: 0.241138
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 61, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487029016017914
loss_pred:0.021483255550265312, decouple_loss:0.018702151253819466
The generated pressure mean: 0.4480973184108734
loss_pred:0.022095080465078354, decouple_loss:0.02036009170114994
The generated pressure mean: 0.4471452534198761
loss_pred:0.02304050326347351, decouple_loss:0.018626095727086067
Iteration: 62, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483974874019623
loss_pred:0.02170684188604355, decouple_loss:0.018507642671465874
The generated pressure mean: 0.44848212599754333
loss_pred:0.020630624145269394, decouple_loss:0.019149113446474075
The generated pressure mean: 0.44906309247016907
loss_pred:0.02131372131407261, decouple_loss:0.021733775734901428
Iteration: 63, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44809508323669434
loss_pred:0.021000854671001434, decouple_loss:0.02288614585995674
The generated pressure mean: 0.44862475991249084
loss_pred:0.020474838092923164, decouple_loss:0.022674204781651497
The generated pressure mean: 0.4474721848964691
loss_pred:0.02172396332025528, decouple_loss:0.02381269447505474
Iteration: 64, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44793128967285156
loss_pred:0.0225082878023386, decouple_loss:0.02254793979227543
The generated pressure mean: 0.4470251798629761
loss_pred:0.022968919947743416, decouple_loss:0.02179563231766224
The generated pressure mean: 0.447243332862854
loss_pred:0.022247204557061195, decouple_loss:0.021097075194120407
Iteration: 65, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44774582982063293
loss_pred:0.020766528323292732, decouple_loss:0.019714919850230217
The generated pressure mean: 0.44878485798835754
loss_pred:0.020897623151540756, decouple_loss:0.021223898977041245
The generated pressure mean: 0.44768765568733215
loss_pred:0.021432355046272278, decouple_loss:0.020210854709148407
Iteration: 66, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487539529800415
loss_pred:0.02065620757639408, decouple_loss:0.02009047381579876
The generated pressure mean: 0.44817525148391724
loss_pred:0.023152561858296394, decouple_loss:0.01638680137693882
The generated pressure mean: 0.44839760661125183
loss_pred:0.023294664919376373, decouple_loss:0.01716754399240017
Iteration: 67, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483967125415802
loss_pred:0.021352628245949745, decouple_loss:0.020543383434414864
The generated pressure mean: 0.4477974474430084
loss_pred:0.0192888081073761, decouple_loss:0.02059139870107174
The generated pressure mean: 0.44773316383361816
loss_pred:0.020881500095129013, decouple_loss:0.020344283431768417
Iteration: 68, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44804275035858154
loss_pred:0.020871607586741447, decouple_loss:0.02014433778822422
The generated pressure mean: 0.44835102558135986
loss_pred:0.021367914974689484, decouple_loss:0.019274894148111343
The generated pressure mean: 0.44792357087135315
loss_pred:0.021573157981038094, decouple_loss:0.020459428429603577
Iteration: 69, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44751593470573425
loss_pred:0.020604420453310013, decouple_loss:0.01868877373635769
The generated pressure mean: 0.4495077431201935
loss_pred:0.020860714837908745, decouple_loss:0.019619060680270195
The generated pressure mean: 0.4486130177974701
loss_pred:0.020914064720273018, decouple_loss:0.019486725330352783
Iteration: 70, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44785046577453613
loss_pred:0.021459121257066727, decouple_loss:0.0214383527636528
The generated pressure mean: 0.44809165596961975
loss_pred:0.019067710265517235, decouple_loss:0.019047750160098076
The generated pressure mean: 0.4494192898273468
loss_pred:0.020652011036872864, decouple_loss:0.021910017356276512
2023-04-16 12:38:37 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.12704522907733917, decouple_loss:0.052756309509277344
The generated pressure mean: 0.4500313103199005
loss_pred:0.1269582360982895, decouple_loss:0.05370571091771126
The generated pressure mean: 0.4503248929977417
loss_pred:0.12574796378612518, decouple_loss:0.05344730615615845
WV_1_PC_1_EH_1_PS_40, loss: 0.1292489618062973, avg_mse: 0.24259178340435028
current test mse: 0.242592
Iteration: 71, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44833236932754517
loss_pred:0.021907750517129898, decouple_loss:0.0202752985060215
The generated pressure mean: 0.44722068309783936
loss_pred:0.02092049829661846, decouple_loss:0.021040787920355797
The generated pressure mean: 0.44756975769996643
loss_pred:0.020746545866131783, decouple_loss:0.020353829488158226
Iteration: 72, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44768020510673523
The generated pressure mean: 0.4488990902900696loss_pred:0.021950460970401764, decouple_loss:0.01895289495587349
loss_pred:0.020916525274515152, decouple_loss:0.01882118172943592
The generated pressure mean: 0.44915100932121277
loss_pred:0.02075895667076111, decouple_loss:0.018498115241527557
Iteration: 73, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488358795642853
The generated pressure mean: 0.4486958384513855loss_pred:0.02203870192170143, decouple_loss:0.020237188786268234
loss_pred:0.020853690803050995, decouple_loss:0.02172136679291725
The generated pressure mean: 0.44934192299842834
loss_pred:0.019265417009592056, decouple_loss:0.02225619927048683
Iteration: 74, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497535824775696
loss_pred:0.021700644865632057, decouple_loss:0.020658185705542564
The generated pressure mean: 0.44821053743362427
loss_pred:0.020838769152760506, decouple_loss:0.017049124464392662
The generated pressure mean: 0.4490041434764862
loss_pred:0.021266786381602287, decouple_loss:0.018153367564082146
Iteration: 75, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44730523228645325
loss_pred:0.01995840109884739, decouple_loss:0.019499320536851883
The generated pressure mean: 0.44777795672416687
loss_pred:0.020543688908219337, decouple_loss:0.01844409666955471
The generated pressure mean: 0.4486595690250397
loss_pred:0.021133530884981155, decouple_loss:0.018428627401590347
Iteration: 76, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482852518558502
loss_pred:0.020688408985733986, decouple_loss:0.01927086152136326
The generated pressure mean: 0.44779449701309204
loss_pred:0.020265458151698112, decouple_loss:0.017714587971568108
The generated pressure mean: 0.44780233502388
loss_pred:0.019826479256153107, decouple_loss:0.020144760608673096
Iteration: 77, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489791989326477
loss_pred:0.02044365368783474, decouple_loss:0.020392820239067078
The generated pressure mean: 0.4490651488304138
loss_pred:0.02189869061112404, decouple_loss:0.020612027496099472
The generated pressure mean: 0.44858017563819885
loss_pred:0.019900210201740265, decouple_loss:0.01964389905333519
Iteration: 78, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486996829509735
loss_pred:0.020076217129826546, decouple_loss:0.016756119206547737
The generated pressure mean: 0.4474320411682129
loss_pred:0.021464955061674118, decouple_loss:0.016219789162278175
The generated pressure mean: 0.4474721848964691
loss_pred:0.020627940073609352, decouple_loss:0.01639503613114357
Iteration: 79, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44779714941978455
loss_pred:0.01945957913994789, decouple_loss:0.01727316901087761
The generated pressure mean: 0.4492420256137848
loss_pred:0.020049214363098145, decouple_loss:0.016535762697458267
The generated pressure mean: 0.4479843080043793
loss_pred:0.021025564521551132, decouple_loss:0.017550207674503326
Iteration: 80, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477177858352661
loss_pred:0.019359536468982697, decouple_loss:0.015544733963906765
The generated pressure mean: 0.44853660464286804
loss_pred:0.019259266555309296, decouple_loss:0.01563798077404499
The generated pressure mean: 0.4477553069591522
loss_pred:0.02330762706696987, decouple_loss:0.015732964500784874
2023-04-16 12:40:43 testing...
The generated pressure mean: 0.4502691924571991
loss_pred:0.1301010400056839, decouple_loss:0.04504361376166344
The generated pressure mean: 0.45003047585487366
loss_pred:0.12964721024036407, decouple_loss:0.04591124877333641
The generated pressure mean: 0.45032382011413574
loss_pred:0.12870250642299652, decouple_loss:0.04623376578092575
WV_1_PC_1_EH_1_PS_40, loss: 0.1317700743675232, avg_mse: 0.2509520351886749
current test mse: 0.250952
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 81, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480094313621521
loss_pred:0.02105586789548397, decouple_loss:0.016642317175865173
The generated pressure mean: 0.4493415355682373
loss_pred:0.02059902995824814, decouple_loss:0.01680995710194111
The generated pressure mean: 0.44874754548072815
loss_pred:0.020662540569901466, decouple_loss:0.016347870230674744
Iteration: 82, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492151141166687
loss_pred:0.02150101773440838, decouple_loss:0.016460394486784935
The generated pressure mean: 0.4484817683696747
loss_pred:0.02062634564936161, decouple_loss:0.016564257442951202
The generated pressure mean: 0.44896262884140015
loss_pred:0.021678227931261063, decouple_loss:0.016302652657032013
Iteration: 83, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480005204677582
loss_pred:0.021686404943466187, decouple_loss:0.01669275388121605
The generated pressure mean: 0.44826778769493103
loss_pred:0.020690180361270905, decouple_loss:0.016591956838965416
The generated pressure mean: 0.44777607917785645
loss_pred:0.02225189283490181, decouple_loss:0.017605213448405266
Iteration: 84, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487158954143524
loss_pred:0.023471953347325325, decouple_loss:0.015181902796030045
The generated pressure mean: 0.4490710496902466
loss_pred:0.02053794451057911, decouple_loss:0.01610017567873001
The generated pressure mean: 0.4468577802181244
loss_pred:0.020992862060666084, decouple_loss:0.01645008847117424
Iteration: 85, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44809406995773315
loss_pred:0.0203841682523489, decouple_loss:0.017532262951135635
The generated pressure mean: 0.448589563369751
loss_pred:0.02161075547337532, decouple_loss:0.02030886895954609
The generated pressure mean: 0.4486941993236542
loss_pred:0.022132080048322678, decouple_loss:0.019688140600919724
Iteration: 86, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473658800125122
loss_pred:0.020435519516468048, decouple_loss:0.018852170556783676
The generated pressure mean: 0.44827699661254883
loss_pred:0.023089556023478508, decouple_loss:0.018703563138842583
The generated pressure mean: 0.4465518295764923
loss_pred:0.02066422626376152, decouple_loss:0.01915104314684868
Iteration: 87, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44827598333358765
loss_pred:0.020573576912283897, decouple_loss:0.014966997317969799
The generated pressure mean: 0.4480644762516022
loss_pred:0.0200857724994421, decouple_loss:0.015277526341378689
The generated pressure mean: 0.44787925481796265
loss_pred:0.020300831645727158, decouple_loss:0.016631221398711205
Iteration: 88, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44946396350860596
loss_pred:0.021592281758785248, decouple_loss:0.023109709843993187
The generated pressure mean: 0.4492436647415161
loss_pred:0.021848855540156364, decouple_loss:0.02110278233885765
The generated pressure mean: 0.4480145573616028
loss_pred:0.02086089365184307, decouple_loss:0.019854510203003883
Iteration: 89, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475937485694885
loss_pred:0.0199170783162117, decouple_loss:0.015159565024077892
The generated pressure mean: 0.4478603005409241
loss_pred:0.020435307174921036, decouple_loss:0.015873145312070847
The generated pressure mean: 0.4492640197277069
loss_pred:0.02099619433283806, decouple_loss:0.01649186573922634
Iteration: 90, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479926824569702
loss_pred:0.024384472519159317, decouple_loss:0.01806257665157318
The generated pressure mean: 0.4483940005302429
loss_pred:0.02439112402498722, decouple_loss:0.017744766548275948
The generated pressure mean: 0.44712159037590027
loss_pred:0.02003292925655842, decouple_loss:0.01834830269217491
2023-04-16 12:43:24 testing...
The generated pressure mean: 0.4502691626548767
loss_pred:0.12341402471065521, decouple_loss:0.04331403598189354
The generated pressure mean: 0.4503236413002014
loss_pred:0.1213151067495346, decouple_loss:0.04426475241780281
The generated pressure mean: 0.45003026723861694
loss_pred:0.1225166916847229, decouple_loss:0.04431435093283653
WV_1_PC_1_EH_1_PS_40, loss: 0.12461349368095398, avg_mse: 0.2329668551683426
current test mse: 0.232967
Iteration: 91, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483586251735687
The generated pressure mean: 0.4474276006221771
loss_pred:0.020570963621139526, decouple_loss:0.014024483039975166
loss_pred:0.02210811711847782, decouple_loss:0.015153374522924423
The generated pressure mean: 0.44753357768058777
loss_pred:0.02085704728960991, decouple_loss:0.015203284099698067
Iteration: 92, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44822821021080017
The generated pressure mean: 0.44748130440711975
loss_pred:0.020652277395129204, decouple_loss:0.017002539709210396
loss_pred:0.021238695830106735, decouple_loss:0.016903666779398918
The generated pressure mean: 0.44804808497428894
loss_pred:0.020310014486312866, decouple_loss:0.01702071540057659
Iteration: 93, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481261670589447
loss_pred:0.020727988332509995, decouple_loss:0.015238224528729916
The generated pressure mean: 0.44751399755477905
loss_pred:0.020472537726163864, decouple_loss:0.015349975787103176
The generated pressure mean: 0.4478967785835266
loss_pred:0.020823771134018898, decouple_loss:0.015400923788547516
Iteration: 94, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481998085975647
loss_pred:0.02213791385293007, decouple_loss:0.01632545329630375
The generated pressure mean: 0.4483067989349365
loss_pred:0.01961382105946541, decouple_loss:0.015778454020619392
The generated pressure mean: 0.4482916593551636
loss_pred:0.01995977945625782, decouple_loss:0.016255546361207962
Iteration: 95, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44744765758514404
loss_pred:0.02185085043311119, decouple_loss:0.01653970032930374
The generated pressure mean: 0.4469567835330963
loss_pred:0.020972246304154396, decouple_loss:0.017106084153056145
The generated pressure mean: 0.44775834679603577
loss_pred:0.020676257088780403, decouple_loss:0.01729116030037403
Iteration: 96, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44786062836647034
loss_pred:0.020267492160201073, decouple_loss:0.015266402624547482
The generated pressure mean: 0.44780784845352173
loss_pred:0.02178654819726944, decouple_loss:0.018425168469548225
The generated pressure mean: 0.44620281457901
loss_pred:0.020565742626786232, decouple_loss:0.016900964081287384
Iteration: 97, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490337073802948
loss_pred:0.019932864233851433, decouple_loss:0.017151303589344025
The generated pressure mean: 0.44847190380096436
loss_pred:0.019102931022644043, decouple_loss:0.015091118402779102
The generated pressure mean: 0.44847220182418823
loss_pred:0.02096656523644924, decouple_loss:0.015574950724840164
Iteration: 98, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486134946346283
loss_pred:0.022214893251657486, decouple_loss:0.017373718321323395
The generated pressure mean: 0.4483097493648529
loss_pred:0.020720381289720535, decouple_loss:0.017439305782318115
The generated pressure mean: 0.4483974277973175
loss_pred:0.019621537998318672, decouple_loss:0.01823347806930542
Iteration: 99, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44869452714920044
The generated pressure mean: 0.4476105570793152
loss_pred:0.019368229433894157, decouple_loss:0.015350265428423882
loss_pred:0.021554408594965935, decouple_loss:0.0161021426320076
The generated pressure mean: 0.4473530054092407
loss_pred:0.019415637478232384, decouple_loss:0.01507555041462183
Iteration: 100, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481827914714813
loss_pred:0.02049873024225235, decouple_loss:0.015088255517184734
The generated pressure mean: 0.4470517337322235
loss_pred:0.020011916756629944, decouple_loss:0.015114582143723965
The generated pressure mean: 0.4492262601852417
loss_pred:0.0199084784835577, decouple_loss:0.01582045666873455
2023-04-16 12:45:30 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.12648749351501465, decouple_loss:0.042034488171339035
The generated pressure mean: 0.45032447576522827
loss_pred:0.12497834861278534, decouple_loss:0.04268667474389076
The generated pressure mean: 0.4500308930873871
loss_pred:0.12585285305976868, decouple_loss:0.04258371889591217
WV_1_PC_1_EH_1_PS_40, loss: 0.12789463996887207, avg_mse: 0.24352571368217468
current test mse: 0.243526
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
Iteration: 101, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472864270210266
loss_pred:0.020559391006827354, decouple_loss:0.013685634359717369
The generated pressure mean: 0.4476431608200073
loss_pred:0.022662831470370293, decouple_loss:0.014962940476834774
The generated pressure mean: 0.44653263688087463
loss_pred:0.023410746827721596, decouple_loss:0.014812113717198372
Iteration: 102, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473295509815216
loss_pred:0.020553261041641235, decouple_loss:0.014949733391404152
The generated pressure mean: 0.4472334086894989
loss_pred:0.020924633368849754, decouple_loss:0.015336773358285427
The generated pressure mean: 0.4473887085914612
loss_pred:0.01975289173424244, decouple_loss:0.015968767926096916
Iteration: 103, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44775161147117615
loss_pred:0.020504049956798553, decouple_loss:0.015475617721676826
The generated pressure mean: 0.44704920053482056
loss_pred:0.021014364436268806, decouple_loss:0.015769347548484802
The generated pressure mean: 0.4469417929649353
loss_pred:0.021709563210606575, decouple_loss:0.01585604064166546
Iteration: 104, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482231140136719
The generated pressure mean: 0.4457460045814514
loss_pred:0.02236848510801792, decouple_loss:0.01558563020080328
loss_pred:0.02015705406665802, decouple_loss:0.014439201913774014
The generated pressure mean: 0.44643428921699524
loss_pred:0.022345876321196556, decouple_loss:0.014308079145848751
Iteration: 105, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44690167903900146
loss_pred:0.02056640200316906, decouple_loss:0.014436285942792892
The generated pressure mean: 0.44648733735084534
loss_pred:0.02247912622988224, decouple_loss:0.013842250220477581
The generated pressure mean: 0.4463685154914856
loss_pred:0.021904582157731056, decouple_loss:0.014819497242569923
Iteration: 106, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44701719284057617
loss_pred:0.02199249342083931, decouple_loss:0.015410270541906357
The generated pressure mean: 0.4477277100086212
loss_pred:0.02153729274868965, decouple_loss:0.015743611380457878
The generated pressure mean: 0.44649872183799744
loss_pred:0.02117496356368065, decouple_loss:0.016306143254041672
Iteration: 107, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469922184944153
loss_pred:0.02008717879652977, decouple_loss:0.016814477741718292
The generated pressure mean: 0.4472326636314392
loss_pred:0.02180459536612034, decouple_loss:0.01755487360060215
The generated pressure mean: 0.44795936346054077
loss_pred:0.022174641489982605, decouple_loss:0.01733439415693283
Iteration: 108, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478299021720886
loss_pred:0.020387349650263786, decouple_loss:0.0138940354809165
The generated pressure mean: 0.4477337896823883
loss_pred:0.021915795281529427, decouple_loss:0.01494763232767582
The generated pressure mean: 0.4476383328437805
loss_pred:0.02306922897696495, decouple_loss:0.015526238828897476
Iteration: 109, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4454919397830963
loss_pred:0.021877991035580635, decouple_loss:0.017350761219859123
The generated pressure mean: 0.44687533378601074
loss_pred:0.01990887150168419, decouple_loss:0.01583571545779705
The generated pressure mean: 0.4462107717990875
loss_pred:0.02059730514883995, decouple_loss:0.017193742096424103
Iteration: 110, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44675517082214355
loss_pred:0.021445808932185173, decouple_loss:0.013923591002821922
The generated pressure mean: 0.4467504024505615
loss_pred:0.021036718040704727, decouple_loss:0.01379286590963602
The generated pressure mean: 0.447717547416687
loss_pred:0.021778499707579613, decouple_loss:0.013511843979358673
2023-04-16 12:48:13 testing...
The generated pressure mean: 0.4502691328525543
loss_pred:0.12351924926042557, decouple_loss:0.0392504446208477
The generated pressure mean: 0.4503261148929596
loss_pred:0.12203574925661087, decouple_loss:0.04000111296772957
The generated pressure mean: 0.45003044605255127
loss_pred:0.12291601300239563, decouple_loss:0.03988471254706383
WV_1_PC_1_EH_1_PS_40, loss: 0.12480928003787994, avg_mse: 0.23878219723701477
current test mse: 0.238782
Iteration: 111, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44717109203338623
The generated pressure mean: 0.44762536883354187
loss_pred:0.022703727707266808, decouple_loss:0.013794111087918282
loss_pred:0.022270848974585533, decouple_loss:0.014308733865618706
The generated pressure mean: 0.44613945484161377
loss_pred:0.020267542451620102, decouple_loss:0.013722690753638744
Iteration: 112, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466732442378998
The generated pressure mean: 0.44476327300071716
loss_pred:0.020674649626016617, decouple_loss:0.01590236835181713
loss_pred:0.020883148536086082, decouple_loss:0.015664856880903244
The generated pressure mean: 0.4474087357521057
loss_pred:0.02088388241827488, decouple_loss:0.015584539622068405
Iteration: 113, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465687572956085
loss_pred:0.021889638155698776, decouple_loss:0.016526419669389725
The generated pressure mean: 0.4473678469657898
loss_pred:0.021694526076316833, decouple_loss:0.016295505687594414
The generated pressure mean: 0.44707605242729187
loss_pred:0.02112472802400589, decouple_loss:0.016488300636410713
Iteration: 114, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44713515043258667
loss_pred:0.02190256677567959, decouple_loss:0.014456876553595066
The generated pressure mean: 0.44772869348526
loss_pred:0.021807720884680748, decouple_loss:0.014233354479074478
The generated pressure mean: 0.4460413157939911
loss_pred:0.02122245542705059, decouple_loss:0.013508357107639313
Iteration: 115, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470447301864624
loss_pred:0.02092714048922062, decouple_loss:0.017328564077615738
The generated pressure mean: 0.4464532434940338
loss_pred:0.02185652032494545, decouple_loss:0.017687704414129257
The generated pressure mean: 0.4462270736694336
loss_pred:0.021791527047753334, decouple_loss:0.017335446551442146
Iteration: 116, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474984407424927
The generated pressure mean: 0.4476279020309448
loss_pred:0.021346919238567352, decouple_loss:0.014984353445470333
loss_pred:0.022679990157485008, decouple_loss:0.015622975304722786
The generated pressure mean: 0.4471293091773987
loss_pred:0.020012391731142998, decouple_loss:0.015052473172545433
Iteration: 117, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471038579940796
loss_pred:0.02253931760787964, decouple_loss:0.014104465022683144
The generated pressure mean: 0.447176069021225
loss_pred:0.020607110112905502, decouple_loss:0.014816737733781338
The generated pressure mean: 0.4475894868373871
loss_pred:0.02102883718907833, decouple_loss:0.015270303934812546
Iteration: 118, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44853776693344116
The generated pressure mean: 0.4470963180065155
loss_pred:0.022610917687416077, decouple_loss:0.016095774248242378
loss_pred:0.02047848328948021, decouple_loss:0.01587674394249916
The generated pressure mean: 0.44780147075653076
loss_pred:0.02369794435799122, decouple_loss:0.016963021829724312
Iteration: 119, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476169943809509
loss_pred:0.021195635199546814, decouple_loss:0.01365637220442295
The generated pressure mean: 0.44819748401641846
loss_pred:0.022865699604153633, decouple_loss:0.013979335315525532
The generated pressure mean: 0.44626766443252563
loss_pred:0.021649854257702827, decouple_loss:0.01389265526086092
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 120, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44604963064193726
loss_pred:0.021047214046120644, decouple_loss:0.014751330018043518
The generated pressure mean: 0.44753628969192505
loss_pred:0.024273285642266273, decouple_loss:0.013169044628739357
The generated pressure mean: 0.44615525007247925
loss_pred:0.020218772813677788, decouple_loss:0.014833795838057995
