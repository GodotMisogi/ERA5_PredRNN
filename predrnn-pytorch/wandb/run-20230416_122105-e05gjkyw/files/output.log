After initialize model, args.img_channel:3
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
train_data_files nums: 41
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_09012020_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.9025978446006775
loss_pred:0.2109736204147339, decouple_loss:0.05444638058543205
The generated pressure mean: 0.900393545627594
loss_pred:0.20614780485630035, decouple_loss:0.05369022861123085
The generated pressure mean: 0.9017001986503601
loss_pred:0.21232880651950836, decouple_loss:0.05679585039615631
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.9077749252319336
The generated pressure mean: 0.908770740032196
loss_pred:0.230565145611763, decouple_loss:0.4511276185512543
loss_pred:0.22575411200523376, decouple_loss:0.4386879503726959
The generated pressure mean: 0.9073527455329895
loss_pred:0.22196480631828308, decouple_loss:0.36520838737487793
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.9120427966117859
The generated pressure mean: 0.9123821258544922
loss_pred:0.23396195471286774, decouple_loss:0.47728943824768066
loss_pred:0.23592257499694824, decouple_loss:0.504755437374115
The generated pressure mean: 0.91410893201828
loss_pred:0.23170249164104462, decouple_loss:0.505515456199646
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.9127093553543091
The generated pressure mean: 0.9145433306694031
loss_pred:0.2403435856103897, decouple_loss:0.5350174307823181
loss_pred:0.23906368017196655, decouple_loss:0.5400896072387695
The generated pressure mean: 0.9114672541618347
loss_pred:0.23771770298480988, decouple_loss:0.5334963798522949
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.8905444145202637
The generated pressure mean: 0.8886368274688721
loss_pred:0.21879735589027405, decouple_loss:0.6067212820053101
loss_pred:0.2208574265241623, decouple_loss:0.6068084239959717
The generated pressure mean: 0.8891814947128296
loss_pred:0.21494866907596588, decouple_loss:0.6126773953437805
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.9004538059234619
The generated pressure mean: 0.9010879993438721
loss_pred:0.2046211212873459, decouple_loss:0.4967653751373291
loss_pred:0.1992560178041458, decouple_loss:0.49796077609062195
The generated pressure mean: 0.9022562503814697
loss_pred:0.20164752006530762, decouple_loss:0.4951034486293793
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.9166138172149658
The generated pressure mean: 0.9156844615936279
loss_pred:0.2112211436033249, decouple_loss:0.6166114807128906
loss_pred:0.21171313524246216, decouple_loss:0.5544107556343079
The generated pressure mean: 0.9165090918540955
loss_pred:0.21577630937099457, decouple_loss:0.6253055930137634
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.8962700366973877
loss_pred:0.19573387503623962, decouple_loss:0.6234076023101807
The generated pressure mean: 0.896093487739563
loss_pred:0.19714456796646118, decouple_loss:0.5897994637489319
The generated pressure mean: 0.8957169651985168
loss_pred:0.19241788983345032, decouple_loss:0.6167154908180237
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.8719971776008606
loss_pred:0.1870763599872589, decouple_loss:0.6210058927536011
The generated pressure mean: 0.8694080114364624
loss_pred:0.18627247214317322, decouple_loss:0.6072492599487305
The generated pressure mean: 0.8687680959701538
loss_pred:0.18889261782169342, decouple_loss:0.6300132870674133
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.8731288313865662
loss_pred:0.17575767636299133, decouple_loss:0.5319324731826782
The generated pressure mean: 0.8711707592010498
loss_pred:0.18370003998279572, decouple_loss:0.5122969150543213
The generated pressure mean: 0.8719466924667358
loss_pred:0.17921759188175201, decouple_loss:0.5295604467391968
2023-04-16 12:24:08 testing...
The generated pressure mean: 0.312643438577652
The generated pressure mean: 0.3126828372478485
The generated pressure mean: 0.3124048709869385
loss_pred:0.19121910631656647, decouple_loss:0.7032676339149475
loss_pred:0.19015705585479736, decouple_loss:0.7036468386650085
loss_pred:0.19048529863357544, decouple_loss:0.7038294672966003
WV_0_PC_0_EH_1_PS_40, loss: 0.225799560546875, avg_mse: 0.1985156238079071
current test mse: 0.198516
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.8474828004837036
The generated pressure mean: 0.8510827422142029
loss_pred:0.17501504719257355, decouple_loss:0.5468672513961792
loss_pred:0.17889922857284546, decouple_loss:0.6253347992897034
The generated pressure mean: 0.845663845539093
loss_pred:0.179977685213089, decouple_loss:0.5427298545837402
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.8463141918182373
The generated pressure mean: 0.845784604549408
loss_pred:0.17486122250556946, decouple_loss:0.5384569764137268
loss_pred:0.17060615122318268, decouple_loss:0.5032084584236145
The generated pressure mean: 0.8448505401611328
loss_pred:0.1734546422958374, decouple_loss:0.5053054094314575
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.8216783404350281
loss_pred:0.1616249680519104, decouple_loss:0.48083847761154175
The generated pressure mean: 0.820527970790863
loss_pred:0.17033247649669647, decouple_loss:0.4801173508167267
The generated pressure mean: 0.8189998865127563
loss_pred:0.16034886240959167, decouple_loss:0.46730294823646545
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.7866131663322449
loss_pred:0.15602676570415497, decouple_loss:0.4554276764392853
The generated pressure mean: 0.7815966010093689
loss_pred:0.154788076877594, decouple_loss:0.44269195199012756
The generated pressure mean: 0.7866719365119934
loss_pred:0.1577804982662201, decouple_loss:0.4593719244003296
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.7402361035346985
loss_pred:0.14935533702373505, decouple_loss:0.4293481707572937
The generated pressure mean: 0.7426159381866455
loss_pred:0.146804079413414, decouple_loss:0.4281314015388489
The generated pressure mean: 0.7415378093719482
loss_pred:0.14413459599018097, decouple_loss:0.434929758310318
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.7027828693389893
loss_pred:0.13784268498420715, decouple_loss:0.42403462529182434
The generated pressure mean: 0.7011411190032959
loss_pred:0.13496054708957672, decouple_loss:0.42996856570243835
The generated pressure mean: 0.7031987905502319
loss_pred:0.13488060235977173, decouple_loss:0.39960363507270813
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.6598947048187256
loss_pred:0.12768502533435822, decouple_loss:0.37668275833129883
The generated pressure mean: 0.6587210297584534
loss_pred:0.1316138505935669, decouple_loss:0.39889955520629883
The generated pressure mean: 0.6585321426391602
loss_pred:0.12751886248588562, decouple_loss:0.37666380405426025
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.6192651987075806
The generated pressure mean: 0.6161923408508301
loss_pred:0.12004414200782776, decouple_loss:0.36374431848526
loss_pred:0.11496350169181824, decouple_loss:0.36780673265457153
The generated pressure mean: 0.6175321340560913
loss_pred:0.1182996854186058, decouple_loss:0.3405979871749878
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.5803683400154114
loss_pred:0.11556784808635712, decouple_loss:0.32056164741516113
The generated pressure mean: 0.5812003016471863
loss_pred:0.11435610800981522, decouple_loss:0.3206884264945984
The generated pressure mean: 0.5810436606407166
loss_pred:0.11216677725315094, decouple_loss:0.3093760907649994
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.5452635884284973
loss_pred:0.1056591346859932, decouple_loss:0.28410598635673523
The generated pressure mean: 0.5474692583084106
loss_pred:0.10672682523727417, decouple_loss:0.28665322065353394
The generated pressure mean: 0.5468591451644897
loss_pred:0.10577612370252609, decouple_loss:0.2850998044013977
2023-04-16 12:26:02 testing...
The generated pressure mean: 0.39258795976638794
The generated pressure mean: 0.39279410243034363
The generated pressure mean: 0.39252370595932007
loss_pred:0.10903838276863098, decouple_loss:0.2646620273590088
loss_pred:0.10936693847179413, decouple_loss:0.2641291320323944
loss_pred:0.10946805775165558, decouple_loss:0.26133283972740173
WV_0_PC_0_EH_1_PS_40, loss: 0.12245985865592957, avg_mse: 0.10753273963928223
current test mse: 0.107533
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.5185381770133972
loss_pred:0.10206545889377594, decouple_loss:0.2599669098854065
The generated pressure mean: 0.5198920369148254
loss_pred:0.10144297033548355, decouple_loss:0.2621486186981201
The generated pressure mean: 0.5200344920158386
loss_pred:0.1025204211473465, decouple_loss:0.25820910930633545
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.49870437383651733
The generated pressure mean: 0.4986041486263275
loss_pred:0.09805873781442642, decouple_loss:0.239810049533844
loss_pred:0.09760801494121552, decouple_loss:0.23766277730464935
The generated pressure mean: 0.4990672767162323
loss_pred:0.09617763757705688, decouple_loss:0.23045723140239716
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4833497107028961
The generated pressure mean: 0.48449650406837463
loss_pred:0.09413935244083405, decouple_loss:0.21518656611442566
loss_pred:0.0926375612616539, decouple_loss:0.2128172218799591
The generated pressure mean: 0.4850776791572571
loss_pred:0.0926566869020462, decouple_loss:0.21510940790176392
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47391411662101746
The generated pressure mean: 0.47182756662368774
loss_pred:0.08799322694540024, decouple_loss:0.20350420475006104
loss_pred:0.09117834270000458, decouple_loss:0.20181961357593536
The generated pressure mean: 0.47279366850852966
loss_pred:0.09308886528015137, decouple_loss:0.20274579524993896
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46318909525871277
The generated pressure mean: 0.4627041518688202
loss_pred:0.08971309661865234, decouple_loss:0.18945994973182678
loss_pred:0.08856767416000366, decouple_loss:0.19353492558002472
The generated pressure mean: 0.4639539122581482
loss_pred:0.08962572365999222, decouple_loss:0.19253934919834137
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4560546576976776
The generated pressure mean: 0.4559745788574219
loss_pred:0.08816708624362946, decouple_loss:0.18336814641952515
loss_pred:0.08731184154748917, decouple_loss:0.18249177932739258
The generated pressure mean: 0.4565141201019287
loss_pred:0.08731827884912491, decouple_loss:0.18299764394760132
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4559347927570343
The generated pressure mean: 0.45590221881866455
loss_pred:0.08513540029525757, decouple_loss:0.16595639288425446
loss_pred:0.085189089179039, decouple_loss:0.1673448234796524
The generated pressure mean: 0.4561885595321655
loss_pred:0.08365924656391144, decouple_loss:0.17013289034366608
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505120515823364
loss_pred:0.08598858118057251, decouple_loss:0.15959718823432922
The generated pressure mean: 0.45147600769996643
loss_pred:0.08341486006975174, decouple_loss:0.15652276575565338
The generated pressure mean: 0.45208996534347534
loss_pred:0.08332264423370361, decouple_loss:0.15744610130786896
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45060908794403076
loss_pred:0.08340796828269958, decouple_loss:0.1447078436613083
The generated pressure mean: 0.4514593183994293
loss_pred:0.08469980210065842, decouple_loss:0.14887632429599762
The generated pressure mean: 0.45019373297691345
loss_pred:0.08527316153049469, decouple_loss:0.14716507494449615
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45089367032051086
loss_pred:0.08608271926641464, decouple_loss:0.14348141849040985
The generated pressure mean: 0.4493832588195801
loss_pred:0.0827493816614151, decouple_loss:0.14147716760635376
The generated pressure mean: 0.45014670491218567
loss_pred:0.08189000189304352, decouple_loss:0.1404019445180893
2023-04-16 12:28:30 testing...
The generated pressure mean: 0.4100697934627533
The generated pressure mean: 0.4109390377998352
loss_pred:0.08845905214548111, decouple_loss:0.13823221623897552
The generated pressure mean: 0.41012367606163025
loss_pred:0.08914148062467575, decouple_loss:0.14164727926254272
loss_pred:0.08930674195289612, decouple_loss:0.1349353939294815
WV_0_PC_0_EH_1_PS_40, loss: 0.09588267654180527, avg_mse: 0.08876912295818329
current test mse: 0.088769
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492630958557129
loss_pred:0.08313074707984924, decouple_loss:0.13359591364860535
The generated pressure mean: 0.4493210017681122
loss_pred:0.0824887678027153, decouple_loss:0.13611526787281036
The generated pressure mean: 0.45039764046669006
loss_pred:0.08433529734611511, decouple_loss:0.13383875787258148
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45147061347961426
loss_pred:0.08407492190599442, decouple_loss:0.12899065017700195
The generated pressure mean: 0.4509030282497406
loss_pred:0.08053088933229446, decouple_loss:0.13364528119564056
The generated pressure mean: 0.4520014226436615
loss_pred:0.08210363984107971, decouple_loss:0.13094113767147064
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4573092460632324
loss_pred:0.08151078969240189, decouple_loss:0.12298049032688141
The generated pressure mean: 0.4574272334575653
loss_pred:0.0826454684138298, decouple_loss:0.12672805786132812
The generated pressure mean: 0.45647621154785156
loss_pred:0.08383879065513611, decouple_loss:0.12575404345989227
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45650526881217957
loss_pred:0.08490714430809021, decouple_loss:0.12073346227407455
The generated pressure mean: 0.4563084542751312
loss_pred:0.08218688517808914, decouple_loss:0.12209425121545792
The generated pressure mean: 0.4576181471347809
loss_pred:0.08220695704221725, decouple_loss:0.11709514260292053
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45252013206481934
loss_pred:0.083136647939682, decouple_loss:0.11205688118934631
The generated pressure mean: 0.45233961939811707
loss_pred:0.08217890560626984, decouple_loss:0.11219330877065659
The generated pressure mean: 0.45165473222732544
loss_pred:0.08301402628421783, decouple_loss:0.11404550820589066
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4625905454158783
loss_pred:0.08437784761190414, decouple_loss:0.11160758882761002
The generated pressure mean: 0.4628121554851532
loss_pred:0.08414983749389648, decouple_loss:0.10898486524820328
The generated pressure mean: 0.4612681567668915
loss_pred:0.08325094729661942, decouple_loss:0.1076112911105156
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45448365807533264
loss_pred:0.08108396828174591, decouple_loss:0.10361877828836441
The generated pressure mean: 0.4536515176296234
loss_pred:0.08351992815732956, decouple_loss:0.10340175032615662
The generated pressure mean: 0.45243439078330994
loss_pred:0.07960157841444016, decouple_loss:0.10448148846626282
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46250277757644653
loss_pred:0.08150336146354675, decouple_loss:0.09914638102054596
The generated pressure mean: 0.4645325839519501
loss_pred:0.08012533187866211, decouple_loss:0.09907655417919159
The generated pressure mean: 0.46159616112709045
loss_pred:0.08004084974527359, decouple_loss:0.10047414153814316
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4595184326171875
loss_pred:0.08043953031301498, decouple_loss:0.09640321135520935
The generated pressure mean: 0.46051108837127686
loss_pred:0.08183476328849792, decouple_loss:0.09663128852844238
The generated pressure mean: 0.4612485468387604
loss_pred:0.08104155957698822, decouple_loss:0.09554623067378998
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4630233943462372
loss_pred:0.08112182468175888, decouple_loss:0.0922292098402977
The generated pressure mean: 0.463130384683609
loss_pred:0.08124305307865143, decouple_loss:0.08994002640247345
The generated pressure mean: 0.46115028858184814
loss_pred:0.07776977866888046, decouple_loss:0.0932139903306961
2023-04-16 12:30:24 testing...
The generated pressure mean: 0.415407657623291
The generated pressure mean: 0.41423481702804565
The generated pressure mean: 0.41574791073799133
loss_pred:0.08632047474384308, decouple_loss:0.0949023887515068
loss_pred:0.0855526402592659, decouple_loss:0.0933886468410492
loss_pred:0.0864325538277626, decouple_loss:0.09353304654359818
WV_0_PC_0_EH_1_PS_40, loss: 0.09079895913600922, avg_mse: 0.08672578632831573
current test mse: 0.086726
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4530767500400543
loss_pred:0.08110259473323822, decouple_loss:0.08825533837080002
The generated pressure mean: 0.45493876934051514
loss_pred:0.08092482388019562, decouple_loss:0.08894404768943787
The generated pressure mean: 0.45628997683525085
loss_pred:0.07872001826763153, decouple_loss:0.08695691078901291
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46745914220809937
The generated pressure mean: 0.46856629848480225
loss_pred:0.08014373481273651, decouple_loss:0.08651822060346603
loss_pred:0.07867396622896194, decouple_loss:0.08463547378778458
The generated pressure mean: 0.468122661113739
loss_pred:0.0803358256816864, decouple_loss:0.08531395345926285
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.41422587633132935
loss_pred:0.0818067267537117, decouple_loss:0.09308744966983795
The generated pressure mean: 0.4174245297908783
loss_pred:0.08207384496927261, decouple_loss:0.0901828408241272
The generated pressure mean: 0.41583752632141113
loss_pred:0.08272894471883774, decouple_loss:0.09465201199054718
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.5584038496017456
The generated pressure mean: 0.5582954287528992
loss_pred:0.08695756644010544, decouple_loss:0.11586596816778183
loss_pred:0.08928853273391724, decouple_loss:0.11497926712036133
The generated pressure mean: 0.5563586950302124
loss_pred:0.08921871334314346, decouple_loss:0.1159660592675209
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.35874491930007935
loss_pred:0.08824604004621506, decouple_loss:0.10593920946121216
The generated pressure mean: 0.35705357789993286
loss_pred:0.08598025143146515, decouple_loss:0.10409171134233475
The generated pressure mean: 0.35652586817741394
loss_pred:0.08594045788049698, decouple_loss:0.1060357540845871
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.35492703318595886
The generated pressure mean: 0.3547336459159851
loss_pred:0.08888944238424301, decouple_loss:0.10051803290843964
loss_pred:0.08738498389720917, decouple_loss:0.1008312925696373
The generated pressure mean: 0.35688745975494385
loss_pred:0.09058772772550583, decouple_loss:0.1004161611199379
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4036221206188202The generated pressure mean: 0.4027947783470154
loss_pred:0.08473406732082367, decouple_loss:0.09852036833763123loss_pred:0.08439148217439651, decouple_loss:0.09763875603675842
The generated pressure mean: 0.4062691330909729
loss_pred:0.08280326426029205, decouple_loss:0.09787865728139877
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4589339792728424
loss_pred:0.08143044263124466, decouple_loss:0.10747618228197098
The generated pressure mean: 0.4582669734954834
loss_pred:0.08037211000919342, decouple_loss:0.10780341923236847
The generated pressure mean: 0.4577891528606415
loss_pred:0.0805768147110939, decouple_loss:0.10817186534404755
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.49454987049102783
The generated pressure mean: 0.4936542510986328
loss_pred:0.0825442299246788, decouple_loss:0.10290578752756119
loss_pred:0.08544914424419403, decouple_loss:0.10326377302408218
The generated pressure mean: 0.4924047589302063
loss_pred:0.08216381072998047, decouple_loss:0.10283598303794861
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.5035505294799805
loss_pred:0.08301759511232376, decouple_loss:0.0926862508058548
The generated pressure mean: 0.5046980381011963
loss_pred:0.08257781714200974, decouple_loss:0.09019007533788681
The generated pressure mean: 0.5039483904838562
loss_pred:0.0822506919503212, decouple_loss:0.09261851012706757
2023-04-16 12:32:55 testing...
The generated pressure mean: 0.3983471393585205
The generated pressure mean: 0.39814677834510803
The generated pressure mean: 0.39824968576431274
loss_pred:0.0879242941737175, decouple_loss:0.09346476942300797
loss_pred:0.0884711816906929, decouple_loss:0.09614065289497375
loss_pred:0.08859327435493469, decouple_loss:0.09206756204366684
WV_0_PC_0_EH_1_PS_40, loss: 0.09302413463592529, avg_mse: 0.08974171429872513
current test mse: 0.089742
Iteration: 51, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.49318987131118774
loss_pred:0.082241952419281, decouple_loss:0.08919254690408707
The generated pressure mean: 0.4928496181964874
loss_pred:0.08098222315311432, decouple_loss:0.09023504704236984
The generated pressure mean: 0.4927082359790802
loss_pred:0.08230423927307129, decouple_loss:0.0907193198800087
Iteration: 52, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47251757979393005
loss_pred:0.07928688079118729, decouple_loss:0.09387204796075821
The generated pressure mean: 0.4747631847858429
loss_pred:0.08324941992759705, decouple_loss:0.09398488700389862
The generated pressure mean: 0.47273197770118713
loss_pred:0.0816822499036789, decouple_loss:0.09291531145572662
Iteration: 53, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4520041346549988
loss_pred:0.0808270275592804, decouple_loss:0.0877559706568718
The generated pressure mean: 0.45215895771980286
loss_pred:0.07886272668838501, decouple_loss:0.08707407116889954
The generated pressure mean: 0.4523763060569763
loss_pred:0.07918825000524521, decouple_loss:0.08692562580108643
Iteration: 54, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4373570680618286
loss_pred:0.08027740567922592, decouple_loss:0.08174702525138855
The generated pressure mean: 0.4373391270637512
loss_pred:0.07904713600873947, decouple_loss:0.08267231285572052
The generated pressure mean: 0.437279611825943
loss_pred:0.08144520223140717, decouple_loss:0.08201322704553604
Iteration: 55, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43096038699150085
loss_pred:0.07982619851827621, decouple_loss:0.08131850510835648
The generated pressure mean: 0.43152278661727905
loss_pred:0.081999771296978, decouple_loss:0.08177895098924637
The generated pressure mean: 0.4317374527454376
loss_pred:0.0794261172413826, decouple_loss:0.082491435110569
Iteration: 56, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4342116713523865
loss_pred:0.08015064150094986, decouple_loss:0.08181274682283401
The generated pressure mean: 0.43283843994140625
loss_pred:0.0799713060259819, decouple_loss:0.0799315944314003
The generated pressure mean: 0.43394234776496887
loss_pred:0.07985599339008331, decouple_loss:0.08089800179004669
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 57, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44057682156562805
loss_pred:0.07872633635997772, decouple_loss:0.07551319897174835
The generated pressure mean: 0.4403632879257202
loss_pred:0.0799233466386795, decouple_loss:0.07792104035615921
The generated pressure mean: 0.43963104486465454
loss_pred:0.07966354489326477, decouple_loss:0.07693205028772354
Iteration: 58, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496763050556183
loss_pred:0.07995982468128204, decouple_loss:0.072487972676754
The generated pressure mean: 0.44872936606407166
loss_pred:0.07948523014783859, decouple_loss:0.07072129845619202
The generated pressure mean: 0.4498331844806671
loss_pred:0.08169400691986084, decouple_loss:0.07213062047958374
Iteration: 59, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4582262337207794
loss_pred:0.08022971451282501, decouple_loss:0.07124149054288864
The generated pressure mean: 0.457430362701416
loss_pred:0.08003803342580795, decouple_loss:0.0702221542596817
The generated pressure mean: 0.4575332701206207
loss_pred:0.07919568568468094, decouple_loss:0.0708080306649208
Iteration: 60, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46454906463623047
loss_pred:0.08051987737417221, decouple_loss:0.06864982098340988
The generated pressure mean: 0.46293461322784424
loss_pred:0.08135244995355606, decouple_loss:0.06970246136188507
The generated pressure mean: 0.4635251760482788
loss_pred:0.07965447008609772, decouple_loss:0.06838062405586243
2023-04-16 12:34:49 testing...
The generated pressure mean: 0.40601956844329834
The generated pressure mean: 0.4063788950443268
loss_pred:0.08482001721858978, decouple_loss:0.06858817487955093
The generated pressure mean: 0.4060303270816803
loss_pred:0.08546113967895508, decouple_loss:0.0711262971162796
loss_pred:0.08557885140180588, decouple_loss:0.06810340285301208
WV_0_PC_0_EH_1_PS_40, loss: 0.08875030279159546, avg_mse: 0.08627883344888687
current test mse: 0.086279
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 61, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46458306908607483
loss_pred:0.08012642711400986, decouple_loss:0.07024293392896652
The generated pressure mean: 0.46354037523269653
The generated pressure mean: 0.464993953704834
loss_pred:0.07990711182355881, decouple_loss:0.06794440001249313
loss_pred:0.07854816317558289, decouple_loss:0.06823883205652237
Iteration: 62, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4614620506763458
The generated pressure mean: 0.46228888630867004
loss_pred:0.07829339057207108, decouple_loss:0.07463453710079193
loss_pred:0.07842659950256348, decouple_loss:0.06691765785217285
The generated pressure mean: 0.4622398912906647
loss_pred:0.07858770340681076, decouple_loss:0.06385970115661621
Iteration: 63, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45827120542526245
The generated pressure mean: 0.4589296281337738
loss_pred:0.0782395601272583, decouple_loss:0.0651995986700058
loss_pred:0.08211540430784225, decouple_loss:0.06364388018846512
The generated pressure mean: 0.4597926735877991
loss_pred:0.07847554236650467, decouple_loss:0.06730981171131134
Iteration: 64, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4539376497268677
The generated pressure mean: 0.4526785612106323
loss_pred:0.0765710398554802, decouple_loss:0.06289184838533401
loss_pred:0.07861710339784622, decouple_loss:0.06517620384693146
The generated pressure mean: 0.453721284866333
loss_pred:0.07804952561855316, decouple_loss:0.061753809452056885
Iteration: 65, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45322301983833313
loss_pred:0.08175913244485855, decouple_loss:0.0584888756275177
The generated pressure mean: 0.45168161392211914
loss_pred:0.07961700111627579, decouple_loss:0.057489652186632156
The generated pressure mean: 0.4508592188358307
loss_pred:0.0790039524435997, decouple_loss:0.06092202290892601
Iteration: 66, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4518545866012573
The generated pressure mean: 0.45238131284713745
loss_pred:0.08028359711170197, decouple_loss:0.05715524032711983
loss_pred:0.08047881722450256, decouple_loss:0.05790981277823448
The generated pressure mean: 0.45074814558029175
loss_pred:0.0766095221042633, decouple_loss:0.056292228400707245
Iteration: 67, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4529300332069397
The generated pressure mean: 0.45278915762901306
loss_pred:0.0769883468747139, decouple_loss:0.05929163843393326
loss_pred:0.0781727060675621, decouple_loss:0.05759789049625397
The generated pressure mean: 0.4518125355243683
loss_pred:0.07950518280267715, decouple_loss:0.05763155594468117
Iteration: 68, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45633161067962646
The generated pressure mean: 0.45515769720077515
loss_pred:0.07737060636281967, decouple_loss:0.059898801147937775
loss_pred:0.07871116697788239, decouple_loss:0.054926663637161255
The generated pressure mean: 0.4568292498588562
loss_pred:0.07905258238315582, decouple_loss:0.054688822478055954
Iteration: 69, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4616509675979614
loss_pred:0.07846284657716751, decouple_loss:0.058600615710020065
The generated pressure mean: 0.45871105790138245
loss_pred:0.07961361855268478, decouple_loss:0.05581222474575043
The generated pressure mean: 0.45777371525764465
loss_pred:0.0777287632226944, decouple_loss:0.053017064929008484
Iteration: 70, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4595194160938263
The generated pressure mean: 0.4584636092185974
loss_pred:0.07627394795417786, decouple_loss:0.05345586687326431
loss_pred:0.07711956650018692, decouple_loss:0.05566126108169556
The generated pressure mean: 0.45942533016204834
loss_pred:0.0765654519200325, decouple_loss:0.051837775856256485
2023-04-16 12:37:18 testing...
The generated pressure mean: 0.4082157015800476
The generated pressure mean: 0.40875765681266785
The generated pressure mean: 0.4084378182888031
loss_pred:0.08317205309867859, decouple_loss:0.05178871378302574
loss_pred:0.0838041603565216, decouple_loss:0.05421090126037598
loss_pred:0.08395121991634369, decouple_loss:0.0523708201944828
WV_0_PC_0_EH_1_PS_40, loss: 0.08628198504447937, avg_mse: 0.08466453850269318
current test mse: 0.084665
Iteration: 71, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46088388562202454
loss_pred:0.07943762093782425, decouple_loss:0.055147357285022736
The generated pressure mean: 0.4571639895439148
loss_pred:0.07998155057430267, decouple_loss:0.05361751466989517
The generated pressure mean: 0.458245187997818
loss_pred:0.07747768610715866, decouple_loss:0.05114186555147171
Iteration: 72, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4518387019634247
loss_pred:0.0773986354470253, decouple_loss:0.054052311927080154
The generated pressure mean: 0.45364412665367126
loss_pred:0.07905156910419464, decouple_loss:0.05060195177793503
The generated pressure mean: 0.4535033404827118
loss_pred:0.0755680650472641, decouple_loss:0.05135796219110489
Iteration: 73, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475322365760803
loss_pred:0.07853791862726212, decouple_loss:0.05220509320497513
The generated pressure mean: 0.44824329018592834
loss_pred:0.07749690860509872, decouple_loss:0.05025126039981842
The generated pressure mean: 0.4494193494319916
loss_pred:0.07874228805303574, decouple_loss:0.04934926703572273
Iteration: 74, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44795742630958557
loss_pred:0.07795068621635437, decouple_loss:0.0483497753739357
The generated pressure mean: 0.4482933580875397
loss_pred:0.07899198681116104, decouple_loss:0.049205463379621506
The generated pressure mean: 0.4465620219707489
loss_pred:0.07784377783536911, decouple_loss:0.050373487174510956
Iteration: 75, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44793441891670227
loss_pred:0.07927732169628143, decouple_loss:0.050601448863744736
The generated pressure mean: 0.4466792345046997
loss_pred:0.07765644043684006, decouple_loss:0.04831945151090622
The generated pressure mean: 0.44813424348831177
loss_pred:0.07875809073448181, decouple_loss:0.04837917163968086
Iteration: 76, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4518803358078003
loss_pred:0.07468530535697937, decouple_loss:0.046026501804590225
The generated pressure mean: 0.4502485692501068
loss_pred:0.0760246217250824, decouple_loss:0.04688737168908119
The generated pressure mean: 0.44966164231300354
loss_pred:0.07494217157363892, decouple_loss:0.045414090156555176
Iteration: 77, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45308107137680054
loss_pred:0.07525002956390381, decouple_loss:0.04659884050488472
The generated pressure mean: 0.45229554176330566
loss_pred:0.07651662826538086, decouple_loss:0.045799288898706436
The generated pressure mean: 0.4524933993816376
loss_pred:0.07597875595092773, decouple_loss:0.044748831540346146
Iteration: 78, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4547506272792816
loss_pred:0.07656823098659515, decouple_loss:0.04429369792342186
The generated pressure mean: 0.45411941409111023
loss_pred:0.078055739402771, decouple_loss:0.04553643614053726
The generated pressure mean: 0.4546774923801422
loss_pred:0.07698550075292587, decouple_loss:0.045759256929159164
Iteration: 79, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45544108748435974
loss_pred:0.07711729407310486, decouple_loss:0.044820841401815414
The generated pressure mean: 0.4571566581726074
loss_pred:0.07621666043996811, decouple_loss:0.045153696089982986
The generated pressure mean: 0.4576629400253296
loss_pred:0.07883750647306442, decouple_loss:0.04638855904340744
Iteration: 80, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45670750737190247
loss_pred:0.077016681432724, decouple_loss:0.047739382833242416
The generated pressure mean: 0.455333411693573
loss_pred:0.0755753442645073, decouple_loss:0.043000154197216034
The generated pressure mean: 0.4563121795654297
loss_pred:0.07565914839506149, decouple_loss:0.04421300068497658
2023-04-16 12:39:12 testing...
The generated pressure mean: 0.40955865383148193
The generated pressure mean: 0.4106748700141907
loss_pred:0.08147652447223663, decouple_loss:0.043268825858831406
The generated pressure mean: 0.41042378544807434
loss_pred:0.08217260241508484, decouple_loss:0.04489963501691818
loss_pred:0.08227977901697159, decouple_loss:0.044835660606622696
WV_0_PC_0_EH_1_PS_40, loss: 0.08419303596019745, avg_mse: 0.08314897865056992
current test mse: 0.083149
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 81, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4546351432800293
loss_pred:0.07507888972759247, decouple_loss:0.044670820236206055
The generated pressure mean: 0.4538559913635254
The generated pressure mean: 0.4552028179168701
loss_pred:0.07297991961240768, decouple_loss:0.042134761810302734
loss_pred:0.0744827464222908, decouple_loss:0.04341418668627739
Iteration: 82, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44795888662338257
loss_pred:0.07535240054130554, decouple_loss:0.041418567299842834
The generated pressure mean: 0.4465000331401825
loss_pred:0.07625571638345718, decouple_loss:0.04475882649421692
The generated pressure mean: 0.4483816623687744
loss_pred:0.07708997279405594, decouple_loss:0.04476428031921387
Iteration: 83, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44637101888656616
loss_pred:0.07284844666719437, decouple_loss:0.0426664762198925
The generated pressure mean: 0.444649338722229
loss_pred:0.07489536702632904, decouple_loss:0.040680669248104095
The generated pressure mean: 0.44301748275756836
loss_pred:0.07444249093532562, decouple_loss:0.04143969714641571
Iteration: 84, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44940292835235596
loss_pred:0.07244207710027695, decouple_loss:0.042033493518829346
The generated pressure mean: 0.4504360556602478
loss_pred:0.07544334977865219, decouple_loss:0.04319143295288086
The generated pressure mean: 0.4459465444087982
loss_pred:0.07404465973377228, decouple_loss:0.04095185548067093
Iteration: 85, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4540265202522278
loss_pred:0.07695434987545013, decouple_loss:0.040676623582839966
The generated pressure mean: 0.4557300806045532
loss_pred:0.07329022139310837, decouple_loss:0.04277605190873146
The generated pressure mean: 0.45518937706947327
loss_pred:0.07246609777212143, decouple_loss:0.042968444526195526
Iteration: 86, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45507386326789856
loss_pred:0.07412449270486832, decouple_loss:0.04052315652370453
The generated pressure mean: 0.45559731125831604
loss_pred:0.07532534003257751, decouple_loss:0.040782537311315536
The generated pressure mean: 0.4552356004714966
loss_pred:0.0753394365310669, decouple_loss:0.04143820330500603
Iteration: 87, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.452919065952301
loss_pred:0.07195617258548737, decouple_loss:0.039087098091840744
The generated pressure mean: 0.4537807106971741
loss_pred:0.07645981013774872, decouple_loss:0.04078873246908188
The generated pressure mean: 0.4527578353881836
loss_pred:0.0727706104516983, decouple_loss:0.0396074540913105
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 88, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4518962800502777
loss_pred:0.07164405286312103, decouple_loss:0.0382256917655468
The generated pressure mean: 0.4546969532966614
loss_pred:0.07444846630096436, decouple_loss:0.03939256817102432
The generated pressure mean: 0.4512426257133484
loss_pred:0.0754227265715599, decouple_loss:0.03907915577292442
Iteration: 89, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.460586816072464
loss_pred:0.07242941856384277, decouple_loss:0.03887693211436272
The generated pressure mean: 0.4599863886833191
loss_pred:0.07339408248662949, decouple_loss:0.03880270943045616
The generated pressure mean: 0.45970430970191956
loss_pred:0.0750669538974762, decouple_loss:0.038996919989585876
Iteration: 90, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4565449357032776
loss_pred:0.07471363246440887, decouple_loss:0.037987932562828064
The generated pressure mean: 0.4588739275932312
loss_pred:0.07474398612976074, decouple_loss:0.03806181624531746
The generated pressure mean: 0.45998266339302063
loss_pred:0.07489233464002609, decouple_loss:0.03843999654054642
2023-04-16 12:41:46 testing...
The generated pressure mean: 0.4105707108974457
The generated pressure mean: 0.41221335530281067
The generated pressure mean: 0.41205278038978577
loss_pred:0.0793771743774414, decouple_loss:0.04056417942047119
loss_pred:0.08019696921110153, decouple_loss:0.04283061623573303
loss_pred:0.08015972375869751, decouple_loss:0.04213438183069229
WV_0_PC_0_EH_1_PS_40, loss: 0.08200344443321228, avg_mse: 0.0811038464307785
current test mse: 0.081104
Iteration: 91, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45077580213546753
loss_pred:0.07463569194078445, decouple_loss:0.038885798305273056
The generated pressure mean: 0.45307502150535583
loss_pred:0.07323344051837921, decouple_loss:0.03876475617289543
The generated pressure mean: 0.4545017182826996
loss_pred:0.07475785911083221, decouple_loss:0.03986116871237755
Iteration: 92, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46673014760017395
loss_pred:0.07250037044286728, decouple_loss:0.03651917725801468
The generated pressure mean: 0.4642745852470398
loss_pred:0.07260160148143768, decouple_loss:0.0377187617123127
The generated pressure mean: 0.46408939361572266
loss_pred:0.07201147079467773, decouple_loss:0.03875710442662239
Iteration: 93, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4616507887840271
The generated pressure mean: 0.4592425227165222
loss_pred:0.07130365073680878, decouple_loss:0.03645464405417442
loss_pred:0.06941276043653488, decouple_loss:0.035080909729003906
The generated pressure mean: 0.4640083312988281
loss_pred:0.07422737032175064, decouple_loss:0.03886978700757027
Iteration: 94, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45508942008018494
The generated pressure mean: 0.45131921768188477
loss_pred:0.07188894599676132, decouple_loss:0.036794278770685196
loss_pred:0.07417766749858856, decouple_loss:0.038135726004838943
The generated pressure mean: 0.45155102014541626
loss_pred:0.07383149862289429, decouple_loss:0.036967143416404724
Iteration: 95, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.48368212580680847
The generated pressure mean: 0.4840985834598541
loss_pred:0.07333339750766754, decouple_loss:0.03811566159129143
loss_pred:0.0727720558643341, decouple_loss:0.037194594740867615
The generated pressure mean: 0.48216772079467773
loss_pred:0.07046841084957123, decouple_loss:0.03664441034197807
Iteration: 96, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.427934855222702
loss_pred:0.07238461077213287, decouple_loss:0.04668537527322769
The generated pressure mean: 0.4270896315574646
loss_pred:0.07454926520586014, decouple_loss:0.046224210411310196
The generated pressure mean: 0.42809537053108215
loss_pred:0.07652328163385391, decouple_loss:0.04792007431387901
Iteration: 97, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4756068289279938
The generated pressure mean: 0.4811858534812927
loss_pred:0.0720682218670845, decouple_loss:0.04455125331878662
loss_pred:0.06944456696510315, decouple_loss:0.04465170577168465
The generated pressure mean: 0.4784110486507416
loss_pred:0.07158065587282181, decouple_loss:0.044817082583904266
Iteration: 98, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46847522258758545
loss_pred:0.06901871412992477, decouple_loss:0.03851733356714249
The generated pressure mean: 0.4666297435760498
loss_pred:0.06853626668453217, decouple_loss:0.0362393893301487
The generated pressure mean: 0.46995773911476135
loss_pred:0.0688987746834755, decouple_loss:0.038478076457977295
Iteration: 99, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465160667896271
loss_pred:0.07060353457927704, decouple_loss:0.04547936096787453
The generated pressure mean: 0.4464496970176697
loss_pred:0.06974618136882782, decouple_loss:0.04550216346979141
The generated pressure mean: 0.4480227828025818
loss_pred:0.07191893458366394, decouple_loss:0.04529764503240585
Iteration: 100, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47588858008384705
loss_pred:0.07289249449968338, decouple_loss:0.036750633269548416
The generated pressure mean: 0.47783780097961426
loss_pred:0.06783998757600784, decouple_loss:0.03622497618198395
The generated pressure mean: 0.47673773765563965
loss_pred:0.07117121666669846, decouple_loss:0.03665637969970703
2023-04-16 12:43:39 testing...
The generated pressure mean: 0.4043112099170685
The generated pressure mean: 0.4057841897010803
The generated pressure mean: 0.4056411683559418
loss_pred:0.07774046063423157, decouple_loss:0.04224592074751854
loss_pred:0.07814247906208038, decouple_loss:0.044515181332826614
loss_pred:0.07815227657556534, decouple_loss:0.04426886886358261
WV_0_PC_0_EH_1_PS_40, loss: 0.08019557595252991, avg_mse: 0.0793021023273468
current test mse: 0.079302
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 101, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4784446656703949
loss_pred:0.06906634569168091, decouple_loss:0.03927858546376228
The generated pressure mean: 0.475835919380188
loss_pred:0.0704178512096405, decouple_loss:0.03935706242918968
The generated pressure mean: 0.47892412543296814
loss_pred:0.07057745009660721, decouple_loss:0.038710903376340866
Iteration: 102, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4536091089248657
loss_pred:0.07006923854351044, decouple_loss:0.039277542382478714
The generated pressure mean: 0.45464834570884705
loss_pred:0.0686841681599617, decouple_loss:0.038823410868644714
The generated pressure mean: 0.4521734416484833
loss_pred:0.07276885956525803, decouple_loss:0.03811495378613472
Iteration: 103, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46515142917633057
The generated pressure mean: 0.4632734954357147
loss_pred:0.06843748688697815, decouple_loss:0.03550371155142784
loss_pred:0.06850235909223557, decouple_loss:0.03569306060671806
The generated pressure mean: 0.46414849162101746
loss_pred:0.07033433020114899, decouple_loss:0.036643292754888535
Iteration: 104, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.476431667804718
The generated pressure mean: 0.4793757200241089
loss_pred:0.06876060366630554, decouple_loss:0.03968697413802147
loss_pred:0.0691518560051918, decouple_loss:0.04027159512042999
The generated pressure mean: 0.4766092300415039
loss_pred:0.06867871433496475, decouple_loss:0.03923763334751129
Iteration: 105, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449004590511322
The generated pressure mean: 0.4487280547618866
loss_pred:0.06803013384342194, decouple_loss:0.036480460315942764
loss_pred:0.0711689218878746, decouple_loss:0.03646710887551308
The generated pressure mean: 0.4479682445526123
loss_pred:0.06920246034860611, decouple_loss:0.03643062338232994
Iteration: 106, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4601265788078308
loss_pred:0.0678982138633728, decouple_loss:0.03742529824376106
The generated pressure mean: 0.45871782302856445
loss_pred:0.06662140041589737, decouple_loss:0.038176149129867554
The generated pressure mean: 0.4635688066482544
loss_pred:0.06690473109483719, decouple_loss:0.03919520974159241
Iteration: 107, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4714038372039795
loss_pred:0.06645279377698898, decouple_loss:0.03387550637125969
The generated pressure mean: 0.4705061614513397
loss_pred:0.0673929750919342, decouple_loss:0.03474671021103859
The generated pressure mean: 0.4713856279850006
loss_pred:0.06726383417844772, decouple_loss:0.034857168793678284
Iteration: 108, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45028743147850037
The generated pressure mean: 0.44808101654052734
loss_pred:0.06827294081449509, decouple_loss:0.038395706564188004
loss_pred:0.06991233676671982, decouple_loss:0.03673470765352249
The generated pressure mean: 0.4469147324562073
loss_pred:0.06530909240245819, decouple_loss:0.036878801882267
Iteration: 109, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4602404534816742
loss_pred:0.06967778503894806, decouple_loss:0.03467151150107384
The generated pressure mean: 0.4629821181297302
loss_pred:0.06924591958522797, decouple_loss:0.03574836254119873
The generated pressure mean: 0.46045389771461487
loss_pred:0.06788017600774765, decouple_loss:0.03418434411287308
Iteration: 110, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46956750750541687
loss_pred:0.06864454597234726, decouple_loss:0.033196333795785904
The generated pressure mean: 0.47228118777275085
loss_pred:0.06602869927883148, decouple_loss:0.0336248017847538
The generated pressure mean: 0.4686008095741272
loss_pred:0.06831705570220947, decouple_loss:0.033869531005620956
2023-04-16 12:46:11 testing...
The generated pressure mean: 0.4105161130428314
The generated pressure mean: 0.4115033745765686
loss_pred:0.07381365448236465, decouple_loss:0.03837651386857033
The generated pressure mean: 0.4113200604915619
loss_pred:0.07441335171461105, decouple_loss:0.04068944975733757
loss_pred:0.07434199750423431, decouple_loss:0.04069143906235695
WV_0_PC_0_EH_1_PS_40, loss: 0.07618562877178192, avg_mse: 0.07485000044107437
current test mse: 0.07485
Iteration: 111, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44965454936027527
loss_pred:0.06637909263372421, decouple_loss:0.03540854528546333
The generated pressure mean: 0.4510232210159302
loss_pred:0.06529033184051514, decouple_loss:0.03625163435935974
The generated pressure mean: 0.45185407996177673
loss_pred:0.06541718542575836, decouple_loss:0.035384733229875565
Iteration: 112, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45384883880615234
loss_pred:0.06646175682544708, decouple_loss:0.0314624197781086
The generated pressure mean: 0.45630714297294617
loss_pred:0.06457570195198059, decouple_loss:0.0322992317378521
The generated pressure mean: 0.45469579100608826
loss_pred:0.06848123669624329, decouple_loss:0.032345786690711975
Iteration: 113, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4652502238750458
loss_pred:0.06539853662252426, decouple_loss:0.0349944531917572
The generated pressure mean: 0.46406546235084534
loss_pred:0.06543823331594467, decouple_loss:0.03343488648533821
The generated pressure mean: 0.4635474383831024
loss_pred:0.0653730109333992, decouple_loss:0.034334827214479446
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 114, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45404329895973206
loss_pred:0.06599501520395279, decouple_loss:0.03249610587954521
The generated pressure mean: 0.45565512776374817
loss_pred:0.06428010016679764, decouple_loss:0.03280691057443619
The generated pressure mean: 0.454032301902771
loss_pred:0.06538748741149902, decouple_loss:0.03296241909265518
Iteration: 115, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4558263421058655
The generated pressure mean: 0.4544154107570648
loss_pred:0.06477248668670654, decouple_loss:0.03057583048939705
loss_pred:0.06669770926237106, decouple_loss:0.031379036605358124
The generated pressure mean: 0.4577357769012451
loss_pred:0.06414928287267685, decouple_loss:0.03310495615005493
Iteration: 116, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4579503834247589
loss_pred:0.06571963429450989, decouple_loss:0.030601348727941513
The generated pressure mean: 0.4578777849674225
loss_pred:0.0641656294465065, decouple_loss:0.031179502606391907
The generated pressure mean: 0.46046847105026245
loss_pred:0.06404772400856018, decouple_loss:0.033059392124414444
Iteration: 117, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.452796995639801
The generated pressure mean: 0.45388832688331604
loss_pred:0.06326118111610413, decouple_loss:0.030749132856726646
loss_pred:0.06619591265916824, decouple_loss:0.03076513111591339
The generated pressure mean: 0.4539831280708313
loss_pred:0.06326986849308014, decouple_loss:0.03059731051325798
Iteration: 118, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45670586824417114
The generated pressure mean: 0.4545581340789795
loss_pred:0.06301427632570267, decouple_loss:0.030112098902463913
loss_pred:0.06558950245380402, decouple_loss:0.030036011710762978
The generated pressure mean: 0.45429790019989014
loss_pred:0.06484147906303406, decouple_loss:0.02981177158653736
Iteration: 119, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45274609327316284
loss_pred:0.06168099865317345, decouple_loss:0.02900032512843609
The generated pressure mean: 0.45432791113853455
loss_pred:0.06151488423347473, decouple_loss:0.02999679557979107
The generated pressure mean: 0.4526917636394501
loss_pred:0.06345757842063904, decouple_loss:0.030282605439424515
Iteration: 120, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506596624851227
The generated pressure mean: 0.45042455196380615
loss_pred:0.06441275775432587, decouple_loss:0.029633309692144394
loss_pred:0.06115615740418434, decouple_loss:0.02926953136920929
The generated pressure mean: 0.4536745250225067
loss_pred:0.061947181820869446, decouple_loss:0.02976328879594803
2023-04-16 12:48:05 testing...
The generated pressure mean: 0.4090422987937927
The generated pressure mean: 0.409578412771225
The generated pressure mean: 0.4093300402164459
loss_pred:0.06966280937194824, decouple_loss:0.03203459829092026
loss_pred:0.07015801966190338, decouple_loss:0.03462523594498634
loss_pred:0.06995972245931625, decouple_loss:0.03453666344285011
WV_0_PC_0_EH_1_PS_40, loss: 0.07161346077919006, avg_mse: 0.07002073526382446
current test mse: 0.070021
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 121, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45064979791641235
loss_pred:0.06248996779322624, decouple_loss:0.029092438519001007
The generated pressure mean: 0.4533061683177948
loss_pred:0.06283821165561676, decouple_loss:0.03145259618759155
The generated pressure mean: 0.4506959319114685
loss_pred:0.06243939697742462, decouple_loss:0.028789741918444633
Iteration: 122, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507516026496887
loss_pred:0.0613069012761116, decouple_loss:0.02818242460489273
The generated pressure mean: 0.45138809084892273
loss_pred:0.06485462933778763, decouple_loss:0.030501024797558784
The generated pressure mean: 0.4528881907463074
loss_pred:0.0635831356048584, decouple_loss:0.02814630977809429
Iteration: 123, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45237812399864197
loss_pred:0.061632733792066574, decouple_loss:0.02907274104654789
The generated pressure mean: 0.45161086320877075
loss_pred:0.06249868869781494, decouple_loss:0.028428291901946068
The generated pressure mean: 0.45374688506126404
loss_pred:0.06187862902879715, decouple_loss:0.02845645323395729
Iteration: 124, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4515577554702759
loss_pred:0.060894858092069626, decouple_loss:0.029716921970248222
The generated pressure mean: 0.45243310928344727
loss_pred:0.059368230402469635, decouple_loss:0.028997348621487617
The generated pressure mean: 0.4533321261405945
loss_pred:0.06218915805220604, decouple_loss:0.029632218182086945
Iteration: 125, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4523571729660034
The generated pressure mean: 0.4534284770488739
loss_pred:0.06113559007644653, decouple_loss:0.028423495590686798
loss_pred:0.06367012113332748, decouple_loss:0.0297487024217844
The generated pressure mean: 0.4534353017807007
loss_pred:0.0641334056854248, decouple_loss:0.029161524027585983
Iteration: 126, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45150843262672424
loss_pred:0.062373753637075424, decouple_loss:0.029237588867545128
The generated pressure mean: 0.4525103271007538
loss_pred:0.061463795602321625, decouple_loss:0.029551008716225624
The generated pressure mean: 0.45291048288345337
loss_pred:0.06140543147921562, decouple_loss:0.028768101707100868
Iteration: 127, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45244407653808594
loss_pred:0.06045667082071304, decouple_loss:0.02940710447728634
The generated pressure mean: 0.4536250829696655
loss_pred:0.05947968736290932, decouple_loss:0.02934414893388748
The generated pressure mean: 0.4525240361690521
loss_pred:0.06095394492149353, decouple_loss:0.02913627214729786
Iteration: 128, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503215551376343
loss_pred:0.06131172925233841, decouple_loss:0.028005952015519142
The generated pressure mean: 0.4524070918560028
loss_pred:0.06074792519211769, decouple_loss:0.027839548885822296
The generated pressure mean: 0.4512670040130615
loss_pred:0.06257614493370056, decouple_loss:0.028414849191904068
Iteration: 129, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459224045276642
loss_pred:0.060221392661333084, decouple_loss:0.028802301734685898
The generated pressure mean: 0.44753265380859375
loss_pred:0.06237735226750374, decouple_loss:0.030288321897387505
The generated pressure mean: 0.44783923029899597
loss_pred:0.06175176426768303, decouple_loss:0.028436172753572464
Iteration: 130, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45820772647857666
loss_pred:0.0635785162448883, decouple_loss:0.04267720505595207
The generated pressure mean: 0.4575616717338562
loss_pred:0.06393522769212723, decouple_loss:0.04270332306623459
The generated pressure mean: 0.4552878439426422
loss_pred:0.06078270077705383, decouple_loss:0.04235311970114708
2023-04-16 12:50:34 testing...
The generated pressure mean: 0.41371843218803406
The generated pressure mean: 0.41408348083496094
The generated pressure mean: 0.4138413965702057
loss_pred:0.07376747578382492, decouple_loss:0.0489899143576622
loss_pred:0.07341884076595306, decouple_loss:0.05139488726854324
loss_pred:0.07376328110694885, decouple_loss:0.05159725248813629
WV_0_PC_0_EH_1_PS_40, loss: 0.07618290185928345, avg_mse: 0.07518093287944794
current test mse: 0.075181
Iteration: 131, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43335896730422974
loss_pred:0.06758011877536774, decouple_loss:0.04633850231766701
The generated pressure mean: 0.4320487976074219
loss_pred:0.06831476092338562, decouple_loss:0.04680551588535309
The generated pressure mean: 0.4347020089626312
loss_pred:0.067973293364048, decouple_loss:0.04505011811852455
Iteration: 132, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45823797583580017
loss_pred:0.06835388392210007, decouple_loss:0.04182744398713112
The generated pressure mean: 0.45817166566848755
loss_pred:0.06491470336914062, decouple_loss:0.0396980419754982
The generated pressure mean: 0.46036821603775024
loss_pred:0.06541166454553604, decouple_loss:0.04081883653998375
Iteration: 133, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46425992250442505
loss_pred:0.06569933891296387, decouple_loss:0.03489414229989052
The generated pressure mean: 0.465614378452301
loss_pred:0.06691810488700867, decouple_loss:0.03504092991352081
The generated pressure mean: 0.46350908279418945
loss_pred:0.06292489171028137, decouple_loss:0.0334930494427681
Iteration: 134, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46268805861473083
loss_pred:0.06401166319847107, decouple_loss:0.0449419803917408
The generated pressure mean: 0.4627153277397156
loss_pred:0.06367360800504684, decouple_loss:0.042767930775880814
The generated pressure mean: 0.465862900018692
loss_pred:0.063826784491539, decouple_loss:0.04308903217315674
Iteration: 135, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486422836780548
loss_pred:0.0647243931889534, decouple_loss:0.04517641291022301
The generated pressure mean: 0.4478977918624878
loss_pred:0.06522510200738907, decouple_loss:0.046035949140787125
The generated pressure mean: 0.4479143023490906
loss_pred:0.06669206917285919, decouple_loss:0.0456596314907074
Iteration: 136, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4214736521244049
loss_pred:0.06261903792619705, decouple_loss:0.04672883450984955
The generated pressure mean: 0.42405807971954346
loss_pred:0.061141155660152435, decouple_loss:0.04686102643609047
The generated pressure mean: 0.42341405153274536
loss_pred:0.06149249151349068, decouple_loss:0.04735010489821434
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 137, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42744702100753784
loss_pred:0.06235955283045769, decouple_loss:0.05217546969652176
The generated pressure mean: 0.42707255482673645
loss_pred:0.06475872546434402, decouple_loss:0.05183205381035805
The generated pressure mean: 0.42916566133499146
loss_pred:0.062449339777231216, decouple_loss:0.051766976714134216
Iteration: 138, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4573362171649933
loss_pred:0.06075071543455124, decouple_loss:0.05063118785619736
The generated pressure mean: 0.4580335319042206
loss_pred:0.06184689328074455, decouple_loss:0.05080355331301689
The generated pressure mean: 0.45732733607292175
loss_pred:0.061742257326841354, decouple_loss:0.050368357449769974
Iteration: 139, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4831336736679077
loss_pred:0.06285607814788818, decouple_loss:0.05122336745262146
The generated pressure mean: 0.48337993025779724
loss_pred:0.06238748878240585, decouple_loss:0.051294438540935516
The generated pressure mean: 0.4830743670463562
loss_pred:0.06394103914499283, decouple_loss:0.05093306675553322
Iteration: 140, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46684423089027405
loss_pred:0.062305282801389694, decouple_loss:0.05071069672703743
The generated pressure mean: 0.4669787585735321
loss_pred:0.06077592447400093, decouple_loss:0.05015208199620247
The generated pressure mean: 0.4662322700023651
loss_pred:0.060351137071847916, decouple_loss:0.05101906880736351
2023-04-16 12:52:28 testing...
The generated pressure mean: 0.4127177298069
The generated pressure mean: 0.41323158144950867
loss_pred:0.06730103492736816, decouple_loss:0.05501246824860573
The generated pressure mean: 0.41302597522735596
loss_pred:0.06784597039222717, decouple_loss:0.05645262077450752
loss_pred:0.06787226349115372, decouple_loss:0.056097377091646194
WV_0_PC_0_EH_1_PS_40, loss: 0.07046579569578171, avg_mse: 0.06822390854358673
current test mse: 0.068224
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 141, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4373267590999603
loss_pred:0.06152593344449997, decouple_loss:0.05365535989403725
The generated pressure mean: 0.4369468688964844
loss_pred:0.06098691746592522, decouple_loss:0.05240899696946144
The generated pressure mean: 0.4384452700614929
loss_pred:0.06033032014966011, decouple_loss:0.052911169826984406
Iteration: 142, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42896613478660583
The generated pressure mean: 0.4278380274772644
loss_pred:0.06035700440406799, decouple_loss:0.045985423028469086
loss_pred:0.059709735214710236, decouple_loss:0.046462513506412506
The generated pressure mean: 0.4274464249610901
loss_pred:0.06277092546224594, decouple_loss:0.04638849198818207
Iteration: 143, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4370173215866089
loss_pred:0.05844422057271004, decouple_loss:0.05103349685668945
The generated pressure mean: 0.4357166588306427
loss_pred:0.060915641486644745, decouple_loss:0.050585921853780746
The generated pressure mean: 0.43740159273147583
loss_pred:0.06374543160200119, decouple_loss:0.05071478709578514
Iteration: 144, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495508372783661
The generated pressure mean: 0.44818708300590515
loss_pred:0.06321405619382858, decouple_loss:0.0498802475631237
loss_pred:0.060485441237688065, decouple_loss:0.05002424493432045
The generated pressure mean: 0.44765934348106384
loss_pred:0.061241548508405685, decouple_loss:0.050088070333004
Iteration: 145, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45650118589401245
The generated pressure mean: 0.4547697603702545
loss_pred:0.058533623814582825, decouple_loss:0.041279736906290054
loss_pred:0.06032143533229828, decouple_loss:0.04156239703297615
The generated pressure mean: 0.4543386399745941
loss_pred:0.059383995831012726, decouple_loss:0.042264558374881744
Iteration: 146, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4557741582393646
loss_pred:0.062046073377132416, decouple_loss:0.04695061221718788
The generated pressure mean: 0.45462489128112793
loss_pred:0.05993933230638504, decouple_loss:0.04684782773256302
The generated pressure mean: 0.45622169971466064
loss_pred:0.06162803992629051, decouple_loss:0.04722129553556442
Iteration: 147, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45734718441963196
loss_pred:0.05894986540079117, decouple_loss:0.04342145100235939
The generated pressure mean: 0.4592454731464386
loss_pred:0.05995448678731918, decouple_loss:0.04244517907500267
The generated pressure mean: 0.45830196142196655
loss_pred:0.06157844886183739, decouple_loss:0.04404325410723686
Iteration: 148, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45965859293937683
loss_pred:0.06438367068767548, decouple_loss:0.038615934550762177
The generated pressure mean: 0.4603659510612488
loss_pred:0.05995858833193779, decouple_loss:0.03846198692917824
The generated pressure mean: 0.4601302444934845
loss_pred:0.05959170684218407, decouple_loss:0.038786765187978745
Iteration: 149, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45279067754745483
loss_pred:0.06265823543071747, decouple_loss:0.03998878598213196
The generated pressure mean: 0.4528721868991852
loss_pred:0.05765269324183464, decouple_loss:0.04061318188905716
The generated pressure mean: 0.45346173644065857
loss_pred:0.06035080924630165, decouple_loss:0.039479222148656845
Iteration: 150, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4415266811847687
loss_pred:0.05723892152309418, decouple_loss:0.03848111629486084
The generated pressure mean: 0.44146570563316345
loss_pred:0.06023960933089256, decouple_loss:0.0380253940820694
The generated pressure mean: 0.4419054388999939
loss_pred:0.06087362393736839, decouple_loss:0.03801475465297699
2023-04-16 12:54:58 testing...
The generated pressure mean: 0.4124193489551544
The generated pressure mean: 0.41281139850616455
loss_pred:0.06598255038261414, decouple_loss:0.04020573943853378
The generated pressure mean: 0.4125361442565918
loss_pred:0.06658655405044556, decouple_loss:0.04290555417537689
loss_pred:0.06647782772779465, decouple_loss:0.04156515374779701
WV_0_PC_0_EH_1_PS_40, loss: 0.06842692196369171, avg_mse: 0.06657737493515015
current test mse: 0.066577
Iteration: 151, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43880197405815125
loss_pred:0.059574324637651443, decouple_loss:0.03744327276945114
The generated pressure mean: 0.4373336732387543
loss_pred:0.06086547300219536, decouple_loss:0.03779253363609314
The generated pressure mean: 0.4373300075531006
loss_pred:0.05891641601920128, decouple_loss:0.037075869739055634
Iteration: 152, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.442510187625885
loss_pred:0.06017505005002022, decouple_loss:0.03850582614541054
The generated pressure mean: 0.4424416422843933
loss_pred:0.06055706739425659, decouple_loss:0.03741879016160965
The generated pressure mean: 0.4419918954372406
loss_pred:0.06333648413419724, decouple_loss:0.037584058940410614
Iteration: 153, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44874662160873413
loss_pred:0.05835750326514244, decouple_loss:0.03568657115101814
The generated pressure mean: 0.44882628321647644
loss_pred:0.05926098674535751, decouple_loss:0.036372557282447815
The generated pressure mean: 0.4476622939109802
loss_pred:0.05771735683083534, decouple_loss:0.03557074815034866
Iteration: 154, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4539632797241211
loss_pred:0.060429275035858154, decouple_loss:0.03469676896929741
The generated pressure mean: 0.4547344744205475
loss_pred:0.058308105915784836, decouple_loss:0.03547556698322296
The generated pressure mean: 0.4527386426925659
loss_pred:0.057630136609077454, decouple_loss:0.03524105250835419
Iteration: 155, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45642539858818054
loss_pred:0.05812200531363487, decouple_loss:0.03430240973830223
The generated pressure mean: 0.45530828833580017
loss_pred:0.05945606157183647, decouple_loss:0.033985644578933716
The generated pressure mean: 0.45617806911468506
loss_pred:0.05936427041888237, decouple_loss:0.033504899591207504
Iteration: 156, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45632684230804443
loss_pred:0.059152960777282715, decouple_loss:0.03406397998332977
The generated pressure mean: 0.455445259809494
loss_pred:0.058121416717767715, decouple_loss:0.03364749997854233
The generated pressure mean: 0.45600154995918274
loss_pred:0.05670247972011566, decouple_loss:0.03378523141145706
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 157, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4579387903213501
loss_pred:0.056883156299591064, decouple_loss:0.031158436089754105
The generated pressure mean: 0.45662441849708557
loss_pred:0.059190116822719574, decouple_loss:0.03217674046754837
The generated pressure mean: 0.45810407400131226
loss_pred:0.06164705008268356, decouple_loss:0.030525408685207367
Iteration: 158, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4555332362651825
loss_pred:0.05754793807864189, decouple_loss:0.03206972777843475
The generated pressure mean: 0.45542898774147034
loss_pred:0.059315867722034454, decouple_loss:0.031243788078427315
The generated pressure mean: 0.4539566934108734
loss_pred:0.058003637939691544, decouple_loss:0.03145203739404678
Iteration: 159, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499451816082001
loss_pred:0.05849746614694595, decouple_loss:0.03067540004849434
The generated pressure mean: 0.44971764087677
loss_pred:0.0561164952814579, decouple_loss:0.03051091730594635
The generated pressure mean: 0.4503684937953949
loss_pred:0.05739673227071762, decouple_loss:0.02939552441239357
Iteration: 160, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4434587359428406
loss_pred:0.05731504410505295, decouple_loss:0.030751390382647514
The generated pressure mean: 0.4446326792240143
loss_pred:0.05788060650229454, decouple_loss:0.0308025274425745
The generated pressure mean: 0.4457054138183594
loss_pred:0.05835789069533348, decouple_loss:0.03036355786025524
2023-04-16 12:56:53 testing...
The generated pressure mean: 0.4105430841445923
The generated pressure mean: 0.4110088348388672
The generated pressure mean: 0.41080328822135925
loss_pred:0.0650465339422226, decouple_loss:0.03209458664059639
loss_pred:0.06545734405517578, decouple_loss:0.03495923429727554
loss_pred:0.06518804281949997, decouple_loss:0.0349884107708931
WV_0_PC_0_EH_1_PS_40, loss: 0.06693135201931, avg_mse: 0.06583596020936966
current test mse: 0.065836
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 161, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4457070231437683
loss_pred:0.05932828038930893, decouple_loss:0.029279084876179695
The generated pressure mean: 0.4451774060726166
The generated pressure mean: 0.4447707533836365
loss_pred:0.0576438307762146, decouple_loss:0.02991638518869877
loss_pred:0.05937877669930458, decouple_loss:0.02924806997179985
Iteration: 162, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464509189128876
loss_pred:0.05566830933094025, decouple_loss:0.029157200828194618
The generated pressure mean: 0.4457368552684784
loss_pred:0.05656499043107033, decouple_loss:0.029320985078811646
The generated pressure mean: 0.4480595886707306
loss_pred:0.05694965645670891, decouple_loss:0.03008614294230938
Iteration: 163, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503846764564514
loss_pred:0.059456340968608856, decouple_loss:0.027893749997019768
The generated pressure mean: 0.4492146074771881
loss_pred:0.05770014598965645, decouple_loss:0.028278527781367302
The generated pressure mean: 0.44907858967781067
loss_pred:0.05815797299146652, decouple_loss:0.029742570593953133
Iteration: 164, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4513256549835205
loss_pred:0.055945321917533875, decouple_loss:0.027986668050289154
The generated pressure mean: 0.4505123198032379
loss_pred:0.060005657374858856, decouple_loss:0.027776340022683144
The generated pressure mean: 0.4511305093765259
loss_pred:0.05956322327256203, decouple_loss:0.027677349746227264
Iteration: 165, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508344233036041
loss_pred:0.05873844772577286, decouple_loss:0.027231233194470406
The generated pressure mean: 0.4508698880672455
loss_pred:0.05908791348338127, decouple_loss:0.02767914906144142
The generated pressure mean: 0.4512689709663391
loss_pred:0.06009792163968086, decouple_loss:0.02663286030292511
Iteration: 166, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4549650549888611
loss_pred:0.05658739432692528, decouple_loss:0.028973499312996864
The generated pressure mean: 0.4547443091869354
loss_pred:0.056877363473176956, decouple_loss:0.02681811898946762
The generated pressure mean: 0.4555700123310089
loss_pred:0.057461995631456375, decouple_loss:0.02699560672044754
Iteration: 167, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45189201831817627
loss_pred:0.057519640773534775, decouple_loss:0.0264139361679554
The generated pressure mean: 0.45247283577919006
loss_pred:0.05490313842892647, decouple_loss:0.026345038786530495
The generated pressure mean: 0.4523877501487732
loss_pred:0.058194056153297424, decouple_loss:0.02608199417591095
Iteration: 168, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478277266025543
loss_pred:0.057076338678598404, decouple_loss:0.02686251886188984
The generated pressure mean: 0.4493599832057953
loss_pred:0.056762393563985825, decouple_loss:0.02733941376209259
The generated pressure mean: 0.4494715929031372
loss_pred:0.05924578383564949, decouple_loss:0.02730080671608448
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 169, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44720926880836487
loss_pred:0.058160435408353806, decouple_loss:0.026980895549058914
The generated pressure mean: 0.44699782133102417
loss_pred:0.056608282029628754, decouple_loss:0.02683090604841709
The generated pressure mean: 0.44726812839508057
loss_pred:0.0572085864841938, decouple_loss:0.026874331757426262
Iteration: 170, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44272032380104065
loss_pred:0.057501912117004395, decouple_loss:0.025870179757475853
The generated pressure mean: 0.44326192140579224
loss_pred:0.05793484300374985, decouple_loss:0.026036392897367477
The generated pressure mean: 0.44418391585350037
loss_pred:0.05791999399662018, decouple_loss:0.026153551414608955
2023-04-16 12:59:24 testing...
The generated pressure mean: 0.41103729605674744
The generated pressure mean: 0.41158944368362427
loss_pred:0.06419391185045242, decouple_loss:0.02929668314754963
The generated pressure mean: 0.41142743825912476
loss_pred:0.06456805020570755, decouple_loss:0.03224096819758415
loss_pred:0.0642288476228714, decouple_loss:0.03225215524435043
WV_0_PC_0_EH_1_PS_40, loss: 0.06589344143867493, avg_mse: 0.06526374071836472
current test mse: 0.065264
Iteration: 171, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4453549087047577
loss_pred:0.057848867028951645, decouple_loss:0.026282750070095062
The generated pressure mean: 0.44511812925338745
loss_pred:0.055008579045534134, decouple_loss:0.02621948905289173
The generated pressure mean: 0.443895548582077
loss_pred:0.05586188659071922, decouple_loss:0.02534622512757778
Iteration: 172, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447659432888031
loss_pred:0.060174714773893356, decouple_loss:0.025707101449370384
The generated pressure mean: 0.4451581835746765
loss_pred:0.057995907962322235, decouple_loss:0.024936817586421967
The generated pressure mean: 0.4459676444530487
loss_pred:0.05735966935753822, decouple_loss:0.025600673630833626
Iteration: 173, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4528619349002838
loss_pred:0.05976741388440132, decouple_loss:0.025292223319411278
The generated pressure mean: 0.4519466459751129
loss_pred:0.057757701724767685, decouple_loss:0.024642078205943108
The generated pressure mean: 0.45232927799224854
loss_pred:0.054023101925849915, decouple_loss:0.02513548545539379
Iteration: 174, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4555922746658325
loss_pred:0.05563485249876976, decouple_loss:0.024879135191440582
The generated pressure mean: 0.456966370344162
loss_pred:0.060035668313503265, decouple_loss:0.02483958564698696
The generated pressure mean: 0.45551079511642456
loss_pred:0.05317335203289986, decouple_loss:0.024964554235339165
Iteration: 175, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4573139250278473
loss_pred:0.059318993240594864, decouple_loss:0.02511618472635746
The generated pressure mean: 0.4560483694076538
loss_pred:0.056337498128414154, decouple_loss:0.02497997134923935
The generated pressure mean: 0.4571523070335388
loss_pred:0.056573692709207535, decouple_loss:0.026225395500659943
Iteration: 176, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4516591429710388
loss_pred:0.05886508524417877, decouple_loss:0.02721586264669895
The generated pressure mean: 0.45161518454551697
loss_pred:0.058948319405317307, decouple_loss:0.02687237784266472
The generated pressure mean: 0.4510652422904968
loss_pred:0.05770060420036316, decouple_loss:0.027873530983924866
Iteration: 177, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474847912788391
loss_pred:0.05668310075998306, decouple_loss:0.02992413379251957
The generated pressure mean: 0.44758403301239014
loss_pred:0.06000968813896179, decouple_loss:0.02974933758378029
The generated pressure mean: 0.44745898246765137
loss_pred:0.05510571599006653, decouple_loss:0.03031703643500805
Iteration: 178, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4415057897567749
loss_pred:0.059310585260391235, decouple_loss:0.025969956070184708
The generated pressure mean: 0.4423941969871521
loss_pred:0.05561744421720505, decouple_loss:0.026259202510118484
The generated pressure mean: 0.44306886196136475
loss_pred:0.05510589852929115, decouple_loss:0.026491621509194374
Iteration: 179, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44387733936309814
loss_pred:0.056512027978897095, decouple_loss:0.02527664415538311
The generated pressure mean: 0.4441033601760864
loss_pred:0.05835113301873207, decouple_loss:0.02559913694858551
The generated pressure mean: 0.44509536027908325
loss_pred:0.05744124948978424, decouple_loss:0.02541828528046608
Iteration: 180, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474927484989166
loss_pred:0.054852720350027084, decouple_loss:0.026084767654538155
The generated pressure mean: 0.4473381042480469
loss_pred:0.054707422852516174, decouple_loss:0.025788819417357445
The generated pressure mean: 0.4467563033103943
loss_pred:0.05474301800131798, decouple_loss:0.025092190131545067
2023-04-16 13:01:17 testing...
The generated pressure mean: 0.4089556336402893
The generated pressure mean: 0.4094172418117523
The generated pressure mean: 0.40928396582603455
loss_pred:0.0635669156908989, decouple_loss:0.027916161343455315
loss_pred:0.06336425244808197, decouple_loss:0.030544480308890343
loss_pred:0.0638115182518959, decouple_loss:0.030602270737290382
WV_0_PC_0_EH_1_PS_40, loss: 0.06506527960300446, avg_mse: 0.06502757221460342
current test mse: 0.065028
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 181, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493701159954071
loss_pred:0.057877760380506516, decouple_loss:0.02493857406079769
The generated pressure mean: 0.45039311051368713
The generated pressure mean: 0.45199674367904663
loss_pred:0.05473116785287857, decouple_loss:0.024919841438531876
loss_pred:0.05895877256989479, decouple_loss:0.02583112195134163
Iteration: 182, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4523938298225403
The generated pressure mean: 0.45110324025154114loss_pred:0.05462281033396721, decouple_loss:0.025411391630768776
loss_pred:0.0580425001680851, decouple_loss:0.026827890425920486
The generated pressure mean: 0.4524106979370117
loss_pred:0.05252908170223236, decouple_loss:0.026071639731526375
Iteration: 183, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4539867639541626
The generated pressure mean: 0.45498695969581604loss_pred:0.05651303753256798, decouple_loss:0.024674508720636368
loss_pred:0.05304744839668274, decouple_loss:0.02378280833363533
The generated pressure mean: 0.4546753764152527
loss_pred:0.05411181598901749, decouple_loss:0.023990046232938766
Iteration: 184, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45560795068740845
The generated pressure mean: 0.45433592796325684
loss_pred:0.060041118413209915, decouple_loss:0.02425161562860012
loss_pred:0.056511737406253815, decouple_loss:0.024632060900330544
The generated pressure mean: 0.4530186653137207
loss_pred:0.0589304119348526, decouple_loss:0.023274198174476624
Iteration: 185, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449666142463684
The generated pressure mean: 0.44760626554489136
loss_pred:0.056632474064826965, decouple_loss:0.026381345465779305
loss_pred:0.05971985682845116, decouple_loss:0.0284478347748518
The generated pressure mean: 0.44778135418891907
loss_pred:0.059391167014837265, decouple_loss:0.026564469560980797
Iteration: 186, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4384305477142334
The generated pressure mean: 0.4415188133716583
loss_pred:0.0583549439907074, decouple_loss:0.02762499637901783
loss_pred:0.058959729969501495, decouple_loss:0.02792072668671608
The generated pressure mean: 0.4390149712562561
loss_pred:0.056849073618650436, decouple_loss:0.027247419580817223
Iteration: 187, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43850284814834595
The generated pressure mean: 0.4385347366333008
loss_pred:0.05467739701271057, decouple_loss:0.029722267761826515
loss_pred:0.05853791907429695, decouple_loss:0.028061604127287865
The generated pressure mean: 0.4392326772212982
loss_pred:0.053354259580373764, decouple_loss:0.028205247595906258
Iteration: 188, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4450347423553467
loss_pred:0.0557435043156147, decouple_loss:0.029354043304920197
The generated pressure mean: 0.4453465938568115
loss_pred:0.05561700090765953, decouple_loss:0.027892354875802994
The generated pressure mean: 0.4438251256942749
loss_pred:0.05401507019996643, decouple_loss:0.028333405032753944
Iteration: 189, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45528197288513184
loss_pred:0.0567752979695797, decouple_loss:0.028662048280239105
The generated pressure mean: 0.4569818079471588
loss_pred:0.05300629511475563, decouple_loss:0.028401747345924377
The generated pressure mean: 0.45538443326950073
loss_pred:0.05490823835134506, decouple_loss:0.027970988303422928
Iteration: 190, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4617842137813568
loss_pred:0.05551727116107941, decouple_loss:0.02788405679166317
The generated pressure mean: 0.46094653010368347
loss_pred:0.058395419269800186, decouple_loss:0.027756981551647186
The generated pressure mean: 0.4605776369571686
loss_pred:0.05708447843790054, decouple_loss:0.02929934486746788
2023-04-16 13:03:49 testing...
The generated pressure mean: 0.40750205516815186
The generated pressure mean: 0.40787550806999207
loss_pred:0.06276008486747742, decouple_loss:0.030344510450959206
The generated pressure mean: 0.40776005387306213
loss_pred:0.0628010481595993, decouple_loss:0.032848238945007324
loss_pred:0.062218885868787766, decouple_loss:0.033121753484010696
WV_0_PC_0_EH_1_PS_40, loss: 0.0641985833644867, avg_mse: 0.06421597301959991
current test mse: 0.064216
Iteration: 191, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45555007457733154
loss_pred:0.05463767424225807, decouple_loss:0.027502404525876045
The generated pressure mean: 0.4551522433757782
loss_pred:0.05198712274432182, decouple_loss:0.027910474687814713
The generated pressure mean: 0.4546303451061249
loss_pred:0.055881377309560776, decouple_loss:0.026878472417593002
Iteration: 192, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449273347854614
loss_pred:0.05309800058603287, decouple_loss:0.027585139498114586
The generated pressure mean: 0.44507765769958496
loss_pred:0.052280571311712265, decouple_loss:0.02784307859838009
The generated pressure mean: 0.4426265358924866
loss_pred:0.0521402433514595, decouple_loss:0.027812497690320015
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 193, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44077420234680176
loss_pred:0.05535173416137695, decouple_loss:0.028905775398015976
The generated pressure mean: 0.43978631496429443
loss_pred:0.05676981434226036, decouple_loss:0.02772635594010353
The generated pressure mean: 0.44161316752433777
loss_pred:0.05782201141119003, decouple_loss:0.027212131768465042
Iteration: 194, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4439496099948883
loss_pred:0.053054746240377426, decouple_loss:0.03102993778884411
The generated pressure mean: 0.4453677237033844
loss_pred:0.05472613126039505, decouple_loss:0.03074726089835167
The generated pressure mean: 0.4460922181606293
loss_pred:0.05382298678159714, decouple_loss:0.030590025708079338
Iteration: 195, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4552336037158966
loss_pred:0.05843618884682655, decouple_loss:0.03142281621694565
The generated pressure mean: 0.4519977271556854
loss_pred:0.05333024263381958, decouple_loss:0.031522758305072784
The generated pressure mean: 0.4545694887638092
loss_pred:0.05248256400227547, decouple_loss:0.031686291098594666
Iteration: 196, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.453048437833786
loss_pred:0.054372258484363556, decouple_loss:0.028128130361437798
The generated pressure mean: 0.4548158049583435
loss_pred:0.05561874806880951, decouple_loss:0.028540726751089096
The generated pressure mean: 0.45241472125053406
loss_pred:0.05606374144554138, decouple_loss:0.028239702805876732
Iteration: 197, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44827353954315186
loss_pred:0.05303426459431648, decouple_loss:0.03134853020310402
The generated pressure mean: 0.45035073161125183
loss_pred:0.05324101820588112, decouple_loss:0.031244106590747833
The generated pressure mean: 0.44943439960479736
loss_pred:0.05229159817099571, decouple_loss:0.03164558857679367
Iteration: 198, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44701504707336426
loss_pred:0.05134351924061775, decouple_loss:0.03153424337506294
The generated pressure mean: 0.44788917899131775
loss_pred:0.053274400532245636, decouple_loss:0.030172575265169144
The generated pressure mean: 0.44843852519989014
loss_pred:0.05359343811869621, decouple_loss:0.030551381409168243
Iteration: 199, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483785331249237
loss_pred:0.05302758142352104, decouple_loss:0.030801517888903618
The generated pressure mean: 0.44907307624816895
loss_pred:0.057369258254766464, decouple_loss:0.030154960229992867
The generated pressure mean: 0.45013079047203064
loss_pred:0.05655733123421669, decouple_loss:0.03134317323565483
Iteration: 200, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4544081687927246
loss_pred:0.05920999497175217, decouple_loss:0.03190017119050026
The generated pressure mean: 0.4548777937889099
loss_pred:0.05538434907793999, decouple_loss:0.031657349318265915
The generated pressure mean: 0.45401936769485474
loss_pred:0.05562756955623627, decouple_loss:0.03101654164493084
2023-04-16 13:05:43 testing...
The generated pressure mean: 0.41099175810813904
The generated pressure mean: 0.41144832968711853
loss_pred:0.06170922890305519, decouple_loss:0.030790144577622414
The generated pressure mean: 0.4113944470882416
loss_pred:0.06178954988718033, decouple_loss:0.03299557417631149
loss_pred:0.06106438860297203, decouple_loss:0.03328034281730652
WV_0_PC_0_EH_1_PS_40, loss: 0.06313882768154144, avg_mse: 0.06352438777685165
current test mse: 0.063524
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 201, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44318363070487976
loss_pred:0.054886266589164734, decouple_loss:0.029495730996131897
The generated pressure mean: 0.4429931044578552
The generated pressure mean: 0.4438140392303467
loss_pred:0.05785056948661804, decouple_loss:0.028926534578204155
loss_pred:0.05993477255105972, decouple_loss:0.03096575289964676
Iteration: 202, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4425834119319916
loss_pred:0.05646456778049469, decouple_loss:0.03603766858577728
The generated pressure mean: 0.44607290625572205
loss_pred:0.06374362111091614, decouple_loss:0.034129127860069275
The generated pressure mean: 0.44521644711494446
loss_pred:0.0547666996717453, decouple_loss:0.03100789338350296
Iteration: 203, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45369428396224976
loss_pred:0.05899893864989281, decouple_loss:0.030512012541294098
The generated pressure mean: 0.45317894220352173
loss_pred:0.05674814432859421, decouple_loss:0.030002055689692497
The generated pressure mean: 0.4543495774269104
loss_pred:0.058096081018447876, decouple_loss:0.031171904876828194
Iteration: 204, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449487566947937
loss_pred:0.06255443394184113, decouple_loss:0.031757622957229614
The generated pressure mean: 0.4469384253025055
loss_pred:0.056331418454647064, decouple_loss:0.030757231637835503
The generated pressure mean: 0.4495662748813629
loss_pred:0.053771842271089554, decouple_loss:0.03191148117184639
Iteration: 205, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44407159090042114
The generated pressure mean: 0.443256139755249
loss_pred:0.06197339668869972, decouple_loss:0.029665278270840645
loss_pred:0.05565883591771126, decouple_loss:0.0303787924349308
The generated pressure mean: 0.4455188810825348
loss_pred:0.05709820240736008, decouple_loss:0.031759247183799744
Iteration: 206, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452621042728424
The generated pressure mean: 0.44511961936950684
loss_pred:0.05769845098257065, decouple_loss:0.032301004976034164
loss_pred:0.057290252298116684, decouple_loss:0.033178847283124924
The generated pressure mean: 0.4477112293243408
loss_pred:0.058459747582674026, decouple_loss:0.0347292497754097
Iteration: 207, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44281333684921265
loss_pred:0.05777832120656967, decouple_loss:0.034990232437849045
The generated pressure mean: 0.4446236789226532
loss_pred:0.054343510419130325, decouple_loss:0.03598806634545326
The generated pressure mean: 0.4432516396045685
loss_pred:0.05525759235024452, decouple_loss:0.03580375760793686
Iteration: 208, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45467036962509155
loss_pred:0.05926565080881119, decouple_loss:0.03450504690408707
The generated pressure mean: 0.45572367310523987
loss_pred:0.0575266107916832, decouple_loss:0.034249287098646164
The generated pressure mean: 0.45257648825645447
loss_pred:0.05737956240773201, decouple_loss:0.03390930965542793
Iteration: 209, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45054447650909424
loss_pred:0.05414320155978203, decouple_loss:0.029748879373073578
The generated pressure mean: 0.45561590790748596
loss_pred:0.060882817953825, decouple_loss:0.03211544081568718
The generated pressure mean: 0.45556288957595825
loss_pred:0.057198259979486465, decouple_loss:0.03382045403122902
Iteration: 210, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489579498767853
loss_pred:0.057072944939136505, decouple_loss:0.03460364788770676
The generated pressure mean: 0.4493958652019501
loss_pred:0.05515159294009209, decouple_loss:0.03391494229435921
The generated pressure mean: 0.4499433636665344
loss_pred:0.05752244591712952, decouple_loss:0.0349106527864933
2023-04-16 13:08:10 testing...
The generated pressure mean: 0.4097377359867096
The generated pressure mean: 0.4104177951812744
loss_pred:0.06153649836778641, decouple_loss:0.03392574191093445
The generated pressure mean: 0.4103972017765045
loss_pred:0.06107629835605621, decouple_loss:0.036493126302957535
loss_pred:0.06070395186543465, decouple_loss:0.0359656848013401
WV_0_PC_0_EH_1_PS_40, loss: 0.06287866085767746, avg_mse: 0.06347198039293289
current test mse: 0.063472
Iteration: 211, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462622404098511
loss_pred:0.05500681698322296, decouple_loss:0.03256053477525711
The generated pressure mean: 0.4480522871017456
loss_pred:0.0555446520447731, decouple_loss:0.0319693349301815
The generated pressure mean: 0.45052963495254517
loss_pred:0.05550631880760193, decouple_loss:0.031933192163705826
Iteration: 212, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44885459542274475
loss_pred:0.05571017786860466, decouple_loss:0.027710484340786934
The generated pressure mean: 0.4474407434463501
loss_pred:0.05425405502319336, decouple_loss:0.026762712746858597
The generated pressure mean: 0.44886624813079834
loss_pred:0.05463942512869835, decouple_loss:0.02699609473347664
Iteration: 213, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482538104057312
loss_pred:0.05870722234249115, decouple_loss:0.030526485294103622
The generated pressure mean: 0.44515007734298706
loss_pred:0.05643298476934433, decouple_loss:0.029423534870147705
The generated pressure mean: 0.44686606526374817
loss_pred:0.05545009672641754, decouple_loss:0.030256636440753937
Iteration: 214, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4430398941040039
loss_pred:0.05346069857478142, decouple_loss:0.027989201247692108
The generated pressure mean: 0.44669482111930847
loss_pred:0.05464610829949379, decouple_loss:0.028208330273628235
The generated pressure mean: 0.44603487849235535
loss_pred:0.0558319129049778, decouple_loss:0.028104975819587708
Iteration: 215, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505259394645691
loss_pred:0.05413319915533066, decouple_loss:0.02867094613611698
The generated pressure mean: 0.4514126777648926
loss_pred:0.05471864715218544, decouple_loss:0.030656397342681885
The generated pressure mean: 0.44887107610702515
loss_pred:0.0522371344268322, decouple_loss:0.02899293042719364
Iteration: 216, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44931668043136597
loss_pred:0.05487118661403656, decouple_loss:0.02679550275206566
The generated pressure mean: 0.4481274485588074
loss_pred:0.05092382803559303, decouple_loss:0.028269603848457336
The generated pressure mean: 0.45054638385772705
loss_pred:0.05619726702570915, decouple_loss:0.02833797037601471
Iteration: 217, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4443386495113373
loss_pred:0.053320564329624176, decouple_loss:0.027952780947089195
The generated pressure mean: 0.4438931345939636
loss_pred:0.05439124256372452, decouple_loss:0.02745017036795616
The generated pressure mean: 0.44533583521842957
loss_pred:0.05536653846502304, decouple_loss:0.027928980067372322
Iteration: 218, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4510800838470459
loss_pred:0.05394384637475014, decouple_loss:0.030019083991646767
The generated pressure mean: 0.45090410113334656
loss_pred:0.05219012871384621, decouple_loss:0.029432348906993866
The generated pressure mean: 0.4535626173019409
loss_pred:0.0579647421836853, decouple_loss:0.02953304536640644
Iteration: 219, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44043824076652527
loss_pred:0.05508507788181305, decouple_loss:0.031127989292144775
The generated pressure mean: 0.4427729845046997
loss_pred:0.05380444973707199, decouple_loss:0.030933506786823273
The generated pressure mean: 0.44309332966804504
loss_pred:0.051428381353616714, decouple_loss:0.0311923548579216
Iteration: 220, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473554491996765
loss_pred:0.05265166237950325, decouple_loss:0.03171764314174652
The generated pressure mean: 0.4494863748550415
loss_pred:0.05395209789276123, decouple_loss:0.030997412279248238
The generated pressure mean: 0.44999146461486816
loss_pred:0.05597468093037605, decouple_loss:0.03282973915338516
2023-04-16 13:10:04 testing...
The generated pressure mean: 0.40806302428245544
The generated pressure mean: 0.4086349904537201
loss_pred:0.06072572246193886, decouple_loss:0.03136510029435158
The generated pressure mean: 0.40860432386398315
loss_pred:0.05997209623456001, decouple_loss:0.033853840082883835
loss_pred:0.059616368263959885, decouple_loss:0.03319160267710686
WV_0_PC_0_EH_1_PS_40, loss: 0.06174490600824356, avg_mse: 0.06261985749006271
current test mse: 0.06262
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 221, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45399758219718933
The generated pressure mean: 0.4533182382583618
loss_pred:0.056187234818935394, decouple_loss:0.030611803755164146
loss_pred:0.05212615057826042, decouple_loss:0.030268587172031403
The generated pressure mean: 0.4540754556655884
loss_pred:0.05225813016295433, decouple_loss:0.02879822440445423
Iteration: 222, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4409779906272888
loss_pred:0.05394676700234413, decouple_loss:0.0335523784160614
The generated pressure mean: 0.4427745044231415
loss_pred:0.05216088518500328, decouple_loss:0.034074053168296814
The generated pressure mean: 0.4418827295303345
loss_pred:0.05305028334259987, decouple_loss:0.03403233736753464
Iteration: 223, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45196038484573364
loss_pred:0.05129444971680641, decouple_loss:0.03528657928109169
The generated pressure mean: 0.4527427554130554
loss_pred:0.05211692303419113, decouple_loss:0.035178590565919876
The generated pressure mean: 0.45004451274871826
loss_pred:0.05342298001050949, decouple_loss:0.035093896090984344
Iteration: 224, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4521403908729553
loss_pred:0.05526856333017349, decouple_loss:0.029547974467277527
The generated pressure mean: 0.45065775513648987
loss_pred:0.05220436677336693, decouple_loss:0.028583860024809837
The generated pressure mean: 0.45196765661239624
loss_pred:0.05335957184433937, decouple_loss:0.029125193133950233
Iteration: 225, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44193559885025024
loss_pred:0.05172295495867729, decouple_loss:0.0323476605117321
The generated pressure mean: 0.44218847155570984
loss_pred:0.05280712619423866, decouple_loss:0.03128135949373245
The generated pressure mean: 0.4439440369606018
loss_pred:0.05400963872671127, decouple_loss:0.03150735795497894
Iteration: 226, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498877227306366
The generated pressure mean: 0.4500795602798462
loss_pred:0.05200965702533722, decouple_loss:0.03119766153395176
loss_pred:0.05073487386107445, decouple_loss:0.030963316559791565
The generated pressure mean: 0.450534462928772
loss_pred:0.053253937512636185, decouple_loss:0.03018823452293873
Iteration: 227, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44883689284324646
loss_pred:0.052203744649887085, decouple_loss:0.027831634506583214
The generated pressure mean: 0.44928380846977234
loss_pred:0.051520537585020065, decouple_loss:0.02761346846818924
The generated pressure mean: 0.45023658871650696
loss_pred:0.052426788955926895, decouple_loss:0.027389908209443092
Iteration: 228, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480225741863251
loss_pred:0.05096747726202011, decouple_loss:0.029425321146845818
The generated pressure mean: 0.44779059290885925
loss_pred:0.05262620002031326, decouple_loss:0.029812732711434364
The generated pressure mean: 0.44520679116249084
loss_pred:0.051034826785326004, decouple_loss:0.029411807656288147
Iteration: 229, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488467872142792
loss_pred:0.05070013925433159, decouple_loss:0.028591124340891838
The generated pressure mean: 0.44871070981025696
loss_pred:0.05011468380689621, decouple_loss:0.028475910425186157
The generated pressure mean: 0.44888898730278015
loss_pred:0.049396391957998276, decouple_loss:0.029149066656827927
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 230, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44913631677627563
loss_pred:0.04872434213757515, decouple_loss:0.028443872928619385
The generated pressure mean: 0.4504777789115906
loss_pred:0.05070728436112404, decouple_loss:0.02722829580307007
The generated pressure mean: 0.450270414352417
loss_pred:0.05298232287168503, decouple_loss:0.02711695246398449
2023-04-16 13:12:35 testing...
The generated pressure mean: 0.4093376100063324
The generated pressure mean: 0.409615159034729
The generated pressure mean: 0.40971553325653076
loss_pred:0.05884429067373276, decouple_loss:0.03326656296849251
loss_pred:0.05783089995384216, decouple_loss:0.03551187366247177
loss_pred:0.05868111550807953, decouple_loss:0.03577369078993797
WV_0_PC_0_EH_1_PS_40, loss: 0.06019463762640953, avg_mse: 0.061235927045345306
current test mse: 0.061236
Iteration: 231, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44744420051574707
loss_pred:0.05010221153497696, decouple_loss:0.030831018462777138
The generated pressure mean: 0.44878193736076355
loss_pred:0.048418279737234116, decouple_loss:0.032127659767866135
The generated pressure mean: 0.4476344585418701
loss_pred:0.05004717409610748, decouple_loss:0.031810928136110306
Iteration: 232, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44340866804122925
loss_pred:0.04974021017551422, decouple_loss:0.02903001196682453
The generated pressure mean: 0.44404855370521545
loss_pred:0.05013332515954971, decouple_loss:0.028678659349679947
The generated pressure mean: 0.4449405074119568
loss_pred:0.050047896802425385, decouple_loss:0.02861320599913597
Iteration: 233, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462367296218872
loss_pred:0.05004364997148514, decouple_loss:0.02792363055050373
The generated pressure mean: 0.44646212458610535
loss_pred:0.050015244632959366, decouple_loss:0.027564406394958496
The generated pressure mean: 0.445238322019577
loss_pred:0.050205379724502563, decouple_loss:0.02850707247853279
Iteration: 234, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4511117935180664
loss_pred:0.051519691944122314, decouple_loss:0.031766377389431
The generated pressure mean: 0.4504433870315552
loss_pred:0.05170078203082085, decouple_loss:0.031192464753985405
The generated pressure mean: 0.4499458372592926
loss_pred:0.05321270227432251, decouple_loss:0.032264478504657745
Iteration: 235, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44800448417663574
loss_pred:0.049507953226566315, decouple_loss:0.03303282707929611
The generated pressure mean: 0.44708991050720215
loss_pred:0.0505584180355072, decouple_loss:0.033770602196455
The generated pressure mean: 0.44744929671287537
loss_pred:0.051139816641807556, decouple_loss:0.033221397548913956
Iteration: 236, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472857713699341
loss_pred:0.04978230223059654, decouple_loss:0.027275756001472473
The generated pressure mean: 0.44820427894592285
loss_pred:0.05081789568066597, decouple_loss:0.027067432180047035
The generated pressure mean: 0.44607824087142944
loss_pred:0.051271744072437286, decouple_loss:0.02769692800939083
Iteration: 237, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44812124967575073
loss_pred:0.05262220650911331, decouple_loss:0.03087519481778145
The generated pressure mean: 0.44678637385368347
loss_pred:0.0486905574798584, decouple_loss:0.029790423810482025
The generated pressure mean: 0.4470542073249817
loss_pred:0.049422573298215866, decouple_loss:0.030013184994459152
Iteration: 238, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44575926661491394
loss_pred:0.051229946315288544, decouple_loss:0.02905147708952427
The generated pressure mean: 0.44570815563201904
loss_pred:0.05047301948070526, decouple_loss:0.02970542199909687
The generated pressure mean: 0.4457769989967346
loss_pred:0.05281909555196762, decouple_loss:0.02936054766178131
Iteration: 239, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44899803400039673
loss_pred:0.049439333379268646, decouple_loss:0.027261018753051758
The generated pressure mean: 0.4481916129589081
loss_pred:0.049334846436977386, decouple_loss:0.02699454128742218
The generated pressure mean: 0.4460502862930298
loss_pred:0.051062051206827164, decouple_loss:0.026758532971143723
Iteration: 240, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473918378353119
loss_pred:0.04981638863682747, decouple_loss:0.027574991807341576
The generated pressure mean: 0.445817232131958
loss_pred:0.04946890473365784, decouple_loss:0.0283453818410635
The generated pressure mean: 0.4462413191795349
loss_pred:0.05024448037147522, decouple_loss:0.027706891298294067
2023-04-16 13:14:29 testing...
The generated pressure mean: 0.40523695945739746
The generated pressure mean: 0.4056150019168854
loss_pred:0.05885987728834152, decouple_loss:0.03183373808860779
The generated pressure mean: 0.40579724311828613
loss_pred:0.05889769271016121, decouple_loss:0.03433138504624367
loss_pred:0.05808570981025696, decouple_loss:0.033857543021440506
WV_0_PC_0_EH_1_PS_40, loss: 0.06028147041797638, avg_mse: 0.061974480748176575
current test mse: 0.061974
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 241, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46288588643074036
loss_pred:0.052869267761707306, decouple_loss:0.028321439400315285
The generated pressure mean: 0.4644261598587036
loss_pred:0.0516543947160244, decouple_loss:0.029255039989948273
The generated pressure mean: 0.46449345350265503
loss_pred:0.051665764302015305, decouple_loss:0.029301734641194344
Iteration: 242, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4365369975566864
loss_pred:0.05014517158269882, decouple_loss:0.0300129484385252
The generated pressure mean: 0.43560653924942017
loss_pred:0.05289800092577934, decouple_loss:0.029857467859983444
The generated pressure mean: 0.4359659254550934
loss_pred:0.051328931003808975, decouple_loss:0.02914687804877758
Iteration: 243, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4557742476463318
loss_pred:0.049537476152181625, decouple_loss:0.02974206767976284
The generated pressure mean: 0.4564426839351654
loss_pred:0.04873532056808472, decouple_loss:0.029777323827147484
The generated pressure mean: 0.45443665981292725
loss_pred:0.04913146421313286, decouple_loss:0.029769912362098694
Iteration: 244, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.455006867647171
loss_pred:0.05151349678635597, decouple_loss:0.029385462403297424
The generated pressure mean: 0.45445185899734497
loss_pred:0.048010990023612976, decouple_loss:0.029107362031936646
The generated pressure mean: 0.4551749527454376
loss_pred:0.04856879264116287, decouple_loss:0.029102806001901627
Iteration: 245, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4525614082813263
loss_pred:0.050392474979162216, decouple_loss:0.02924727089703083
The generated pressure mean: 0.45000460743904114
loss_pred:0.05293678119778633, decouple_loss:0.028736090287566185
The generated pressure mean: 0.45064693689346313
loss_pred:0.05023661255836487, decouple_loss:0.02834044024348259
Iteration: 246, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42698606848716736
loss_pred:0.05032810941338539, decouple_loss:0.028807682916522026
The generated pressure mean: 0.42619985342025757
loss_pred:0.048944346606731415, decouple_loss:0.02753997966647148
The generated pressure mean: 0.4268212616443634
loss_pred:0.05066804215312004, decouple_loss:0.02751401625573635
Iteration: 247, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4392707645893097
loss_pred:0.04883075878024101, decouple_loss:0.029037687927484512
The generated pressure mean: 0.44099801778793335
loss_pred:0.04962591081857681, decouple_loss:0.028382431715726852
The generated pressure mean: 0.44065746665000916
loss_pred:0.049618177115917206, decouple_loss:0.028451012447476387
Iteration: 248, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.475170761346817
loss_pred:0.049517229199409485, decouple_loss:0.03033960796892643
The generated pressure mean: 0.47592297196388245
loss_pred:0.05076715350151062, decouple_loss:0.03150993213057518
The generated pressure mean: 0.4747233986854553
loss_pred:0.04705536365509033, decouple_loss:0.030577128753066063
Iteration: 249, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44489002227783203
loss_pred:0.04804350435733795, decouple_loss:0.029133331030607224
The generated pressure mean: 0.44541946053504944
loss_pred:0.04907640814781189, decouple_loss:0.02923962101340294
The generated pressure mean: 0.4452570676803589
loss_pred:0.048287294805049896, decouple_loss:0.02950059249997139
Iteration: 250, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4307914972305298
loss_pred:0.051160745322704315, decouple_loss:0.030378082767128944
The generated pressure mean: 0.4317110478878021
loss_pred:0.04923263564705849, decouple_loss:0.030771568417549133
The generated pressure mean: 0.4302026033401489
loss_pred:0.05047300457954407, decouple_loss:0.029706571251153946
2023-04-16 13:16:59 testing...
The generated pressure mean: 0.4088154435157776
The generated pressure mean: 0.4094580411911011
The generated pressure mean: 0.40966472029685974
loss_pred:0.057616282254457474, decouple_loss:0.03339742496609688
loss_pred:0.05747971683740616, decouple_loss:0.036103859543800354
loss_pred:0.05664904788136482, decouple_loss:0.03578658774495125
WV_0_PC_0_EH_1_PS_40, loss: 0.05900314450263977, avg_mse: 0.060453981161117554
current test mse: 0.060454
Iteration: 251, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4514042139053345
loss_pred:0.04853876307606697, decouple_loss:0.029699137434363365
The generated pressure mean: 0.45221608877182007
loss_pred:0.049786221235990524, decouple_loss:0.03306296095252037
The generated pressure mean: 0.45181804895401
loss_pred:0.04940279945731163, decouple_loss:0.03082280419766903
Iteration: 252, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44570887088775635
loss_pred:0.051291659474372864, decouple_loss:0.027989020571112633
The generated pressure mean: 0.44633036851882935
loss_pred:0.04916174337267876, decouple_loss:0.027747148647904396
The generated pressure mean: 0.44779840111732483
loss_pred:0.04861661419272423, decouple_loss:0.02857327088713646
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 253, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471206068992615
loss_pred:0.04973287507891655, decouple_loss:0.03263106197118759
The generated pressure mean: 0.44838014245033264
loss_pred:0.049026619642972946, decouple_loss:0.03359084948897362
The generated pressure mean: 0.4473319351673126
loss_pred:0.0487433560192585, decouple_loss:0.03246420994400978
Iteration: 254, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45612162351608276
loss_pred:0.04814095422625542, decouple_loss:0.028912629932165146
The generated pressure mean: 0.45629552006721497
loss_pred:0.050656646490097046, decouple_loss:0.028657734394073486
The generated pressure mean: 0.45485278964042664
loss_pred:0.04830580949783325, decouple_loss:0.028424391523003578
Iteration: 255, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43902668356895447
loss_pred:0.048304203897714615, decouple_loss:0.028794921934604645
The generated pressure mean: 0.43978115916252136
loss_pred:0.0482843779027462, decouple_loss:0.02943994104862213
The generated pressure mean: 0.4388929307460785
loss_pred:0.05055958777666092, decouple_loss:0.028531625866889954
Iteration: 256, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44237053394317627
loss_pred:0.05077780410647392, decouple_loss:0.03119865246117115
The generated pressure mean: 0.44192829728126526
loss_pred:0.04916324093937874, decouple_loss:0.03125012665987015
The generated pressure mean: 0.4434714913368225
loss_pred:0.04749923571944237, decouple_loss:0.03177811950445175
Iteration: 257, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4570038914680481
loss_pred:0.047746751457452774, decouple_loss:0.03127298131585121
The generated pressure mean: 0.45722347497940063
loss_pred:0.04890633746981621, decouple_loss:0.03121703676879406
The generated pressure mean: 0.4585992097854614
loss_pred:0.050770994275808334, decouple_loss:0.03317367285490036
Iteration: 258, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.453512042760849
loss_pred:0.04976235702633858, decouple_loss:0.027937570586800575
The generated pressure mean: 0.45464691519737244
loss_pred:0.0474645271897316, decouple_loss:0.02817806415259838
The generated pressure mean: 0.45465779304504395
loss_pred:0.04710903763771057, decouple_loss:0.028662443161010742
Iteration: 259, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43569445610046387
loss_pred:0.05013515055179596, decouple_loss:0.030242010951042175
The generated pressure mean: 0.43557819724082947
loss_pred:0.04971270263195038, decouple_loss:0.03088124841451645
The generated pressure mean: 0.4356779456138611
loss_pred:0.046228595077991486, decouple_loss:0.03033491224050522
Iteration: 260, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44999098777770996
loss_pred:0.04940051585435867, decouple_loss:0.031080396845936775
The generated pressure mean: 0.4508519768714905
loss_pred:0.04915387183427811, decouple_loss:0.03224658966064453
The generated pressure mean: 0.44882068037986755
loss_pred:0.04923456534743309, decouple_loss:0.030985092744231224
2023-04-16 13:18:54 testing...
The generated pressure mean: 0.4095035791397095
The generated pressure mean: 0.4105127155780792
loss_pred:0.05696547031402588, decouple_loss:0.030729614198207855
The generated pressure mean: 0.4106805622577667
loss_pred:0.056729864329099655, decouple_loss:0.03349195793271065
loss_pred:0.055917590856552124, decouple_loss:0.03293415158987045
WV_0_PC_0_EH_1_PS_40, loss: 0.058156903833150864, avg_mse: 0.06044559180736542
current test mse: 0.060446
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 261, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488736689090729
loss_pred:0.04806258901953697, decouple_loss:0.028065092861652374
The generated pressure mean: 0.44984298944473267
loss_pred:0.04844846948981285, decouple_loss:0.028013141825795174
The generated pressure mean: 0.451562762260437
loss_pred:0.0487113818526268, decouple_loss:0.02862532064318657
Iteration: 262, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4353752136230469
loss_pred:0.0477764867246151, decouple_loss:0.028828885406255722
The generated pressure mean: 0.43488451838493347
loss_pred:0.05033446475863457, decouple_loss:0.02842859737575054
The generated pressure mean: 0.43474406003952026
loss_pred:0.04845014959573746, decouple_loss:0.0289045087993145
Iteration: 263, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45811113715171814
The generated pressure mean: 0.4559468626976013
loss_pred:0.04716018587350845, decouple_loss:0.028194578364491463
loss_pred:0.0468563437461853, decouple_loss:0.028444809839129448
The generated pressure mean: 0.4583328664302826
loss_pred:0.0452144593000412, decouple_loss:0.028727935627102852
Iteration: 264, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43517789244651794
loss_pred:0.047548625618219376, decouple_loss:0.026600481942296028
The generated pressure mean: 0.4352562129497528
loss_pred:0.04823381453752518, decouple_loss:0.027147065848112106
The generated pressure mean: 0.4349181652069092
loss_pred:0.046713367104530334, decouple_loss:0.026508362963795662
Iteration: 265, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494430720806122
loss_pred:0.0483710914850235, decouple_loss:0.029086319729685783
The generated pressure mean: 0.45051002502441406
loss_pred:0.044983502477407455, decouple_loss:0.029111703857779503
The generated pressure mean: 0.44812890887260437
loss_pred:0.04988963529467583, decouple_loss:0.028760476037859917
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 266, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4511885344982147
loss_pred:0.04855961725115776, decouple_loss:0.029430896043777466
The generated pressure mean: 0.451132208108902
loss_pred:0.04742671921849251, decouple_loss:0.029147155582904816
The generated pressure mean: 0.4533580541610718
loss_pred:0.04896985739469528, decouple_loss:0.02979903854429722
Iteration: 267, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44223037362098694
loss_pred:0.04662368446588516, decouple_loss:0.029184862971305847
The generated pressure mean: 0.44281572103500366
loss_pred:0.048807963728904724, decouple_loss:0.029711663722991943
The generated pressure mean: 0.4405520260334015
loss_pred:0.047684263437986374, decouple_loss:0.030065415427088737
Iteration: 268, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44392549991607666
loss_pred:0.047259338200092316, decouple_loss:0.026875047013163567
The generated pressure mean: 0.4452964961528778
loss_pred:0.04781903326511383, decouple_loss:0.025971412658691406
The generated pressure mean: 0.44490769505500793
loss_pred:0.0478607676923275, decouple_loss:0.026184983551502228
Iteration: 269, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45323944091796875
loss_pred:0.04759391397237778, decouple_loss:0.026487309485673904
The generated pressure mean: 0.45443353056907654
loss_pred:0.04485180974006653, decouple_loss:0.027009546756744385
The generated pressure mean: 0.4544178545475006
loss_pred:0.045363400131464005, decouple_loss:0.026733417063951492
Iteration: 270, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45009368658065796
The generated pressure mean: 0.4509037435054779
loss_pred:0.04841113090515137, decouple_loss:0.028560757637023926
loss_pred:0.0484035424888134, decouple_loss:0.02870846726000309
The generated pressure mean: 0.4510549008846283
loss_pred:0.048187755048274994, decouple_loss:0.028381623327732086
2023-04-16 13:21:24 testing...
The generated pressure mean: 0.41496679186820984
The generated pressure mean: 0.4163793921470642
The generated pressure mean: 0.4167437255382538
loss_pred:0.05569089204072952, decouple_loss:0.02873379737138748
loss_pred:0.05504084378480911, decouple_loss:0.031324561685323715
loss_pred:0.054588478058576584, decouple_loss:0.031027058139443398
WV_0_PC_0_EH_1_PS_40, loss: 0.05662482604384422, avg_mse: 0.05911381170153618
current test mse: 0.059114
Iteration: 271, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4315304160118103
loss_pred:0.04661157354712486, decouple_loss:0.027370883151888847
The generated pressure mean: 0.4329569339752197
loss_pred:0.04493413120508194, decouple_loss:0.025574354454874992
The generated pressure mean: 0.4311530590057373
loss_pred:0.048449937254190445, decouple_loss:0.025864390656352043
Iteration: 272, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4715538024902344
The generated pressure mean: 0.4727790951728821
loss_pred:0.046347297728061676, decouple_loss:0.027783144265413284
loss_pred:0.04568202421069145, decouple_loss:0.026746386662125587
The generated pressure mean: 0.47171610593795776
loss_pred:0.046228859573602676, decouple_loss:0.027082432061433792
Iteration: 273, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4132441282272339
loss_pred:0.046784304082393646, decouple_loss:0.027717143297195435
The generated pressure mean: 0.41363266110420227
loss_pred:0.04621816426515579, decouple_loss:0.027951175346970558
The generated pressure mean: 0.41224920749664307
loss_pred:0.046902768313884735, decouple_loss:0.028023913502693176
Iteration: 274, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47147074341773987
loss_pred:0.048275817185640335, decouple_loss:0.031874410808086395
The generated pressure mean: 0.472137987613678
loss_pred:0.048328280448913574, decouple_loss:0.0323219895362854
The generated pressure mean: 0.47276926040649414
loss_pred:0.0481872633099556, decouple_loss:0.03230822831392288
Iteration: 275, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42995914816856384
The generated pressure mean: 0.4305821359157562
loss_pred:0.04967387020587921, decouple_loss:0.03284900262951851
loss_pred:0.04532722756266594, decouple_loss:0.03282399848103523
The generated pressure mean: 0.42934727668762207
loss_pred:0.05003779008984566, decouple_loss:0.03321891278028488
Iteration: 276, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45671311020851135
loss_pred:0.04876496270298958, decouple_loss:0.03154449537396431
The generated pressure mean: 0.4551943838596344
loss_pred:0.047102637588977814, decouple_loss:0.03115074522793293
The generated pressure mean: 0.4569719433784485
loss_pred:0.04707897827029228, decouple_loss:0.03123161569237709
Iteration: 277, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43860548734664917
loss_pred:0.04576591029763222, decouple_loss:0.025508413091301918
The generated pressure mean: 0.43830469250679016
loss_pred:0.047837529331445694, decouple_loss:0.025454718619585037
The generated pressure mean: 0.43902137875556946
loss_pred:0.04633883014321327, decouple_loss:0.025455022230744362
Iteration: 278, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4453282654285431
loss_pred:0.045583900064229965, decouple_loss:0.030652962625026703
The generated pressure mean: 0.44498762488365173
loss_pred:0.047851964831352234, decouple_loss:0.030553441494703293
The generated pressure mean: 0.4432818293571472
loss_pred:0.046981338411569595, decouple_loss:0.030426843091845512
Iteration: 279, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45330166816711426
loss_pred:0.045498624444007874, decouple_loss:0.02984757348895073
The generated pressure mean: 0.4526113271713257
loss_pred:0.04542798921465874, decouple_loss:0.030617890879511833
The generated pressure mean: 0.45340558886528015
loss_pred:0.04706842824816704, decouple_loss:0.031221630051732063
Iteration: 280, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43703845143318176
The generated pressure mean: 0.44042056798934937
loss_pred:0.04506199061870575, decouple_loss:0.027498574927449226
loss_pred:0.04684970900416374, decouple_loss:0.027231091633439064
The generated pressure mean: 0.43915194272994995
loss_pred:0.04522004351019859, decouple_loss:0.02632489614188671
2023-04-16 13:23:17 testing...
The generated pressure mean: 0.41109907627105713
The generated pressure mean: 0.412394255399704
loss_pred:0.056014884263277054, decouple_loss:0.02902190200984478
The generated pressure mean: 0.41285011172294617
loss_pred:0.05547923594713211, decouple_loss:0.03163537383079529
loss_pred:0.05468026176095009, decouple_loss:0.03142881393432617
WV_0_PC_0_EH_1_PS_40, loss: 0.05692622810602188, avg_mse: 0.06033302843570709
current test mse: 0.060333
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 281, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470289349555969
loss_pred:0.04380477964878082, decouple_loss:0.027352789416909218
The generated pressure mean: 0.44864657521247864
loss_pred:0.04748445376753807, decouple_loss:0.02754799835383892
The generated pressure mean: 0.45088768005371094
loss_pred:0.047705501317977905, decouple_loss:0.03143088147044182
Iteration: 282, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4565514326095581
loss_pred:0.044685009866952896, decouple_loss:0.02864009514451027
The generated pressure mean: 0.45705798268318176
loss_pred:0.047499459236860275, decouple_loss:0.028087371960282326
The generated pressure mean: 0.45760011672973633
loss_pred:0.04852260276675224, decouple_loss:0.0304166991263628
Iteration: 283, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4325719177722931
loss_pred:0.046484582126140594, decouple_loss:0.02709289640188217
The generated pressure mean: 0.4355165660381317
loss_pred:0.048339635133743286, decouple_loss:0.02760530449450016
The generated pressure mean: 0.43458253145217896
loss_pred:0.04832696169614792, decouple_loss:0.027369514107704163
Iteration: 284, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494456946849823
loss_pred:0.047847893089056015, decouple_loss:0.02723795548081398
The generated pressure mean: 0.44880354404449463
loss_pred:0.04781321808695793, decouple_loss:0.027218809351325035
The generated pressure mean: 0.44969892501831055
loss_pred:0.05077206343412399, decouple_loss:0.02693922445178032
Iteration: 285, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45669427514076233
loss_pred:0.04769476503133774, decouple_loss:0.026750244200229645
The generated pressure mean: 0.4578871428966522
loss_pred:0.04652012139558792, decouple_loss:0.02640737034380436
The generated pressure mean: 0.4608486294746399
loss_pred:0.04680773243308067, decouple_loss:0.026605019345879555
Iteration: 286, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4353894293308258
The generated pressure mean: 0.43424391746520996
loss_pred:0.04591284319758415, decouple_loss:0.028068577870726585
loss_pred:0.04629082232713699, decouple_loss:0.02743719331920147
The generated pressure mean: 0.43285471200942993
loss_pred:0.04778652265667915, decouple_loss:0.026914559304714203
Iteration: 287, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4616837501525879
loss_pred:0.04464714601635933, decouple_loss:0.02965657226741314
The generated pressure mean: 0.4630890488624573
loss_pred:0.04578582942485809, decouple_loss:0.02950439415872097
The generated pressure mean: 0.46772584319114685
loss_pred:0.05021527037024498, decouple_loss:0.03236794099211693
Iteration: 288, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4231337606906891
loss_pred:0.0461580716073513, decouple_loss:0.030597101897001266
The generated pressure mean: 0.425315260887146
The generated pressure mean: 0.4282240569591522
loss_pred:0.04499471187591553, decouple_loss:0.03025716356933117
loss_pred:0.04919847100973129, decouple_loss:0.03050444833934307
Iteration: 289, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4647804796695709
loss_pred:0.04670710861682892, decouple_loss:0.02930809184908867
The generated pressure mean: 0.46554818749427795
loss_pred:0.050014033913612366, decouple_loss:0.029688838869333267
The generated pressure mean: 0.4626481831073761
loss_pred:0.04792359843850136, decouple_loss:0.029241180047392845
Iteration: 290, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4522164762020111
The generated pressure mean: 0.4494648873806
loss_pred:0.046991799026727676, decouple_loss:0.028530854731798172
loss_pred:0.04729750379920006, decouple_loss:0.028146488592028618
The generated pressure mean: 0.45153775811195374
loss_pred:0.04747842624783516, decouple_loss:0.0293206088244915
2023-04-16 13:25:49 testing...
The generated pressure mean: 0.41552630066871643
The generated pressure mean: 0.4173773527145386
The generated pressure mean: 0.417663037776947
loss_pred:0.055096834897994995, decouple_loss:0.029380641877651215
loss_pred:0.05429499223828316, decouple_loss:0.03193846717476845
loss_pred:0.05373143032193184, decouple_loss:0.031426213681697845
WV_0_PC_0_EH_1_PS_40, loss: 0.05592017620801926, avg_mse: 0.05926046147942543
current test mse: 0.05926
Iteration: 291, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4362224340438843
The generated pressure mean: 0.43507981300354004
loss_pred:0.04542558640241623, decouple_loss:0.028186801820993423
loss_pred:0.04775633290410042, decouple_loss:0.028375690802931786
The generated pressure mean: 0.4359699487686157
loss_pred:0.04766831919550896, decouple_loss:0.028246695175766945
Iteration: 292, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4541572332382202
loss_pred:0.04878636449575424, decouple_loss:0.029052307829260826
The generated pressure mean: 0.451560378074646
loss_pred:0.047430507838726044, decouple_loss:0.027628345414996147
The generated pressure mean: 0.4535161256790161
loss_pred:0.047154638916254044, decouple_loss:0.027439497411251068
Iteration: 293, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503544569015503
loss_pred:0.04775308445096016, decouple_loss:0.029469119384884834
The generated pressure mean: 0.4525264799594879
loss_pred:0.047288678586483, decouple_loss:0.03000478632748127
The generated pressure mean: 0.4511733055114746
loss_pred:0.04621349275112152, decouple_loss:0.028956634923815727
Iteration: 294, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4538396894931793
loss_pred:0.048093412071466446, decouple_loss:0.02939658798277378
The generated pressure mean: 0.4519532322883606
loss_pred:0.046902451664209366, decouple_loss:0.02921791933476925
The generated pressure mean: 0.4534367620944977
loss_pred:0.04674452170729637, decouple_loss:0.0290434118360281
Iteration: 295, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43428218364715576
loss_pred:0.04604432359337807, decouple_loss:0.028582420200109482
The generated pressure mean: 0.4366970658302307
loss_pred:0.045867763459682465, decouple_loss:0.02865360863506794
The generated pressure mean: 0.43954724073410034
loss_pred:0.04780057817697525, decouple_loss:0.027917081490159035
Iteration: 296, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45302265882492065
loss_pred:0.046330761164426804, decouple_loss:0.03261185064911842
The generated pressure mean: 0.45189136266708374
The generated pressure mean: 0.4518143832683563
loss_pred:0.04920195788145065, decouple_loss:0.033273156732320786
loss_pred:0.04925142601132393, decouple_loss:0.03193306177854538
Iteration: 297, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47115182876586914
loss_pred:0.04515773430466652, decouple_loss:0.026499342173337936
The generated pressure mean: 0.472541481256485
loss_pred:0.04449981823563576, decouple_loss:0.02631523460149765
The generated pressure mean: 0.4726608693599701
loss_pred:0.0460972934961319, decouple_loss:0.029056111350655556
Iteration: 298, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.41788429021835327
loss_pred:0.04690727964043617, decouple_loss:0.030434750020503998
The generated pressure mean: 0.42297548055648804The generated pressure mean: 0.4183756113052368
loss_pred:0.04744420200586319, decouple_loss:0.029720580205321312
loss_pred:0.04770073667168617, decouple_loss:0.030337806791067123
Iteration: 299, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4315841495990753
loss_pred:0.04638264328241348, decouple_loss:0.02656925655901432
The generated pressure mean: 0.4323045611381531
The generated pressure mean: 0.430503785610199
loss_pred:0.04704877734184265, decouple_loss:0.028013547882437706
loss_pred:0.046968936920166016, decouple_loss:0.02651188150048256
Iteration: 300, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4857798218727112
loss_pred:0.04600563645362854, decouple_loss:0.028571918606758118
The generated pressure mean: 0.4887523055076599
loss_pred:0.04637468233704567, decouple_loss:0.02884346805512905
The generated pressure mean: 0.49039533734321594
loss_pred:0.04867556691169739, decouple_loss:0.028598733246326447
2023-04-16 13:27:44 testing...
The generated pressure mean: 0.4159865379333496
The generated pressure mean: 0.4180677831172943
The generated pressure mean: 0.4184788167476654
loss_pred:0.05437237396836281, decouple_loss:0.029650093987584114
loss_pred:0.05306832492351532, decouple_loss:0.03130995109677315
loss_pred:0.05251958966255188, decouple_loss:0.03102564997971058
WV_0_PC_0_EH_1_PS_40, loss: 0.05485319346189499, avg_mse: 0.05817176774144173
current test mse: 0.058172
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
Iteration: 301, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43152105808258057
loss_pred:0.044601354748010635, decouple_loss:0.029435820877552032
The generated pressure mean: 0.43286222219467163
The generated pressure mean: 0.43273448944091797
loss_pred:0.04703586921095848, decouple_loss:0.029148871079087257
loss_pred:0.046073585748672485, decouple_loss:0.029497632756829262
Iteration: 302, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4206492602825165
The generated pressure mean: 0.42196041345596313
loss_pred:0.04494038596749306, decouple_loss:0.02934376895427704
loss_pred:0.04711819067597389, decouple_loss:0.028338344767689705
The generated pressure mean: 0.42009252309799194
loss_pred:0.044414665549993515, decouple_loss:0.02845863066613674
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 303, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46690985560417175
The generated pressure mean: 0.46746501326560974
loss_pred:0.04654332250356674, decouple_loss:0.027808498591184616
loss_pred:0.04851497337222099, decouple_loss:0.027806773781776428
The generated pressure mean: 0.46791398525238037
loss_pred:0.04724133387207985, decouple_loss:0.02717849425971508
Iteration: 304, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4528563618659973
The generated pressure mean: 0.4510333836078644
loss_pred:0.04565691947937012, decouple_loss:0.029649896547198296
loss_pred:0.04570555314421654, decouple_loss:0.02930261567234993
The generated pressure mean: 0.4517536163330078
loss_pred:0.045121729373931885, decouple_loss:0.02906009741127491
Iteration: 305, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4340384602546692
The generated pressure mean: 0.4352348744869232
loss_pred:0.04532664269208908, decouple_loss:0.029005017131567
loss_pred:0.0470203198492527, decouple_loss:0.028466010466217995
The generated pressure mean: 0.4329819083213806
loss_pred:0.04523879289627075, decouple_loss:0.028921909630298615
Iteration: 306, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476749300956726
The generated pressure mean: 0.446795791387558
loss_pred:0.04542830213904381, decouple_loss:0.02925809472799301
loss_pred:0.04666123166680336, decouple_loss:0.028072338551282883
The generated pressure mean: 0.4478834271430969
loss_pred:0.047860775142908096, decouple_loss:0.027997376397252083
Iteration: 307, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44709447026252747
loss_pred:0.046660538762807846, decouple_loss:0.028429903090000153
The generated pressure mean: 0.44836223125457764
loss_pred:0.047305501997470856, decouple_loss:0.028160663321614265
The generated pressure mean: 0.4462577998638153
loss_pred:0.04584706947207451, decouple_loss:0.027991900220513344
Iteration: 308, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4422759711742401
loss_pred:0.05060342699289322, decouple_loss:0.02825976349413395
The generated pressure mean: 0.4406326413154602
loss_pred:0.0471472442150116, decouple_loss:0.028041260316967964
The generated pressure mean: 0.4415318965911865
loss_pred:0.04492873325943947, decouple_loss:0.02864251658320427
Iteration: 309, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4457286596298218
loss_pred:0.04685137793421745, decouple_loss:0.02687174640595913
The generated pressure mean: 0.4433237910270691
loss_pred:0.04546171799302101, decouple_loss:0.02688612975180149
The generated pressure mean: 0.4409100115299225
loss_pred:0.04483939707279205, decouple_loss:0.02716289833188057
Iteration: 310, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4569641053676605
The generated pressure mean: 0.45452991127967834loss_pred:0.04517650604248047, decouple_loss:0.03319738060235977
loss_pred:0.0452575720846653, decouple_loss:0.03272994980216026
The generated pressure mean: 0.45830321311950684
loss_pred:0.04466450586915016, decouple_loss:0.03367377817630768
2023-04-16 13:30:17 testing...
The generated pressure mean: 0.41274315118789673
The generated pressure mean: 0.41451555490493774
The generated pressure mean: 0.41522106528282166
loss_pred:0.054143935441970825, decouple_loss:0.030461017042398453
loss_pred:0.05345134809613228, decouple_loss:0.033179014921188354
loss_pred:0.052583809942007065, decouple_loss:0.032846204936504364
WV_0_PC_0_EH_1_PS_40, loss: 0.05500113591551781, avg_mse: 0.059187207370996475
current test mse: 0.059187
Iteration: 311, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4446054697036743
loss_pred:0.04435756430029869, decouple_loss:0.029444804415106773
The generated pressure mean: 0.4446474611759186
loss_pred:0.047013211995363235, decouple_loss:0.027674172073602676
The generated pressure mean: 0.4451363682746887
loss_pred:0.04536282271146774, decouple_loss:0.02813834697008133
Iteration: 312, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42988845705986023
loss_pred:0.04455530270934105, decouple_loss:0.029694417491555214
The generated pressure mean: 0.43288734555244446
loss_pred:0.0448487363755703, decouple_loss:0.029518648982048035
The generated pressure mean: 0.42671453952789307
loss_pred:0.046541858464479446, decouple_loss:0.030037498101592064
Iteration: 313, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45478761196136475
The generated pressure mean: 0.4554349184036255
loss_pred:0.04660143330693245, decouple_loss:0.03273513913154602
loss_pred:0.04442935809493065, decouple_loss:0.034103527665138245
The generated pressure mean: 0.4549030661582947
loss_pred:0.045376986265182495, decouple_loss:0.03317224979400635
Iteration: 314, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4606228768825531
The generated pressure mean: 0.45854103565216064loss_pred:0.04378286004066467, decouple_loss:0.02598012425005436
loss_pred:0.04598761722445488, decouple_loss:0.02634325437247753
The generated pressure mean: 0.46102508902549744
loss_pred:0.04843670129776001, decouple_loss:0.02685960754752159
Iteration: 315, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.423482745885849
The generated pressure mean: 0.42328473925590515
loss_pred:0.04484640434384346, decouple_loss:0.029887940734624863
loss_pred:0.04316706210374832, decouple_loss:0.029769815504550934
The generated pressure mean: 0.4219343066215515
loss_pred:0.04651866853237152, decouple_loss:0.030158640816807747
Iteration: 316, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498935341835022
loss_pred:0.04494823142886162, decouple_loss:0.02898554503917694
The generated pressure mean: 0.447053462266922
loss_pred:0.04440498352050781, decouple_loss:0.02928544580936432
The generated pressure mean: 0.44522184133529663
loss_pred:0.04440978541970253, decouple_loss:0.029437663033604622
Iteration: 317, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46395745873451233
loss_pred:0.04590743035078049, decouple_loss:0.026506027206778526
The generated pressure mean: 0.4643048048019409
loss_pred:0.04523937776684761, decouple_loss:0.02664995566010475
The generated pressure mean: 0.4632193446159363
loss_pred:0.04373824968934059, decouple_loss:0.025632888078689575
Iteration: 318, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43845972418785095
loss_pred:0.044400010257959366, decouple_loss:0.029162248596549034
The generated pressure mean: 0.4377605617046356
loss_pred:0.043436892330646515, decouple_loss:0.028705202043056488
The generated pressure mean: 0.43745851516723633
loss_pred:0.04466639831662178, decouple_loss:0.02934972010552883
Iteration: 319, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44036799669265747
loss_pred:0.0454595573246479, decouple_loss:0.027104349806904793
The generated pressure mean: 0.4361482262611389
loss_pred:0.047721050679683685, decouple_loss:0.026412684470415115
The generated pressure mean: 0.4376767575740814
loss_pred:0.04393025115132332, decouple_loss:0.02640637382864952
Iteration: 320, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44786733388900757
loss_pred:0.04658328369259834, decouple_loss:0.025824962183833122
The generated pressure mean: 0.4496448338031769
The generated pressure mean: 0.4483087360858917
loss_pred:0.04348670318722725, decouple_loss:0.02666112594306469
loss_pred:0.04376646503806114, decouple_loss:0.02563161961734295
2023-04-16 13:32:12 testing...
The generated pressure mean: 0.4089092016220093
The generated pressure mean: 0.4109390079975128
The generated pressure mean: 0.4117640554904938
loss_pred:0.05468326061964035, decouple_loss:0.029565749689936638
loss_pred:0.053675029426813126, decouple_loss:0.03202102705836296
loss_pred:0.05314867943525314, decouple_loss:0.031817663460969925
WV_0_PC_0_EH_1_PS_40, loss: 0.055392395704984665, avg_mse: 0.060298021882772446
current test mse: 0.060298
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 321, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46075451374053955
loss_pred:0.04641548916697502, decouple_loss:0.027888033539056778
The generated pressure mean: 0.45866498351097107
loss_pred:0.04506811499595642, decouple_loss:0.027851583436131477
The generated pressure mean: 0.46114498376846313
loss_pred:0.045523591339588165, decouple_loss:0.027529867365956306
Iteration: 322, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4197077453136444
The generated pressure mean: 0.4174007177352905
loss_pred:0.04611470550298691, decouple_loss:0.028988223522901535
loss_pred:0.044941920787096024, decouple_loss:0.029363246634602547
The generated pressure mean: 0.4190102517604828
loss_pred:0.04554850608110428, decouple_loss:0.028378713876008987
Iteration: 323, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4743679463863373
The generated pressure mean: 0.47430574893951416
loss_pred:0.04618757590651512, decouple_loss:0.028542010113596916
loss_pred:0.045612286776304245, decouple_loss:0.0283980555832386
The generated pressure mean: 0.47667694091796875
loss_pred:0.045104485005140305, decouple_loss:0.0280885212123394
Iteration: 324, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4269178509712219
The generated pressure mean: 0.42890670895576477
loss_pred:0.045950163155794144, decouple_loss:0.027517519891262054
loss_pred:0.046303294599056244, decouple_loss:0.02864367887377739
The generated pressure mean: 0.43256568908691406
loss_pred:0.04600317403674126, decouple_loss:0.02736951783299446
Iteration: 325, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4399484694004059
The generated pressure mean: 0.43684497475624084
loss_pred:0.04598831757903099, decouple_loss:0.03090665303170681
loss_pred:0.04405112564563751, decouple_loss:0.032609857618808746
The generated pressure mean: 0.4366900324821472
loss_pred:0.04661213606595993, decouple_loss:0.03116595558822155
Iteration: 326, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4704291522502899
The generated pressure mean: 0.4760526120662689
loss_pred:0.0440387949347496, decouple_loss:0.027597570791840553
loss_pred:0.047087885439395905, decouple_loss:0.028685549274086952
The generated pressure mean: 0.4759416878223419
loss_pred:0.04708300530910492, decouple_loss:0.028194472193717957
Iteration: 327, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4271414577960968
loss_pred:0.04459802806377411, decouple_loss:0.03083033114671707
The generated pressure mean: 0.4291187524795532
loss_pred:0.0429290235042572, decouple_loss:0.031193427741527557
The generated pressure mean: 0.43071913719177246
loss_pred:0.044607046991586685, decouple_loss:0.03125232830643654
Iteration: 328, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42226558923721313
loss_pred:0.04479531943798065, decouple_loss:0.031276583671569824
The generated pressure mean: 0.4237504303455353
loss_pred:0.04621563106775284, decouple_loss:0.03086203895509243
The generated pressure mean: 0.4222007393836975
loss_pred:0.0448988638818264, decouple_loss:0.031322505325078964
Iteration: 329, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47821539640426636
loss_pred:0.043643344193696976, decouple_loss:0.027009936049580574
The generated pressure mean: 0.4788598418235779
loss_pred:0.04562552273273468, decouple_loss:0.027054430916905403
The generated pressure mean: 0.4799956679344177
loss_pred:0.04450397193431854, decouple_loss:0.02758815325796604
Iteration: 330, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44745010137557983
The generated pressure mean: 0.44991186261177063
loss_pred:0.045516323298215866, decouple_loss:0.031244246289134026
loss_pred:0.04529935494065285, decouple_loss:0.030884528532624245
The generated pressure mean: 0.4485733211040497
loss_pred:0.043976593762636185, decouple_loss:0.031114209443330765
2023-04-16 13:34:39 testing...
The generated pressure mean: 0.41940993070602417
The generated pressure mean: 0.4174693822860718
The generated pressure mean: 0.4202045500278473
loss_pred:0.05136486142873764, decouple_loss:0.029439520090818405
loss_pred:0.052579790353775024, decouple_loss:0.02745307981967926
loss_pred:0.05082906037569046, decouple_loss:0.0290390495210886
WV_0_PC_0_EH_1_PS_40, loss: 0.053023435175418854, avg_mse: 0.05665096268057823
current test mse: 0.056651
Iteration: 331, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4283261299133301
The generated pressure mean: 0.428361713886261
loss_pred:0.04290902614593506, decouple_loss:0.026608651503920555
loss_pred:0.04538380727171898, decouple_loss:0.02647431567311287
The generated pressure mean: 0.42661240696907043
loss_pred:0.04453931376338005, decouple_loss:0.026583392173051834
Iteration: 332, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.453566312789917
loss_pred:0.04444094002246857, decouple_loss:0.029672758653759956
The generated pressure mean: 0.4511355757713318
loss_pred:0.042563118040561676, decouple_loss:0.02849316969513893
The generated pressure mean: 0.4535660743713379
loss_pred:0.04619665816426277, decouple_loss:0.028594033792614937
Iteration: 333, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4557155668735504
loss_pred:0.04344887658953667, decouple_loss:0.03069206140935421
The generated pressure mean: 0.4539605975151062
loss_pred:0.04301176220178604, decouple_loss:0.03158579394221306
The generated pressure mean: 0.45716920495033264
loss_pred:0.0449339896440506, decouple_loss:0.031241919845342636
Iteration: 334, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4407863914966583
loss_pred:0.04562770202755928, decouple_loss:0.02662482112646103
The generated pressure mean: 0.43863940238952637
loss_pred:0.04339060187339783, decouple_loss:0.025906164199113846
The generated pressure mean: 0.4414040744304657
loss_pred:0.041828643530607224, decouple_loss:0.0263297650963068
Iteration: 335, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44571423530578613
loss_pred:0.043793659657239914, decouple_loss:0.03028193861246109
The generated pressure mean: 0.44777265191078186
loss_pred:0.04467345401644707, decouple_loss:0.029257146641612053
The generated pressure mean: 0.4450328052043915
loss_pred:0.044027965515851974, decouple_loss:0.029393894597887993
Iteration: 336, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44560641050338745
loss_pred:0.04417244717478752, decouple_loss:0.028945401310920715
The generated pressure mean: 0.4466700553894043
loss_pred:0.04433382302522659, decouple_loss:0.028033707290887833
The generated pressure mean: 0.4448639154434204
loss_pred:0.04421268403530121, decouple_loss:0.02799225226044655
Iteration: 337, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44511058926582336
loss_pred:0.04390689730644226, decouple_loss:0.027262909337878227
The generated pressure mean: 0.4438723921775818
loss_pred:0.043484654277563095, decouple_loss:0.027341699227690697
The generated pressure mean: 0.4454820156097412
loss_pred:0.0452149361371994, decouple_loss:0.02766888402402401
Iteration: 338, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4597710072994232
loss_pred:0.04431280493736267, decouple_loss:0.02745772898197174
The generated pressure mean: 0.45592477917671204
loss_pred:0.04376662150025368, decouple_loss:0.02749934233725071
The generated pressure mean: 0.4569145441055298
loss_pred:0.0429249070584774, decouple_loss:0.027941973879933357
Iteration: 339, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4431382417678833
loss_pred:0.04319613426923752, decouple_loss:0.026866065338253975
The generated pressure mean: 0.4388425350189209
The generated pressure mean: 0.44241103529930115
loss_pred:0.04333418607711792, decouple_loss:0.027117270976305008
loss_pred:0.04441993683576584, decouple_loss:0.02801530249416828
Iteration: 340, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4252590835094452
loss_pred:0.04470755159854889, decouple_loss:0.02566048875451088
The generated pressure mean: 0.4271903932094574
The generated pressure mean: 0.4292896091938019
loss_pred:0.042975377291440964, decouple_loss:0.02686583437025547
loss_pred:0.04366190358996391, decouple_loss:0.0257272832095623
2023-04-16 13:36:32 testing...
The generated pressure mean: 0.40565621852874756
The generated pressure mean: 0.4080869257450104
loss_pred:0.05420089513063431, decouple_loss:0.028026966378092766
The generated pressure mean: 0.4093782305717468
loss_pred:0.05255354940891266, decouple_loss:0.029867714270949364
loss_pred:0.05204383283853531, decouple_loss:0.029395412653684616
WV_0_PC_0_EH_1_PS_40, loss: 0.05438759922981262, avg_mse: 0.05980224162340164
current test mse: 0.059802
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 341, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47769469022750854
loss_pred:0.042370330542325974, decouple_loss:0.026624714955687523
The generated pressure mean: 0.4834013283252716
loss_pred:0.04234444722533226, decouple_loss:0.02780851535499096
The generated pressure mean: 0.4799198508262634
loss_pred:0.04485283046960831, decouple_loss:0.027932267636060715
Iteration: 342, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44478848576545715
loss_pred:0.042544055730104446, decouple_loss:0.027401017025113106
The generated pressure mean: 0.43947315216064453
loss_pred:0.04267553612589836, decouple_loss:0.02651962824165821
The generated pressure mean: 0.4429522156715393
loss_pred:0.04355530068278313, decouple_loss:0.027260467410087585
Iteration: 343, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4245205521583557
loss_pred:0.04234440624713898, decouple_loss:0.025852015241980553
The generated pressure mean: 0.4231991469860077
loss_pred:0.04297095164656639, decouple_loss:0.025461828336119652
The generated pressure mean: 0.4243771433830261
loss_pred:0.04130759462714195, decouple_loss:0.025621864944696426
Iteration: 344, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4796268045902252
The generated pressure mean: 0.47468024492263794
loss_pred:0.0434504933655262, decouple_loss:0.02891586534678936
loss_pred:0.04145745933055878, decouple_loss:0.026804616674780846
The generated pressure mean: 0.4784136414527893
loss_pred:0.04502803087234497, decouple_loss:0.028108948841691017
Iteration: 345, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44402360916137695
loss_pred:0.04404526948928833, decouple_loss:0.027099624276161194
The generated pressure mean: 0.4407298266887665
loss_pred:0.04383263364434242, decouple_loss:0.02580398879945278
The generated pressure mean: 0.4436754286289215
loss_pred:0.043200355023145676, decouple_loss:0.026045965030789375
Iteration: 346, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43297940492630005
loss_pred:0.044490423053503036, decouple_loss:0.025951653718948364
The generated pressure mean: 0.433927983045578
loss_pred:0.04426776245236397, decouple_loss:0.02507154829800129
The generated pressure mean: 0.4313656687736511
loss_pred:0.04239703342318535, decouple_loss:0.025465920567512512
Iteration: 347, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45877549052238464
The generated pressure mean: 0.45710673928260803
loss_pred:0.04329410195350647, decouple_loss:0.024523282423615456
loss_pred:0.045462727546691895, decouple_loss:0.02445373497903347
The generated pressure mean: 0.4588508605957031
loss_pred:0.045497357845306396, decouple_loss:0.024368654936552048
Iteration: 348, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4528999328613281
loss_pred:0.042445745319128036, decouple_loss:0.030910728499293327
The generated pressure mean: 0.4489741921424866
The generated pressure mean: 0.449327290058136
loss_pred:0.045011840760707855, decouple_loss:0.031168701127171516
loss_pred:0.044594619423151016, decouple_loss:0.030489159747958183
Iteration: 349, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.445576012134552
The generated pressure mean: 0.44366616010665894loss_pred:0.0433456115424633, decouple_loss:0.02542860619723797
loss_pred:0.04259875789284706, decouple_loss:0.02545204572379589
The generated pressure mean: 0.4421733617782593
loss_pred:0.04216655716300011, decouple_loss:0.025854535400867462
Iteration: 350, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4579344093799591
loss_pred:0.042474906891584396, decouple_loss:0.027791405096650124
The generated pressure mean: 0.45252102613449097
loss_pred:0.04206553101539612, decouple_loss:0.02873750403523445
The generated pressure mean: 0.45755550265312195
loss_pred:0.041375093162059784, decouple_loss:0.028416238725185394
2023-04-16 13:39:05 testing...
The generated pressure mean: 0.41623714566230774
The generated pressure mean: 0.41860735416412354
loss_pred:0.05318446084856987, decouple_loss:0.026981299743056297
The generated pressure mean: 0.4199042022228241
loss_pred:0.052242591977119446, decouple_loss:0.02892114594578743
loss_pred:0.05171374976634979, decouple_loss:0.028603199869394302
WV_0_PC_0_EH_1_PS_40, loss: 0.053788699209690094, avg_mse: 0.059953782707452774
current test mse: 0.059954
Iteration: 351, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44392916560173035
loss_pred:0.04250441864132881, decouple_loss:0.025904882699251175
The generated pressure mean: 0.4455065131187439
loss_pred:0.04324846342206001, decouple_loss:0.026896975934505463
The generated pressure mean: 0.4422178864479065
loss_pred:0.043525148183107376, decouple_loss:0.026734577491879463
Iteration: 352, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42783963680267334
loss_pred:0.042467519640922546, decouple_loss:0.028294268995523453
The generated pressure mean: 0.4335266649723053
loss_pred:0.041965872049331665, decouple_loss:0.02874520607292652
The generated pressure mean: 0.4323895275592804
loss_pred:0.04385843500494957, decouple_loss:0.029442712664604187
Iteration: 353, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47214868664741516
loss_pred:0.041592974215745926, decouple_loss:0.02571059763431549
The generated pressure mean: 0.46746110916137695
loss_pred:0.04278251901268959, decouple_loss:0.024294469505548477
The generated pressure mean: 0.47188642621040344
loss_pred:0.042994819581508636, decouple_loss:0.024378271773457527
Iteration: 354, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4332810640335083
loss_pred:0.04355938732624054, decouple_loss:0.030324747785925865
The generated pressure mean: 0.43406423926353455
loss_pred:0.04365455359220505, decouple_loss:0.02970164082944393
The generated pressure mean: 0.43262308835983276
loss_pred:0.043648798018693924, decouple_loss:0.02919924445450306
Iteration: 355, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44751593470573425
loss_pred:0.041527509689331055, decouple_loss:0.025736041367053986
The generated pressure mean: 0.4489056468009949
loss_pred:0.042210448533296585, decouple_loss:0.026161324232816696
The generated pressure mean: 0.44906365871429443
loss_pred:0.044264476746320724, decouple_loss:0.028110336512327194
Iteration: 356, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44884368777275085
loss_pred:0.04051223024725914, decouple_loss:0.031589608639478683
The generated pressure mean: 0.45072880387306213
loss_pred:0.04287363961338997, decouple_loss:0.031476959586143494
The generated pressure mean: 0.45049163699150085
loss_pred:0.041682906448841095, decouple_loss:0.03094218112528324
Iteration: 357, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44212111830711365
loss_pred:0.0438920296728611, decouple_loss:0.026389557868242264
The generated pressure mean: 0.4416187107563019
The generated pressure mean: 0.441328227519989
loss_pred:0.042394910007715225, decouple_loss:0.023973576724529266
loss_pred:0.04369271174073219, decouple_loss:0.02511756308376789
Iteration: 358, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4513309597969055
loss_pred:0.041791487485170364, decouple_loss:0.026047471910715103
The generated pressure mean: 0.4508960247039795
loss_pred:0.04169324040412903, decouple_loss:0.026325305923819542
The generated pressure mean: 0.4504673182964325
loss_pred:0.04091080650687218, decouple_loss:0.026015663519501686
Iteration: 359, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.438875287771225
loss_pred:0.042578235268592834, decouple_loss:0.03025776892900467
The generated pressure mean: 0.43934038281440735
loss_pred:0.042850278317928314, decouple_loss:0.030494775623083115
The generated pressure mean: 0.43897801637649536
loss_pred:0.04289167746901512, decouple_loss:0.02995752915740013
Iteration: 360, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44566646218299866
loss_pred:0.0418349914252758, decouple_loss:0.025282980874180794
The generated pressure mean: 0.44750168919563293
loss_pred:0.04208602383732796, decouple_loss:0.02555910497903824
The generated pressure mean: 0.4431782364845276
loss_pred:0.04335496947169304, decouple_loss:0.02515786699950695
2023-04-16 13:40:58 testing...
The generated pressure mean: 0.41378799080848694
The generated pressure mean: 0.4111481010913849
loss_pred:0.05068394914269447, decouple_loss:0.02856246381998062
The generated pressure mean: 0.41553160548210144
loss_pred:0.0522540807723999, decouple_loss:0.026985151693224907
loss_pred:0.050101540982723236, decouple_loss:0.028254400938749313
WV_0_PC_0_EH_1_PS_40, loss: 0.05240989476442337, avg_mse: 0.05790812522172928
current test mse: 0.057908
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 361, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45653295516967773
loss_pred:0.042585983872413635, decouple_loss:0.027116643264889717
The generated pressure mean: 0.46278321743011475
loss_pred:0.04338310658931732, decouple_loss:0.02732657827436924
The generated pressure mean: 0.4608001708984375
loss_pred:0.04232332855463028, decouple_loss:0.027435394003987312
Iteration: 362, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43469589948654175
loss_pred:0.04457096755504608, decouple_loss:0.02898694947361946
The generated pressure mean: 0.4347005784511566
loss_pred:0.04268341884016991, decouple_loss:0.02907685935497284
The generated pressure mean: 0.4347022771835327
loss_pred:0.04326728358864784, decouple_loss:0.028639396652579308
Iteration: 363, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465690851211548
loss_pred:0.040102288126945496, decouple_loss:0.02443111687898636
The generated pressure mean: 0.4440343677997589
loss_pred:0.04207424819469452, decouple_loss:0.02409273386001587
The generated pressure mean: 0.44488030672073364
loss_pred:0.042666126042604446, decouple_loss:0.02447650395333767
Iteration: 364, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4609421491622925
The generated pressure mean: 0.45963478088378906
loss_pred:0.04292566329240799, decouple_loss:0.03042660839855671
loss_pred:0.04318731278181076, decouple_loss:0.030697427690029144
The generated pressure mean: 0.4597686231136322
loss_pred:0.04131140187382698, decouple_loss:0.030307961627840996
Iteration: 365, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4440644085407257
The generated pressure mean: 0.4444746673107147
loss_pred:0.041517045348882675, decouple_loss:0.0238267220556736
loss_pred:0.04327048361301422, decouple_loss:0.02456432580947876
The generated pressure mean: 0.44212716817855835
loss_pred:0.04246516525745392, decouple_loss:0.025062428787350655
Iteration: 366, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43061503767967224
The generated pressure mean: 0.43234947323799133
loss_pred:0.041198521852493286, decouple_loss:0.027478089556097984
loss_pred:0.040955498814582825, decouple_loss:0.02633574604988098
The generated pressure mean: 0.4299607276916504
loss_pred:0.0441289022564888, decouple_loss:0.02665756456553936
Iteration: 367, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47179701924324036
loss_pred:0.044286321848630905, decouple_loss:0.02797960676252842
The generated pressure mean: 0.4696754515171051
loss_pred:0.042711373418569565, decouple_loss:0.02738058939576149
The generated pressure mean: 0.4746657609939575
loss_pred:0.04430701956152916, decouple_loss:0.02779231034219265
Iteration: 368, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.41810375452041626
loss_pred:0.04138951003551483, decouple_loss:0.02515905350446701
The generated pressure mean: 0.41894152760505676
loss_pred:0.04212650656700134, decouple_loss:0.025526029989123344
The generated pressure mean: 0.4199494421482086
loss_pred:0.044554464519023895, decouple_loss:0.026532035320997238
Iteration: 369, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4716307818889618
loss_pred:0.043440911918878555, decouple_loss:0.028949348255991936
The generated pressure mean: 0.4762817323207855
loss_pred:0.04338163137435913, decouple_loss:0.0299528781324625
The generated pressure mean: 0.474280446767807
loss_pred:0.04193122312426567, decouple_loss:0.029476044699549675
Iteration: 370, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43632420897483826
loss_pred:0.03944603353738785, decouple_loss:0.02477107010781765
The generated pressure mean: 0.442546546459198
loss_pred:0.042786575853824615, decouple_loss:0.024875320494174957
The generated pressure mean: 0.4356236457824707
loss_pred:0.04242878407239914, decouple_loss:0.025311900302767754
2023-04-16 13:43:29 testing...
The generated pressure mean: 0.4182790517807007
The generated pressure mean: 0.4204370379447937
The generated pressure mean: 0.42186596989631653
loss_pred:0.05049506947398186, decouple_loss:0.027591869235038757
loss_pred:0.04960896447300911, decouple_loss:0.02911870740354061
loss_pred:0.048981815576553345, decouple_loss:0.028899848461151123
WV_0_PC_0_EH_1_PS_40, loss: 0.05112212523818016, avg_mse: 0.055670201778411865
current test mse: 0.05567
Iteration: 371, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4300563931465149
loss_pred:0.04397616907954216, decouple_loss:0.028092971071600914
The generated pressure mean: 0.4312886893749237
loss_pred:0.04229533299803734, decouple_loss:0.02687748894095421
The generated pressure mean: 0.43528854846954346
loss_pred:0.04412461817264557, decouple_loss:0.02745276689529419
Iteration: 372, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4671514928340912
loss_pred:0.04273078590631485, decouple_loss:0.025729665532708168
The generated pressure mean: 0.4648420810699463
loss_pred:0.042758189141750336, decouple_loss:0.026149310171604156
The generated pressure mean: 0.4679264426231384
loss_pred:0.04341591149568558, decouple_loss:0.026373473927378654
Iteration: 373, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45044246315956116
The generated pressure mean: 0.44571825861930847
loss_pred:0.04432420805096626, decouple_loss:0.02510196529328823
loss_pred:0.03996438905596733, decouple_loss:0.025911081582307816
The generated pressure mean: 0.44830092787742615
loss_pred:0.04267429560422897, decouple_loss:0.02505752258002758
Iteration: 374, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4340378940105438
loss_pred:0.04241449013352394, decouple_loss:0.025329208001494408
The generated pressure mean: 0.43848782777786255
loss_pred:0.04251883924007416, decouple_loss:0.024571118876338005
The generated pressure mean: 0.43652796745300293
loss_pred:0.04315958544611931, decouple_loss:0.024812927469611168
Iteration: 375, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45840635895729065
The generated pressure mean: 0.4534744620323181
loss_pred:0.043875552713871, decouple_loss:0.025899551808834076
loss_pred:0.04239381104707718, decouple_loss:0.02517835795879364
The generated pressure mean: 0.4560079574584961
loss_pred:0.04109537973999977, decouple_loss:0.02554507926106453
Iteration: 376, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474508464336395The generated pressure mean: 0.4496973752975464
loss_pred:0.04289763793349266, decouple_loss:0.024632589891552925
loss_pred:0.04329202324151993, decouple_loss:0.024961307644844055
The generated pressure mean: 0.44582828879356384
loss_pred:0.044062528759241104, decouple_loss:0.026642275974154472
Iteration: 377, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43515169620513916
The generated pressure mean: 0.4329959452152252
loss_pred:0.04329131543636322, decouple_loss:0.027406150475144386
loss_pred:0.04177965968847275, decouple_loss:0.027098821476101875
The generated pressure mean: 0.433786004781723
loss_pred:0.04184048995375633, decouple_loss:0.0274957325309515
Iteration: 378, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45739880204200745
loss_pred:0.04024365171790123, decouple_loss:0.02455207146704197
The generated pressure mean: 0.45593997836112976
loss_pred:0.04156660661101341, decouple_loss:0.02442476525902748
The generated pressure mean: 0.4562353193759918
loss_pred:0.042250972241163254, decouple_loss:0.024058345705270767
Iteration: 379, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4517374336719513
loss_pred:0.04102508723735809, decouple_loss:0.024996483698487282
The generated pressure mean: 0.44933950901031494
loss_pred:0.041250843554735184, decouple_loss:0.025759199634194374
The generated pressure mean: 0.4499211609363556
loss_pred:0.04189398139715195, decouple_loss:0.02660096436738968
Iteration: 380, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44289401173591614
loss_pred:0.04304047301411629, decouple_loss:0.02426333539187908
The generated pressure mean: 0.4435780942440033
The generated pressure mean: 0.43954041600227356
loss_pred:0.04309439659118652, decouple_loss:0.0237247534096241
loss_pred:0.041838549077510834, decouple_loss:0.022297434508800507
2023-04-16 13:45:22 testing...
The generated pressure mean: 0.41601496934890747
The generated pressure mean: 0.41890281438827515
The generated pressure mean: 0.42051780223846436
loss_pred:0.0504152737557888, decouple_loss:0.02323198691010475
loss_pred:0.04908375442028046, decouple_loss:0.02510928176343441
loss_pred:0.048823095858097076, decouple_loss:0.024821337312459946
WV_0_PC_0_EH_1_PS_40, loss: 0.050660084933042526, avg_mse: 0.05576106905937195
current test mse: 0.055761
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 381, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4458315968513489
loss_pred:0.04055486246943474, decouple_loss:0.02317870408296585
The generated pressure mean: 0.4529438614845276
loss_pred:0.04124413803219795, decouple_loss:0.02215777151286602
The generated pressure mean: 0.4461607038974762
loss_pred:0.04265052080154419, decouple_loss:0.022687219083309174
Iteration: 382, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44839057326316833
The generated pressure mean: 0.45250749588012695
loss_pred:0.04054832458496094, decouple_loss:0.02419806458055973
loss_pred:0.04219883680343628, decouple_loss:0.023684075102210045
The generated pressure mean: 0.447442889213562
loss_pred:0.04126304015517235, decouple_loss:0.024507557973265648
Iteration: 383, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44749337434768677
The generated pressure mean: 0.4444408118724823
loss_pred:0.043281953781843185, decouple_loss:0.02118837647140026
loss_pred:0.04017392545938492, decouple_loss:0.021578026935458183
The generated pressure mean: 0.4443185329437256
loss_pred:0.04137264937162399, decouple_loss:0.02268367074429989
Iteration: 384, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46593669056892395
loss_pred:0.042882055044174194, decouple_loss:0.02574702724814415
The generated pressure mean: 0.46405693888664246
loss_pred:0.041879646480083466, decouple_loss:0.026233632117509842
The generated pressure mean: 0.46437087655067444
loss_pred:0.04093768075108528, decouple_loss:0.025702830404043198
Iteration: 385, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42261460423469543
The generated pressure mean: 0.42993348836898804
loss_pred:0.042599234730005264, decouple_loss:0.023022539913654327
loss_pred:0.04221006855368614, decouple_loss:0.02272907830774784
The generated pressure mean: 0.42556846141815186
loss_pred:0.04202484339475632, decouple_loss:0.02263742685317993
Iteration: 386, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45853909850120544
loss_pred:0.04177236929535866, decouple_loss:0.021828683093190193
The generated pressure mean: 0.45962750911712646
loss_pred:0.04171489179134369, decouple_loss:0.021269960328936577
The generated pressure mean: 0.4555499851703644
loss_pred:0.04186851903796196, decouple_loss:0.022351350635290146
Iteration: 387, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4632872939109802The generated pressure mean: 0.4558226466178894
loss_pred:0.04102855548262596, decouple_loss:0.02159571647644043
loss_pred:0.03977761045098305, decouple_loss:0.021453019231557846
The generated pressure mean: 0.45805320143699646
loss_pred:0.04148905351758003, decouple_loss:0.022521570324897766
Iteration: 388, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.427415132522583
The generated pressure mean: 0.4285346567630768
loss_pred:0.0397692546248436, decouple_loss:0.02127879112958908
loss_pred:0.03986768424510956, decouple_loss:0.021048476919531822
The generated pressure mean: 0.42839738726615906
loss_pred:0.04012947529554367, decouple_loss:0.021217046305537224
Iteration: 389, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43999940156936646
The generated pressure mean: 0.440556138753891
loss_pred:0.03911775350570679, decouple_loss:0.02232578955590725
loss_pred:0.040368977934122086, decouple_loss:0.022274060174822807
The generated pressure mean: 0.440661758184433
loss_pred:0.041865453124046326, decouple_loss:0.022205045446753502
Iteration: 390, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.48874571919441223
loss_pred:0.041331272572278976, decouple_loss:0.024442113935947418
The generated pressure mean: 0.48697030544281006
loss_pred:0.04381803795695305, decouple_loss:0.024584926664829254
The generated pressure mean: 0.4854160249233246
loss_pred:0.041019853204488754, decouple_loss:0.024029890075325966
2023-04-16 13:47:51 testing...
The generated pressure mean: 0.4294099807739258
The generated pressure mean: 0.43201905488967896
loss_pred:0.050200097262859344, decouple_loss:0.02799541875720024
The generated pressure mean: 0.4334469139575958
loss_pred:0.04906764626502991, decouple_loss:0.02961830236017704
loss_pred:0.048466458916664124, decouple_loss:0.029431600123643875
WV_0_PC_0_EH_1_PS_40, loss: 0.05069549009203911, avg_mse: 0.055610235780477524
current test mse: 0.05561
Iteration: 391, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.39323827624320984
The generated pressure mean: 0.39045050740242004
loss_pred:0.040968529880046844, decouple_loss:0.027109231799840927
loss_pred:0.04108273237943649, decouple_loss:0.027519123628735542
The generated pressure mean: 0.3957813084125519
loss_pred:0.04189636558294296, decouple_loss:0.02585025131702423
Iteration: 392, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4650138020515442
loss_pred:0.03989149257540703, decouple_loss:0.026678375899791718
The generated pressure mean: 0.46103420853614807
loss_pred:0.03847507759928703, decouple_loss:0.025992849841713905
The generated pressure mean: 0.4615596532821655
loss_pred:0.04180294647812843, decouple_loss:0.02629847452044487
Iteration: 393, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.48401060700416565
loss_pred:0.041973236948251724, decouple_loss:0.025638040155172348
The generated pressure mean: 0.4817749559879303
loss_pred:0.04163471236824989, decouple_loss:0.025032980367541313
The generated pressure mean: 0.48112574219703674
loss_pred:0.04159724339842796, decouple_loss:0.025165323168039322
Iteration: 394, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43226975202560425
The generated pressure mean: 0.4336944818496704
loss_pred:0.04104214161634445, decouple_loss:0.024395180866122246
loss_pred:0.04246699437499046, decouple_loss:0.025635922327637672
The generated pressure mean: 0.4342515468597412
loss_pred:0.03998897224664688, decouple_loss:0.02462354116141796
Iteration: 395, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42525020241737366
The generated pressure mean: 0.43399569392204285
loss_pred:0.04100583866238594, decouple_loss:0.025497030466794968
loss_pred:0.043276235461235046, decouple_loss:0.02538621611893177
The generated pressure mean: 0.4249914288520813
loss_pred:0.042736005038022995, decouple_loss:0.026730813086032867
Iteration: 396, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45907843112945557
loss_pred:0.04170320928096771, decouple_loss:0.024374807253479958
The generated pressure mean: 0.45583945512771606
loss_pred:0.041762154549360275, decouple_loss:0.024284876883029938
The generated pressure mean: 0.456832617521286
loss_pred:0.04279080033302307, decouple_loss:0.024070488288998604
Iteration: 397, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4815275967121124
loss_pred:0.04088183864951134, decouple_loss:0.02519863471388817
The generated pressure mean: 0.48519366979599
loss_pred:0.04354856163263321, decouple_loss:0.025480445474386215
The generated pressure mean: 0.4802726209163666
loss_pred:0.03955258056521416, decouple_loss:0.02517816238105297
Iteration: 398, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4385066330432892
loss_pred:0.041188791394233704, decouple_loss:0.022641673684120178
The generated pressure mean: 0.434457927942276
loss_pred:0.0390896201133728, decouple_loss:0.022783001884818077
The generated pressure mean: 0.4396969974040985
loss_pred:0.03987119346857071, decouple_loss:0.022651461884379387
Iteration: 399, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.40916651487350464
loss_pred:0.04131438210606575, decouple_loss:0.024400265887379646
The generated pressure mean: 0.4112832546234131
loss_pred:0.04119928553700447, decouple_loss:0.02546555921435356
The generated pressure mean: 0.4096467196941376
loss_pred:0.041421499103307724, decouple_loss:0.024735892191529274
Iteration: 400, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46028172969818115
loss_pred:0.041581813246011734, decouple_loss:0.024563821032643318
The generated pressure mean: 0.4573074281215668
loss_pred:0.0416339635848999, decouple_loss:0.025938328355550766
The generated pressure mean: 0.45333075523376465
loss_pred:0.03977212309837341, decouple_loss:0.02464093454182148
2023-04-16 13:49:44 testing...
The generated pressure mean: 0.4061617851257324
The generated pressure mean: 0.40891775488853455
loss_pred:0.052111271768808365, decouple_loss:0.02613399550318718
The generated pressure mean: 0.41020524501800537
loss_pred:0.05163733661174774, decouple_loss:0.026928776875138283
loss_pred:0.05049732327461243, decouple_loss:0.026579517871141434
WV_0_PC_0_EH_1_PS_40, loss: 0.05274268239736557, avg_mse: 0.05957143381237984
current test mse: 0.059571
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 401, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4748416841030121
loss_pred:0.041557811200618744, decouple_loss:0.02555829845368862
The generated pressure mean: 0.47576242685317993
The generated pressure mean: 0.471591979265213
loss_pred:0.04228394478559494, decouple_loss:0.025690507143735886
loss_pred:0.0417783185839653, decouple_loss:0.0252675898373127
Iteration: 402, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44467511773109436
The generated pressure mean: 0.448952853679657
loss_pred:0.041747093200683594, decouple_loss:0.02461656555533409
loss_pred:0.04218033328652382, decouple_loss:0.025151394307613373
The generated pressure mean: 0.44871649146080017
loss_pred:0.04070435091853142, decouple_loss:0.02472228929400444
Iteration: 403, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43146470189094543
loss_pred:0.04049532115459442, decouple_loss:0.02568965218961239
The generated pressure mean: 0.43233510851860046
loss_pred:0.041064951568841934, decouple_loss:0.02569633349776268
The generated pressure mean: 0.4309745728969574
loss_pred:0.041931819170713425, decouple_loss:0.026035234332084656
Iteration: 404, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.433709055185318
loss_pred:0.0420675203204155, decouple_loss:0.024440128356218338
The generated pressure mean: 0.4367867708206177
loss_pred:0.041450291872024536, decouple_loss:0.02464786358177662
The generated pressure mean: 0.4366750419139862
loss_pred:0.040056463330984116, decouple_loss:0.024251194670796394
Iteration: 405, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46346789598464966
loss_pred:0.041055355221033096, decouple_loss:0.023082103580236435
The generated pressure mean: 0.4653386175632477
loss_pred:0.04091717302799225, decouple_loss:0.02364833652973175
The generated pressure mean: 0.4657492935657501
loss_pred:0.04118603467941284, decouple_loss:0.023369915783405304
Iteration: 406, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45898979902267456
loss_pred:0.03894873708486557, decouple_loss:0.023011667653918266
The generated pressure mean: 0.45625370740890503
The generated pressure mean: 0.4578542113304138
loss_pred:0.03944970667362213, decouple_loss:0.02301572635769844
loss_pred:0.041128579527139664, decouple_loss:0.02287084423005581
Iteration: 407, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4383721649646759
loss_pred:0.03970160707831383, decouple_loss:0.021880656480789185
The generated pressure mean: 0.43603038787841797
loss_pred:0.03988019376993179, decouple_loss:0.02174653299152851
The generated pressure mean: 0.4387189745903015
loss_pred:0.041922323405742645, decouple_loss:0.023918405175209045
Iteration: 408, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44425323605537415
loss_pred:0.04060783237218857, decouple_loss:0.021601708605885506
The generated pressure mean: 0.44586896896362305
loss_pred:0.03938114643096924, decouple_loss:0.02207755297422409
The generated pressure mean: 0.44417011737823486
loss_pred:0.03978181257843971, decouple_loss:0.021387064829468727
Iteration: 409, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45456749200820923
loss_pred:0.039919886738061905, decouple_loss:0.022159844636917114
The generated pressure mean: 0.45223143696784973
loss_pred:0.04092782363295555, decouple_loss:0.022178394719958305
The generated pressure mean: 0.4564480781555176
loss_pred:0.03929576650261879, decouple_loss:0.022276101633906364
Iteration: 410, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43311598896980286
The generated pressure mean: 0.4304284453392029
loss_pred:0.04167027398943901, decouple_loss:0.02136937342584133
loss_pred:0.040188368409872055, decouple_loss:0.021663518622517586
The generated pressure mean: 0.42784616351127625
loss_pred:0.04278409481048584, decouple_loss:0.021869638934731483
2023-04-16 13:52:16 testing...
The generated pressure mean: 0.4139050543308258
The generated pressure mean: 0.41678157448768616
The generated pressure mean: 0.41826164722442627
loss_pred:0.04992853105068207, decouple_loss:0.022494690492749214
loss_pred:0.04879814013838768, decouple_loss:0.02348403073847294
loss_pred:0.0482957623898983, decouple_loss:0.023192400112748146
WV_0_PC_0_EH_1_PS_40, loss: 0.050160329788923264, avg_mse: 0.05607368052005768
current test mse: 0.056074
Iteration: 411, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44840288162231445
The generated pressure mean: 0.44983747601509094
loss_pred:0.04019957408308983, decouple_loss:0.0216747485101223
loss_pred:0.041596636176109314, decouple_loss:0.022536730393767357
The generated pressure mean: 0.44437921047210693
loss_pred:0.04121999815106392, decouple_loss:0.021996911615133286
Iteration: 412, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4713444411754608
loss_pred:0.0392877422273159, decouple_loss:0.022900493815541267
The generated pressure mean: 0.47043704986572266
loss_pred:0.040680013597011566, decouple_loss:0.02329295501112938
The generated pressure mean: 0.46640753746032715
loss_pred:0.04058830440044403, decouple_loss:0.023087210953235626
Iteration: 413, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4269806444644928
loss_pred:0.041136257350444794, decouple_loss:0.02084406279027462
The generated pressure mean: 0.42918917536735535
loss_pred:0.03995924070477486, decouple_loss:0.020903803408145905
The generated pressure mean: 0.42997562885284424
loss_pred:0.04096382111310959, decouple_loss:0.021192293614149094
Iteration: 414, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4346700608730316
The generated pressure mean: 0.43183663487434387
loss_pred:0.04250076413154602, decouple_loss:0.024054812267422676
loss_pred:0.04111528396606445, decouple_loss:0.02354060485959053
The generated pressure mean: 0.43396738171577454
loss_pred:0.040238071233034134, decouple_loss:0.024044690653681755
Iteration: 415, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47569140791893005
The generated pressure mean: 0.46925175189971924
loss_pred:0.041603934019804, decouple_loss:0.023898035287857056
loss_pred:0.03977283090353012, decouple_loss:0.023350147530436516
The generated pressure mean: 0.4741743505001068
loss_pred:0.03978465497493744, decouple_loss:0.022932052612304688
Iteration: 416, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448034405708313
The generated pressure mean: 0.4463239014148712
loss_pred:0.041505444794893265, decouple_loss:0.025482553988695145
loss_pred:0.04193700850009918, decouple_loss:0.02542973682284355
The generated pressure mean: 0.451307475566864
loss_pred:0.0414600670337677, decouple_loss:0.025887086987495422
Iteration: 417, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4332537353038788
loss_pred:0.04154423996806145, decouple_loss:0.024506522342562675
The generated pressure mean: 0.4344668686389923
loss_pred:0.04102801904082298, decouple_loss:0.0245986171066761
The generated pressure mean: 0.4335636496543884
loss_pred:0.03894222527742386, decouple_loss:0.024139560759067535
Iteration: 418, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44998621940612793
The generated pressure mean: 0.4568348824977875
loss_pred:0.04135964438319206, decouple_loss:0.02468171715736389
loss_pred:0.04341563954949379, decouple_loss:0.025222009047865868
The generated pressure mean: 0.4571819305419922
loss_pred:0.04093872383236885, decouple_loss:0.025844469666481018
Iteration: 419, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4535853862762451The generated pressure mean: 0.4528678357601166
loss_pred:0.04108604043722153, decouple_loss:0.03075464628636837loss_pred:0.04163649305701256, decouple_loss:0.03179195150732994
The generated pressure mean: 0.4586188793182373
loss_pred:0.042029548436403275, decouple_loss:0.030460761860013008
Iteration: 420, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.442534476518631
loss_pred:0.03979237750172615, decouple_loss:0.022983146831393242
The generated pressure mean: 0.44057223200798035
loss_pred:0.03825412318110466, decouple_loss:0.0238836407661438
The generated pressure mean: 0.43878138065338135
loss_pred:0.039467088878154755, decouple_loss:0.023543115705251694
2023-04-16 13:54:10 testing...
The generated pressure mean: 0.4193165600299835
The generated pressure mean: 0.41601136326789856
The generated pressure mean: 0.42099055647850037
loss_pred:0.05022145062685013, decouple_loss:0.03560329228639603
loss_pred:0.05115274712443352, decouple_loss:0.03374385088682175
loss_pred:0.04929433390498161, decouple_loss:0.0354413278400898
WV_0_PC_0_EH_1_PS_40, loss: 0.051969315856695175, avg_mse: 0.0587599091231823
current test mse: 0.05876
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 421, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4418932795524597
loss_pred:0.04368100315332413, decouple_loss:0.03259348124265671
The generated pressure mean: 0.4421561062335968
loss_pred:0.04235813394188881, decouple_loss:0.03199860826134682
The generated pressure mean: 0.4428270161151886
loss_pred:0.04092097282409668, decouple_loss:0.03197694197297096
Iteration: 422, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45356035232543945
loss_pred:0.04212537780404091, decouple_loss:0.02701951563358307
The generated pressure mean: 0.4558619260787964
loss_pred:0.04162807762622833, decouple_loss:0.027336353436112404
The generated pressure mean: 0.4536179006099701
loss_pred:0.042306844145059586, decouple_loss:0.027386991307139397
Iteration: 423, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44793951511383057
The generated pressure mean: 0.45388731360435486
loss_pred:0.042369142174720764, decouple_loss:0.027976492419838905
loss_pred:0.0394599549472332, decouple_loss:0.027348918840289116
The generated pressure mean: 0.45056140422821045
loss_pred:0.042323943227529526, decouple_loss:0.028864743188023567
Iteration: 424, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44477415084838867
The generated pressure mean: 0.4405912756919861
loss_pred:0.040092583745718, decouple_loss:0.027556799352169037
loss_pred:0.042722415179014206, decouple_loss:0.028208496049046516
The generated pressure mean: 0.44358691573143005
loss_pred:0.04211873188614845, decouple_loss:0.02807687036693096
Iteration: 425, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468386471271515
The generated pressure mean: 0.4549422264099121
loss_pred:0.04030657187104225, decouple_loss:0.025984130799770355
loss_pred:0.04232049733400345, decouple_loss:0.027307799085974693
The generated pressure mean: 0.444671630859375
loss_pred:0.04024805501103401, decouple_loss:0.02655908279120922
Iteration: 426, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4514807462692261
The generated pressure mean: 0.4554346203804016
loss_pred:0.04184522479772568, decouple_loss:0.030857069417834282
loss_pred:0.04286238178610802, decouple_loss:0.031117644160985947
The generated pressure mean: 0.4511444568634033
loss_pred:0.04391853138804436, decouple_loss:0.031110111624002457
Iteration: 427, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4457009434700012
The generated pressure mean: 0.4468739330768585
loss_pred:0.0428907573223114, decouple_loss:0.02479114942252636
loss_pred:0.04140039533376694, decouple_loss:0.025309212505817413
The generated pressure mean: 0.44305935502052307
loss_pred:0.04040995240211487, decouple_loss:0.024842122569680214
Iteration: 428, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4566015899181366
loss_pred:0.03983292728662491, decouple_loss:0.03143134340643883
The generated pressure mean: 0.4532116651535034
loss_pred:0.04116705432534218, decouple_loss:0.031455185264348984
The generated pressure mean: 0.4538046717643738
loss_pred:0.041614361107349396, decouple_loss:0.03181353956460953
Iteration: 429, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.445637047290802
loss_pred:0.04148358106613159, decouple_loss:0.02470523491501808
The generated pressure mean: 0.4439801275730133
loss_pred:0.041769664734601974, decouple_loss:0.025779854506254196
The generated pressure mean: 0.4444250762462616
loss_pred:0.03935744985938072, decouple_loss:0.024265019223093987
Iteration: 430, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4573396146297455
loss_pred:0.043402478098869324, decouple_loss:0.03442944586277008
The generated pressure mean: 0.45190030336380005
loss_pred:0.04021383449435234, decouple_loss:0.03433075174689293
The generated pressure mean: 0.4493555724620819
loss_pred:0.039387334138154984, decouple_loss:0.034468285739421844
2023-04-16 13:56:46 testing...
The generated pressure mean: 0.41879960894584656
The generated pressure mean: 0.4222281277179718
The generated pressure mean: 0.42421388626098633
loss_pred:0.049293484538793564, decouple_loss:0.026867588981986046
loss_pred:0.04792775958776474, decouple_loss:0.027867846190929413
loss_pred:0.04683210328221321, decouple_loss:0.027630753815174103
WV_0_PC_0_EH_1_PS_40, loss: 0.049390554428100586, avg_mse: 0.05543948709964752
current test mse: 0.055439
Iteration: 431, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.443404883146286
loss_pred:0.042468804866075516, decouple_loss:0.026340961456298828
The generated pressure mean: 0.4400462806224823
loss_pred:0.04126683250069618, decouple_loss:0.026151686906814575
The generated pressure mean: 0.4421856701374054
loss_pred:0.03961081802845001, decouple_loss:0.02564757876098156
Iteration: 432, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4528556764125824
loss_pred:0.042721811681985855, decouple_loss:0.035301510244607925
The generated pressure mean: 0.4558107852935791
loss_pred:0.039904605597257614, decouple_loss:0.03487212583422661
The generated pressure mean: 0.46117883920669556
loss_pred:0.04235100746154785, decouple_loss:0.03604235127568245
Iteration: 433, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4396519660949707
loss_pred:0.03956622630357742, decouple_loss:0.028720533475279808
The generated pressure mean: 0.44276851415634155
loss_pred:0.03907599672675133, decouple_loss:0.029057694599032402
The generated pressure mean: 0.4449414312839508
loss_pred:0.04027555510401726, decouple_loss:0.02879268489778042
Iteration: 434, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4363526701927185
loss_pred:0.04181024432182312, decouple_loss:0.034291621297597885
The generated pressure mean: 0.4442262053489685
loss_pred:0.042115192860364914, decouple_loss:0.03454972058534622
The generated pressure mean: 0.442870557308197
loss_pred:0.03900489583611488, decouple_loss:0.03380858898162842
Iteration: 435, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4584542512893677
loss_pred:0.039419081062078476, decouple_loss:0.028169499710202217
The generated pressure mean: 0.4574335217475891
loss_pred:0.04064149037003517, decouple_loss:0.028379561379551888
The generated pressure mean: 0.459090918302536
loss_pred:0.04091673716902733, decouple_loss:0.028378672897815704
Iteration: 436, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4563499987125397
loss_pred:0.04137380048632622, decouple_loss:0.03261721879243851
The generated pressure mean: 0.4578990340232849
loss_pred:0.03961172699928284, decouple_loss:0.031041814014315605
The generated pressure mean: 0.46098753809928894
loss_pred:0.03911574184894562, decouple_loss:0.031591713428497314
Iteration: 437, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42446112632751465
The generated pressure mean: 0.42326030135154724
loss_pred:0.04126901179552078, decouple_loss:0.026226194575428963
loss_pred:0.04054518789052963, decouple_loss:0.026544200256466866
The generated pressure mean: 0.4236595630645752
loss_pred:0.0402911975979805, decouple_loss:0.026303263381123543
Iteration: 438, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46706709265708923
loss_pred:0.041401877999305725, decouple_loss:0.030273767188191414
The generated pressure mean: 0.4605673849582672
loss_pred:0.03942599147558212, decouple_loss:0.029791181907057762
The generated pressure mean: 0.4626290500164032
loss_pred:0.041260406374931335, decouple_loss:0.030227934941649437
Iteration: 439, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4543658196926117
loss_pred:0.04042324051260948, decouple_loss:0.023030001670122147
The generated pressure mean: 0.45618152618408203
loss_pred:0.040580667555332184, decouple_loss:0.023121897131204605
The generated pressure mean: 0.455714613199234
loss_pred:0.04149173945188522, decouple_loss:0.02263476513326168
Iteration: 440, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43143683671951294
loss_pred:0.04281696677207947, decouple_loss:0.028650235384702682
The generated pressure mean: 0.4290577471256256
loss_pred:0.04232703521847725, decouple_loss:0.029148777946829796
The generated pressure mean: 0.4335554838180542
loss_pred:0.04117840901017189, decouple_loss:0.029047125950455666
2023-04-16 13:58:39 testing...
The generated pressure mean: 0.41392117738723755
The generated pressure mean: 0.4172847867012024
The generated pressure mean: 0.4196319282054901
loss_pred:0.049634892493486404, decouple_loss:0.02615426294505596
loss_pred:0.04872020334005356, decouple_loss:0.026840176433324814
loss_pred:0.047684308141469955, decouple_loss:0.026745643466711044
WV_0_PC_0_EH_1_PS_40, loss: 0.050008803606033325, avg_mse: 0.05698985978960991
current test mse: 0.05699
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 441, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46368837356567383
loss_pred:0.04157045856118202, decouple_loss:0.024547798559069633
The generated pressure mean: 0.46444469690322876
loss_pred:0.04073372483253479, decouple_loss:0.024486087262630463
The generated pressure mean: 0.46099504828453064
loss_pred:0.040809061378240585, decouple_loss:0.024873752146959305
Iteration: 442, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4337623119354248
The generated pressure mean: 0.43365201354026794
loss_pred:0.039090562611818314, decouple_loss:0.02889537811279297
loss_pred:0.04248525947332382, decouple_loss:0.0296540018171072
The generated pressure mean: 0.4381960928440094
loss_pred:0.041302360594272614, decouple_loss:0.029609106481075287
Iteration: 443, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44833388924598694
The generated pressure mean: 0.45033660531044006
loss_pred:0.040967222303152084, decouple_loss:0.024978723376989365
loss_pred:0.04010272026062012, decouple_loss:0.026340622454881668
The generated pressure mean: 0.4505408704280853
loss_pred:0.04240861162543297, decouple_loss:0.025937410071492195
Iteration: 444, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4534949064254761
The generated pressure mean: 0.45798981189727783
loss_pred:0.040385399013757706, decouple_loss:0.025983167812228203
loss_pred:0.04045625030994415, decouple_loss:0.026396172121167183
The generated pressure mean: 0.455375075340271
loss_pred:0.04079956188797951, decouple_loss:0.026516277343034744
Iteration: 445, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44904330372810364
The generated pressure mean: 0.4583703577518463
loss_pred:0.038743648678064346, decouple_loss:0.027729490771889687
loss_pred:0.039076242595911026, decouple_loss:0.026309434324502945
The generated pressure mean: 0.45301058888435364
loss_pred:0.0397842675447464, decouple_loss:0.02730908989906311
Iteration: 446, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4532078504562378
The generated pressure mean: 0.4518599212169647
loss_pred:0.040948286652565, decouple_loss:0.024783045053482056
loss_pred:0.04124745726585388, decouple_loss:0.025050532072782516
The generated pressure mean: 0.45129984617233276
loss_pred:0.041436195373535156, decouple_loss:0.025463417172431946
Iteration: 447, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4335605502128601The generated pressure mean: 0.42711612582206726
loss_pred:0.04022150859236717, decouple_loss:0.025315463542938232
loss_pred:0.039406899362802505, decouple_loss:0.0249257180839777
The generated pressure mean: 0.43451833724975586
loss_pred:0.04048962891101837, decouple_loss:0.025209540501236916
Iteration: 448, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4588640332221985
The generated pressure mean: 0.4586663544178009
loss_pred:0.04137561842799187, decouple_loss:0.02660323865711689
loss_pred:0.042554821819067, decouple_loss:0.026965493336319923
The generated pressure mean: 0.4605386257171631
loss_pred:0.041246142238378525, decouple_loss:0.026719678193330765
Iteration: 449, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46900784969329834
loss_pred:0.04239447042346001, decouple_loss:0.024401800706982613
The generated pressure mean: 0.47385552525520325
loss_pred:0.04129359498620033, decouple_loss:0.02431495115160942
The generated pressure mean: 0.4765067398548126
loss_pred:0.04004845768213272, decouple_loss:0.02496161311864853
Iteration: 450, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.40061154961586
loss_pred:0.04081932455301285, decouple_loss:0.026066171005368233
The generated pressure mean: 0.397841215133667
loss_pred:0.04412763565778732, decouple_loss:0.026271270588040352
The generated pressure mean: 0.3988259434700012
loss_pred:0.04250578209757805, decouple_loss:0.025734053924679756
2023-04-16 14:01:09 testing...
The generated pressure mean: 0.40598440170288086
The generated pressure mean: 0.40970537066459656
The generated pressure mean: 0.4115537405014038
loss_pred:0.05405868962407112, decouple_loss:0.025873636826872826
loss_pred:0.05297316983342171, decouple_loss:0.027225568890571594
loss_pred:0.05189996585249901, decouple_loss:0.026940273120999336
WV_0_PC_0_EH_1_PS_40, loss: 0.05431126803159714, avg_mse: 0.06514577567577362
current test mse: 0.065146
Iteration: 451, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4825354218482971
loss_pred:0.04242412745952606, decouple_loss:0.024556433781981468
The generated pressure mean: 0.482493132352829
loss_pred:0.04078760743141174, decouple_loss:0.025004681199789047
The generated pressure mean: 0.48411670327186584
loss_pred:0.040817517787218094, decouple_loss:0.024221794679760933
Iteration: 452, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47103071212768555
The generated pressure mean: 0.4700274169445038
loss_pred:0.041293106973171234, decouple_loss:0.0240708626806736
loss_pred:0.04145028442144394, decouple_loss:0.02522171661257744
The generated pressure mean: 0.4699568748474121
loss_pred:0.04084458947181702, decouple_loss:0.024332644417881966
Iteration: 453, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4169948101043701The generated pressure mean: 0.42245906591415405
loss_pred:0.042231302708387375, decouple_loss:0.025928925722837448
loss_pred:0.04045254364609718, decouple_loss:0.026356831192970276
The generated pressure mean: 0.4163401424884796
loss_pred:0.041540857404470444, decouple_loss:0.02523694559931755
Iteration: 454, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4396294057369232The generated pressure mean: 0.4420722723007202
loss_pred:0.04124646633863449, decouple_loss:0.02532166801393032
loss_pred:0.03963089361786842, decouple_loss:0.024534333497285843
The generated pressure mean: 0.4394431412220001
loss_pred:0.040398191660642624, decouple_loss:0.024847280234098434
Iteration: 455, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47182026505470276
The generated pressure mean: 0.4698691666126251
loss_pred:0.041142694652080536, decouple_loss:0.025756150484085083
loss_pred:0.03964732587337494, decouple_loss:0.02516091614961624
The generated pressure mean: 0.4746902585029602
loss_pred:0.04135286808013916, decouple_loss:0.02533012442290783
Iteration: 456, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45690810680389404
loss_pred:0.040116071701049805, decouple_loss:0.023234277963638306
The generated pressure mean: 0.45908862352371216
loss_pred:0.03995616361498833, decouple_loss:0.02466338872909546
The generated pressure mean: 0.4571666717529297
loss_pred:0.0394769161939621, decouple_loss:0.02362445741891861
Iteration: 457, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42637863755226135
loss_pred:0.04027605429291725, decouple_loss:0.023289302363991737
The generated pressure mean: 0.426853746175766
loss_pred:0.03891558200120926, decouple_loss:0.02331831492483616
The generated pressure mean: 0.424445778131485
loss_pred:0.03950446471571922, decouple_loss:0.02380463108420372
Iteration: 458, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4363294839859009
loss_pred:0.04027817025780678, decouple_loss:0.02355034276843071
The generated pressure mean: 0.43496668338775635
loss_pred:0.0411505289375782, decouple_loss:0.02373761311173439
The generated pressure mean: 0.43554842472076416
loss_pred:0.03991870582103729, decouple_loss:0.024198364466428757
Iteration: 459, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46470901370048523
The generated pressure mean: 0.46631351113319397loss_pred:0.04176659509539604, decouple_loss:0.022642647847533226
loss_pred:0.038764648139476776, decouple_loss:0.02276870794594288
The generated pressure mean: 0.463981032371521
loss_pred:0.04069981724023819, decouple_loss:0.022342169657349586
Iteration: 460, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.464251846075058
loss_pred:0.041669104248285294, decouple_loss:0.02368808723986149
The generated pressure mean: 0.4622177183628082
loss_pred:0.03903999179601669, decouple_loss:0.023173881694674492
The generated pressure mean: 0.46780651807785034
loss_pred:0.040577083826065063, decouple_loss:0.02298002690076828
2023-04-16 14:03:03 testing...
The generated pressure mean: 0.41850748658180237
The generated pressure mean: 0.42162731289863586
The generated pressure mean: 0.42334553599357605
loss_pred:0.04699009284377098, decouple_loss:0.02199574187397957
loss_pred:0.046158451586961746, decouple_loss:0.023558078333735466
loss_pred:0.045553915202617645, decouple_loss:0.02335965819656849
WV_0_PC_0_EH_1_PS_40, loss: 0.04738271236419678, avg_mse: 0.053067632019519806
current test mse: 0.053068
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 461, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4328851103782654
loss_pred:0.03931800648570061, decouple_loss:0.02171613834798336
The generated pressure mean: 0.43350130319595337
loss_pred:0.040026187896728516, decouple_loss:0.021396037191152573
The generated pressure mean: 0.4354231655597687
loss_pred:0.03907689452171326, decouple_loss:0.022129854187369347
Iteration: 462, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4327751100063324
The generated pressure mean: 0.43031570315361023
loss_pred:0.03842910751700401, decouple_loss:0.023204492405056953
loss_pred:0.040039170533418655, decouple_loss:0.02231360599398613
The generated pressure mean: 0.43038901686668396
loss_pred:0.03930674493312836, decouple_loss:0.023009534925222397
Iteration: 463, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4593137502670288
loss_pred:0.03730341047048569, decouple_loss:0.023100264370441437
The generated pressure mean: 0.4603128731250763
loss_pred:0.038198716938495636, decouple_loss:0.022955238819122314
The generated pressure mean: 0.4597633481025696
loss_pred:0.03900965675711632, decouple_loss:0.022733494639396667
Iteration: 464, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46653345227241516
The generated pressure mean: 0.4652228057384491
loss_pred:0.040062014013528824, decouple_loss:0.02027945965528488
loss_pred:0.03970833122730255, decouple_loss:0.020463231950998306
The generated pressure mean: 0.46412351727485657
loss_pred:0.03995669633150101, decouple_loss:0.020475830882787704
Iteration: 465, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4367258548736572
The generated pressure mean: 0.43499255180358887
loss_pred:0.039312537759542465, decouple_loss:0.02266775816679001
loss_pred:0.04001973941922188, decouple_loss:0.022564271464943886
The generated pressure mean: 0.43623220920562744
loss_pred:0.037846796214580536, decouple_loss:0.02185947261750698
Iteration: 466, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43286198377609253
The generated pressure mean: 0.43517637252807617
loss_pred:0.03911145031452179, decouple_loss:0.020462993532419205
loss_pred:0.03952978178858757, decouple_loss:0.021075589582324028
The generated pressure mean: 0.43311673402786255
loss_pred:0.03884601220488548, decouple_loss:0.020874371752142906
Iteration: 467, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45289358496665955
loss_pred:0.038895927369594574, decouple_loss:0.020918218418955803
The generated pressure mean: 0.45551419258117676
loss_pred:0.0378430038690567, decouple_loss:0.021134212613105774
The generated pressure mean: 0.4541933536529541
loss_pred:0.03976107016205788, decouple_loss:0.020880643278360367
Iteration: 468, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4516228139400482
loss_pred:0.03852061182260513, decouple_loss:0.019401978701353073
The generated pressure mean: 0.4526940584182739
loss_pred:0.03934204950928688, decouple_loss:0.020369943231344223
The generated pressure mean: 0.448981910943985
loss_pred:0.03960476070642471, decouple_loss:0.019695593044161797
Iteration: 469, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4367014765739441
The generated pressure mean: 0.43617409467697144loss_pred:0.03724024072289467, decouple_loss:0.021489053964614868
loss_pred:0.037393055856227875, decouple_loss:0.021805549040436745
The generated pressure mean: 0.435547411441803
loss_pred:0.0389915332198143, decouple_loss:0.021069200709462166
Iteration: 470, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44514185190200806
The generated pressure mean: 0.44876888394355774
loss_pred:0.03805902227759361, decouple_loss:0.02171740122139454
loss_pred:0.03816249221563339, decouple_loss:0.021567344665527344
The generated pressure mean: 0.4493063986301422
loss_pred:0.038083311170339584, decouple_loss:0.021931957453489304
2023-04-16 14:05:36 testing...
The generated pressure mean: 0.4181286096572876
The generated pressure mean: 0.42158639430999756
The generated pressure mean: 0.4237436056137085
loss_pred:0.048251040279865265, decouple_loss:0.022410690784454346
loss_pred:0.0471099391579628, decouple_loss:0.02377312071621418
loss_pred:0.04639657586812973, decouple_loss:0.023683717474341393
WV_0_PC_0_EH_1_PS_40, loss: 0.04841697961091995, avg_mse: 0.05571848526597023
current test mse: 0.055718
Iteration: 471, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479285478591919The generated pressure mean: 0.4540070593357086
loss_pred:0.039188023656606674, decouple_loss:0.020823433995246887loss_pred:0.039951667189598083, decouple_loss:0.02091078832745552
The generated pressure mean: 0.4530065655708313
loss_pred:0.0392705537378788, decouple_loss:0.020798642188310623
Iteration: 472, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45009228587150574
The generated pressure mean: 0.44875526428222656
loss_pred:0.03688431903719902, decouple_loss:0.022131774574518204
loss_pred:0.037925418466329575, decouple_loss:0.02160394936800003
The generated pressure mean: 0.4534008204936981
loss_pred:0.040026165544986725, decouple_loss:0.021638523787260056
Iteration: 473, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470905661582947
The generated pressure mean: 0.44512563943862915
loss_pred:0.03811025619506836, decouple_loss:0.01950111798942089
loss_pred:0.03707887977361679, decouple_loss:0.020260393619537354
The generated pressure mean: 0.4489390254020691
loss_pred:0.038377318531274796, decouple_loss:0.01962820626795292
Iteration: 474, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4457317292690277
The generated pressure mean: 0.44320791959762573
loss_pred:0.03919181972742081, decouple_loss:0.02169841155409813
loss_pred:0.03983625769615173, decouple_loss:0.021609168499708176
The generated pressure mean: 0.4445575773715973
loss_pred:0.03750727325677872, decouple_loss:0.021503528580069542
Iteration: 475, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4531133472919464
The generated pressure mean: 0.45257270336151123loss_pred:0.039082121104002, decouple_loss:0.020874634385108948
loss_pred:0.03755929321050644, decouple_loss:0.02142530493438244
The generated pressure mean: 0.4485968351364136
loss_pred:0.03971267491579056, decouple_loss:0.020872989669442177
Iteration: 476, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4428587555885315
The generated pressure mean: 0.4413091242313385
loss_pred:0.03972747176885605, decouple_loss:0.01991989277303219
loss_pred:0.03719997778534889, decouple_loss:0.020297519862651825
The generated pressure mean: 0.4423843026161194
loss_pred:0.03843521699309349, decouple_loss:0.020149854943156242
Iteration: 477, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.457732230424881The generated pressure mean: 0.45604294538497925
loss_pred:0.03868376463651657, decouple_loss:0.02234705351293087
loss_pred:0.03771315515041351, decouple_loss:0.02199830301105976
The generated pressure mean: 0.4571838080883026
loss_pred:0.03753664717078209, decouple_loss:0.021983569487929344
Iteration: 478, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42920657992362976
The generated pressure mean: 0.43513232469558716
loss_pred:0.039306726306676865, decouple_loss:0.019191116094589233
loss_pred:0.03896336257457733, decouple_loss:0.019963938742876053
The generated pressure mean: 0.4386863112449646
loss_pred:0.03821933642029762, decouple_loss:0.019671548157930374
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 479, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4617404043674469
loss_pred:0.03891075775027275, decouple_loss:0.01971772313117981
The generated pressure mean: 0.4653190076351166
loss_pred:0.03727058693766594, decouple_loss:0.01992054469883442
The generated pressure mean: 0.46146950125694275
loss_pred:0.03824089467525482, decouple_loss:0.019818564876914024
Iteration: 480, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43086379766464233
The generated pressure mean: 0.43348586559295654
loss_pred:0.03827475383877754, decouple_loss:0.022172054275870323
loss_pred:0.03786405175924301, decouple_loss:0.022030368447303772
The generated pressure mean: 0.428708016872406
loss_pred:0.037112124264240265, decouple_loss:0.02232944592833519
2023-04-16 14:07:30 testing...
The generated pressure mean: 0.41532397270202637
The generated pressure mean: 0.4190482497215271
The generated pressure mean: 0.4212395250797272
loss_pred:0.047006312757730484, decouple_loss:0.021870417520403862
loss_pred:0.045650165528059006, decouple_loss:0.023402031511068344
loss_pred:0.04504624381661415, decouple_loss:0.023233072832226753
WV_0_PC_0_EH_1_PS_40, loss: 0.047042667865753174, avg_mse: 0.05385586619377136
current test mse: 0.053856
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 481, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46145662665367126
loss_pred:0.039797160774469376, decouple_loss:0.019419193267822266
The generated pressure mean: 0.46170803904533386
loss_pred:0.0388617068529129, decouple_loss:0.019268935546278954
The generated pressure mean: 0.463373601436615
loss_pred:0.038519952446222305, decouple_loss:0.019216274842619896
Iteration: 482, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43927183747291565
The generated pressure mean: 0.44269365072250366
loss_pred:0.037847187370061874, decouple_loss:0.0192951001226902
loss_pred:0.03664270043373108, decouple_loss:0.019456665962934494
The generated pressure mean: 0.43437448143959045
loss_pred:0.03807331621646881, decouple_loss:0.019210796803236008
Iteration: 483, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4426712393760681
The generated pressure mean: 0.45135751366615295
loss_pred:0.03819284960627556, decouple_loss:0.01909731514751911
loss_pred:0.03671151399612427, decouple_loss:0.01955048181116581
The generated pressure mean: 0.4489898979663849
loss_pred:0.03996706381440163, decouple_loss:0.01978173851966858
Iteration: 484, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4535546600818634
The generated pressure mean: 0.45265236496925354
loss_pred:0.03605695813894272, decouple_loss:0.01916593685746193
loss_pred:0.03768852353096008, decouple_loss:0.019407669082283974
The generated pressure mean: 0.4475986957550049
loss_pred:0.03678235411643982, decouple_loss:0.019297322258353233
Iteration: 485, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4450623095035553
The generated pressure mean: 0.439053475856781
loss_pred:0.038765035569667816, decouple_loss:0.01845639944076538
loss_pred:0.038203973323106766, decouple_loss:0.018237760290503502
The generated pressure mean: 0.4412085711956024
loss_pred:0.03803201764822006, decouple_loss:0.017722265794873238
Iteration: 486, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45695990324020386
The generated pressure mean: 0.45816007256507874
loss_pred:0.03836681321263313, decouple_loss:0.020441753789782524
loss_pred:0.039110761135816574, decouple_loss:0.020355690270662308
The generated pressure mean: 0.4616188108921051
loss_pred:0.038399823009967804, decouple_loss:0.020610392093658447
Iteration: 487, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44212085008621216
The generated pressure mean: 0.4406006634235382
loss_pred:0.03914136067032814, decouple_loss:0.01837635412812233
loss_pred:0.03601659834384918, decouple_loss:0.018452975898981094
The generated pressure mean: 0.43461084365844727
loss_pred:0.03641439974308014, decouple_loss:0.0185852088034153
Iteration: 488, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44360673427581787
loss_pred:0.037651270627975464, decouple_loss:0.017711035907268524
The generated pressure mean: 0.4472801983356476
loss_pred:0.03861379250884056, decouple_loss:0.018109261989593506
The generated pressure mean: 0.44672223925590515
loss_pred:0.03698369488120079, decouple_loss:0.017398562282323837
Iteration: 489, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.451158732175827
The generated pressure mean: 0.45056548714637756
loss_pred:0.03697375953197479, decouple_loss:0.019557543098926544
loss_pred:0.0368313193321228, decouple_loss:0.019322603940963745
The generated pressure mean: 0.45316416025161743
loss_pred:0.03911381959915161, decouple_loss:0.01978413574397564
Iteration: 490, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44114765524864197
loss_pred:0.037674419581890106, decouple_loss:0.01840340718626976
The generated pressure mean: 0.43948131799697876
loss_pred:0.03759808838367462, decouple_loss:0.018302928656339645
The generated pressure mean: 0.4375259578227997
loss_pred:0.03783244267106056, decouple_loss:0.017975274473428726
2023-04-16 14:10:04 testing...
The generated pressure mean: 0.414668470621109
The generated pressure mean: 0.4180328845977783
The generated pressure mean: 0.4201169013977051
loss_pred:0.04678536579012871, decouple_loss:0.0198347307741642
loss_pred:0.04571370780467987, decouple_loss:0.02126801386475563loss_pred:0.04506468027830124, decouple_loss:0.02116939052939415
WV_0_PC_0_EH_1_PS_40, loss: 0.04689245671033859, avg_mse: 0.053973812609910965
current test mse: 0.053974
Iteration: 491, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4647846519947052
The generated pressure mean: 0.46171069145202637
loss_pred:0.037502918392419815, decouple_loss:0.018770791590213776
loss_pred:0.03694203868508339, decouple_loss:0.01842244528234005
The generated pressure mean: 0.46546047925949097
loss_pred:0.03736795857548714, decouple_loss:0.018078656867146492
Iteration: 492, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4352743923664093
loss_pred:0.0370296873152256, decouple_loss:0.018647190183401108
The generated pressure mean: 0.43352222442626953
loss_pred:0.03864620253443718, decouple_loss:0.018752967938780785
The generated pressure mean: 0.4351601302623749
loss_pred:0.03516925126314163, decouple_loss:0.019011886790394783
Iteration: 493, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4433693289756775
The generated pressure mean: 0.44909435510635376
loss_pred:0.037132617086172104, decouple_loss:0.019078413024544716
loss_pred:0.038781821727752686, decouple_loss:0.018624786287546158
The generated pressure mean: 0.44732484221458435
loss_pred:0.03683483600616455, decouple_loss:0.019078552722930908
Iteration: 494, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4630540609359741
loss_pred:0.038272131234407425, decouple_loss:0.018705781549215317
The generated pressure mean: 0.46298748254776
loss_pred:0.0376887209713459, decouple_loss:0.01901995576918125
The generated pressure mean: 0.46577030420303345
loss_pred:0.03739582747220993, decouple_loss:0.018913136795163155
Iteration: 495, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4314488172531128
The generated pressure mean: 0.42645010352134705
loss_pred:0.037037041038274765, decouple_loss:0.01887921430170536
loss_pred:0.03794892504811287, decouple_loss:0.019538341090083122
The generated pressure mean: 0.4326229691505432
loss_pred:0.03792048990726471, decouple_loss:0.019153885543346405
Iteration: 496, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47078558802604675
The generated pressure mean: 0.4721468389034271
loss_pred:0.038735371083021164, decouple_loss:0.019245395436882973
loss_pred:0.04007260501384735, decouple_loss:0.019436892122030258
The generated pressure mean: 0.46749427914619446
loss_pred:0.03549414128065109, decouple_loss:0.01917220652103424
Iteration: 497, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4149314761161804
loss_pred:0.03802776336669922, decouple_loss:0.02035439759492874
The generated pressure mean: 0.41854938864707947
loss_pred:0.03938690572977066, decouple_loss:0.01972634717822075
The generated pressure mean: 0.42023158073425293
loss_pred:0.03734326362609863, decouple_loss:0.019500914961099625
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 498, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47442689538002014
The generated pressure mean: 0.4864320755004883
loss_pred:0.03755725920200348, decouple_loss:0.01983540505170822
loss_pred:0.039477020502090454, decouple_loss:0.01962095871567726
The generated pressure mean: 0.4816839098930359
loss_pred:0.038548167794942856, decouple_loss:0.019477277994155884
Iteration: 499, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4266565442085266
The generated pressure mean: 0.42879918217658997
loss_pred:0.03836693987250328, decouple_loss:0.01834152638912201
loss_pred:0.03644753620028496, decouple_loss:0.018533842638134956
The generated pressure mean: 0.42573484778404236
loss_pred:0.03616220876574516, decouple_loss:0.018391335383057594
Iteration: 500, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45012807846069336
loss_pred:0.03622625023126602, decouple_loss:0.019122889265418053
The generated pressure mean: 0.4524446129798889
loss_pred:0.03801858425140381, decouple_loss:0.018858788534998894
The generated pressure mean: 0.44864532351493835
loss_pred:0.03743342310190201, decouple_loss:0.018919197842478752
2023-04-16 14:11:57 testing...
The generated pressure mean: 0.4188891351222992
The generated pressure mean: 0.4155771732330322
The generated pressure mean: 0.42069190740585327
loss_pred:0.046097200363874435, decouple_loss:0.022759146988391876
loss_pred:0.046987079083919525, decouple_loss:0.021652499213814735
loss_pred:0.04540863260626793, decouple_loss:0.022594455629587173
WV_0_PC_0_EH_1_PS_40, loss: 0.04728107154369354, avg_mse: 0.05467427149415016
current test mse: 0.054674
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 501, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44935786724090576
loss_pred:0.038799040019512177, decouple_loss:0.020696187391877174
The generated pressure mean: 0.45116156339645386The generated pressure mean: 0.44786331057548523
loss_pred:0.037088025361299515, decouple_loss:0.02145753987133503
loss_pred:0.037402763962745667, decouple_loss:0.021892309188842773
Iteration: 502, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44857698678970337
loss_pred:0.039806168526411057, decouple_loss:0.021058758720755577
The generated pressure mean: 0.4427502155303955
loss_pred:0.039954300969839096, decouple_loss:0.020591363310813904
The generated pressure mean: 0.4454606771469116
loss_pred:0.037367552518844604, decouple_loss:0.021594058722257614
Iteration: 503, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489099085330963
The generated pressure mean: 0.4550318717956543
loss_pred:0.03780397027730942, decouple_loss:0.022261004894971848
loss_pred:0.039101697504520416, decouple_loss:0.02186022885143757
The generated pressure mean: 0.44710296392440796
loss_pred:0.03835073485970497, decouple_loss:0.022738277912139893
Iteration: 504, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46290868520736694
The generated pressure mean: 0.4547238051891327
loss_pred:0.03842271864414215, decouple_loss:0.022252367809414864
loss_pred:0.036130595952272415, decouple_loss:0.021827097982168198
The generated pressure mean: 0.4500400424003601
loss_pred:0.03928736597299576, decouple_loss:0.021838227286934853
Iteration: 505, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4415194094181061
The generated pressure mean: 0.4414995014667511
loss_pred:0.03867782652378082, decouple_loss:0.02079290896654129
loss_pred:0.03856693580746651, decouple_loss:0.021146399900317192
The generated pressure mean: 0.44558823108673096
loss_pred:0.038592949509620667, decouple_loss:0.021236415952444077
Iteration: 506, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4428474009037018
The generated pressure mean: 0.44454073905944824
loss_pred:0.036872923374176025, decouple_loss:0.023290827870368958
loss_pred:0.03731117770075798, decouple_loss:0.022356728091835976
The generated pressure mean: 0.44130173325538635
loss_pred:0.03917216137051582, decouple_loss:0.02263730764389038
Iteration: 507, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461258053779602The generated pressure mean: 0.44882598519325256
loss_pred:0.03707238286733627, decouple_loss:0.022003570571541786loss_pred:0.038937512785196304, decouple_loss:0.022538375109434128
The generated pressure mean: 0.44941580295562744
loss_pred:0.03620263934135437, decouple_loss:0.022759972140192986
Iteration: 508, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4594314992427826
loss_pred:0.0372922345995903, decouple_loss:0.023568423464894295
The generated pressure mean: 0.4612397253513336
loss_pred:0.035965465009212494, decouple_loss:0.023518074303865433
The generated pressure mean: 0.45248943567276
loss_pred:0.035476185381412506, decouple_loss:0.023131219670176506
Iteration: 509, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4590718746185303
loss_pred:0.037631336599588394, decouple_loss:0.02244594134390354
The generated pressure mean: 0.45691922307014465
loss_pred:0.03895479440689087, decouple_loss:0.023341767489910126
The generated pressure mean: 0.4563106894493103
loss_pred:0.038441162556409836, decouple_loss:0.02268734760582447
Iteration: 510, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4304184019565582
loss_pred:0.03715472295880318, decouple_loss:0.022503288462758064
The generated pressure mean: 0.43795669078826904
loss_pred:0.03827904909849167, decouple_loss:0.022552339360117912
The generated pressure mean: 0.4293194115161896
loss_pred:0.03831484913825989, decouple_loss:0.023940809071063995
2023-04-16 14:14:29 testing...
The generated pressure mean: 0.41808342933654785
The generated pressure mean: 0.4220205247402191
The generated pressure mean: 0.4241696000099182
loss_pred:0.04676207900047302, decouple_loss:0.021308351308107376
loss_pred:0.04535982012748718, decouple_loss:0.021841276437044144
loss_pred:0.04452633112668991, decouple_loss:0.02175382524728775
WV_0_PC_0_EH_1_PS_40, loss: 0.046631135046482086, avg_mse: 0.05429142713546753
current test mse: 0.054291
Iteration: 511, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4435628056526184
The generated pressure mean: 0.4463300406932831
loss_pred:0.0384419783949852, decouple_loss:0.020463917404413223
loss_pred:0.03769838437438011, decouple_loss:0.021082060411572456
The generated pressure mean: 0.4514038562774658
loss_pred:0.03684885799884796, decouple_loss:0.020527884364128113
Iteration: 512, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46004384756088257
loss_pred:0.037645213305950165, decouple_loss:0.02318432927131653
The generated pressure mean: 0.4591182470321655
loss_pred:0.03713327646255493, decouple_loss:0.022517049685120583
The generated pressure mean: 0.45701637864112854
loss_pred:0.036553945392370224, decouple_loss:0.02284463308751583
Iteration: 513, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4408070743083954
The generated pressure mean: 0.44419655203819275
loss_pred:0.03713320940732956, decouple_loss:0.021177755668759346
loss_pred:0.039067190140485764, decouple_loss:0.02086619846522808
The generated pressure mean: 0.4459449052810669
loss_pred:0.037089888006448746, decouple_loss:0.02089964970946312
Iteration: 514, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43767666816711426
The generated pressure mean: 0.43793565034866333
loss_pred:0.03628072887659073, decouple_loss:0.022146666422486305
loss_pred:0.03750021383166313, decouple_loss:0.022787904366850853
The generated pressure mean: 0.44228437542915344
loss_pred:0.0377727746963501, decouple_loss:0.023097757250070572
Iteration: 515, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4605821669101715
The generated pressure mean: 0.4635852575302124
loss_pred:0.03580153360962868, decouple_loss:0.02185922861099243
loss_pred:0.036678582429885864, decouple_loss:0.021656809374690056
The generated pressure mean: 0.4611959755420685
loss_pred:0.036566972732543945, decouple_loss:0.022425148636102676
Iteration: 516, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442726969718933
loss_pred:0.037064988166093826, decouple_loss:0.021506575867533684
The generated pressure mean: 0.4439087212085724
The generated pressure mean: 0.4546552896499634
loss_pred:0.03449701517820358, decouple_loss:0.021095873787999153
loss_pred:0.03649161383509636, decouple_loss:0.020899206399917603
Iteration: 517, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4350302219390869
loss_pred:0.03671769052743912, decouple_loss:0.019803868606686592
The generated pressure mean: 0.43960756063461304
loss_pred:0.03795361891388893, decouple_loss:0.020815495401620865
The generated pressure mean: 0.44328680634498596
loss_pred:0.03899788111448288, decouple_loss:0.020837493240833282
Iteration: 518, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4540068209171295
loss_pred:0.0359564833343029, decouple_loss:0.021669914945960045
The generated pressure mean: 0.4474099576473236
loss_pred:0.036028534173965454, decouple_loss:0.02138260193169117
The generated pressure mean: 0.4515359699726105
loss_pred:0.03601137176156044, decouple_loss:0.021067658439278603
Iteration: 519, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505288004875183
loss_pred:0.03938344866037369, decouple_loss:0.02039194479584694
The generated pressure mean: 0.452860951423645
loss_pred:0.0389183945953846, decouple_loss:0.02087104320526123
The generated pressure mean: 0.44705215096473694
loss_pred:0.03738434612751007, decouple_loss:0.020894931629300117
Iteration: 520, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44097015261650085
loss_pred:0.0379604808986187, decouple_loss:0.02131204679608345
The generated pressure mean: 0.4411679208278656
loss_pred:0.03732332959771156, decouple_loss:0.02097519300878048
The generated pressure mean: 0.44457757472991943
loss_pred:0.03760379180312157, decouple_loss:0.019796134904026985
2023-04-16 14:16:22 testing...
The generated pressure mean: 0.4180234670639038
The generated pressure mean: 0.41410359740257263
The generated pressure mean: 0.4204399287700653
loss_pred:0.046365734189748764, decouple_loss:0.025907479226589203
loss_pred:0.04800792038440704, decouple_loss:0.024903830140829086
loss_pred:0.04541323706507683, decouple_loss:0.025762014091014862
WV_0_PC_0_EH_1_PS_40, loss: 0.04787185415625572, avg_mse: 0.056024014949798584
current test mse: 0.056024
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 521, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46293026208877563
loss_pred:0.03783433884382248, decouple_loss:0.023417694494128227
The generated pressure mean: 0.4643682837486267
loss_pred:0.03953469172120094, decouple_loss:0.023857470601797104
The generated pressure mean: 0.4584902226924896
loss_pred:0.03829837962985039, decouple_loss:0.023944946005940437
Iteration: 522, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4441458582878113
loss_pred:0.037412889301776886, decouple_loss:0.023923497647047043
The generated pressure mean: 0.4480744004249573
loss_pred:0.03689882531762123, decouple_loss:0.023648325353860855
The generated pressure mean: 0.4451340138912201
loss_pred:0.036190539598464966, decouple_loss:0.023685084655880928
Iteration: 523, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4420379400253296
loss_pred:0.037388693541288376, decouple_loss:0.02259884402155876
The generated pressure mean: 0.43945741653442383
loss_pred:0.03762254863977432, decouple_loss:0.0222527626901865
The generated pressure mean: 0.44253137707710266
loss_pred:0.037219543009996414, decouple_loss:0.022100046277046204
Iteration: 524, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4541250765323639
loss_pred:0.03953215479850769, decouple_loss:0.02198881283402443
The generated pressure mean: 0.45893433690071106
loss_pred:0.038982633501291275, decouple_loss:0.021983962506055832
The generated pressure mean: 0.4486148953437805
loss_pred:0.03640264645218849, decouple_loss:0.021517438814044
Iteration: 525, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45562177896499634
loss_pred:0.037459596991539, decouple_loss:0.022559119388461113
The generated pressure mean: 0.45659586787223816
loss_pred:0.035972960293293, decouple_loss:0.022200699895620346
The generated pressure mean: 0.4475701153278351
loss_pred:0.039605800062417984, decouple_loss:0.022577857598662376
Iteration: 526, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.40832817554473877
loss_pred:0.04180767759680748, decouple_loss:0.02263309806585312
The generated pressure mean: 0.4067160189151764
loss_pred:0.03953200951218605, decouple_loss:0.02259300835430622
The generated pressure mean: 0.40344539284706116
loss_pred:0.036661844700574875, decouple_loss:0.022642139345407486
Iteration: 527, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.49596771597862244
loss_pred:0.03672479838132858, decouple_loss:0.021489271894097328
The generated pressure mean: 0.49796637892723083
loss_pred:0.0385410375893116, decouple_loss:0.021506626158952713
The generated pressure mean: 0.5028087496757507
loss_pred:0.03967396914958954, decouple_loss:0.021422123536467552
Iteration: 528, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42168185114860535
loss_pred:0.03545870631933212, decouple_loss:0.020794246345758438
The generated pressure mean: 0.42529478669166565
The generated pressure mean: 0.42803865671157837loss_pred:0.037397291511297226, decouple_loss:0.021035131067037582
loss_pred:0.0378023125231266, decouple_loss:0.02092382125556469
Iteration: 529, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.424497127532959
loss_pred:0.03770638257265091, decouple_loss:0.021026678383350372
The generated pressure mean: 0.4207839369773865
loss_pred:0.03637605533003807, decouple_loss:0.020920701324939728
The generated pressure mean: 0.42494940757751465
loss_pred:0.03894350677728653, decouple_loss:0.021025491878390312
Iteration: 530, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4720573127269745
loss_pred:0.038712047040462494, decouple_loss:0.01956162229180336
The generated pressure mean: 0.47098255157470703
loss_pred:0.03643012046813965, decouple_loss:0.019563810899853706
The generated pressure mean: 0.47215479612350464
loss_pred:0.03872222080826759, decouple_loss:0.02015145681798458
2023-04-16 14:18:55 testing...
The generated pressure mean: 0.412004679441452
The generated pressure mean: 0.4153555929660797
The generated pressure mean: 0.417151540517807
loss_pred:0.04697025567293167, decouple_loss:0.0227059219032526
loss_pred:0.04586261138319969, decouple_loss:0.02353857085108757
loss_pred:0.04499160125851631, decouple_loss:0.023447023704648018
WV_0_PC_0_EH_1_PS_40, loss: 0.04710301756858826, avg_mse: 0.05459548160433769
current test mse: 0.054595
Iteration: 531, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46001216769218445
loss_pred:0.038791824132204056, decouple_loss:0.022827325388789177
The generated pressure mean: 0.4654208719730377
loss_pred:0.03984861448407173, decouple_loss:0.022580090910196304
The generated pressure mean: 0.4601696729660034
loss_pred:0.035495173186063766, decouple_loss:0.02279072068631649
Iteration: 532, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43107154965400696
loss_pred:0.03668920695781708, decouple_loss:0.021044310182332993
The generated pressure mean: 0.43386492133140564
loss_pred:0.03717295080423355, decouple_loss:0.020724546164274216
The generated pressure mean: 0.43084314465522766
loss_pred:0.036854568868875504, decouple_loss:0.021063806489109993
Iteration: 533, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44486990571022034
loss_pred:0.037115175276994705, decouple_loss:0.023352479562163353
The generated pressure mean: 0.44480812549591064
loss_pred:0.03690144047141075, decouple_loss:0.023123841732740402
The generated pressure mean: 0.44230514764785767
loss_pred:0.038964252918958664, decouple_loss:0.023152807727456093
Iteration: 534, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4566141366958618
loss_pred:0.03849819675087929, decouple_loss:0.022760583087801933
The generated pressure mean: 0.4623207747936249
loss_pred:0.038895364850759506, decouple_loss:0.02309415116906166
The generated pressure mean: 0.46067070960998535
loss_pred:0.0384787991642952, decouple_loss:0.023129254579544067
Iteration: 535, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44403210282325745
loss_pred:0.03840966895222664, decouple_loss:0.023710791021585464
The generated pressure mean: 0.44332990050315857
The generated pressure mean: 0.44660598039627075loss_pred:0.038256172090768814, decouple_loss:0.023898489773273468
loss_pred:0.037772078067064285, decouple_loss:0.02410619705915451
Iteration: 536, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4391802251338959
loss_pred:0.03700191155076027, decouple_loss:0.022210830822587013
The generated pressure mean: 0.4392825961112976
loss_pred:0.03856410086154938, decouple_loss:0.02333722449839115
The generated pressure mean: 0.43551552295684814
loss_pred:0.03636646643280983, decouple_loss:0.022294556722044945
Iteration: 537, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4558347761631012
loss_pred:0.03904515504837036, decouple_loss:0.02465924806892872
The generated pressure mean: 0.4532875120639801
loss_pred:0.03825627267360687, decouple_loss:0.025082359090447426
The generated pressure mean: 0.45378416776657104
loss_pred:0.03661375120282173, decouple_loss:0.02473839558660984
Iteration: 538, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44583097100257874
loss_pred:0.03849228098988533, decouple_loss:0.021290501579642296
The generated pressure mean: 0.44700759649276733
loss_pred:0.036939315497875214, decouple_loss:0.02126147970557213
The generated pressure mean: 0.44755661487579346
loss_pred:0.03793587535619736, decouple_loss:0.021389618515968323
Iteration: 539, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4447570741176605
loss_pred:0.036139968782663345, decouple_loss:0.023101849481463432
The generated pressure mean: 0.44298112392425537
The generated pressure mean: 0.44139012694358826
loss_pred:0.03720991685986519, decouple_loss:0.022973429411649704
loss_pred:0.03928301855921745, decouple_loss:0.02343418076634407
Iteration: 540, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44975385069847107
loss_pred:0.03583984076976776, decouple_loss:0.021364958956837654
The generated pressure mean: 0.44960135221481323
The generated pressure mean: 0.4500880241394043
loss_pred:0.03780408203601837, decouple_loss:0.022160271182656288
loss_pred:0.03694946691393852, decouple_loss:0.021547608077526093
2023-04-16 14:20:48 testing...
The generated pressure mean: 0.4157222807407379
The generated pressure mean: 0.41978588700294495
The generated pressure mean: 0.42172971367836
loss_pred:0.04529106616973877, decouple_loss:0.023795999586582184
loss_pred:0.04430777207016945, decouple_loss:0.024874325841665268
loss_pred:0.043518997728824615, decouple_loss:0.024960435926914215
WV_0_PC_0_EH_1_PS_40, loss: 0.0455997958779335, avg_mse: 0.05232778191566467
current test mse: 0.052328
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 541, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45222947001457214
loss_pred:0.03815862163901329, decouple_loss:0.021953817456960678
The generated pressure mean: 0.45102426409721375
loss_pred:0.03832554444670677, decouple_loss:0.02263183519244194
The generated pressure mean: 0.4499770402908325
loss_pred:0.03674371913075447, decouple_loss:0.022644301876425743
Iteration: 542, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4417456090450287
loss_pred:0.0380224734544754, decouple_loss:0.022092118859291077
The generated pressure mean: 0.4465683400630951
loss_pred:0.036584991961717606, decouple_loss:0.021811803802847862
The generated pressure mean: 0.4420560598373413
loss_pred:0.03747445344924927, decouple_loss:0.021844597533345222
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 543, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442616403102875
loss_pred:0.03722645714879036, decouple_loss:0.022569183260202408
The generated pressure mean: 0.44497719407081604
loss_pred:0.03791917860507965, decouple_loss:0.02322959341108799
The generated pressure mean: 0.4450105130672455
loss_pred:0.03627261519432068, decouple_loss:0.022480208426713943
Iteration: 544, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503380358219147
loss_pred:0.03814937546849251, decouple_loss:0.021488996222615242
The generated pressure mean: 0.4510711431503296
loss_pred:0.03642512112855911, decouple_loss:0.02179519645869732
The generated pressure mean: 0.45267024636268616
loss_pred:0.03744298592209816, decouple_loss:0.021828310564160347
Iteration: 545, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45015016198158264
loss_pred:0.03746024891734123, decouple_loss:0.02079332061111927
The generated pressure mean: 0.4492872357368469
loss_pred:0.036777373403310776, decouple_loss:0.02130289189517498
The generated pressure mean: 0.4518573582172394
loss_pred:0.03678315505385399, decouple_loss:0.021241001784801483
Iteration: 546, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4350811541080475
loss_pred:0.0366891585290432, decouple_loss:0.023279502987861633
The generated pressure mean: 0.4392428696155548
loss_pred:0.037919074296951294, decouple_loss:0.023558178916573524
The generated pressure mean: 0.43927961587905884
loss_pred:0.035864297300577164, decouple_loss:0.02303284779191017
Iteration: 547, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4424830973148346
loss_pred:0.0371539331972599, decouple_loss:0.021423030644655228
The generated pressure mean: 0.44170743227005005
loss_pred:0.03663770481944084, decouple_loss:0.021070118993520737
The generated pressure mean: 0.4457954168319702
loss_pred:0.03709263727068901, decouple_loss:0.021038217470049858
Iteration: 548, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4538400173187256
loss_pred:0.03661860153079033, decouple_loss:0.021601859480142593
The generated pressure mean: 0.4524760842323303
loss_pred:0.035847071558237076, decouple_loss:0.021402671933174133
The generated pressure mean: 0.4547922611236572
loss_pred:0.03652259334921837, decouple_loss:0.021076342090964317
Iteration: 549, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.452459454536438
loss_pred:0.036095112562179565, decouple_loss:0.021729202941060066
The generated pressure mean: 0.4516003429889679The generated pressure mean: 0.44546374678611755
loss_pred:0.037162162363529205, decouple_loss:0.021387970075011253
loss_pred:0.035885363817214966, decouple_loss:0.021139081567525864
Iteration: 550, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4389335513114929
loss_pred:0.036986544728279114, decouple_loss:0.019872134551405907
The generated pressure mean: 0.4398614168167114
loss_pred:0.03747785836458206, decouple_loss:0.019917814061045647
The generated pressure mean: 0.4382919669151306
loss_pred:0.03672954440116882, decouple_loss:0.02005554363131523
2023-04-16 14:23:22 testing...
The generated pressure mean: 0.41846734285354614
The generated pressure mean: 0.4224885404109955
loss_pred:0.044064972549676895, decouple_loss:0.022998111322522163
The generated pressure mean: 0.42451244592666626
loss_pred:0.04333686828613281, decouple_loss:0.02428138442337513
loss_pred:0.04255473241209984, decouple_loss:0.024249235168099403
WV_0_PC_0_EH_1_PS_40, loss: 0.04451100528240204, avg_mse: 0.05094645544886589
current test mse: 0.050946
Iteration: 551, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.445767343044281
loss_pred:0.03790372610092163, decouple_loss:0.02076701819896698
The generated pressure mean: 0.4468722939491272
loss_pred:0.03558974713087082, decouple_loss:0.020639825612306595
The generated pressure mean: 0.44582176208496094
loss_pred:0.03706131875514984, decouple_loss:0.020468682050704956
Iteration: 552, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45460590720176697
loss_pred:0.037246156483888626, decouple_loss:0.01905609853565693
The generated pressure mean: 0.4556373357772827
loss_pred:0.03513375297188759, decouple_loss:0.01845729909837246
The generated pressure mean: 0.45388466119766235
loss_pred:0.03498609736561775, decouple_loss:0.018844589591026306
Iteration: 553, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464741051197052
loss_pred:0.03531630337238312, decouple_loss:0.019446423277258873
The generated pressure mean: 0.4529789090156555
loss_pred:0.035139914602041245, decouple_loss:0.019448785111308098
The generated pressure mean: 0.4510093033313751
loss_pred:0.03699324280023575, decouple_loss:0.01960396207869053
Iteration: 554, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4347858428955078
loss_pred:0.03659633919596672, decouple_loss:0.018181215971708298
The generated pressure mean: 0.44122111797332764
loss_pred:0.036334455013275146, decouple_loss:0.017996447160840034
The generated pressure mean: 0.4415307343006134
loss_pred:0.037066299468278885, decouple_loss:0.01768372394144535
Iteration: 555, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4378824532032013
loss_pred:0.0363224633038044, decouple_loss:0.01813459023833275
The generated pressure mean: 0.4392106831073761
loss_pred:0.03607990965247154, decouple_loss:0.01865524798631668
The generated pressure mean: 0.442121684551239
loss_pred:0.0354406014084816, decouple_loss:0.018331604078412056
Iteration: 556, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46431800723075867
loss_pred:0.03512367606163025, decouple_loss:0.017747029662132263
The generated pressure mean: 0.46688154339790344
loss_pred:0.03574807941913605, decouple_loss:0.01769854687154293
The generated pressure mean: 0.4645117223262787
loss_pred:0.037982501089572906, decouple_loss:0.018483059480786324
Iteration: 557, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4328034818172455
loss_pred:0.03561676666140556, decouple_loss:0.017539208754897118
The generated pressure mean: 0.4398449957370758
loss_pred:0.03583904728293419, decouple_loss:0.018405603244900703
The generated pressure mean: 0.43842077255249023
loss_pred:0.03662734851241112, decouple_loss:0.017376363277435303
Iteration: 558, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4368692636489868
The generated pressure mean: 0.44041356444358826
loss_pred:0.03585318475961685, decouple_loss:0.016751611605286598
loss_pred:0.03622222691774368, decouple_loss:0.017090335488319397
The generated pressure mean: 0.4376998245716095
loss_pred:0.03530967980623245, decouple_loss:0.016506092622876167
Iteration: 559, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4644010365009308
loss_pred:0.03544561564922333, decouple_loss:0.019044484943151474
The generated pressure mean: 0.46834972500801086
loss_pred:0.03589870408177376, decouple_loss:0.018301673233509064
The generated pressure mean: 0.4650326371192932
loss_pred:0.035631582140922546, decouple_loss:0.01828605681657791
Iteration: 560, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44773364067077637
The generated pressure mean: 0.4435022473335266
loss_pred:0.036503780633211136, decouple_loss:0.016512330621480942
loss_pred:0.03599635139107704, decouple_loss:0.016925565898418427
The generated pressure mean: 0.4446699619293213
loss_pred:0.03599664196372032, decouple_loss:0.017148800194263458
2023-04-16 14:25:15 testing...
The generated pressure mean: 0.4228135645389557
The generated pressure mean: 0.42670613527297974
loss_pred:0.043516188859939575, decouple_loss:0.01838897354900837
The generated pressure mean: 0.4287738800048828
loss_pred:0.04241308197379112, decouple_loss:0.019498907029628754
loss_pred:0.042114581912755966, decouple_loss:0.019479108974337578
WV_0_PC_0_EH_1_PS_40, loss: 0.04363740235567093, avg_mse: 0.05045037344098091
current test mse: 0.05045
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 561, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43396270275115967
loss_pred:0.035092853009700775, decouple_loss:0.01688065193593502
The generated pressure mean: 0.429347425699234
loss_pred:0.03879250958561897, decouple_loss:0.017072172835469246
The generated pressure mean: 0.43226516246795654
loss_pred:0.039346594363451004, decouple_loss:0.01675949990749359
Iteration: 562, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46332091093063354
loss_pred:0.03721972927451134, decouple_loss:0.01600644923746586
The generated pressure mean: 0.4631956219673157
loss_pred:0.03668883815407753, decouple_loss:0.017023803666234016
The generated pressure mean: 0.45821723341941833
loss_pred:0.03804568201303482, decouple_loss:0.01610899344086647
Iteration: 563, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44174039363861084
loss_pred:0.03512071073055267, decouple_loss:0.017664987593889236
The generated pressure mean: 0.43970951437950134
loss_pred:0.03715701401233673, decouple_loss:0.01810595393180847
The generated pressure mean: 0.4401944875717163
loss_pred:0.035167183727025986, decouple_loss:0.01834203116595745
Iteration: 564, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481548070907593
loss_pred:0.03724748268723488, decouple_loss:0.01759096421301365
The generated pressure mean: 0.4492062032222748
loss_pred:0.036928851157426834, decouple_loss:0.01724236086010933
The generated pressure mean: 0.4392850399017334
loss_pred:0.036662790924310684, decouple_loss:0.017635129392147064
Iteration: 565, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487866163253784
loss_pred:0.03798883408308029, decouple_loss:0.017109908163547516
The generated pressure mean: 0.44879016280174255
loss_pred:0.038923002779483795, decouple_loss:0.017494816333055496
The generated pressure mean: 0.448387086391449
loss_pred:0.03550979867577553, decouple_loss:0.01702730357646942
Iteration: 566, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43850573897361755
loss_pred:0.03692663833498955, decouple_loss:0.01793614588677883
The generated pressure mean: 0.4410363435745239
loss_pred:0.03566037490963936, decouple_loss:0.01767522469162941
The generated pressure mean: 0.44557419419288635
loss_pred:0.034440990537405014, decouple_loss:0.017834855243563652
Iteration: 567, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4445793330669403
loss_pred:0.035800568759441376, decouple_loss:0.017294371500611305
The generated pressure mean: 0.44558578729629517
The generated pressure mean: 0.4488671123981476
loss_pred:0.033979643136262894, decouple_loss:0.017242012545466423
loss_pred:0.03657029569149017, decouple_loss:0.017550259828567505
Iteration: 568, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4610195457935333
loss_pred:0.03727784380316734, decouple_loss:0.01786191575229168
The generated pressure mean: 0.4613197147846222
loss_pred:0.034869205206632614, decouple_loss:0.017522195354104042
The generated pressure mean: 0.45832234621047974
loss_pred:0.037531185895204544, decouple_loss:0.017148060724139214
Iteration: 569, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44055935740470886
The generated pressure mean: 0.439353346824646
loss_pred:0.034304242581129074, decouple_loss:0.01754358410835266
loss_pred:0.037105511873960495, decouple_loss:0.017931615933775902
The generated pressure mean: 0.4392123222351074
loss_pred:0.03782424330711365, decouple_loss:0.017483070492744446
Iteration: 570, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44319331645965576
loss_pred:0.03730117157101631, decouple_loss:0.019264044240117073
The generated pressure mean: 0.44628652930259705
loss_pred:0.036810796707868576, decouple_loss:0.018326103687286377
The generated pressure mean: 0.44876232743263245
loss_pred:0.036524221301078796, decouple_loss:0.018611211329698563
2023-04-16 14:27:48 testing...
The generated pressure mean: 0.4191599488258362
The generated pressure mean: 0.4231169819831848
The generated pressure mean: 0.4252859354019165
loss_pred:0.0435795821249485, decouple_loss:0.01987609453499317
loss_pred:0.042842742055654526, decouple_loss:0.021018199622631073
loss_pred:0.04186161980032921, decouple_loss:0.02093094401061535
WV_0_PC_0_EH_1_PS_40, loss: 0.04379173368215561, avg_mse: 0.0509447306394577
current test mse: 0.050945
Iteration: 571, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45194175839424133
loss_pred:0.03804594650864601, decouple_loss:0.01850109174847603
The generated pressure mean: 0.44746294617652893
loss_pred:0.03691753000020981, decouple_loss:0.018173586577177048
The generated pressure mean: 0.44865626096725464
loss_pred:0.03660167008638382, decouple_loss:0.018467891961336136
Iteration: 572, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4436173737049103
loss_pred:0.03621717169880867, decouple_loss:0.017326707020401955
The generated pressure mean: 0.44358837604522705
loss_pred:0.036312952637672424, decouple_loss:0.01740754395723343
The generated pressure mean: 0.4437902271747589
loss_pred:0.036890145391225815, decouple_loss:0.017674898728728294
Iteration: 573, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4572499692440033The generated pressure mean: 0.4496094584465027
loss_pred:0.03736824169754982, decouple_loss:0.01763717457652092
loss_pred:0.03547919541597366, decouple_loss:0.01764041930437088
The generated pressure mean: 0.4581303000450134
loss_pred:0.036134976893663406, decouple_loss:0.0175973791629076
Iteration: 574, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4428868293762207
The generated pressure mean: 0.44212374091148376
loss_pred:0.03564968332648277, decouple_loss:0.01924487017095089
loss_pred:0.03599414601922035, decouple_loss:0.018739931285381317
The generated pressure mean: 0.44374746084213257
loss_pred:0.037696536630392075, decouple_loss:0.018634827807545662
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 575, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447782963514328The generated pressure mean: 0.4453972578048706
loss_pred:0.037461161613464355, decouple_loss:0.017699966207146645loss_pred:0.03709200769662857, decouple_loss:0.017687497660517693
The generated pressure mean: 0.4484863579273224
loss_pred:0.035473037511110306, decouple_loss:0.01766159199178219
Iteration: 576, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4440142512321472
The generated pressure mean: 0.442553848028183
loss_pred:0.0355362743139267, decouple_loss:0.016052667051553726
loss_pred:0.03477637097239494, decouple_loss:0.01678638905286789
The generated pressure mean: 0.44377079606056213
loss_pred:0.033897582441568375, decouple_loss:0.016229115426540375
Iteration: 577, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4557073414325714
The generated pressure mean: 0.4562532603740692
loss_pred:0.03460441157221794, decouple_loss:0.017209922894835472
loss_pred:0.0346502959728241, decouple_loss:0.017082499340176582
The generated pressure mean: 0.4544764757156372
loss_pred:0.036198172718286514, decouple_loss:0.017261167988181114
Iteration: 578, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43329933285713196
loss_pred:0.03461523726582527, decouple_loss:0.017383849248290062
The generated pressure mean: 0.4363500475883484
loss_pred:0.03719250112771988, decouple_loss:0.0174571480602026
The generated pressure mean: 0.43225523829460144
loss_pred:0.03782806172966957, decouple_loss:0.017256848514080048
Iteration: 579, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503266215324402
loss_pred:0.036270346492528915, decouple_loss:0.019540933892130852
The generated pressure mean: 0.4550038278102875
loss_pred:0.03761725872755051, decouple_loss:0.019974838942289352
The generated pressure mean: 0.4600428640842438
loss_pred:0.03805675357580185, decouple_loss:0.019462736323475838
Iteration: 580, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44349563121795654
loss_pred:0.035625431686639786, decouple_loss:0.02078675664961338
The generated pressure mean: 0.44811540842056274
loss_pred:0.036856163293123245, decouple_loss:0.02169438637793064
The generated pressure mean: 0.44385242462158203
loss_pred:0.03756380081176758, decouple_loss:0.020588573068380356
2023-04-16 14:29:41 testing...
The generated pressure mean: 0.42155149579048157
The generated pressure mean: 0.4175846576690674
The generated pressure mean: 0.4233522117137909
loss_pred:0.0426168218255043, decouple_loss:0.02090335264801979
loss_pred:0.043439220637083054, decouple_loss:0.019809631630778313
loss_pred:0.04195354878902435, decouple_loss:0.020998897030949593
WV_0_PC_0_EH_1_PS_40, loss: 0.04369839280843735, avg_mse: 0.0509314090013504
current test mse: 0.050931
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 581, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504104554653168
loss_pred:0.03593021631240845, decouple_loss:0.01859099417924881
The generated pressure mean: 0.4522772431373596
The generated pressure mean: 0.4479145407676697
loss_pred:0.038058530539274216, decouple_loss:0.018298683688044548
loss_pred:0.0360734760761261, decouple_loss:0.018480466678738594
Iteration: 582, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44648897647857666
loss_pred:0.034116629511117935, decouple_loss:0.020867707207798958
The generated pressure mean: 0.4473050534725189
loss_pred:0.036408763378858566, decouple_loss:0.01982276141643524
The generated pressure mean: 0.4452402889728546
loss_pred:0.03622135892510414, decouple_loss:0.019900325685739517
Iteration: 583, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4552905857563019
The generated pressure mean: 0.45498424768447876
loss_pred:0.03717431053519249, decouple_loss:0.02040349505841732
loss_pred:0.03496300429105759, decouple_loss:0.02089458703994751
The generated pressure mean: 0.4483828842639923
loss_pred:0.035365670919418335, decouple_loss:0.02070779725909233
Iteration: 584, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4446973502635956
loss_pred:0.0361984446644783, decouple_loss:0.019380316138267517
The generated pressure mean: 0.44749221205711365
loss_pred:0.034971050918102264, decouple_loss:0.019256949424743652
The generated pressure mean: 0.448548823595047
loss_pred:0.03390562906861305, decouple_loss:0.019468970596790314
Iteration: 585, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4336514174938202
loss_pred:0.03526771441102028, decouple_loss:0.020650846883654594
The generated pressure mean: 0.4311509430408478
loss_pred:0.03696522116661072, decouple_loss:0.020693166181445122
The generated pressure mean: 0.4347074329853058
loss_pred:0.0359414704144001, decouple_loss:0.02002943493425846
Iteration: 586, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4672527313232422
loss_pred:0.03534329682588577, decouple_loss:0.0200332198292017
The generated pressure mean: 0.461275577545166
loss_pred:0.03482687100768089, decouple_loss:0.019521327689290047
The generated pressure mean: 0.46801137924194336
loss_pred:0.03587155044078827, decouple_loss:0.02009507082402706
Iteration: 587, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44260090589523315
loss_pred:0.03553983196616173, decouple_loss:0.018352417275309563
The generated pressure mean: 0.4452783763408661
loss_pred:0.03381721302866936, decouple_loss:0.019236518070101738
The generated pressure mean: 0.4465692341327667
loss_pred:0.03492043912410736, decouple_loss:0.019075075164437294
Iteration: 588, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.431598424911499
loss_pred:0.03504560515284538, decouple_loss:0.01958875171840191
The generated pressure mean: 0.4304307699203491
loss_pred:0.03667861968278885, decouple_loss:0.01986854337155819
The generated pressure mean: 0.4367762506008148
loss_pred:0.03398287296295166, decouple_loss:0.019658561795949936
Iteration: 589, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46361243724823
loss_pred:0.03515109792351723, decouple_loss:0.018613915890455246
The generated pressure mean: 0.4655340611934662
loss_pred:0.035253867506980896, decouple_loss:0.018760260194540024
The generated pressure mean: 0.4697161614894867
loss_pred:0.03558763116598129, decouple_loss:0.018711546435952187
Iteration: 590, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4405544102191925
loss_pred:0.03627081587910652, decouple_loss:0.019931809976696968
The generated pressure mean: 0.4444600045681
loss_pred:0.03539609909057617, decouple_loss:0.01941162720322609
The generated pressure mean: 0.44029906392097473
loss_pred:0.03477049246430397, decouple_loss:0.019486701115965843
2023-04-16 14:32:16 testing...
The generated pressure mean: 0.4221705198287964
The generated pressure mean: 0.42650148272514343
loss_pred:0.04288196563720703, decouple_loss:0.020538078621029854
The generated pressure mean: 0.4284118711948395
loss_pred:0.04178943112492561, decouple_loss:0.0216726902872324
loss_pred:0.04111456498503685, decouple_loss:0.021648144349455833
WV_0_PC_0_EH_1_PS_40, loss: 0.0429929718375206, avg_mse: 0.0499676913022995
current test mse: 0.049968
Iteration: 591, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44345375895500183
The generated pressure mean: 0.4369884431362152
loss_pred:0.03741103410720825, decouple_loss:0.020031791180372238
loss_pred:0.03430864214897156, decouple_loss:0.01926935277879238
The generated pressure mean: 0.4437895715236664
loss_pred:0.03576821833848953, decouple_loss:0.019803838804364204
Iteration: 592, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46264809370040894
loss_pred:0.03636469691991806, decouple_loss:0.019668690860271454
The generated pressure mean: 0.4598006308078766
loss_pred:0.03554636612534523, decouple_loss:0.02045213058590889
The generated pressure mean: 0.46091321110725403
loss_pred:0.03481058403849602, decouple_loss:0.020506760105490685
Iteration: 593, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.41844427585601807
loss_pred:0.036107826977968216, decouple_loss:0.019433066248893738
The generated pressure mean: 0.41381514072418213
loss_pred:0.03674428164958954, decouple_loss:0.019761988893151283
The generated pressure mean: 0.4148968458175659
loss_pred:0.035378653556108475, decouple_loss:0.019927028566598892
Iteration: 594, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4697350859642029
loss_pred:0.03577198088169098, decouple_loss:0.02154790610074997
The generated pressure mean: 0.4707867205142975
loss_pred:0.03422311320900917, decouple_loss:0.022481204941868782
The generated pressure mean: 0.4709731936454773
loss_pred:0.033860839903354645, decouple_loss:0.022648170590400696
Iteration: 595, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46006742119789124
loss_pred:0.0341847687959671, decouple_loss:0.018898766487836838
The generated pressure mean: 0.46282610297203064
loss_pred:0.033136963844299316, decouple_loss:0.01862785778939724
The generated pressure mean: 0.4613555371761322
loss_pred:0.03610369563102722, decouple_loss:0.01867000013589859
Iteration: 596, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4220470190048218
loss_pred:0.03591884672641754, decouple_loss:0.022283414378762245
The generated pressure mean: 0.4207000732421875
loss_pred:0.036490779370069504, decouple_loss:0.022443220019340515
The generated pressure mean: 0.4227484464645386
loss_pred:0.035379622131586075, decouple_loss:0.022486375644803047
Iteration: 597, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46633803844451904
loss_pred:0.0348595455288887, decouple_loss:0.018633564934134483
The generated pressure mean: 0.46807995438575745
loss_pred:0.03470427542924881, decouple_loss:0.018908748403191566
The generated pressure mean: 0.47414615750312805
loss_pred:0.03464556857943535, decouple_loss:0.01885673590004444
Iteration: 598, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44091904163360596
The generated pressure mean: 0.43627867102622986
loss_pred:0.035868871957063675, decouple_loss:0.020307892933487892
loss_pred:0.036637771874666214, decouple_loss:0.02020852640271187
The generated pressure mean: 0.4376954734325409
loss_pred:0.03502291813492775, decouple_loss:0.02028525061905384
Iteration: 599, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44974538683891296
The generated pressure mean: 0.4508945941925049
loss_pred:0.034337256103754044, decouple_loss:0.019652247428894043
loss_pred:0.03371419757604599, decouple_loss:0.01954604685306549
The generated pressure mean: 0.4464614689350128
loss_pred:0.033628612756729126, decouple_loss:0.019734777510166168
Iteration: 600, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4538397192955017
loss_pred:0.03459630534052849, decouple_loss:0.021563300862908363
The generated pressure mean: 0.4562220275402069
loss_pred:0.03473043441772461, decouple_loss:0.021791011095046997
The generated pressure mean: 0.4527745544910431
loss_pred:0.0347566120326519, decouple_loss:0.02230243943631649
2023-04-16 14:34:09 testing...
The generated pressure mean: 0.42182639241218567
The generated pressure mean: 0.4259958267211914
The generated pressure mean: 0.42793288826942444
loss_pred:0.04238468036055565, decouple_loss:0.02095901034772396
loss_pred:0.04151540994644165, decouple_loss:0.0217508003115654
loss_pred:0.04088697209954262, decouple_loss:0.021802091971039772
WV_0_PC_0_EH_1_PS_40, loss: 0.04267088696360588, avg_mse: 0.049517642706632614
current test mse: 0.049518
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 601, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43365412950515747
loss_pred:0.035548560321331024, decouple_loss:0.02080218493938446
The generated pressure mean: 0.4308561384677887
loss_pred:0.03547180816531181, decouple_loss:0.019685566425323486
The generated pressure mean: 0.435235857963562
loss_pred:0.03463547304272652, decouple_loss:0.02051958069205284
Iteration: 602, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44757840037345886The generated pressure mean: 0.4530209004878998
loss_pred:0.03484175354242325, decouple_loss:0.022222569212317467
loss_pred:0.03431617468595505, decouple_loss:0.02254120260477066
The generated pressure mean: 0.44982844591140747
loss_pred:0.03552655130624771, decouple_loss:0.02269808202981949
Iteration: 603, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4541563093662262
The generated pressure mean: 0.45703384280204773
loss_pred:0.034871332347393036, decouple_loss:0.019594963639974594
loss_pred:0.035913217812776566, decouple_loss:0.01976952888071537
The generated pressure mean: 0.46028393507003784
loss_pred:0.035598427057266235, decouple_loss:0.019896602258086205
Iteration: 604, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.432646244764328
loss_pred:0.035269223153591156, decouple_loss:0.020823145285248756
The generated pressure mean: 0.43574339151382446
loss_pred:0.034828320145606995, decouple_loss:0.02062397263944149
The generated pressure mean: 0.4292933940887451
loss_pred:0.036494363099336624, decouple_loss:0.02113945037126541
Iteration: 605, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44501808285713196
The generated pressure mean: 0.44137290120124817
loss_pred:0.03487296402454376, decouple_loss:0.01982743851840496
loss_pred:0.034072145819664, decouple_loss:0.019038407132029533
The generated pressure mean: 0.447686105966568
loss_pred:0.035248998552560806, decouple_loss:0.019304681569337845
Iteration: 606, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4610176384449005
The generated pressure mean: 0.4618093967437744
loss_pred:0.03402887284755707, decouple_loss:0.01974189281463623
loss_pred:0.03502000868320465, decouple_loss:0.019279107451438904
The generated pressure mean: 0.4595857262611389
loss_pred:0.03488411754369736, decouple_loss:0.019856203347444534
Iteration: 607, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44389835000038147
The generated pressure mean: 0.4510260820388794
loss_pred:0.03455442562699318, decouple_loss:0.019384168088436127
loss_pred:0.03399017080664635, decouple_loss:0.019251059740781784
The generated pressure mean: 0.44442427158355713
loss_pred:0.035072144120931625, decouple_loss:0.01939251832664013
Iteration: 608, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4357600510120392
The generated pressure mean: 0.4316156208515167
loss_pred:0.034655652940273285, decouple_loss:0.01812911406159401
loss_pred:0.03429200500249863, decouple_loss:0.018279477953910828
The generated pressure mean: 0.43860867619514465
loss_pred:0.03383807837963104, decouple_loss:0.018051747232675552
Iteration: 609, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44210201501846313
The generated pressure mean: 0.4400397837162018
loss_pred:0.03540371358394623, decouple_loss:0.02198520489037037
loss_pred:0.03405679762363434, decouple_loss:0.021993596106767654
The generated pressure mean: 0.43885016441345215
loss_pred:0.034184981137514114, decouple_loss:0.021657487377524376
Iteration: 610, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4613117575645447
The generated pressure mean: 0.460447758436203
loss_pred:0.034510593861341476, decouple_loss:0.01983710750937462
loss_pred:0.034434378147125244, decouple_loss:0.020158110186457634
The generated pressure mean: 0.4641467034816742
loss_pred:0.03549280762672424, decouple_loss:0.020432306453585625
2023-04-16 14:36:42 testing...
The generated pressure mean: 0.4204946756362915
The generated pressure mean: 0.425126850605011
The generated pressure mean: 0.4275716543197632
loss_pred:0.04210473224520683, decouple_loss:0.020862320438027382
loss_pred:0.04112749174237251, decouple_loss:0.021898161619901657loss_pred:0.040353771299123764, decouple_loss:0.02176278457045555
WV_0_PC_0_EH_1_PS_40, loss: 0.0422707200050354, avg_mse: 0.04929431900382042
current test mse: 0.049294
Iteration: 611, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495446979999542
loss_pred:0.032998282462358475, decouple_loss:0.01905803754925728
The generated pressure mean: 0.4440561830997467
loss_pred:0.033850397914648056, decouple_loss:0.019332867115736008
The generated pressure mean: 0.44648411870002747
loss_pred:0.03386808931827545, decouple_loss:0.01940968632698059
Iteration: 612, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43312859535217285
loss_pred:0.03517516329884529, decouple_loss:0.020449602976441383
The generated pressure mean: 0.4376864433288574
loss_pred:0.0337272472679615, decouple_loss:0.020591676235198975
The generated pressure mean: 0.43528130650520325
loss_pred:0.035331517457962036, decouple_loss:0.020332442596554756
Iteration: 613, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44876524806022644
loss_pred:0.035859547555446625, decouple_loss:0.020189959555864334
The generated pressure mean: 0.4490940272808075
loss_pred:0.032939083874225616, decouple_loss:0.019587719812989235
The generated pressure mean: 0.4509558081626892
loss_pred:0.03443329781293869, decouple_loss:0.020533954724669456
Iteration: 614, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44374287128448486
loss_pred:0.035273000597953796, decouple_loss:0.018077654764056206
The generated pressure mean: 0.44954919815063477
loss_pred:0.03378254920244217, decouple_loss:0.018740592524409294
The generated pressure mean: 0.44514861702919006
loss_pred:0.033864036202430725, decouple_loss:0.018347488716244698
Iteration: 615, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45176905393600464
loss_pred:0.034070368856191635, decouple_loss:0.01861921325325966
The generated pressure mean: 0.45730534195899963
loss_pred:0.03538583219051361, decouple_loss:0.01883840374648571
The generated pressure mean: 0.45472320914268494
loss_pred:0.03553025424480438, decouple_loss:0.018725167959928513
Iteration: 616, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44331786036491394
loss_pred:0.03289926424622536, decouple_loss:0.017862820997834206
The generated pressure mean: 0.44634419679641724
loss_pred:0.035513896495103836, decouple_loss:0.01786080189049244
The generated pressure mean: 0.4363791048526764
loss_pred:0.03434932976961136, decouple_loss:0.018471745774149895
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 617, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4387478828430176
loss_pred:0.03483046591281891, decouple_loss:0.01847538724541664
The generated pressure mean: 0.4457637667655945
loss_pred:0.03319532424211502, decouple_loss:0.018060356378555298
The generated pressure mean: 0.44153690338134766
loss_pred:0.0356580950319767, decouple_loss:0.019041357561945915
Iteration: 618, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4630858302116394
The generated pressure mean: 0.4531349837779999
loss_pred:0.03519139066338539, decouple_loss:0.019581854343414307
loss_pred:0.03587127849459648, decouple_loss:0.019038161262869835
The generated pressure mean: 0.4526742100715637
loss_pred:0.03577521815896034, decouple_loss:0.01903277263045311
Iteration: 619, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44104164838790894
loss_pred:0.034409716725349426, decouple_loss:0.018903611227869987
The generated pressure mean: 0.439569354057312
loss_pred:0.033551886677742004, decouple_loss:0.018109269440174103
The generated pressure mean: 0.43348827958106995
loss_pred:0.033922579139471054, decouple_loss:0.018081052228808403
Iteration: 620, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498539865016937The generated pressure mean: 0.45058637857437134
loss_pred:0.03394123539328575, decouple_loss:0.017946358770132065
loss_pred:0.03536628931760788, decouple_loss:0.018855299800634384
The generated pressure mean: 0.4479925334453583
loss_pred:0.03535858541727066, decouple_loss:0.018732767552137375
2023-04-16 14:38:36 testing...
The generated pressure mean: 0.42661887407302856
The generated pressure mean: 0.4222416579723358
loss_pred:0.04357917606830597, decouple_loss:0.020572306588292122
The generated pressure mean: 0.4290107190608978
loss_pred:0.04412253201007843, decouple_loss:0.01937064342200756
loss_pred:0.042794570326805115, decouple_loss:0.02067418582737446
WV_0_PC_0_EH_1_PS_40, loss: 0.04450904577970505, avg_mse: 0.053653549402952194
current test mse: 0.053654
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 621, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44232016801834106
loss_pred:0.03547485172748566, decouple_loss:0.018215715885162354
The generated pressure mean: 0.4464709758758545The generated pressure mean: 0.4488101899623871
loss_pred:0.03741121292114258, decouple_loss:0.01960578002035618
loss_pred:0.03550976142287254, decouple_loss:0.02062489651143551
Iteration: 622, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462146461009979
The generated pressure mean: 0.4442726671695709
loss_pred:0.034766048192977905, decouple_loss:0.019801180809736252
loss_pred:0.03544134646654129, decouple_loss:0.02009011059999466
The generated pressure mean: 0.4490431547164917
loss_pred:0.034808311611413956, decouple_loss:0.02034873515367508
Iteration: 623, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45489510893821716
The generated pressure mean: 0.4543946385383606
loss_pred:0.03617856279015541, decouple_loss:0.019754739478230476
loss_pred:0.033684711903333664, decouple_loss:0.01993989571928978
The generated pressure mean: 0.458839476108551
loss_pred:0.036669496446847916, decouple_loss:0.020196493715047836
Iteration: 624, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43827787041664124
loss_pred:0.03731774911284447, decouple_loss:0.020652644336223602
The generated pressure mean: 0.4310874938964844
loss_pred:0.034281712025403976, decouple_loss:0.020636841654777527
The generated pressure mean: 0.4288581311702728
loss_pred:0.03609943017363548, decouple_loss:0.020136671140789986
Iteration: 625, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44852128624916077
loss_pred:0.03561398759484291, decouple_loss:0.019798671826720238
The generated pressure mean: 0.45039311051368713
loss_pred:0.03534259274601936, decouple_loss:0.018047556281089783
The generated pressure mean: 0.448976993560791
loss_pred:0.03555562347173691, decouple_loss:0.019589759409427643
Iteration: 626, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45000341534614563
loss_pred:0.03598089888691902, decouple_loss:0.021184515208005905
The generated pressure mean: 0.4499087333679199
loss_pred:0.03457482531666756, decouple_loss:0.02106376923620701
The generated pressure mean: 0.4488590359687805
loss_pred:0.033959127962589264, decouple_loss:0.020990153774619102
Iteration: 627, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45666632056236267
loss_pred:0.03604697436094284, decouple_loss:0.018628887832164764
The generated pressure mean: 0.452929824590683
loss_pred:0.034462928771972656, decouple_loss:0.018471606075763702
The generated pressure mean: 0.44551724195480347
loss_pred:0.03349391371011734, decouple_loss:0.018856318667531013
Iteration: 628, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45002734661102295
loss_pred:0.034548867493867874, decouple_loss:0.020417876541614532
The generated pressure mean: 0.44715365767478943
loss_pred:0.034900959581136703, decouple_loss:0.019526420161128044
The generated pressure mean: 0.4461944103240967
loss_pred:0.03614913672208786, decouple_loss:0.019785631448030472
Iteration: 629, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4380533993244171
loss_pred:0.034470852464437485, decouple_loss:0.01825762540102005
The generated pressure mean: 0.43555089831352234
loss_pred:0.03401331603527069, decouple_loss:0.019803177565336227
The generated pressure mean: 0.4342696964740753
loss_pred:0.03453117981553078, decouple_loss:0.0184460561722517
Iteration: 630, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4560306668281555
The generated pressure mean: 0.4602757394313812
loss_pred:0.0356501042842865, decouple_loss:0.018824389204382896
loss_pred:0.03503750264644623, decouple_loss:0.019049659371376038
The generated pressure mean: 0.46090927720069885
loss_pred:0.03466898947954178, decouple_loss:0.019118091091513634
2023-04-16 14:41:08 testing...
The generated pressure mean: 0.42558929324150085
The generated pressure mean: 0.4304705560207367
The generated pressure mean: 0.4327802062034607
loss_pred:0.04218866303563118, decouple_loss:0.01907074823975563
loss_pred:0.041206762194633484, decouple_loss:0.019583778455853462
loss_pred:0.0401490218937397, decouple_loss:0.019497713074088097
WV_0_PC_0_EH_1_PS_40, loss: 0.04215068742632866, avg_mse: 0.0498516820371151
current test mse: 0.049852
Iteration: 631, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4360808730125427
loss_pred:0.03333982452750206, decouple_loss:0.01838814467191696
The generated pressure mean: 0.43594589829444885
loss_pred:0.034383900463581085, decouple_loss:0.0192121509462595
The generated pressure mean: 0.43096327781677246
loss_pred:0.03552943840622902, decouple_loss:0.01843424327671528
Iteration: 632, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505181312561035
loss_pred:0.03532351553440094, decouple_loss:0.018879279494285583
The generated pressure mean: 0.45383989810943604
loss_pred:0.034143004566431046, decouple_loss:0.019676193594932556
The generated pressure mean: 0.4592161774635315
loss_pred:0.0354871042072773, decouple_loss:0.01929028518497944
Iteration: 633, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44440406560897827
loss_pred:0.03369225561618805, decouple_loss:0.01765402965247631
The generated pressure mean: 0.4380229711532593
loss_pred:0.033902496099472046, decouple_loss:0.017675388604402542
The generated pressure mean: 0.4433107376098633
loss_pred:0.03446429595351219, decouple_loss:0.018683332949876785
Iteration: 634, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4602675437927246
The generated pressure mean: 0.45355525612831116
loss_pred:0.03593306988477707, decouple_loss:0.01871372014284134
loss_pred:0.034248463809490204, decouple_loss:0.018459977582097054
The generated pressure mean: 0.4522445499897003
loss_pred:0.03490385040640831, decouple_loss:0.018310436978936195
Iteration: 635, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480312168598175
The generated pressure mean: 0.4417974054813385
loss_pred:0.032929789274930954, decouple_loss:0.016905974596738815
loss_pred:0.03375379741191864, decouple_loss:0.016582097858190536
The generated pressure mean: 0.44600918889045715
loss_pred:0.034714166074991226, decouple_loss:0.0169638954102993
Iteration: 636, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4446587860584259
loss_pred:0.033658843487501144, decouple_loss:0.01710669696331024
The generated pressure mean: 0.44318246841430664
loss_pred:0.0345909483730793, decouple_loss:0.0166730135679245
The generated pressure mean: 0.439270943403244
loss_pred:0.034590158611536026, decouple_loss:0.01705906353890896
Iteration: 637, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4554319977760315
The generated pressure mean: 0.45694881677627563
loss_pred:0.034113626927137375, decouple_loss:0.017338251695036888
loss_pred:0.035077497363090515, decouple_loss:0.01768198050558567
The generated pressure mean: 0.4533803462982178
loss_pred:0.034185949712991714, decouple_loss:0.017306534573435783
Iteration: 638, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44933104515075684
loss_pred:0.034362901002168655, decouple_loss:0.019122544676065445
The generated pressure mean: 0.4454159438610077
loss_pred:0.03469938412308693, decouple_loss:0.02048533782362938
The generated pressure mean: 0.4474065899848938
loss_pred:0.03366967290639877, decouple_loss:0.02053767815232277
Iteration: 639, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4395614266395569
The generated pressure mean: 0.4421074688434601
loss_pred:0.033273130655288696, decouple_loss:0.01715013198554516
loss_pred:0.03430672734975815, decouple_loss:0.017867540940642357
The generated pressure mean: 0.4403032660484314
loss_pred:0.03497392684221268, decouple_loss:0.017302466556429863
Iteration: 640, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45250189304351807
loss_pred:0.03307877108454704, decouple_loss:0.016306495293974876
The generated pressure mean: 0.45576348900794983
loss_pred:0.03452804312109947, decouple_loss:0.016876133158802986
The generated pressure mean: 0.4563998878002167
loss_pred:0.03509844094514847, decouple_loss:0.016319958493113518
2023-04-16 14:43:01 testing...
The generated pressure mean: 0.42432186007499695
The generated pressure mean: 0.42910173535346985
loss_pred:0.04109635949134827, decouple_loss:0.018105804920196533
The generated pressure mean: 0.4313948452472687
loss_pred:0.040401555597782135, decouple_loss:0.018507035449147224
loss_pred:0.03943277895450592, decouple_loss:0.018494244664907455
WV_0_PC_0_EH_1_PS_40, loss: 0.041228681802749634, avg_mse: 0.04823896288871765
current test mse: 0.048239
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 641, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44041186571121216
loss_pred:0.0343872532248497, decouple_loss:0.01763588935136795
The generated pressure mean: 0.4317871928215027
loss_pred:0.03659119829535484, decouple_loss:0.016812646761536598
The generated pressure mean: 0.43079838156700134
loss_pred:0.03447903320193291, decouple_loss:0.017186706885695457
Iteration: 642, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46054020524024963
The generated pressure mean: 0.4600771367549896
loss_pred:0.03472992032766342, decouple_loss:0.019039949402213097
loss_pred:0.034865718334913254, decouple_loss:0.01827039010822773
The generated pressure mean: 0.4684005677700043
loss_pred:0.03482578694820404, decouple_loss:0.01823662407696247
Iteration: 643, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4382345974445343
The generated pressure mean: 0.4375547766685486
loss_pred:0.03360622748732567, decouple_loss:0.01850806176662445
loss_pred:0.03484378382563591, decouple_loss:0.01888151839375496
The generated pressure mean: 0.4392626881599426
loss_pred:0.03412308916449547, decouple_loss:0.01893491856753826
Iteration: 644, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44855406880378723
The generated pressure mean: 0.45260903239250183
loss_pred:0.0346497967839241, decouple_loss:0.01817251183092594
loss_pred:0.03368091210722923, decouple_loss:0.018150119110941887
The generated pressure mean: 0.4453360438346863
loss_pred:0.03355259820818901, decouple_loss:0.018107768148183823
Iteration: 645, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4350804090499878
The generated pressure mean: 0.44067248702049255
loss_pred:0.03430679440498352, decouple_loss:0.018128128722310066
loss_pred:0.034862056374549866, decouple_loss:0.017744800075888634
The generated pressure mean: 0.44658875465393066
loss_pred:0.03416818752884865, decouple_loss:0.017934171482920647
Iteration: 646, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46501246094703674The generated pressure mean: 0.47273847460746765
loss_pred:0.03513674810528755, decouple_loss:0.01921827346086502
loss_pred:0.03477151691913605, decouple_loss:0.019150272011756897
The generated pressure mean: 0.46541324257850647
loss_pred:0.03425663337111473, decouple_loss:0.019314417615532875
Iteration: 647, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4251968562602997
The generated pressure mean: 0.42492327094078064
loss_pred:0.03390410542488098, decouple_loss:0.018322261050343513
loss_pred:0.03461647778749466, decouple_loss:0.01824745535850525
The generated pressure mean: 0.42779263854026794
loss_pred:0.03384280204772949, decouple_loss:0.018100038170814514
Iteration: 648, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45017197728157043
The generated pressure mean: 0.4483753740787506
loss_pred:0.03470786660909653, decouple_loss:0.016824379563331604
loss_pred:0.03474687039852142, decouple_loss:0.016499673947691917
The generated pressure mean: 0.45618560910224915
loss_pred:0.03438723459839821, decouple_loss:0.016741149127483368
Iteration: 649, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4609454870223999
loss_pred:0.03474602848291397, decouple_loss:0.01763324812054634
The generated pressure mean: 0.4569413661956787
loss_pred:0.03496230021119118, decouple_loss:0.017386460676789284
The generated pressure mean: 0.4538552463054657
loss_pred:0.034828949719667435, decouple_loss:0.017856642603874207
Iteration: 650, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42469295859336853
loss_pred:0.034584853798151016, decouple_loss:0.018534664064645767
The generated pressure mean: 0.42474257946014404
loss_pred:0.034562207758426666, decouple_loss:0.01881873607635498
The generated pressure mean: 0.426837295293808
loss_pred:0.03505285829305649, decouple_loss:0.018841370940208435
2023-04-16 14:45:35 testing...
The generated pressure mean: 0.4077063798904419
The generated pressure mean: 0.412583589553833
The generated pressure mean: 0.41469794511795044
loss_pred:0.045762885361909866, decouple_loss:0.02125050686299801
loss_pred:0.04493068531155586, decouple_loss:0.021954182535409927
loss_pred:0.04426514357328415, decouple_loss:0.022165628150105476
WV_0_PC_0_EH_1_PS_40, loss: 0.046075742691755295, avg_mse: 0.057081662118434906
current test mse: 0.057082
Iteration: 651, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.49668869376182556
loss_pred:0.03541065752506256, decouple_loss:0.020004931837320328
The generated pressure mean: 0.4999281167984009
loss_pred:0.03501218557357788, decouple_loss:0.019859202206134796
The generated pressure mean: 0.500900387763977
loss_pred:0.03580651432275772, decouple_loss:0.01973072439432144
Iteration: 652, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4000280797481537
loss_pred:0.03564653545618057, decouple_loss:0.022962691262364388
The generated pressure mean: 0.4047124683856964
loss_pred:0.03464866057038307, decouple_loss:0.022725526243448257
The generated pressure mean: 0.39214855432510376
loss_pred:0.03434910997748375, decouple_loss:0.02309197559952736
Iteration: 653, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4304729104042053
loss_pred:0.03422752022743225, decouple_loss:0.01942913979291916
The generated pressure mean: 0.4340527355670929
loss_pred:0.03348659723997116, decouple_loss:0.01918889582157135
The generated pressure mean: 0.4356919527053833
loss_pred:0.03406764566898346, decouple_loss:0.019695758819580078
Iteration: 654, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.49205806851387024
The generated pressure mean: 0.49436694383621216
loss_pred:0.036054275929927826, decouple_loss:0.02094246633350849
loss_pred:0.0350956991314888, decouple_loss:0.02063659392297268
The generated pressure mean: 0.4929431080818176
loss_pred:0.034289807081222534, decouple_loss:0.020779574289917946
Iteration: 655, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43521642684936523
The generated pressure mean: 0.43661823868751526
loss_pred:0.034969981759786606, decouple_loss:0.023249689489603043
loss_pred:0.03440961614251137, decouple_loss:0.023706547915935516
The generated pressure mean: 0.43829432129859924
loss_pred:0.03511284664273262, decouple_loss:0.02345683053135872
Iteration: 656, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4243381917476654
loss_pred:0.03361520171165466, decouple_loss:0.019558051601052284
The generated pressure mean: 0.42200183868408203
loss_pred:0.03636105731129646, decouple_loss:0.019490860402584076
The generated pressure mean: 0.4241609275341034
loss_pred:0.03635406121611595, decouple_loss:0.019392259418964386
Iteration: 657, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47878801822662354
loss_pred:0.03540777415037155, decouple_loss:0.02385568618774414
The generated pressure mean: 0.4820084869861603
loss_pred:0.03420184925198555, decouple_loss:0.02396218478679657
The generated pressure mean: 0.48185503482818604
loss_pred:0.034423891454935074, decouple_loss:0.023974400013685226
Iteration: 658, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.454129159450531
The generated pressure mean: 0.45638686418533325
loss_pred:0.0343812070786953, decouple_loss:0.020259534940123558
loss_pred:0.034742746502161026, decouple_loss:0.0202164426445961
The generated pressure mean: 0.45794302225112915
loss_pred:0.03642988204956055, decouple_loss:0.020606566220521927
Iteration: 659, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4093242287635803
loss_pred:0.03413794934749603, decouple_loss:0.022593263536691666
The generated pressure mean: 0.40584230422973633
loss_pred:0.03606953099370003, decouple_loss:0.02269558608531952
The generated pressure mean: 0.4056388735771179
loss_pred:0.035160452127456665, decouple_loss:0.022733626887202263
Iteration: 660, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45230358839035034
The generated pressure mean: 0.4502849876880646
loss_pred:0.03415822982788086, decouple_loss:0.021259797737002373
loss_pred:0.03453417867422104, decouple_loss:0.021469946950674057
The generated pressure mean: 0.4493328332901001
loss_pred:0.03416874259710312, decouple_loss:0.020623860880732536
2023-04-16 14:47:28 testing...
The generated pressure mean: 0.4121924638748169
The generated pressure mean: 0.40812480449676514
loss_pred:0.043894559144973755, decouple_loss:0.024387160316109657
The generated pressure mean: 0.41397395730018616
loss_pred:0.04455576837062836, decouple_loss:0.023815397173166275
loss_pred:0.04296804592013359, decouple_loss:0.024437163025140762
WV_0_PC_0_EH_1_PS_40, loss: 0.04501678794622421, avg_mse: 0.054577190428972244
current test mse: 0.054577
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 661, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4770435094833374
loss_pred:0.03416077047586441, decouple_loss:0.022971300408244133
The generated pressure mean: 0.475721150636673
loss_pred:0.03474675863981247, decouple_loss:0.023309724405407906
The generated pressure mean: 0.4693445563316345
loss_pred:0.03546840324997902, decouple_loss:0.022763950750231743
Iteration: 662, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480475187301636The generated pressure mean: 0.45346781611442566
loss_pred:0.03347489982843399, decouple_loss:0.0202933419495821
loss_pred:0.03423599153757095, decouple_loss:0.020388204604387283
The generated pressure mean: 0.446030855178833
loss_pred:0.03331460431218147, decouple_loss:0.02100866287946701
Iteration: 663, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42538753151893616
The generated pressure mean: 0.43107444047927856
loss_pred:0.033662304282188416, decouple_loss:0.022350391373038292
loss_pred:0.03459147363901138, decouple_loss:0.022128179669380188
The generated pressure mean: 0.4309388995170593
loss_pred:0.035093776881694794, decouple_loss:0.022212302312254906
Iteration: 664, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44536295533180237The generated pressure mean: 0.4481438994407654
loss_pred:0.03393213078379631, decouple_loss:0.0213176216930151
loss_pred:0.03348473459482193, decouple_loss:0.020514056086540222
The generated pressure mean: 0.4401511251926422
loss_pred:0.034187592566013336, decouple_loss:0.020718585699796677
Iteration: 665, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4615906774997711
The generated pressure mean: 0.46270087361335754
loss_pred:0.033987462520599365, decouple_loss:0.02298213541507721
loss_pred:0.034118469804525375, decouple_loss:0.02237158641219139
The generated pressure mean: 0.45954740047454834
loss_pred:0.03434758260846138, decouple_loss:0.02270682156085968
Iteration: 666, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44312411546707153
The generated pressure mean: 0.44047874212265015
loss_pred:0.032676875591278076, decouple_loss:0.021200310438871384
loss_pred:0.033333342522382736, decouple_loss:0.02090633288025856
The generated pressure mean: 0.44095301628112793
loss_pred:0.03494328632950783, decouple_loss:0.021666977554559708
Iteration: 667, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43873006105422974
The generated pressure mean: 0.43942877650260925
loss_pred:0.033138908445835114, decouple_loss:0.020868562161922455
loss_pred:0.03349936008453369, decouple_loss:0.021247269585728645
The generated pressure mean: 0.43723708391189575
loss_pred:0.0337948277592659, decouple_loss:0.021619779989123344
Iteration: 668, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45121973752975464
loss_pred:0.034507233649492264, decouple_loss:0.019386302679777145
The generated pressure mean: 0.4506416320800781
loss_pred:0.03309940919280052, decouple_loss:0.019261527806520462
The generated pressure mean: 0.4532381296157837
loss_pred:0.03358617052435875, decouple_loss:0.019344322383403778
Iteration: 669, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4576879143714905
The generated pressure mean: 0.4526469111442566
loss_pred:0.032709576189517975, decouple_loss:0.02079719305038452
loss_pred:0.03305791690945625, decouple_loss:0.020604172721505165
The generated pressure mean: 0.45045748353004456
loss_pred:0.03387116640806198, decouple_loss:0.020505595952272415
Iteration: 670, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4400319457054138
loss_pred:0.03610404580831528, decouple_loss:0.01886354386806488
The generated pressure mean: 0.4499428868293762
loss_pred:0.03286559134721756, decouple_loss:0.01917964220046997
The generated pressure mean: 0.4469626843929291
loss_pred:0.034021589905023575, decouple_loss:0.01984073780477047
2023-04-16 14:50:02 testing...
The generated pressure mean: 0.418766051530838
The generated pressure mean: 0.4239887595176697
The generated pressure mean: 0.42586299777030945
loss_pred:0.042457517236471176, decouple_loss:0.020211072638630867
loss_pred:0.041443221271038055, decouple_loss:0.02083832398056984
loss_pred:0.040896181017160416, decouple_loss:0.02074257843196392
WV_0_PC_0_EH_1_PS_40, loss: 0.04262883961200714, avg_mse: 0.05105290934443474
current test mse: 0.051053
Iteration: 671, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44430384039878845
The generated pressure mean: 0.4423637390136719
loss_pred:0.032396651804447174, decouple_loss:0.02030787616968155
loss_pred:0.03388272970914841, decouple_loss:0.019633041694760323
The generated pressure mean: 0.4437713623046875
loss_pred:0.033169493079185486, decouple_loss:0.020434759557247162
Iteration: 672, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44413647055625916
The generated pressure mean: 0.43938860297203064
loss_pred:0.03422477841377258, decouple_loss:0.01890152506530285
loss_pred:0.03480008244514465, decouple_loss:0.018371140584349632
The generated pressure mean: 0.44072580337524414
loss_pred:0.03377597779035568, decouple_loss:0.01810891553759575
Iteration: 673, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4526257812976837
The generated pressure mean: 0.45389825105667114
loss_pred:0.034350279718637466, decouple_loss:0.019213024526834488
loss_pred:0.032620128244161606, decouple_loss:0.018774976953864098
The generated pressure mean: 0.45593899488449097
loss_pred:0.03344634547829628, decouple_loss:0.019050024449825287
Iteration: 674, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45199793577194214
loss_pred:0.03370761126279831, decouple_loss:0.01865530014038086
The generated pressure mean: 0.450023353099823
loss_pred:0.03335253521800041, decouple_loss:0.018477994948625565
The generated pressure mean: 0.4521671533584595
loss_pred:0.03349148482084274, decouple_loss:0.018569817766547203
Iteration: 675, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4404415488243103
The generated pressure mean: 0.438256174325943
loss_pred:0.03295298293232918, decouple_loss:0.019247161224484444
loss_pred:0.03334425017237663, decouple_loss:0.01918693259358406
The generated pressure mean: 0.44317546486854553
loss_pred:0.03270499035716057, decouple_loss:0.019309015944600105
Iteration: 676, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43987882137298584
loss_pred:0.033495597541332245, decouple_loss:0.017947260290384293
The generated pressure mean: 0.43788257241249084
loss_pred:0.03357478603720665, decouple_loss:0.018165893852710724
The generated pressure mean: 0.4463047683238983
loss_pred:0.03238409012556076, decouple_loss:0.01801329106092453
Iteration: 677, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.460841566324234
loss_pred:0.034056372940540314, decouple_loss:0.018681762740015984
The generated pressure mean: 0.46165525913238525
loss_pred:0.03386626020073891, decouple_loss:0.01879866048693657
The generated pressure mean: 0.45712143182754517
loss_pred:0.033965203911066055, decouple_loss:0.018646009266376495
Iteration: 678, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449139803647995
loss_pred:0.033949755132198334, decouple_loss:0.01760360598564148
The generated pressure mean: 0.45398569107055664
loss_pred:0.03334366902709007, decouple_loss:0.017565282061696053
The generated pressure mean: 0.4475872814655304
loss_pred:0.034367989748716354, decouple_loss:0.016789991408586502
Iteration: 679, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44173839688301086
loss_pred:0.03340275213122368, decouple_loss:0.017998898401856422
The generated pressure mean: 0.43486037850379944
loss_pred:0.033381588757038116, decouple_loss:0.017925385385751724
The generated pressure mean: 0.43742597103118896
loss_pred:0.03344113007187843, decouple_loss:0.018064169213175774
Iteration: 680, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4404040277004242
loss_pred:0.031493671238422394, decouple_loss:0.017109204083681107
The generated pressure mean: 0.4444543123245239
loss_pred:0.03313257172703743, decouple_loss:0.01692987233400345
The generated pressure mean: 0.4418003261089325
loss_pred:0.03290288522839546, decouple_loss:0.016715148463845253
2023-04-16 14:51:55 testing...
The generated pressure mean: 0.422759473323822
The generated pressure mean: 0.41785162687301636
The generated pressure mean: 0.42487257719039917
loss_pred:0.04139818996191025, decouple_loss:0.01932709291577339
loss_pred:0.042550865560770035, decouple_loss:0.018560290336608887
loss_pred:0.04100353643298149, decouple_loss:0.019598806276917458
WV_0_PC_0_EH_1_PS_40, loss: 0.042608968913555145, avg_mse: 0.05145763233304024
current test mse: 0.051458
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 681, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44459936022758484
loss_pred:0.033654674887657166, decouple_loss:0.01774289645254612
The generated pressure mean: 0.45036813616752625
loss_pred:0.033209845423698425, decouple_loss:0.017499491572380066
The generated pressure mean: 0.4506131410598755
loss_pred:0.03270122781395912, decouple_loss:0.01738915406167507
Iteration: 682, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46372899413108826
The generated pressure mean: 0.45784756541252136
loss_pred:0.03484690934419632, decouple_loss:0.01736125908792019
loss_pred:0.03351415693759918, decouple_loss:0.017107916995882988
The generated pressure mean: 0.45778271555900574
loss_pred:0.03133261948823929, decouple_loss:0.017202623188495636
Iteration: 683, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4458532929420471
The generated pressure mean: 0.44390204548835754
loss_pred:0.034291237592697144, decouple_loss:0.016624528914690018
loss_pred:0.03363867849111557, decouple_loss:0.01725281961262226
The generated pressure mean: 0.4414869248867035
loss_pred:0.03267570212483406, decouple_loss:0.016864987090229988
Iteration: 684, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442744553089142
loss_pred:0.0338575541973114, decouple_loss:0.01728661172091961
The generated pressure mean: 0.432342529296875
loss_pred:0.03356987610459328, decouple_loss:0.01745637133717537
The generated pressure mean: 0.44202694296836853
loss_pred:0.034522585570812225, decouple_loss:0.017516518011689186
Iteration: 685, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4536780118942261
The generated pressure mean: 0.45000970363616943
loss_pred:0.031339436769485474, decouple_loss:0.0168461836874485
loss_pred:0.03236876800656319, decouple_loss:0.0167694091796875
The generated pressure mean: 0.44975587725639343
loss_pred:0.03285299986600876, decouple_loss:0.01730538345873356
Iteration: 686, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4574064314365387
loss_pred:0.03316459059715271, decouple_loss:0.016256017610430717
The generated pressure mean: 0.4545794129371643
loss_pred:0.03313209488987923, decouple_loss:0.01651284284889698
The generated pressure mean: 0.4548724591732025
loss_pred:0.03231697902083397, decouple_loss:0.016864119097590446
Iteration: 687, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43853649497032166
loss_pred:0.03423956036567688, decouple_loss:0.017253205180168152
The generated pressure mean: 0.43821921944618225
loss_pred:0.033205706626176834, decouple_loss:0.01775199919939041
The generated pressure mean: 0.44238123297691345
loss_pred:0.03308800607919693, decouple_loss:0.017257679253816605
Iteration: 688, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4512602388858795
loss_pred:0.032240454107522964, decouple_loss:0.017847929149866104
The generated pressure mean: 0.4499199390411377
loss_pred:0.031719572842121124, decouple_loss:0.01843455247581005
The generated pressure mean: 0.45143380761146545
loss_pred:0.03273629769682884, decouple_loss:0.017992183566093445
Iteration: 689, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45192694664001465
loss_pred:0.03226683288812637, decouple_loss:0.017251767218112946
The generated pressure mean: 0.46192824840545654
loss_pred:0.033978529274463654, decouple_loss:0.017149288207292557
The generated pressure mean: 0.45465436577796936
loss_pred:0.03299425169825554, decouple_loss:0.017637526616454124
Iteration: 690, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43185195326805115
loss_pred:0.032726552337408066, decouple_loss:0.017419418320059776
The generated pressure mean: 0.43497416377067566
loss_pred:0.032617341727018356, decouple_loss:0.01755184680223465
The generated pressure mean: 0.442471444606781
loss_pred:0.0317980982363224, decouple_loss:0.017223455011844635
2023-04-16 14:54:30 testing...
The generated pressure mean: 0.41904255747795105
The generated pressure mean: 0.4240691065788269
loss_pred:0.041191354393959045, decouple_loss:0.01712464727461338
The generated pressure mean: 0.4260786473751068
loss_pred:0.04049598053097725, decouple_loss:0.017727123573422432
loss_pred:0.03940559923648834, decouple_loss:0.017846619710326195
WV_0_PC_0_EH_1_PS_40, loss: 0.04124261811375618, avg_mse: 0.049232564866542816
current test mse: 0.049233
Iteration: 691, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45073509216308594
The generated pressure mean: 0.44885894656181335
loss_pred:0.03299770504236221, decouple_loss:0.016291050240397453
loss_pred:0.031221872195601463, decouple_loss:0.016383517533540726
The generated pressure mean: 0.4482530653476715
loss_pred:0.03220607340335846, decouple_loss:0.016038939356803894
Iteration: 692, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4521547555923462
loss_pred:0.03253885358572006, decouple_loss:0.018039580434560776
The generated pressure mean: 0.4630236327648163
loss_pred:0.0337877981364727, decouple_loss:0.018079711124300957
The generated pressure mean: 0.4590848684310913
loss_pred:0.03388717398047447, decouple_loss:0.018054552376270294
Iteration: 693, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44776007533073425
loss_pred:0.03344441577792168, decouple_loss:0.02195393480360508
The generated pressure mean: 0.4402267038822174
loss_pred:0.03291196748614311, decouple_loss:0.022026842460036278
The generated pressure mean: 0.4442359507083893
loss_pred:0.031399741768836975, decouple_loss:0.021809805184602737
Iteration: 694, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4297735393047333
loss_pred:0.03300701454281807, decouple_loss:0.018093552440404892
The generated pressure mean: 0.4341932237148285
loss_pred:0.03293740376830101, decouple_loss:0.01820141077041626
The generated pressure mean: 0.4300069808959961
loss_pred:0.033820442855358124, decouple_loss:0.018537085503339767
Iteration: 695, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4614964425563812
loss_pred:0.03259284049272537, decouple_loss:0.01925744116306305
The generated pressure mean: 0.4637412428855896
loss_pred:0.0333593524992466, decouple_loss:0.019264357164502144
The generated pressure mean: 0.467327356338501
loss_pred:0.03191353753209114, decouple_loss:0.019881008192896843
Iteration: 696, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44716522097587585
loss_pred:0.03260663524270058, decouple_loss:0.020027417689561844
The generated pressure mean: 0.4564499258995056
loss_pred:0.03236544132232666, decouple_loss:0.020070601254701614
The generated pressure mean: 0.4530393183231354
loss_pred:0.03284608945250511, decouple_loss:0.02014915458858013
Iteration: 697, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43967491388320923
loss_pred:0.03246624767780304, decouple_loss:0.018336521461606026
The generated pressure mean: 0.43744370341300964
loss_pred:0.033256419003009796, decouple_loss:0.018356801941990852
The generated pressure mean: 0.440277636051178
loss_pred:0.03226323798298836, decouple_loss:0.01807752065360546
Iteration: 698, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44826146960258484
loss_pred:0.032310862094163895, decouple_loss:0.018457021564245224
The generated pressure mean: 0.44990289211273193
loss_pred:0.03229657560586929, decouple_loss:0.018278643488883972
The generated pressure mean: 0.4466496407985687
loss_pred:0.03304886072874069, decouple_loss:0.018323464319109917
Iteration: 699, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44974908232688904
loss_pred:0.032093122601509094, decouple_loss:0.017566440626978874
The generated pressure mean: 0.4440767168998718
loss_pred:0.03304320201277733, decouple_loss:0.01745319925248623
The generated pressure mean: 0.4559307098388672
loss_pred:0.03328320011496544, decouple_loss:0.01733098179101944
Iteration: 700, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485495090484619
loss_pred:0.03191943094134331, decouple_loss:0.017886420711874962
The generated pressure mean: 0.44497641921043396
The generated pressure mean: 0.44935858249664307
loss_pred:0.03219994902610779, decouple_loss:0.017760511487722397
loss_pred:0.031343281269073486, decouple_loss:0.01748713292181492
2023-04-16 14:56:23 testing...
The generated pressure mean: 0.41875317692756653
The generated pressure mean: 0.42401817440986633
The generated pressure mean: 0.42604008316993713
loss_pred:0.041185710579156876, decouple_loss:0.020319081842899323
loss_pred:0.040398746728897095, decouple_loss:0.02126455307006836
loss_pred:0.03944423049688339, decouple_loss:0.021428000181913376
WV_0_PC_0_EH_1_PS_40, loss: 0.04139309376478195, avg_mse: 0.04942936450242996
current test mse: 0.049429
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 701, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.454311728477478
loss_pred:0.034651197493076324, decouple_loss:0.01922999694943428
The generated pressure mean: 0.44781404733657837
The generated pressure mean: 0.4455588459968567
loss_pred:0.033586956560611725, decouple_loss:0.019734486937522888
loss_pred:0.03381260484457016, decouple_loss:0.019463328644633293
Iteration: 702, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494727849960327
loss_pred:0.03256500884890556, decouple_loss:0.018837396055459976
The generated pressure mean: 0.4469279944896698
loss_pred:0.0322921946644783, decouple_loss:0.018816106021404266
The generated pressure mean: 0.44960248470306396
loss_pred:0.03327247500419617, decouple_loss:0.018969465047121048
Iteration: 703, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43606385588645935
loss_pred:0.032432544976472855, decouple_loss:0.01792728155851364
The generated pressure mean: 0.441215455532074
loss_pred:0.033897072076797485, decouple_loss:0.018156712874770164
The generated pressure mean: 0.4422352910041809
loss_pred:0.034497298300266266, decouple_loss:0.018204256892204285
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 704, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4648665487766266
loss_pred:0.032686080783605576, decouple_loss:0.01792062073945999
The generated pressure mean: 0.46228015422821045
loss_pred:0.03253062441945076, decouple_loss:0.018082015216350555
The generated pressure mean: 0.4710609018802643
loss_pred:0.03391024470329285, decouple_loss:0.018360761925578117
Iteration: 705, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473733603954315
loss_pred:0.032298821955919266, decouple_loss:0.018478471785783768
The generated pressure mean: 0.44190090894699097
loss_pred:0.03239716961979866, decouple_loss:0.01828143186867237
The generated pressure mean: 0.44583195447921753
loss_pred:0.03327612951397896, decouple_loss:0.018540259450674057
Iteration: 706, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.443255215883255
loss_pred:0.03357374668121338, decouple_loss:0.018111418932676315
The generated pressure mean: 0.437433123588562
loss_pred:0.03260054066777229, decouple_loss:0.018153147771954536
The generated pressure mean: 0.4416482150554657
loss_pred:0.03313768282532692, decouple_loss:0.01806486025452614
Iteration: 707, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45753082633018494
loss_pred:0.03436393290758133, decouple_loss:0.018469933420419693
The generated pressure mean: 0.4621512293815613
loss_pred:0.03351825848221779, decouple_loss:0.018315482884645462
The generated pressure mean: 0.46103689074516296
loss_pred:0.0337284654378891, decouple_loss:0.018411627039313316
Iteration: 708, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442058801651001
loss_pred:0.03179480880498886, decouple_loss:0.01795731857419014
The generated pressure mean: 0.44101575016975403
loss_pred:0.034167271107435226, decouple_loss:0.017909802496433258
The generated pressure mean: 0.4459209740161896
loss_pred:0.03193563222885132, decouple_loss:0.017751794308423996
Iteration: 709, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4510648250579834
loss_pred:0.03398999199271202, decouple_loss:0.01752711646258831
The generated pressure mean: 0.45046329498291016
loss_pred:0.032474953681230545, decouple_loss:0.017579711973667145
The generated pressure mean: 0.4534376263618469
loss_pred:0.033293478190898895, decouple_loss:0.017130171880126
Iteration: 710, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4550779461860657
loss_pred:0.03380116820335388, decouple_loss:0.01779297925531864
The generated pressure mean: 0.45133891701698303
loss_pred:0.032781507819890976, decouple_loss:0.01790437661111355
The generated pressure mean: 0.45374906063079834
loss_pred:0.03536645695567131, decouple_loss:0.017871471121907234
2023-04-16 14:58:59 testing...
The generated pressure mean: 0.421228289604187
The generated pressure mean: 0.42689141631126404
The generated pressure mean: 0.42891764640808105
loss_pred:0.04096684232354164, decouple_loss:0.017622554674744606
loss_pred:0.039127714931964874, decouple_loss:0.018573811277747154
loss_pred:0.04008142277598381, decouple_loss:0.01838070899248123
WV_0_PC_0_EH_1_PS_40, loss: 0.04096828028559685, avg_mse: 0.04929964989423752
current test mse: 0.0493
Iteration: 711, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44094449281692505
loss_pred:0.03350589796900749, decouple_loss:0.01701684668660164
The generated pressure mean: 0.43936336040496826
loss_pred:0.03211154043674469, decouple_loss:0.01656138151884079
The generated pressure mean: 0.4389054477214813
loss_pred:0.03375929221510887, decouple_loss:0.016799792647361755
Iteration: 712, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44658637046813965
loss_pred:0.032217077910900116, decouple_loss:0.017505183815956116
The generated pressure mean: 0.45336034893989563
loss_pred:0.03360458463430405, decouple_loss:0.017529461532831192
The generated pressure mean: 0.44822603464126587
loss_pred:0.035111069679260254, decouple_loss:0.017214460298419
Iteration: 713, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4625164270401001
loss_pred:0.03367199748754501, decouple_loss:0.017407337203621864
The generated pressure mean: 0.4606512486934662
loss_pred:0.03299906104803085, decouple_loss:0.018085312098264694
The generated pressure mean: 0.46352702379226685
loss_pred:0.03324936702847481, decouple_loss:0.01748034544289112
Iteration: 714, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43523427844047546
loss_pred:0.033932607620954514, decouple_loss:0.017199646681547165
The generated pressure mean: 0.4399961531162262
loss_pred:0.032599419355392456, decouple_loss:0.017381705343723297
The generated pressure mean: 0.43701398372650146
loss_pred:0.03251730278134346, decouple_loss:0.01722920872271061
Iteration: 715, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4541831910610199
loss_pred:0.031975165009498596, decouple_loss:0.01594756916165352
The generated pressure mean: 0.4534405469894409
loss_pred:0.03214824199676514, decouple_loss:0.015923958271741867
The generated pressure mean: 0.44966673851013184
loss_pred:0.033171556890010834, decouple_loss:0.016145242378115654
Iteration: 716, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4595021605491638
loss_pred:0.033602599054574966, decouple_loss:0.016969868913292885
The generated pressure mean: 0.4542258679866791
loss_pred:0.032966140657663345, decouple_loss:0.016847049817442894
The generated pressure mean: 0.4604824185371399
loss_pred:0.03284932300448418, decouple_loss:0.01660434901714325
Iteration: 717, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4383974075317383
loss_pred:0.03222782909870148, decouple_loss:0.017105238512158394
The generated pressure mean: 0.436551958322525
loss_pred:0.033219631761312485, decouple_loss:0.016929037868976593
The generated pressure mean: 0.43069660663604736
loss_pred:0.03320048749446869, decouple_loss:0.01690184324979782
Iteration: 718, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4640659689903259
loss_pred:0.03282524272799492, decouple_loss:0.01731606014072895
The generated pressure mean: 0.456689715385437
loss_pred:0.03264410048723221, decouple_loss:0.017099129036068916
The generated pressure mean: 0.4555969536304474
loss_pred:0.03238474577665329, decouple_loss:0.01716553419828415
Iteration: 719, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4590689241886139
loss_pred:0.03225361555814743, decouple_loss:0.017268894240260124
The generated pressure mean: 0.4626830518245697
loss_pred:0.03300657123327255, decouple_loss:0.017307685688138008
The generated pressure mean: 0.45613813400268555
loss_pred:0.033812277019023895, decouple_loss:0.01715407334268093
Iteration: 720, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4364256262779236
loss_pred:0.034516580402851105, decouple_loss:0.017734229564666748
The generated pressure mean: 0.4326908588409424
loss_pred:0.033126138150691986, decouple_loss:0.01754949428141117
The generated pressure mean: 0.4336889684200287
loss_pred:0.03312830999493599, decouple_loss:0.01789781264960766
2023-04-16 15:00:53 testing...
The generated pressure mean: 0.4240507185459137
The generated pressure mean: 0.4189339280128479
loss_pred:0.03990766778588295, decouple_loss:0.01916353404521942
The generated pressure mean: 0.42616572976112366
loss_pred:0.040647875517606735, decouple_loss:0.01821829378604889
loss_pred:0.03888864442706108, decouple_loss:0.01933901011943817
WV_0_PC_0_EH_1_PS_40, loss: 0.04076007753610611, avg_mse: 0.048840660601854324
current test mse: 0.048841
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 721, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490232467651367
loss_pred:0.03461294621229172, decouple_loss:0.017004309222102165
The generated pressure mean: 0.44395875930786133
loss_pred:0.033788055181503296, decouple_loss:0.01705721579492092
The generated pressure mean: 0.44674596190452576
loss_pred:0.032714203000068665, decouple_loss:0.017278259620070457
Iteration: 722, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4555583596229553
loss_pred:0.03380747511982918, decouple_loss:0.018771588802337646
The generated pressure mean: 0.44625213742256165
loss_pred:0.031966760754585266, decouple_loss:0.018305500969290733
The generated pressure mean: 0.451921671628952
loss_pred:0.0332162119448185, decouple_loss:0.018346939235925674
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 723, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498580992221832
loss_pred:0.03322823345661163, decouple_loss:0.01816500350832939
The generated pressure mean: 0.4486369490623474
loss_pred:0.03329649195075035, decouple_loss:0.018105467781424522
The generated pressure mean: 0.44795164465904236
loss_pred:0.03290712460875511, decouple_loss:0.018134022131562233
Iteration: 724, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476369321346283
loss_pred:0.032542068511247635, decouple_loss:0.01735006645321846
The generated pressure mean: 0.44568121433258057
loss_pred:0.0339348204433918, decouple_loss:0.01679333858191967
The generated pressure mean: 0.4406713843345642
loss_pred:0.0320931039750576, decouple_loss:0.017079820856451988
Iteration: 725, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44036784768104553
loss_pred:0.03189581260085106, decouple_loss:0.016365332528948784
The generated pressure mean: 0.4339831471443176
loss_pred:0.032091423869132996, decouple_loss:0.01591234654188156
The generated pressure mean: 0.4390702247619629
loss_pred:0.03236498311161995, decouple_loss:0.016129378229379654
Iteration: 726, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45417189598083496
loss_pred:0.03243665024638176, decouple_loss:0.017187464982271194
The generated pressure mean: 0.45760706067085266
loss_pred:0.03238885477185249, decouple_loss:0.016805090010166168
The generated pressure mean: 0.4537949860095978
loss_pred:0.03328728303313255, decouple_loss:0.016533086076378822
Iteration: 727, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44630223512649536
loss_pred:0.03425607830286026, decouple_loss:0.01617305912077427
The generated pressure mean: 0.4423797130584717
loss_pred:0.03327689692378044, decouple_loss:0.0163289662450552
The generated pressure mean: 0.450599730014801
loss_pred:0.03244102746248245, decouple_loss:0.016190003603696823
Iteration: 728, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4439532458782196
loss_pred:0.03186511620879173, decouple_loss:0.017852121964097023
The generated pressure mean: 0.4389655590057373
loss_pred:0.03196553885936737, decouple_loss:0.017495635896921158
The generated pressure mean: 0.4332949221134186
loss_pred:0.03250005096197128, decouple_loss:0.017711590975522995
Iteration: 729, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44773000478744507
loss_pred:0.03358519449830055, decouple_loss:0.016236482188105583
The generated pressure mean: 0.44880783557891846
loss_pred:0.03159014880657196, decouple_loss:0.016102131456136703
The generated pressure mean: 0.4481246769428253
loss_pred:0.03327858820557594, decouple_loss:0.016153516247868538
Iteration: 730, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46211859583854675
loss_pred:0.03335537016391754, decouple_loss:0.01627332717180252
The generated pressure mean: 0.4566725194454193
loss_pred:0.0330958366394043, decouple_loss:0.016582386568188667
The generated pressure mean: 0.4614396393299103
loss_pred:0.03229754418134689, decouple_loss:0.016389794647693634
2023-04-16 15:03:27 testing...
The generated pressure mean: 0.42060381174087524
The generated pressure mean: 0.42555853724479675
The generated pressure mean: 0.4276531934738159
loss_pred:0.039911940693855286, decouple_loss:0.0183212049305439
loss_pred:0.03834665194153786, decouple_loss:0.01896858774125576
loss_pred:0.03895629197359085, decouple_loss:0.01902506873011589
WV_0_PC_0_EH_1_PS_40, loss: 0.04001021012663841, avg_mse: 0.04750756174325943
current test mse: 0.047508
Iteration: 731, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43210461735725403
loss_pred:0.03299286589026451, decouple_loss:0.016770079731941223
The generated pressure mean: 0.439109206199646
loss_pred:0.0331241711974144, decouple_loss:0.016908997669816017
The generated pressure mean: 0.4336572587490082
loss_pred:0.033263884484767914, decouple_loss:0.016425523906946182
Iteration: 732, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4457436203956604
loss_pred:0.03323033079504967, decouple_loss:0.017875712364912033
The generated pressure mean: 0.4485374093055725
loss_pred:0.032341424375772476, decouple_loss:0.017945444211363792
The generated pressure mean: 0.4491661489009857
loss_pred:0.032165996730327606, decouple_loss:0.017850272357463837
Iteration: 733, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4548216462135315
loss_pred:0.03155827149748802, decouple_loss:0.01658686436712742
The generated pressure mean: 0.4549908936023712
loss_pred:0.032702237367630005, decouple_loss:0.016475189477205276
The generated pressure mean: 0.45532312989234924
loss_pred:0.032458361238241196, decouple_loss:0.016564536839723587
Iteration: 734, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44313883781433105
loss_pred:0.03340121731162071, decouple_loss:0.016244396567344666
The generated pressure mean: 0.44493815302848816
loss_pred:0.03260667249560356, decouple_loss:0.01583496481180191
The generated pressure mean: 0.4430365562438965
loss_pred:0.03202900290489197, decouple_loss:0.015858285129070282
Iteration: 735, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43697991967201233
The generated pressure mean: 0.4401749074459076
loss_pred:0.03351461514830589, decouple_loss:0.016087492927908897
loss_pred:0.034294530749320984, decouple_loss:0.015977049246430397
The generated pressure mean: 0.4412928521633148
loss_pred:0.031883399933576584, decouple_loss:0.01601778343319893
Iteration: 736, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44621968269348145
loss_pred:0.03239094465970993, decouple_loss:0.01574920490384102
The generated pressure mean: 0.45294424891471863
loss_pred:0.03306088224053383, decouple_loss:0.015883691608905792
The generated pressure mean: 0.4495261311531067
loss_pred:0.031802479177713394, decouple_loss:0.01581873744726181
Iteration: 737, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4544769525527954
loss_pred:0.03261721879243851, decouple_loss:0.016558971256017685
The generated pressure mean: 0.44966790080070496
loss_pred:0.0329764299094677, decouple_loss:0.016334693878889084
The generated pressure mean: 0.4524794816970825
loss_pred:0.03209931403398514, decouple_loss:0.016630448400974274
Iteration: 738, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43586745858192444
loss_pred:0.03497334197163582, decouple_loss:0.018104905262589455
The generated pressure mean: 0.43709003925323486
loss_pred:0.03184134513139725, decouple_loss:0.017742712050676346
The generated pressure mean: 0.4378121793270111
loss_pred:0.03251037001609802, decouple_loss:0.018039489164948463
Iteration: 739, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45737892389297485
loss_pred:0.03298838436603546, decouple_loss:0.01870054565370083
The generated pressure mean: 0.45450693368911743
loss_pred:0.03258863091468811, decouple_loss:0.01857314445078373
The generated pressure mean: 0.4600881040096283
loss_pred:0.035398200154304504, decouple_loss:0.0189268309623003
Iteration: 740, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4408220648765564
loss_pred:0.03332718089222908, decouple_loss:0.016722429543733597
The generated pressure mean: 0.43460366129875183
loss_pred:0.03358062356710434, decouple_loss:0.016782881692051888
The generated pressure mean: 0.43479013442993164
loss_pred:0.03259573504328728, decouple_loss:0.016714848577976227
2023-04-16 15:05:21 testing...
The generated pressure mean: 0.4169819951057434
The generated pressure mean: 0.42204469442367554
loss_pred:0.04020152986049652, decouple_loss:0.016964245587587357
The generated pressure mean: 0.4242238402366638
loss_pred:0.039414189755916595, decouple_loss:0.017822904512286186
loss_pred:0.03848714753985405, decouple_loss:0.017864936962723732
WV_0_PC_0_EH_1_PS_40, loss: 0.04024515673518181, avg_mse: 0.04828808456659317
current test mse: 0.048288
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 741, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4589708745479584
loss_pred:0.031770650297403336, decouple_loss:0.01753847301006317
The generated pressure mean: 0.4602465033531189
loss_pred:0.031204497441649437, decouple_loss:0.016007913276553154
The generated pressure mean: 0.45764702558517456
loss_pred:0.03223353251814842, decouple_loss:0.016126476228237152
Iteration: 742, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4424009323120117
loss_pred:0.031358156353235245, decouple_loss:0.01686226576566696
The generated pressure mean: 0.44596022367477417
loss_pred:0.030677881091833115, decouple_loss:0.017925582826137543
The generated pressure mean: 0.45161259174346924
loss_pred:0.032611992210149765, decouple_loss:0.017199555411934853
Iteration: 743, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45585203170776367
loss_pred:0.03298329561948776, decouple_loss:0.018128888681530952
The generated pressure mean: 0.4514390528202057
loss_pred:0.03237183764576912, decouple_loss:0.017556510865688324
The generated pressure mean: 0.449092298746109
loss_pred:0.034786880016326904, decouple_loss:0.018250059336423874
Iteration: 744, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4246389865875244
loss_pred:0.032508302479982376, decouple_loss:0.017149759456515312
The generated pressure mean: 0.4319411814212799
loss_pred:0.0335770882666111, decouple_loss:0.016742583364248276
The generated pressure mean: 0.4281505346298218
loss_pred:0.033409107476472855, decouple_loss:0.016914943233132362
Iteration: 745, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4781268239021301
loss_pred:0.0341196246445179, decouple_loss:0.016738444566726685
The generated pressure mean: 0.47886911034584045
loss_pred:0.03291425481438637, decouple_loss:0.01693878322839737
The generated pressure mean: 0.4826406240463257
loss_pred:0.032147038727998734, decouple_loss:0.017013104632496834
Iteration: 746, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43462225794792175
loss_pred:0.03161315619945526, decouple_loss:0.01992402784526348
The generated pressure mean: 0.43651843070983887
loss_pred:0.03184991702437401, decouple_loss:0.019840067252516747
The generated pressure mean: 0.4405165910720825
loss_pred:0.03243830054998398, decouple_loss:0.01991080865263939
Iteration: 747, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4417535662651062
loss_pred:0.03239702805876732, decouple_loss:0.01916469819843769
The generated pressure mean: 0.43967291712760925
loss_pred:0.03134346008300781, decouple_loss:0.01900634355843067
The generated pressure mean: 0.4445337951183319
loss_pred:0.0318683423101902, decouple_loss:0.01894354820251465
Iteration: 748, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4509287178516388
The generated pressure mean: 0.4510658085346222
loss_pred:0.03075476549565792, decouple_loss:0.01675812155008316
loss_pred:0.032882727682590485, decouple_loss:0.01670807972550392
The generated pressure mean: 0.451321005821228
loss_pred:0.032307256013154984, decouple_loss:0.01682465337216854
Iteration: 749, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4446406364440918
loss_pred:0.030755212530493736, decouple_loss:0.019885731860995293
The generated pressure mean: 0.44474881887435913
loss_pred:0.03105274587869644, decouple_loss:0.0205551665276289
The generated pressure mean: 0.44388291239738464
loss_pred:0.029626421630382538, decouple_loss:0.02006857469677925
Iteration: 750, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4580177366733551
loss_pred:0.031094681471586227, decouple_loss:0.017809664830565453
The generated pressure mean: 0.4499396085739136
loss_pred:0.030819181352853775, decouple_loss:0.017339974641799927
The generated pressure mean: 0.4605896472930908
loss_pred:0.033060282468795776, decouple_loss:0.017817405983805656
2023-04-16 15:07:52 testing...
The generated pressure mean: 0.4170469045639038
The generated pressure mean: 0.42222869396209717
The generated pressure mean: 0.42429691553115845
loss_pred:0.04070964828133583, decouple_loss:0.019066432490944862
loss_pred:0.0400158166885376, decouple_loss:0.019383739680051804
loss_pred:0.03888620808720589, decouple_loss:0.019395310431718826
WV_0_PC_0_EH_1_PS_40, loss: 0.04083465039730072, avg_mse: 0.049300629645586014
current test mse: 0.049301
Iteration: 751, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4533899128437042
loss_pred:0.03314938768744469, decouple_loss:0.01844017580151558
The generated pressure mean: 0.4520973861217499
loss_pred:0.030843235552310944, decouple_loss:0.018335146829485893
The generated pressure mean: 0.4536333680152893
loss_pred:0.03339359536767006, decouple_loss:0.01842198707163334
Iteration: 752, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464617669582367
loss_pred:0.03157421201467514, decouple_loss:0.016925513744354248
The generated pressure mean: 0.4428395926952362
loss_pred:0.031021881848573685, decouple_loss:0.016741175204515457
The generated pressure mean: 0.44494694471359253
loss_pred:0.030670588836073875, decouple_loss:0.017156334593892097
Iteration: 753, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470925033092499
loss_pred:0.030986564233899117, decouple_loss:0.018461598083376884
The generated pressure mean: 0.45085814595222473
loss_pred:0.032545533031225204, decouple_loss:0.018527181819081306
The generated pressure mean: 0.45129892230033875
loss_pred:0.031813301146030426, decouple_loss:0.018398340791463852
Iteration: 754, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4511656165122986
The generated pressure mean: 0.449701726436615
loss_pred:0.03126823902130127, decouple_loss:0.018793515861034393
loss_pred:0.031401753425598145, decouple_loss:0.018819283694028854
The generated pressure mean: 0.44861066341400146
loss_pred:0.031380292028188705, decouple_loss:0.018818577751517296
Iteration: 755, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475579559803009
The generated pressure mean: 0.44814932346343994
loss_pred:0.031182164326310158, decouple_loss:0.017263280227780342
loss_pred:0.03064590133726597, decouple_loss:0.017218729481101036
The generated pressure mean: 0.44485196471214294
loss_pred:0.031304072588682175, decouple_loss:0.017511524260044098
Iteration: 756, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4448954463005066
The generated pressure mean: 0.44864317774772644
loss_pred:0.030247488990426064, decouple_loss:0.017033183947205544
loss_pred:0.031644441187381744, decouple_loss:0.01693282462656498
The generated pressure mean: 0.4441254436969757
loss_pred:0.03228100389242172, decouple_loss:0.01670590043067932
Iteration: 757, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4630211889743805
The generated pressure mean: 0.4582749903202057
loss_pred:0.030845459550619125, decouple_loss:0.016683191061019897
loss_pred:0.03230021893978119, decouple_loss:0.016895044595003128
The generated pressure mean: 0.44843241572380066
loss_pred:0.031420931220054626, decouple_loss:0.016553983092308044
Iteration: 758, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43003717064857483
loss_pred:0.030616285279393196, decouple_loss:0.016893859952688217
The generated pressure mean: 0.43696534633636475
loss_pred:0.029220793396234512, decouple_loss:0.017816023901104927
The generated pressure mean: 0.43879643082618713
loss_pred:0.030150791630148888, decouple_loss:0.0177787933498621
Iteration: 759, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44962024688720703
loss_pred:0.030946804210543633, decouple_loss:0.01665332168340683
The generated pressure mean: 0.45118263363838196
loss_pred:0.03028145805001259, decouple_loss:0.016729477792978287
The generated pressure mean: 0.4489508867263794
loss_pred:0.03136907145380974, decouple_loss:0.016105998307466507
Iteration: 760, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46308669447898865
loss_pred:0.030251607298851013, decouple_loss:0.017817748710513115
The generated pressure mean: 0.45475679636001587
loss_pred:0.029870497062802315, decouple_loss:0.01825888268649578
The generated pressure mean: 0.45806485414505005
loss_pred:0.032263047993183136, decouple_loss:0.018340304493904114
2023-04-16 15:09:46 testing...
The generated pressure mean: 0.41875943541526794
The generated pressure mean: 0.4247246980667114
The generated pressure mean: 0.4268428385257721
loss_pred:0.04043351486325264, decouple_loss:0.017767159268260002
loss_pred:0.038796864449977875, decouple_loss:0.018152229487895966
loss_pred:0.03950078412890434, decouple_loss:0.018000097945332527
WV_0_PC_0_EH_1_PS_40, loss: 0.04047571122646332, avg_mse: 0.049215637147426605
current test mse: 0.049216
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 761, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45384374260902405
loss_pred:0.03202887251973152, decouple_loss:0.017472561448812485
The generated pressure mean: 0.4415512681007385
loss_pred:0.03293060138821602, decouple_loss:0.016891904175281525
The generated pressure mean: 0.44965583086013794
loss_pred:0.0320865623652935, decouple_loss:0.017264747992157936
Iteration: 762, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4334494173526764
The generated pressure mean: 0.4432131350040436
loss_pred:0.03355802968144417, decouple_loss:0.01823021098971367
loss_pred:0.032876405864953995, decouple_loss:0.017521528527140617
The generated pressure mean: 0.4330657124519348
loss_pred:0.03290849179029465, decouple_loss:0.01785905845463276
Iteration: 763, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44189196825027466
The generated pressure mean: 0.45419031381607056
loss_pred:0.03183677792549133, decouple_loss:0.01604050025343895
loss_pred:0.03360379859805107, decouple_loss:0.016032380983233452
The generated pressure mean: 0.4446915090084076
loss_pred:0.032847922295331955, decouple_loss:0.01656320132315159
Iteration: 764, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46133628487586975The generated pressure mean: 0.4547562599182129
loss_pred:0.03238989785313606, decouple_loss:0.016468653455376625
loss_pred:0.031802382320165634, decouple_loss:0.016203943639993668
The generated pressure mean: 0.4542063772678375
loss_pred:0.03156798705458641, decouple_loss:0.0161313246935606
Iteration: 765, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45757168531417847
The generated pressure mean: 0.45941099524497986
loss_pred:0.031990211457014084, decouple_loss:0.016190122812986374
loss_pred:0.033873412758111954, decouple_loss:0.016083769500255585
The generated pressure mean: 0.4460296630859375
loss_pred:0.0311239343136549, decouple_loss:0.016198793426156044
Iteration: 766, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4334929287433624
The generated pressure mean: 0.4423852562904358
loss_pred:0.03270525857806206, decouple_loss:0.017360767349600792
loss_pred:0.032561447471380234, decouple_loss:0.017234470695257187
The generated pressure mean: 0.4417894780635834
loss_pred:0.03259939327836037, decouple_loss:0.017282569780945778
Iteration: 767, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486424922943115
loss_pred:0.03243929147720337, decouple_loss:0.017869286239147186
The generated pressure mean: 0.44824928045272827
loss_pred:0.03216660022735596, decouple_loss:0.018007930368185043
The generated pressure mean: 0.4503004848957062
loss_pred:0.03282683342695236, decouple_loss:0.01786702498793602
Iteration: 768, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44932571053504944
The generated pressure mean: 0.44790878891944885
loss_pred:0.031371038407087326, decouple_loss:0.01815827004611492
loss_pred:0.031825531274080276, decouple_loss:0.018274584785103798
The generated pressure mean: 0.4499359726905823
loss_pred:0.032062362879514694, decouple_loss:0.01810612715780735
Iteration: 769, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488426744937897
loss_pred:0.03176562115550041, decouple_loss:0.015960395336151123
The generated pressure mean: 0.4464495778083801
loss_pred:0.03327763080596924, decouple_loss:0.016445696353912354
The generated pressure mean: 0.457231342792511
loss_pred:0.03201507404446602, decouple_loss:0.01616722159087658
Iteration: 770, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44822245836257935
The generated pressure mean: 0.45902594923973083
loss_pred:0.034619301557540894, decouple_loss:0.01692056655883789
loss_pred:0.03319340571761131, decouple_loss:0.01641390472650528
The generated pressure mean: 0.44595634937286377
loss_pred:0.031954988837242126, decouple_loss:0.016308709979057312
2023-04-16 15:12:18 testing...
The generated pressure mean: 0.4216354191303253
The generated pressure mean: 0.42791885137557983
The generated pressure mean: 0.4304387867450714
loss_pred:0.04116426780819893, decouple_loss:0.017013978213071823
loss_pred:0.04020249843597412, decouple_loss:0.017457155510783195
loss_pred:0.03908812627196312, decouple_loss:0.01752440072596073
WV_0_PC_0_EH_1_PS_40, loss: 0.041018225252628326, avg_mse: 0.050496723502874374
current test mse: 0.050497
Iteration: 771, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4446060061454773
loss_pred:0.03349820151925087, decouple_loss:0.016328239813447
The generated pressure mean: 0.4485599994659424
loss_pred:0.03163529559969902, decouple_loss:0.016670823097229004
The generated pressure mean: 0.4393177032470703
loss_pred:0.032823532819747925, decouple_loss:0.01665169559419155
Iteration: 772, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45037350058555603
The generated pressure mean: 0.44858041405677795
loss_pred:0.03355933725833893, decouple_loss:0.018198100849986076
loss_pred:0.032722629606723785, decouple_loss:0.018407486379146576
The generated pressure mean: 0.4478171169757843
loss_pred:0.03226715326309204, decouple_loss:0.018782764673233032
Iteration: 773, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44563838839530945
loss_pred:0.03152673318982124, decouple_loss:0.01887507364153862
The generated pressure mean: 0.4512993395328522
loss_pred:0.03233463317155838, decouple_loss:0.019053539261221886
The generated pressure mean: 0.442280113697052
loss_pred:0.032053470611572266, decouple_loss:0.018721437081694603
Iteration: 774, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44758206605911255
The generated pressure mean: 0.44700369238853455
loss_pred:0.03261302784085274, decouple_loss:0.019514089450240135
loss_pred:0.031935833394527435, decouple_loss:0.01907132938504219
The generated pressure mean: 0.4612257182598114
loss_pred:0.03338220715522766, decouple_loss:0.019678384065628052
Iteration: 775, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42595162987709045
The generated pressure mean: 0.42500510811805725
loss_pred:0.03264873847365379, decouple_loss:0.019610043615102768
loss_pred:0.03277182579040527, decouple_loss:0.019271185621619225
The generated pressure mean: 0.42372390627861023
loss_pred:0.03343893960118294, decouple_loss:0.01958101987838745
Iteration: 776, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.48883867263793945
The generated pressure mean: 0.4879153370857239
loss_pred:0.033701542764902115, decouple_loss:0.019021332263946533
loss_pred:0.03323674574494362, decouple_loss:0.018727215006947517
The generated pressure mean: 0.48117613792419434
loss_pred:0.033451590687036514, decouple_loss:0.018070032820105553
Iteration: 777, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44311660528182983
The generated pressure mean: 0.44181862473487854
loss_pred:0.03185250610113144, decouple_loss:0.01783069036900997
loss_pred:0.0313810296356678, decouple_loss:0.01737268641591072
The generated pressure mean: 0.4413954019546509
loss_pred:0.03222820162773132, decouple_loss:0.01727760210633278
Iteration: 778, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42631253600120544
The generated pressure mean: 0.4206893742084503
loss_pred:0.03201771154999733, decouple_loss:0.01688741333782673
loss_pred:0.03316644951701164, decouple_loss:0.016592033207416534
The generated pressure mean: 0.42601442337036133
loss_pred:0.03243265673518181, decouple_loss:0.01651788130402565
Iteration: 779, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4724804759025574
loss_pred:0.032542403787374496, decouple_loss:0.018490398302674294
The generated pressure mean: 0.4687100350856781
loss_pred:0.03248804807662964, decouple_loss:0.01799226738512516
The generated pressure mean: 0.47372743487358093
loss_pred:0.03248562291264534, decouple_loss:0.017901433631777763
Iteration: 780, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488535225391388
loss_pred:0.031647808849811554, decouple_loss:0.016938991844654083
The generated pressure mean: 0.446621835231781
loss_pred:0.03203434869647026, decouple_loss:0.017344076186418533
The generated pressure mean: 0.4498404264450073
loss_pred:0.033184316009283066, decouple_loss:0.016905829310417175
2023-04-16 15:14:11 testing...
The generated pressure mean: 0.42178261280059814
The generated pressure mean: 0.4274907112121582
loss_pred:0.040470369160175323, decouple_loss:0.01754746027290821
The generated pressure mean: 0.42982950806617737
loss_pred:0.03950479254126549, decouple_loss:0.018066851422190666
loss_pred:0.03878612816333771, decouple_loss:0.018261447548866272
WV_0_PC_0_EH_1_PS_40, loss: 0.04048502445220947, avg_mse: 0.049331456422805786
current test mse: 0.049331
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 781, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4357553720474243
loss_pred:0.03191262111067772, decouple_loss:0.016995785757899284
The generated pressure mean: 0.43653592467308044
loss_pred:0.030170762911438942, decouple_loss:0.01701008528470993
The generated pressure mean: 0.43311741948127747
loss_pred:0.02979997918009758, decouple_loss:0.01670009084045887
Iteration: 782, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4591933488845825
The generated pressure mean: 0.45944273471832275
loss_pred:0.03168393298983574, decouple_loss:0.01616005226969719
loss_pred:0.031084034591913223, decouple_loss:0.01668941229581833
The generated pressure mean: 0.461533784866333
loss_pred:0.031634338200092316, decouple_loss:0.016455771401524544
Iteration: 783, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493706524372101
The generated pressure mean: 0.44817307591438293
loss_pred:0.029845494776964188, decouple_loss:0.017866870388388634
loss_pred:0.031589996069669724, decouple_loss:0.017892448231577873
The generated pressure mean: 0.4511291980743408
loss_pred:0.031183309853076935, decouple_loss:0.01787545531988144
Iteration: 784, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4345684051513672
The generated pressure mean: 0.4340076446533203
loss_pred:0.032162345945835114, decouple_loss:0.01761501654982567
loss_pred:0.03241509571671486, decouple_loss:0.017442572861909866
The generated pressure mean: 0.4360717236995697
loss_pred:0.030598221346735954, decouple_loss:0.017646493390202522
Iteration: 785, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4539719223976135
The generated pressure mean: 0.4524966776371002
loss_pred:0.031461168080568314, decouple_loss:0.01683758571743965
loss_pred:0.03007933683693409, decouple_loss:0.01695706509053707
The generated pressure mean: 0.44865861535072327
loss_pred:0.030669210478663445, decouple_loss:0.017041023820638657
Iteration: 786, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44563427567481995
The generated pressure mean: 0.44949764013290405
loss_pred:0.030895020812749863, decouple_loss:0.016869574785232544
loss_pred:0.03105543740093708, decouple_loss:0.017502810806035995
The generated pressure mean: 0.4507980942726135
loss_pred:0.032636988908052444, decouple_loss:0.01704259030520916
Iteration: 787, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45682263374328613
The generated pressure mean: 0.46241676807403564
loss_pred:0.03057657741010189, decouple_loss:0.01655007153749466
loss_pred:0.032375313341617584, decouple_loss:0.016956932842731476
The generated pressure mean: 0.46544599533081055
loss_pred:0.02971014566719532, decouple_loss:0.01678168773651123
Iteration: 788, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4414140582084656The generated pressure mean: 0.4377215504646301
loss_pred:0.031611960381269455, decouple_loss:0.017876794561743736
loss_pred:0.034743860363960266, decouple_loss:0.01711495965719223
The generated pressure mean: 0.4375746250152588
loss_pred:0.031004633754491806, decouple_loss:0.01745094172656536
Iteration: 789, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.41229602694511414
The generated pressure mean: 0.4054718017578125
loss_pred:0.03294336423277855, decouple_loss:0.017388055101037025
loss_pred:0.033092427998781204, decouple_loss:0.017280787229537964
The generated pressure mean: 0.4015045166015625
loss_pred:0.03411748632788658, decouple_loss:0.017315909266471863
Iteration: 790, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.49009382724761963
loss_pred:0.031084967777132988, decouple_loss:0.01886822283267975
The generated pressure mean: 0.48976579308509827
loss_pred:0.030896581709384918, decouple_loss:0.018738677725195885
The generated pressure mean: 0.4829901456832886
loss_pred:0.03251391276717186, decouple_loss:0.018878992646932602
2023-04-16 15:16:44 testing...
The generated pressure mean: 0.41389894485473633
The generated pressure mean: 0.4200596809387207
The generated pressure mean: 0.4227754771709442
loss_pred:0.04496466740965843, decouple_loss:0.017950888723134995
loss_pred:0.04317053034901619, decouple_loss:0.01863476075232029
loss_pred:0.044155776500701904, decouple_loss:0.018419938161969185
WV_0_PC_0_EH_1_PS_40, loss: 0.045013751834630966, avg_mse: 0.057875849306583405
current test mse: 0.057876
Iteration: 791, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.462275892496109
loss_pred:0.031862594187259674, decouple_loss:0.01721775531768799
The generated pressure mean: 0.46775293350219727
loss_pred:0.03145928680896759, decouple_loss:0.017528407275676727
The generated pressure mean: 0.47389957308769226
loss_pred:0.03239142522215843, decouple_loss:0.018032552674412727
Iteration: 792, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.41088801622390747The generated pressure mean: 0.4072031080722809
loss_pred:0.033170320093631744, decouple_loss:0.017730966210365295
loss_pred:0.03235317021608353, decouple_loss:0.017956534400582314
The generated pressure mean: 0.4176889657974243
loss_pred:0.03197812661528587, decouple_loss:0.01854652538895607
Iteration: 793, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4363277554512024
loss_pred:0.03108874335885048, decouple_loss:0.019709596410393715
The generated pressure mean: 0.4392109215259552
loss_pred:0.031843554228544235, decouple_loss:0.019714588299393654
The generated pressure mean: 0.44341158866882324
loss_pred:0.031375762075185776, decouple_loss:0.01999746635556221
Iteration: 794, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4620879590511322
loss_pred:0.030855128541588783, decouple_loss:0.0192008838057518
The generated pressure mean: 0.4646718502044678
loss_pred:0.032338690012693405, decouple_loss:0.01928008906543255
The generated pressure mean: 0.4603379964828491
loss_pred:0.030825557187199593, decouple_loss:0.019038919359445572
Iteration: 795, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4563697874546051
loss_pred:0.03202955424785614, decouple_loss:0.017753640189766884
The generated pressure mean: 0.44872480630874634
loss_pred:0.030207615345716476, decouple_loss:0.017779875546693802
The generated pressure mean: 0.450122207403183
loss_pred:0.03143063560128212, decouple_loss:0.01768612675368786
Iteration: 796, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4398038387298584
loss_pred:0.030974874272942543, decouple_loss:0.01920759677886963
The generated pressure mean: 0.4400218427181244
loss_pred:0.03209035098552704, decouple_loss:0.0179875660687685
The generated pressure mean: 0.43929752707481384
loss_pred:0.031027842313051224, decouple_loss:0.018332190811634064
Iteration: 797, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4455362856388092
loss_pred:0.03167480230331421, decouple_loss:0.017980970442295074
The generated pressure mean: 0.44569939374923706
loss_pred:0.029212711378932, decouple_loss:0.017874011769890785
The generated pressure mean: 0.44658541679382324
loss_pred:0.031551800668239594, decouple_loss:0.017353419214487076
Iteration: 798, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46263936161994934
The generated pressure mean: 0.463196337223053
loss_pred:0.03141123056411743, decouple_loss:0.01865495927631855
loss_pred:0.031738169491291046, decouple_loss:0.01864289492368698
The generated pressure mean: 0.46422505378723145
loss_pred:0.030318202450871468, decouple_loss:0.018632875755429268
Iteration: 799, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442408084869385
loss_pred:0.03093581832945347, decouple_loss:0.018110111355781555
The generated pressure mean: 0.4499363899230957
loss_pred:0.03090844303369522, decouple_loss:0.017983555793762207
The generated pressure mean: 0.4427528381347656
loss_pred:0.031373657286167145, decouple_loss:0.01800767332315445
Iteration: 800, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42786118388175964
loss_pred:0.030654065310955048, decouple_loss:0.01755576580762863
The generated pressure mean: 0.43136969208717346
loss_pred:0.030907990410923958, decouple_loss:0.01742342859506607
The generated pressure mean: 0.42776986956596375
loss_pred:0.031580280512571335, decouple_loss:0.017447950318455696
2023-04-16 15:18:39 testing...
The generated pressure mean: 0.4178787171840668
The generated pressure mean: 0.42382562160491943
The generated pressure mean: 0.4258783161640167
loss_pred:0.041061047464609146, decouple_loss:0.01845250464975834
loss_pred:0.03966611251235008, decouple_loss:0.01890130527317524
loss_pred:0.03914914280176163, decouple_loss:0.019059857353568077
WV_0_PC_0_EH_1_PS_40, loss: 0.040898993611335754, avg_mse: 0.050225213170051575
current test mse: 0.050225
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 801, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448465496301651
loss_pred:0.03003031387925148, decouple_loss:0.018152400851249695
The generated pressure mean: 0.4514000713825226
loss_pred:0.0320943146944046, decouple_loss:0.017900794744491577
The generated pressure mean: 0.44963493943214417
loss_pred:0.03214346244931221, decouple_loss:0.018030403181910515
Iteration: 802, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4654291570186615
loss_pred:0.03175130486488342, decouple_loss:0.017061443999409676
The generated pressure mean: 0.4645654559135437
loss_pred:0.03144165873527527, decouple_loss:0.01727941446006298
The generated pressure mean: 0.4557664394378662
loss_pred:0.032049987465143204, decouple_loss:0.017437508329749107
Iteration: 803, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4258967936038971
The generated pressure mean: 0.4353657364845276
loss_pred:0.03241945430636406, decouple_loss:0.017830751836299896
loss_pred:0.03129826858639717, decouple_loss:0.01736336201429367
The generated pressure mean: 0.43575093150138855
loss_pred:0.031241945922374725, decouple_loss:0.01760331355035305
Iteration: 804, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43336305022239685
The generated pressure mean: 0.4325067400932312
loss_pred:0.030275464057922363, decouple_loss:0.01811649091541767
loss_pred:0.02998923324048519, decouple_loss:0.018092608079314232
The generated pressure mean: 0.4348313808441162
loss_pred:0.0312386192381382, decouple_loss:0.01821058616042137
Iteration: 805, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45886650681495667
loss_pred:0.03208295255899429, decouple_loss:0.0177605003118515
The generated pressure mean: 0.4572780430316925
loss_pred:0.030638031661510468, decouple_loss:0.01799231767654419
The generated pressure mean: 0.46003711223602295
loss_pred:0.029617851600050926, decouple_loss:0.01786823384463787
Iteration: 806, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46388527750968933
The generated pressure mean: 0.4678303599357605
loss_pred:0.03173398971557617, decouple_loss:0.017098601907491684
loss_pred:0.03104175627231598, decouple_loss:0.0166045930236578
The generated pressure mean: 0.46227556467056274
loss_pred:0.03134184703230858, decouple_loss:0.01694323681294918
Iteration: 807, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4307945668697357
loss_pred:0.032011404633522034, decouple_loss:0.01695292443037033
The generated pressure mean: 0.4357648491859436
loss_pred:0.030533168464899063, decouple_loss:0.01699524186551571
The generated pressure mean: 0.43824777007102966
loss_pred:0.030535591766238213, decouple_loss:0.016664672642946243
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 808, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43583187460899353
The generated pressure mean: 0.4305900037288666
loss_pred:0.032691262662410736, decouple_loss:0.015861371532082558
loss_pred:0.031158331781625748, decouple_loss:0.015703320503234863
The generated pressure mean: 0.4352482855319977
loss_pred:0.03047911450266838, decouple_loss:0.016065457835793495
Iteration: 809, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44904765486717224
loss_pred:0.030236203223466873, decouple_loss:0.016809403896331787
The generated pressure mean: 0.44780275225639343
loss_pred:0.031593576073646545, decouple_loss:0.01659245602786541
The generated pressure mean: 0.45561158657073975
loss_pred:0.029778683558106422, decouple_loss:0.016695845872163773
Iteration: 810, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45373791456222534
The generated pressure mean: 0.4519503712654114
loss_pred:0.03127247840166092, decouple_loss:0.01615329645574093
loss_pred:0.03065704181790352, decouple_loss:0.015478882938623428
The generated pressure mean: 0.4492969810962677
loss_pred:0.031100034713745117, decouple_loss:0.01575307548046112
2023-04-16 15:21:13 testing...
The generated pressure mean: 0.4192682206630707
The generated pressure mean: 0.42490774393081665
loss_pred:0.03942246362566948, decouple_loss:0.0172543004155159
The generated pressure mean: 0.4273586571216583
loss_pred:0.03867121785879135, decouple_loss:0.017879536375403404
loss_pred:0.0379553884267807, decouple_loss:0.017990300431847572
WV_0_PC_0_EH_1_PS_40, loss: 0.039568424224853516, avg_mse: 0.04802827537059784
current test mse: 0.048028
Iteration: 811, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4432238042354584
loss_pred:0.030515480786561966, decouple_loss:0.01651744544506073
The generated pressure mean: 0.44038257002830505
loss_pred:0.030714528635144234, decouple_loss:0.016477787867188454
The generated pressure mean: 0.44477057456970215
loss_pred:0.030409451574087143, decouple_loss:0.016141092404723167
Iteration: 812, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44997817277908325
loss_pred:0.02967827022075653, decouple_loss:0.014859474264085293
The generated pressure mean: 0.4369278848171234
loss_pred:0.03233321011066437, decouple_loss:0.015411477535963058
The generated pressure mean: 0.4453430473804474
loss_pred:0.03057009167969227, decouple_loss:0.01489824615418911
Iteration: 813, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446392685174942
loss_pred:0.03228306025266647, decouple_loss:0.015987973660230637
The generated pressure mean: 0.44750794768333435
loss_pred:0.03160266950726509, decouple_loss:0.01589706353843212
The generated pressure mean: 0.44305720925331116
loss_pred:0.031633514910936356, decouple_loss:0.015845084562897682
Iteration: 814, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4553222060203552
loss_pred:0.030187057331204414, decouple_loss:0.015561423264443874
The generated pressure mean: 0.45389801263809204
loss_pred:0.030297089368104935, decouple_loss:0.015415521338582039
The generated pressure mean: 0.4556119740009308
loss_pred:0.03334349766373634, decouple_loss:0.01515558548271656
Iteration: 815, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45034059882164
loss_pred:0.030716819688677788, decouple_loss:0.01569935493171215
The generated pressure mean: 0.45265457034111023
loss_pred:0.03158457949757576, decouple_loss:0.015433767810463905
The generated pressure mean: 0.45037853717803955
loss_pred:0.031035736203193665, decouple_loss:0.015880541875958443
Iteration: 816, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4287331998348236
loss_pred:0.03070995956659317, decouple_loss:0.015552778728306293
The generated pressure mean: 0.4294697046279907
loss_pred:0.031786203384399414, decouple_loss:0.015639908611774445
The generated pressure mean: 0.42784395813941956
loss_pred:0.030338535085320473, decouple_loss:0.016087669879198074
Iteration: 817, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475230872631073
loss_pred:0.031141025945544243, decouple_loss:0.016065064817667007
The generated pressure mean: 0.45190584659576416
loss_pred:0.030863869935274124, decouple_loss:0.016566423699259758
The generated pressure mean: 0.4498264789581299
loss_pred:0.030902991071343422, decouple_loss:0.016316121444106102
Iteration: 818, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4659508168697357
loss_pred:0.03261227533221245, decouple_loss:0.015533586032688618
The generated pressure mean: 0.4549046754837036
loss_pred:0.030274733901023865, decouple_loss:0.01520891860127449
The generated pressure mean: 0.45456093549728394
loss_pred:0.030076170340180397, decouple_loss:0.015241870656609535
Iteration: 819, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452565014362335
loss_pred:0.029578031972050667, decouple_loss:0.015402785502374172
The generated pressure mean: 0.440211683511734
loss_pred:0.032223571091890335, decouple_loss:0.01539827510714531
The generated pressure mean: 0.441735178232193
loss_pred:0.030786272138357162, decouple_loss:0.015626123175024986
Iteration: 820, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43924614787101746
loss_pred:0.030199561268091202, decouple_loss:0.01718234270811081
The generated pressure mean: 0.43628522753715515
loss_pred:0.0297438595443964, decouple_loss:0.017399076372385025
The generated pressure mean: 0.4345313012599945
loss_pred:0.030512701719999313, decouple_loss:0.017164109274744987
2023-04-16 15:23:07 testing...
The generated pressure mean: 0.41768136620521545
The generated pressure mean: 0.423338919878006
The generated pressure mean: 0.4260610044002533
loss_pred:0.039736099541187286, decouple_loss:0.018249833956360817loss_pred:0.04062969982624054, decouple_loss:0.01781494729220867
loss_pred:0.039225369691848755, decouple_loss:0.01835077628493309
WV_0_PC_0_EH_1_PS_40, loss: 0.040770649909973145, avg_mse: 0.0504271574318409
current test mse: 0.050427
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 821, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45476779341697693
loss_pred:0.0303762536495924, decouple_loss:0.017386145889759064
The generated pressure mean: 0.4513396918773651
loss_pred:0.031969454139471054, decouple_loss:0.017242398113012314
The generated pressure mean: 0.4486640691757202
loss_pred:0.03047223575413227, decouple_loss:0.01727743074297905
Iteration: 822, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45087069272994995
The generated pressure mean: 0.4477894902229309
loss_pred:0.03153369575738907, decouple_loss:0.0180670116096735
loss_pred:0.03196163475513458, decouple_loss:0.018117481842637062
The generated pressure mean: 0.44916537404060364
loss_pred:0.03163265809416771, decouple_loss:0.018052805215120316
Iteration: 823, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44591066241264343
loss_pred:0.030592843890190125, decouple_loss:0.015865501016378403
The generated pressure mean: 0.44888952374458313
loss_pred:0.029828336089849472, decouple_loss:0.01586870849132538
The generated pressure mean: 0.44466128945350647
loss_pred:0.03282412141561508, decouple_loss:0.016036104410886765
Iteration: 824, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484201967716217
loss_pred:0.032677557319402695, decouple_loss:0.016218703240156174
The generated pressure mean: 0.44948747754096985
loss_pred:0.03116506338119507, decouple_loss:0.016205457970499992
The generated pressure mean: 0.4509831666946411
loss_pred:0.03214452415704727, decouple_loss:0.016353674232959747
Iteration: 825, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4271245002746582
loss_pred:0.031489044427871704, decouple_loss:0.018572473898530006
The generated pressure mean: 0.4247104823589325
loss_pred:0.03127446398139, decouple_loss:0.018641464412212372
The generated pressure mean: 0.42948248982429504
loss_pred:0.03027917444705963, decouple_loss:0.019066378474235535
Iteration: 826, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46179234981536865
The generated pressure mean: 0.45546185970306396
loss_pred:0.030955437570810318, decouple_loss:0.017199896275997162
loss_pred:0.030081994831562042, decouple_loss:0.0170616302639246
The generated pressure mean: 0.4561406075954437
loss_pred:0.030853349715471268, decouple_loss:0.01689520664513111
Iteration: 827, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46911153197288513
loss_pred:0.03216976672410965, decouple_loss:0.01722881570458412
The generated pressure mean: 0.4723135232925415
loss_pred:0.030135339125990868, decouple_loss:0.01700645312666893
The generated pressure mean: 0.4685207009315491
loss_pred:0.031424760818481445, decouple_loss:0.017467498779296875
Iteration: 828, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42415255308151245
loss_pred:0.03147542104125023, decouple_loss:0.017348671332001686
The generated pressure mean: 0.42729511857032776
loss_pred:0.03103606216609478, decouple_loss:0.01730808988213539
The generated pressure mean: 0.4235079288482666
loss_pred:0.031466446816921234, decouple_loss:0.01749119535088539
Iteration: 829, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44036832451820374
loss_pred:0.031038397923111916, decouple_loss:0.016271384432911873
The generated pressure mean: 0.44364452362060547
loss_pred:0.03079785592854023, decouple_loss:0.01621958054602146
The generated pressure mean: 0.4445478022098541
loss_pred:0.03058970347046852, decouple_loss:0.01632501929998398
Iteration: 830, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4687962234020233
loss_pred:0.030010124668478966, decouple_loss:0.017013104632496834
The generated pressure mean: 0.4662703573703766
loss_pred:0.03033560886979103, decouple_loss:0.01722426526248455
The generated pressure mean: 0.46450570225715637
loss_pred:0.030275819823145866, decouple_loss:0.016870932653546333
2023-04-16 15:25:39 testing...
The generated pressure mean: 0.4188019037246704
The generated pressure mean: 0.4242611229419708
The generated pressure mean: 0.4265620708465576
loss_pred:0.04036968573927879, decouple_loss:0.018393782898783684
loss_pred:0.03949177265167236, decouple_loss:0.0190571416169405
loss_pred:0.0389040932059288, decouple_loss:0.019083186984062195
WV_0_PC_0_EH_1_PS_40, loss: 0.04053075239062309, avg_mse: 0.04990445077419281
current test mse: 0.049904
Iteration: 831, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4369968771934509
loss_pred:0.03125757351517677, decouple_loss:0.017390934750437737
The generated pressure mean: 0.44051697850227356
loss_pred:0.03234143927693367, decouple_loss:0.01746150106191635
The generated pressure mean: 0.4449984133243561
loss_pred:0.02966141887009144, decouple_loss:0.017576340585947037
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 832, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4356796145439148
loss_pred:0.03107384219765663, decouple_loss:0.017489060759544373
The generated pressure mean: 0.43243110179901123
loss_pred:0.03138124942779541, decouple_loss:0.017929457128047943
The generated pressure mean: 0.43841788172721863
loss_pred:0.03173590078949928, decouple_loss:0.01741872727870941
Iteration: 833, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45165714621543884
loss_pred:0.030906859785318375, decouple_loss:0.01780369132757187
The generated pressure mean: 0.4486064314842224
loss_pred:0.030730728060007095, decouple_loss:0.01785191521048546
The generated pressure mean: 0.4479435682296753
loss_pred:0.030082518234848976, decouple_loss:0.017303530126810074
Iteration: 834, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4580952525138855
loss_pred:0.0313720703125, decouple_loss:0.016807613894343376
The generated pressure mean: 0.45528271794319153
loss_pred:0.03145339712500572, decouple_loss:0.016812926158308983
The generated pressure mean: 0.4542435109615326
loss_pred:0.03131406009197235, decouple_loss:0.016667529940605164
Iteration: 835, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44918349385261536
loss_pred:0.031877245754003525, decouple_loss:0.014772535301744938
The generated pressure mean: 0.4469926357269287
loss_pred:0.030899768695235252, decouple_loss:0.014749431051313877
The generated pressure mean: 0.4506278932094574
loss_pred:0.03136468306183815, decouple_loss:0.014853856526315212
Iteration: 836, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44228658080101013
loss_pred:0.03128247335553169, decouple_loss:0.01624070294201374
The generated pressure mean: 0.43885189294815063
loss_pred:0.030314922332763672, decouple_loss:0.01630079746246338
The generated pressure mean: 0.44499942660331726
loss_pred:0.02964092418551445, decouple_loss:0.016400184482336044
Iteration: 837, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492333233356476
loss_pred:0.030775340273976326, decouple_loss:0.01650521717965603
The generated pressure mean: 0.4444025158882141
loss_pred:0.030941834673285484, decouple_loss:0.016107695177197456
The generated pressure mean: 0.4501386284828186
loss_pred:0.030434176325798035, decouple_loss:0.016274716705083847
Iteration: 838, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4513796269893646
loss_pred:0.031096672639250755, decouple_loss:0.016323331743478775
The generated pressure mean: 0.4466473162174225
loss_pred:0.03162277117371559, decouple_loss:0.01596783846616745
The generated pressure mean: 0.452658474445343
loss_pred:0.03121913969516754, decouple_loss:0.01635236106812954
Iteration: 839, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44876155257225037
loss_pred:0.029542172327637672, decouple_loss:0.014598104171454906
The generated pressure mean: 0.4488121569156647
loss_pred:0.029700439423322678, decouple_loss:0.014359998516738415
The generated pressure mean: 0.44604456424713135
loss_pred:0.029487481340765953, decouple_loss:0.014504040591418743
Iteration: 840, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44176632165908813
loss_pred:0.03058193251490593, decouple_loss:0.0152716264128685
The generated pressure mean: 0.4443880319595337
loss_pred:0.030131973326206207, decouple_loss:0.015298305079340935
The generated pressure mean: 0.4395061135292053
loss_pred:0.0314471460878849, decouple_loss:0.015135225839912891
2023-04-16 15:27:33 testing...
The generated pressure mean: 0.4176124632358551
The generated pressure mean: 0.4232577979564667
The generated pressure mean: 0.4259570240974426
loss_pred:0.0397428534924984, decouple_loss:0.015534790232777596
loss_pred:0.03894263878464699, decouple_loss:0.016106976196169853
loss_pred:0.03826248645782471, decouple_loss:0.016218267381191254
WV_0_PC_0_EH_1_PS_40, loss: 0.039780326187610626, avg_mse: 0.049053892493247986
current test mse: 0.049054
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 841, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45583608746528625
loss_pred:0.031129566952586174, decouple_loss:0.01398453302681446
The generated pressure mean: 0.4481128752231598
The generated pressure mean: 0.45206400752067566
loss_pred:0.029965681955218315, decouple_loss:0.014245805330574512
loss_pred:0.03068169206380844, decouple_loss:0.014085273258388042
Iteration: 842, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4434477686882019
loss_pred:0.030631454661488533, decouple_loss:0.01576145552098751
The generated pressure mean: 0.4434490203857422
loss_pred:0.030514072626829147, decouple_loss:0.015776533633470535
The generated pressure mean: 0.44258350133895874
loss_pred:0.03030003048479557, decouple_loss:0.015566582791507244
Iteration: 843, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45189911127090454
The generated pressure mean: 0.4465799927711487loss_pred:0.03074202686548233, decouple_loss:0.016393518075346947
loss_pred:0.030569080263376236, decouple_loss:0.016254719346761703
The generated pressure mean: 0.44705069065093994
loss_pred:0.03031848557293415, decouple_loss:0.016172844916582108
Iteration: 844, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4440939128398895
loss_pred:0.02945357747375965, decouple_loss:0.016007691621780396
The generated pressure mean: 0.43968021869659424
loss_pred:0.03140686824917793, decouple_loss:0.015515283681452274
The generated pressure mean: 0.44981077313423157
loss_pred:0.028927011415362358, decouple_loss:0.015633268281817436
Iteration: 845, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4418017864227295
The generated pressure mean: 0.4432426691055298loss_pred:0.029833408072590828, decouple_loss:0.016380028799176216
loss_pred:0.029874464496970177, decouple_loss:0.01672878861427307
The generated pressure mean: 0.44095319509506226
loss_pred:0.03117949329316616, decouple_loss:0.016367828473448753
Iteration: 846, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45203351974487305
loss_pred:0.02963162772357464, decouple_loss:0.01737881451845169
The generated pressure mean: 0.4559347927570343
loss_pred:0.030333295464515686, decouple_loss:0.017119161784648895
The generated pressure mean: 0.45545223355293274
loss_pred:0.02991671860218048, decouple_loss:0.01707475073635578
Iteration: 847, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4533390998840332
loss_pred:0.02916029840707779, decouple_loss:0.01646428182721138
The generated pressure mean: 0.44519907236099243
loss_pred:0.03181421384215355, decouple_loss:0.016186267137527466
The generated pressure mean: 0.4564940631389618
loss_pred:0.029191207140684128, decouple_loss:0.016312895342707634
Iteration: 848, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4350467920303345
loss_pred:0.03131857514381409, decouple_loss:0.015360585413873196
The generated pressure mean: 0.4380359649658203
loss_pred:0.029267167672514915, decouple_loss:0.015081746503710747
The generated pressure mean: 0.4357968866825104
loss_pred:0.031134534627199173, decouple_loss:0.015378220938146114
Iteration: 849, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45900973677635193
loss_pred:0.03003508597612381, decouple_loss:0.0149189168587327
The generated pressure mean: 0.452316015958786
loss_pred:0.03095223195850849, decouple_loss:0.015067078173160553
The generated pressure mean: 0.4536590278148651
loss_pred:0.03067929297685623, decouple_loss:0.015070966444909573
Iteration: 850, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44521835446357727
loss_pred:0.03009861707687378, decouple_loss:0.014710400253534317
The generated pressure mean: 0.4466056227684021
loss_pred:0.030025899410247803, decouple_loss:0.01458248682320118
The generated pressure mean: 0.44581905007362366
loss_pred:0.029891373589634895, decouple_loss:0.014330272562801838
2023-04-16 15:30:07 testing...
The generated pressure mean: 0.42061570286750793
The generated pressure mean: 0.4263383448123932
The generated pressure mean: 0.4287059009075165
loss_pred:0.0383630134165287, decouple_loss:0.016293112188577652
loss_pred:0.03755089268088341, decouple_loss:0.01704353839159012
loss_pred:0.037210360169410706, decouple_loss:0.01706511154770851
WV_0_PC_0_EH_1_PS_40, loss: 0.038548119366168976, avg_mse: 0.046842511743307114
current test mse: 0.046843
Iteration: 851, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43882620334625244
loss_pred:0.02984721213579178, decouple_loss:0.015319572761654854
The generated pressure mean: 0.44302359223365784
loss_pred:0.029001852497458458, decouple_loss:0.015103894285857677
The generated pressure mean: 0.44103536009788513
loss_pred:0.02904122695326805, decouple_loss:0.01550083514302969
Iteration: 852, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44315841794013977
loss_pred:0.029314227402210236, decouple_loss:0.016364499926567078
The generated pressure mean: 0.4468120038509369
loss_pred:0.02978871949017048, decouple_loss:0.016329821199178696
The generated pressure mean: 0.4422489404678345
loss_pred:0.029867025092244148, decouple_loss:0.01649138145148754
Iteration: 853, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4633733928203583
loss_pred:0.028663698583841324, decouple_loss:0.018482279032468796
The generated pressure mean: 0.45895782113075256
loss_pred:0.03014383465051651, decouple_loss:0.018243957310914993
The generated pressure mean: 0.46289926767349243
loss_pred:0.03181660920381546, decouple_loss:0.018328141421079636
Iteration: 854, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4339032769203186
loss_pred:0.02986173704266548, decouple_loss:0.016127629205584526
The generated pressure mean: 0.4344436228275299
loss_pred:0.029790634289383888, decouple_loss:0.016024667769670486
The generated pressure mean: 0.43444880843162537
loss_pred:0.029428692534565926, decouple_loss:0.01637907698750496
Iteration: 855, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44600793719291687
The generated pressure mean: 0.44044655561447144
loss_pred:0.0300834272056818, decouple_loss:0.014725674875080585
loss_pred:0.03030041977763176, decouple_loss:0.0146704176440835
The generated pressure mean: 0.44596239924430847
loss_pred:0.029513435438275337, decouple_loss:0.014461160637438297
Iteration: 856, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4550864100456238
loss_pred:0.029424382373690605, decouple_loss:0.01618560217320919
The generated pressure mean: 0.45488327741622925
loss_pred:0.031351860612630844, decouple_loss:0.016458559781312943
The generated pressure mean: 0.45715102553367615
loss_pred:0.030743159353733063, decouple_loss:0.016290875151753426
Iteration: 857, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4444429874420166
The generated pressure mean: 0.4422405958175659loss_pred:0.029087474569678307, decouple_loss:0.0180211141705513
loss_pred:0.02978413552045822, decouple_loss:0.018058083951473236
The generated pressure mean: 0.4433198869228363
loss_pred:0.030595457181334496, decouple_loss:0.017880182713270187
Iteration: 858, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4418521523475647
loss_pred:0.029915086925029755, decouple_loss:0.01614351011812687
The generated pressure mean: 0.44313153624534607
loss_pred:0.029181214049458504, decouple_loss:0.01607733964920044
The generated pressure mean: 0.43711158633232117
loss_pred:0.031452957540750504, decouple_loss:0.016159355640411377
Iteration: 859, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4511900842189789
loss_pred:0.030680401250720024, decouple_loss:0.01538756862282753
The generated pressure mean: 0.45005935430526733
The generated pressure mean: 0.45856064558029175
loss_pred:0.03082863800227642, decouple_loss:0.015239965170621872
loss_pred:0.029476473107933998, decouple_loss:0.015584143809974194
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 860, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4426860213279724
loss_pred:0.030271301046013832, decouple_loss:0.017078328877687454
The generated pressure mean: 0.44732704758644104
loss_pred:0.02998337149620056, decouple_loss:0.016973474994301796
The generated pressure mean: 0.44777795672416687
loss_pred:0.029204241931438446, decouple_loss:0.017184562981128693
2023-04-16 15:32:01 testing...
The generated pressure mean: 0.41906291246414185
The generated pressure mean: 0.42491650581359863
The generated pressure mean: 0.4270693361759186
loss_pred:0.03920021280646324, decouple_loss:0.01753877103328705
loss_pred:0.03833350911736488, decouple_loss:0.018225783482193947
loss_pred:0.037603992968797684, decouple_loss:0.01829284429550171
WV_0_PC_0_EH_1_PS_40, loss: 0.03928019851446152, avg_mse: 0.04826076701283455
current test mse: 0.048261
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 861, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44821277260780334
loss_pred:0.03053128346800804, decouple_loss:0.016407160088419914
The generated pressure mean: 0.4495428502559662
loss_pred:0.027888862416148186, decouple_loss:0.016732603311538696
The generated pressure mean: 0.4482702314853668
loss_pred:0.028377331793308258, decouple_loss:0.01662846840918064
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 862, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4509257674217224
loss_pred:0.030221959576010704, decouple_loss:0.01534965168684721
The generated pressure mean: 0.4512929320335388
loss_pred:0.030627503991127014, decouple_loss:0.01541487779468298
The generated pressure mean: 0.45347654819488525
loss_pred:0.02999291382730007, decouple_loss:0.015415862202644348
Iteration: 863, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43984800577163696
loss_pred:0.029902668669819832, decouple_loss:0.016764046624302864
The generated pressure mean: 0.43718191981315613
loss_pred:0.031741913408041, decouple_loss:0.01679869368672371
The generated pressure mean: 0.43532079458236694
loss_pred:0.03019041195511818, decouple_loss:0.016586849465966225
Iteration: 864, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4397638440132141
loss_pred:0.030433494597673416, decouple_loss:0.016759047284722328
The generated pressure mean: 0.44419869780540466
loss_pred:0.03048120066523552, decouple_loss:0.016846053302288055
The generated pressure mean: 0.4479764401912689
loss_pred:0.03172755613923073, decouple_loss:0.016854828223586082
Iteration: 865, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4619242548942566
The generated pressure mean: 0.45888856053352356
loss_pred:0.030721411108970642, decouple_loss:0.0161131639033556
loss_pred:0.03301409259438515, decouple_loss:0.016029536724090576
The generated pressure mean: 0.45980173349380493
loss_pred:0.030780840665102005, decouple_loss:0.016084833070635796
Iteration: 866, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487502872943878
loss_pred:0.029899295419454575, decouple_loss:0.016488216817378998
The generated pressure mean: 0.44520047307014465
loss_pred:0.030738577246665955, decouple_loss:0.01647568680346012
The generated pressure mean: 0.4459971785545349
loss_pred:0.030021246522665024, decouple_loss:0.016714734956622124
Iteration: 867, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4429458677768707
loss_pred:0.029913082718849182, decouple_loss:0.01572754792869091
The generated pressure mean: 0.43786007165908813
loss_pred:0.030827786773443222, decouple_loss:0.015402532182633877
The generated pressure mean: 0.44316866993904114
loss_pred:0.02846308797597885, decouple_loss:0.015472020953893661
Iteration: 868, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500858783721924
loss_pred:0.03057238459587097, decouple_loss:0.01665184460580349
The generated pressure mean: 0.4530370533466339
loss_pred:0.029401371255517006, decouple_loss:0.016728274524211884
The generated pressure mean: 0.4493822455406189
loss_pred:0.03146762028336525, decouple_loss:0.016695179045200348
Iteration: 869, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4550878405570984
The generated pressure mean: 0.4627859890460968
loss_pred:0.03126459941267967, decouple_loss:0.016938596963882446
loss_pred:0.03149845451116562, decouple_loss:0.01715787872672081
The generated pressure mean: 0.45251035690307617
loss_pred:0.03074181266129017, decouple_loss:0.016907650977373123
Iteration: 870, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43963223695755005
loss_pred:0.03092207945883274, decouple_loss:0.016522277146577835
The generated pressure mean: 0.44031432271003723
loss_pred:0.02938435785472393, decouple_loss:0.016171282157301903
The generated pressure mean: 0.4314921200275421
loss_pred:0.031143950298428535, decouple_loss:0.01657174713909626
2023-04-16 15:34:38 testing...
The generated pressure mean: 0.4184124767780304
The generated pressure mean: 0.4242558777332306
loss_pred:0.039042990654706955, decouple_loss:0.016565285623073578
The generated pressure mean: 0.42692846059799194
loss_pred:0.03837033733725548, decouple_loss:0.017187394201755524
loss_pred:0.03761299327015877, decouple_loss:0.017155377194285393
WV_0_PC_0_EH_1_PS_40, loss: 0.03919057548046112, avg_mse: 0.04844394326210022
current test mse: 0.048444
Iteration: 871, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4519299566745758
The generated pressure mean: 0.4520286023616791
loss_pred:0.029484331607818604, decouple_loss:0.015508955344557762
loss_pred:0.028354959562420845, decouple_loss:0.015651647001504898
The generated pressure mean: 0.4508669972419739
loss_pred:0.028717851266264915, decouple_loss:0.015629244968295097
Iteration: 872, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4572470784187317
loss_pred:0.02972470596432686, decouple_loss:0.015246016904711723
The generated pressure mean: 0.44620281457901
loss_pred:0.03096545860171318, decouple_loss:0.015550738200545311
The generated pressure mean: 0.44750675559043884
loss_pred:0.03088507615029812, decouple_loss:0.015931785106658936
Iteration: 873, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4404585361480713
loss_pred:0.02980518527328968, decouple_loss:0.015519925393164158
The generated pressure mean: 0.4387388527393341
loss_pred:0.029385603964328766, decouple_loss:0.015492159873247147
The generated pressure mean: 0.4393565058708191
loss_pred:0.030159246176481247, decouple_loss:0.015878260135650635
Iteration: 874, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45927950739860535
loss_pred:0.02877691388130188, decouple_loss:0.016978664323687553
The generated pressure mean: 0.4560316801071167
loss_pred:0.02909514680504799, decouple_loss:0.016752218827605247
The generated pressure mean: 0.4558395743370056
loss_pred:0.03236953169107437, decouple_loss:0.01666155457496643
Iteration: 875, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44560858607292175
loss_pred:0.031156180426478386, decouple_loss:0.016959788277745247
The generated pressure mean: 0.4428345263004303
loss_pred:0.02972252480685711, decouple_loss:0.01737276464700699
The generated pressure mean: 0.4456062912940979
loss_pred:0.030419714748859406, decouple_loss:0.017213808372616768
Iteration: 876, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462030231952667
loss_pred:0.029566964134573936, decouple_loss:0.015610065311193466
The generated pressure mean: 0.4392356872558594
loss_pred:0.030943527817726135, decouple_loss:0.015649339184165
The generated pressure mean: 0.4359853267669678
loss_pred:0.02965298481285572, decouple_loss:0.01546720415353775
Iteration: 877, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4605555832386017
loss_pred:0.029591847211122513, decouple_loss:0.015703139826655388
The generated pressure mean: 0.45683830976486206
loss_pred:0.029627986252307892, decouple_loss:0.01599540375173092
The generated pressure mean: 0.45340919494628906
loss_pred:0.030461110174655914, decouple_loss:0.015738869085907936
Iteration: 878, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44910356402397156
loss_pred:0.028272150084376335, decouple_loss:0.016056399792432785
The generated pressure mean: 0.447758287191391
loss_pred:0.03028370626270771, decouple_loss:0.016243617981672287
The generated pressure mean: 0.44737207889556885
loss_pred:0.029759496450424194, decouple_loss:0.01628190651535988
Iteration: 879, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4394069015979767
loss_pred:0.0315498448908329, decouple_loss:0.015692897140979767
The generated pressure mean: 0.44704800844192505
loss_pred:0.0297311432659626, decouple_loss:0.015607835724949837
The generated pressure mean: 0.4440385401248932
loss_pred:0.029934722930192947, decouple_loss:0.015529469586908817
Iteration: 880, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45081716775894165
loss_pred:0.029777808114886284, decouple_loss:0.017979834228754044
The generated pressure mean: 0.4546610116958618
loss_pred:0.028864750638604164, decouple_loss:0.017920946702361107
The generated pressure mean: 0.44838547706604004
loss_pred:0.03088734671473503, decouple_loss:0.017791708931326866
2023-04-16 15:36:32 testing...
The generated pressure mean: 0.4248404800891876
The generated pressure mean: 0.4185815155506134
loss_pred:0.0379643552005291, decouple_loss:0.01741223782300949
The generated pressure mean: 0.4275444447994232
loss_pred:0.038891393691301346, decouple_loss:0.016707981005311012
loss_pred:0.037077099084854126, decouple_loss:0.017496097832918167
WV_0_PC_0_EH_1_PS_40, loss: 0.03883788734674454, avg_mse: 0.04780244082212448
current test mse: 0.047802
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 881, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.445573091506958
loss_pred:0.029773864895105362, decouple_loss:0.016022298485040665
The generated pressure mean: 0.4489539563655853
loss_pred:0.029210327193140984, decouple_loss:0.01581033505499363
The generated pressure mean: 0.45066383481025696
loss_pred:0.02866285666823387, decouple_loss:0.016036275774240494
Iteration: 882, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44281941652297974
The generated pressure mean: 0.4423706531524658
loss_pred:0.03082876466214657, decouple_loss:0.016018055379390717
loss_pred:0.02946610189974308, decouple_loss:0.015974923968315125
The generated pressure mean: 0.4410580098628998
loss_pred:0.030879678204655647, decouple_loss:0.016568314284086227
Iteration: 883, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499116539955139
loss_pred:0.03086332604289055, decouple_loss:0.016237851232290268
The generated pressure mean: 0.44894272089004517
loss_pred:0.030886374413967133, decouple_loss:0.0163942389190197
The generated pressure mean: 0.44644594192504883
loss_pred:0.03086993843317032, decouple_loss:0.01599457673728466
Iteration: 884, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508213698863983
loss_pred:0.03088129684329033, decouple_loss:0.015388424508273602
The generated pressure mean: 0.44732651114463806
loss_pred:0.030909143388271332, decouple_loss:0.015203944407403469
The generated pressure mean: 0.44888684153556824
loss_pred:0.03030555136501789, decouple_loss:0.016255483031272888
Iteration: 885, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45051589608192444
loss_pred:0.030463233590126038, decouple_loss:0.015854576602578163
The generated pressure mean: 0.4470026195049286
loss_pred:0.031152380630373955, decouple_loss:0.01578661985695362
The generated pressure mean: 0.44886595010757446
loss_pred:0.030780116096138954, decouple_loss:0.016417792066931725
Iteration: 886, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462881088256836
loss_pred:0.030626751482486725, decouple_loss:0.01452883705496788
The generated pressure mean: 0.44629359245300293
loss_pred:0.03121951036155224, decouple_loss:0.014318453148007393
The generated pressure mean: 0.45098382234573364
loss_pred:0.029139159247279167, decouple_loss:0.014146069996058941
Iteration: 887, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496598541736603
loss_pred:0.02934325858950615, decouple_loss:0.015401942655444145
The generated pressure mean: 0.4522571265697479
loss_pred:0.02935977093875408, decouple_loss:0.015506069175899029
The generated pressure mean: 0.45293864607810974
loss_pred:0.0302566047757864, decouple_loss:0.015142595395445824
Iteration: 888, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44571956992149353
loss_pred:0.029492687433958054, decouple_loss:0.01686566136777401
The generated pressure mean: 0.4405013620853424
loss_pred:0.030739055946469307, decouple_loss:0.016895273700356483
The generated pressure mean: 0.4376719892024994
loss_pred:0.030206939205527306, decouple_loss:0.017310086637735367
Iteration: 889, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45118507742881775
loss_pred:0.030866598710417747, decouple_loss:0.01636740006506443
The generated pressure mean: 0.45407742261886597
loss_pred:0.029505394399166107, decouple_loss:0.016265803948044777
The generated pressure mean: 0.4549165368080139
loss_pred:0.03080873191356659, decouple_loss:0.016287215054035187
Iteration: 890, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45001697540283203
loss_pred:0.02911764197051525, decouple_loss:0.017486736178398132
The generated pressure mean: 0.4570452570915222
loss_pred:0.030120933428406715, decouple_loss:0.01750996895134449
The generated pressure mean: 0.45030561089515686
loss_pred:0.030067112296819687, decouple_loss:0.016985969617962837
2023-04-16 15:39:04 testing...
The generated pressure mean: 0.4209429621696472
The generated pressure mean: 0.4269997775554657
The generated pressure mean: 0.42943719029426575
loss_pred:0.03862778842449188, decouple_loss:0.015155473724007607
loss_pred:0.0378800593316555, decouple_loss:0.015326172113418579
loss_pred:0.03719046711921692, decouple_loss:0.015469367615878582
WV_0_PC_0_EH_1_PS_40, loss: 0.0386652909219265, avg_mse: 0.047663506120443344
current test mse: 0.047664
Iteration: 891, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44467902183532715
loss_pred:0.031303562223911285, decouple_loss:0.014430777169764042
The generated pressure mean: 0.4367823004722595
loss_pred:0.029288243502378464, decouple_loss:0.014791003428399563
The generated pressure mean: 0.4413117468357086
loss_pred:0.02897671051323414, decouple_loss:0.014354832470417023
Iteration: 892, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45502039790153503
loss_pred:0.030691301450133324, decouple_loss:0.015360712073743343
The generated pressure mean: 0.4538298547267914
loss_pred:0.030952734872698784, decouple_loss:0.014776308089494705
The generated pressure mean: 0.4478127658367157
loss_pred:0.03006415069103241, decouple_loss:0.014737027697265148
Iteration: 893, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4376738667488098
loss_pred:0.031212717294692993, decouple_loss:0.015737764537334442
The generated pressure mean: 0.4435633420944214
loss_pred:0.030051397159695625, decouple_loss:0.01622396893799305
The generated pressure mean: 0.44428959488868713
loss_pred:0.029872877523303032, decouple_loss:0.01582479104399681
Iteration: 894, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4543909430503845
loss_pred:0.03139108419418335, decouple_loss:0.01659693755209446
The generated pressure mean: 0.450447142124176
loss_pred:0.029757212847471237, decouple_loss:0.0164004135876894
The generated pressure mean: 0.4511871039867401
loss_pred:0.02918802946805954, decouple_loss:0.016244754195213318
Iteration: 895, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45020872354507446
loss_pred:0.03027951531112194, decouple_loss:0.017964713275432587
The generated pressure mean: 0.4515114426612854
loss_pred:0.030442889779806137, decouple_loss:0.017762793228030205
The generated pressure mean: 0.4568592607975006
loss_pred:0.029389413073658943, decouple_loss:0.017592163756489754
Iteration: 896, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491961598396301
loss_pred:0.028550583869218826, decouple_loss:0.015581928193569183
The generated pressure mean: 0.44858649373054504
loss_pred:0.030285142362117767, decouple_loss:0.015372036024928093
The generated pressure mean: 0.44674092531204224
loss_pred:0.030703481286764145, decouple_loss:0.015501417219638824
Iteration: 897, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44312959909439087
loss_pred:0.02922539971768856, decouple_loss:0.014847544021904469
The generated pressure mean: 0.44402942061424255
loss_pred:0.029199954122304916, decouple_loss:0.015016247518360615
The generated pressure mean: 0.4419713318347931
loss_pred:0.03028671257197857, decouple_loss:0.014661084860563278
Iteration: 898, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44465959072113037
loss_pred:0.029092561453580856, decouple_loss:0.015852317214012146
The generated pressure mean: 0.4390656054019928
loss_pred:0.030525753274559975, decouple_loss:0.015935512259602547
The generated pressure mean: 0.4410434365272522
loss_pred:0.031342510133981705, decouple_loss:0.0158549677580595
Iteration: 899, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4656159579753876
loss_pred:0.030959468334913254, decouple_loss:0.01818775199353695
The generated pressure mean: 0.462319552898407
The generated pressure mean: 0.46277526021003723
loss_pred:0.029037751257419586, decouple_loss:0.01801714487373829
loss_pred:0.03162607550621033, decouple_loss:0.018178284168243408
Iteration: 900, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43748268485069275
loss_pred:0.02966991439461708, decouple_loss:0.016134969890117645
The generated pressure mean: 0.43681812286376953
loss_pred:0.030027687549591064, decouple_loss:0.016206271946430206
The generated pressure mean: 0.4351086914539337
loss_pred:0.029881855472922325, decouple_loss:0.016096362844109535
2023-04-16 15:40:58 testing...
The generated pressure mean: 0.420232892036438
The generated pressure mean: 0.4261159300804138
The generated pressure mean: 0.4287276268005371
loss_pred:0.03826826065778732, decouple_loss:0.018240125849843025
loss_pred:0.03697526827454567, decouple_loss:0.018767088651657104
loss_pred:0.03651060536503792, decouple_loss:0.01884770765900612
WV_0_PC_0_EH_1_PS_40, loss: 0.038182295858860016, avg_mse: 0.046385474503040314
current test mse: 0.046385
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 901, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.441351056098938
loss_pred:0.030046775937080383, decouple_loss:0.017729485407471657
The generated pressure mean: 0.4425300657749176
loss_pred:0.028819534927606583, decouple_loss:0.01774878054857254
The generated pressure mean: 0.4417870044708252
loss_pred:0.02863176353275776, decouple_loss:0.018077846616506577
Iteration: 902, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4616394340991974
loss_pred:0.02903630957007408, decouple_loss:0.018543602898716927
The generated pressure mean: 0.4648318886756897
loss_pred:0.029807481914758682, decouple_loss:0.018693866208195686
The generated pressure mean: 0.45987483859062195
loss_pred:0.031973280012607574, decouple_loss:0.018350619822740555
Iteration: 903, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4355654716491699
loss_pred:0.029278762638568878, decouple_loss:0.01780806854367256
The generated pressure mean: 0.43378472328186035
loss_pred:0.02882612869143486, decouple_loss:0.017704110592603683
The generated pressure mean: 0.43812665343284607
loss_pred:0.029197148978710175, decouple_loss:0.01778460666537285
Iteration: 904, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44530168175697327
loss_pred:0.02981080673635006, decouple_loss:0.016591902822256088
The generated pressure mean: 0.44030681252479553
loss_pred:0.030298519879579544, decouple_loss:0.016424519941210747
The generated pressure mean: 0.4460279643535614
loss_pred:0.029216883704066277, decouple_loss:0.016759710386395454
Iteration: 905, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45659932494163513
loss_pred:0.028863364830613136, decouple_loss:0.016800427809357643
The generated pressure mean: 0.45738157629966736
loss_pred:0.030073348432779312, decouple_loss:0.016509639099240303
The generated pressure mean: 0.4500974416732788
loss_pred:0.029349345713853836, decouple_loss:0.016379989683628082
Iteration: 906, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44749772548675537
loss_pred:0.029670817777514458, decouple_loss:0.01584681309759617
The generated pressure mean: 0.43764162063598633
loss_pred:0.029408860951662064, decouple_loss:0.01577223464846611
The generated pressure mean: 0.44104504585266113
loss_pred:0.03070759028196335, decouple_loss:0.01590864174067974
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 907, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45269283652305603
loss_pred:0.030861318111419678, decouple_loss:0.015843689441680908
The generated pressure mean: 0.4441962242126465
loss_pred:0.02900758571922779, decouple_loss:0.015816695988178253
The generated pressure mean: 0.44879844784736633
loss_pred:0.02805139310657978, decouple_loss:0.015869831666350365
Iteration: 908, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44802674651145935
loss_pred:0.029959607869386673, decouple_loss:0.01626559905707836
The generated pressure mean: 0.4500717520713806
loss_pred:0.029989439994096756, decouple_loss:0.01609606109559536
The generated pressure mean: 0.45200231671333313
loss_pred:0.029361935332417488, decouple_loss:0.016005737707018852
Iteration: 909, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44149380922317505
loss_pred:0.029592137783765793, decouple_loss:0.015862135216593742
The generated pressure mean: 0.4466339647769928
loss_pred:0.029859518632292747, decouple_loss:0.015488788485527039
The generated pressure mean: 0.43979862332344055
loss_pred:0.029680974781513214, decouple_loss:0.01572665199637413
Iteration: 910, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4445447325706482
loss_pred:0.02977880835533142, decouple_loss:0.01655171811580658
The generated pressure mean: 0.44788023829460144
loss_pred:0.028965940698981285, decouple_loss:0.0166122205555439
The generated pressure mean: 0.44257184863090515
loss_pred:0.030871199443936348, decouple_loss:0.016645468771457672
2023-04-16 15:43:31 testing...
The generated pressure mean: 0.41632694005966187
The generated pressure mean: 0.4230394959449768
The generated pressure mean: 0.42562979459762573
loss_pred:0.04038434103131294, decouple_loss:0.016653919592499733
loss_pred:0.03905181214213371, decouple_loss:0.01714511029422283
loss_pred:0.0384647361934185, decouple_loss:0.01727065071463585
WV_0_PC_0_EH_1_PS_40, loss: 0.040151458233594894, avg_mse: 0.05068987235426903
current test mse: 0.05069
Iteration: 911, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4651128947734833
loss_pred:0.029685379937291145, decouple_loss:0.01628343015909195
The generated pressure mean: 0.4565943777561188
loss_pred:0.02809513360261917, decouple_loss:0.01600387878715992
The generated pressure mean: 0.4597132205963135
loss_pred:0.030049622058868408, decouple_loss:0.01594000868499279
Iteration: 912, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.440561443567276
loss_pred:0.029370654374361038, decouple_loss:0.016178758814930916
The generated pressure mean: 0.44702112674713135
loss_pred:0.029643680900335312, decouple_loss:0.01618301495909691
The generated pressure mean: 0.44601237773895264
loss_pred:0.029282402247190475, decouple_loss:0.015898769721388817
Iteration: 913, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4409855306148529
loss_pred:0.030515458434820175, decouple_loss:0.015222420915961266
The generated pressure mean: 0.4357549548149109
loss_pred:0.029050903394818306, decouple_loss:0.015156886540353298
The generated pressure mean: 0.4304753839969635
loss_pred:0.028321031481027603, decouple_loss:0.015176753513514996
Iteration: 914, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45034271478652954
loss_pred:0.028854498639702797, decouple_loss:0.015402195043861866
The generated pressure mean: 0.44811689853668213
loss_pred:0.02826857939362526, decouple_loss:0.015700699761509895
The generated pressure mean: 0.4547704756259918
loss_pred:0.028314847499132156, decouple_loss:0.015475982800126076
Iteration: 915, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4582495093345642
loss_pred:0.028118928894400597, decouple_loss:0.014803138561546803
The generated pressure mean: 0.4486919045448303
loss_pred:0.028642412275075912, decouple_loss:0.015046989545226097
The generated pressure mean: 0.4493143558502197
loss_pred:0.02866632118821144, decouple_loss:0.01470483560115099
Iteration: 916, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470818340778351
The generated pressure mean: 0.44100064039230347
loss_pred:0.028842175379395485, decouple_loss:0.014672544784843922
loss_pred:0.02840062975883484, decouple_loss:0.014439296908676624
The generated pressure mean: 0.44640976190567017
loss_pred:0.02932647429406643, decouple_loss:0.014624803327023983
Iteration: 917, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4439467191696167
The generated pressure mean: 0.44637271761894226
loss_pred:0.02923245169222355, decouple_loss:0.016171829774975777
loss_pred:0.029269376769661903, decouple_loss:0.016181400045752525
The generated pressure mean: 0.4469864070415497
loss_pred:0.030081002041697502, decouple_loss:0.016307812184095383
Iteration: 918, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4439759850502014
The generated pressure mean: 0.4454009234905243
loss_pred:0.029913680627942085, decouple_loss:0.015846027061343193
loss_pred:0.028887541964650154, decouple_loss:0.01562848687171936
The generated pressure mean: 0.44628793001174927
loss_pred:0.029869306832551956, decouple_loss:0.01567152701318264
Iteration: 919, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463493227958679The generated pressure mean: 0.446550577878952
loss_pred:0.028509417548775673, decouple_loss:0.015488428995013237loss_pred:0.02989237941801548, decouple_loss:0.015698779374361038
The generated pressure mean: 0.4414869248867035
loss_pred:0.029061967507004738, decouple_loss:0.015478169545531273
Iteration: 920, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44900238513946533
The generated pressure mean: 0.45278337597846985
loss_pred:0.02927250601351261, decouple_loss:0.014445031993091106
loss_pred:0.02939634583890438, decouple_loss:0.014362693764269352
The generated pressure mean: 0.4472939670085907
loss_pred:0.030273811891674995, decouple_loss:0.014369005337357521
2023-04-16 15:45:25 testing...
The generated pressure mean: 0.42108675837516785
The generated pressure mean: 0.4273081123828888
loss_pred:0.03879799693822861, decouple_loss:0.017761841416358948
The generated pressure mean: 0.42987534403800964
loss_pred:0.03823399543762207, decouple_loss:0.018386127427220345
loss_pred:0.037508878856897354, decouple_loss:0.01837209053337574
WV_0_PC_0_EH_1_PS_40, loss: 0.039088957011699677, avg_mse: 0.048525240272283554
current test mse: 0.048525
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 921, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489552676677704
loss_pred:0.027619680389761925, decouple_loss:0.01636132411658764
The generated pressure mean: 0.44651827216148376
loss_pred:0.02830679714679718, decouple_loss:0.016367677599191666
The generated pressure mean: 0.4494318664073944
loss_pred:0.029976356774568558, decouple_loss:0.016658416017889977
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 922, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44407203793525696
The generated pressure mean: 0.44446244835853577
loss_pred:0.02875201590359211, decouple_loss:0.015507022850215435
loss_pred:0.029385870322585106, decouple_loss:0.015594745986163616
The generated pressure mean: 0.4508669972419739
loss_pred:0.029505694285035133, decouple_loss:0.015543654561042786
Iteration: 923, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464886486530304
The generated pressure mean: 0.4474228620529175
loss_pred:0.029548758640885353, decouple_loss:0.016081495210528374
loss_pred:0.030790207907557487, decouple_loss:0.016417082399129868
The generated pressure mean: 0.44895654916763306
loss_pred:0.02859225682914257, decouple_loss:0.01604396291077137
Iteration: 924, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4376344680786133
The generated pressure mean: 0.436880499124527
loss_pred:0.02825801447033882, decouple_loss:0.015275287441909313
loss_pred:0.03006342239677906, decouple_loss:0.015088272280991077
The generated pressure mean: 0.44214919209480286
loss_pred:0.028390705585479736, decouple_loss:0.015372894704341888
Iteration: 925, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45660847425460815
The generated pressure mean: 0.4561876654624939
loss_pred:0.02946517802774906, decouple_loss:0.014723280444741249
loss_pred:0.028971944004297256, decouple_loss:0.015272745862603188
The generated pressure mean: 0.4544132351875305
loss_pred:0.028385363519191742, decouple_loss:0.014755145646631718
Iteration: 926, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44978031516075134
loss_pred:0.029295535758137703, decouple_loss:0.014176109805703163
The generated pressure mean: 0.4564688205718994
loss_pred:0.031091364100575447, decouple_loss:0.014129800722002983
The generated pressure mean: 0.45437756180763245
loss_pred:0.02809060364961624, decouple_loss:0.014129431918263435
Iteration: 927, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4389079511165619
The generated pressure mean: 0.43492013216018677
loss_pred:0.03033733181655407, decouple_loss:0.013748123310506344
loss_pred:0.030824899673461914, decouple_loss:0.013663453981280327
The generated pressure mean: 0.4342021346092224
loss_pred:0.02917364425957203, decouple_loss:0.013865704648196697
Iteration: 928, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4515732526779175
loss_pred:0.028531668707728386, decouple_loss:0.014375224709510803
The generated pressure mean: 0.4513135552406311
loss_pred:0.030587032437324524, decouple_loss:0.014590445905923843
The generated pressure mean: 0.4529995918273926
loss_pred:0.029257379472255707, decouple_loss:0.014511290937662125
Iteration: 929, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43894878029823303
loss_pred:0.0313996858894825, decouple_loss:0.015256809070706367
The generated pressure mean: 0.4361278712749481
loss_pred:0.02891894057393074, decouple_loss:0.015021701343357563
The generated pressure mean: 0.4419613778591156
loss_pred:0.02847195230424404, decouple_loss:0.015260827727615833
Iteration: 930, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.445424884557724
The generated pressure mean: 0.44815394282341003
loss_pred:0.030304156243801117, decouple_loss:0.016238344833254814
loss_pred:0.02837490290403366, decouple_loss:0.016060473397374153
The generated pressure mean: 0.4459492564201355
loss_pred:0.029254961758852005, decouple_loss:0.015914008021354675
2023-04-16 15:47:58 testing...
The generated pressure mean: 0.41497960686683655
The generated pressure mean: 0.4217073917388916
The generated pressure mean: 0.42422017455101013
loss_pred:0.04006604477763176, decouple_loss:0.015988098457455635
loss_pred:0.039043404161930084, decouple_loss:0.01656375639140606
loss_pred:0.038474518805742264, decouple_loss:0.01671101525425911
WV_0_PC_0_EH_1_PS_40, loss: 0.040015704929828644, avg_mse: 0.05074052885174751
current test mse: 0.050741
Iteration: 931, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46874409914016724
loss_pred:0.02817007154226303, decouple_loss:0.014644957147538662
The generated pressure mean: 0.46898433566093445
loss_pred:0.029024768620729446, decouple_loss:0.014782793819904327
The generated pressure mean: 0.46225783228874207
loss_pred:0.029354466125369072, decouple_loss:0.014610853977501392
Iteration: 932, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42952343821525574
loss_pred:0.03022756613790989, decouple_loss:0.015361896716058254
The generated pressure mean: 0.43216806650161743
loss_pred:0.030989546328783035, decouple_loss:0.015786737203598022
The generated pressure mean: 0.43047693371772766
loss_pred:0.03143275901675224, decouple_loss:0.015487601980566978
Iteration: 933, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4417499899864197
The generated pressure mean: 0.44309988617897034
loss_pred:0.02786611020565033, decouple_loss:0.014688825234770775
loss_pred:0.027537913993000984, decouple_loss:0.01451287791132927
The generated pressure mean: 0.440280020236969
loss_pred:0.029160989448428154, decouple_loss:0.014517581090331078
Iteration: 934, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46755099296569824
The generated pressure mean: 0.4664062261581421
loss_pred:0.028460847213864326, decouple_loss:0.014675986021757126
loss_pred:0.028904389590024948, decouple_loss:0.014458103105425835
The generated pressure mean: 0.4659985899925232
loss_pred:0.02768254466354847, decouple_loss:0.014883297495543957
Iteration: 935, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44938692450523376
The generated pressure mean: 0.4483838379383087
loss_pred:0.027418609708547592, decouple_loss:0.014724403619766235
loss_pred:0.02911398559808731, decouple_loss:0.01482688169926405
The generated pressure mean: 0.4478287398815155
loss_pred:0.027349425479769707, decouple_loss:0.01468711905181408
Iteration: 936, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42538323998451233
The generated pressure mean: 0.42318904399871826
loss_pred:0.028955385088920593, decouple_loss:0.014488179236650467
loss_pred:0.02936607412993908, decouple_loss:0.01470264419913292
The generated pressure mean: 0.4257894456386566
loss_pred:0.02865324541926384, decouple_loss:0.0145511319860816
Iteration: 937, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46062755584716797
The generated pressure mean: 0.4583938717842102
loss_pred:0.02973240241408348, decouple_loss:0.0140017569065094
loss_pred:0.029204560443758965, decouple_loss:0.014217599295079708
The generated pressure mean: 0.46114271879196167
loss_pred:0.029281135648489, decouple_loss:0.013943888247013092
Iteration: 938, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4533805549144745
loss_pred:0.028879648074507713, decouple_loss:0.015446018427610397
The generated pressure mean: 0.45331668853759766
loss_pred:0.027790607884526253, decouple_loss:0.015064338222146034
The generated pressure mean: 0.45432770252227783
loss_pred:0.027190670371055603, decouple_loss:0.015266167931258678
Iteration: 939, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4313572943210602
loss_pred:0.028018953278660774, decouple_loss:0.016182705760002136
The generated pressure mean: 0.437038779258728
loss_pred:0.02878657728433609, decouple_loss:0.01607966050505638
The generated pressure mean: 0.43399757146835327
loss_pred:0.028936127200722694, decouple_loss:0.015961691737174988
Iteration: 940, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4590228796005249
loss_pred:0.029076823964715004, decouple_loss:0.016832245513796806
The generated pressure mean: 0.4580223560333252
loss_pred:0.027547717094421387, decouple_loss:0.016952121630311012
The generated pressure mean: 0.456305593252182
loss_pred:0.02927343361079693, decouple_loss:0.01695297844707966
2023-04-16 15:49:51 testing...
The generated pressure mean: 0.4172252118587494
The generated pressure mean: 0.42355120182037354
loss_pred:0.03819899633526802, decouple_loss:0.016664350405335426
The generated pressure mean: 0.42634835839271545
loss_pred:0.037374287843704224, decouple_loss:0.017351921647787094
loss_pred:0.03672994673252106, decouple_loss:0.017445560544729233
WV_0_PC_0_EH_1_PS_40, loss: 0.038292109966278076, avg_mse: 0.04748396947979927
current test mse: 0.047484
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 941, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4561171233654022
loss_pred:0.029171613976359367, decouple_loss:0.016086891293525696
The generated pressure mean: 0.45179012417793274
The generated pressure mean: 0.4531911611557007
loss_pred:0.028481198474764824, decouple_loss:0.015830934047698975
loss_pred:0.030069267377257347, decouple_loss:0.01571139506995678
Iteration: 942, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4364244341850281
The generated pressure mean: 0.4306979179382324
loss_pred:0.029353132471442223, decouple_loss:0.015089954249560833
loss_pred:0.030884740874171257, decouple_loss:0.015515736304223537
The generated pressure mean: 0.43546026945114136
loss_pred:0.02986731007695198, decouple_loss:0.015287655405700207
Iteration: 943, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44809964299201965
The generated pressure mean: 0.4499702453613281
loss_pred:0.029775161296129227, decouple_loss:0.013398360460996628
loss_pred:0.028460189700126648, decouple_loss:0.013330931775271893
The generated pressure mean: 0.4513896405696869
loss_pred:0.029181258752942085, decouple_loss:0.013412924483418465
Iteration: 944, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505809247493744
The generated pressure mean: 0.44921836256980896
loss_pred:0.029168151319026947, decouple_loss:0.014304589480161667
loss_pred:0.02906510792672634, decouple_loss:0.014191636815667152
The generated pressure mean: 0.44721993803977966
loss_pred:0.028761979192495346, decouple_loss:0.014252705499529839
Iteration: 945, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44261565804481506
The generated pressure mean: 0.43878334760665894
loss_pred:0.029580967500805855, decouple_loss:0.013379363343119621
loss_pred:0.02836919017136097, decouple_loss:0.013623676262795925
The generated pressure mean: 0.44246363639831543
loss_pred:0.02991522289812565, decouple_loss:0.013477007858455181
Iteration: 946, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45260560512542725
The generated pressure mean: 0.44833827018737793
loss_pred:0.028845172375440598, decouple_loss:0.014418883249163628
loss_pred:0.029270611703395844, decouple_loss:0.014498544856905937
The generated pressure mean: 0.4435288608074188
loss_pred:0.030401017516851425, decouple_loss:0.014381172135472298
Iteration: 947, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45986464619636536
The generated pressure mean: 0.45645859837532043
loss_pred:0.03137826919555664, decouple_loss:0.013604998588562012
loss_pred:0.029669849202036858, decouple_loss:0.013607742264866829
The generated pressure mean: 0.451728492975235
loss_pred:0.029246311634778976, decouple_loss:0.013566276989877224
Iteration: 948, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4424710273742676
loss_pred:0.028852200135588646, decouple_loss:0.01539646927267313
The generated pressure mean: 0.4322965145111084
loss_pred:0.02788827195763588, decouple_loss:0.015105318278074265
The generated pressure mean: 0.4361453950405121
loss_pred:0.030154099687933922, decouple_loss:0.015226000919938087
Iteration: 949, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.457241415977478
The generated pressure mean: 0.44380730390548706
loss_pred:0.02851521223783493, decouple_loss:0.016179656609892845
loss_pred:0.03004056215286255, decouple_loss:0.01564132049679756
The generated pressure mean: 0.4484573006629944
loss_pred:0.02910391241312027, decouple_loss:0.015663251280784607
Iteration: 950, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44814029335975647
loss_pred:0.02840527892112732, decouple_loss:0.013959556818008423
The generated pressure mean: 0.4391748607158661
loss_pred:0.030179724097251892, decouple_loss:0.014082477428019047
The generated pressure mean: 0.44071128964424133
loss_pred:0.02976473979651928, decouple_loss:0.013739237561821938
2023-04-16 15:52:24 testing...
The generated pressure mean: 0.4200133681297302
The generated pressure mean: 0.426299124956131
The generated pressure mean: 0.4284488558769226
loss_pred:0.0381445549428463, decouple_loss:0.015072510577738285
loss_pred:0.037017881870269775, decouple_loss:0.015631388872861862
loss_pred:0.03678879141807556, decouple_loss:0.0157049261033535
WV_0_PC_0_EH_1_PS_40, loss: 0.03809055685997009, avg_mse: 0.047220878303050995
current test mse: 0.047221
Iteration: 951, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4516541361808777The generated pressure mean: 0.4448135197162628
loss_pred:0.029180221259593964, decouple_loss:0.014267299324274063
loss_pred:0.02904368005692959, decouple_loss:0.013947115279734135
The generated pressure mean: 0.4429597854614258
loss_pred:0.028893930837512016, decouple_loss:0.013890411704778671
Iteration: 952, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4540334641933441
The generated pressure mean: 0.4567977786064148
loss_pred:0.029007017612457275, decouple_loss:0.014380648732185364
loss_pred:0.029088016599416733, decouple_loss:0.014345711097121239
The generated pressure mean: 0.4592471718788147
loss_pred:0.02830452099442482, decouple_loss:0.014430639334022999
Iteration: 953, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44936123490333557
The generated pressure mean: 0.4466831684112549
loss_pred:0.02883472666144371, decouple_loss:0.015347682870924473
loss_pred:0.02927987650036812, decouple_loss:0.015607699751853943
The generated pressure mean: 0.4469221234321594
loss_pred:0.0287554319947958, decouple_loss:0.015459926798939705
Iteration: 954, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.435524582862854
loss_pred:0.028500838205218315, decouple_loss:0.01404220424592495The generated pressure mean: 0.4380830228328705
loss_pred:0.028148481622338295, decouple_loss:0.01362865511327982
The generated pressure mean: 0.43395212292671204
loss_pred:0.029566718265414238, decouple_loss:0.013596919365227222
Iteration: 955, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45630303025245667
The generated pressure mean: 0.45791059732437134
loss_pred:0.029514046385884285, decouple_loss:0.013865537941455841
loss_pred:0.029349103569984436, decouple_loss:0.014080136083066463
The generated pressure mean: 0.4529586732387543
loss_pred:0.028560005128383636, decouple_loss:0.01394825242459774
Iteration: 956, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4512711465358734
loss_pred:0.02918887883424759, decouple_loss:0.013927401043474674
The generated pressure mean: 0.44637444615364075
loss_pred:0.028046127408742905, decouple_loss:0.01390793640166521
The generated pressure mean: 0.44524943828582764
loss_pred:0.03042309731245041, decouple_loss:0.014158004894852638
Iteration: 957, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4359179437160492
loss_pred:0.02963976189494133, decouple_loss:0.015465467236936092
The generated pressure mean: 0.43485382199287415
loss_pred:0.02897607535123825, decouple_loss:0.015307953581213951
The generated pressure mean: 0.43771639466285706
loss_pred:0.02815733663737774, decouple_loss:0.015467739664018154
Iteration: 958, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4590572714805603
loss_pred:0.02969953417778015, decouple_loss:0.014673899859189987
The generated pressure mean: 0.44715195894241333
loss_pred:0.030002305284142494, decouple_loss:0.014597308821976185
The generated pressure mean: 0.4555421769618988
loss_pred:0.02894686348736286, decouple_loss:0.014653565362095833
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 959, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44058677554130554
loss_pred:0.029285572469234467, decouple_loss:0.0138288214802742
The generated pressure mean: 0.43773937225341797
loss_pred:0.028969060629606247, decouple_loss:0.013944027945399284
The generated pressure mean: 0.43943238258361816
loss_pred:0.02931956574320793, decouple_loss:0.013853785581886768
Iteration: 960, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44537851214408875
loss_pred:0.029515530914068222, decouple_loss:0.014995643869042397
The generated pressure mean: 0.4424792528152466
loss_pred:0.029077885672450066, decouple_loss:0.01493057794868946
The generated pressure mean: 0.44711625576019287
loss_pred:0.028247272595763206, decouple_loss:0.015172356739640236
2023-04-16 15:54:18 testing...
The generated pressure mean: 0.41450732946395874
The generated pressure mean: 0.42062562704086304
The generated pressure mean: 0.4229353666305542
loss_pred:0.038669172674417496, decouple_loss:0.01549101434648037
loss_pred:0.03772163763642311, decouple_loss:0.016139386221766472
loss_pred:0.037248075008392334, decouple_loss:0.016218625009059906
WV_0_PC_0_EH_1_PS_40, loss: 0.03867711126804352, avg_mse: 0.048369280993938446
current test mse: 0.048369
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 961, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4588005244731903
loss_pred:0.02823479101061821, decouple_loss:0.014353539794683456
The generated pressure mean: 0.46598291397094727The generated pressure mean: 0.4650951623916626
loss_pred:0.030511876568198204, decouple_loss:0.014245199970901012
loss_pred:0.02886418253183365, decouple_loss:0.014157871715724468
Iteration: 962, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4386756122112274
The generated pressure mean: 0.43053221702575684
loss_pred:0.03149215504527092, decouple_loss:0.013667963445186615
loss_pred:0.03030078299343586, decouple_loss:0.013582452200353146
The generated pressure mean: 0.43518853187561035
loss_pred:0.029734347015619278, decouple_loss:0.013876455835998058
Iteration: 963, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44286227226257324
The generated pressure mean: 0.44592759013175964
loss_pred:0.030193286016583443, decouple_loss:0.015034218318760395
loss_pred:0.029304660856723785, decouple_loss:0.015336946584284306
The generated pressure mean: 0.45055562257766724
loss_pred:0.02976587601006031, decouple_loss:0.015241052024066448
Iteration: 964, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45751914381980896
loss_pred:0.029664328321814537, decouple_loss:0.015577029436826706
The generated pressure mean: 0.45827144384384155
loss_pred:0.03045128472149372, decouple_loss:0.015504828654229641
The generated pressure mean: 0.45979052782058716
loss_pred:0.028127353638410568, decouple_loss:0.01536789070814848
Iteration: 965, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4352254271507263
loss_pred:0.029362086206674576, decouple_loss:0.014758173376321793
The generated pressure mean: 0.4353584051132202
loss_pred:0.0309735294431448, decouple_loss:0.014741906896233559
The generated pressure mean: 0.4313661754131317
loss_pred:0.02940354309976101, decouple_loss:0.015068325214087963
Iteration: 966, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44634896516799927
loss_pred:0.02852102555334568, decouple_loss:0.014270180836319923
The generated pressure mean: 0.444441020488739
loss_pred:0.02978779934346676, decouple_loss:0.013680041767656803
The generated pressure mean: 0.4454177916049957
loss_pred:0.02916078455746174, decouple_loss:0.014258693903684616
Iteration: 967, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4635660946369171
The generated pressure mean: 0.46276965737342834
loss_pred:0.02858377806842327, decouple_loss:0.014352775178849697
loss_pred:0.030667778104543686, decouple_loss:0.01436014473438263
The generated pressure mean: 0.46309250593185425
loss_pred:0.028800955042243004, decouple_loss:0.014745127409696579
Iteration: 968, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4388657510280609
loss_pred:0.029320310801267624, decouple_loss:0.014163380488753319
The generated pressure mean: 0.43588078022003174
loss_pred:0.030511558055877686, decouple_loss:0.014360803179442883
The generated pressure mean: 0.43383416533470154
loss_pred:0.028767580166459084, decouple_loss:0.014607332646846771
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 969, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449426233768463
loss_pred:0.029078969731926918, decouple_loss:0.014010710641741753
The generated pressure mean: 0.45083218812942505
loss_pred:0.02971409633755684, decouple_loss:0.01395298819988966
The generated pressure mean: 0.4467149078845978
loss_pred:0.029060596600174904, decouple_loss:0.013926563784480095
Iteration: 970, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506053924560547
loss_pred:0.029636360704898834, decouple_loss:0.014821450226008892
The generated pressure mean: 0.448943167924881
loss_pred:0.0285646915435791, decouple_loss:0.015001621097326279
The generated pressure mean: 0.45281603932380676
loss_pred:0.028756601735949516, decouple_loss:0.015270538628101349
2023-04-16 15:56:50 testing...
The generated pressure mean: 0.4188978672027588
The generated pressure mean: 0.4249122738838196
loss_pred:0.03832297399640083, decouple_loss:0.01536064688116312
The generated pressure mean: 0.4273369014263153
loss_pred:0.03709639608860016, decouple_loss:0.01588573306798935
loss_pred:0.03662046790122986, decouple_loss:0.015907438471913338
WV_0_PC_0_EH_1_PS_40, loss: 0.03813251107931137, avg_mse: 0.047577351331710815
current test mse: 0.047577
Iteration: 971, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.440191388130188
loss_pred:0.028833160176873207, decouple_loss:0.014645068906247616
The generated pressure mean: 0.44649845361709595
loss_pred:0.028766054660081863, decouple_loss:0.014487935230135918
The generated pressure mean: 0.44280433654785156
loss_pred:0.029268726706504822, decouple_loss:0.014368956908583641
Iteration: 972, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45488306879997253
loss_pred:0.02792534790933132, decouple_loss:0.014290680177509785
The generated pressure mean: 0.4567946493625641
loss_pred:0.029920924454927444, decouple_loss:0.014441471546888351
The generated pressure mean: 0.45034462213516235
loss_pred:0.028229426592588425, decouple_loss:0.01397278904914856
Iteration: 973, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505214989185333
loss_pred:0.029617106541991234, decouple_loss:0.0147836459800601
The generated pressure mean: 0.4436882734298706
loss_pred:0.029146824032068253, decouple_loss:0.014758697710931301
The generated pressure mean: 0.4469338655471802
loss_pred:0.028872977942228317, decouple_loss:0.01463413704186678
Iteration: 974, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4343480169773102
The generated pressure mean: 0.4331623315811157
loss_pred:0.028344586491584778, decouple_loss:0.014803754165768623
loss_pred:0.027776939794421196, decouple_loss:0.01459949929267168
The generated pressure mean: 0.4324932098388672
loss_pred:0.029122881591320038, decouple_loss:0.0148012088611722
Iteration: 975, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4597782492637634
loss_pred:0.028974788263440132, decouple_loss:0.015480613335967064
The generated pressure mean: 0.461311399936676
loss_pred:0.027998708188533783, decouple_loss:0.015251072123646736
The generated pressure mean: 0.4651366174221039
loss_pred:0.028133247047662735, decouple_loss:0.015225001610815525
Iteration: 976, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44678571820259094
loss_pred:0.029689641669392586, decouple_loss:0.016382934525609016
The generated pressure mean: 0.4540901482105255
loss_pred:0.028128622099757195, decouple_loss:0.016309941187500954
The generated pressure mean: 0.4549696445465088
loss_pred:0.028988374397158623, decouple_loss:0.016326339915394783
Iteration: 977, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43350252509117126
loss_pred:0.028568528592586517, decouple_loss:0.014760579913854599
The generated pressure mean: 0.4305427670478821
loss_pred:0.028249502182006836, decouple_loss:0.01483962219208479
The generated pressure mean: 0.4387001097202301
loss_pred:0.030100364238023758, decouple_loss:0.014927196316421032
Iteration: 978, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44867900013923645
loss_pred:0.029166366904973984, decouple_loss:0.015201558358967304
The generated pressure mean: 0.45109832286834717
loss_pred:0.027804626151919365, decouple_loss:0.014734768308699131
The generated pressure mean: 0.44950711727142334
loss_pred:0.029723653569817543, decouple_loss:0.014809396117925644
Iteration: 979, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45620518922805786
The generated pressure mean: 0.4552609622478485
loss_pred:0.029765797778964043, decouple_loss:0.01581873744726181
loss_pred:0.028408866375684738, decouple_loss:0.015870951116085052
The generated pressure mean: 0.45520710945129395
loss_pred:0.029488032683730125, decouple_loss:0.015794996172189713
Iteration: 980, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43289095163345337
loss_pred:0.028622951358556747, decouple_loss:0.015272236429154873
The generated pressure mean: 0.43046411871910095
loss_pred:0.027927473187446594, decouple_loss:0.015376231633126736
The generated pressure mean: 0.42391103506088257
loss_pred:0.031123315915465355, decouple_loss:0.015593595802783966
2023-04-16 15:58:44 testing...
The generated pressure mean: 0.42246323823928833
The generated pressure mean: 0.415691077709198
loss_pred:0.037039823830127716, decouple_loss:0.016236094757914543
The generated pressure mean: 0.424635648727417
loss_pred:0.03808457776904106, decouple_loss:0.01584535464644432
loss_pred:0.03656350076198578, decouple_loss:0.016229672357439995
WV_0_PC_0_EH_1_PS_40, loss: 0.03803449124097824, avg_mse: 0.04747999832034111
current test mse: 0.04748
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 981, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46262770891189575
loss_pred:0.029424631968140602, decouple_loss:0.015472345985472202
The generated pressure mean: 0.45825517177581787
loss_pred:0.0281341765075922, decouple_loss:0.01511302124708891
The generated pressure mean: 0.4601219892501831
loss_pred:0.028705431148409843, decouple_loss:0.01551088597625494
Iteration: 982, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45431438088417053
The generated pressure mean: 0.45258164405822754
loss_pred:0.02900250256061554, decouple_loss:0.014662247151136398
loss_pred:0.028096118941903114, decouple_loss:0.014759603887796402
The generated pressure mean: 0.4506787657737732
loss_pred:0.02860577218234539, decouple_loss:0.014843646436929703
Iteration: 983, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43763360381126404
The generated pressure mean: 0.44347840547561646
loss_pred:0.028899017721414566, decouple_loss:0.014921365305781364
loss_pred:0.02948521077632904, decouple_loss:0.014897912740707397
The generated pressure mean: 0.4389120638370514
loss_pred:0.028863737359642982, decouple_loss:0.015165670774877071
Iteration: 984, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44549885392189026
The generated pressure mean: 0.44727665185928345
loss_pred:0.029817285016179085, decouple_loss:0.01399286463856697
loss_pred:0.028637906536459923, decouple_loss:0.0141970906406641
The generated pressure mean: 0.4458879828453064
loss_pred:0.028252897784113884, decouple_loss:0.013908110558986664
Iteration: 985, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4553816318511963
The generated pressure mean: 0.45722708106040955
loss_pred:0.028735607862472534, decouple_loss:0.013883231207728386
loss_pred:0.027788063511252403, decouple_loss:0.01407710649073124
The generated pressure mean: 0.45743244886398315
loss_pred:0.028557991608977318, decouple_loss:0.013936285860836506
Iteration: 986, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4438875913619995
The generated pressure mean: 0.4489976763725281
loss_pred:0.028038594871759415, decouple_loss:0.014558459632098675
loss_pred:0.029259849339723587, decouple_loss:0.014733565039932728
The generated pressure mean: 0.4435789883136749
loss_pred:0.028113732114434242, decouple_loss:0.01462071668356657
Iteration: 987, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4416719377040863
The generated pressure mean: 0.43879014253616333
loss_pred:0.029201120138168335, decouple_loss:0.013737833127379417
loss_pred:0.027689961716532707, decouple_loss:0.013739007525146008
The generated pressure mean: 0.43627768754959106
loss_pred:0.030057761818170547, decouple_loss:0.013938919641077518
Iteration: 988, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45490145683288574
The generated pressure mean: 0.4530467987060547loss_pred:0.029452811926603317, decouple_loss:0.014689866453409195
loss_pred:0.02729032002389431, decouple_loss:0.01467324048280716
The generated pressure mean: 0.45360520482063293
loss_pred:0.028985818848013878, decouple_loss:0.014285695739090443
Iteration: 989, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452327787876129
The generated pressure mean: 0.4521063268184662
loss_pred:0.02791512757539749, decouple_loss:0.015719013288617134
loss_pred:0.02909606322646141, decouple_loss:0.016058294102549553
The generated pressure mean: 0.4421032965183258
loss_pred:0.029375877231359482, decouple_loss:0.015670685097575188
Iteration: 990, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44623664021492004
loss_pred:0.02822071872651577, decouple_loss:0.016248466446995735
The generated pressure mean: 0.44701093435287476
loss_pred:0.028613878414034843, decouple_loss:0.01630854792892933
The generated pressure mean: 0.45028069615364075
loss_pred:0.028440939262509346, decouple_loss:0.016375670209527016
2023-04-16 16:01:16 testing...
The generated pressure mean: 0.4180481433868408
The generated pressure mean: 0.42464667558670044
The generated pressure mean: 0.426987886428833
loss_pred:0.03737185522913933, decouple_loss:0.016188649460673332
loss_pred:0.03643878549337387, decouple_loss:0.016784176230430603
loss_pred:0.035740889608860016, decouple_loss:0.016942374408245087
WV_0_PC_0_EH_1_PS_40, loss: 0.037349097430706024, avg_mse: 0.04637625440955162
current test mse: 0.046376
Iteration: 991, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45146429538726807
The generated pressure mean: 0.4418460428714752
loss_pred:0.028687281534075737, decouple_loss:0.015452823601663113
loss_pred:0.02877822145819664, decouple_loss:0.015531565062701702
The generated pressure mean: 0.452099472284317
loss_pred:0.02905556559562683, decouple_loss:0.015562946908175945
Iteration: 992, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4543260931968689
loss_pred:0.028189945966005325, decouple_loss:0.01411470491439104
The generated pressure mean: 0.4531741738319397
loss_pred:0.028333909809589386, decouple_loss:0.014234456233680248
The generated pressure mean: 0.4588160514831543
loss_pred:0.029083481058478355, decouple_loss:0.013948328793048859
Iteration: 993, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44437387585639954
The generated pressure mean: 0.44205158948898315
loss_pred:0.028458217158913612, decouple_loss:0.014778471551835537
loss_pred:0.029105767607688904, decouple_loss:0.015212048776447773
The generated pressure mean: 0.44674813747406006
loss_pred:0.02988172322511673, decouple_loss:0.01508813165128231
Iteration: 994, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4412389397621155
loss_pred:0.029143519699573517, decouple_loss:0.016250984743237495
The generated pressure mean: 0.4387052655220032
loss_pred:0.028802720829844475, decouple_loss:0.017000405117869377
The generated pressure mean: 0.4354317784309387
loss_pred:0.02872324176132679, decouple_loss:0.016564900055527687
Iteration: 995, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4579092562198639
loss_pred:0.02938402257859707, decouple_loss:0.01517003308981657
The generated pressure mean: 0.45258381962776184
loss_pred:0.029300035908818245, decouple_loss:0.015109886415302753
The generated pressure mean: 0.45752981305122375
loss_pred:0.028216814622282982, decouple_loss:0.015126938000321388
Iteration: 996, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45363155007362366
The generated pressure mean: 0.4550577700138092loss_pred:0.028564967215061188, decouple_loss:0.015274100936949253
loss_pred:0.030078183859586716, decouple_loss:0.015077032148838043
The generated pressure mean: 0.4520697593688965
loss_pred:0.028137795627117157, decouple_loss:0.015339924022555351
Iteration: 997, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43812230229377747
The generated pressure mean: 0.44345295429229736
loss_pred:0.028788438066840172, decouple_loss:0.014732086099684238
loss_pred:0.02807956002652645, decouple_loss:0.014655045233666897
The generated pressure mean: 0.4374750554561615
loss_pred:0.028585076332092285, decouple_loss:0.014884372241795063
Iteration: 998, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4432357847690582
The generated pressure mean: 0.4478990435600281
loss_pred:0.028569446876645088, decouple_loss:0.014325693249702454
loss_pred:0.028054755181074142, decouple_loss:0.014353552833199501
The generated pressure mean: 0.44220679998397827
loss_pred:0.02763018012046814, decouple_loss:0.01422452088445425
Iteration: 999, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4597771167755127
The generated pressure mean: 0.4562526345252991
loss_pred:0.02862546220421791, decouple_loss:0.015691103413701057
loss_pred:0.028964031487703323, decouple_loss:0.015845300629734993
The generated pressure mean: 0.4611870050430298
loss_pred:0.028140582144260406, decouple_loss:0.01600831001996994
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1000, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43235325813293457
The generated pressure mean: 0.43472838401794434
loss_pred:0.029088638722896576, decouple_loss:0.016749827191233635
loss_pred:0.028897590935230255, decouple_loss:0.01684177853167057
The generated pressure mean: 0.4352315068244934
loss_pred:0.02842462621629238, decouple_loss:0.01666935719549656
2023-04-16 16:03:09 itr: 1000
training loss: [0.02925809 0.02992613 0.02973968]
2023-04-16 16:03:09 testing...
The generated pressure mean: 0.41419103741645813
The generated pressure mean: 0.4200856685638428
loss_pred:0.03853471949696541, decouple_loss:0.016401013359427452
The generated pressure mean: 0.422218382358551
loss_pred:0.037638530135154724, decouple_loss:0.016910210251808167
loss_pred:0.03716716170310974, decouple_loss:0.01695300079882145
WV_0_PC_0_EH_1_PS_40, loss: 0.038617875427007675, avg_mse: 0.048543598502874374
current test mse: 0.048544
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 1001, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4594479203224182
loss_pred:0.028991879895329475, decouple_loss:0.015846990048885345
The generated pressure mean: 0.45869287848472595
loss_pred:0.028139406815171242, decouple_loss:0.015893777832388878
The generated pressure mean: 0.45601820945739746
loss_pred:0.026748398318886757, decouple_loss:0.015898065641522408
Iteration: 1002, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45260897278785706
The generated pressure mean: 0.4562435746192932
loss_pred:0.02679857611656189, decouple_loss:0.016288626939058304
loss_pred:0.027385296300053596, decouple_loss:0.01607130654156208
The generated pressure mean: 0.45465582609176636
loss_pred:0.03100847825407982, decouple_loss:0.016514938324689865
Iteration: 1003, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43863287568092346
The generated pressure mean: 0.44113820791244507
loss_pred:0.029517142102122307, decouple_loss:0.01759248785674572
loss_pred:0.027853896841406822, decouple_loss:0.01770772412419319
The generated pressure mean: 0.43343037366867065
loss_pred:0.029153311625123024, decouple_loss:0.017510123550891876
Iteration: 1004, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44620949029922485
The generated pressure mean: 0.44427430629730225
loss_pred:0.026588791981339455, decouple_loss:0.017217425629496574
loss_pred:0.02980753779411316, decouple_loss:0.01729353331029415
The generated pressure mean: 0.4444657862186432
loss_pred:0.027737295255064964, decouple_loss:0.017227061092853546
Iteration: 1005, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44777074456214905
The generated pressure mean: 0.44678032398223877
loss_pred:0.028019797056913376, decouple_loss:0.016816381365060806
loss_pred:0.029611360281705856, decouple_loss:0.01722337119281292
The generated pressure mean: 0.45183059573173523
loss_pred:0.02909735031425953, decouple_loss:0.017057305201888084
Iteration: 1006, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4540706276893616
The generated pressure mean: 0.4536829888820648
loss_pred:0.028168514370918274, decouple_loss:0.016487864777445793
loss_pred:0.027795540168881416, decouple_loss:0.016545753926038742
The generated pressure mean: 0.447651743888855
loss_pred:0.028372546657919884, decouple_loss:0.01687493734061718
Iteration: 1007, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44271722435951233
The generated pressure mean: 0.43795713782310486
loss_pred:0.02922252006828785, decouple_loss:0.01794334687292576
loss_pred:0.02790926955640316, decouple_loss:0.018183888867497444
The generated pressure mean: 0.43765634298324585
loss_pred:0.027696380391716957, decouple_loss:0.01825643703341484
Iteration: 1008, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491901099681854
loss_pred:0.029514765366911888, decouple_loss:0.016086630523204803
The generated pressure mean: 0.45391201972961426
loss_pred:0.0263773612678051, decouple_loss:0.015819672495126724
The generated pressure mean: 0.45540252327919006
loss_pred:0.026811925694346428, decouple_loss:0.0156917292624712
Iteration: 1009, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4424130916595459
The generated pressure mean: 0.4471612572669983
loss_pred:0.02870750054717064, decouple_loss:0.016864275559782982
loss_pred:0.027817077934741974, decouple_loss:0.016836753115057945
The generated pressure mean: 0.445357084274292
loss_pred:0.02777606062591076, decouple_loss:0.01684517227113247
Iteration: 1010, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498397707939148
The generated pressure mean: 0.4472059905529022
loss_pred:0.026368629187345505, decouple_loss:0.015926837921142578
loss_pred:0.029089592397212982, decouple_loss:0.01595461554825306
The generated pressure mean: 0.4529151916503906
loss_pred:0.0274990014731884, decouple_loss:0.016439413651823997
2023-04-16 16:05:41 testing...
The generated pressure mean: 0.41943830251693726
The generated pressure mean: 0.426032692193985
loss_pred:0.037797801196575165, decouple_loss:0.017018433660268784
The generated pressure mean: 0.4285248816013336
loss_pred:0.03685282543301582, decouple_loss:0.017709458246827126
loss_pred:0.03637654706835747, decouple_loss:0.017907682806253433
WV_0_PC_0_EH_1_PS_40, loss: 0.03788631781935692, avg_mse: 0.04769609495997429
current test mse: 0.047696
Iteration: 1011, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4443539083003998
loss_pred:0.028998346999287605, decouple_loss:0.016103537753224373
The generated pressure mean: 0.4498545527458191
loss_pred:0.027804890647530556, decouple_loss:0.015719784423708916
The generated pressure mean: 0.44194522500038147
loss_pred:0.027620742097496986, decouple_loss:0.015925122424960136
Iteration: 1012, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42775341868400574
loss_pred:0.028448278084397316, decouple_loss:0.016567688435316086
The generated pressure mean: 0.42792627215385437
loss_pred:0.031359605491161346, decouple_loss:0.016553061082959175
The generated pressure mean: 0.43479475378990173
loss_pred:0.027869727462530136, decouple_loss:0.016619468107819557
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1013, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4669038653373718
loss_pred:0.02971601113677025, decouple_loss:0.015031879767775536
The generated pressure mean: 0.46772488951683044
loss_pred:0.026872815564274788, decouple_loss:0.015186675824224949
The generated pressure mean: 0.46678489446640015
loss_pred:0.028667185455560684, decouple_loss:0.015465225093066692
Iteration: 1014, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4524126648902893
loss_pred:0.02735540270805359, decouple_loss:0.014237727969884872
The generated pressure mean: 0.452384889125824
loss_pred:0.029545007273554802, decouple_loss:0.014138586819171906
The generated pressure mean: 0.4480516314506531
loss_pred:0.028858695179224014, decouple_loss:0.014241164550185204
Iteration: 1015, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4240693151950836
loss_pred:0.028563732281327248, decouple_loss:0.014897703193128109
The generated pressure mean: 0.4268868863582611
loss_pred:0.02787291631102562, decouple_loss:0.01499880664050579
The generated pressure mean: 0.4232563376426697
loss_pred:0.028966005891561508, decouple_loss:0.014947491697967052
Iteration: 1016, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493423402309418
loss_pred:0.027833938598632812, decouple_loss:0.014475507661700249
The generated pressure mean: 0.45283910632133484
loss_pred:0.028005583211779594, decouple_loss:0.014303602278232574
The generated pressure mean: 0.44528961181640625
loss_pred:0.02895169146358967, decouple_loss:0.014156322926282883
Iteration: 1017, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46994271874427795
loss_pred:0.029244642704725266, decouple_loss:0.014746764674782753
The generated pressure mean: 0.47788652777671814
loss_pred:0.029476208612322807, decouple_loss:0.014834875240921974
The generated pressure mean: 0.4703305661678314
loss_pred:0.029766052961349487, decouple_loss:0.014839878305792809
Iteration: 1018, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4219033420085907
loss_pred:0.028965536504983902, decouple_loss:0.016119731590151787
The generated pressure mean: 0.41891467571258545
The generated pressure mean: 0.4136976897716522
loss_pred:0.027473479509353638, decouple_loss:0.015925154089927673
loss_pred:0.03021976724267006, decouple_loss:0.016492526978254318
Iteration: 1019, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44555696845054626
loss_pred:0.02751089446246624, decouple_loss:0.01587616465985775
The generated pressure mean: 0.4540066123008728
loss_pred:0.028254278004169464, decouple_loss:0.015491687692701817
The generated pressure mean: 0.45102933049201965
loss_pred:0.02822677418589592, decouple_loss:0.01552543230354786
Iteration: 1020, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4641473889350891
loss_pred:0.028196420520544052, decouple_loss:0.016093555837869644
The generated pressure mean: 0.46687185764312744
loss_pred:0.027853474020957947, decouple_loss:0.016329551115632057
The generated pressure mean: 0.472412645816803
loss_pred:0.02791609801352024, decouple_loss:0.01588035188615322
2023-04-16 16:07:35 testing...
The generated pressure mean: 0.417662650346756
The generated pressure mean: 0.4240165054798126
The generated pressure mean: 0.42659270763397217
loss_pred:0.039000071585178375, decouple_loss:0.017212947830557823
loss_pred:0.0379948653280735, decouple_loss:0.017425259575247765
loss_pred:0.03751067817211151, decouple_loss:0.017423594370484352
WV_0_PC_0_EH_1_PS_40, loss: 0.039036236703395844, avg_mse: 0.05014459416270256
current test mse: 0.050145
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 1021, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4542708992958069
loss_pred:0.030415302142500877, decouple_loss:0.017911871895194054
The generated pressure mean: 0.45219022035598755
loss_pred:0.029990144073963165, decouple_loss:0.01726425066590309
The generated pressure mean: 0.4456523358821869
loss_pred:0.030033854767680168, decouple_loss:0.01679617166519165
Iteration: 1022, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.41056525707244873
The generated pressure mean: 0.41110748052597046
loss_pred:0.029856324195861816, decouple_loss:0.016401182860136032
loss_pred:0.030022112652659416, decouple_loss:0.015793703496456146
The generated pressure mean: 0.42070743441581726
loss_pred:0.03064781427383423, decouple_loss:0.01591118797659874
Iteration: 1023, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45532843470573425
The generated pressure mean: 0.4587233364582062
loss_pred:0.03181351721286774, decouple_loss:0.01805035211145878
loss_pred:0.029504042118787766, decouple_loss:0.017213432118296623
The generated pressure mean: 0.45370158553123474
loss_pred:0.02995484322309494, decouple_loss:0.017079990357160568
Iteration: 1024, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47258448600769043
The generated pressure mean: 0.46930474042892456
loss_pred:0.03078271448612213, decouple_loss:0.016491182148456573
loss_pred:0.02976454421877861, decouple_loss:0.016084980219602585
The generated pressure mean: 0.4729228913784027
loss_pred:0.029907934367656708, decouple_loss:0.01634114794433117
Iteration: 1025, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43810218572616577The generated pressure mean: 0.4397449195384979
loss_pred:0.028250887989997864, decouple_loss:0.016908658668398857
loss_pred:0.028462650254368782, decouple_loss:0.016750022768974304
The generated pressure mean: 0.44703778624534607
loss_pred:0.028855392709374428, decouple_loss:0.016645045951008797
Iteration: 1026, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43454423546791077
The generated pressure mean: 0.43582504987716675
loss_pred:0.031338684260845184, decouple_loss:0.01688878796994686
loss_pred:0.02896122820675373, decouple_loss:0.01605912111699581
The generated pressure mean: 0.43701499700546265
loss_pred:0.029993204399943352, decouple_loss:0.016687173396348953
Iteration: 1027, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44307732582092285
The generated pressure mean: 0.4418239891529083loss_pred:0.028537342324852943, decouple_loss:0.015755221247673035
loss_pred:0.029704533517360687, decouple_loss:0.015734054148197174
The generated pressure mean: 0.44336557388305664
loss_pred:0.02989325486123562, decouple_loss:0.016109852120280266
Iteration: 1028, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44967028498649597
loss_pred:0.028962165117263794, decouple_loss:0.01522866915911436
The generated pressure mean: 0.4518376588821411
loss_pred:0.029484551399946213, decouple_loss:0.015380403958261013
The generated pressure mean: 0.44876840710639954
loss_pred:0.028388431295752525, decouple_loss:0.015312273055315018
Iteration: 1029, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46166524291038513
The generated pressure mean: 0.46035510301589966
loss_pred:0.029690856114029884, decouple_loss:0.0161236971616745
loss_pred:0.029758015647530556, decouple_loss:0.016235677525401115
The generated pressure mean: 0.45574289560317993
loss_pred:0.029440563172101974, decouple_loss:0.01587263122200966
Iteration: 1030, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494195878505707
loss_pred:0.029678966850042343, decouple_loss:0.014978203922510147
The generated pressure mean: 0.45242276787757874
loss_pred:0.029164452105760574, decouple_loss:0.015174406580626965
The generated pressure mean: 0.4478691518306732
loss_pred:0.02803207002580166, decouple_loss:0.015380528755486012
2023-04-16 16:10:04 testing...
The generated pressure mean: 0.4214005172252655
The generated pressure mean: 0.4277905523777008
loss_pred:0.037614040076732635, decouple_loss:0.016390739008784294
The generated pressure mean: 0.4306587874889374
loss_pred:0.03620549663901329, decouple_loss:0.016828659921884537
loss_pred:0.03572988510131836, decouple_loss:0.01703353226184845
WV_0_PC_0_EH_1_PS_40, loss: 0.03735402226448059, avg_mse: 0.046581316739320755
current test mse: 0.046581
Iteration: 1031, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43398597836494446
loss_pred:0.029594440013170242, decouple_loss:0.016159579157829285
The generated pressure mean: 0.43189743161201477
loss_pred:0.028094764798879623, decouple_loss:0.015797870233654976
The generated pressure mean: 0.43398675322532654
loss_pred:0.028523817658424377, decouple_loss:0.01582934334874153
Iteration: 1032, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44889000058174133
loss_pred:0.02948402799665928, decouple_loss:0.016690779477357864
The generated pressure mean: 0.44845613837242126
loss_pred:0.029084622859954834, decouple_loss:0.01633373647928238
The generated pressure mean: 0.4501771628856659
loss_pred:0.028101999312639236, decouple_loss:0.01639210432767868
Iteration: 1033, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44966018199920654
loss_pred:0.030642392113804817, decouple_loss:0.01653348281979561
The generated pressure mean: 0.4527014195919037
loss_pred:0.028642212972044945, decouple_loss:0.016795558854937553
The generated pressure mean: 0.44535666704177856
loss_pred:0.029886791482567787, decouple_loss:0.01628456450998783
Iteration: 1034, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479651153087616
The generated pressure mean: 0.45386385917663574loss_pred:0.030006451532244682, decouple_loss:0.015542118810117245
loss_pred:0.030176881700754166, decouple_loss:0.015978150069713593
The generated pressure mean: 0.44227492809295654
loss_pred:0.029421498998999596, decouple_loss:0.015442575328052044
Iteration: 1035, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.456076443195343
loss_pred:0.029174599796533585, decouple_loss:0.016495266929268837
The generated pressure mean: 0.4498247504234314
loss_pred:0.03077617473900318, decouple_loss:0.017037827521562576
The generated pressure mean: 0.45383378863334656
loss_pred:0.031080905348062515, decouple_loss:0.017095770686864853
Iteration: 1036, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4352945387363434
loss_pred:0.02892119809985161, decouple_loss:0.01832689344882965
The generated pressure mean: 0.438283771276474
loss_pred:0.029956167563796043, decouple_loss:0.018738949671387672
The generated pressure mean: 0.43695056438446045
loss_pred:0.028719119727611542, decouple_loss:0.01824333332479
Iteration: 1037, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44840091466903687
loss_pred:0.02942745015025139, decouple_loss:0.019616562873125076
The generated pressure mean: 0.46154356002807617
loss_pred:0.02866755984723568, decouple_loss:0.01948387734591961
The generated pressure mean: 0.4522928297519684
loss_pred:0.028546931222081184, decouple_loss:0.019432613626122475
Iteration: 1038, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4446916878223419The generated pressure mean: 0.45027536153793335
loss_pred:0.031171811744570732, decouple_loss:0.016451895236968994
loss_pred:0.027610454708337784, decouple_loss:0.01628020405769348
The generated pressure mean: 0.4486332833766937
loss_pred:0.03046829253435135, decouple_loss:0.016672408208251
Iteration: 1039, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4384308159351349
loss_pred:0.027928844094276428, decouple_loss:0.01806694269180298
The generated pressure mean: 0.44482165575027466
loss_pred:0.02943510189652443, decouple_loss:0.01887001283466816
The generated pressure mean: 0.43715763092041016
loss_pred:0.029027381911873817, decouple_loss:0.0179971344769001
Iteration: 1040, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501439929008484
loss_pred:0.028591061010956764, decouple_loss:0.018613236024975777
The generated pressure mean: 0.4466371238231659
loss_pred:0.030110834166407585, decouple_loss:0.018456581979990005
The generated pressure mean: 0.45249542593955994
loss_pred:0.028752604499459267, decouple_loss:0.018653156235814095
2023-04-16 16:11:57 testing...
The generated pressure mean: 0.41588258743286133
The generated pressure mean: 0.4229797124862671
The generated pressure mean: 0.4254409372806549
loss_pred:0.03828805685043335, decouple_loss:0.016354374587535858
loss_pred:0.0371943861246109, decouple_loss:0.016507809981703758
loss_pred:0.036607299000024796, decouple_loss:0.016711026430130005
WV_0_PC_0_EH_1_PS_40, loss: 0.038189470767974854, avg_mse: 0.048584695905447006
current test mse: 0.048585
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 1041, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4555073082447052
loss_pred:0.02797846309840679, decouple_loss:0.016048818826675415
The generated pressure mean: 0.4542006552219391
loss_pred:0.029371529817581177, decouple_loss:0.016653571277856827
The generated pressure mean: 0.45784857869148254
loss_pred:0.028379976749420166, decouple_loss:0.016382688656449318
Iteration: 1042, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44404828548431396
The generated pressure mean: 0.4456711411476135
loss_pred:0.026909654960036278, decouple_loss:0.016240445896983147
loss_pred:0.02858714386820793, decouple_loss:0.016545377671718597
The generated pressure mean: 0.44653189182281494
loss_pred:0.031402356922626495, decouple_loss:0.016540348529815674
Iteration: 1043, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4350351393222809
The generated pressure mean: 0.4342179000377655
loss_pred:0.027558838948607445, decouple_loss:0.017793254926800728
loss_pred:0.031065048649907112, decouple_loss:0.01778981275856495
The generated pressure mean: 0.4346778392791748
loss_pred:0.028859777376055717, decouple_loss:0.017677156254649162
Iteration: 1044, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44258707761764526
loss_pred:0.02893834002315998, decouple_loss:0.014648089185357094
The generated pressure mean: 0.43508854508399963
loss_pred:0.027716385200619698, decouple_loss:0.014819585718214512
The generated pressure mean: 0.4360303580760956
loss_pred:0.027837753295898438, decouple_loss:0.01476588100194931
Iteration: 1045, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46382877230644226
The generated pressure mean: 0.459448903799057
loss_pred:0.028288766741752625, decouple_loss:0.017844298854470253
loss_pred:0.02786323055624962, decouple_loss:0.018046094104647636
The generated pressure mean: 0.46981897950172424
loss_pred:0.028652116656303406, decouple_loss:0.017675643786787987
Iteration: 1046, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486776292324066
The generated pressure mean: 0.4544810652732849
loss_pred:0.029550733044743538, decouple_loss:0.019658656790852547
loss_pred:0.02951306849718094, decouple_loss:0.019785240292549133
The generated pressure mean: 0.4466540813446045
loss_pred:0.028360525146126747, decouple_loss:0.019865036010742188
Iteration: 1047, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4425593614578247
The generated pressure mean: 0.43520236015319824
loss_pred:0.028670135885477066, decouple_loss:0.015698736533522606
loss_pred:0.028952280059456825, decouple_loss:0.01581946574151516
The generated pressure mean: 0.43419939279556274
loss_pred:0.027609683573246002, decouple_loss:0.015589956194162369
Iteration: 1048, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45104292035102844
loss_pred:0.027673348784446716, decouple_loss:0.01781335473060608
The generated pressure mean: 0.45245739817619324
loss_pred:0.027262356132268906, decouple_loss:0.01783919706940651
The generated pressure mean: 0.45201095938682556
loss_pred:0.028641732409596443, decouple_loss:0.01777002401649952
Iteration: 1049, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4517325162887573
loss_pred:0.02796587534248829, decouple_loss:0.019781243056058884
The generated pressure mean: 0.4522503614425659
loss_pred:0.028677094727754593, decouple_loss:0.020015660673379898
The generated pressure mean: 0.45104798674583435
loss_pred:0.029966630041599274, decouple_loss:0.019960561767220497
Iteration: 1050, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43656694889068604
loss_pred:0.02850085310637951, decouple_loss:0.016923177987337112
The generated pressure mean: 0.4374070167541504
loss_pred:0.02951495721936226, decouple_loss:0.01689348928630352
The generated pressure mean: 0.4363011121749878
loss_pred:0.028806885704398155, decouple_loss:0.016682878136634827
2023-04-16 16:14:28 testing...
The generated pressure mean: 0.41831347346305847
The generated pressure mean: 0.42499876022338867
The generated pressure mean: 0.42746374011039734
loss_pred:0.03781900182366371, decouple_loss:0.020392313599586487
loss_pred:0.03674359992146492, decouple_loss:0.02077547274529934
loss_pred:0.03654429316520691, decouple_loss:0.020820533856749535
WV_0_PC_0_EH_1_PS_40, loss: 0.03806877136230469, avg_mse: 0.047993600368499756
current test mse: 0.047994
Iteration: 1051, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4419384300708771
The generated pressure mean: 0.44694462418556213
loss_pred:0.027991311624646187, decouple_loss:0.019627658650279045
loss_pred:0.02830362692475319, decouple_loss:0.019207879900932312
The generated pressure mean: 0.44198107719421387
loss_pred:0.029332315549254417, decouple_loss:0.019427267834544182
Iteration: 1052, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45951423048973083
The generated pressure mean: 0.459453821182251
loss_pred:0.02916453406214714, decouple_loss:0.020403726026415825
loss_pred:0.027601812034845352, decouple_loss:0.020643584430217743
The generated pressure mean: 0.46447014808654785
loss_pred:0.029523631557822227, decouple_loss:0.02078879438340664
Iteration: 1053, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45111966133117676
loss_pred:0.028357015922665596, decouple_loss:0.01773396134376526
The generated pressure mean: 0.4431163966655731
loss_pred:0.02866338938474655, decouple_loss:0.017469843849539757
The generated pressure mean: 0.44381171464920044
loss_pred:0.029210884124040604, decouple_loss:0.01773589849472046
Iteration: 1054, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4420222043991089
The generated pressure mean: 0.4424996078014374
loss_pred:0.02712172269821167, decouple_loss:0.023543722927570343
loss_pred:0.028112834319472313, decouple_loss:0.02320033311843872
The generated pressure mean: 0.4479775130748749
loss_pred:0.02815239317715168, decouple_loss:0.023293713107705116
Iteration: 1055, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44650664925575256
loss_pred:0.028693748638033867, decouple_loss:0.01744382083415985
The generated pressure mean: 0.4470902979373932
loss_pred:0.02811771258711815, decouple_loss:0.017338329926133156
The generated pressure mean: 0.4489600658416748
loss_pred:0.028133807703852654, decouple_loss:0.01732119545340538
Iteration: 1056, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42932769656181335
The generated pressure mean: 0.43454214930534363
loss_pred:0.02745485119521618, decouple_loss:0.023391032591462135
loss_pred:0.028071613982319832, decouple_loss:0.023273644968867302
The generated pressure mean: 0.4335020184516907
loss_pred:0.027425920590758324, decouple_loss:0.023505326360464096
Iteration: 1057, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44984865188598633
The generated pressure mean: 0.45143380761146545
loss_pred:0.031246758997440338, decouple_loss:0.018330855295062065
loss_pred:0.02878783643245697, decouple_loss:0.018378380686044693
The generated pressure mean: 0.45310720801353455
loss_pred:0.027504825964570045, decouple_loss:0.018136462196707726
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1058, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4641380310058594
The generated pressure mean: 0.45923230051994324
loss_pred:0.02882895991206169, decouple_loss:0.024314530193805695
loss_pred:0.029432980343699455, decouple_loss:0.02400890178978443
The generated pressure mean: 0.4587171673774719
loss_pred:0.028788169845938683, decouple_loss:0.024495430290699005
Iteration: 1059, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4351138770580292
The generated pressure mean: 0.4371921122074127
loss_pred:0.026583055034279823, decouple_loss:0.020289074629545212
loss_pred:0.027406025677919388, decouple_loss:0.020090973004698753
The generated pressure mean: 0.43626338243484497
loss_pred:0.027942383661866188, decouple_loss:0.02008701115846634
Iteration: 1060, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43421223759651184
loss_pred:0.02853383682668209, decouple_loss:0.022861186414957047
The generated pressure mean: 0.4333193898200989
loss_pred:0.027678649872541428, decouple_loss:0.02249317429959774
The generated pressure mean: 0.43116137385368347
loss_pred:0.028654685243964195, decouple_loss:0.02260972186923027
2023-04-16 16:16:22 testing...
The generated pressure mean: 0.4227559268474579
The generated pressure mean: 0.4153483808040619
The generated pressure mean: 0.425555557012558
loss_pred:0.03971792757511139, decouple_loss:0.02271837368607521
loss_pred:0.04077284783124924, decouple_loss:0.02229541912674904
loss_pred:0.038939714431762695, decouple_loss:0.022676074877381325
WV_0_PC_0_EH_1_PS_40, loss: 0.040938328951597214, avg_mse: 0.05351799726486206
current test mse: 0.053518
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 1061, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4549178183078766
loss_pred:0.031010905280709267, decouple_loss:0.021284829825162888
The generated pressure mean: 0.46192246675491333
The generated pressure mean: 0.46197572350502014
loss_pred:0.02781170792877674, decouple_loss:0.02118372917175293
loss_pred:0.02871852181851864, decouple_loss:0.021330101415514946
Iteration: 1062, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46289438009262085
The generated pressure mean: 0.4624291658401489
loss_pred:0.027822474017739296, decouple_loss:0.021304352208971977
loss_pred:0.02892770990729332, decouple_loss:0.02156444825232029
The generated pressure mean: 0.46367523074150085
loss_pred:0.02717394381761551, decouple_loss:0.021309256553649902
Iteration: 1063, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4325776696205139
loss_pred:0.02827349305152893, decouple_loss:0.018351957201957703
The generated pressure mean: 0.43393972516059875
loss_pred:0.02856440469622612, decouple_loss:0.018521124497056007
The generated pressure mean: 0.43019741773605347
loss_pred:0.029229318723082542, decouple_loss:0.01830298639833927
Iteration: 1064, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42959344387054443
The generated pressure mean: 0.4282078444957733
loss_pred:0.02955583482980728, decouple_loss:0.020549215376377106
loss_pred:0.029314829036593437, decouple_loss:0.02068050391972065
The generated pressure mean: 0.4357941448688507
loss_pred:0.029412753880023956, decouple_loss:0.020603660494089127
Iteration: 1065, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4757918417453766
The generated pressure mean: 0.47807782888412476
loss_pred:0.028653699904680252, decouple_loss:0.017521407455205917
loss_pred:0.026964634656906128, decouple_loss:0.017316186800599098
The generated pressure mean: 0.47492101788520813
loss_pred:0.03020375780761242, decouple_loss:0.01738813892006874
Iteration: 1066, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4515935480594635
The generated pressure mean: 0.4553903639316559
loss_pred:0.028040725737810135, decouple_loss:0.017845552414655685
loss_pred:0.029186751693487167, decouple_loss:0.018930034711956978
The generated pressure mean: 0.4541185796260834
loss_pred:0.02776866778731346, decouple_loss:0.01783089153468609
Iteration: 1067, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42382800579071045
The generated pressure mean: 0.4210294485092163
loss_pred:0.02751503325998783, decouple_loss:0.017194310203194618
loss_pred:0.029711436480283737, decouple_loss:0.016931211575865746
The generated pressure mean: 0.42268651723861694
loss_pred:0.02957053855061531, decouple_loss:0.016986699774861336
Iteration: 1068, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4619894325733185
loss_pred:0.029214434325695038, decouple_loss:0.01762520521879196
The generated pressure mean: 0.46615538001060486
loss_pred:0.027517247945070267, decouple_loss:0.01756320334970951
The generated pressure mean: 0.4633674621582031
loss_pred:0.03024115413427353, decouple_loss:0.017642196267843246
Iteration: 1069, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44296783208847046
loss_pred:0.029138075187802315, decouple_loss:0.018302369862794876
The generated pressure mean: 0.4425530433654785
loss_pred:0.030085841193795204, decouple_loss:0.01843124069273472
The generated pressure mean: 0.44694945216178894
loss_pred:0.02925986610352993, decouple_loss:0.018304675817489624
Iteration: 1070, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45096567273139954
The generated pressure mean: 0.44711220264434814
loss_pred:0.02800064906477928, decouple_loss:0.017193278297781944
loss_pred:0.028235528618097305, decouple_loss:0.016957689076662064
The generated pressure mean: 0.4474588930606842
loss_pred:0.0286254845559597, decouple_loss:0.01703036017715931
2023-04-16 16:18:52 testing...
The generated pressure mean: 0.4174480438232422
The generated pressure mean: 0.4231356382369995
loss_pred:0.0372142530977726, decouple_loss:0.01790468394756317
The generated pressure mean: 0.42563292384147644
loss_pred:0.03640049323439598, decouple_loss:0.018322966992855072
loss_pred:0.03591327369213104, decouple_loss:0.018293509259819984
WV_0_PC_0_EH_1_PS_40, loss: 0.037418026477098465, avg_mse: 0.046944763511419296
current test mse: 0.046945
Iteration: 1071, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44798538088798523
The generated pressure mean: 0.4506648778915405
loss_pred:0.02972506172955036, decouple_loss:0.017076632007956505
loss_pred:0.027716977521777153, decouple_loss:0.01727994903922081
The generated pressure mean: 0.4463197886943817
loss_pred:0.027858449146151543, decouple_loss:0.016914887353777885
Iteration: 1072, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44947147369384766
The generated pressure mean: 0.4485566318035126
loss_pred:0.02759481780230999, decouple_loss:0.018288200721144676
loss_pred:0.02750183828175068, decouple_loss:0.018135305494070053
The generated pressure mean: 0.44924938678741455
loss_pred:0.027933070436120033, decouple_loss:0.018082136288285255
Iteration: 1073, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4522007703781128
The generated pressure mean: 0.45090532302856445
loss_pred:0.02760677970945835, decouple_loss:0.015278942883014679
loss_pred:0.029803939163684845, decouple_loss:0.015621590428054333
The generated pressure mean: 0.4483073949813843
loss_pred:0.028774654492735863, decouple_loss:0.01545014139264822
Iteration: 1074, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.434762179851532The generated pressure mean: 0.43489745259284973
loss_pred:0.028711222112178802, decouple_loss:0.017640070989727974
loss_pred:0.02841406688094139, decouple_loss:0.017780069261789322
The generated pressure mean: 0.4406930208206177
loss_pred:0.02746225707232952, decouple_loss:0.017722412943840027
Iteration: 1075, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4597133696079254
The generated pressure mean: 0.4603535532951355
loss_pred:0.027345817536115646, decouple_loss:0.01557956449687481
loss_pred:0.02769453451037407, decouple_loss:0.01557217724621296
The generated pressure mean: 0.45895084738731384
loss_pred:0.027747662737965584, decouple_loss:0.01566530391573906
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1076, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470973014831543
loss_pred:0.027315272018313408, decouple_loss:0.014613164588809013
The generated pressure mean: 0.4517580568790436
loss_pred:0.02733733505010605, decouple_loss:0.014647060073912144
The generated pressure mean: 0.4492018222808838
loss_pred:0.02803504839539528, decouple_loss:0.014716566540300846
Iteration: 1077, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4421982765197754
The generated pressure mean: 0.4419885277748108
loss_pred:0.027841176837682724, decouple_loss:0.015182267874479294
loss_pred:0.02736423723399639, decouple_loss:0.015402164310216904
The generated pressure mean: 0.44376927614212036
loss_pred:0.02790043130517006, decouple_loss:0.015229800716042519
Iteration: 1078, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45380711555480957
The generated pressure mean: 0.4566504955291748
loss_pred:0.02680136449635029, decouple_loss:0.014952562749385834
loss_pred:0.028104733675718307, decouple_loss:0.015078934840857983
The generated pressure mean: 0.4564536213874817
loss_pred:0.027190780267119408, decouple_loss:0.015257507562637329
Iteration: 1079, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474867880344391
The generated pressure mean: 0.44709351658821106
loss_pred:0.027870887890458107, decouple_loss:0.01442761067301035
loss_pred:0.02924249693751335, decouple_loss:0.014621692709624767
The generated pressure mean: 0.4506729245185852
loss_pred:0.027646180242300034, decouple_loss:0.014208096079528332
Iteration: 1080, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43864068388938904
loss_pred:0.027937524020671844, decouple_loss:0.014364916831254959
The generated pressure mean: 0.4343121349811554
loss_pred:0.028507553040981293, decouple_loss:0.014191847294569016
The generated pressure mean: 0.4384153485298157
loss_pred:0.02768057957291603, decouple_loss:0.014135429635643959
2023-04-16 16:20:45 testing...
The generated pressure mean: 0.42224475741386414
The generated pressure mean: 0.41587767004966736
loss_pred:0.03635060787200928, decouple_loss:0.015884455293416977
The generated pressure mean: 0.4246756136417389
loss_pred:0.03706473857164383, decouple_loss:0.015292126685380936
loss_pred:0.035654012113809586, decouple_loss:0.015937896445393562
WV_0_PC_0_EH_1_PS_40, loss: 0.037141695618629456, avg_mse: 0.046991195529699326
current test mse: 0.046991
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 1081, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45711034536361694
loss_pred:0.028244882822036743, decouple_loss:0.014305775985121727
The generated pressure mean: 0.4552984833717346
loss_pred:0.026953037828207016, decouple_loss:0.014516090974211693
The generated pressure mean: 0.45618540048599243
loss_pred:0.026940716430544853, decouple_loss:0.014457455836236477
Iteration: 1082, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476485550403595
loss_pred:0.02869906648993492, decouple_loss:0.01569327525794506
The generated pressure mean: 0.4525001049041748
loss_pred:0.027585845440626144, decouple_loss:0.015843816101551056
The generated pressure mean: 0.44956159591674805
loss_pred:0.029100684449076653, decouple_loss:0.015590651892125607
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1083, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482436180114746
The generated pressure mean: 0.4451933205127716
loss_pred:0.028531096875667572, decouple_loss:0.014752204529941082
loss_pred:0.029307929798960686, decouple_loss:0.014334820210933685
The generated pressure mean: 0.44149890542030334
loss_pred:0.02972220629453659, decouple_loss:0.014500092715024948
Iteration: 1084, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44028496742248535
The generated pressure mean: 0.4395716190338135
loss_pred:0.02645394764840603, decouple_loss:0.015110776759684086
loss_pred:0.02746429666876793, decouple_loss:0.01476785447448492
The generated pressure mean: 0.4388943314552307
loss_pred:0.026788711547851562, decouple_loss:0.014957338571548462
Iteration: 1085, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44810160994529724
The generated pressure mean: 0.4471551775932312
loss_pred:0.02866007573902607, decouple_loss:0.01345318928360939
loss_pred:0.027534427121281624, decouple_loss:0.013836248777806759
The generated pressure mean: 0.4483998417854309
loss_pred:0.02784002013504505, decouple_loss:0.013716029934585094
Iteration: 1086, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45044219493865967
The generated pressure mean: 0.44875645637512207
loss_pred:0.028782492503523827, decouple_loss:0.014205987565219402
loss_pred:0.028217924758791924, decouple_loss:0.01418631337583065
The generated pressure mean: 0.4471147358417511
loss_pred:0.028399638831615448, decouple_loss:0.014145656488835812
Iteration: 1087, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4509303867816925
loss_pred:0.026792077347636223, decouple_loss:0.013340183533728123
The generated pressure mean: 0.44458240270614624
loss_pred:0.02768866717815399, decouple_loss:0.013336807489395142
The generated pressure mean: 0.4455685317516327
loss_pred:0.02802879735827446, decouple_loss:0.013518467545509338
Iteration: 1088, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4510195851325989
The generated pressure mean: 0.4522428512573242
loss_pred:0.02806623838841915, decouple_loss:0.014540442265570164
loss_pred:0.027729393914341927, decouple_loss:0.014679145067930222
The generated pressure mean: 0.4487292766571045
loss_pred:0.028451059013605118, decouple_loss:0.014736787416040897
Iteration: 1089, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.442361980676651
loss_pred:0.02831634320318699, decouple_loss:0.014390349388122559
The generated pressure mean: 0.44566458463668823
loss_pred:0.027644112706184387, decouple_loss:0.014366059564054012
The generated pressure mean: 0.44280341267585754
loss_pred:0.027946557849645615, decouple_loss:0.014358850196003914
Iteration: 1090, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44319137930870056
The generated pressure mean: 0.44507330656051636
loss_pred:0.02770560048520565, decouple_loss:0.015344907529652119
loss_pred:0.026955632492899895, decouple_loss:0.015117568895220757
The generated pressure mean: 0.45213308930397034
loss_pred:0.026295596733689308, decouple_loss:0.01490282453596592
2023-04-16 16:23:16 testing...
The generated pressure mean: 0.41745343804359436
The generated pressure mean: 0.4250536859035492
The generated pressure mean: 0.4276749789714813
loss_pred:0.038022156804800034, decouple_loss:0.014712817966938019
loss_pred:0.037041760981082916, decouple_loss:0.015288488008081913
loss_pred:0.036699727177619934, decouple_loss:0.015227418392896652
WV_0_PC_0_EH_1_PS_40, loss: 0.03800836205482483, avg_mse: 0.04916766658425331
current test mse: 0.049168
Iteration: 1091, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4512382447719574
The generated pressure mean: 0.4546796679496765
loss_pred:0.02783352881669998, decouple_loss:0.013658183626830578
loss_pred:0.02620111219584942, decouple_loss:0.013678439892828465
The generated pressure mean: 0.4514741897583008
loss_pred:0.029018182307481766, decouple_loss:0.013858627527952194
Iteration: 1092, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4361935257911682
The generated pressure mean: 0.43105944991111755
loss_pred:0.027324415743350983, decouple_loss:0.013761857524514198
loss_pred:0.02751312032341957, decouple_loss:0.013733518309891224
The generated pressure mean: 0.4372015595436096
loss_pred:0.027868961915373802, decouple_loss:0.013926751911640167
Iteration: 1093, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44879773259162903
The generated pressure mean: 0.44058018922805786
loss_pred:0.02683289721608162, decouple_loss:0.01414219569414854
loss_pred:0.029174551367759705, decouple_loss:0.014258338138461113
The generated pressure mean: 0.43861907720565796
loss_pred:0.02697492390871048, decouple_loss:0.014145052060484886
Iteration: 1094, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45123204588890076
The generated pressure mean: 0.45657745003700256
loss_pred:0.027645394206047058, decouple_loss:0.013234698213636875
loss_pred:0.02542729862034321, decouple_loss:0.0132598876953125
The generated pressure mean: 0.4518980085849762
loss_pred:0.02785758301615715, decouple_loss:0.013236337341368198
Iteration: 1095, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4458639621734619
The generated pressure mean: 0.4473213851451874
loss_pred:0.027164846658706665, decouple_loss:0.01351501327008009
loss_pred:0.028583385050296783, decouple_loss:0.013521255925297737
The generated pressure mean: 0.4507923126220703
loss_pred:0.026741988956928253, decouple_loss:0.013569386675953865
Iteration: 1096, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44114601612091064
The generated pressure mean: 0.44272661209106445
loss_pred:0.027066411450505257, decouple_loss:0.014087253250181675
loss_pred:0.026823237538337708, decouple_loss:0.013879991136491299
The generated pressure mean: 0.44153279066085815
loss_pred:0.028809314593672752, decouple_loss:0.013999906368553638
Iteration: 1097, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473723769187927
The generated pressure mean: 0.4471540153026581
loss_pred:0.028828153386712074, decouple_loss:0.014322703704237938
loss_pred:0.028355572372674942, decouple_loss:0.014249849133193493
The generated pressure mean: 0.4473537802696228
loss_pred:0.028425857424736023, decouple_loss:0.014372356235980988
Iteration: 1098, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.451995849609375
The generated pressure mean: 0.45503440499305725
loss_pred:0.027546614408493042, decouple_loss:0.01412462629377842
loss_pred:0.0255451463162899, decouple_loss:0.01415977906435728
The generated pressure mean: 0.45152008533477783
loss_pred:0.028019657358527184, decouple_loss:0.013762758113443851
Iteration: 1099, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45398998260498047
The generated pressure mean: 0.4526684880256653
loss_pred:0.02682294137775898, decouple_loss:0.0141913378611207
loss_pred:0.027219455689191818, decouple_loss:0.01416685152798891
The generated pressure mean: 0.4497070610523224
loss_pred:0.027968399226665497, decouple_loss:0.014027781784534454
Iteration: 1100, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43641406297683716
The generated pressure mean: 0.436051607131958
loss_pred:0.027181269600987434, decouple_loss:0.013128004036843777
loss_pred:0.02655756287276745, decouple_loss:0.012980171479284763
The generated pressure mean: 0.4359187185764313
loss_pred:0.02601201832294464, decouple_loss:0.01296340860426426
2023-04-16 16:25:09 testing...
The generated pressure mean: 0.41824620962142944
The generated pressure mean: 0.42515215277671814
The generated pressure mean: 0.4275350868701935
loss_pred:0.037130728363990784, decouple_loss:0.013829783536493778
loss_pred:0.0360381118953228, decouple_loss:0.014411323703825474
loss_pred:0.0353986993432045, decouple_loss:0.014420988038182259
WV_0_PC_0_EH_1_PS_40, loss: 0.03690021485090256, avg_mse: 0.047097932547330856
current test mse: 0.047098
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 1101, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460972845554352
loss_pred:0.027467960491776466, decouple_loss:0.01318975817412138
The generated pressure mean: 0.4456613063812256
loss_pred:0.028357241302728653, decouple_loss:0.013355127535760403
The generated pressure mean: 0.44978436827659607
loss_pred:0.026980029419064522, decouple_loss:0.013276679441332817
Iteration: 1102, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484764337539673
The generated pressure mean: 0.4469241499900818
loss_pred:0.027942104265093803, decouple_loss:0.013818402774631977
loss_pred:0.027432499453425407, decouple_loss:0.013757238164544106
The generated pressure mean: 0.4503573179244995
loss_pred:0.026831993833184242, decouple_loss:0.014235361479222775
Iteration: 1103, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44875264167785645
The generated pressure mean: 0.45114731788635254
loss_pred:0.028530297800898552, decouple_loss:0.013873305171728134
loss_pred:0.029630854725837708, decouple_loss:0.01339893601834774
The generated pressure mean: 0.4429292678833008
loss_pred:0.027996666729450226, decouple_loss:0.013948602601885796
Iteration: 1104, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45252448320388794
The generated pressure mean: 0.45051154494285583
loss_pred:0.027383094653487206, decouple_loss:0.013546803966164589
loss_pred:0.02710811048746109, decouple_loss:0.013451842591166496
The generated pressure mean: 0.4493868350982666
loss_pred:0.028852280229330063, decouple_loss:0.013400914147496223
Iteration: 1105, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487271010875702
The generated pressure mean: 0.452912837266922
loss_pred:0.028027070686221123, decouple_loss:0.012847396545112133
loss_pred:0.0275456290692091, decouple_loss:0.012846636585891247
The generated pressure mean: 0.4553034007549286
loss_pred:0.027485063299536705, decouple_loss:0.013413398526608944
Iteration: 1106, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45334476232528687
loss_pred:0.027695368975400925, decouple_loss:0.013353339396417141
The generated pressure mean: 0.4445011019706726
loss_pred:0.027823174372315407, decouple_loss:0.013455281034111977
The generated pressure mean: 0.4484982490539551
loss_pred:0.028786426410079002, decouple_loss:0.013117510825395584
Iteration: 1107, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4373687505722046
The generated pressure mean: 0.43322935700416565
loss_pred:0.02791639044880867, decouple_loss:0.014146913774311543
loss_pred:0.028154371306300163, decouple_loss:0.013539747335016727
The generated pressure mean: 0.4345684051513672
loss_pred:0.027210265398025513, decouple_loss:0.013770721852779388
Iteration: 1108, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45862868428230286
The generated pressure mean: 0.4600052535533905
loss_pred:0.02714299038052559, decouple_loss:0.013721466064453125
loss_pred:0.026454543694853783, decouple_loss:0.013746063224971294
The generated pressure mean: 0.46139469742774963
loss_pred:0.027186593040823936, decouple_loss:0.01376300398260355
Iteration: 1109, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4522596001625061
The generated pressure mean: 0.453378826379776
loss_pred:0.028061646968126297, decouple_loss:0.013267377391457558
loss_pred:0.026745542883872986, decouple_loss:0.013796980492770672
The generated pressure mean: 0.4563314914703369
loss_pred:0.028865136206150055, decouple_loss:0.013802398927509785
Iteration: 1110, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4291330575942993
The generated pressure mean: 0.42188870906829834
loss_pred:0.028605394065380096, decouple_loss:0.01482323743402958
loss_pred:0.02803858183324337, decouple_loss:0.014828689396381378
The generated pressure mean: 0.42861470580101013
loss_pred:0.02747499570250511, decouple_loss:0.014846494421362877
2023-04-16 16:27:38 testing...
The generated pressure mean: 0.4164554476737976
The generated pressure mean: 0.42360374331474304
The generated pressure mean: 0.4258127212524414
loss_pred:0.03744438290596008, decouple_loss:0.014600099995732307
loss_pred:0.03637845441699028, decouple_loss:0.014918286353349686
loss_pred:0.03573032096028328, decouple_loss:0.014971118420362473
WV_0_PC_0_EH_1_PS_40, loss: 0.037259213626384735, avg_mse: 0.047817666083574295
current test mse: 0.047818
Iteration: 1111, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4511376917362213
loss_pred:0.0270855650305748, decouple_loss:0.01406356692314148
The generated pressure mean: 0.4589537978172302
loss_pred:0.02803761698305607, decouple_loss:0.013975035399198532
The generated pressure mean: 0.45265114307403564
loss_pred:0.027194781228899956, decouple_loss:0.014522679150104523
Iteration: 1112, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45472750067710876
loss_pred:0.02797938510775566, decouple_loss:0.014509611763060093
The generated pressure mean: 0.45418819785118103
loss_pred:0.027258822694420815, decouple_loss:0.01458282582461834
The generated pressure mean: 0.46399566531181335
loss_pred:0.02852357178926468, decouple_loss:0.014475150033831596
Iteration: 1113, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44199928641319275
loss_pred:0.029293667525053024, decouple_loss:0.013578381389379501
The generated pressure mean: 0.4456031918525696
loss_pred:0.02756498195230961, decouple_loss:0.01380559429526329
The generated pressure mean: 0.442722886800766
loss_pred:0.026621270924806595, decouple_loss:0.01346276793628931
Iteration: 1114, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4341728389263153
loss_pred:0.027288902550935745, decouple_loss:0.013640502467751503
The generated pressure mean: 0.42405325174331665
loss_pred:0.027415882796049118, decouple_loss:0.013775455765426159
The generated pressure mean: 0.4296115040779114
loss_pred:0.027077551931142807, decouple_loss:0.013917054049670696
Iteration: 1115, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45982760190963745
loss_pred:0.026974275708198547, decouple_loss:0.01589750126004219
The generated pressure mean: 0.4592449963092804
loss_pred:0.02766330912709236, decouple_loss:0.015071935951709747
The generated pressure mean: 0.46401023864746094
loss_pred:0.02810073457658291, decouple_loss:0.015349900349974632
Iteration: 1116, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46231284737586975
loss_pred:0.02791040763258934, decouple_loss:0.014139619655907154
The generated pressure mean: 0.4653577506542206
loss_pred:0.027514509856700897, decouple_loss:0.014366415329277515
The generated pressure mean: 0.46600785851478577
loss_pred:0.02709043398499489, decouple_loss:0.014159453101456165
Iteration: 1117, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4383392632007599
loss_pred:0.027483196929097176, decouple_loss:0.016644613817334175
The generated pressure mean: 0.4396297335624695
The generated pressure mean: 0.435554176568985loss_pred:0.02627573534846306, decouple_loss:0.016456497833132744
loss_pred:0.026833584532141685, decouple_loss:0.016626553609967232
Iteration: 1118, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4358360469341278
loss_pred:0.02742530032992363, decouple_loss:0.014227605424821377
The generated pressure mean: 0.4256627857685089
The generated pressure mean: 0.44551387429237366
loss_pred:0.02812482975423336, decouple_loss:0.014565406367182732
loss_pred:0.028132235631346703, decouple_loss:0.014988553710281849
Iteration: 1119, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4550294876098633
loss_pred:0.02684895507991314, decouple_loss:0.015589283779263496
The generated pressure mean: 0.4561348557472229
loss_pred:0.028467239812016487, decouple_loss:0.015535500831902027
The generated pressure mean: 0.46089157462120056
loss_pred:0.027434565126895905, decouple_loss:0.015563332475721836
Iteration: 1120, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44804415106773376
loss_pred:0.029663342982530594, decouple_loss:0.015400893986225128
The generated pressure mean: 0.4515588879585266
loss_pred:0.027557486668229103, decouple_loss:0.015441647730767727
The generated pressure mean: 0.4550597667694092
loss_pred:0.02755110338330269, decouple_loss:0.01536138728260994
2023-04-16 16:29:30 testing...
The generated pressure mean: 0.4209994673728943
The generated pressure mean: 0.4266318678855896
loss_pred:0.03859315440058708, decouple_loss:0.016369350254535675
The generated pressure mean: 0.42877012491226196
loss_pred:0.037582360208034515, decouple_loss:0.016547778621315956
loss_pred:0.037047386169433594, decouple_loss:0.01661478914320469
WV_0_PC_0_EH_1_PS_40, loss: 0.03856649994850159, avg_mse: 0.04964680224657059
current test mse: 0.049647
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
Iteration: 1121, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43735629320144653
loss_pred:0.02993122674524784, decouple_loss:0.01605924405157566
The generated pressure mean: 0.43681156635284424
loss_pred:0.030299915000796318, decouple_loss:0.015986109152436256
The generated pressure mean: 0.4372480809688568
loss_pred:0.030076531693339348, decouple_loss:0.016459019854664803
Iteration: 1122, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4522785544395447
loss_pred:0.027733419090509415, decouple_loss:0.015049104578793049
The generated pressure mean: 0.45215386152267456
loss_pred:0.028690753504633904, decouple_loss:0.014546854421496391
The generated pressure mean: 0.4499683976173401
loss_pred:0.029379891231656075, decouple_loss:0.014987642876803875
Iteration: 1123, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45457515120506287
loss_pred:0.02807052992284298, decouple_loss:0.01583276130259037
The generated pressure mean: 0.4559873938560486
loss_pred:0.028871990740299225, decouple_loss:0.016208739951252937
The generated pressure mean: 0.45509573817253113
loss_pred:0.030969364568591118, decouple_loss:0.016212912276387215
Iteration: 1124, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42632272839546204
loss_pred:0.027582990005612373, decouple_loss:0.015433385968208313
The generated pressure mean: 0.429085373878479
loss_pred:0.028678450733423233, decouple_loss:0.015240997076034546
The generated pressure mean: 0.42718783020973206
loss_pred:0.027536319568753242, decouple_loss:0.015529420226812363
Iteration: 1125, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44553670287132263
loss_pred:0.027996480464935303, decouple_loss:0.016206519678235054
The generated pressure mean: 0.4467372000217438
loss_pred:0.029467357322573662, decouple_loss:0.016103392466902733
The generated pressure mean: 0.4491393566131592
loss_pred:0.027129124850034714, decouple_loss:0.016027657315135002
Iteration: 1126, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46282869577407837
loss_pred:0.02806890942156315, decouple_loss:0.016147904098033905
The generated pressure mean: 0.4617635905742645
The generated pressure mean: 0.4627513587474823
loss_pred:0.028032368049025536, decouple_loss:0.01570797897875309
loss_pred:0.032484982162714005, decouple_loss:0.015836477279663086
Iteration: 1127, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.41864854097366333
loss_pred:0.02775277942419052, decouple_loss:0.016602516174316406
The generated pressure mean: 0.4162816107273102
loss_pred:0.028167808428406715, decouple_loss:0.01660528965294361
The generated pressure mean: 0.4241013526916504
loss_pred:0.028946083039045334, decouple_loss:0.01678629405796528
Iteration: 1128, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4366307258605957
loss_pred:0.028324851766228676, decouple_loss:0.015477461740374565
The generated pressure mean: 0.44347625970840454
loss_pred:0.028588447719812393, decouple_loss:0.015811927616596222
The generated pressure mean: 0.43925562500953674
loss_pred:0.027953846380114555, decouple_loss:0.015821320936083794
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1129, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47617629170417786
loss_pred:0.02944566309452057, decouple_loss:0.015140139497816563
The generated pressure mean: 0.4725610315799713
The generated pressure mean: 0.47087791562080383
loss_pred:0.028866857290267944, decouple_loss:0.015167072415351868
loss_pred:0.02808259427547455, decouple_loss:0.015442043542861938
Iteration: 1130, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45548558235168457
loss_pred:0.02855418622493744, decouple_loss:0.015048393048346043
The generated pressure mean: 0.45127344131469727
The generated pressure mean: 0.45461025834083557
loss_pred:0.026770230382680893, decouple_loss:0.014726835303008556
loss_pred:0.027374286204576492, decouple_loss:0.015369455330073833
2023-04-16 16:32:01 testing...
The generated pressure mean: 0.4217032790184021
The generated pressure mean: 0.42737525701522827
loss_pred:0.03879353404045105, decouple_loss:0.0154966339468956
The generated pressure mean: 0.42935848236083984
loss_pred:0.0381794199347496, decouple_loss:0.015763569623231888
loss_pred:0.037666674703359604, decouple_loss:0.015836631879210472
WV_0_PC_0_EH_1_PS_40, loss: 0.038998156785964966, avg_mse: 0.050883978605270386
current test mse: 0.050884
Iteration: 1131, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4318528473377228
loss_pred:0.027197876945137978, decouple_loss:0.015173764899373055
The generated pressure mean: 0.42992186546325684
loss_pred:0.028979796916246414, decouple_loss:0.014751406386494637
The generated pressure mean: 0.43026211857795715
loss_pred:0.02768079750239849, decouple_loss:0.014832266606390476
Iteration: 1132, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43922117352485657
The generated pressure mean: 0.4358588755130768
loss_pred:0.02768731489777565, decouple_loss:0.015073273330926895
loss_pred:0.028182217851281166, decouple_loss:0.015007846988737583
The generated pressure mean: 0.4341278076171875
loss_pred:0.029081178829073906, decouple_loss:0.014890500344336033
Iteration: 1133, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4517410397529602
The generated pressure mean: 0.45742514729499817
loss_pred:0.028705986216664314, decouple_loss:0.015248524025082588
loss_pred:0.030077051371335983, decouple_loss:0.015518739819526672
The generated pressure mean: 0.45965173840522766
loss_pred:0.028715118765830994, decouple_loss:0.01518767885863781
Iteration: 1134, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4400419592857361
The generated pressure mean: 0.44155314564704895
loss_pred:0.030263831838965416, decouple_loss:0.0156867653131485
loss_pred:0.028234485536813736, decouple_loss:0.015158537775278091
The generated pressure mean: 0.4376552402973175
loss_pred:0.027999019250273705, decouple_loss:0.015244743786752224
Iteration: 1135, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503328800201416
The generated pressure mean: 0.45162972807884216
loss_pred:0.027929015457630157, decouple_loss:0.01544896699488163
loss_pred:0.0281508881598711, decouple_loss:0.015488678589463234
The generated pressure mean: 0.4511646032333374
loss_pred:0.027357161045074463, decouple_loss:0.015415084548294544
Iteration: 1136, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4584675133228302
loss_pred:0.027773376554250717, decouple_loss:0.015078243799507618The generated pressure mean: 0.4542965292930603
loss_pred:0.0286598838865757, decouple_loss:0.015020697377622128
The generated pressure mean: 0.45582205057144165
loss_pred:0.027050817385315895, decouple_loss:0.015120171010494232
Iteration: 1137, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4345638155937195
The generated pressure mean: 0.433809757232666
loss_pred:0.028178315609693527, decouple_loss:0.014930985867977142
loss_pred:0.029622407630085945, decouple_loss:0.015017715282738209
The generated pressure mean: 0.43741345405578613
loss_pred:0.027471326291561127, decouple_loss:0.014863338321447372
Iteration: 1138, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4314029812812805
loss_pred:0.029567580670118332, decouple_loss:0.014579208567738533
The generated pressure mean: 0.43683022260665894
loss_pred:0.026662008836865425, decouple_loss:0.014690056443214417
The generated pressure mean: 0.4378208518028259
loss_pred:0.02730555273592472, decouple_loss:0.014508409425616264
Iteration: 1139, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4525967836380005
The generated pressure mean: 0.45133721828460693
loss_pred:0.026335759088397026, decouple_loss:0.014348010532557964
loss_pred:0.02817073091864586, decouple_loss:0.013999604620039463
The generated pressure mean: 0.45084837079048157
loss_pred:0.02857859991490841, decouple_loss:0.014266074635088444
Iteration: 1140, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502757489681244
The generated pressure mean: 0.4551149308681488loss_pred:0.02777213789522648, decouple_loss:0.013656925410032272
loss_pred:0.026458965614438057, decouple_loss:0.013619455508887768
The generated pressure mean: 0.4528755843639374
loss_pred:0.02886783517897129, decouple_loss:0.013683870434761047
2023-04-16 16:33:54 testing...
The generated pressure mean: 0.41889747977256775
The generated pressure mean: 0.4252132773399353
loss_pred:0.03658269718289375, decouple_loss:0.014072398655116558
The generated pressure mean: 0.4276619553565979
loss_pred:0.03553638607263565, decouple_loss:0.014497436583042145
loss_pred:0.035042330622673035, decouple_loss:0.01460778247565031
WV_0_PC_0_EH_1_PS_40, loss: 0.03644010052084923, avg_mse: 0.04641639441251755
current test mse: 0.046416
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 1141, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4412367641925812
loss_pred:0.027764419093728065, decouple_loss:0.014044865034520626
The generated pressure mean: 0.44178587198257446
loss_pred:0.0277881883084774, decouple_loss:0.014001847244799137
The generated pressure mean: 0.4446895718574524
loss_pred:0.02666527032852173, decouple_loss:0.01367897167801857
Iteration: 1142, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44898417592048645
The generated pressure mean: 0.4514572024345398
loss_pred:0.029496166855096817, decouple_loss:0.013639205135405064
loss_pred:0.0258199293166399, decouple_loss:0.013731162995100021
The generated pressure mean: 0.45094770193099976
loss_pred:0.025793373584747314, decouple_loss:0.013360493816435337
Iteration: 1143, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44399815797805786
loss_pred:0.026249149814248085, decouple_loss:0.013447321020066738
The generated pressure mean: 0.44621413946151733
loss_pred:0.025935865938663483, decouple_loss:0.01357665378600359
The generated pressure mean: 0.4449591040611267
loss_pred:0.026969099417328835, decouple_loss:0.013826217502355576
Iteration: 1144, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44074365496635437
The generated pressure mean: 0.44741424918174744
loss_pred:0.026511989533901215, decouple_loss:0.014400743879377842
loss_pred:0.027716396376490593, decouple_loss:0.014277330599725246
The generated pressure mean: 0.4461267590522766
loss_pred:0.026961492374539375, decouple_loss:0.014114446938037872
Iteration: 1145, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4415638744831085
The generated pressure mean: 0.44950008392333984
loss_pred:0.026385150849819183, decouple_loss:0.015585454180836678
loss_pred:0.026551522314548492, decouple_loss:0.015762919560074806
The generated pressure mean: 0.4390125274658203
loss_pred:0.025908831506967545, decouple_loss:0.01560548972338438
Iteration: 1146, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4610745906829834
loss_pred:0.02745024673640728, decouple_loss:0.017005234956741333
The generated pressure mean: 0.4629674553871155
loss_pred:0.027333637699484825, decouple_loss:0.017589056864380836
The generated pressure mean: 0.45919960737228394
loss_pred:0.02779237926006317, decouple_loss:0.01713472604751587
Iteration: 1147, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4380766749382019The generated pressure mean: 0.4434165358543396
loss_pred:0.026818029582500458, decouple_loss:0.014924402348697186loss_pred:0.027506673708558083, decouple_loss:0.014823813922703266
The generated pressure mean: 0.4340410530567169
loss_pred:0.02638208493590355, decouple_loss:0.01476341299712658
Iteration: 1148, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.435660719871521
The generated pressure mean: 0.4382661283016205
loss_pred:0.02816730923950672, decouple_loss:0.014317050576210022
loss_pred:0.02764228917658329, decouple_loss:0.014512614347040653
The generated pressure mean: 0.4390128552913666
loss_pred:0.026257142424583435, decouple_loss:0.01454999204725027
Iteration: 1149, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45621955394744873
loss_pred:0.026936251670122147, decouple_loss:0.014573904685676098
The generated pressure mean: 0.4510745108127594
loss_pred:0.02772108092904091, decouple_loss:0.014451386407017708
The generated pressure mean: 0.4523741900920868
loss_pred:0.02568550780415535, decouple_loss:0.014411660842597485
Iteration: 1150, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45445743203163147
The generated pressure mean: 0.44885703921318054
loss_pred:0.026482269167900085, decouple_loss:0.014470714144408703
loss_pred:0.027591869235038757, decouple_loss:0.014348841272294521
The generated pressure mean: 0.445374071598053
loss_pred:0.026757869869470596, decouple_loss:0.014422327280044556
2023-04-16 16:36:25 testing...
The generated pressure mean: 0.41831693053245544
The generated pressure mean: 0.4252512454986572
The generated pressure mean: 0.42760950326919556
loss_pred:0.03630964085459709, decouple_loss:0.015311306342482567
loss_pred:0.03547031432390213, decouple_loss:0.01564282551407814
loss_pred:0.03485867381095886, decouple_loss:0.01570330560207367
WV_0_PC_0_EH_1_PS_40, loss: 0.03632383421063423, avg_mse: 0.04642380774021149
current test mse: 0.046424
Iteration: 1151, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452531635761261
loss_pred:0.025845704600214958, decouple_loss:0.014863939955830574
The generated pressure mean: 0.4457835257053375
loss_pred:0.027645958587527275, decouple_loss:0.014599746093153954
The generated pressure mean: 0.4473791718482971
loss_pred:0.027057185769081116, decouple_loss:0.015060327015817165
Iteration: 1152, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4434497356414795
The generated pressure mean: 0.4430645704269409
loss_pred:0.027946004644036293, decouple_loss:0.014067672193050385
loss_pred:0.026678159832954407, decouple_loss:0.013836251571774483
The generated pressure mean: 0.44156816601753235
loss_pred:0.026811599731445312, decouple_loss:0.013918004930019379
Iteration: 1153, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46076029539108276
The generated pressure mean: 0.4560883045196533
loss_pred:0.027333417907357216, decouple_loss:0.014301346614956856
loss_pred:0.026597527787089348, decouple_loss:0.014641260728240013
The generated pressure mean: 0.45323848724365234
loss_pred:0.027520881965756416, decouple_loss:0.01426341850310564
Iteration: 1154, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472169876098633
The generated pressure mean: 0.44292151927948
loss_pred:0.026577213779091835, decouple_loss:0.013798383064568043
loss_pred:0.02613918110728264, decouple_loss:0.013927068561315536
The generated pressure mean: 0.4441400170326233
loss_pred:0.027956927195191383, decouple_loss:0.014156465418636799
Iteration: 1155, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43862003087997437
The generated pressure mean: 0.4492664933204651
loss_pred:0.02594994381070137, decouple_loss:0.012980318628251553
loss_pred:0.026612255722284317, decouple_loss:0.012845571152865887
The generated pressure mean: 0.44174161553382874
loss_pred:0.028242819011211395, decouple_loss:0.013508393429219723
Iteration: 1156, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43698567152023315
loss_pred:0.026388203725218773, decouple_loss:0.012831524945795536
The generated pressure mean: 0.43939971923828125
loss_pred:0.02572501264512539, decouple_loss:0.012958216480910778
The generated pressure mean: 0.4399615228176117
loss_pred:0.026336703449487686, decouple_loss:0.012790663167834282
Iteration: 1157, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4561117887496948
The generated pressure mean: 0.45696112513542175
loss_pred:0.026912376284599304, decouple_loss:0.014356924220919609
loss_pred:0.026772264391183853, decouple_loss:0.014165213331580162
The generated pressure mean: 0.4555100202560425
loss_pred:0.029614096507430077, decouple_loss:0.013961894437670708
Iteration: 1158, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44575557112693787
The generated pressure mean: 0.4449998438358307
loss_pred:0.02695566788315773, decouple_loss:0.015048688277602196
loss_pred:0.028018485754728317, decouple_loss:0.014953142032027245
The generated pressure mean: 0.44999781250953674
loss_pred:0.02670891210436821, decouple_loss:0.01499937940388918
Iteration: 1159, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4440871477127075
loss_pred:0.027391748502850533, decouple_loss:0.013981686905026436
The generated pressure mean: 0.4410564601421356
loss_pred:0.027323994785547256, decouple_loss:0.013652353547513485
The generated pressure mean: 0.44554203748703003
loss_pred:0.026365676894783974, decouple_loss:0.014067360199987888
Iteration: 1160, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493502676486969
loss_pred:0.02775941602885723, decouple_loss:0.013566161505877972
The generated pressure mean: 0.447785347700119
loss_pred:0.02686079777777195, decouple_loss:0.013533860445022583
The generated pressure mean: 0.44784486293792725
loss_pred:0.026544177904725075, decouple_loss:0.013464843854308128
2023-04-16 16:38:19 testing...
The generated pressure mean: 0.41752690076828003
The generated pressure mean: 0.4238489270210266
loss_pred:0.03660951927304268, decouple_loss:0.0136485630646348
The generated pressure mean: 0.4263509213924408
loss_pred:0.03561229631304741, decouple_loss:0.01398062240332365
loss_pred:0.034958455711603165, decouple_loss:0.014030822552740574
WV_0_PC_0_EH_1_PS_40, loss: 0.03642109036445618, avg_mse: 0.046854615211486816
current test mse: 0.046855
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 1161, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45440638065338135
loss_pred:0.027450039982795715, decouple_loss:0.013006611727178097
The generated pressure mean: 0.452610582113266
loss_pred:0.02654973976314068, decouple_loss:0.012901188805699348
The generated pressure mean: 0.4496561586856842
loss_pred:0.02567034773528576, decouple_loss:0.013094102963805199
Iteration: 1162, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44614946842193604
The generated pressure mean: 0.44226959347724915
loss_pred:0.026112975552678108, decouple_loss:0.014774615876376629
loss_pred:0.025743111968040466, decouple_loss:0.01435108296573162
The generated pressure mean: 0.4395844042301178
loss_pred:0.02714400179684162, decouple_loss:0.014859518967568874
Iteration: 1163, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45674383640289307
The generated pressure mean: 0.4507611095905304
loss_pred:0.02588864602148533, decouple_loss:0.014103283174335957
loss_pred:0.02691970206797123, decouple_loss:0.014136983081698418
The generated pressure mean: 0.46103641390800476
loss_pred:0.025809084996581078, decouple_loss:0.014084485359489918
Iteration: 1164, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44762247800827026
The generated pressure mean: 0.4486798346042633
loss_pred:0.026662688702344894, decouple_loss:0.013597853481769562
loss_pred:0.02609577588737011, decouple_loss:0.013533229008316994
The generated pressure mean: 0.4457733929157257
loss_pred:0.025736499577760696, decouple_loss:0.01331440918147564
Iteration: 1165, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4300747215747833The generated pressure mean: 0.42899733781814575
loss_pred:0.026193484663963318, decouple_loss:0.01380978710949421
loss_pred:0.02704908326268196, decouple_loss:0.013193152844905853
The generated pressure mean: 0.4286899268627167
loss_pred:0.027235381305217743, decouple_loss:0.01311575062572956
Iteration: 1166, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4580211341381073
The generated pressure mean: 0.46269169449806213
loss_pred:0.025870736688375473, decouple_loss:0.013236218132078648
loss_pred:0.026004264131188393, decouple_loss:0.013459572568535805
The generated pressure mean: 0.45386838912963867
loss_pred:0.025201695039868355, decouple_loss:0.013236281462013721
Iteration: 1167, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4578196108341217
The generated pressure mean: 0.4605579376220703
loss_pred:0.02575552649796009, decouple_loss:0.015547497197985649
loss_pred:0.025857238098978996, decouple_loss:0.015408983454108238
The generated pressure mean: 0.4551812708377838
loss_pred:0.02645942196249962, decouple_loss:0.015679044649004936
Iteration: 1168, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4429646134376526
The generated pressure mean: 0.4407309591770172
loss_pred:0.02703341841697693, decouple_loss:0.015539131127297878
loss_pred:0.02704574167728424, decouple_loss:0.015637878328561783
The generated pressure mean: 0.43999573588371277
loss_pred:0.025827184319496155, decouple_loss:0.015605558641254902
Iteration: 1169, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43326255679130554The generated pressure mean: 0.437374085187912
loss_pred:0.02726561576128006, decouple_loss:0.014473400078713894
loss_pred:0.025575479492545128, decouple_loss:0.014374603517353535
The generated pressure mean: 0.4365593194961548
loss_pred:0.026872798800468445, decouple_loss:0.014186660759150982
Iteration: 1170, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45423176884651184
loss_pred:0.02619980461895466, decouple_loss:0.014242964796721935
The generated pressure mean: 0.4547857344150543
loss_pred:0.0272419061511755, decouple_loss:0.01382055040448904
The generated pressure mean: 0.4544414281845093
loss_pred:0.0265802014619112, decouple_loss:0.0138707235455513
2023-04-16 16:40:54 testing...
The generated pressure mean: 0.4164184033870697
The generated pressure mean: 0.4235321879386902
loss_pred:0.036923475563526154, decouple_loss:0.013908888213336468
The generated pressure mean: 0.4261748194694519
loss_pred:0.03582289069890976, decouple_loss:0.014247647486627102
loss_pred:0.035108331590890884, decouple_loss:0.01441129669547081
WV_0_PC_0_EH_1_PS_40, loss: 0.03666102886199951, avg_mse: 0.04750937968492508
current test mse: 0.047509
Iteration: 1171, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45621445775032043
loss_pred:0.026938702911138535, decouple_loss:0.013760039582848549
The generated pressure mean: 0.45267453789711
loss_pred:0.026888998225331306, decouple_loss:0.013402324169874191
The generated pressure mean: 0.4533441364765167
loss_pred:0.025341186672449112, decouple_loss:0.013285210356116295
Iteration: 1172, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43949761986732483
loss_pred:0.02654174156486988, decouple_loss:0.013320534490048885
The generated pressure mean: 0.4414154887199402
loss_pred:0.024888304993510246, decouple_loss:0.013414991088211536
The generated pressure mean: 0.43982812762260437
loss_pred:0.026944372802972794, decouple_loss:0.013190616853535175
Iteration: 1173, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4536948502063751
The generated pressure mean: 0.45528271794319153
loss_pred:0.02474132552742958, decouple_loss:0.01311404723674059
loss_pred:0.027326246723532677, decouple_loss:0.013032326474785805
The generated pressure mean: 0.4508541524410248
loss_pred:0.026429884135723114, decouple_loss:0.013109798543155193
Iteration: 1174, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43677717447280884
loss_pred:0.026469409465789795, decouple_loss:0.012900280766189098
The generated pressure mean: 0.4414755702018738
loss_pred:0.02589222975075245, decouple_loss:0.01288473978638649
The generated pressure mean: 0.44128039479255676
loss_pred:0.02490704134106636, decouple_loss:0.012743858620524406
Iteration: 1175, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44628408551216125
loss_pred:0.02766440063714981, decouple_loss:0.013475874438881874
The generated pressure mean: 0.45225852727890015
loss_pred:0.02572030946612358, decouple_loss:0.013480239547789097
The generated pressure mean: 0.44833752512931824
loss_pred:0.02683654986321926, decouple_loss:0.013500696048140526
Iteration: 1176, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44908714294433594
loss_pred:0.026833154261112213, decouple_loss:0.014672644436359406
The generated pressure mean: 0.4453371465206146
loss_pred:0.025293627753853798, decouple_loss:0.014400096610188484
The generated pressure mean: 0.4489748775959015
loss_pred:0.024824358522892, decouple_loss:0.01402395498007536
Iteration: 1177, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4447040259838104The generated pressure mean: 0.4484826326370239
loss_pred:0.027016902342438698, decouple_loss:0.014645848423242569loss_pred:0.02549397200345993, decouple_loss:0.0143095338717103
The generated pressure mean: 0.4473894536495209
loss_pred:0.026587635278701782, decouple_loss:0.014345315285027027
Iteration: 1178, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45140933990478516
loss_pred:0.02598802000284195, decouple_loss:0.012887774035334587
The generated pressure mean: 0.45400866866111755
loss_pred:0.025211604312062263, decouple_loss:0.012975761666893959
The generated pressure mean: 0.44813600182533264
loss_pred:0.026401573792099953, decouple_loss:0.01257945317775011
Iteration: 1179, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4533786475658417
loss_pred:0.025493193417787552, decouple_loss:0.012915854342281818
The generated pressure mean: 0.44965019822120667
loss_pred:0.02821856178343296, decouple_loss:0.013208688236773014
The generated pressure mean: 0.44685009121894836
loss_pred:0.0288842786103487, decouple_loss:0.012899784371256828
Iteration: 1180, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42829808592796326
loss_pred:0.025155043229460716, decouple_loss:0.014399140141904354
The generated pressure mean: 0.43050679564476013
loss_pred:0.025805290788412094, decouple_loss:0.014766235835850239
The generated pressure mean: 0.42727765440940857
loss_pred:0.02670074813067913, decouple_loss:0.014560633338987827
2023-04-16 16:42:48 testing...
The generated pressure mean: 0.4155511260032654
The generated pressure mean: 0.4221314489841461
The generated pressure mean: 0.4244438111782074
loss_pred:0.03637010231614113, decouple_loss:0.014195959083735943
loss_pred:0.035634253174066544, decouple_loss:0.014471208676695824
loss_pred:0.034894928336143494, decouple_loss:0.014583421871066093
WV_0_PC_0_EH_1_PS_40, loss: 0.0363539382815361, avg_mse: 0.04695773869752884
current test mse: 0.046958
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 1181, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4586103856563568
loss_pred:0.027822809293866158, decouple_loss:0.013839399442076683
The generated pressure mean: 0.4536759853363037
loss_pred:0.02541225031018257, decouple_loss:0.013723487965762615
The generated pressure mean: 0.4551604092121124
loss_pred:0.025381330400705338, decouple_loss:0.01348665077239275
Iteration: 1182, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4582784175872803
The generated pressure mean: 0.4630565941333771
loss_pred:0.026784289628267288, decouple_loss:0.013155234046280384
loss_pred:0.02689685858786106, decouple_loss:0.012725631706416607
The generated pressure mean: 0.4586249887943268
loss_pred:0.02682042494416237, decouple_loss:0.012476453557610512
Iteration: 1183, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4359053671360016
loss_pred:0.027040652930736542, decouple_loss:0.013086173683404922
The generated pressure mean: 0.4422643482685089
loss_pred:0.02641010284423828, decouple_loss:0.012858386151492596
The generated pressure mean: 0.43970516324043274
loss_pred:0.026432480663061142, decouple_loss:0.012829596176743507
Iteration: 1184, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4425531327724457
loss_pred:0.02572869136929512, decouple_loss:0.012296579778194427
The generated pressure mean: 0.4355163276195526
loss_pred:0.029610319063067436, decouple_loss:0.012520723976194859
The generated pressure mean: 0.4361885190010071
loss_pred:0.027086617425084114, decouple_loss:0.01248020026832819
Iteration: 1185, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45138710737228394
loss_pred:0.027320807799696922, decouple_loss:0.013203608803451061
The generated pressure mean: 0.45134982466697693
loss_pred:0.027050184085965157, decouple_loss:0.013314830139279366
The generated pressure mean: 0.4521537721157074
loss_pred:0.026526153087615967, decouple_loss:0.013085253536701202
Iteration: 1186, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4555308222770691
The generated pressure mean: 0.447843462228775loss_pred:0.026583360508084297, decouple_loss:0.013920499943196774
loss_pred:0.026535281911492348, decouple_loss:0.013519852422177792
The generated pressure mean: 0.45564618706703186
loss_pred:0.02712504006922245, decouple_loss:0.013542428612709045
Iteration: 1187, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44904616475105286
The generated pressure mean: 0.4479554295539856
loss_pred:0.026554707437753677, decouple_loss:0.014236231334507465
loss_pred:0.027208540588617325, decouple_loss:0.013845735229551792
The generated pressure mean: 0.4436209797859192
loss_pred:0.028077637776732445, decouple_loss:0.01403777115046978
Iteration: 1188, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43976178765296936
loss_pred:0.02699507772922516, decouple_loss:0.015595522709190845
The generated pressure mean: 0.4386524558067322
loss_pred:0.027124792337417603, decouple_loss:0.01541939564049244
The generated pressure mean: 0.44082391262054443
loss_pred:0.025899037718772888, decouple_loss:0.014831481501460075
Iteration: 1189, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4555373191833496The generated pressure mean: 0.4533819556236267
loss_pred:0.02777783013880253, decouple_loss:0.014432449825108051
loss_pred:0.02659575268626213, decouple_loss:0.014080307446420193
The generated pressure mean: 0.4533459544181824
loss_pred:0.026422271504998207, decouple_loss:0.014179777354001999
Iteration: 1190, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44265395402908325
loss_pred:0.026313453912734985, decouple_loss:0.014512645080685616
The generated pressure mean: 0.44066473841667175
loss_pred:0.026714026927947998, decouple_loss:0.01397651806473732
The generated pressure mean: 0.44811105728149414
loss_pred:0.028442272916436195, decouple_loss:0.014233473688364029
2023-04-16 16:45:18 testing...
The generated pressure mean: 0.4195505380630493
The generated pressure mean: 0.42651501297950745
The generated pressure mean: 0.42884930968284607
loss_pred:0.0366547554731369, decouple_loss:0.014775438234210014
loss_pred:0.035617440938949585, decouple_loss:0.01490746345371008
loss_pred:0.035096459090709686, decouple_loss:0.015031390823423862
WV_0_PC_0_EH_1_PS_40, loss: 0.03653479367494583, avg_mse: 0.04710954800248146
current test mse: 0.04711
Iteration: 1191, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4510886073112488
loss_pred:0.027521949261426926, decouple_loss:0.014460966922342777
The generated pressure mean: 0.4495607316493988
loss_pred:0.026129040867090225, decouple_loss:0.014600139111280441
The generated pressure mean: 0.4451320767402649
loss_pred:0.02806514874100685, decouple_loss:0.014240373857319355
Iteration: 1192, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45121267437934875
loss_pred:0.0255019161850214, decouple_loss:0.014286346733570099
The generated pressure mean: 0.44768479466438293
loss_pred:0.02568947896361351, decouple_loss:0.014201559126377106
The generated pressure mean: 0.4544771611690521
loss_pred:0.026437584310770035, decouple_loss:0.013922195881605148
Iteration: 1193, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464280605316162
loss_pred:0.024815132841467857, decouple_loss:0.015227256342768669
The generated pressure mean: 0.4456387162208557
loss_pred:0.025512605905532837, decouple_loss:0.01494287233799696
The generated pressure mean: 0.44944170117378235
loss_pred:0.02698897011578083, decouple_loss:0.015308083966374397
Iteration: 1194, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4400734007358551
loss_pred:0.027002451941370964, decouple_loss:0.014003428630530834
The generated pressure mean: 0.43641090393066406
loss_pred:0.026886137202382088, decouple_loss:0.014061913825571537
The generated pressure mean: 0.4463418126106262
loss_pred:0.02708284743130207, decouple_loss:0.01421753317117691
Iteration: 1195, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4510499835014343
loss_pred:0.026260415092110634, decouple_loss:0.015045098029077053
The generated pressure mean: 0.44955942034721375
loss_pred:0.026998132467269897, decouple_loss:0.014803127385675907
The generated pressure mean: 0.4517481029033661
loss_pred:0.026135558262467384, decouple_loss:0.014970408752560616
Iteration: 1196, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4441626965999603
loss_pred:0.026433609426021576, decouple_loss:0.01447176281362772
The generated pressure mean: 0.4475235044956207
loss_pred:0.025974802672863007, decouple_loss:0.014602205716073513
The generated pressure mean: 0.4473484456539154
loss_pred:0.027692312374711037, decouple_loss:0.014830012805759907
Iteration: 1197, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4414902329444885
loss_pred:0.0283792857080698, decouple_loss:0.014963344670832157
The generated pressure mean: 0.4453711211681366
loss_pred:0.025167476385831833, decouple_loss:0.014669980853796005
The generated pressure mean: 0.4401988387107849
loss_pred:0.024562044069170952, decouple_loss:0.0149214006960392
Iteration: 1198, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4525488615036011
The generated pressure mean: 0.4498886168003082
loss_pred:0.02813689596951008, decouple_loss:0.013895764946937561
loss_pred:0.025754764676094055, decouple_loss:0.013742626644670963
The generated pressure mean: 0.4423615634441376
loss_pred:0.027060117572546005, decouple_loss:0.013953441753983498
Iteration: 1199, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4571012556552887
The generated pressure mean: 0.45619845390319824
loss_pred:0.027781739830970764, decouple_loss:0.014322588220238686
loss_pred:0.02663380652666092, decouple_loss:0.014123461209237576
The generated pressure mean: 0.4560530483722687
loss_pred:0.027588030323386192, decouple_loss:0.0138657595962286
Iteration: 1200, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4268999993801117
The generated pressure mean: 0.42895621061325073
loss_pred:0.026998549699783325, decouple_loss:0.014842905104160309
loss_pred:0.026276230812072754, decouple_loss:0.014952651225030422
The generated pressure mean: 0.4245833456516266
loss_pred:0.026713041588664055, decouple_loss:0.014711392112076283
2023-04-16 16:47:11 testing...
The generated pressure mean: 0.41515323519706726
The generated pressure mean: 0.42141056060791016
The generated pressure mean: 0.42374590039253235
loss_pred:0.036432914435863495, decouple_loss:0.014471841044723988
loss_pred:0.03573157265782356, decouple_loss:0.014767392538487911
loss_pred:0.03494871035218239, decouple_loss:0.014888922683894634
WV_0_PC_0_EH_1_PS_40, loss: 0.03643986955285072, avg_mse: 0.047144703567028046
current test mse: 0.047145
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 1201, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45874032378196716
loss_pred:0.025043008849024773, decouple_loss:0.014040838927030563
The generated pressure mean: 0.45589277148246765
loss_pred:0.02629452385008335, decouple_loss:0.014103378169238567
The generated pressure mean: 0.46079787611961365
loss_pred:0.025907183066010475, decouple_loss:0.014040758833289146
Iteration: 1202, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45831984281539917
The generated pressure mean: 0.46407511830329895
loss_pred:0.025922847911715508, decouple_loss:0.014417744241654873
loss_pred:0.025612670928239822, decouple_loss:0.014119211584329605
The generated pressure mean: 0.46633628010749817
loss_pred:0.026204435154795647, decouple_loss:0.014431118965148926
Iteration: 1203, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4354466497898102
loss_pred:0.02569771185517311, decouple_loss:0.014303433708846569
The generated pressure mean: 0.4342042803764343
loss_pred:0.025881916284561157, decouple_loss:0.014164932072162628
The generated pressure mean: 0.43934366106987
loss_pred:0.02574920281767845, decouple_loss:0.013885095715522766
Iteration: 1204, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4383496344089508
The generated pressure mean: 0.43572890758514404
loss_pred:0.026528455317020416, decouple_loss:0.013726172037422657
loss_pred:0.02717953734099865, decouple_loss:0.01379565428942442
The generated pressure mean: 0.43841850757598877
loss_pred:0.02618495747447014, decouple_loss:0.01367662288248539
Iteration: 1205, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.458421915769577
loss_pred:0.025191517546772957, decouple_loss:0.014129748567938805
The generated pressure mean: 0.4579387605190277
loss_pred:0.02786330319941044, decouple_loss:0.01419222354888916
The generated pressure mean: 0.45880356431007385
loss_pred:0.02562856487929821, decouple_loss:0.014286819845438004
Iteration: 1206, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461379945278168
The generated pressure mean: 0.44606199860572815
loss_pred:0.02546021342277527, decouple_loss:0.013482136651873589
loss_pred:0.027114976197481155, decouple_loss:0.013445413671433926
The generated pressure mean: 0.44703155755996704
loss_pred:0.02689710073173046, decouple_loss:0.013390939682722092
Iteration: 1207, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43469879031181335
loss_pred:0.026883739978075027, decouple_loss:0.014127969741821289
The generated pressure mean: 0.43614885210990906
loss_pred:0.025920210406184196, decouple_loss:0.013973559252917767
The generated pressure mean: 0.4398496448993683
loss_pred:0.025407597422599792, decouple_loss:0.014134565368294716
Iteration: 1208, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45772626996040344
loss_pred:0.025319820269942284, decouple_loss:0.013462814502418041
The generated pressure mean: 0.4531957805156708
loss_pred:0.024828054010868073, decouple_loss:0.013440035283565521
The generated pressure mean: 0.4533293545246124
loss_pred:0.02558039501309395, decouple_loss:0.013353503309190273
Iteration: 1209, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45889952778816223
The generated pressure mean: 0.45708703994750977
loss_pred:0.027003902941942215, decouple_loss:0.01400832086801529
loss_pred:0.0276089608669281, decouple_loss:0.013814009726047516
The generated pressure mean: 0.45504024624824524
loss_pred:0.026290440931916237, decouple_loss:0.014040328562259674
Iteration: 1210, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42520371079444885
loss_pred:0.02697039023041725, decouple_loss:0.01368022058159113
The generated pressure mean: 0.4251997172832489
loss_pred:0.026327820494771004, decouple_loss:0.01342965941876173
The generated pressure mean: 0.4286883771419525
loss_pred:0.02702820859849453, decouple_loss:0.013556732796132565
2023-04-16 16:49:42 testing...
The generated pressure mean: 0.41662245988845825
The generated pressure mean: 0.42357680201530457
The generated pressure mean: 0.42638587951660156
loss_pred:0.03707720711827278, decouple_loss:0.013473199680447578
loss_pred:0.036033663898706436, decouple_loss:0.013642830774188042
loss_pred:0.03527385741472244, decouple_loss:0.013844270259141922
WV_0_PC_0_EH_1_PS_40, loss: 0.03681091591715813, avg_mse: 0.04813288524746895
current test mse: 0.048133
Iteration: 1211, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45250651240348816
loss_pred:0.026816293597221375, decouple_loss:0.013055721297860146
The generated pressure mean: 0.4506819546222687
loss_pred:0.025630654767155647, decouple_loss:0.013155313208699226
The generated pressure mean: 0.45319363474845886
loss_pred:0.02514738403260708, decouple_loss:0.013288835063576698
Iteration: 1212, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.460843026638031
loss_pred:0.02545998990535736, decouple_loss:0.01287151500582695
The generated pressure mean: 0.47133028507232666
loss_pred:0.02498806267976761, decouple_loss:0.013013399206101894
The generated pressure mean: 0.46213415265083313
loss_pred:0.026071183383464813, decouple_loss:0.013115908019244671
Iteration: 1213, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44919154047966003
loss_pred:0.025553086772561073, decouple_loss:0.01267867349088192
The generated pressure mean: 0.4477267861366272
loss_pred:0.025823870673775673, decouple_loss:0.012460487894713879
The generated pressure mean: 0.4434698820114136
loss_pred:0.024767152965068817, decouple_loss:0.012462482787668705
Iteration: 1214, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43352147936820984
loss_pred:0.025352701544761658, decouple_loss:0.01353311538696289
The generated pressure mean: 0.4347497820854187
loss_pred:0.025476230308413506, decouple_loss:0.013635353185236454
The generated pressure mean: 0.4339156150817871
loss_pred:0.026924267411231995, decouple_loss:0.013601197861135006
Iteration: 1215, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4428950846195221
loss_pred:0.024694934487342834, decouple_loss:0.014629323966801167
The generated pressure mean: 0.4428033232688904
loss_pred:0.02574900910258293, decouple_loss:0.014622238464653492
The generated pressure mean: 0.45256632566452026
loss_pred:0.02689039148390293, decouple_loss:0.014861233532428741
Iteration: 1216, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4643004536628723
loss_pred:0.024965662509202957, decouple_loss:0.014755326323211193
The generated pressure mean: 0.4619041085243225
loss_pred:0.027586597949266434, decouple_loss:0.014787613414227962
The generated pressure mean: 0.46313801407814026
loss_pred:0.02653883397579193, decouple_loss:0.014784273691475391
Iteration: 1217, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44820985198020935
loss_pred:0.02501346729695797, decouple_loss:0.013640997000038624
The generated pressure mean: 0.4437415897846222
loss_pred:0.025851832702755928, decouple_loss:0.01403056737035513
The generated pressure mean: 0.4447932541370392
loss_pred:0.025889432057738304, decouple_loss:0.013991707935929298
Iteration: 1218, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43489617109298706
loss_pred:0.02606911212205887, decouple_loss:0.013196424581110477
The generated pressure mean: 0.43368062376976013
loss_pred:0.026969151571393013, decouple_loss:0.013200294226408005
The generated pressure mean: 0.4304082989692688
loss_pred:0.025811554864048958, decouple_loss:0.013212544843554497
Iteration: 1219, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45268428325653076
The generated pressure mean: 0.4514537453651428
loss_pred:0.026252398267388344, decouple_loss:0.016487006098031998
loss_pred:0.026448257267475128, decouple_loss:0.016272440552711487
The generated pressure mean: 0.4542447328567505
loss_pred:0.025913570076227188, decouple_loss:0.016021868214011192
Iteration: 1220, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45592471957206726
loss_pred:0.026294756680727005, decouple_loss:0.015344494953751564
The generated pressure mean: 0.4673476219177246
loss_pred:0.025243377313017845, decouple_loss:0.015323597937822342
The generated pressure mean: 0.4587140679359436
loss_pred:0.026022763922810555, decouple_loss:0.015316472388803959
2023-04-16 16:51:36 testing...
The generated pressure mean: 0.4190184772014618
The generated pressure mean: 0.4256238639354706
The generated pressure mean: 0.42791712284088135
loss_pred:0.036114007234573364, decouple_loss:0.014399979263544083
loss_pred:0.035195861011743546, decouple_loss:0.01467428170144558
loss_pred:0.03450357913970947, decouple_loss:0.014784712344408035
WV_0_PC_0_EH_1_PS_40, loss: 0.036002133041620255, avg_mse: 0.046439845114946365
current test mse: 0.04644
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 1221, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4405364394187927
loss_pred:0.02661765180528164, decouple_loss:0.013658056035637856
The generated pressure mean: 0.4429720342159271
loss_pred:0.024965746328234673, decouple_loss:0.014191457070410252
The generated pressure mean: 0.43929800391197205
loss_pred:0.026629246771335602, decouple_loss:0.013799617066979408
Iteration: 1222, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44092363119125366
The generated pressure mean: 0.44016820192337036
loss_pred:0.02722991816699505, decouple_loss:0.01456539984792471
loss_pred:0.024675393477082253, decouple_loss:0.014399059116840363
The generated pressure mean: 0.44269540905952454
loss_pred:0.025566404685378075, decouple_loss:0.014314442873001099
Iteration: 1223, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475491940975189
The generated pressure mean: 0.4484662413597107
loss_pred:0.025927124544978142, decouple_loss:0.015114404261112213
loss_pred:0.025471875444054604, decouple_loss:0.015014373697340488
The generated pressure mean: 0.45071351528167725
loss_pred:0.02568756230175495, decouple_loss:0.015421324409544468
Iteration: 1224, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4613852798938751
The generated pressure mean: 0.45824751257896423
loss_pred:0.02624114602804184, decouple_loss:0.0149002680554986
loss_pred:0.026514321565628052, decouple_loss:0.014896770007908344
The generated pressure mean: 0.4588386118412018
loss_pred:0.026557112112641335, decouple_loss:0.014894874766469002
Iteration: 1225, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43194085359573364
loss_pred:0.027676302939653397, decouple_loss:0.013414917513728142
The generated pressure mean: 0.42994844913482666
loss_pred:0.02509881742298603, decouple_loss:0.013284403830766678
The generated pressure mean: 0.43045204877853394
loss_pred:0.027619998902082443, decouple_loss:0.013344673439860344
Iteration: 1226, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45038869976997375
The generated pressure mean: 0.45457419753074646loss_pred:0.025240011513233185, decouple_loss:0.014186588115990162
loss_pred:0.02706815116107464, decouple_loss:0.014739012345671654
The generated pressure mean: 0.45024651288986206
loss_pred:0.025810416787862778, decouple_loss:0.014346817508339882
Iteration: 1227, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4588310420513153
The generated pressure mean: 0.4616565406322479
loss_pred:0.024875598028302193, decouple_loss:0.014967987313866615
loss_pred:0.02647443301975727, decouple_loss:0.015067901462316513
The generated pressure mean: 0.45860645174980164
loss_pred:0.025544224306941032, decouple_loss:0.014634562656283379
Iteration: 1228, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4430503249168396
The generated pressure mean: 0.4513184428215027loss_pred:0.025361385196447372, decouple_loss:0.01431131549179554
loss_pred:0.02611563727259636, decouple_loss:0.014258255250751972
The generated pressure mean: 0.44817525148391724
loss_pred:0.02432897314429283, decouple_loss:0.014171537943184376
Iteration: 1229, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43153974413871765
loss_pred:0.025502962991595268, decouple_loss:0.014096055179834366
The generated pressure mean: 0.4323406517505646
loss_pred:0.02537744864821434, decouple_loss:0.013720639050006866
The generated pressure mean: 0.44021859765052795
loss_pred:0.025197073817253113, decouple_loss:0.013667906634509563
Iteration: 1230, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44335728883743286
loss_pred:0.025437936186790466, decouple_loss:0.012873897328972816
The generated pressure mean: 0.4507119953632355
The generated pressure mean: 0.45042943954467773
loss_pred:0.026218174025416374, decouple_loss:0.013002435676753521
loss_pred:0.023738281801342964, decouple_loss:0.012858778238296509
2023-04-16 16:54:05 testing...
The generated pressure mean: 0.4162661135196686
The generated pressure mean: 0.4240321218967438
The generated pressure mean: 0.4267711043357849
loss_pred:0.039025235921144485, decouple_loss:0.014180055819451809
loss_pred:0.03794481232762337, decouple_loss:0.014520335011184216
loss_pred:0.037227023392915726, decouple_loss:0.014678135514259338
WV_0_PC_0_EH_1_PS_40, loss: 0.03878866881132126, avg_mse: 0.052179474383592606
current test mse: 0.052179
Iteration: 1231, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4581420123577118
loss_pred:0.024852998554706573, decouple_loss:0.013357694260776043
The generated pressure mean: 0.45304983854293823
loss_pred:0.02607690542936325, decouple_loss:0.01342708058655262
The generated pressure mean: 0.45796528458595276
loss_pred:0.025478018447756767, decouple_loss:0.01337885670363903
Iteration: 1232, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4389050602912903
loss_pred:0.02683127112686634, decouple_loss:0.012811792083084583
The generated pressure mean: 0.43956685066223145
loss_pred:0.027209486812353134, decouple_loss:0.012688771821558475
The generated pressure mean: 0.4417521357536316
loss_pred:0.02535199746489525, decouple_loss:0.012761292979121208
Iteration: 1233, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44755759835243225
loss_pred:0.02496309019625187, decouple_loss:0.013536377809941769
The generated pressure mean: 0.4443376958370209
loss_pred:0.02563515678048134, decouple_loss:0.013731230981647968
The generated pressure mean: 0.44639694690704346
loss_pred:0.02490435354411602, decouple_loss:0.013497831299901009
Iteration: 1234, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492410123348236
loss_pred:0.026622403413057327, decouple_loss:0.013453147374093533
The generated pressure mean: 0.4543524384498596
loss_pred:0.02636096440255642, decouple_loss:0.012963809072971344
The generated pressure mean: 0.45500457286834717
loss_pred:0.025775523856282234, decouple_loss:0.013377029448747635
Iteration: 1235, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44820085167884827
loss_pred:0.024431750178337097, decouple_loss:0.013078862801194191
The generated pressure mean: 0.4451616704463959
loss_pred:0.02522069588303566, decouple_loss:0.013039433397352695
The generated pressure mean: 0.4447488784790039
loss_pred:0.025538694113492966, decouple_loss:0.01293958444148302
Iteration: 1236, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495421350002289
loss_pred:0.026759635657072067, decouple_loss:0.013068371452391148
The generated pressure mean: 0.4449264109134674
loss_pred:0.02542487345635891, decouple_loss:0.013073239475488663
The generated pressure mean: 0.44329172372817993
loss_pred:0.02562113292515278, decouple_loss:0.013006014749407768
Iteration: 1237, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45362967252731323
loss_pred:0.025396112352609634, decouple_loss:0.013164273463189602
The generated pressure mean: 0.4520323574542999
loss_pred:0.02628430165350437, decouple_loss:0.013073446229100227
The generated pressure mean: 0.4552445411682129
loss_pred:0.025512970983982086, decouple_loss:0.013067074120044708
Iteration: 1238, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442489743232727
loss_pred:0.024715065956115723, decouple_loss:0.013053969480097294
The generated pressure mean: 0.43972986936569214
loss_pred:0.025893937796354294, decouple_loss:0.012998743914067745
The generated pressure mean: 0.44765979051589966
loss_pred:0.02595650404691696, decouple_loss:0.012947706505656242
Iteration: 1239, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44611409306526184
loss_pred:0.025789104402065277, decouple_loss:0.012463927268981934
The generated pressure mean: 0.4417560398578644
loss_pred:0.025850003585219383, decouple_loss:0.012310197576880455
The generated pressure mean: 0.44846591353416443
loss_pred:0.024850331246852875, decouple_loss:0.01267830841243267
Iteration: 1240, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44464346766471863
loss_pred:0.02538643218576908, decouple_loss:0.01267250720411539
The generated pressure mean: 0.4510035514831543
loss_pred:0.02563927322626114, decouple_loss:0.012600908055901527
The generated pressure mean: 0.4405880868434906
loss_pred:0.02718745917081833, decouple_loss:0.012601100839674473
2023-04-16 16:55:59 testing...
The generated pressure mean: 0.4176653325557709
The generated pressure mean: 0.42493829131126404
The generated pressure mean: 0.42741256952285767
loss_pred:0.03576252982020378, decouple_loss:0.012638243846595287
loss_pred:0.034757670015096664, decouple_loss:0.013056040741503239
loss_pred:0.0341130830347538, decouple_loss:0.013156847096979618
WV_0_PC_0_EH_1_PS_40, loss: 0.035525280982255936, avg_mse: 0.04611445590853691
current test mse: 0.046114
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 1241, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4433927834033966
loss_pred:0.026541562750935555, decouple_loss:0.012303683906793594
The generated pressure mean: 0.44645047187805176
loss_pred:0.02780776657164097, decouple_loss:0.01225331798195839
The generated pressure mean: 0.44963961839675903
loss_pred:0.02720664069056511, decouple_loss:0.01219900045543909
Iteration: 1242, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4514760375022888
The generated pressure mean: 0.4534343481063843
loss_pred:0.028221117332577705, decouple_loss:0.012613151222467422
loss_pred:0.02571956254541874, decouple_loss:0.012417711317539215
The generated pressure mean: 0.45772984623908997
loss_pred:0.025656627491116524, decouple_loss:0.012603175826370716
Iteration: 1243, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507848024368286
loss_pred:0.02586432918906212, decouple_loss:0.014522291719913483
The generated pressure mean: 0.4463600218296051
loss_pred:0.027947846800088882, decouple_loss:0.014435989782214165
The generated pressure mean: 0.4481900632381439
loss_pred:0.026979101821780205, decouple_loss:0.014554839581251144
Iteration: 1244, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45135003328323364
The generated pressure mean: 0.44862446188926697
loss_pred:0.026376033201813698, decouple_loss:0.014480073936283588
loss_pred:0.02715105563402176, decouple_loss:0.014720703475177288
The generated pressure mean: 0.45006898045539856
loss_pred:0.0274166502058506, decouple_loss:0.014581210911273956
Iteration: 1245, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44316309690475464
loss_pred:0.02764926478266716, decouple_loss:0.01423976942896843
The generated pressure mean: 0.4407682418823242
loss_pred:0.026893015950918198, decouple_loss:0.01464875042438507
The generated pressure mean: 0.4411300718784332
loss_pred:0.026261083781719208, decouple_loss:0.014403905719518661
Iteration: 1246, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45348820090293884
loss_pred:0.025617379695177078, decouple_loss:0.013180641457438469
The generated pressure mean: 0.45125603675842285
loss_pred:0.025207722559571266, decouple_loss:0.01306952629238367
The generated pressure mean: 0.4509139657020569
loss_pred:0.0249922052025795, decouple_loss:0.013233978301286697
Iteration: 1247, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45187699794769287
loss_pred:0.02625350095331669, decouple_loss:0.01222048420459032
The generated pressure mean: 0.44793203473091125
The generated pressure mean: 0.45303136110305786
loss_pred:0.027110593393445015, decouple_loss:0.012348628602921963
loss_pred:0.028060639277100563, decouple_loss:0.012586045078933239
Iteration: 1248, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487597942352295
loss_pred:0.026523301377892494, decouple_loss:0.013203666545450687
The generated pressure mean: 0.4450922906398773
loss_pred:0.025900593027472496, decouple_loss:0.01275493111461401
The generated pressure mean: 0.44633129239082336
loss_pred:0.02712370827794075, decouple_loss:0.013188737444579601
Iteration: 1249, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477807581424713The generated pressure mean: 0.44962790608406067
loss_pred:0.02845476195216179, decouple_loss:0.014501566998660564
loss_pred:0.026928899809718132, decouple_loss:0.014541314914822578
The generated pressure mean: 0.4487748444080353
loss_pred:0.0279068760573864, decouple_loss:0.014495833776891232
Iteration: 1250, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44331932067871094
The generated pressure mean: 0.4425255060195923
loss_pred:0.025718960911035538, decouple_loss:0.014388535171747208
loss_pred:0.027160465717315674, decouple_loss:0.014288902282714844
The generated pressure mean: 0.44466227293014526
loss_pred:0.025894129648804665, decouple_loss:0.014079644344747066
2023-04-16 16:58:30 testing...
The generated pressure mean: 0.41535091400146484
The generated pressure mean: 0.4222599267959595
The generated pressure mean: 0.4245794117450714
loss_pred:0.03685397282242775, decouple_loss:0.014107962138950825
loss_pred:0.035684701055288315, decouple_loss:0.014485317282378674
loss_pred:0.034808896481990814, decouple_loss:0.014604419469833374
WV_0_PC_0_EH_1_PS_40, loss: 0.03650248795747757, avg_mse: 0.04777127131819725
current test mse: 0.047771
Iteration: 1251, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45512446761131287
loss_pred:0.02727453038096428, decouple_loss:0.013439120724797249
The generated pressure mean: 0.4548613429069519
loss_pred:0.025905542075634003, decouple_loss:0.013428173027932644
The generated pressure mean: 0.4561856985092163
loss_pred:0.02699735388159752, decouple_loss:0.013327017426490784
Iteration: 1252, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497023820877075
loss_pred:0.027070898562669754, decouple_loss:0.012337038293480873
The generated pressure mean: 0.44996142387390137
loss_pred:0.02594226598739624, decouple_loss:0.012440178543329239
The generated pressure mean: 0.4478631317615509
loss_pred:0.02578135021030903, decouple_loss:0.011910228058695793
Iteration: 1253, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4425429403781891
loss_pred:0.026482461020350456, decouple_loss:0.012550891377031803
The generated pressure mean: 0.44802483916282654
loss_pred:0.025481196120381355, decouple_loss:0.012619697488844395
The generated pressure mean: 0.4430376887321472
loss_pred:0.025205044075846672, decouple_loss:0.012424120679497719
Iteration: 1254, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45062386989593506
loss_pred:0.02703646942973137, decouple_loss:0.013356124982237816
The generated pressure mean: 0.45402634143829346
loss_pred:0.02754852920770645, decouple_loss:0.013426747173070908
The generated pressure mean: 0.4532213509082794
loss_pred:0.02759396657347679, decouple_loss:0.013238273561000824
Iteration: 1255, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44079533219337463
The generated pressure mean: 0.43958762288093567
loss_pred:0.027597682550549507, decouple_loss:0.013982356525957584
loss_pred:0.026564933359622955, decouple_loss:0.014262584038078785
The generated pressure mean: 0.4422970116138458
loss_pred:0.026783844456076622, decouple_loss:0.014252166263759136
Iteration: 1256, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44602999091148376
loss_pred:0.025952894240617752, decouple_loss:0.01348264142870903
The generated pressure mean: 0.443971186876297
loss_pred:0.027556052431464195, decouple_loss:0.013538924045860767
The generated pressure mean: 0.4426822364330292
loss_pred:0.026740698143839836, decouple_loss:0.013532113283872604
Iteration: 1257, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46031710505485535
loss_pred:0.02508336491882801, decouple_loss:0.013451885432004929
The generated pressure mean: 0.46058619022369385
loss_pred:0.02578936330974102, decouple_loss:0.013432075269520283
The generated pressure mean: 0.4630797505378723
loss_pred:0.027626046910881996, decouple_loss:0.013516644015908241
Iteration: 1258, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4546484351158142
loss_pred:0.028286661952733994, decouple_loss:0.012401686981320381
The generated pressure mean: 0.45188987255096436
loss_pred:0.026339324191212654, decouple_loss:0.012293227016925812
The generated pressure mean: 0.4548776149749756
loss_pred:0.026680726557970047, decouple_loss:0.012533859349787235
Iteration: 1259, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4359377920627594
loss_pred:0.026984062045812607, decouple_loss:0.013278235681355
The generated pressure mean: 0.441397488117218
loss_pred:0.027570344507694244, decouple_loss:0.013552681542932987
The generated pressure mean: 0.4370958209037781
loss_pred:0.02778088115155697, decouple_loss:0.013096126727759838
Iteration: 1260, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449901282787323
loss_pred:0.02653314918279648, decouple_loss:0.0147993303835392
The generated pressure mean: 0.4503459632396698
loss_pred:0.027241811156272888, decouple_loss:0.014894356019794941
The generated pressure mean: 0.447603702545166
loss_pred:0.02624928578734398, decouple_loss:0.014899086207151413
2023-04-16 17:00:24 testing...
The generated pressure mean: 0.4244963526725769
The generated pressure mean: 0.4171253740787506
The generated pressure mean: 0.426870197057724
loss_pred:0.034880369901657104, decouple_loss:0.01516291406005621
loss_pred:0.03615520894527435, decouple_loss:0.015021602623164654
loss_pred:0.034147489815950394, decouple_loss:0.015253330580890179
WV_0_PC_0_EH_1_PS_40, loss: 0.03581831976771355, avg_mse: 0.04679996892809868
current test mse: 0.0468
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 1261, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4446655213832855
loss_pred:0.02666778303682804, decouple_loss:0.01435477752238512
The generated pressure mean: 0.4453337788581848
loss_pred:0.0271922554820776, decouple_loss:0.014439531601965427
The generated pressure mean: 0.44760310649871826
loss_pred:0.025879427790641785, decouple_loss:0.014666089788079262
Iteration: 1262, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476267993450165
loss_pred:0.025235291570425034, decouple_loss:0.012688837945461273
The generated pressure mean: 0.44479402899742126
loss_pred:0.026194952428340912, decouple_loss:0.012684601359069347
The generated pressure mean: 0.4519478380680084
loss_pred:0.025773443281650543, decouple_loss:0.012621007859706879
Iteration: 1263, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45592156052589417
The generated pressure mean: 0.4558183252811432loss_pred:0.02688654325902462, decouple_loss:0.013777380809187889
loss_pred:0.027925241738557816, decouple_loss:0.013478406704962254
The generated pressure mean: 0.45149192214012146
loss_pred:0.026009991765022278, decouple_loss:0.013432299718260765
Iteration: 1264, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490816295146942
The generated pressure mean: 0.449428528547287
loss_pred:0.026356397196650505, decouple_loss:0.014573252759873867
loss_pred:0.025464171543717384, decouple_loss:0.014707776717841625
The generated pressure mean: 0.44915103912353516
loss_pred:0.02557563968002796, decouple_loss:0.014487055130302906
Iteration: 1265, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473821520805359
The generated pressure mean: 0.45010221004486084
loss_pred:0.025245288386940956, decouple_loss:0.013356905430555344
loss_pred:0.02647346630692482, decouple_loss:0.013299109414219856
The generated pressure mean: 0.4484143555164337
loss_pred:0.02576187439262867, decouple_loss:0.013090179301798344
Iteration: 1266, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45039045810699463
The generated pressure mean: 0.4439932405948639
loss_pred:0.026048433035612106, decouple_loss:0.012625078670680523
loss_pred:0.0255401823669672, decouple_loss:0.012408184818923473
The generated pressure mean: 0.450212299823761
loss_pred:0.026012161746621132, decouple_loss:0.012455891817808151
Iteration: 1267, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44526469707489014The generated pressure mean: 0.4477660655975342
loss_pred:0.025978872552514076, decouple_loss:0.013504361733794212
loss_pred:0.02616899646818638, decouple_loss:0.013726811856031418
The generated pressure mean: 0.4479354918003082
loss_pred:0.02567603625357151, decouple_loss:0.014025026001036167
Iteration: 1268, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44226837158203125
loss_pred:0.026965821161866188, decouple_loss:0.012553255073726177
The generated pressure mean: 0.4447360336780548
The generated pressure mean: 0.4473698139190674
loss_pred:0.026082562282681465, decouple_loss:0.01242875773459673
loss_pred:0.026722023263573647, decouple_loss:0.012637946754693985
Iteration: 1269, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4436332583427429
The generated pressure mean: 0.4504985511302948
loss_pred:0.025678465142846107, decouple_loss:0.012279885821044445
loss_pred:0.025103336200118065, decouple_loss:0.012090940959751606
The generated pressure mean: 0.45146268606185913
loss_pred:0.02684357948601246, decouple_loss:0.012242643162608147
Iteration: 1270, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4577401876449585
loss_pred:0.026667414233088493, decouple_loss:0.012370801530778408
The generated pressure mean: 0.4520091414451599
loss_pred:0.024699395522475243, decouple_loss:0.012171666137874126
The generated pressure mean: 0.45713570713996887
loss_pred:0.026715004816651344, decouple_loss:0.012050622142851353
2023-04-16 17:02:55 testing...
The generated pressure mean: 0.4187864363193512
The generated pressure mean: 0.42560967803001404
The generated pressure mean: 0.4283137023448944
loss_pred:0.03523287922143936, decouple_loss:0.013064214959740639
loss_pred:0.03415694460272789, decouple_loss:0.013352450914680958
loss_pred:0.033316150307655334, decouple_loss:0.013490593060851097
WV_0_PC_0_EH_1_PS_40, loss: 0.034900449216365814, avg_mse: 0.04507015272974968
current test mse: 0.04507
Iteration: 1271, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472235441207886
The generated pressure mean: 0.4483931064605713
loss_pred:0.025344261899590492, decouple_loss:0.012253215536475182
loss_pred:0.027369577437639236, decouple_loss:0.01233529020100832
The generated pressure mean: 0.4468463659286499
loss_pred:0.02585151232779026, decouple_loss:0.012524797581136227
Iteration: 1272, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465183615684509
The generated pressure mean: 0.4428631663322449
loss_pred:0.026199644431471825, decouple_loss:0.013836739584803581
loss_pred:0.025099359452724457, decouple_loss:0.013957628980278969
The generated pressure mean: 0.4425348937511444
loss_pred:0.02626192942261696, decouple_loss:0.01406227145344019
Iteration: 1273, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490608274936676
The generated pressure mean: 0.45577874779701233
loss_pred:0.025977816432714462, decouple_loss:0.01386224664747715
loss_pred:0.025640780106186867, decouple_loss:0.014057399705052376
The generated pressure mean: 0.4528801441192627
loss_pred:0.02662050537765026, decouple_loss:0.014011935330927372
Iteration: 1274, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507269561290741
loss_pred:0.025553010404109955, decouple_loss:0.013921886682510376
The generated pressure mean: 0.4441310167312622
loss_pred:0.02620887942612171, decouple_loss:0.013861838728189468
The generated pressure mean: 0.44939085841178894
loss_pred:0.02544449269771576, decouple_loss:0.014036653563380241
Iteration: 1275, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44785773754119873
The generated pressure mean: 0.44904831051826477
loss_pred:0.02580087073147297, decouple_loss:0.01362721435725689
loss_pred:0.02643115445971489, decouple_loss:0.013368895277380943
The generated pressure mean: 0.44881683588027954
loss_pred:0.02749754674732685, decouple_loss:0.013483364135026932
Iteration: 1276, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45179566740989685
loss_pred:0.024624759331345558, decouple_loss:0.012829579412937164
The generated pressure mean: 0.46076127886772156
loss_pred:0.026356466114521027, decouple_loss:0.01273061241954565
The generated pressure mean: 0.45845669507980347
loss_pred:0.025855282321572304, decouple_loss:0.012391294352710247
Iteration: 1277, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44908374547958374
loss_pred:0.02503119595348835, decouple_loss:0.014155030250549316
The generated pressure mean: 0.44285327196121216
loss_pred:0.026090532541275024, decouple_loss:0.014046809636056423
The generated pressure mean: 0.4491644501686096
loss_pred:0.02599611133337021, decouple_loss:0.014004691503942013
Iteration: 1278, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43504956364631653
loss_pred:0.024634910747408867, decouple_loss:0.012980668805539608
The generated pressure mean: 0.44395115971565247
loss_pred:0.025180421769618988, decouple_loss:0.012933512218296528
The generated pressure mean: 0.4441268742084503
loss_pred:0.027124106884002686, decouple_loss:0.013090858235955238
Iteration: 1279, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4558867812156677
loss_pred:0.02647138200700283, decouple_loss:0.012426436878740788
The generated pressure mean: 0.4494156539440155
loss_pred:0.025688214227557182, decouple_loss:0.012503813952207565
The generated pressure mean: 0.4568403661251068
loss_pred:0.02619026042521, decouple_loss:0.012471611611545086
Iteration: 1280, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45349574089050293
loss_pred:0.026275837793946266, decouple_loss:0.01451826561242342
The generated pressure mean: 0.4499998390674591
loss_pred:0.02521098405122757, decouple_loss:0.01455011498183012
The generated pressure mean: 0.4432287812232971
loss_pred:0.02550283633172512, decouple_loss:0.014548520557582378
2023-04-16 17:04:48 testing...
The generated pressure mean: 0.4187849760055542
The generated pressure mean: 0.4258998930454254
The generated pressure mean: 0.42868587374687195
loss_pred:0.03592362999916077, decouple_loss:0.013421697542071342
loss_pred:0.03479062020778656, decouple_loss:0.013705405406653881
loss_pred:0.034277740865945816, decouple_loss:0.013875111006200314
WV_0_PC_0_EH_1_PS_40, loss: 0.035680703818798065, avg_mse: 0.04654069244861603
current test mse: 0.046541
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 1281, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44352149963378906
loss_pred:0.024632152169942856, decouple_loss:0.013330391608178616
The generated pressure mean: 0.44877889752388
loss_pred:0.02477201446890831, decouple_loss:0.01300784107297659
The generated pressure mean: 0.44661444425582886
loss_pred:0.025211015716195107, decouple_loss:0.013228628784418106
Iteration: 1282, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4541550576686859
The generated pressure mean: 0.4510875940322876
loss_pred:0.02625161223113537, decouple_loss:0.014309725724160671
loss_pred:0.026423180475831032, decouple_loss:0.014171216636896133
The generated pressure mean: 0.45347827672958374
loss_pred:0.026037245988845825, decouple_loss:0.014425082132220268
Iteration: 1283, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43984586000442505
The generated pressure mean: 0.4438202679157257
loss_pred:0.026678549125790596, decouple_loss:0.013245980255305767
loss_pred:0.026611119508743286, decouple_loss:0.0131604028865695
The generated pressure mean: 0.4376930892467499
loss_pred:0.026940157637000084, decouple_loss:0.013162901625037193
Iteration: 1284, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44508668780326843
loss_pred:0.025459695607423782, decouple_loss:0.013395549729466438
The generated pressure mean: 0.44263413548469543
loss_pred:0.025737496092915535, decouple_loss:0.01361399982124567
The generated pressure mean: 0.44479647278785706
loss_pred:0.025413384661078453, decouple_loss:0.013183867558836937
Iteration: 1285, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474504292011261The generated pressure mean: 0.451172411441803
loss_pred:0.025805523619055748, decouple_loss:0.0136148352175951loss_pred:0.025468233972787857, decouple_loss:0.013714941218495369
The generated pressure mean: 0.45243039727211
loss_pred:0.02520178258419037, decouple_loss:0.01369395386427641
Iteration: 1286, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4568215012550354
The generated pressure mean: 0.4514957070350647
loss_pred:0.026832569390535355, decouple_loss:0.012715828604996204
loss_pred:0.026767458766698837, decouple_loss:0.012739887461066246
The generated pressure mean: 0.45692718029022217
loss_pred:0.02770223841071129, decouple_loss:0.012934875674545765
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1287, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.436090886592865
loss_pred:0.02600364200770855, decouple_loss:0.01410367339849472
The generated pressure mean: 0.4350508153438568
loss_pred:0.025308437645435333, decouple_loss:0.01429213397204876
The generated pressure mean: 0.43577203154563904
loss_pred:0.025429630652070045, decouple_loss:0.014338325709104538
Iteration: 1288, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508225917816162
loss_pred:0.0264731477946043, decouple_loss:0.014289647340774536
The generated pressure mean: 0.4500025510787964
loss_pred:0.025468619540333748, decouple_loss:0.014221753925085068
The generated pressure mean: 0.4444108009338379
loss_pred:0.02754751220345497, decouple_loss:0.014222327619791031
Iteration: 1289, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492924213409424
The generated pressure mean: 0.45153433084487915
loss_pred:0.02715277299284935, decouple_loss:0.01431975420564413
loss_pred:0.02605898678302765, decouple_loss:0.014394151046872139
The generated pressure mean: 0.45160502195358276
loss_pred:0.02603982947766781, decouple_loss:0.014376749284565449
Iteration: 1290, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4414860010147095
loss_pred:0.02673524245619774, decouple_loss:0.014237153343856335
The generated pressure mean: 0.4439551532268524
loss_pred:0.027698153629899025, decouple_loss:0.014152527786791325
The generated pressure mean: 0.44250574707984924
loss_pred:0.025617698207497597, decouple_loss:0.014305890537798405
2023-04-16 17:07:21 testing...
The generated pressure mean: 0.41624021530151367
The generated pressure mean: 0.42342609167099
loss_pred:0.03601905703544617, decouple_loss:0.01341322809457779
The generated pressure mean: 0.4255605936050415
loss_pred:0.034878991544246674, decouple_loss:0.013758369721472263
loss_pred:0.034276217222213745, decouple_loss:0.013890617527067661
WV_0_PC_0_EH_1_PS_40, loss: 0.03574246168136597, avg_mse: 0.046859920024871826
current test mse: 0.04686
Iteration: 1291, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4547351598739624
loss_pred:0.02490028366446495, decouple_loss:0.012936422601342201
The generated pressure mean: 0.45689108967781067
loss_pred:0.02593260072171688, decouple_loss:0.012785494327545166
The generated pressure mean: 0.4552030861377716
loss_pred:0.025227900594472885, decouple_loss:0.012768055312335491
Iteration: 1292, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447796493768692
loss_pred:0.026648884639143944, decouple_loss:0.012845232151448727
The generated pressure mean: 0.451544851064682
loss_pred:0.026714714244008064, decouple_loss:0.012852432206273079
The generated pressure mean: 0.44625550508499146
loss_pred:0.02533130533993244, decouple_loss:0.012989294715225697
Iteration: 1293, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4377039968967438
loss_pred:0.02613794058561325, decouple_loss:0.012235982343554497
The generated pressure mean: 0.43644434213638306
loss_pred:0.026644498109817505, decouple_loss:0.012238425202667713
The generated pressure mean: 0.4390244781970978
loss_pred:0.025456858798861504, decouple_loss:0.012271944433450699
Iteration: 1294, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45279842615127563
loss_pred:0.024746540933847427, decouple_loss:0.01226118765771389
The generated pressure mean: 0.44957029819488525
loss_pred:0.026238029822707176, decouple_loss:0.012334523722529411
The generated pressure mean: 0.45337438583374023
loss_pred:0.025631245225667953, decouple_loss:0.012325027957558632
Iteration: 1295, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45077767968177795
loss_pred:0.025767741724848747, decouple_loss:0.012525755912065506
The generated pressure mean: 0.4484982490539551
loss_pred:0.026006922125816345, decouple_loss:0.012559616006910801
The generated pressure mean: 0.45170682668685913
loss_pred:0.02531753107905388, decouple_loss:0.012627312913537025
Iteration: 1296, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44189831614494324
loss_pred:0.025608276948332787, decouple_loss:0.012206794694066048
The generated pressure mean: 0.44489091634750366
loss_pred:0.025653617456555367, decouple_loss:0.012211455963551998
The generated pressure mean: 0.4436861574649811
loss_pred:0.02554609626531601, decouple_loss:0.01214082445949316
Iteration: 1297, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44469401240348816
loss_pred:0.02463647350668907, decouple_loss:0.012815647758543491
The generated pressure mean: 0.44608157873153687
loss_pred:0.025945739820599556, decouple_loss:0.012763196602463722
The generated pressure mean: 0.4444271922111511
loss_pred:0.02386944554746151, decouple_loss:0.01286886166781187
Iteration: 1298, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446503609418869
The generated pressure mean: 0.4524777829647064
loss_pred:0.02630172111093998, decouple_loss:0.011858985759317875
loss_pred:0.025284968316555023, decouple_loss:0.012045935727655888
The generated pressure mean: 0.4544996917247772
loss_pred:0.0262361541390419, decouple_loss:0.012042001821100712
Iteration: 1299, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4445785880088806
The generated pressure mean: 0.4446519613265991
loss_pred:0.026242006570100784, decouple_loss:0.012176447547972202
loss_pred:0.025501936674118042, decouple_loss:0.012163412757217884
The generated pressure mean: 0.44543880224227905
loss_pred:0.02364453114569187, decouple_loss:0.012089566327631474
Iteration: 1300, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470583200454712
loss_pred:0.02462035045027733, decouple_loss:0.013346195220947266
The generated pressure mean: 0.44556912779808044The generated pressure mean: 0.4505675137042999
loss_pred:0.025753812864422798, decouple_loss:0.0133370915427804
loss_pred:0.026134837418794632, decouple_loss:0.013182868249714375
2023-04-16 17:09:14 testing...
The generated pressure mean: 0.4222181439399719
The generated pressure mean: 0.4156750440597534
The generated pressure mean: 0.42443302273750305
loss_pred:0.03430481255054474, decouple_loss:0.013796273618936539
loss_pred:0.03548705205321312, decouple_loss:0.0135090546682477
loss_pred:0.03363579884171486, decouple_loss:0.013948644511401653
WV_0_PC_0_EH_1_PS_40, loss: 0.035163454711437225, avg_mse: 0.045641664415597916
current test mse: 0.045642
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 1301, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4561075270175934
loss_pred:0.02693653106689453, decouple_loss:0.01305698323994875
The generated pressure mean: 0.45329371094703674
The generated pressure mean: 0.45391780138015747
loss_pred:0.02523256652057171, decouple_loss:0.013168654404580593
loss_pred:0.026714108884334564, decouple_loss:0.013082599267363548
Iteration: 1302, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44871997833251953
The generated pressure mean: 0.4455689489841461
loss_pred:0.026407139375805855, decouple_loss:0.012992409989237785
loss_pred:0.025760481134057045, decouple_loss:0.013010005466639996
The generated pressure mean: 0.4478827118873596
loss_pred:0.026107756420969963, decouple_loss:0.013042394071817398
Iteration: 1303, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4338805377483368
The generated pressure mean: 0.43981531262397766
loss_pred:0.025914622470736504, decouple_loss:0.013109381310641766
loss_pred:0.026556268334388733, decouple_loss:0.013100712560117245
The generated pressure mean: 0.4392061233520508
loss_pred:0.024076852947473526, decouple_loss:0.013151751831173897
Iteration: 1304, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45757102966308594
The generated pressure mean: 0.4540262222290039
loss_pred:0.025701699778437614, decouple_loss:0.014245339669287205
loss_pred:0.025642909109592438, decouple_loss:0.014240985736250877
The generated pressure mean: 0.45693519711494446
loss_pred:0.02599666826426983, decouple_loss:0.014284415170550346
Iteration: 1305, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491746723651886
loss_pred:0.024386519566178322, decouple_loss:0.013117893598973751
The generated pressure mean: 0.44799861311912537
loss_pred:0.02515455149114132, decouple_loss:0.013064183294773102
The generated pressure mean: 0.4480448067188263
loss_pred:0.025667821988463402, decouple_loss:0.013072692789137363
Iteration: 1306, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4390096366405487
The generated pressure mean: 0.44024142622947693
loss_pred:0.026218241080641747, decouple_loss:0.012916699051856995
loss_pred:0.025747044011950493, decouple_loss:0.012777340598404408
The generated pressure mean: 0.4407239258289337
loss_pred:0.025126056745648384, decouple_loss:0.01268354244530201
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1307, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.456040620803833
loss_pred:0.025821538642048836, decouple_loss:0.01214376837015152
The generated pressure mean: 0.456052303314209
loss_pred:0.026299890130758286, decouple_loss:0.012196390889585018
The generated pressure mean: 0.45545998215675354
loss_pred:0.027045410126447678, decouple_loss:0.012217073701322079
Iteration: 1308, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44457924365997314
The generated pressure mean: 0.4467722773551941
loss_pred:0.026361439377069473, decouple_loss:0.0119097251445055
loss_pred:0.02437727153301239, decouple_loss:0.012174421921372414
The generated pressure mean: 0.44098150730133057
loss_pred:0.025158967822790146, decouple_loss:0.012237154878675938
Iteration: 1309, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4430500268936157
loss_pred:0.02555222250521183, decouple_loss:0.012838279828429222
The generated pressure mean: 0.4421505630016327
loss_pred:0.024372264742851257, decouple_loss:0.012955690734088421
The generated pressure mean: 0.43462759256362915
loss_pred:0.025749096646904945, decouple_loss:0.012885620817542076
Iteration: 1310, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45375314354896545
loss_pred:0.026290996000170708, decouple_loss:0.012880593538284302
The generated pressure mean: 0.45281505584716797
loss_pred:0.02429831586778164, decouple_loss:0.01285656075924635
The generated pressure mean: 0.4539896249771118
loss_pred:0.02495904639363289, decouple_loss:0.012919019907712936
2023-04-16 17:11:46 testing...
The generated pressure mean: 0.41687458753585815
The generated pressure mean: 0.4232596755027771
loss_pred:0.03537842258810997, decouple_loss:0.013528676703572273
The generated pressure mean: 0.4256218373775482
loss_pred:0.034297917038202286, decouple_loss:0.013922272250056267
loss_pred:0.033724281936883926, decouple_loss:0.014034205116331577
WV_0_PC_0_EH_1_PS_40, loss: 0.035158298909664154, avg_mse: 0.04581542685627937
current test mse: 0.045815
Iteration: 1311, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44540292024612427
loss_pred:0.02470366656780243, decouple_loss:0.012660910375416279
The generated pressure mean: 0.4539242684841156
loss_pred:0.02675112709403038, decouple_loss:0.012575596570968628
The generated pressure mean: 0.448665052652359
loss_pred:0.024771373718976974, decouple_loss:0.012585780583322048
Iteration: 1312, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463494122028351
loss_pred:0.02440168522298336, decouple_loss:0.012010504491627216
The generated pressure mean: 0.44517895579338074
loss_pred:0.02539866976439953, decouple_loss:0.012119974009692669
The generated pressure mean: 0.44208425283432007
loss_pred:0.025202659890055656, decouple_loss:0.01215576846152544
Iteration: 1313, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45221418142318726
loss_pred:0.02452075481414795, decouple_loss:0.013031530193984509
The generated pressure mean: 0.4471743702888489
loss_pred:0.02527335099875927, decouple_loss:0.01268560066819191
The generated pressure mean: 0.4503785967826843
loss_pred:0.025745831429958344, decouple_loss:0.01286094356328249
Iteration: 1314, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44712644815444946
loss_pred:0.025282707065343857, decouple_loss:0.014788861386477947
The generated pressure mean: 0.4529998302459717
loss_pred:0.023923274129629135, decouple_loss:0.014960279688239098
The generated pressure mean: 0.45011743903160095
loss_pred:0.025569645687937737, decouple_loss:0.014922167174518108
Iteration: 1315, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45418497920036316
loss_pred:0.025381896644830704, decouple_loss:0.013901332393288612
The generated pressure mean: 0.4450668394565582
loss_pred:0.02433811128139496, decouple_loss:0.014046113938093185
The generated pressure mean: 0.44884517788887024
loss_pred:0.026086091995239258, decouple_loss:0.013915563933551311
Iteration: 1316, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4451577067375183
loss_pred:0.024172399193048477, decouple_loss:0.012270873412489891
The generated pressure mean: 0.44361793994903564
loss_pred:0.024687135592103004, decouple_loss:0.012500165030360222
The generated pressure mean: 0.4462255537509918
loss_pred:0.025521008297801018, decouple_loss:0.012342148460447788
Iteration: 1317, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471399784088135
loss_pred:0.024993037804961205, decouple_loss:0.012426286935806274
The generated pressure mean: 0.4450313150882721
loss_pred:0.026018178090453148, decouple_loss:0.012570536695420742
The generated pressure mean: 0.4388812780380249
loss_pred:0.025370188057422638, decouple_loss:0.012601593509316444
Iteration: 1318, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4545375108718872
loss_pred:0.025245768949389458, decouple_loss:0.01346076000481844
The generated pressure mean: 0.4533325135707855
loss_pred:0.02344346232712269, decouple_loss:0.01369631476700306
The generated pressure mean: 0.4557805359363556
loss_pred:0.026837486773729324, decouple_loss:0.013641471043229103
Iteration: 1319, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466477930545807
loss_pred:0.026346903294324875, decouple_loss:0.014395266771316528
The generated pressure mean: 0.4441264867782593
loss_pred:0.025453003123402596, decouple_loss:0.014384000562131405
The generated pressure mean: 0.44565531611442566
loss_pred:0.02495179884135723, decouple_loss:0.01465438213199377
Iteration: 1320, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473780393600464
loss_pred:0.024634268134832382, decouple_loss:0.01324006263166666
The generated pressure mean: 0.4483829140663147
loss_pred:0.025918254628777504, decouple_loss:0.013279063627123833
The generated pressure mean: 0.44736915826797485
loss_pred:0.025228841230273247, decouple_loss:0.013210108503699303
2023-04-16 17:13:39 testing...
The generated pressure mean: 0.4193068742752075
The generated pressure mean: 0.4264916181564331
The generated pressure mean: 0.42921510338783264
loss_pred:0.035505570471286774, decouple_loss:0.01338660903275013
loss_pred:0.03461434319615364, decouple_loss:0.013776223175227642
loss_pred:0.03402766212821007, decouple_loss:0.013811840675771236
WV_0_PC_0_EH_1_PS_40, loss: 0.03539877012372017, avg_mse: 0.046829722821712494
current test mse: 0.04683
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 1321, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4426860213279724
loss_pred:0.02470586448907852, decouple_loss:0.013190568424761295
The generated pressure mean: 0.44094306230545044
loss_pred:0.025581862777471542, decouple_loss:0.012944233603775501
The generated pressure mean: 0.442516952753067
loss_pred:0.025570828467607498, decouple_loss:0.013082106597721577
Iteration: 1322, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44584500789642334
loss_pred:0.02441934496164322, decouple_loss:0.015168300829827785
The generated pressure mean: 0.45547521114349365
loss_pred:0.027906589210033417, decouple_loss:0.015057087875902653
The generated pressure mean: 0.4462646245956421
loss_pred:0.02536422200500965, decouple_loss:0.014812643639743328
Iteration: 1323, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4385494887828827
loss_pred:0.02895781397819519, decouple_loss:0.013509062118828297
The generated pressure mean: 0.43536296486854553
loss_pred:0.02509661205112934, decouple_loss:0.013881169259548187
The generated pressure mean: 0.43659839034080505
loss_pred:0.026063788682222366, decouple_loss:0.014057490974664688
Iteration: 1324, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4778977334499359
The generated pressure mean: 0.4740566909313202
loss_pred:0.0278437789529562, decouple_loss:0.01766141876578331
loss_pred:0.026681870222091675, decouple_loss:0.018208034336566925
The generated pressure mean: 0.4711178243160248
loss_pred:0.026724860072135925, decouple_loss:0.017810657620429993
Iteration: 1325, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.441290944814682
The generated pressure mean: 0.43900397419929504
loss_pred:0.025995712727308273, decouple_loss:0.014981639571487904
loss_pred:0.026938674971461296, decouple_loss:0.015041040256619453
The generated pressure mean: 0.441942036151886
loss_pred:0.025490034371614456, decouple_loss:0.015371418558061123
Iteration: 1326, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4334343671798706
loss_pred:0.024259423837065697, decouple_loss:0.016300493851304054
The generated pressure mean: 0.43324583768844604
loss_pred:0.024975324049592018, decouple_loss:0.01609613001346588
The generated pressure mean: 0.4345414340496063
loss_pred:0.026745576411485672, decouple_loss:0.01625163108110428
Iteration: 1327, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4639267921447754
The generated pressure mean: 0.45691433548927307
loss_pred:0.026361361145973206, decouple_loss:0.015111060813069344
loss_pred:0.025221487507224083, decouple_loss:0.015338905155658722
The generated pressure mean: 0.4627254605293274
loss_pred:0.024913106113672256, decouple_loss:0.015341885387897491
Iteration: 1328, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45065751671791077
loss_pred:0.024725018069148064, decouple_loss:0.017889104783535004
The generated pressure mean: 0.44182658195495605
loss_pred:0.02593514695763588, decouple_loss:0.017833171412348747
The generated pressure mean: 0.44744008779525757
loss_pred:0.02603599615395069, decouple_loss:0.018179526552557945
Iteration: 1329, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43182551860809326
loss_pred:0.023809917271137238, decouple_loss:0.015563330613076687
The generated pressure mean: 0.4428175091743469
loss_pred:0.02546740509569645, decouple_loss:0.015670806169509888
The generated pressure mean: 0.43968653678894043
loss_pred:0.02755260467529297, decouple_loss:0.01559415739029646
Iteration: 1330, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4609256088733673
The generated pressure mean: 0.4586888551712036
loss_pred:0.02605181187391281, decouple_loss:0.01586456596851349
loss_pred:0.025787826627492905, decouple_loss:0.01589188538491726
The generated pressure mean: 0.46918612718582153
loss_pred:0.026815300807356834, decouple_loss:0.01617138832807541
2023-04-16 17:16:11 testing...
The generated pressure mean: 0.41607874631881714
The generated pressure mean: 0.4226827323436737
loss_pred:0.03657681867480278, decouple_loss:0.017227832227945328
The generated pressure mean: 0.4254433810710907
loss_pred:0.035435840487480164, decouple_loss:0.017351249232888222
loss_pred:0.03487715125083923, decouple_loss:0.017431553453207016
WV_0_PC_0_EH_1_PS_40, loss: 0.036496780812740326, avg_mse: 0.047978002578020096
current test mse: 0.047978
Iteration: 1331, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4527287483215332
loss_pred:0.02540452964603901, decouple_loss:0.017052115872502327
The generated pressure mean: 0.45338523387908936
loss_pred:0.026318997144699097, decouple_loss:0.01681804098188877
The generated pressure mean: 0.45995214581489563
loss_pred:0.02639956772327423, decouple_loss:0.0170255396515131
Iteration: 1332, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4294561445713043
loss_pred:0.024832969531416893, decouple_loss:0.014489167369902134
The generated pressure mean: 0.425405353307724
loss_pred:0.02499016746878624, decouple_loss:0.014760950580239296
The generated pressure mean: 0.42775243520736694
loss_pred:0.02536262758076191, decouple_loss:0.014401497319340706
Iteration: 1333, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45047447085380554
loss_pred:0.02525600790977478, decouple_loss:0.015573023818433285
The generated pressure mean: 0.4507330656051636
loss_pred:0.025756996124982834, decouple_loss:0.015787040814757347
The generated pressure mean: 0.45589888095855713
loss_pred:0.026897110044956207, decouple_loss:0.016004623845219612
Iteration: 1334, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44759947061538696
loss_pred:0.022757938131690025, decouple_loss:0.01411069929599762
The generated pressure mean: 0.44932305812835693
loss_pred:0.02622172236442566, decouple_loss:0.014070894569158554
The generated pressure mean: 0.4459306299686432
loss_pred:0.02390456385910511, decouple_loss:0.014021579176187515
Iteration: 1335, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.444882333278656
loss_pred:0.0254076961427927, decouple_loss:0.015274901874363422
The generated pressure mean: 0.4448561668395996
loss_pred:0.025884920731186867, decouple_loss:0.015052427537739277
The generated pressure mean: 0.4479016661643982
loss_pred:0.024380913004279137, decouple_loss:0.014984185807406902
Iteration: 1336, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45174652338027954
loss_pred:0.024618614464998245, decouple_loss:0.01438216958194971
The generated pressure mean: 0.45741981267929077
The generated pressure mean: 0.45454496145248413
loss_pred:0.023619825020432472, decouple_loss:0.014389965683221817
loss_pred:0.02606636844575405, decouple_loss:0.01417603250592947
Iteration: 1337, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44966039061546326
loss_pred:0.02451508305966854, decouple_loss:0.013582497835159302
The generated pressure mean: 0.45018067955970764
loss_pred:0.025786638259887695, decouple_loss:0.01352720521390438
The generated pressure mean: 0.45204484462738037
loss_pred:0.02661736123263836, decouple_loss:0.013501848094165325
Iteration: 1338, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470207095146179
loss_pred:0.026131199672818184, decouple_loss:0.014012612402439117
The generated pressure mean: 0.44472190737724304
loss_pred:0.025701699778437614, decouple_loss:0.014183305203914642
The generated pressure mean: 0.4406014084815979
loss_pred:0.025708859786391258, decouple_loss:0.014019747264683247
Iteration: 1339, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4368738532066345
loss_pred:0.02550888992846012, decouple_loss:0.014500187709927559
The generated pressure mean: 0.43822842836380005
loss_pred:0.024934273213148117, decouple_loss:0.014811579138040543
The generated pressure mean: 0.4334909915924072
loss_pred:0.025576530024409294, decouple_loss:0.014446575194597244
Iteration: 1340, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45922380685806274
loss_pred:0.025052590295672417, decouple_loss:0.014101387932896614
The generated pressure mean: 0.4599038362503052
loss_pred:0.026511652395129204, decouple_loss:0.014239259995520115
The generated pressure mean: 0.44937863945961
loss_pred:0.02526133321225643, decouple_loss:0.014045056886970997
2023-04-16 17:18:04 testing...
The generated pressure mean: 0.41807523369789124
The generated pressure mean: 0.424919456243515
The generated pressure mean: 0.42784515023231506
loss_pred:0.03542878106236458, decouple_loss:0.014155336655676365
loss_pred:0.03419561684131622, decouple_loss:0.014323422685265541
loss_pred:0.03339533135294914, decouple_loss:0.014466132037341595
WV_0_PC_0_EH_1_PS_40, loss: 0.03505565971136093, avg_mse: 0.04581255465745926
current test mse: 0.045813
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 1341, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44511255621910095
loss_pred:0.027312152087688446, decouple_loss:0.013537047430872917
The generated pressure mean: 0.4486963152885437
loss_pred:0.026558920741081238, decouple_loss:0.013448968529701233
The generated pressure mean: 0.44210776686668396
loss_pred:0.025859253481030464, decouple_loss:0.0135719683021307
Iteration: 1342, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4453308880329132
The generated pressure mean: 0.44531601667404175
loss_pred:0.02546372264623642, decouple_loss:0.013032044284045696
loss_pred:0.02560337819159031, decouple_loss:0.013150948099792004
The generated pressure mean: 0.4432463049888611
loss_pred:0.025333724915981293, decouple_loss:0.01312972605228424
Iteration: 1343, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4544520974159241
loss_pred:0.025148887187242508, decouple_loss:0.01262379065155983
The generated pressure mean: 0.4523584544658661
loss_pred:0.024131136015057564, decouple_loss:0.012608940713107586
The generated pressure mean: 0.45224153995513916
loss_pred:0.024968642741441727, decouple_loss:0.012552083469927311
Iteration: 1344, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469968378543854
The generated pressure mean: 0.4477910101413727
loss_pred:0.026734570041298866, decouple_loss:0.012764763087034225
loss_pred:0.02572765201330185, decouple_loss:0.01282572839409113
The generated pressure mean: 0.4486598074436188
loss_pred:0.024336321279406548, decouple_loss:0.012782849371433258
Iteration: 1345, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4450623095035553
loss_pred:0.02464684471487999, decouple_loss:0.013271080330014229
The generated pressure mean: 0.4420727491378784
loss_pred:0.024146392941474915, decouple_loss:0.013345211744308472
The generated pressure mean: 0.4421463906764984
loss_pred:0.027595477178692818, decouple_loss:0.01328648068010807
Iteration: 1346, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4399406611919403
The generated pressure mean: 0.4457544684410095
loss_pred:0.026173753663897514, decouple_loss:0.013085727579891682
loss_pred:0.0244598388671875, decouple_loss:0.013047045096755028
The generated pressure mean: 0.4492202699184418
loss_pred:0.023168319836258888, decouple_loss:0.012968678958714008
Iteration: 1347, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461190402507782
The generated pressure mean: 0.4549131691455841
loss_pred:0.025881662964820862, decouple_loss:0.013819742016494274
loss_pred:0.024676233530044556, decouple_loss:0.013838077895343304
The generated pressure mean: 0.4463992416858673
loss_pred:0.02491896040737629, decouple_loss:0.01335855945944786
Iteration: 1348, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44343966245651245
loss_pred:0.02377878688275814, decouple_loss:0.012636518105864525
The generated pressure mean: 0.4483479857444763
loss_pred:0.026883117854595184, decouple_loss:0.012731336988508701
The generated pressure mean: 0.4439373314380646
loss_pred:0.02472604624927044, decouple_loss:0.012974010780453682
Iteration: 1349, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495539665222168
loss_pred:0.02487282082438469, decouple_loss:0.011933131143450737
The generated pressure mean: 0.4477267265319824
loss_pred:0.024641111493110657, decouple_loss:0.01196463406085968
The generated pressure mean: 0.44970622658729553
loss_pred:0.02651084028184414, decouple_loss:0.011833466589450836
Iteration: 1350, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4437996447086334
loss_pred:0.025903750211000443, decouple_loss:0.011959204450249672
The generated pressure mean: 0.44590169191360474
loss_pred:0.02646215446293354, decouple_loss:0.011658300645649433
The generated pressure mean: 0.4458366334438324
loss_pred:0.02491648495197296, decouple_loss:0.011608816683292389
2023-04-16 17:20:34 testing...
The generated pressure mean: 0.41801008582115173
The generated pressure mean: 0.4247532784938812
The generated pressure mean: 0.4272409975528717
loss_pred:0.03536471351981163, decouple_loss:0.012433558702468872
loss_pred:0.03448227047920227, decouple_loss:0.01276661828160286
loss_pred:0.03373435512185097, decouple_loss:0.012989168055355549
WV_0_PC_0_EH_1_PS_40, loss: 0.035163603723049164, avg_mse: 0.04623357951641083
current test mse: 0.046234
Iteration: 1351, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44728630781173706
loss_pred:0.023439813405275345, decouple_loss:0.011867843568325043
The generated pressure mean: 0.4494757056236267
loss_pred:0.0248903576284647, decouple_loss:0.011729291640222073
The generated pressure mean: 0.4528902471065521
loss_pred:0.025145867839455605, decouple_loss:0.012052563950419426
Iteration: 1352, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45341694355010986
loss_pred:0.025668345391750336, decouple_loss:0.013514198362827301
The generated pressure mean: 0.45453086495399475
loss_pred:0.026180652901530266, decouple_loss:0.013541004620492458
The generated pressure mean: 0.44870519638061523
loss_pred:0.024097654968500137, decouple_loss:0.01319302897900343
Iteration: 1353, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4417979419231415
loss_pred:0.025005575269460678, decouple_loss:0.015206826850771904
The generated pressure mean: 0.4416891634464264
loss_pred:0.023524435237050056, decouple_loss:0.015246350318193436
The generated pressure mean: 0.44027167558670044
loss_pred:0.02559213526546955, decouple_loss:0.01498899981379509
Iteration: 1354, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44627538323402405
loss_pred:0.024339651688933372, decouple_loss:0.013541502878069878
The generated pressure mean: 0.44639888405799866
loss_pred:0.0260758176445961, decouple_loss:0.013881543651223183
The generated pressure mean: 0.4488995671272278
loss_pred:0.025112515315413475, decouple_loss:0.01352754794061184
Iteration: 1355, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45136338472366333
loss_pred:0.026927370578050613, decouple_loss:0.01190109271556139
The generated pressure mean: 0.4531272351741791
loss_pred:0.02502233348786831, decouple_loss:0.011887487955391407
The generated pressure mean: 0.4495081901550293
loss_pred:0.024375464767217636, decouple_loss:0.011732669547200203
Iteration: 1356, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452365040779114
The generated pressure mean: 0.4480678141117096
loss_pred:0.024257540702819824, decouple_loss:0.012322833761572838
loss_pred:0.024929184466600418, decouple_loss:0.012320178560912609
The generated pressure mean: 0.4477759897708893
loss_pred:0.02501942403614521, decouple_loss:0.012346201576292515
Iteration: 1357, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4444555342197418
The generated pressure mean: 0.44262900948524475
loss_pred:0.024584483355283737, decouple_loss:0.014266639947891235
loss_pred:0.02487465925514698, decouple_loss:0.014433185569941998
The generated pressure mean: 0.4415864944458008
loss_pred:0.023703085258603096, decouple_loss:0.014546421356499195
Iteration: 1358, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45239314436912537
loss_pred:0.025650791823863983, decouple_loss:0.013972255401313305
The generated pressure mean: 0.4520067572593689
loss_pred:0.02560868114233017, decouple_loss:0.013902425765991211
The generated pressure mean: 0.4457237720489502
loss_pred:0.02451033890247345, decouple_loss:0.013898477889597416
Iteration: 1359, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44819003343582153
loss_pred:0.024592213332653046, decouple_loss:0.012474591843783855
The generated pressure mean: 0.4443587064743042
loss_pred:0.023641344159841537, decouple_loss:0.012414364144206047
The generated pressure mean: 0.44827938079833984
loss_pred:0.025014739483594894, decouple_loss:0.01244958397001028
Iteration: 1360, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479285478591919
The generated pressure mean: 0.4421161115169525
loss_pred:0.026436181738972664, decouple_loss:0.01255125179886818
loss_pred:0.023977575823664665, decouple_loss:0.012446586042642593
The generated pressure mean: 0.44487640261650085
loss_pred:0.025497587397694588, decouple_loss:0.012245106510818005
2023-04-16 17:22:27 testing...
The generated pressure mean: 0.41847628355026245
The generated pressure mean: 0.42499518394470215
loss_pred:0.03511838614940643, decouple_loss:0.015278592705726624
The generated pressure mean: 0.42770618200302124
loss_pred:0.0341445654630661, decouple_loss:0.01551209855824709
loss_pred:0.03342929854989052, decouple_loss:0.0157491285353899
WV_0_PC_0_EH_1_PS_40, loss: 0.03500641509890556, avg_mse: 0.04578615725040436
current test mse: 0.045786
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 1361, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45059123635292053
loss_pred:0.025651440024375916, decouple_loss:0.015204885974526405
The generated pressure mean: 0.4492485225200653
The generated pressure mean: 0.44823914766311646
loss_pred:0.02547554299235344, decouple_loss:0.0151572460308671
loss_pred:0.02564394474029541, decouple_loss:0.01513303816318512
Iteration: 1362, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498808979988098
loss_pred:0.02535484917461872, decouple_loss:0.013125484809279442
The generated pressure mean: 0.4514677822589874
loss_pred:0.025348922237753868, decouple_loss:0.012729011476039886
The generated pressure mean: 0.4487113654613495
loss_pred:0.02445949986577034, decouple_loss:0.01301233097910881
Iteration: 1363, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4431920051574707
The generated pressure mean: 0.44453081488609314
loss_pred:0.025158269330859184, decouple_loss:0.013074268586933613
loss_pred:0.02512478642165661, decouple_loss:0.012961981818079948
The generated pressure mean: 0.4430851638317108
loss_pred:0.025029167532920837, decouple_loss:0.01319700013846159
Iteration: 1364, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4440184235572815
loss_pred:0.02557007223367691, decouple_loss:0.01466552447527647
The generated pressure mean: 0.4426136314868927
loss_pred:0.026049457490444183, decouple_loss:0.014695494435727596
The generated pressure mean: 0.442707359790802
loss_pred:0.02538592554628849, decouple_loss:0.014781900681555271
Iteration: 1365, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505336582660675
The generated pressure mean: 0.4510546624660492
loss_pred:0.024924807250499725, decouple_loss:0.013581925071775913
loss_pred:0.025308163836598396, decouple_loss:0.013512518256902695
The generated pressure mean: 0.44461590051651
loss_pred:0.02420257404446602, decouple_loss:0.013389701955020428
Iteration: 1366, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45120733976364136
The generated pressure mean: 0.4538806676864624
loss_pred:0.02482699602842331, decouple_loss:0.012965754605829716
loss_pred:0.02491038292646408, decouple_loss:0.012597141787409782
The generated pressure mean: 0.4510987401008606
loss_pred:0.02605322189629078, decouple_loss:0.012877711094915867
Iteration: 1367, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4456953704357147
loss_pred:0.026276256889104843, decouple_loss:0.012624593451619148
The generated pressure mean: 0.4523772895336151
loss_pred:0.02456763945519924, decouple_loss:0.012564986012876034
The generated pressure mean: 0.44513270258903503
loss_pred:0.025001415982842445, decouple_loss:0.012549330480396748
Iteration: 1368, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4410231411457062
loss_pred:0.02449716441333294, decouple_loss:0.012696893885731697
The generated pressure mean: 0.4413931667804718
loss_pred:0.024811655282974243, decouple_loss:0.012558046728372574
The generated pressure mean: 0.4398210644721985
loss_pred:0.026285413652658463, decouple_loss:0.012562546879053116
Iteration: 1369, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4523339569568634
loss_pred:0.025786666199564934, decouple_loss:0.012535489164292812The generated pressure mean: 0.4565257132053375
loss_pred:0.02459573931992054, decouple_loss:0.012893341481685638
The generated pressure mean: 0.4518878161907196
loss_pred:0.024900441989302635, decouple_loss:0.012805487960577011
Iteration: 1370, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452977478504181
loss_pred:0.025008225813508034, decouple_loss:0.012285848148167133
The generated pressure mean: 0.4424608647823334
The generated pressure mean: 0.44715163111686707
loss_pred:0.02483210526406765, decouple_loss:0.012373946607112885
loss_pred:0.025794118642807007, decouple_loss:0.012528511695563793
2023-04-16 17:24:58 testing...
The generated pressure mean: 0.4194691777229309
The generated pressure mean: 0.4261063039302826
The generated pressure mean: 0.4285038113594055
loss_pred:0.03460400179028511, decouple_loss:0.013228986412286758
loss_pred:0.03354598954319954, decouple_loss:0.01360656414180994
loss_pred:0.03314581513404846, decouple_loss:0.013724724762141705
WV_0_PC_0_EH_1_PS_40, loss: 0.0344412736594677, avg_mse: 0.044907428324222565
current test mse: 0.044907
Iteration: 1371, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479624032974243
loss_pred:0.02481207065284252, decouple_loss:0.012423096224665642
The generated pressure mean: 0.43681493401527405
loss_pred:0.024581730365753174, decouple_loss:0.012300433591008186
The generated pressure mean: 0.4432736337184906
loss_pred:0.024087952449917793, decouple_loss:0.012292529456317425
Iteration: 1372, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45169901847839355
loss_pred:0.024775516241788864, decouple_loss:0.013425055891275406
The generated pressure mean: 0.45325541496276855
loss_pred:0.02534535340964794, decouple_loss:0.013217400759458542
The generated pressure mean: 0.45394328236579895
loss_pred:0.024594871327280998, decouple_loss:0.013264218345284462
Iteration: 1373, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4451822340488434
loss_pred:0.02503027580678463, decouple_loss:0.013442104682326317
The generated pressure mean: 0.4424815773963928
loss_pred:0.024748094379901886, decouple_loss:0.013687574304640293
The generated pressure mean: 0.44169533252716064
loss_pred:0.0248422771692276, decouple_loss:0.013283224776387215
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1374, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482325315475464
loss_pred:0.02573835849761963, decouple_loss:0.013935175724327564
The generated pressure mean: 0.44905126094818115
loss_pred:0.025409596040844917, decouple_loss:0.014078497886657715
The generated pressure mean: 0.44787847995758057
loss_pred:0.02475637011229992, decouple_loss:0.014176096767187119
Iteration: 1375, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4379856288433075
loss_pred:0.02539321780204773, decouple_loss:0.012821166776120663
The generated pressure mean: 0.4410409927368164
loss_pred:0.0250331349670887, decouple_loss:0.012674841098487377
The generated pressure mean: 0.4382745027542114
loss_pred:0.024700025096535683, decouple_loss:0.0128873810172081
Iteration: 1376, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46134957671165466
loss_pred:0.024647977203130722, decouple_loss:0.011924022808670998
The generated pressure mean: 0.4599835276603699
loss_pred:0.02436736784875393, decouple_loss:0.011975526809692383
The generated pressure mean: 0.45761123299598694
loss_pred:0.025007231160998344, decouple_loss:0.01209197100251913
Iteration: 1377, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44637802243232727
loss_pred:0.02702808752655983, decouple_loss:0.0115251699462533
The generated pressure mean: 0.44041240215301514
loss_pred:0.02564040757715702, decouple_loss:0.011767965741455555
The generated pressure mean: 0.4433380961418152
loss_pred:0.025960056111216545, decouple_loss:0.01177269034087658
Iteration: 1378, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44016164541244507
loss_pred:0.024380100890994072, decouple_loss:0.012513436377048492
The generated pressure mean: 0.44081369042396545
loss_pred:0.02550102025270462, decouple_loss:0.012861712835729122
The generated pressure mean: 0.43534043431282043
loss_pred:0.027241546660661697, decouple_loss:0.012676426209509373
Iteration: 1379, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4568837583065033
loss_pred:0.024488721042871475, decouple_loss:0.011714044958353043
The generated pressure mean: 0.4646124541759491
loss_pred:0.024679696187376976, decouple_loss:0.011631188914179802
The generated pressure mean: 0.46255844831466675
loss_pred:0.027326276525855064, decouple_loss:0.011694131419062614
Iteration: 1380, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43779411911964417
loss_pred:0.025844022631645203, decouple_loss:0.011797996237874031
The generated pressure mean: 0.4405522346496582
loss_pred:0.024960486218333244, decouple_loss:0.011916416697204113
The generated pressure mean: 0.4389992356300354
loss_pred:0.02526668645441532, decouple_loss:0.011841787956655025
2023-04-16 17:26:52 testing...
The generated pressure mean: 0.4191383421421051
The generated pressure mean: 0.4261351525783539
The generated pressure mean: 0.4286605417728424
loss_pred:0.03517792373895645, decouple_loss:0.012780064716935158
loss_pred:0.033992085605859756, decouple_loss:0.013115322217345238
loss_pred:0.033842265605926514, decouple_loss:0.01334329042583704
WV_0_PC_0_EH_1_PS_40, loss: 0.03499140590429306, avg_mse: 0.04609057307243347
current test mse: 0.046091
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 1381, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466544985771179
loss_pred:0.02551097422838211, decouple_loss:0.012476288713514805
The generated pressure mean: 0.4438368082046509
loss_pred:0.028502561151981354, decouple_loss:0.012381787411868572
The generated pressure mean: 0.44526228308677673
loss_pred:0.02564917877316475, decouple_loss:0.012411045841872692
Iteration: 1382, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4547324478626251
The generated pressure mean: 0.45233410596847534
loss_pred:0.024030476808547974, decouple_loss:0.012813265435397625
loss_pred:0.025190602988004684, decouple_loss:0.01280140969902277
The generated pressure mean: 0.455500990152359
loss_pred:0.02545183151960373, decouple_loss:0.012812604196369648
Iteration: 1383, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447632759809494
loss_pred:0.02447272650897503, decouple_loss:0.011680142022669315
The generated pressure mean: 0.44968029856681824
loss_pred:0.026206430047750473, decouple_loss:0.011822217144072056
The generated pressure mean: 0.4478485584259033
loss_pred:0.025393621996045113, decouple_loss:0.011619078926742077
Iteration: 1384, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4400567412376404
The generated pressure mean: 0.43344616889953613
loss_pred:0.026127347722649574, decouple_loss:0.012546992860734463
loss_pred:0.02591370977461338, decouple_loss:0.012352053076028824
The generated pressure mean: 0.43603116273880005
loss_pred:0.025157058611512184, decouple_loss:0.01255638338625431
Iteration: 1385, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45378580689430237
The generated pressure mean: 0.45512130856513977
loss_pred:0.025873122736811638, decouple_loss:0.012122008949518204
loss_pred:0.026284176856279373, decouple_loss:0.0116083063185215
The generated pressure mean: 0.45352810621261597
loss_pred:0.02456020563840866, decouple_loss:0.01176680251955986
Iteration: 1386, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45280981063842773
The generated pressure mean: 0.4517759680747986
loss_pred:0.025722727179527283, decouple_loss:0.012945015914738178
loss_pred:0.024541474878787994, decouple_loss:0.013249300420284271
The generated pressure mean: 0.45066991448402405
loss_pred:0.02611605077981949, decouple_loss:0.01301014143973589
Iteration: 1387, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4347565472126007
The generated pressure mean: 0.4376797378063202
loss_pred:0.02515520714223385, decouple_loss:0.012626421637833118
loss_pred:0.02566157467663288, decouple_loss:0.0126091493293643
The generated pressure mean: 0.438181072473526
loss_pred:0.024900075048208237, decouple_loss:0.012564676813781261
Iteration: 1388, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470301568508148
loss_pred:0.0265971552580595, decouple_loss:0.011373910121619701
The generated pressure mean: 0.4482683837413788
The generated pressure mean: 0.4435034692287445
loss_pred:0.02678748592734337, decouple_loss:0.011141705326735973
loss_pred:0.026164529845118523, decouple_loss:0.011429774574935436
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1389, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45103323459625244
loss_pred:0.02647075615823269, decouple_loss:0.011966239660978317
The generated pressure mean: 0.4550800621509552
loss_pred:0.026308560743927956, decouple_loss:0.012248453684151173
The generated pressure mean: 0.4563485085964203
loss_pred:0.02567662112414837, decouple_loss:0.01218511164188385
Iteration: 1390, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44967085123062134
loss_pred:0.024185210466384888, decouple_loss:0.012464446015655994
The generated pressure mean: 0.4479290843009949
loss_pred:0.026286879554390907, decouple_loss:0.012223436497151852
The generated pressure mean: 0.44650596380233765
loss_pred:0.025336047634482384, decouple_loss:0.012252680025994778
2023-04-16 17:29:20 testing...
The generated pressure mean: 0.4202723801136017
The generated pressure mean: 0.4269925653934479
loss_pred:0.03427622467279434, decouple_loss:0.012469837442040443
The generated pressure mean: 0.4295150935649872
loss_pred:0.033393535763025284, decouple_loss:0.012882697395980358
loss_pred:0.03285335749387741, decouple_loss:0.013007409870624542
WV_0_PC_0_EH_1_PS_40, loss: 0.03414703905582428, avg_mse: 0.044612765312194824
current test mse: 0.044613
Iteration: 1391, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4388993978500366
loss_pred:0.02528342232108116, decouple_loss:0.011885089799761772
The generated pressure mean: 0.443469762802124
loss_pred:0.026302441954612732, decouple_loss:0.011908384971320629
The generated pressure mean: 0.4358276128768921
loss_pred:0.02667452022433281, decouple_loss:0.011935182847082615
Iteration: 1392, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507731795310974
loss_pred:0.024630868807435036, decouple_loss:0.011359854601323605
The generated pressure mean: 0.44968053698539734
loss_pred:0.024944551289081573, decouple_loss:0.0114184794947505
The generated pressure mean: 0.44830378890037537
loss_pred:0.02518538385629654, decouple_loss:0.011285306885838509
Iteration: 1393, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45161768794059753
The generated pressure mean: 0.44667941331863403loss_pred:0.029117710888385773, decouple_loss:0.013134190812706947
loss_pred:0.025080621242523193, decouple_loss:0.01301157008856535
The generated pressure mean: 0.4484008550643921
loss_pred:0.025882339105010033, decouple_loss:0.01287156157195568
Iteration: 1394, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4229900538921356
loss_pred:0.02585112676024437, decouple_loss:0.013926937244832516
The generated pressure mean: 0.42276903986930847
loss_pred:0.026218559592962265, decouple_loss:0.01396009512245655
The generated pressure mean: 0.4190036654472351
loss_pred:0.027344346046447754, decouple_loss:0.013952371664345264
Iteration: 1395, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46361464262008667
loss_pred:0.02410002052783966, decouple_loss:0.013560513965785503
The generated pressure mean: 0.4659777879714966
loss_pred:0.024141816422343254, decouple_loss:0.01330603938549757
The generated pressure mean: 0.466178834438324
loss_pred:0.025885632261633873, decouple_loss:0.013375353999435902
Iteration: 1396, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4683276414871216
The generated pressure mean: 0.4734888970851898
loss_pred:0.02742122672498226, decouple_loss:0.011505408212542534
loss_pred:0.026715774089097977, decouple_loss:0.011729924008250237
The generated pressure mean: 0.4733293354511261
loss_pred:0.025879940018057823, decouple_loss:0.011729440651834011
Iteration: 1397, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4240884482860565
The generated pressure mean: 0.42815789580345154
loss_pred:0.027383198961615562, decouple_loss:0.012178019620478153
loss_pred:0.026732634752988815, decouple_loss:0.012343809939920902
The generated pressure mean: 0.42183053493499756
loss_pred:0.02543763257563114, decouple_loss:0.012134682387113571
Iteration: 1398, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43644019961357117
loss_pred:0.025496462360024452, decouple_loss:0.01165085844695568
The generated pressure mean: 0.4330393970012665
loss_pred:0.026732882484793663, decouple_loss:0.01161529403179884
The generated pressure mean: 0.4418122470378876
loss_pred:0.026039816439151764, decouple_loss:0.011943145655095577
Iteration: 1399, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4620679020881653
loss_pred:0.02687752991914749, decouple_loss:0.013628505170345306
The generated pressure mean: 0.46589285135269165
loss_pred:0.024616194888949394, decouple_loss:0.013810079544782639
The generated pressure mean: 0.459781676530838
loss_pred:0.025624284520745277, decouple_loss:0.013586935587227345
Iteration: 1400, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.444015234708786
loss_pred:0.026397906243801117, decouple_loss:0.012454652227461338
The generated pressure mean: 0.4431321620941162
loss_pred:0.027383582666516304, decouple_loss:0.012558209709823132
The generated pressure mean: 0.4443841278553009
loss_pred:0.0285157710313797, decouple_loss:0.012608270160853863
2023-04-16 17:31:14 testing...
The generated pressure mean: 0.42034411430358887
The generated pressure mean: 0.42753785848617554
The generated pressure mean: 0.42984575033187866
loss_pred:0.035669464617967606, decouple_loss:0.013951861299574375
loss_pred:0.03418149799108505, decouple_loss:0.014272375032305717
loss_pred:0.03419271484017372, decouple_loss:0.014368191361427307
WV_0_PC_0_EH_1_PS_40, loss: 0.035391103476285934, avg_mse: 0.04667588695883751
current test mse: 0.046676
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 1401, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44134727120399475
loss_pred:0.02541205659508705, decouple_loss:0.01326444000005722
The generated pressure mean: 0.4356097877025604
loss_pred:0.025943834334611893, decouple_loss:0.013401639647781849
The generated pressure mean: 0.4441371560096741
loss_pred:0.024950800463557243, decouple_loss:0.013229760341346264
Iteration: 1402, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45713144540786743
The generated pressure mean: 0.453921914100647
loss_pred:0.025733213871717453, decouple_loss:0.013000219129025936
loss_pred:0.025593338534235954, decouple_loss:0.012294759042561054
The generated pressure mean: 0.4549943804740906
loss_pred:0.024705030024051666, decouple_loss:0.012747202068567276
Iteration: 1403, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45528459548950195
The generated pressure mean: 0.45695701241493225
loss_pred:0.025204017758369446, decouple_loss:0.01283346675336361
loss_pred:0.02379867061972618, decouple_loss:0.012727131135761738
The generated pressure mean: 0.4513119161128998
loss_pred:0.025540493428707123, decouple_loss:0.012672221288084984
Iteration: 1404, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4375222325325012
loss_pred:0.02621799148619175, decouple_loss:0.012314085848629475
The generated pressure mean: 0.44322457909584045
loss_pred:0.0255717895925045, decouple_loss:0.012085873633623123
The generated pressure mean: 0.44251325726509094
loss_pred:0.02570611797273159, decouple_loss:0.012088886462152004
Iteration: 1405, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4396872818470001
loss_pred:0.024435488507151604, decouple_loss:0.012644105590879917
The generated pressure mean: 0.43608421087265015
loss_pred:0.025507118552923203, decouple_loss:0.012546411715447903
The generated pressure mean: 0.43963849544525146
loss_pred:0.024175265803933144, decouple_loss:0.012972023338079453
Iteration: 1406, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4606088697910309
loss_pred:0.027252057567238808, decouple_loss:0.012593104504048824
The generated pressure mean: 0.4596558213233948
loss_pred:0.02600024826824665, decouple_loss:0.012680890038609505
The generated pressure mean: 0.4551791250705719
loss_pred:0.025517133995890617, decouple_loss:0.012670643627643585
Iteration: 1407, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4353179335594177
loss_pred:0.023781005293130875, decouple_loss:0.01438345480710268
The generated pressure mean: 0.43281829357147217
loss_pred:0.023686736822128296, decouple_loss:0.014312250539660454
The generated pressure mean: 0.4325382709503174
loss_pred:0.024988390505313873, decouple_loss:0.014302280731499195
Iteration: 1408, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4455264210700989
loss_pred:0.024851521477103233, decouple_loss:0.013512806035578251
The generated pressure mean: 0.4476132392883301
loss_pred:0.025378180667757988, decouple_loss:0.01331425178796053
The generated pressure mean: 0.44833052158355713
loss_pred:0.024758754298090935, decouple_loss:0.013436567038297653
Iteration: 1409, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45513224601745605
The generated pressure mean: 0.4659842252731323
loss_pred:0.024251140654087067, decouple_loss:0.012703078798949718
loss_pred:0.02410103566944599, decouple_loss:0.013110940344631672
The generated pressure mean: 0.4552534520626068
loss_pred:0.0260968878865242, decouple_loss:0.012880011461675167
Iteration: 1410, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468790292739868
loss_pred:0.025010457262396812, decouple_loss:0.014272691681981087
The generated pressure mean: 0.4464675486087799
loss_pred:0.024000627920031548, decouple_loss:0.014290323480963707
The generated pressure mean: 0.44489461183547974
loss_pred:0.026445141062140465, decouple_loss:0.01440437976270914
2023-04-16 17:33:44 testing...
The generated pressure mean: 0.4201940596103668
The generated pressure mean: 0.42655837535858154
loss_pred:0.035901956260204315, decouple_loss:0.014384308829903603
The generated pressure mean: 0.4292052686214447
loss_pred:0.034570466727018356, decouple_loss:0.014656327664852142
loss_pred:0.03430881351232529, decouple_loss:0.014745665714144707
WV_0_PC_0_EH_1_PS_40, loss: 0.035656850785017014, avg_mse: 0.04723041504621506
current test mse: 0.04723
Iteration: 1411, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44073066115379333
The generated pressure mean: 0.4425618350505829
loss_pred:0.02434733882546425, decouple_loss:0.013930361717939377
loss_pred:0.025283725932240486, decouple_loss:0.01395595632493496
The generated pressure mean: 0.4404537081718445
loss_pred:0.02499869093298912, decouple_loss:0.013798520900309086
Iteration: 1412, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4426233768463135
The generated pressure mean: 0.4494538903236389
loss_pred:0.02480737678706646, decouple_loss:0.012739807367324829
loss_pred:0.025521380826830864, decouple_loss:0.012774860486388206
The generated pressure mean: 0.4454784095287323
loss_pred:0.024400988593697548, decouple_loss:0.01263001374900341
Iteration: 1413, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45733723044395447
The generated pressure mean: 0.45668265223503113loss_pred:0.024218643084168434, decouple_loss:0.012341314926743507
loss_pred:0.025678426027297974, decouple_loss:0.01257688645273447
The generated pressure mean: 0.4575504958629608
loss_pred:0.026353685185313225, decouple_loss:0.012501440942287445
Iteration: 1414, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4441877007484436
loss_pred:0.023831214755773544, decouple_loss:0.013834761455655098
The generated pressure mean: 0.44404375553131104
loss_pred:0.024342628195881844, decouple_loss:0.013897725380957127
The generated pressure mean: 0.43740972876548767
loss_pred:0.02384975552558899, decouple_loss:0.01385780144482851
Iteration: 1415, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.445255309343338
The generated pressure mean: 0.44509828090667725
loss_pred:0.02417580783367157, decouple_loss:0.012902257964015007
loss_pred:0.024551361799240112, decouple_loss:0.012828350067138672
The generated pressure mean: 0.44019466638565063
loss_pred:0.023407477885484695, decouple_loss:0.013173512183129787
Iteration: 1416, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4521411061286926
The generated pressure mean: 0.4544011056423187
loss_pred:0.024236628785729408, decouple_loss:0.012291338294744492
loss_pred:0.02484853006899357, decouple_loss:0.012553507462143898
The generated pressure mean: 0.4535418450832367
loss_pred:0.02544454298913479, decouple_loss:0.01271239947527647
Iteration: 1417, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447514146566391
loss_pred:0.024580014869570732, decouple_loss:0.013539575040340424
The generated pressure mean: 0.4506324529647827
loss_pred:0.024125980213284492, decouple_loss:0.01348771620541811
The generated pressure mean: 0.45058873295783997
loss_pred:0.026204118505120277, decouple_loss:0.013310672715306282
Iteration: 1418, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4296099543571472
loss_pred:0.02553168497979641, decouple_loss:0.013428907841444016
The generated pressure mean: 0.4338572025299072
loss_pred:0.024418294429779053, decouple_loss:0.013243245892226696
The generated pressure mean: 0.43031537532806396
loss_pred:0.02361743524670601, decouple_loss:0.013300459831953049
Iteration: 1419, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44692549109458923
loss_pred:0.02334563061594963, decouple_loss:0.012355024926364422
The generated pressure mean: 0.4482237696647644
loss_pred:0.024930693209171295, decouple_loss:0.012342074885964394
The generated pressure mean: 0.44809669256210327
loss_pred:0.02498975582420826, decouple_loss:0.012428425252437592
Iteration: 1420, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.461153119802475
loss_pred:0.02475174330174923, decouple_loss:0.012070193886756897
The generated pressure mean: 0.465564489364624
loss_pred:0.025540439411997795, decouple_loss:0.012165257707238197
The generated pressure mean: 0.46205854415893555
loss_pred:0.02447926625609398, decouple_loss:0.01197123248130083
2023-04-16 17:35:38 testing...
The generated pressure mean: 0.4185572862625122
The generated pressure mean: 0.4250885248184204
The generated pressure mean: 0.42771586775779724
loss_pred:0.03488245978951454, decouple_loss:0.011973855085670948
loss_pred:0.03382837027311325, decouple_loss:0.01226883102208376
loss_pred:0.03348580375313759, decouple_loss:0.01238841563463211
WV_0_PC_0_EH_1_PS_40, loss: 0.034676067531108856, avg_mse: 0.04575101658701897
current test mse: 0.045751
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 1421, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4455741345882416
loss_pred:0.02607083134353161, decouple_loss:0.011606690473854542
The generated pressure mean: 0.43804532289505005
loss_pred:0.02483862079679966, decouple_loss:0.01140189915895462
The generated pressure mean: 0.4404657781124115
loss_pred:0.026085196062922478, decouple_loss:0.01147562824189663
Iteration: 1422, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43457522988319397
The generated pressure mean: 0.429494172334671
loss_pred:0.024440908804535866, decouple_loss:0.012195110321044922
loss_pred:0.02489927038550377, decouple_loss:0.012258181348443031
The generated pressure mean: 0.4390397369861603
loss_pred:0.02545655332505703, decouple_loss:0.012425074353814125
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1423, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45025834441185
The generated pressure mean: 0.45497801899909973
loss_pred:0.02577604539692402, decouple_loss:0.011842187494039536
loss_pred:0.023375799879431725, decouple_loss:0.011776300147175789
The generated pressure mean: 0.4554356336593628
loss_pred:0.024168619886040688, decouple_loss:0.011664731428027153
Iteration: 1424, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4521251618862152
The generated pressure mean: 0.4491429626941681
loss_pred:0.02467512898147106, decouple_loss:0.011382762342691422
loss_pred:0.02565160021185875, decouple_loss:0.011456485837697983
The generated pressure mean: 0.4495866298675537
loss_pred:0.025186369195580482, decouple_loss:0.0113906878978014
Iteration: 1425, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44468939304351807
The generated pressure mean: 0.4414478540420532
loss_pred:0.023483986034989357, decouple_loss:0.01127620693296194
loss_pred:0.025343697518110275, decouple_loss:0.011276227422058582
The generated pressure mean: 0.4442161023616791
loss_pred:0.0255416352301836, decouple_loss:0.011414273642003536
Iteration: 1426, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44448184967041016
The generated pressure mean: 0.4413074851036072
loss_pred:0.023793615400791168, decouple_loss:0.011743682436645031
loss_pred:0.0246054045855999, decouple_loss:0.011799139901995659
The generated pressure mean: 0.44135263562202454
loss_pred:0.02540258876979351, decouple_loss:0.011714749969542027
Iteration: 1427, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4593767523765564
The generated pressure mean: 0.4520875811576843
loss_pred:0.02495286613702774, decouple_loss:0.012924745678901672
loss_pred:0.02503509260714054, decouple_loss:0.012849678285419941
The generated pressure mean: 0.4520881772041321
loss_pred:0.024359142407774925, decouple_loss:0.012930778786540031
Iteration: 1428, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4453951418399811
The generated pressure mean: 0.44102782011032104
loss_pred:0.025451330468058586, decouple_loss:0.01283235102891922
loss_pred:0.02439778856933117, decouple_loss:0.013011916540563107
The generated pressure mean: 0.44418177008628845
loss_pred:0.025424892082810402, decouple_loss:0.012935678474605083
Iteration: 1429, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476192891597748
The generated pressure mean: 0.4373255670070648
loss_pred:0.025731051340699196, decouple_loss:0.012618454173207283
loss_pred:0.023915033787488937, decouple_loss:0.01216938067227602
The generated pressure mean: 0.4431045651435852
loss_pred:0.023686444386839867, decouple_loss:0.01245764922350645
Iteration: 1430, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44644948840141296
The generated pressure mean: 0.4491487145423889loss_pred:0.024532848969101906, decouple_loss:0.012531666085124016
loss_pred:0.025090890005230904, decouple_loss:0.012415733188390732
The generated pressure mean: 0.4477657377719879
loss_pred:0.025263944640755653, decouple_loss:0.012414359487593174
2023-04-16 17:38:10 testing...
The generated pressure mean: 0.4181160032749176
The generated pressure mean: 0.42506200075149536
The generated pressure mean: 0.42775312066078186
loss_pred:0.0354161374270916, decouple_loss:0.012170257046818733
loss_pred:0.03403768688440323, decouple_loss:0.01256314292550087
loss_pred:0.033744145184755325, decouple_loss:0.012647702358663082
WV_0_PC_0_EH_1_PS_40, loss: 0.03502234071493149, avg_mse: 0.04638983681797981
current test mse: 0.04639
Iteration: 1431, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494020342826843
loss_pred:0.024105889722704887, decouple_loss:0.011671596206724644
The generated pressure mean: 0.4459637701511383
loss_pred:0.023389989510178566, decouple_loss:0.011459189467132092
The generated pressure mean: 0.4426119923591614
loss_pred:0.024710122495889664, decouple_loss:0.011746897362172604
Iteration: 1432, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44436803460121155
loss_pred:0.025215717032551765, decouple_loss:0.011277880519628525
The generated pressure mean: 0.446110337972641
loss_pred:0.025611121207475662, decouple_loss:0.011238803155720234
The generated pressure mean: 0.44895946979522705
loss_pred:0.024182451888918877, decouple_loss:0.011127266101539135
Iteration: 1433, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4524323642253876
loss_pred:0.025110850110650063, decouple_loss:0.012418985366821289
The generated pressure mean: 0.44655007123947144
loss_pred:0.024911735206842422, decouple_loss:0.012323209084570408
The generated pressure mean: 0.44347476959228516
loss_pred:0.024304069578647614, decouple_loss:0.012349285185337067
Iteration: 1434, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44149249792099
loss_pred:0.025389373302459717, decouple_loss:0.01264486089348793
The generated pressure mean: 0.4436222016811371
loss_pred:0.02484828233718872, decouple_loss:0.012771260924637318
The generated pressure mean: 0.44240593910217285
loss_pred:0.024777093902230263, decouple_loss:0.012489138171076775
Iteration: 1435, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.453206866979599
loss_pred:0.02325253002345562, decouple_loss:0.01187712512910366
The generated pressure mean: 0.44891077280044556
loss_pred:0.02500067465007305, decouple_loss:0.011798071675002575
The generated pressure mean: 0.45301857590675354
loss_pred:0.026833917945623398, decouple_loss:0.011952577158808708
Iteration: 1436, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4420583248138428
The generated pressure mean: 0.4464482367038727
loss_pred:0.02545294724404812, decouple_loss:0.011998734436929226
loss_pred:0.024657508358359337, decouple_loss:0.012014712207019329
The generated pressure mean: 0.44590792059898376
loss_pred:0.025327010080218315, decouple_loss:0.012005911208689213
Iteration: 1437, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4455665647983551
loss_pred:0.02376384474337101, decouple_loss:0.012212329544126987
The generated pressure mean: 0.43894216418266296
loss_pred:0.02327156253159046, decouple_loss:0.012535367161035538
The generated pressure mean: 0.44039756059646606
loss_pred:0.025677110999822617, decouple_loss:0.012230324558913708
Iteration: 1438, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44916126132011414
loss_pred:0.024477345868945122, decouple_loss:0.011957744136452675
The generated pressure mean: 0.4541316032409668
loss_pred:0.025981131941080093, decouple_loss:0.012079309672117233
The generated pressure mean: 0.4437335133552551
loss_pred:0.024294886738061905, decouple_loss:0.011919292621314526
Iteration: 1439, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45270612835884094
loss_pred:0.024738531559705734, decouple_loss:0.013381270691752434
The generated pressure mean: 0.45604315400123596
loss_pred:0.02441110648214817, decouple_loss:0.013440392911434174
The generated pressure mean: 0.4518757462501526
loss_pred:0.02431131899356842, decouple_loss:0.013401508331298828
Iteration: 1440, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4366299510002136
loss_pred:0.025493590161204338, decouple_loss:0.012886470183730125
The generated pressure mean: 0.43686556816101074
loss_pred:0.024899911135435104, decouple_loss:0.013061244040727615
The generated pressure mean: 0.43957218527793884
loss_pred:0.02414979785680771, decouple_loss:0.012843864969909191
2023-04-16 17:40:03 testing...
The generated pressure mean: 0.41934454441070557
The generated pressure mean: 0.42596060037612915
The generated pressure mean: 0.42881497740745544
loss_pred:0.03510722890496254, decouple_loss:0.012520450167357922
loss_pred:0.033592671155929565, decouple_loss:0.013015059754252434
loss_pred:0.03372473269701004, decouple_loss:0.012880620546638966
WV_0_PC_0_EH_1_PS_40, loss: 0.034781813621520996, avg_mse: 0.045965809375047684
current test mse: 0.045966
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 1441, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4396151900291443
loss_pred:0.025089384987950325, decouple_loss:0.012601240538060665
The generated pressure mean: 0.44055065512657166
loss_pred:0.026196956634521484, decouple_loss:0.012215404771268368
The generated pressure mean: 0.4420755207538605
loss_pred:0.024718323722481728, decouple_loss:0.012297267094254494
Iteration: 1442, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45556533336639404The generated pressure mean: 0.4492671489715576
loss_pred:0.025723950937390327, decouple_loss:0.011786110699176788
loss_pred:0.02537122741341591, decouple_loss:0.011443222872912884
The generated pressure mean: 0.45624762773513794
loss_pred:0.02672242932021618, decouple_loss:0.011549056507647038
Iteration: 1443, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45184826850891113
The generated pressure mean: 0.461704820394516
loss_pred:0.024094991385936737, decouple_loss:0.012432755902409554
loss_pred:0.02629493735730648, decouple_loss:0.012403570115566254
The generated pressure mean: 0.4595940113067627
loss_pred:0.024639256298542023, decouple_loss:0.012488170526921749
Iteration: 1444, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446312814950943
The generated pressure mean: 0.44202929735183716
loss_pred:0.02666008658707142, decouple_loss:0.013191998936235905
loss_pred:0.026264982298016548, decouple_loss:0.01301803532987833
The generated pressure mean: 0.44253605604171753
loss_pred:0.026026077568531036, decouple_loss:0.01304868794977665
Iteration: 1445, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43752339482307434
loss_pred:0.025240546092391014, decouple_loss:0.011932818219065666
The generated pressure mean: 0.4364013671875
loss_pred:0.024711545556783676, decouple_loss:0.012521405704319477
The generated pressure mean: 0.4380081593990326
loss_pred:0.02513130009174347, decouple_loss:0.012128865346312523
Iteration: 1446, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494742453098297
loss_pred:0.02585328370332718, decouple_loss:0.012491371482610703
The generated pressure mean: 0.4485241174697876
loss_pred:0.02503875456750393, decouple_loss:0.012964212335646152
The generated pressure mean: 0.4526561498641968
loss_pred:0.026084642857313156, decouple_loss:0.012831197120249271
Iteration: 1447, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4597550332546234
loss_pred:0.026205826550722122, decouple_loss:0.012749864719808102
The generated pressure mean: 0.4584800899028778
loss_pred:0.026819592341780663, decouple_loss:0.01266058161854744
The generated pressure mean: 0.45410093665122986
loss_pred:0.025306222960352898, decouple_loss:0.01260269433259964
Iteration: 1448, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4326670467853546
loss_pred:0.02568548545241356, decouple_loss:0.012970316223800182
The generated pressure mean: 0.430501788854599
loss_pred:0.025771358981728554, decouple_loss:0.01313212513923645
The generated pressure mean: 0.43599510192871094
loss_pred:0.025166427716612816, decouple_loss:0.013007751666009426
Iteration: 1449, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45172062516212463
loss_pred:0.02576105110347271, decouple_loss:0.012826734222471714
The generated pressure mean: 0.4540170431137085
loss_pred:0.023449471220374107, decouple_loss:0.012816482223570347
The generated pressure mean: 0.4480362832546234
loss_pred:0.02589200809597969, decouple_loss:0.012760593555867672
Iteration: 1450, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45503148436546326
The generated pressure mean: 0.4567716717720032
loss_pred:0.02402658201754093, decouple_loss:0.012587600387632847
loss_pred:0.027163155376911163, decouple_loss:0.012387225404381752
The generated pressure mean: 0.45418667793273926
loss_pred:0.0253297071903944, decouple_loss:0.012603267095983028
2023-04-16 17:42:31 testing...
The generated pressure mean: 0.4208351671695709
The generated pressure mean: 0.4270397126674652
loss_pred:0.03547985106706619, decouple_loss:0.012774390168488026
The generated pressure mean: 0.4293796420097351
loss_pred:0.0341930016875267, decouple_loss:0.013004070147871971
loss_pred:0.03390960767865181, decouple_loss:0.013164396397769451
WV_0_PC_0_EH_1_PS_40, loss: 0.035176537930965424, avg_mse: 0.046571966260671616
current test mse: 0.046572
Iteration: 1451, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43783098459243774
The generated pressure mean: 0.4346122443675995
loss_pred:0.025057591497898102, decouple_loss:0.01249500922858715
loss_pred:0.02525603584945202, decouple_loss:0.012359793297946453
The generated pressure mean: 0.43420568108558655
loss_pred:0.026358764618635178, decouple_loss:0.012273941189050674
Iteration: 1452, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500855803489685
loss_pred:0.024578675627708435, decouple_loss:0.011520829051733017
The generated pressure mean: 0.44999879598617554
loss_pred:0.025272078812122345, decouple_loss:0.011787598952651024
The generated pressure mean: 0.4483450949192047
loss_pred:0.026292558759450912, decouple_loss:0.011779902502894402
Iteration: 1453, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4558737277984619
loss_pred:0.023898890241980553, decouple_loss:0.012863709591329098
The generated pressure mean: 0.4634643495082855
loss_pred:0.025356413796544075, decouple_loss:0.013088976964354515
The generated pressure mean: 0.457120805978775
loss_pred:0.02475106157362461, decouple_loss:0.012756296433508396
Iteration: 1454, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.441860556602478
The generated pressure mean: 0.4445754587650299
loss_pred:0.024118009954690933, decouple_loss:0.012580587528645992
loss_pred:0.02589813806116581, decouple_loss:0.012309221550822258
The generated pressure mean: 0.4430636167526245
loss_pred:0.024743933230638504, decouple_loss:0.012734506279230118
Iteration: 1455, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4361892342567444
The generated pressure mean: 0.43552282452583313
loss_pred:0.025744309648871422, decouple_loss:0.011820853687822819
loss_pred:0.024954387918114662, decouple_loss:0.01177188940346241
The generated pressure mean: 0.4392465054988861
loss_pred:0.024299850687384605, decouple_loss:0.011856738477945328
Iteration: 1456, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44903913140296936
The generated pressure mean: 0.4496729373931885
loss_pred:0.024862296879291534, decouple_loss:0.011169511824846268
loss_pred:0.024792177602648735, decouple_loss:0.011146783828735352
The generated pressure mean: 0.44807371497154236
loss_pred:0.024838268756866455, decouple_loss:0.011279762722551823
Iteration: 1457, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4537680745124817
loss_pred:0.024844156578183174, decouple_loss:0.012617879547178745
The generated pressure mean: 0.4565787613391876
loss_pred:0.024984734132885933, decouple_loss:0.012738827615976334
The generated pressure mean: 0.45459574460983276
loss_pred:0.02382679097354412, decouple_loss:0.01292392984032631
Iteration: 1458, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44921258091926575
loss_pred:0.025699038058519363, decouple_loss:0.013033765368163586
The generated pressure mean: 0.44913020730018616
loss_pred:0.02506164461374283, decouple_loss:0.013037650845944881
The generated pressure mean: 0.44287747144699097
loss_pred:0.023892713710665703, decouple_loss:0.01292906142771244
Iteration: 1459, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44589006900787354
loss_pred:0.026801859959959984, decouple_loss:0.012524252757430077
The generated pressure mean: 0.44718873500823975
loss_pred:0.02455759607255459, decouple_loss:0.01255862507969141
The generated pressure mean: 0.4469161331653595
loss_pred:0.023608975112438202, decouple_loss:0.012792936526238918
Iteration: 1460, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43746015429496765
loss_pred:0.02357945591211319, decouple_loss:0.012442205101251602
The generated pressure mean: 0.4352983236312866
loss_pred:0.024208663031458855, decouple_loss:0.012360411696135998
The generated pressure mean: 0.4344364404678345
loss_pred:0.024641696363687515, decouple_loss:0.012335449457168579
2023-04-16 17:44:24 testing...
The generated pressure mean: 0.4256499409675598
The generated pressure mean: 0.41807857155799866
The generated pressure mean: 0.4282282292842865
loss_pred:0.03424825146794319, decouple_loss:0.012278649024665356
loss_pred:0.03528638556599617, decouple_loss:0.012114989571273327
loss_pred:0.03349538892507553, decouple_loss:0.012356509454548359
WV_0_PC_0_EH_1_PS_40, loss: 0.03495584428310394, avg_mse: 0.04684232547879219
current test mse: 0.046842
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 1461, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4453212022781372
loss_pred:0.025313984602689743, decouple_loss:0.011526525020599365
The generated pressure mean: 0.4488818943500519
loss_pred:0.024836072698235512, decouple_loss:0.011603966355323792
The generated pressure mean: 0.4516605734825134
loss_pred:0.02601579762995243, decouple_loss:0.011737815104424953
Iteration: 1462, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4543745517730713
The generated pressure mean: 0.4473138451576233
loss_pred:0.025292491540312767, decouple_loss:0.011939511634409428
loss_pred:0.025545474141836166, decouple_loss:0.011949234642088413
The generated pressure mean: 0.4539441168308258
loss_pred:0.024758996441960335, decouple_loss:0.011770430952310562
Iteration: 1463, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4448917508125305
The generated pressure mean: 0.4411194920539856
loss_pred:0.0240938663482666, decouple_loss:0.012541424483060837
loss_pred:0.025871438905596733, decouple_loss:0.01245309878140688
The generated pressure mean: 0.44260677695274353
loss_pred:0.02464938908815384, decouple_loss:0.01257896889001131
Iteration: 1464, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496825933456421
loss_pred:0.024545524269342422, decouple_loss:0.012690647505223751
The generated pressure mean: 0.45401671528816223
loss_pred:0.025900550186634064, decouple_loss:0.012740448117256165
The generated pressure mean: 0.4564901292324066
loss_pred:0.025969870388507843, decouple_loss:0.012898724526166916
Iteration: 1465, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4432922899723053
The generated pressure mean: 0.4474271237850189
loss_pred:0.024851853027939796, decouple_loss:0.011319407261908054
loss_pred:0.02696678414940834, decouple_loss:0.011389720253646374
The generated pressure mean: 0.44538670778274536
loss_pred:0.02565792389214039, decouple_loss:0.011377973482012749
Iteration: 1466, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4372042119503021
The generated pressure mean: 0.43620002269744873
loss_pred:0.024617359042167664, decouple_loss:0.012585503049194813
loss_pred:0.02624407783150673, decouple_loss:0.01247667707502842
The generated pressure mean: 0.4324954152107239
loss_pred:0.02439732477068901, decouple_loss:0.012744216248393059
Iteration: 1467, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4596240520477295
loss_pred:0.024767117574810982, decouple_loss:0.014604411087930202
The generated pressure mean: 0.459829717874527
loss_pred:0.025323396548628807, decouple_loss:0.014541484415531158
The generated pressure mean: 0.45875707268714905
loss_pred:0.023399559780955315, decouple_loss:0.0144847072660923
Iteration: 1468, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45645585656166077
loss_pred:0.024593787267804146, decouple_loss:0.012937309220433235
The generated pressure mean: 0.45353826880455017
loss_pred:0.02446584217250347, decouple_loss:0.012940776534378529
The generated pressure mean: 0.4533635973930359
loss_pred:0.024428581818938255, decouple_loss:0.012869304046034813
Iteration: 1469, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4365360736846924
loss_pred:0.024673927575349808, decouple_loss:0.0125162024050951
The generated pressure mean: 0.440905898809433
loss_pred:0.025050783529877663, decouple_loss:0.01216367818415165
The generated pressure mean: 0.43678396940231323
loss_pred:0.02469114027917385, decouple_loss:0.01231298130005598
Iteration: 1470, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44435548782348633
loss_pred:0.024133292958140373, decouple_loss:0.015067505650222301
The generated pressure mean: 0.43982353806495667
loss_pred:0.025386426597833633, decouple_loss:0.01504410058259964
The generated pressure mean: 0.4431353509426117
loss_pred:0.02576136589050293, decouple_loss:0.015122740529477596
2023-04-16 17:46:53 testing...
The generated pressure mean: 0.41612109541893005
The generated pressure mean: 0.4229702055454254
loss_pred:0.035638220608234406, decouple_loss:0.014010126702487469
The generated pressure mean: 0.4247129261493683
loss_pred:0.03428838029503822, decouple_loss:0.014266369864344597
loss_pred:0.03411418944597244, decouple_loss:0.014454376883804798
WV_0_PC_0_EH_1_PS_40, loss: 0.03539244458079338, avg_mse: 0.047079090029001236
current test mse: 0.047079
Iteration: 1471, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4455788731575012
The generated pressure mean: 0.4479596018791199
loss_pred:0.023977946490049362, decouple_loss:0.013373881578445435
loss_pred:0.025575872510671616, decouple_loss:0.013374620117247105
The generated pressure mean: 0.44901975989341736
loss_pred:0.025069065392017365, decouple_loss:0.013320785015821457
Iteration: 1472, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.451930433511734
The generated pressure mean: 0.4526306390762329
loss_pred:0.024455729871988297, decouple_loss:0.012981181964278221
loss_pred:0.024538611993193626, decouple_loss:0.013015029020607471
The generated pressure mean: 0.4455370306968689
loss_pred:0.025492530316114426, decouple_loss:0.01296407449990511
Iteration: 1473, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493147134780884
loss_pred:0.026369115337729454, decouple_loss:0.013536132872104645
The generated pressure mean: 0.4575079083442688
loss_pred:0.02478429116308689, decouple_loss:0.0137322461232543
The generated pressure mean: 0.45803818106651306
loss_pred:0.02525615505874157, decouple_loss:0.013672328554093838
Iteration: 1474, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4400140643119812
The generated pressure mean: 0.43714359402656555
loss_pred:0.024641400203108788, decouple_loss:0.012559249997138977
loss_pred:0.024354705587029457, decouple_loss:0.012608700431883335
The generated pressure mean: 0.42957866191864014
loss_pred:0.025464527308940887, decouple_loss:0.01248335000127554
Iteration: 1475, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44559571146965027
loss_pred:0.02442733757197857, decouple_loss:0.012589984573423862
The generated pressure mean: 0.44469383358955383
loss_pred:0.024846618995070457, decouple_loss:0.012267542071640491
The generated pressure mean: 0.4493546485900879
loss_pred:0.024484984576702118, decouple_loss:0.012322844006121159
Iteration: 1476, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4554285407066345
loss_pred:0.024825170636177063, decouple_loss:0.011356036178767681
The generated pressure mean: 0.454944372177124
loss_pred:0.025513434782624245, decouple_loss:0.011431452818214893
The generated pressure mean: 0.45272356271743774
loss_pred:0.02522364631295204, decouple_loss:0.011632891371846199
Iteration: 1477, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44109076261520386
The generated pressure mean: 0.4447978734970093
loss_pred:0.02393334172666073, decouple_loss:0.011651628650724888
loss_pred:0.02544539049267769, decouple_loss:0.011658155359327793
The generated pressure mean: 0.4419538080692291
loss_pred:0.024417148903012276, decouple_loss:0.011973857879638672
Iteration: 1478, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44621002674102783
The generated pressure mean: 0.44167041778564453
loss_pred:0.0247163288295269, decouple_loss:0.012903690338134766
loss_pred:0.02687288634479046, decouple_loss:0.01303608063608408
The generated pressure mean: 0.4439263641834259
loss_pred:0.024303501471877098, decouple_loss:0.013121974654495716
Iteration: 1479, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44835197925567627
The generated pressure mean: 0.45411980152130127
loss_pred:0.024221271276474, decouple_loss:0.013177761808037758
loss_pred:0.023804467171430588, decouple_loss:0.013322400860488415
The generated pressure mean: 0.44676461815834045
loss_pred:0.023897498846054077, decouple_loss:0.013376538641750813
Iteration: 1480, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44763365387916565
The generated pressure mean: 0.45025137066841125
loss_pred:0.023627186194062233, decouple_loss:0.013049392029643059
loss_pred:0.024298742413520813, decouple_loss:0.012876784428954124
The generated pressure mean: 0.45417332649230957
loss_pred:0.025232475250959396, decouple_loss:0.012793133035302162
2023-04-16 17:48:46 testing...
The generated pressure mean: 0.42350271344184875
The generated pressure mean: 0.4169030785560608
The generated pressure mean: 0.426045686006546
loss_pred:0.033655498176813126, decouple_loss:0.01243889145553112
loss_pred:0.034803807735443115, decouple_loss:0.012293284758925438
loss_pred:0.0330432765185833, decouple_loss:0.012619981542229652
WV_0_PC_0_EH_1_PS_40, loss: 0.034456729888916016, avg_mse: 0.045474227517843246
current test mse: 0.045474
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 1481, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45121315121650696
loss_pred:0.02395048923790455, decouple_loss:0.012311166152358055
The generated pressure mean: 0.44844770431518555
loss_pred:0.023978576064109802, decouple_loss:0.01208251342177391
The generated pressure mean: 0.45224300026893616
loss_pred:0.025623183697462082, decouple_loss:0.012255052104592323
Iteration: 1482, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4432206451892853
The generated pressure mean: 0.44520333409309387
loss_pred:0.02494395710527897, decouple_loss:0.011568122543394566
loss_pred:0.023528967052698135, decouple_loss:0.011556818149983883
The generated pressure mean: 0.43907541036605835
loss_pred:0.02450798638164997, decouple_loss:0.011711927130818367
Iteration: 1483, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483489394187927
The generated pressure mean: 0.44824305176734924
loss_pred:0.024028727784752846, decouple_loss:0.011990763247013092
loss_pred:0.02452620305120945, decouple_loss:0.011882664635777473
The generated pressure mean: 0.4460621178150177
loss_pred:0.025708695873618126, decouple_loss:0.012087283656001091
Iteration: 1484, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4410579204559326
The generated pressure mean: 0.4408460557460785
loss_pred:0.026233498007059097, decouple_loss:0.011305681429803371
loss_pred:0.02566712163388729, decouple_loss:0.011330671608448029
The generated pressure mean: 0.4456273019313812
loss_pred:0.023056121543049812, decouple_loss:0.01156179141253233
Iteration: 1485, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4437737464904785
The generated pressure mean: 0.44280529022216797
loss_pred:0.02533416450023651, decouple_loss:0.011820513755083084
loss_pred:0.024082109332084656, decouple_loss:0.011786204762756824
The generated pressure mean: 0.4429284930229187
loss_pred:0.023391366004943848, decouple_loss:0.011622430756688118
Iteration: 1486, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45767390727996826
The generated pressure mean: 0.4607818126678467
loss_pred:0.023336486890912056, decouple_loss:0.012335743755102158
loss_pred:0.02476167492568493, decouple_loss:0.01234398502856493
The generated pressure mean: 0.4580773115158081
loss_pred:0.02474364824593067, decouple_loss:0.012207644991576672
Iteration: 1487, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45358186960220337
The generated pressure mean: 0.4495668411254883
loss_pred:0.024366695433855057, decouple_loss:0.012495890259742737
loss_pred:0.024078369140625, decouple_loss:0.012457489967346191
The generated pressure mean: 0.45108169317245483
loss_pred:0.024788284674286842, decouple_loss:0.012582284398376942
Iteration: 1488, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4395853877067566
The generated pressure mean: 0.433353453874588
loss_pred:0.023714810609817505, decouple_loss:0.011995733715593815
loss_pred:0.025381382554769516, decouple_loss:0.012052967213094234
The generated pressure mean: 0.43388426303863525
loss_pred:0.02329847402870655, decouple_loss:0.011924905702471733
Iteration: 1489, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43615347146987915
The generated pressure mean: 0.4394061267375946
loss_pred:0.023905422538518906, decouple_loss:0.011100654490292072
loss_pred:0.024604937061667442, decouple_loss:0.01139574684202671
The generated pressure mean: 0.43926748633384705
loss_pred:0.02437252551317215, decouple_loss:0.011186650022864342
Iteration: 1490, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4543658196926117
loss_pred:0.025200799107551575, decouple_loss:0.011280471459031105
The generated pressure mean: 0.4597603976726532
loss_pred:0.025205044075846672, decouple_loss:0.011045495979487896
The generated pressure mean: 0.4581296145915985
loss_pred:0.02464430034160614, decouple_loss:0.011063149198889732
2023-04-16 17:51:18 testing...
The generated pressure mean: 0.41732096672058105
The generated pressure mean: 0.4242033064365387
loss_pred:0.03447924181818962, decouple_loss:0.012300381436944008
The generated pressure mean: 0.42673468589782715
loss_pred:0.03333005681633949, decouple_loss:0.012569962069392204
loss_pred:0.03260539844632149, decouple_loss:0.01272139698266983
WV_0_PC_0_EH_1_PS_40, loss: 0.03409809619188309, avg_mse: 0.045052606612443924
current test mse: 0.045053
Iteration: 1491, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4379878342151642
loss_pred:0.024098001420497894, decouple_loss:0.011865190230309963
The generated pressure mean: 0.4488849341869354
loss_pred:0.02500499039888382, decouple_loss:0.011933919973671436
The generated pressure mean: 0.44933804869651794
loss_pred:0.024089619517326355, decouple_loss:0.01168283075094223
Iteration: 1492, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44625866413116455
The generated pressure mean: 0.44471296668052673
loss_pred:0.026150768622756004, decouple_loss:0.013593277893960476
loss_pred:0.024155069142580032, decouple_loss:0.013578066602349281
The generated pressure mean: 0.45014137029647827
loss_pred:0.02383951097726822, decouple_loss:0.013707257807254791
Iteration: 1493, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45925554633140564
The generated pressure mean: 0.448649138212204
loss_pred:0.025323880836367607, decouple_loss:0.01186708640307188
loss_pred:0.026355430483818054, decouple_loss:0.01196572557091713
The generated pressure mean: 0.4527086615562439
loss_pred:0.025966932997107506, decouple_loss:0.01187228225171566
Iteration: 1494, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.438198059797287The generated pressure mean: 0.44289299845695496
loss_pred:0.024028653278946877, decouple_loss:0.011029958724975586
loss_pred:0.02400844544172287, decouple_loss:0.011069932952523232
The generated pressure mean: 0.4417153596878052
loss_pred:0.02418612129986286, decouple_loss:0.011416645720601082
Iteration: 1495, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4327079653739929
The generated pressure mean: 0.43712759017944336
loss_pred:0.023753641173243523, decouple_loss:0.012748638167977333
loss_pred:0.02579617127776146, decouple_loss:0.012818923220038414
The generated pressure mean: 0.442846417427063
loss_pred:0.02471390925347805, decouple_loss:0.012758429162204266
Iteration: 1496, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4523763954639435
loss_pred:0.024919690564274788, decouple_loss:0.013889092020690441
The generated pressure mean: 0.45409268140792847
loss_pred:0.02339082956314087, decouple_loss:0.01386333629488945
The generated pressure mean: 0.45612022280693054
loss_pred:0.023434709757566452, decouple_loss:0.014026198536157608
Iteration: 1497, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4515482187271118The generated pressure mean: 0.45868581533432007
loss_pred:0.024025337770581245, decouple_loss:0.011909629218280315
loss_pred:0.02496194653213024, decouple_loss:0.01173087116330862
The generated pressure mean: 0.4508377015590668
loss_pred:0.025442933663725853, decouple_loss:0.011714738793671131
Iteration: 1498, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42854684591293335
loss_pred:0.025474034249782562, decouple_loss:0.014206677675247192
The generated pressure mean: 0.4354947507381439
loss_pred:0.024942129850387573, decouple_loss:0.014355264604091644
The generated pressure mean: 0.4264849126338959
loss_pred:0.026423761621117592, decouple_loss:0.01429206132888794
Iteration: 1499, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45792242884635925
loss_pred:0.02380339987576008, decouple_loss:0.01150861382484436
The generated pressure mean: 0.4511256814002991
loss_pred:0.024643082171678543, decouple_loss:0.01147189736366272
The generated pressure mean: 0.45850417017936707
loss_pred:0.023032698780298233, decouple_loss:0.011472910642623901
Iteration: 1500, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4568890631198883
loss_pred:0.025426188483834267, decouple_loss:0.011329924687743187
The generated pressure mean: 0.45696693658828735
loss_pred:0.02472568489611149, decouple_loss:0.01168263703584671
The generated pressure mean: 0.45070603489875793
loss_pred:0.02456437051296234, decouple_loss:0.011584282852709293
2023-04-16 17:53:11 testing...
The generated pressure mean: 0.4210866093635559
The generated pressure mean: 0.428205668926239
The generated pressure mean: 0.43086519837379456
loss_pred:0.036274101585149765, decouple_loss:0.014764721505343914
loss_pred:0.03504292666912079, decouple_loss:0.01511094719171524
loss_pred:0.03455767035484314, decouple_loss:0.015249675139784813
WV_0_PC_0_EH_1_PS_40, loss: 0.03604365885257721, avg_mse: 0.04848369583487511
current test mse: 0.048484
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 1501, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4398050606250763
loss_pred:0.022930344566702843, decouple_loss:0.014214320108294487
The generated pressure mean: 0.43606990575790405
loss_pred:0.024455731734633446, decouple_loss:0.01434484776109457
The generated pressure mean: 0.43528494238853455
loss_pred:0.02454260364174843, decouple_loss:0.014366026036441326
Iteration: 1502, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43651703000068665
loss_pred:0.02556617558002472, decouple_loss:0.011898938566446304
The generated pressure mean: 0.4398040771484375
loss_pred:0.024233512580394745, decouple_loss:0.011804009787738323
The generated pressure mean: 0.44333791732788086
loss_pred:0.02635865844786167, decouple_loss:0.01185518503189087
Iteration: 1503, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47508153319358826
The generated pressure mean: 0.47184810042381287
loss_pred:0.024972377344965935, decouple_loss:0.013161052949726582
loss_pred:0.028014767915010452, decouple_loss:0.013186248950660229
The generated pressure mean: 0.46840378642082214
loss_pred:0.02437099628150463, decouple_loss:0.013046955689787865
Iteration: 1504, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42060384154319763
loss_pred:0.024461129680275917, decouple_loss:0.013272618874907494
The generated pressure mean: 0.42034977674484253
loss_pred:0.026211772114038467, decouple_loss:0.01289570052176714
The generated pressure mean: 0.4255710542201996
loss_pred:0.025156928226351738, decouple_loss:0.013060059398412704
Iteration: 1505, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43931135535240173
loss_pred:0.02422606758773327, decouple_loss:0.011893104761838913
The generated pressure mean: 0.4405292272567749
loss_pred:0.0243652556091547, decouple_loss:0.011780784465372562
The generated pressure mean: 0.4405825436115265
loss_pred:0.024631213396787643, decouple_loss:0.011763260699808598
Iteration: 1506, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4789789617061615
loss_pred:0.024263110011816025, decouple_loss:0.013626123778522015
The generated pressure mean: 0.47062477469444275
loss_pred:0.024535737931728363, decouple_loss:0.013762681744992733
The generated pressure mean: 0.47526606917381287
loss_pred:0.023195745423436165, decouple_loss:0.013807469978928566
Iteration: 1507, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44787901639938354
loss_pred:0.024218235164880753, decouple_loss:0.011790678836405277
The generated pressure mean: 0.4491064250469208
loss_pred:0.02571847289800644, decouple_loss:0.011662614531815052
The generated pressure mean: 0.44970476627349854
loss_pred:0.02342587150633335, decouple_loss:0.011772682890295982
Iteration: 1508, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4285162389278412
loss_pred:0.024947917088866234, decouple_loss:0.011532329954206944
The generated pressure mean: 0.4265034794807434
loss_pred:0.02477654255926609, decouple_loss:0.011410858482122421
The generated pressure mean: 0.4235081970691681
loss_pred:0.024126920849084854, decouple_loss:0.01151957269757986
Iteration: 1509, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44527778029441833The generated pressure mean: 0.4496631324291229
loss_pred:0.024606963619589806, decouple_loss:0.011175788938999176
loss_pred:0.024417586624622345, decouple_loss:0.01132199913263321
The generated pressure mean: 0.4515420198440552
loss_pred:0.02449781261384487, decouple_loss:0.010994774289429188
Iteration: 1510, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4613797068595886
loss_pred:0.025556234642863274, decouple_loss:0.012355057522654533
The generated pressure mean: 0.45670363306999207
The generated pressure mean: 0.4598545730113983
loss_pred:0.023715859279036522, decouple_loss:0.012241383083164692
loss_pred:0.024245716631412506, decouple_loss:0.012518603354692459
2023-04-16 17:55:46 testing...
The generated pressure mean: 0.41698312759399414
The generated pressure mean: 0.4234768748283386
The generated pressure mean: 0.4255408048629761
loss_pred:0.03520195931196213, decouple_loss:0.014352753758430481
loss_pred:0.034135472029447556, decouple_loss:0.014703783206641674
loss_pred:0.033541396260261536, decouple_loss:0.014789704233407974
WV_0_PC_0_EH_1_PS_40, loss: 0.03502371162176132, avg_mse: 0.046339936554431915
current test mse: 0.04634
Iteration: 1511, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4424220621585846
loss_pred:0.024584757164120674, decouple_loss:0.014087909832596779
The generated pressure mean: 0.4492079019546509
loss_pred:0.024604706093668938, decouple_loss:0.014095447957515717
The generated pressure mean: 0.44608670473098755
loss_pred:0.024990888312458992, decouple_loss:0.01423886138945818
Iteration: 1512, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448177307844162
loss_pred:0.0245981402695179, decouple_loss:0.011995092034339905
The generated pressure mean: 0.441434383392334
loss_pred:0.02468835934996605, decouple_loss:0.011747658252716064
The generated pressure mean: 0.44074296951293945
loss_pred:0.02535754255950451, decouple_loss:0.011834998615086079
Iteration: 1513, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44534558057785034
loss_pred:0.02335604466497898, decouple_loss:0.012301926501095295
The generated pressure mean: 0.44560614228248596
loss_pred:0.02501748688519001, decouple_loss:0.012175248004496098
The generated pressure mean: 0.4486468434333801
loss_pred:0.02459597773849964, decouple_loss:0.01240526046603918
Iteration: 1514, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45264825224876404
loss_pred:0.02413424290716648, decouple_loss:0.012971125543117523
The generated pressure mean: 0.4579184949398041
loss_pred:0.02684590220451355, decouple_loss:0.012841163203120232
The generated pressure mean: 0.4519365727901459
loss_pred:0.023541996255517006, decouple_loss:0.01315263845026493
Iteration: 1515, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504542648792267
loss_pred:0.023635663092136383, decouple_loss:0.011795454658567905
The generated pressure mean: 0.4534061849117279
loss_pred:0.02342807501554489, decouple_loss:0.011556905694305897
The generated pressure mean: 0.45378920435905457
loss_pred:0.02360580861568451, decouple_loss:0.011645217426121235
Iteration: 1516, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4380110800266266
loss_pred:0.023007001727819443, decouple_loss:0.01282528042793274
The generated pressure mean: 0.43918657302856445
loss_pred:0.02451801858842373, decouple_loss:0.013155878521502018
The generated pressure mean: 0.4352097809314728
loss_pred:0.025256577879190445, decouple_loss:0.012939282692968845
Iteration: 1517, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44670552015304565
loss_pred:0.02508455328643322, decouple_loss:0.012253167107701302
The generated pressure mean: 0.4465791881084442
loss_pred:0.02431250363588333, decouple_loss:0.012085025198757648
The generated pressure mean: 0.4438120722770691
loss_pred:0.02444378472864628, decouple_loss:0.012491881847381592
Iteration: 1518, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4513263404369354
loss_pred:0.025257648900151253, decouple_loss:0.012156099081039429
The generated pressure mean: 0.45255324244499207
loss_pred:0.02339090034365654, decouple_loss:0.012381348758935928
The generated pressure mean: 0.4544183611869812
loss_pred:0.023597178980708122, decouple_loss:0.011932174675166607
Iteration: 1519, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45006051659584045
loss_pred:0.024254202842712402, decouple_loss:0.0112312538549304
The generated pressure mean: 0.45913663506507874
loss_pred:0.02369963377714157, decouple_loss:0.011138455010950565
The generated pressure mean: 0.46047890186309814
loss_pred:0.023189255967736244, decouple_loss:0.011145271360874176
Iteration: 1520, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4383772611618042
loss_pred:0.023995734751224518, decouple_loss:0.012042396701872349
The generated pressure mean: 0.4421316087245941
loss_pred:0.023219846189022064, decouple_loss:0.011849491856992245
The generated pressure mean: 0.4410857558250427
loss_pred:0.024383848533034325, decouple_loss:0.01141273695975542
2023-04-16 17:57:39 testing...
The generated pressure mean: 0.4192081093788147
The generated pressure mean: 0.4263732135295868
The generated pressure mean: 0.4287390112876892
loss_pred:0.03542916476726532, decouple_loss:0.013409588485956192
loss_pred:0.03415100648999214, decouple_loss:0.013484440743923187
loss_pred:0.033390168100595474, decouple_loss:0.013561653904616833
WV_0_PC_0_EH_1_PS_40, loss: 0.03499770909547806, avg_mse: 0.046669770032167435
current test mse: 0.04667
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 1521, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4388313591480255
loss_pred:0.027126016095280647, decouple_loss:0.013154813088476658
The generated pressure mean: 0.4391835927963257
loss_pred:0.023827465251088142, decouple_loss:0.012955417856574059
The generated pressure mean: 0.4419044852256775
loss_pred:0.024298308417201042, decouple_loss:0.013139463029801846
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1522, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44688138365745544
loss_pred:0.02477295510470867, decouple_loss:0.012187916785478592
The generated pressure mean: 0.4543326199054718
loss_pred:0.02477213740348816, decouple_loss:0.01226246077567339
The generated pressure mean: 0.4464625418186188
loss_pred:0.02506323531270027, decouple_loss:0.012361258268356323
Iteration: 1523, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4601189196109772
loss_pred:0.026569947600364685, decouple_loss:0.011548980139195919
The generated pressure mean: 0.46292227506637573
loss_pred:0.024941449984908104, decouple_loss:0.011738439090549946
The generated pressure mean: 0.46169689297676086
loss_pred:0.024477630853652954, decouple_loss:0.011452855542302132
Iteration: 1524, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4535326659679413
The generated pressure mean: 0.4537138044834137
loss_pred:0.02409052476286888, decouple_loss:0.011453388258814812
loss_pred:0.024950329214334488, decouple_loss:0.011367890983819962
The generated pressure mean: 0.4531189799308777
loss_pred:0.025067072361707687, decouple_loss:0.011362707242369652
Iteration: 1525, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4368756413459778
loss_pred:0.02396181784570217, decouple_loss:0.011087962426245213
The generated pressure mean: 0.4305925965309143
loss_pred:0.024973370134830475, decouple_loss:0.010949920862913132
The generated pressure mean: 0.434569776058197
loss_pred:0.024464480578899384, decouple_loss:0.011439623311161995
Iteration: 1526, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449557900428772
loss_pred:0.024953467771410942, decouple_loss:0.011473232880234718
The generated pressure mean: 0.453825443983078
loss_pred:0.02410644106566906, decouple_loss:0.011894903145730495
The generated pressure mean: 0.44179683923721313
loss_pred:0.02545071579515934, decouple_loss:0.011703060008585453
Iteration: 1527, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46256735920906067
loss_pred:0.026908887550234795, decouple_loss:0.011503977701067924
The generated pressure mean: 0.46097925305366516
loss_pred:0.024670010432600975, decouple_loss:0.011390379630029202
The generated pressure mean: 0.4610265791416168
loss_pred:0.023993980139493942, decouple_loss:0.011294849216938019
Iteration: 1528, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43950650095939636
loss_pred:0.024863656610250473, decouple_loss:0.011140481568872929
The generated pressure mean: 0.4415150582790375
loss_pred:0.024581819772720337, decouple_loss:0.01122832391411066
The generated pressure mean: 0.43697455525398254
loss_pred:0.0248835701495409, decouple_loss:0.0110216299071908
Iteration: 1529, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44924622774124146
loss_pred:0.025160692632198334, decouple_loss:0.010711167007684708
The generated pressure mean: 0.44651663303375244
loss_pred:0.025754880160093307, decouple_loss:0.01070079579949379
The generated pressure mean: 0.44274911284446716
loss_pred:0.02397293969988823, decouple_loss:0.010710411705076694
Iteration: 1530, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4592946469783783
loss_pred:0.024893812835216522, decouple_loss:0.011904602870345116
The generated pressure mean: 0.46204715967178345
loss_pred:0.024340219795703888, decouple_loss:0.01183822937309742
The generated pressure mean: 0.4591113030910492
loss_pred:0.026449447497725487, decouple_loss:0.011745663359761238
2023-04-16 18:00:11 testing...
The generated pressure mean: 0.4160529673099518
The generated pressure mean: 0.4230170249938965
loss_pred:0.03519013896584511, decouple_loss:0.013281255029141903
The generated pressure mean: 0.4251827895641327
loss_pred:0.034235429018735886, decouple_loss:0.013507041148841381
loss_pred:0.03392265737056732, decouple_loss:0.013738682493567467
WV_0_PC_0_EH_1_PS_40, loss: 0.03512486070394516, avg_mse: 0.04685447737574577
current test mse: 0.046854
Iteration: 1531, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4519614577293396
The generated pressure mean: 0.44916313886642456
loss_pred:0.02602258324623108, decouple_loss:0.012681535445153713
loss_pred:0.02528397925198078, decouple_loss:0.012770246714353561
The generated pressure mean: 0.4514513611793518
loss_pred:0.02644120156764984, decouple_loss:0.01287873461842537
Iteration: 1532, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44151046872138977
loss_pred:0.02469601109623909, decouple_loss:0.014230872504413128
The generated pressure mean: 0.44074180722236633
loss_pred:0.02429857850074768, decouple_loss:0.01439785398542881
The generated pressure mean: 0.440735787153244
loss_pred:0.02583582140505314, decouple_loss:0.014338340610265732
Iteration: 1533, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4439179301261902
loss_pred:0.02415609359741211, decouple_loss:0.012767357751727104
The generated pressure mean: 0.4481370747089386
loss_pred:0.02440819703042507, decouple_loss:0.012911246158182621
The generated pressure mean: 0.45109233260154724
loss_pred:0.023871256038546562, decouple_loss:0.012988016940653324
Iteration: 1534, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4614226520061493
loss_pred:0.024110442027449608, decouple_loss:0.012458226643502712
The generated pressure mean: 0.4563978612422943
loss_pred:0.02451149933040142, decouple_loss:0.012254524044692516
The generated pressure mean: 0.4588193893432617
loss_pred:0.023917024955153465, decouple_loss:0.012312585487961769
Iteration: 1535, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4407685399055481
loss_pred:0.0247608944773674, decouple_loss:0.011529369279742241
The generated pressure mean: 0.4395587742328644
loss_pred:0.025048283860087395, decouple_loss:0.011596916243433952
The generated pressure mean: 0.4437374472618103
loss_pred:0.025535305961966515, decouple_loss:0.011516891419887543
Iteration: 1536, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4436742961406708
loss_pred:0.024683650583028793, decouple_loss:0.011042107827961445
The generated pressure mean: 0.449115514755249
loss_pred:0.02535940334200859, decouple_loss:0.011054354719817638
The generated pressure mean: 0.45210525393486023
loss_pred:0.0250993762165308, decouple_loss:0.011061325669288635
Iteration: 1537, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4562832713127136
loss_pred:0.024548545479774475, decouple_loss:0.011849726550281048
The generated pressure mean: 0.451480507850647
loss_pred:0.02449733577668667, decouple_loss:0.011806340888142586
The generated pressure mean: 0.4540460705757141
loss_pred:0.024812133982777596, decouple_loss:0.011738656088709831
Iteration: 1538, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474850594997406
loss_pred:0.02473045513033867, decouple_loss:0.012603042647242546
The generated pressure mean: 0.4471023976802826
loss_pred:0.0259467251598835, decouple_loss:0.012524869292974472
The generated pressure mean: 0.45195335149765015
loss_pred:0.02486562915146351, decouple_loss:0.012382161803543568
Iteration: 1539, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4413054287433624
loss_pred:0.02514418214559555, decouple_loss:0.011753675527870655
The generated pressure mean: 0.4416421353816986
loss_pred:0.024388642981648445, decouple_loss:0.011547408066689968
The generated pressure mean: 0.4410492181777954
loss_pred:0.024898843839764595, decouple_loss:0.011477736756205559
Iteration: 1540, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45919162034988403
The generated pressure mean: 0.4573605954647064
loss_pred:0.025373641401529312, decouple_loss:0.010766703635454178
loss_pred:0.024709247052669525, decouple_loss:0.010701057501137257
The generated pressure mean: 0.4550165832042694
loss_pred:0.025921322405338287, decouple_loss:0.010815108194947243
2023-04-16 18:02:05 testing...
The generated pressure mean: 0.4159322679042816
The generated pressure mean: 0.4221762418746948
The generated pressure mean: 0.4243958294391632
loss_pred:0.03469237685203552, decouple_loss:0.012720432132482529
loss_pred:0.03360578790307045, decouple_loss:0.013040161691606045
loss_pred:0.03333764523267746, decouple_loss:0.013155083172023296
WV_0_PC_0_EH_1_PS_40, loss: 0.03452719748020172, avg_mse: 0.04567060247063637
current test mse: 0.045671
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 1541, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500349760055542
loss_pred:0.024991169571876526, decouple_loss:0.012498438358306885
The generated pressure mean: 0.44995778799057007
loss_pred:0.02546166442334652, decouple_loss:0.01236015371978283
The generated pressure mean: 0.4477861523628235
loss_pred:0.025933735072612762, decouple_loss:0.012471234425902367
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1542, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44583284854888916
The generated pressure mean: 0.4408957362174988
loss_pred:0.024658484384417534, decouple_loss:0.010919365100562572
loss_pred:0.024616725742816925, decouple_loss:0.010895393788814545
The generated pressure mean: 0.4382985532283783
loss_pred:0.025682786479592323, decouple_loss:0.010874121449887753
Iteration: 1543, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43930187821388245
loss_pred:0.025388607755303383, decouple_loss:0.01098906621336937
The generated pressure mean: 0.44497668743133545
loss_pred:0.023954303935170174, decouple_loss:0.01070897001773119
The generated pressure mean: 0.4405839741230011
loss_pred:0.026221824809908867, decouple_loss:0.010958286002278328
Iteration: 1544, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44623827934265137
The generated pressure mean: 0.45125991106033325
loss_pred:0.0254450011998415, decouple_loss:0.010752413421869278
loss_pred:0.023678753525018692, decouple_loss:0.010908035561442375
The generated pressure mean: 0.4527544677257538
loss_pred:0.024752430617809296, decouple_loss:0.010748176835477352
Iteration: 1545, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44906583428382874
The generated pressure mean: 0.44933274388313293
loss_pred:0.02557368017733097, decouple_loss:0.010397380217909813
loss_pred:0.023880524560809135, decouple_loss:0.010415628552436829
The generated pressure mean: 0.44794324040412903
loss_pred:0.025909844785928726, decouple_loss:0.01051427237689495
Iteration: 1546, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45390868186950684
The generated pressure mean: 0.448755145072937
loss_pred:0.02545081079006195, decouple_loss:0.010664214380085468
The generated pressure mean: 0.4459792971611023
loss_pred:0.024728303775191307, decouple_loss:0.010489800944924355
loss_pred:0.024449223652482033, decouple_loss:0.010435055010020733
Iteration: 1547, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4359433948993683
The generated pressure mean: 0.4333656430244446
loss_pred:0.024469757452607155, decouple_loss:0.013277255930006504
loss_pred:0.024086827412247658, decouple_loss:0.013289129361510277
The generated pressure mean: 0.4336937367916107
loss_pred:0.023830285295844078, decouple_loss:0.013111195527017117
Iteration: 1548, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4422111511230469
The generated pressure mean: 0.44691428542137146
loss_pred:0.025447698310017586, decouple_loss:0.013964429497718811
loss_pred:0.02468014694750309, decouple_loss:0.013921009376645088
The generated pressure mean: 0.4517359137535095
loss_pred:0.02565770223736763, decouple_loss:0.013949491083621979
Iteration: 1549, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4572874903678894
The generated pressure mean: 0.4496653378009796
loss_pred:0.02512698993086815, decouple_loss:0.012257062830030918
loss_pred:0.025541502982378006, decouple_loss:0.012212120927870274
The generated pressure mean: 0.4541719853878021
loss_pred:0.025441499426960945, decouple_loss:0.012239743955433369
Iteration: 1550, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45027434825897217
The generated pressure mean: 0.4511391520500183loss_pred:0.024051647633314133, decouple_loss:0.010877992026507854
loss_pred:0.02389131858944893, decouple_loss:0.010911991819739342
The generated pressure mean: 0.45280471444129944
loss_pred:0.024732407182455063, decouple_loss:0.01076649408787489
2023-04-16 18:04:38 testing...
The generated pressure mean: 0.41900834441185
The generated pressure mean: 0.4255460500717163
The generated pressure mean: 0.4279331564903259
loss_pred:0.03435109183192253, decouple_loss:0.012442254461348057
loss_pred:0.03330124169588089, decouple_loss:0.012736192904412746
loss_pred:0.032748859375715256, decouple_loss:0.012865004129707813
WV_0_PC_0_EH_1_PS_40, loss: 0.03410112112760544, avg_mse: 0.04524366557598114
current test mse: 0.045244
Iteration: 1551, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4395157992839813
loss_pred:0.024115798994898796, decouple_loss:0.011785095557570457
The generated pressure mean: 0.4367391765117645
loss_pred:0.025919385254383087, decouple_loss:0.011930042877793312
The generated pressure mean: 0.43984487652778625
loss_pred:0.02426682971417904, decouple_loss:0.011756060644984245
Iteration: 1552, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44559845328330994
loss_pred:0.024320805445313454, decouple_loss:0.013650829903781414
The generated pressure mean: 0.44823598861694336
loss_pred:0.024705901741981506, decouple_loss:0.013543445616960526
The generated pressure mean: 0.43846118450164795
loss_pred:0.02522284910082817, decouple_loss:0.013587946072220802
Iteration: 1553, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468245804309845The generated pressure mean: 0.44592490792274475
loss_pred:0.025620438158512115, decouple_loss:0.013078142888844013
loss_pred:0.0260312519967556, decouple_loss:0.013186144642531872
The generated pressure mean: 0.4407946765422821
loss_pred:0.024881314486265182, decouple_loss:0.012971092946827412
Iteration: 1554, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4457662105560303
The generated pressure mean: 0.44485947489738464
loss_pred:0.024387603625655174, decouple_loss:0.011617697775363922
loss_pred:0.02710026316344738, decouple_loss:0.011513911187648773
The generated pressure mean: 0.4413723647594452
loss_pred:0.023844068869948387, decouple_loss:0.011474564671516418
Iteration: 1555, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45128920674324036
The generated pressure mean: 0.4488968551158905
loss_pred:0.024979611858725548, decouple_loss:0.011193107813596725
loss_pred:0.02486446499824524, decouple_loss:0.01121197547763586
The generated pressure mean: 0.4506687521934509
loss_pred:0.025148456916213036, decouple_loss:0.011051656678318977
Iteration: 1556, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45302364230155945
The generated pressure mean: 0.4560777544975281
loss_pred:0.02547352947294712, decouple_loss:0.013494538143277168
loss_pred:0.02486496791243553, decouple_loss:0.013442447409033775
The generated pressure mean: 0.4524942636489868
loss_pred:0.026472901925444603, decouple_loss:0.013333086855709553
Iteration: 1557, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43748459219932556
The generated pressure mean: 0.4405279755592346
loss_pred:0.02411862090229988, decouple_loss:0.013244149275124073
loss_pred:0.02451988309621811, decouple_loss:0.013347855769097805
The generated pressure mean: 0.4374443590641022
loss_pred:0.023807426914572716, decouple_loss:0.013350963592529297
Iteration: 1558, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43412715196609497
loss_pred:0.02562190778553486, decouple_loss:0.0117952860891819
The generated pressure mean: 0.43094733357429504
loss_pred:0.02526765502989292, decouple_loss:0.011813926510512829
The generated pressure mean: 0.43252456188201904
loss_pred:0.025031697005033493, decouple_loss:0.011718371883034706
Iteration: 1559, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45837101340293884
loss_pred:0.026223408058285713, decouple_loss:0.010865193791687489
The generated pressure mean: 0.45868024230003357
loss_pred:0.02419138513505459, decouple_loss:0.011005713604390621
The generated pressure mean: 0.45641326904296875
loss_pred:0.025585278868675232, decouple_loss:0.010902362875640392
Iteration: 1560, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44346484541893005
loss_pred:0.025407999753952026, decouple_loss:0.011826814152300358
The generated pressure mean: 0.44243478775024414
loss_pred:0.025392431765794754, decouple_loss:0.011891425587236881
The generated pressure mean: 0.44354572892189026
loss_pred:0.025658296421170235, decouple_loss:0.011894816532731056
2023-04-16 18:06:31 testing...
The generated pressure mean: 0.41651177406311035
The generated pressure mean: 0.4229098856449127
The generated pressure mean: 0.425383061170578
loss_pred:0.034080155193805695, decouple_loss:0.013641699217259884
loss_pred:0.033101897686719894, decouple_loss:0.01400483213365078
loss_pred:0.032568104565143585, decouple_loss:0.014094376005232334
WV_0_PC_0_EH_1_PS_40, loss: 0.03394573554396629, avg_mse: 0.04458608850836754
current test mse: 0.044586
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 1561, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497002363204956
loss_pred:0.02518208511173725, decouple_loss:0.013102469965815544
The generated pressure mean: 0.44891878962516785
The generated pressure mean: 0.44996708631515503
loss_pred:0.023490477353334427, decouple_loss:0.01319776102900505
loss_pred:0.023070255294442177, decouple_loss:0.013178310357034206
Iteration: 1562, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4548291862010956
loss_pred:0.023043083027005196, decouple_loss:0.013668185099959373
The generated pressure mean: 0.4552319347858429
loss_pred:0.02347145602107048, decouple_loss:0.014006922021508217
The generated pressure mean: 0.451537549495697
loss_pred:0.02349821664392948, decouple_loss:0.014174800366163254
Iteration: 1563, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4564010500907898
loss_pred:0.02274329587817192, decouple_loss:0.013111869804561138
The generated pressure mean: 0.45580947399139404
loss_pred:0.02308191917836666, decouple_loss:0.01314964797347784
The generated pressure mean: 0.45623213052749634
loss_pred:0.02481808513402939, decouple_loss:0.012977590784430504
Iteration: 1564, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4391239583492279
loss_pred:0.02489703893661499, decouple_loss:0.01216989103704691
The generated pressure mean: 0.4447886049747467
loss_pred:0.02348325587809086, decouple_loss:0.012338838540017605
The generated pressure mean: 0.44112107157707214
loss_pred:0.024838950484991074, decouple_loss:0.012201298959553242
Iteration: 1565, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.440177321434021
loss_pred:0.025128813460469246, decouple_loss:0.012933720834553242
The generated pressure mean: 0.4411042630672455
loss_pred:0.022935615852475166, decouple_loss:0.012836817651987076
The generated pressure mean: 0.44558921456336975
loss_pred:0.024153342470526695, decouple_loss:0.013025255873799324
Iteration: 1566, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.443886399269104
loss_pred:0.02374008297920227, decouple_loss:0.011870733462274075
The generated pressure mean: 0.4524669349193573
loss_pred:0.022808587178587914, decouple_loss:0.01226116344332695
The generated pressure mean: 0.45110103487968445
loss_pred:0.02401522360742092, decouple_loss:0.012152884155511856
Iteration: 1567, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4535181224346161
loss_pred:0.024324921891093254, decouple_loss:0.011484984308481216
The generated pressure mean: 0.4524001181125641
loss_pred:0.023436367511749268, decouple_loss:0.011560584418475628
The generated pressure mean: 0.45385000109672546
loss_pred:0.02385574020445347, decouple_loss:0.011738617904484272
Iteration: 1568, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44710642099380493
The generated pressure mean: 0.4518302083015442
loss_pred:0.02194177359342575, decouple_loss:0.012091255746781826
loss_pred:0.023730477318167686, decouple_loss:0.011907782405614853
The generated pressure mean: 0.4457107186317444
loss_pred:0.02260321006178856, decouple_loss:0.012021821923553944
Iteration: 1569, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44879150390625
The generated pressure mean: 0.45146644115448
loss_pred:0.024155814200639725, decouple_loss:0.011879545636475086
loss_pred:0.02284475602209568, decouple_loss:0.012024624273180962
The generated pressure mean: 0.4504125714302063
loss_pred:0.02348715253174305, decouple_loss:0.011927085928618908
Iteration: 1570, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45001158118247986
loss_pred:0.023591239005327225, decouple_loss:0.0121269840747118
The generated pressure mean: 0.4421297609806061
loss_pred:0.02285274676978588, decouple_loss:0.012017462402582169
The generated pressure mean: 0.447486013174057
loss_pred:0.02321465127170086, decouple_loss:0.012108147144317627
2023-04-16 18:09:06 testing...
The generated pressure mean: 0.41806480288505554
The generated pressure mean: 0.4261572062969208
The generated pressure mean: 0.42902013659477234
loss_pred:0.03607412427663803, decouple_loss:0.01118277944624424
loss_pred:0.03467586264014244, decouple_loss:0.011390434578061104
loss_pred:0.034303728491067886, decouple_loss:0.011510432697832584
WV_0_PC_0_EH_1_PS_40, loss: 0.03558596596121788, avg_mse: 0.04869706556200981
current test mse: 0.048697
Iteration: 1571, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44030052423477173
loss_pred:0.024402031674981117, decouple_loss:0.010600556619465351
The generated pressure mean: 0.4488443434238434
loss_pred:0.023718219250440598, decouple_loss:0.010815653018653393
The generated pressure mean: 0.44840580224990845
loss_pred:0.02215082012116909, decouple_loss:0.010670894756913185
Iteration: 1572, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44951167702674866
loss_pred:0.024307262152433395, decouple_loss:0.01118948683142662
The generated pressure mean: 0.4471866190433502
loss_pred:0.02376662939786911, decouple_loss:0.011427845805883408
The generated pressure mean: 0.4475461542606354
loss_pred:0.02380988933146, decouple_loss:0.011096334084868431
Iteration: 1573, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45594581961631775
loss_pred:0.024278810247778893, decouple_loss:0.012891631573438644
The generated pressure mean: 0.454645037651062
loss_pred:0.021081481128931046, decouple_loss:0.013024285435676575
The generated pressure mean: 0.45625513792037964
loss_pred:0.023289360105991364, decouple_loss:0.012761369347572327
Iteration: 1574, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45620307326316833
The generated pressure mean: 0.4497164785861969
loss_pred:0.02361222729086876, decouple_loss:0.012004228308796883
loss_pred:0.02384394407272339, decouple_loss:0.012061266228556633
The generated pressure mean: 0.4544433057308197
loss_pred:0.02338419109582901, decouple_loss:0.011951258406043053
Iteration: 1575, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44312673807144165
loss_pred:0.0230976864695549, decouple_loss:0.010777786374092102
The generated pressure mean: 0.4378082752227783
loss_pred:0.02442798763513565, decouple_loss:0.01112378854304552
The generated pressure mean: 0.44151070713996887
loss_pred:0.02361864410340786, decouple_loss:0.010785965248942375
Iteration: 1576, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43958762288093567
loss_pred:0.022728050127625465, decouple_loss:0.011077268980443478
The generated pressure mean: 0.4460856020450592
loss_pred:0.022900667041540146, decouple_loss:0.011445797979831696
The generated pressure mean: 0.44697171449661255
loss_pred:0.023469574749469757, decouple_loss:0.011503987945616245
Iteration: 1577, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44965821504592896
loss_pred:0.0239325650036335, decouple_loss:0.012693574652075768
The generated pressure mean: 0.44811129570007324
loss_pred:0.02304542437195778, decouple_loss:0.012678807601332664
The generated pressure mean: 0.4494439661502838
loss_pred:0.02386588230729103, decouple_loss:0.012630196288228035
Iteration: 1578, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44981294870376587
loss_pred:0.023220475763082504, decouple_loss:0.011733814142644405
The generated pressure mean: 0.4484185576438904
loss_pred:0.023796768859028816, decouple_loss:0.011810753494501114
The generated pressure mean: 0.45090344548225403
loss_pred:0.0236185435205698, decouple_loss:0.011990348808467388
Iteration: 1579, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4549688994884491
loss_pred:0.023270202800631523, decouple_loss:0.011280578561127186
The generated pressure mean: 0.4513595998287201
loss_pred:0.02331423945724964, decouple_loss:0.011548242531716824
The generated pressure mean: 0.4519141614437103
loss_pred:0.02292494662106037, decouple_loss:0.011539669707417488
Iteration: 1580, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449653625488281
loss_pred:0.02404043637216091, decouple_loss:0.011278829537332058
The generated pressure mean: 0.44772869348526
loss_pred:0.02308005280792713, decouple_loss:0.01135346945375204
The generated pressure mean: 0.44015341997146606
loss_pred:0.023384949192404747, decouple_loss:0.011398851871490479
2023-04-16 18:10:59 testing...
The generated pressure mean: 0.4164385497570038
The generated pressure mean: 0.4242171347141266
loss_pred:0.03489276021718979, decouple_loss:0.01144256442785263
The generated pressure mean: 0.4264567196369171
loss_pred:0.03365110233426094, decouple_loss:0.011696581728756428
loss_pred:0.03311092406511307, decouple_loss:0.011896713636815548
WV_0_PC_0_EH_1_PS_40, loss: 0.034468863159418106, avg_mse: 0.04659092798829079
current test mse: 0.046591
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 1581, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44716712832450867
loss_pred:0.02428317815065384, decouple_loss:0.011322720907628536
The generated pressure mean: 0.45503711700439453
loss_pred:0.024723229929804802, decouple_loss:0.011090974323451519
The generated pressure mean: 0.45227107405662537
loss_pred:0.02350788190960884, decouple_loss:0.011041532270610332
Iteration: 1582, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44436654448509216
The generated pressure mean: 0.4401840567588806
loss_pred:0.024508481845259666, decouple_loss:0.011220459826290607
loss_pred:0.023194290697574615, decouple_loss:0.011153421364724636
The generated pressure mean: 0.4511595666408539
loss_pred:0.024407923221588135, decouple_loss:0.011057106778025627
Iteration: 1583, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44331833720207214
The generated pressure mean: 0.4471609890460968
loss_pred:0.025385631248354912, decouple_loss:0.01149122603237629
loss_pred:0.02323971875011921, decouple_loss:0.011312086135149002
The generated pressure mean: 0.4520796537399292
loss_pred:0.025248009711503983, decouple_loss:0.011420072056353092
Iteration: 1584, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44963768124580383
The generated pressure mean: 0.4540668725967407
loss_pred:0.024553468450903893, decouple_loss:0.010685949586331844
loss_pred:0.024524971842765808, decouple_loss:0.010797500610351562
The generated pressure mean: 0.4478282332420349
loss_pred:0.02431420050561428, decouple_loss:0.010986936278641224
Iteration: 1585, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44600746035575867
loss_pred:0.023144088685512543, decouple_loss:0.010775030590593815
The generated pressure mean: 0.451015830039978
loss_pred:0.02437441237270832, decouple_loss:0.010790626518428326
The generated pressure mean: 0.45639291405677795
loss_pred:0.025760900229215622, decouple_loss:0.01142717245966196
Iteration: 1586, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44263702630996704
The generated pressure mean: 0.4355020523071289
loss_pred:0.02500731311738491, decouple_loss:0.010441001504659653
loss_pred:0.0240639578551054, decouple_loss:0.010663737542927265
The generated pressure mean: 0.4346071779727936
loss_pred:0.024382252246141434, decouple_loss:0.01063812617212534
Iteration: 1587, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45260006189346313
The generated pressure mean: 0.4468775987625122
loss_pred:0.024226894602179527, decouple_loss:0.010322163812816143
loss_pred:0.023322289809584618, decouple_loss:0.010201015509665012
The generated pressure mean: 0.45428118109703064
loss_pred:0.023799370974302292, decouple_loss:0.010220587253570557
Iteration: 1588, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4581396281719208
loss_pred:0.024456944316625595, decouple_loss:0.011072029359638691
The generated pressure mean: 0.45045098662376404
loss_pred:0.024277059361338615, decouple_loss:0.010872473940253258
The generated pressure mean: 0.45370182394981384
loss_pred:0.024409517645835876, decouple_loss:0.011105370707809925
Iteration: 1589, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45333564281463623
loss_pred:0.024703534319996834, decouple_loss:0.010989087633788586
The generated pressure mean: 0.4447063207626343
loss_pred:0.025478338822722435, decouple_loss:0.01118769496679306
The generated pressure mean: 0.44738149642944336
loss_pred:0.024061398580670357, decouple_loss:0.011122971773147583
Iteration: 1590, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4534958004951477
The generated pressure mean: 0.45362457633018494
loss_pred:0.02274486981332302, decouple_loss:0.01095436979085207
loss_pred:0.024493778124451637, decouple_loss:0.010947196744382381
The generated pressure mean: 0.4458490312099457
loss_pred:0.02490628883242607, decouple_loss:0.011053581722080708
2023-04-16 18:13:29 testing...
The generated pressure mean: 0.41922327876091003
The generated pressure mean: 0.4271899461746216
loss_pred:0.03536972403526306, decouple_loss:0.01194804534316063
The generated pressure mean: 0.42997419834136963
loss_pred:0.03442749008536339, decouple_loss:0.012047018855810165
loss_pred:0.03346136212348938, decouple_loss:0.012315915897488594
WV_0_PC_0_EH_1_PS_40, loss: 0.03502470999956131, avg_mse: 0.04801499471068382
current test mse: 0.048015
Iteration: 1591, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4435092508792877
The generated pressure mean: 0.4450790584087372
loss_pred:0.02369660884141922, decouple_loss:0.011468222364783287
loss_pred:0.0231182724237442, decouple_loss:0.011581311002373695
The generated pressure mean: 0.4448871314525604
loss_pred:0.023347096517682076, decouple_loss:0.011173614300787449
Iteration: 1592, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4437863826751709
The generated pressure mean: 0.4400283396244049
loss_pred:0.024372145533561707, decouple_loss:0.011462930589914322
loss_pred:0.02475295029580593, decouple_loss:0.011422839015722275
The generated pressure mean: 0.45139190554618835
loss_pred:0.02484305202960968, decouple_loss:0.01153457909822464
Iteration: 1593, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4371385872364044
The generated pressure mean: 0.4391805827617645
loss_pred:0.023729732260107994, decouple_loss:0.01094043254852295
loss_pred:0.02320029027760029, decouple_loss:0.010926967486739159
The generated pressure mean: 0.4455049932003021
loss_pred:0.024263830855488777, decouple_loss:0.010924480855464935
Iteration: 1594, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449552893638611
The generated pressure mean: 0.4436149001121521
loss_pred:0.023930473253130913, decouple_loss:0.010278789326548576
loss_pred:0.0245900247246027, decouple_loss:0.010226191021502018
The generated pressure mean: 0.4488310217857361
loss_pred:0.023302732035517693, decouple_loss:0.010173385962843895
Iteration: 1595, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.472204327583313
The generated pressure mean: 0.4717271327972412
loss_pred:0.023871537297964096, decouple_loss:0.010898444801568985
loss_pred:0.024534134194254875, decouple_loss:0.010765514336526394
The generated pressure mean: 0.46998026967048645
loss_pred:0.024433797225356102, decouple_loss:0.010926201939582825
Iteration: 1596, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44823387265205383
The generated pressure mean: 0.4481980800628662
loss_pred:0.02322644740343094, decouple_loss:0.011570950038731098
loss_pred:0.02357735112309456, decouple_loss:0.011600201949477196
The generated pressure mean: 0.4494125247001648
loss_pred:0.023423200473189354, decouple_loss:0.011725224554538727
Iteration: 1597, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43873339891433716
The generated pressure mean: 0.4295002818107605
loss_pred:0.024137835949659348, decouple_loss:0.011669661849737167
loss_pred:0.02407422475516796, decouple_loss:0.0115943169221282
The generated pressure mean: 0.43234315514564514
loss_pred:0.025099964812397957, decouple_loss:0.011649533174932003
Iteration: 1598, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4526498317718506
The generated pressure mean: 0.45381617546081543
loss_pred:0.02461790107190609, decouple_loss:0.011693289503455162
loss_pred:0.02376982942223549, decouple_loss:0.011627531610429287
The generated pressure mean: 0.4411020874977112
loss_pred:0.02423451840877533, decouple_loss:0.011869333684444427
Iteration: 1599, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508969783782959
loss_pred:0.024417905136942863, decouple_loss:0.012543785385787487
The generated pressure mean: 0.45843684673309326
loss_pred:0.02437719702720642, decouple_loss:0.012402729131281376
The generated pressure mean: 0.4551788866519928
loss_pred:0.025355452671647072, decouple_loss:0.012661145068705082
Iteration: 1600, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44577884674072266
The generated pressure mean: 0.44164183735847473
loss_pred:0.02459963783621788, decouple_loss:0.012052548117935658
loss_pred:0.024774717167019844, decouple_loss:0.012094289064407349
The generated pressure mean: 0.44615626335144043
loss_pred:0.024202508851885796, decouple_loss:0.011957071721553802
2023-04-16 18:15:22 testing...
The generated pressure mean: 0.41801100969314575
The generated pressure mean: 0.424653023481369
The generated pressure mean: 0.42774254083633423
loss_pred:0.03481706976890564, decouple_loss:0.013213824480772018
loss_pred:0.033929113298654556, decouple_loss:0.013597573153674603
loss_pred:0.03312266245484352, decouple_loss:0.013835563324391842
WV_0_PC_0_EH_1_PS_40, loss: 0.034633733332157135, avg_mse: 0.04656879976391792
current test mse: 0.046569
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 1601, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44035470485687256
loss_pred:0.022811003029346466, decouple_loss:0.012588069774210453
The generated pressure mean: 0.4507441222667694
loss_pred:0.024800781160593033, decouple_loss:0.012936102226376534
The generated pressure mean: 0.4450969696044922
loss_pred:0.025320500135421753, decouple_loss:0.012661674991250038
Iteration: 1602, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4606747627258301
The generated pressure mean: 0.45785853266716003
loss_pred:0.022900016978383064, decouple_loss:0.012912324629724026
loss_pred:0.02378772385418415, decouple_loss:0.013039804063737392
The generated pressure mean: 0.4572902023792267
loss_pred:0.02269499935209751, decouple_loss:0.013053794391453266
Iteration: 1603, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448701411485672
loss_pred:0.022293545305728912, decouple_loss:0.010886488482356071
The generated pressure mean: 0.4536239206790924
loss_pred:0.02255544438958168, decouple_loss:0.011073203757405281
The generated pressure mean: 0.4443805515766144
loss_pred:0.02568124793469906, decouple_loss:0.011190195567905903
Iteration: 1604, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43587931990623474
loss_pred:0.02426542341709137, decouple_loss:0.011707465164363384
The generated pressure mean: 0.43760737776756287
loss_pred:0.02391076274216175, decouple_loss:0.011567618697881699
The generated pressure mean: 0.4356186091899872
loss_pred:0.023892072960734367, decouple_loss:0.011668331921100616
Iteration: 1605, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44548943638801575
The generated pressure mean: 0.44486716389656067
loss_pred:0.024614481255412102, decouple_loss:0.011937037110328674
loss_pred:0.024579230695962906, decouple_loss:0.012192321009933949
The generated pressure mean: 0.4466593861579895
loss_pred:0.024013236165046692, decouple_loss:0.011829058639705181
Iteration: 1606, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45568206906318665
loss_pred:0.02276683785021305, decouple_loss:0.011550799012184143
The generated pressure mean: 0.4506405293941498
loss_pred:0.023147443309426308, decouple_loss:0.01161143183708191
The generated pressure mean: 0.45353108644485474
loss_pred:0.023432234302163124, decouple_loss:0.011608853004872799
Iteration: 1607, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44928011298179626
loss_pred:0.023613637313246727, decouple_loss:0.011021075770258904
The generated pressure mean: 0.4528285264968872
loss_pred:0.02311107888817787, decouple_loss:0.010981809347867966
The generated pressure mean: 0.45164209604263306
loss_pred:0.02333533577620983, decouple_loss:0.011285081505775452
Iteration: 1608, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4373912513256073
loss_pred:0.023948460817337036, decouple_loss:0.011241555213928223
The generated pressure mean: 0.43761518597602844
loss_pred:0.022212062031030655, decouple_loss:0.011112561449408531
The generated pressure mean: 0.44066646695137024
loss_pred:0.023172562941908836, decouple_loss:0.011161102913320065
Iteration: 1609, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44624975323677063
loss_pred:0.024124760180711746, decouple_loss:0.01149762887507677
The generated pressure mean: 0.4458640515804291
loss_pred:0.02378128282725811, decouple_loss:0.011826960369944572
The generated pressure mean: 0.44915494322776794
loss_pred:0.025069935247302055, decouple_loss:0.01178429089486599
Iteration: 1610, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45512211322784424The generated pressure mean: 0.4562279284000397
loss_pred:0.023489445447921753, decouple_loss:0.011671390384435654loss_pred:0.024516882374882698, decouple_loss:0.011671376414597034
The generated pressure mean: 0.4525975286960602
loss_pred:0.023031003773212433, decouple_loss:0.01152096502482891
2023-04-16 18:17:56 testing...
The generated pressure mean: 0.41732925176620483
The generated pressure mean: 0.42412257194519043
loss_pred:0.035437751561403275, decouple_loss:0.012254128232598305
The generated pressure mean: 0.4271629750728607
loss_pred:0.03433838114142418, decouple_loss:0.012548910453915596
loss_pred:0.03372867405414581, decouple_loss:0.01279984600841999
WV_0_PC_0_EH_1_PS_40, loss: 0.03512831777334213, avg_mse: 0.04757531359791756
current test mse: 0.047575
Iteration: 1611, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496104419231415
The generated pressure mean: 0.44701144099235535
loss_pred:0.0232657790184021, decouple_loss:0.011563386768102646
loss_pred:0.023222357034683228, decouple_loss:0.012101350352168083
The generated pressure mean: 0.44886985421180725
loss_pred:0.024478144943714142, decouple_loss:0.011582589708268642
Iteration: 1612, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4443511664867401
The generated pressure mean: 0.4402959644794464
loss_pred:0.02350352518260479, decouple_loss:0.011613517999649048
loss_pred:0.022137656807899475, decouple_loss:0.011609300039708614
The generated pressure mean: 0.4399515688419342
loss_pred:0.024176333099603653, decouple_loss:0.011701337061822414
Iteration: 1613, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44318270683288574The generated pressure mean: 0.44085875153541565
loss_pred:0.023549040779471397, decouple_loss:0.011168304830789566
loss_pred:0.02321433834731579, decouple_loss:0.011775435879826546
The generated pressure mean: 0.44723430275917053
loss_pred:0.022872423753142357, decouple_loss:0.011333365924656391
Iteration: 1614, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4532732665538788
loss_pred:0.023922163993120193, decouple_loss:0.011994852684438229
The generated pressure mean: 0.4617392420768738
loss_pred:0.023156704381108284, decouple_loss:0.012012028135359287
The generated pressure mean: 0.46154487133026123
loss_pred:0.022546738386154175, decouple_loss:0.01152984332293272
Iteration: 1615, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.444588840007782
loss_pred:0.023571375757455826, decouple_loss:0.012778416275978088
The generated pressure mean: 0.4503096342086792
loss_pred:0.023710614070296288, decouple_loss:0.012512640096247196
The generated pressure mean: 0.44340476393699646
loss_pred:0.023371512070298195, decouple_loss:0.012640448287129402
Iteration: 1616, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.437782883644104
loss_pred:0.02413334511220455, decouple_loss:0.01245975960046053
The generated pressure mean: 0.44085806608200073
loss_pred:0.024123165756464005, decouple_loss:0.012299886904656887
The generated pressure mean: 0.4396120309829712
loss_pred:0.024720467627048492, decouple_loss:0.01234227605164051
Iteration: 1617, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44628870487213135
The generated pressure mean: 0.44973963499069214
loss_pred:0.024089312180876732, decouple_loss:0.011643150821328163
loss_pred:0.024319365620613098, decouple_loss:0.011710649356245995
The generated pressure mean: 0.4469645619392395
loss_pred:0.02369358390569687, decouple_loss:0.01163905207067728
Iteration: 1618, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4513086974620819
The generated pressure mean: 0.44795820116996765
loss_pred:0.024607036262750626, decouple_loss:0.011362392455339432
loss_pred:0.023796172812581062, decouple_loss:0.011375331319868565
The generated pressure mean: 0.44930344820022583
loss_pred:0.024773044511675835, decouple_loss:0.01135925017297268
Iteration: 1619, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44963759183883667
loss_pred:0.022729165852069855, decouple_loss:0.011108595877885818
The generated pressure mean: 0.4435059726238251
loss_pred:0.023360274732112885, decouple_loss:0.010949715040624142
The generated pressure mean: 0.4475992023944855
loss_pred:0.023555098101496696, decouple_loss:0.011235756799578667
Iteration: 1620, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45020556449890137
loss_pred:0.023258235305547714, decouple_loss:0.010671361349523067
The generated pressure mean: 0.44797414541244507
loss_pred:0.022795045748353004, decouple_loss:0.010497280396521091
The generated pressure mean: 0.44249406456947327
loss_pred:0.023459417745471, decouple_loss:0.010423202998936176
2023-04-16 18:19:49 testing...
The generated pressure mean: 0.4173688590526581
The generated pressure mean: 0.4241564869880676
loss_pred:0.034500181674957275, decouple_loss:0.01120220310986042
The generated pressure mean: 0.4266696274280548
loss_pred:0.033166393637657166, decouple_loss:0.011474999599158764
loss_pred:0.03293246403336525, decouple_loss:0.011636254377663136
WV_0_PC_0_EH_1_PS_40, loss: 0.034104906022548676, avg_mse: 0.04563477635383606
current test mse: 0.045635
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 1621, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44324350357055664
loss_pred:0.02317718416452408, decouple_loss:0.010992160066962242
The generated pressure mean: 0.4553028345108032
loss_pred:0.024417132139205933, decouple_loss:0.011108405888080597
The generated pressure mean: 0.448254257440567
loss_pred:0.022638455033302307, decouple_loss:0.010943826287984848
Iteration: 1622, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4447315037250519
loss_pred:0.024241361767053604, decouple_loss:0.01119866780936718
The generated pressure mean: 0.4438309371471405
loss_pred:0.023923370987176895, decouple_loss:0.011044339276850224
The generated pressure mean: 0.43677058815956116
loss_pred:0.026239115744829178, decouple_loss:0.011298700235784054
Iteration: 1623, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44779014587402344
The generated pressure mean: 0.4404841661453247
loss_pred:0.023591522127389908, decouple_loss:0.012278479523956776
loss_pred:0.0234893299639225, decouple_loss:0.012563121505081654
The generated pressure mean: 0.4486539661884308
loss_pred:0.02295088954269886, decouple_loss:0.012352182529866695
Iteration: 1624, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44425106048583984
The generated pressure mean: 0.4480750262737274
loss_pred:0.023835202679038048, decouple_loss:0.012001262977719307
loss_pred:0.02381499484181404, decouple_loss:0.012118402868509293
The generated pressure mean: 0.4393695890903473
loss_pred:0.024070899933576584, decouple_loss:0.012186236679553986
Iteration: 1625, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.451495498418808
The generated pressure mean: 0.44607919454574585
loss_pred:0.02313307672739029, decouple_loss:0.011095177382230759
loss_pred:0.022812753915786743, decouple_loss:0.011015019379556179
The generated pressure mean: 0.4475168287754059
loss_pred:0.025922229513525963, decouple_loss:0.010933104902505875
Iteration: 1626, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44900044798851013
loss_pred:0.022562244907021523, decouple_loss:0.012133919633924961
The generated pressure mean: 0.4427698254585266
loss_pred:0.023282604292035103, decouple_loss:0.012078513391315937
The generated pressure mean: 0.4428249001502991
loss_pred:0.02451196126639843, decouple_loss:0.012147773988544941
Iteration: 1627, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45189109444618225
loss_pred:0.024340592324733734, decouple_loss:0.013978082686662674
The generated pressure mean: 0.44874852895736694
loss_pred:0.02442515455186367, decouple_loss:0.013999649323523045
The generated pressure mean: 0.4440849721431732
loss_pred:0.02336777187883854, decouple_loss:0.013964759185910225
Iteration: 1628, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44601672887802124
loss_pred:0.023944761604070663, decouple_loss:0.013170327991247177
The generated pressure mean: 0.4431675374507904
loss_pred:0.024259252473711967, decouple_loss:0.012990593910217285
The generated pressure mean: 0.44373902678489685
loss_pred:0.023599082604050636, decouple_loss:0.012891063466668129
Iteration: 1629, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449223279953003
The generated pressure mean: 0.4429134428501129
loss_pred:0.022845586761832237, decouple_loss:0.011382357217371464
loss_pred:0.023133534938097, decouple_loss:0.011272290721535683
The generated pressure mean: 0.44603100419044495
loss_pred:0.02369055338203907, decouple_loss:0.01138317584991455
Iteration: 1630, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44523659348487854
loss_pred:0.02422189712524414, decouple_loss:0.010597269982099533
The generated pressure mean: 0.4468781650066376
loss_pred:0.022367611527442932, decouple_loss:0.010642971843481064
The generated pressure mean: 0.44705528020858765
loss_pred:0.024882303550839424, decouple_loss:0.01046236976981163
2023-04-16 18:22:22 testing...
The generated pressure mean: 0.41689935326576233
The generated pressure mean: 0.4238053858280182
loss_pred:0.03401379659771919, decouple_loss:0.011906543746590614
The generated pressure mean: 0.4261683523654938
loss_pred:0.03307564556598663, decouple_loss:0.012223976664245129
loss_pred:0.03231384605169296, decouple_loss:0.012291849590837955
WV_0_PC_0_EH_1_PS_40, loss: 0.03374147042632103, avg_mse: 0.045043256133794785
current test mse: 0.045043
Iteration: 1631, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44883859157562256
loss_pred:0.02360268123447895, decouple_loss:0.011352021247148514
The generated pressure mean: 0.44727420806884766
loss_pred:0.024459604173898697, decouple_loss:0.01130157895386219
The generated pressure mean: 0.44507429003715515
loss_pred:0.024161722511053085, decouple_loss:0.01119113340973854
Iteration: 1632, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4521903991699219
loss_pred:0.023405104875564575, decouple_loss:0.011013144627213478
The generated pressure mean: 0.4480838179588318
loss_pred:0.02425660565495491, decouple_loss:0.010977798141539097
The generated pressure mean: 0.44482704997062683
loss_pred:0.025092920288443565, decouple_loss:0.010966498404741287
Iteration: 1633, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4438173770904541
loss_pred:0.024349762126803398, decouple_loss:0.01302332803606987
The generated pressure mean: 0.43700873851776123
loss_pred:0.024457845836877823, decouple_loss:0.012953986413776875
The generated pressure mean: 0.4331181049346924
loss_pred:0.02410692349076271, decouple_loss:0.013148762285709381
Iteration: 1634, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44574078917503357
The generated pressure mean: 0.44758227467536926
loss_pred:0.02273057959973812, decouple_loss:0.012663018889725208
loss_pred:0.024739930406212807, decouple_loss:0.012718826532363892
The generated pressure mean: 0.444195955991745
loss_pred:0.02485564723610878, decouple_loss:0.012684722431004047
Iteration: 1635, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4707670211791992
The generated pressure mean: 0.4629943370819092
loss_pred:0.02931179478764534, decouple_loss:0.012224582955241203
loss_pred:0.02372259832918644, decouple_loss:0.01215575821697712
The generated pressure mean: 0.45997604727745056
loss_pred:0.0261027030646801, decouple_loss:0.012347512878477573
Iteration: 1636, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.3854900598526001
The generated pressure mean: 0.3863655924797058
loss_pred:0.026389963924884796, decouple_loss:0.012492882087826729
loss_pred:0.027873339131474495, decouple_loss:0.012514960952103138
The generated pressure mean: 0.38696587085723877
loss_pred:0.02637372352182865, decouple_loss:0.012367596849799156
Iteration: 1637, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43397748470306396
The generated pressure mean: 0.4344478249549866
loss_pred:0.02525293454527855, decouple_loss:0.012762891128659248
loss_pred:0.027970509603619576, decouple_loss:0.012711204588413239
The generated pressure mean: 0.4400525391101837
loss_pred:0.02595849707722664, decouple_loss:0.012649225071072578
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1638, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.5197588205337524
loss_pred:0.026135152205824852, decouple_loss:0.013576525263488293
The generated pressure mean: 0.5186482071876526
loss_pred:0.02670333907008171, decouple_loss:0.013651017099618912
The generated pressure mean: 0.5170661807060242
loss_pred:0.02714628539979458, decouple_loss:0.013601703569293022
Iteration: 1639, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47218185663223267
loss_pred:0.025921234861016273, decouple_loss:0.013982024975121021
The generated pressure mean: 0.47216880321502686The generated pressure mean: 0.47021278738975525
loss_pred:0.024976249784231186, decouple_loss:0.014103472232818604
loss_pred:0.023687681183218956, decouple_loss:0.014102339744567871
Iteration: 1640, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.3849354386329651
loss_pred:0.027012726292014122, decouple_loss:0.015984976664185524
The generated pressure mean: 0.3867003321647644
loss_pred:0.028570257127285004, decouple_loss:0.015948478132486343
The generated pressure mean: 0.38487645983695984
loss_pred:0.026903392747044563, decouple_loss:0.01583230495452881
2023-04-16 18:24:15 testing...
The generated pressure mean: 0.41800758242607117
The generated pressure mean: 0.42371952533721924
The generated pressure mean: 0.42660894989967346
loss_pred:0.04109053686261177, decouple_loss:0.016725804656744003
loss_pred:0.04026699811220169, decouple_loss:0.017011204734444618
loss_pred:0.03938565403223038, decouple_loss:0.017145201563835144
WV_0_PC_0_EH_1_PS_40, loss: 0.04109577089548111, avg_mse: 0.05842463672161102
current test mse: 0.058425
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 1641, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43646350502967834
loss_pred:0.024930234998464584, decouple_loss:0.016214225441217422
The generated pressure mean: 0.439268559217453
loss_pred:0.024955807253718376, decouple_loss:0.016402311623096466
The generated pressure mean: 0.4393939673900604
loss_pred:0.024513062089681625, decouple_loss:0.016265101730823517
Iteration: 1642, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47970351576805115
The generated pressure mean: 0.4781782329082489
loss_pred:0.02646997943520546, decouple_loss:0.01677839830517769
loss_pred:0.02535942569375038, decouple_loss:0.016731269657611847
The generated pressure mean: 0.47586995363235474
loss_pred:0.024823222309350967, decouple_loss:0.01671602763235569
Iteration: 1643, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460078477859497The generated pressure mean: 0.4476717412471771
loss_pred:0.025917643681168556, decouple_loss:0.016503483057022095loss_pred:0.025773411616683006, decouple_loss:0.016484364867210388
The generated pressure mean: 0.4502822160720825
loss_pred:0.024732623249292374, decouple_loss:0.01651129312813282
Iteration: 1644, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4225532114505768
The generated pressure mean: 0.42430832982063293
loss_pred:0.026112383231520653, decouple_loss:0.017279010266065598
loss_pred:0.02594539150595665, decouple_loss:0.017307231202721596
The generated pressure mean: 0.421220064163208
loss_pred:0.02429681085050106, decouple_loss:0.01725195348262787
Iteration: 1645, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45546573400497437The generated pressure mean: 0.45732229948043823
loss_pred:0.02364150807261467, decouple_loss:0.01553383469581604
loss_pred:0.024408437311649323, decouple_loss:0.015576188452541828
The generated pressure mean: 0.4579019844532013
loss_pred:0.026227658614516258, decouple_loss:0.01567307487130165
Iteration: 1646, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4640515148639679
The generated pressure mean: 0.46089327335357666
loss_pred:0.025290118530392647, decouple_loss:0.015788456425070763
loss_pred:0.02400379255414009, decouple_loss:0.015604117885231972
The generated pressure mean: 0.46628063917160034
loss_pred:0.024577341973781586, decouple_loss:0.01580609194934368
Iteration: 1647, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44590744376182556
The generated pressure mean: 0.44669508934020996
loss_pred:0.023844806477427483, decouple_loss:0.014611493796110153
loss_pred:0.025218339636921883, decouple_loss:0.014564815908670425
The generated pressure mean: 0.44071686267852783
loss_pred:0.02428286522626877, decouple_loss:0.014438294805586338
Iteration: 1648, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4338538646697998
loss_pred:0.02441890724003315, decouple_loss:0.014138419181108475
The generated pressure mean: 0.4363692104816437
loss_pred:0.022924533113837242, decouple_loss:0.014134231954813004
The generated pressure mean: 0.42920660972595215
loss_pred:0.023759393021464348, decouple_loss:0.01402368675917387
Iteration: 1649, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4431060552597046
loss_pred:0.02389940433204174, decouple_loss:0.014342606998980045
The generated pressure mean: 0.44828277826309204
loss_pred:0.023039979860186577, decouple_loss:0.014375828206539154
The generated pressure mean: 0.44648388028144836
loss_pred:0.02538401447236538, decouple_loss:0.014393134042620659
Iteration: 1650, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45880529284477234
The generated pressure mean: 0.4571223258972168
loss_pred:0.025377992540597916, decouple_loss:0.013127798214554787
loss_pred:0.024481192231178284, decouple_loss:0.01326661091297865
The generated pressure mean: 0.4549487233161926
loss_pred:0.02505524270236492, decouple_loss:0.013243080116808414
2023-04-16 18:26:45 testing...
The generated pressure mean: 0.42563679814338684
The generated pressure mean: 0.41920050978660583
The generated pressure mean: 0.4282579720020294
loss_pred:0.03455410152673721, decouple_loss:0.013911678455770016
loss_pred:0.035567499697208405, decouple_loss:0.013630356639623642
loss_pred:0.033879734575748444, decouple_loss:0.014133390970528126
WV_0_PC_0_EH_1_PS_40, loss: 0.03536170348525047, avg_mse: 0.047938209027051926
current test mse: 0.047938
Iteration: 1651, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4437359869480133
The generated pressure mean: 0.44400280714035034
loss_pred:0.023805741220712662, decouple_loss:0.012847565114498138
loss_pred:0.023296523839235306, decouple_loss:0.01289381179958582
The generated pressure mean: 0.43919408321380615
loss_pred:0.027195192873477936, decouple_loss:0.012783646583557129
Iteration: 1652, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4342421889305115
The generated pressure mean: 0.4349063038825989
loss_pred:0.02375803142786026, decouple_loss:0.012773712165653706
loss_pred:0.02379765920341015, decouple_loss:0.012752898037433624
The generated pressure mean: 0.43880143761634827
loss_pred:0.022941702976822853, decouple_loss:0.01282384991645813
Iteration: 1653, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448708713054657
The generated pressure mean: 0.4481285512447357
loss_pred:0.02494189888238907, decouple_loss:0.012759380973875523
loss_pred:0.02530774474143982, decouple_loss:0.012674237601459026
The generated pressure mean: 0.4486426115036011
loss_pred:0.02494242787361145, decouple_loss:0.012707732617855072
Iteration: 1654, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506167769432068
loss_pred:0.02487366646528244, decouple_loss:0.011901400052011013
The generated pressure mean: 0.45454034209251404
loss_pred:0.023571381345391273, decouple_loss:0.011954271234571934
The generated pressure mean: 0.45760786533355713
loss_pred:0.02600807324051857, decouple_loss:0.01195627823472023
Iteration: 1655, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4446556568145752
The generated pressure mean: 0.44670966267585754
loss_pred:0.02289029024541378, decouple_loss:0.012573637068271637
loss_pred:0.02289174124598503, decouple_loss:0.012301726266741753
The generated pressure mean: 0.4415368139743805
loss_pred:0.02614702843129635, decouple_loss:0.012377038598060608
Iteration: 1656, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44715431332588196
loss_pred:0.022627824917435646, decouple_loss:0.012053164653480053
The generated pressure mean: 0.4465900957584381
loss_pred:0.02278747595846653, decouple_loss:0.011980662122368813
The generated pressure mean: 0.4466859698295593
loss_pred:0.024964146316051483, decouple_loss:0.01216280460357666
Iteration: 1657, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4433673322200775
loss_pred:0.025523755699396133, decouple_loss:0.011823851615190506
The generated pressure mean: 0.4490833282470703
loss_pred:0.02294176071882248, decouple_loss:0.011849435977637768
The generated pressure mean: 0.4432305693626404
loss_pred:0.023447265848517418, decouple_loss:0.011687587946653366
Iteration: 1658, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461745321750641
The generated pressure mean: 0.4402865767478943
loss_pred:0.02313089370727539, decouple_loss:0.0120056988671422
loss_pred:0.023830173537135124, decouple_loss:0.01214377861469984
The generated pressure mean: 0.4485814571380615
loss_pred:0.02297281287610531, decouple_loss:0.012102692387998104
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1659, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44288235902786255
The generated pressure mean: 0.4487752914428711
loss_pred:0.022968241944909096, decouple_loss:0.011827090755105019
loss_pred:0.023120803758502007, decouple_loss:0.011728700250387192
The generated pressure mean: 0.4472878575325012
loss_pred:0.024207500740885735, decouple_loss:0.011856107041239738
Iteration: 1660, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44958731532096863
loss_pred:0.02321302331984043, decouple_loss:0.011596526019275188
The generated pressure mean: 0.4533482789993286
loss_pred:0.02475622296333313, decouple_loss:0.011916767805814743
The generated pressure mean: 0.45076775550842285
loss_pred:0.02409602515399456, decouple_loss:0.011773993261158466
2023-04-16 18:28:38 testing...
The generated pressure mean: 0.41579750180244446
The generated pressure mean: 0.42250820994377136
loss_pred:0.035647645592689514, decouple_loss:0.013428464531898499
The generated pressure mean: 0.4250936806201935
loss_pred:0.03464830666780472, decouple_loss:0.013669495470821857
loss_pred:0.03391174599528313, decouple_loss:0.013807154260575771
WV_0_PC_0_EH_1_PS_40, loss: 0.03541765362024307, avg_mse: 0.04796883463859558
current test mse: 0.047969
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1661, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4513590335845947
loss_pred:0.02309737168252468, decouple_loss:0.012864993885159492
The generated pressure mean: 0.44806721806526184
loss_pred:0.024776704609394073, decouple_loss:0.012791245244443417
The generated pressure mean: 0.4512319564819336
loss_pred:0.023736316710710526, decouple_loss:0.012704533524811268
Iteration: 1662, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4370351731777191
loss_pred:0.02497316338121891, decouple_loss:0.012571187689900398
The generated pressure mean: 0.4428691565990448
loss_pred:0.022459452971816063, decouple_loss:0.012505687773227692
The generated pressure mean: 0.4417274594306946
loss_pred:0.024016190320253372, decouple_loss:0.012506701052188873
Iteration: 1663, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4406488239765167
The generated pressure mean: 0.4419279098510742
loss_pred:0.024227336049079895, decouple_loss:0.012118869461119175
loss_pred:0.02500641904771328, decouple_loss:0.012156423181295395
The generated pressure mean: 0.4417248070240021
loss_pred:0.02318614348769188, decouple_loss:0.012206723913550377
Iteration: 1664, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44717442989349365
loss_pred:0.02444457821547985, decouple_loss:0.011156023479998112
The generated pressure mean: 0.45386165380477905
loss_pred:0.024882929399609566, decouple_loss:0.01112048514187336
The generated pressure mean: 0.45419278740882874
loss_pred:0.023035848513245583, decouple_loss:0.011434894986450672
Iteration: 1665, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486803114414215
loss_pred:0.023905569687485695, decouple_loss:0.011454561725258827
The generated pressure mean: 0.4469912350177765
loss_pred:0.02360149845480919, decouple_loss:0.011619527824223042
The generated pressure mean: 0.44905972480773926
loss_pred:0.023280516266822815, decouple_loss:0.011606038548052311
Iteration: 1666, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43627339601516724
loss_pred:0.023298809304833412, decouple_loss:0.011690011247992516
The generated pressure mean: 0.4408782422542572
loss_pred:0.023622415959835052, decouple_loss:0.011870421469211578
The generated pressure mean: 0.44720426201820374
loss_pred:0.024877963587641716, decouple_loss:0.01176307164132595
Iteration: 1667, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486471712589264
loss_pred:0.02360108681023121, decouple_loss:0.011283050291240215
The generated pressure mean: 0.4510805904865265
loss_pred:0.023112082853913307, decouple_loss:0.011536010541021824
The generated pressure mean: 0.4503548741340637
loss_pred:0.024878470227122307, decouple_loss:0.011315212585031986
Iteration: 1668, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446118026971817
loss_pred:0.023553606122732162, decouple_loss:0.012783609330654144
The generated pressure mean: 0.44537702202796936
loss_pred:0.023091519251465797, decouple_loss:0.012750715017318726
The generated pressure mean: 0.44642940163612366
loss_pred:0.022876976057887077, decouple_loss:0.012578053399920464
Iteration: 1669, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44843512773513794
loss_pred:0.022541213780641556, decouple_loss:0.01228488702327013
The generated pressure mean: 0.45142412185668945
loss_pred:0.02254909835755825, decouple_loss:0.012340160086750984
The generated pressure mean: 0.4473329782485962
loss_pred:0.02399292029440403, decouple_loss:0.012048781849443913
Iteration: 1670, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43680065870285034
loss_pred:0.02516593597829342, decouple_loss:0.011502224951982498
The generated pressure mean: 0.4427948594093323
loss_pred:0.02350717782974243, decouple_loss:0.01137806847691536
The generated pressure mean: 0.4409402906894684
loss_pred:0.024540305137634277, decouple_loss:0.011679462157189846
2023-04-16 18:31:07 testing...
The generated pressure mean: 0.4170333445072174
The generated pressure mean: 0.4247511923313141
loss_pred:0.037225767970085144, decouple_loss:0.01183696836233139
The generated pressure mean: 0.42731356620788574
loss_pred:0.03586846590042114, decouple_loss:0.012165152467787266
loss_pred:0.0357922725379467, decouple_loss:0.01232156902551651
WV_0_PC_0_EH_1_PS_40, loss: 0.036900896579027176, avg_mse: 0.051161862909793854
current test mse: 0.051162
Iteration: 1671, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493992328643799
loss_pred:0.02424302138388157, decouple_loss:0.011233540251851082
The generated pressure mean: 0.45132607221603394
loss_pred:0.024651046842336655, decouple_loss:0.01129591092467308
The generated pressure mean: 0.45194974541664124
loss_pred:0.023388737812638283, decouple_loss:0.011341285891830921
Iteration: 1672, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505077004432678
loss_pred:0.023563051596283913, decouple_loss:0.012235650792717934
The generated pressure mean: 0.443438857793808
loss_pred:0.023954205214977264, decouple_loss:0.012361097149550915
The generated pressure mean: 0.44626230001449585
loss_pred:0.02424698881804943, decouple_loss:0.012272934429347515
Iteration: 1673, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4446980953216553
loss_pred:0.0241713710129261, decouple_loss:0.012107744812965393
The generated pressure mean: 0.44613566994667053
loss_pred:0.024017563089728355, decouple_loss:0.0121006453409791
The generated pressure mean: 0.4501191973686218
loss_pred:0.02405010722577572, decouple_loss:0.012190742418169975
Iteration: 1674, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.450643390417099
The generated pressure mean: 0.4478631317615509
loss_pred:0.024028247222304344, decouple_loss:0.012718570418655872
loss_pred:0.024026552215218544, decouple_loss:0.012865743599832058
The generated pressure mean: 0.44729265570640564
loss_pred:0.02359624393284321, decouple_loss:0.012898442335426807
Iteration: 1675, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4363205134868622The generated pressure mean: 0.4400540292263031
loss_pred:0.024285372346639633, decouple_loss:0.011958692222833633
loss_pred:0.023199694231152534, decouple_loss:0.011872032657265663
The generated pressure mean: 0.43838030099868774
loss_pred:0.024261845275759697, decouple_loss:0.011977403424680233
Iteration: 1676, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44825536012649536
The generated pressure mean: 0.44036731123924255
loss_pred:0.02217307686805725, decouple_loss:0.012209643609821796
loss_pred:0.022376999258995056, decouple_loss:0.012380419299006462
The generated pressure mean: 0.44275906682014465
loss_pred:0.02353682368993759, decouple_loss:0.012174359522759914
Iteration: 1677, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45251938700675964
The generated pressure mean: 0.45548683404922485loss_pred:0.02411755546927452, decouple_loss:0.011552124284207821
loss_pred:0.024716436862945557, decouple_loss:0.011626682244241238
The generated pressure mean: 0.44827982783317566
loss_pred:0.02431398443877697, decouple_loss:0.011519738472998142
Iteration: 1678, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4568192660808563
loss_pred:0.02413242496550083, decouple_loss:0.01196714211255312
The generated pressure mean: 0.45307546854019165
loss_pred:0.02373950183391571, decouple_loss:0.01215533446520567
The generated pressure mean: 0.4593338072299957
loss_pred:0.02567855827510357, decouple_loss:0.012101573869585991
Iteration: 1679, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4385656416416168
loss_pred:0.022327112033963203, decouple_loss:0.012903579510748386
The generated pressure mean: 0.43463414907455444
loss_pred:0.023429350927472115, decouple_loss:0.013016159646213055
The generated pressure mean: 0.4365898370742798
loss_pred:0.023060882464051247, decouple_loss:0.01297205500304699
Iteration: 1680, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43753957748413086
loss_pred:0.02321278490126133, decouple_loss:0.011128847487270832
The generated pressure mean: 0.4410747289657593
loss_pred:0.023504868149757385, decouple_loss:0.011168205179274082
The generated pressure mean: 0.4448986351490021
loss_pred:0.02261163294315338, decouple_loss:0.011340808123350143
2023-04-16 18:32:59 testing...
The generated pressure mean: 0.42249196767807007
The generated pressure mean: 0.4157988131046295
The generated pressure mean: 0.42497849464416504
loss_pred:0.03371112793684006, decouple_loss:0.011696889996528625
loss_pred:0.03491729870438576, decouple_loss:0.011484463699162006
loss_pred:0.03323346748948097, decouple_loss:0.01181803084909916
WV_0_PC_0_EH_1_PS_40, loss: 0.03453729301691055, avg_mse: 0.0469888411462307
current test mse: 0.046989
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 1681, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4553978741168976
loss_pred:0.023032527416944504, decouple_loss:0.010782390832901001
The generated pressure mean: 0.44928207993507385
loss_pred:0.02381950244307518, decouple_loss:0.010601761750876904
The generated pressure mean: 0.45043522119522095
loss_pred:0.025124648585915565, decouple_loss:0.010623102076351643
Iteration: 1682, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499323070049286
loss_pred:0.022127294912934303, decouple_loss:0.012132933363318443
The generated pressure mean: 0.45161357522010803
loss_pred:0.023596391081809998, decouple_loss:0.01194525882601738
The generated pressure mean: 0.4493238031864166
loss_pred:0.02416457049548626, decouple_loss:0.011967744678258896
Iteration: 1683, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44954007863998413
The generated pressure mean: 0.45160600543022156
loss_pred:0.02450985088944435, decouple_loss:0.012439727783203125
loss_pred:0.022408833727240562, decouple_loss:0.012362190522253513
The generated pressure mean: 0.447001188993454
loss_pred:0.02388230711221695, decouple_loss:0.012301690876483917
Iteration: 1684, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44664525985717773
loss_pred:0.02257913537323475, decouple_loss:0.010587847791612148
The generated pressure mean: 0.44762200117111206
loss_pred:0.022555241361260414, decouple_loss:0.010685187764465809
The generated pressure mean: 0.44173887372016907
loss_pred:0.023391930386424065, decouple_loss:0.010508581064641476
Iteration: 1685, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44612303376197815
The generated pressure mean: 0.44724637269973755
loss_pred:0.02367636375129223, decouple_loss:0.01172663550823927
loss_pred:0.0230599083006382, decouple_loss:0.011991907842457294
The generated pressure mean: 0.4520499110221863
loss_pred:0.023257937282323837, decouple_loss:0.011735773645341396
Iteration: 1686, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482618570327759
The generated pressure mean: 0.4456799328327179
loss_pred:0.02360551245510578, decouple_loss:0.012419418431818485
loss_pred:0.024591777473688126, decouple_loss:0.01251230575144291
The generated pressure mean: 0.4510312080383301
loss_pred:0.02318495698273182, decouple_loss:0.012726268731057644
Iteration: 1687, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.438670814037323
loss_pred:0.023308739066123962, decouple_loss:0.011567411944270134
The generated pressure mean: 0.44156473875045776
loss_pred:0.024474462494254112, decouple_loss:0.011524377390742302
The generated pressure mean: 0.439177930355072
loss_pred:0.02360077202320099, decouple_loss:0.011618252843618393
Iteration: 1688, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45336994528770447
loss_pred:0.022425511851906776, decouple_loss:0.010890284553170204
The generated pressure mean: 0.4479489028453827
The generated pressure mean: 0.4539957642555237
loss_pred:0.023340417072176933, decouple_loss:0.010774719528853893
loss_pred:0.02170512266457081, decouple_loss:0.01088804379105568
Iteration: 1689, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502541422843933
loss_pred:0.025315016508102417, decouple_loss:0.010647781193256378
The generated pressure mean: 0.4518323242664337
loss_pred:0.023578215390443802, decouple_loss:0.010678996331989765
The generated pressure mean: 0.45940929651260376
loss_pred:0.023334842175245285, decouple_loss:0.010842379182577133
Iteration: 1690, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44183167815208435
The generated pressure mean: 0.44675683975219727
loss_pred:0.02516923099756241, decouple_loss:0.01047571748495102
loss_pred:0.023055559024214745, decouple_loss:0.010374637320637703
The generated pressure mean: 0.44530102610588074
loss_pred:0.022280098870396614, decouple_loss:0.010405411012470722
2023-04-16 18:35:29 testing...
The generated pressure mean: 0.41890549659729004
The generated pressure mean: 0.4251326620578766
The generated pressure mean: 0.4276507794857025
loss_pred:0.0335296206176281, decouple_loss:0.010770921595394611
loss_pred:0.032668180763721466, decouple_loss:0.011114208959043026
loss_pred:0.03202936425805092, decouple_loss:0.011240431107580662
WV_0_PC_0_EH_1_PS_40, loss: 0.03329448401927948, avg_mse: 0.044682055711746216
current test mse: 0.044682
Iteration: 1691, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4404226839542389
loss_pred:0.02446066588163376, decouple_loss:0.009900462813675404
The generated pressure mean: 0.44375625252723694
loss_pred:0.0242910236120224, decouple_loss:0.010070670396089554
The generated pressure mean: 0.4429152011871338
loss_pred:0.024797139689326286, decouple_loss:0.010051582008600235
Iteration: 1692, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467693567276001
loss_pred:0.022752704098820686, decouple_loss:0.010739338584244251
The generated pressure mean: 0.44017648696899414
loss_pred:0.024322858080267906, decouple_loss:0.010782779194414616
The generated pressure mean: 0.44224923849105835
loss_pred:0.022652732208371162, decouple_loss:0.010932926088571548
Iteration: 1693, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507082402706146
loss_pred:0.0223909430205822, decouple_loss:0.010139137506484985
The generated pressure mean: 0.4525963366031647
loss_pred:0.023520667105913162, decouple_loss:0.010098600760102272
The generated pressure mean: 0.45488837361335754
loss_pred:0.02340705692768097, decouple_loss:0.010127844288945198
Iteration: 1694, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46140262484550476
loss_pred:0.02337578311562538, decouple_loss:0.009707941673696041
The generated pressure mean: 0.4650549292564392
loss_pred:0.024211591109633446, decouple_loss:0.009983199648559093
The generated pressure mean: 0.45822232961654663
loss_pred:0.023232119157910347, decouple_loss:0.01005682721734047
Iteration: 1695, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4420860707759857
loss_pred:0.022990921512246132, decouple_loss:0.009876816533505917
The generated pressure mean: 0.43820419907569885
loss_pred:0.02481684647500515, decouple_loss:0.010007456876337528
The generated pressure mean: 0.43235501646995544
loss_pred:0.024864306673407555, decouple_loss:0.00997231062501669
Iteration: 1696, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4333036243915558
loss_pred:0.024335822090506554, decouple_loss:0.010060962289571762
The generated pressure mean: 0.4359174072742462
loss_pred:0.0239116121083498, decouple_loss:0.009905696846544743
The generated pressure mean: 0.4315107464790344
loss_pred:0.023405686020851135, decouple_loss:0.009917344897985458
Iteration: 1697, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45650336146354675
loss_pred:0.025933245196938515, decouple_loss:0.010191806592047215
The generated pressure mean: 0.45572221279144287
The generated pressure mean: 0.458781898021698
loss_pred:0.02258332073688507, decouple_loss:0.010234366171061993
loss_pred:0.02321266569197178, decouple_loss:0.010206134989857674
Iteration: 1698, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45261961221694946
loss_pred:0.023578688502311707, decouple_loss:0.010347367264330387
The generated pressure mean: 0.45216837525367737
loss_pred:0.022571278735995293, decouple_loss:0.01047573797404766
The generated pressure mean: 0.4480595886707306
loss_pred:0.025562437251210213, decouple_loss:0.010439498350024223
Iteration: 1699, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44180092215538025
loss_pred:0.025211498141288757, decouple_loss:0.010631740093231201
The generated pressure mean: 0.44505253434181213
loss_pred:0.025640059262514114, decouple_loss:0.010433733463287354
The generated pressure mean: 0.44370704889297485
loss_pred:0.025784790515899658, decouple_loss:0.010481538251042366
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1700, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4353075325489044
loss_pred:0.024232901632785797, decouple_loss:0.010646460577845573
The generated pressure mean: 0.43460050225257874
loss_pred:0.023952435702085495, decouple_loss:0.010625757277011871
The generated pressure mean: 0.439904123544693
loss_pred:0.024558797478675842, decouple_loss:0.010609565302729607
2023-04-16 18:37:22 testing...
The generated pressure mean: 0.41478365659713745
The generated pressure mean: 0.42198243737220764
loss_pred:0.037384770810604095, decouple_loss:0.011617525480687618
The generated pressure mean: 0.42475318908691406
loss_pred:0.03609161078929901, decouple_loss:0.011946805752813816
loss_pred:0.0359487347304821, decouple_loss:0.012032533995807171
WV_0_PC_0_EH_1_PS_40, loss: 0.03706832230091095, avg_mse: 0.051945220679044724
current test mse: 0.051945
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 1701, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45825037360191345
loss_pred:0.023134762421250343, decouple_loss:0.011309104971587658
The generated pressure mean: 0.4582216143608093
loss_pred:0.025712603703141212, decouple_loss:0.011407800018787384
The generated pressure mean: 0.4563119113445282
loss_pred:0.024878675118088722, decouple_loss:0.01103558111935854
Iteration: 1702, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44193190336227417
loss_pred:0.02275339514017105, decouple_loss:0.01069732941687107
The generated pressure mean: 0.4396909475326538
loss_pred:0.022715691477060318, decouple_loss:0.010995360091328621
The generated pressure mean: 0.4440532326698303
loss_pred:0.02209899015724659, decouple_loss:0.01075428444892168
Iteration: 1703, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4458826780319214
loss_pred:0.023021891713142395, decouple_loss:0.010771580971777439
The generated pressure mean: 0.4416095018386841
loss_pred:0.02454703114926815, decouple_loss:0.01129268016666174
The generated pressure mean: 0.4454720914363861
loss_pred:0.023147139698266983, decouple_loss:0.010741799138486385
Iteration: 1704, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45593369007110596
loss_pred:0.024602724239230156, decouple_loss:0.010367258451879025
The generated pressure mean: 0.45542123913764954
loss_pred:0.023971686139702797, decouple_loss:0.010505936108529568
The generated pressure mean: 0.45283639430999756
loss_pred:0.023471949622035027, decouple_loss:0.01037604734301567
Iteration: 1705, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449006587266922
loss_pred:0.026500822976231575, decouple_loss:0.011985915713012218
The generated pressure mean: 0.44850385189056396
loss_pred:0.024698931723833084, decouple_loss:0.011914975941181183
The generated pressure mean: 0.4502931535243988
loss_pred:0.025355728343129158, decouple_loss:0.012311486527323723
Iteration: 1706, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42528656125068665
loss_pred:0.02295001968741417, decouple_loss:0.011150481179356575
The generated pressure mean: 0.4264620840549469
loss_pred:0.023735906928777695, decouple_loss:0.011245936155319214
The generated pressure mean: 0.42675644159317017
loss_pred:0.023234238848090172, decouple_loss:0.011134065687656403
Iteration: 1707, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44372162222862244
loss_pred:0.02376187965273857, decouple_loss:0.011243084445595741
The generated pressure mean: 0.4340660572052002
loss_pred:0.02343268133699894, decouple_loss:0.011654442176222801
The generated pressure mean: 0.4437010586261749
loss_pred:0.023243388161063194, decouple_loss:0.011446631513535976
Iteration: 1708, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4713994860649109
loss_pred:0.025528399273753166, decouple_loss:0.01243719831109047
The generated pressure mean: 0.4613547921180725
The generated pressure mean: 0.46938055753707886
loss_pred:0.022598402574658394, decouple_loss:0.012259522452950478
loss_pred:0.024183563888072968, decouple_loss:0.012458809651434422
Iteration: 1709, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4627930521965027
loss_pred:0.022652506828308105, decouple_loss:0.011343826539814472
The generated pressure mean: 0.4649105370044708
loss_pred:0.02269664965569973, decouple_loss:0.011291686445474625
The generated pressure mean: 0.4634997248649597
loss_pred:0.024501826614141464, decouple_loss:0.011736113578081131
Iteration: 1710, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4367597699165344
loss_pred:0.022936662659049034, decouple_loss:0.011412383057177067
The generated pressure mean: 0.4375170171260834
loss_pred:0.02316003479063511, decouple_loss:0.011670148931443691
The generated pressure mean: 0.4362207353115082
loss_pred:0.024394549429416656, decouple_loss:0.011470883153378963
2023-04-16 18:39:51 testing...
The generated pressure mean: 0.4230966567993164
The generated pressure mean: 0.4294484853744507
The generated pressure mean: 0.43177640438079834
loss_pred:0.034392740577459335, decouple_loss:0.011887642554938793
loss_pred:0.033452898263931274, decouple_loss:0.012061633169651031
loss_pred:0.03283446654677391, decouple_loss:0.012227651663124561
WV_0_PC_0_EH_1_PS_40, loss: 0.0341629832983017, avg_mse: 0.04615338519215584
current test mse: 0.046153
Iteration: 1711, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42401641607284546
loss_pred:0.02426614612340927, decouple_loss:0.011498862877488136
The generated pressure mean: 0.4262945055961609
loss_pred:0.022498857229948044, decouple_loss:0.011491048149764538
The generated pressure mean: 0.42143628001213074
loss_pred:0.024234382435679436, decouple_loss:0.01171552762389183
Iteration: 1712, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4536168575286865
loss_pred:0.024161743000149727, decouple_loss:0.011540919542312622
The generated pressure mean: 0.4542393982410431
loss_pred:0.024070411920547485, decouple_loss:0.011604203842580318
The generated pressure mean: 0.45453187823295593
loss_pred:0.024695513769984245, decouple_loss:0.01165292039513588
Iteration: 1713, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46084076166152954
loss_pred:0.024052627384662628, decouple_loss:0.011652719229459763
The generated pressure mean: 0.4626980423927307
loss_pred:0.024699082598090172, decouple_loss:0.011710000224411488
The generated pressure mean: 0.4623912572860718
loss_pred:0.023348070681095123, decouple_loss:0.011656112968921661
Iteration: 1714, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4456240236759186
loss_pred:0.02324320375919342, decouple_loss:0.011097876355051994
The generated pressure mean: 0.44899782538414
loss_pred:0.0231486763805151, decouple_loss:0.0109851760789752
The generated pressure mean: 0.4530656635761261
loss_pred:0.02349254861474037, decouple_loss:0.011339699849486351
Iteration: 1715, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461209774017334
loss_pred:0.022246329113841057, decouple_loss:0.01083468459546566
The generated pressure mean: 0.4403211772441864
loss_pred:0.024255013093352318, decouple_loss:0.010959325358271599
The generated pressure mean: 0.44384264945983887
loss_pred:0.02437734045088291, decouple_loss:0.010694725438952446
Iteration: 1716, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44553202390670776
loss_pred:0.022938882932066917, decouple_loss:0.01116992998868227
The generated pressure mean: 0.4481826722621918
loss_pred:0.02321314997971058, decouple_loss:0.011438645422458649
The generated pressure mean: 0.44224125146865845
loss_pred:0.023917026817798615, decouple_loss:0.011388133279979229
Iteration: 1717, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.442785382270813
loss_pred:0.023321136832237244, decouple_loss:0.011271383613348007
The generated pressure mean: 0.4480769634246826
loss_pred:0.02463778853416443, decouple_loss:0.011350007727742195
The generated pressure mean: 0.4472469389438629
loss_pred:0.02207079529762268, decouple_loss:0.011340253986418247
Iteration: 1718, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44713297486305237
loss_pred:0.02421470545232296, decouple_loss:0.01104780938476324
The generated pressure mean: 0.4465715289115906
loss_pred:0.023011937737464905, decouple_loss:0.011044001206755638
The generated pressure mean: 0.44864755868911743
loss_pred:0.023903580382466316, decouple_loss:0.011040721088647842
Iteration: 1719, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44799214601516724
loss_pred:0.02388501912355423, decouple_loss:0.01238328404724598
The generated pressure mean: 0.44444340467453003
loss_pred:0.023830929771065712, decouple_loss:0.012251743115484715
The generated pressure mean: 0.4438822567462921
loss_pred:0.023955978453159332, decouple_loss:0.012411125004291534
Iteration: 1720, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4513215124607086
loss_pred:0.023553024977445602, decouple_loss:0.01198343001306057
The generated pressure mean: 0.4494708776473999
loss_pred:0.022784186527132988, decouple_loss:0.011935337446630001
The generated pressure mean: 0.4504144787788391
loss_pred:0.022802185267210007, decouple_loss:0.011912249960005283
2023-04-16 18:41:44 testing...
The generated pressure mean: 0.41425007581710815
The generated pressure mean: 0.4213095009326935
loss_pred:0.034824155271053314, decouple_loss:0.011549333110451698
The generated pressure mean: 0.4236767292022705
loss_pred:0.03336327150464058, decouple_loss:0.011849628761410713
loss_pred:0.03307291865348816, decouple_loss:0.011972695589065552
WV_0_PC_0_EH_1_PS_40, loss: 0.03434297814965248, avg_mse: 0.04667339846491814
current test mse: 0.046673
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 1721, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45580199360847473
loss_pred:0.024102268740534782, decouple_loss:0.01126387994736433
The generated pressure mean: 0.45262154936790466
loss_pred:0.021582625806331635, decouple_loss:0.011270983144640923
The generated pressure mean: 0.4581523835659027
loss_pred:0.024382401257753372, decouple_loss:0.011051958426833153
Iteration: 1722, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44875404238700867
loss_pred:0.02334420569241047, decouple_loss:0.010879376903176308
The generated pressure mean: 0.45234495401382446
loss_pred:0.02224343828856945, decouple_loss:0.011157996952533722
The generated pressure mean: 0.4532925486564636
loss_pred:0.023382136598229408, decouple_loss:0.011058459989726543
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1723, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43052732944488525
The generated pressure mean: 0.43756166100502014loss_pred:0.02253916673362255, decouple_loss:0.011049427092075348
loss_pred:0.022579308599233627, decouple_loss:0.010919525288045406
The generated pressure mean: 0.4287913143634796
loss_pred:0.023871272802352905, decouple_loss:0.010921335779130459
Iteration: 1724, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4450431168079376
loss_pred:0.02200400084257126, decouple_loss:0.01066791731864214
The generated pressure mean: 0.44045600295066833
loss_pred:0.022898167371749878, decouple_loss:0.0107677411288023
The generated pressure mean: 0.4469672441482544
loss_pred:0.02239786647260189, decouple_loss:0.01080225594341755
Iteration: 1725, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44940584897994995
loss_pred:0.02182006649672985, decouple_loss:0.010798785835504532
The generated pressure mean: 0.4470052719116211
loss_pred:0.02232588641345501, decouple_loss:0.010689528658986092
The generated pressure mean: 0.45726731419563293
loss_pred:0.023381326347589493, decouple_loss:0.010896112769842148
Iteration: 1726, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4550212025642395
loss_pred:0.02246091514825821, decouple_loss:0.011466444469988346
The generated pressure mean: 0.4482235908508301
loss_pred:0.023403994739055634, decouple_loss:0.011248685419559479
The generated pressure mean: 0.448123961687088
loss_pred:0.022304246202111244, decouple_loss:0.011208022944629192
Iteration: 1727, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469892680644989
loss_pred:0.02217736281454563, decouple_loss:0.012394011951982975
The generated pressure mean: 0.4459744989871979
loss_pred:0.023515276610851288, decouple_loss:0.012420284561812878
The generated pressure mean: 0.4491424560546875
loss_pred:0.024090662598609924, decouple_loss:0.012549998238682747
Iteration: 1728, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4402008056640625
loss_pred:0.022547531872987747, decouple_loss:0.012401063926517963
The generated pressure mean: 0.44229939579963684
loss_pred:0.02366715297102928, decouple_loss:0.01254347525537014
The generated pressure mean: 0.4451734125614166
loss_pred:0.023082781583070755, decouple_loss:0.012342954985797405
Iteration: 1729, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4443950951099396
loss_pred:0.023510701954364777, decouple_loss:0.010736343450844288
The generated pressure mean: 0.44673657417297363
loss_pred:0.023248804733157158, decouple_loss:0.01071776170283556
The generated pressure mean: 0.4460126757621765
loss_pred:0.023734312504529953, decouple_loss:0.010772552341222763
Iteration: 1730, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44075244665145874
loss_pred:0.0244937464594841, decouple_loss:0.010285855270922184
The generated pressure mean: 0.4422445595264435
loss_pred:0.022569825872778893, decouple_loss:0.01031479425728321
The generated pressure mean: 0.4403232932090759
loss_pred:0.022167479619383812, decouple_loss:0.010304545052349567
2023-04-16 18:44:16 testing...
The generated pressure mean: 0.4152062237262726
The generated pressure mean: 0.42173299193382263
loss_pred:0.03421024605631828, decouple_loss:0.012308341450989246
The generated pressure mean: 0.42408379912376404
loss_pred:0.033242080360651016, decouple_loss:0.012547027319669724
loss_pred:0.0327371247112751, decouple_loss:0.012673113495111465
WV_0_PC_0_EH_1_PS_40, loss: 0.03402195870876312, avg_mse: 0.04597366973757744
current test mse: 0.045974
Iteration: 1731, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4531570374965668
loss_pred:0.022420890629291534, decouple_loss:0.011541959829628468
The generated pressure mean: 0.4541594088077545
loss_pred:0.02219475992023945, decouple_loss:0.011641941964626312
The generated pressure mean: 0.45655593276023865
loss_pred:0.022880930453538895, decouple_loss:0.011467432603240013
Iteration: 1732, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44921064376831055
loss_pred:0.02301035448908806, decouple_loss:0.014205719344317913
The generated pressure mean: 0.4461837410926819
loss_pred:0.02446655184030533, decouple_loss:0.014375980012118816
The generated pressure mean: 0.4495300352573395
loss_pred:0.023666007444262505, decouple_loss:0.014163089916110039
Iteration: 1733, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44538643956184387
loss_pred:0.022579919546842575, decouple_loss:0.01142585463821888
The generated pressure mean: 0.44037461280822754
loss_pred:0.024500755593180656, decouple_loss:0.011550561524927616
The generated pressure mean: 0.4473443031311035
loss_pred:0.022464212030172348, decouple_loss:0.01131435576826334
Iteration: 1734, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4429211914539337
loss_pred:0.021532166749238968, decouple_loss:0.010963717475533485
The generated pressure mean: 0.4416612684726715
loss_pred:0.022982673719525337, decouple_loss:0.0110716437920928
The generated pressure mean: 0.44236236810684204
loss_pred:0.02212483435869217, decouple_loss:0.011029851622879505
Iteration: 1735, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4423810839653015
The generated pressure mean: 0.4507678151130676loss_pred:0.022338533774018288, decouple_loss:0.011968630366027355
loss_pred:0.022520704194903374, decouple_loss:0.011759201996028423
The generated pressure mean: 0.45061659812927246
loss_pred:0.02208760380744934, decouple_loss:0.011765087954699993
Iteration: 1736, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4519621431827545
loss_pred:0.02458401769399643, decouple_loss:0.012808429077267647
The generated pressure mean: 0.4541572034358978
loss_pred:0.023529615253210068, decouple_loss:0.012779245153069496
The generated pressure mean: 0.45465603470802307
loss_pred:0.022868890315294266, decouple_loss:0.012604129500687122
Iteration: 1737, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4288400113582611
loss_pred:0.021934783086180687, decouple_loss:0.011315058916807175
The generated pressure mean: 0.4374876916408539
loss_pred:0.023188047111034393, decouple_loss:0.011347001418471336
The generated pressure mean: 0.43602344393730164
loss_pred:0.023423969745635986, decouple_loss:0.011357974261045456
Iteration: 1738, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44589412212371826
The generated pressure mean: 0.44203630089759827
loss_pred:0.022405704483389854, decouple_loss:0.010283177718520164
loss_pred:0.02420254610478878, decouple_loss:0.010293429717421532
The generated pressure mean: 0.4472847580909729
loss_pred:0.021785171702504158, decouple_loss:0.010350894182920456
Iteration: 1739, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45772647857666016
loss_pred:0.022879842668771744, decouple_loss:0.01223947573453188
The generated pressure mean: 0.4588678181171417
loss_pred:0.023742709308862686, decouple_loss:0.012297473847866058
The generated pressure mean: 0.45675188302993774
loss_pred:0.022818533703684807, decouple_loss:0.012374741025269032
Iteration: 1740, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44229856133461
loss_pred:0.02236284501850605, decouple_loss:0.012033013626933098
The generated pressure mean: 0.44479939341545105
loss_pred:0.023661069571971893, decouple_loss:0.012082194909453392
The generated pressure mean: 0.44008246064186096
loss_pred:0.022223923355340958, decouple_loss:0.012180402874946594
2023-04-16 18:46:11 testing...
The generated pressure mean: 0.4252273738384247
The generated pressure mean: 0.4184856414794922
The generated pressure mean: 0.42798131704330444
loss_pred:0.033045053482055664, decouple_loss:0.01150206383317709
loss_pred:0.03412075340747833, decouple_loss:0.011203160509467125
loss_pred:0.03277658298611641, decouple_loss:0.01160880271345377
WV_0_PC_0_EH_1_PS_40, loss: 0.033886030316352844, avg_mse: 0.04595167562365532
current test mse: 0.045952
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 1741, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4432995319366455
loss_pred:0.023914754390716553, decouple_loss:0.010931278578937054
The generated pressure mean: 0.44452497363090515
The generated pressure mean: 0.44329163432121277
loss_pred:0.023784825578331947, decouple_loss:0.010947463102638721
loss_pred:0.02376677095890045, decouple_loss:0.010754371993243694
Iteration: 1742, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4441806375980377
The generated pressure mean: 0.4449477195739746
loss_pred:0.022302942350506783, decouple_loss:0.010614081285893917
loss_pred:0.02326810173690319, decouple_loss:0.010838695801794529
The generated pressure mean: 0.4478963315486908
loss_pred:0.025608401745557785, decouple_loss:0.010935378260910511
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1743, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503580331802368
The generated pressure mean: 0.4492439925670624
loss_pred:0.022401485592126846, decouple_loss:0.009610949084162712
loss_pred:0.023521367460489273, decouple_loss:0.009771334007382393
The generated pressure mean: 0.45331013202667236
loss_pred:0.02248488925397396, decouple_loss:0.00962831825017929
Iteration: 1744, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44798213243484497
The generated pressure mean: 0.45033714175224304
loss_pred:0.022690340876579285, decouple_loss:0.010125168599188328
loss_pred:0.022181233391165733, decouple_loss:0.010145122185349464
The generated pressure mean: 0.44684094190597534
loss_pred:0.022172192111611366, decouple_loss:0.010134343057870865
Iteration: 1745, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475646913051605
The generated pressure mean: 0.44377389550209045
loss_pred:0.02249148115515709, decouple_loss:0.009803221561014652
loss_pred:0.024610793218016624, decouple_loss:0.009591983631253242
The generated pressure mean: 0.4471839368343353
loss_pred:0.02258531004190445, decouple_loss:0.009567983448505402
Iteration: 1746, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4526684582233429The generated pressure mean: 0.4456285536289215
loss_pred:0.021510198712348938, decouple_loss:0.009844175539910793loss_pred:0.02232508733868599, decouple_loss:0.01001119613647461
The generated pressure mean: 0.45014768838882446
loss_pred:0.02261653169989586, decouple_loss:0.009853782132267952
Iteration: 1747, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4513513147830963
The generated pressure mean: 0.4476095139980316
loss_pred:0.022647423669695854, decouple_loss:0.010177254676818848
The generated pressure mean: 0.44812947511672974
loss_pred:0.02196120098233223, decouple_loss:0.01030263863503933
loss_pred:0.025033950805664062, decouple_loss:0.010327394120395184
Iteration: 1748, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4417332112789154
loss_pred:0.023071113973855972, decouple_loss:0.010218316689133644
The generated pressure mean: 0.43607932329177856
loss_pred:0.02352512627840042, decouple_loss:0.010385052300989628
The generated pressure mean: 0.43796753883361816
loss_pred:0.02300596982240677, decouple_loss:0.010242728516459465
Iteration: 1749, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4438338279724121
loss_pred:0.02234840579330921, decouple_loss:0.011442146264016628
The generated pressure mean: 0.44738543033599854
loss_pred:0.024058829993009567, decouple_loss:0.011554050259292126
The generated pressure mean: 0.44679880142211914
loss_pred:0.022739987820386887, decouple_loss:0.01133213471621275
Iteration: 1750, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4555347263813019
loss_pred:0.023809881880879402, decouple_loss:0.011333523318171501
The generated pressure mean: 0.45289164781570435
The generated pressure mean: 0.4587242305278778
loss_pred:0.021913129836320877, decouple_loss:0.011242445558309555
loss_pred:0.022155674174427986, decouple_loss:0.011109215207397938
2023-04-16 18:48:44 testing...
The generated pressure mean: 0.41725316643714905
The generated pressure mean: 0.4238380491733551
loss_pred:0.03348181024193764, decouple_loss:0.01048368588089943
The generated pressure mean: 0.4263197183609009
loss_pred:0.03249240666627884, decouple_loss:0.010730435140430927
loss_pred:0.032092634588479996, decouple_loss:0.010896185413002968
WV_0_PC_0_EH_1_PS_40, loss: 0.03322412073612213, avg_mse: 0.04486902430653572
current test mse: 0.044869
Iteration: 1751, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44734787940979004
loss_pred:0.02223828062415123, decouple_loss:0.009690563194453716
The generated pressure mean: 0.44848179817199707
loss_pred:0.021564282476902008, decouple_loss:0.009893056005239487
The generated pressure mean: 0.4476417303085327
loss_pred:0.023224225267767906, decouple_loss:0.009804652072489262
Iteration: 1752, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44481179118156433
loss_pred:0.022525180131196976, decouple_loss:0.009776675142347813
The generated pressure mean: 0.4435121417045593
loss_pred:0.021718986332416534, decouple_loss:0.009837539866566658
The generated pressure mean: 0.4475097060203552
loss_pred:0.02200200967490673, decouple_loss:0.009747346863150597
Iteration: 1753, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.451435923576355
loss_pred:0.02296767756342888, decouple_loss:0.01009781751781702
The generated pressure mean: 0.4487917125225067
The generated pressure mean: 0.4456396698951721loss_pred:0.021413158625364304, decouple_loss:0.010036705061793327
loss_pred:0.02163809724152088, decouple_loss:0.009937061928212643
Iteration: 1754, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4434048533439636
loss_pred:0.022557450458407402, decouple_loss:0.011254459619522095
The generated pressure mean: 0.44371700286865234
loss_pred:0.022766733542084694, decouple_loss:0.011237935163080692
The generated pressure mean: 0.44600358605384827
loss_pred:0.022131672129034996, decouple_loss:0.011566106230020523
Iteration: 1755, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468448758125305
loss_pred:0.02198619954288006, decouple_loss:0.011817746795713902
The generated pressure mean: 0.44722601771354675
loss_pred:0.02248365618288517, decouple_loss:0.011908093467354774
The generated pressure mean: 0.4527759850025177
loss_pred:0.020546339452266693, decouple_loss:0.011872016824781895
Iteration: 1756, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480469822883606
loss_pred:0.02258399873971939, decouple_loss:0.010088251903653145
The generated pressure mean: 0.4495677947998047
The generated pressure mean: 0.45161065459251404
loss_pred:0.024534421041607857, decouple_loss:0.009752541780471802
loss_pred:0.02406974509358406, decouple_loss:0.009863356128334999
Iteration: 1757, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4437929391860962
loss_pred:0.02412867173552513, decouple_loss:0.010274171829223633
The generated pressure mean: 0.4385685324668884
loss_pred:0.021871566772460938, decouple_loss:0.009958205744624138
The generated pressure mean: 0.4403810501098633
loss_pred:0.021882839500904083, decouple_loss:0.010043906047940254
Iteration: 1758, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4528506398200989
loss_pred:0.021665059030056, decouple_loss:0.012956771068274975
The generated pressure mean: 0.45436733961105347
loss_pred:0.022736065089702606, decouple_loss:0.012966706417500973
The generated pressure mean: 0.4575299322605133
loss_pred:0.022036517038941383, decouple_loss:0.013023142702877522
Iteration: 1759, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45140838623046875
loss_pred:0.02210099995136261, decouple_loss:0.011425443924963474
The generated pressure mean: 0.4489269554615021
loss_pred:0.023404855281114578, decouple_loss:0.011209695599973202
The generated pressure mean: 0.4539671242237091
loss_pred:0.022045671939849854, decouple_loss:0.011117910966277122
Iteration: 1760, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43779629468917847
loss_pred:0.023895202204585075, decouple_loss:0.010172080248594284
The generated pressure mean: 0.43494391441345215
loss_pred:0.022413603961467743, decouple_loss:0.010057131759822369
The generated pressure mean: 0.43528836965560913
loss_pred:0.02257980778813362, decouple_loss:0.010157543234527111
2023-04-16 18:50:37 testing...
The generated pressure mean: 0.419023334980011
The generated pressure mean: 0.42538177967071533
The generated pressure mean: 0.4279137849807739
loss_pred:0.03320757672190666, decouple_loss:0.01199651975184679
loss_pred:0.03182283416390419, decouple_loss:0.012336820363998413
loss_pred:0.031599029898643494, decouple_loss:0.012364254333078861
WV_0_PC_0_EH_1_PS_40, loss: 0.03282144293189049, avg_mse: 0.04391346499323845
current test mse: 0.043913
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 1761, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4377034306526184
loss_pred:0.023330524563789368, decouple_loss:0.011713868007063866
The generated pressure mean: 0.4403945207595825
loss_pred:0.023098235949873924, decouple_loss:0.011470945551991463
The generated pressure mean: 0.44040411710739136
loss_pred:0.024034840986132622, decouple_loss:0.011512038297951221
Iteration: 1762, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4541879892349243
The generated pressure mean: 0.4502581059932709
loss_pred:0.022543342784047127, decouple_loss:0.012535826303064823
loss_pred:0.023177949711680412, decouple_loss:0.012478146702051163
The generated pressure mean: 0.4521198868751526
loss_pred:0.02275216393172741, decouple_loss:0.01288007665425539
Iteration: 1763, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448110967874527
The generated pressure mean: 0.4566226899623871
loss_pred:0.023266885429620743, decouple_loss:0.010831066407263279
loss_pred:0.024152720347046852, decouple_loss:0.010708564892411232
The generated pressure mean: 0.4568966031074524
loss_pred:0.02255665510892868, decouple_loss:0.010806309059262276
Iteration: 1764, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4451258182525635
loss_pred:0.023594334721565247, decouple_loss:0.011894496157765388
The generated pressure mean: 0.4484686553478241
loss_pred:0.021873552352190018, decouple_loss:0.01180680375546217
The generated pressure mean: 0.45322105288505554
loss_pred:0.02262730337679386, decouple_loss:0.011859583668410778
Iteration: 1765, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.444358766078949
loss_pred:0.023013168945908546, decouple_loss:0.010598981752991676
The generated pressure mean: 0.4485861659049988
loss_pred:0.022663505747914314, decouple_loss:0.010850935243070126
The generated pressure mean: 0.4393244981765747
loss_pred:0.023815670982003212, decouple_loss:0.01060991920530796
Iteration: 1766, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4384005665779114
The generated pressure mean: 0.4400361180305481
loss_pred:0.023063888773322105, decouple_loss:0.011004817672073841
loss_pred:0.023712243884801865, decouple_loss:0.010834649205207825
The generated pressure mean: 0.4411197900772095
loss_pred:0.02293107658624649, decouple_loss:0.010658279061317444
Iteration: 1767, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483790695667267
loss_pred:0.022771157324314117, decouple_loss:0.010926131159067154
The generated pressure mean: 0.4452994763851166
loss_pred:0.024188272655010223, decouple_loss:0.010883664712309837
The generated pressure mean: 0.4420880377292633
loss_pred:0.02204466052353382, decouple_loss:0.010735511779785156
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1768, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473664462566376
The generated pressure mean: 0.4540085792541504
loss_pred:0.022691404446959496, decouple_loss:0.01098148338496685
loss_pred:0.023021312430500984, decouple_loss:0.010962721891701221
The generated pressure mean: 0.4461807608604431
loss_pred:0.022948695346713066, decouple_loss:0.011089528910815716
Iteration: 1769, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44831663370132446
The generated pressure mean: 0.4453977048397064
loss_pred:0.022973649203777313, decouple_loss:0.011890441179275513
The generated pressure mean: 0.4519116282463074loss_pred:0.02303685061633587, decouple_loss:0.011862675659358501
loss_pred:0.023670433089137077, decouple_loss:0.011919356882572174
Iteration: 1770, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45120811462402344
The generated pressure mean: 0.45040959119796753
loss_pred:0.02350756712257862, decouple_loss:0.010496258735656738
loss_pred:0.025670554488897324, decouple_loss:0.010261954739689827
The generated pressure mean: 0.44690021872520447
loss_pred:0.022553572431206703, decouple_loss:0.01029241643846035
2023-04-16 18:53:07 testing...
The generated pressure mean: 0.417147159576416
The generated pressure mean: 0.4235406219959259
The generated pressure mean: 0.42618057131767273
loss_pred:0.03398429602384567, decouple_loss:0.011034739203751087
loss_pred:0.032856401056051254, decouple_loss:0.011176412925124168
loss_pred:0.032421015202999115, decouple_loss:0.01136181689798832
WV_0_PC_0_EH_1_PS_40, loss: 0.03364678844809532, avg_mse: 0.04556236416101456
current test mse: 0.045562
Iteration: 1771, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44585981965065
loss_pred:0.02445703186094761, decouple_loss:0.010310989804565907
The generated pressure mean: 0.4502629339694977
loss_pred:0.023005299270153046, decouple_loss:0.010286192409694195
The generated pressure mean: 0.44745397567749023
loss_pred:0.02276988886296749, decouple_loss:0.010297899134457111
Iteration: 1772, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43627098202705383
loss_pred:0.024012627080082893, decouple_loss:0.01113514881581068
The generated pressure mean: 0.4388939142227173
loss_pred:0.023214934393763542, decouple_loss:0.01115147303789854
The generated pressure mean: 0.4425084590911865
loss_pred:0.023782555013895035, decouple_loss:0.011171563528478146
Iteration: 1773, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4418888986110687
The generated pressure mean: 0.4429953992366791
loss_pred:0.023699840530753136, decouple_loss:0.010771374218165874
loss_pred:0.024698501452803612, decouple_loss:0.010634678415954113
The generated pressure mean: 0.4398234486579895
loss_pred:0.023811712861061096, decouple_loss:0.010740299709141254
Iteration: 1774, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45481425523757935
loss_pred:0.023425595834851265, decouple_loss:0.010936234146356583
The generated pressure mean: 0.44798675179481506
loss_pred:0.02352854050695896, decouple_loss:0.010651318356394768
The generated pressure mean: 0.44526207447052
loss_pred:0.02366790361702442, decouple_loss:0.010650246404111385
Iteration: 1775, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4532342553138733
loss_pred:0.02288488671183586, decouple_loss:0.010574753396213055
The generated pressure mean: 0.44952502846717834
loss_pred:0.02310146950185299, decouple_loss:0.010740358382463455
The generated pressure mean: 0.45667874813079834
loss_pred:0.023014424368739128, decouple_loss:0.010672647505998611
Iteration: 1776, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4577585756778717
The generated pressure mean: 0.44923505187034607
loss_pred:0.02279810793697834, decouple_loss:0.00993154477328062
loss_pred:0.022965682670474052, decouple_loss:0.009866316802799702
The generated pressure mean: 0.4542770981788635
loss_pred:0.02374284900724888, decouple_loss:0.009756115265190601
Iteration: 1777, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4402238726615906
loss_pred:0.022627169266343117, decouple_loss:0.011639035306870937
The generated pressure mean: 0.43091100454330444
loss_pred:0.022349337115883827, decouple_loss:0.01124005950987339
The generated pressure mean: 0.4420092701911926
loss_pred:0.02200993523001671, decouple_loss:0.011327550746500492
Iteration: 1778, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4401090145111084
loss_pred:0.022312812507152557, decouple_loss:0.01067373063415289
The generated pressure mean: 0.44280433654785156
The generated pressure mean: 0.44057050347328186
loss_pred:0.022577332332730293, decouple_loss:0.010554471053183079
loss_pred:0.0233747735619545, decouple_loss:0.010497010312974453
Iteration: 1779, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45227083563804626
loss_pred:0.023273320868611336, decouple_loss:0.012068638578057289
The generated pressure mean: 0.4435664713382721
loss_pred:0.024160265922546387, decouple_loss:0.011881685815751553
The generated pressure mean: 0.4443384110927582
loss_pred:0.0227286908775568, decouple_loss:0.011738771572709084
Iteration: 1780, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44301486015319824
loss_pred:0.02379567176103592, decouple_loss:0.01099355611950159
The generated pressure mean: 0.44269365072250366
The generated pressure mean: 0.4522427022457123
loss_pred:0.023701362311840057, decouple_loss:0.011073162779211998
loss_pred:0.025263678282499313, decouple_loss:0.0110998610034585
2023-04-16 18:55:01 testing...
The generated pressure mean: 0.41876891255378723
The generated pressure mean: 0.42487382888793945
The generated pressure mean: 0.4277856945991516
loss_pred:0.033563558012247086, decouple_loss:0.01037578284740448
loss_pred:0.03241119906306267, decouple_loss:0.010870390571653843
loss_pred:0.03242669999599457, decouple_loss:0.0106721892952919
WV_0_PC_0_EH_1_PS_40, loss: 0.033332459628582, avg_mse: 0.045134663581848145
current test mse: 0.045135
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 1781, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44788187742233276
loss_pred:0.02421814575791359, decouple_loss:0.009866020642220974
The generated pressure mean: 0.4439346194267273
loss_pred:0.02335406467318535, decouple_loss:0.009964359924197197
The generated pressure mean: 0.4397105872631073
loss_pred:0.023276368156075478, decouple_loss:0.010033581405878067
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1782, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492884874343872
loss_pred:0.023112231865525246, decouple_loss:0.010185477323830128
The generated pressure mean: 0.4505614936351776
loss_pred:0.023088058456778526, decouple_loss:0.010285536758601665
The generated pressure mean: 0.4464501440525055
loss_pred:0.024531789124011993, decouple_loss:0.010367372073233128
Iteration: 1783, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4514673352241516
loss_pred:0.02356463484466076, decouple_loss:0.009823231026530266
The generated pressure mean: 0.4505229890346527
loss_pred:0.026186617091298103, decouple_loss:0.010019737295806408
The generated pressure mean: 0.4576791226863861
loss_pred:0.022826718166470528, decouple_loss:0.009793389588594437
Iteration: 1784, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44511401653289795
loss_pred:0.023093122988939285, decouple_loss:0.010040882974863052
The generated pressure mean: 0.4433809518814087
loss_pred:0.021638179197907448, decouple_loss:0.01000932790338993
The generated pressure mean: 0.4424656927585602
loss_pred:0.022927194833755493, decouple_loss:0.010007579810917377
Iteration: 1785, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467198848724365
loss_pred:0.023359820246696472, decouple_loss:0.010629168711602688
The generated pressure mean: 0.445922315120697
loss_pred:0.024483593180775642, decouple_loss:0.010486844927072525
The generated pressure mean: 0.4467242956161499
loss_pred:0.022206000983715057, decouple_loss:0.010613974183797836
Iteration: 1786, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43987566232681274
loss_pred:0.02379380166530609, decouple_loss:0.011943669989705086
The generated pressure mean: 0.4374578297138214
loss_pred:0.02366373874247074, decouple_loss:0.01183637510985136
The generated pressure mean: 0.4425516426563263
loss_pred:0.022458789870142937, decouple_loss:0.011976239271461964
Iteration: 1787, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4519328773021698
loss_pred:0.02178497612476349, decouple_loss:0.012164361774921417
The generated pressure mean: 0.44821465015411377
loss_pred:0.023500192910432816, decouple_loss:0.0121990405023098
The generated pressure mean: 0.4437260925769806
loss_pred:0.023996708914637566, decouple_loss:0.012100321240723133
Iteration: 1788, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.453284353017807
loss_pred:0.023996684700250626, decouple_loss:0.01023199874907732
The generated pressure mean: 0.45038795471191406
loss_pred:0.022792885079979897, decouple_loss:0.010372286662459373
The generated pressure mean: 0.45303648710250854
loss_pred:0.02297644317150116, decouple_loss:0.01035099197179079
Iteration: 1789, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4458880126476288
loss_pred:0.022883696481585503, decouple_loss:0.009845520369708538
The generated pressure mean: 0.4495743215084076
loss_pred:0.02297946996986866, decouple_loss:0.00990144070237875
The generated pressure mean: 0.44898879528045654
loss_pred:0.022838324308395386, decouple_loss:0.009783842600882053
Iteration: 1790, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465959966182709
loss_pred:0.023397870361804962, decouple_loss:0.009137792512774467
The generated pressure mean: 0.4460912048816681
loss_pred:0.022159134969115257, decouple_loss:0.009039603173732758
The generated pressure mean: 0.44241487979888916
loss_pred:0.02315475419163704, decouple_loss:0.009294213727116585
2023-04-16 18:57:31 testing...
The generated pressure mean: 0.41754722595214844
The generated pressure mean: 0.4235861003398895
loss_pred:0.03366154059767723, decouple_loss:0.0101760383695364
The generated pressure mean: 0.4257848262786865
loss_pred:0.03253308683633804, decouple_loss:0.010548295453190804
loss_pred:0.03224579244852066, decouple_loss:0.010735894553363323
WV_0_PC_0_EH_1_PS_40, loss: 0.03333781287074089, avg_mse: 0.0452103428542614
current test mse: 0.04521
Iteration: 1791, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44946232438087463
loss_pred:0.024402344599366188, decouple_loss:0.009820346720516682
The generated pressure mean: 0.45049843192100525
loss_pred:0.023570280522108078, decouple_loss:0.00987953320145607
The generated pressure mean: 0.4453030824661255
loss_pred:0.02226058393716812, decouple_loss:0.009859554469585419
Iteration: 1792, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4425334334373474
loss_pred:0.02211226522922516, decouple_loss:0.010715853422880173
The generated pressure mean: 0.44146886467933655
loss_pred:0.023684699088335037, decouple_loss:0.01067839004099369
The generated pressure mean: 0.4415954649448395
loss_pred:0.023196160793304443, decouple_loss:0.010626113042235374
Iteration: 1793, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45291462540626526
loss_pred:0.023727787658572197, decouple_loss:0.011601277627050877
The generated pressure mean: 0.44417816400527954
loss_pred:0.02473905310034752, decouple_loss:0.011472945101559162
The generated pressure mean: 0.4460786283016205
loss_pred:0.022214148193597794, decouple_loss:0.011690143495798111
Iteration: 1794, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44570472836494446
loss_pred:0.021390004083514214, decouple_loss:0.010531526990234852
The generated pressure mean: 0.44259366393089294
loss_pred:0.022389158606529236, decouple_loss:0.010806628502905369
The generated pressure mean: 0.4425182640552521
loss_pred:0.02162698283791542, decouple_loss:0.010717080906033516
Iteration: 1795, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45241740345954895
loss_pred:0.022970715537667274, decouple_loss:0.009847937151789665
The generated pressure mean: 0.447075217962265
loss_pred:0.02361929975450039, decouple_loss:0.009942388162016869
The generated pressure mean: 0.4490792453289032
loss_pred:0.022441206499934196, decouple_loss:0.009843280538916588
Iteration: 1796, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44919976592063904
loss_pred:0.02342241071164608, decouple_loss:0.010031670331954956
The generated pressure mean: 0.44676417112350464
loss_pred:0.02315627597272396, decouple_loss:0.009982778690755367
The generated pressure mean: 0.4591200649738312
loss_pred:0.022640282288193703, decouple_loss:0.009977050125598907
Iteration: 1797, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43981248140335083
loss_pred:0.02464083768427372, decouple_loss:0.009489371441304684
The generated pressure mean: 0.44062939286231995
loss_pred:0.023186741396784782, decouple_loss:0.009585519321262836
The generated pressure mean: 0.4415168762207031
loss_pred:0.023086722940206528, decouple_loss:0.009496020153164864
Iteration: 1798, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4419800043106079
loss_pred:0.022777125239372253, decouple_loss:0.009339074604213238
The generated pressure mean: 0.4440244734287262
loss_pred:0.023614346981048584, decouple_loss:0.009328069165349007
The generated pressure mean: 0.44360628724098206
loss_pred:0.024302562698721886, decouple_loss:0.009125381708145142
Iteration: 1799, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44824689626693726
loss_pred:0.021858273074030876, decouple_loss:0.009927869774401188
The generated pressure mean: 0.45246583223342896
loss_pred:0.022683514282107353, decouple_loss:0.009961307980120182
The generated pressure mean: 0.4489077031612396
loss_pred:0.022749045863747597, decouple_loss:0.009887064807116985
Iteration: 1800, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4552358388900757
The generated pressure mean: 0.45403945446014404
loss_pred:0.023521091789007187, decouple_loss:0.011479162611067295
loss_pred:0.023272203281521797, decouple_loss:0.011605112813413143
The generated pressure mean: 0.45314204692840576
loss_pred:0.023010630160570145, decouple_loss:0.011661236174404621
2023-04-16 18:59:24 testing...
The generated pressure mean: 0.4177197217941284
The generated pressure mean: 0.4244002103805542
loss_pred:0.03337695822119713, decouple_loss:0.011697711423039436
The generated pressure mean: 0.42664414644241333
loss_pred:0.032032474875450134, decouple_loss:0.012052824720740318
loss_pred:0.03178892657160759, decouple_loss:0.012155866250395775
WV_0_PC_0_EH_1_PS_40, loss: 0.032997895032167435, avg_mse: 0.0445670560002327
current test mse: 0.044567
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 1801, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475577175617218
loss_pred:0.022690264508128166, decouple_loss:0.010989452712237835
The generated pressure mean: 0.44566774368286133
loss_pred:0.021967777982354164, decouple_loss:0.011031021364033222
The generated pressure mean: 0.45077264308929443
loss_pred:0.02257794514298439, decouple_loss:0.011012562550604343
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1802, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.440842866897583
The generated pressure mean: 0.4431999921798706loss_pred:0.02240903675556183, decouple_loss:0.010717764496803284
loss_pred:0.022617749869823456, decouple_loss:0.010761411860585213
The generated pressure mean: 0.44554394483566284
loss_pred:0.022905901074409485, decouple_loss:0.010507189668715
Iteration: 1803, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4530541002750397
The generated pressure mean: 0.4485095143318176loss_pred:0.024068603292107582, decouple_loss:0.010823479853570461
loss_pred:0.022178299725055695, decouple_loss:0.0105978948995471
The generated pressure mean: 0.4508249759674072
loss_pred:0.022651584818959236, decouple_loss:0.010528601706027985
Iteration: 1804, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45256197452545166
loss_pred:0.02295902743935585, decouple_loss:0.010891163721680641
The generated pressure mean: 0.45135122537612915
loss_pred:0.022837281227111816, decouple_loss:0.010533560998737812
The generated pressure mean: 0.4512573182582855
loss_pred:0.02388862892985344, decouple_loss:0.010804804041981697
Iteration: 1805, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43900373578071594
loss_pred:0.022819988429546356, decouple_loss:0.010994807817041874
The generated pressure mean: 0.44037818908691406
loss_pred:0.022087622433900833, decouple_loss:0.011378990486264229
The generated pressure mean: 0.44181644916534424
loss_pred:0.02329111099243164, decouple_loss:0.011318222619593143
Iteration: 1806, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44179457426071167
loss_pred:0.022844871506094933, decouple_loss:0.01208457164466381
The generated pressure mean: 0.4374842643737793
loss_pred:0.023480553179979324, decouple_loss:0.012101165018975735
The generated pressure mean: 0.4391496777534485
loss_pred:0.023780088871717453, decouple_loss:0.011907389387488365
Iteration: 1807, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45558369159698486
loss_pred:0.02156275324523449, decouple_loss:0.011455933563411236
The generated pressure mean: 0.45665451884269714
loss_pred:0.025019897148013115, decouple_loss:0.011565941385924816
The generated pressure mean: 0.4574924111366272
loss_pred:0.021678006276488304, decouple_loss:0.011733243241906166
Iteration: 1808, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45162925124168396
loss_pred:0.02261587232351303, decouple_loss:0.011619869619607925
The generated pressure mean: 0.44846001267433167
loss_pred:0.024155903607606888, decouple_loss:0.011816952377557755
The generated pressure mean: 0.44561105966567993
loss_pred:0.0231624823063612, decouple_loss:0.01155260019004345
Iteration: 1809, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482232332229614
The generated pressure mean: 0.4512527287006378
loss_pred:0.022550679743289948, decouple_loss:0.01123964972794056
loss_pred:0.023538026958703995, decouple_loss:0.011146854609251022
The generated pressure mean: 0.44695842266082764
loss_pred:0.022641273215413094, decouple_loss:0.011209658347070217
Iteration: 1810, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478786885738373
loss_pred:0.022635428234934807, decouple_loss:0.010483123362064362
The generated pressure mean: 0.4484966993331909
loss_pred:0.023072626441717148, decouple_loss:0.010613495483994484
The generated pressure mean: 0.44768956303596497
loss_pred:0.02406805381178856, decouple_loss:0.010625489056110382
2023-04-16 19:01:54 testing...
The generated pressure mean: 0.4192315638065338
The generated pressure mean: 0.42573609948158264
The generated pressure mean: 0.42793506383895874
loss_pred:0.03339685872197151, decouple_loss:0.01152520440518856
loss_pred:0.032196421176195145, decouple_loss:0.011748156510293484
loss_pred:0.03175055980682373, decouple_loss:0.01184921059757471
WV_0_PC_0_EH_1_PS_40, loss: 0.033033326268196106, avg_mse: 0.04458644986152649
current test mse: 0.044586
Iteration: 1811, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43362268805503845
loss_pred:0.023525189608335495, decouple_loss:0.011016212403774261
The generated pressure mean: 0.4398987889289856
loss_pred:0.022422339767217636, decouple_loss:0.010979306884109974
The generated pressure mean: 0.44121184945106506
loss_pred:0.023027487099170685, decouple_loss:0.010909131728112698
Iteration: 1812, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4543251395225525
The generated pressure mean: 0.45225390791893005
loss_pred:0.02279742807149887, decouple_loss:0.01131401862949133
loss_pred:0.023891884833574295, decouple_loss:0.011099833063781261
The generated pressure mean: 0.4521937072277069
loss_pred:0.02249179594218731, decouple_loss:0.011060596443712711
Iteration: 1813, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4518210291862488
The generated pressure mean: 0.45074522495269775loss_pred:0.023047685623168945, decouple_loss:0.0112648606300354
loss_pred:0.023132149130105972, decouple_loss:0.011278188787400723
The generated pressure mean: 0.45054560899734497
loss_pred:0.021842509508132935, decouple_loss:0.011334423907101154
Iteration: 1814, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45270538330078125
loss_pred:0.02337774634361267, decouple_loss:0.012198448181152344
The generated pressure mean: 0.44980287551879883
loss_pred:0.0223699901252985, decouple_loss:0.01238066516816616
The generated pressure mean: 0.44564980268478394
loss_pred:0.022852888330817223, decouple_loss:0.012114397250115871
Iteration: 1815, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44637787342071533
The generated pressure mean: 0.43598780035972595
loss_pred:0.02252071350812912, decouple_loss:0.011649250984191895
loss_pred:0.023354269564151764, decouple_loss:0.011820671148598194
The generated pressure mean: 0.44159477949142456
loss_pred:0.02182503044605255, decouple_loss:0.01191448513418436
Iteration: 1816, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464974105358124
The generated pressure mean: 0.44768208265304565
loss_pred:0.022731155157089233, decouple_loss:0.010545708239078522
loss_pred:0.02234744466841221, decouple_loss:0.010367232374846935
The generated pressure mean: 0.446511834859848
loss_pred:0.02265164442360401, decouple_loss:0.010246990248560905
Iteration: 1817, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45151957869529724
The generated pressure mean: 0.4499877095222473
loss_pred:0.022045431658625603, decouple_loss:0.010591319762170315
loss_pred:0.022892894223332405, decouple_loss:0.010577479377388954
The generated pressure mean: 0.45323795080184937
loss_pred:0.02244381047785282, decouple_loss:0.010515417903661728
Iteration: 1818, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492521584033966
loss_pred:0.024075429886579514, decouple_loss:0.010622182860970497
The generated pressure mean: 0.44788187742233276
loss_pred:0.02261584810912609, decouple_loss:0.010569548234343529
The generated pressure mean: 0.4566787779331207
loss_pred:0.0226310882717371, decouple_loss:0.010618358850479126
Iteration: 1819, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43844538927078247
loss_pred:0.024074485525488853, decouple_loss:0.010552032850682735
The generated pressure mean: 0.44242072105407715
loss_pred:0.02218361385166645, decouple_loss:0.01038953848183155
The generated pressure mean: 0.4457734227180481
loss_pred:0.022700438275933266, decouple_loss:0.010573682375252247
Iteration: 1820, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43671444058418274
The generated pressure mean: 0.4469412863254547
loss_pred:0.022477345541119576, decouple_loss:0.01117054931819439
loss_pred:0.02283450774848461, decouple_loss:0.011139633134007454
The generated pressure mean: 0.4409506618976593
loss_pred:0.024386821314692497, decouple_loss:0.011207240633666515
2023-04-16 19:03:47 testing...
The generated pressure mean: 0.4147254526615143
The generated pressure mean: 0.4218808114528656
The generated pressure mean: 0.423728346824646
loss_pred:0.03398725762963295, decouple_loss:0.011544534005224705
loss_pred:0.03280392661690712, decouple_loss:0.01181194931268692
loss_pred:0.03243492916226387, decouple_loss:0.01192122045904398
WV_0_PC_0_EH_1_PS_40, loss: 0.03366333246231079, avg_mse: 0.045824985951185226
current test mse: 0.045825
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1821, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.455140084028244
loss_pred:0.02299376204609871, decouple_loss:0.01081762369722128
The generated pressure mean: 0.4588712453842163
loss_pred:0.021664535626769066, decouple_loss:0.01074745412915945
The generated pressure mean: 0.45716437697410583
loss_pred:0.02396768517792225, decouple_loss:0.010970850475132465
Iteration: 1822, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4533809423446655
The generated pressure mean: 0.4530443251132965
loss_pred:0.0215646643191576, decouple_loss:0.010794514790177345
loss_pred:0.021901030093431473, decouple_loss:0.010923533700406551
The generated pressure mean: 0.45418933033943176
loss_pred:0.021941455081105232, decouple_loss:0.01078025158494711
Iteration: 1823, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4318501949310303
The generated pressure mean: 0.4322252869606018
loss_pred:0.02128257416188717, decouple_loss:0.010393899865448475
loss_pred:0.02206644043326378, decouple_loss:0.010316220112144947
The generated pressure mean: 0.42875880002975464
loss_pred:0.024152575060725212, decouple_loss:0.010424093343317509
Iteration: 1824, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507717490196228
loss_pred:0.02201886661350727, decouple_loss:0.010103276930749416
The generated pressure mean: 0.4534900188446045
loss_pred:0.021740520372986794, decouple_loss:0.009992413222789764
The generated pressure mean: 0.45335689187049866
loss_pred:0.022204184904694557, decouple_loss:0.010060948319733143
Iteration: 1825, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4536897540092468
The generated pressure mean: 0.4536024332046509
loss_pred:0.021565962582826614, decouple_loss:0.010568244382739067
loss_pred:0.023536520078778267, decouple_loss:0.010408423840999603
The generated pressure mean: 0.4469608664512634
loss_pred:0.021547045558691025, decouple_loss:0.010578416287899017
Iteration: 1826, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4429837465286255
The generated pressure mean: 0.44241398572921753
loss_pred:0.024292360991239548, decouple_loss:0.01087033562362194
loss_pred:0.023013539612293243, decouple_loss:0.011102622374892235
The generated pressure mean: 0.43926289677619934
loss_pred:0.021870478987693787, decouple_loss:0.0109034962952137
Iteration: 1827, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4350869953632355
The generated pressure mean: 0.43270638585090637
loss_pred:0.02531401999294758, decouple_loss:0.011464067734777927
loss_pred:0.021328533068299294, decouple_loss:0.011520999483764172
The generated pressure mean: 0.4372709095478058
loss_pred:0.02219582162797451, decouple_loss:0.011591277085244656
Iteration: 1828, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463464617729187
The generated pressure mean: 0.45279577374458313
loss_pred:0.021826473996043205, decouple_loss:0.010616960003972054
loss_pred:0.022844739258289337, decouple_loss:0.010511714033782482
The generated pressure mean: 0.4486337900161743
loss_pred:0.023760735988616943, decouple_loss:0.010553892701864243
Iteration: 1829, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46000099182128906
loss_pred:0.021712254732847214, decouple_loss:0.010732241906225681
The generated pressure mean: 0.4603237509727478
loss_pred:0.02347910962998867, decouple_loss:0.010646327398717403
The generated pressure mean: 0.4618571102619171
loss_pred:0.021892206743359566, decouple_loss:0.01045650988817215
Iteration: 1830, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484476149082184
loss_pred:0.021808264777064323, decouple_loss:0.01021259929984808
The generated pressure mean: 0.4446406960487366
loss_pred:0.02225455455482006, decouple_loss:0.010258379392325878
The generated pressure mean: 0.4472545087337494
loss_pred:0.023571891710162163, decouple_loss:0.009880186058580875
2023-04-16 19:06:26 testing...
The generated pressure mean: 0.4191114604473114
The generated pressure mean: 0.42529284954071045
loss_pred:0.03348569571971893, decouple_loss:0.010496079921722412
The generated pressure mean: 0.4276258647441864
loss_pred:0.032348643988370895, decouple_loss:0.010739958845078945
loss_pred:0.03192722424864769, decouple_loss:0.010934875346720219
WV_0_PC_0_EH_1_PS_40, loss: 0.03312337026000023, avg_mse: 0.04495678097009659
current test mse: 0.044957
Iteration: 1831, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44145506620407104
loss_pred:0.025073237717151642, decouple_loss:0.009963978081941605
The generated pressure mean: 0.43958622217178345
loss_pred:0.02280498296022415, decouple_loss:0.010159092023968697
The generated pressure mean: 0.43788471817970276
loss_pred:0.023793330416083336, decouple_loss:0.00990353338420391
Iteration: 1832, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45002636313438416
The generated pressure mean: 0.4493093192577362
loss_pred:0.0221269391477108, decouple_loss:0.010946834459900856
loss_pred:0.022081684321165085, decouple_loss:0.010672350414097309
The generated pressure mean: 0.44724908471107483
loss_pred:0.02423981949687004, decouple_loss:0.010788421146571636
Iteration: 1833, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44146180152893066
The generated pressure mean: 0.4462459981441498loss_pred:0.021994199603796005, decouple_loss:0.009925389662384987
loss_pred:0.022489288821816444, decouple_loss:0.010075684636831284
The generated pressure mean: 0.4378814995288849
loss_pred:0.023430313915014267, decouple_loss:0.009961522184312344
Iteration: 1834, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45175066590309143
loss_pred:0.022958366200327873, decouple_loss:0.010783901438117027
The generated pressure mean: 0.4461924731731415
loss_pred:0.024023300036787987, decouple_loss:0.011027646251022816
The generated pressure mean: 0.45337414741516113
loss_pred:0.022580673918128014, decouple_loss:0.010708414018154144
Iteration: 1835, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4437703788280487
The generated pressure mean: 0.4447077810764313
loss_pred:0.02324795164167881, decouple_loss:0.011524089612066746
loss_pred:0.02257660962641239, decouple_loss:0.011619406752288342
The generated pressure mean: 0.4473632574081421
loss_pred:0.020370639860630035, decouple_loss:0.011585506610572338
Iteration: 1836, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496942460536957
The generated pressure mean: 0.4440923035144806
loss_pred:0.021185174584388733, decouple_loss:0.010280606336891651
loss_pred:0.02292254939675331, decouple_loss:0.01037628948688507
The generated pressure mean: 0.45573127269744873
loss_pred:0.021272793412208557, decouple_loss:0.010313203558325768
Iteration: 1837, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460369050502777
The generated pressure mean: 0.4494824707508087
loss_pred:0.022443445399403572, decouple_loss:0.010496098548173904
loss_pred:0.02228793129324913, decouple_loss:0.010270747356116772
The generated pressure mean: 0.4511505663394928
loss_pred:0.021771105006337166, decouple_loss:0.010211984626948833
Iteration: 1838, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4376696050167084
loss_pred:0.02348542958498001, decouple_loss:0.011444111354649067
The generated pressure mean: 0.4410017132759094
loss_pred:0.021696915850043297, decouple_loss:0.011634132824838161
The generated pressure mean: 0.4413723349571228
loss_pred:0.021854862570762634, decouple_loss:0.011593268252909184
Iteration: 1839, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4379707872867584
The generated pressure mean: 0.44338083267211914
loss_pred:0.022307345643639565, decouple_loss:0.0111350417137146
loss_pred:0.021726125851273537, decouple_loss:0.011147641576826572
The generated pressure mean: 0.44124147295951843
loss_pred:0.022361651062965393, decouple_loss:0.011084414087235928
Iteration: 1840, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44938600063323975
loss_pred:0.02252385951578617, decouple_loss:0.009823529981076717The generated pressure mean: 0.4497322142124176
loss_pred:0.022348664700984955, decouple_loss:0.009841504506766796
The generated pressure mean: 0.4517092704772949
loss_pred:0.02160223387181759, decouple_loss:0.009979679249227047
2023-04-16 19:08:19 testing...
The generated pressure mean: 0.4145234525203705
The generated pressure mean: 0.4209650456905365
The generated pressure mean: 0.42313387989997864
loss_pred:0.03443140909075737, decouple_loss:0.010304381139576435
loss_pred:0.033174969255924225, decouple_loss:0.010571018792688847
loss_pred:0.03274015709757805, decouple_loss:0.010732241906225681
WV_0_PC_0_EH_1_PS_40, loss: 0.033975642174482346, avg_mse: 0.046454451978206635
current test mse: 0.046454
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 1841, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4583733379840851
loss_pred:0.02411414124071598, decouple_loss:0.01041476521641016
The generated pressure mean: 0.45525071024894714
The generated pressure mean: 0.4624254107475281
loss_pred:0.024403885006904602, decouple_loss:0.0101249935105443
loss_pred:0.023280059918761253, decouple_loss:0.010618344880640507
Iteration: 1842, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44296887516975403
The generated pressure mean: 0.441110223531723
loss_pred:0.022935934364795685, decouple_loss:0.012324974872171879
loss_pred:0.0252933781594038, decouple_loss:0.012547435238957405
The generated pressure mean: 0.44226861000061035
loss_pred:0.022601062431931496, decouple_loss:0.012454577721655369
Iteration: 1843, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4371602237224579
The generated pressure mean: 0.4411982297897339
loss_pred:0.02364329993724823, decouple_loss:0.010862771421670914
loss_pred:0.02338622882962227, decouple_loss:0.010847436264157295
The generated pressure mean: 0.44080448150634766
loss_pred:0.024009617045521736, decouple_loss:0.010882207192480564
Iteration: 1844, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45500805974006653
loss_pred:0.02313317358493805, decouple_loss:0.010376597754657269
The generated pressure mean: 0.4573497176170349
loss_pred:0.022845307365059853, decouple_loss:0.01012884546071291
The generated pressure mean: 0.45062270760536194
loss_pred:0.022619007155299187, decouple_loss:0.010166049003601074
Iteration: 1845, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4456833004951477
loss_pred:0.023657727986574173, decouple_loss:0.012406839989125729
The generated pressure mean: 0.45312434434890747
loss_pred:0.02442127652466297, decouple_loss:0.012413510121405125
The generated pressure mean: 0.44771742820739746
loss_pred:0.02537660114467144, decouple_loss:0.012396978214383125
Iteration: 1846, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447355180978775
loss_pred:0.02370377629995346, decouple_loss:0.012293624691665173
The generated pressure mean: 0.45058274269104004
loss_pred:0.02550836279988289, decouple_loss:0.012386986054480076
The generated pressure mean: 0.44626346230506897
loss_pred:0.0247428547590971, decouple_loss:0.012080473825335503
Iteration: 1847, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4380767345428467
loss_pred:0.02212064526975155, decouple_loss:0.010224655270576477
The generated pressure mean: 0.4322842061519623
loss_pred:0.02367512136697769, decouple_loss:0.010483203455805779
The generated pressure mean: 0.44117292761802673
loss_pred:0.02391798608005047, decouple_loss:0.010144520550966263
Iteration: 1848, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466131627559662
loss_pred:0.023252492770552635, decouple_loss:0.010981074534356594
The generated pressure mean: 0.45420804619789124
loss_pred:0.02301197499036789, decouple_loss:0.011132508516311646
The generated pressure mean: 0.4601203203201294
loss_pred:0.02378770522773266, decouple_loss:0.011773071251809597
Iteration: 1849, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46058061718940735
loss_pred:0.024691211059689522, decouple_loss:0.011442144401371479
The generated pressure mean: 0.4571532905101776
loss_pred:0.02442413754761219, decouple_loss:0.011503537185490131
The generated pressure mean: 0.4576939046382904
loss_pred:0.023489240556955338, decouple_loss:0.011395535431802273
Iteration: 1850, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4315422475337982
The generated pressure mean: 0.43319252133369446
loss_pred:0.024124594405293465, decouple_loss:0.011092694476246834
loss_pred:0.025845663622021675, decouple_loss:0.011201252229511738
The generated pressure mean: 0.4286240041255951
loss_pred:0.02397703006863594, decouple_loss:0.011231432668864727
2023-04-16 19:10:50 testing...
The generated pressure mean: 0.4178900420665741
The generated pressure mean: 0.4237876534461975
The generated pressure mean: 0.4258560538291931
loss_pred:0.034458547830581665, decouple_loss:0.011090514250099659
loss_pred:0.03283565491437912, decouple_loss:0.011339258402585983
loss_pred:0.03278854116797447, decouple_loss:0.01153242215514183
WV_0_PC_0_EH_1_PS_40, loss: 0.03392695635557175, avg_mse: 0.04602237045764923
current test mse: 0.046022
Iteration: 1851, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4438341557979584
loss_pred:0.024531958624720573, decouple_loss:0.010814128443598747
The generated pressure mean: 0.4415617883205414
loss_pred:0.02486230991780758, decouple_loss:0.010560399852693081
The generated pressure mean: 0.4495753049850464
loss_pred:0.02378131076693535, decouple_loss:0.010607358999550343
Iteration: 1852, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508340060710907
loss_pred:0.025397082790732384, decouple_loss:0.010851576924324036
The generated pressure mean: 0.45023560523986816
loss_pred:0.022117551416158676, decouple_loss:0.010739664547145367
The generated pressure mean: 0.45707258582115173
loss_pred:0.023923425003886223, decouple_loss:0.010986139997839928
Iteration: 1853, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44872039556503296
loss_pred:0.024950623512268066, decouple_loss:0.011150841601192951
The generated pressure mean: 0.44819068908691406
loss_pred:0.025383921340107918, decouple_loss:0.01145982462912798
The generated pressure mean: 0.4482390284538269
loss_pred:0.02259691059589386, decouple_loss:0.01119942031800747
Iteration: 1854, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4411391019821167
loss_pred:0.024082420393824577, decouple_loss:0.012494933791458607
The generated pressure mean: 0.438678115606308
loss_pred:0.024071842432022095, decouple_loss:0.012655162252485752
The generated pressure mean: 0.43873342871665955
loss_pred:0.02403833344578743, decouple_loss:0.012615502811968327
Iteration: 1855, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44966280460357666
loss_pred:0.0238177552819252, decouple_loss:0.011364426463842392
The generated pressure mean: 0.4509163498878479
loss_pred:0.025282863527536392, decouple_loss:0.01155944261699915
The generated pressure mean: 0.44837504625320435
loss_pred:0.023368433117866516, decouple_loss:0.011669563129544258
Iteration: 1856, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45368024706840515
The generated pressure mean: 0.45078447461128235
loss_pred:0.023244578391313553, decouple_loss:0.01102583296597004
loss_pred:0.02279561571776867, decouple_loss:0.011245711706578732
The generated pressure mean: 0.4517894387245178
loss_pred:0.023768477141857147, decouple_loss:0.01135339867323637
Iteration: 1857, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45747727155685425
loss_pred:0.024409087374806404, decouple_loss:0.010410175658762455
The generated pressure mean: 0.45858034491539
loss_pred:0.024491630494594574, decouple_loss:0.010477328673005104
The generated pressure mean: 0.4535079300403595
loss_pred:0.024840466678142548, decouple_loss:0.010383750312030315
Iteration: 1858, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4279290735721588
loss_pred:0.023393705487251282, decouple_loss:0.01160460151731968
The generated pressure mean: 0.42558667063713074
loss_pred:0.024335335940122604, decouple_loss:0.01172709185630083
The generated pressure mean: 0.43220964074134827
loss_pred:0.025187313556671143, decouple_loss:0.011683952063322067
Iteration: 1859, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44408074021339417
The generated pressure mean: 0.44421517848968506
loss_pred:0.025308676064014435, decouple_loss:0.01221339963376522
loss_pred:0.02289515919983387, decouple_loss:0.012033779174089432
The generated pressure mean: 0.4497814476490021
loss_pred:0.023686597123742104, decouple_loss:0.012201232835650444
Iteration: 1860, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4565848410129547
loss_pred:0.02353130280971527, decouple_loss:0.011161665432155132
The generated pressure mean: 0.44836100935935974
loss_pred:0.023299643769860268, decouple_loss:0.011250444687902927
The generated pressure mean: 0.457972913980484
loss_pred:0.02314811386168003, decouple_loss:0.011218205094337463
2023-04-16 19:12:44 testing...
The generated pressure mean: 0.4154248833656311
The generated pressure mean: 0.42180100083351135
loss_pred:0.03443070501089096, decouple_loss:0.010948467068374157
The generated pressure mean: 0.42411091923713684
loss_pred:0.03332110866904259, decouple_loss:0.011022639460861683
loss_pred:0.03277483582496643, decouple_loss:0.011178765445947647
WV_0_PC_0_EH_1_PS_40, loss: 0.03406137973070145, avg_mse: 0.04680873453617096
current test mse: 0.046809
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 1861, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4563637971878052
loss_pred:0.024348946288228035, decouple_loss:0.01082832831889391
The generated pressure mean: 0.4527217149734497
loss_pred:0.021918775513768196, decouple_loss:0.01050893310457468
The generated pressure mean: 0.4546121060848236
loss_pred:0.02223191037774086, decouple_loss:0.010612956248223782
Iteration: 1862, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4411844313144684
The generated pressure mean: 0.4483656585216522
loss_pred:0.022614920511841774, decouple_loss:0.011855406686663628
loss_pred:0.02285749278962612, decouple_loss:0.011999662965536118
The generated pressure mean: 0.44765204191207886
loss_pred:0.02311880514025688, decouple_loss:0.011915546841919422
Iteration: 1863, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43170568346977234
The generated pressure mean: 0.4274030327796936
loss_pred:0.022204013541340828, decouple_loss:0.011417835019528866
loss_pred:0.023549756035208702, decouple_loss:0.011476577259600163
The generated pressure mean: 0.42904141545295715
loss_pred:0.022371968254446983, decouple_loss:0.011523676104843616
Iteration: 1864, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467404782772064
The generated pressure mean: 0.44781866669654846
loss_pred:0.022632809355854988, decouple_loss:0.01050189696252346
loss_pred:0.023176997900009155, decouple_loss:0.01038707047700882
The generated pressure mean: 0.4440126121044159
loss_pred:0.02221364714205265, decouple_loss:0.010449784807860851
Iteration: 1865, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4621327221393585The generated pressure mean: 0.4637230634689331
loss_pred:0.022011058405041695, decouple_loss:0.01038647722452879
loss_pred:0.022637853398919106, decouple_loss:0.010409954935312271
The generated pressure mean: 0.45816728472709656
loss_pred:0.022699827328324318, decouple_loss:0.010377752594649792
Iteration: 1866, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4424244165420532
The generated pressure mean: 0.4470230042934418
loss_pred:0.022705521434545517, decouple_loss:0.010364179499447346
loss_pred:0.02245926856994629, decouple_loss:0.010112332180142403
The generated pressure mean: 0.44832029938697815
loss_pred:0.02208334021270275, decouple_loss:0.010202600620687008
Iteration: 1867, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.442958265542984
The generated pressure mean: 0.4413178265094757
loss_pred:0.022905178368091583, decouple_loss:0.010036894120275974
loss_pred:0.022659648209810257, decouple_loss:0.010062477551400661
The generated pressure mean: 0.44568976759910583
loss_pred:0.021431872621178627, decouple_loss:0.010000895708799362
Iteration: 1868, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44550007581710815The generated pressure mean: 0.44512423872947693
loss_pred:0.022033696994185448, decouple_loss:0.00937790609896183
loss_pred:0.022356431931257248, decouple_loss:0.009399769827723503
The generated pressure mean: 0.4477303922176361
loss_pred:0.02252579666674137, decouple_loss:0.009251846000552177
Iteration: 1869, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4423558712005615
loss_pred:0.022717749699950218, decouple_loss:0.010536963120102882
The generated pressure mean: 0.4428059458732605
loss_pred:0.021365610882639885, decouple_loss:0.010572175495326519
The generated pressure mean: 0.44284525513648987
loss_pred:0.023130131885409355, decouple_loss:0.010480922646820545
Iteration: 1870, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4447042644023895
loss_pred:0.023315653204917908, decouple_loss:0.01014881394803524
The generated pressure mean: 0.4415878653526306
loss_pred:0.023096390068531036, decouple_loss:0.010310961864888668
The generated pressure mean: 0.4433019161224365
loss_pred:0.022403107956051826, decouple_loss:0.010063596069812775
2023-04-16 19:15:17 testing...
The generated pressure mean: 0.41524267196655273
The generated pressure mean: 0.4220485985279083
loss_pred:0.03498594090342522, decouple_loss:0.011244915425777435
The generated pressure mean: 0.4248197078704834
loss_pred:0.03383462503552437, decouple_loss:0.011404431425035
loss_pred:0.03327077254652977, decouple_loss:0.011605503037571907
WV_0_PC_0_EH_1_PS_40, loss: 0.0346013605594635, avg_mse: 0.04793740436434746
current test mse: 0.047937
Iteration: 1871, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45229873061180115
The generated pressure mean: 0.4544445276260376
loss_pred:0.02143164724111557, decouple_loss:0.010448213666677475
loss_pred:0.02315361052751541, decouple_loss:0.010609677992761135
The generated pressure mean: 0.4509352445602417
loss_pred:0.02193792350590229, decouple_loss:0.010594009421765804
Iteration: 1872, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44457924365997314
The generated pressure mean: 0.4465402662754059
loss_pred:0.023784685879945755, decouple_loss:0.011658884584903717
loss_pred:0.022385014221072197, decouple_loss:0.011464775539934635
The generated pressure mean: 0.44366833567619324
loss_pred:0.023435618728399277, decouple_loss:0.011537914164364338
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1873, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45315021276474
loss_pred:0.022949961945414543, decouple_loss:0.011669499799609184
The generated pressure mean: 0.44833293557167053
loss_pred:0.02174455113708973, decouple_loss:0.01171297300606966
The generated pressure mean: 0.453608900308609
loss_pred:0.023656969889998436, decouple_loss:0.011863954365253448
Iteration: 1874, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496098756790161
loss_pred:0.024193929508328438, decouple_loss:0.010702056810259819
The generated pressure mean: 0.4502962529659271
loss_pred:0.021646173670887947, decouple_loss:0.01036769524216652
The generated pressure mean: 0.4459226429462433
loss_pred:0.02238789200782776, decouple_loss:0.01048522349447012
Iteration: 1875, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44093841314315796
loss_pred:0.022548677399754524, decouple_loss:0.009958883747458458
The generated pressure mean: 0.4356996417045593
loss_pred:0.021425647661089897, decouple_loss:0.010015402920544147
The generated pressure mean: 0.43564751744270325
loss_pred:0.02224249765276909, decouple_loss:0.009959354996681213
Iteration: 1876, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493086040019989
loss_pred:0.023460518568754196, decouple_loss:0.010563402436673641
The generated pressure mean: 0.452135294675827
loss_pred:0.02263588458299637, decouple_loss:0.010540066286921501
The generated pressure mean: 0.4464859664440155
loss_pred:0.0235525481402874, decouple_loss:0.010403279215097427
Iteration: 1877, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45602813363075256
loss_pred:0.022281799465417862, decouple_loss:0.010129707865417004
The generated pressure mean: 0.45548149943351746
loss_pred:0.023036375641822815, decouple_loss:0.010073467157781124
The generated pressure mean: 0.44868841767311096
loss_pred:0.02357158437371254, decouple_loss:0.010099014267325401
Iteration: 1878, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44543251395225525
The generated pressure mean: 0.4417933523654938
loss_pred:0.023019859567284584, decouple_loss:0.009774993173778057
loss_pred:0.021531004458665848, decouple_loss:0.009369385428726673
The generated pressure mean: 0.4444296360015869
loss_pred:0.0234836433082819, decouple_loss:0.00979018583893776
Iteration: 1879, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4410347044467926
loss_pred:0.022570094093680382, decouple_loss:0.009765082038939
The generated pressure mean: 0.4392036497592926
loss_pred:0.023624997586011887, decouple_loss:0.010077396407723427
The generated pressure mean: 0.4447527825832367
loss_pred:0.023346204310655594, decouple_loss:0.009652450680732727
Iteration: 1880, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44694578647613525
loss_pred:0.02201441302895546, decouple_loss:0.01001456007361412
The generated pressure mean: 0.4440802335739136
loss_pred:0.021933093667030334, decouple_loss:0.010069990530610085
The generated pressure mean: 0.4497595727443695
loss_pred:0.02352207712829113, decouple_loss:0.010155455209314823
2023-04-16 19:17:10 testing...
The generated pressure mean: 0.41497376561164856
The generated pressure mean: 0.4214716851711273
loss_pred:0.03428544104099274, decouple_loss:0.010771784000098705
The generated pressure mean: 0.4239695072174072
loss_pred:0.03310946747660637, decouple_loss:0.010995413176715374
loss_pred:0.03287910297513008, decouple_loss:0.011072998866438866
WV_0_PC_0_EH_1_PS_40, loss: 0.03397200629115105, avg_mse: 0.04689586162567139
current test mse: 0.046896
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 1881, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4516388177871704
loss_pred:0.024255264550447464, decouple_loss:0.010166166350245476
The generated pressure mean: 0.4537185728549957
The generated pressure mean: 0.4524693191051483
loss_pred:0.024168234318494797, decouple_loss:0.010153841227293015
loss_pred:0.02196727879345417, decouple_loss:0.010232699103653431
Iteration: 1882, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44379687309265137
The generated pressure mean: 0.4397616386413574
loss_pred:0.023985261097550392, decouple_loss:0.009849597699940205
loss_pred:0.022956721484661102, decouple_loss:0.009832946583628654
The generated pressure mean: 0.4426911771297455
loss_pred:0.023432154208421707, decouple_loss:0.009771527722477913
Iteration: 1883, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44823598861694336
The generated pressure mean: 0.445957213640213
loss_pred:0.022026168182492256, decouple_loss:0.011114702560007572
loss_pred:0.0229379590600729, decouple_loss:0.01113397628068924
The generated pressure mean: 0.44390884041786194
loss_pred:0.023449411615729332, decouple_loss:0.011197876185178757
Iteration: 1884, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4519825577735901
The generated pressure mean: 0.4517679810523987
loss_pred:0.02223246730864048, decouple_loss:0.01089792512357235
loss_pred:0.02394850365817547, decouple_loss:0.010968758724629879
The generated pressure mean: 0.455048143863678
loss_pred:0.022055113688111305, decouple_loss:0.01093361433595419
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1885, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45047762989997864
The generated pressure mean: 0.4517139196395874
loss_pred:0.022451480850577354, decouple_loss:0.012003155425190926
loss_pred:0.02332128770649433, decouple_loss:0.012011426500976086
The generated pressure mean: 0.4530450999736786
loss_pred:0.022033363580703735, decouple_loss:0.011912708170711994
Iteration: 1886, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.441477507352829
The generated pressure mean: 0.43885859847068787
loss_pred:0.023575853556394577, decouple_loss:0.010303985327482224
loss_pred:0.02378249354660511, decouple_loss:0.010258941911160946
The generated pressure mean: 0.4445696771144867
loss_pred:0.022148633375763893, decouple_loss:0.010349373333156109
Iteration: 1887, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45150694251060486
loss_pred:0.023188848048448563, decouple_loss:0.01078411377966404
The generated pressure mean: 0.45029351115226746
loss_pred:0.022662853822112083, decouple_loss:0.010576851665973663
The generated pressure mean: 0.4477884769439697
loss_pred:0.023587388917803764, decouple_loss:0.010679111815989017
Iteration: 1888, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473099112510681
loss_pred:0.024073319509625435, decouple_loss:0.009611384943127632
The generated pressure mean: 0.45197319984436035
loss_pred:0.022604044526815414, decouple_loss:0.009732633829116821
The generated pressure mean: 0.45367398858070374
loss_pred:0.02292456105351448, decouple_loss:0.009665322490036488
Iteration: 1889, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44310614466667175
The generated pressure mean: 0.4463196098804474loss_pred:0.022731348872184753, decouple_loss:0.012133019976317883
loss_pred:0.022154225036501884, decouple_loss:0.012046260759234428
The generated pressure mean: 0.43615782260894775
loss_pred:0.024507753551006317, decouple_loss:0.012066401541233063
Iteration: 1890, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503946006298065
The generated pressure mean: 0.4470427930355072
loss_pred:0.022624898701906204, decouple_loss:0.010274332948029041
loss_pred:0.02317100018262863, decouple_loss:0.010302145034074783
The generated pressure mean: 0.4520123302936554
loss_pred:0.022266818210482597, decouple_loss:0.010189219377934933
2023-04-16 19:19:45 testing...
The generated pressure mean: 0.4149142801761627
The generated pressure mean: 0.4216475784778595
loss_pred:0.034094374626874924, decouple_loss:0.012035329826176167
The generated pressure mean: 0.42398664355278015
loss_pred:0.033058058470487595, decouple_loss:0.012241698801517487
loss_pred:0.03279668837785721, decouple_loss:0.012302611023187637
WV_0_PC_0_EH_1_PS_40, loss: 0.03392603620886803, avg_mse: 0.046500012278556824
current test mse: 0.0465
Iteration: 1891, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4543876051902771
The generated pressure mean: 0.45014920830726624loss_pred:0.022885950282216072, decouple_loss:0.011166009120643139
loss_pred:0.022900816053152084, decouple_loss:0.011216535232961178
The generated pressure mean: 0.45162686705589294
loss_pred:0.023571858182549477, decouple_loss:0.011122227646410465
Iteration: 1892, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44932249188423157
The generated pressure mean: 0.4497191905975342
loss_pred:0.02309608832001686, decouple_loss:0.011143222451210022
loss_pred:0.022569740191102028, decouple_loss:0.011070291511714458
The generated pressure mean: 0.44986778497695923
loss_pred:0.02300747111439705, decouple_loss:0.010689470916986465
Iteration: 1893, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446742445230484
The generated pressure mean: 0.4467514753341675
loss_pred:0.02215336263179779, decouple_loss:0.00996503233909607
loss_pred:0.022230304777622223, decouple_loss:0.010166763328015804
The generated pressure mean: 0.4472223222255707
loss_pred:0.022967008873820305, decouple_loss:0.010096323676407337
Iteration: 1894, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477142095565796
The generated pressure mean: 0.4512411952018738
loss_pred:0.022722972556948662, decouple_loss:0.010725615546107292
loss_pred:0.022478202357888222, decouple_loss:0.010778685100376606
The generated pressure mean: 0.4473215937614441
loss_pred:0.022198233753442764, decouple_loss:0.010510677471756935
Iteration: 1895, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492749869823456
The generated pressure mean: 0.44655266404151917
loss_pred:0.02421790361404419, decouple_loss:0.010702520608901978
loss_pred:0.022981276735663414, decouple_loss:0.010787341743707657
The generated pressure mean: 0.44586077332496643
loss_pred:0.022656047716736794, decouple_loss:0.010751409456133842
Iteration: 1896, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4400783181190491
loss_pred:0.02351447381079197, decouple_loss:0.010178294032812119
The generated pressure mean: 0.4381665587425232
loss_pred:0.022414419800043106, decouple_loss:0.010314359329640865
The generated pressure mean: 0.4367656707763672
loss_pred:0.022448450326919556, decouple_loss:0.010385032743215561
Iteration: 1897, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502165913581848
The generated pressure mean: 0.4541163742542267loss_pred:0.022220227867364883, decouple_loss:0.009817225858569145
loss_pred:0.022818181663751602, decouple_loss:0.009771108627319336
The generated pressure mean: 0.4569767713546753
loss_pred:0.022907959297299385, decouple_loss:0.009935698471963406
Iteration: 1898, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4577515125274658
loss_pred:0.023455586284399033, decouple_loss:0.01000197697430849
The generated pressure mean: 0.45803627371788025
loss_pred:0.02139117754995823, decouple_loss:0.00963672250509262
The generated pressure mean: 0.4580208957195282
loss_pred:0.022739078849554062, decouple_loss:0.00965334102511406
Iteration: 1899, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4430602192878723
loss_pred:0.024508805945515633, decouple_loss:0.010487455874681473
The generated pressure mean: 0.4440532922744751
loss_pred:0.023371051996946335, decouple_loss:0.010613548569381237
The generated pressure mean: 0.44388169050216675
loss_pred:0.022675329819321632, decouple_loss:0.01046296302229166
Iteration: 1900, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4379979372024536
The generated pressure mean: 0.43231436610221863
loss_pred:0.022636203095316887, decouple_loss:0.010293892584741116
loss_pred:0.0240790955722332, decouple_loss:0.010094240307807922
The generated pressure mean: 0.43835723400115967
loss_pred:0.022494712844491005, decouple_loss:0.010124246589839458
2023-04-16 19:21:38 testing...
The generated pressure mean: 0.42242830991744995
The generated pressure mean: 0.41584697365760803
The generated pressure mean: 0.42449742555618286
loss_pred:0.03220893442630768, decouple_loss:0.011302600614726543
loss_pred:0.0333128497004509, decouple_loss:0.010983385145664215
loss_pred:0.03177007660269737, decouple_loss:0.011462898924946785
WV_0_PC_0_EH_1_PS_40, loss: 0.032993100583553314, avg_mse: 0.04456115514039993
current test mse: 0.044561
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 1901, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44970375299453735
loss_pred:0.022423245012760162, decouple_loss:0.010439028032124043
The generated pressure mean: 0.4516604542732239
loss_pred:0.02259977161884308, decouple_loss:0.01044569630175829
The generated pressure mean: 0.4507196247577667
loss_pred:0.022053491324186325, decouple_loss:0.010346224531531334
Iteration: 1902, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4548632502555847
The generated pressure mean: 0.4603710472583771
loss_pred:0.02223926968872547, decouple_loss:0.009894249029457569
loss_pred:0.021708426997065544, decouple_loss:0.009897124022245407
The generated pressure mean: 0.4614444077014923
loss_pred:0.022253531962633133, decouple_loss:0.00989579688757658
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1903, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449782967567444
loss_pred:0.022958841174840927, decouple_loss:0.010321727953851223
The generated pressure mean: 0.4440591335296631
loss_pred:0.024645723402500153, decouple_loss:0.01027621515095234
The generated pressure mean: 0.4526652991771698
loss_pred:0.022763215005397797, decouple_loss:0.0104308370500803
Iteration: 1904, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43172216415405273
The generated pressure mean: 0.43020355701446533
loss_pred:0.023154733702540398, decouple_loss:0.01059285644441843
loss_pred:0.023231124505400658, decouple_loss:0.010358584113419056
The generated pressure mean: 0.42892324924468994
loss_pred:0.022489862516522408, decouple_loss:0.010574639774858952
Iteration: 1905, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44346296787261963
The generated pressure mean: 0.45039066672325134loss_pred:0.023358182981610298, decouple_loss:0.01004091463983059
loss_pred:0.022287826985120773, decouple_loss:0.009885117411613464
The generated pressure mean: 0.4483785629272461
loss_pred:0.020736653357744217, decouple_loss:0.01005703303962946
Iteration: 1906, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4560520350933075
loss_pred:0.02304304949939251, decouple_loss:0.011027509346604347
The generated pressure mean: 0.45812615752220154
loss_pred:0.022864997386932373, decouple_loss:0.010848326608538628
The generated pressure mean: 0.4557981789112091
loss_pred:0.022878192365169525, decouple_loss:0.011105204932391644
Iteration: 1907, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44492992758750916
loss_pred:0.022334160283207893, decouple_loss:0.011519435793161392
The generated pressure mean: 0.445130854845047
loss_pred:0.022344920784235, decouple_loss:0.011545844376087189
The generated pressure mean: 0.44373828172683716
loss_pred:0.02250722423195839, decouple_loss:0.0115819051861763
Iteration: 1908, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4393252730369568
loss_pred:0.02126961573958397, decouple_loss:0.010344639420509338
The generated pressure mean: 0.44125083088874817
loss_pred:0.023239286616444588, decouple_loss:0.010478687472641468
The generated pressure mean: 0.43898749351501465
loss_pred:0.021910423412919044, decouple_loss:0.010209123603999615
Iteration: 1909, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44893157482147217
loss_pred:0.022984573617577553, decouple_loss:0.010007446631789207
The generated pressure mean: 0.44802767038345337
loss_pred:0.02269936352968216, decouple_loss:0.010248045437037945
The generated pressure mean: 0.4490073621273041
loss_pred:0.02263663150370121, decouple_loss:0.010018285363912582
Iteration: 1910, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508485198020935
The generated pressure mean: 0.45442336797714233
loss_pred:0.021412722766399384, decouple_loss:0.009967993944883347
loss_pred:0.02298407256603241, decouple_loss:0.010045868344604969
The generated pressure mean: 0.45287981629371643
loss_pred:0.02339249663054943, decouple_loss:0.009966384619474411
2023-04-16 19:24:12 testing...
The generated pressure mean: 0.4164227545261383
The generated pressure mean: 0.4229547679424286
loss_pred:0.03363052010536194, decouple_loss:0.011950184591114521
The generated pressure mean: 0.425375759601593
loss_pred:0.032484572380781174, decouple_loss:0.012103615328669548
loss_pred:0.0322263278067112, decouple_loss:0.012234948575496674
WV_0_PC_0_EH_1_PS_40, loss: 0.03338528797030449, avg_mse: 0.045600954443216324
current test mse: 0.045601
Iteration: 1911, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474632441997528
loss_pred:0.023331141099333763, decouple_loss:0.011282329447567463
The generated pressure mean: 0.4422958791255951
loss_pred:0.022518295794725418, decouple_loss:0.011092624627053738
The generated pressure mean: 0.44386255741119385
loss_pred:0.021242188289761543, decouple_loss:0.011060220189392567
Iteration: 1912, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4374845027923584
loss_pred:0.022138068452477455, decouple_loss:0.01022416539490223
The generated pressure mean: 0.4365979731082916
loss_pred:0.023082615807652473, decouple_loss:0.010220557451248169
The generated pressure mean: 0.44125014543533325
loss_pred:0.020991619676351547, decouple_loss:0.010277330875396729
Iteration: 1913, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44080060720443726
loss_pred:0.022059500217437744, decouple_loss:0.009752857498824596
The generated pressure mean: 0.44468989968299866
loss_pred:0.023199547082185745, decouple_loss:0.009773975238204002
The generated pressure mean: 0.4422813355922699
loss_pred:0.021619420498609543, decouple_loss:0.009797068312764168
Iteration: 1914, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45805004239082336
loss_pred:0.023717790842056274, decouple_loss:0.010542936623096466
The generated pressure mean: 0.45667243003845215
loss_pred:0.02294899895787239, decouple_loss:0.01048887986689806
The generated pressure mean: 0.45709696412086487
loss_pred:0.0209401436150074, decouple_loss:0.010643110610544682
Iteration: 1915, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477415978908539
loss_pred:0.020738279446959496, decouple_loss:0.010784764774143696
The generated pressure mean: 0.44008785486221313
loss_pred:0.022260259836912155, decouple_loss:0.010731284506618977
The generated pressure mean: 0.44368240237236023
loss_pred:0.022913698107004166, decouple_loss:0.010908680967986584
Iteration: 1916, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45415517687797546
loss_pred:0.023595213890075684, decouple_loss:0.010424555279314518
The generated pressure mean: 0.45271268486976624
loss_pred:0.022480564191937447, decouple_loss:0.010573024861514568
The generated pressure mean: 0.45404741168022156
loss_pred:0.024574806913733482, decouple_loss:0.010540417395532131
Iteration: 1917, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43292510509490967
loss_pred:0.023221706971526146, decouple_loss:0.010048890486359596
The generated pressure mean: 0.43589910864830017
loss_pred:0.022146327421069145, decouple_loss:0.010000727139413357
The generated pressure mean: 0.43579959869384766
loss_pred:0.023430531844496727, decouple_loss:0.009862599894404411
Iteration: 1918, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44827932119369507
The generated pressure mean: 0.45047926902770996
loss_pred:0.022860126569867134, decouple_loss:0.01007016096264124
loss_pred:0.022595446556806564, decouple_loss:0.010076314210891724
The generated pressure mean: 0.45180779695510864
loss_pred:0.025162113830447197, decouple_loss:0.010072678327560425
Iteration: 1919, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459097981452942
loss_pred:0.02323903702199459, decouple_loss:0.01087428629398346
The generated pressure mean: 0.4434203505516052
loss_pred:0.02151166833937168, decouple_loss:0.01085946150124073
The generated pressure mean: 0.4533511698246002
loss_pred:0.021890200674533844, decouple_loss:0.010671205818653107
Iteration: 1920, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4409335255622864
The generated pressure mean: 0.44288960099220276
loss_pred:0.021869422867894173, decouple_loss:0.010493735782802105
loss_pred:0.022133413702249527, decouple_loss:0.010668829083442688
The generated pressure mean: 0.4456346035003662
loss_pred:0.021925976499915123, decouple_loss:0.010635482147336006
2023-04-16 19:26:05 testing...
The generated pressure mean: 0.41574278473854065
The generated pressure mean: 0.42226603627204895
The generated pressure mean: 0.4242978096008301
loss_pred:0.0338386669754982, decouple_loss:0.011335809715092182
loss_pred:0.032699789851903915, decouple_loss:0.011647754348814487
loss_pred:0.032461173832416534, decouple_loss:0.011763022281229496
WV_0_PC_0_EH_1_PS_40, loss: 0.033578988164663315, avg_mse: 0.04599633440375328
current test mse: 0.045996
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 1921, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470967948436737
loss_pred:0.02179516851902008, decouple_loss:0.010607745498418808
The generated pressure mean: 0.4429738223552704
loss_pred:0.022855905815958977, decouple_loss:0.011188645847141743
The generated pressure mean: 0.4434863030910492
loss_pred:0.02240302599966526, decouple_loss:0.010691857896745205
Iteration: 1922, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46257585287094116
The generated pressure mean: 0.4542935788631439
loss_pred:0.023094212636351585, decouple_loss:0.010942946188151836
loss_pred:0.02272513136267662, decouple_loss:0.010635468177497387
The generated pressure mean: 0.4561632573604584
loss_pred:0.024647606536746025, decouple_loss:0.010576004162430763
Iteration: 1923, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4380545914173126
The generated pressure mean: 0.4390251636505127
loss_pred:0.02374102920293808, decouple_loss:0.010669155046343803
loss_pred:0.02236219309270382, decouple_loss:0.010221346281468868
The generated pressure mean: 0.43678000569343567
loss_pred:0.02190784364938736, decouple_loss:0.010700024664402008
Iteration: 1924, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4388926029205322
The generated pressure mean: 0.44399115443229675
loss_pred:0.022077515721321106, decouple_loss:0.010612642392516136
loss_pred:0.02238013781607151, decouple_loss:0.010591958649456501
The generated pressure mean: 0.4378601312637329
loss_pred:0.023471789434552193, decouple_loss:0.010415037162601948
Iteration: 1925, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4569847583770752
The generated pressure mean: 0.45682239532470703
loss_pred:0.023313410580158234, decouple_loss:0.0100929643958807
loss_pred:0.02351415529847145, decouple_loss:0.010427539236843586
The generated pressure mean: 0.46072328090667725
loss_pred:0.023547101765871048, decouple_loss:0.010159033350646496
Iteration: 1926, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45185160636901855
The generated pressure mean: 0.4558041989803314
loss_pred:0.023663030937314034, decouple_loss:0.010379458777606487
loss_pred:0.022711776196956635, decouple_loss:0.010307855904102325
The generated pressure mean: 0.4509523808956146
loss_pred:0.02325669676065445, decouple_loss:0.010342739522457123
Iteration: 1927, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43567025661468506
The generated pressure mean: 0.43753138184547424
loss_pred:0.024481922388076782, decouple_loss:0.011021331883966923
loss_pred:0.02368094027042389, decouple_loss:0.011210603639483452
The generated pressure mean: 0.4379154443740845
loss_pred:0.022053301334381104, decouple_loss:0.011005097068846226
Iteration: 1928, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4458910822868347
The generated pressure mean: 0.44401538372039795
loss_pred:0.02191576175391674, decouple_loss:0.010231096297502518
loss_pred:0.0227437112480402, decouple_loss:0.010164288803935051
The generated pressure mean: 0.44543835520744324
loss_pred:0.02252023294568062, decouple_loss:0.01057836040854454
Iteration: 1929, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45693206787109375
The generated pressure mean: 0.45982804894447327
loss_pred:0.025026705116033554, decouple_loss:0.009703793562948704
loss_pred:0.02270379848778248, decouple_loss:0.00953071378171444
The generated pressure mean: 0.4575991630554199
loss_pred:0.02216891013085842, decouple_loss:0.009705373086035252
Iteration: 1930, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44412529468536377
loss_pred:0.02284930646419525, decouple_loss:0.010195797309279442
The generated pressure mean: 0.44405704736709595
loss_pred:0.02296118251979351, decouple_loss:0.010413562878966331
The generated pressure mean: 0.43917378783226013
loss_pred:0.022949153557419777, decouple_loss:0.01039340253919363
2023-04-16 19:28:36 testing...
The generated pressure mean: 0.4174426198005676
The generated pressure mean: 0.42360931634902954
The generated pressure mean: 0.42561379075050354
loss_pred:0.03506099805235863, decouple_loss:0.010476605966687202
loss_pred:0.03327780216932297, decouple_loss:0.010643077082931995
loss_pred:0.03360917046666145, decouple_loss:0.010543912649154663
WV_0_PC_0_EH_1_PS_40, loss: 0.03451038524508476, avg_mse: 0.04753657057881355
current test mse: 0.047537
Iteration: 1931, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44573280215263367
The generated pressure mean: 0.44172725081443787
loss_pred:0.022305013611912727, decouple_loss:0.010007753036916256
loss_pred:0.02248110994696617, decouple_loss:0.010063502006232738
The generated pressure mean: 0.44557666778564453
loss_pred:0.022721000015735626, decouple_loss:0.009821594692766666
Iteration: 1932, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44439253211021423
loss_pred:0.023440588265657425, decouple_loss:0.010202769190073013
The generated pressure mean: 0.44811221957206726
loss_pred:0.022482581436634064, decouple_loss:0.010249461978673935
The generated pressure mean: 0.45259326696395874
loss_pred:0.022934218868613243, decouple_loss:0.010513579472899437
Iteration: 1933, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482156038284302
loss_pred:0.024716945365071297, decouple_loss:0.010869906283915043
The generated pressure mean: 0.446473091840744
loss_pred:0.021930916234850883, decouple_loss:0.010843677446246147
The generated pressure mean: 0.45028674602508545
loss_pred:0.022048797458410263, decouple_loss:0.01102358940988779
Iteration: 1934, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507449269294739
loss_pred:0.022885587066411972, decouple_loss:0.011225231923162937
The generated pressure mean: 0.44404900074005127
loss_pred:0.02275693230330944, decouple_loss:0.011219620704650879
The generated pressure mean: 0.4462878406047821
loss_pred:0.0240838173776865, decouple_loss:0.011041670106351376
Iteration: 1935, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480665624141693
The generated pressure mean: 0.4498334527015686loss_pred:0.022501714527606964, decouple_loss:0.011137580499053001
loss_pred:0.022793155163526535, decouple_loss:0.010934398509562016
The generated pressure mean: 0.45250412821769714
loss_pred:0.024492250755429268, decouple_loss:0.010899190790951252
Iteration: 1936, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4398344159126282
loss_pred:0.022155778482556343, decouple_loss:0.01037374697625637
The generated pressure mean: 0.4423178732395172
loss_pred:0.0225814338773489, decouple_loss:0.010120815597474575
The generated pressure mean: 0.44405367970466614
loss_pred:0.022732077166438103, decouple_loss:0.010318567976355553
Iteration: 1937, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44918811321258545
loss_pred:0.02159050852060318, decouple_loss:0.011607491411268711
The generated pressure mean: 0.4605419337749481
loss_pred:0.02218496985733509, decouple_loss:0.01154234167188406
The generated pressure mean: 0.4587913751602173
loss_pred:0.02337132766842842, decouple_loss:0.011481267400085926
Iteration: 1938, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4435175061225891
loss_pred:0.023359231650829315, decouple_loss:0.01158114243298769
The generated pressure mean: 0.4504273533821106
loss_pred:0.02317797765135765, decouple_loss:0.011628310196101665
The generated pressure mean: 0.45561960339546204
loss_pred:0.021741047501564026, decouple_loss:0.01162641029804945
Iteration: 1939, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44167283177375793
loss_pred:0.02226119302213192, decouple_loss:0.011111625470221043
The generated pressure mean: 0.44028395414352417
loss_pred:0.02237740159034729, decouple_loss:0.011310561560094357
The generated pressure mean: 0.4386758804321289
loss_pred:0.023221498355269432, decouple_loss:0.011193450540304184
Iteration: 1940, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44039514660835266
The generated pressure mean: 0.44290924072265625loss_pred:0.022710034623742104, decouple_loss:0.011008606292307377
loss_pred:0.022966613993048668, decouple_loss:0.011114959605038166
The generated pressure mean: 0.4436371922492981
loss_pred:0.02160232700407505, decouple_loss:0.010793961584568024
2023-04-16 19:30:29 testing...
The generated pressure mean: 0.4137381315231323
The generated pressure mean: 0.42026230692863464
loss_pred:0.035648804157972336, decouple_loss:0.011549359187483788
The generated pressure mean: 0.42273062467575073
loss_pred:0.03458376228809357, decouple_loss:0.011756662279367447
loss_pred:0.03402024134993553, decouple_loss:0.011849446222186089
WV_0_PC_0_EH_1_PS_40, loss: 0.03533686324954033, avg_mse: 0.049088362604379654
current test mse: 0.049088
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1941, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4593023657798767
loss_pred:0.02400093525648117, decouple_loss:0.011278511956334114
The generated pressure mean: 0.4579552710056305
The generated pressure mean: 0.4531533420085907
loss_pred:0.024496503174304962, decouple_loss:0.011391171254217625
loss_pred:0.022553199902176857, decouple_loss:0.011091474443674088
Iteration: 1942, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447450190782547
The generated pressure mean: 0.4490269720554352
loss_pred:0.023261362686753273, decouple_loss:0.011087224818766117
loss_pred:0.022866366431117058, decouple_loss:0.011034836061298847
The generated pressure mean: 0.448449045419693
loss_pred:0.023427458480000496, decouple_loss:0.01105547696352005
Iteration: 1943, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.437758207321167
The generated pressure mean: 0.43546539545059204
loss_pred:0.023795804008841515, decouple_loss:0.011947404593229294
loss_pred:0.023687215521931648, decouple_loss:0.011851109564304352
The generated pressure mean: 0.43374934792518616
loss_pred:0.023841597139835358, decouple_loss:0.011768986470997334
Iteration: 1944, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4427650272846222
The generated pressure mean: 0.443037211894989
loss_pred:0.02199745550751686, decouple_loss:0.010777272284030914
loss_pred:0.02334178425371647, decouple_loss:0.010578658431768417
The generated pressure mean: 0.4438895583152771
loss_pred:0.023311370983719826, decouple_loss:0.010763336904346943
Iteration: 1945, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45608648657798767
loss_pred:0.02252361923456192, decouple_loss:0.0109715536236763
The generated pressure mean: 0.4534538984298706
loss_pred:0.022237326949834824, decouple_loss:0.010981285013258457
The generated pressure mean: 0.45702433586120605
loss_pred:0.022365279495716095, decouple_loss:0.01091791968792677
Iteration: 1946, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477580189704895
loss_pred:0.023343559354543686, decouple_loss:0.01076934952288866
The generated pressure mean: 0.4510396420955658
loss_pred:0.02219744212925434, decouple_loss:0.010752367787063122
The generated pressure mean: 0.4530993103981018
loss_pred:0.02332129515707493, decouple_loss:0.010787950828671455
Iteration: 1947, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43259817361831665
loss_pred:0.025637580081820488, decouple_loss:0.011165408417582512
The generated pressure mean: 0.4360499382019043
loss_pred:0.022947948426008224, decouple_loss:0.010945236310362816
The generated pressure mean: 0.4370889961719513
loss_pred:0.023332243785262108, decouple_loss:0.010865693911910057
Iteration: 1948, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45337578654289246
The generated pressure mean: 0.4447738826274872
loss_pred:0.022577041760087013, decouple_loss:0.012024501338601112
loss_pred:0.023675942793488503, decouple_loss:0.01192784495651722
The generated pressure mean: 0.44889599084854126
loss_pred:0.022542694583535194, decouple_loss:0.012042527087032795
Iteration: 1949, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4541648328304291
The generated pressure mean: 0.45352059602737427
loss_pred:0.022281209006905556, decouple_loss:0.010858750902116299
loss_pred:0.022994346916675568, decouple_loss:0.01079235877841711
The generated pressure mean: 0.44643405079841614
loss_pred:0.022611213847994804, decouple_loss:0.010632586665451527
Iteration: 1950, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44015172123908997
The generated pressure mean: 0.44176045060157776
loss_pred:0.023654695600271225, decouple_loss:0.011416405439376831
loss_pred:0.023133940994739532, decouple_loss:0.011267834343016148
The generated pressure mean: 0.44366616010665894
loss_pred:0.023967893794178963, decouple_loss:0.011353090405464172
2023-04-16 19:33:03 testing...
The generated pressure mean: 0.41782575845718384
The generated pressure mean: 0.42409375309944153
The generated pressure mean: 0.4265715777873993
loss_pred:0.03382806479930878, decouple_loss:0.011790843680500984
loss_pred:0.03257625922560692, decouple_loss:0.011996165849268436
loss_pred:0.032113272696733475, decouple_loss:0.012160221114754677
WV_0_PC_0_EH_1_PS_40, loss: 0.03343832120299339, avg_mse: 0.0458441898226738
current test mse: 0.045844
Iteration: 1951, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.439586877822876
loss_pred:0.02314949221909046, decouple_loss:0.011237857863307
The generated pressure mean: 0.4411020278930664
loss_pred:0.023212581872940063, decouple_loss:0.011202658526599407
The generated pressure mean: 0.4388478994369507
loss_pred:0.023784203454852104, decouple_loss:0.011234737001359463
Iteration: 1952, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448583722114563
The generated pressure mean: 0.4554154574871063
loss_pred:0.024312783032655716, decouple_loss:0.010342328809201717
loss_pred:0.023779259994626045, decouple_loss:0.010390651412308216
The generated pressure mean: 0.44487112760543823
loss_pred:0.023199478164315224, decouple_loss:0.010312273167073727
Iteration: 1953, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495302438735962
The generated pressure mean: 0.4533597528934479
loss_pred:0.023608427494764328, decouple_loss:0.010820459574460983
loss_pred:0.02562590315937996, decouple_loss:0.010998733341693878
The generated pressure mean: 0.45249781012535095
loss_pred:0.021519917994737625, decouple_loss:0.010789644904434681
Iteration: 1954, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44577735662460327
loss_pred:0.02394285798072815, decouple_loss:0.011356722563505173
The generated pressure mean: 0.44241586327552795
loss_pred:0.024266928434371948, decouple_loss:0.01152554526925087
The generated pressure mean: 0.44187313318252563
loss_pred:0.022616736590862274, decouple_loss:0.011439274996519089
Iteration: 1955, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44288453459739685
The generated pressure mean: 0.439348965883255
loss_pred:0.022456761449575424, decouple_loss:0.010213393718004227
loss_pred:0.023643819615244865, decouple_loss:0.010129847563803196
The generated pressure mean: 0.43792980909347534
loss_pred:0.023862050846219063, decouple_loss:0.010274741798639297
Iteration: 1956, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45115914940834045
The generated pressure mean: 0.44870904088020325
loss_pred:0.023883990943431854, decouple_loss:0.010672264732420444
loss_pred:0.02267003059387207, decouple_loss:0.010785740800201893
The generated pressure mean: 0.4446505606174469
loss_pred:0.02382751740515232, decouple_loss:0.010736183263361454
Iteration: 1957, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494788646697998
The generated pressure mean: 0.44906654953956604
loss_pred:0.022963739931583405, decouple_loss:0.010180741548538208
loss_pred:0.022259335964918137, decouple_loss:0.010257893241941929
The generated pressure mean: 0.4515034854412079
loss_pred:0.02329406701028347, decouple_loss:0.01011283416301012
Iteration: 1958, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44393157958984375
loss_pred:0.02231842465698719, decouple_loss:0.010102983564138412
The generated pressure mean: 0.44634920358657837
loss_pred:0.024434957653284073, decouple_loss:0.010062610730528831
The generated pressure mean: 0.4412083029747009
loss_pred:0.023361407220363617, decouple_loss:0.009965170174837112
Iteration: 1959, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4413115084171295
loss_pred:0.022045137360692024, decouple_loss:0.010948781855404377
The generated pressure mean: 0.44262364506721497
loss_pred:0.023828981444239616, decouple_loss:0.011105903424322605
The generated pressure mean: 0.4417625665664673
loss_pred:0.02413739636540413, decouple_loss:0.01125294342637062
Iteration: 1960, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4457608163356781
The generated pressure mean: 0.4453219473361969loss_pred:0.02389374002814293, decouple_loss:0.010538686066865921
loss_pred:0.023593945428729057, decouple_loss:0.010534809902310371
The generated pressure mean: 0.4482269585132599
loss_pred:0.023064138367772102, decouple_loss:0.010507126338779926
2023-04-16 19:34:56 testing...
The generated pressure mean: 0.4218675196170807
The generated pressure mean: 0.41501572728157043
The generated pressure mean: 0.4244692623615265
loss_pred:0.033152759075164795, decouple_loss:0.011164350435137749
loss_pred:0.034312982112169266, decouple_loss:0.01090014073997736
loss_pred:0.03268599882721901, decouple_loss:0.011309784837067127
WV_0_PC_0_EH_1_PS_40, loss: 0.0339401513338089, avg_mse: 0.04681980237364769
current test mse: 0.04682
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 1961, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4524157643318176
loss_pred:0.02267889864742756, decouple_loss:0.010433428920805454
The generated pressure mean: 0.4511308968067169
loss_pred:0.023449096828699112, decouple_loss:0.010733935050666332
The generated pressure mean: 0.4484972655773163
loss_pred:0.022019734606146812, decouple_loss:0.01057662907987833
Iteration: 1962, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44499996304512024
The generated pressure mean: 0.4461953341960907
loss_pred:0.02150753326714039, decouple_loss:0.01036459393799305
loss_pred:0.022035658359527588, decouple_loss:0.010414195246994495
The generated pressure mean: 0.4449211359024048
loss_pred:0.022230397909879684, decouple_loss:0.010310759767889977
Iteration: 1963, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499076306819916
loss_pred:0.020973721519112587, decouple_loss:0.009690211154520512
The generated pressure mean: 0.4546809494495392
loss_pred:0.021828360855579376, decouple_loss:0.0093541843816638
The generated pressure mean: 0.44921308755874634
loss_pred:0.023011593148112297, decouple_loss:0.009602287784218788
Iteration: 1964, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4430495500564575
loss_pred:0.02210983633995056, decouple_loss:0.009492126293480396
The generated pressure mean: 0.4402337968349457
loss_pred:0.022312361747026443, decouple_loss:0.009440679103136063
The generated pressure mean: 0.4483391046524048
loss_pred:0.022052938118577003, decouple_loss:0.009626543149352074
Iteration: 1965, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43970900774002075
The generated pressure mean: 0.441131591796875
loss_pred:0.020902447402477264, decouple_loss:0.009547175839543343
loss_pred:0.021192673593759537, decouple_loss:0.009565075859427452
The generated pressure mean: 0.4447072148323059
loss_pred:0.022261183708906174, decouple_loss:0.009571737609803677
Iteration: 1966, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4457460343837738
loss_pred:0.023122884333133698, decouple_loss:0.009977070614695549
The generated pressure mean: 0.44838622212409973
loss_pred:0.021743865683674812, decouple_loss:0.009660693816840649
The generated pressure mean: 0.4456588327884674
loss_pred:0.021723145619034767, decouple_loss:0.009596407413482666
Iteration: 1967, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45152467489242554
loss_pred:0.02303270250558853, decouple_loss:0.011042295023798943
The generated pressure mean: 0.45278239250183105
loss_pred:0.02188464067876339, decouple_loss:0.010971909388899803
The generated pressure mean: 0.4514751732349396
loss_pred:0.023377561941742897, decouple_loss:0.01102315355092287
Iteration: 1968, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44748640060424805
loss_pred:0.023044802248477936, decouple_loss:0.009031157940626144
The generated pressure mean: 0.44282564520835876
loss_pred:0.02217448502779007, decouple_loss:0.009000347927212715
The generated pressure mean: 0.4519496262073517
loss_pred:0.0217291209846735, decouple_loss:0.009195361286401749
Iteration: 1969, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44516557455062866
loss_pred:0.021466929465532303, decouple_loss:0.009990619495511055
The generated pressure mean: 0.44810834527015686
loss_pred:0.021467894315719604, decouple_loss:0.00996219553053379
The generated pressure mean: 0.4486217200756073
loss_pred:0.021958889439702034, decouple_loss:0.010000965557992458
Iteration: 1970, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467712938785553
The generated pressure mean: 0.4453791677951813
loss_pred:0.02288065105676651, decouple_loss:0.011208425275981426
loss_pred:0.02241903729736805, decouple_loss:0.011072184890508652
The generated pressure mean: 0.4439547061920166
loss_pred:0.02138703316450119, decouple_loss:0.011121095158159733
2023-04-16 19:37:32 testing...
The generated pressure mean: 0.4176046550273895
The generated pressure mean: 0.4247235357761383
loss_pred:0.03330037742853165, decouple_loss:0.012743933126330376
The generated pressure mean: 0.4270927906036377
loss_pred:0.03209669142961502, decouple_loss:0.013053631410002708
loss_pred:0.03153562545776367, decouple_loss:0.013232152909040451
WV_0_PC_0_EH_1_PS_40, loss: 0.032961394637823105, avg_mse: 0.045056648552417755
current test mse: 0.045057
Iteration: 1971, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471297562122345The generated pressure mean: 0.44515737891197205
loss_pred:0.022541625425219536, decouple_loss:0.012509673833847046
loss_pred:0.022521480917930603, decouple_loss:0.012329679913818836
The generated pressure mean: 0.4446604251861572
loss_pred:0.021897342056035995, decouple_loss:0.012260162271559238
Iteration: 1972, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4421195387840271
The generated pressure mean: 0.4412621557712555
loss_pred:0.022721683606505394, decouple_loss:0.011547664180397987
loss_pred:0.022048989310860634, decouple_loss:0.011280335485935211
The generated pressure mean: 0.44293835759162903
loss_pred:0.022677378728985786, decouple_loss:0.011419227346777916
Iteration: 1973, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4519580900669098
loss_pred:0.02386263944208622, decouple_loss:0.009140421636402607
The generated pressure mean: 0.45427340269088745
loss_pred:0.023061223328113556, decouple_loss:0.009208573959767818
The generated pressure mean: 0.4571665823459625
loss_pred:0.023410094901919365, decouple_loss:0.009148641489446163
Iteration: 1974, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.438581258058548
loss_pred:0.022199586033821106, decouple_loss:0.010467501357197762
The generated pressure mean: 0.44152000546455383
loss_pred:0.02219577319920063, decouple_loss:0.010589017532765865
The generated pressure mean: 0.4418374300003052
loss_pred:0.02178686112165451, decouple_loss:0.010722045786678791
Iteration: 1975, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473362863063812
loss_pred:0.02336115762591362, decouple_loss:0.012246483936905861
The generated pressure mean: 0.45364904403686523
loss_pred:0.022900469601154327, decouple_loss:0.012034771032631397
The generated pressure mean: 0.4502965211868286
loss_pred:0.021520763635635376, decouple_loss:0.01197650283575058
Iteration: 1976, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4418730139732361
loss_pred:0.02113163284957409, decouple_loss:0.00970515888184309
The generated pressure mean: 0.4497045874595642
loss_pred:0.02191660925745964, decouple_loss:0.00982089526951313
The generated pressure mean: 0.4500851333141327
loss_pred:0.023129398003220558, decouple_loss:0.009662134572863579
Iteration: 1977, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442473351955414
loss_pred:0.021769892424345016, decouple_loss:0.009865115396678448
The generated pressure mean: 0.44684767723083496
loss_pred:0.021141275763511658, decouple_loss:0.009770449250936508
The generated pressure mean: 0.447815865278244
loss_pred:0.021944917738437653, decouple_loss:0.009863520972430706
Iteration: 1978, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489981532096863
loss_pred:0.022828280925750732, decouple_loss:0.011236008256673813
The generated pressure mean: 0.44620880484580994
loss_pred:0.02179541066288948, decouple_loss:0.011242243461310863
The generated pressure mean: 0.4492052495479584
loss_pred:0.02299804799258709, decouple_loss:0.011148407123982906
Iteration: 1979, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.441893070936203The generated pressure mean: 0.44141003489494324
loss_pred:0.021150164306163788, decouple_loss:0.010934452526271343
loss_pred:0.02212284691631794, decouple_loss:0.01090993732213974
The generated pressure mean: 0.44073599576950073
loss_pred:0.021976150572299957, decouple_loss:0.011036582291126251
Iteration: 1980, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4426085650920868
loss_pred:0.02213272824883461, decouple_loss:0.010449041612446308
The generated pressure mean: 0.44695863127708435
loss_pred:0.021856479346752167, decouple_loss:0.010540562681853771
The generated pressure mean: 0.4432387948036194
loss_pred:0.022856133058667183, decouple_loss:0.010512159205973148
2023-04-16 19:39:25 testing...
The generated pressure mean: 0.41379860043525696
The generated pressure mean: 0.42074277997016907
loss_pred:0.03450433909893036, decouple_loss:0.011371576227247715
The generated pressure mean: 0.42367273569107056
loss_pred:0.033467620611190796, decouple_loss:0.011702148243784904
loss_pred:0.03273870423436165, decouple_loss:0.011856423690915108
WV_0_PC_0_EH_1_PS_40, loss: 0.03415239229798317, avg_mse: 0.04749026894569397
current test mse: 0.04749
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 1981, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45763587951660156
loss_pred:0.022198060527443886, decouple_loss:0.010862555354833603
The generated pressure mean: 0.4575541913509369
loss_pred:0.021964464336633682, decouple_loss:0.010739046148955822
The generated pressure mean: 0.4613334834575653
loss_pred:0.02107640542089939, decouple_loss:0.011003460735082626
Iteration: 1982, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45343413949012756
loss_pred:0.021524915471673012, decouple_loss:0.010922474786639214
The generated pressure mean: 0.4483408033847809
loss_pred:0.021343860775232315, decouple_loss:0.010892466641962528
The generated pressure mean: 0.4485374093055725
loss_pred:0.021329451352357864, decouple_loss:0.010852435603737831
Iteration: 1983, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4391075074672699
loss_pred:0.02128547802567482, decouple_loss:0.010480381548404694
The generated pressure mean: 0.44048038125038147
loss_pred:0.0216487068682909, decouple_loss:0.010344499722123146
The generated pressure mean: 0.4410429000854492
loss_pred:0.02127048186957836, decouple_loss:0.010448338463902473
Iteration: 1984, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466038942337036
loss_pred:0.022363785654306412, decouple_loss:0.010188058950006962
The generated pressure mean: 0.44734987616539
loss_pred:0.02125789411365986, decouple_loss:0.010372575372457504
The generated pressure mean: 0.45036718249320984
loss_pred:0.022248370572924614, decouple_loss:0.010241979733109474
Iteration: 1985, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44961175322532654
loss_pred:0.020510753616690636, decouple_loss:0.011157944798469543
The generated pressure mean: 0.44572529196739197
loss_pred:0.022022174671292305, decouple_loss:0.01169107761234045
The generated pressure mean: 0.44523531198501587
loss_pred:0.02250824309885502, decouple_loss:0.01171133853495121
Iteration: 1986, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446628600358963
loss_pred:0.024110469967126846, decouple_loss:0.0113653764128685
The generated pressure mean: 0.4426485002040863
loss_pred:0.02279818430542946, decouple_loss:0.011322489939630032
The generated pressure mean: 0.4404974579811096
loss_pred:0.023036735132336617, decouple_loss:0.01126619428396225
Iteration: 1987, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467102587223053
loss_pred:0.02168601006269455, decouple_loss:0.009797953069210052
The generated pressure mean: 0.44609978795051575
loss_pred:0.021365918219089508, decouple_loss:0.009859682992100716
The generated pressure mean: 0.44562584161758423
loss_pred:0.02170545607805252, decouple_loss:0.010064476169645786
Iteration: 1988, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4591009020805359
loss_pred:0.021500570699572563, decouple_loss:0.01030683983117342
The generated pressure mean: 0.457074373960495
loss_pred:0.022794654592871666, decouple_loss:0.010540353134274483
The generated pressure mean: 0.45749640464782715
loss_pred:0.022920090705156326, decouple_loss:0.010488984175026417
Iteration: 1989, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44143855571746826
loss_pred:0.02153649739921093, decouple_loss:0.010144009254872799
The generated pressure mean: 0.434726744890213
loss_pred:0.02291417494416237, decouple_loss:0.00992327556014061
The generated pressure mean: 0.438616544008255
loss_pred:0.02242172136902809, decouple_loss:0.009938394650816917
Iteration: 1990, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4447952210903168
The generated pressure mean: 0.43984436988830566
loss_pred:0.020527413114905357, decouple_loss:0.01081849355250597
loss_pred:0.023013830184936523, decouple_loss:0.010860387235879898
The generated pressure mean: 0.4424099624156952
loss_pred:0.022477321326732635, decouple_loss:0.01096316333860159
2023-04-16 19:42:00 testing...
The generated pressure mean: 0.415315181016922
The generated pressure mean: 0.4215068817138672
loss_pred:0.03362787887454033, decouple_loss:0.011797527782619
The generated pressure mean: 0.4241441786289215
loss_pred:0.03265160694718361, decouple_loss:0.011970153078436852
loss_pred:0.03220197930932045, decouple_loss:0.012096981517970562
WV_0_PC_0_EH_1_PS_40, loss: 0.03342490270733833, avg_mse: 0.04598148167133331
current test mse: 0.045981
Iteration: 1991, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45323631167411804
The generated pressure mean: 0.45381423830986023
loss_pred:0.022143002599477768, decouple_loss:0.011187986470758915
loss_pred:0.021430807188153267, decouple_loss:0.01120444294065237
The generated pressure mean: 0.4499739110469818
loss_pred:0.021243317052721977, decouple_loss:0.011180471628904343
Iteration: 1992, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479098320007324
The generated pressure mean: 0.45151349902153015
loss_pred:0.022417012602090836, decouple_loss:0.010028827004134655
loss_pred:0.021387476474046707, decouple_loss:0.01036921888589859
The generated pressure mean: 0.4529391825199127
loss_pred:0.020761074498295784, decouple_loss:0.01006906945258379
Iteration: 1993, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461583197116852
The generated pressure mean: 0.4455460011959076loss_pred:0.02072286047041416, decouple_loss:0.009386565536260605
loss_pred:0.021497013047337532, decouple_loss:0.009490716271102428
The generated pressure mean: 0.4437156319618225
loss_pred:0.023359596729278564, decouple_loss:0.009443237446248531
Iteration: 1994, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4451015591621399
The generated pressure mean: 0.4420701861381531
loss_pred:0.022861512377858162, decouple_loss:0.009624584577977657
loss_pred:0.020631279796361923, decouple_loss:0.009535771794617176
The generated pressure mean: 0.44693395495414734
loss_pred:0.021193161606788635, decouple_loss:0.009519532322883606
Iteration: 1995, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44985052943229675
The generated pressure mean: 0.4459531903266907
loss_pred:0.022730648517608643, decouple_loss:0.010742608457803726
loss_pred:0.021593837067484856, decouple_loss:0.010471493937075138
The generated pressure mean: 0.4464942216873169
loss_pred:0.020690536126494408, decouple_loss:0.010704669170081615
Iteration: 1996, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45215439796447754
The generated pressure mean: 0.4515497386455536
loss_pred:0.02234247699379921, decouple_loss:0.012282345443964005
loss_pred:0.022650226950645447, decouple_loss:0.012513271532952785
The generated pressure mean: 0.45021921396255493
loss_pred:0.022717274725437164, decouple_loss:0.012410461902618408
Iteration: 1997, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4325246810913086
The generated pressure mean: 0.4372931122779846
loss_pred:0.023842912167310715, decouple_loss:0.01107349805533886
loss_pred:0.021095769479870796, decouple_loss:0.011198966763913631
The generated pressure mean: 0.43834203481674194
loss_pred:0.02159894071519375, decouple_loss:0.011005381122231483
Iteration: 1998, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480274021625519
The generated pressure mean: 0.4466154873371124
loss_pred:0.02230864204466343, decouple_loss:0.009644846431910992
loss_pred:0.022188477218151093, decouple_loss:0.009847883135080338
The generated pressure mean: 0.45092421770095825
loss_pred:0.02216658927500248, decouple_loss:0.009618880227208138
Iteration: 1999, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46660101413726807The generated pressure mean: 0.4660910964012146
loss_pred:0.022743208333849907, decouple_loss:0.009683368727564812
loss_pred:0.020773455500602722, decouple_loss:0.009624972008168697
The generated pressure mean: 0.46451202034950256
loss_pred:0.022013511508703232, decouple_loss:0.009573837742209435
Iteration: 2000, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4438464641571045
loss_pred:0.02156415395438671, decouple_loss:0.010019331239163876
The generated pressure mean: 0.44176724553108215
loss_pred:0.022027982398867607, decouple_loss:0.009955262765288353
The generated pressure mean: 0.43871021270751953
loss_pred:0.02079240046441555, decouple_loss:0.009966911748051643
2023-04-16 19:43:54 itr: 2000
training loss: [0.02129075 0.02206512 0.02252575]
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_0_EH_1_PS_40/model_2000.ckpt
2023-04-16 19:43:58 testing...
The generated pressure mean: 0.42049574851989746
The generated pressure mean: 0.4266390800476074
The generated pressure mean: 0.4291769564151764
loss_pred:0.03324643895030022, decouple_loss:0.01126723550260067
loss_pred:0.03213591128587723, decouple_loss:0.011497634463012218
loss_pred:0.03174637630581856, decouple_loss:0.011711539700627327
WV_0_PC_0_EH_1_PS_40, loss: 0.03295084834098816, avg_mse: 0.04511618986725807
current test mse: 0.045116
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 2001, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.430258572101593
loss_pred:0.02074824459850788, decouple_loss:0.010925774462521076
The generated pressure mean: 0.4323634207248688
loss_pred:0.02229260839521885, decouple_loss:0.010991658084094524
The generated pressure mean: 0.43439191579818726
loss_pred:0.02339862659573555, decouple_loss:0.011017099022865295
Iteration: 2002, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442980885505676
The generated pressure mean: 0.4474047124385834loss_pred:0.02347015030682087, decouple_loss:0.010103424079716206
loss_pred:0.022220619022846222, decouple_loss:0.009974967688322067
The generated pressure mean: 0.4434320032596588
loss_pred:0.022008812054991722, decouple_loss:0.009921368211507797
Iteration: 2003, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4532025456428528
The generated pressure mean: 0.4539320468902588
loss_pred:0.02172788977622986, decouple_loss:0.009347262792289257
loss_pred:0.021634263917803764, decouple_loss:0.00937793031334877
The generated pressure mean: 0.4551633596420288
loss_pred:0.0213340874761343, decouple_loss:0.009492400102317333
Iteration: 2004, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45966100692749023
The generated pressure mean: 0.458978533744812
loss_pred:0.021616823971271515, decouple_loss:0.009959334507584572
loss_pred:0.02164229191839695, decouple_loss:0.009904736652970314
The generated pressure mean: 0.4582729637622833
loss_pred:0.02153780497610569, decouple_loss:0.010013462975621223
Iteration: 2005, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485083520412445
loss_pred:0.02335287444293499, decouple_loss:0.010929207317531109
The generated pressure mean: 0.4483528137207031
loss_pred:0.023533036932349205, decouple_loss:0.010684605687856674
The generated pressure mean: 0.44791167974472046
loss_pred:0.022631047293543816, decouple_loss:0.010776405222713947
Iteration: 2006, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42442336678504944The generated pressure mean: 0.4303112030029297
loss_pred:0.022039931267499924, decouple_loss:0.010795908980071545
loss_pred:0.021074384450912476, decouple_loss:0.010701014660298824
The generated pressure mean: 0.43049269914627075
loss_pred:0.022372422739863396, decouple_loss:0.010662665590643883
Iteration: 2007, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44434282183647156
The generated pressure mean: 0.4407944083213806
loss_pred:0.021559955552220345, decouple_loss:0.009895476512610912
loss_pred:0.02204451523721218, decouple_loss:0.009897704236209393
The generated pressure mean: 0.44471296668052673
loss_pred:0.022820215672254562, decouple_loss:0.00987045094370842
Iteration: 2008, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45413264632225037
loss_pred:0.021927274763584137, decouple_loss:0.010048861615359783
The generated pressure mean: 0.45248761773109436
The generated pressure mean: 0.4542873203754425
loss_pred:0.02279123291373253, decouple_loss:0.009980638511478901
loss_pred:0.021595491096377373, decouple_loss:0.010035727173089981
Iteration: 2009, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465699791908264
loss_pred:0.023118792101740837, decouple_loss:0.010280830785632133
The generated pressure mean: 0.4532994329929352
The generated pressure mean: 0.45281079411506653
loss_pred:0.021860675886273384, decouple_loss:0.010145503096282482
loss_pred:0.02355627529323101, decouple_loss:0.01019933819770813
Iteration: 2010, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45147886872291565
loss_pred:0.022834615781903267, decouple_loss:0.010564291849732399
The generated pressure mean: 0.4502224624156952
loss_pred:0.02116602472960949, decouple_loss:0.010530775412917137
The generated pressure mean: 0.4496309459209442
loss_pred:0.021492747589945793, decouple_loss:0.010534966364502907
2023-04-16 19:46:28 testing...
The generated pressure mean: 0.4167020916938782
The generated pressure mean: 0.4233730733394623
The generated pressure mean: 0.42601311206817627
loss_pred:0.0330938845872879, decouple_loss:0.010090945288538933
loss_pred:0.031532738357782364, decouple_loss:0.010344551876187325
loss_pred:0.03144317492842674, decouple_loss:0.010456331074237823
WV_0_PC_0_EH_1_PS_40, loss: 0.03253813087940216, avg_mse: 0.044776905328035355
current test mse: 0.044777
Iteration: 2011, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502606689929962
loss_pred:0.021516093984246254, decouple_loss:0.009435754269361496
The generated pressure mean: 0.4446823298931122
loss_pred:0.021433236077427864, decouple_loss:0.009750022552907467
The generated pressure mean: 0.43929556012153625
loss_pred:0.022445492446422577, decouple_loss:0.009623255580663681
Iteration: 2012, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4378328323364258
The generated pressure mean: 0.4424777328968048
loss_pred:0.022788645699620247, decouple_loss:0.00959836132824421
loss_pred:0.02389013022184372, decouple_loss:0.009660612791776657
The generated pressure mean: 0.44920143485069275
loss_pred:0.023073667660355568, decouple_loss:0.009740342386066914
Iteration: 2013, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44629615545272827
The generated pressure mean: 0.4494503140449524
loss_pred:0.0219824630767107, decouple_loss:0.010188807733356953
loss_pred:0.022252652794122696, decouple_loss:0.009944084100425243
The generated pressure mean: 0.4406408965587616
loss_pred:0.021801769733428955, decouple_loss:0.010110551491379738
Iteration: 2014, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44485044479370117
The generated pressure mean: 0.44853565096855164
loss_pred:0.022606683894991875, decouple_loss:0.010320411063730717
loss_pred:0.02332681603729725, decouple_loss:0.010281477123498917
The generated pressure mean: 0.449787974357605
loss_pred:0.021787112578749657, decouple_loss:0.01000240072607994
Iteration: 2015, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476233124732971The generated pressure mean: 0.44195571541786194
loss_pred:0.02235778607428074, decouple_loss:0.010332983918488026
loss_pred:0.022066105157136917, decouple_loss:0.010379254817962646
The generated pressure mean: 0.4448471665382385
loss_pred:0.022066708654165268, decouple_loss:0.010359116829931736
Iteration: 2016, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4539351165294647
The generated pressure mean: 0.44627633690834045
loss_pred:0.02248673141002655, decouple_loss:0.0102413734421134
loss_pred:0.02238115668296814, decouple_loss:0.01034077163785696
The generated pressure mean: 0.44373786449432373
loss_pred:0.022471847012639046, decouple_loss:0.010303834453225136
Iteration: 2017, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499935805797577
The generated pressure mean: 0.447632759809494
loss_pred:0.022136826068162918, decouple_loss:0.010776100680232048
loss_pred:0.021798377856612206, decouple_loss:0.010549133643507957
The generated pressure mean: 0.4446241557598114
loss_pred:0.022496413439512253, decouple_loss:0.01046170573681593
Iteration: 2018, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466266930103302
loss_pred:0.02331116423010826, decouple_loss:0.009957319125533104
The generated pressure mean: 0.45051267743110657
loss_pred:0.0223226435482502, decouple_loss:0.00986277125775814
The generated pressure mean: 0.44951364398002625
loss_pred:0.024303816258907318, decouple_loss:0.009823936969041824
Iteration: 2019, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44193530082702637
The generated pressure mean: 0.4500404894351959
loss_pred:0.02413230389356613, decouple_loss:0.009996955282986164
loss_pred:0.021976202726364136, decouple_loss:0.00995159987360239
The generated pressure mean: 0.4486277997493744
loss_pred:0.0222227331250906, decouple_loss:0.010187329724431038
Iteration: 2020, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44016245007514954
loss_pred:0.022890139371156693, decouple_loss:0.009786782786250114
The generated pressure mean: 0.44358158111572266
loss_pred:0.021532289683818817, decouple_loss:0.009836498647928238
The generated pressure mean: 0.44857507944107056
loss_pred:0.021923772990703583, decouple_loss:0.009953148663043976
2023-04-16 19:48:21 testing...
The generated pressure mean: 0.41643890738487244
The generated pressure mean: 0.42277082800865173
loss_pred:0.03313760831952095, decouple_loss:0.00982652697712183
The generated pressure mean: 0.42536717653274536
loss_pred:0.031674426048994064, decouple_loss:0.009950371459126472
loss_pred:0.031421780586242676, decouple_loss:0.010144954547286034
WV_0_PC_0_EH_1_PS_40, loss: 0.03257663547992706, avg_mse: 0.044761303812265396
current test mse: 0.044761
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 2021, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.444821834564209
loss_pred:0.021085640415549278, decouple_loss:0.009507863782346249
The generated pressure mean: 0.4494837820529938
loss_pred:0.02152450941503048, decouple_loss:0.009462106041610241
The generated pressure mean: 0.44799333810806274
loss_pred:0.020030919462442398, decouple_loss:0.009557864628732204
Iteration: 2022, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4570675194263458
loss_pred:0.024494951590895653, decouple_loss:0.009515506215393543
The generated pressure mean: 0.4548823833465576
loss_pred:0.02334592305123806, decouple_loss:0.009373161010444164
The generated pressure mean: 0.45165255665779114
loss_pred:0.022599345073103905, decouple_loss:0.009398997761309147
Iteration: 2023, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43409404158592224
loss_pred:0.023424779996275902, decouple_loss:0.010653883218765259
The generated pressure mean: 0.4317609965801239
loss_pred:0.022389497607946396, decouple_loss:0.010721615515649319
The generated pressure mean: 0.4334825873374939
loss_pred:0.02204856276512146, decouple_loss:0.010603654198348522
Iteration: 2024, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44611674547195435
loss_pred:0.02293715626001358, decouple_loss:0.011697748675942421
The generated pressure mean: 0.4445781409740448
loss_pred:0.022530291229486465, decouple_loss:0.011661347001791
The generated pressure mean: 0.4539549946784973
loss_pred:0.02115701138973236, decouple_loss:0.011857174336910248
Iteration: 2025, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45733654499053955
loss_pred:0.022123415023088455, decouple_loss:0.010016072541475296
The generated pressure mean: 0.4654718339443207
loss_pred:0.021921655163168907, decouple_loss:0.010274825617671013
The generated pressure mean: 0.45675787329673767
loss_pred:0.021578682586550713, decouple_loss:0.010249000042676926
Iteration: 2026, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45272648334503174
loss_pred:0.021962743252515793, decouple_loss:0.010277432389557362
The generated pressure mean: 0.44921010732650757
loss_pred:0.02189524658024311, decouple_loss:0.010341082699596882
The generated pressure mean: 0.45403730869293213
loss_pred:0.021684033796191216, decouple_loss:0.010338177904486656
Iteration: 2027, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.434820294380188
loss_pred:0.02112940512597561, decouple_loss:0.009843128733336926
The generated pressure mean: 0.4327743351459503
loss_pred:0.021714825183153152, decouple_loss:0.009957357309758663
The generated pressure mean: 0.42934587597846985
loss_pred:0.021756304427981377, decouple_loss:0.009776185266673565
Iteration: 2028, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44864892959594727
loss_pred:0.021394556388258934, decouple_loss:0.010835482738912106
The generated pressure mean: 0.4482806622982025
loss_pred:0.0233174916356802, decouple_loss:0.010920668952167034
The generated pressure mean: 0.4428676664829254
loss_pred:0.021651165559887886, decouple_loss:0.010872035287320614
Iteration: 2029, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45061302185058594
loss_pred:0.02280503511428833, decouple_loss:0.01031695306301117
The generated pressure mean: 0.45337849855422974
loss_pred:0.022504569962620735, decouple_loss:0.010210047475993633
The generated pressure mean: 0.45821613073349
loss_pred:0.022369354963302612, decouple_loss:0.01018546987324953
Iteration: 2030, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44621193408966064
loss_pred:0.021397624164819717, decouple_loss:0.009657665155827999
The generated pressure mean: 0.44495758414268494
The generated pressure mean: 0.4404616951942444
loss_pred:0.022278016433119774, decouple_loss:0.009635534137487411
loss_pred:0.021740462630987167, decouple_loss:0.009639974683523178
2023-04-16 19:50:49 testing...
The generated pressure mean: 0.41625547409057617
The generated pressure mean: 0.42331013083457947
loss_pred:0.03309682756662369, decouple_loss:0.010356634855270386
The generated pressure mean: 0.42583590745925903
loss_pred:0.032005757093429565, decouple_loss:0.010631169192492962
loss_pred:0.03132928907871246, decouple_loss:0.010806649923324585
WV_0_PC_0_EH_1_PS_40, loss: 0.03267386555671692, avg_mse: 0.04501214250922203
current test mse: 0.045012
Iteration: 2031, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45136764645576477
loss_pred:0.021163759753108025, decouple_loss:0.010095701552927494
The generated pressure mean: 0.45114827156066895
loss_pred:0.02217407338321209, decouple_loss:0.009932347573339939
The generated pressure mean: 0.44687485694885254
loss_pred:0.021182674914598465, decouple_loss:0.009966983459889889
Iteration: 2032, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44854462146759033
loss_pred:0.02084231562912464, decouple_loss:0.010682418011128902
The generated pressure mean: 0.44821596145629883
loss_pred:0.02146509848535061, decouple_loss:0.010813976638019085
The generated pressure mean: 0.4454042911529541
loss_pred:0.02128947339951992, decouple_loss:0.010794700123369694
Iteration: 2033, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4436185956001282
loss_pred:0.022813964635133743, decouple_loss:0.010349313728511333
The generated pressure mean: 0.4450766146183014
loss_pred:0.021888557821512222, decouple_loss:0.010354054160416126
The generated pressure mean: 0.4467945694923401
loss_pred:0.02168329991400242, decouple_loss:0.010638783685863018
Iteration: 2034, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4391971230506897
loss_pred:0.020183857530355453, decouple_loss:0.009264646098017693
The generated pressure mean: 0.438701331615448
loss_pred:0.021519172936677933, decouple_loss:0.009524103254079819
The generated pressure mean: 0.4435654580593109
loss_pred:0.02142506279051304, decouple_loss:0.009514069184660912
Iteration: 2035, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44709905982017517
loss_pred:0.021286819130182266, decouple_loss:0.009409052319824696
The generated pressure mean: 0.4475472867488861
loss_pred:0.022580398246645927, decouple_loss:0.009595652110874653
The generated pressure mean: 0.44868215918540955
loss_pred:0.020720282569527626, decouple_loss:0.009287027642130852
Iteration: 2036, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45531001687049866
loss_pred:0.021815871819853783, decouple_loss:0.009752007201313972
The generated pressure mean: 0.459037184715271
loss_pred:0.022781047970056534, decouple_loss:0.009624037891626358
The generated pressure mean: 0.46159788966178894
loss_pred:0.022444207221269608, decouple_loss:0.009705650620162487
Iteration: 2037, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471331834793091
loss_pred:0.020562296733260155, decouple_loss:0.010421657003462315
The generated pressure mean: 0.4458833336830139
loss_pred:0.021361809223890305, decouple_loss:0.01033718790858984
The generated pressure mean: 0.4437081515789032
loss_pred:0.022074401378631592, decouple_loss:0.010534602217376232
Iteration: 2038, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43580567836761475
loss_pred:0.021392693743109703, decouple_loss:0.009341283701360226
The generated pressure mean: 0.43978917598724365
loss_pred:0.023387644439935684, decouple_loss:0.009377066045999527
The generated pressure mean: 0.4420398473739624
loss_pred:0.02271643839776516, decouple_loss:0.00923218671232462
Iteration: 2039, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44712668657302856
The generated pressure mean: 0.44754403829574585
loss_pred:0.02070041559636593, decouple_loss:0.009820425882935524
loss_pred:0.022821426391601562, decouple_loss:0.009678727947175503
The generated pressure mean: 0.4456048607826233
loss_pred:0.02086617797613144, decouple_loss:0.009628086350858212
Iteration: 2040, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45138731598854065
loss_pred:0.021555693820118904, decouple_loss:0.01007076632231474
The generated pressure mean: 0.4550797939300537
loss_pred:0.02050008997321129, decouple_loss:0.010173831135034561
The generated pressure mean: 0.4490433931350708
loss_pred:0.021382354199886322, decouple_loss:0.009927318431437016
2023-04-16 19:52:42 testing...
The generated pressure mean: 0.4150695502758026
The generated pressure mean: 0.42178967595100403
loss_pred:0.03348580375313759, decouple_loss:0.00967343058437109
The generated pressure mean: 0.4240817427635193
loss_pred:0.03218520060181618, decouple_loss:0.0098831532523036
loss_pred:0.031864915043115616, decouple_loss:0.0100336205214262
WV_0_PC_0_EH_1_PS_40, loss: 0.03300514444708824, avg_mse: 0.045634955167770386
current test mse: 0.045635
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 2041, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44999581575393677
loss_pred:0.02062518522143364, decouple_loss:0.00933642964810133
The generated pressure mean: 0.4558020830154419
loss_pred:0.02112145721912384, decouple_loss:0.009441527538001537
The generated pressure mean: 0.44913744926452637
loss_pred:0.02197767235338688, decouple_loss:0.009379372000694275
Iteration: 2042, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4422326683998108
loss_pred:0.021735647693276405, decouple_loss:0.00909347739070654
The generated pressure mean: 0.4473651945590973
loss_pred:0.020328499376773834, decouple_loss:0.009168162010610104
The generated pressure mean: 0.4423268437385559
loss_pred:0.020717613399028778, decouple_loss:0.009213009849190712
Iteration: 2043, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4434093236923218
The generated pressure mean: 0.44056034088134766loss_pred:0.02070688083767891, decouple_loss:0.009712702594697475
loss_pred:0.020731758326292038, decouple_loss:0.00978307705372572
The generated pressure mean: 0.43776407837867737
loss_pred:0.021029505878686905, decouple_loss:0.009757155552506447
Iteration: 2044, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499998092651367
The generated pressure mean: 0.4494408071041107
loss_pred:0.021512990817427635, decouple_loss:0.010993999429047108
loss_pred:0.02417154796421528, decouple_loss:0.011208848096430302
The generated pressure mean: 0.450909286737442
loss_pred:0.02159292623400688, decouple_loss:0.011041038669645786
Iteration: 2045, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44083842635154724
loss_pred:0.021317098289728165, decouple_loss:0.011495777405798435
The generated pressure mean: 0.44675007462501526
loss_pred:0.020637616515159607, decouple_loss:0.011265113018453121
The generated pressure mean: 0.4429827928543091
loss_pred:0.020572809502482414, decouple_loss:0.011483816429972649
Iteration: 2046, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45271703600883484
loss_pred:0.021992146968841553, decouple_loss:0.01003241166472435
The generated pressure mean: 0.4511222541332245
loss_pred:0.021636422723531723, decouple_loss:0.010211454704403877
The generated pressure mean: 0.45590940117836
loss_pred:0.02073451317846775, decouple_loss:0.009939647279679775
Iteration: 2047, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44706642627716064
The generated pressure mean: 0.4488968551158905
loss_pred:0.021693577989935875, decouple_loss:0.008349093608558178
loss_pred:0.02122562751173973, decouple_loss:0.008473974652588367
The generated pressure mean: 0.44702523946762085
loss_pred:0.022155459970235825, decouple_loss:0.00841858983039856
Iteration: 2048, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508756101131439
loss_pred:0.021605459973216057, decouple_loss:0.008971363306045532
The generated pressure mean: 0.45128557085990906
loss_pred:0.021332263946533203, decouple_loss:0.009209390729665756
The generated pressure mean: 0.4499247372150421
loss_pred:0.021734129637479782, decouple_loss:0.009108449332416058
Iteration: 2049, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44081175327301025
loss_pred:0.019717538729310036, decouple_loss:0.010244620963931084
The generated pressure mean: 0.43900004029273987
loss_pred:0.021019604057073593, decouple_loss:0.01035463996231556
The generated pressure mean: 0.44162946939468384
loss_pred:0.021679304540157318, decouple_loss:0.010304195806384087
Iteration: 2050, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4444674551486969
loss_pred:0.020336702466011047, decouple_loss:0.00976264476776123
The generated pressure mean: 0.45020177960395813
loss_pred:0.02201778069138527, decouple_loss:0.00981023907661438
The generated pressure mean: 0.44403278827667236
loss_pred:0.020799873396754265, decouple_loss:0.009753691032528877
2023-04-16 19:55:11 testing...
The generated pressure mean: 0.41533163189888
The generated pressure mean: 0.42224156856536865
loss_pred:0.03432057425379753, decouple_loss:0.010142725892364979
The generated pressure mean: 0.42464813590049744
loss_pred:0.0331733264029026, decouple_loss:0.010203929618000984
loss_pred:0.03262374550104141, decouple_loss:0.01030703168362379
WV_0_PC_0_EH_1_PS_40, loss: 0.03388344496488571, avg_mse: 0.047346729785203934
current test mse: 0.047347
Iteration: 2051, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4587125778198242
loss_pred:0.021485624834895134, decouple_loss:0.009334725327789783
The generated pressure mean: 0.4465169608592987
loss_pred:0.021610520780086517, decouple_loss:0.009597333148121834
The generated pressure mean: 0.45120248198509216
loss_pred:0.021141601726412773, decouple_loss:0.009531661868095398
Iteration: 2052, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45065274834632874
loss_pred:0.022058865055441856, decouple_loss:0.009829624556005001
The generated pressure mean: 0.450714647769928
loss_pred:0.021614588797092438, decouple_loss:0.009826143272221088
The generated pressure mean: 0.4506016969680786
loss_pred:0.02225758507847786, decouple_loss:0.00999191589653492
Iteration: 2053, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43979158997535706
loss_pred:0.021485302597284317, decouple_loss:0.01066720113158226
The generated pressure mean: 0.44120270013809204
loss_pred:0.021626325324177742, decouple_loss:0.01044874731451273
The generated pressure mean: 0.43432897329330444
loss_pred:0.021828940138220787, decouple_loss:0.01060426514595747
Iteration: 2054, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44694727659225464
loss_pred:0.022570215165615082, decouple_loss:0.011914944276213646
The generated pressure mean: 0.4420100748538971
loss_pred:0.021983258426189423, decouple_loss:0.011874977499246597
The generated pressure mean: 0.4446040391921997
loss_pred:0.020808085799217224, decouple_loss:0.011884508654475212
Iteration: 2055, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45414718985557556
loss_pred:0.021222902461886406, decouple_loss:0.010045240633189678
The generated pressure mean: 0.45124727487564087
loss_pred:0.02181609347462654, decouple_loss:0.010075157508254051
The generated pressure mean: 0.45166143774986267
loss_pred:0.022418761625885963, decouple_loss:0.010126279667019844
Iteration: 2056, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46047505736351013
loss_pred:0.021394692361354828, decouple_loss:0.00927827414125204
The generated pressure mean: 0.45582717657089233
loss_pred:0.022112635895609856, decouple_loss:0.009012974798679352
The generated pressure mean: 0.4532356262207031
loss_pred:0.02320125326514244, decouple_loss:0.009211075492203236
Iteration: 2057, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44496509432792664
loss_pred:0.020503079518675804, decouple_loss:0.010465661995112896
The generated pressure mean: 0.4417176842689514
loss_pred:0.0213610976934433, decouple_loss:0.010746878571808338
The generated pressure mean: 0.44166886806488037
loss_pred:0.02079874463379383, decouple_loss:0.0107274129986763
Iteration: 2058, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481033384799957
loss_pred:0.022431636229157448, decouple_loss:0.010574761778116226
The generated pressure mean: 0.44445163011550903
loss_pred:0.021078161895275116, decouple_loss:0.010489162057638168
The generated pressure mean: 0.4416808784008026
loss_pred:0.021749727427959442, decouple_loss:0.010575520806014538
Iteration: 2059, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44613319635391235
loss_pred:0.02205491252243519, decouple_loss:0.011042855679988861
The generated pressure mean: 0.4513186514377594
loss_pred:0.021814068779349327, decouple_loss:0.011015238240361214
The generated pressure mean: 0.44845935702323914
loss_pred:0.020784718915820122, decouple_loss:0.010986756533384323
Iteration: 2060, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4444003105163574
loss_pred:0.021315552294254303, decouple_loss:0.010798657312989235
The generated pressure mean: 0.4416638910770416
loss_pred:0.021288687363266945, decouple_loss:0.011043737642467022
The generated pressure mean: 0.44637173414230347
loss_pred:0.020187078043818474, decouple_loss:0.01110456045717001
2023-04-16 19:57:04 testing...
The generated pressure mean: 0.415932834148407
The generated pressure mean: 0.4232963025569916
The generated pressure mean: 0.42528101801872253
loss_pred:0.03410396724939346, decouple_loss:0.010234135203063488
loss_pred:0.032969191670417786, decouple_loss:0.010400524362921715
loss_pred:0.03239854797720909, decouple_loss:0.010473730973899364
WV_0_PC_0_EH_1_PS_40, loss: 0.03367570787668228, avg_mse: 0.04677971452474594
current test mse: 0.04678
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 2061, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487382769584656
loss_pred:0.02280471660196781, decouple_loss:0.009764301590621471
The generated pressure mean: 0.44489777088165283
loss_pred:0.02377929538488388, decouple_loss:0.009721293114125729
The generated pressure mean: 0.44821515679359436
loss_pred:0.023563994094729424, decouple_loss:0.009888337925076485
Iteration: 2062, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4510648846626282
loss_pred:0.02264261245727539, decouple_loss:0.009431062266230583
The generated pressure mean: 0.4491206407546997
loss_pred:0.024280445650219917, decouple_loss:0.009451765567064285
The generated pressure mean: 0.44801485538482666
loss_pred:0.022626733407378197, decouple_loss:0.00954991765320301
Iteration: 2063, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45447444915771484
loss_pred:0.023089628666639328, decouple_loss:0.009735316038131714
The generated pressure mean: 0.45032647252082825
loss_pred:0.02239443175494671, decouple_loss:0.009822443127632141
The generated pressure mean: 0.45030632615089417
loss_pred:0.02267449162900448, decouple_loss:0.0095219686627388
Iteration: 2064, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4522339403629303
loss_pred:0.02157950960099697, decouple_loss:0.010789881460368633
The generated pressure mean: 0.45087093114852905
loss_pred:0.02188817970454693, decouple_loss:0.010923991911113262
The generated pressure mean: 0.45070451498031616
loss_pred:0.024584908038377762, decouple_loss:0.010917609557509422
Iteration: 2065, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44380253553390503
loss_pred:0.02355053834617138, decouple_loss:0.011853430420160294
The generated pressure mean: 0.4403665363788605
loss_pred:0.02231944352388382, decouple_loss:0.01170299667865038
The generated pressure mean: 0.44154345989227295
loss_pred:0.02222014218568802, decouple_loss:0.011968455277383327
Iteration: 2066, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442538619041443
loss_pred:0.021953197196125984, decouple_loss:0.010489078238606453
The generated pressure mean: 0.4453074336051941
loss_pred:0.020997555926442146, decouple_loss:0.010718953795731068
The generated pressure mean: 0.4478224813938141
loss_pred:0.02240949124097824, decouple_loss:0.010522675700485706
Iteration: 2067, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4532228708267212
loss_pred:0.02246507629752159, decouple_loss:0.009362472221255302
The generated pressure mean: 0.4517431855201721
loss_pred:0.024442341178655624, decouple_loss:0.009509840048849583
The generated pressure mean: 0.452899694442749
loss_pred:0.02226996049284935, decouple_loss:0.009396766312420368
Iteration: 2068, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.442997545003891
The generated pressure mean: 0.4407213032245636
loss_pred:0.023330088704824448, decouple_loss:0.009500283747911453
loss_pred:0.023573528975248337, decouple_loss:0.00941906776279211
The generated pressure mean: 0.4434627890586853
loss_pred:0.022858262062072754, decouple_loss:0.00940950307995081
Iteration: 2069, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45163771510124207
The generated pressure mean: 0.4452676475048065
loss_pred:0.02346966788172722, decouple_loss:0.009880486875772476
loss_pred:0.0222980584949255, decouple_loss:0.009593973867595196
The generated pressure mean: 0.4443277418613434
loss_pred:0.02227993682026863, decouple_loss:0.009701776318252087
Iteration: 2070, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45620355010032654
loss_pred:0.0232162494212389, decouple_loss:0.010653122328221798
The generated pressure mean: 0.45047372579574585
loss_pred:0.021245663985610008, decouple_loss:0.010755375027656555
The generated pressure mean: 0.45365750789642334
loss_pred:0.023012353107333183, decouple_loss:0.010791396722197533
2023-04-16 19:59:51 testing...
The generated pressure mean: 0.41408392786979675
The generated pressure mean: 0.4205124080181122
loss_pred:0.03376632556319237, decouple_loss:0.010376217775046825
The generated pressure mean: 0.4229440987110138
loss_pred:0.0328512080013752, decouple_loss:0.01041257381439209
loss_pred:0.03200383111834526, decouple_loss:0.010574381798505783
WV_0_PC_0_EH_1_PS_40, loss: 0.033396508544683456, avg_mse: 0.04635674133896828
current test mse: 0.046357
Iteration: 2071, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45778077840805054
loss_pred:0.02334051951766014, decouple_loss:0.009934830479323864
The generated pressure mean: 0.45507627725601196
loss_pred:0.022242721170186996, decouple_loss:0.00985066406428814
The generated pressure mean: 0.456059068441391
loss_pred:0.02289886213839054, decouple_loss:0.009976101107895374
Iteration: 2072, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44172072410583496
loss_pred:0.022502074018120766, decouple_loss:0.010112510994076729
The generated pressure mean: 0.4427284598350525
loss_pred:0.02286485955119133, decouple_loss:0.01002589613199234
The generated pressure mean: 0.44237440824508667
loss_pred:0.021605821326375008, decouple_loss:0.010066630318760872
Iteration: 2073, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4380854368209839
loss_pred:0.023879369720816612, decouple_loss:0.01023989450186491
The generated pressure mean: 0.44031229615211487
loss_pred:0.022732755169272423, decouple_loss:0.010183230973780155
The generated pressure mean: 0.4421219229698181
loss_pred:0.02243979088962078, decouple_loss:0.010215187445282936
Iteration: 2074, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466319680213928
loss_pred:0.02276970073580742, decouple_loss:0.010267754085361958
The generated pressure mean: 0.44806262850761414
loss_pred:0.02335410937666893, decouple_loss:0.010143639519810677
The generated pressure mean: 0.4464193284511566
loss_pred:0.022931749001145363, decouple_loss:0.010079310275614262
Iteration: 2075, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45680609345436096
loss_pred:0.02292107418179512, decouple_loss:0.009950484149158001
The generated pressure mean: 0.45284658670425415
loss_pred:0.02323514223098755, decouple_loss:0.009968417696654797
The generated pressure mean: 0.4508218467235565
loss_pred:0.024285608902573586, decouple_loss:0.009871360845863819
Iteration: 2076, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4544556736946106
loss_pred:0.021557671949267387, decouple_loss:0.009781327098608017
The generated pressure mean: 0.457740843296051
loss_pred:0.021308233961462975, decouple_loss:0.00979345478117466
The generated pressure mean: 0.45155560970306396
loss_pred:0.022175198420882225, decouple_loss:0.009843425825238228
Iteration: 2077, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.444503515958786
loss_pred:0.02103050798177719, decouple_loss:0.010225588455796242
The generated pressure mean: 0.44386106729507446
loss_pred:0.023059692233800888, decouple_loss:0.010377808474004269
The generated pressure mean: 0.4408475458621979
loss_pred:0.021185101941227913, decouple_loss:0.010364728048443794
Iteration: 2078, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471244215965271The generated pressure mean: 0.4473569691181183
loss_pred:0.021876031532883644, decouple_loss:0.009684269316494465
loss_pred:0.022578099742531776, decouple_loss:0.00972561165690422
The generated pressure mean: 0.44742801785469055
loss_pred:0.0220362339168787, decouple_loss:0.009877011179924011
Iteration: 2079, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45017382502555847
The generated pressure mean: 0.44868409633636475
loss_pred:0.02165157161653042, decouple_loss:0.009807365946471691
loss_pred:0.02165011316537857, decouple_loss:0.009740752167999744
The generated pressure mean: 0.4533107876777649
loss_pred:0.020662445574998856, decouple_loss:0.009843072853982449
Iteration: 2080, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44423824548721313
loss_pred:0.022476159036159515, decouple_loss:0.010144371539354324
The generated pressure mean: 0.44021639227867126
loss_pred:0.022454382851719856, decouple_loss:0.010244564153254032
The generated pressure mean: 0.45239880681037903
loss_pred:0.022903669625520706, decouple_loss:0.010551085695624352
2023-04-16 20:01:43 testing...
The generated pressure mean: 0.41625896096229553
The generated pressure mean: 0.4232977628707886
The generated pressure mean: 0.4259997606277466
loss_pred:0.0334634855389595, decouple_loss:0.011629147455096245
loss_pred:0.03218895196914673, decouple_loss:0.011651366017758846
loss_pred:0.03175019845366478, decouple_loss:0.011825388297438622
WV_0_PC_0_EH_1_PS_40, loss: 0.03305264562368393, avg_mse: 0.045764192938804626
current test mse: 0.045764
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 2081, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461340606212616
loss_pred:0.023087717592716217, decouple_loss:0.01122952625155449
The generated pressure mean: 0.4469878077507019
loss_pred:0.021811116486787796, decouple_loss:0.011297700926661491
The generated pressure mean: 0.4490196704864502
loss_pred:0.022470960393548012, decouple_loss:0.011152774095535278
Iteration: 2082, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499441683292389
loss_pred:0.021479368209838867, decouple_loss:0.010625380091369152
The generated pressure mean: 0.44833269715309143
loss_pred:0.021550660952925682, decouple_loss:0.01075731124728918
The generated pressure mean: 0.44477421045303345
loss_pred:0.022644884884357452, decouple_loss:0.010565463453531265
Iteration: 2083, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45203202962875366
The generated pressure mean: 0.44648444652557373
loss_pred:0.022484181448817253, decouple_loss:0.00920557789504528
loss_pred:0.021804330870509148, decouple_loss:0.009313549846410751
The generated pressure mean: 0.4454084634780884
loss_pred:0.021806739270687103, decouple_loss:0.009289787150919437
Iteration: 2084, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.450926810503006
loss_pred:0.020801115781068802, decouple_loss:0.009071554988622665
The generated pressure mean: 0.4522693455219269
loss_pred:0.023445947095751762, decouple_loss:0.008999191224575043
The generated pressure mean: 0.4517960846424103
loss_pred:0.021804507821798325, decouple_loss:0.009180789813399315
Iteration: 2085, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.450350284576416
The generated pressure mean: 0.45201465487480164loss_pred:0.021844616159796715, decouple_loss:0.00829977449029684
loss_pred:0.021824689581990242, decouple_loss:0.008433478884398937
The generated pressure mean: 0.45040345191955566
loss_pred:0.0223394762724638, decouple_loss:0.008435310795903206
Iteration: 2086, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4406318962574005
The generated pressure mean: 0.4446798861026764loss_pred:0.022798528894782066, decouple_loss:0.008776966482400894
loss_pred:0.02108289860188961, decouple_loss:0.008933810517191887
The generated pressure mean: 0.4424629211425781
loss_pred:0.021723484620451927, decouple_loss:0.008993304334580898
Iteration: 2087, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4511772096157074
loss_pred:0.02380863018333912, decouple_loss:0.009545094333589077
The generated pressure mean: 0.4520302414894104
loss_pred:0.02195087820291519, decouple_loss:0.009539885446429253
The generated pressure mean: 0.4505307078361511
loss_pred:0.021523568779230118, decouple_loss:0.009427067823708057
Iteration: 2088, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44358640909194946
loss_pred:0.02214289829134941, decouple_loss:0.00997647549957037
The generated pressure mean: 0.44495052099227905
The generated pressure mean: 0.447709858417511
loss_pred:0.02260909602046013, decouple_loss:0.010060214437544346
loss_pred:0.022302543744444847, decouple_loss:0.010110996663570404
Iteration: 2089, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4546055793762207
loss_pred:0.022780850529670715, decouple_loss:0.010404716245830059
The generated pressure mean: 0.4558357298374176
loss_pred:0.02167949452996254, decouple_loss:0.010472194291651249
The generated pressure mean: 0.4487045407295227
loss_pred:0.02145862951874733, decouple_loss:0.010469919070601463
Iteration: 2090, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44693824648857117
loss_pred:0.022227196022868156, decouple_loss:0.010001718997955322
The generated pressure mean: 0.4512007236480713
loss_pred:0.023335589095950127, decouple_loss:0.01006120815873146
The generated pressure mean: 0.45160946249961853
loss_pred:0.02147562988102436, decouple_loss:0.009906409308314323
2023-04-16 20:04:11 testing...
The generated pressure mean: 0.4181169271469116
The generated pressure mean: 0.42457321286201477
loss_pred:0.03252562880516052, decouple_loss:0.011023076251149178
The generated pressure mean: 0.4267807900905609
loss_pred:0.031231513246893883, decouple_loss:0.011145553551614285
loss_pred:0.03090709075331688, decouple_loss:0.011366168037056923
WV_0_PC_0_EH_1_PS_40, loss: 0.032113656401634216, avg_mse: 0.04392526298761368
current test mse: 0.043925
Iteration: 2091, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4402610957622528
loss_pred:0.022001266479492188, decouple_loss:0.01053682528436184
The generated pressure mean: 0.4361479878425598
loss_pred:0.022887149825692177, decouple_loss:0.010549711994826794
The generated pressure mean: 0.4419151544570923
loss_pred:0.021362707018852234, decouple_loss:0.010613278485834599
Iteration: 2092, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508565664291382
loss_pred:0.022774970158934593, decouple_loss:0.009590993635356426
The generated pressure mean: 0.454080194234848
loss_pred:0.021510962396860123, decouple_loss:0.009562927298247814
The generated pressure mean: 0.4564777910709381
loss_pred:0.021929236128926277, decouple_loss:0.009629656560719013
Iteration: 2093, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45310062170028687
loss_pred:0.022398829460144043, decouple_loss:0.009826088324189186
The generated pressure mean: 0.45229867100715637
loss_pred:0.022524088621139526, decouple_loss:0.00998663529753685
The generated pressure mean: 0.4499390125274658
loss_pred:0.020900841802358627, decouple_loss:0.009693785570561886
Iteration: 2094, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44968438148498535
loss_pred:0.022998297587037086, decouple_loss:0.009457007981836796
The generated pressure mean: 0.44355177879333496
loss_pred:0.021343598142266273, decouple_loss:0.009516505524516106
The generated pressure mean: 0.4391901195049286
loss_pred:0.02176917903125286, decouple_loss:0.009252171032130718
Iteration: 2095, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44832783937454224
loss_pred:0.022527968510985374, decouple_loss:0.00854843482375145
The generated pressure mean: 0.4439208209514618
loss_pred:0.020506601780653, decouple_loss:0.008306112140417099
The generated pressure mean: 0.44700610637664795
loss_pred:0.022463854402303696, decouple_loss:0.008304949849843979
Iteration: 2096, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4421665370464325
loss_pred:0.020682677626609802, decouple_loss:0.009289300069212914
The generated pressure mean: 0.4501418471336365
loss_pred:0.024072708562016487, decouple_loss:0.009172867052257061
The generated pressure mean: 0.4537222683429718
loss_pred:0.022743424400687218, decouple_loss:0.009060787037014961
Iteration: 2097, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44809579849243164
loss_pred:0.020937716588377953, decouple_loss:0.00897663738578558
The generated pressure mean: 0.44600582122802734
loss_pred:0.02159910649061203, decouple_loss:0.009058377705514431
The generated pressure mean: 0.4417729675769806
loss_pred:0.02234850823879242, decouple_loss:0.008814346045255661
Iteration: 2098, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4530562162399292
loss_pred:0.02240881323814392, decouple_loss:0.009527494199573994
The generated pressure mean: 0.4500826597213745
loss_pred:0.02268846519291401, decouple_loss:0.009465849958360195
The generated pressure mean: 0.4574924111366272
loss_pred:0.02266511507332325, decouple_loss:0.009603519923985004
Iteration: 2099, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4590391218662262The generated pressure mean: 0.4563649296760559
loss_pred:0.02212643250823021, decouple_loss:0.01055079884827137
loss_pred:0.021617218852043152, decouple_loss:0.010573916137218475
The generated pressure mean: 0.4563818573951721
loss_pred:0.021490929648280144, decouple_loss:0.01042822003364563
Iteration: 2100, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44861727952957153
The generated pressure mean: 0.4475313723087311
loss_pred:0.022083288058638573, decouple_loss:0.010994221083819866
loss_pred:0.02271650917828083, decouple_loss:0.010991290211677551
The generated pressure mean: 0.44505032896995544
loss_pred:0.023829318583011627, decouple_loss:0.011000501923263073
2023-04-16 20:06:04 testing...
The generated pressure mean: 0.42005833983421326
The generated pressure mean: 0.4262624979019165
The generated pressure mean: 0.42862650752067566
loss_pred:0.032086290419101715, decouple_loss:0.01037014089524746
loss_pred:0.030912596732378006, decouple_loss:0.010441363789141178
loss_pred:0.030503179877996445, decouple_loss:0.010592494159936905
WV_0_PC_0_EH_1_PS_40, loss: 0.03169075772166252, avg_mse: 0.043188706040382385
current test mse: 0.043189
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 2101, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4313322603702545
loss_pred:0.022060971707105637, decouple_loss:0.009962232783436775
The generated pressure mean: 0.43464046716690063
The generated pressure mean: 0.4343462884426117
loss_pred:0.0211026631295681, decouple_loss:0.009971531108021736
loss_pred:0.0213970635086298, decouple_loss:0.010035933926701546
Iteration: 2102, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447508841753006
The generated pressure mean: 0.4507603049278259
loss_pred:0.021975522860884666, decouple_loss:0.0101905707269907
loss_pred:0.021289370954036713, decouple_loss:0.01025703176856041
The generated pressure mean: 0.45340463519096375
loss_pred:0.021692311391234398, decouple_loss:0.01038438268005848
Iteration: 2103, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45261359214782715
The generated pressure mean: 0.45833733677864075
loss_pred:0.02036379650235176, decouple_loss:0.010098743252456188
loss_pred:0.02229391783475876, decouple_loss:0.01001095212996006
The generated pressure mean: 0.45724523067474365
loss_pred:0.021959468722343445, decouple_loss:0.010221835225820541
Iteration: 2104, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4437721073627472
The generated pressure mean: 0.4462641179561615
loss_pred:0.021704817190766335, decouple_loss:0.010233853943645954
loss_pred:0.022911975160241127, decouple_loss:0.010161024518311024
The generated pressure mean: 0.44338998198509216
loss_pred:0.024099240079522133, decouple_loss:0.01014619693160057
Iteration: 2105, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44189155101776123
The generated pressure mean: 0.4443908631801605
loss_pred:0.022420663386583328, decouple_loss:0.009971597231924534
loss_pred:0.02182799205183983, decouple_loss:0.009705113247036934
The generated pressure mean: 0.44281744956970215
loss_pred:0.02355954237282276, decouple_loss:0.009947273880243301
Iteration: 2106, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4445926249027252
The generated pressure mean: 0.4504280090332031
loss_pred:0.021637773141264915, decouple_loss:0.00862450897693634
loss_pred:0.0244301687926054, decouple_loss:0.008646447211503983
The generated pressure mean: 0.4471423625946045
loss_pred:0.022959783673286438, decouple_loss:0.00854234118014574
Iteration: 2107, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4552733600139618
The generated pressure mean: 0.455514520406723
loss_pred:0.022587640210986137, decouple_loss:0.009507187642157078
loss_pred:0.022127673029899597, decouple_loss:0.009439881891012192
The generated pressure mean: 0.45663607120513916
loss_pred:0.02354387380182743, decouple_loss:0.009436222724616528
Iteration: 2108, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4361739158630371
The generated pressure mean: 0.43142831325531006
loss_pred:0.024486897513270378, decouple_loss:0.011272006668150425
loss_pred:0.024375317618250847, decouple_loss:0.011219161562621593
The generated pressure mean: 0.43467217683792114
loss_pred:0.02360878698527813, decouple_loss:0.011124969460070133
Iteration: 2109, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45961904525756836
The generated pressure mean: 0.45944470167160034
loss_pred:0.02220209129154682, decouple_loss:0.010854005813598633
loss_pred:0.0215204618871212, decouple_loss:0.010813485831022263
The generated pressure mean: 0.4577520191669464
loss_pred:0.022574108093976974, decouple_loss:0.011000577360391617
Iteration: 2110, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469730257987976
loss_pred:0.023080268874764442, decouple_loss:0.009604058228433132
The generated pressure mean: 0.4536086618900299
loss_pred:0.021682852879166603, decouple_loss:0.009692579507827759
The generated pressure mean: 0.44699013233184814
loss_pred:0.02339458093047142, decouple_loss:0.009612781926989555
2023-04-16 20:08:36 testing...
The generated pressure mean: 0.41833189129829407
The generated pressure mean: 0.4240703582763672
loss_pred:0.03388980031013489, decouple_loss:0.011487491428852081
The generated pressure mean: 0.42622023820877075
loss_pred:0.03261778876185417, decouple_loss:0.011583729647099972
loss_pred:0.032203949987888336, decouple_loss:0.011830184608697891
WV_0_PC_0_EH_1_PS_40, loss: 0.0334855392575264, avg_mse: 0.046053752303123474
current test mse: 0.046054
Iteration: 2111, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43201637268066406
loss_pred:0.02385045774281025, decouple_loss:0.010929828509688377
The generated pressure mean: 0.4384777247905731
loss_pred:0.023139329627156258, decouple_loss:0.01106402836740017
The generated pressure mean: 0.4391765594482422
loss_pred:0.022049661725759506, decouple_loss:0.01123728696256876
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2112, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4558936059474945
The generated pressure mean: 0.455010324716568
loss_pred:0.022927971556782722, decouple_loss:0.01185683999210596
loss_pred:0.02297191135585308, decouple_loss:0.011838139034807682
The generated pressure mean: 0.4539128839969635
loss_pred:0.022691769525408745, decouple_loss:0.011883935891091824
Iteration: 2113, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45538410544395447
The generated pressure mean: 0.4540448784828186
loss_pred:0.02341022714972496, decouple_loss:0.010486576706171036
loss_pred:0.02157408371567726, decouple_loss:0.010352018289268017
The generated pressure mean: 0.45643216371536255
loss_pred:0.022208895534276962, decouple_loss:0.010306697338819504
Iteration: 2114, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4379485845565796
loss_pred:0.022418934851884842, decouple_loss:0.011277731508016586
The generated pressure mean: 0.43794795870780945
loss_pred:0.023895496502518654, decouple_loss:0.011230331845581532
The generated pressure mean: 0.4371514916419983
loss_pred:0.02136041596531868, decouple_loss:0.011166240088641644
Iteration: 2115, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44176945090293884The generated pressure mean: 0.44130557775497437
loss_pred:0.022487211972475052, decouple_loss:0.010691762901842594
loss_pred:0.022350814193487167, decouple_loss:0.01072628889232874
The generated pressure mean: 0.4388221800327301
loss_pred:0.021797560155391693, decouple_loss:0.010600225068628788
Iteration: 2116, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4538283348083496
The generated pressure mean: 0.45235005021095276loss_pred:0.020969130098819733, decouple_loss:0.009923984296619892
loss_pred:0.02131703682243824, decouple_loss:0.009852041490375996
The generated pressure mean: 0.45395374298095703
loss_pred:0.022174643352627754, decouple_loss:0.009808209724724293
Iteration: 2117, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4536592364311218
loss_pred:0.023582985624670982, decouple_loss:0.009479915723204613
The generated pressure mean: 0.45375433564186096
loss_pred:0.021570265293121338, decouple_loss:0.009477981366217136
The generated pressure mean: 0.45108604431152344
loss_pred:0.022785674780607224, decouple_loss:0.009400103241205215
Iteration: 2118, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44195738434791565
loss_pred:0.0237905140966177, decouple_loss:0.010213511995971203
The generated pressure mean: 0.4407876133918762
loss_pred:0.022168969735503197, decouple_loss:0.010327287949621677
The generated pressure mean: 0.44257065653800964
loss_pred:0.02322268858551979, decouple_loss:0.01020683441311121
Iteration: 2119, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4424867033958435
loss_pred:0.02196703664958477, decouple_loss:0.010648582130670547
The generated pressure mean: 0.44477608799934387
loss_pred:0.021662617102265358, decouple_loss:0.010774987749755383
The generated pressure mean: 0.4436352550983429
loss_pred:0.02252945862710476, decouple_loss:0.010774330236017704
Iteration: 2120, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4512123763561249
The generated pressure mean: 0.45221197605133057
loss_pred:0.02167840301990509, decouple_loss:0.010296755470335484
loss_pred:0.022610921412706375, decouple_loss:0.010360081680119038
The generated pressure mean: 0.45475760102272034
loss_pred:0.02286885865032673, decouple_loss:0.010473900474607944
2023-04-16 20:10:29 testing...
The generated pressure mean: 0.4162670373916626
The generated pressure mean: 0.4229019284248352
loss_pred:0.03345832973718643, decouple_loss:0.009818310849368572
The generated pressure mean: 0.4256132245063782
loss_pred:0.03233204036951065, decouple_loss:0.010089491493999958
loss_pred:0.03210580348968506, decouple_loss:0.01029539480805397
WV_0_PC_0_EH_1_PS_40, loss: 0.033135443925857544, avg_mse: 0.046313416212797165
current test mse: 0.046313
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 2121, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44476187229156494
loss_pred:0.022378072142601013, decouple_loss:0.009234338998794556
The generated pressure mean: 0.4481644928455353
loss_pred:0.02290991321206093, decouple_loss:0.00922869611531496
The generated pressure mean: 0.4486694931983948
loss_pred:0.022472193464636803, decouple_loss:0.009286588989198208
Iteration: 2122, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4417957067489624The generated pressure mean: 0.44296592473983765
loss_pred:0.022443460300564766, decouple_loss:0.009604339487850666
loss_pred:0.022918550297617912, decouple_loss:0.009609219618141651
The generated pressure mean: 0.441958487033844
loss_pred:0.022532232105731964, decouple_loss:0.009768308140337467
Iteration: 2123, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4403301477432251
loss_pred:0.02164003998041153, decouple_loss:0.009862955659627914
The generated pressure mean: 0.44817104935646057
loss_pred:0.022773681208491325, decouple_loss:0.009908157400786877
The generated pressure mean: 0.4436579942703247
loss_pred:0.021442871540784836, decouple_loss:0.009935214184224606
Iteration: 2124, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45072245597839355
loss_pred:0.02212466672062874, decouple_loss:0.010817461647093296
The generated pressure mean: 0.4571351706981659
loss_pred:0.021169977262616158, decouple_loss:0.01095619797706604
The generated pressure mean: 0.45935457944869995
loss_pred:0.02231546677649021, decouple_loss:0.010788476094603539
Iteration: 2125, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4416171908378601
The generated pressure mean: 0.4453124403953552
loss_pred:0.023770440369844437, decouple_loss:0.010026304982602596
loss_pred:0.020471179857850075, decouple_loss:0.010289817117154598
The generated pressure mean: 0.4427071213722229
loss_pred:0.023470409214496613, decouple_loss:0.010018396191298962
Iteration: 2126, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4447242021560669
The generated pressure mean: 0.446707546710968
loss_pred:0.022482294589281082, decouple_loss:0.009775415062904358
loss_pred:0.024415096268057823, decouple_loss:0.009790902957320213
The generated pressure mean: 0.44517451524734497
loss_pred:0.021031714975833893, decouple_loss:0.009728682227432728
Iteration: 2127, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483315348625183The generated pressure mean: 0.45427030324935913
loss_pred:0.021207351237535477, decouple_loss:0.009605085477232933
loss_pred:0.022124316543340683, decouple_loss:0.009903563186526299
The generated pressure mean: 0.45264866948127747
loss_pred:0.021615002304315567, decouple_loss:0.009715382009744644
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2128, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4421931803226471
The generated pressure mean: 0.4455341398715973
loss_pred:0.020916691049933434, decouple_loss:0.010527004487812519
loss_pred:0.02201973833143711, decouple_loss:0.010586259886622429
The generated pressure mean: 0.4378775656223297
loss_pred:0.022354768589138985, decouple_loss:0.01071306224912405
Iteration: 2129, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44468531012535095
The generated pressure mean: 0.44340261816978455loss_pred:0.02308330498635769, decouple_loss:0.009970597922801971
loss_pred:0.022017909213900566, decouple_loss:0.009881077334284782
The generated pressure mean: 0.44699689745903015
loss_pred:0.021558957174420357, decouple_loss:0.009950571693480015
Iteration: 2130, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45728054642677307
The generated pressure mean: 0.4606514573097229
loss_pred:0.02195010334253311, decouple_loss:0.010221900418400764
loss_pred:0.0231479462236166, decouple_loss:0.010198650881648064
The generated pressure mean: 0.4576747715473175
loss_pred:0.021671073511242867, decouple_loss:0.010309934616088867
2023-04-16 20:13:01 testing...
The generated pressure mean: 0.41665729880332947
The generated pressure mean: 0.42304643988609314
The generated pressure mean: 0.4256784915924072
loss_pred:0.03317961096763611, decouple_loss:0.010943589732050896
loss_pred:0.03186354413628578, decouple_loss:0.010989646427333355
loss_pred:0.031405799090862274, decouple_loss:0.011177019216120243
WV_0_PC_0_EH_1_PS_40, loss: 0.03270149230957031, avg_mse: 0.045042190700769424
current test mse: 0.045042
Iteration: 2131, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44470614194869995
The generated pressure mean: 0.4470616281032562
loss_pred:0.020622583106160164, decouple_loss:0.010449125431478024
loss_pred:0.021821293979883194, decouple_loss:0.010617096908390522
The generated pressure mean: 0.4481346309185028
loss_pred:0.02246527560055256, decouple_loss:0.01045185700058937
Iteration: 2132, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4391908049583435
loss_pred:0.021712837740778923, decouple_loss:0.011378373019397259
The generated pressure mean: 0.43709903955459595
loss_pred:0.02208852209150791, decouple_loss:0.011472702957689762
The generated pressure mean: 0.43638095259666443
loss_pred:0.021778790280222893, decouple_loss:0.011472082696855068
Iteration: 2133, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44986921548843384
loss_pred:0.021131033077836037, decouple_loss:0.010119804181158543
The generated pressure mean: 0.44756436347961426
loss_pred:0.02045832760632038, decouple_loss:0.010010807774960995
The generated pressure mean: 0.44664737582206726
loss_pred:0.025317685678601265, decouple_loss:0.010112181305885315
Iteration: 2134, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44628316164016724
loss_pred:0.021373633295297623, decouple_loss:0.009413131512701511
The generated pressure mean: 0.44416239857673645
loss_pred:0.021527212113142014, decouple_loss:0.009466376155614853
The generated pressure mean: 0.44717174768447876
loss_pred:0.022422906011343002, decouple_loss:0.009368675760924816
Iteration: 2135, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4523486793041229
loss_pred:0.02161622978746891, decouple_loss:0.010736021213233471
The generated pressure mean: 0.45024922490119934
loss_pred:0.021405382081866264, decouple_loss:0.0108619574457407
The generated pressure mean: 0.45242229104042053
loss_pred:0.02148217149078846, decouple_loss:0.010846676304936409
Iteration: 2136, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4514214098453522
loss_pred:0.020759480074048042, decouple_loss:0.010379547253251076
The generated pressure mean: 0.4512683153152466
loss_pred:0.021424686536192894, decouple_loss:0.010510239750146866
The generated pressure mean: 0.44707968831062317
loss_pred:0.020192358642816544, decouple_loss:0.010192031972110271
Iteration: 2137, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503360390663147
loss_pred:0.02086464688181877, decouple_loss:0.0099990488961339
The generated pressure mean: 0.4490997791290283
loss_pred:0.022673392668366432, decouple_loss:0.00991075299680233
The generated pressure mean: 0.44168621301651
loss_pred:0.021568119525909424, decouple_loss:0.010118488222360611
Iteration: 2138, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4438430070877075
loss_pred:0.021554768085479736, decouple_loss:0.009871391579508781
The generated pressure mean: 0.4413679838180542
loss_pred:0.02220376767218113, decouple_loss:0.009957616217434406
The generated pressure mean: 0.43784183263778687
loss_pred:0.024738196283578873, decouple_loss:0.009887026622891426
Iteration: 2139, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4389292597770691
The generated pressure mean: 0.44287657737731934
loss_pred:0.02144397608935833, decouple_loss:0.009590585716068745
loss_pred:0.022110527381300926, decouple_loss:0.009657363407313824
The generated pressure mean: 0.4360867440700531
loss_pred:0.021401971578598022, decouple_loss:0.009396561421453953
Iteration: 2140, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44973307847976685
loss_pred:0.02292223833501339, decouple_loss:0.009582615457475185
The generated pressure mean: 0.4502246677875519
loss_pred:0.02213788963854313, decouple_loss:0.009713604114949703
The generated pressure mean: 0.4542637765407562
loss_pred:0.020592758432030678, decouple_loss:0.00967383198440075
2023-04-16 20:14:54 testing...
The generated pressure mean: 0.4139748811721802
The generated pressure mean: 0.42034417390823364
The generated pressure mean: 0.4227486550807953
loss_pred:0.03500327840447426, decouple_loss:0.010658808052539825
loss_pred:0.033775147050619125, decouple_loss:0.010803855955600739
loss_pred:0.033764973282814026, decouple_loss:0.010857594199478626
WV_0_PC_0_EH_1_PS_40, loss: 0.0347198024392128, avg_mse: 0.04869954660534859
current test mse: 0.0487
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 2141, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45414185523986816
loss_pred:0.022532563656568527, decouple_loss:0.010355217382311821
The generated pressure mean: 0.45545530319213867
loss_pred:0.02280992455780506, decouple_loss:0.009874836541712284
The generated pressure mean: 0.45271778106689453
loss_pred:0.021367765963077545, decouple_loss:0.010185545310378075
Iteration: 2142, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4412255585193634
The generated pressure mean: 0.44188907742500305
loss_pred:0.0207498911768198, decouple_loss:0.010106130503118038
loss_pred:0.020969705656170845, decouple_loss:0.010200484655797482
The generated pressure mean: 0.4378061890602112
loss_pred:0.02197881229221821, decouple_loss:0.010176650248467922
Iteration: 2143, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44545167684555054
The generated pressure mean: 0.4441903233528137loss_pred:0.02223619632422924, decouple_loss:0.008884157985448837
loss_pred:0.02175643853843212, decouple_loss:0.008630086667835712
The generated pressure mean: 0.4527200162410736
loss_pred:0.021931245923042297, decouple_loss:0.008720699697732925
Iteration: 2144, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4613371193408966
The generated pressure mean: 0.46421605348587036
loss_pred:0.021545888856053352, decouple_loss:0.008801061660051346
loss_pred:0.02142101339995861, decouple_loss:0.00877294410020113
The generated pressure mean: 0.45533934235572815
loss_pred:0.021887073293328285, decouple_loss:0.008760951459407806
Iteration: 2145, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.445066899061203
loss_pred:0.02244207262992859, decouple_loss:0.010020355693995953
The generated pressure mean: 0.4363439977169037
loss_pred:0.02015957236289978, decouple_loss:0.010093506425619125
The generated pressure mean: 0.447373628616333
loss_pred:0.021954046562314034, decouple_loss:0.010111518204212189
Iteration: 2146, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4401306211948395
loss_pred:0.02027002163231373, decouple_loss:0.011255022138357162
The generated pressure mean: 0.43088194727897644
loss_pred:0.020648857578635216, decouple_loss:0.01100444607436657
The generated pressure mean: 0.43356943130493164
loss_pred:0.021046288311481476, decouple_loss:0.011162489652633667
Iteration: 2147, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484754502773285
The generated pressure mean: 0.44787710905075073loss_pred:0.021558642387390137, decouple_loss:0.009791955351829529
loss_pred:0.022305786609649658, decouple_loss:0.00992192979902029
The generated pressure mean: 0.4466584622859955
loss_pred:0.02253446727991104, decouple_loss:0.009911779314279556
Iteration: 2148, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45699015259742737
The generated pressure mean: 0.46004778146743774
loss_pred:0.020691506564617157, decouple_loss:0.009992444887757301
loss_pred:0.022160187363624573, decouple_loss:0.01024847012013197
The generated pressure mean: 0.4559935927391052
loss_pred:0.02262849360704422, decouple_loss:0.010201644152402878
Iteration: 2149, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4522891342639923
The generated pressure mean: 0.4433656930923462
loss_pred:0.021238915622234344, decouple_loss:0.011089056730270386
loss_pred:0.0215666051954031, decouple_loss:0.010913425125181675
The generated pressure mean: 0.4445941746234894
loss_pred:0.021252593025565147, decouple_loss:0.010880794376134872
Iteration: 2150, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462449252605438
The generated pressure mean: 0.44770583510398865
loss_pred:0.021312691271305084, decouple_loss:0.011179573833942413
loss_pred:0.022398579865694046, decouple_loss:0.011235949583351612
The generated pressure mean: 0.44868433475494385
loss_pred:0.021247226744890213, decouple_loss:0.011294372379779816
2023-04-16 20:17:30 testing...
The generated pressure mean: 0.4171646237373352
The generated pressure mean: 0.4232788681983948
loss_pred:0.032696112990379333, decouple_loss:0.010953116230666637
The generated pressure mean: 0.42591074109077454
loss_pred:0.031688421964645386, decouple_loss:0.011190386489033699
loss_pred:0.031411271542310715, decouple_loss:0.011298938654363155
WV_0_PC_0_EH_1_PS_40, loss: 0.03248931095004082, avg_mse: 0.04452655836939812
current test mse: 0.044527
Iteration: 2151, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4424462616443634
loss_pred:0.02342277020215988, decouple_loss:0.010621046647429466
The generated pressure mean: 0.4404953718185425
loss_pred:0.020254533737897873, decouple_loss:0.010607749223709106
The generated pressure mean: 0.44047191739082336
loss_pred:0.02259594202041626, decouple_loss:0.010695711709558964
Iteration: 2152, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469364881515503
The generated pressure mean: 0.4430392384529114
loss_pred:0.022063322365283966, decouple_loss:0.011289180256426334
loss_pred:0.021174395456910133, decouple_loss:0.011372583918273449
The generated pressure mean: 0.444997638463974
loss_pred:0.021652348339557648, decouple_loss:0.011557421647012234
Iteration: 2153, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4619085490703583
loss_pred:0.02301439456641674, decouple_loss:0.009678223170340061
The generated pressure mean: 0.45904433727264404
loss_pred:0.023965369910001755, decouple_loss:0.00958287250250578
The generated pressure mean: 0.4610094130039215
loss_pred:0.021368036046624184, decouple_loss:0.009944884106516838
Iteration: 2154, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43869683146476746
The generated pressure mean: 0.447954386472702
loss_pred:0.020588066428899765, decouple_loss:0.010139944031834602
loss_pred:0.022561632096767426, decouple_loss:0.009954063221812248
The generated pressure mean: 0.4426974654197693
loss_pred:0.021514680236577988, decouple_loss:0.010007880628108978
Iteration: 2155, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43678873777389526
The generated pressure mean: 0.443305104970932
loss_pred:0.022343672811985016, decouple_loss:0.00988391786813736
loss_pred:0.02211589924991131, decouple_loss:0.009986004792153835
The generated pressure mean: 0.44160956144332886
loss_pred:0.022405928000807762, decouple_loss:0.010119558311998844
Iteration: 2156, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496573805809021
The generated pressure mean: 0.4490698277950287loss_pred:0.022453349083662033, decouple_loss:0.009216859936714172
loss_pred:0.02054029330611229, decouple_loss:0.009515754878520966
The generated pressure mean: 0.4508505165576935
loss_pred:0.022655297070741653, decouple_loss:0.009513644501566887
Iteration: 2157, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45715081691741943
The generated pressure mean: 0.4489721357822418loss_pred:0.020286038517951965, decouple_loss:0.008991283364593983
loss_pred:0.020411765202879906, decouple_loss:0.008835743181407452
The generated pressure mean: 0.45177406072616577
loss_pred:0.022166788578033447, decouple_loss:0.00896310806274414
Iteration: 2158, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44243907928466797
loss_pred:0.02249348722398281, decouple_loss:0.009194895625114441
The generated pressure mean: 0.44515475630760193
loss_pred:0.01904851198196411, decouple_loss:0.009208384901285172
The generated pressure mean: 0.44040265679359436
loss_pred:0.02253049798309803, decouple_loss:0.009268397465348244
Iteration: 2159, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504508972167969
loss_pred:0.022041039541363716, decouple_loss:0.011831301264464855
The generated pressure mean: 0.442948579788208
loss_pred:0.022394439205527306, decouple_loss:0.012001673690974712
The generated pressure mean: 0.44417914748191833
loss_pred:0.020287318155169487, decouple_loss:0.011858437210321426
Iteration: 2160, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4575144648551941
loss_pred:0.021861929446458817, decouple_loss:0.011512497439980507
The generated pressure mean: 0.4572489559650421
loss_pred:0.0206009428948164, decouple_loss:0.011345528066158295
The generated pressure mean: 0.4516790807247162
loss_pred:0.0211534034460783, decouple_loss:0.011281891725957394
2023-04-16 20:19:23 testing...
The generated pressure mean: 0.41633301973342896
The generated pressure mean: 0.4227132201194763
The generated pressure mean: 0.4257635772228241
loss_pred:0.03463968262076378, decouple_loss:0.009712516330182552
loss_pred:0.03358301520347595, decouple_loss:0.010003925301134586
loss_pred:0.03333071619272232, decouple_loss:0.010116823017597198
WV_0_PC_0_EH_1_PS_40, loss: 0.03434836119413376, avg_mse: 0.04879589378833771
current test mse: 0.048796
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 2161, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4454900622367859
loss_pred:0.020448002964258194, decouple_loss:0.009365808218717575
The generated pressure mean: 0.4484966993331909
loss_pred:0.02190241403877735, decouple_loss:0.00920131616294384
The generated pressure mean: 0.4462234079837799
loss_pred:0.022374294698238373, decouple_loss:0.009155909530818462
Iteration: 2162, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4385371804237366
loss_pred:0.021678810939192772, decouple_loss:0.008302700705826283
The generated pressure mean: 0.43759867548942566
loss_pred:0.021321341395378113, decouple_loss:0.00817216094583273
The generated pressure mean: 0.438825786113739
loss_pred:0.021851303055882454, decouple_loss:0.008140476420521736
Iteration: 2163, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44510558247566223
loss_pred:0.02200625091791153, decouple_loss:0.00983414240181446
The generated pressure mean: 0.45092201232910156
loss_pred:0.02143578790128231, decouple_loss:0.00954965129494667
The generated pressure mean: 0.4498971104621887
loss_pred:0.022098038345575333, decouple_loss:0.009628106839954853
Iteration: 2164, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495331645011902
loss_pred:0.020451152697205544, decouple_loss:0.011472497135400772
The generated pressure mean: 0.4545261263847351
loss_pred:0.020643319934606552, decouple_loss:0.011459876783192158
The generated pressure mean: 0.4551740288734436
loss_pred:0.02195889875292778, decouple_loss:0.011378919705748558
Iteration: 2165, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44658344984054565
loss_pred:0.02305125817656517, decouple_loss:0.011485325172543526
The generated pressure mean: 0.4481661319732666
loss_pred:0.022217756137251854, decouple_loss:0.011422606185078621
The generated pressure mean: 0.44799166917800903
loss_pred:0.021907545626163483, decouple_loss:0.011376517824828625
Iteration: 2166, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4427943825721741
loss_pred:0.02205536887049675, decouple_loss:0.00995054841041565
The generated pressure mean: 0.4417375326156616
loss_pred:0.022958509624004364, decouple_loss:0.010117355734109879
The generated pressure mean: 0.4386039078235626
loss_pred:0.02225685864686966, decouple_loss:0.009846207685768604
Iteration: 2167, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484020173549652
loss_pred:0.02133217267692089, decouple_loss:0.008852122351527214
The generated pressure mean: 0.44422462582588196
loss_pred:0.020773038268089294, decouple_loss:0.008793256245553493
The generated pressure mean: 0.447001576423645
loss_pred:0.024176737293601036, decouple_loss:0.008879519067704678
Iteration: 2168, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4420464038848877
The generated pressure mean: 0.44187459349632263
loss_pred:0.021720297634601593, decouple_loss:0.009357161819934845
loss_pred:0.0205746591091156, decouple_loss:0.009357769973576069
The generated pressure mean: 0.449013888835907
loss_pred:0.02109139785170555, decouple_loss:0.009519509971141815
Iteration: 2169, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44781219959259033
loss_pred:0.022000418975949287, decouple_loss:0.009606913663446903
The generated pressure mean: 0.4501616358757019
loss_pred:0.020540772005915642, decouple_loss:0.009511043317615986
The generated pressure mean: 0.4442266821861267
loss_pred:0.020924238488078117, decouple_loss:0.009510306641459465
Iteration: 2170, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45390093326568604
The generated pressure mean: 0.4544884264469147
loss_pred:0.020861677825450897, decouple_loss:0.010488579981029034
loss_pred:0.02007516473531723, decouple_loss:0.010510058142244816
The generated pressure mean: 0.452696293592453
loss_pred:0.020606650039553642, decouple_loss:0.01032868679612875
2023-04-16 20:21:55 testing...
The generated pressure mean: 0.41629624366760254
The generated pressure mean: 0.422820508480072
loss_pred:0.03359102085232735, decouple_loss:0.010042792186141014
The generated pressure mean: 0.4253350794315338
loss_pred:0.03296191990375519, decouple_loss:0.01006799004971981
loss_pred:0.032332971692085266, decouple_loss:0.01033224631100893
WV_0_PC_0_EH_1_PS_40, loss: 0.03346935659646988, avg_mse: 0.04701900854706764
current test mse: 0.047019
Iteration: 2171, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4539490044116974
The generated pressure mean: 0.44948074221611023
loss_pred:0.021496381610631943, decouple_loss:0.009215360507369041
loss_pred:0.0220832210034132, decouple_loss:0.009163856506347656
The generated pressure mean: 0.44926634430885315
loss_pred:0.021464284509420395, decouple_loss:0.009295675903558731
Iteration: 2172, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4320695102214813
The generated pressure mean: 0.431423544883728
loss_pred:0.021379495039582253, decouple_loss:0.008902959525585175
loss_pred:0.023205026984214783, decouple_loss:0.00903439149260521
The generated pressure mean: 0.43389055132865906
loss_pred:0.02245025709271431, decouple_loss:0.00890512764453888
Iteration: 2173, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463063180446625
The generated pressure mean: 0.44434842467308044
loss_pred:0.02177133969962597, decouple_loss:0.010923580266535282
loss_pred:0.0226292684674263, decouple_loss:0.010886343196034431
The generated pressure mean: 0.4441604018211365
loss_pred:0.02279144525527954, decouple_loss:0.011092998087406158
Iteration: 2174, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4515615403652191
The generated pressure mean: 0.4551880657672882
loss_pred:0.02186373621225357, decouple_loss:0.00942146871238947
loss_pred:0.022043146193027496, decouple_loss:0.009489476680755615
The generated pressure mean: 0.4532829523086548
loss_pred:0.021026937291026115, decouple_loss:0.009292993694543839
Iteration: 2175, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45255395770072937The generated pressure mean: 0.45364195108413696
loss_pred:0.021547531709074974, decouple_loss:0.00915566273033619
loss_pred:0.021258080378174782, decouple_loss:0.009140639565885067
The generated pressure mean: 0.4481986463069916
loss_pred:0.01941780559718609, decouple_loss:0.0091613894328475
Iteration: 2176, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478808045387268
The generated pressure mean: 0.4498562812805176
loss_pred:0.023547716438770294, decouple_loss:0.009741613641381264
loss_pred:0.021634520962834358, decouple_loss:0.009579932317137718
The generated pressure mean: 0.448552668094635
loss_pred:0.02184417098760605, decouple_loss:0.009574353694915771
Iteration: 2177, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43828755617141724The generated pressure mean: 0.4436003863811493
loss_pred:0.022334707900881767, decouple_loss:0.010104021988809109
loss_pred:0.020695123821496964, decouple_loss:0.0100276293233037
The generated pressure mean: 0.440349280834198
loss_pred:0.021415311843156815, decouple_loss:0.009890357963740826
Iteration: 2178, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4519001245498657
loss_pred:0.022212279960513115, decouple_loss:0.009742840193212032
The generated pressure mean: 0.4486941993236542
loss_pred:0.020934145897626877, decouple_loss:0.009686208330094814
The generated pressure mean: 0.4441913068294525
loss_pred:0.020754413679242134, decouple_loss:0.009796000085771084
Iteration: 2179, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45108240842819214
The generated pressure mean: 0.44547924399375916
loss_pred:0.0210313331335783, decouple_loss:0.010260689072310925
loss_pred:0.020746521651744843, decouple_loss:0.010357365012168884
The generated pressure mean: 0.45105215907096863
loss_pred:0.02216188795864582, decouple_loss:0.010367968119680882
Iteration: 2180, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44639021158218384
loss_pred:0.021418722346425056, decouple_loss:0.010590942576527596
The generated pressure mean: 0.4461129307746887
loss_pred:0.0226887296885252, decouple_loss:0.010610973462462425
The generated pressure mean: 0.4477849304676056
loss_pred:0.022039877250790596, decouple_loss:0.010664613917469978
2023-04-16 20:23:47 testing...
The generated pressure mean: 0.4160849153995514
The generated pressure mean: 0.4222927689552307
The generated pressure mean: 0.42458629608154297
loss_pred:0.03265328332781792, decouple_loss:0.011058584786951542
loss_pred:0.03114338405430317, decouple_loss:0.011041227728128433
loss_pred:0.03059222549200058, decouple_loss:0.01131119579076767
WV_0_PC_0_EH_1_PS_40, loss: 0.03201981633901596, avg_mse: 0.04394511878490448
current test mse: 0.043945
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 2181, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4522895812988281
loss_pred:0.02286164090037346, decouple_loss:0.010691745206713676
The generated pressure mean: 0.4494708180427551
loss_pred:0.02281324937939644, decouple_loss:0.010675153695046902
The generated pressure mean: 0.4478560984134674
loss_pred:0.02226259931921959, decouple_loss:0.010771132074296474
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2182, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43913334608078003
The generated pressure mean: 0.445282518863678
loss_pred:0.0221963319927454, decouple_loss:0.010246898978948593
loss_pred:0.021772660315036774, decouple_loss:0.00999358482658863
The generated pressure mean: 0.45108112692832947
loss_pred:0.02078821137547493, decouple_loss:0.009891577996313572
Iteration: 2183, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4430874288082123
The generated pressure mean: 0.4472687840461731
loss_pred:0.02134297974407673, decouple_loss:0.009748105891048908
loss_pred:0.021602708846330643, decouple_loss:0.009820519015192986
The generated pressure mean: 0.4451974332332611
loss_pred:0.022699834778904915, decouple_loss:0.009949681349098682
Iteration: 2184, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459274113178253
The generated pressure mean: 0.4501942992210388
loss_pred:0.021852347999811172, decouple_loss:0.009075071662664413
loss_pred:0.020664192736148834, decouple_loss:0.009190382435917854
The generated pressure mean: 0.4458875358104706
loss_pred:0.026005897670984268, decouple_loss:0.009016050957143307
Iteration: 2185, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4369667172431946
loss_pred:0.022890429943799973, decouple_loss:0.009427482262253761
The generated pressure mean: 0.4452163875102997
loss_pred:0.02143886312842369, decouple_loss:0.00943559780716896
The generated pressure mean: 0.44040364027023315
loss_pred:0.02124781347811222, decouple_loss:0.009573736228048801
Iteration: 2186, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442114233970642
loss_pred:0.021316945552825928, decouple_loss:0.010180652141571045
The generated pressure mean: 0.4436213970184326
loss_pred:0.021747443825006485, decouple_loss:0.010321350768208504
The generated pressure mean: 0.44774261116981506
loss_pred:0.02242688275873661, decouple_loss:0.010062268003821373
Iteration: 2187, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507747292518616
loss_pred:0.02488560974597931, decouple_loss:0.009567346423864365
The generated pressure mean: 0.45069313049316406
loss_pred:0.02358596958220005, decouple_loss:0.00960431806743145
The generated pressure mean: 0.44988977909088135
loss_pred:0.020727504044771194, decouple_loss:0.009581700898706913
Iteration: 2188, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4373522102832794
loss_pred:0.021916091442108154, decouple_loss:0.008815000765025616
The generated pressure mean: 0.43640702962875366
loss_pred:0.021681802347302437, decouple_loss:0.00901093240827322
The generated pressure mean: 0.44081446528434753
loss_pred:0.021648980677127838, decouple_loss:0.008934183977544308
Iteration: 2189, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4417475461959839
loss_pred:0.02357548102736473, decouple_loss:0.009484278038144112
The generated pressure mean: 0.44702309370040894
loss_pred:0.022946225479245186, decouple_loss:0.009314780123531818
The generated pressure mean: 0.4446316957473755
loss_pred:0.02195912040770054, decouple_loss:0.009389885701239109
Iteration: 2190, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.462784081697464
The generated pressure mean: 0.4571128189563751
loss_pred:0.021703971549868584, decouple_loss:0.00897850003093481
loss_pred:0.020966442301869392, decouple_loss:0.009176518768072128
The generated pressure mean: 0.4607011377811432
loss_pred:0.021953856572508812, decouple_loss:0.009251846931874752
2023-04-16 20:26:17 testing...
The generated pressure mean: 0.41641828417778015
The generated pressure mean: 0.42271488904953003
loss_pred:0.03605856001377106, decouple_loss:0.010483461432158947
The generated pressure mean: 0.42516666650772095
loss_pred:0.034522902220487595, decouple_loss:0.010570145212113857
loss_pred:0.0346316359937191, decouple_loss:0.010787716135382652
WV_0_PC_0_EH_1_PS_40, loss: 0.035601720213890076, avg_mse: 0.05109238252043724
current test mse: 0.051092
Iteration: 2191, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486735165119171
The generated pressure mean: 0.4520888924598694
loss_pred:0.022982157766819, decouple_loss:0.010163153521716595
loss_pred:0.022285504266619682, decouple_loss:0.010185894556343555
The generated pressure mean: 0.45172086358070374
loss_pred:0.021090760827064514, decouple_loss:0.010097869671881199
Iteration: 2192, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4342270493507385
The generated pressure mean: 0.43520334362983704
loss_pred:0.022779693827033043, decouple_loss:0.01054803654551506
loss_pred:0.02156672440469265, decouple_loss:0.01074012741446495
The generated pressure mean: 0.43743517994880676
loss_pred:0.022164668887853622, decouple_loss:0.010527265258133411
Iteration: 2193, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43572503328323364
The generated pressure mean: 0.4412761926651001
loss_pred:0.02217588573694229, decouple_loss:0.009329008869826794
loss_pred:0.022615674883127213, decouple_loss:0.009424551390111446
The generated pressure mean: 0.43860307335853577
loss_pred:0.02368123270571232, decouple_loss:0.00936027243733406
Iteration: 2194, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45207858085632324
The generated pressure mean: 0.4532042145729065
loss_pred:0.02224380522966385, decouple_loss:0.008825021795928478
loss_pred:0.022166527807712555, decouple_loss:0.008883045054972172
The generated pressure mean: 0.4533585011959076
loss_pred:0.02141485922038555, decouple_loss:0.008839801885187626
Iteration: 2195, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4526914358139038
The generated pressure mean: 0.45256105065345764
loss_pred:0.022632572799921036, decouple_loss:0.011457830667495728
loss_pred:0.021754201501607895, decouple_loss:0.011254486627876759
The generated pressure mean: 0.4542137682437897
loss_pred:0.02170570008456707, decouple_loss:0.011302570812404156
Iteration: 2196, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44787612557411194
The generated pressure mean: 0.44595491886138916
loss_pred:0.0224398672580719, decouple_loss:0.009256887249648571
loss_pred:0.022262489423155785, decouple_loss:0.009290431626141071
The generated pressure mean: 0.4471224248409271
loss_pred:0.022452326491475105, decouple_loss:0.0092860646545887
Iteration: 2197, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44717904925346375
The generated pressure mean: 0.4462023079395294
loss_pred:0.022085009142756462, decouple_loss:0.009855334646999836
loss_pred:0.0222112275660038, decouple_loss:0.009823862463235855
The generated pressure mean: 0.4451020061969757
loss_pred:0.02144705317914486, decouple_loss:0.009836642071604729
Iteration: 2198, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4447048008441925
loss_pred:0.0217207670211792, decouple_loss:0.010653839446604252
The generated pressure mean: 0.4440506100654602
loss_pred:0.023038333281874657, decouple_loss:0.010663139633834362
The generated pressure mean: 0.44422274827957153
loss_pred:0.022509323433041573, decouple_loss:0.010568352416157722
Iteration: 2199, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4435378611087799
loss_pred:0.021486038342118263, decouple_loss:0.009403528645634651
The generated pressure mean: 0.4468531906604767
loss_pred:0.021496431902050972, decouple_loss:0.009386434219777584
The generated pressure mean: 0.44545188546180725
loss_pred:0.020627764984965324, decouple_loss:0.009269298054277897
Iteration: 2200, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44309473037719727
loss_pred:0.022304341197013855, decouple_loss:0.009010420180857182
The generated pressure mean: 0.4473479986190796
loss_pred:0.02197309024631977, decouple_loss:0.008912329562008381
The generated pressure mean: 0.4481864273548126
loss_pred:0.021927351132035255, decouple_loss:0.009067656472325325
2023-04-16 20:28:09 testing...
The generated pressure mean: 0.4213820993900299
The generated pressure mean: 0.4157288372516632
The generated pressure mean: 0.423635333776474
loss_pred:0.032376762479543686, decouple_loss:0.009286021813750267
loss_pred:0.03357357904314995, decouple_loss:0.009145351126790047
loss_pred:0.03239067271351814, decouple_loss:0.009409255348145962
WV_0_PC_0_EH_1_PS_40, loss: 0.03324434906244278, avg_mse: 0.04646260291337967
current test mse: 0.046463
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 2201, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452466368675232
loss_pred:0.021099938079714775, decouple_loss:0.008806710131466389
The generated pressure mean: 0.45022961497306824
The generated pressure mean: 0.4437532424926758
loss_pred:0.02168143168091774, decouple_loss:0.008706009946763515
loss_pred:0.021707991138100624, decouple_loss:0.008715622127056122
Iteration: 2202, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4575878381729126
The generated pressure mean: 0.4537975490093231
loss_pred:0.022136688232421875, decouple_loss:0.008600226603448391
loss_pred:0.02221733331680298, decouple_loss:0.008511782623827457
The generated pressure mean: 0.46011802554130554
loss_pred:0.021742083132267, decouple_loss:0.008605653420090675
Iteration: 2203, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4383887052536011
The generated pressure mean: 0.43933603167533875loss_pred:0.02418069913983345, decouple_loss:0.00839628279209137
loss_pred:0.02204429917037487, decouple_loss:0.008548587560653687
The generated pressure mean: 0.444970041513443
loss_pred:0.022750919684767723, decouple_loss:0.008463905192911625
Iteration: 2204, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4352203607559204
The generated pressure mean: 0.43944135308265686
loss_pred:0.02321549318730831, decouple_loss:0.00876392051577568
loss_pred:0.02217947505414486, decouple_loss:0.008870459161698818
The generated pressure mean: 0.43633267283439636
loss_pred:0.02320864424109459, decouple_loss:0.00907058920711279
Iteration: 2205, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4574206471443176
The generated pressure mean: 0.4540247917175293
loss_pred:0.021378932520747185, decouple_loss:0.009925292804837227
loss_pred:0.02207368239760399, decouple_loss:0.009638774208724499
The generated pressure mean: 0.45941826701164246
loss_pred:0.021307384595274925, decouple_loss:0.009829268790781498
Iteration: 2206, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45302072167396545
The generated pressure mean: 0.4520428776741028
loss_pred:0.02168550342321396, decouple_loss:0.00916871428489685
loss_pred:0.02172296866774559, decouple_loss:0.009280433878302574
The generated pressure mean: 0.45247507095336914
loss_pred:0.022390101104974747, decouple_loss:0.009236517362296581
Iteration: 2207, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4377419650554657
The generated pressure mean: 0.43904489278793335
loss_pred:0.02276274748146534, decouple_loss:0.010276093147695065
loss_pred:0.023020640015602112, decouple_loss:0.010262027382850647
The generated pressure mean: 0.4372502267360687
loss_pred:0.023453103378415108, decouple_loss:0.010184085927903652
Iteration: 2208, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44355037808418274
The generated pressure mean: 0.44369757175445557
loss_pred:0.022240811958909035, decouple_loss:0.008955277502536774
loss_pred:0.02160683460533619, decouple_loss:0.008703307248651981
The generated pressure mean: 0.44782987236976624
loss_pred:0.023405771702528, decouple_loss:0.008983240462839603
Iteration: 2209, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4575303792953491
The generated pressure mean: 0.4533579647541046
loss_pred:0.02207825891673565, decouple_loss:0.008713671006262302
loss_pred:0.021876981481909752, decouple_loss:0.008786455728113651
The generated pressure mean: 0.4596813917160034
loss_pred:0.022228563204407692, decouple_loss:0.00872002076357603
Iteration: 2210, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43962976336479187
loss_pred:0.02206728607416153, decouple_loss:0.008273878134787083
The generated pressure mean: 0.4416055679321289
loss_pred:0.02265101857483387, decouple_loss:0.00825042650103569
The generated pressure mean: 0.4461108446121216
loss_pred:0.024443013593554497, decouple_loss:0.008359730243682861
2023-04-16 20:30:36 testing...
The generated pressure mean: 0.41832202672958374
The generated pressure mean: 0.4244528114795685
The generated pressure mean: 0.42694899439811707
loss_pred:0.03202304616570473, decouple_loss:0.00975449476391077
loss_pred:0.031113935634493828, decouple_loss:0.009966692887246609
loss_pred:0.030859552323818207, decouple_loss:0.010177845135331154
WV_0_PC_0_EH_1_PS_40, loss: 0.031830497086048126, avg_mse: 0.043727051466703415
current test mse: 0.043727
Iteration: 2211, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43765386939048767
The generated pressure mean: 0.43705976009368896
loss_pred:0.02182060293853283, decouple_loss:0.009402420371770859
loss_pred:0.021679623052477837, decouple_loss:0.00942380353808403
The generated pressure mean: 0.43353626132011414
loss_pred:0.02346218191087246, decouple_loss:0.009489204734563828
Iteration: 2212, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4579548239707947
The generated pressure mean: 0.451389878988266
loss_pred:0.021914668381214142, decouple_loss:0.009684031829237938
loss_pred:0.02174427919089794, decouple_loss:0.009524999186396599
The generated pressure mean: 0.4549676775932312
loss_pred:0.022693168371915817, decouple_loss:0.009566140361130238
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2213, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4560214579105377The generated pressure mean: 0.4555932581424713
loss_pred:0.021157637238502502, decouple_loss:0.009093810804188251loss_pred:0.021840775385499, decouple_loss:0.008739643730223179
The generated pressure mean: 0.4582650065422058
loss_pred:0.022883078083395958, decouple_loss:0.008914362639188766
Iteration: 2214, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43923166394233704
The generated pressure mean: 0.44100186228752136
loss_pred:0.023501133546233177, decouple_loss:0.009427553042769432
loss_pred:0.02126111090183258, decouple_loss:0.009656138718128204
The generated pressure mean: 0.4392925202846527
loss_pred:0.020569050684571266, decouple_loss:0.009545039385557175
Iteration: 2215, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4434487521648407
The generated pressure mean: 0.4403369724750519
loss_pred:0.02290165051817894, decouple_loss:0.009393359534442425
loss_pred:0.022078169509768486, decouple_loss:0.009298145771026611
The generated pressure mean: 0.4414002001285553
loss_pred:0.023419175297021866, decouple_loss:0.009358328767120838
Iteration: 2216, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44415444135665894
The generated pressure mean: 0.4416262209415436
loss_pred:0.02154017612338066, decouple_loss:0.009789626114070415
loss_pred:0.023058239370584488, decouple_loss:0.00983149278908968
The generated pressure mean: 0.4413926303386688
loss_pred:0.022051719948649406, decouple_loss:0.0100382249802351
Iteration: 2217, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4523298144340515
The generated pressure mean: 0.4555802047252655
loss_pred:0.02179962955415249, decouple_loss:0.008999641984701157
loss_pred:0.02230962924659252, decouple_loss:0.009050111286342144
The generated pressure mean: 0.4513854682445526
loss_pred:0.022381292656064034, decouple_loss:0.009073414839804173
Iteration: 2218, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4513837397098541
loss_pred:0.022951848804950714, decouple_loss:0.008782362565398216
The generated pressure mean: 0.44985923171043396
loss_pred:0.02206369861960411, decouple_loss:0.008747899904847145
The generated pressure mean: 0.4538609981536865
loss_pred:0.02185049094259739, decouple_loss:0.008759611286222935
Iteration: 2219, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4451804459095001
loss_pred:0.02277521975338459, decouple_loss:0.00922195054590702
The generated pressure mean: 0.44789159297943115
loss_pred:0.02067229524254799, decouple_loss:0.009355689398944378
The generated pressure mean: 0.4456389546394348
loss_pred:0.02267407439649105, decouple_loss:0.009270697832107544
Iteration: 2220, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4441351890563965
loss_pred:0.02321525104343891, decouple_loss:0.009038722142577171
The generated pressure mean: 0.44103920459747314
loss_pred:0.023026591166853905, decouple_loss:0.009218970313668251
The generated pressure mean: 0.4417383074760437
loss_pred:0.023201603442430496, decouple_loss:0.008986878208816051
2023-04-16 20:32:28 testing...
The generated pressure mean: 0.4174967408180237
The generated pressure mean: 0.4244639277458191
The generated pressure mean: 0.4271833002567291
loss_pred:0.033223167061805725, decouple_loss:0.010379047133028507
loss_pred:0.032047998160123825, decouple_loss:0.01054522767663002
loss_pred:0.03187134861946106, decouple_loss:0.01065630279481411
WV_0_PC_0_EH_1_PS_40, loss: 0.03290718421339989, avg_mse: 0.046052318066358566
current test mse: 0.046052
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 2221, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4445880353450775
loss_pred:0.02166726067662239, decouple_loss:0.010288937948644161
The generated pressure mean: 0.4400952458381653
loss_pred:0.022035054862499237, decouple_loss:0.010034523904323578
The generated pressure mean: 0.4475659728050232
loss_pred:0.021043699234724045, decouple_loss:0.010251272469758987
Iteration: 2222, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44890910387039185
The generated pressure mean: 0.45223307609558105
loss_pred:0.020013829693198204, decouple_loss:0.009059078060090542
loss_pred:0.020965971052646637, decouple_loss:0.009162094444036484
The generated pressure mean: 0.4496816098690033
loss_pred:0.02201741933822632, decouple_loss:0.0093051353469491
Iteration: 2223, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498571455478668
The generated pressure mean: 0.449637770652771
loss_pred:0.020747218281030655, decouple_loss:0.008735651150345802
loss_pred:0.022289037704467773, decouple_loss:0.008848531171679497
The generated pressure mean: 0.4515465199947357
loss_pred:0.022578289732336998, decouple_loss:0.00896776095032692
Iteration: 2224, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44328007102012634
The generated pressure mean: 0.4416843354701996
loss_pred:0.02244023233652115, decouple_loss:0.008613895624876022
loss_pred:0.021906528621912003, decouple_loss:0.008624076843261719
The generated pressure mean: 0.44061166048049927
loss_pred:0.02045500837266445, decouple_loss:0.008733351714909077
Iteration: 2225, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44515663385391235
loss_pred:0.020875297486782074, decouple_loss:0.008691595867276192
The generated pressure mean: 0.4472062289714813
loss_pred:0.021405156701803207, decouple_loss:0.0087071992456913
The generated pressure mean: 0.45254048705101013
loss_pred:0.01976723037660122, decouple_loss:0.008795462548732758
Iteration: 2226, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45412442088127136
The generated pressure mean: 0.4487437605857849
loss_pred:0.02166163921356201, decouple_loss:0.010128265246748924
loss_pred:0.0209210105240345, decouple_loss:0.010272829793393612
The generated pressure mean: 0.45325741171836853
loss_pred:0.021201331168413162, decouple_loss:0.010350529104471207
Iteration: 2227, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4432152211666107
The generated pressure mean: 0.45267388224601746loss_pred:0.022631259635090828, decouple_loss:0.0098712844774127
loss_pred:0.021735206246376038, decouple_loss:0.010017454624176025
The generated pressure mean: 0.45062902569770813
loss_pred:0.02071439102292061, decouple_loss:0.009804672561585903
Iteration: 2228, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4397580325603485
loss_pred:0.022101838141679764, decouple_loss:0.009897088631987572
The generated pressure mean: 0.4441012442111969
loss_pred:0.020989377051591873, decouple_loss:0.00994851067662239
The generated pressure mean: 0.4422400891780853
loss_pred:0.0210599172860384, decouple_loss:0.009783782996237278
Iteration: 2229, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4444406032562256
The generated pressure mean: 0.4448123574256897loss_pred:0.021486710757017136, decouple_loss:0.008462336845695972
loss_pred:0.02233433909714222, decouple_loss:0.008685036562383175
The generated pressure mean: 0.4405612349510193
loss_pred:0.02100999653339386, decouple_loss:0.008424343541264534
Iteration: 2230, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4443266689777374
loss_pred:0.02019575424492359, decouple_loss:0.009278684854507446
The generated pressure mean: 0.445904940366745
loss_pred:0.02179747447371483, decouple_loss:0.009415175765752792
The generated pressure mean: 0.44619113206863403
loss_pred:0.022508366033434868, decouple_loss:0.009279866702854633
2023-04-16 20:34:58 testing...
The generated pressure mean: 0.41543641686439514
The generated pressure mean: 0.42248162627220154
loss_pred:0.0328017994761467, decouple_loss:0.010966611094772816
The generated pressure mean: 0.4253854751586914
loss_pred:0.03161567449569702, decouple_loss:0.011220886372029781
loss_pred:0.031340762972831726, decouple_loss:0.011413255706429482
WV_0_PC_0_EH_1_PS_40, loss: 0.032479427754879, avg_mse: 0.04538572579622269
current test mse: 0.045386
Iteration: 2231, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4542211890220642
The generated pressure mean: 0.4571012556552887
loss_pred:0.021365251392126083, decouple_loss:0.010420823469758034
loss_pred:0.020688481628894806, decouple_loss:0.010403523221611977
The generated pressure mean: 0.45664772391319275
loss_pred:0.02184526063501835, decouple_loss:0.01050565019249916
Iteration: 2232, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470177888870239
loss_pred:0.021493885666131973, decouple_loss:0.009497051127254963
The generated pressure mean: 0.4457758069038391
loss_pred:0.022308580577373505, decouple_loss:0.009595426730811596
The generated pressure mean: 0.44095343351364136
loss_pred:0.022846238687634468, decouple_loss:0.009618854150176048
Iteration: 2233, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44174984097480774
loss_pred:0.021540675312280655, decouple_loss:0.00860879197716713
The generated pressure mean: 0.44245922565460205
loss_pred:0.02204500325024128, decouple_loss:0.008474322035908699
The generated pressure mean: 0.44068264961242676
loss_pred:0.022501595318317413, decouple_loss:0.00858477782458067
Iteration: 2234, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4572162330150604
The generated pressure mean: 0.4509575068950653
loss_pred:0.021929889917373657, decouple_loss:0.008910173550248146
loss_pred:0.0209577064961195, decouple_loss:0.008915666490793228
The generated pressure mean: 0.4529496729373932
loss_pred:0.021094225347042084, decouple_loss:0.00888554472476244
Iteration: 2235, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4428237974643707
The generated pressure mean: 0.4442308843135834loss_pred:0.021726461127400398, decouple_loss:0.009976891800761223
loss_pred:0.021335534751415253, decouple_loss:0.009848703630268574
The generated pressure mean: 0.4466131627559662
loss_pred:0.020605353638529778, decouple_loss:0.009919262491166592
Iteration: 2236, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44512423872947693
The generated pressure mean: 0.4418385624885559
loss_pred:0.021725090220570564, decouple_loss:0.009277887642383575
loss_pred:0.02299284003674984, decouple_loss:0.009363580495119095
The generated pressure mean: 0.44365397095680237
loss_pred:0.020084712654352188, decouple_loss:0.009271572344005108
Iteration: 2237, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478919804096222
The generated pressure mean: 0.44948288798332214
loss_pred:0.021995041519403458, decouple_loss:0.008577464148402214
loss_pred:0.02062232606112957, decouple_loss:0.008556697517633438
The generated pressure mean: 0.45390769839286804
loss_pred:0.022531608119606972, decouple_loss:0.008371254429221153
Iteration: 2238, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501056671142578
loss_pred:0.02278023585677147, decouple_loss:0.009502053260803223
The generated pressure mean: 0.44816941022872925
loss_pred:0.021250396966934204, decouple_loss:0.0096846092492342
The generated pressure mean: 0.44593095779418945
loss_pred:0.02094879001379013, decouple_loss:0.009566623717546463
Iteration: 2239, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43830955028533936
The generated pressure mean: 0.4347897171974182
loss_pred:0.020660212263464928, decouple_loss:0.008816923946142197
loss_pred:0.020549606531858444, decouple_loss:0.008915760554373264
The generated pressure mean: 0.4360405206680298
loss_pred:0.02196030132472515, decouple_loss:0.009085836820304394
Iteration: 2240, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4551164209842682The generated pressure mean: 0.4544648230075836
loss_pred:0.023132534697651863, decouple_loss:0.008897515013813972loss_pred:0.02125309221446514, decouple_loss:0.008714258670806885
The generated pressure mean: 0.45145654678344727
loss_pred:0.021191086620092392, decouple_loss:0.008735699579119682
2023-04-16 20:36:49 testing...
The generated pressure mean: 0.41647398471832275
The generated pressure mean: 0.4224618375301361
loss_pred:0.032918013632297516, decouple_loss:0.010658693499863148
The generated pressure mean: 0.4249975383281708
loss_pred:0.03159242868423462, decouple_loss:0.010727732442319393
loss_pred:0.03133438900113106, decouple_loss:0.01078511867672205
WV_0_PC_0_EH_1_PS_40, loss: 0.03248446807265282, avg_mse: 0.04497891291975975
current test mse: 0.044979
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 2241, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44654810428619385
loss_pred:0.02285960502922535, decouple_loss:0.010369434021413326
The generated pressure mean: 0.4508107006549835
loss_pred:0.021814825013279915, decouple_loss:0.010387511923909187
The generated pressure mean: 0.4514642655849457
loss_pred:0.020333290100097656, decouple_loss:0.010333087295293808
Iteration: 2242, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4367408752441406
loss_pred:0.021521931514143944, decouple_loss:0.009963694959878922
The generated pressure mean: 0.447165846824646
loss_pred:0.022561926394701004, decouple_loss:0.0100336205214262
The generated pressure mean: 0.44357138872146606
loss_pred:0.021499382331967354, decouple_loss:0.010024002753198147
Iteration: 2243, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4435149133205414
loss_pred:0.02214442566037178, decouple_loss:0.009473767131567001
The generated pressure mean: 0.44487032294273376
loss_pred:0.02100997418165207, decouple_loss:0.009380057454109192
The generated pressure mean: 0.4437882602214813
loss_pred:0.021518371999263763, decouple_loss:0.009490867145359516
Iteration: 2244, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.440437376499176
The generated pressure mean: 0.4424498677253723
loss_pred:0.02052617073059082, decouple_loss:0.009815295226871967
loss_pred:0.022147661074995995, decouple_loss:0.009772286750376225
The generated pressure mean: 0.446042537689209
loss_pred:0.02119002863764763, decouple_loss:0.00990309752523899
Iteration: 2245, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45682284235954285
The generated pressure mean: 0.45186853408813477
loss_pred:0.022026004269719124, decouple_loss:0.010486857034265995
loss_pred:0.023000027984380722, decouple_loss:0.010355337522923946
The generated pressure mean: 0.4524082839488983
loss_pred:0.022387653589248657, decouple_loss:0.010324832051992416
Iteration: 2246, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478987157344818
The generated pressure mean: 0.4476219117641449
loss_pred:0.02188136987388134, decouple_loss:0.0102635957300663
loss_pred:0.022766513749957085, decouple_loss:0.010177613236010075
The generated pressure mean: 0.44901835918426514
loss_pred:0.021037453785538673, decouple_loss:0.010143744759261608
Iteration: 2247, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495016634464264
The generated pressure mean: 0.44566524028778076
loss_pred:0.021967492997646332, decouple_loss:0.009760180488228798
loss_pred:0.021401017904281616, decouple_loss:0.009735452942550182
The generated pressure mean: 0.44328761100769043
loss_pred:0.02130989171564579, decouple_loss:0.00988573394715786
Iteration: 2248, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4339319169521332
loss_pred:0.02328466810286045, decouple_loss:0.009678594768047333
The generated pressure mean: 0.44355669617652893
loss_pred:0.022131329402327538, decouple_loss:0.009438659995794296
The generated pressure mean: 0.43505993485450745
loss_pred:0.02160346880555153, decouple_loss:0.00938697811216116
Iteration: 2249, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44543811678886414The generated pressure mean: 0.4430007338523865
loss_pred:0.020377980545163155, decouple_loss:0.008703742176294327
loss_pred:0.0217380803078413, decouple_loss:0.008769821375608444
The generated pressure mean: 0.44688063859939575
loss_pred:0.021691210567951202, decouple_loss:0.008872696198523045
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2250, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44886156916618347
The generated pressure mean: 0.4533059298992157
loss_pred:0.021029269322752953, decouple_loss:0.009375113062560558
loss_pred:0.022299757227301598, decouple_loss:0.009313573129475117
The generated pressure mean: 0.4541017413139343
loss_pred:0.02196837216615677, decouple_loss:0.009119503200054169
2023-04-16 20:39:23 testing...
The generated pressure mean: 0.4174208343029022
The generated pressure mean: 0.4233962595462799
The generated pressure mean: 0.4259672462940216
loss_pred:0.03251635283231735, decouple_loss:0.011252651922404766
loss_pred:0.031165465712547302, decouple_loss:0.011514103040099144
loss_pred:0.031468465924263, decouple_loss:0.011382120661437511
WV_0_PC_0_EH_1_PS_40, loss: 0.0322859100997448, avg_mse: 0.04453994333744049
current test mse: 0.04454
Iteration: 2251, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4409394860267639
The generated pressure mean: 0.43806222081184387
loss_pred:0.021514728665351868, decouple_loss:0.010744825005531311
loss_pred:0.02145944908261299, decouple_loss:0.010906178504228592
The generated pressure mean: 0.4405938684940338
loss_pred:0.02221044898033142, decouple_loss:0.010870176367461681
Iteration: 2252, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448415607213974
loss_pred:0.020338142290711403, decouple_loss:0.009813466109335423
The generated pressure mean: 0.45057690143585205
loss_pred:0.0214395672082901, decouple_loss:0.009952839463949203
The generated pressure mean: 0.45099613070487976
loss_pred:0.020652128383517265, decouple_loss:0.010130276903510094
Iteration: 2253, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4530423581600189
The generated pressure mean: 0.45206302404403687
loss_pred:0.02122269943356514, decouple_loss:0.0093286894261837
loss_pred:0.022076250985264778, decouple_loss:0.009148359298706055
The generated pressure mean: 0.45384055376052856
loss_pred:0.021558742970228195, decouple_loss:0.009151467122137547
Iteration: 2254, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4388059675693512
The generated pressure mean: 0.44218161702156067
loss_pred:0.02087005414068699, decouple_loss:0.00983506627380848
loss_pred:0.021316705271601677, decouple_loss:0.009712213650345802
The generated pressure mean: 0.44403502345085144
loss_pred:0.021925916895270348, decouple_loss:0.009738622233271599
Iteration: 2255, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43803858757019043
The generated pressure mean: 0.43541860580444336
loss_pred:0.02191333845257759, decouple_loss:0.009665270335972309
loss_pred:0.02102753147482872, decouple_loss:0.009332744404673576
The generated pressure mean: 0.4339444041252136
loss_pred:0.021144872531294823, decouple_loss:0.009595626965165138
Iteration: 2256, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484575390815735
The generated pressure mean: 0.44940677285194397
loss_pred:0.021427059546113014, decouple_loss:0.009133351035416126
loss_pred:0.02062228135764599, decouple_loss:0.009221088141202927
The generated pressure mean: 0.4450071454048157
loss_pred:0.022044025361537933, decouple_loss:0.009312350302934647
Iteration: 2257, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4565393626689911
loss_pred:0.021730152890086174, decouple_loss:0.010277658700942993
The generated pressure mean: 0.45438870787620544
loss_pred:0.022206520661711693, decouple_loss:0.010269536636769772
The generated pressure mean: 0.45455604791641235
loss_pred:0.021335609257221222, decouple_loss:0.01023416593670845
Iteration: 2258, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44828179478645325
loss_pred:0.020755818113684654, decouple_loss:0.009875897318124771
The generated pressure mean: 0.45159777998924255
loss_pred:0.020959828048944473, decouple_loss:0.009840560145676136
The generated pressure mean: 0.44984209537506104
loss_pred:0.022430507466197014, decouple_loss:0.009823412634432316
Iteration: 2259, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4389955401420593
The generated pressure mean: 0.4359952211380005
loss_pred:0.02086813561618328, decouple_loss:0.008479316718876362
loss_pred:0.021060125902295113, decouple_loss:0.008674903772771358
The generated pressure mean: 0.4374062418937683
loss_pred:0.021895170211791992, decouple_loss:0.008596104569733143
Iteration: 2260, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476469159126282
loss_pred:0.021277697756886482, decouple_loss:0.009161869063973427
The generated pressure mean: 0.4442422389984131
loss_pred:0.02192424051463604, decouple_loss:0.008858317509293556
The generated pressure mean: 0.44820135831832886
loss_pred:0.02137448638677597, decouple_loss:0.009060772135853767
2023-04-16 20:41:14 testing...
The generated pressure mean: 0.4217211902141571
The generated pressure mean: 0.41524365544319153
The generated pressure mean: 0.42426830530166626
loss_pred:0.03145039826631546, decouple_loss:0.0112944720312953
loss_pred:0.03243082016706467, decouple_loss:0.011073177680373192
loss_pred:0.03107660822570324, decouple_loss:0.011496737599372864
WV_0_PC_0_EH_1_PS_40, loss: 0.03221701830625534, avg_mse: 0.044655345380306244
current test mse: 0.044655
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 2261, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44922250509262085
loss_pred:0.021850332617759705, decouple_loss:0.010845097713172436
The generated pressure mean: 0.45320045948028564
loss_pred:0.023541757836937904, decouple_loss:0.010815443471074104
The generated pressure mean: 0.44934818148612976
loss_pred:0.021945346146821976, decouple_loss:0.010889590717852116
Iteration: 2262, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44383299350738525
The generated pressure mean: 0.44164615869522095
loss_pred:0.02065318636596203, decouple_loss:0.01094446238130331
loss_pred:0.02218841016292572, decouple_loss:0.010711580514907837
The generated pressure mean: 0.44621992111206055
loss_pred:0.02158529683947563, decouple_loss:0.010736430063843727
Iteration: 2263, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442337453365326
The generated pressure mean: 0.45006072521209717
loss_pred:0.022120269015431404, decouple_loss:0.009080898948013783
loss_pred:0.020543722435832024, decouple_loss:0.00909663736820221
The generated pressure mean: 0.44380661845207214
loss_pred:0.022214002907276154, decouple_loss:0.009093391709029675
Iteration: 2264, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462835192680359
The generated pressure mean: 0.4485718905925751
loss_pred:0.021436965093016624, decouple_loss:0.008557641878724098
loss_pred:0.022254731506109238, decouple_loss:0.008777721785008907
The generated pressure mean: 0.44606852531433105
loss_pred:0.021947184577584267, decouple_loss:0.008661534637212753
Iteration: 2265, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4450435936450958
The generated pressure mean: 0.44236138463020325
loss_pred:0.02055983804166317, decouple_loss:0.010416790843009949
loss_pred:0.020787952467799187, decouple_loss:0.010321253910660744
The generated pressure mean: 0.443313330411911
loss_pred:0.022117147222161293, decouple_loss:0.010560323484241962
Iteration: 2266, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45224374532699585
The generated pressure mean: 0.4499683380126953
loss_pred:0.022226206958293915, decouple_loss:0.00970473699271679
loss_pred:0.021398918703198433, decouple_loss:0.00958385318517685
The generated pressure mean: 0.4538860321044922
loss_pred:0.021060382947325706, decouple_loss:0.009816647507250309
Iteration: 2267, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4454170763492584
The generated pressure mean: 0.44636884331703186
loss_pred:0.023153405636548996, decouple_loss:0.009673449210822582
loss_pred:0.023559391498565674, decouple_loss:0.009733221493661404
The generated pressure mean: 0.4504980146884918
loss_pred:0.021845094859600067, decouple_loss:0.009633676148951054
Iteration: 2268, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4405088722705841
loss_pred:0.02152632735669613, decouple_loss:0.010608786717057228
The generated pressure mean: 0.4404582679271698
loss_pred:0.021859468892216682, decouple_loss:0.010667828842997551
The generated pressure mean: 0.440157949924469
loss_pred:0.020279482007026672, decouple_loss:0.010579928755760193
Iteration: 2269, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44368672370910645
loss_pred:0.02220953442156315, decouple_loss:0.009810318239033222
The generated pressure mean: 0.4419234097003937
loss_pred:0.02209167554974556, decouple_loss:0.009806954301893711
The generated pressure mean: 0.4447803795337677
loss_pred:0.022438159212470055, decouple_loss:0.009803763590753078
Iteration: 2270, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4525153636932373
loss_pred:0.021057408303022385, decouple_loss:0.008727842010557652
The generated pressure mean: 0.4546426236629486
loss_pred:0.02167024090886116, decouple_loss:0.008800101466476917
The generated pressure mean: 0.44885069131851196
loss_pred:0.021214082837104797, decouple_loss:0.008805003948509693
2023-04-16 20:43:42 testing...
The generated pressure mean: 0.41608646512031555
The generated pressure mean: 0.4236038327217102
The generated pressure mean: 0.4262571334838867
loss_pred:0.03365352377295494, decouple_loss:0.010238573886454105
loss_pred:0.03200957924127579, decouple_loss:0.010395600460469723
loss_pred:0.03202744200825691, decouple_loss:0.010569986887276173
WV_0_PC_0_EH_1_PS_40, loss: 0.033083584159612656, avg_mse: 0.04670099541544914
current test mse: 0.046701
Iteration: 2271, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44481146335601807
The generated pressure mean: 0.44903603196144104
loss_pred:0.022525576874613762, decouple_loss:0.009462578222155571
loss_pred:0.021848035976290703, decouple_loss:0.00969826988875866
The generated pressure mean: 0.4521499276161194
loss_pred:0.022206993773579597, decouple_loss:0.009632699191570282
Iteration: 2272, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44496530294418335The generated pressure mean: 0.4448368549346924
loss_pred:0.021163592115044594, decouple_loss:0.010420293547213078
loss_pred:0.02071055956184864, decouple_loss:0.01059737615287304
The generated pressure mean: 0.4470402002334595
loss_pred:0.021796083077788353, decouple_loss:0.010488065890967846
Iteration: 2273, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44574248790740967
loss_pred:0.021903591230511665, decouple_loss:0.00967926811426878
The generated pressure mean: 0.4429910182952881
loss_pred:0.02130815014243126, decouple_loss:0.009625212289392948
The generated pressure mean: 0.4438888132572174
loss_pred:0.02232837677001953, decouple_loss:0.009424128569662571
Iteration: 2274, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474409818649292
loss_pred:0.02017338015139103, decouple_loss:0.00831115897744894
The generated pressure mean: 0.44546636939048767
loss_pred:0.021368512883782387, decouple_loss:0.008322393521666527
The generated pressure mean: 0.44796493649482727
loss_pred:0.02245400846004486, decouple_loss:0.008453079499304295
Iteration: 2275, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44703155755996704
The generated pressure mean: 0.44573041796684265
loss_pred:0.020091895014047623, decouple_loss:0.009126763790845871
loss_pred:0.020423784852027893, decouple_loss:0.00886695645749569
The generated pressure mean: 0.44406858086586
loss_pred:0.022775521501898766, decouple_loss:0.008888342417776585
Iteration: 2276, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44861966371536255
loss_pred:0.02138417400419712, decouple_loss:0.010210597887635231
The generated pressure mean: 0.45218029618263245
loss_pred:0.023078786209225655, decouple_loss:0.010123112238943577
The generated pressure mean: 0.450306236743927
loss_pred:0.022473324090242386, decouple_loss:0.01021732110530138
Iteration: 2277, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44703754782676697
loss_pred:0.02255195379257202, decouple_loss:0.01015552505850792
The generated pressure mean: 0.44291478395462036
loss_pred:0.022862575948238373, decouple_loss:0.010125946253538132
The generated pressure mean: 0.446189284324646
loss_pred:0.02155747078359127, decouple_loss:0.010271046310663223
Iteration: 2278, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484984278678894
loss_pred:0.02256440743803978, decouple_loss:0.0096319280564785
The generated pressure mean: 0.4493914246559143
loss_pred:0.021293871104717255, decouple_loss:0.009577580727636814
The generated pressure mean: 0.44610539078712463
loss_pred:0.021051965653896332, decouple_loss:0.009674119763076305
Iteration: 2279, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4447705149650574The generated pressure mean: 0.4484018087387085
loss_pred:0.021409038454294205, decouple_loss:0.010030671954154968
loss_pred:0.021463437005877495, decouple_loss:0.01007703598588705
The generated pressure mean: 0.44364166259765625
loss_pred:0.021217357367277145, decouple_loss:0.0101476414129138
Iteration: 2280, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44893357157707214
loss_pred:0.022724894806742668, decouple_loss:0.011258992366492748
The generated pressure mean: 0.4457750618457794
loss_pred:0.02110927365720272, decouple_loss:0.01118609867990017
The generated pressure mean: 0.44128456711769104
loss_pred:0.020191270858049393, decouple_loss:0.011172899045050144
2023-04-16 20:45:33 testing...
The generated pressure mean: 0.41642940044403076
The generated pressure mean: 0.42297622561454773
The generated pressure mean: 0.42549195885658264
loss_pred:0.032941967248916626, decouple_loss:0.010488969273865223
loss_pred:0.03164505958557129, decouple_loss:0.010723146609961987
loss_pred:0.0313829705119133, decouple_loss:0.010863599367439747
WV_0_PC_0_EH_1_PS_40, loss: 0.03252459689974785, avg_mse: 0.04541465640068054
current test mse: 0.045415
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 2281, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4455778896808624
loss_pred:0.02090330421924591, decouple_loss:0.010038282722234726
The generated pressure mean: 0.44873303174972534
loss_pred:0.021679578348994255, decouple_loss:0.010040459223091602
The generated pressure mean: 0.45059579610824585
loss_pred:0.02113904245197773, decouple_loss:0.010045355185866356
Iteration: 2282, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44902709126472473
The generated pressure mean: 0.44512397050857544loss_pred:0.023029569536447525, decouple_loss:0.00916699692606926
loss_pred:0.020985212177038193, decouple_loss:0.00907678622752428
The generated pressure mean: 0.4507143199443817
loss_pred:0.021086901426315308, decouple_loss:0.009110895916819572
Iteration: 2283, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44506895542144775
loss_pred:0.021679705008864403, decouple_loss:0.008054196834564209
The generated pressure mean: 0.43899422883987427
loss_pred:0.02189212664961815, decouple_loss:0.008361943997442722
The generated pressure mean: 0.443477988243103
loss_pred:0.022246459499001503, decouple_loss:0.008171585388481617
Iteration: 2284, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446082204580307
loss_pred:0.02157091349363327, decouple_loss:0.009084129706025124
The generated pressure mean: 0.44489821791648865
loss_pred:0.020719772204756737, decouple_loss:0.009055747650563717
The generated pressure mean: 0.44692936539649963
loss_pred:0.021442793309688568, decouple_loss:0.009136618115007877
Iteration: 2285, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469190239906311
loss_pred:0.02176433615386486, decouple_loss:0.01065177284181118The generated pressure mean: 0.4524863064289093
loss_pred:0.021224113181233406, decouple_loss:0.010480380617082119
The generated pressure mean: 0.4490651786327362
loss_pred:0.021859537810087204, decouple_loss:0.010710581205785275
Iteration: 2286, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478525221347809
The generated pressure mean: 0.4475027918815613
loss_pred:0.02022790163755417, decouple_loss:0.010914312675595284
loss_pred:0.02245471626520157, decouple_loss:0.010885799303650856
The generated pressure mean: 0.45402050018310547
loss_pred:0.021305439993739128, decouple_loss:0.010936642996966839
Iteration: 2287, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490455090999603
The generated pressure mean: 0.45059457421302795
loss_pred:0.021895401179790497, decouple_loss:0.008979289792478085
loss_pred:0.021084656938910484, decouple_loss:0.008953796699643135
The generated pressure mean: 0.45164239406585693
loss_pred:0.02107052505016327, decouple_loss:0.008943074382841587
Iteration: 2288, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.437837153673172
loss_pred:0.02132888324558735, decouple_loss:0.009498532861471176
The generated pressure mean: 0.43468666076660156
loss_pred:0.022648120298981667, decouple_loss:0.009482367895543575
The generated pressure mean: 0.4439840316772461
loss_pred:0.02133224345743656, decouple_loss:0.009390806779265404
Iteration: 2289, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4412064552307129
loss_pred:0.020566267892718315, decouple_loss:0.01025882363319397
The generated pressure mean: 0.44604766368865967
loss_pred:0.02129378356039524, decouple_loss:0.010048755444586277
The generated pressure mean: 0.44954732060432434
loss_pred:0.021158576011657715, decouple_loss:0.010194683447480202
Iteration: 2290, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4521215260028839
loss_pred:0.02191801555454731, decouple_loss:0.009621155448257923
The generated pressure mean: 0.4479328989982605
loss_pred:0.022130141034722328, decouple_loss:0.009723748080432415
The generated pressure mean: 0.448561429977417
loss_pred:0.02171236276626587, decouple_loss:0.00970806647092104
2023-04-16 20:48:07 testing...
The generated pressure mean: 0.4173935353755951
The generated pressure mean: 0.4235852360725403
loss_pred:0.03195337951183319, decouple_loss:0.009484414011240005
The generated pressure mean: 0.4265136420726776
loss_pred:0.030704697594046593, decouple_loss:0.009685186669230461
loss_pred:0.030249733477830887, decouple_loss:0.00977377686649561
WV_0_PC_0_EH_1_PS_40, loss: 0.03145166113972664, avg_mse: 0.04333151876926422
current test mse: 0.043332
Iteration: 2291, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44630691409111023
loss_pred:0.021008050069212914, decouple_loss:0.008817476220428944
The generated pressure mean: 0.445602148771286
loss_pred:0.020585976541042328, decouple_loss:0.008883533999323845
The generated pressure mean: 0.43949180841445923
loss_pred:0.02192334085702896, decouple_loss:0.008716542273759842
Iteration: 2292, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44409888982772827
loss_pred:0.020545003935694695, decouple_loss:0.00837473850697279
The generated pressure mean: 0.4513116478919983
loss_pred:0.020779011771082878, decouple_loss:0.008573188446462154
The generated pressure mean: 0.4524035155773163
loss_pred:0.02041543833911419, decouple_loss:0.00846904143691063
Iteration: 2293, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45759499073028564
loss_pred:0.021320313215255737, decouple_loss:0.00867603998631239
The generated pressure mean: 0.45747581124305725
loss_pred:0.02081366814672947, decouple_loss:0.008585459552705288
The generated pressure mean: 0.452452152967453
loss_pred:0.02198893390595913, decouple_loss:0.008551552891731262
Iteration: 2294, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44374775886535645
The generated pressure mean: 0.4429256319999695loss_pred:0.01996663585305214, decouple_loss:0.008746673353016376
loss_pred:0.021858828142285347, decouple_loss:0.008856479078531265
The generated pressure mean: 0.4427913427352905
loss_pred:0.021445883437991142, decouple_loss:0.00895558763295412
Iteration: 2295, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43643856048583984
loss_pred:0.0216230396181345, decouple_loss:0.009069973602890968
The generated pressure mean: 0.43442150950431824
loss_pred:0.020979255437850952, decouple_loss:0.009240683168172836
The generated pressure mean: 0.4332149028778076
loss_pred:0.023615369573235512, decouple_loss:0.009318915195763111
Iteration: 2296, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44119855761528015
loss_pred:0.02010006457567215, decouple_loss:0.009039467200636864
The generated pressure mean: 0.4408496916294098
loss_pred:0.021131647750735283, decouple_loss:0.009028940461575985
The generated pressure mean: 0.4412236511707306
loss_pred:0.020658167079091072, decouple_loss:0.009114974178373814
Iteration: 2297, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46183785796165466
loss_pred:0.02068108320236206, decouple_loss:0.010271485894918442
The generated pressure mean: 0.4648124873638153
loss_pred:0.022522540763020515, decouple_loss:0.01028286013752222
The generated pressure mean: 0.46018847823143005
loss_pred:0.021987205371260643, decouple_loss:0.010209090076386929
Iteration: 2298, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4539242088794708
loss_pred:0.02160034514963627, decouple_loss:0.009366299957036972
The generated pressure mean: 0.45137813687324524
loss_pred:0.022067813202738762, decouple_loss:0.009114480577409267
The generated pressure mean: 0.45527008175849915
loss_pred:0.02172652818262577, decouple_loss:0.009419675916433334
Iteration: 2299, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43834295868873596
loss_pred:0.022072413936257362, decouple_loss:0.008025902323424816
The generated pressure mean: 0.4477199912071228
loss_pred:0.02146701142191887, decouple_loss:0.007966043427586555
The generated pressure mean: 0.4439428746700287
loss_pred:0.02148262783885002, decouple_loss:0.008117582648992538
Iteration: 2300, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4349939525127411
loss_pred:0.021992137655615807, decouple_loss:0.008415860123932362
The generated pressure mean: 0.44221997261047363
loss_pred:0.021675877273082733, decouple_loss:0.00853960495442152
The generated pressure mean: 0.43802011013031006
loss_pred:0.021965391933918, decouple_loss:0.00838406104594469
2023-04-16 20:50:00 testing...
The generated pressure mean: 0.4179645776748657
The generated pressure mean: 0.42420315742492676
The generated pressure mean: 0.4266906976699829
loss_pred:0.03246082738041878, decouple_loss:0.00914313830435276
loss_pred:0.031148647889494896, decouple_loss:0.009343594312667847
loss_pred:0.03071255050599575, decouple_loss:0.009553031995892525
WV_0_PC_0_EH_1_PS_40, loss: 0.031908005475997925, avg_mse: 0.04450232908129692
current test mse: 0.044502
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 2301, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44505631923675537
loss_pred:0.021868892014026642, decouple_loss:0.009059842675924301
The generated pressure mean: 0.4428739547729492
loss_pred:0.02085178904235363, decouple_loss:0.008711385540664196
The generated pressure mean: 0.4412536323070526
loss_pred:0.020439261570572853, decouple_loss:0.008860880509018898
Iteration: 2302, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4546189308166504
loss_pred:0.02194669097661972, decouple_loss:0.008788355626165867
The generated pressure mean: 0.4531763195991516
loss_pred:0.021518157795071602, decouple_loss:0.009052412584424019
The generated pressure mean: 0.45536261796951294
loss_pred:0.022539203986525536, decouple_loss:0.009084346704185009
Iteration: 2303, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44535693526268005
The generated pressure mean: 0.44090619683265686loss_pred:0.02026447281241417, decouple_loss:0.00853682029992342
loss_pred:0.02215675264596939, decouple_loss:0.00868654903024435
The generated pressure mean: 0.44350695610046387
loss_pred:0.021273447200655937, decouple_loss:0.008799566887319088
Iteration: 2304, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4437722861766815
The generated pressure mean: 0.44201692938804626
loss_pred:0.021154046058654785, decouple_loss:0.009135756641626358
loss_pred:0.022354312241077423, decouple_loss:0.00922798365354538
The generated pressure mean: 0.44471386075019836
loss_pred:0.02149691805243492, decouple_loss:0.009093423373997211
Iteration: 2305, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486391842365265
loss_pred:0.023831598460674286, decouple_loss:0.008275352418422699
The generated pressure mean: 0.4510386884212494
loss_pred:0.021346958354115486, decouple_loss:0.008295539766550064
The generated pressure mean: 0.44874972105026245
loss_pred:0.02111329883337021, decouple_loss:0.008213086985051632
Iteration: 2306, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449092149734497
loss_pred:0.020097849890589714, decouple_loss:0.008185717277228832
The generated pressure mean: 0.4437260031700134
loss_pred:0.02097010239958763, decouple_loss:0.00811914261430502
The generated pressure mean: 0.44499537348747253
loss_pred:0.019292889162898064, decouple_loss:0.008229793980717659
Iteration: 2307, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.452705055475235
loss_pred:0.022098852321505547, decouple_loss:0.00858289748430252
The generated pressure mean: 0.4472590386867523
loss_pred:0.020973751321434975, decouple_loss:0.008417367935180664
The generated pressure mean: 0.4438004195690155
loss_pred:0.02019995078444481, decouple_loss:0.008287174627184868
Iteration: 2308, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4430706799030304
loss_pred:0.020713182166218758, decouple_loss:0.01030005794018507
The generated pressure mean: 0.4423507750034332
loss_pred:0.02165314555168152, decouple_loss:0.010184271261096
The generated pressure mean: 0.4498711824417114
loss_pred:0.020389316603541374, decouple_loss:0.01004466600716114
Iteration: 2309, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471468925476074
loss_pred:0.021014850586652756, decouple_loss:0.011226175352931023
The generated pressure mean: 0.43719613552093506
loss_pred:0.02087964490056038, decouple_loss:0.011003092862665653
The generated pressure mean: 0.4437202513217926
loss_pred:0.02243717573583126, decouple_loss:0.01101484801620245
Iteration: 2310, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44398823380470276
loss_pred:0.02078576572239399, decouple_loss:0.009357139468193054
The generated pressure mean: 0.4428747296333313
loss_pred:0.021721284836530685, decouple_loss:0.009325371123850346
The generated pressure mean: 0.4501612186431885
loss_pred:0.02142987586557865, decouple_loss:0.009286075830459595
2023-04-16 20:52:31 testing...
The generated pressure mean: 0.41470199823379517
The generated pressure mean: 0.4206175208091736
loss_pred:0.03277287632226944, decouple_loss:0.00898418016731739
The generated pressure mean: 0.4227718114852905
loss_pred:0.031388357281684875, decouple_loss:0.009199353866279125
loss_pred:0.03098512440919876, decouple_loss:0.009457622654736042
WV_0_PC_0_EH_1_PS_40, loss: 0.03217614069581032, avg_mse: 0.04457209259271622
current test mse: 0.044572
Iteration: 2311, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4543178677558899
loss_pred:0.02242819219827652, decouple_loss:0.008545204997062683
The generated pressure mean: 0.4582577347755432
loss_pred:0.02131727710366249, decouple_loss:0.008493519388139248
The generated pressure mean: 0.4529925584793091
loss_pred:0.021626828238368034, decouple_loss:0.008549447171390057
Iteration: 2312, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.439483106136322
loss_pred:0.022565944120287895, decouple_loss:0.008834579028189182
The generated pressure mean: 0.4443497359752655
loss_pred:0.020485099405050278, decouple_loss:0.008817796595394611
The generated pressure mean: 0.4448101818561554
loss_pred:0.02012009359896183, decouple_loss:0.008839832618832588
Iteration: 2313, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45033591985702515
loss_pred:0.02260255068540573, decouple_loss:0.00958817359060049
The generated pressure mean: 0.4456540644168854
loss_pred:0.02051573432981968, decouple_loss:0.009590651839971542
The generated pressure mean: 0.44215890765190125
loss_pred:0.021006552502512932, decouple_loss:0.009539088234305382
Iteration: 2314, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45184627175331116
loss_pred:0.02006017230451107, decouple_loss:0.009681660681962967
The generated pressure mean: 0.447919100522995
loss_pred:0.02096300572156906, decouple_loss:0.009656061418354511
The generated pressure mean: 0.44515010714530945
loss_pred:0.0213455967605114, decouple_loss:0.009736078791320324
Iteration: 2315, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43639227747917175
loss_pred:0.021378690376877785, decouple_loss:0.009365017525851727
The generated pressure mean: 0.4501856863498688
loss_pred:0.020011378452181816, decouple_loss:0.009457750245928764
The generated pressure mean: 0.4459383487701416
loss_pred:0.021721230819821358, decouple_loss:0.00949587021023035
Iteration: 2316, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4397604167461395
loss_pred:0.02234666422009468, decouple_loss:0.009784898720681667
The generated pressure mean: 0.44850587844848633
loss_pred:0.022043602541089058, decouple_loss:0.009766103699803352
The generated pressure mean: 0.44632962346076965
loss_pred:0.021095499396324158, decouple_loss:0.010028902441263199
Iteration: 2317, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45256075263023376
loss_pred:0.020863449200987816, decouple_loss:0.008921265602111816
The generated pressure mean: 0.4490094780921936
loss_pred:0.02163884975016117, decouple_loss:0.008739239536225796
The generated pressure mean: 0.44603976607322693
loss_pred:0.02191852405667305, decouple_loss:0.008795313537120819
Iteration: 2318, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44470131397247314
loss_pred:0.021581407636404037, decouple_loss:0.007957239635288715
The generated pressure mean: 0.4492902159690857
loss_pred:0.020723998546600342, decouple_loss:0.007946373894810677
The generated pressure mean: 0.44588324427604675
loss_pred:0.02084922417998314, decouple_loss:0.007826284505426884
Iteration: 2319, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45168256759643555
loss_pred:0.02004104293882847, decouple_loss:0.009019029326736927
The generated pressure mean: 0.4473937451839447
loss_pred:0.020753180608153343, decouple_loss:0.009026998654007912
The generated pressure mean: 0.44324198365211487
loss_pred:0.022135712206363678, decouple_loss:0.008792512118816376
Iteration: 2320, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467535614967346
loss_pred:0.02168624848127365, decouple_loss:0.008970090188086033
The generated pressure mean: 0.4474259614944458
loss_pred:0.019914008677005768, decouple_loss:0.008766868151724339
The generated pressure mean: 0.43924185633659363
loss_pred:0.021073535084724426, decouple_loss:0.008878964930772781
2023-04-16 20:54:25 testing...
The generated pressure mean: 0.41752055287361145
The generated pressure mean: 0.4237281382083893
The generated pressure mean: 0.4256182909011841
loss_pred:0.03254837542772293, decouple_loss:0.010337176732718945
loss_pred:0.0310494564473629, decouple_loss:0.010438685305416584
loss_pred:0.03077257238328457, decouple_loss:0.010608253069221973
WV_0_PC_0_EH_1_PS_40, loss: 0.031979870051145554, avg_mse: 0.044341202825307846
current test mse: 0.044341
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 2321, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44020965695381165
loss_pred:0.021461591124534607, decouple_loss:0.010164433158934116
The generated pressure mean: 0.4434897303581238
loss_pred:0.021242225542664528, decouple_loss:0.009939571842551231
The generated pressure mean: 0.44269341230392456
loss_pred:0.02101413533091545, decouple_loss:0.009943188168108463
Iteration: 2322, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4574751853942871
loss_pred:0.02042640745639801, decouple_loss:0.00991783756762743
The generated pressure mean: 0.46140697598457336
loss_pred:0.021162761375308037, decouple_loss:0.009787920862436295
The generated pressure mean: 0.4562303125858307
loss_pred:0.022687694057822227, decouple_loss:0.009993165731430054
Iteration: 2323, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4430549144744873
loss_pred:0.02219681441783905, decouple_loss:0.009091098792850971
The generated pressure mean: 0.44159722328186035
loss_pred:0.02181510254740715, decouple_loss:0.0089457668364048
The generated pressure mean: 0.43834319710731506
loss_pred:0.020285960286855698, decouple_loss:0.008904045447707176
Iteration: 2324, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4424179792404175
loss_pred:0.02132350578904152, decouple_loss:0.009240062907338142
The generated pressure mean: 0.44606098532676697
loss_pred:0.021925397217273712, decouple_loss:0.009173113852739334
The generated pressure mean: 0.447681188583374
loss_pred:0.020914090797305107, decouple_loss:0.009243940934538841
Iteration: 2325, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4606609642505646
loss_pred:0.021070579066872597, decouple_loss:0.010025606490671635
The generated pressure mean: 0.4525325894355774
loss_pred:0.02119990438222885, decouple_loss:0.010187220759689808
The generated pressure mean: 0.45662790536880493
loss_pred:0.020821841433644295, decouple_loss:0.010080738924443722
Iteration: 2326, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481394588947296
loss_pred:0.02154422551393509, decouple_loss:0.008541567251086235
The generated pressure mean: 0.45015081763267517
The generated pressure mean: 0.44950568675994873loss_pred:0.022324278950691223, decouple_loss:0.008724167943000793
loss_pred:0.021877456456422806, decouple_loss:0.00861466396600008
Iteration: 2327, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4386616051197052
loss_pred:0.01944967545568943, decouple_loss:0.009625404141843319
The generated pressure mean: 0.4365740120410919
loss_pred:0.021582024171948433, decouple_loss:0.009814309887588024
The generated pressure mean: 0.43555134534835815
loss_pred:0.0224465262144804, decouple_loss:0.009680664166808128
Iteration: 2328, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45819389820098877
loss_pred:0.021601088345050812, decouple_loss:0.01084393635392189
The generated pressure mean: 0.4596007168292999
loss_pred:0.019589398056268692, decouple_loss:0.010755837894976139
The generated pressure mean: 0.4563801884651184
loss_pred:0.02163531444966793, decouple_loss:0.01092374324798584
Iteration: 2329, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460688531398773
loss_pred:0.02269812673330307, decouple_loss:0.008586499840021133
The generated pressure mean: 0.44705668091773987
loss_pred:0.021280640736222267, decouple_loss:0.008731731213629246
The generated pressure mean: 0.4486824870109558
loss_pred:0.021831337362527847, decouple_loss:0.00867356825619936
Iteration: 2330, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43012502789497375
loss_pred:0.019758490845561028, decouple_loss:0.008694407530128956
The generated pressure mean: 0.4273354411125183
loss_pred:0.02087440714240074, decouple_loss:0.008849638514220715
The generated pressure mean: 0.43219006061553955
loss_pred:0.02200804278254509, decouple_loss:0.008707846514880657
2023-04-16 20:56:57 testing...
The generated pressure mean: 0.4156506359577179
The generated pressure mean: 0.42191243171691895
loss_pred:0.03291735798120499, decouple_loss:0.01099545881152153
The generated pressure mean: 0.4242345988750458
loss_pred:0.03172304853796959, decouple_loss:0.01130030769854784
loss_pred:0.03117898292839527, decouple_loss:0.011515986174345016
WV_0_PC_0_EH_1_PS_40, loss: 0.03250332921743393, avg_mse: 0.04503447189927101
current test mse: 0.045034
Iteration: 2331, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4509224593639374
The generated pressure mean: 0.44845521450042725
loss_pred:0.02060212939977646, decouple_loss:0.010678562335669994
loss_pred:0.020797787234187126, decouple_loss:0.010700616985559464
The generated pressure mean: 0.4491620361804962
loss_pred:0.025978898629546165, decouple_loss:0.010577118024230003
Iteration: 2332, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45760828256607056
The generated pressure mean: 0.45959123969078064
loss_pred:0.021411694586277008, decouple_loss:0.009496094658970833
loss_pred:0.019603442400693893, decouple_loss:0.009517510421574116
The generated pressure mean: 0.4654562473297119
loss_pred:0.020998071879148483, decouple_loss:0.009541290812194347
Iteration: 2333, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449107825756073
loss_pred:0.021974977105855942, decouple_loss:0.009040648117661476
The generated pressure mean: 0.45151442289352417
loss_pred:0.020714037120342255, decouple_loss:0.008996633812785149
The generated pressure mean: 0.4444284439086914
loss_pred:0.020409034565091133, decouple_loss:0.009181411936879158
Iteration: 2334, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4399489164352417
loss_pred:0.020781660452485085, decouple_loss:0.009197207167744637
The generated pressure mean: 0.43827900290489197
loss_pred:0.020541517063975334, decouple_loss:0.009195219725370407
The generated pressure mean: 0.43698543310165405
loss_pred:0.021999074146151543, decouple_loss:0.009206021204590797
Iteration: 2335, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4448338747024536
loss_pred:0.020378239452838898, decouple_loss:0.00923236459493637
The generated pressure mean: 0.4467375576496124
loss_pred:0.02114616520702839, decouple_loss:0.009187886491417885
The generated pressure mean: 0.44909295439720154
loss_pred:0.021344948559999466, decouple_loss:0.008844043128192425
Iteration: 2336, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4598727524280548
loss_pred:0.021650414913892746, decouple_loss:0.009429688565433025
The generated pressure mean: 0.4589994251728058
loss_pred:0.022326728329062462, decouple_loss:0.009372429922223091
The generated pressure mean: 0.45584022998809814
loss_pred:0.021772542968392372, decouple_loss:0.00912561733275652
Iteration: 2337, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44578373432159424
loss_pred:0.02394004911184311, decouple_loss:0.010691376402974129
The generated pressure mean: 0.4436020255088806
loss_pred:0.02272852323949337, decouple_loss:0.010704261250793934
The generated pressure mean: 0.4481392502784729
loss_pred:0.021799227222800255, decouple_loss:0.010728191584348679
Iteration: 2338, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4386940598487854
loss_pred:0.02192061021924019, decouple_loss:0.010829969309270382
The generated pressure mean: 0.43373769521713257
loss_pred:0.02215469628572464, decouple_loss:0.010698320344090462
The generated pressure mean: 0.4362214505672455
loss_pred:0.02310238592326641, decouple_loss:0.010766031220555305
Iteration: 2339, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44357094168663025
loss_pred:0.02122417651116848, decouple_loss:0.010824626311659813
The generated pressure mean: 0.44304466247558594
loss_pred:0.02409113198518753, decouple_loss:0.010775466449558735
The generated pressure mean: 0.4465075433254242
loss_pred:0.02105589210987091, decouple_loss:0.010859701782464981
Iteration: 2340, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4578026235103607
The generated pressure mean: 0.46161147952079773
loss_pred:0.022553663700819016, decouple_loss:0.010495390743017197
loss_pred:0.021881038323044777, decouple_loss:0.010567571967840195
The generated pressure mean: 0.4615831673145294
loss_pred:0.02200494147837162, decouple_loss:0.01047605648636818
2023-04-16 20:58:51 testing...
The generated pressure mean: 0.41343173384666443
The generated pressure mean: 0.4192105829715729
The generated pressure mean: 0.42134490609169006
loss_pred:0.034705013036727905, decouple_loss:0.011864119209349155
loss_pred:0.03347364440560341, decouple_loss:0.012162953615188599
loss_pred:0.03267045319080353, decouple_loss:0.012254227884113789
WV_0_PC_0_EH_1_PS_40, loss: 0.03422106057405472, avg_mse: 0.048277489840984344
current test mse: 0.048277
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 2341, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44942036271095276
loss_pred:0.022104281932115555, decouple_loss:0.011518290266394615
The generated pressure mean: 0.453865110874176
loss_pred:0.024917850270867348, decouple_loss:0.011281200684607029
The generated pressure mean: 0.45374253392219543
loss_pred:0.022152258083224297, decouple_loss:0.011340795084834099
Iteration: 2342, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4349503815174103
The generated pressure mean: 0.43334221839904785
loss_pred:0.021774323657155037, decouple_loss:0.01044821459800005
loss_pred:0.021330902352929115, decouple_loss:0.01042267493903637
The generated pressure mean: 0.4364044666290283
loss_pred:0.02284228429198265, decouple_loss:0.010326909832656384
Iteration: 2343, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44876644015312195The generated pressure mean: 0.4528524875640869
loss_pred:0.021762577816843987, decouple_loss:0.010321557521820068
loss_pred:0.021529342979192734, decouple_loss:0.010335422120988369
The generated pressure mean: 0.44272321462631226
loss_pred:0.02190747670829296, decouple_loss:0.01018997561186552
Iteration: 2344, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4596167504787445
The generated pressure mean: 0.45585814118385315
loss_pred:0.021425239741802216, decouple_loss:0.010936576873064041
loss_pred:0.021792076528072357, decouple_loss:0.011024462059140205
The generated pressure mean: 0.45688560605049133
loss_pred:0.02140447124838829, decouple_loss:0.010789881460368633
Iteration: 2345, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461865723133087
loss_pred:0.02138676866889, decouple_loss:0.009781870059669018
The generated pressure mean: 0.4510214328765869
loss_pred:0.021654468029737473, decouple_loss:0.009750732220709324
The generated pressure mean: 0.4483255445957184
loss_pred:0.022259464487433434, decouple_loss:0.009856581687927246
Iteration: 2346, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4521207809448242
loss_pred:0.022272896021604538, decouple_loss:0.010012609884142876
The generated pressure mean: 0.4503526985645294
loss_pred:0.021730685606598854, decouple_loss:0.010060283355414867
The generated pressure mean: 0.45157742500305176
loss_pred:0.023504657670855522, decouple_loss:0.010035845451056957
Iteration: 2347, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4407537579536438
loss_pred:0.021415308117866516, decouple_loss:0.009621311910450459
The generated pressure mean: 0.4396744668483734
loss_pred:0.022056303918361664, decouple_loss:0.009750357829034328
The generated pressure mean: 0.4441772699356079
loss_pred:0.02211928181350231, decouple_loss:0.009661644697189331
Iteration: 2348, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44960033893585205
The generated pressure mean: 0.45447298884391785
loss_pred:0.02256263978779316, decouple_loss:0.010622515343129635
loss_pred:0.022142605856060982, decouple_loss:0.010549182072281837
The generated pressure mean: 0.4473647475242615
loss_pred:0.02202172391116619, decouple_loss:0.010473910719156265
Iteration: 2349, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45162612199783325
loss_pred:0.023409025743603706, decouple_loss:0.009906481020152569
The generated pressure mean: 0.45007622241973877
loss_pred:0.023130137473344803, decouple_loss:0.009762193076312542
The generated pressure mean: 0.4523164629936218
loss_pred:0.021752353757619858, decouple_loss:0.009735647588968277
Iteration: 2350, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4509383738040924
loss_pred:0.02277432195842266, decouple_loss:0.010135864838957787
The generated pressure mean: 0.4463294744491577
loss_pred:0.02217305451631546, decouple_loss:0.010073799639940262
The generated pressure mean: 0.4509914815425873
loss_pred:0.02463555335998535, decouple_loss:0.010208213701844215
2023-04-16 21:01:29 testing...
The generated pressure mean: 0.41543737053871155
loss_pred:0.03436625003814697, decouple_loss:0.010602079331874847
The generated pressure mean: 0.4221874177455902
The generated pressure mean: 0.4248396158218384
loss_pred:0.033299628645181656, decouple_loss:0.010704942978918552
loss_pred:0.032787028700113297, decouple_loss:0.010838008485734463
WV_0_PC_0_EH_1_PS_40, loss: 0.03402005136013031, avg_mse: 0.04800006374716759
current test mse: 0.048
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2351, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44962725043296814
loss_pred:0.02160418964922428, decouple_loss:0.00993182323873043
The generated pressure mean: 0.4561639130115509
loss_pred:0.02222476713359356, decouple_loss:0.010145600885152817
The generated pressure mean: 0.4509009122848511
loss_pred:0.023060036823153496, decouple_loss:0.009971248917281628
Iteration: 2352, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490807354450226
loss_pred:0.021537786349654198, decouple_loss:0.009082457982003689
The generated pressure mean: 0.4479735195636749
loss_pred:0.021861091256141663, decouple_loss:0.009172300808131695
The generated pressure mean: 0.4475463628768921
loss_pred:0.02091551199555397, decouple_loss:0.009087799116969109
Iteration: 2353, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4423125982284546
loss_pred:0.02221600152552128, decouple_loss:0.010171840898692608
The generated pressure mean: 0.44556209444999695
loss_pred:0.023259887471795082, decouple_loss:0.01035676896572113
The generated pressure mean: 0.4467160999774933
loss_pred:0.023042261600494385, decouple_loss:0.010273485444486141
Iteration: 2354, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468678832054138
loss_pred:0.022259429097175598, decouple_loss:0.011506594717502594
The generated pressure mean: 0.44540634751319885
loss_pred:0.02173752710223198, decouple_loss:0.01144871860742569
The generated pressure mean: 0.4463593661785126
loss_pred:0.02124841697514057, decouple_loss:0.011465686373412609
Iteration: 2355, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471350312232971
loss_pred:0.02069222182035446, decouple_loss:0.010063273832201958
The generated pressure mean: 0.44565722346305847
loss_pred:0.021074382588267326, decouple_loss:0.010064121335744858
The generated pressure mean: 0.4474257230758667
loss_pred:0.021472815424203873, decouple_loss:0.010076028294861317
Iteration: 2356, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4573117792606354
loss_pred:0.02097848244011402, decouple_loss:0.008895428851246834
The generated pressure mean: 0.45732903480529785
loss_pred:0.022259633988142014, decouple_loss:0.008918900974094868
The generated pressure mean: 0.45905163884162903
loss_pred:0.022314641624689102, decouple_loss:0.008789795450866222
Iteration: 2357, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44764554500579834
loss_pred:0.022302020341157913, decouple_loss:0.009264101274311543
The generated pressure mean: 0.4513764977455139
loss_pred:0.023316439241170883, decouple_loss:0.00926261581480503
The generated pressure mean: 0.4492470324039459
loss_pred:0.02150771953165531, decouple_loss:0.009163605980575085
Iteration: 2358, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43852633237838745
loss_pred:0.020932044833898544, decouple_loss:0.009427608922123909
The generated pressure mean: 0.44429802894592285
loss_pred:0.021371612325310707, decouple_loss:0.009485828690230846
The generated pressure mean: 0.4435232877731323
loss_pred:0.02105080522596836, decouple_loss:0.00939639937132597
Iteration: 2359, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45117926597595215
loss_pred:0.021505607292056084, decouple_loss:0.010044902563095093
The generated pressure mean: 0.44942647218704224
loss_pred:0.020922787487506866, decouple_loss:0.010184263810515404
The generated pressure mean: 0.4561416506767273
loss_pred:0.021929258480668068, decouple_loss:0.010147466324269772
Iteration: 2360, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502868354320526
loss_pred:0.022941872477531433, decouple_loss:0.010025881230831146
The generated pressure mean: 0.4535965621471405
The generated pressure mean: 0.45300066471099854
loss_pred:0.02091660350561142, decouple_loss:0.010039388202130795
loss_pred:0.023021750152111053, decouple_loss:0.009947745129466057
2023-04-16 21:03:21 testing...
The generated pressure mean: 0.4196397364139557
The generated pressure mean: 0.4257209300994873
loss_pred:0.031223250553011894, decouple_loss:0.01013500988483429
The generated pressure mean: 0.42808547616004944
loss_pred:0.030274059623479843, decouple_loss:0.0102692861109972
loss_pred:0.02995207905769348, decouple_loss:0.010485547594726086
WV_0_PC_0_EH_1_PS_40, loss: 0.03099796175956726, avg_mse: 0.04248100891709328
current test mse: 0.042481
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 2361, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4356854259967804
loss_pred:0.023040248081088066, decouple_loss:0.009795947931706905
The generated pressure mean: 0.43615201115608215
loss_pred:0.02113262563943863, decouple_loss:0.009701167233288288
The generated pressure mean: 0.4384737014770508
loss_pred:0.022810759022831917, decouple_loss:0.009826530702412128
Iteration: 2362, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4516706168651581
loss_pred:0.021512852981686592, decouple_loss:0.008761054836213589
The generated pressure mean: 0.4462452232837677
loss_pred:0.020707188174128532, decouple_loss:0.00887493509799242
The generated pressure mean: 0.4427577555179596
loss_pred:0.021599462255835533, decouple_loss:0.00887791533023119
Iteration: 2363, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46181967854499817
The generated pressure mean: 0.45840394496917725
loss_pred:0.022272059693932533, decouple_loss:0.0082563990727067
loss_pred:0.021712249144911766, decouple_loss:0.008209656924009323
The generated pressure mean: 0.45365792512893677
loss_pred:0.021455518901348114, decouple_loss:0.008205780759453773
Iteration: 2364, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4399682581424713
The generated pressure mean: 0.44535231590270996
loss_pred:0.02183523401618004, decouple_loss:0.008369555696845055
loss_pred:0.022317219525575638, decouple_loss:0.008453781716525555
The generated pressure mean: 0.44082653522491455
loss_pred:0.022379767149686813, decouple_loss:0.008472345769405365
Iteration: 2365, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43857887387275696
The generated pressure mean: 0.4389443099498749
loss_pred:0.022056112065911293, decouple_loss:0.008660156279802322
loss_pred:0.021244104951620102, decouple_loss:0.008456525392830372
The generated pressure mean: 0.43958231806755066
loss_pred:0.021199066191911697, decouple_loss:0.008575924672186375
Iteration: 2366, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468773603439331
The generated pressure mean: 0.4525201618671417
loss_pred:0.021984629333019257, decouple_loss:0.007954347878694534
loss_pred:0.021234864369034767, decouple_loss:0.008131904527544975
The generated pressure mean: 0.45228978991508484
loss_pred:0.02125876396894455, decouple_loss:0.00792672485113144
Iteration: 2367, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4441263675689697
The generated pressure mean: 0.4446175694465637
loss_pred:0.021694837138056755, decouple_loss:0.00861454103142023
loss_pred:0.023694923147559166, decouple_loss:0.008694011718034744
The generated pressure mean: 0.4479973316192627
loss_pred:0.021662363782525063, decouple_loss:0.008637966588139534
Iteration: 2368, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481153190135956
The generated pressure mean: 0.4457019567489624
loss_pred:0.021002408117055893, decouple_loss:0.008750051259994507
loss_pred:0.020447665825486183, decouple_loss:0.00868273340165615
The generated pressure mean: 0.4475705325603485
loss_pred:0.021797610446810722, decouple_loss:0.008762240409851074
Iteration: 2369, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4305139482021332
loss_pred:0.0224765557795763, decouple_loss:0.010247803293168545
The generated pressure mean: 0.4395427107810974
loss_pred:0.021789399906992912, decouple_loss:0.01010026503354311
The generated pressure mean: 0.4339663088321686
loss_pred:0.02181394025683403, decouple_loss:0.010108467191457748
Iteration: 2370, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4517926871776581
The generated pressure mean: 0.4490288496017456
loss_pred:0.021851198747754097, decouple_loss:0.011221230961382389
loss_pred:0.022900620475411415, decouple_loss:0.011216999962925911
The generated pressure mean: 0.4481240212917328
loss_pred:0.022156154736876488, decouple_loss:0.011253845877945423
2023-04-16 21:05:56 testing...
The generated pressure mean: 0.42019909620285034
The generated pressure mean: 0.4136198163032532
loss_pred:0.03169845789670944, decouple_loss:0.011286838911473751
The generated pressure mean: 0.4225606322288513
loss_pred:0.033018458634614944, decouple_loss:0.01105350349098444
loss_pred:0.031247220933437347, decouple_loss:0.01137807872146368
WV_0_PC_0_EH_1_PS_40, loss: 0.03255002200603485, avg_mse: 0.04552952200174332
current test mse: 0.04553
Iteration: 2371, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45463863015174866
loss_pred:0.022392772138118744, decouple_loss:0.010057538747787476
The generated pressure mean: 0.45265713334083557
loss_pred:0.02099688909947872, decouple_loss:0.010172954760491848
The generated pressure mean: 0.4568477272987366
loss_pred:0.02214665897190571, decouple_loss:0.010500715114176273
Iteration: 2372, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464375078678131
loss_pred:0.020431915298104286, decouple_loss:0.008741426281630993
The generated pressure mean: 0.44026386737823486
loss_pred:0.02118539623916149, decouple_loss:0.008684230037033558
The generated pressure mean: 0.4432382583618164
loss_pred:0.020900825038552284, decouple_loss:0.00861658900976181
Iteration: 2373, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43894627690315247
loss_pred:0.021386701613664627, decouple_loss:0.01007369440048933
The generated pressure mean: 0.4436355531215668
loss_pred:0.02262674644589424, decouple_loss:0.010169492103159428
The generated pressure mean: 0.4433993399143219
loss_pred:0.024211790412664413, decouple_loss:0.010083495639264584
Iteration: 2374, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4443225562572479
loss_pred:0.020805181935429573, decouple_loss:0.009968647733330727
The generated pressure mean: 0.4393247663974762
loss_pred:0.02153693698346615, decouple_loss:0.010100314393639565
The generated pressure mean: 0.4412957727909088
loss_pred:0.0212085023522377, decouple_loss:0.00998226273804903
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2375, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45379960536956787
loss_pred:0.02157597988843918, decouple_loss:0.00937018170952797
The generated pressure mean: 0.4562504291534424
loss_pred:0.022193772718310356, decouple_loss:0.009247827343642712
The generated pressure mean: 0.4553912281990051
loss_pred:0.02244461700320244, decouple_loss:0.00936192274093628
Iteration: 2376, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4516231417655945
loss_pred:0.02131096087396145, decouple_loss:0.008727735839784145
The generated pressure mean: 0.4504812955856323
loss_pred:0.022229911759495735, decouple_loss:0.008781486190855503
The generated pressure mean: 0.44686540961265564
loss_pred:0.02170923911035061, decouple_loss:0.008715051226317883
Iteration: 2377, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4441729187965393
loss_pred:0.02125183679163456, decouple_loss:0.010142656043171883
The generated pressure mean: 0.44105422496795654
loss_pred:0.020565388724207878, decouple_loss:0.010091854259371758
The generated pressure mean: 0.4452683925628662
loss_pred:0.021444443613290787, decouple_loss:0.010119951330125332
Iteration: 2378, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4422396421432495
loss_pred:0.021292228251695633, decouple_loss:0.00884415302425623
The generated pressure mean: 0.44755303859710693
loss_pred:0.02189655229449272, decouple_loss:0.008712641894817352
The generated pressure mean: 0.4436344802379608
loss_pred:0.02063005231320858, decouple_loss:0.00862329825758934
Iteration: 2379, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478059411048889
loss_pred:0.021720396354794502, decouple_loss:0.008736043237149715
The generated pressure mean: 0.4468033015727997
loss_pred:0.02121952548623085, decouple_loss:0.008747006766498089
The generated pressure mean: 0.43920043110847473
loss_pred:0.02177458629012108, decouple_loss:0.008788323029875755
Iteration: 2380, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4443017542362213
loss_pred:0.022938013076782227, decouple_loss:0.008614321239292622
The generated pressure mean: 0.4429857134819031
loss_pred:0.023056749254465103, decouple_loss:0.00860944576561451
The generated pressure mean: 0.4436502754688263
loss_pred:0.02280276268720627, decouple_loss:0.008700507692992687
2023-04-16 21:07:49 testing...
The generated pressure mean: 0.4145333468914032
The generated pressure mean: 0.4216155707836151
The generated pressure mean: 0.42404723167419434
loss_pred:0.03292424976825714, decouple_loss:0.00934301782399416
loss_pred:0.03164442256093025, decouple_loss:0.009642617776989937
loss_pred:0.030977753922343254, decouple_loss:0.009852898307144642
WV_0_PC_0_EH_1_PS_40, loss: 0.03232945501804352, avg_mse: 0.045582592487335205
current test mse: 0.045583
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 2381, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45446810126304626
loss_pred:0.020698802545666695, decouple_loss:0.008983335457742214
The generated pressure mean: 0.4624698758125305
loss_pred:0.019673528149724007, decouple_loss:0.009046409279108047
The generated pressure mean: 0.4574325382709503
loss_pred:0.021009661257267, decouple_loss:0.00912981666624546
Iteration: 2382, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501674771308899
The generated pressure mean: 0.44638919830322266
loss_pred:0.019736580550670624, decouple_loss:0.010534731671214104
loss_pred:0.02147218957543373, decouple_loss:0.01011039037257433
The generated pressure mean: 0.44761189818382263
loss_pred:0.021543055772781372, decouple_loss:0.010261469520628452
Iteration: 2383, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4413449466228485
The generated pressure mean: 0.43663614988327026
loss_pred:0.019859571009874344, decouple_loss:0.009918085299432278
loss_pred:0.021006900817155838, decouple_loss:0.00992653425782919
The generated pressure mean: 0.44077563285827637
loss_pred:0.02105410397052765, decouple_loss:0.009965339675545692
Iteration: 2384, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.445441871881485
loss_pred:0.020664319396018982, decouple_loss:0.009587286040186882
The generated pressure mean: 0.44509536027908325
loss_pred:0.023669768124818802, decouple_loss:0.009774649515748024
The generated pressure mean: 0.45186564326286316
loss_pred:0.02010837011039257, decouple_loss:0.009691554121673107
Iteration: 2385, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44515666365623474
The generated pressure mean: 0.4461771249771118
loss_pred:0.02107388526201248, decouple_loss:0.008700239472091198
loss_pred:0.019981611520051956, decouple_loss:0.00871400535106659
The generated pressure mean: 0.44360628724098206
loss_pred:0.020850805565714836, decouple_loss:0.008525796234607697
Iteration: 2386, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45304280519485474
The generated pressure mean: 0.4528290629386902
loss_pred:0.02042652666568756, decouple_loss:0.00784575380384922
loss_pred:0.021665658801794052, decouple_loss:0.007922694087028503
The generated pressure mean: 0.45599132776260376
loss_pred:0.02118413709104061, decouple_loss:0.00790618546307087
Iteration: 2387, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4534444212913513
loss_pred:0.021632224321365356, decouple_loss:0.00896353181451559
The generated pressure mean: 0.4554087221622467
loss_pred:0.020312001928687096, decouple_loss:0.00893339142203331
The generated pressure mean: 0.45607665181159973
loss_pred:0.019946768879890442, decouple_loss:0.008913506753742695
Iteration: 2388, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44370633363723755
loss_pred:0.02011193335056305, decouple_loss:0.008836553432047367The generated pressure mean: 0.440502792596817
loss_pred:0.022890781983733177, decouple_loss:0.008877224288880825
The generated pressure mean: 0.44366857409477234
loss_pred:0.020941542461514473, decouple_loss:0.008848167024552822
Iteration: 2389, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44117844104766846
loss_pred:0.0206916481256485, decouple_loss:0.009346420876681805
The generated pressure mean: 0.43403083086013794
loss_pred:0.02052166871726513, decouple_loss:0.009319278411567211
The generated pressure mean: 0.4322049915790558
loss_pred:0.02045426517724991, decouple_loss:0.009145337156951427
Iteration: 2390, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4599990248680115
loss_pred:0.019152425229549408, decouple_loss:0.009615938179194927
The generated pressure mean: 0.46027812361717224
loss_pred:0.019774938002228737, decouple_loss:0.009513922035694122
The generated pressure mean: 0.46298956871032715
loss_pred:0.021507887169718742, decouple_loss:0.009451895952224731
2023-04-16 21:10:22 testing...
The generated pressure mean: 0.41636762022972107
The generated pressure mean: 0.422958642244339
The generated pressure mean: 0.42520564794540405
loss_pred:0.03277876228094101, decouple_loss:0.01027577556669712
loss_pred:0.0316288135945797, decouple_loss:0.010518491268157959
loss_pred:0.03161589428782463, decouple_loss:0.010634317062795162
WV_0_PC_0_EH_1_PS_40, loss: 0.03253163397312164, avg_mse: 0.04565882682800293
current test mse: 0.045659
Iteration: 2391, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4533262848854065
loss_pred:0.021347923204302788, decouple_loss:0.00985141471028328
The generated pressure mean: 0.4473613202571869
loss_pred:0.019772442057728767, decouple_loss:0.009772018529474735
The generated pressure mean: 0.4490327537059784
loss_pred:0.020166318863630295, decouple_loss:0.009908197447657585
Iteration: 2392, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466511607170105
loss_pred:0.021842731162905693, decouple_loss:0.00910742487758398
The generated pressure mean: 0.45077067613601685
loss_pred:0.02017231099307537, decouple_loss:0.009180241264402866
The generated pressure mean: 0.4454001784324646
loss_pred:0.019605150446295738, decouple_loss:0.009226428344845772
Iteration: 2393, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463847875595093
loss_pred:0.019001316279172897, decouple_loss:0.009725864976644516
The generated pressure mean: 0.44662854075431824
loss_pred:0.02350541763007641, decouple_loss:0.0098612355068326
The generated pressure mean: 0.44331640005111694
loss_pred:0.019141748547554016, decouple_loss:0.009879082441329956
Iteration: 2394, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4348524212837219
The generated pressure mean: 0.440804660320282
loss_pred:0.019509265199303627, decouple_loss:0.00988654512912035
loss_pred:0.021336963400244713, decouple_loss:0.009970778599381447
The generated pressure mean: 0.44342291355133057
loss_pred:0.02089175023138523, decouple_loss:0.009891475550830364
Iteration: 2395, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45629778504371643
loss_pred:0.01997901313006878, decouple_loss:0.00978324469178915
The generated pressure mean: 0.4562106132507324
loss_pred:0.019992085173726082, decouple_loss:0.009667766280472279
The generated pressure mean: 0.45649683475494385
loss_pred:0.0227230004966259, decouple_loss:0.00976487621665001
Iteration: 2396, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44953158497810364
loss_pred:0.020976576954126358, decouple_loss:0.008931959047913551
The generated pressure mean: 0.4467615783214569
loss_pred:0.02045939862728119, decouple_loss:0.008857006207108498
The generated pressure mean: 0.44801416993141174
loss_pred:0.021252525970339775, decouple_loss:0.008979910053312778
Iteration: 2397, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45107385516166687
loss_pred:0.021909328177571297, decouple_loss:0.009891336783766747
The generated pressure mean: 0.44971945881843567
loss_pred:0.020279064774513245, decouple_loss:0.009521864354610443
The generated pressure mean: 0.44757962226867676
loss_pred:0.0208653062582016, decouple_loss:0.009712585248053074
Iteration: 2398, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45236530900001526
loss_pred:0.019972044974565506, decouple_loss:0.010040264576673508
The generated pressure mean: 0.4425608515739441
loss_pred:0.0201867688447237, decouple_loss:0.01002065371721983
The generated pressure mean: 0.446668416261673
loss_pred:0.021006455644965172, decouple_loss:0.010068186558783054
Iteration: 2399, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44393208622932434
loss_pred:0.020453669130802155, decouple_loss:0.008954393677413464
The generated pressure mean: 0.443997859954834
loss_pred:0.022624162957072258, decouple_loss:0.008783170022070408
The generated pressure mean: 0.4471449851989746
loss_pred:0.020801467821002007, decouple_loss:0.008927094750106335
Iteration: 2400, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4399423897266388
The generated pressure mean: 0.44809120893478394
loss_pred:0.02141376957297325, decouple_loss:0.008235138840973377
loss_pred:0.020802149549126625, decouple_loss:0.008266844786703587
The generated pressure mean: 0.44139358401298523
loss_pred:0.019104447215795517, decouple_loss:0.008414999581873417
2023-04-16 21:12:16 testing...
The generated pressure mean: 0.4136936068534851
The generated pressure mean: 0.4204846918582916
The generated pressure mean: 0.4233156740665436
loss_pred:0.03557613119482994, decouple_loss:0.009853092953562737
loss_pred:0.034095991402864456, decouple_loss:0.010114339180290699
loss_pred:0.034588493406772614, decouple_loss:0.009964527562260628
WV_0_PC_0_EH_1_PS_40, loss: 0.0352524071931839, avg_mse: 0.05105411261320114
current test mse: 0.051054
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 2401, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4550967216491699
loss_pred:0.022436968982219696, decouple_loss:0.009280695579946041
The generated pressure mean: 0.4589228928089142
loss_pred:0.021949825808405876, decouple_loss:0.009455092251300812
The generated pressure mean: 0.4510335624217987
loss_pred:0.02195456251502037, decouple_loss:0.009457239881157875
Iteration: 2402, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45023223757743835
The generated pressure mean: 0.44078484177589417
loss_pred:0.02120029367506504, decouple_loss:0.008962384425103664
loss_pred:0.021002382040023804, decouple_loss:0.00891800131648779
The generated pressure mean: 0.44029125571250916
loss_pred:0.02193310484290123, decouple_loss:0.009001734666526318
Iteration: 2403, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466458857059479The generated pressure mean: 0.45035192370414734
loss_pred:0.02143312431871891, decouple_loss:0.008917402476072311
loss_pred:0.021375276148319244, decouple_loss:0.008818481117486954
The generated pressure mean: 0.4506993889808655
loss_pred:0.021321987733244896, decouple_loss:0.008685220964252949
Iteration: 2404, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4571457803249359
The generated pressure mean: 0.4523215889930725
loss_pred:0.021431080996990204, decouple_loss:0.008565125986933708
loss_pred:0.02100864239037037, decouple_loss:0.00840375479310751
The generated pressure mean: 0.4525432288646698
loss_pred:0.022199595347046852, decouple_loss:0.008553187362849712
Iteration: 2405, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4407822787761688
The generated pressure mean: 0.44485053420066833
loss_pred:0.02166604809463024, decouple_loss:0.00934509001672268
loss_pred:0.021670445799827576, decouple_loss:0.009250317700207233
The generated pressure mean: 0.4426581561565399
loss_pred:0.021473601460456848, decouple_loss:0.009336759336292744
Iteration: 2406, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44817304611206055
The generated pressure mean: 0.45084869861602783
loss_pred:0.020946338772773743, decouple_loss:0.009204203262925148
loss_pred:0.02243078127503395, decouple_loss:0.009251505136489868
The generated pressure mean: 0.4472569227218628
loss_pred:0.021529877558350563, decouple_loss:0.009157197549939156
Iteration: 2407, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4409627914428711
The generated pressure mean: 0.44633054733276367
loss_pred:0.020457470789551735, decouple_loss:0.008971421048045158
loss_pred:0.020704936236143112, decouple_loss:0.009012153372168541
The generated pressure mean: 0.4432786703109741
loss_pred:0.022203952074050903, decouple_loss:0.00905134342610836
Iteration: 2408, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45023059844970703
The generated pressure mean: 0.4485104978084564loss_pred:0.02034611627459526, decouple_loss:0.008698015473783016
loss_pred:0.020983321592211723, decouple_loss:0.008693695068359375
The generated pressure mean: 0.4504646956920624
loss_pred:0.02069961093366146, decouple_loss:0.008648891933262348
Iteration: 2409, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45419859886169434
The generated pressure mean: 0.45647093653678894
loss_pred:0.020885175094008446, decouple_loss:0.008495568297803402
loss_pred:0.021134929731488228, decouple_loss:0.008430510759353638
The generated pressure mean: 0.44808855652809143
loss_pred:0.020773839205503464, decouple_loss:0.008535737171769142
Iteration: 2410, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43951308727264404
loss_pred:0.020771728828549385, decouple_loss:0.008327070623636246
The generated pressure mean: 0.4483200013637543
loss_pred:0.02098255604505539, decouple_loss:0.00840919278562069
The generated pressure mean: 0.4534815549850464
loss_pred:0.023110395297408104, decouple_loss:0.00851102638989687
2023-04-16 21:14:45 testing...
The generated pressure mean: 0.4173649251461029
The generated pressure mean: 0.4229374825954437
loss_pred:0.032186489552259445, decouple_loss:0.008701283484697342
The generated pressure mean: 0.4253918528556824
loss_pred:0.031355805695056915, decouple_loss:0.008827370591461658
loss_pred:0.030664481222629547, decouple_loss:0.009009241126477718
WV_0_PC_0_EH_1_PS_40, loss: 0.03184455633163452, avg_mse: 0.04438943788409233
current test mse: 0.044389
Iteration: 2411, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4444746673107147
loss_pred:0.01981949806213379, decouple_loss:0.008215322159230709
The generated pressure mean: 0.4359784424304962
loss_pred:0.021689871326088905, decouple_loss:0.008336839266121387
The generated pressure mean: 0.439763605594635
loss_pred:0.02019822970032692, decouple_loss:0.008260837756097317
Iteration: 2412, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45682814717292786
loss_pred:0.021493175998330116, decouple_loss:0.008032642304897308
The generated pressure mean: 0.4508885145187378
loss_pred:0.020529601722955704, decouple_loss:0.008243449963629246
The generated pressure mean: 0.45792725682258606
loss_pred:0.021358715370297432, decouple_loss:0.008168496191501617
Iteration: 2413, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502429962158203
loss_pred:0.020444562658667564, decouple_loss:0.008340593427419662
The generated pressure mean: 0.4493795335292816
loss_pred:0.020497918128967285, decouple_loss:0.008526553399860859
The generated pressure mean: 0.4580657482147217
loss_pred:0.020574070513248444, decouple_loss:0.00855827797204256
Iteration: 2414, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45519259572029114
loss_pred:0.020813599228858948, decouple_loss:0.008154165931046009
The generated pressure mean: 0.4504674971103668
loss_pred:0.02066824585199356, decouple_loss:0.008212123066186905
The generated pressure mean: 0.4522201716899872
loss_pred:0.020447388291358948, decouple_loss:0.008323395624756813
Iteration: 2415, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.439354807138443
The generated pressure mean: 0.44011130928993225
loss_pred:0.022694192826747894, decouple_loss:0.008936603553593159
loss_pred:0.020661694929003716, decouple_loss:0.008978619240224361
The generated pressure mean: 0.44465139508247375
loss_pred:0.02139309048652649, decouple_loss:0.0088821891695261
Iteration: 2416, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44514378905296326
The generated pressure mean: 0.4378538131713867
loss_pred:0.021165261045098305, decouple_loss:0.008975611068308353
loss_pred:0.02197573333978653, decouple_loss:0.008999289013445377
The generated pressure mean: 0.4389801025390625
loss_pred:0.022087790071964264, decouple_loss:0.008934960700571537
Iteration: 2417, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43637388944625854
The generated pressure mean: 0.44024911522865295
loss_pred:0.02085084095597267, decouple_loss:0.00985548086464405
loss_pred:0.02238505892455578, decouple_loss:0.00974379014223814
The generated pressure mean: 0.44061630964279175
loss_pred:0.021062251180410385, decouple_loss:0.0097352284938097
Iteration: 2418, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4652560353279114
loss_pred:0.019654352217912674, decouple_loss:0.010242613032460213
The generated pressure mean: 0.4555342197418213
loss_pred:0.02049110271036625, decouple_loss:0.010214320383965969
The generated pressure mean: 0.46175819635391235
loss_pred:0.021669253706932068, decouple_loss:0.010259349830448627
Iteration: 2419, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46079739928245544
loss_pred:0.01999686472117901, decouple_loss:0.007885850965976715
The generated pressure mean: 0.4561361074447632
The generated pressure mean: 0.4647432565689087
loss_pred:0.02167198807001114, decouple_loss:0.00788439903408289
loss_pred:0.02011287957429886, decouple_loss:0.00784658920019865
Iteration: 2420, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4383991062641144
loss_pred:0.0209210142493248, decouple_loss:0.009071562439203262
The generated pressure mean: 0.4407189190387726
loss_pred:0.020253073424100876, decouple_loss:0.00908944196999073
The generated pressure mean: 0.43791094422340393
loss_pred:0.021278319880366325, decouple_loss:0.008949645794928074
2023-04-16 21:16:36 testing...
The generated pressure mean: 0.4185045063495636
The generated pressure mean: 0.42507877945899963
loss_pred:0.03275604546070099, decouple_loss:0.009939244017004967
The generated pressure mean: 0.42769259214401245
loss_pred:0.031823109835386276, decouple_loss:0.010164584964513779
loss_pred:0.031378522515296936, decouple_loss:0.010258903726935387
WV_0_PC_0_EH_1_PS_40, loss: 0.03249194100499153, avg_mse: 0.04611606150865555
current test mse: 0.046116
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 2421, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44013872742652893
loss_pred:0.0211039911955595, decouple_loss:0.009632633067667484
The generated pressure mean: 0.4401850700378418
The generated pressure mean: 0.43933308124542236loss_pred:0.02001333422958851, decouple_loss:0.009604857303202152
loss_pred:0.020478270947933197, decouple_loss:0.00943925604224205
Iteration: 2422, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471569061279297
loss_pred:0.021320996806025505, decouple_loss:0.008677231147885323
The generated pressure mean: 0.4485766589641571
loss_pred:0.019933098927140236, decouple_loss:0.008843368850648403
The generated pressure mean: 0.4476834833621979
loss_pred:0.020874708890914917, decouple_loss:0.008514784276485443
Iteration: 2423, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503108263015747
loss_pred:0.022784888744354248, decouple_loss:0.01010221429169178
The generated pressure mean: 0.4476424753665924
loss_pred:0.020872334018349648, decouple_loss:0.010085483081638813
The generated pressure mean: 0.44533148407936096
loss_pred:0.020359056070446968, decouple_loss:0.009961714036762714
Iteration: 2424, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449651539325714
loss_pred:0.020940573886036873, decouple_loss:0.00922282226383686
The generated pressure mean: 0.452449768781662
loss_pred:0.019629575312137604, decouple_loss:0.009007164277136326
The generated pressure mean: 0.44221755862236023
loss_pred:0.02057594433426857, decouple_loss:0.008959508500993252
Iteration: 2425, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45042943954467773
The generated pressure mean: 0.44946977496147156
loss_pred:0.020857371389865875, decouple_loss:0.009144047275185585
loss_pred:0.021373257040977478, decouple_loss:0.00919782929122448
The generated pressure mean: 0.4485223591327667
loss_pred:0.020250089466571808, decouple_loss:0.00907636247575283
Iteration: 2426, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4440801739692688
The generated pressure mean: 0.4464295208454132
loss_pred:0.02065567672252655, decouple_loss:0.008748575113713741
loss_pred:0.020730035379529, decouple_loss:0.008816322311758995
The generated pressure mean: 0.4416579008102417
loss_pred:0.021170448511838913, decouple_loss:0.008804209530353546
Iteration: 2427, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4536123275756836
loss_pred:0.01999799534678459, decouple_loss:0.008765083737671375
The generated pressure mean: 0.4475674033164978
loss_pred:0.02269710972905159, decouple_loss:0.00873846560716629
The generated pressure mean: 0.45031070709228516
loss_pred:0.020693117752671242, decouple_loss:0.00881560891866684
Iteration: 2428, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4428955018520355
loss_pred:0.019925935193896294, decouple_loss:0.008938639424741268
The generated pressure mean: 0.44443362951278687
loss_pred:0.01975160278379917, decouple_loss:0.009461993351578712
The generated pressure mean: 0.44316232204437256
loss_pred:0.01933450810611248, decouple_loss:0.008970960043370724
Iteration: 2429, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44383344054222107
loss_pred:0.020055975764989853, decouple_loss:0.009456916712224483
The generated pressure mean: 0.4480484426021576
loss_pred:0.02014915645122528, decouple_loss:0.009354396723210812
The generated pressure mean: 0.44406363368034363
loss_pred:0.02234867587685585, decouple_loss:0.009521969594061375
Iteration: 2430, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44256913661956787
The generated pressure mean: 0.4440831243991852
loss_pred:0.020002903416752815, decouple_loss:0.0090674739331007
loss_pred:0.02003810554742813, decouple_loss:0.009278460405766964
The generated pressure mean: 0.44960254430770874
loss_pred:0.020587028935551643, decouple_loss:0.009056436829268932
2023-04-16 21:19:04 testing...
The generated pressure mean: 0.41429227590560913
The generated pressure mean: 0.4201945960521698
The generated pressure mean: 0.42235955595970154
loss_pred:0.03268559277057648, decouple_loss:0.009618908166885376
loss_pred:0.031168419867753983, decouple_loss:0.009811199270188808
loss_pred:0.031013768166303635, decouple_loss:0.009963104501366615
WV_0_PC_0_EH_1_PS_40, loss: 0.0321124792098999, avg_mse: 0.04477479308843613
current test mse: 0.044775
Iteration: 2431, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44971489906311035
loss_pred:0.02066926471889019, decouple_loss:0.009247414767742157
The generated pressure mean: 0.4506790339946747
loss_pred:0.02041989006102085, decouple_loss:0.009494039230048656
The generated pressure mean: 0.45122987031936646
loss_pred:0.02057068422436714, decouple_loss:0.009297427721321583
Iteration: 2432, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45281529426574707
loss_pred:0.021152039989829063, decouple_loss:0.00902889110147953
The generated pressure mean: 0.45050451159477234
loss_pred:0.021648414433002472, decouple_loss:0.00887711625546217
The generated pressure mean: 0.4585808217525482
loss_pred:0.020890187472105026, decouple_loss:0.00896824523806572
Iteration: 2433, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469435513019562
loss_pred:0.02108459174633026, decouple_loss:0.008812455460429192
The generated pressure mean: 0.4438339173793793
loss_pred:0.020992368459701538, decouple_loss:0.008848288096487522
The generated pressure mean: 0.4416505992412567
loss_pred:0.020998667925596237, decouple_loss:0.00877405982464552
Iteration: 2434, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4336782693862915
loss_pred:0.02105419710278511, decouple_loss:0.008414373733103275
The generated pressure mean: 0.4384767413139343
loss_pred:0.021537145599722862, decouple_loss:0.008288015611469746
The generated pressure mean: 0.43636927008628845
loss_pred:0.023960290476679802, decouple_loss:0.008409611880779266
Iteration: 2435, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46092844009399414
loss_pred:0.020926523953676224, decouple_loss:0.009266688488423824
The generated pressure mean: 0.4583617150783539
loss_pred:0.020338281989097595, decouple_loss:0.0092560313642025
The generated pressure mean: 0.45673251152038574
loss_pred:0.021240396425127983, decouple_loss:0.009145643562078476
Iteration: 2436, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446109414100647
The generated pressure mean: 0.4434874355792999
loss_pred:0.019808588549494743, decouple_loss:0.008405719883739948
loss_pred:0.020793888717889786, decouple_loss:0.0083612110465765
The generated pressure mean: 0.4531218409538269
loss_pred:0.0197634045034647, decouple_loss:0.008502354845404625
Iteration: 2437, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43846988677978516The generated pressure mean: 0.43952858448028564
loss_pred:0.021144060418009758, decouple_loss:0.008894946426153183
loss_pred:0.021053513512015343, decouple_loss:0.009076756425201893
The generated pressure mean: 0.44322019815444946
loss_pred:0.019305938854813576, decouple_loss:0.009000071324408054
Iteration: 2438, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45293128490448
loss_pred:0.019922887906432152, decouple_loss:0.009637327864766121
The generated pressure mean: 0.4534274935722351
loss_pred:0.020514201372861862, decouple_loss:0.009484825655817986
The generated pressure mean: 0.45858511328697205
loss_pred:0.02033357322216034, decouple_loss:0.009679296053946018
Iteration: 2439, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44871148467063904
loss_pred:0.020341606810688972, decouple_loss:0.010351208969950676
The generated pressure mean: 0.4537559151649475
loss_pred:0.020019490271806717, decouple_loss:0.010324042290449142
The generated pressure mean: 0.4492938220500946
loss_pred:0.020886508747935295, decouple_loss:0.010378985665738583
Iteration: 2440, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44717544317245483
loss_pred:0.019886784255504608, decouple_loss:0.008474556729197502
The generated pressure mean: 0.4458041787147522
loss_pred:0.02112594246864319, decouple_loss:0.008663429878652096
The generated pressure mean: 0.44035863876342773
loss_pred:0.019931914284825325, decouple_loss:0.008508149534463882
2023-04-16 21:20:55 testing...
The generated pressure mean: 0.4254089593887329
The generated pressure mean: 0.41881728172302246
The generated pressure mean: 0.4278292953968048
loss_pred:0.031576041132211685, decouple_loss:0.011367825791239738
loss_pred:0.032366298139095306, decouple_loss:0.011080820113420486
loss_pred:0.03102044388651848, decouple_loss:0.011543702334165573
WV_0_PC_0_EH_1_PS_40, loss: 0.03222080320119858, avg_mse: 0.04533202201128006
current test mse: 0.045332
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 2441, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43353036046028137
loss_pred:0.022569896653294563, decouple_loss:0.010920732282102108
The generated pressure mean: 0.4351174235343933
loss_pred:0.02132333442568779, decouple_loss:0.010850370861589909
The generated pressure mean: 0.43118199706077576
loss_pred:0.02316899225115776, decouple_loss:0.011016817763447762
Iteration: 2442, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4381248354911804
The generated pressure mean: 0.4444415867328644
loss_pred:0.022410636767745018, decouple_loss:0.009904245845973492
loss_pred:0.020837338641285896, decouple_loss:0.0098655316978693
The generated pressure mean: 0.4401775300502777
loss_pred:0.022315455600619316, decouple_loss:0.009826989844441414
Iteration: 2443, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.457026869058609The generated pressure mean: 0.45788171887397766
loss_pred:0.02273886278271675, decouple_loss:0.00927556399255991loss_pred:0.02176380157470703, decouple_loss:0.009250354953110218
The generated pressure mean: 0.4573652148246765
loss_pred:0.021137727424502373, decouple_loss:0.009319356642663479
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2444, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4607604444026947
loss_pred:0.020023183897137642, decouple_loss:0.009595024399459362
The generated pressure mean: 0.4544578790664673
loss_pred:0.020833883434534073, decouple_loss:0.009306812658905983
The generated pressure mean: 0.4612012207508087
loss_pred:0.020160827785730362, decouple_loss:0.009520215913653374
Iteration: 2445, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4532942771911621
The generated pressure mean: 0.44863709807395935
loss_pred:0.02114804834127426, decouple_loss:0.009587693028151989
loss_pred:0.020255645737051964, decouple_loss:0.009501473046839237
The generated pressure mean: 0.4490259885787964
loss_pred:0.01938086934387684, decouple_loss:0.009543383494019508
Iteration: 2446, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4391796588897705
loss_pred:0.022056497633457184, decouple_loss:0.009918998926877975
The generated pressure mean: 0.42616695165634155
loss_pred:0.022468119859695435, decouple_loss:0.00988538097590208
The generated pressure mean: 0.4297547936439514
loss_pred:0.020879346877336502, decouple_loss:0.00993108469992876
Iteration: 2447, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4182063639163971
The generated pressure mean: 0.4249396026134491
loss_pred:0.022829217836260796, decouple_loss:0.009970911778509617
loss_pred:0.02045157365500927, decouple_loss:0.010072105564177036
The generated pressure mean: 0.4236130118370056
loss_pred:0.02053005062043667, decouple_loss:0.009786359034478664
Iteration: 2448, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4622516334056854
loss_pred:0.021055113524198532, decouple_loss:0.009732665494084358
The generated pressure mean: 0.46394866704940796
loss_pred:0.02069048024713993, decouple_loss:0.009932087734341621
The generated pressure mean: 0.462126761674881
loss_pred:0.020710358396172523, decouple_loss:0.009694516658782959
Iteration: 2449, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.466231107711792
The generated pressure mean: 0.46434274315834045
loss_pred:0.019670218229293823, decouple_loss:0.009052476845681667
loss_pred:0.020976457744836807, decouple_loss:0.009029349312186241
The generated pressure mean: 0.4643230438232422
loss_pred:0.021805496886372566, decouple_loss:0.00893781241029501
Iteration: 2450, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4419732391834259
The generated pressure mean: 0.44129666686058044
loss_pred:0.020848026499152184, decouple_loss:0.00895148515701294
loss_pred:0.020713895559310913, decouple_loss:0.008906187489628792
The generated pressure mean: 0.4436626434326172
loss_pred:0.020333247259259224, decouple_loss:0.008973602205514908
2023-04-16 21:23:25 testing...
The generated pressure mean: 0.41931241750717163
The generated pressure mean: 0.4259258210659027
loss_pred:0.033058393746614456, decouple_loss:0.009412220679223537
The generated pressure mean: 0.4287374019622803
loss_pred:0.03226209059357643, decouple_loss:0.009511222131550312
loss_pred:0.031937774270772934, decouple_loss:0.009728946723043919
WV_0_PC_0_EH_1_PS_40, loss: 0.03289695829153061, avg_mse: 0.04712758958339691
current test mse: 0.047128
Iteration: 2451, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42953231930732727
loss_pred:0.020220806822180748, decouple_loss:0.008860668167471886
The generated pressure mean: 0.43502750992774963
loss_pred:0.021714987233281136, decouple_loss:0.008844219148159027
The generated pressure mean: 0.4368372857570648
loss_pred:0.021548710763454437, decouple_loss:0.008797002024948597
Iteration: 2452, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4567047357559204
loss_pred:0.020949458703398705, decouple_loss:0.008853165432810783
The generated pressure mean: 0.4492827355861664
loss_pred:0.02028784155845642, decouple_loss:0.008736793883144855
The generated pressure mean: 0.4504409432411194
loss_pred:0.02154141664505005, decouple_loss:0.008793533779680729
Iteration: 2453, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447413831949234
loss_pred:0.021972624585032463, decouple_loss:0.009161053225398064
The generated pressure mean: 0.43743088841438293
loss_pred:0.021792473271489143, decouple_loss:0.009355885908007622
The generated pressure mean: 0.44045665860176086
loss_pred:0.021108169108629227, decouple_loss:0.009337954223155975
Iteration: 2454, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4297138750553131
loss_pred:0.02052675187587738, decouple_loss:0.00958551000803709
The generated pressure mean: 0.4328438639640808
loss_pred:0.022662963718175888, decouple_loss:0.009654488414525986
The generated pressure mean: 0.43258461356163025
loss_pred:0.022470826283097267, decouple_loss:0.009570199064910412
Iteration: 2455, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4683834910392761
loss_pred:0.02060568332672119, decouple_loss:0.008826067671179771
The generated pressure mean: 0.46103253960609436
loss_pred:0.020637983456254005, decouple_loss:0.008925088681280613
The generated pressure mean: 0.46711674332618713
loss_pred:0.02138398215174675, decouple_loss:0.00898781605064869
Iteration: 2456, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.456747829914093
loss_pred:0.02038160338997841, decouple_loss:0.008958150632679462
The generated pressure mean: 0.45615068078041077
loss_pred:0.021579885855317116, decouple_loss:0.009033169597387314
The generated pressure mean: 0.451517790555954
loss_pred:0.020328722894191742, decouple_loss:0.008840287104249
Iteration: 2457, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4379628896713257
loss_pred:0.021808572113513947, decouple_loss:0.008743382059037685
The generated pressure mean: 0.44103947281837463
loss_pred:0.020623458549380302, decouple_loss:0.008776417933404446
The generated pressure mean: 0.43978559970855713
loss_pred:0.01992988958954811, decouple_loss:0.008785619400441647
Iteration: 2458, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4381437301635742
loss_pred:0.020575348287820816, decouple_loss:0.009181882254779339
The generated pressure mean: 0.4353315234184265
loss_pred:0.02021975815296173, decouple_loss:0.009127648547291756
The generated pressure mean: 0.44100257754325867
loss_pred:0.02005823142826557, decouple_loss:0.009028722532093525
Iteration: 2459, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4417930245399475
loss_pred:0.021610209718346596, decouple_loss:0.010437102988362312
The generated pressure mean: 0.4429643750190735
loss_pred:0.020497534424066544, decouple_loss:0.010343068279325962
The generated pressure mean: 0.4421444535255432
loss_pred:0.020072543993592262, decouple_loss:0.010469645261764526
Iteration: 2460, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4625310003757477
loss_pred:0.021194370463490486, decouple_loss:0.010157295502722263
The generated pressure mean: 0.4565929174423218
loss_pred:0.01992492936551571, decouple_loss:0.010178818367421627
The generated pressure mean: 0.4566187858581543
loss_pred:0.021063275635242462, decouple_loss:0.01007540337741375
2023-04-16 21:25:16 testing...
The generated pressure mean: 0.4174851179122925
The generated pressure mean: 0.42395612597465515
loss_pred:0.03166428580880165, decouple_loss:0.009359623305499554
The generated pressure mean: 0.42582887411117554
loss_pred:0.030657971277832985, decouple_loss:0.00949831586331129
loss_pred:0.030277514830231667, decouple_loss:0.009626062586903572
WV_0_PC_0_EH_1_PS_40, loss: 0.031341325491666794, avg_mse: 0.04351174831390381
current test mse: 0.043512
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 2461, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449062645435333
loss_pred:0.01949094608426094, decouple_loss:0.008886474184691906
The generated pressure mean: 0.4371035397052765
The generated pressure mean: 0.43704017996788025
loss_pred:0.021153490990400314, decouple_loss:0.00892619974911213
loss_pred:0.021357817575335503, decouple_loss:0.008900918997824192
Iteration: 2462, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4401533603668213
The generated pressure mean: 0.4404342472553253
loss_pred:0.021950412541627884, decouple_loss:0.008479668758809566
loss_pred:0.019954130053520203, decouple_loss:0.008457467891275883
The generated pressure mean: 0.4373563528060913
loss_pred:0.021287333220243454, decouple_loss:0.008415190503001213
Iteration: 2463, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4551684260368347
loss_pred:0.020506704226136208, decouple_loss:0.008230200968682766
The generated pressure mean: 0.45654067397117615
loss_pred:0.020042959600687027, decouple_loss:0.0082122553139925
The generated pressure mean: 0.4505341351032257
loss_pred:0.020422184839844704, decouple_loss:0.008229861967265606
Iteration: 2464, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45114001631736755
loss_pred:0.020698675885796547, decouple_loss:0.009256674908101559
The generated pressure mean: 0.4566429555416107
loss_pred:0.021915297955274582, decouple_loss:0.009172702208161354
The generated pressure mean: 0.45385614037513733
loss_pred:0.021712757647037506, decouple_loss:0.009144664742052555
Iteration: 2465, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4372192919254303
The generated pressure mean: 0.43754664063453674
loss_pred:0.021318022161722183, decouple_loss:0.009047999046742916
loss_pred:0.021278325468301773, decouple_loss:0.00896929670125246
The generated pressure mean: 0.4370407462120056
loss_pred:0.021477140486240387, decouple_loss:0.009183323010802269
Iteration: 2466, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44834455847740173
The generated pressure mean: 0.4459038972854614
loss_pred:0.020561929792165756, decouple_loss:0.009339790791273117
loss_pred:0.020653285086154938, decouple_loss:0.00959949940443039
The generated pressure mean: 0.447050541639328
loss_pred:0.021506795659661293, decouple_loss:0.009466556832194328
Iteration: 2467, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4445798099040985
The generated pressure mean: 0.4490574300289154
loss_pred:0.019862378016114235, decouple_loss:0.00841591227799654
loss_pred:0.021189145743846893, decouple_loss:0.008420513942837715
The generated pressure mean: 0.4476770758628845
loss_pred:0.01995689794421196, decouple_loss:0.008502442389726639
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2468, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44593629240989685
The generated pressure mean: 0.4398358464241028
loss_pred:0.021251555532217026, decouple_loss:0.008479151874780655
loss_pred:0.02033478021621704, decouple_loss:0.008335248567163944
The generated pressure mean: 0.4450407326221466
loss_pred:0.020062033087015152, decouple_loss:0.008273585699498653
Iteration: 2469, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4560367166996002
The generated pressure mean: 0.4561609625816345
loss_pred:0.020425505936145782, decouple_loss:0.00811004638671875
loss_pred:0.01929248496890068, decouple_loss:0.008031975477933884
The generated pressure mean: 0.4563399851322174
loss_pred:0.022504035383462906, decouple_loss:0.008100523613393307
Iteration: 2470, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44620802998542786
loss_pred:0.020723890513181686, decouple_loss:0.008226105011999607
The generated pressure mean: 0.4441347122192383
loss_pred:0.021523823961615562, decouple_loss:0.0080765625461936
The generated pressure mean: 0.4417296350002289
loss_pred:0.020920157432556152, decouple_loss:0.00810734461992979
2023-04-16 21:27:44 testing...
The generated pressure mean: 0.41776758432388306
The generated pressure mean: 0.4236007034778595
loss_pred:0.0317583866417408, decouple_loss:0.008965056389570236
The generated pressure mean: 0.42548224329948425
loss_pred:0.030769404023885727, decouple_loss:0.00923377275466919
loss_pred:0.03056548908352852, decouple_loss:0.009379472583532333
WV_0_PC_0_EH_1_PS_40, loss: 0.03149073198437691, avg_mse: 0.0438377745449543
current test mse: 0.043838
Iteration: 2471, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.439104825258255
The generated pressure mean: 0.4381847679615021
loss_pred:0.02108021266758442, decouple_loss:0.008539410308003426
loss_pred:0.020364170894026756, decouple_loss:0.008381878025829792
The generated pressure mean: 0.4382224380970001
loss_pred:0.020163843408226967, decouple_loss:0.00837317667901516
Iteration: 2472, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45243874192237854
The generated pressure mean: 0.4471900463104248
loss_pred:0.021437637507915497, decouple_loss:0.009089243598282337
loss_pred:0.021012602373957634, decouple_loss:0.009109877049922943
The generated pressure mean: 0.45354369282722473
loss_pred:0.019841104745864868, decouple_loss:0.008924080058932304
Iteration: 2473, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4523395895957947
The generated pressure mean: 0.45313549041748047
loss_pred:0.021743368357419968, decouple_loss:0.00931060966104269
loss_pred:0.019953249022364616, decouple_loss:0.009110153652727604
The generated pressure mean: 0.45069360733032227
loss_pred:0.020067721605300903, decouple_loss:0.009349806234240532
Iteration: 2474, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44181615114212036
The generated pressure mean: 0.43864405155181885loss_pred:0.0221727155148983, decouple_loss:0.008633838035166264
loss_pred:0.020912056788802147, decouple_loss:0.008688049390912056
The generated pressure mean: 0.439889520406723
loss_pred:0.0206838957965374, decouple_loss:0.008675983175635338
Iteration: 2475, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44494038820266724
The generated pressure mean: 0.444879949092865
loss_pred:0.020909013226628304, decouple_loss:0.009050847962498665
loss_pred:0.02095954678952694, decouple_loss:0.008859215304255486
The generated pressure mean: 0.44179728627204895
loss_pred:0.021102968603372574, decouple_loss:0.008855744265019894
Iteration: 2476, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492562413215637
The generated pressure mean: 0.45439332723617554
loss_pred:0.0223569143563509, decouple_loss:0.008946511894464493
loss_pred:0.019901426509022713, decouple_loss:0.008914414793252945
The generated pressure mean: 0.45042526721954346
loss_pred:0.020595470443367958, decouple_loss:0.008738837204873562
Iteration: 2477, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4414380192756653
loss_pred:0.020927930250763893, decouple_loss:0.00810739304870367
The generated pressure mean: 0.4437595307826996
loss_pred:0.020137550309300423, decouple_loss:0.008018454536795616
The generated pressure mean: 0.44593918323516846
loss_pred:0.021917644888162613, decouple_loss:0.008092813193798065
Iteration: 2478, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507613480091095
The generated pressure mean: 0.44724151492118835
loss_pred:0.02079298160970211, decouple_loss:0.008077513426542282
loss_pred:0.020352646708488464, decouple_loss:0.00794881209731102
The generated pressure mean: 0.44617563486099243
loss_pred:0.02081151120364666, decouple_loss:0.0079948203638196
Iteration: 2479, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447327584028244
loss_pred:0.02012772671878338, decouple_loss:0.00821080431342125The generated pressure mean: 0.4482273757457733
loss_pred:0.021658774465322495, decouple_loss:0.008149325847625732
The generated pressure mean: 0.45003291964530945
loss_pred:0.019780756905674934, decouple_loss:0.00815671868622303
Iteration: 2480, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44761961698532104
loss_pred:0.020488562062382698, decouple_loss:0.00826119352132082
The generated pressure mean: 0.444445937871933
loss_pred:0.019244186580181122, decouple_loss:0.008387021720409393
The generated pressure mean: 0.4400641918182373
loss_pred:0.02125483937561512, decouple_loss:0.008315742015838623
2023-04-16 21:29:38 testing...
The generated pressure mean: 0.4164653718471527
The generated pressure mean: 0.42331621050834656
The generated pressure mean: 0.4254462718963623
loss_pred:0.0322658009827137, decouple_loss:0.009075474925339222
loss_pred:0.030835933983325958, decouple_loss:0.009275577031075954
loss_pred:0.030887287110090256, decouple_loss:0.009417424909770489
WV_0_PC_0_EH_1_PS_40, loss: 0.03179248422384262, avg_mse: 0.04479583352804184
current test mse: 0.044796
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 2481, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44799384474754333
loss_pred:0.020946303382515907, decouple_loss:0.008751875720918179
The generated pressure mean: 0.4473287761211395
loss_pred:0.020919950678944588, decouple_loss:0.008733727969229221
The generated pressure mean: 0.4442112445831299
loss_pred:0.021567346528172493, decouple_loss:0.008634746074676514
Iteration: 2482, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481559991836548
The generated pressure mean: 0.44582435488700867
loss_pred:0.02138945646584034, decouple_loss:0.0077990139834582806
loss_pred:0.019683310762047768, decouple_loss:0.007835214026272297
The generated pressure mean: 0.44337356090545654
loss_pred:0.020084833726286888, decouple_loss:0.007867511361837387
Iteration: 2483, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499584436416626
loss_pred:0.021303227171301842, decouple_loss:0.008008494973182678
The generated pressure mean: 0.44985640048980713
loss_pred:0.020079519599676132, decouple_loss:0.008115582168102264
The generated pressure mean: 0.45045164227485657
loss_pred:0.020921558141708374, decouple_loss:0.007974324747920036
Iteration: 2484, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44104185700416565
The generated pressure mean: 0.4388427734375
loss_pred:0.020304981619119644, decouple_loss:0.008694673888385296
loss_pred:0.019985565915703773, decouple_loss:0.008601811714470387
The generated pressure mean: 0.4429810345172882
loss_pred:0.020565660670399666, decouple_loss:0.008800194598734379
Iteration: 2485, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4416564106941223
The generated pressure mean: 0.44375982880592346
loss_pred:0.021092591807246208, decouple_loss:0.009831100702285767
loss_pred:0.020318886265158653, decouple_loss:0.009744021110236645
The generated pressure mean: 0.4500991702079773
loss_pred:0.019224243238568306, decouple_loss:0.009861179627478123
Iteration: 2486, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4556615352630615
The generated pressure mean: 0.44850149750709534
loss_pred:0.021367402747273445, decouple_loss:0.010714979842305183
loss_pred:0.02248752862215042, decouple_loss:0.010661883279681206
The generated pressure mean: 0.4542037844657898
loss_pred:0.02129182405769825, decouple_loss:0.010701125487685204
Iteration: 2487, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4447081685066223
The generated pressure mean: 0.44071465730667114
loss_pred:0.020934004336595535, decouple_loss:0.009141946211457253
loss_pred:0.020552249625325203, decouple_loss:0.00920862052589655
The generated pressure mean: 0.43836289644241333
loss_pred:0.02189962938427925, decouple_loss:0.009123017080128193
Iteration: 2488, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4539574384689331
The generated pressure mean: 0.4446905553340912
loss_pred:0.021558314561843872, decouple_loss:0.0076726083643734455
loss_pred:0.02172505296766758, decouple_loss:0.007723002694547176
The generated pressure mean: 0.44347235560417175
loss_pred:0.020758481696248055, decouple_loss:0.007607962004840374
Iteration: 2489, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45345818996429443
The generated pressure mean: 0.4488145709037781
loss_pred:0.01879849284887314, decouple_loss:0.009719845838844776
loss_pred:0.020664405077695847, decouple_loss:0.009806184098124504
The generated pressure mean: 0.4450102746486664
loss_pred:0.02142919786274433, decouple_loss:0.009942171163856983
Iteration: 2490, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498603940010071
loss_pred:0.0199448075145483, decouple_loss:0.009760254062712193
The generated pressure mean: 0.4508596956729889
loss_pred:0.01873186230659485, decouple_loss:0.009940947405993938
The generated pressure mean: 0.4474851191043854
loss_pred:0.020529214292764664, decouple_loss:0.009809904731810093
2023-04-16 21:32:11 testing...
The generated pressure mean: 0.4164886176586151
The generated pressure mean: 0.4234578013420105
The generated pressure mean: 0.4257107675075531
loss_pred:0.032612476497888565, decouple_loss:0.009578484110534191
loss_pred:0.0317409448325634, decouple_loss:0.009722410701215267
loss_pred:0.03157535567879677, decouple_loss:0.009888785891234875
WV_0_PC_0_EH_1_PS_40, loss: 0.03246275708079338, avg_mse: 0.046318963170051575
current test mse: 0.046319
Iteration: 2491, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44160178303718567
The generated pressure mean: 0.4483494460582733
loss_pred:0.01985459215939045, decouple_loss:0.008711560629308224
loss_pred:0.019025109708309174, decouple_loss:0.008616354316473007
The generated pressure mean: 0.45049065351486206
loss_pred:0.02117803692817688, decouple_loss:0.008670401759445667
Iteration: 2492, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4359598755836487
The generated pressure mean: 0.4361424744129181
loss_pred:0.020698580890893936, decouple_loss:0.007625971455127001
loss_pred:0.020367661491036415, decouple_loss:0.007759540341794491
The generated pressure mean: 0.43504542112350464
loss_pred:0.020949583500623703, decouple_loss:0.00768521660938859
Iteration: 2493, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473535716533661
The generated pressure mean: 0.4520759582519531
loss_pred:0.020481416955590248, decouple_loss:0.008240673691034317
loss_pred:0.020680278539657593, decouple_loss:0.008181856013834476
The generated pressure mean: 0.4486594796180725
loss_pred:0.021311404183506966, decouple_loss:0.008175596594810486
Iteration: 2494, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45119717717170715
The generated pressure mean: 0.4477289617061615
loss_pred:0.020014263689517975, decouple_loss:0.008123760111629963
loss_pred:0.019646350294351578, decouple_loss:0.008151358924806118
The generated pressure mean: 0.44775551557540894
loss_pred:0.019239062443375587, decouple_loss:0.008091270923614502
Iteration: 2495, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44755589962005615The generated pressure mean: 0.446618914604187
loss_pred:0.020171232521533966, decouple_loss:0.007983515970408916
loss_pred:0.019290335476398468, decouple_loss:0.00802407693117857
The generated pressure mean: 0.44768989086151123
loss_pred:0.020688556134700775, decouple_loss:0.00797983631491661
Iteration: 2496, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44921478629112244
The generated pressure mean: 0.45284321904182434
loss_pred:0.020716547966003418, decouple_loss:0.0079679349437356
loss_pred:0.019623246043920517, decouple_loss:0.00814818125218153
The generated pressure mean: 0.44943657517433167
loss_pred:0.020891034975647926, decouple_loss:0.008186854422092438
Iteration: 2497, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43604350090026855
The generated pressure mean: 0.4387742280960083
loss_pred:0.019983384758234024, decouple_loss:0.00878715980798006
loss_pred:0.020435839891433716, decouple_loss:0.00868305191397667
The generated pressure mean: 0.43747779726982117
loss_pred:0.021307943388819695, decouple_loss:0.00859557930380106
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2498, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44241851568222046
loss_pred:0.021556466817855835, decouple_loss:0.009498614817857742
The generated pressure mean: 0.44695574045181274
loss_pred:0.021939827129244804, decouple_loss:0.009534066542983055
The generated pressure mean: 0.4500442445278168
loss_pred:0.020719341933727264, decouple_loss:0.009546622633934021
Iteration: 2499, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4426448941230774
loss_pred:0.019969595596194267, decouple_loss:0.009528718888759613
The generated pressure mean: 0.44971609115600586
loss_pred:0.02098926156759262, decouple_loss:0.009517749771475792
The generated pressure mean: 0.4447331130504608
loss_pred:0.019757816568017006, decouple_loss:0.009638925082981586
Iteration: 2500, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469306766986847
loss_pred:0.019543049857020378, decouple_loss:0.008086375892162323
The generated pressure mean: 0.4454267919063568
loss_pred:0.021342581138014793, decouple_loss:0.00811742153018713
The generated pressure mean: 0.4477729797363281
loss_pred:0.020835978910326958, decouple_loss:0.008185096085071564
2023-04-16 21:34:05 testing...
The generated pressure mean: 0.41324707865715027
The generated pressure mean: 0.42050454020500183
loss_pred:0.03312963992357254, decouple_loss:0.00877857394516468
The generated pressure mean: 0.4225991666316986
loss_pred:0.03198380023241043, decouple_loss:0.00888256449252367
loss_pred:0.031631533056497574, decouple_loss:0.009052103385329247
WV_0_PC_0_EH_1_PS_40, loss: 0.03269354626536369, avg_mse: 0.046758513897657394
current test mse: 0.046759
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 2501, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46423646807670593
loss_pred:0.019816413521766663, decouple_loss:0.00801797118037939
The generated pressure mean: 0.4594096541404724
loss_pred:0.019489608705043793, decouple_loss:0.007876879535615444
The generated pressure mean: 0.4560059607028961
loss_pred:0.0206654854118824, decouple_loss:0.007904132828116417
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2502, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480721652507782
The generated pressure mean: 0.447163462638855
loss_pred:0.019929064437747, decouple_loss:0.009605211205780506
loss_pred:0.020517930388450623, decouple_loss:0.009684392251074314
The generated pressure mean: 0.4464786946773529
loss_pred:0.020292744040489197, decouple_loss:0.009723314084112644
Iteration: 2503, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4292019009590149
The generated pressure mean: 0.4303478002548218
loss_pred:0.021658096462488174, decouple_loss:0.009596505202353
loss_pred:0.020799769088625908, decouple_loss:0.009480665437877178
The generated pressure mean: 0.4288698732852936
loss_pred:0.0211491696536541, decouple_loss:0.009641050361096859
Iteration: 2504, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44723451137542725
The generated pressure mean: 0.447245717048645
loss_pred:0.021276012063026428, decouple_loss:0.008237446658313274
loss_pred:0.021050414070487022, decouple_loss:0.00814809650182724
The generated pressure mean: 0.44765231013298035
loss_pred:0.020728852599859238, decouple_loss:0.008327838964760303
Iteration: 2505, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4542270004749298
The generated pressure mean: 0.4561089873313904
loss_pred:0.02127351425588131, decouple_loss:0.00849205907434225
loss_pred:0.02085193246603012, decouple_loss:0.008468739688396454
The generated pressure mean: 0.45592841506004333
loss_pred:0.02156415954232216, decouple_loss:0.008589365519583225
Iteration: 2506, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4566290080547333
The generated pressure mean: 0.4514373242855072loss_pred:0.02023501880466938, decouple_loss:0.00786163005977869
loss_pred:0.019216284155845642, decouple_loss:0.007843133062124252
The generated pressure mean: 0.4471088647842407
loss_pred:0.020172452554106712, decouple_loss:0.00771485548466444
Iteration: 2507, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462340176105499
The generated pressure mean: 0.44919446110725403
loss_pred:0.020212076604366302, decouple_loss:0.00892949104309082
loss_pred:0.020257186144590378, decouple_loss:0.009041452780365944
The generated pressure mean: 0.4431329071521759
loss_pred:0.02077922224998474, decouple_loss:0.008880785666406155
Iteration: 2508, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4518439769744873
The generated pressure mean: 0.4470148980617523
loss_pred:0.019263379275798798, decouple_loss:0.009383924305438995
loss_pred:0.02162875421345234, decouple_loss:0.009393901564180851
The generated pressure mean: 0.45015621185302734
loss_pred:0.02058631181716919, decouple_loss:0.009349898435175419
Iteration: 2509, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43784353137016296The generated pressure mean: 0.4401824474334717
loss_pred:0.020443646237254143, decouple_loss:0.009727833792567253
loss_pred:0.020973026752471924, decouple_loss:0.009687122888863087
The generated pressure mean: 0.44006386399269104
loss_pred:0.021021854132413864, decouple_loss:0.009600750170648098
Iteration: 2510, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4391947388648987
The generated pressure mean: 0.44284313917160034
loss_pred:0.022066820412874222, decouple_loss:0.009926768019795418
loss_pred:0.02097797766327858, decouple_loss:0.009818315505981445
The generated pressure mean: 0.4410104751586914
loss_pred:0.02127055823802948, decouple_loss:0.009915448725223541
2023-04-16 21:36:37 testing...
The generated pressure mean: 0.4125268757343292
The generated pressure mean: 0.41858431696891785
loss_pred:0.03272081911563873, decouple_loss:0.009043881669640541
The generated pressure mean: 0.4207763373851776
loss_pred:0.03170718997716904, decouple_loss:0.009339033626019955
loss_pred:0.03133782744407654, decouple_loss:0.009367868304252625
WV_0_PC_0_EH_1_PS_40, loss: 0.03238445892930031, avg_mse: 0.045699380338191986
current test mse: 0.045699
Iteration: 2511, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4576321840286255
The generated pressure mean: 0.4599531292915344
loss_pred:0.020887404680252075, decouple_loss:0.008556432090699673
loss_pred:0.02049204520881176, decouple_loss:0.00859149731695652
The generated pressure mean: 0.4590282738208771
loss_pred:0.01994682289659977, decouple_loss:0.008507275953888893
Iteration: 2512, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44689640402793884
The generated pressure mean: 0.4534103572368622
loss_pred:0.020924681797623634, decouple_loss:0.008486789651215076
loss_pred:0.019911549985408783, decouple_loss:0.008517386391758919
The generated pressure mean: 0.44577986001968384
loss_pred:0.020217876881361008, decouple_loss:0.008561232127249241
Iteration: 2513, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4455684423446655
loss_pred:0.020838381722569466, decouple_loss:0.009003386832773685
The generated pressure mean: 0.4463134706020355
loss_pred:0.02077825739979744, decouple_loss:0.00882203783839941
The generated pressure mean: 0.44243595004081726
loss_pred:0.0216780137270689, decouple_loss:0.008831024169921875
Iteration: 2514, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44203928112983704
loss_pred:0.020704438909888268, decouple_loss:0.008993320167064667
The generated pressure mean: 0.44745397567749023
loss_pred:0.020613569766283035, decouple_loss:0.008881396614015102
The generated pressure mean: 0.4475569725036621
loss_pred:0.020201390609145164, decouple_loss:0.0088660204783082
Iteration: 2515, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506429135799408
loss_pred:0.021412719041109085, decouple_loss:0.009229430928826332
The generated pressure mean: 0.4456668794155121
loss_pred:0.021593069657683372, decouple_loss:0.00904209166765213
The generated pressure mean: 0.45090726017951965
loss_pred:0.02041955292224884, decouple_loss:0.009227758273482323
Iteration: 2516, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475618302822113
loss_pred:0.021461017429828644, decouple_loss:0.008807105012238026
The generated pressure mean: 0.446533739566803
loss_pred:0.02054647170007229, decouple_loss:0.00890402588993311
The generated pressure mean: 0.44027191400527954
loss_pred:0.020610138773918152, decouple_loss:0.008859442546963692
Iteration: 2517, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44781818985939026
The generated pressure mean: 0.44751450419425964
loss_pred:0.019870677962899208, decouple_loss:0.008114660158753395
loss_pred:0.021596038714051247, decouple_loss:0.0080717159435153
The generated pressure mean: 0.4446026384830475
loss_pred:0.02140982262790203, decouple_loss:0.008079281076788902
Iteration: 2518, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4431231617927551
The generated pressure mean: 0.45266321301460266
loss_pred:0.020635662600398064, decouple_loss:0.007260087877511978
loss_pred:0.021206850185990334, decouple_loss:0.007229336071759462
The generated pressure mean: 0.44589346647262573
loss_pred:0.020918356254696846, decouple_loss:0.007197143975645304
Iteration: 2519, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45083877444267273
The generated pressure mean: 0.4475290775299072
loss_pred:0.01951931044459343, decouple_loss:0.008043688721954823
loss_pred:0.019737185910344124, decouple_loss:0.00806530099362135
The generated pressure mean: 0.4449290931224823
loss_pred:0.020435448735952377, decouple_loss:0.00794410053640604
Iteration: 2520, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45560815930366516
loss_pred:0.018428033217787743, decouple_loss:0.008101317100226879
The generated pressure mean: 0.45079469680786133
loss_pred:0.020942145958542824, decouple_loss:0.008036112412810326
The generated pressure mean: 0.4540790915489197
loss_pred:0.021053742617368698, decouple_loss:0.007934105582535267
2023-04-16 21:38:30 testing...
The generated pressure mean: 0.42289847135543823
The generated pressure mean: 0.41649603843688965
The generated pressure mean: 0.42513343691825867
loss_pred:0.03173026442527771, decouple_loss:0.009629158303141594
loss_pred:0.03293318673968315, decouple_loss:0.009343397803604603
loss_pred:0.03142743185162544, decouple_loss:0.009791048243641853
WV_0_PC_0_EH_1_PS_40, loss: 0.032509688287973404, avg_mse: 0.046137142926454544
current test mse: 0.046137
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 2521, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44073379039764404
loss_pred:0.020883727818727493, decouple_loss:0.00925380177795887
The generated pressure mean: 0.446045458316803
loss_pred:0.020902138203382492, decouple_loss:0.008941280655562878
The generated pressure mean: 0.4443281888961792
loss_pred:0.020765360444784164, decouple_loss:0.00910887960344553
Iteration: 2522, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4413836896419525
The generated pressure mean: 0.4384687840938568
loss_pred:0.021666765213012695, decouple_loss:0.010083804838359356
loss_pred:0.021129457280039787, decouple_loss:0.00979146733880043
The generated pressure mean: 0.4365141689777374
loss_pred:0.02133677341043949, decouple_loss:0.009997106157243252
Iteration: 2523, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4522723853588104
The generated pressure mean: 0.4572393000125885
loss_pred:0.020946184173226357, decouple_loss:0.009914064779877663
loss_pred:0.021563708782196045, decouple_loss:0.009717238135635853
The generated pressure mean: 0.45324641466140747
loss_pred:0.02204054407775402, decouple_loss:0.009974749758839607
Iteration: 2524, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45229578018188477
loss_pred:0.021828543394804, decouple_loss:0.008883989416062832
The generated pressure mean: 0.4509909451007843
loss_pred:0.019761795178055763, decouple_loss:0.008783974684774876
The generated pressure mean: 0.4550994634628296
loss_pred:0.020905449986457825, decouple_loss:0.009074983187019825
Iteration: 2525, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467359185218811
The generated pressure mean: 0.44725582003593445
loss_pred:0.02098957821726799, decouple_loss:0.00827518105506897
loss_pred:0.021087927743792534, decouple_loss:0.00858465489000082
The generated pressure mean: 0.44893619418144226
loss_pred:0.021316489204764366, decouple_loss:0.008333929814398289
Iteration: 2526, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4458376467227936
The generated pressure mean: 0.44751256704330444
loss_pred:0.020145028829574585, decouple_loss:0.007515075616538525
loss_pred:0.02031809650361538, decouple_loss:0.007441507652401924
The generated pressure mean: 0.4501878321170807
loss_pred:0.02074548229575157, decouple_loss:0.0075659980066120625
Iteration: 2527, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43970680236816406
The generated pressure mean: 0.43787670135498047
loss_pred:0.02131996490061283, decouple_loss:0.008573319762945175
loss_pred:0.02024737000465393, decouple_loss:0.008443989790976048
The generated pressure mean: 0.4375460147857666
loss_pred:0.022232279181480408, decouple_loss:0.008864560164511204
Iteration: 2528, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44115081429481506
The generated pressure mean: 0.43922537565231323
loss_pred:0.021140748634934425, decouple_loss:0.010536247864365578
loss_pred:0.020041225478053093, decouple_loss:0.010471032932400703
The generated pressure mean: 0.4472042918205261
loss_pred:0.02108733169734478, decouple_loss:0.010572563856840134
Iteration: 2529, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4582735598087311
The generated pressure mean: 0.45650628209114075
loss_pred:0.020954817533493042, decouple_loss:0.008258399553596973
loss_pred:0.019896727055311203, decouple_loss:0.00848475843667984
The generated pressure mean: 0.4548979699611664
loss_pred:0.020460348576307297, decouple_loss:0.008242527022957802
Iteration: 2530, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4535844326019287
loss_pred:0.020491337403655052, decouple_loss:0.010844988748431206
The generated pressure mean: 0.45641809701919556
loss_pred:0.020955873653292656, decouple_loss:0.010740863159298897
The generated pressure mean: 0.4575129747390747
loss_pred:0.019939007237553596, decouple_loss:0.010681675747036934
2023-04-16 21:41:02 testing...
The generated pressure mean: 0.41619759798049927
The generated pressure mean: 0.42253556847572327
The generated pressure mean: 0.4250584542751312
loss_pred:0.032146863639354706, decouple_loss:0.008860941044986248
loss_pred:0.031097209081053734, decouple_loss:0.008890525437891483
loss_pred:0.030746258795261383, decouple_loss:0.009116691537201405
WV_0_PC_0_EH_1_PS_40, loss: 0.031777914613485336, avg_mse: 0.044858988374471664
current test mse: 0.044859
Iteration: 2531, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4450831711292267
loss_pred:0.021521341055631638, decouple_loss:0.008317513391375542
The generated pressure mean: 0.44703322649002075
loss_pred:0.02408396266400814, decouple_loss:0.008496341295540333
The generated pressure mean: 0.448952853679657
loss_pred:0.02020334266126156, decouple_loss:0.008452502079308033
Iteration: 2532, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4340093731880188
loss_pred:0.02095838636159897, decouple_loss:0.008092769421637058
The generated pressure mean: 0.4379594326019287
loss_pred:0.018820788711309433, decouple_loss:0.00803713221102953
The generated pressure mean: 0.4342094361782074
loss_pred:0.020097754895687103, decouple_loss:0.008066733367741108
Iteration: 2533, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.443439781665802
loss_pred:0.02200830727815628, decouple_loss:0.010029311291873455
The generated pressure mean: 0.4476191997528076
loss_pred:0.020513631403446198, decouple_loss:0.010112750343978405
The generated pressure mean: 0.44825759530067444
loss_pred:0.019335083663463593, decouple_loss:0.010140320286154747
Iteration: 2534, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4553142488002777
loss_pred:0.019966861233115196, decouple_loss:0.008417954668402672
The generated pressure mean: 0.45522409677505493
loss_pred:0.021826395764946938, decouple_loss:0.008555978536605835
The generated pressure mean: 0.4510582983493805
loss_pred:0.020066555589437485, decouple_loss:0.008431248366832733
Iteration: 2535, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4455108046531677
loss_pred:0.020161714404821396, decouple_loss:0.00882671121507883
The generated pressure mean: 0.45085182785987854
loss_pred:0.02080496773123741, decouple_loss:0.008926143869757652
The generated pressure mean: 0.44888532161712646
loss_pred:0.020005159080028534, decouple_loss:0.008936521597206593
Iteration: 2536, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44606876373291016
loss_pred:0.019440853968262672, decouple_loss:0.009121348150074482
The generated pressure mean: 0.44688162207603455
loss_pred:0.020467014983296394, decouple_loss:0.00958689022809267
The generated pressure mean: 0.4424389898777008
loss_pred:0.023277996107935905, decouple_loss:0.00926801934838295
Iteration: 2537, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44496607780456543
loss_pred:0.019539425149559975, decouple_loss:0.007961984723806381
The generated pressure mean: 0.4405994415283203
loss_pred:0.020426051691174507, decouple_loss:0.007918637245893478
The generated pressure mean: 0.44925910234451294
loss_pred:0.020319459959864616, decouple_loss:0.007800987921655178
Iteration: 2538, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45494624972343445
loss_pred:0.021878423169255257, decouple_loss:0.009592362679541111
The generated pressure mean: 0.4547349512577057
The generated pressure mean: 0.4562937617301941
loss_pred:0.020197590813040733, decouple_loss:0.009474698454141617
loss_pred:0.020668240264058113, decouple_loss:0.009472465142607689
Iteration: 2539, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43297478556632996
loss_pred:0.020458826795220375, decouple_loss:0.009170293807983398
The generated pressure mean: 0.44066253304481506
loss_pred:0.02253107726573944, decouple_loss:0.00908195786178112
The generated pressure mean: 0.4418448805809021
loss_pred:0.019593574106693268, decouple_loss:0.00902589038014412
Iteration: 2540, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4565976560115814
loss_pred:0.019877096638083458, decouple_loss:0.009156888350844383
The generated pressure mean: 0.45796042680740356
The generated pressure mean: 0.4582310616970062
loss_pred:0.019721144810318947, decouple_loss:0.00907672755420208
loss_pred:0.022054389119148254, decouple_loss:0.00913152750581503
2023-04-16 21:42:56 testing...
The generated pressure mean: 0.41609758138656616
The generated pressure mean: 0.4223374128341675
The generated pressure mean: 0.42503824830055237
loss_pred:0.032351355999708176, decouple_loss:0.009239308536052704
loss_pred:0.031198473647236824, decouple_loss:0.009458299726247787
loss_pred:0.031008131802082062, decouple_loss:0.009670603089034557
WV_0_PC_0_EH_1_PS_40, loss: 0.03199212625622749, avg_mse: 0.04534028843045235
current test mse: 0.04534
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 2541, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485870599746704
loss_pred:0.019145695492625237, decouple_loss:0.009130100719630718
The generated pressure mean: 0.4483896493911743
The generated pressure mean: 0.4487135708332062
loss_pred:0.020062819123268127, decouple_loss:0.009023585356771946
loss_pred:0.019022207707166672, decouple_loss:0.009269824251532555
Iteration: 2542, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4369580149650574
loss_pred:0.020229220390319824, decouple_loss:0.008350388146936893
The generated pressure mean: 0.44012075662612915
loss_pred:0.021214745938777924, decouple_loss:0.008380880579352379
The generated pressure mean: 0.43343767523765564
loss_pred:0.020208066329360008, decouple_loss:0.008310423232614994
Iteration: 2543, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489150941371918
loss_pred:0.0199023075401783, decouple_loss:0.009705135598778725
The generated pressure mean: 0.4458920359611511
loss_pred:0.019889408722519875, decouple_loss:0.009726324118673801
The generated pressure mean: 0.45167526602745056
loss_pred:0.020603159442543983, decouple_loss:0.009666230529546738
Iteration: 2544, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4509343206882477
loss_pred:0.02140231430530548, decouple_loss:0.008948256261646748
The generated pressure mean: 0.44929659366607666
loss_pred:0.020547324791550636, decouple_loss:0.008875468745827675
The generated pressure mean: 0.4503075182437897
loss_pred:0.01966959238052368, decouple_loss:0.008841793052852154
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2545, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4419296085834503
loss_pred:0.020645691081881523, decouple_loss:0.00846629124134779
The generated pressure mean: 0.4431723356246948
loss_pred:0.02062302641570568, decouple_loss:0.00860233698040247
The generated pressure mean: 0.4356476962566376
loss_pred:0.02064456231892109, decouple_loss:0.008572760969400406
Iteration: 2546, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464753270149231
loss_pred:0.020113268867135048, decouple_loss:0.00782270822674036
The generated pressure mean: 0.4497324228286743
loss_pred:0.0213336069136858, decouple_loss:0.007847275584936142
The generated pressure mean: 0.44903460144996643
loss_pred:0.02076398953795433, decouple_loss:0.007932843640446663
Iteration: 2547, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4520684778690338
loss_pred:0.020814359188079834, decouple_loss:0.00826781801879406
The generated pressure mean: 0.4475723206996918
The generated pressure mean: 0.453508585691452
loss_pred:0.019680939614772797, decouple_loss:0.008242798037827015
loss_pred:0.019384365528821945, decouple_loss:0.008076678030192852
Iteration: 2548, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45234426856040955
The generated pressure mean: 0.4589049816131592
loss_pred:0.020394327118992805, decouple_loss:0.007357580587267876
loss_pred:0.020059406757354736, decouple_loss:0.007346820551902056
The generated pressure mean: 0.44648534059524536
loss_pred:0.019301695749163628, decouple_loss:0.0073114377446472645
Iteration: 2549, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43670526146888733
loss_pred:0.021448692306876183, decouple_loss:0.008077539503574371
The generated pressure mean: 0.4321056008338928
loss_pred:0.019179753959178925, decouple_loss:0.008183622732758522
The generated pressure mean: 0.4377593994140625
loss_pred:0.019921451807022095, decouple_loss:0.008303564973175526
Iteration: 2550, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44650202989578247The generated pressure mean: 0.44305309653282166
loss_pred:0.020196950063109398, decouple_loss:0.007589551620185375
loss_pred:0.019838428124785423, decouple_loss:0.007693237159401178
The generated pressure mean: 0.440663605928421
loss_pred:0.020562225952744484, decouple_loss:0.007724165450781584
2023-04-16 21:45:36 testing...
The generated pressure mean: 0.413757860660553
The generated pressure mean: 0.4206264317035675
The generated pressure mean: 0.4230513274669647
loss_pred:0.033602260053157806, decouple_loss:0.008654524572193623
loss_pred:0.032370131462812424, decouple_loss:0.008801360614597797
loss_pred:0.03215701878070831, decouple_loss:0.008840599097311497
WV_0_PC_0_EH_1_PS_40, loss: 0.03314808011054993, avg_mse: 0.04781229421496391
current test mse: 0.047812
Iteration: 2551, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4535038471221924
loss_pred:0.020080195739865303, decouple_loss:0.008073071949183941
The generated pressure mean: 0.46079280972480774
loss_pred:0.020334342494606972, decouple_loss:0.008082211948931217
The generated pressure mean: 0.45849865674972534
loss_pred:0.022286584600806236, decouple_loss:0.008077184669673443
Iteration: 2552, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43655940890312195
loss_pred:0.020466266199946404, decouple_loss:0.009110094048082829
The generated pressure mean: 0.43250924348831177
loss_pred:0.020157156512141228, decouple_loss:0.008977293968200684
The generated pressure mean: 0.4373251795768738
loss_pred:0.020917536690831184, decouple_loss:0.009205270558595657
Iteration: 2553, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4427841603755951
loss_pred:0.02356034703552723, decouple_loss:0.009389625862240791
The generated pressure mean: 0.44361621141433716
loss_pred:0.021251868456602097, decouple_loss:0.00930399913340807
The generated pressure mean: 0.4411360025405884
loss_pred:0.020798003301024437, decouple_loss:0.009366466663777828
Iteration: 2554, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45269590616226196
loss_pred:0.020594913512468338, decouple_loss:0.009238563477993011
The generated pressure mean: 0.44784411787986755
loss_pred:0.020423853769898415, decouple_loss:0.00929182767868042
The generated pressure mean: 0.4550670087337494
loss_pred:0.02103876881301403, decouple_loss:0.009484326466917992
Iteration: 2555, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490727484226227
loss_pred:0.019873226061463356, decouple_loss:0.007760171312838793
The generated pressure mean: 0.4533819556236267
loss_pred:0.01916026882827282, decouple_loss:0.007653416134417057
The generated pressure mean: 0.4558989703655243
loss_pred:0.01966158114373684, decouple_loss:0.007673528511077166
Iteration: 2556, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4423332214355469
loss_pred:0.01870274730026722, decouple_loss:0.00987542700022459
The generated pressure mean: 0.44602665305137634
loss_pred:0.02112949639558792, decouple_loss:0.009816196747124195
The generated pressure mean: 0.44250157475471497
loss_pred:0.019939599558711052, decouple_loss:0.00995270162820816
Iteration: 2557, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43750134110450745
loss_pred:0.02065075747668743, decouple_loss:0.010226096026599407
The generated pressure mean: 0.4375288188457489
loss_pred:0.01978771761059761, decouple_loss:0.010344475507736206
The generated pressure mean: 0.4409068822860718
loss_pred:0.01949945278465748, decouple_loss:0.010252139531075954
Iteration: 2558, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44693371653556824
loss_pred:0.019513310864567757, decouple_loss:0.008511065505445004
The generated pressure mean: 0.44947245717048645
The generated pressure mean: 0.4530330002307892
loss_pred:0.02073117345571518, decouple_loss:0.008463695645332336
loss_pred:0.02022857405245304, decouple_loss:0.008504923433065414
Iteration: 2559, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493413269519806
loss_pred:0.020256483927369118, decouple_loss:0.009532063268125057
The generated pressure mean: 0.4453151524066925
loss_pred:0.018982073292136192, decouple_loss:0.009602922014892101
The generated pressure mean: 0.4532708525657654
loss_pred:0.020158004015684128, decouple_loss:0.009382838383316994
Iteration: 2560, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449346661567688
loss_pred:0.019658999517560005, decouple_loss:0.009916036389768124
The generated pressure mean: 0.4467546343803406
loss_pred:0.019668804481625557, decouple_loss:0.009895537048578262
The generated pressure mean: 0.4483100473880768
loss_pred:0.019172916188836098, decouple_loss:0.009918365627527237
2023-04-16 21:47:29 testing...
The generated pressure mean: 0.42288854718208313
The generated pressure mean: 0.41668248176574707
loss_pred:0.031185422092676163, decouple_loss:0.008986548520624638
The generated pressure mean: 0.42497286200523376
loss_pred:0.03188503906130791, decouple_loss:0.008782545104622841
loss_pred:0.030607836320996284, decouple_loss:0.009036236442625523
WV_0_PC_0_EH_1_PS_40, loss: 0.03167285770177841, avg_mse: 0.04469535872340202
current test mse: 0.044695
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 2561, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4427504241466522
loss_pred:0.019505800679326057, decouple_loss:0.008321527391672134
The generated pressure mean: 0.4410210847854614
loss_pred:0.019836895167827606, decouple_loss:0.008365774527192116
The generated pressure mean: 0.444286972284317
loss_pred:0.019091689959168434, decouple_loss:0.008388184010982513
Iteration: 2562, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4537317454814911
The generated pressure mean: 0.4525386691093445
loss_pred:0.02412748895585537, decouple_loss:0.008185593411326408
loss_pred:0.02118554152548313, decouple_loss:0.008133376948535442
The generated pressure mean: 0.4525580108165741
loss_pred:0.019763285294175148, decouple_loss:0.008137676864862442
Iteration: 2563, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42664411664009094
loss_pred:0.020901689305901527, decouple_loss:0.008208176121115685
The generated pressure mean: 0.42299598455429077
loss_pred:0.019872574135661125, decouple_loss:0.008268936537206173
The generated pressure mean: 0.4284038543701172
loss_pred:0.021133972331881523, decouple_loss:0.00840643048286438
Iteration: 2564, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45339876413345337
The generated pressure mean: 0.45370247960090637
loss_pred:0.022153440862894058, decouple_loss:0.009876521304249763
loss_pred:0.020222842693328857, decouple_loss:0.009915092028677464
The generated pressure mean: 0.45324552059173584
loss_pred:0.02003386802971363, decouple_loss:0.010015253908932209
Iteration: 2565, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46943387389183044
loss_pred:0.019038233906030655, decouple_loss:0.01025911420583725
The generated pressure mean: 0.47006675601005554
loss_pred:0.01891259104013443, decouple_loss:0.010390541516244411
The generated pressure mean: 0.4749460816383362
loss_pred:0.020442869514226913, decouple_loss:0.010238819755613804
Iteration: 2566, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.442607045173645
The generated pressure mean: 0.44630780816078186
loss_pred:0.021075181663036346, decouple_loss:0.009772008284926414
loss_pred:0.020038893446326256, decouple_loss:0.009856848046183586
The generated pressure mean: 0.44533541798591614
loss_pred:0.020999416708946228, decouple_loss:0.009807437658309937
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2567, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4279285967350006
The generated pressure mean: 0.429545134305954
loss_pred:0.02062089927494526, decouple_loss:0.008550726808607578
loss_pred:0.022198887541890144, decouple_loss:0.008474727161228657
The generated pressure mean: 0.4284060001373291
loss_pred:0.020074645057320595, decouple_loss:0.008399047888815403
Iteration: 2568, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4390118718147278
The generated pressure mean: 0.4397086501121521
loss_pred:0.02030545100569725, decouple_loss:0.009886834770441055
loss_pred:0.020477773621678352, decouple_loss:0.009922167286276817
The generated pressure mean: 0.44429293274879456
loss_pred:0.019190574064850807, decouple_loss:0.009857081808149815
Iteration: 2569, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4522639214992523
The generated pressure mean: 0.45095643401145935
loss_pred:0.02136974222958088, decouple_loss:0.009851180016994476
loss_pred:0.018790896981954575, decouple_loss:0.009813983924686909
The generated pressure mean: 0.4563184678554535
loss_pred:0.02050754614174366, decouple_loss:0.009849934838712215
Iteration: 2570, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45930302143096924
The generated pressure mean: 0.4573008418083191
loss_pred:0.020560432225465775, decouple_loss:0.008660819381475449
loss_pred:0.02111043408513069, decouple_loss:0.0087359007447958
The generated pressure mean: 0.4620520770549774
loss_pred:0.02020137943327427, decouple_loss:0.008726747706532478
2023-04-16 21:50:13 testing...
The generated pressure mean: 0.41497889161109924
The generated pressure mean: 0.4209023416042328
The generated pressure mean: 0.4232689440250397
loss_pred:0.0320066474378109, decouple_loss:0.009314495138823986
loss_pred:0.030911147594451904, decouple_loss:0.009389454498887062
loss_pred:0.03056761436164379, decouple_loss:0.009523115120828152
WV_0_PC_0_EH_1_PS_40, loss: 0.031632255762815475, avg_mse: 0.044489260762929916
current test mse: 0.044489
Iteration: 2571, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477912485599518
loss_pred:0.020113984122872353, decouple_loss:0.008696194738149643
The generated pressure mean: 0.4490694999694824
loss_pred:0.019879676401615143, decouple_loss:0.008741720579564571
The generated pressure mean: 0.44542717933654785
loss_pred:0.020766420289874077, decouple_loss:0.008579262532293797
Iteration: 2572, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43955835700035095
loss_pred:0.019100958481431007, decouple_loss:0.008699563331902027
The generated pressure mean: 0.4403812289237976
loss_pred:0.020335311070084572, decouple_loss:0.008659019134938717
The generated pressure mean: 0.43700307607650757
loss_pred:0.019409405067563057, decouple_loss:0.00870161596685648
Iteration: 2573, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4405699074268341
loss_pred:0.02074436843395233, decouple_loss:0.008907472714781761
The generated pressure mean: 0.4456235468387604
loss_pred:0.02080109901726246, decouple_loss:0.00893312320113182
The generated pressure mean: 0.4427759349346161
loss_pred:0.020826008170843124, decouple_loss:0.009123153984546661
Iteration: 2574, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505399763584137
loss_pred:0.02101120539009571, decouple_loss:0.009790568612515926
The generated pressure mean: 0.45474812388420105
loss_pred:0.019132696092128754, decouple_loss:0.009681075811386108
The generated pressure mean: 0.45283159613609314
loss_pred:0.021215802058577538, decouple_loss:0.009851653128862381
Iteration: 2575, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4409291446208954
loss_pred:0.02038554660975933, decouple_loss:0.009690260514616966
The generated pressure mean: 0.4466482102870941
loss_pred:0.0193525031208992, decouple_loss:0.009531783871352673
The generated pressure mean: 0.44125986099243164
loss_pred:0.01985560543835163, decouple_loss:0.009448637254536152
Iteration: 2576, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44829896092414856
loss_pred:0.01951761171221733, decouple_loss:0.008457774296402931
The generated pressure mean: 0.450264036655426
loss_pred:0.019228914752602577, decouple_loss:0.00838419795036316
The generated pressure mean: 0.4489423334598541
loss_pred:0.021086636930704117, decouple_loss:0.008646703325212002
Iteration: 2577, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45465460419654846
loss_pred:0.020040029659867287, decouple_loss:0.007972159422934055
The generated pressure mean: 0.4539337158203125
loss_pred:0.019461603835225105, decouple_loss:0.007939480245113373
The generated pressure mean: 0.445512056350708
loss_pred:0.019337987527251244, decouple_loss:0.008114270865917206
Iteration: 2578, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44264405965805054
loss_pred:0.020854121074080467, decouple_loss:0.008528697304427624
The generated pressure mean: 0.44273027777671814
loss_pred:0.02039075829088688, decouple_loss:0.008631289005279541
The generated pressure mean: 0.4407828748226166
loss_pred:0.020120710134506226, decouple_loss:0.008484244346618652
Iteration: 2579, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4444675147533417
loss_pred:0.020493151620030403, decouple_loss:0.009913889691233635
The generated pressure mean: 0.4450109302997589
The generated pressure mean: 0.44952264428138733
loss_pred:0.020751139149069786, decouple_loss:0.010013137012720108
loss_pred:0.02176949754357338, decouple_loss:0.009868494234979153
Iteration: 2580, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44744476675987244
loss_pred:0.018665550276637077, decouple_loss:0.009187801741063595
The generated pressure mean: 0.4473735988140106
loss_pred:0.020268144086003304, decouple_loss:0.009181100875139236
The generated pressure mean: 0.44521018862724304
loss_pred:0.02033095248043537, decouple_loss:0.009222475811839104
2023-04-16 21:52:07 testing...
The generated pressure mean: 0.41579368710517883
The generated pressure mean: 0.42145562171936035
loss_pred:0.031983546912670135, decouple_loss:0.0089788306504488
The generated pressure mean: 0.42362162470817566
loss_pred:0.030643435195088387, decouple_loss:0.009137801826000214
loss_pred:0.030493786558508873, decouple_loss:0.009193823672831059
WV_0_PC_0_EH_1_PS_40, loss: 0.03149542957544327, avg_mse: 0.044229671359062195
current test mse: 0.04423
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 2581, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471188485622406
loss_pred:0.019273418933153152, decouple_loss:0.00830054096877575
The generated pressure mean: 0.44955775141716003
loss_pred:0.02037372812628746, decouple_loss:0.008305927738547325
The generated pressure mean: 0.4486076831817627
loss_pred:0.019461894407868385, decouple_loss:0.008399325422942638
Iteration: 2582, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43944716453552246
loss_pred:0.021643588319420815, decouple_loss:0.008919906802475452
The generated pressure mean: 0.4424898624420166
loss_pred:0.020944343879818916, decouple_loss:0.008915480226278305
The generated pressure mean: 0.4384901225566864
loss_pred:0.02009335532784462, decouple_loss:0.008979948237538338
Iteration: 2583, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44768571853637695
loss_pred:0.021783504635095596, decouple_loss:0.00837878230959177
The generated pressure mean: 0.4495181441307068
loss_pred:0.020861728116869926, decouple_loss:0.008537041954696178
The generated pressure mean: 0.44312044978141785
loss_pred:0.020160282030701637, decouple_loss:0.008756495080888271
Iteration: 2584, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44379904866218567
loss_pred:0.021360386162996292, decouple_loss:0.008068123832345009
The generated pressure mean: 0.44686147570610046
loss_pred:0.020839018747210503, decouple_loss:0.007957055233418941
The generated pressure mean: 0.4481545686721802
loss_pred:0.019639885053038597, decouple_loss:0.00800761952996254
Iteration: 2585, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45101359486579895
loss_pred:0.02138344757258892, decouple_loss:0.00801372341811657
The generated pressure mean: 0.4479759931564331
loss_pred:0.020703716203570366, decouple_loss:0.008116057142615318
The generated pressure mean: 0.44886723160743713
loss_pred:0.02037336677312851, decouple_loss:0.007966653443872929
Iteration: 2586, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45782533288002014
loss_pred:0.02072489634156227, decouple_loss:0.007513916119933128
The generated pressure mean: 0.4525430202484131
loss_pred:0.020816190168261528, decouple_loss:0.00763609167188406
The generated pressure mean: 0.45178094506263733
loss_pred:0.020154159516096115, decouple_loss:0.007509235292673111
Iteration: 2587, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4395027458667755
loss_pred:0.021700184792280197, decouple_loss:0.009243861772119999
The generated pressure mean: 0.44045689702033997
loss_pred:0.021174270659685135, decouple_loss:0.009435325860977173
The generated pressure mean: 0.4375282824039459
loss_pred:0.020534582436084747, decouple_loss:0.009339448064565659
Iteration: 2588, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4319588541984558
loss_pred:0.02138432301580906, decouple_loss:0.011643409729003906
The generated pressure mean: 0.4418903589248657
loss_pred:0.021287743002176285, decouple_loss:0.011592274531722069
The generated pressure mean: 0.4395909011363983
loss_pred:0.020068103447556496, decouple_loss:0.011777934618294239
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2589, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4436982274055481
loss_pred:0.020231399685144424, decouple_loss:0.009542610496282578
The generated pressure mean: 0.4443366825580597
The generated pressure mean: 0.4440222382545471
loss_pred:0.020013367757201195, decouple_loss:0.009486023336648941
loss_pred:0.01873285137116909, decouple_loss:0.009493933990597725
Iteration: 2590, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45982640981674194
loss_pred:0.02090277150273323, decouple_loss:0.00807331595569849
The generated pressure mean: 0.4619384706020355
The generated pressure mean: 0.46061065793037415
loss_pred:0.02035425417125225, decouple_loss:0.008046330884099007
loss_pred:0.020405985414981842, decouple_loss:0.008095013909041882
2023-04-16 21:54:39 testing...
The generated pressure mean: 0.41620004177093506
The generated pressure mean: 0.4224731922149658
The generated pressure mean: 0.4248124063014984
loss_pred:0.0317951999604702, decouple_loss:0.010814177803695202
loss_pred:0.03069574013352394, decouple_loss:0.010886001400649548
loss_pred:0.030611615628004074, decouple_loss:0.01109233871102333
WV_0_PC_0_EH_1_PS_40, loss: 0.03158072754740715, avg_mse: 0.04438294470310211
current test mse: 0.044383
Iteration: 2591, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44499534368515015
loss_pred:0.01966061443090439, decouple_loss:0.01047166995704174
The generated pressure mean: 0.4395841658115387
loss_pred:0.020267421379685402, decouple_loss:0.010550064034759998
The generated pressure mean: 0.4416966438293457
loss_pred:0.019213523715734482, decouple_loss:0.010575017891824245
Iteration: 2592, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4427185356616974
loss_pred:0.020154235884547234, decouple_loss:0.008464879356324673
The generated pressure mean: 0.43801674246788025
loss_pred:0.01977471634745598, decouple_loss:0.008423509076237679
The generated pressure mean: 0.44171950221061707
loss_pred:0.01920217089354992, decouple_loss:0.008704649284482002
Iteration: 2593, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44493886828422546
loss_pred:0.020894525572657585, decouple_loss:0.008699683472514153
The generated pressure mean: 0.44883161783218384
loss_pred:0.021472245454788208, decouple_loss:0.00870850682258606
The generated pressure mean: 0.4432925581932068
loss_pred:0.021232005208730698, decouple_loss:0.008520455099642277
Iteration: 2594, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4440957307815552
loss_pred:0.020910056307911873, decouple_loss:0.01006072387099266
The generated pressure mean: 0.4476761817932129
loss_pred:0.020058870315551758, decouple_loss:0.009981079027056694
The generated pressure mean: 0.44562262296676636
loss_pred:0.020962709560990334, decouple_loss:0.0100422827526927
Iteration: 2595, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504050314426422
loss_pred:0.02126641757786274, decouple_loss:0.008305316790938377
The generated pressure mean: 0.4509066045284271
loss_pred:0.020586945116519928, decouple_loss:0.008201932534575462
The generated pressure mean: 0.45028042793273926
loss_pred:0.020793912932276726, decouple_loss:0.008283041417598724
Iteration: 2596, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4553565979003906
loss_pred:0.02156086266040802, decouple_loss:0.008514183573424816
The generated pressure mean: 0.44818854331970215
loss_pred:0.020238490775227547, decouple_loss:0.008417855948209763
The generated pressure mean: 0.4558042585849762
loss_pred:0.020371530205011368, decouple_loss:0.008464008569717407
Iteration: 2597, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4528396725654602
loss_pred:0.020894262939691544, decouple_loss:0.008662858046591282
The generated pressure mean: 0.4513215124607086
loss_pred:0.020610803738236427, decouple_loss:0.00859746988862753
The generated pressure mean: 0.45255565643310547
loss_pred:0.01958935335278511, decouple_loss:0.008509892970323563
Iteration: 2598, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.421635240316391
loss_pred:0.019762733951210976, decouple_loss:0.009597430005669594
The generated pressure mean: 0.4262402355670929
loss_pred:0.01975920982658863, decouple_loss:0.009378474205732346
The generated pressure mean: 0.43254098296165466
loss_pred:0.02024848386645317, decouple_loss:0.009487420320510864
Iteration: 2599, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477781057357788
loss_pred:0.020931590348482132, decouple_loss:0.01008516363799572
The generated pressure mean: 0.4454098641872406
The generated pressure mean: 0.4493987262248993
loss_pred:0.020753517746925354, decouple_loss:0.009933900088071823
loss_pred:0.020561056211590767, decouple_loss:0.009895073249936104
Iteration: 2600, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508814513683319
loss_pred:0.01959623582661152, decouple_loss:0.008553523570299149
The generated pressure mean: 0.4488740563392639
loss_pred:0.019829612225294113, decouple_loss:0.008531235158443451
The generated pressure mean: 0.44860386848449707
loss_pred:0.021257255226373672, decouple_loss:0.008743937127292156
2023-04-16 21:56:32 testing...
The generated pressure mean: 0.41371485590934753
The generated pressure mean: 0.41961199045181274
The generated pressure mean: 0.422313392162323
loss_pred:0.03264174610376358, decouple_loss:0.008586760610342026
loss_pred:0.03146824985742569, decouple_loss:0.008752056397497654
loss_pred:0.031225599348545074, decouple_loss:0.008829987607896328
WV_0_PC_0_EH_1_PS_40, loss: 0.032214678823947906, avg_mse: 0.045700930058956146
current test mse: 0.045701
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 2601, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4539552330970764
loss_pred:0.022411933168768883, decouple_loss:0.008096296340227127
The generated pressure mean: 0.455508291721344
The generated pressure mean: 0.45460018515586853
loss_pred:0.02033293806016445, decouple_loss:0.008066757582128048
loss_pred:0.020613037049770355, decouple_loss:0.008172028698027134
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2602, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44547462463378906
loss_pred:0.02016523852944374, decouple_loss:0.008091598749160767
The generated pressure mean: 0.4458143711090088
loss_pred:0.02081327699124813, decouple_loss:0.007976531982421875
The generated pressure mean: 0.4456959366798401
loss_pred:0.020471561700105667, decouple_loss:0.007999559864401817
Iteration: 2603, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4365256428718567
loss_pred:0.022374575957655907, decouple_loss:0.008355909027159214
The generated pressure mean: 0.4432339370250702
loss_pred:0.021107684820890427, decouple_loss:0.008170818910002708
The generated pressure mean: 0.43968358635902405
loss_pred:0.02030039392411709, decouple_loss:0.008132307790219784
Iteration: 2604, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4392335116863251
loss_pred:0.019478457048535347, decouple_loss:0.009002055041491985
The generated pressure mean: 0.4414944648742676
loss_pred:0.02056925930082798, decouple_loss:0.009022671729326248
The generated pressure mean: 0.4435056447982788
loss_pred:0.019857089966535568, decouple_loss:0.008967171423137188
Iteration: 2605, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45489025115966797
loss_pred:0.02049608901143074, decouple_loss:0.008879453875124454
The generated pressure mean: 0.45737090706825256
loss_pred:0.020807018503546715, decouple_loss:0.008770233020186424
The generated pressure mean: 0.4595319628715515
loss_pred:0.022078469395637512, decouple_loss:0.008813099004328251
Iteration: 2606, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4519982635974884
loss_pred:0.021958982571959496, decouple_loss:0.008553456515073776
The generated pressure mean: 0.4453462064266205
The generated pressure mean: 0.4448881447315216loss_pred:0.019937997683882713, decouple_loss:0.00849057361483574
loss_pred:0.020588602870702744, decouple_loss:0.008567522279918194
Iteration: 2607, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4436260163784027
loss_pred:0.02118750289082527, decouple_loss:0.008029641583561897
The generated pressure mean: 0.44691190123558044
loss_pred:0.021065132692456245, decouple_loss:0.007985712960362434
The generated pressure mean: 0.4403824508190155
loss_pred:0.020543059334158897, decouple_loss:0.008262339979410172
Iteration: 2608, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44266805052757263
The generated pressure mean: 0.4455297887325287
loss_pred:0.021647635847330093, decouple_loss:0.008705731481313705
loss_pred:0.020177247002720833, decouple_loss:0.008675378747284412
The generated pressure mean: 0.44748663902282715
loss_pred:0.020096750929951668, decouple_loss:0.008581471629440784
Iteration: 2609, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483858346939087
loss_pred:0.019410664215683937, decouple_loss:0.008183816447854042
The generated pressure mean: 0.44674253463745117
loss_pred:0.02065478079020977, decouple_loss:0.008176115341484547
The generated pressure mean: 0.4487713575363159
loss_pred:0.020932162180542946, decouple_loss:0.008206886239349842
Iteration: 2610, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45386090874671936
loss_pred:0.02158982865512371, decouple_loss:0.008450152352452278
The generated pressure mean: 0.45108920335769653
loss_pred:0.023246074095368385, decouple_loss:0.00827571377158165
The generated pressure mean: 0.4520857334136963
loss_pred:0.01998957246541977, decouple_loss:0.00823790393769741
2023-04-16 21:59:04 testing...
The generated pressure mean: 0.41862958669662476
The generated pressure mean: 0.4241317808628082
loss_pred:0.03154216706752777, decouple_loss:0.009450198151171207
The generated pressure mean: 0.4269443452358246
loss_pred:0.030530203133821487, decouple_loss:0.009609229862689972
loss_pred:0.030210604891180992, decouple_loss:0.009718958288431168
WV_0_PC_0_EH_1_PS_40, loss: 0.03124063089489937, avg_mse: 0.04402080923318863
current test mse: 0.044021
Iteration: 2611, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43264463543891907
loss_pred:0.021333636716008186, decouple_loss:0.008692585863173008
The generated pressure mean: 0.4380790591239929
loss_pred:0.019989579916000366, decouple_loss:0.00875831488519907
The generated pressure mean: 0.4320853054523468
loss_pred:0.02101181261241436, decouple_loss:0.008939840830862522
Iteration: 2612, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44832390546798706
loss_pred:0.02026420086622238, decouple_loss:0.008931807242333889
The generated pressure mean: 0.44804316759109497
loss_pred:0.02094358764588833, decouple_loss:0.00885231327265501
The generated pressure mean: 0.44801977276802063
loss_pred:0.02027633786201477, decouple_loss:0.008987270295619965
Iteration: 2613, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45295238494873047
loss_pred:0.019602658227086067, decouple_loss:0.00885183084756136
The generated pressure mean: 0.4593348801136017
loss_pred:0.02131124772131443, decouple_loss:0.00888627115637064
The generated pressure mean: 0.4568875730037689
loss_pred:0.020359404385089874, decouple_loss:0.009021302685141563
Iteration: 2614, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44008132815361023
loss_pred:0.02150977961719036, decouple_loss:0.008287417702376842
The generated pressure mean: 0.43851226568222046
loss_pred:0.021095572039484978, decouple_loss:0.008188777603209019
The generated pressure mean: 0.4381558299064636
loss_pred:0.02312135137617588, decouple_loss:0.008227811194956303
Iteration: 2615, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44718053936958313
loss_pred:0.021080855280160904, decouple_loss:0.008472194895148277
The generated pressure mean: 0.44342541694641113
loss_pred:0.021287523210048676, decouple_loss:0.008444929495453835
The generated pressure mean: 0.44771310687065125
loss_pred:0.0204012468457222, decouple_loss:0.00836123526096344
Iteration: 2616, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45321890711784363
loss_pred:0.020953936502337456, decouple_loss:0.009885169565677643
The generated pressure mean: 0.4525476098060608
loss_pred:0.02199862152338028, decouple_loss:0.009975027292966843
The generated pressure mean: 0.455697238445282
loss_pred:0.020884180441498756, decouple_loss:0.009917405433952808
Iteration: 2617, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4447343051433563
loss_pred:0.020125480368733406, decouple_loss:0.009187430143356323
The generated pressure mean: 0.44266730546951294
loss_pred:0.020125916227698326, decouple_loss:0.008969513699412346
The generated pressure mean: 0.4472608268260956
loss_pred:0.021284934133291245, decouple_loss:0.009209176525473595
Iteration: 2618, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449990391731262
loss_pred:0.022181924432516098, decouple_loss:0.009432530030608177
The generated pressure mean: 0.4463016390800476
loss_pred:0.02013017050921917, decouple_loss:0.009378228336572647
The generated pressure mean: 0.44528838992118835
loss_pred:0.0200020931661129, decouple_loss:0.009286493062973022
Iteration: 2619, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44724801182746887
The generated pressure mean: 0.4436429738998413
loss_pred:0.020508309826254845, decouple_loss:0.008241638541221619
loss_pred:0.02000574581325054, decouple_loss:0.008451650850474834
The generated pressure mean: 0.4430979788303375
loss_pred:0.022991744801402092, decouple_loss:0.008296596817672253
Iteration: 2620, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44277501106262207
loss_pred:0.020564530044794083, decouple_loss:0.008156425319612026
The generated pressure mean: 0.44862115383148193
loss_pred:0.018879622220993042, decouple_loss:0.008308119140565395
The generated pressure mean: 0.4450356364250183
loss_pred:0.02000342682003975, decouple_loss:0.008133317343890667
2023-04-16 22:00:57 testing...
The generated pressure mean: 0.41514891386032104
The generated pressure mean: 0.4210353493690491
The generated pressure mean: 0.42322278022766113
loss_pred:0.031989626586437225, decouple_loss:0.008129846304655075
loss_pred:0.031041745096445084, decouple_loss:0.008320949971675873
loss_pred:0.030609173700213432, decouple_loss:0.008417507633566856
WV_0_PC_0_EH_1_PS_40, loss: 0.03162799030542374, avg_mse: 0.04465934634208679
current test mse: 0.044659
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 2621, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501849114894867
loss_pred:0.01997905783355236, decouple_loss:0.007801641710102558
The generated pressure mean: 0.4483541250228882
The generated pressure mean: 0.45072680711746216
loss_pred:0.02035987749695778, decouple_loss:0.007744231726974249
loss_pred:0.019989196211099625, decouple_loss:0.007750636897981167
Iteration: 2622, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44435006380081177
The generated pressure mean: 0.4500339925289154
loss_pred:0.01967473328113556, decouple_loss:0.00767318531870842
loss_pred:0.019944511353969574, decouple_loss:0.007840602658689022
The generated pressure mean: 0.44524437189102173
loss_pred:0.022187329828739166, decouple_loss:0.007588808424770832
Iteration: 2623, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4512454867362976
loss_pred:0.0207721758633852, decouple_loss:0.008768959902226925
The generated pressure mean: 0.44835588335990906
loss_pred:0.021175701171159744, decouple_loss:0.008731032721698284
The generated pressure mean: 0.44655081629753113
loss_pred:0.021024437621235847, decouple_loss:0.008853919804096222
Iteration: 2624, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462405741214752
The generated pressure mean: 0.44825461506843567
loss_pred:0.019856350496411324, decouple_loss:0.009545119479298592
loss_pred:0.018884597346186638, decouple_loss:0.00953737273812294
The generated pressure mean: 0.4470842480659485
loss_pred:0.019923893734812737, decouple_loss:0.009515325538814068
Iteration: 2625, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4443989098072052
loss_pred:0.021803682669997215, decouple_loss:0.008314553648233414
The generated pressure mean: 0.44607165455818176
loss_pred:0.020272640511393547, decouple_loss:0.008242872543632984
The generated pressure mean: 0.4440484642982483
loss_pred:0.020932620391249657, decouple_loss:0.008248090744018555
Iteration: 2626, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4448191821575165
The generated pressure mean: 0.4394895136356354
loss_pred:0.019897889345884323, decouple_loss:0.007980981841683388
loss_pred:0.021395660936832428, decouple_loss:0.008104516193270683
The generated pressure mean: 0.4387720227241516
loss_pred:0.021185265854001045, decouple_loss:0.007946090772747993
Iteration: 2627, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45164525508880615
The generated pressure mean: 0.4502775967121124
loss_pred:0.021421121433377266, decouple_loss:0.008169503882527351
loss_pred:0.019011233001947403, decouple_loss:0.00812562182545662
The generated pressure mean: 0.45111584663391113
loss_pred:0.020912736654281616, decouple_loss:0.008128928951919079
Iteration: 2628, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4596376121044159
loss_pred:0.019716067239642143, decouple_loss:0.009529249742627144
The generated pressure mean: 0.4581572711467743
loss_pred:0.019697412848472595, decouple_loss:0.009452126920223236
The generated pressure mean: 0.4563344120979309
loss_pred:0.020071571692824364, decouple_loss:0.009639774449169636
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2629, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501699209213257
loss_pred:0.019691910594701767, decouple_loss:0.00905781239271164
The generated pressure mean: 0.44502949714660645
loss_pred:0.01877707615494728, decouple_loss:0.009128292091190815
The generated pressure mean: 0.44699034094810486
loss_pred:0.020014768466353416, decouple_loss:0.008970911614596844
Iteration: 2630, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44313108921051025
loss_pred:0.020713914185762405, decouple_loss:0.00805563572794199
The generated pressure mean: 0.4411930441856384
loss_pred:0.02105216681957245, decouple_loss:0.008029039949178696
The generated pressure mean: 0.43571737408638
loss_pred:0.023294370621442795, decouple_loss:0.008056219667196274
2023-04-16 22:03:34 testing...
The generated pressure mean: 0.42451122403144836
The generated pressure mean: 0.4188620448112488
The generated pressure mean: 0.4267738163471222
loss_pred:0.030605651438236237, decouple_loss:0.01040981337428093
loss_pred:0.0318927988409996, decouple_loss:0.010172795504331589
loss_pred:0.030519237741827965, decouple_loss:0.010494410991668701
WV_0_PC_0_EH_1_PS_40, loss: 0.031523846089839935, avg_mse: 0.044160146266222
current test mse: 0.04416
Iteration: 2631, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.436903715133667
loss_pred:0.021231571212410927, decouple_loss:0.00986636895686388
The generated pressure mean: 0.4383540451526642
loss_pred:0.020421113818883896, decouple_loss:0.009754759259521961
The generated pressure mean: 0.43366333842277527
loss_pred:0.020235281437635422, decouple_loss:0.009908469393849373
Iteration: 2632, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4552944600582123
loss_pred:0.0201761182397604, decouple_loss:0.009631886146962643
The generated pressure mean: 0.4476039409637451
loss_pred:0.020321719348430634, decouple_loss:0.009533529169857502
The generated pressure mean: 0.45757386088371277
loss_pred:0.019603896886110306, decouple_loss:0.009637976065278053
Iteration: 2633, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4623064696788788
loss_pred:0.01991361193358898, decouple_loss:0.008737928234040737
The generated pressure mean: 0.4577109217643738
loss_pred:0.02054630033671856, decouple_loss:0.008688653819262981
The generated pressure mean: 0.4596576392650604
loss_pred:0.019996115937829018, decouple_loss:0.0086700189858675
Iteration: 2634, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449297159910202
loss_pred:0.02024436555802822, decouple_loss:0.0101283248513937
The generated pressure mean: 0.4397459626197815
loss_pred:0.01958007551729679, decouple_loss:0.01005630474537611
The generated pressure mean: 0.44551411271095276
loss_pred:0.020748784765601158, decouple_loss:0.010115299373865128
Iteration: 2635, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44151076674461365
The generated pressure mean: 0.43993115425109863loss_pred:0.020066222175955772, decouple_loss:0.01011374406516552
loss_pred:0.021845946088433266, decouple_loss:0.010102611966431141
The generated pressure mean: 0.4378069341182709
loss_pred:0.020562438294291496, decouple_loss:0.009970160201191902
Iteration: 2636, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449405699968338
loss_pred:0.01981523260474205, decouple_loss:0.009614861570298672
The generated pressure mean: 0.45428842306137085
loss_pred:0.0206719059497118, decouple_loss:0.009412458166480064
The generated pressure mean: 0.4494611620903015
loss_pred:0.019578564912080765, decouple_loss:0.009504066780209541
Iteration: 2637, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464527666568756
loss_pred:0.01999984309077263, decouple_loss:0.008943201042711735
The generated pressure mean: 0.44728994369506836
loss_pred:0.021744724363088608, decouple_loss:0.008867768570780754
The generated pressure mean: 0.44087713956832886
loss_pred:0.019562823697924614, decouple_loss:0.008859475143253803
Iteration: 2638, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.450125515460968
loss_pred:0.01958277076482773, decouple_loss:0.009512636810541153
The generated pressure mean: 0.4483310878276825
loss_pred:0.01935332641005516, decouple_loss:0.009743181057274342
The generated pressure mean: 0.4439990520477295
loss_pred:0.019295750185847282, decouple_loss:0.009548335336148739
Iteration: 2639, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497238099575043
loss_pred:0.019493725150823593, decouple_loss:0.008599377237260342
The generated pressure mean: 0.44932934641838074
loss_pred:0.020132014527916908, decouple_loss:0.008562369272112846
The generated pressure mean: 0.45065227150917053
loss_pred:0.021258601918816566, decouple_loss:0.008635961450636387
Iteration: 2640, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4538138806819916
loss_pred:0.021116506308317184, decouple_loss:0.007876741699874401
The generated pressure mean: 0.45145970582962036
loss_pred:0.020663611590862274, decouple_loss:0.007953554391860962
The generated pressure mean: 0.4437221884727478
loss_pred:0.020676152780652046, decouple_loss:0.007860427722334862
2023-04-16 22:05:28 testing...
The generated pressure mean: 0.41701850295066833
The generated pressure mean: 0.42277345061302185
The generated pressure mean: 0.42539528012275696
loss_pred:0.03168945759534836, decouple_loss:0.010308402590453625
loss_pred:0.030810441821813583, decouple_loss:0.010451587848365307
loss_pred:0.03027968481183052, decouple_loss:0.010569089092314243
WV_0_PC_0_EH_1_PS_40, loss: 0.03144868090748787, avg_mse: 0.044229090213775635
current test mse: 0.044229
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 2641, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43965739011764526
loss_pred:0.01971261575818062, decouple_loss:0.009670420549809933
The generated pressure mean: 0.4398128092288971
loss_pred:0.01856250688433647, decouple_loss:0.009804446250200272
The generated pressure mean: 0.44588950276374817
loss_pred:0.019600413739681244, decouple_loss:0.009666734375059605
Iteration: 2642, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44632673263549805
loss_pred:0.022039195522665977, decouple_loss:0.009163273498415947
The generated pressure mean: 0.44760870933532715
loss_pred:0.018774034455418587, decouple_loss:0.009163733571767807
The generated pressure mean: 0.45139530301094055
loss_pred:0.018833337351679802, decouple_loss:0.00919853150844574
Iteration: 2643, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4406551420688629
loss_pred:0.02109631523489952, decouple_loss:0.0077317445538938046
The generated pressure mean: 0.44739654660224915
loss_pred:0.019612764939665794, decouple_loss:0.007656978443264961
The generated pressure mean: 0.4405192732810974
loss_pred:0.019709864631295204, decouple_loss:0.007750862278044224
Iteration: 2644, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44443953037261963
loss_pred:0.01964750699698925, decouple_loss:0.009898344986140728
The generated pressure mean: 0.44185835123062134
loss_pred:0.02019370160996914, decouple_loss:0.009902503341436386
The generated pressure mean: 0.4460732936859131
loss_pred:0.018654221668839455, decouple_loss:0.00985860824584961
Iteration: 2645, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44771409034729004
loss_pred:0.020598746836185455, decouple_loss:0.01002527866512537
The generated pressure mean: 0.4474959075450897
loss_pred:0.021380841732025146, decouple_loss:0.009947683662176132
The generated pressure mean: 0.44962620735168457
loss_pred:0.01956956461071968, decouple_loss:0.009943690150976181
Iteration: 2646, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45080867409706116
loss_pred:0.019977126270532608, decouple_loss:0.008915743790566921
The generated pressure mean: 0.44874706864356995
The generated pressure mean: 0.4463951289653778
loss_pred:0.02012799121439457, decouple_loss:0.008704359643161297
loss_pred:0.02020183950662613, decouple_loss:0.008817583322525024
Iteration: 2647, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4572668969631195
loss_pred:0.020144499838352203, decouple_loss:0.007722485810518265
The generated pressure mean: 0.45732784271240234
loss_pred:0.019982941448688507, decouple_loss:0.007751176133751869
The generated pressure mean: 0.45483604073524475
loss_pred:0.019215723499655724, decouple_loss:0.007765514310449362
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2648, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4392739236354828
The generated pressure mean: 0.43835386633872986
loss_pred:0.020776644349098206, decouple_loss:0.008596992120146751
loss_pred:0.019572068005800247, decouple_loss:0.008616357110440731
The generated pressure mean: 0.43760016560554504
loss_pred:0.0219399593770504, decouple_loss:0.008771919645369053
Iteration: 2649, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4375685453414917
loss_pred:0.01970050483942032, decouple_loss:0.008747076615691185
The generated pressure mean: 0.436306893825531
loss_pred:0.020568860694766045, decouple_loss:0.008700758218765259
The generated pressure mean: 0.43753981590270996
loss_pred:0.02226581797003746, decouple_loss:0.00890143122524023
Iteration: 2650, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461763799190521
The generated pressure mean: 0.44660329818725586
loss_pred:0.02027609385550022, decouple_loss:0.009274383075535297
loss_pred:0.019747186452150345, decouple_loss:0.009329074993729591
The generated pressure mean: 0.45079484581947327
loss_pred:0.02232484333217144, decouple_loss:0.009301135316491127
2023-04-16 22:08:00 testing...
The generated pressure mean: 0.41418516635894775
The generated pressure mean: 0.4193718731403351
loss_pred:0.03249470144510269, decouple_loss:0.009489631280303001
The generated pressure mean: 0.4219633936882019
loss_pred:0.03128697723150253, decouple_loss:0.009585189633071423
loss_pred:0.031019672751426697, decouple_loss:0.009701943024992943
WV_0_PC_0_EH_1_PS_40, loss: 0.032080065459012985, avg_mse: 0.04539818316698074
current test mse: 0.045398
Iteration: 2651, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4527814984321594
loss_pred:0.019648076966404915, decouple_loss:0.009088650345802307
The generated pressure mean: 0.44916102290153503
loss_pred:0.020106205716729164, decouple_loss:0.0090737110003829
The generated pressure mean: 0.454235702753067
loss_pred:0.01989336498081684, decouple_loss:0.009025389328598976
Iteration: 2652, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45309415459632874
loss_pred:0.019368229433894157, decouple_loss:0.00893054623156786
The generated pressure mean: 0.45651283860206604
loss_pred:0.020523229613900185, decouple_loss:0.008815628476440907
The generated pressure mean: 0.45738229155540466
loss_pred:0.01978427544236183, decouple_loss:0.008791541680693626
Iteration: 2653, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4384683668613434
loss_pred:0.020316703245043755, decouple_loss:0.00785713829100132
The generated pressure mean: 0.4453805983066559
loss_pred:0.020662514492869377, decouple_loss:0.007722781039774418
The generated pressure mean: 0.4412968158721924
loss_pred:0.021695559844374657, decouple_loss:0.00775868771597743
Iteration: 2654, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4438233971595764
loss_pred:0.02053488790988922, decouple_loss:0.008247166872024536
The generated pressure mean: 0.44233039021492004
loss_pred:0.019978661090135574, decouple_loss:0.008368488401174545
The generated pressure mean: 0.44449523091316223
loss_pred:0.019010325893759727, decouple_loss:0.008176298812031746
Iteration: 2655, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4436253309249878
loss_pred:0.018889864906668663, decouple_loss:0.00859332550317049
The generated pressure mean: 0.4462113082408905
loss_pred:0.01975320652127266, decouple_loss:0.00848026666790247
The generated pressure mean: 0.44515737891197205
loss_pred:0.019335942342877388, decouple_loss:0.008732055313885212
Iteration: 2656, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4410860538482666
loss_pred:0.020192552357912064, decouple_loss:0.008877575397491455
The generated pressure mean: 0.44886961579322815
loss_pred:0.019642462953925133, decouple_loss:0.00879516452550888
The generated pressure mean: 0.44964900612831116
loss_pred:0.01881580241024494, decouple_loss:0.008801142685115337
Iteration: 2657, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44214168190956116
loss_pred:0.019536832347512245, decouple_loss:0.008162317797541618
The generated pressure mean: 0.4481969177722931
loss_pred:0.020965635776519775, decouple_loss:0.008136749267578125
The generated pressure mean: 0.45265933871269226
loss_pred:0.01928718015551567, decouple_loss:0.00821199081838131
Iteration: 2658, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4513131082057953
loss_pred:0.01911124773323536, decouple_loss:0.007983335293829441
The generated pressure mean: 0.4488270878791809The generated pressure mean: 0.44319888949394226
loss_pred:0.021869247779250145, decouple_loss:0.00819036178290844loss_pred:0.019804833456873894, decouple_loss:0.008001432754099369
Iteration: 2659, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4435632824897766
The generated pressure mean: 0.45033031702041626
loss_pred:0.019308850169181824, decouple_loss:0.008814075030386448
loss_pred:0.019510773941874504, decouple_loss:0.008924972265958786
The generated pressure mean: 0.4466278553009033
loss_pred:0.0213935449719429, decouple_loss:0.008893650956451893
Iteration: 2660, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4544481635093689
The generated pressure mean: 0.44957098364830017
loss_pred:0.02082681842148304, decouple_loss:0.009398376569151878
loss_pred:0.01987091451883316, decouple_loss:0.009323511272668839
The generated pressure mean: 0.4506647288799286
loss_pred:0.020101303234696388, decouple_loss:0.009470323100686073
2023-04-16 22:09:53 testing...
The generated pressure mean: 0.42394742369651794
The generated pressure mean: 0.4178166687488556
The generated pressure mean: 0.4265080988407135
loss_pred:0.03097989782691002, decouple_loss:0.009169753640890121
loss_pred:0.03224581480026245, decouple_loss:0.008938904851675034
loss_pred:0.030689815059304237, decouple_loss:0.009326945059001446
WV_0_PC_0_EH_1_PS_40, loss: 0.03176243603229523, avg_mse: 0.04536794126033783
current test mse: 0.045368
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 2661, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4405318796634674
loss_pred:0.02230198122560978, decouple_loss:0.008849394507706165
The generated pressure mean: 0.4462330937385559
loss_pred:0.020586540922522545, decouple_loss:0.008732310496270657
The generated pressure mean: 0.4404332637786865
loss_pred:0.021749718114733696, decouple_loss:0.008769990876317024
Iteration: 2662, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43490225076675415
loss_pred:0.020409785211086273, decouple_loss:0.00857547577470541
The generated pressure mean: 0.4396454095840454
loss_pred:0.02083265222609043, decouple_loss:0.008427278138697147
The generated pressure mean: 0.44063085317611694
loss_pred:0.022090142592787743, decouple_loss:0.008704200387001038
Iteration: 2663, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.450605571269989
loss_pred:0.020861567929387093, decouple_loss:0.0081934267655015
The generated pressure mean: 0.44424593448638916
loss_pred:0.02059905044734478, decouple_loss:0.008137370459735394
The generated pressure mean: 0.4424517750740051
loss_pred:0.02041517198085785, decouple_loss:0.008139041252434254
Iteration: 2664, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45777255296707153
loss_pred:0.0202649999409914, decouple_loss:0.007821164093911648
The generated pressure mean: 0.4545055329799652
loss_pred:0.019519886001944542, decouple_loss:0.0075943442061543465
The generated pressure mean: 0.45572105050086975
loss_pred:0.021367670968174934, decouple_loss:0.00749747920781374
Iteration: 2665, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4518263339996338
loss_pred:0.022343698889017105, decouple_loss:0.00850344356149435
The generated pressure mean: 0.44947749376296997
loss_pred:0.0209099929779768, decouple_loss:0.008316857740283012
The generated pressure mean: 0.4503544867038727
loss_pred:0.020038779824972153, decouple_loss:0.008458251133561134
Iteration: 2666, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4416724741458893
loss_pred:0.023395035415887833, decouple_loss:0.008971906267106533
The generated pressure mean: 0.4419422447681427
loss_pred:0.020853931084275246, decouple_loss:0.009091440588235855
The generated pressure mean: 0.4403746426105499
loss_pred:0.02103276364505291, decouple_loss:0.009208939969539642
Iteration: 2667, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488009810447693
loss_pred:0.0234634131193161, decouple_loss:0.009905525483191013
The generated pressure mean: 0.44489288330078125
The generated pressure mean: 0.44690194725990295
loss_pred:0.022110402584075928, decouple_loss:0.009828003123402596
loss_pred:0.019785206764936447, decouple_loss:0.009874137118458748
Iteration: 2668, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44330018758773804
loss_pred:0.020750895142555237, decouple_loss:0.008137964643537998
The generated pressure mean: 0.44416379928588867
The generated pressure mean: 0.4417257010936737
loss_pred:0.021099627017974854, decouple_loss:0.00817887019366026
loss_pred:0.02080417610704899, decouple_loss:0.008232379332184792
Iteration: 2669, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.454599529504776
loss_pred:0.02190418913960457, decouple_loss:0.008465848863124847
The generated pressure mean: 0.4526519477367401
loss_pred:0.02041526883840561, decouple_loss:0.008177033625543118
The generated pressure mean: 0.45473870635032654
loss_pred:0.020660851150751114, decouple_loss:0.008273006416857243
Iteration: 2670, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4514550566673279
loss_pred:0.01966848224401474, decouple_loss:0.00921755749732256
The generated pressure mean: 0.44485270977020264
loss_pred:0.020250719040632248, decouple_loss:0.009173247031867504
The generated pressure mean: 0.4453733265399933
loss_pred:0.0213567316532135, decouple_loss:0.009321950376033783
2023-04-16 22:12:21 testing...
The generated pressure mean: 0.4164271056652069
The generated pressure mean: 0.42342638969421387
The generated pressure mean: 0.4259909391403198
loss_pred:0.03275527060031891, decouple_loss:0.009275181218981743
loss_pred:0.03165499493479729, decouple_loss:0.009321293793618679
loss_pred:0.030940277501940727, decouple_loss:0.009420414455235004
WV_0_PC_0_EH_1_PS_40, loss: 0.03225046396255493, avg_mse: 0.046454932540655136
current test mse: 0.046455
Iteration: 2671, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4399176836013794
loss_pred:0.021006783470511436, decouple_loss:0.008627342991530895
The generated pressure mean: 0.44024622440338135
loss_pred:0.022034181281924248, decouple_loss:0.0086731081828475
The generated pressure mean: 0.44212019443511963
loss_pred:0.020400676876306534, decouple_loss:0.008751814253628254
Iteration: 2672, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44293901324272156
loss_pred:0.02014675922691822, decouple_loss:0.007991518825292587
The generated pressure mean: 0.4416598379611969
loss_pred:0.02008621208369732, decouple_loss:0.008029096759855747
The generated pressure mean: 0.4407937824726105
loss_pred:0.020148368552327156, decouple_loss:0.00788110587745905
Iteration: 2673, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45008617639541626
loss_pred:0.020365778356790543, decouple_loss:0.007797844707965851
The generated pressure mean: 0.45066896080970764
loss_pred:0.020721448585391045, decouple_loss:0.007727622054517269
The generated pressure mean: 0.4494708478450775
loss_pred:0.020448414608836174, decouple_loss:0.007608442567288876
Iteration: 2674, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4621739387512207
loss_pred:0.021410662680864334, decouple_loss:0.008374594151973724
The generated pressure mean: 0.45230597257614136
loss_pred:0.019898969680070877, decouple_loss:0.008084259927272797
The generated pressure mean: 0.45549240708351135
loss_pred:0.02024812437593937, decouple_loss:0.008022424764931202
Iteration: 2675, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4412628710269928
loss_pred:0.022046318277716637, decouple_loss:0.008418647572398186
The generated pressure mean: 0.44122371077537537
loss_pred:0.021068239584565163, decouple_loss:0.008454680442810059
The generated pressure mean: 0.4504722058773041
loss_pred:0.02195153199136257, decouple_loss:0.008484059944748878
Iteration: 2676, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43689942359924316
loss_pred:0.019131070002913475, decouple_loss:0.007741288747638464
The generated pressure mean: 0.43699297308921814
loss_pred:0.023091400042176247, decouple_loss:0.007808612659573555
The generated pressure mean: 0.43840062618255615
loss_pred:0.02222631312906742, decouple_loss:0.007799503393471241
Iteration: 2677, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4438563287258148
loss_pred:0.021464427933096886, decouple_loss:0.008313337340950966
The generated pressure mean: 0.4423676133155823
loss_pred:0.020353905856609344, decouple_loss:0.008078943006694317
The generated pressure mean: 0.4467182159423828
loss_pred:0.019992053508758545, decouple_loss:0.008353709243237972
Iteration: 2678, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45286282896995544
loss_pred:0.021326832473278046, decouple_loss:0.008038164116442204
The generated pressure mean: 0.45437976717948914
loss_pred:0.020763861015439034, decouple_loss:0.008092567324638367
The generated pressure mean: 0.44797271490097046
loss_pred:0.022374186664819717, decouple_loss:0.008101942017674446
Iteration: 2679, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463541805744171
loss_pred:0.02032521739602089, decouple_loss:0.00854822900146246
The generated pressure mean: 0.44639456272125244
loss_pred:0.01981547474861145, decouple_loss:0.008527119643986225
The generated pressure mean: 0.45013678073883057
loss_pred:0.021237296983599663, decouple_loss:0.008891538716852665
Iteration: 2680, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504421353340149
loss_pred:0.020359890535473824, decouple_loss:0.008777191862463951
The generated pressure mean: 0.4428503215312958
loss_pred:0.020214326679706573, decouple_loss:0.008786750957369804
The generated pressure mean: 0.44487330317497253
loss_pred:0.020582227036356926, decouple_loss:0.008808188140392303
2023-04-16 22:14:13 testing...
The generated pressure mean: 0.4151999056339264
The generated pressure mean: 0.4213086664676666
The generated pressure mean: 0.42396020889282227
loss_pred:0.032946646213531494, decouple_loss:0.00861970242112875
loss_pred:0.03208264708518982, decouple_loss:0.008731559850275517
loss_pred:0.031503621488809586, decouple_loss:0.008944161236286163
WV_0_PC_0_EH_1_PS_40, loss: 0.03261589631438255, avg_mse: 0.04708358272910118
current test mse: 0.047084
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 2681, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4516371190547943
loss_pred:0.01928708329796791, decouple_loss:0.008566619828343391
The generated pressure mean: 0.45077067613601685
The generated pressure mean: 0.4559098780155182
loss_pred:0.0205225870013237, decouple_loss:0.008511150255799294
loss_pred:0.02039135806262493, decouple_loss:0.008742017671465874
Iteration: 2682, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44301334023475647
loss_pred:0.01950986683368683, decouple_loss:0.007741949521005154
The generated pressure mean: 0.44433364272117615
loss_pred:0.019986076280474663, decouple_loss:0.007909285835921764The generated pressure mean: 0.44829320907592773
loss_pred:0.022028977051377296, decouple_loss:0.007692534476518631
Iteration: 2683, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4303637742996216
loss_pred:0.020218152552843094, decouple_loss:0.008060223422944546
The generated pressure mean: 0.4321881830692291
loss_pred:0.01890716142952442, decouple_loss:0.008097278885543346
The generated pressure mean: 0.4264277219772339
loss_pred:0.02021751180291176, decouple_loss:0.00821708608418703
Iteration: 2684, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484545886516571
loss_pred:0.02064969576895237, decouple_loss:0.008458225056529045
The generated pressure mean: 0.4491833448410034
loss_pred:0.019939638674259186, decouple_loss:0.008493902161717415
The generated pressure mean: 0.44096803665161133
loss_pred:0.0191754512488842, decouple_loss:0.008585335686802864
Iteration: 2685, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4597262144088745
The generated pressure mean: 0.46608585119247437
loss_pred:0.020376674830913544, decouple_loss:0.008960056118667126
loss_pred:0.020229436457157135, decouple_loss:0.008944975212216377
The generated pressure mean: 0.4571974575519562
loss_pred:0.018599046394228935, decouple_loss:0.008809298276901245
Iteration: 2686, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4579103887081146
loss_pred:0.022258326411247253, decouple_loss:0.008431940339505672
The generated pressure mean: 0.45627516508102417
loss_pred:0.020191607996821404, decouple_loss:0.008501432836055756
The generated pressure mean: 0.4519452750682831
loss_pred:0.020711401477456093, decouple_loss:0.008368851616978645
Iteration: 2687, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4310942590236664
loss_pred:0.020900661125779152, decouple_loss:0.008248673751950264
The generated pressure mean: 0.42851099371910095
loss_pred:0.019828591495752335, decouple_loss:0.008206031285226345
The generated pressure mean: 0.4305543303489685
loss_pred:0.020291728898882866, decouple_loss:0.008252901025116444
Iteration: 2688, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464855194091797
loss_pred:0.020581653341650963, decouple_loss:0.008776889182627201
The generated pressure mean: 0.4433440864086151
loss_pred:0.02015692926943302, decouple_loss:0.008864051662385464
The generated pressure mean: 0.44077983498573303
loss_pred:0.021950284019112587, decouple_loss:0.008992256596684456
Iteration: 2689, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45240962505340576
loss_pred:0.019449857994914055, decouple_loss:0.00933064240962267
The generated pressure mean: 0.45333346724510193
The generated pressure mean: 0.45468583703041077
loss_pred:0.02032027393579483, decouple_loss:0.00922680739313364
loss_pred:0.020770259201526642, decouple_loss:0.009246647357940674
Iteration: 2690, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45398709177970886
loss_pred:0.02108713611960411, decouple_loss:0.008520841598510742
The generated pressure mean: 0.4553443491458893
loss_pred:0.020077593624591827, decouple_loss:0.008457673713564873
The generated pressure mean: 0.45521771907806396
loss_pred:0.021626630797982216, decouple_loss:0.008407988585531712
2023-04-16 22:16:41 testing...
The generated pressure mean: 0.4189932346343994
The generated pressure mean: 0.4243142604827881
The generated pressure mean: 0.42652806639671326
loss_pred:0.03133537992835045, decouple_loss:0.009061035700142384
loss_pred:0.030463051050901413, decouple_loss:0.009150061756372452
loss_pred:0.030254200100898743, decouple_loss:0.009298822842538357
WV_0_PC_0_EH_1_PS_40, loss: 0.031142707914114, avg_mse: 0.04357024282217026
current test mse: 0.04357
Iteration: 2691, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4349181354045868
loss_pred:0.02048243209719658, decouple_loss:0.008604193106293678
The generated pressure mean: 0.43498465418815613
loss_pred:0.018868347629904747, decouple_loss:0.008537312038242817
The generated pressure mean: 0.42988115549087524
loss_pred:0.020764268934726715, decouple_loss:0.008568383753299713
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2692, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44308093190193176
loss_pred:0.02134060673415661, decouple_loss:0.008965643122792244
The generated pressure mean: 0.4429655969142914
loss_pred:0.020089054480195045, decouple_loss:0.008897820487618446
The generated pressure mean: 0.4424351751804352
loss_pred:0.021389659494161606, decouple_loss:0.008946381509304047
Iteration: 2693, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45378854870796204
loss_pred:0.02001555636525154, decouple_loss:0.010256480425596237
The generated pressure mean: 0.4575400650501251
loss_pred:0.019375121220946312, decouple_loss:0.010217543691396713
The generated pressure mean: 0.4578694701194763
loss_pred:0.021071355789899826, decouple_loss:0.01020099688321352
Iteration: 2694, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45670875906944275
loss_pred:0.020521603524684906, decouple_loss:0.009477990679442883
The generated pressure mean: 0.4578680098056793
loss_pred:0.02038629539310932, decouple_loss:0.009455882012844086
The generated pressure mean: 0.45738890767097473
loss_pred:0.019482731819152832, decouple_loss:0.009444122202694416
Iteration: 2695, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43747398257255554
loss_pred:0.0204582829028368, decouple_loss:0.00898326002061367
The generated pressure mean: 0.4436871409416199
loss_pred:0.020679375156760216, decouple_loss:0.00918000191450119
The generated pressure mean: 0.43851277232170105
loss_pred:0.021599888801574707, decouple_loss:0.00910977739840746
Iteration: 2696, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4307840168476105
loss_pred:0.021169133484363556, decouple_loss:0.00943080522119999
The generated pressure mean: 0.4276520311832428
loss_pred:0.021888596937060356, decouple_loss:0.009299367666244507
The generated pressure mean: 0.43105006217956543
loss_pred:0.02052476815879345, decouple_loss:0.009347373619675636
Iteration: 2697, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44470787048339844
loss_pred:0.020535631105303764, decouple_loss:0.008824990130960941
The generated pressure mean: 0.4453454315662384
loss_pred:0.019841589033603668, decouple_loss:0.008823198266327381
The generated pressure mean: 0.45311057567596436
loss_pred:0.019877873361110687, decouple_loss:0.008874353021383286
Iteration: 2698, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4590185880661011
loss_pred:0.019890237599611282, decouple_loss:0.009940373711287975
The generated pressure mean: 0.4603232741355896
loss_pred:0.01932579278945923, decouple_loss:0.010044196620583534
The generated pressure mean: 0.46027642488479614
loss_pred:0.02105838991701603, decouple_loss:0.010008555836975574
Iteration: 2699, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4513673484325409
loss_pred:0.020483795553445816, decouple_loss:0.008312759920954704
The generated pressure mean: 0.4518338143825531
loss_pred:0.020757384598255157, decouple_loss:0.00824471190571785
The generated pressure mean: 0.45425179600715637
loss_pred:0.02103603072464466, decouple_loss:0.008241353556513786
Iteration: 2700, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.441260427236557
loss_pred:0.01978723146021366, decouple_loss:0.008252415806055069
The generated pressure mean: 0.4459115266799927
loss_pred:0.020001979544758797, decouple_loss:0.008267696015536785
The generated pressure mean: 0.4465392827987671
loss_pred:0.01927202381193638, decouple_loss:0.00846357923001051
2023-04-16 22:18:35 testing...
The generated pressure mean: 0.4175947308540344
The generated pressure mean: 0.42367425560951233
The generated pressure mean: 0.4259655475616455
loss_pred:0.03223010152578354, decouple_loss:0.00872255489230156
loss_pred:0.031147457659244537, decouple_loss:0.008916536346077919
loss_pred:0.03076588362455368, decouple_loss:0.009026117622852325
WV_0_PC_0_EH_1_PS_40, loss: 0.03182556852698326, avg_mse: 0.04544725641608238
current test mse: 0.045447
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 2701, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4411936104297638
loss_pred:0.021695084869861603, decouple_loss:0.00842543039470911
The generated pressure mean: 0.43927839398384094
loss_pred:0.02037455141544342, decouple_loss:0.008165174163877964
The generated pressure mean: 0.4399208128452301
loss_pred:0.02044668421149254, decouple_loss:0.008280131034553051
Iteration: 2702, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44548875093460083
The generated pressure mean: 0.44221779704093933
loss_pred:0.019808316603302956, decouple_loss:0.008922293782234192
loss_pred:0.02122511900961399, decouple_loss:0.008872421458363533
The generated pressure mean: 0.44552814960479736
loss_pred:0.02250262349843979, decouple_loss:0.008937744423747063
Iteration: 2703, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43720921874046326
The generated pressure mean: 0.4359579384326935loss_pred:0.02215900830924511, decouple_loss:0.009188387542963028
loss_pred:0.020609576255083084, decouple_loss:0.009131447412073612
The generated pressure mean: 0.43714839220046997
loss_pred:0.020497752353549004, decouple_loss:0.009093597531318665
Iteration: 2704, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4573150873184204
The generated pressure mean: 0.46322861313819885
loss_pred:0.020309017971158028, decouple_loss:0.008214575238525867
loss_pred:0.019726701080799103, decouple_loss:0.008335128426551819
The generated pressure mean: 0.462277889251709
loss_pred:0.021136077120900154, decouple_loss:0.008358389139175415
Iteration: 2705, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4584038555622101
The generated pressure mean: 0.456278920173645
loss_pred:0.021582718938589096, decouple_loss:0.00899235624819994
loss_pred:0.021850448101758957, decouple_loss:0.008823630400002003
The generated pressure mean: 0.45956119894981384
loss_pred:0.021098924800753593, decouple_loss:0.008906270377337933
Iteration: 2706, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44020166993141174
The generated pressure mean: 0.4426700472831726
loss_pred:0.02065865695476532, decouple_loss:0.010479150339961052
loss_pred:0.021080289036035538, decouple_loss:0.010400183498859406
The generated pressure mean: 0.44370126724243164
loss_pred:0.023457422852516174, decouple_loss:0.010510178282856941
Iteration: 2707, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44233202934265137
The generated pressure mean: 0.4423498511314392
loss_pred:0.02034684270620346, decouple_loss:0.008443460799753666
loss_pred:0.0205729678273201, decouple_loss:0.008400596678256989
The generated pressure mean: 0.4416863024234772
loss_pred:0.02145901881158352, decouple_loss:0.008440200239419937
Iteration: 2708, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4417014420032501
loss_pred:0.022534869611263275, decouple_loss:0.008231536485254765
The generated pressure mean: 0.44881781935691833
loss_pred:0.020745405927300453, decouple_loss:0.008315634913742542
The generated pressure mean: 0.44958555698394775
loss_pred:0.02076323702931404, decouple_loss:0.008113873191177845
Iteration: 2709, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4430702328681946
loss_pred:0.022456713020801544, decouple_loss:0.00953835528343916
The generated pressure mean: 0.440748006105423
loss_pred:0.021801216527819633, decouple_loss:0.009414544329047203
The generated pressure mean: 0.442117303609848
loss_pred:0.02001921460032463, decouple_loss:0.009375719353556633
Iteration: 2710, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4545748829841614
loss_pred:0.021100318059325218, decouple_loss:0.009624171070754528
The generated pressure mean: 0.4525337815284729
loss_pred:0.020738959312438965, decouple_loss:0.00949400756508112
The generated pressure mean: 0.45285430550575256
loss_pred:0.021064989268779755, decouple_loss:0.009521826170384884
2023-04-16 22:21:07 testing...
The generated pressure mean: 0.413144588470459
The generated pressure mean: 0.4187066853046417
The generated pressure mean: 0.4208133816719055
loss_pred:0.03220857307314873, decouple_loss:0.008451193571090698
loss_pred:0.03083602711558342, decouple_loss:0.008848837576806545
loss_pred:0.031084930524230003, decouple_loss:0.008691682480275631
WV_0_PC_0_EH_1_PS_40, loss: 0.03180970996618271, avg_mse: 0.044980019330978394
current test mse: 0.04498
Iteration: 2711, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45172154903411865
loss_pred:0.021163897588849068, decouple_loss:0.008133772760629654
The generated pressure mean: 0.4528147280216217
The generated pressure mean: 0.4529165029525757
loss_pred:0.020811641588807106, decouple_loss:0.00804347638040781
loss_pred:0.020384298637509346, decouple_loss:0.00804476160556078
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2712, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44763702154159546
loss_pred:0.020699087530374527, decouple_loss:0.007742241956293583
The generated pressure mean: 0.44961217045783997
loss_pred:0.019423389807343483, decouple_loss:0.0076468088664114475
The generated pressure mean: 0.4483020305633545
loss_pred:0.020541813224554062, decouple_loss:0.007713926490396261
Iteration: 2713, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44309407472610474
loss_pred:0.021340206265449524, decouple_loss:0.00833890214562416
The generated pressure mean: 0.4457126259803772
loss_pred:0.020979197695851326, decouple_loss:0.00830132607370615
The generated pressure mean: 0.44641101360321045
loss_pred:0.021264055743813515, decouple_loss:0.008367622271180153
Iteration: 2714, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4389694631099701
loss_pred:0.019753091037273407, decouple_loss:0.00932115875184536
The generated pressure mean: 0.44416701793670654
loss_pred:0.020145269110798836, decouple_loss:0.009414306841790676
The generated pressure mean: 0.4396865665912628
loss_pred:0.01915929652750492, decouple_loss:0.009494145400822163
Iteration: 2715, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476989805698395
loss_pred:0.021325131878256798, decouple_loss:0.0088978111743927
The generated pressure mean: 0.44552376866340637
loss_pred:0.019887587055563927, decouple_loss:0.008938457816839218
The generated pressure mean: 0.44960883259773254
loss_pred:0.021101266145706177, decouple_loss:0.009105619043111801
Iteration: 2716, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45261338353157043
loss_pred:0.022215163335204124, decouple_loss:0.009213447570800781
The generated pressure mean: 0.4564587473869324
loss_pred:0.020365918055176735, decouple_loss:0.009004736319184303
The generated pressure mean: 0.4541953206062317
loss_pred:0.020892975851893425, decouple_loss:0.009016577154397964
Iteration: 2717, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462210237979889
loss_pred:0.021683519706130028, decouple_loss:0.008081925101578236
The generated pressure mean: 0.4476314187049866
loss_pred:0.02039743959903717, decouple_loss:0.008043868467211723
The generated pressure mean: 0.4429120719432831
loss_pred:0.02091800607740879, decouple_loss:0.008067737333476543
Iteration: 2718, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448857843875885
loss_pred:0.019973149523139, decouple_loss:0.008402102626860142
The generated pressure mean: 0.44714564085006714
The generated pressure mean: 0.4479129910469055
loss_pred:0.019625652581453323, decouple_loss:0.00835323054343462
loss_pred:0.019936494529247284, decouple_loss:0.008495639078319073
Iteration: 2719, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45079776644706726
loss_pred:0.019916236400604248, decouple_loss:0.008291484788060188
The generated pressure mean: 0.4520137310028076
loss_pred:0.019741738215088844, decouple_loss:0.008144857361912727
The generated pressure mean: 0.44756564497947693
loss_pred:0.023078899830579758, decouple_loss:0.008308530785143375
Iteration: 2720, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44279584288597107
loss_pred:0.021204745396971703, decouple_loss:0.008787242695689201
The generated pressure mean: 0.44480374455451965
loss_pred:0.020086949691176414, decouple_loss:0.00887586921453476
The generated pressure mean: 0.4458026587963104
loss_pred:0.02052641659975052, decouple_loss:0.00881524570286274
2023-04-16 22:23:01 testing...
The generated pressure mean: 0.4213392734527588
The generated pressure mean: 0.4150997996330261
The generated pressure mean: 0.42376720905303955
loss_pred:0.03204237297177315, decouple_loss:0.009497050195932388
loss_pred:0.03303440287709236, decouple_loss:0.00937562994658947
loss_pred:0.031500499695539474, decouple_loss:0.009622679091989994
WV_0_PC_0_EH_1_PS_40, loss: 0.03266735002398491, avg_mse: 0.04667500779032707
current test mse: 0.046675
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 2721, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44276514649391174
loss_pred:0.01943638175725937, decouple_loss:0.009005601517856121
The generated pressure mean: 0.4437272846698761
loss_pred:0.02087901532649994, decouple_loss:0.009079130366444588
The generated pressure mean: 0.4457589089870453
loss_pred:0.020468035712838173, decouple_loss:0.00893827062100172
Iteration: 2722, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4414733648300171
loss_pred:0.021089937537908554, decouple_loss:0.00884873978793621
The generated pressure mean: 0.4489613473415375
loss_pred:0.0197389405220747, decouple_loss:0.008691884577274323
The generated pressure mean: 0.4417973458766937
loss_pred:0.020358171314001083, decouple_loss:0.008902240544557571
Iteration: 2723, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45368221402168274
loss_pred:0.019007483497262, decouple_loss:0.008235752582550049
The generated pressure mean: 0.4490928053855896
loss_pred:0.021461866796016693, decouple_loss:0.008273213170468807
The generated pressure mean: 0.44893980026245117
loss_pred:0.02135014720261097, decouple_loss:0.008204931393265724
Iteration: 2724, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4591995179653168
loss_pred:0.019786924123764038, decouple_loss:0.00877110194414854
The generated pressure mean: 0.45608723163604736
loss_pred:0.020161516964435577, decouple_loss:0.008671524003148079
The generated pressure mean: 0.45995044708251953
loss_pred:0.0201052688062191, decouple_loss:0.00879813265055418
Iteration: 2725, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4335215389728546
loss_pred:0.02081884816288948, decouple_loss:0.00912522803992033
The generated pressure mean: 0.43756285309791565
loss_pred:0.019507037475705147, decouple_loss:0.008946665562689304
The generated pressure mean: 0.4370002746582031
loss_pred:0.020027609542012215, decouple_loss:0.008900274522602558
Iteration: 2726, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.439492791891098
loss_pred:0.020617160946130753, decouple_loss:0.008679011836647987
The generated pressure mean: 0.4377041161060333
loss_pred:0.01921682432293892, decouple_loss:0.008736022748053074
The generated pressure mean: 0.43631744384765625
loss_pred:0.02017083391547203, decouple_loss:0.008567220531404018
Iteration: 2727, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448886513710022
loss_pred:0.019444845616817474, decouple_loss:0.008246691897511482
The generated pressure mean: 0.45242276787757874
loss_pred:0.020528119057416916, decouple_loss:0.008006749674677849
The generated pressure mean: 0.4521847367286682
loss_pred:0.019623709842562675, decouple_loss:0.008042647503316402
Iteration: 2728, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463261067867279
loss_pred:0.019905030727386475, decouple_loss:0.007970033213496208
The generated pressure mean: 0.44769904017448425
loss_pred:0.02100749872624874, decouple_loss:0.007794221863150597
The generated pressure mean: 0.44928881525993347
loss_pred:0.019636662676930428, decouple_loss:0.007884792983531952
Iteration: 2729, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4422779679298401
loss_pred:0.022356821224093437, decouple_loss:0.0077798026613891125
The generated pressure mean: 0.440317839384079
loss_pred:0.019373973831534386, decouple_loss:0.007684838492423296
The generated pressure mean: 0.4411745071411133
loss_pred:0.020145850256085396, decouple_loss:0.007753122132271528
Iteration: 2730, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4527435600757599
loss_pred:0.02056018076837063, decouple_loss:0.0073930309154093266
The generated pressure mean: 0.45542484521865845
loss_pred:0.01917210966348648, decouple_loss:0.007390604820102453
The generated pressure mean: 0.45358461141586304
loss_pred:0.019258325919508934, decouple_loss:0.007475974969565868
2023-04-16 22:25:31 testing...
The generated pressure mean: 0.41394588351249695
The generated pressure mean: 0.4205746650695801
The generated pressure mean: 0.42310357093811035
loss_pred:0.03325314819812775, decouple_loss:0.00831620953977108
loss_pred:0.03215600922703743, decouple_loss:0.008475547656416893
loss_pred:0.031758297234773636, decouple_loss:0.00865112617611885
WV_0_PC_0_EH_1_PS_40, loss: 0.03281319886445999, avg_mse: 0.04739266261458397
current test mse: 0.047393
Iteration: 2731, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4526781737804413
loss_pred:0.020308906212449074, decouple_loss:0.00782225001603365
The generated pressure mean: 0.4455908238887787
The generated pressure mean: 0.4483363926410675loss_pred:0.020399244502186775, decouple_loss:0.007810486946254969
loss_pred:0.01990427076816559, decouple_loss:0.007846435531973839
Iteration: 2732, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43603914976119995
loss_pred:0.021077251061797142, decouple_loss:0.008924204856157303
The generated pressure mean: 0.432428240776062
loss_pred:0.01977674663066864, decouple_loss:0.009002159349620342
The generated pressure mean: 0.43407922983169556
loss_pred:0.021903548389673233, decouple_loss:0.009035013616085052
Iteration: 2733, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45883888006210327
loss_pred:0.021298402920365334, decouple_loss:0.009333541616797447
The generated pressure mean: 0.45742130279541016
loss_pred:0.021222656592726707, decouple_loss:0.009509166702628136
The generated pressure mean: 0.4550604820251465
loss_pred:0.01928936317563057, decouple_loss:0.009433488361537457
Iteration: 2734, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45792925357818604
loss_pred:0.019751379266381264, decouple_loss:0.008474670350551605
The generated pressure mean: 0.45240962505340576
loss_pred:0.021115338429808617, decouple_loss:0.008733557537198067
The generated pressure mean: 0.4530492424964905
loss_pred:0.020578432828187943, decouple_loss:0.008684811182320118
Iteration: 2735, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4350539445877075
loss_pred:0.020505979657173157, decouple_loss:0.00806293822824955
The generated pressure mean: 0.4402368366718292
loss_pred:0.018863463774323463, decouple_loss:0.008021406829357147
The generated pressure mean: 0.4371006190776825
loss_pred:0.020849473774433136, decouple_loss:0.007963690906763077
Iteration: 2736, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4422345757484436
loss_pred:0.019308138638734818, decouple_loss:0.00846660602837801
The generated pressure mean: 0.4413190484046936
loss_pred:0.018908603116869926, decouple_loss:0.008395032025873661
The generated pressure mean: 0.4469839036464691
loss_pred:0.021036868914961815, decouple_loss:0.008307673037052155
Iteration: 2737, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442689120769501
loss_pred:0.02097894810140133, decouple_loss:0.008543232455849648
The generated pressure mean: 0.44620469212532043
loss_pred:0.02067970298230648, decouple_loss:0.008476130664348602
The generated pressure mean: 0.4430096745491028
loss_pred:0.02095675654709339, decouple_loss:0.008756579831242561
Iteration: 2738, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44086429476737976
loss_pred:0.020125774666666985, decouple_loss:0.008236388675868511
The generated pressure mean: 0.4407159686088562
The generated pressure mean: 0.4373687207698822loss_pred:0.021420862525701523, decouple_loss:0.008284376934170723
loss_pred:0.02025170996785164, decouple_loss:0.008117669261991978
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2739, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45286697149276733
loss_pred:0.02071710117161274, decouple_loss:0.008335167542099953
The generated pressure mean: 0.4573613703250885
The generated pressure mean: 0.45948246121406555
loss_pred:0.018665725365281105, decouple_loss:0.008256543427705765
loss_pred:0.020716143772006035, decouple_loss:0.008516211993992329
Iteration: 2740, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4529908001422882
loss_pred:0.01869247294962406, decouple_loss:0.008723576553165913
The generated pressure mean: 0.4503955841064453
The generated pressure mean: 0.44862014055252075
loss_pred:0.019490670412778854, decouple_loss:0.008625251241028309
loss_pred:0.019009077921509743, decouple_loss:0.008733944967389107
2023-04-16 22:27:26 testing...
The generated pressure mean: 0.4152113199234009
The generated pressure mean: 0.42127659916877747
The generated pressure mean: 0.4237438440322876
loss_pred:0.03249739482998848, decouple_loss:0.00919161643832922
loss_pred:0.031536877155303955, decouple_loss:0.009349669329822063
loss_pred:0.031168371438980103, decouple_loss:0.009513738565146923
WV_0_PC_0_EH_1_PS_40, loss: 0.032201796770095825, avg_mse: 0.04622310772538185
current test mse: 0.046223
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 2741, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472392797470093
loss_pred:0.01955392211675644, decouple_loss:0.008501178584992886
The generated pressure mean: 0.445461630821228
loss_pred:0.02039380557835102, decouple_loss:0.008950106799602509
The generated pressure mean: 0.4441728889942169
loss_pred:0.02053983323276043, decouple_loss:0.008661319501698017
Iteration: 2742, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44015079736709595
The generated pressure mean: 0.4459054172039032
loss_pred:0.02046366222202778, decouple_loss:0.008437778800725937
loss_pred:0.021083509549498558, decouple_loss:0.008607062511146069
The generated pressure mean: 0.445591002702713
loss_pred:0.020065639168024063, decouple_loss:0.0085751386359334
Iteration: 2743, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44143447279930115
loss_pred:0.020082995295524597, decouple_loss:0.008788756094872952
The generated pressure mean: 0.4406391680240631
loss_pred:0.021688934415578842, decouple_loss:0.008755889721214771
The generated pressure mean: 0.4363027513027191
loss_pred:0.020261310040950775, decouple_loss:0.009083675220608711
Iteration: 2744, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4564703702926636
loss_pred:0.019481096416711807, decouple_loss:0.008349653333425522
The generated pressure mean: 0.4549148380756378
loss_pred:0.022208979353308678, decouple_loss:0.008604349568486214
The generated pressure mean: 0.456149160861969
loss_pred:0.021846335381269455, decouple_loss:0.008429724723100662
Iteration: 2745, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45876404643058777
loss_pred:0.01971340924501419, decouple_loss:0.008778036572039127
The generated pressure mean: 0.46303874254226685
loss_pred:0.01980013959109783, decouple_loss:0.008826527744531631
The generated pressure mean: 0.45760753750801086
loss_pred:0.022049635648727417, decouple_loss:0.008657046593725681
Iteration: 2746, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44040989875793457
loss_pred:0.021199233829975128, decouple_loss:0.008608650416135788
The generated pressure mean: 0.44388774037361145
loss_pred:0.019663231447339058, decouple_loss:0.008564116433262825
The generated pressure mean: 0.4465673863887787
loss_pred:0.020178161561489105, decouple_loss:0.008370080031454563
Iteration: 2747, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43349653482437134
loss_pred:0.021878477185964584, decouple_loss:0.009655703790485859
The generated pressure mean: 0.42907631397247314
loss_pred:0.02010602504014969, decouple_loss:0.009712380357086658
The generated pressure mean: 0.43219542503356934
loss_pred:0.020738987252116203, decouple_loss:0.009684300981462002
Iteration: 2748, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45108363032341003
loss_pred:0.019917137920856476, decouple_loss:0.009139816276729107
The generated pressure mean: 0.4564949572086334
The generated pressure mean: 0.4640677571296692
loss_pred:0.022313078865408897, decouple_loss:0.008987011387944221
loss_pred:0.020199619233608246, decouple_loss:0.009211600758135319
Iteration: 2749, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4513542354106903
loss_pred:0.020580356940627098, decouple_loss:0.009004302322864532
The generated pressure mean: 0.4510878026485443
loss_pred:0.01957247406244278, decouple_loss:0.009125125594437122
The generated pressure mean: 0.44475001096725464
loss_pred:0.020416786894202232, decouple_loss:0.009027929976582527
Iteration: 2750, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459548890590668
loss_pred:0.019745849072933197, decouple_loss:0.008369307033717632
The generated pressure mean: 0.45460355281829834
The generated pressure mean: 0.4529840350151062
loss_pred:0.020658917725086212, decouple_loss:0.008337803184986115
loss_pred:0.019460134208202362, decouple_loss:0.008441474288702011
2023-04-16 22:29:55 testing...
The generated pressure mean: 0.41408488154411316
The generated pressure mean: 0.4208110272884369
loss_pred:0.034132469445466995, decouple_loss:0.008972499519586563
The generated pressure mean: 0.4238128364086151
loss_pred:0.033154960721731186, decouple_loss:0.009029640816152096
loss_pred:0.03236834332346916, decouple_loss:0.009184968657791615
WV_0_PC_0_EH_1_PS_40, loss: 0.03367171436548233, avg_mse: 0.04924320802092552
current test mse: 0.049243
Iteration: 2751, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45234790444374084
loss_pred:0.01883988454937935, decouple_loss:0.008768176659941673
The generated pressure mean: 0.44968554377555847
loss_pred:0.0197763592004776, decouple_loss:0.00865127518773079
The generated pressure mean: 0.4537871479988098
loss_pred:0.019314274191856384, decouple_loss:0.008576584048569202
Iteration: 2752, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43987441062927246
loss_pred:0.019954705610871315, decouple_loss:0.008268878795206547
The generated pressure mean: 0.44283899664878845
loss_pred:0.020458046346902847, decouple_loss:0.008546017110347748
The generated pressure mean: 0.44403305649757385
loss_pred:0.023263942450284958, decouple_loss:0.008331488817930222
Iteration: 2753, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43742457032203674
loss_pred:0.019717082381248474, decouple_loss:0.009352578781545162
The generated pressure mean: 0.42819514870643616
loss_pred:0.019635943695902824, decouple_loss:0.009406493045389652
The generated pressure mean: 0.4309569001197815
loss_pred:0.019590139389038086, decouple_loss:0.009150808677077293
Iteration: 2754, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45803552865982056
loss_pred:0.021586177870631218, decouple_loss:0.00953580066561699
The generated pressure mean: 0.4577329456806183
loss_pred:0.02010433003306389, decouple_loss:0.009568348526954651
The generated pressure mean: 0.4562797248363495
loss_pred:0.020254410803318024, decouple_loss:0.009519803337752819
Iteration: 2755, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46503835916519165
loss_pred:0.0210685096681118, decouple_loss:0.008659121580421925
The generated pressure mean: 0.46074819564819336
loss_pred:0.020066941156983376, decouple_loss:0.008367824368178844
The generated pressure mean: 0.46836724877357483
loss_pred:0.01970013976097107, decouple_loss:0.008399742655456066
Iteration: 2756, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449351727962494
loss_pred:0.02065146341919899, decouple_loss:0.00838445220142603
The generated pressure mean: 0.4417545199394226
loss_pred:0.02018624357879162, decouple_loss:0.008269956335425377
The generated pressure mean: 0.4395756423473358
loss_pred:0.020024428144097328, decouple_loss:0.008198952302336693
Iteration: 2757, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.432831734418869
loss_pred:0.020620359107851982, decouple_loss:0.008040024898946285
The generated pressure mean: 0.4259176552295685
loss_pred:0.020871227607131004, decouple_loss:0.007953998632729053
The generated pressure mean: 0.4313521385192871
loss_pred:0.022078730165958405, decouple_loss:0.008059555664658546
Iteration: 2758, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4537366032600403
loss_pred:0.020840799435973167, decouple_loss:0.008439104072749615
The generated pressure mean: 0.4578326344490051
The generated pressure mean: 0.45769351720809937
loss_pred:0.020302418619394302, decouple_loss:0.008740212768316269
loss_pred:0.02038196101784706, decouple_loss:0.008680730126798153
Iteration: 2759, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506089687347412
loss_pred:0.018849365413188934, decouple_loss:0.009271398186683655
The generated pressure mean: 0.44737347960472107
The generated pressure mean: 0.4500235617160797
loss_pred:0.020388709381222725, decouple_loss:0.009254449978470802
loss_pred:0.020138578489422798, decouple_loss:0.00909188948571682
Iteration: 2760, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4447711706161499
The generated pressure mean: 0.448779821395874
loss_pred:0.019545547664165497, decouple_loss:0.008661620318889618
loss_pred:0.01952507346868515, decouple_loss:0.008665692992508411
The generated pressure mean: 0.451738178730011
loss_pred:0.0196465402841568, decouple_loss:0.00860575120896101
2023-04-16 22:31:49 testing...
The generated pressure mean: 0.4153439998626709
The generated pressure mean: 0.4206683933734894
The generated pressure mean: 0.423159122467041
loss_pred:0.03242308273911476, decouple_loss:0.008869924582540989
loss_pred:0.03129899129271507, decouple_loss:0.009031090885400772
loss_pred:0.030900655314326286, decouple_loss:0.009210010059177876
WV_0_PC_0_EH_1_PS_40, loss: 0.03199275955557823, avg_mse: 0.045642998069524765
current test mse: 0.045643
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
Iteration: 2761, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44349348545074463
loss_pred:0.020062820985913277, decouple_loss:0.008635513484477997
The generated pressure mean: 0.4502265751361847
loss_pred:0.019498316571116447, decouple_loss:0.008528970181941986
The generated pressure mean: 0.4498993754386902
loss_pred:0.02025640569627285, decouple_loss:0.008456899784505367
Iteration: 2762, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43852028250694275
The generated pressure mean: 0.44008949398994446
loss_pred:0.021937711164355278, decouple_loss:0.009991360828280449
loss_pred:0.019956398755311966, decouple_loss:0.009838433936238289
The generated pressure mean: 0.445157915353775
loss_pred:0.020848194137215614, decouple_loss:0.009892978705465794
Iteration: 2763, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462873637676239
The generated pressure mean: 0.446086049079895
loss_pred:0.019787680357694626, decouple_loss:0.00862712413072586
loss_pred:0.020844221115112305, decouple_loss:0.008542061783373356
The generated pressure mean: 0.44495633244514465
loss_pred:0.02084449678659439, decouple_loss:0.00867568701505661
Iteration: 2764, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469062387943268
The generated pressure mean: 0.44638365507125854
loss_pred:0.020823871716856956, decouple_loss:0.007985481061041355
loss_pred:0.021583886817097664, decouple_loss:0.008043902926146984
The generated pressure mean: 0.44450852274894714
loss_pred:0.02118954062461853, decouple_loss:0.00807928666472435
Iteration: 2765, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4418947100639343
The generated pressure mean: 0.4520043432712555
loss_pred:0.02134006656706333, decouple_loss:0.008067133836448193
loss_pred:0.020994437858462334, decouple_loss:0.00807222630828619
The generated pressure mean: 0.44060227274894714
loss_pred:0.02056850865483284, decouple_loss:0.008071071468293667
Iteration: 2766, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476856589317322The generated pressure mean: 0.4471227824687958
loss_pred:0.02183372527360916, decouple_loss:0.00832226313650608
loss_pred:0.019524218514561653, decouple_loss:0.008239053189754486
The generated pressure mean: 0.44530758261680603
loss_pred:0.021245447918772697, decouple_loss:0.008150500245392323
Iteration: 2767, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4455249607563019
The generated pressure mean: 0.44564464688301086
loss_pred:0.021065445616841316, decouple_loss:0.00805007666349411
loss_pred:0.020876340568065643, decouple_loss:0.008052359335124493
The generated pressure mean: 0.4419708549976349
loss_pred:0.020221944898366928, decouple_loss:0.008056018501520157
Iteration: 2768, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485572278499603
loss_pred:0.02203294076025486, decouple_loss:0.007937787100672722
The generated pressure mean: 0.44757673144340515
loss_pred:0.019767357036471367, decouple_loss:0.007951446808874607
The generated pressure mean: 0.45048555731773376
loss_pred:0.020217079669237137, decouple_loss:0.007988576777279377
Iteration: 2769, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4405779242515564
loss_pred:0.020133528858423233, decouple_loss:0.0076203965581953526
The generated pressure mean: 0.44235512614250183
loss_pred:0.022586990147829056, decouple_loss:0.007708474528044462
The generated pressure mean: 0.44248828291893005
loss_pred:0.02136232517659664, decouple_loss:0.007645401172339916
Iteration: 2770, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44686272740364075
loss_pred:0.020439477637410164, decouple_loss:0.008964749053120613
The generated pressure mean: 0.450966477394104
loss_pred:0.02129298634827137, decouple_loss:0.009186149574816227
The generated pressure mean: 0.4458722174167633
loss_pred:0.021944038569927216, decouple_loss:0.008886079303920269
2023-04-16 22:34:26 testing...
The generated pressure mean: 0.4161069989204407
The generated pressure mean: 0.4221937358379364
The generated pressure mean: 0.42442750930786133
loss_pred:0.03216954320669174, decouple_loss:0.008469468913972378
loss_pred:0.031165895983576775, decouple_loss:0.008701101876795292
loss_pred:0.030884189531207085, decouple_loss:0.008856117725372314
WV_0_PC_0_EH_1_PS_40, loss: 0.03184032067656517, avg_mse: 0.04543570801615715
current test mse: 0.045436
Iteration: 2771, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4419231116771698
loss_pred:0.01945686712861061, decouple_loss:0.008001579903066158
The generated pressure mean: 0.43867844343185425
loss_pred:0.021038448438048363, decouple_loss:0.007913490757346153
The generated pressure mean: 0.4401018023490906
loss_pred:0.020246440544724464, decouple_loss:0.007833796553313732
Iteration: 2772, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4527783691883087
The generated pressure mean: 0.4534270167350769
loss_pred:0.02236340381205082, decouple_loss:0.008057501167058945
loss_pred:0.022226758301258087, decouple_loss:0.008110026828944683
The generated pressure mean: 0.4512448310852051
loss_pred:0.02161187306046486, decouple_loss:0.008036809042096138
Iteration: 2773, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4377577602863312
loss_pred:0.022118423134088516, decouple_loss:0.009262491948902607
The generated pressure mean: 0.4359655976295471
loss_pred:0.02147224359214306, decouple_loss:0.009405268356204033
The generated pressure mean: 0.44062739610671997
loss_pred:0.02021702565252781, decouple_loss:0.00925002433359623
Iteration: 2774, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447277694940567
loss_pred:0.0201424490660429, decouple_loss:0.011590921320021152
The generated pressure mean: 0.4493294954299927
loss_pred:0.021144332364201546, decouple_loss:0.011885643005371094
The generated pressure mean: 0.44693952798843384
loss_pred:0.02000316046178341, decouple_loss:0.011874009855091572
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2775, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44999489188194275
loss_pred:0.020612424239516258, decouple_loss:0.008251035585999489
The generated pressure mean: 0.45003268122673035
loss_pred:0.020189689472317696, decouple_loss:0.008284972980618477
The generated pressure mean: 0.45501765608787537
loss_pred:0.020846307277679443, decouple_loss:0.008386902511119843
Iteration: 2776, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4521692395210266
loss_pred:0.020847029983997345, decouple_loss:0.00938141718506813
The generated pressure mean: 0.44599848985671997
loss_pred:0.019773827865719795, decouple_loss:0.009315031580626965
The generated pressure mean: 0.45200496912002563
loss_pred:0.01977156661450863, decouple_loss:0.00937870517373085
Iteration: 2777, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4400619566440582
loss_pred:0.02203894592821598, decouple_loss:0.009545673616230488
The generated pressure mean: 0.4389819800853729
loss_pred:0.021311918273568153, decouple_loss:0.009495076723396778
The generated pressure mean: 0.43688011169433594
loss_pred:0.020871518179774284, decouple_loss:0.009404029697179794
Iteration: 2778, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4404178261756897
loss_pred:0.02120169624686241, decouple_loss:0.00873518269509077
The generated pressure mean: 0.4414011240005493
The generated pressure mean: 0.4426192045211792loss_pred:0.022021528333425522, decouple_loss:0.008756539784371853
loss_pred:0.020221995189785957, decouple_loss:0.008524193428456783
Iteration: 2779, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44371914863586426
loss_pred:0.019970742985606194, decouple_loss:0.011641552671790123
The generated pressure mean: 0.44988584518432617
loss_pred:0.02075040712952614, decouple_loss:0.011565357446670532
The generated pressure mean: 0.44313323497772217
loss_pred:0.020393183454871178, decouple_loss:0.011591337621212006
Iteration: 2780, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44984176754951477
loss_pred:0.02035783790051937, decouple_loss:0.010270287282764912
The generated pressure mean: 0.4487728476524353
loss_pred:0.02002268098294735, decouple_loss:0.010409021750092506
The generated pressure mean: 0.45080146193504333
loss_pred:0.020668331533670425, decouple_loss:0.01012137345969677
2023-04-16 22:36:20 testing...
The generated pressure mean: 0.4145819842815399
The generated pressure mean: 0.42101210355758667
The generated pressure mean: 0.42267337441444397
loss_pred:0.03176754340529442, decouple_loss:0.009767654351890087
loss_pred:0.030824337154626846, decouple_loss:0.01013735868036747
loss_pred:0.030416613444685936, decouple_loss:0.01028729323297739
WV_0_PC_0_EH_1_PS_40, loss: 0.03150603547692299, avg_mse: 0.04481479153037071
current test mse: 0.044815
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 2781, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460243582725525
loss_pred:0.021120281890034676, decouple_loss:0.009605552069842815
The generated pressure mean: 0.44998395442962646
loss_pred:0.01907419040799141, decouple_loss:0.009897386655211449
The generated pressure mean: 0.4459051787853241
loss_pred:0.01910555735230446, decouple_loss:0.009556866250932217
Iteration: 2782, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44405287504196167
loss_pred:0.019750606268644333, decouple_loss:0.00955536775290966
The generated pressure mean: 0.4430382549762726
loss_pred:0.02086126245558262, decouple_loss:0.009579758159816265
The generated pressure mean: 0.4489108920097351
loss_pred:0.02001674845814705, decouple_loss:0.009539453312754631
Iteration: 2783, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4454573392868042
loss_pred:0.022166334092617035, decouple_loss:0.008619857020676136
The generated pressure mean: 0.44405943155288696
loss_pred:0.02314496412873268, decouple_loss:0.008700150065124035
The generated pressure mean: 0.4394978880882263
loss_pred:0.02017517201602459, decouple_loss:0.008799894712865353
Iteration: 2784, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4444487690925598
The generated pressure mean: 0.4476284682750702
loss_pred:0.020453711971640587, decouple_loss:0.009849275462329388
loss_pred:0.020731564611196518, decouple_loss:0.009761927649378777
The generated pressure mean: 0.4448698163032532
loss_pred:0.01874629221856594, decouple_loss:0.009746280498802662
Iteration: 2785, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44835972785949707
loss_pred:0.020669840276241302, decouple_loss:0.00913327932357788
The generated pressure mean: 0.4487808644771576
loss_pred:0.021232912316918373, decouple_loss:0.00896067451685667
The generated pressure mean: 0.4549042880535126
loss_pred:0.0209428109228611, decouple_loss:0.008952411822974682
Iteration: 2786, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44462308287620544
The generated pressure mean: 0.4450308084487915
loss_pred:0.018943466246128082, decouple_loss:0.00822874903678894
loss_pred:0.020211661234498024, decouple_loss:0.008247645571827888
The generated pressure mean: 0.44113147258758545
loss_pred:0.01995461992919445, decouple_loss:0.00818940531462431
Iteration: 2787, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492548108100891
loss_pred:0.02091742679476738, decouple_loss:0.010217293165624142
The generated pressure mean: 0.44871261715888977
loss_pred:0.02001013047993183, decouple_loss:0.010164226405322552
The generated pressure mean: 0.4534870982170105
loss_pred:0.0194256529211998, decouple_loss:0.010341080836951733
Iteration: 2788, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4400326907634735
loss_pred:0.019706664606928825, decouple_loss:0.009574227966368198
The generated pressure mean: 0.4399542212486267
The generated pressure mean: 0.44048070907592773
loss_pred:0.018820716068148613, decouple_loss:0.009616883471608162
loss_pred:0.022081788629293442, decouple_loss:0.00959824863821268
Iteration: 2789, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467056691646576
loss_pred:0.020224209874868393, decouple_loss:0.009851070120930672
The generated pressure mean: 0.445169597864151
loss_pred:0.019627396017313004, decouple_loss:0.009783204644918442
The generated pressure mean: 0.44924071431159973
loss_pred:0.020307665690779686, decouple_loss:0.010064780712127686
Iteration: 2790, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464796781539917
loss_pred:0.019702322781085968, decouple_loss:0.009779645130038261
The generated pressure mean: 0.4456872344017029
loss_pred:0.019232699647545815, decouple_loss:0.009825845248997211
The generated pressure mean: 0.4465474784374237
loss_pred:0.019702672958374023, decouple_loss:0.009620798751711845
2023-04-16 22:38:51 testing...
The generated pressure mean: 0.4207109212875366
The generated pressure mean: 0.41499263048171997
loss_pred:0.031233839690685272, decouple_loss:0.008980863727629185
The generated pressure mean: 0.42274805903434753
loss_pred:0.03240520507097244, decouple_loss:0.008889367803931236
loss_pred:0.03094192035496235, decouple_loss:0.00909305177628994
WV_0_PC_0_EH_1_PS_40, loss: 0.031976379454135895, avg_mse: 0.045612819492816925
current test mse: 0.045613
Iteration: 2791, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480784833431244
loss_pred:0.019445005804300308, decouple_loss:0.008657362312078476
The generated pressure mean: 0.4464147090911865
loss_pred:0.01979481242597103, decouple_loss:0.00856715627014637
The generated pressure mean: 0.4432811439037323
loss_pred:0.02082972042262554, decouple_loss:0.00864062923938036
Iteration: 2792, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44517436623573303
loss_pred:0.021583905443549156, decouple_loss:0.008170788176357746
The generated pressure mean: 0.44962865114212036
The generated pressure mean: 0.4456424117088318
loss_pred:0.02021096833050251, decouple_loss:0.008367769420146942
loss_pred:0.021615592762827873, decouple_loss:0.008321521803736687
Iteration: 2793, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45877689123153687
loss_pred:0.019534066319465637, decouple_loss:0.009866219945251942
The generated pressure mean: 0.46320652961730957
loss_pred:0.020230870693922043, decouple_loss:0.009951429441571236
The generated pressure mean: 0.4604560434818268
loss_pred:0.020658481866121292, decouple_loss:0.009911281056702137
Iteration: 2794, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44498470425605774
loss_pred:0.019629761576652527, decouple_loss:0.009136009030044079
The generated pressure mean: 0.44304731488227844
loss_pred:0.020256303250789642, decouple_loss:0.009131022728979588
The generated pressure mean: 0.440233051776886
loss_pred:0.020378179848194122, decouple_loss:0.009184449911117554
Iteration: 2795, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4279271960258484
loss_pred:0.019655734300613403, decouple_loss:0.008404876105487347
The generated pressure mean: 0.42655470967292786
loss_pred:0.020030677318572998, decouple_loss:0.008487044833600521
The generated pressure mean: 0.42537835240364075
loss_pred:0.01969572901725769, decouple_loss:0.008409850299358368
Iteration: 2796, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4611804783344269
loss_pred:0.019427500665187836, decouple_loss:0.008533216081559658
The generated pressure mean: 0.4581511914730072
loss_pred:0.021782467141747475, decouple_loss:0.008522708900272846
The generated pressure mean: 0.458134263753891
loss_pred:0.01941758766770363, decouple_loss:0.008521044626832008
Iteration: 2797, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45084813237190247
loss_pred:0.018437210470438004, decouple_loss:0.009346488863229752
The generated pressure mean: 0.45453253388404846
loss_pred:0.020216507837176323, decouple_loss:0.009297332726418972
The generated pressure mean: 0.45229536294937134
loss_pred:0.018754610791802406, decouple_loss:0.009405402466654778
Iteration: 2798, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4512588679790497
The generated pressure mean: 0.4489594101905823
loss_pred:0.0206037238240242, decouple_loss:0.008371224626898766
loss_pred:0.020319415256381035, decouple_loss:0.008469895459711552
The generated pressure mean: 0.4486427307128906
loss_pred:0.019563650712370872, decouple_loss:0.008347432129085064
Iteration: 2799, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4386149048805237
loss_pred:0.020213570445775986, decouple_loss:0.008818390779197216
The generated pressure mean: 0.4364171326160431
loss_pred:0.019793564453721046, decouple_loss:0.008693414740264416
The generated pressure mean: 0.4348442256450653
loss_pred:0.020161498337984085, decouple_loss:0.008759071119129658
Iteration: 2800, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44772791862487793
loss_pred:0.019231311976909637, decouple_loss:0.009401868097484112
The generated pressure mean: 0.4484228193759918
loss_pred:0.020901085808873177, decouple_loss:0.009512314572930336
The generated pressure mean: 0.4502137303352356
loss_pred:0.019981902092695236, decouple_loss:0.009595243260264397
2023-04-16 22:40:44 testing...
The generated pressure mean: 0.41437819600105286
The generated pressure mean: 0.42132699489593506
The generated pressure mean: 0.42300641536712646
loss_pred:0.03252364695072174, decouple_loss:0.009349807165563107
loss_pred:0.031412187963724136, decouple_loss:0.009620586410164833
loss_pred:0.03109828382730484, decouple_loss:0.009779999032616615
WV_0_PC_0_EH_1_PS_40, loss: 0.03215721249580383, avg_mse: 0.04620785266160965
current test mse: 0.046208
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 2801, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4509430229663849
loss_pred:0.019136516377329826, decouple_loss:0.008799970149993896
The generated pressure mean: 0.45442819595336914
loss_pred:0.01947965659201145, decouple_loss:0.008834888227283955
The generated pressure mean: 0.45120298862457275
loss_pred:0.01916741207242012, decouple_loss:0.00883396901190281
Iteration: 2802, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4402729570865631
loss_pred:0.02184823341667652, decouple_loss:0.008647718466818333
The generated pressure mean: 0.43863165378570557
loss_pred:0.02217542566359043, decouple_loss:0.00882076658308506
The generated pressure mean: 0.4412786662578583
loss_pred:0.020014207810163498, decouple_loss:0.00858029630035162
Iteration: 2803, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4403519034385681The generated pressure mean: 0.43851131200790405
loss_pred:0.01894836686551571, decouple_loss:0.008778796531260014loss_pred:0.01940835453569889, decouple_loss:0.008830833248794079
The generated pressure mean: 0.4402889907360077
loss_pred:0.020387068390846252, decouple_loss:0.00864227395504713
Iteration: 2804, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4584207832813263
The generated pressure mean: 0.45862725377082825
loss_pred:0.0200105682015419, decouple_loss:0.008192219771444798
loss_pred:0.020454751327633858, decouple_loss:0.008223607204854488
The generated pressure mean: 0.4597996473312378
loss_pred:0.019678207114338875, decouple_loss:0.007939925417304039
Iteration: 2805, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44943153858184814
The generated pressure mean: 0.4470078647136688
loss_pred:0.01961531676352024, decouple_loss:0.009077008813619614
loss_pred:0.01897377334535122, decouple_loss:0.00917581282556057
The generated pressure mean: 0.44692811369895935
loss_pred:0.02250562235713005, decouple_loss:0.009235423058271408
Iteration: 2806, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4390629231929779
The generated pressure mean: 0.43719932436943054
loss_pred:0.019560998305678368, decouple_loss:0.008155418559908867
loss_pred:0.020243681967258453, decouple_loss:0.008073422126471996
The generated pressure mean: 0.4375742971897125
loss_pred:0.019622696563601494, decouple_loss:0.008203549310564995
Iteration: 2807, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4522978365421295
The generated pressure mean: 0.4516983926296234
loss_pred:0.019283225759863853, decouple_loss:0.007623872719705105
loss_pred:0.018992679193615913, decouple_loss:0.007534900214523077
The generated pressure mean: 0.4520070552825928
loss_pred:0.018986312672495842, decouple_loss:0.007609797641634941
Iteration: 2808, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45002448558807373
loss_pred:0.019839245826005936, decouple_loss:0.008072840981185436
The generated pressure mean: 0.4513726532459259
loss_pred:0.019283002242445946, decouple_loss:0.007980577647686005
The generated pressure mean: 0.4505629539489746
loss_pred:0.01988680474460125, decouple_loss:0.008016999810934067
Iteration: 2809, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4371793568134308
The generated pressure mean: 0.43829143047332764
loss_pred:0.01871408335864544, decouple_loss:0.007813982665538788
loss_pred:0.020342478528618813, decouple_loss:0.007525674067437649
The generated pressure mean: 0.4371839165687561
loss_pred:0.020092636346817017, decouple_loss:0.007660927716642618
Iteration: 2810, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44524234533309937
The generated pressure mean: 0.452853262424469
loss_pred:0.020129848271608353, decouple_loss:0.008281278423964977
loss_pred:0.018814019858837128, decouple_loss:0.008141247555613518
The generated pressure mean: 0.4527594745159149
loss_pred:0.019051140174269676, decouple_loss:0.008322503417730331
2023-04-16 22:43:17 testing...
The generated pressure mean: 0.41327059268951416
The generated pressure mean: 0.4202430546283722
The generated pressure mean: 0.4223465621471405
loss_pred:0.03339424729347229, decouple_loss:0.00908658280968666
loss_pred:0.031804416328668594, decouple_loss:0.009148822166025639
loss_pred:0.03181295469403267, decouple_loss:0.009415696375072002
WV_0_PC_0_EH_1_PS_40, loss: 0.03279805928468704, avg_mse: 0.047588057816028595
current test mse: 0.047588
Iteration: 2811, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45292237401008606
loss_pred:0.020507100969552994, decouple_loss:0.008529589511454105
The generated pressure mean: 0.4518522620201111
loss_pred:0.01995447650551796, decouple_loss:0.008692075498402119
The generated pressure mean: 0.4568435847759247
loss_pred:0.022196071222424507, decouple_loss:0.008468818850815296
Iteration: 2812, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4261966049671173
loss_pred:0.020262528210878372, decouple_loss:0.008231433108448982
The generated pressure mean: 0.4231410324573517
loss_pred:0.02136106602847576, decouple_loss:0.008275849744677544
The generated pressure mean: 0.42307373881340027
loss_pred:0.021322637796401978, decouple_loss:0.008271879516541958
Iteration: 2813, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.455665647983551
loss_pred:0.019213341176509857, decouple_loss:0.008248354308307171
The generated pressure mean: 0.45509111881256104
loss_pred:0.019492728635668755, decouple_loss:0.008204955607652664
The generated pressure mean: 0.45218878984451294
loss_pred:0.019493630155920982, decouple_loss:0.008259718306362629
Iteration: 2814, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46598848700523376
loss_pred:0.01839778572320938, decouple_loss:0.008457688614726067
The generated pressure mean: 0.46743476390838623
loss_pred:0.019931787624955177, decouple_loss:0.008555522188544273
The generated pressure mean: 0.46926283836364746
loss_pred:0.021079828962683678, decouple_loss:0.008470573462545872
Iteration: 2815, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44422590732574463
loss_pred:0.021290652453899384, decouple_loss:0.008200796321034431
The generated pressure mean: 0.4421175420284271
loss_pred:0.019116608425974846, decouple_loss:0.008221366442739964
The generated pressure mean: 0.4431625306606293
loss_pred:0.019702119752764702, decouple_loss:0.008128831163048744
Iteration: 2816, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4303268492221832
loss_pred:0.020381204783916473, decouple_loss:0.00873607862740755
The generated pressure mean: 0.433818519115448
loss_pred:0.0213006604462862, decouple_loss:0.008808686397969723
The generated pressure mean: 0.43242794275283813
loss_pred:0.018940933048725128, decouple_loss:0.008844510652124882
Iteration: 2817, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4426824450492859
loss_pred:0.02034755051136017, decouple_loss:0.009736529551446438
The generated pressure mean: 0.4485933482646942
loss_pred:0.018558543175458908, decouple_loss:0.00980181060731411
The generated pressure mean: 0.44849684834480286
loss_pred:0.019624298438429832, decouple_loss:0.009788846597075462
Iteration: 2818, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45661142468452454
loss_pred:0.018459951505064964, decouple_loss:0.009003864601254463
The generated pressure mean: 0.45380231738090515
loss_pred:0.020813174545764923, decouple_loss:0.009124086238443851
The generated pressure mean: 0.4546153247356415
loss_pred:0.0190938338637352, decouple_loss:0.009137751534581184
Iteration: 2819, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44585707783699036
loss_pred:0.0191726665943861, decouple_loss:0.009023621678352356
The generated pressure mean: 0.4439348578453064
loss_pred:0.019124053418636322, decouple_loss:0.008924515917897224
The generated pressure mean: 0.444717139005661
loss_pred:0.019592206925153732, decouple_loss:0.009009200148284435
Iteration: 2820, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44621601700782776
loss_pred:0.018703585490584373, decouple_loss:0.00786294974386692
The generated pressure mean: 0.4448084533214569
loss_pred:0.019695507362484932, decouple_loss:0.008077924139797688
The generated pressure mean: 0.44783899188041687
loss_pred:0.018778853118419647, decouple_loss:0.007966830395162106
2023-04-16 22:45:11 testing...
The generated pressure mean: 0.4149211049079895
The generated pressure mean: 0.42130762338638306
The generated pressure mean: 0.4236268401145935
loss_pred:0.032965321093797684, decouple_loss:0.008840298280119896
loss_pred:0.03186856582760811, decouple_loss:0.008943271823227406
loss_pred:0.031246215105056763, decouple_loss:0.00915991235524416
WV_0_PC_0_EH_1_PS_40, loss: 0.03247576206922531, avg_mse: 0.046827223151922226
current test mse: 0.046827
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 2821, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449487030506134
loss_pred:0.02124212682247162, decouple_loss:0.008572977967560291
The generated pressure mean: 0.44962766766548157
The generated pressure mean: 0.44961923360824585
loss_pred:0.02149355411529541, decouple_loss:0.008472722955048084
loss_pred:0.021810369566082954, decouple_loss:0.008670995943248272
Iteration: 2822, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4374033212661743
The generated pressure mean: 0.4369864761829376
loss_pred:0.02112952060997486, decouple_loss:0.00787190068513155
loss_pred:0.02099105902016163, decouple_loss:0.008068972267210484
The generated pressure mean: 0.4322129189968109
loss_pred:0.020918721333146095, decouple_loss:0.008168719708919525
Iteration: 2823, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45529448986053467
The generated pressure mean: 0.4540388882160187
loss_pred:0.020571839064359665, decouple_loss:0.00796650629490614
loss_pred:0.019444674253463745, decouple_loss:0.00773334177210927
The generated pressure mean: 0.4506162703037262
loss_pred:0.018512463197112083, decouple_loss:0.007773739751428366
Iteration: 2824, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45941969752311707
The generated pressure mean: 0.4659488797187805
loss_pred:0.020415669307112694, decouple_loss:0.007568872533738613
loss_pred:0.020212173461914062, decouple_loss:0.007567764259874821
The generated pressure mean: 0.4579877555370331
loss_pred:0.021453209221363068, decouple_loss:0.007452600169926882
Iteration: 2825, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4373570680618286
The generated pressure mean: 0.4372049570083618
loss_pred:0.019979428499937057, decouple_loss:0.007946783676743507
loss_pred:0.020364908501505852, decouple_loss:0.008115184493362904
The generated pressure mean: 0.43595170974731445
loss_pred:0.019521940499544144, decouple_loss:0.007926451042294502
Iteration: 2826, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4410914182662964
The generated pressure mean: 0.43836623430252075
loss_pred:0.020324477925896645, decouple_loss:0.007633924949914217
loss_pred:0.02079094387590885, decouple_loss:0.007614421658217907
The generated pressure mean: 0.4406270682811737
loss_pred:0.020171528682112694, decouple_loss:0.007576423697173595
Iteration: 2827, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44995543360710144
The generated pressure mean: 0.45080244541168213
loss_pred:0.01829676888883114, decouple_loss:0.008558728732168674
loss_pred:0.020099427551031113, decouple_loss:0.00850916001945734
The generated pressure mean: 0.4520326256752014
loss_pred:0.01980639062821865, decouple_loss:0.008521704003214836
Iteration: 2828, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502076208591461
The generated pressure mean: 0.45617949962615967
loss_pred:0.01973479613661766, decouple_loss:0.007408046629279852
loss_pred:0.02008221112191677, decouple_loss:0.007284701801836491
The generated pressure mean: 0.44980761408805847
loss_pred:0.022291909903287888, decouple_loss:0.007575462106615305
Iteration: 2829, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4389401972293854
The generated pressure mean: 0.4396462142467499
loss_pred:0.02145267091691494, decouple_loss:0.007426621858030558
loss_pred:0.019540935754776, decouple_loss:0.00747227156534791
The generated pressure mean: 0.439044326543808
loss_pred:0.020141690969467163, decouple_loss:0.007572509814053774
Iteration: 2830, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44270068407058716
loss_pred:0.01974480040371418, decouple_loss:0.00881562102586031
The generated pressure mean: 0.4453160762786865
loss_pred:0.020124755799770355, decouple_loss:0.008742112666368484
The generated pressure mean: 0.44777292013168335
loss_pred:0.020880436524748802, decouple_loss:0.00870529655367136
2023-04-16 22:47:44 testing...
The generated pressure mean: 0.4119930565357208
The generated pressure mean: 0.41832050681114197
The generated pressure mean: 0.4204344153404236
loss_pred:0.03321442753076553, decouple_loss:0.011195067316293716
loss_pred:0.03208128362894058, decouple_loss:0.01127119641751051
loss_pred:0.03172389790415764, decouple_loss:0.011450919322669506
WV_0_PC_0_EH_1_PS_40, loss: 0.032905157655477524, avg_mse: 0.04702923819422722
current test mse: 0.047029
Iteration: 2831, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4589861333370209
loss_pred:0.018960321322083473, decouple_loss:0.010537399910390377
The generated pressure mean: 0.4532972276210785
loss_pred:0.02024131454527378, decouple_loss:0.010500645264983177
The generated pressure mean: 0.4610722064971924
loss_pred:0.019836148247122765, decouple_loss:0.01041265670210123
Iteration: 2832, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44886937737464905
loss_pred:0.01989920251071453, decouple_loss:0.009029919281601906
The generated pressure mean: 0.4476351737976074
loss_pred:0.019348880276083946, decouple_loss:0.008926051668822765
The generated pressure mean: 0.4449083209037781
loss_pred:0.01941663771867752, decouple_loss:0.00905638001859188
Iteration: 2833, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449154734611511
loss_pred:0.021050650626420975, decouple_loss:0.00741223432123661
The generated pressure mean: 0.4353347718715668
loss_pred:0.02135356143116951, decouple_loss:0.007408334407955408
The generated pressure mean: 0.44072243571281433
loss_pred:0.020286116749048233, decouple_loss:0.007482217624783516
Iteration: 2834, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44721123576164246
loss_pred:0.01995111256837845, decouple_loss:0.008109843358397484
The generated pressure mean: 0.44697555899620056
loss_pred:0.018864944577217102, decouple_loss:0.008109740912914276
The generated pressure mean: 0.4425748884677887
loss_pred:0.02044333703815937, decouple_loss:0.008278749883174896
Iteration: 2835, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44950634241104126
loss_pred:0.020249638706445694, decouple_loss:0.008597183041274548
The generated pressure mean: 0.4399893283843994
loss_pred:0.020554285496473312, decouple_loss:0.00848658662289381
The generated pressure mean: 0.4483020603656769
loss_pred:0.02109610103070736, decouple_loss:0.008375761099159718
Iteration: 2836, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4408171474933624
loss_pred:0.019446441903710365, decouple_loss:0.009227719157934189
The generated pressure mean: 0.4438858926296234
loss_pred:0.019649740308523178, decouple_loss:0.00929025374352932
The generated pressure mean: 0.44458284974098206
loss_pred:0.02054949663579464, decouple_loss:0.009380564093589783
Iteration: 2837, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489689767360687
loss_pred:0.021804161369800568, decouple_loss:0.008989955298602581
The generated pressure mean: 0.45078837871551514
loss_pred:0.01880515180528164, decouple_loss:0.00896134227514267
The generated pressure mean: 0.44840008020401
loss_pred:0.01972460001707077, decouple_loss:0.008817342109978199
Iteration: 2838, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45100441575050354
loss_pred:0.019587449729442596, decouple_loss:0.008800739422440529
The generated pressure mean: 0.45011210441589355
loss_pred:0.020345641300082207, decouple_loss:0.008804035373032093
The generated pressure mean: 0.45398345589637756
loss_pred:0.021313266828656197, decouple_loss:0.008923078887164593
Iteration: 2839, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44052955508232117
loss_pred:0.018480107188224792, decouple_loss:0.009566636756062508
The generated pressure mean: 0.4428759217262268
loss_pred:0.018857339397072792, decouple_loss:0.009576413780450821
The generated pressure mean: 0.44433844089508057
loss_pred:0.02077329531311989, decouple_loss:0.009559976868331432
Iteration: 2840, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487473964691162
loss_pred:0.019809305667877197, decouple_loss:0.008732498623430729
The generated pressure mean: 0.45152074098587036
loss_pred:0.01958296447992325, decouple_loss:0.008704693987965584
The generated pressure mean: 0.44442763924598694
loss_pred:0.020858289673924446, decouple_loss:0.00871290359646082
2023-04-16 22:49:36 testing...
The generated pressure mean: 0.4156123697757721
The generated pressure mean: 0.42196720838546753
loss_pred:0.03270215913653374, decouple_loss:0.00871635414659977
The generated pressure mean: 0.42411836981773376
loss_pred:0.0315435454249382, decouple_loss:0.008942498825490475
loss_pred:0.03113071247935295, decouple_loss:0.009082476608455181
WV_0_PC_0_EH_1_PS_40, loss: 0.03223782777786255, avg_mse: 0.04662589728832245
current test mse: 0.046626
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 2841, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485507905483246
loss_pred:0.01993275247514248, decouple_loss:0.008502022363245487
The generated pressure mean: 0.4474948048591614
The generated pressure mean: 0.44798344373703003
loss_pred:0.019591188058257103, decouple_loss:0.008488205261528492
loss_pred:0.019369127228856087, decouple_loss:0.008328195661306381
Iteration: 2842, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44348809123039246
loss_pred:0.020736251026391983, decouple_loss:0.010810770094394684
The generated pressure mean: 0.44369685649871826
loss_pred:0.019949980080127716, decouple_loss:0.010618429630994797
The generated pressure mean: 0.44143399596214294
loss_pred:0.021240685135126114, decouple_loss:0.010771616362035275
Iteration: 2843, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4443628787994385
loss_pred:0.020222017541527748, decouple_loss:0.008388604037463665
The generated pressure mean: 0.4433721601963043
loss_pred:0.019636018201708794, decouple_loss:0.008328328840434551
The generated pressure mean: 0.44854119420051575
loss_pred:0.01959867775440216, decouple_loss:0.008394270204007626
Iteration: 2844, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501849412918091
The generated pressure mean: 0.44981032609939575
loss_pred:0.020750125870108604, decouple_loss:0.01013857126235962
loss_pred:0.019289406016469002, decouple_loss:0.010016612708568573
The generated pressure mean: 0.4477243423461914
loss_pred:0.020981786772608757, decouple_loss:0.010321841575205326
Iteration: 2845, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470190703868866
The generated pressure mean: 0.4515400230884552
loss_pred:0.019605927169322968, decouple_loss:0.009370803833007812
loss_pred:0.01992783695459366, decouple_loss:0.009569034911692142
The generated pressure mean: 0.45271018147468567
loss_pred:0.019436147063970566, decouple_loss:0.009345423430204391
Iteration: 2846, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4444933831691742
loss_pred:0.019592024385929108, decouple_loss:0.008106990717351437
The generated pressure mean: 0.4482460021972656
The generated pressure mean: 0.4432089328765869
loss_pred:0.01887916401028633, decouple_loss:0.00808755587786436
loss_pred:0.017887044697999954, decouple_loss:0.008072221651673317
Iteration: 2847, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4413609802722931
loss_pred:0.019467951729893684, decouple_loss:0.009832805022597313
The generated pressure mean: 0.44148996472358704
loss_pred:0.018269412219524384, decouple_loss:0.009516200050711632
The generated pressure mean: 0.4471776783466339
loss_pred:0.019533643499016762, decouple_loss:0.009512499906122684
Iteration: 2848, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44670921564102173
loss_pred:0.020174212753772736, decouple_loss:0.01008967962116003
The generated pressure mean: 0.44872021675109863
loss_pred:0.019270911812782288, decouple_loss:0.01020813174545765
The generated pressure mean: 0.44630736112594604
loss_pred:0.019741008058190346, decouple_loss:0.010220933705568314
Iteration: 2849, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.444862961769104
loss_pred:0.018779108300805092, decouple_loss:0.007557282689958811
The generated pressure mean: 0.44504326581954956
loss_pred:0.020101260393857956, decouple_loss:0.007604826241731644
The generated pressure mean: 0.44627052545547485
loss_pred:0.019078509882092476, decouple_loss:0.007941888645291328
Iteration: 2850, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462697505950928
The generated pressure mean: 0.4509786367416382
loss_pred:0.019423993304371834, decouple_loss:0.008231468498706818
loss_pred:0.018545955419540405, decouple_loss:0.008145119063556194
The generated pressure mean: 0.44911447167396545
loss_pred:0.01981443352997303, decouple_loss:0.008021456189453602
2023-04-16 22:52:10 testing...
The generated pressure mean: 0.413774311542511
The generated pressure mean: 0.419474333524704
The generated pressure mean: 0.42136049270629883
loss_pred:0.03206753358244896, decouple_loss:0.00924835167825222
loss_pred:0.03120081126689911, decouple_loss:0.009180841036140919
loss_pred:0.030535932630300522, decouple_loss:0.009281201288104057
WV_0_PC_0_EH_1_PS_40, loss: 0.03172993287444115, avg_mse: 0.044970087707042694
current test mse: 0.04497
Iteration: 2851, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4510039985179901
loss_pred:0.017602015286684036, decouple_loss:0.008520456030964851
The generated pressure mean: 0.4528869688510895
loss_pred:0.019826514646410942, decouple_loss:0.00862276554107666
The generated pressure mean: 0.4504953622817993
loss_pred:0.018883563578128815, decouple_loss:0.00862456951290369
Iteration: 2852, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485083818435669
loss_pred:0.0195461418479681, decouple_loss:0.0086362324655056
The generated pressure mean: 0.45377489924430847
loss_pred:0.0184890516102314, decouple_loss:0.00829360168427229
The generated pressure mean: 0.45052486658096313
loss_pred:0.01939372718334198, decouple_loss:0.008403383195400238
Iteration: 2853, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45023542642593384
loss_pred:0.017924698069691658, decouple_loss:0.008548024110496044
The generated pressure mean: 0.45299696922302246
loss_pred:0.01894201710820198, decouple_loss:0.008665500208735466
The generated pressure mean: 0.44748929142951965
loss_pred:0.01971372961997986, decouple_loss:0.008549368940293789
Iteration: 2854, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4368349611759186
The generated pressure mean: 0.43980464339256287
loss_pred:0.022010134533047676, decouple_loss:0.008381147868931293
loss_pred:0.019481852650642395, decouple_loss:0.008218173868954182
The generated pressure mean: 0.436021089553833
loss_pred:0.01899661310017109, decouple_loss:0.008370698429644108
Iteration: 2855, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43628671765327454
The generated pressure mean: 0.4421965479850769
loss_pred:0.01882771961390972, decouple_loss:0.0076132770627737045
loss_pred:0.020164085552096367, decouple_loss:0.007765767630189657
The generated pressure mean: 0.43966248631477356
loss_pred:0.018857497721910477, decouple_loss:0.007742191664874554
Iteration: 2856, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46068230271339417
The generated pressure mean: 0.45686104893684387
loss_pred:0.02208990789949894, decouple_loss:0.007937385700643063
loss_pred:0.02067650854587555, decouple_loss:0.007945590652525425
The generated pressure mean: 0.4553125202655792
loss_pred:0.02010330930352211, decouple_loss:0.007869347929954529
Iteration: 2857, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463498294353485The generated pressure mean: 0.4486790895462036
loss_pred:0.02025657519698143, decouple_loss:0.009449096396565437loss_pred:0.02016025222837925, decouple_loss:0.009347742423415184
The generated pressure mean: 0.4495351314544678
loss_pred:0.019823437556624413, decouple_loss:0.0093438271433115
Iteration: 2858, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480806887149811
loss_pred:0.01869278959929943, decouple_loss:0.00874922052025795
The generated pressure mean: 0.4502544105052948
loss_pred:0.01934659294784069, decouple_loss:0.009121398441493511
The generated pressure mean: 0.45100900530815125
loss_pred:0.018651500344276428, decouple_loss:0.008817406371235847
Iteration: 2859, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44762617349624634
loss_pred:0.018617767840623856, decouple_loss:0.007389863021671772
The generated pressure mean: 0.4474239945411682
The generated pressure mean: 0.4492190480232239
loss_pred:0.0207322146743536, decouple_loss:0.007551371585577726
loss_pred:0.019922126084566116, decouple_loss:0.007411815691739321
Iteration: 2860, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4337456524372101
loss_pred:0.018704703077673912, decouple_loss:0.007430656347423792
The generated pressure mean: 0.434876024723053
loss_pred:0.01971926912665367, decouple_loss:0.007550424430519342
The generated pressure mean: 0.436032772064209
loss_pred:0.01944652944803238, decouple_loss:0.007494041696190834
2023-04-16 22:54:04 testing...
The generated pressure mean: 0.4147453308105469
The generated pressure mean: 0.4210304021835327
The generated pressure mean: 0.42317917943000793
loss_pred:0.03251371905207634, decouple_loss:0.010081796906888485
loss_pred:0.03142588213086128, decouple_loss:0.010300379246473312
loss_pred:0.03108539804816246, decouple_loss:0.010429074056446552
WV_0_PC_0_EH_1_PS_40, loss: 0.032188523560762405, avg_mse: 0.04609942436218262
current test mse: 0.046099
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 2861, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4455500841140747
loss_pred:0.019255749881267548, decouple_loss:0.00963545497506857
The generated pressure mean: 0.44868162274360657
loss_pred:0.01861880160868168, decouple_loss:0.009677569381892681
The generated pressure mean: 0.4553890526294708
loss_pred:0.020507430657744408, decouple_loss:0.009553398936986923
Iteration: 2862, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45674794912338257
loss_pred:0.01856936514377594, decouple_loss:0.01002619881182909
The generated pressure mean: 0.4644237756729126
loss_pred:0.019111046567559242, decouple_loss:0.010015320032835007
The generated pressure mean: 0.46395546197891235
loss_pred:0.019343513995409012, decouple_loss:0.010021715424954891
Iteration: 2863, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459091126918793
loss_pred:0.01933930441737175, decouple_loss:0.00829675979912281
The generated pressure mean: 0.43964695930480957
loss_pred:0.019218795001506805, decouple_loss:0.008220728486776352
The generated pressure mean: 0.4424935579299927
loss_pred:0.020905669778585434, decouple_loss:0.008247008547186852
Iteration: 2864, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4375261962413788
loss_pred:0.021120650693774223, decouple_loss:0.008803782053291798
The generated pressure mean: 0.44520992040634155
loss_pred:0.018641771748661995, decouple_loss:0.008774664252996445
The generated pressure mean: 0.4423731863498688
loss_pred:0.019370194524526596, decouple_loss:0.008836229331791401
Iteration: 2865, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4446154534816742
loss_pred:0.01988905481994152, decouple_loss:0.00829150527715683
The generated pressure mean: 0.4361709654331207
loss_pred:0.0195807795971632, decouple_loss:0.008342902176082134
The generated pressure mean: 0.44141027331352234
loss_pred:0.018396493047475815, decouple_loss:0.008211889304220676
Iteration: 2866, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45219704508781433
loss_pred:0.01978258043527603, decouple_loss:0.008319982327520847
The generated pressure mean: 0.44786497950553894
loss_pred:0.019227929413318634, decouple_loss:0.008459285832941532
The generated pressure mean: 0.4504099488258362
loss_pred:0.01931050606071949, decouple_loss:0.008283555507659912
Iteration: 2867, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45530250668525696
loss_pred:0.020214572548866272, decouple_loss:0.009204410016536713
The generated pressure mean: 0.45462602376937866
loss_pred:0.021353986114263535, decouple_loss:0.009130812250077724
The generated pressure mean: 0.45386847853660583
loss_pred:0.01877162605524063, decouple_loss:0.009294587187469006
Iteration: 2868, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460245370864868
loss_pred:0.01887570135295391, decouple_loss:0.009020747616887093
The generated pressure mean: 0.44870084524154663
loss_pred:0.019520312547683716, decouple_loss:0.009066780097782612
The generated pressure mean: 0.4418220818042755
loss_pred:0.019289080053567886, decouple_loss:0.008851482532918453
Iteration: 2869, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4375603199005127
loss_pred:0.019938260316848755, decouple_loss:0.008057083934545517
The generated pressure mean: 0.4408869445323944
loss_pred:0.01981819048523903, decouple_loss:0.00797133706510067
The generated pressure mean: 0.44402220845222473
loss_pred:0.022126518189907074, decouple_loss:0.008070411160588264
Iteration: 2870, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4406340420246124
loss_pred:0.019368642941117287, decouple_loss:0.009291248396039009
The generated pressure mean: 0.4456915855407715
The generated pressure mean: 0.4406352639198303
loss_pred:0.019750379025936127, decouple_loss:0.009363872930407524
loss_pred:0.019994374364614487, decouple_loss:0.009055002592504025
2023-04-16 22:56:34 testing...
The generated pressure mean: 0.41403982043266296
The generated pressure mean: 0.42070886492729187
The generated pressure mean: 0.4223083257675171
loss_pred:0.0329904668033123, decouple_loss:0.00988068524748087
loss_pred:0.031180351972579956, decouple_loss:0.010005529969930649
loss_pred:0.0317157506942749, decouple_loss:0.009908782318234444
WV_0_PC_0_EH_1_PS_40, loss: 0.032458774745464325, avg_mse: 0.0465540774166584
current test mse: 0.046554
Iteration: 2871, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45329549908638
loss_pred:0.01891617476940155, decouple_loss:0.009202464483678341
The generated pressure mean: 0.4495576024055481
loss_pred:0.02014477178454399, decouple_loss:0.009272998198866844
The generated pressure mean: 0.4533783197402954
loss_pred:0.018644418567419052, decouple_loss:0.009259192273020744
Iteration: 2872, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4523026943206787
loss_pred:0.01958124339580536, decouple_loss:0.008248597383499146
The generated pressure mean: 0.45089656114578247
loss_pred:0.019123950973153114, decouple_loss:0.00811887439340353
The generated pressure mean: 0.45004352927207947
loss_pred:0.01957463100552559, decouple_loss:0.00823191087692976
Iteration: 2873, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44842246174812317
loss_pred:0.020297495648264885, decouple_loss:0.011393295601010323
The generated pressure mean: 0.44468894600868225
loss_pred:0.019990552216768265, decouple_loss:0.011281118728220463
The generated pressure mean: 0.449601948261261
loss_pred:0.020579487085342407, decouple_loss:0.011316510848701
Iteration: 2874, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43009674549102783
loss_pred:0.019745565950870514, decouple_loss:0.00876444298774004
The generated pressure mean: 0.43112048506736755
The generated pressure mean: 0.4361456036567688
loss_pred:0.020246431231498718, decouple_loss:0.008683385327458382
loss_pred:0.018217453733086586, decouple_loss:0.00859446544200182
Iteration: 2875, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490279257297516
loss_pred:0.0187869630753994, decouple_loss:0.008652718737721443
The generated pressure mean: 0.4519563615322113
loss_pred:0.01947159320116043, decouple_loss:0.008858625777065754
The generated pressure mean: 0.45493969321250916
loss_pred:0.019470540806651115, decouple_loss:0.008519352413713932
Iteration: 2876, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45762383937835693
loss_pred:0.018805718049407005, decouple_loss:0.009070768021047115
The generated pressure mean: 0.45606786012649536
loss_pred:0.019014783203601837, decouple_loss:0.009083891287446022
The generated pressure mean: 0.45622870326042175
loss_pred:0.020797045901417732, decouple_loss:0.009273195639252663
Iteration: 2877, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44068580865859985
loss_pred:0.01916155032813549, decouple_loss:0.0074775330722332
The generated pressure mean: 0.44152048230171204
The generated pressure mean: 0.44027969241142273
loss_pred:0.01960216648876667, decouple_loss:0.007563460152596235
loss_pred:0.019799234345555305, decouple_loss:0.00754525838419795
Iteration: 2878, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44735050201416016
loss_pred:0.019127190113067627, decouple_loss:0.007978427223861217
The generated pressure mean: 0.45131683349609375
The generated pressure mean: 0.44577667117118835
loss_pred:0.019304325804114342, decouple_loss:0.007822005078196526
loss_pred:0.018792472779750824, decouple_loss:0.007639739662408829
Iteration: 2879, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44957736134529114
loss_pred:0.01971757411956787, decouple_loss:0.00891026109457016
The generated pressure mean: 0.4457022547721863
The generated pressure mean: 0.45001420378685
loss_pred:0.018369704484939575, decouple_loss:0.009210032410919666
loss_pred:0.02006165310740471, decouple_loss:0.009072168730199337
Iteration: 2880, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43946367502212524
loss_pred:0.019060445949435234, decouple_loss:0.008438216522336006
The generated pressure mean: 0.44127562642097473
The generated pressure mean: 0.43929967284202576
loss_pred:0.01851513609290123, decouple_loss:0.00840978603810072
loss_pred:0.020537719130516052, decouple_loss:0.008341129869222641
2023-04-16 22:58:27 testing...
The generated pressure mean: 0.4149768054485321
The generated pressure mean: 0.4209541082382202
The generated pressure mean: 0.4225712716579437
loss_pred:0.03167027607560158, decouple_loss:0.008171265944838524
loss_pred:0.030965929850935936, decouple_loss:0.008380351588129997
loss_pred:0.030225925147533417, decouple_loss:0.008486710488796234
WV_0_PC_0_EH_1_PS_40, loss: 0.0313713513314724, avg_mse: 0.044708944857120514
current test mse: 0.044709
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 2881, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449672669172287
loss_pred:0.019184181466698647, decouple_loss:0.007532775867730379
The generated pressure mean: 0.4471319913864136
loss_pred:0.02202925644814968, decouple_loss:0.007765239104628563
The generated pressure mean: 0.4464819133281708
loss_pred:0.021647701039910316, decouple_loss:0.007621925789862871
Iteration: 2882, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45268577337265015
loss_pred:0.020611843094229698, decouple_loss:0.008354643359780312
The generated pressure mean: 0.4497128427028656
loss_pred:0.021955830976366997, decouple_loss:0.00821027159690857
The generated pressure mean: 0.44997072219848633
loss_pred:0.020617133006453514, decouple_loss:0.00841408409178257
Iteration: 2883, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44497498869895935
The generated pressure mean: 0.4456792175769806
loss_pred:0.02201223373413086, decouple_loss:0.009747859090566635
loss_pred:0.01951376534998417, decouple_loss:0.009610660374164581
The generated pressure mean: 0.4452950358390808
loss_pred:0.019876250997185707, decouple_loss:0.009601718746125698
Iteration: 2884, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45069947838783264
loss_pred:0.02039530873298645, decouple_loss:0.008364370092749596
The generated pressure mean: 0.44862431287765503
loss_pred:0.022025149315595627, decouple_loss:0.00845098402351141
The generated pressure mean: 0.4540150761604309
loss_pred:0.020156286656856537, decouple_loss:0.008465458638966084
Iteration: 2885, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4515613615512848
loss_pred:0.020632077008485794, decouple_loss:0.007908158004283905
The generated pressure mean: 0.45492175221443176
loss_pred:0.020461441949009895, decouple_loss:0.007906423881649971
The generated pressure mean: 0.4559999406337738
loss_pred:0.020611323416233063, decouple_loss:0.00801908690482378
Iteration: 2886, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44695037603378296
loss_pred:0.020154882222414017, decouple_loss:0.008136708289384842
The generated pressure mean: 0.4479716420173645
loss_pred:0.021687425673007965, decouple_loss:0.008112768642604351
The generated pressure mean: 0.44722333550453186
loss_pred:0.0198267363011837, decouple_loss:0.008208878338336945
Iteration: 2887, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43768659234046936
loss_pred:0.01975056901574135, decouple_loss:0.007565617095679045
The generated pressure mean: 0.44023534655570984
loss_pred:0.020424772053956985, decouple_loss:0.007502495776861906
The generated pressure mean: 0.44645243883132935
loss_pred:0.021156247705221176, decouple_loss:0.007663634140044451
Iteration: 2888, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4405428469181061
loss_pred:0.022607462480664253, decouple_loss:0.009199188090860844
The generated pressure mean: 0.4425932765007019
The generated pressure mean: 0.44055798649787903
loss_pred:0.020344853401184082, decouple_loss:0.009180823341012001
loss_pred:0.019697876647114754, decouple_loss:0.009239478036761284
Iteration: 2889, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44796982407569885
loss_pred:0.01966872811317444, decouple_loss:0.009241500869393349
The generated pressure mean: 0.4490838050842285
The generated pressure mean: 0.44833728671073914
loss_pred:0.020771721377968788, decouple_loss:0.009281321428716183
loss_pred:0.020530689507722855, decouple_loss:0.009237968362867832
Iteration: 2890, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4574876129627228
loss_pred:0.01869417168200016, decouple_loss:0.008057919330894947
The generated pressure mean: 0.4584084451198578
loss_pred:0.02150149457156658, decouple_loss:0.0081021161749959
The generated pressure mean: 0.45639145374298096
loss_pred:0.020258145406842232, decouple_loss:0.008126433938741684
2023-04-16 23:00:58 testing...
The generated pressure mean: 0.41449621319770813
The generated pressure mean: 0.41967910528182983
loss_pred:0.03216469660401344, decouple_loss:0.0084303580224514
The generated pressure mean: 0.42155855894088745
loss_pred:0.031019221991300583, decouple_loss:0.008519397117197514
loss_pred:0.030544282868504524, decouple_loss:0.008670210838317871
WV_0_PC_0_EH_1_PS_40, loss: 0.031669732183218, avg_mse: 0.04505903273820877
current test mse: 0.045059
Iteration: 2891, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45067012310028076
loss_pred:0.02127346210181713, decouple_loss:0.008207748644053936
The generated pressure mean: 0.4509701132774353
loss_pred:0.020612910389900208, decouple_loss:0.007964104413986206
The generated pressure mean: 0.4501661956310272
loss_pred:0.019793925806879997, decouple_loss:0.00805044174194336
Iteration: 2892, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487345516681671
loss_pred:0.020036766305565834, decouple_loss:0.00777090061455965
The generated pressure mean: 0.44428086280822754
loss_pred:0.01997040957212448, decouple_loss:0.0077308351173996925
The generated pressure mean: 0.4474108815193176
loss_pred:0.01995614729821682, decouple_loss:0.008037310093641281
Iteration: 2893, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44227686524391174
loss_pred:0.020743895322084427, decouple_loss:0.008783325552940369
The generated pressure mean: 0.44781383872032166
loss_pred:0.020464373752474785, decouple_loss:0.00870335940271616
The generated pressure mean: 0.4461529850959778
loss_pred:0.020183956250548363, decouple_loss:0.00877486914396286
Iteration: 2894, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491376280784607
loss_pred:0.01942937634885311, decouple_loss:0.010069305077195168
The generated pressure mean: 0.4433761239051819
loss_pred:0.021217213943600655, decouple_loss:0.00983758457005024
The generated pressure mean: 0.4459807276725769
loss_pred:0.02086176909506321, decouple_loss:0.009906493127346039
Iteration: 2895, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44423431158065796
loss_pred:0.0196977648884058, decouple_loss:0.00790479127317667
The generated pressure mean: 0.4427853524684906
loss_pred:0.0209015104919672, decouple_loss:0.007907436229288578
The generated pressure mean: 0.4449670910835266
loss_pred:0.020503565669059753, decouple_loss:0.007937166839838028
Iteration: 2896, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4509546160697937
loss_pred:0.024376260116696358, decouple_loss:0.0076131513342261314
The generated pressure mean: 0.4529641270637512
loss_pred:0.020333558320999146, decouple_loss:0.007506341207772493
The generated pressure mean: 0.45035529136657715
loss_pred:0.02112022042274475, decouple_loss:0.007742487825453281
Iteration: 2897, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.433356374502182
loss_pred:0.02069443091750145, decouple_loss:0.009631210938096046
The generated pressure mean: 0.4338056743144989
loss_pred:0.020535606890916824, decouple_loss:0.009559635072946548
The generated pressure mean: 0.43287408351898193
loss_pred:0.019718782976269722, decouple_loss:0.009470713324844837
Iteration: 2898, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45691627264022827
loss_pred:0.01962849870324135, decouple_loss:0.008972578682005405
The generated pressure mean: 0.45587509870529175
loss_pred:0.02117488905787468, decouple_loss:0.009021812118589878
The generated pressure mean: 0.45482003688812256
loss_pred:0.021161425858736038, decouple_loss:0.008949213661253452
Iteration: 2899, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46566641330718994
The generated pressure mean: 0.4592224955558777
loss_pred:0.021073000505566597, decouple_loss:0.009074391797184944
loss_pred:0.01972125843167305, decouple_loss:0.00896492786705494
The generated pressure mean: 0.46231991052627563
loss_pred:0.019535761326551437, decouple_loss:0.009052003733813763
Iteration: 2900, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44158944487571716
loss_pred:0.02133788727223873, decouple_loss:0.008766025304794312
The generated pressure mean: 0.4499148428440094
loss_pred:0.020036619156599045, decouple_loss:0.008827872574329376
The generated pressure mean: 0.4455227255821228
loss_pred:0.020241884514689445, decouple_loss:0.008760572411119938
2023-04-16 23:02:52 testing...
The generated pressure mean: 0.4245680272579193
The generated pressure mean: 0.4185056686401367
loss_pred:0.030567949637770653, decouple_loss:0.0079430490732193
The generated pressure mean: 0.42636966705322266
loss_pred:0.031408775597810745, decouple_loss:0.007807728834450245
loss_pred:0.029785944148898125, decouple_loss:0.008141879923641682
WV_0_PC_0_EH_1_PS_40, loss: 0.030985768884420395, avg_mse: 0.044191133230924606
current test mse: 0.044191
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 2901, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4344048798084259
loss_pred:0.018718287348747253, decouple_loss:0.00748865632340312
The generated pressure mean: 0.4377773106098175
The generated pressure mean: 0.43726983666419983
loss_pred:0.020520323887467384, decouple_loss:0.007357927039265633
loss_pred:0.019276507198810577, decouple_loss:0.007340107578784227
Iteration: 2902, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4426071047782898
loss_pred:0.020495397970080376, decouple_loss:0.008302666246891022
The generated pressure mean: 0.4460711181163788
loss_pred:0.019772782921791077, decouple_loss:0.00816250592470169
The generated pressure mean: 0.4491300582885742
loss_pred:0.020972855389118195, decouple_loss:0.008160268887877464
Iteration: 2903, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4541289210319519
loss_pred:0.019996359944343567, decouple_loss:0.00984997022897005
The generated pressure mean: 0.45024141669273376
loss_pred:0.019781244918704033, decouple_loss:0.009914908558130264
The generated pressure mean: 0.45314911007881165
loss_pred:0.02046286128461361, decouple_loss:0.009823190979659557
Iteration: 2904, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44816118478775024
loss_pred:0.020617568865418434, decouple_loss:0.008962674997746944
The generated pressure mean: 0.44464996457099915
loss_pred:0.02050986886024475, decouple_loss:0.008788522332906723
The generated pressure mean: 0.44845646619796753
loss_pred:0.02113935351371765, decouple_loss:0.008862139657139778
Iteration: 2905, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45165708661079407
loss_pred:0.02060003951191902, decouple_loss:0.00825945008546114
The generated pressure mean: 0.44753891229629517
loss_pred:0.021142173558473587, decouple_loss:0.008238954469561577
The generated pressure mean: 0.44523149728775024
loss_pred:0.019016148522496223, decouple_loss:0.008244435302913189
Iteration: 2906, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45304054021835327
loss_pred:0.020154615864157677, decouple_loss:0.008447578176856041
The generated pressure mean: 0.45435917377471924
loss_pred:0.019787108525633812, decouple_loss:0.008465711027383804
The generated pressure mean: 0.4531405568122864
loss_pred:0.01965409144759178, decouple_loss:0.008353671990334988
Iteration: 2907, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44758251309394836
loss_pred:0.02015075460076332, decouple_loss:0.009043896570801735
The generated pressure mean: 0.4479127526283264
loss_pred:0.019363686442375183, decouple_loss:0.009255937300622463
The generated pressure mean: 0.4462990164756775
loss_pred:0.02087201178073883, decouple_loss:0.009207263588905334
Iteration: 2908, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470059275627136
The generated pressure mean: 0.44528838992118835
loss_pred:0.019612355157732964, decouple_loss:0.009552504867315292
loss_pred:0.021068207919597626, decouple_loss:0.009349338710308075
The generated pressure mean: 0.44937944412231445
loss_pred:0.019251646474003792, decouple_loss:0.009344302117824554
Iteration: 2909, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495391547679901
The generated pressure mean: 0.45614174008369446
loss_pred:0.02063843235373497, decouple_loss:0.007833299227058887
loss_pred:0.020144345238804817, decouple_loss:0.008009165525436401
The generated pressure mean: 0.4557652473449707
loss_pred:0.0189022459089756, decouple_loss:0.007871022447943687
Iteration: 2910, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491690993309021
The generated pressure mean: 0.4451739490032196
loss_pred:0.019010668620467186, decouple_loss:0.008316331543028355
loss_pred:0.020913314074277878, decouple_loss:0.008366147987544537
The generated pressure mean: 0.4484243094921112
loss_pred:0.01948804408311844, decouple_loss:0.008336127735674381
2023-04-16 23:05:23 testing...
The generated pressure mean: 0.417381227016449
The generated pressure mean: 0.4233263432979584
loss_pred:0.031792256981134415, decouple_loss:0.008983192965388298
The generated pressure mean: 0.42548656463623047
loss_pred:0.030694661661982536, decouple_loss:0.00907448586076498
loss_pred:0.030059924349188805, decouple_loss:0.009277320466935635
WV_0_PC_0_EH_1_PS_40, loss: 0.031304530799388885, avg_mse: 0.04472750425338745
current test mse: 0.044728
Iteration: 2911, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43977123498916626
loss_pred:0.019884958863258362, decouple_loss:0.008507995866239071
The generated pressure mean: 0.4400218427181244
loss_pred:0.01928006112575531, decouple_loss:0.00867852009832859
The generated pressure mean: 0.43455955386161804
loss_pred:0.019458401948213577, decouple_loss:0.008576133288443089
Iteration: 2912, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45079943537712097
loss_pred:0.02000519633293152, decouple_loss:0.007784114219248295
The generated pressure mean: 0.4416387677192688
loss_pred:0.018049299716949463, decouple_loss:0.0076221683993935585
The generated pressure mean: 0.45251014828681946
loss_pred:0.020278606563806534, decouple_loss:0.007849925197660923
Iteration: 2913, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4586617648601532
loss_pred:0.020910676568746567, decouple_loss:0.00785784237086773
The generated pressure mean: 0.4556241035461426
loss_pred:0.021434830501675606, decouple_loss:0.007850565947592258
The generated pressure mean: 0.45384901762008667
loss_pred:0.020346511155366898, decouple_loss:0.007896915078163147
Iteration: 2914, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4424879848957062
loss_pred:0.021428655833005905, decouple_loss:0.009738517925143242
The generated pressure mean: 0.44495889544487
loss_pred:0.019993603229522705, decouple_loss:0.009603925049304962
The generated pressure mean: 0.44120994210243225
loss_pred:0.021208619698882103, decouple_loss:0.00956152006983757
Iteration: 2915, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44809865951538086
loss_pred:0.020953617990016937, decouple_loss:0.008539566770195961
The generated pressure mean: 0.44170981645584106
loss_pred:0.02032620459794998, decouple_loss:0.00868758000433445
The generated pressure mean: 0.44720229506492615
loss_pred:0.022722681984305382, decouple_loss:0.008707542903721333
Iteration: 2916, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45026087760925293
loss_pred:0.01919071562588215, decouple_loss:0.00846122670918703
The generated pressure mean: 0.45154017210006714
loss_pred:0.02242489531636238, decouple_loss:0.008374152705073357
The generated pressure mean: 0.4510940909385681
loss_pred:0.018867051228880882, decouple_loss:0.008387663401663303
Iteration: 2917, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4518575370311737
loss_pred:0.020481955260038376, decouple_loss:0.009028573520481586
The generated pressure mean: 0.44775405526161194
loss_pred:0.01991581916809082, decouple_loss:0.008841874077916145
The generated pressure mean: 0.45389288663864136
loss_pred:0.020511461421847343, decouple_loss:0.008879085071384907
Iteration: 2918, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489290118217468
The generated pressure mean: 0.44314587116241455
loss_pred:0.02149556577205658, decouple_loss:0.007977725937962532
loss_pred:0.020634885877370834, decouple_loss:0.008203445933759212
The generated pressure mean: 0.445592999458313
loss_pred:0.02001599408686161, decouple_loss:0.008062667213380337
Iteration: 2919, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4426899552345276
loss_pred:0.022596728056669235, decouple_loss:0.009108061902225018
The generated pressure mean: 0.4455212652683258
loss_pred:0.020570263266563416, decouple_loss:0.009166528470814228
The generated pressure mean: 0.4470236599445343
loss_pred:0.020432893186807632, decouple_loss:0.009095445275306702
Iteration: 2920, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4416443407535553
loss_pred:0.01969430409371853, decouple_loss:0.010530086234211922
The generated pressure mean: 0.4462372958660126
loss_pred:0.019704092293977737, decouple_loss:0.010264366865158081
The generated pressure mean: 0.44268330931663513
loss_pred:0.018846824765205383, decouple_loss:0.010208072140812874
2023-04-16 23:07:17 testing...
The generated pressure mean: 0.413551390171051
The generated pressure mean: 0.4201895296573639
The generated pressure mean: 0.4221056401729584
loss_pred:0.03443754091858864, decouple_loss:0.009179065003991127
loss_pred:0.03293031081557274, decouple_loss:0.009335493668913841
loss_pred:0.03255035728216171, decouple_loss:0.009490379132330418
WV_0_PC_0_EH_1_PS_40, loss: 0.03377281874418259, avg_mse: 0.04936947673559189
current test mse: 0.049369
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 2921, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44969236850738525
loss_pred:0.021425418555736542, decouple_loss:0.0088359909132123
The generated pressure mean: 0.45537546277046204
loss_pred:0.019947044551372528, decouple_loss:0.008849161677062511
The generated pressure mean: 0.4563617408275604
loss_pred:0.018950531259179115, decouple_loss:0.00896455068141222
Iteration: 2922, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4552479684352875
loss_pred:0.019545376300811768, decouple_loss:0.008370143361389637
The generated pressure mean: 0.4506389796733856
loss_pred:0.019573397934436798, decouple_loss:0.008433329872786999
The generated pressure mean: 0.4525020718574524
loss_pred:0.020566917955875397, decouple_loss:0.008414666168391705
Iteration: 2923, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442470967769623
loss_pred:0.020114270970225334, decouple_loss:0.009728732518851757
The generated pressure mean: 0.4413275718688965
loss_pred:0.020241256803274155, decouple_loss:0.00962310191243887
The generated pressure mean: 0.4385635554790497
loss_pred:0.02452956698834896, decouple_loss:0.009832360781729221
Iteration: 2924, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4428020119667053
loss_pred:0.02104918844997883, decouple_loss:0.008787890896201134
The generated pressure mean: 0.44503054022789
loss_pred:0.020341994240880013, decouple_loss:0.008990638889372349
The generated pressure mean: 0.44056475162506104
loss_pred:0.01940900832414627, decouple_loss:0.008872615173459053
Iteration: 2925, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44869983196258545
loss_pred:0.02090132050216198, decouple_loss:0.007864267565310001
The generated pressure mean: 0.4474162757396698
loss_pred:0.01927119493484497, decouple_loss:0.00801572110503912
The generated pressure mean: 0.4490145742893219
loss_pred:0.0198218896985054, decouple_loss:0.007822513580322266
Iteration: 2926, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442881643772125
loss_pred:0.020428799092769623, decouple_loss:0.007943060249090195
The generated pressure mean: 0.44526565074920654
loss_pred:0.02021203190088272, decouple_loss:0.008121336810290813
The generated pressure mean: 0.44469547271728516
loss_pred:0.02076917700469494, decouple_loss:0.008056570775806904
Iteration: 2927, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45009130239486694
loss_pred:0.01913127303123474, decouple_loss:0.009021029807627201
The generated pressure mean: 0.4539366364479065
loss_pred:0.019532013684511185, decouple_loss:0.008954205550253391
The generated pressure mean: 0.44800886511802673
loss_pred:0.01975652016699314, decouple_loss:0.008944297209382057
Iteration: 2928, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45246773958206177
loss_pred:0.01957322470843792, decouple_loss:0.008989952504634857
The generated pressure mean: 0.4525860846042633
loss_pred:0.019306089729070663, decouple_loss:0.008895647712051868
The generated pressure mean: 0.4516710340976715
loss_pred:0.018726738169789314, decouple_loss:0.00885517057031393
Iteration: 2929, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472178518772125
The generated pressure mean: 0.44676995277404785
loss_pred:0.01917402446269989, decouple_loss:0.007495415862649679
loss_pred:0.018784133717417717, decouple_loss:0.0074615017510950565
The generated pressure mean: 0.44247135519981384
loss_pred:0.020637204870581627, decouple_loss:0.0074718124233186245
Iteration: 2930, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44209200143814087
loss_pred:0.01861819066107273, decouple_loss:0.008021824061870575
The generated pressure mean: 0.4417852461338043
loss_pred:0.019520258530974388, decouple_loss:0.007937433198094368
The generated pressure mean: 0.441045880317688
loss_pred:0.022450555115938187, decouple_loss:0.007963210344314575
2023-04-16 23:09:48 testing...
The generated pressure mean: 0.41666239500045776
The generated pressure mean: 0.42249608039855957
The generated pressure mean: 0.4240782856941223
loss_pred:0.032124027609825134, decouple_loss:0.00869633536785841
loss_pred:0.03092348203063011, decouple_loss:0.008921083994209766
loss_pred:0.030564043670892715, decouple_loss:0.009077050723135471
WV_0_PC_0_EH_1_PS_40, loss: 0.03164876252412796, avg_mse: 0.04523244872689247
current test mse: 0.045232
Iteration: 2931, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43995827436447144
loss_pred:0.02020055428147316, decouple_loss:0.008338785730302334
The generated pressure mean: 0.4429005980491638
loss_pred:0.01991458795964718, decouple_loss:0.008358187042176723
The generated pressure mean: 0.4413168430328369
loss_pred:0.0191202275454998, decouple_loss:0.00831481721252203
Iteration: 2932, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45711633563041687
loss_pred:0.019867366179823875, decouple_loss:0.008103132247924805
The generated pressure mean: 0.4563976526260376
loss_pred:0.018896903842687607, decouple_loss:0.0081675685942173
The generated pressure mean: 0.45833706855773926
loss_pred:0.019846845418214798, decouple_loss:0.008227569982409477
Iteration: 2933, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467802345752716
loss_pred:0.018974492326378822, decouple_loss:0.007687471807003021
The generated pressure mean: 0.44814345240592957
loss_pred:0.01931147649884224, decouple_loss:0.007384567521512508
The generated pressure mean: 0.44514837861061096
loss_pred:0.018197013065218925, decouple_loss:0.00743140559643507
Iteration: 2934, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477211534976959
The generated pressure mean: 0.44812434911727905
loss_pred:0.019925836473703384, decouple_loss:0.0071803368628025055
loss_pred:0.02061404660344124, decouple_loss:0.007121516857296228
The generated pressure mean: 0.44879934191703796
loss_pred:0.02063082531094551, decouple_loss:0.007151157129555941
Iteration: 2935, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44070562720298767
loss_pred:0.021603180095553398, decouple_loss:0.007911221124231815
The generated pressure mean: 0.44681793451309204
loss_pred:0.019210953265428543, decouple_loss:0.007806927431374788
The generated pressure mean: 0.44529446959495544
loss_pred:0.019992763176560402, decouple_loss:0.007934145629405975
Iteration: 2936, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44430992007255554
loss_pred:0.020952170714735985, decouple_loss:0.008969384245574474
The generated pressure mean: 0.44770175218582153
loss_pred:0.018782833591103554, decouple_loss:0.008973135612905025
The generated pressure mean: 0.44820481538772583
loss_pred:0.019475961104035378, decouple_loss:0.008810669183731079
Iteration: 2937, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4448579251766205
loss_pred:0.019406931474804878, decouple_loss:0.007986501790583134
The generated pressure mean: 0.4446643590927124
loss_pred:0.019735001027584076, decouple_loss:0.007988443598151207
The generated pressure mean: 0.44624316692352295
loss_pred:0.019991356879472733, decouple_loss:0.008040224201977253
Iteration: 2938, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4440177083015442
loss_pred:0.020748285576701164, decouple_loss:0.008113019168376923
The generated pressure mean: 0.4486826956272125
loss_pred:0.020015021786093712, decouple_loss:0.008017250336706638
The generated pressure mean: 0.44416311383247375
loss_pred:0.01812555454671383, decouple_loss:0.008161244913935661
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2939, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506155848503113
loss_pred:0.019309809431433678, decouple_loss:0.007399159483611584
The generated pressure mean: 0.45161503553390503
loss_pred:0.0202498696744442, decouple_loss:0.007252298761159182
The generated pressure mean: 0.4494810700416565
loss_pred:0.018636034801602364, decouple_loss:0.007329151965677738
Iteration: 2940, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45246127247810364
loss_pred:0.01974274404346943, decouple_loss:0.00807951856404543
The generated pressure mean: 0.44768282771110535
loss_pred:0.019617844372987747, decouple_loss:0.00791003555059433
The generated pressure mean: 0.4494151473045349
loss_pred:0.01944621279835701, decouple_loss:0.007953489199280739
2023-04-16 23:11:41 testing...
The generated pressure mean: 0.4217192530632019
The generated pressure mean: 0.4158627390861511
The generated pressure mean: 0.423883855342865
loss_pred:0.030747458338737488, decouple_loss:0.008265132084488869
loss_pred:0.03210357576608658, decouple_loss:0.008040889166295528
loss_pred:0.030403124168515205, decouple_loss:0.008440054021775723
WV_0_PC_0_EH_1_PS_40, loss: 0.031497154384851456, avg_mse: 0.045337554067373276
current test mse: 0.045338
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 2941, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44390565156936646
loss_pred:0.019783953204751015, decouple_loss:0.0076029603369534016
The generated pressure mean: 0.4468769133090973
loss_pred:0.019137704744935036, decouple_loss:0.007682600989937782
The generated pressure mean: 0.44540220499038696
loss_pred:0.019765207543969154, decouple_loss:0.007745606359094381
Iteration: 2942, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44320520758628845
The generated pressure mean: 0.44416141510009766loss_pred:0.021308692172169685, decouple_loss:0.007563750725239515
loss_pred:0.02007962390780449, decouple_loss:0.007512377575039864
The generated pressure mean: 0.44305408000946045
loss_pred:0.019667070358991623, decouple_loss:0.007671003229916096
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2943, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4415935277938843
The generated pressure mean: 0.4497617185115814
loss_pred:0.02012874186038971, decouple_loss:0.008053462021052837
loss_pred:0.019621551036834717, decouple_loss:0.008069085888564587
The generated pressure mean: 0.44899782538414
loss_pred:0.01962038315832615, decouple_loss:0.008245914243161678
Iteration: 2944, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467073678970337
The generated pressure mean: 0.4482259750366211
loss_pred:0.020217785611748695, decouple_loss:0.0087309954687953
loss_pred:0.01899358630180359, decouple_loss:0.008883606642484665
The generated pressure mean: 0.4480491578578949
loss_pred:0.01846843771636486, decouple_loss:0.008814996108412743
Iteration: 2945, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501940608024597
The generated pressure mean: 0.45072656869888306
loss_pred:0.01967201754450798, decouple_loss:0.008492039516568184
loss_pred:0.019545406103134155, decouple_loss:0.008423205465078354
The generated pressure mean: 0.4453964829444885
loss_pred:0.019589485600590706, decouple_loss:0.00840259063988924
Iteration: 2946, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44778209924697876
loss_pred:0.018674325197935104, decouple_loss:0.007592177018523216The generated pressure mean: 0.4465799033641815
loss_pred:0.01948786899447441, decouple_loss:0.007709374651312828
The generated pressure mean: 0.44840967655181885
loss_pred:0.01963416114449501, decouple_loss:0.0074799563735723495
Iteration: 2947, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44811373949050903
The generated pressure mean: 0.45140886306762695
loss_pred:0.021240102127194405, decouple_loss:0.0073119280859827995
loss_pred:0.019241729751229286, decouple_loss:0.007428981363773346
The generated pressure mean: 0.45118993520736694
loss_pred:0.018286902457475662, decouple_loss:0.007458904758095741
Iteration: 2948, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4371087849140167
loss_pred:0.018612364307045937, decouple_loss:0.007830196060240269
The generated pressure mean: 0.4358774721622467
loss_pred:0.018751824274659157, decouple_loss:0.007830922491848469
The generated pressure mean: 0.441030353307724
loss_pred:0.01923425868153572, decouple_loss:0.007867093198001385
Iteration: 2949, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45109209418296814
loss_pred:0.02044493891298771, decouple_loss:0.008353938348591328
The generated pressure mean: 0.44772452116012573
loss_pred:0.01980409398674965, decouple_loss:0.008441651239991188
The generated pressure mean: 0.443515419960022
loss_pred:0.018989890813827515, decouple_loss:0.00839276798069477
Iteration: 2950, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4451087415218353
The generated pressure mean: 0.4484185576438904
loss_pred:0.01892024092376232, decouple_loss:0.009038844145834446
loss_pred:0.019620845094323158, decouple_loss:0.009082002565264702
The generated pressure mean: 0.44869616627693176
loss_pred:0.019818536937236786, decouple_loss:0.009091456420719624
2023-04-16 23:14:14 testing...
The generated pressure mean: 0.41461315751075745
The generated pressure mean: 0.4203857183456421
The generated pressure mean: 0.42232567071914673
loss_pred:0.03167245164513588, decouple_loss:0.008698219433426857
loss_pred:0.03047225996851921, decouple_loss:0.008851108141243458
loss_pred:0.030053192749619484, decouple_loss:0.008987356908619404
WV_0_PC_0_EH_1_PS_40, loss: 0.0311749130487442, avg_mse: 0.04440172761678696
current test mse: 0.044402
Iteration: 2951, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45265039801597595
loss_pred:0.02004411816596985, decouple_loss:0.008342232555150986
The generated pressure mean: 0.45082801580429077
loss_pred:0.020472615957260132, decouple_loss:0.008235270157456398
The generated pressure mean: 0.45161405205726624
loss_pred:0.019121209159493446, decouple_loss:0.008308985270559788
Iteration: 2952, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4547681212425232
loss_pred:0.02010422945022583, decouple_loss:0.006907239556312561
The generated pressure mean: 0.4467307925224304
loss_pred:0.02034877985715866, decouple_loss:0.007035780232399702
The generated pressure mean: 0.44977304339408875
loss_pred:0.019015751779079437, decouple_loss:0.006918462924659252
Iteration: 2953, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44658273458480835
loss_pred:0.02109871245920658, decouple_loss:0.008886296302080154
The generated pressure mean: 0.4420783519744873
loss_pred:0.019527047872543335, decouple_loss:0.008961807005107403
The generated pressure mean: 0.44349735975265503
loss_pred:0.01870656944811344, decouple_loss:0.00891427043825388
Iteration: 2954, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43988656997680664
loss_pred:0.0204451996833086, decouple_loss:0.00848039984703064
The generated pressure mean: 0.4456520080566406
loss_pred:0.019671978428959846, decouple_loss:0.008559118956327438
The generated pressure mean: 0.4479631781578064
loss_pred:0.017934130504727364, decouple_loss:0.008650094270706177
Iteration: 2955, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.444256454706192
loss_pred:0.019086308777332306, decouple_loss:0.007206070702522993
The generated pressure mean: 0.44613197445869446
loss_pred:0.020503971725702286, decouple_loss:0.007194550707936287
The generated pressure mean: 0.4448462724685669
loss_pred:0.019678067415952682, decouple_loss:0.007111851125955582
Iteration: 2956, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45079752802848816
loss_pred:0.02000545524060726, decouple_loss:0.007838631048798561
The generated pressure mean: 0.4489956498146057
loss_pred:0.02141704596579075, decouple_loss:0.007853909395635128
The generated pressure mean: 0.4473888576030731
loss_pred:0.019029667600989342, decouple_loss:0.00791914388537407
Iteration: 2957, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44297438859939575
loss_pred:0.018387945368885994, decouple_loss:0.00807084422558546
The generated pressure mean: 0.44452807307243347
loss_pred:0.01945795863866806, decouple_loss:0.008067669346928596
The generated pressure mean: 0.445689857006073
loss_pred:0.019848398864269257, decouple_loss:0.008128898218274117
Iteration: 2958, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497559666633606
loss_pred:0.018028499558568, decouple_loss:0.00793004222214222
The generated pressure mean: 0.45142847299575806
loss_pred:0.01884554699063301, decouple_loss:0.00787779875099659
The generated pressure mean: 0.4468088448047638
loss_pred:0.019244279712438583, decouple_loss:0.007814344018697739
Iteration: 2959, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45504310727119446
loss_pred:0.019196875393390656, decouple_loss:0.008586290292441845
The generated pressure mean: 0.4543621242046356
The generated pressure mean: 0.4476235508918762
loss_pred:0.020092790946364403, decouple_loss:0.00871396716684103
loss_pred:0.020039185881614685, decouple_loss:0.008678833954036236
Iteration: 2960, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44199109077453613
loss_pred:0.019136106595396996, decouple_loss:0.008518757298588753
The generated pressure mean: 0.4453580379486084
loss_pred:0.019713381305336952, decouple_loss:0.00842332188040018
The generated pressure mean: 0.4471149444580078
loss_pred:0.02131349965929985, decouple_loss:0.008394677191972733
2023-04-16 23:16:06 testing...
The generated pressure mean: 0.41819506883621216
The generated pressure mean: 0.42441439628601074
The generated pressure mean: 0.4264023005962372
loss_pred:0.030783845111727715, decouple_loss:0.00812010932713747
loss_pred:0.029401136562228203, decouple_loss:0.008501903153955936
loss_pred:0.029682831838726997, decouple_loss:0.008260006085038185
WV_0_PC_0_EH_1_PS_40, loss: 0.030370637774467468, avg_mse: 0.04328573867678642
current test mse: 0.043286
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 2961, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4350282549858093
The generated pressure mean: 0.4406473934650421
loss_pred:0.021058648824691772, decouple_loss:0.007759686093777418
loss_pred:0.019168663769960403, decouple_loss:0.008119968697428703
The generated pressure mean: 0.43697163462638855
loss_pred:0.018697192892432213, decouple_loss:0.008012249134480953
Iteration: 2962, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508246183395386
The generated pressure mean: 0.445334255695343
loss_pred:0.020061412826180458, decouple_loss:0.0070660300552845
loss_pred:0.019317518919706345, decouple_loss:0.007154532242566347
The generated pressure mean: 0.4542917013168335
loss_pred:0.019078826531767845, decouple_loss:0.007194817997515202
Iteration: 2963, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4591180086135864
The generated pressure mean: 0.4546002447605133
loss_pred:0.018780304118990898, decouple_loss:0.007739649154245853
loss_pred:0.019990060478448868, decouple_loss:0.00737100699916482
The generated pressure mean: 0.4461688995361328
loss_pred:0.01796799711883068, decouple_loss:0.007711191661655903
Iteration: 2964, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45184609293937683
The generated pressure mean: 0.44621002674102783
loss_pred:0.019144585356116295, decouple_loss:0.008906186558306217
loss_pred:0.01759827509522438, decouple_loss:0.008851166814565659
The generated pressure mean: 0.4444080591201782
loss_pred:0.018698403611779213, decouple_loss:0.00913152564316988
Iteration: 2965, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43967559933662415
loss_pred:0.018320586532354355, decouple_loss:0.008929685689508915
The generated pressure mean: 0.4415644109249115
loss_pred:0.019893819466233253, decouple_loss:0.008824596181511879
The generated pressure mean: 0.4405362904071808
loss_pred:0.020084846764802933, decouple_loss:0.008914328180253506
Iteration: 2966, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4515955448150635
The generated pressure mean: 0.44477519392967224
loss_pred:0.020216377452015877, decouple_loss:0.008494558744132519
loss_pred:0.017711665481328964, decouple_loss:0.008408980444073677
The generated pressure mean: 0.44711512327194214
loss_pred:0.021237138658761978, decouple_loss:0.00841389037668705
Iteration: 2967, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45019495487213135
The generated pressure mean: 0.44533953070640564
loss_pred:0.019601373001933098, decouple_loss:0.00826045498251915
loss_pred:0.017963092774152756, decouple_loss:0.008168373256921768
The generated pressure mean: 0.44902557134628296
loss_pred:0.01886574551463127, decouple_loss:0.008308562450110912
Iteration: 2968, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4543458819389343
The generated pressure mean: 0.4536784887313843
loss_pred:0.019792459905147552, decouple_loss:0.0076818871311843395
loss_pred:0.019308380782604218, decouple_loss:0.0078010037541389465
The generated pressure mean: 0.44950035214424133
loss_pred:0.01908964291214943, decouple_loss:0.007704117801040411
Iteration: 2969, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44738858938217163
loss_pred:0.018532542511820793, decouple_loss:0.007941216230392456
The generated pressure mean: 0.4490728974342346
loss_pred:0.018478937447071075, decouple_loss:0.008065586909651756
The generated pressure mean: 0.4523474872112274
loss_pred:0.019981123507022858, decouple_loss:0.007876759395003319
Iteration: 2970, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4412498474121094
loss_pred:0.020225010812282562, decouple_loss:0.007577641401439905
The generated pressure mean: 0.43851810693740845
loss_pred:0.018509428948163986, decouple_loss:0.0075418236665427685
The generated pressure mean: 0.44142863154411316
loss_pred:0.0179592352360487, decouple_loss:0.0076052043586969376
2023-04-16 23:18:34 testing...
The generated pressure mean: 0.4158886671066284
The generated pressure mean: 0.42188146710395813
loss_pred:0.03127666190266609, decouple_loss:0.008032502606511116
The generated pressure mean: 0.4235623776912689
loss_pred:0.02998501993715763, decouple_loss:0.008116292767226696
loss_pred:0.029732460156083107, decouple_loss:0.008246864192187786
WV_0_PC_0_EH_1_PS_40, loss: 0.030737973749637604, avg_mse: 0.043639134615659714
current test mse: 0.043639
Iteration: 2971, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44634079933166504
The generated pressure mean: 0.4456639289855957
loss_pred:0.019840430468320847, decouple_loss:0.0075052110478281975
loss_pred:0.017841452732682228, decouple_loss:0.007503222674131393
The generated pressure mean: 0.44573259353637695
loss_pred:0.018977699801325798, decouple_loss:0.007514309603720903
Iteration: 2972, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506244361400604
The generated pressure mean: 0.4533725082874298
loss_pred:0.019085200503468513, decouple_loss:0.007962179370224476
loss_pred:0.01914474554359913, decouple_loss:0.0080294543877244
The generated pressure mean: 0.45905905961990356
loss_pred:0.01904689148068428, decouple_loss:0.008336033672094345
Iteration: 2973, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4440717101097107
The generated pressure mean: 0.4485015869140625loss_pred:0.019860917702317238, decouple_loss:0.008741023018956184
loss_pred:0.020984826609492302, decouple_loss:0.00876125693321228
The generated pressure mean: 0.4450320303440094
loss_pred:0.01966303028166294, decouple_loss:0.008790300227701664
Iteration: 2974, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43942734599113464
The generated pressure mean: 0.4433367848396301
loss_pred:0.01857110857963562, decouple_loss:0.00848439522087574
loss_pred:0.018710065633058548, decouple_loss:0.00872129201889038
The generated pressure mean: 0.44674286246299744
loss_pred:0.019145553931593895, decouple_loss:0.008748048916459084
Iteration: 2975, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4434320032596588
The generated pressure mean: 0.4479142725467682
loss_pred:0.018760787323117256, decouple_loss:0.008575632236897945
loss_pred:0.017232447862625122, decouple_loss:0.008462568745017052
The generated pressure mean: 0.4423525035381317
loss_pred:0.019564276561141014, decouple_loss:0.00856806244701147
Iteration: 2976, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45292821526527405
The generated pressure mean: 0.4610864222049713
loss_pred:0.01948363333940506, decouple_loss:0.007391720544546843
loss_pred:0.019661223515868187, decouple_loss:0.007532362826168537
The generated pressure mean: 0.45521917939186096
loss_pred:0.019453199580311775, decouple_loss:0.007428090553730726
Iteration: 2977, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43751224875450134
The generated pressure mean: 0.4371996521949768
loss_pred:0.020395532250404358, decouple_loss:0.006770704407244921
loss_pred:0.020946089178323746, decouple_loss:0.006918087601661682
The generated pressure mean: 0.4389798939228058
loss_pred:0.018865814432501793, decouple_loss:0.006662486586719751
Iteration: 2978, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463598430156708
loss_pred:0.018373165279626846, decouple_loss:0.007830794900655746
The generated pressure mean: 0.4500560462474823
loss_pred:0.018579019233584404, decouple_loss:0.0075941127724945545
The generated pressure mean: 0.44448333978652954
loss_pred:0.01875990815460682, decouple_loss:0.007787233684211969
Iteration: 2979, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45879441499710083
loss_pred:0.01906508207321167, decouple_loss:0.008509139530360699
The generated pressure mean: 0.45446527004241943
loss_pred:0.0217446181923151, decouple_loss:0.008568789809942245
The generated pressure mean: 0.4598442018032074
loss_pred:0.019504399970173836, decouple_loss:0.008538832888007164
Iteration: 2980, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44438600540161133
loss_pred:0.016605496406555176, decouple_loss:0.00853685848414898
The generated pressure mean: 0.4410695433616638
loss_pred:0.019692962989211082, decouple_loss:0.008478248491883278
The generated pressure mean: 0.4421461522579193
loss_pred:0.018435973674058914, decouple_loss:0.008536221459507942
2023-04-16 23:20:28 testing...
The generated pressure mean: 0.41470563411712646
The generated pressure mean: 0.4221055209636688
The generated pressure mean: 0.42443957924842834
loss_pred:0.034342411905527115, decouple_loss:0.00904072169214487
loss_pred:0.03290749341249466, decouple_loss:0.009095716290175915
loss_pred:0.03229597583413124, decouple_loss:0.009319824166595936
WV_0_PC_0_EH_1_PS_40, loss: 0.033639565110206604, avg_mse: 0.04999016597867012
current test mse: 0.04999
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 2981, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479174315929413
loss_pred:0.019699783995747566, decouple_loss:0.008466178551316261
The generated pressure mean: 0.4524763822555542
loss_pred:0.019880207255482674, decouple_loss:0.008368807844817638
The generated pressure mean: 0.45043015480041504
loss_pred:0.018851496279239655, decouple_loss:0.008402067236602306
Iteration: 2982, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4406861662864685
loss_pred:0.019213417544960976, decouple_loss:0.007778615690767765
The generated pressure mean: 0.4405215084552765
loss_pred:0.01877644658088684, decouple_loss:0.00803572591394186
The generated pressure mean: 0.4427369236946106
loss_pred:0.019200241193175316, decouple_loss:0.00794336199760437
Iteration: 2983, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44194337725639343
loss_pred:0.018792295828461647, decouple_loss:0.007469812408089638
The generated pressure mean: 0.44172796607017517
loss_pred:0.020826740190386772, decouple_loss:0.00738892238587141
The generated pressure mean: 0.4379875063896179
loss_pred:0.01900058053433895, decouple_loss:0.007500212173908949
Iteration: 2984, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45615145564079285
The generated pressure mean: 0.4585409462451935
loss_pred:0.018959075212478638, decouple_loss:0.008703846484422684
loss_pred:0.018588079139590263, decouple_loss:0.008914333768188953
The generated pressure mean: 0.46192455291748047
loss_pred:0.019751736894249916, decouple_loss:0.008879569359123707
Iteration: 2985, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506160318851471
The generated pressure mean: 0.45204201340675354
loss_pred:0.01977899856865406, decouple_loss:0.008751893416047096
loss_pred:0.0178410392254591, decouple_loss:0.008770933374762535
The generated pressure mean: 0.4500734806060791
loss_pred:0.02029777690768242, decouple_loss:0.008766871877014637
Iteration: 2986, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4356004297733307
loss_pred:0.020531870424747467, decouple_loss:0.008401723578572273
The generated pressure mean: 0.4331721365451813
loss_pred:0.022625593468546867, decouple_loss:0.008475039154291153
The generated pressure mean: 0.4412577748298645
loss_pred:0.01904403418302536, decouple_loss:0.008392258547246456
Iteration: 2987, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497512876987457
loss_pred:0.019027220085263252, decouple_loss:0.007291062269359827
The generated pressure mean: 0.45252567529678345
loss_pred:0.018979482352733612, decouple_loss:0.007376606110483408
The generated pressure mean: 0.44861218333244324
loss_pred:0.018423540517687798, decouple_loss:0.0071478839963674545
Iteration: 2988, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494805335998535
The generated pressure mean: 0.45214590430259705
loss_pred:0.018178096041083336, decouple_loss:0.0076395790092647076
loss_pred:0.019566610455513, decouple_loss:0.007634822279214859
The generated pressure mean: 0.44891685247421265
loss_pred:0.01792893186211586, decouple_loss:0.00764772854745388
Iteration: 2989, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466630816459656
loss_pred:0.020341411232948303, decouple_loss:0.007847035303711891
The generated pressure mean: 0.4506458640098572
loss_pred:0.019267067313194275, decouple_loss:0.007967744022607803
The generated pressure mean: 0.4445432424545288
loss_pred:0.01995272934436798, decouple_loss:0.007868258282542229
Iteration: 2990, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44294947385787964
The generated pressure mean: 0.43944770097732544
loss_pred:0.018995508551597595, decouple_loss:0.009069005958735943
loss_pred:0.018494125455617905, decouple_loss:0.009009669534862041
The generated pressure mean: 0.44307741522789
loss_pred:0.020372262224555016, decouple_loss:0.00922214612364769
2023-04-16 23:23:10 testing...
The generated pressure mean: 0.41451725363731384
The generated pressure mean: 0.4208093583583832
The generated pressure mean: 0.42280301451683044
loss_pred:0.032570865005254745, decouple_loss:0.008399209938943386
loss_pred:0.03169771283864975, decouple_loss:0.008448394946753979
loss_pred:0.031224489212036133, decouple_loss:0.008650352247059345
WV_0_PC_0_EH_1_PS_40, loss: 0.03225598856806755, avg_mse: 0.046999696642160416
current test mse: 0.047
Iteration: 2991, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446022629737854
loss_pred:0.018904095515608788, decouple_loss:0.007948394864797592
The generated pressure mean: 0.4480564296245575
loss_pred:0.020154481753706932, decouple_loss:0.008068959228694439
The generated pressure mean: 0.44715920090675354
loss_pred:0.019421488046646118, decouple_loss:0.00798759888857603
Iteration: 2992, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494040608406067
The generated pressure mean: 0.45113804936408997
loss_pred:0.01785334199666977, decouple_loss:0.007912288419902325
loss_pred:0.018906064331531525, decouple_loss:0.007993695326149464
The generated pressure mean: 0.4503172039985657
loss_pred:0.02044021524488926, decouple_loss:0.007948305457830429
Iteration: 2993, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44276636838912964The generated pressure mean: 0.4450613260269165
loss_pred:0.018176961690187454, decouple_loss:0.006970686838030815
loss_pred:0.020109109580516815, decouple_loss:0.0069966851733624935
The generated pressure mean: 0.44605308771133423
loss_pred:0.019220778718590736, decouple_loss:0.007139085792005062
Iteration: 2994, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4527301788330078
loss_pred:0.020235422998666763, decouple_loss:0.008709214627742767
The generated pressure mean: 0.45299750566482544
loss_pred:0.01894669234752655, decouple_loss:0.008543338626623154
The generated pressure mean: 0.45435580611228943
loss_pred:0.0196822676807642, decouple_loss:0.008597866632044315
Iteration: 2995, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482232332229614
loss_pred:0.01981820911169052, decouple_loss:0.008949466980993748
The generated pressure mean: 0.45094895362854004
loss_pred:0.01899753324687481, decouple_loss:0.008983654901385307
The generated pressure mean: 0.44930344820022583
loss_pred:0.01974058337509632, decouple_loss:0.009132271632552147
Iteration: 2996, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44240519404411316
The generated pressure mean: 0.44145673513412476
loss_pred:0.01927376352250576, decouple_loss:0.008094376884400845
loss_pred:0.019189607352018356, decouple_loss:0.007974053733050823
The generated pressure mean: 0.44064658880233765
loss_pred:0.018903568387031555, decouple_loss:0.007917352952063084
Iteration: 2997, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4412209689617157
loss_pred:0.019877905026078224, decouple_loss:0.00882165040820837
The generated pressure mean: 0.438694030046463
loss_pred:0.019875086843967438, decouple_loss:0.00873591285198927
The generated pressure mean: 0.4419957101345062
loss_pred:0.02003571391105652, decouple_loss:0.00873091071844101
Iteration: 2998, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507298469543457
loss_pred:0.01765209622681141, decouple_loss:0.008121995255351067
The generated pressure mean: 0.4553651213645935
loss_pred:0.019180426374077797, decouple_loss:0.008082135580480099
The generated pressure mean: 0.45538434386253357
loss_pred:0.018334196880459785, decouple_loss:0.00802190974354744
Iteration: 2999, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45369040966033936
The generated pressure mean: 0.44824090600013733
loss_pred:0.02098318561911583, decouple_loss:0.007747261319309473
loss_pred:0.019934963434934616, decouple_loss:0.00780623871833086
The generated pressure mean: 0.4500480890274048
loss_pred:0.02048521861433983, decouple_loss:0.007796751335263252
Iteration: 3000, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4427763521671295
loss_pred:0.018900370225310326, decouple_loss:0.007833224721252918
The generated pressure mean: 0.44270169734954834
loss_pred:0.01829100400209427, decouple_loss:0.007819064892828465
The generated pressure mean: 0.4433910548686981
loss_pred:0.02012615278363228, decouple_loss:0.007813865318894386
2023-04-16 23:25:03 itr: 3000
training loss: [0.02051685 0.01929203 0.01868196]
2023-04-16 23:25:03 testing...
The generated pressure mean: 0.42196714878082275
The generated pressure mean: 0.4155440330505371
loss_pred:0.030484110116958618, decouple_loss:0.008747260086238384
The generated pressure mean: 0.4242153465747833
loss_pred:0.031516775488853455, decouple_loss:0.008588902652263641
loss_pred:0.029885997995734215, decouple_loss:0.008785235695540905
WV_0_PC_0_EH_1_PS_40, loss: 0.031064316630363464, avg_mse: 0.04461926966905594
current test mse: 0.044619
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 3001, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4435649514198303
loss_pred:0.019943341612815857, decouple_loss:0.00838460959494114
The generated pressure mean: 0.4431628882884979
loss_pred:0.019431373104453087, decouple_loss:0.008422299288213253
The generated pressure mean: 0.4447587728500366
loss_pred:0.01889633946120739, decouple_loss:0.00831705704331398
Iteration: 3002, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44438520073890686
The generated pressure mean: 0.454129695892334
loss_pred:0.019481072202324867, decouple_loss:0.007685823831707239
loss_pred:0.019922593608498573, decouple_loss:0.007408239413052797
The generated pressure mean: 0.4491631090641022
loss_pred:0.01948920078575611, decouple_loss:0.007534072734415531
Iteration: 3003, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.442066490650177
The generated pressure mean: 0.4391188621520996
loss_pred:0.01879231631755829, decouple_loss:0.007888250052928925
loss_pred:0.019874030724167824, decouple_loss:0.00789126567542553
The generated pressure mean: 0.447233647108078
loss_pred:0.01910269260406494, decouple_loss:0.00813455879688263
Iteration: 3004, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470660388469696
The generated pressure mean: 0.4449828565120697
loss_pred:0.019384847953915596, decouple_loss:0.007901116274297237
loss_pred:0.019270408898591995, decouple_loss:0.007877042517066002
The generated pressure mean: 0.4467354416847229
loss_pred:0.019421862438321114, decouple_loss:0.007863790728151798
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3005, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44993552565574646
loss_pred:0.01877424120903015, decouple_loss:0.007806842215359211The generated pressure mean: 0.44941678643226624
loss_pred:0.01980273425579071, decouple_loss:0.007742920890450478
The generated pressure mean: 0.4483043849468231
loss_pred:0.020275788381695747, decouple_loss:0.007772321347147226
Iteration: 3006, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44471776485443115
The generated pressure mean: 0.45130932331085205
loss_pred:0.019322983920574188, decouple_loss:0.008647169917821884
loss_pred:0.019041815772652626, decouple_loss:0.008749598637223244
The generated pressure mean: 0.4472246468067169
loss_pred:0.018256746232509613, decouple_loss:0.008672356605529785
Iteration: 3007, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44596201181411743The generated pressure mean: 0.44521647691726685
loss_pred:0.019299376755952835, decouple_loss:0.007467319257557392
loss_pred:0.019390268251299858, decouple_loss:0.007319615688174963
The generated pressure mean: 0.4477606415748596
loss_pred:0.0197957381606102, decouple_loss:0.007226797752082348
Iteration: 3008, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.444989413022995
The generated pressure mean: 0.4451916515827179
loss_pred:0.019157305359840393, decouple_loss:0.007175298407673836
loss_pred:0.018635611981153488, decouple_loss:0.007247224450111389
The generated pressure mean: 0.44355833530426025
loss_pred:0.019723819568753242, decouple_loss:0.0073367455042898655
Iteration: 3009, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44777438044548035
The generated pressure mean: 0.4467712640762329
loss_pred:0.019843382760882378, decouple_loss:0.008208729326725006
loss_pred:0.01998027041554451, decouple_loss:0.008198331110179424
The generated pressure mean: 0.4449414014816284
loss_pred:0.01886575110256672, decouple_loss:0.008365868590772152
Iteration: 3010, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506291151046753
loss_pred:0.019429251551628113, decouple_loss:0.008142409846186638
The generated pressure mean: 0.44510525465011597
loss_pred:0.018595894798636436, decouple_loss:0.008243936114013195
The generated pressure mean: 0.4456309974193573
loss_pred:0.02176498807966709, decouple_loss:0.008202340453863144
2023-04-16 23:27:34 testing...
The generated pressure mean: 0.41479161381721497
The generated pressure mean: 0.42078161239624023
The generated pressure mean: 0.42281073331832886
loss_pred:0.03141770139336586, decouple_loss:0.007553511299192905
loss_pred:0.030324310064315796, decouple_loss:0.00783634278923273
loss_pred:0.03011268936097622, decouple_loss:0.007976659573614597
WV_0_PC_0_EH_1_PS_40, loss: 0.03100767731666565, avg_mse: 0.04464367777109146
current test mse: 0.044644
Iteration: 3011, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446962833404541
The generated pressure mean: 0.44697001576423645
loss_pred:0.020007256418466568, decouple_loss:0.0070733437314629555
loss_pred:0.01837380975484848, decouple_loss:0.0070511759258806705
The generated pressure mean: 0.44704216718673706
loss_pred:0.019544348120689392, decouple_loss:0.007015241775661707
Iteration: 3012, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45307689905166626
The generated pressure mean: 0.4492064416408539
loss_pred:0.01891615241765976, decouple_loss:0.006991742644459009
loss_pred:0.01834680140018463, decouple_loss:0.0069491504691541195
The generated pressure mean: 0.4542873501777649
loss_pred:0.019516807049512863, decouple_loss:0.006954004056751728
Iteration: 3013, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459061622619629
The generated pressure mean: 0.4459030032157898loss_pred:0.01976284757256508, decouple_loss:0.007315514143556356
loss_pred:0.018707329407334328, decouple_loss:0.007221643812954426
The generated pressure mean: 0.44741424918174744
loss_pred:0.019839085638523102, decouple_loss:0.007190205156803131
Iteration: 3014, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43389347195625305
The generated pressure mean: 0.4378626346588135
loss_pred:0.01934293657541275, decouple_loss:0.007930899038910866
loss_pred:0.019962582737207413, decouple_loss:0.007973333820700645
The generated pressure mean: 0.4362497627735138
loss_pred:0.019612004980444908, decouple_loss:0.0079506179317832
Iteration: 3015, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4540267288684845
loss_pred:0.019001554697752, decouple_loss:0.007361931260675192
The generated pressure mean: 0.4543628990650177
loss_pred:0.021223822608590126, decouple_loss:0.007360830903053284
The generated pressure mean: 0.45424580574035645
loss_pred:0.018911229446530342, decouple_loss:0.007474797777831554
Iteration: 3016, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44105884432792664
loss_pred:0.019344406202435493, decouple_loss:0.007654407527297735
The generated pressure mean: 0.43854930996894836
loss_pred:0.018410824239253998, decouple_loss:0.007697572000324726
The generated pressure mean: 0.4420628249645233
loss_pred:0.01869274489581585, decouple_loss:0.0076763816177845
Iteration: 3017, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4447483420372009
loss_pred:0.019962703809142113, decouple_loss:0.006770992185920477
The generated pressure mean: 0.44409000873565674
loss_pred:0.019768619909882545, decouple_loss:0.006940755993127823
The generated pressure mean: 0.445919007062912
loss_pred:0.018988514319062233, decouple_loss:0.006810614373534918
Iteration: 3018, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45317521691322327
loss_pred:0.019885685294866562, decouple_loss:0.006531484425067902
The generated pressure mean: 0.4574597179889679
loss_pred:0.02176317572593689, decouple_loss:0.006532593630254269
The generated pressure mean: 0.4543476402759552
loss_pred:0.019869938492774963, decouple_loss:0.006420900113880634
Iteration: 3019, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4420323669910431
loss_pred:0.018337972462177277, decouple_loss:0.00693838857114315
The generated pressure mean: 0.44340360164642334
loss_pred:0.019250186160206795, decouple_loss:0.007003046106547117
The generated pressure mean: 0.4412052035331726
loss_pred:0.019167128950357437, decouple_loss:0.007028205320239067
Iteration: 3020, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44117802381515503
loss_pred:0.01950666680932045, decouple_loss:0.00789717212319374
The generated pressure mean: 0.4448425769805908
loss_pred:0.018195772543549538, decouple_loss:0.00794827938079834
The generated pressure mean: 0.4389515221118927
loss_pred:0.01946345344185829, decouple_loss:0.008062011562287807
2023-04-16 23:29:27 testing...
The generated pressure mean: 0.41479912400245667
The generated pressure mean: 0.4216902256011963
The generated pressure mean: 0.4236025810241699
loss_pred:0.03319139406085014, decouple_loss:0.007793520111590624
loss_pred:0.03206741064786911, decouple_loss:0.00782566238194704
loss_pred:0.03188758343458176, decouple_loss:0.008050588890910149
WV_0_PC_0_EH_1_PS_40, loss: 0.03277662396430969, avg_mse: 0.048093561083078384
current test mse: 0.048094
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 3021, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44870463013648987
loss_pred:0.019356032833456993, decouple_loss:0.007389015052467585
The generated pressure mean: 0.45153141021728516
loss_pred:0.020764576271176338, decouple_loss:0.007458964828401804
The generated pressure mean: 0.45343562960624695
loss_pred:0.01988503709435463, decouple_loss:0.007503319066017866
Iteration: 3022, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44345974922180176
loss_pred:0.021924562752246857, decouple_loss:0.007168026641011238
The generated pressure mean: 0.44534915685653687
loss_pred:0.020198022946715355, decouple_loss:0.007126936223357916
The generated pressure mean: 0.4497855305671692
loss_pred:0.02096692845225334, decouple_loss:0.007138912566006184
Iteration: 3023, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44120609760284424
The generated pressure mean: 0.44093865156173706
loss_pred:0.020399633795022964, decouple_loss:0.00774414511397481
loss_pred:0.02246975526213646, decouple_loss:0.007761705666780472
The generated pressure mean: 0.44059130549430847
loss_pred:0.018950138241052628, decouple_loss:0.007799671031534672
Iteration: 3024, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471909999847412
loss_pred:0.02013065107166767, decouple_loss:0.007746471557766199
The generated pressure mean: 0.4473409354686737
loss_pred:0.019588707014918327, decouple_loss:0.007682838011533022
The generated pressure mean: 0.44869884848594666
loss_pred:0.02070898935198784, decouple_loss:0.007778666447848082
Iteration: 3025, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45091527700424194
The generated pressure mean: 0.4496912360191345
loss_pred:0.02169896475970745, decouple_loss:0.007627441082149744
loss_pred:0.020437760278582573, decouple_loss:0.00758748222142458
The generated pressure mean: 0.45672693848609924
loss_pred:0.020311085507273674, decouple_loss:0.007727223448455334
Iteration: 3026, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44648978114128113
The generated pressure mean: 0.450675904750824loss_pred:0.019475799053907394, decouple_loss:0.007362126372754574
loss_pred:0.01996159926056862, decouple_loss:0.0073906052857637405
The generated pressure mean: 0.4495413899421692
loss_pred:0.020225880667567253, decouple_loss:0.0075562880374491215
Iteration: 3027, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4403848350048065
The generated pressure mean: 0.44244855642318726
loss_pred:0.020675718784332275, decouple_loss:0.007902032695710659
loss_pred:0.021066928282380104, decouple_loss:0.007894463837146759
The generated pressure mean: 0.4419807493686676
loss_pred:0.01951257325708866, decouple_loss:0.007917901501059532
Iteration: 3028, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.438883900642395
loss_pred:0.02017710544168949, decouple_loss:0.008061094209551811
The generated pressure mean: 0.4422786235809326
The generated pressure mean: 0.4392620325088501
loss_pred:0.01878958009183407, decouple_loss:0.008097621612250805
loss_pred:0.019277745857834816, decouple_loss:0.008038501255214214
Iteration: 3029, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45333975553512573
loss_pred:0.021211734041571617, decouple_loss:0.008264553733170033
The generated pressure mean: 0.4537494480609894
loss_pred:0.019566481932997704, decouple_loss:0.00849655270576477
The generated pressure mean: 0.4547116756439209
loss_pred:0.022306863218545914, decouple_loss:0.008346432819962502
Iteration: 3030, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44685646891593933
loss_pred:0.019255725666880608, decouple_loss:0.007813842967152596
The generated pressure mean: 0.4433509409427643
The generated pressure mean: 0.438934862613678
loss_pred:0.019798463210463524, decouple_loss:0.007597519084811211
loss_pred:0.021566208451986313, decouple_loss:0.007729032542556524
2023-04-16 23:31:57 testing...
The generated pressure mean: 0.41468921303749084
The generated pressure mean: 0.4209352433681488
The generated pressure mean: 0.42327266931533813
loss_pred:0.03179575130343437, decouple_loss:0.007909434847533703
loss_pred:0.030712688341736794, decouple_loss:0.008059736341238022
loss_pred:0.0303269624710083, decouple_loss:0.008180936798453331
WV_0_PC_0_EH_1_PS_40, loss: 0.03134763613343239, avg_mse: 0.04546501860022545
current test mse: 0.045465
Iteration: 3031, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44959327578544617
loss_pred:0.01869961991906166, decouple_loss:0.007191570941358805
The generated pressure mean: 0.4482664167881012
loss_pred:0.01938406005501747, decouple_loss:0.007403849624097347
The generated pressure mean: 0.4516976773738861
loss_pred:0.019621839746832848, decouple_loss:0.007304396014660597
Iteration: 3032, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501710534095764
loss_pred:0.02110718935728073, decouple_loss:0.0071418373845517635
The generated pressure mean: 0.4556195139884949
loss_pred:0.019546380266547203, decouple_loss:0.007159494794905186
The generated pressure mean: 0.4510578513145447
loss_pred:0.018688414245843887, decouple_loss:0.007157390937209129
Iteration: 3033, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44164395332336426
loss_pred:0.018604984506964684, decouple_loss:0.007803365122526884
The generated pressure mean: 0.44026458263397217
loss_pred:0.018990805372595787, decouple_loss:0.008008039556443691
The generated pressure mean: 0.4382319748401642
loss_pred:0.019344063475728035, decouple_loss:0.007943030446767807
Iteration: 3034, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442536234855652
loss_pred:0.019902849569916725, decouple_loss:0.008827056735754013
The generated pressure mean: 0.4401593804359436
loss_pred:0.02098516933619976, decouple_loss:0.008728200569748878
The generated pressure mean: 0.4422069191932678
loss_pred:0.018802504986524582, decouple_loss:0.0088617242872715
Iteration: 3035, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4511832892894745
loss_pred:0.019871383905410767, decouple_loss:0.00840986892580986
The generated pressure mean: 0.45143240690231323
loss_pred:0.02194717526435852, decouple_loss:0.008517882786691189
The generated pressure mean: 0.4529111087322235
loss_pred:0.018954062834382057, decouple_loss:0.008428370580077171
Iteration: 3036, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43992695212364197
loss_pred:0.019698012620210648, decouple_loss:0.007808688096702099
The generated pressure mean: 0.4354603588581085
loss_pred:0.019822491332888603, decouple_loss:0.007795967161655426
The generated pressure mean: 0.43926987051963806
loss_pred:0.02000396139919758, decouple_loss:0.0077609708532691
Iteration: 3037, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494154751300812
loss_pred:0.021083049476146698, decouple_loss:0.008021296001970768
The generated pressure mean: 0.45325905084609985
loss_pred:0.019291747361421585, decouple_loss:0.007979284040629864
The generated pressure mean: 0.452632337808609
loss_pred:0.020208023488521576, decouple_loss:0.007913241162896156
Iteration: 3038, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482101500034332
loss_pred:0.02052953466773033, decouple_loss:0.007988078519701958
The generated pressure mean: 0.4546566605567932
loss_pred:0.019299793988466263, decouple_loss:0.007679005619138479
The generated pressure mean: 0.4535161554813385
loss_pred:0.020201116800308228, decouple_loss:0.007703893817961216
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3039, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44816744327545166
loss_pred:0.019836818799376488, decouple_loss:0.00924362801015377
The generated pressure mean: 0.44901564717292786
loss_pred:0.01999366283416748, decouple_loss:0.009280752390623093
The generated pressure mean: 0.44836223125457764
loss_pred:0.020757241174578667, decouple_loss:0.009202330373227596
Iteration: 3040, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43643710017204285
loss_pred:0.019771946594119072, decouple_loss:0.009318887256085873
The generated pressure mean: 0.43703967332839966
loss_pred:0.019174007698893547, decouple_loss:0.009251510724425316
The generated pressure mean: 0.4410359263420105
loss_pred:0.020378539338707924, decouple_loss:0.00944418553262949
2023-04-16 23:33:50 testing...
The generated pressure mean: 0.4161338210105896
The generated pressure mean: 0.4223102927207947
The generated pressure mean: 0.42427778244018555
loss_pred:0.032221198081970215, decouple_loss:0.008276752196252346
loss_pred:0.031356289982795715, decouple_loss:0.008359617553651333
loss_pred:0.030359596014022827, decouple_loss:0.008563239127397537
WV_0_PC_0_EH_1_PS_40, loss: 0.031732358038425446, avg_mse: 0.04600152373313904
current test mse: 0.046002
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 3041, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4430801272392273
loss_pred:0.020908480510115623, decouple_loss:0.00792629737406969
The generated pressure mean: 0.44297143816947937
loss_pred:0.019279418513178825, decouple_loss:0.007947501726448536
The generated pressure mean: 0.44495683908462524
loss_pred:0.018621567636728287, decouple_loss:0.007783342152833939
Iteration: 3042, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507189989089966
The generated pressure mean: 0.44356662034988403
loss_pred:0.018558094277977943, decouple_loss:0.007786302827298641
loss_pred:0.019091734662652016, decouple_loss:0.007521620020270348
The generated pressure mean: 0.44829776883125305
loss_pred:0.0191611647605896, decouple_loss:0.007751527242362499
Iteration: 3043, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45126017928123474The generated pressure mean: 0.45407068729400635
loss_pred:0.019808541983366013, decouple_loss:0.008376969955861568
loss_pred:0.019687503576278687, decouple_loss:0.008345711044967175
The generated pressure mean: 0.45256203413009644
loss_pred:0.020184094086289406, decouple_loss:0.00838159117847681
Iteration: 3044, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495602548122406
The generated pressure mean: 0.45015257596969604
loss_pred:0.01827681064605713, decouple_loss:0.0089868837967515
loss_pred:0.01982985809445381, decouple_loss:0.009066101163625717
The generated pressure mean: 0.4427894949913025
loss_pred:0.021088862791657448, decouple_loss:0.009118226356804371
Iteration: 3045, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4423362910747528
The generated pressure mean: 0.4441509246826172
loss_pred:0.018339689821004868, decouple_loss:0.008108964189887047
loss_pred:0.019214922562241554, decouple_loss:0.008166448213160038
The generated pressure mean: 0.4422000050544739
loss_pred:0.019921520724892616, decouple_loss:0.008171819150447845
Iteration: 3046, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475697875022888
The generated pressure mean: 0.4421493709087372
loss_pred:0.021380268037319183, decouple_loss:0.007611951790750027
loss_pred:0.019029775634407997, decouple_loss:0.007672696374356747
The generated pressure mean: 0.44734257459640503
loss_pred:0.01954721286892891, decouple_loss:0.007725216913968325
Iteration: 3047, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44909152388572693
loss_pred:0.018772410228848457, decouple_loss:0.007484246976673603
The generated pressure mean: 0.447374165058136
loss_pred:0.01945154368877411, decouple_loss:0.007565972860902548
The generated pressure mean: 0.4489826560020447
loss_pred:0.019771326333284378, decouple_loss:0.007604663260281086
Iteration: 3048, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4454682171344757
loss_pred:0.01920670084655285, decouple_loss:0.009228797629475594
The generated pressure mean: 0.45317894220352173
The generated pressure mean: 0.4473975598812103
loss_pred:0.02060891129076481, decouple_loss:0.009482837282121181
loss_pred:0.020383885130286217, decouple_loss:0.009367392398416996
Iteration: 3049, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44157326221466064
loss_pred:0.019251499325037003, decouple_loss:0.009696930646896362
The generated pressure mean: 0.43891894817352295
The generated pressure mean: 0.4422110319137573
loss_pred:0.01954445242881775, decouple_loss:0.009709489531815052
loss_pred:0.019354287534952164, decouple_loss:0.009640258736908436
Iteration: 3050, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44984543323516846
loss_pred:0.019275113940238953, decouple_loss:0.007915814407169819
The generated pressure mean: 0.44715696573257446
loss_pred:0.02047884464263916, decouple_loss:0.007937015034258366
The generated pressure mean: 0.4471028745174408
loss_pred:0.018772579729557037, decouple_loss:0.007797311991453171
2023-04-16 23:36:22 testing...
The generated pressure mean: 0.4151551127433777
The generated pressure mean: 0.42074716091156006
The generated pressure mean: 0.4228593409061432
loss_pred:0.0320570208132267, decouple_loss:0.00784764438867569
loss_pred:0.0308185126632452, decouple_loss:0.007967431098222733
loss_pred:0.030546333640813828, decouple_loss:0.00802874006330967
WV_0_PC_0_EH_1_PS_40, loss: 0.031538017094135284, avg_mse: 0.04567074403166771
current test mse: 0.045671
Iteration: 3051, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4454886019229889
loss_pred:0.017749113962054253, decouple_loss:0.007348381448537111
The generated pressure mean: 0.45051509141921997
loss_pred:0.01956505887210369, decouple_loss:0.007432914339005947
The generated pressure mean: 0.45258259773254395
loss_pred:0.021355699747800827, decouple_loss:0.007525870576500893
Iteration: 3052, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501626193523407
loss_pred:0.01915797032415867, decouple_loss:0.008112283423542976
The generated pressure mean: 0.4520812928676605
loss_pred:0.01863766275346279, decouple_loss:0.008153785951435566
The generated pressure mean: 0.44822588562965393
loss_pred:0.019643481820821762, decouple_loss:0.008031696081161499
Iteration: 3053, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4382849931716919
loss_pred:0.019038278609514236, decouple_loss:0.010086816735565662
The generated pressure mean: 0.4367355406284332
loss_pred:0.019595425575971603, decouple_loss:0.009927276521921158
The generated pressure mean: 0.44339650869369507
loss_pred:0.01896471343934536, decouple_loss:0.009854022413492203
Iteration: 3054, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44539427757263184
loss_pred:0.020406369119882584, decouple_loss:0.008090897463262081
The generated pressure mean: 0.4444529116153717
loss_pred:0.019223850220441818, decouple_loss:0.008104556240141392
The generated pressure mean: 0.44577091932296753
loss_pred:0.018854636698961258, decouple_loss:0.008173844777047634
Iteration: 3055, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503158926963806
loss_pred:0.020108742639422417, decouple_loss:0.008160392753779888
The generated pressure mean: 0.4485190212726593
loss_pred:0.019427582621574402, decouple_loss:0.00808524340391159
The generated pressure mean: 0.4488999843597412
loss_pred:0.019716517999768257, decouple_loss:0.00795563030987978
Iteration: 3056, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45203471183776855
loss_pred:0.019716117531061172, decouple_loss:0.009002490900456905
The generated pressure mean: 0.4502558708190918
loss_pred:0.02042396366596222, decouple_loss:0.009068114683032036
The generated pressure mean: 0.44855859875679016
loss_pred:0.019943874329328537, decouple_loss:0.009085371159017086
Iteration: 3057, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44567158818244934
loss_pred:0.01914401911199093, decouple_loss:0.008142432197928429
The generated pressure mean: 0.44751158356666565
loss_pred:0.01851544715464115, decouple_loss:0.007983420044183731
The generated pressure mean: 0.4468652904033661
loss_pred:0.01803528517484665, decouple_loss:0.008036782965064049
Iteration: 3058, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44449111819267273
loss_pred:0.02048022486269474, decouple_loss:0.007540032267570496
The generated pressure mean: 0.44679901003837585
The generated pressure mean: 0.43939724564552307
loss_pred:0.019064782187342644, decouple_loss:0.007447156123816967
loss_pred:0.019371066242456436, decouple_loss:0.00739680789411068
Iteration: 3059, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44517168402671814
The generated pressure mean: 0.4498146176338196
loss_pred:0.01915697753429413, decouple_loss:0.007277708034962416
loss_pred:0.020164305344223976, decouple_loss:0.007411037106066942
The generated pressure mean: 0.4510507881641388
loss_pred:0.020453598350286484, decouple_loss:0.007327884901314974
Iteration: 3060, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4438610076904297
loss_pred:0.018527792766690254, decouple_loss:0.009012555703520775
The generated pressure mean: 0.44066986441612244
loss_pred:0.019636081531643867, decouple_loss:0.009210653603076935
The generated pressure mean: 0.4420575201511383
loss_pred:0.019091269001364708, decouple_loss:0.009057553485035896
2023-04-16 23:38:15 testing...
The generated pressure mean: 0.41703036427497864
The generated pressure mean: 0.42272770404815674
The generated pressure mean: 0.42467638850212097
loss_pred:0.031116409227252007, decouple_loss:0.010237706825137138
loss_pred:0.03015803173184395, decouple_loss:0.010463583283126354
loss_pred:0.029660101979970932, decouple_loss:0.010495874099433422
WV_0_PC_0_EH_1_PS_40, loss: 0.030831467360258102, avg_mse: 0.044008105993270874
current test mse: 0.044008
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 3061, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4367113709449768
loss_pred:0.01869984343647957, decouple_loss:0.00987167563289404
The generated pressure mean: 0.43723225593566895
loss_pred:0.020170293748378754, decouple_loss:0.009622281417250633
The generated pressure mean: 0.4398004710674286
loss_pred:0.019273031502962112, decouple_loss:0.009615843184292316
Iteration: 3062, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493604004383087
The generated pressure mean: 0.45116665959358215
loss_pred:0.021533090621232986, decouple_loss:0.00769752636551857
loss_pred:0.019440609961748123, decouple_loss:0.007638304494321346
The generated pressure mean: 0.4545438587665558
loss_pred:0.019292952492833138, decouple_loss:0.0076516298577189445
Iteration: 3063, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4513975977897644
loss_pred:0.019069047644734383, decouple_loss:0.00740254670381546
The generated pressure mean: 0.451127827167511
loss_pred:0.022180262953042984, decouple_loss:0.0076378872618079185
The generated pressure mean: 0.4506382644176483
loss_pred:0.018693558871746063, decouple_loss:0.0076007056050002575
Iteration: 3064, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4436803162097931
loss_pred:0.018946455791592598, decouple_loss:0.008353404700756073
The generated pressure mean: 0.4467625021934509
loss_pred:0.019314609467983246, decouple_loss:0.008362501859664917
The generated pressure mean: 0.4422292113304138
loss_pred:0.020561696961522102, decouple_loss:0.0082255182787776
Iteration: 3065, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44486045837402344
loss_pred:0.020976491272449493, decouple_loss:0.008527363650500774
The generated pressure mean: 0.44461163878440857
loss_pred:0.01933976449072361, decouple_loss:0.008474314585328102
The generated pressure mean: 0.44201570749282837
loss_pred:0.01800081506371498, decouple_loss:0.008400809019804
Iteration: 3066, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4437786638736725
loss_pred:0.01969977281987667, decouple_loss:0.007455762010067701
The generated pressure mean: 0.4430380165576935
loss_pred:0.02042120322585106, decouple_loss:0.0075300829485058784
The generated pressure mean: 0.4404568076133728
loss_pred:0.01822465844452381, decouple_loss:0.0075201611034572124
Iteration: 3067, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45124247670173645
loss_pred:0.02056523971259594, decouple_loss:0.007331517059355974
The generated pressure mean: 0.44726869463920593
loss_pred:0.020113149657845497, decouple_loss:0.007197507191449404
The generated pressure mean: 0.44926658272743225
loss_pred:0.018703561276197433, decouple_loss:0.007405488286167383
Iteration: 3068, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492913782596588
loss_pred:0.02049405872821808, decouple_loss:0.006930835545063019
The generated pressure mean: 0.4432191550731659
loss_pred:0.0195841733366251, decouple_loss:0.006910182535648346
The generated pressure mean: 0.4454241394996643
loss_pred:0.01815313845872879, decouple_loss:0.006893654353916645
Iteration: 3069, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501931667327881
loss_pred:0.019562143832445145, decouple_loss:0.007209198083728552
The generated pressure mean: 0.446001261472702
loss_pred:0.02115253172814846, decouple_loss:0.0071901981718838215
The generated pressure mean: 0.44620397686958313
loss_pred:0.019038788974285126, decouple_loss:0.007276076357811689
Iteration: 3070, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4383071959018707
loss_pred:0.020280737429857254, decouple_loss:0.009158086031675339
The generated pressure mean: 0.4405958652496338
loss_pred:0.01936306059360504, decouple_loss:0.00903552956879139
The generated pressure mean: 0.44162991642951965
loss_pred:0.018407687544822693, decouple_loss:0.008997535333037376
2023-04-16 23:40:50 testing...
The generated pressure mean: 0.41600272059440613
The generated pressure mean: 0.4220414459705353
The generated pressure mean: 0.42390334606170654
loss_pred:0.032411038875579834, decouple_loss:0.009686563163995743
loss_pred:0.030850708484649658, decouple_loss:0.00991638284176588
loss_pred:0.030809709802269936, decouple_loss:0.00995758455246687
WV_0_PC_0_EH_1_PS_40, loss: 0.031849827617406845, avg_mse: 0.04591185972094536
current test mse: 0.045912
Iteration: 3071, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44656431674957275
loss_pred:0.022416407242417336, decouple_loss:0.009354698471724987
The generated pressure mean: 0.44763293862342834
loss_pred:0.01972479373216629, decouple_loss:0.009314763359725475
The generated pressure mean: 0.44636693596839905
loss_pred:0.020320996642112732, decouple_loss:0.009405403397977352
Iteration: 3072, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446984201669693
loss_pred:0.02099226973950863, decouple_loss:0.0072939107194542885
The generated pressure mean: 0.44487178325653076
loss_pred:0.018194038420915604, decouple_loss:0.007295005954802036
The generated pressure mean: 0.4524777829647064
loss_pred:0.019745195284485817, decouple_loss:0.007430410943925381
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3073, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4529445171356201
The generated pressure mean: 0.4443458020687103loss_pred:0.01923508569598198, decouple_loss:0.007497048936784267
loss_pred:0.01905282400548458, decouple_loss:0.00757319200783968
The generated pressure mean: 0.44795361161231995
loss_pred:0.020191529765725136, decouple_loss:0.007533619645982981
Iteration: 3074, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44673603773117065
The generated pressure mean: 0.45126816630363464
loss_pred:0.018857987597584724, decouple_loss:0.008811787702143192
loss_pred:0.019739286974072456, decouple_loss:0.008916091173887253
The generated pressure mean: 0.45044854283332825
loss_pred:0.019479259848594666, decouple_loss:0.00886548962444067
Iteration: 3075, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4351983666419983
loss_pred:0.021002013236284256, decouple_loss:0.007457849103957415
The generated pressure mean: 0.4380730390548706
loss_pred:0.019367560744285583, decouple_loss:0.007529047783464193
The generated pressure mean: 0.4398868978023529
loss_pred:0.020724665373563766, decouple_loss:0.007417379412800074
Iteration: 3076, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4385465085506439
loss_pred:0.019335387274622917, decouple_loss:0.007839484140276909
The generated pressure mean: 0.4446025490760803
loss_pred:0.01823405921459198, decouple_loss:0.007896313443779945
The generated pressure mean: 0.4364696741104126
loss_pred:0.019178729504346848, decouple_loss:0.007811354473233223
Iteration: 3077, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46087196469306946
loss_pred:0.02080223523080349, decouple_loss:0.008243481628596783
The generated pressure mean: 0.4585026204586029
loss_pred:0.020822929218411446, decouple_loss:0.008252478204667568
The generated pressure mean: 0.4638098180294037
loss_pred:0.019970357418060303, decouple_loss:0.008153322152793407
Iteration: 3078, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452296793460846
loss_pred:0.020352359861135483, decouple_loss:0.007717629428952932
The generated pressure mean: 0.44587579369544983
loss_pred:0.019754858687520027, decouple_loss:0.007858659140765667
The generated pressure mean: 0.44137871265411377
loss_pred:0.020226728171110153, decouple_loss:0.007767703849822283
Iteration: 3079, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43976661562919617
loss_pred:0.018776219338178635, decouple_loss:0.007643244229257107
The generated pressure mean: 0.4359067380428314
loss_pred:0.019743284210562706, decouple_loss:0.007756558246910572
The generated pressure mean: 0.44517776370048523
loss_pred:0.01826324313879013, decouple_loss:0.007532451767474413
Iteration: 3080, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44462448358535767
loss_pred:0.019873328506946564, decouple_loss:0.008272798731923103
The generated pressure mean: 0.44619476795196533
loss_pred:0.02016020193696022, decouple_loss:0.008288318291306496
The generated pressure mean: 0.43978166580200195
loss_pred:0.020108722150325775, decouple_loss:0.008297737687826157
2023-04-16 23:42:43 testing...
The generated pressure mean: 0.4144747853279114
The generated pressure mean: 0.42063671350479126
The generated pressure mean: 0.42267292737960815
loss_pred:0.03213970363140106, decouple_loss:0.010296485386788845
loss_pred:0.031246323138475418, decouple_loss:0.010433844290673733
loss_pred:0.03050624206662178, decouple_loss:0.010647224262356758
WV_0_PC_0_EH_1_PS_40, loss: 0.0318203829228878, avg_mse: 0.04609446972608566
current test mse: 0.046094
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 3081, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44970080256462097
loss_pred:0.018263693898916245, decouple_loss:0.010138893499970436
The generated pressure mean: 0.4500092566013336
The generated pressure mean: 0.4489443600177765
loss_pred:0.01939285174012184, decouple_loss:0.010217947885394096
loss_pred:0.01974131166934967, decouple_loss:0.010012423619627953
Iteration: 3082, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44479840993881226
The generated pressure mean: 0.44638946652412415
loss_pred:0.020829401910305023, decouple_loss:0.00781446136534214
loss_pred:0.01981576904654503, decouple_loss:0.0075838603079319
The generated pressure mean: 0.4462251365184784
loss_pred:0.020286614075303078, decouple_loss:0.007631821557879448
Iteration: 3083, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468845725059509
The generated pressure mean: 0.4427797496318817
loss_pred:0.020562224090099335, decouple_loss:0.007973928935825825
loss_pred:0.019907087087631226, decouple_loss:0.00791161134839058
The generated pressure mean: 0.4493497312068939
loss_pred:0.02052192948758602, decouple_loss:0.008011856116354465
Iteration: 3084, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44788721203804016
The generated pressure mean: 0.4495120942592621
loss_pred:0.01972385123372078, decouple_loss:0.009087301790714264
loss_pred:0.018904749304056168, decouple_loss:0.008917305618524551
The generated pressure mean: 0.4481770992279053
loss_pred:0.02085386961698532, decouple_loss:0.009029132314026356
Iteration: 3085, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44529256224632263
loss_pred:0.019175779074430466, decouple_loss:0.007576003670692444
The generated pressure mean: 0.4469936192035675
loss_pred:0.01966763287782669, decouple_loss:0.007565776351839304
The generated pressure mean: 0.44534623622894287
loss_pred:0.019225098192691803, decouple_loss:0.007743688300251961
Iteration: 3086, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44422462582588196
loss_pred:0.02104802243411541, decouple_loss:0.007291319314390421
The generated pressure mean: 0.4472365081310272
loss_pred:0.0189052801579237, decouple_loss:0.007451043464243412
The generated pressure mean: 0.4449850022792816
loss_pred:0.018632955849170685, decouple_loss:0.007289781700819731
Iteration: 3087, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4458220303058624
loss_pred:0.01853979378938675, decouple_loss:0.008805450983345509
The generated pressure mean: 0.4449300765991211
loss_pred:0.02000037394464016, decouple_loss:0.008627879433333874
The generated pressure mean: 0.4462890923023224
loss_pred:0.020367898046970367, decouple_loss:0.00901032891124487
Iteration: 3088, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44508013129234314
loss_pred:0.018613679334521294, decouple_loss:0.00820554606616497
The generated pressure mean: 0.4457530379295349
loss_pred:0.01937701180577278, decouple_loss:0.008207936771214008
The generated pressure mean: 0.44641411304473877
loss_pred:0.019634973257780075, decouple_loss:0.008218053728342056
Iteration: 3089, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44815459847450256
loss_pred:0.02051161602139473, decouple_loss:0.00829775258898735
The generated pressure mean: 0.44628021121025085
loss_pred:0.01931632310152054, decouple_loss:0.008241006173193455
The generated pressure mean: 0.45095187425613403
loss_pred:0.019615938887000084, decouple_loss:0.00842136237770319
Iteration: 3090, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4448547959327698
loss_pred:0.019907137379050255, decouple_loss:0.008714455179870129
The generated pressure mean: 0.4457836151123047
loss_pred:0.019998639822006226, decouple_loss:0.008908258751034737
The generated pressure mean: 0.4492678940296173
loss_pred:0.019497819244861603, decouple_loss:0.00880171824246645
2023-04-16 23:45:12 testing...
The generated pressure mean: 0.41499757766723633
The generated pressure mean: 0.4214886724948883
The generated pressure mean: 0.42333492636680603
loss_pred:0.032308559864759445, decouple_loss:0.008614154532551765
loss_pred:0.030499236658215523, decouple_loss:0.009038088843226433
loss_pred:0.031050333753228188, decouple_loss:0.0088405292481184
WV_0_PC_0_EH_1_PS_40, loss: 0.031727589666843414, avg_mse: 0.04633869230747223
current test mse: 0.046339
Iteration: 3091, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45099711418151855
loss_pred:0.01898716390132904, decouple_loss:0.008209051564335823
The generated pressure mean: 0.44809219241142273
loss_pred:0.019902540370821953, decouple_loss:0.008183223195374012
The generated pressure mean: 0.4476388692855835
loss_pred:0.019680773839354515, decouple_loss:0.008168560452759266
Iteration: 3092, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4398655891418457
loss_pred:0.019093655049800873, decouple_loss:0.007201071362942457
The generated pressure mean: 0.4446117579936981
loss_pred:0.018487555906176567, decouple_loss:0.0072439443320035934
The generated pressure mean: 0.44481244683265686
loss_pred:0.02008611150085926, decouple_loss:0.007256101816892624
Iteration: 3093, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474736750125885
loss_pred:0.020666949450969696, decouple_loss:0.008205248042941093
The generated pressure mean: 0.44882476329803467
loss_pred:0.01988014578819275, decouple_loss:0.008098837919533253
The generated pressure mean: 0.4485642611980438
loss_pred:0.018060393631458282, decouple_loss:0.008071735501289368
Iteration: 3094, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44243770837783813
loss_pred:0.019999463111162186, decouple_loss:0.007014918141067028
The generated pressure mean: 0.44659191370010376
loss_pred:0.019870072603225708, decouple_loss:0.007327052764594555
The generated pressure mean: 0.4441642165184021
loss_pred:0.021558944135904312, decouple_loss:0.007293529808521271
Iteration: 3095, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4538359045982361
loss_pred:0.022288240492343903, decouple_loss:0.00793327484279871
The generated pressure mean: 0.4477306604385376
loss_pred:0.02258550003170967, decouple_loss:0.007940328679978848
The generated pressure mean: 0.4489576816558838
loss_pred:0.01841784454882145, decouple_loss:0.007896128110587597
Iteration: 3096, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4219539761543274
loss_pred:0.020311526954174042, decouple_loss:0.00755704939365387
The generated pressure mean: 0.42100417613983154
loss_pred:0.020336192101240158, decouple_loss:0.007505845278501511
The generated pressure mean: 0.4213501214981079
loss_pred:0.022375429049134254, decouple_loss:0.007762686815112829
Iteration: 3097, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47597819566726685
loss_pred:0.022083688527345657, decouple_loss:0.00836962927132845
The generated pressure mean: 0.47467389702796936
loss_pred:0.02007952146232128, decouple_loss:0.008287103846669197
The generated pressure mean: 0.4764837920665741
loss_pred:0.02101225033402443, decouple_loss:0.00817732885479927
Iteration: 3098, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503245949745178
The generated pressure mean: 0.4519156515598297
loss_pred:0.020075492560863495, decouple_loss:0.008435512892901897
loss_pred:0.019617566838860512, decouple_loss:0.008463189005851746
The generated pressure mean: 0.45554256439208984
loss_pred:0.018446223810315132, decouple_loss:0.008456217125058174
Iteration: 3099, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4270666837692261
loss_pred:0.021375123411417007, decouple_loss:0.008850755169987679
The generated pressure mean: 0.4265720248222351
loss_pred:0.020369093865156174, decouple_loss:0.009009509347379208
The generated pressure mean: 0.4329150319099426
loss_pred:0.020803745836019516, decouple_loss:0.009064923040568829
Iteration: 3100, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46041592955589294
loss_pred:0.020731689408421516, decouple_loss:0.008925746195018291
The generated pressure mean: 0.4614415168762207
loss_pred:0.022793808951973915, decouple_loss:0.008938640356063843
The generated pressure mean: 0.46563035249710083
loss_pred:0.019942017272114754, decouple_loss:0.00901719368994236
2023-04-16 23:47:06 testing...
The generated pressure mean: 0.42411747574806213
The generated pressure mean: 0.4287433922290802
The generated pressure mean: 0.4309137463569641
loss_pred:0.032576169818639755, decouple_loss:0.009127499535679817
loss_pred:0.03172862529754639, decouple_loss:0.00913938321173191
loss_pred:0.03125559166073799, decouple_loss:0.00917430967092514
WV_0_PC_0_EH_1_PS_40, loss: 0.032310813665390015, avg_mse: 0.0463591031730175
current test mse: 0.046359
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 3101, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.41296154260635376
loss_pred:0.023919057101011276, decouple_loss:0.008830773644149303
The generated pressure mean: 0.4110378324985504
The generated pressure mean: 0.4168108105659485
loss_pred:0.022018790245056152, decouple_loss:0.008740830235183239
loss_pred:0.022372225299477577, decouple_loss:0.00878386851400137
Iteration: 3102, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.49154651165008545
The generated pressure mean: 0.49036863446235657
loss_pred:0.02112269215285778, decouple_loss:0.010539603419601917
loss_pred:0.02144492417573929, decouple_loss:0.010631125420331955
The generated pressure mean: 0.48392564058303833
loss_pred:0.020025720819830894, decouple_loss:0.01049256045371294
Iteration: 3103, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45191121101379395
The generated pressure mean: 0.4550141394138336
loss_pred:0.020420389249920845, decouple_loss:0.010135925374925137
loss_pred:0.020469002425670624, decouple_loss:0.010143307968974113
The generated pressure mean: 0.44818928837776184
loss_pred:0.020082315430045128, decouple_loss:0.010261974297463894
Iteration: 3104, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.41463759541511536
The generated pressure mean: 0.4148201644420624
loss_pred:0.020972860977053642, decouple_loss:0.010133842937648296
loss_pred:0.025296121835708618, decouple_loss:0.010249833576381207
The generated pressure mean: 0.4168024957180023
loss_pred:0.020266443490982056, decouple_loss:0.009934726171195507
Iteration: 3105, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.48182302713394165
The generated pressure mean: 0.4848138391971588
loss_pred:0.02080925554037094, decouple_loss:0.012943241745233536
loss_pred:0.020530061796307564, decouple_loss:0.012557094916701317
The generated pressure mean: 0.48042288422584534
loss_pred:0.02128472551703453, decouple_loss:0.012565475888550282
Iteration: 3106, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4357501268386841
The generated pressure mean: 0.43018871545791626
loss_pred:0.02130242809653282, decouple_loss:0.010970168747007847
loss_pred:0.020288696512579918, decouple_loss:0.01099221222102642
The generated pressure mean: 0.43340206146240234
loss_pred:0.020834563300013542, decouple_loss:0.01100362092256546
Iteration: 3107, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493906795978546The generated pressure mean: 0.4479552209377289
loss_pred:0.02168111875653267, decouple_loss:0.011854217387735844
loss_pred:0.02125106006860733, decouple_loss:0.011634978465735912
The generated pressure mean: 0.448934942483902
loss_pred:0.020824845880270004, decouple_loss:0.011693257838487625
Iteration: 3108, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.445384681224823
The generated pressure mean: 0.44371166825294495
loss_pred:0.021823249757289886, decouple_loss:0.012260508723556995
loss_pred:0.022906258702278137, decouple_loss:0.012279852293431759
The generated pressure mean: 0.4454222619533539
loss_pred:0.02293534390628338, decouple_loss:0.012323984876275063
Iteration: 3109, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4576147198677063
loss_pred:0.021777009591460228, decouple_loss:0.014332540333271027
The generated pressure mean: 0.4575967788696289
loss_pred:0.021649746224284172, decouple_loss:0.014042788185179234
The generated pressure mean: 0.46108511090278625
loss_pred:0.022563429549336433, decouple_loss:0.01418469287455082
Iteration: 3110, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46133849024772644
loss_pred:0.021639270707964897, decouple_loss:0.014442034997045994
The generated pressure mean: 0.4582209587097168
loss_pred:0.022292781621217728, decouple_loss:0.01442187000066042
The generated pressure mean: 0.4567088782787323
loss_pred:0.02274446003139019, decouple_loss:0.014459492638707161
2023-04-16 23:49:37 testing...
The generated pressure mean: 0.4188472032546997
The generated pressure mean: 0.4249797761440277
The generated pressure mean: 0.4268876016139984
loss_pred:0.036240968853235245, decouple_loss:0.014400720596313477
loss_pred:0.03537250682711601, decouple_loss:0.014383026398718357
loss_pred:0.03531959652900696, decouple_loss:0.014509418979287148
WV_0_PC_0_EH_1_PS_40, loss: 0.03636591136455536, avg_mse: 0.053026728332042694
current test mse: 0.053027
Iteration: 3111, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43234890699386597
The generated pressure mean: 0.43728625774383545
loss_pred:0.023518793284893036, decouple_loss:0.014075773768126965
loss_pred:0.022686151787638664, decouple_loss:0.014127067290246487
The generated pressure mean: 0.436285138130188
loss_pred:0.02724086493253708, decouple_loss:0.014066374860703945
Iteration: 3112, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43798255920410156
The generated pressure mean: 0.439383864402771
loss_pred:0.025763828307390213, decouple_loss:0.018321432173252106
loss_pred:0.026505710557103157, decouple_loss:0.018460996448993683
The generated pressure mean: 0.43778350949287415
loss_pred:0.026718659326434135, decouple_loss:0.018241580575704575
Iteration: 3113, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4889707565307617
The generated pressure mean: 0.4910662770271301
loss_pred:0.02547222189605236, decouple_loss:0.019881946966052055
loss_pred:0.026375429704785347, decouple_loss:0.019913900643587112
The generated pressure mean: 0.49183544516563416
loss_pred:0.023906953632831573, decouple_loss:0.020015718415379524
Iteration: 3114, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.38813963532447815
loss_pred:0.033396076411008835, decouple_loss:0.025431916117668152
The generated pressure mean: 0.3902691602706909
loss_pred:0.031950514763593674, decouple_loss:0.025610629469156265
The generated pressure mean: 0.39176490902900696
loss_pred:0.03171249106526375, decouple_loss:0.025391314178705215
Iteration: 3115, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.547599196434021
loss_pred:0.046279825270175934, decouple_loss:0.0378350168466568
The generated pressure mean: 0.5547133088111877
loss_pred:0.044728830456733704, decouple_loss:0.03772308677434921
The generated pressure mean: 0.5529842972755432
loss_pred:0.04739852994680405, decouple_loss:0.037891171872615814
Iteration: 3116, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.3690890371799469
loss_pred:0.041301436722278595, decouple_loss:0.04887587949633598
The generated pressure mean: 0.37054818868637085
loss_pred:0.04262194037437439, decouple_loss:0.04881304129958153
The generated pressure mean: 0.3708990216255188
loss_pred:0.041424065828323364, decouple_loss:0.048951633274555206
Iteration: 3117, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.6085143685340881
loss_pred:0.09811484813690186, decouple_loss:0.0667964294552803
The generated pressure mean: 0.6279992461204529
loss_pred:0.09560525417327881, decouple_loss:0.06951949745416641
The generated pressure mean: 0.6053386926651001
loss_pred:0.11286164820194244, decouple_loss:0.06562398374080658
Iteration: 3118, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.29567307233810425
loss_pred:0.1409619301557541, decouple_loss:0.07293429225683212
The generated pressure mean: 0.2921536862850189
loss_pred:0.12983578443527222, decouple_loss:0.0731690376996994
The generated pressure mean: 0.2906605899333954
loss_pred:0.13946448266506195, decouple_loss:0.07317408919334412
Iteration: 3119, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.546147882938385
loss_pred:0.15296339988708496, decouple_loss:0.09039537608623505
The generated pressure mean: 0.5383290648460388
loss_pred:0.14948059618473053, decouple_loss:0.09051306545734406
The generated pressure mean: 0.5217841267585754
loss_pred:0.16731961071491241, decouple_loss:0.09206365793943405
Iteration: 3120, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.6027536988258362
loss_pred:0.11985597014427185, decouple_loss:0.15032899379730225
The generated pressure mean: 0.5962285995483398
loss_pred:0.12016584724187851, decouple_loss:0.14881841838359833
The generated pressure mean: 0.6013186573982239
loss_pred:0.12039579451084137, decouple_loss:0.15056250989437103
2023-04-16 23:51:31 testing...
The generated pressure mean: 0.5806341767311096
The generated pressure mean: 0.580912172794342
loss_pred:0.29613739252090454, decouple_loss:0.38504838943481445
The generated pressure mean: 0.5809037685394287
loss_pred:0.29621240496635437, decouple_loss:0.38697585463523865
loss_pred:0.29850873351097107, decouple_loss:0.387002557516098
WV_0_PC_0_EH_1_PS_40, loss: 0.31626996397972107, avg_mse: 0.32699379324913025
current test mse: 0.326994
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 3121, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: -0.14248698949813843
loss_pred:0.30984416604042053, decouple_loss:0.3734733760356903
The generated pressure mean: -0.14254072308540344
The generated pressure mean: -0.144313782453537
loss_pred:0.3101545572280884, decouple_loss:0.37089988589286804
loss_pred:0.3085440695285797, decouple_loss:0.3766782879829407
Iteration: 3122, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.7631732821464539
The generated pressure mean: 0.7634492516517639
loss_pred:0.1908336728811264, decouple_loss:0.8076066374778748
loss_pred:0.18807372450828552, decouple_loss:0.8067638278007507
The generated pressure mean: 0.763149082660675
loss_pred:0.1843552142381668, decouple_loss:0.8058995008468628
Iteration: 3123, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.5637691617012024
loss_pred:0.12146013975143433, decouple_loss:0.8578685522079468
The generated pressure mean: 0.5643221735954285
loss_pred:0.12122886627912521, decouple_loss:0.8558093905448914
The generated pressure mean: 0.5639322400093079
loss_pred:0.12226326763629913, decouple_loss:0.859329104423523
Iteration: 3124, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.54142165184021
loss_pred:0.10827820748090744, decouple_loss:0.817868709564209
The generated pressure mean: 0.5419281125068665
loss_pred:0.1049160286784172, decouple_loss:0.811665952205658
The generated pressure mean: 0.5409588813781738
loss_pred:0.10492798686027527, decouple_loss:0.8096936345100403
Iteration: 3125, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44842153787612915
The generated pressure mean: 0.44758716225624084loss_pred:0.09684925526380539, decouple_loss:0.7829182147979736
loss_pred:0.09758725762367249, decouple_loss:0.7866738438606262
The generated pressure mean: 0.4476890563964844
loss_pred:0.09855503588914871, decouple_loss:0.7830528020858765
Iteration: 3126, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4554832875728607
The generated pressure mean: 0.45477527379989624
loss_pred:0.09487093985080719, decouple_loss:0.704516589641571
loss_pred:0.09754379093647003, decouple_loss:0.7027604579925537
The generated pressure mean: 0.45427677035331726
loss_pred:0.09725499153137207, decouple_loss:0.7073018550872803
Iteration: 3127, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.39718979597091675
The generated pressure mean: 0.39693716168403625
loss_pred:0.09986055642366409, decouple_loss:0.29792702198028564
loss_pred:0.10070589929819107, decouple_loss:0.2984680235385895
The generated pressure mean: 0.39683911204338074
loss_pred:0.10371381789445877, decouple_loss:0.30329614877700806
Iteration: 3128, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.48049992322921753
loss_pred:0.10031221807003021, decouple_loss:0.23414631187915802
The generated pressure mean: 0.4806020259857178
loss_pred:0.09974624961614609, decouple_loss:0.23448419570922852
The generated pressure mean: 0.479769766330719
loss_pred:0.09937237948179245, decouple_loss:0.22965414822101593
Iteration: 3129, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46885615587234497
loss_pred:0.08985196799039841, decouple_loss:0.23504281044006348
The generated pressure mean: 0.4697955250740051
loss_pred:0.09184373915195465, decouple_loss:0.2335716187953949
The generated pressure mean: 0.46910804510116577
loss_pred:0.090232715010643, decouple_loss:0.23773016035556793
Iteration: 3130, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4396778345108032
The generated pressure mean: 0.43885019421577454
loss_pred:0.08789205551147461, decouple_loss:0.20213215053081512
loss_pred:0.08630776405334473, decouple_loss:0.19964630901813507
The generated pressure mean: 0.4380411207675934
loss_pred:0.08638812601566315, decouple_loss:0.2016066163778305
2023-04-16 23:54:02 testing...
The generated pressure mean: 0.4128875136375427
The generated pressure mean: 0.412923663854599
The generated pressure mean: 0.4126550853252411
loss_pred:0.09040705859661102, decouple_loss:0.16093994677066803
loss_pred:0.09062935411930084, decouple_loss:0.16253243386745453
loss_pred:0.09093359112739563, decouple_loss:0.16264133155345917
WV_0_PC_0_EH_1_PS_40, loss: 0.09875857084989548, avg_mse: 0.09167664498090744
current test mse: 0.091677
Iteration: 3131, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4346913993358612
The generated pressure mean: 0.4362280070781708
loss_pred:0.08571391552686691, decouple_loss:0.16011786460876465
loss_pred:0.08377527445554733, decouple_loss:0.15945342183113098
The generated pressure mean: 0.43496349453926086
loss_pred:0.08186409622430801, decouple_loss:0.16227242350578308
Iteration: 3132, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4311465919017792
The generated pressure mean: 0.431934654712677
loss_pred:0.08388269692659378, decouple_loss:0.14274688065052032
loss_pred:0.08566474914550781, decouple_loss:0.1411592811346054
The generated pressure mean: 0.43337586522102356
loss_pred:0.08290626853704453, decouple_loss:0.14241209626197815
Iteration: 3133, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4396544396877289
The generated pressure mean: 0.44080713391304016
loss_pred:0.08728756755590439, decouple_loss:0.13106492161750793
loss_pred:0.08296411484479904, decouple_loss:0.1292044073343277
The generated pressure mean: 0.4405902922153473
loss_pred:0.08474233746528625, decouple_loss:0.13164600729942322
Iteration: 3134, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4535209834575653
The generated pressure mean: 0.45333272218704224
loss_pred:0.08248696476221085, decouple_loss:0.11065001785755157
loss_pred:0.08508805185556412, decouple_loss:0.11341655999422073
The generated pressure mean: 0.45355165004730225
loss_pred:0.08327820897102356, decouple_loss:0.11134535074234009
Iteration: 3135, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46649622917175293
The generated pressure mean: 0.4663216769695282
loss_pred:0.08453536033630371, decouple_loss:0.10268726199865341
loss_pred:0.08167090266942978, decouple_loss:0.10260562598705292
The generated pressure mean: 0.46595919132232666
loss_pred:0.08122246712446213, decouple_loss:0.10237547010183334
Iteration: 3136, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4727425277233124
The generated pressure mean: 0.471648246049881
loss_pred:0.0811433494091034, decouple_loss:0.08963743597269058
loss_pred:0.08180970698595047, decouple_loss:0.0892515778541565
The generated pressure mean: 0.4716125726699829
loss_pred:0.08311975002288818, decouple_loss:0.09073109924793243
Iteration: 3137, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46649250388145447
The generated pressure mean: 0.46564504504203796
loss_pred:0.08100558817386627, decouple_loss:0.08203233033418655
loss_pred:0.08485081791877747, decouple_loss:0.08196983486413956
The generated pressure mean: 0.4673766493797302
loss_pred:0.08105527609586716, decouple_loss:0.08081371337175369
Iteration: 3138, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45091724395751953
loss_pred:0.07770483195781708, decouple_loss:0.07597236335277557
The generated pressure mean: 0.45041823387145996
loss_pred:0.08344010263681412, decouple_loss:0.07599134743213654
The generated pressure mean: 0.4499167799949646
loss_pred:0.08318652212619781, decouple_loss:0.076986163854599
Iteration: 3139, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4333376884460449
loss_pred:0.08149362355470657, decouple_loss:0.06782712042331696
The generated pressure mean: 0.43252748250961304
loss_pred:0.08177955448627472, decouple_loss:0.06839402765035629
The generated pressure mean: 0.4331173896789551
loss_pred:0.07837079465389252, decouple_loss:0.06820982694625854
Iteration: 3140, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42636969685554504
loss_pred:0.08288192003965378, decouple_loss:0.06691871583461761
The generated pressure mean: 0.42772242426872253
loss_pred:0.0788441002368927, decouple_loss:0.06605659425258636
The generated pressure mean: 0.42726442217826843
loss_pred:0.0783664882183075, decouple_loss:0.0644521564245224
2023-04-16 23:55:56 testing...
The generated pressure mean: 0.4145038425922394
The generated pressure mean: 0.414539635181427
The generated pressure mean: 0.4142776131629944
loss_pred:0.0836666002869606, decouple_loss:0.0604638010263443
loss_pred:0.08405687659978867, decouple_loss:0.060238707810640335
loss_pred:0.08442223072052002, decouple_loss:0.06149856373667717
WV_0_PC_0_EH_1_PS_40, loss: 0.08708524703979492, avg_mse: 0.08491092175245285
current test mse: 0.084911
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 3141, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4311530590057373
loss_pred:0.07609467953443527, decouple_loss:0.06085000932216644
The generated pressure mean: 0.42977243661880493
The generated pressure mean: 0.4300000071525574
loss_pred:0.07898995280265808, decouple_loss:0.061337780207395554
loss_pred:0.07886610925197601, decouple_loss:0.061391670256853104
Iteration: 3142, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44124311208724976
The generated pressure mean: 0.4418681263923645loss_pred:0.0794200524687767, decouple_loss:0.05521569028496742
loss_pred:0.07948120683431625, decouple_loss:0.057003479450941086
The generated pressure mean: 0.44087520241737366
loss_pred:0.07973629981279373, decouple_loss:0.05628785863518715
Iteration: 3143, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44522976875305176
The generated pressure mean: 0.4461907744407654
loss_pred:0.08140645921230316, decouple_loss:0.05379195883870125
loss_pred:0.07784470915794373, decouple_loss:0.05423511192202568
The generated pressure mean: 0.44636601209640503
loss_pred:0.07798267155885696, decouple_loss:0.05405518785119057
Iteration: 3144, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45170432329177856
The generated pressure mean: 0.45236581563949585
loss_pred:0.07965795695781708, decouple_loss:0.048138104379177094
loss_pred:0.0775182917714119, decouple_loss:0.05165133252739906
The generated pressure mean: 0.4526868462562561
loss_pred:0.07926072180271149, decouple_loss:0.0507294163107872
Iteration: 3145, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4553338587284088
The generated pressure mean: 0.45415350794792175
loss_pred:0.07703722268342972, decouple_loss:0.04587530344724655
loss_pred:0.07930474728345871, decouple_loss:0.04505893215537071
The generated pressure mean: 0.45455625653266907
loss_pred:0.07764972001314163, decouple_loss:0.04667533561587334
Iteration: 3146, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4537949860095978
loss_pred:0.07984129339456558, decouple_loss:0.04464775323867798
The generated pressure mean: 0.4534013867378235
loss_pred:0.07523103058338165, decouple_loss:0.04352237656712532
The generated pressure mean: 0.45301198959350586
loss_pred:0.0766565352678299, decouple_loss:0.0440794862806797
Iteration: 3147, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4512138068675995The generated pressure mean: 0.44956573843955994
loss_pred:0.07414721697568893, decouple_loss:0.04072623699903488
loss_pred:0.0765468180179596, decouple_loss:0.04030011594295502
The generated pressure mean: 0.45088812708854675
loss_pred:0.07884783297777176, decouple_loss:0.040680743753910065
Iteration: 3148, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462507963180542
loss_pred:0.07717454433441162, decouple_loss:0.0401812307536602
The generated pressure mean: 0.4465199410915375
loss_pred:0.07705067098140717, decouple_loss:0.039557911455631256
The generated pressure mean: 0.44565549492836
loss_pred:0.07521689683198929, decouple_loss:0.038852427154779434
Iteration: 3149, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4450114369392395
loss_pred:0.07844787836074829, decouple_loss:0.038755305111408234
The generated pressure mean: 0.44565415382385254
loss_pred:0.07625976204872131, decouple_loss:0.03717997670173645
The generated pressure mean: 0.4452374577522278
loss_pred:0.07458119839429855, decouple_loss:0.03794286027550697
Iteration: 3150, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4448992908000946
The generated pressure mean: 0.44358667731285095
loss_pred:0.07497607171535492, decouple_loss:0.03539616987109184
loss_pred:0.07536204159259796, decouple_loss:0.03521408140659332
The generated pressure mean: 0.4435969591140747
loss_pred:0.07327325642108917, decouple_loss:0.035057153552770615
2023-04-16 23:58:22 testing...
The generated pressure mean: 0.40968450903892517
The generated pressure mean: 0.409724622964859
The generated pressure mean: 0.4094652831554413
loss_pred:0.07961646467447281, decouple_loss:0.03428573161363602
loss_pred:0.08007736504077911, decouple_loss:0.03461576998233795
loss_pred:0.08027344197034836, decouple_loss:0.03454394266009331
WV_0_PC_0_EH_1_PS_40, loss: 0.08171318471431732, avg_mse: 0.08096000552177429
current test mse: 0.08096
Iteration: 3151, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488796293735504
The generated pressure mean: 0.4478810429573059loss_pred:0.07563455402851105, decouple_loss:0.03341959789395332
loss_pred:0.07629309594631195, decouple_loss:0.03339754045009613
The generated pressure mean: 0.4491795599460602
loss_pred:0.07512824982404709, decouple_loss:0.03408677875995636
Iteration: 3152, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487415552139282
The generated pressure mean: 0.44857919216156006
loss_pred:0.07212229818105698, decouple_loss:0.03152482584118843
loss_pred:0.0757385864853859, decouple_loss:0.03172655031085014
The generated pressure mean: 0.44856277108192444
loss_pred:0.07667768001556396, decouple_loss:0.032407086342573166
Iteration: 3153, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44876766204833984
loss_pred:0.07358971983194351, decouple_loss:0.030917992815375328
The generated pressure mean: 0.44841617345809937
loss_pred:0.07331328839063644, decouple_loss:0.030363654717803
The generated pressure mean: 0.4475574791431427
loss_pred:0.07401817291975021, decouple_loss:0.03111131303012371
Iteration: 3154, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44701555371284485
loss_pred:0.07326766848564148, decouple_loss:0.030390989035367966
The generated pressure mean: 0.44614315032958984
loss_pred:0.07082954794168472, decouple_loss:0.029108989983797073
The generated pressure mean: 0.445883184671402
loss_pred:0.07086926698684692, decouple_loss:0.028922969475388527
Iteration: 3155, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478102922439575
loss_pred:0.07098614424467087, decouple_loss:0.029682351276278496
The generated pressure mean: 0.4470018446445465
loss_pred:0.06986039876937866, decouple_loss:0.029056373983621597
The generated pressure mean: 0.4453127682209015
loss_pred:0.07038688659667969, decouple_loss:0.0275057852268219
Iteration: 3156, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4450415372848511
loss_pred:0.07122037559747696, decouple_loss:0.02671677991747856
The generated pressure mean: 0.44536668062210083
loss_pred:0.07099688053131104, decouple_loss:0.027175212278962135
The generated pressure mean: 0.44466084241867065
loss_pred:0.07039646059274673, decouple_loss:0.026404859498143196
Iteration: 3157, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44420015811920166
loss_pred:0.07222496718168259, decouple_loss:0.02606351673603058
The generated pressure mean: 0.44593939185142517
loss_pred:0.07082948088645935, decouple_loss:0.026812288910150528
The generated pressure mean: 0.4440373182296753
loss_pred:0.07035890966653824, decouple_loss:0.026180008426308632
Iteration: 3158, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44663354754447937
loss_pred:0.07130401581525803, decouple_loss:0.024153003469109535
The generated pressure mean: 0.4460386335849762
loss_pred:0.07084787636995316, decouple_loss:0.024073833599686623
The generated pressure mean: 0.44818735122680664
loss_pred:0.06796277314424515, decouple_loss:0.024273181334137917
Iteration: 3159, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4510626494884491
loss_pred:0.07082612812519073, decouple_loss:0.02490413188934326
The generated pressure mean: 0.45062321424484253
loss_pred:0.06980501860380173, decouple_loss:0.02534676529467106
The generated pressure mean: 0.44992193579673767
loss_pred:0.06969626247882843, decouple_loss:0.02492758259177208
Iteration: 3160, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45315980911254883
loss_pred:0.07171749323606491, decouple_loss:0.023150024935603142
The generated pressure mean: 0.45449313521385193
loss_pred:0.0662437230348587, decouple_loss:0.02297123894095421
The generated pressure mean: 0.453244686126709
loss_pred:0.0686120018362999, decouple_loss:0.024170564487576485
2023-04-17 00:00:16 testing...
The generated pressure mean: 0.407632976770401
The generated pressure mean: 0.4075838625431061
The generated pressure mean: 0.40738213062286377
loss_pred:0.07474414259195328, decouple_loss:0.024904336780309677
loss_pred:0.07436801493167877, decouple_loss:0.024441806599497795
loss_pred:0.07481902092695236, decouple_loss:0.02464023046195507
WV_0_PC_0_EH_1_PS_40, loss: 0.07587683200836182, avg_mse: 0.07565633952617645
current test mse: 0.075656
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 3161, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4587107002735138
loss_pred:0.06965505331754684, decouple_loss:0.02360229194164276
The generated pressure mean: 0.4586271643638611
The generated pressure mean: 0.45760178565979004
loss_pred:0.0710785910487175, decouple_loss:0.02278957888484001
loss_pred:0.06794065237045288, decouple_loss:0.022740375250577927
Iteration: 3162, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45127731561660767
loss_pred:0.07078284025192261, decouple_loss:0.02163931541144848
The generated pressure mean: 0.4496876299381256
loss_pred:0.06951867789030075, decouple_loss:0.021945353597402573
The generated pressure mean: 0.4524763822555542
loss_pred:0.06983239948749542, decouple_loss:0.021205531433224678
Iteration: 3163, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4440823793411255
The generated pressure mean: 0.44577696919441223
loss_pred:0.06740649789571762, decouple_loss:0.020714160054922104
loss_pred:0.0684906542301178, decouple_loss:0.021081551909446716
The generated pressure mean: 0.4457228481769562
loss_pred:0.06641565263271332, decouple_loss:0.020499277859926224
Iteration: 3164, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4414892792701721
loss_pred:0.0683729276061058, decouple_loss:0.021593496203422546
The generated pressure mean: 0.4407610297203064
loss_pred:0.06683272868394852, decouple_loss:0.020589979365468025
The generated pressure mean: 0.44058528542518616
loss_pred:0.0654425397515297, decouple_loss:0.021268049255013466
Iteration: 3165, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44254958629608154
The generated pressure mean: 0.4404289126396179
loss_pred:0.0681527629494667, decouple_loss:0.02070312201976776
loss_pred:0.06612390279769897, decouple_loss:0.02112448401749134
The generated pressure mean: 0.44147229194641113
loss_pred:0.06610473990440369, decouple_loss:0.02108103036880493
Iteration: 3166, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44956424832344055
The generated pressure mean: 0.4493057429790497
loss_pred:0.06262306123971939, decouple_loss:0.020622678101062775
loss_pred:0.06367144733667374, decouple_loss:0.019709639251232147
The generated pressure mean: 0.4498027563095093
loss_pred:0.06390421092510223, decouple_loss:0.02075972966849804
Iteration: 3167, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4605260193347931
The generated pressure mean: 0.4593062698841095
loss_pred:0.06770332902669907, decouple_loss:0.02028392069041729
loss_pred:0.0652337372303009, decouple_loss:0.020162060856819153
The generated pressure mean: 0.45924466848373413
loss_pred:0.06480250507593155, decouple_loss:0.02151648700237274
Iteration: 3168, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46215277910232544
The generated pressure mean: 0.4635781943798065
loss_pred:0.06549714505672455, decouple_loss:0.021610718220472336
loss_pred:0.06504621356725693, decouple_loss:0.02042103186249733
The generated pressure mean: 0.46211278438568115
loss_pred:0.0642969086766243, decouple_loss:0.020180746912956238
Iteration: 3169, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4636833667755127
loss_pred:0.06297567486763, decouple_loss:0.021642982959747314
The generated pressure mean: 0.4635331928730011
loss_pred:0.06100257486104965, decouple_loss:0.021653009578585625
The generated pressure mean: 0.46265801787376404
loss_pred:0.06143470108509064, decouple_loss:0.021892886608839035
Iteration: 3170, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45470431447029114
The generated pressure mean: 0.4554115831851959
loss_pred:0.06205788999795914, decouple_loss:0.02076287940144539
loss_pred:0.06330619007349014, decouple_loss:0.020665153861045837
The generated pressure mean: 0.4545527696609497
loss_pred:0.06095629930496216, decouple_loss:0.02131764031946659
2023-04-17 00:02:45 testing...
The generated pressure mean: 0.41209572553634644
The generated pressure mean: 0.4121394455432892
The generated pressure mean: 0.41189083456993103
loss_pred:0.06667056679725647, decouple_loss:0.020061492919921875
loss_pred:0.0671386867761612, decouple_loss:0.02021803706884384
loss_pred:0.06701893359422684, decouple_loss:0.020179565995931625
WV_0_PC_0_EH_1_PS_40, loss: 0.06795038282871246, avg_mse: 0.06774198263883591
current test mse: 0.067742
Iteration: 3171, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44065189361572266
loss_pred:0.06167721748352051, decouple_loss:0.019516058266162872
The generated pressure mean: 0.4404083788394928
loss_pred:0.06005070358514786, decouple_loss:0.019988251850008965
The generated pressure mean: 0.44090402126312256
loss_pred:0.06276184320449829, decouple_loss:0.019364211708307266
Iteration: 3172, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4426095187664032
loss_pred:0.059830427169799805, decouple_loss:0.01702963374555111
The generated pressure mean: 0.4433674216270447
loss_pred:0.06208176165819168, decouple_loss:0.017312906682491302
The generated pressure mean: 0.4421718418598175
loss_pred:0.058666739612817764, decouple_loss:0.017513994127511978
Iteration: 3173, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467240571975708
The generated pressure mean: 0.44557273387908936
loss_pred:0.06104510277509689, decouple_loss:0.01770484447479248
loss_pred:0.06131647899746895, decouple_loss:0.018511638045310974
The generated pressure mean: 0.4460892081260681
loss_pred:0.05747099220752716, decouple_loss:0.017262011766433716
Iteration: 3174, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45144128799438477
loss_pred:0.06063440069556236, decouple_loss:0.019786981865763664
The generated pressure mean: 0.4499703049659729
loss_pred:0.06062006950378418, decouple_loss:0.019366979598999023
The generated pressure mean: 0.451536625623703
loss_pred:0.06308920681476593, decouple_loss:0.02005515806376934
Iteration: 3175, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4563803970813751
The generated pressure mean: 0.45518699288368225
loss_pred:0.05772889778017998, decouple_loss:0.021758008748292923
loss_pred:0.05819930136203766, decouple_loss:0.021419985219836235
The generated pressure mean: 0.45695731043815613
loss_pred:0.060474369674921036, decouple_loss:0.022996000945568085
Iteration: 3176, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45786044001579285
The generated pressure mean: 0.4582216143608093
loss_pred:0.05611709877848625, decouple_loss:0.018915589898824692
loss_pred:0.05981237441301346, decouple_loss:0.018124163150787354
The generated pressure mean: 0.45912113785743713
loss_pred:0.058051083236932755, decouple_loss:0.018390072509646416
Iteration: 3177, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45728641748428345
loss_pred:0.06213292106986046, decouple_loss:0.01598154939711094
The generated pressure mean: 0.4568602442741394
loss_pred:0.058484092354774475, decouple_loss:0.016123250126838684
The generated pressure mean: 0.4571096897125244
loss_pred:0.05786844342947006, decouple_loss:0.017222272232174873
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3178, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4550350606441498
The generated pressure mean: 0.4543716609477997
loss_pred:0.05835511535406113, decouple_loss:0.017096126452088356
loss_pred:0.05937565118074417, decouple_loss:0.017951756715774536
The generated pressure mean: 0.4550930857658386
loss_pred:0.06161374971270561, decouple_loss:0.018076308071613312
Iteration: 3179, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490848779678345
loss_pred:0.05667167529463768, decouple_loss:0.019243165850639343
The generated pressure mean: 0.45055434107780457
loss_pred:0.05621509999036789, decouple_loss:0.01887284591794014
The generated pressure mean: 0.44966670870780945
loss_pred:0.05473306030035019, decouple_loss:0.0183259304612875
Iteration: 3180, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473225474357605
loss_pred:0.05870678275823593, decouple_loss:0.015436789952218533
The generated pressure mean: 0.4464733302593231
loss_pred:0.05415830388665199, decouple_loss:0.01638544164597988
The generated pressure mean: 0.44603970646858215
loss_pred:0.05551894009113312, decouple_loss:0.015704257413744926
2023-04-17 00:04:39 testing...
The generated pressure mean: 0.41119447350502014
The generated pressure mean: 0.41120919585227966
The generated pressure mean: 0.4109540581703186
loss_pred:0.06255204230546951, decouple_loss:0.01754826307296753
loss_pred:0.06293240934610367, decouple_loss:0.01765768602490425
loss_pred:0.06247757002711296, decouple_loss:0.01766577549278736
WV_0_PC_0_EH_1_PS_40, loss: 0.06353520601987839, avg_mse: 0.0638161227107048
current test mse: 0.063816
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 3181, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4415489733219147
loss_pred:0.057741373777389526, decouple_loss:0.017925502732396126
The generated pressure mean: 0.4407718777656555
loss_pred:0.05807194858789444, decouple_loss:0.017719514667987823
The generated pressure mean: 0.440706729888916
loss_pred:0.05824097618460655, decouple_loss:0.018430698662996292
Iteration: 3182, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4400041699409485
loss_pred:0.05929993465542793, decouple_loss:0.025493230670690536
The generated pressure mean: 0.43857714533805847
loss_pred:0.05721040815114975, decouple_loss:0.024860944598913193
The generated pressure mean: 0.44055286049842834
loss_pred:0.055745720863342285, decouple_loss:0.026240728795528412
Iteration: 3183, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4411729872226715
loss_pred:0.05639348924160004, decouple_loss:0.017004115507006645
The generated pressure mean: 0.4416203796863556
loss_pred:0.05592324584722519, decouple_loss:0.01674630306661129
The generated pressure mean: 0.4419008195400238
loss_pred:0.05608290806412697, decouple_loss:0.017613427713513374
Iteration: 3184, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44780874252319336
loss_pred:0.058604396879673004, decouple_loss:0.0157152246683836
The generated pressure mean: 0.4480283856391907
loss_pred:0.0563945397734642, decouple_loss:0.01636987179517746
The generated pressure mean: 0.44614550471305847
loss_pred:0.05722936987876892, decouple_loss:0.01634528487920761
Iteration: 3185, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4514641761779785
loss_pred:0.057091061025857925, decouple_loss:0.02149943821132183
The generated pressure mean: 0.4517894685268402
loss_pred:0.054870281368494034, decouple_loss:0.021906854584813118
The generated pressure mean: 0.45275259017944336
loss_pred:0.05668455734848976, decouple_loss:0.021222427487373352
Iteration: 3186, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45374825596809387
The generated pressure mean: 0.4532294273376465
loss_pred:0.05453813448548317, decouple_loss:0.019659647718071938
loss_pred:0.05598492920398712, decouple_loss:0.019612735137343407
The generated pressure mean: 0.4543691575527191
loss_pred:0.05545273795723915, decouple_loss:0.01951674185693264
Iteration: 3187, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4534451365470886
loss_pred:0.056983932852745056, decouple_loss:0.014749805442988873
The generated pressure mean: 0.45504388213157654
loss_pred:0.055783119052648544, decouple_loss:0.014306345954537392
The generated pressure mean: 0.4541117250919342
loss_pred:0.05567429959774017, decouple_loss:0.014623980037868023
Iteration: 3188, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472131133079529
The generated pressure mean: 0.4469221234321594
loss_pred:0.056586746126413345, decouple_loss:0.01889955624938011
loss_pred:0.05421367287635803, decouple_loss:0.019490959122776985
The generated pressure mean: 0.44664305448532104
loss_pred:0.055084940046072006, decouple_loss:0.018657365813851357
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3189, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43688979744911194
loss_pred:0.055783845484256744, decouple_loss:0.021143201738595963
The generated pressure mean: 0.4374980330467224
loss_pred:0.055065833032131195, decouple_loss:0.021158773452043533
The generated pressure mean: 0.4383026361465454
loss_pred:0.05688432604074478, decouple_loss:0.022528838366270065
Iteration: 3190, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43516796827316284
The generated pressure mean: 0.4362812042236328
loss_pred:0.055744484066963196, decouple_loss:0.01655651070177555
loss_pred:0.05568218231201172, decouple_loss:0.016278618946671486
The generated pressure mean: 0.43672412633895874
loss_pred:0.05648671090602875, decouple_loss:0.016909027472138405
2023-04-17 00:07:10 testing...
The generated pressure mean: 0.41181808710098267
The generated pressure mean: 0.4117995798587799
The generated pressure mean: 0.41153407096862793
loss_pred:0.061087772250175476, decouple_loss:0.018062468618154526
loss_pred:0.06130746006965637, decouple_loss:0.017872216179966927
loss_pred:0.060841143131256104, decouple_loss:0.018018100410699844
WV_0_PC_0_EH_1_PS_40, loss: 0.06197800487279892, avg_mse: 0.06237092614173889
current test mse: 0.062371
Iteration: 3191, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43928179144859314
The generated pressure mean: 0.4380946457386017
loss_pred:0.05565863475203514, decouple_loss:0.017652995884418488
loss_pred:0.054072510451078415, decouple_loss:0.018368728458881378
The generated pressure mean: 0.43862080574035645
loss_pred:0.05578038841485977, decouple_loss:0.017320800572633743
Iteration: 3192, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44399815797805786
loss_pred:0.05478425323963165, decouple_loss:0.02112255059182644
The generated pressure mean: 0.4434463083744049
loss_pred:0.05512818694114685, decouple_loss:0.02029065601527691
The generated pressure mean: 0.4443223178386688
loss_pred:0.05534612014889717, decouple_loss:0.01978168450295925
Iteration: 3193, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494321346282959
loss_pred:0.05438162013888359, decouple_loss:0.01825040392577648
The generated pressure mean: 0.4484456777572632
loss_pred:0.05378885567188263, decouple_loss:0.01817541942000389
The generated pressure mean: 0.4498012959957123
loss_pred:0.05430068075656891, decouple_loss:0.01943688839673996
Iteration: 3194, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4535330533981323
loss_pred:0.05687708035111427, decouple_loss:0.016643144190311432
The generated pressure mean: 0.45295584201812744
loss_pred:0.05436547100543976, decouple_loss:0.016580378636717796
The generated pressure mean: 0.4527117609977722
loss_pred:0.055108290165662766, decouple_loss:0.015791134908795357
Iteration: 3195, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505806863307953
The generated pressure mean: 0.4504399001598358
loss_pred:0.05420537292957306, decouple_loss:0.02766750380396843
loss_pred:0.0536804161965847, decouple_loss:0.025403793901205063
The generated pressure mean: 0.45132216811180115
loss_pred:0.05435444787144661, decouple_loss:0.025799520313739777
Iteration: 3196, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44995391368865967
loss_pred:0.05460374802350998, decouple_loss:0.016456643119454384
The generated pressure mean: 0.44867298007011414
loss_pred:0.05229518935084343, decouple_loss:0.01663310080766678
The generated pressure mean: 0.4499657154083252
loss_pred:0.0558069609105587, decouple_loss:0.01673891767859459
Iteration: 3197, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501364529132843
loss_pred:0.05644585192203522, decouple_loss:0.02723081409931183
The generated pressure mean: 0.449830025434494
loss_pred:0.05586600676178932, decouple_loss:0.02539265900850296
The generated pressure mean: 0.44811689853668213
loss_pred:0.05477435141801834, decouple_loss:0.025911999866366386
Iteration: 3198, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4457099735736847
The generated pressure mean: 0.4468145966529846
loss_pred:0.05340654030442238, decouple_loss:0.019555997103452682
loss_pred:0.0573652908205986, decouple_loss:0.020975565537810326
The generated pressure mean: 0.44618770480155945
loss_pred:0.05302373692393303, decouple_loss:0.01874789223074913
Iteration: 3199, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44159379601478577
loss_pred:0.05366988107562065, decouple_loss:0.023708926513791084
The generated pressure mean: 0.4429575204849243
loss_pred:0.05777367576956749, decouple_loss:0.024139976128935814
The generated pressure mean: 0.44202670454978943
loss_pred:0.05276305228471756, decouple_loss:0.023187950253486633
Iteration: 3200, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4398860037326813
loss_pred:0.052719712257385254, decouple_loss:0.021134573966264725
The generated pressure mean: 0.4393879771232605
loss_pred:0.05779007822275162, decouple_loss:0.020224595442414284
The generated pressure mean: 0.4390081763267517
loss_pred:0.05263729766011238, decouple_loss:0.019768331199884415
2023-04-17 00:09:03 testing...
The generated pressure mean: 0.411031574010849
The generated pressure mean: 0.4110289216041565
The generated pressure mean: 0.41076532006263733
loss_pred:0.06062169000506401, decouple_loss:0.02680029720067978
loss_pred:0.06057630851864815, decouple_loss:0.026942681521177292
loss_pred:0.06014043092727661, decouple_loss:0.027249639853835106
WV_0_PC_0_EH_1_PS_40, loss: 0.06179602071642876, avg_mse: 0.06186104565858841
current test mse: 0.061861
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 3201, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4428460896015167
loss_pred:0.05931989476084709, decouple_loss:0.026900427415966988
The generated pressure mean: 0.44406014680862427
The generated pressure mean: 0.44477230310440063
loss_pred:0.055666591972112656, decouple_loss:0.026458153501152992
loss_pred:0.058731984347105026, decouple_loss:0.02702021226286888
Iteration: 3202, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480074644088745
The generated pressure mean: 0.4482467770576477
loss_pred:0.0577680878341198, decouple_loss:0.022288374602794647
loss_pred:0.060358256101608276, decouple_loss:0.02374717779457569
The generated pressure mean: 0.44847342371940613
loss_pred:0.05195127800107002, decouple_loss:0.02205066569149494
Iteration: 3203, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4526910185813904
loss_pred:0.053007572889328, decouple_loss:0.022569021210074425
The generated pressure mean: 0.4508158266544342
loss_pred:0.05249892920255661, decouple_loss:0.02262849360704422
The generated pressure mean: 0.45382052659988403
loss_pred:0.056994423270225525, decouple_loss:0.023537874221801758
Iteration: 3204, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45575642585754395
loss_pred:0.06090028956532478, decouple_loss:0.021237073466181755
The generated pressure mean: 0.45600762963294983
loss_pred:0.05912730097770691, decouple_loss:0.02070503681898117
The generated pressure mean: 0.4556444585323334
loss_pred:0.05962933227419853, decouple_loss:0.021869193762540817
Iteration: 3205, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45519721508026123
The generated pressure mean: 0.4559445381164551
loss_pred:0.05693662166595459, decouple_loss:0.01908998005092144
loss_pred:0.058762867003679276, decouple_loss:0.020779209211468697
The generated pressure mean: 0.455314964056015
loss_pred:0.060848452150821686, decouple_loss:0.020560817793011665
Iteration: 3206, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45058876276016235
loss_pred:0.05498740077018738, decouple_loss:0.022362057119607925
The generated pressure mean: 0.450735867023468
loss_pred:0.05897212401032448, decouple_loss:0.024078719317913055
The generated pressure mean: 0.451518177986145
loss_pred:0.05775907635688782, decouple_loss:0.021299218758940697
Iteration: 3207, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4447310268878937
loss_pred:0.05858146771788597, decouple_loss:0.017648570239543915
The generated pressure mean: 0.44471606612205505
loss_pred:0.05714878439903259, decouple_loss:0.017851484939455986
The generated pressure mean: 0.4430689513683319
loss_pred:0.056263621896505356, decouple_loss:0.01809612102806568
Iteration: 3208, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4414604902267456
loss_pred:0.05774274095892906, decouple_loss:0.021416224539279938
The generated pressure mean: 0.4409421384334564
loss_pred:0.05738847330212593, decouple_loss:0.02071298286318779
The generated pressure mean: 0.4417245388031006
loss_pred:0.058201663196086884, decouple_loss:0.0218347180634737
Iteration: 3209, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4444672465324402
The generated pressure mean: 0.44471246004104614
loss_pred:0.051033731549978256, decouple_loss:0.01986025832593441
loss_pred:0.05674046650528908, decouple_loss:0.022949064150452614
The generated pressure mean: 0.4435429871082306
loss_pred:0.05641379579901695, decouple_loss:0.020154280588030815
Iteration: 3210, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495871961116791
loss_pred:0.05591738224029541, decouple_loss:0.01833544299006462
The generated pressure mean: 0.448395311832428
loss_pred:0.05309436842799187, decouple_loss:0.015794869512319565
The generated pressure mean: 0.45013564825057983
loss_pred:0.05589861050248146, decouple_loss:0.01717989146709442
2023-04-17 00:11:36 testing...
The generated pressure mean: 0.40867602825164795
The generated pressure mean: 0.40862637758255005
loss_pred:0.06036237254738808, decouple_loss:0.02104710415005684
The generated pressure mean: 0.4083288013935089
loss_pred:0.06023735553026199, decouple_loss:0.020793095231056213
loss_pred:0.05982460826635361, decouple_loss:0.020973065868020058
WV_0_PC_0_EH_1_PS_40, loss: 0.06118833273649216, avg_mse: 0.06168356537818909
current test mse: 0.061684
Iteration: 3211, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4527947008609772
The generated pressure mean: 0.45316553115844727
loss_pred:0.056225962936878204, decouple_loss:0.022181246429681778
loss_pred:0.057227566838264465, decouple_loss:0.020922530442476273
The generated pressure mean: 0.4542964696884155
loss_pred:0.05549601837992668, decouple_loss:0.020852169021964073
Iteration: 3212, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45210421085357666
The generated pressure mean: 0.4539214074611664
loss_pred:0.052942756563425064, decouple_loss:0.01657627522945404
loss_pred:0.05506566911935806, decouple_loss:0.01619953289628029
The generated pressure mean: 0.455001562833786
loss_pred:0.057212941348552704, decouple_loss:0.018520742654800415
Iteration: 3213, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500643014907837
The generated pressure mean: 0.4496306777000427
loss_pred:0.05586215481162071, decouple_loss:0.02281111478805542
loss_pred:0.05313940346240997, decouple_loss:0.02175193838775158
The generated pressure mean: 0.44981637597084045
loss_pred:0.053310882300138474, decouple_loss:0.021525539457798004
Iteration: 3214, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468485414981842
The generated pressure mean: 0.4444081783294678
loss_pred:0.05099163204431534, decouple_loss:0.01509137824177742
loss_pred:0.05176421254873276, decouple_loss:0.015076521784067154
The generated pressure mean: 0.44753530621528625
loss_pred:0.056072257459163666, decouple_loss:0.01639449968934059
Iteration: 3215, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44410157203674316
The generated pressure mean: 0.44248369336128235
loss_pred:0.05761455371975899, decouple_loss:0.02570282854139805
loss_pred:0.05128716677427292, decouple_loss:0.023769855499267578
The generated pressure mean: 0.445469468832016
loss_pred:0.0511169470846653, decouple_loss:0.025621991604566574
Iteration: 3216, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44453027844429016
The generated pressure mean: 0.44586217403411865
loss_pred:0.050622422248125076, decouple_loss:0.01584252528846264
loss_pred:0.05429502949118614, decouple_loss:0.01582767814397812
The generated pressure mean: 0.44714096188545227
loss_pred:0.05450686439871788, decouple_loss:0.016317343339323997
Iteration: 3217, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507966935634613
The generated pressure mean: 0.44997966289520264
loss_pred:0.05560280382633209, decouple_loss:0.020206836983561516
loss_pred:0.05338047072291374, decouple_loss:0.01936439611017704
The generated pressure mean: 0.4506955146789551
loss_pred:0.056774407625198364, decouple_loss:0.020874956622719765
Iteration: 3218, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4524303376674652
loss_pred:0.05549251660704613, decouple_loss:0.015121592208743095
The generated pressure mean: 0.45243754982948303
loss_pred:0.05467918887734413, decouple_loss:0.015096086077392101
The generated pressure mean: 0.45218637585639954
loss_pred:0.05234042555093765, decouple_loss:0.015414769761264324
Iteration: 3219, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45061683654785156
The generated pressure mean: 0.4511781930923462
loss_pred:0.05462376028299332, decouple_loss:0.02012438327074051
loss_pred:0.05466776341199875, decouple_loss:0.02185339853167534
The generated pressure mean: 0.45141270756721497
loss_pred:0.05742383375763893, decouple_loss:0.02093183621764183
Iteration: 3220, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44504737854003906
The generated pressure mean: 0.44614142179489136
loss_pred:0.05577526614069939, decouple_loss:0.015458233654499054
loss_pred:0.055318448692560196, decouple_loss:0.015819236636161804
The generated pressure mean: 0.44528910517692566
loss_pred:0.04997061938047409, decouple_loss:0.01552855409681797
2023-04-17 00:13:29 testing...
The generated pressure mean: 0.4116418957710266
The generated pressure mean: 0.4116879999637604
The generated pressure mean: 0.41139936447143555
loss_pred:0.059119828045368195, decouple_loss:0.02216940186917782
loss_pred:0.05935802683234215, decouple_loss:0.02172797918319702
loss_pred:0.05897199362516403, decouple_loss:0.022385604679584503
WV_0_PC_0_EH_1_PS_40, loss: 0.060254670679569244, avg_mse: 0.06092097982764244
current test mse: 0.060921
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 3221, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44051024317741394
loss_pred:0.05606122687458992, decouple_loss:0.02180984616279602
The generated pressure mean: 0.44134917855262756
loss_pred:0.05306236818432808, decouple_loss:0.020980369299650192
The generated pressure mean: 0.4409101903438568
loss_pred:0.05935346707701683, decouple_loss:0.021129313856363297
Iteration: 3222, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44461485743522644
The generated pressure mean: 0.4445441961288452
loss_pred:0.05606953799724579, decouple_loss:0.018780158832669258
loss_pred:0.0522477813065052, decouple_loss:0.018866287544369698
The generated pressure mean: 0.4452597200870514
loss_pred:0.05983778089284897, decouple_loss:0.018884193152189255
Iteration: 3223, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506544768810272
The generated pressure mean: 0.44909724593162537
loss_pred:0.05647452920675278, decouple_loss:0.01711120270192623
loss_pred:0.05590246617794037, decouple_loss:0.01756107620894909
The generated pressure mean: 0.45149877667427063
loss_pred:0.053685206919908524, decouple_loss:0.016970723867416382
Iteration: 3224, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45129573345184326
The generated pressure mean: 0.45139047503471375
loss_pred:0.0563163124024868, decouple_loss:0.015487147495150566
loss_pred:0.05859198048710823, decouple_loss:0.01592486910521984
The generated pressure mean: 0.44919800758361816
loss_pred:0.057455409318208694, decouple_loss:0.015594621188938618
Iteration: 3225, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44574108719825745
The generated pressure mean: 0.44727227091789246
loss_pred:0.05626041442155838, decouple_loss:0.016427576541900635
loss_pred:0.055384304374456406, decouple_loss:0.017014121636748314
The generated pressure mean: 0.4467215836048126
loss_pred:0.056142859160900116, decouple_loss:0.016663389280438423
Iteration: 3226, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44683003425598145
loss_pred:0.057707950472831726, decouple_loss:0.015012089163064957
The generated pressure mean: 0.4477524161338806
loss_pred:0.060844678431749344, decouple_loss:0.014929431490600109
The generated pressure mean: 0.4451279938220978
loss_pred:0.054720912128686905, decouple_loss:0.014111526310443878
Iteration: 3227, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476507604122162
The generated pressure mean: 0.44704434275627136
loss_pred:0.05914881452918053, decouple_loss:0.016233965754508972
loss_pred:0.05375866964459419, decouple_loss:0.016552850604057312
The generated pressure mean: 0.44782236218452454
loss_pred:0.0554310642182827, decouple_loss:0.016620313748717308
Iteration: 3228, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44978225231170654The generated pressure mean: 0.44987934827804565
loss_pred:0.05525610223412514, decouple_loss:0.01524867583066225
loss_pred:0.05290933698415756, decouple_loss:0.014996567741036415
The generated pressure mean: 0.4492262601852417
loss_pred:0.0569218285381794, decouple_loss:0.015077727846801281
Iteration: 3229, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449433296918869
The generated pressure mean: 0.44798851013183594
loss_pred:0.05862773582339287, decouple_loss:0.01765739545226097
loss_pred:0.05679185688495636, decouple_loss:0.016875168308615685
The generated pressure mean: 0.44860824942588806
loss_pred:0.05394458770751953, decouple_loss:0.017216460779309273
Iteration: 3230, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474329352378845
loss_pred:0.05512257665395737, decouple_loss:0.01596701517701149
The generated pressure mean: 0.4473213255405426
loss_pred:0.05184393376111984, decouple_loss:0.015584532171487808
The generated pressure mean: 0.44863635301589966
loss_pred:0.054983917623758316, decouple_loss:0.01609668880701065
2023-04-17 00:15:57 testing...
The generated pressure mean: 0.4108923673629761
The generated pressure mean: 0.4108709990978241
The generated pressure mean: 0.41055601835250854
loss_pred:0.059045564383268356, decouple_loss:0.017183085903525352
loss_pred:0.05846522003412247, decouple_loss:0.01728293113410473
loss_pred:0.05830810219049454, decouple_loss:0.017009444534778595
WV_0_PC_0_EH_1_PS_40, loss: 0.059464216232299805, avg_mse: 0.06059780344367027
current test mse: 0.060598
Iteration: 3231, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449397623538971
The generated pressure mean: 0.44466421008110046
loss_pred:0.053080059587955475, decouple_loss:0.01657024398446083
loss_pred:0.05555250495672226, decouple_loss:0.017152631655335426
The generated pressure mean: 0.4439804255962372
loss_pred:0.05357067286968231, decouple_loss:0.017296019941568375
Iteration: 3232, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4450377821922302
The generated pressure mean: 0.4454655349254608
loss_pred:0.05433260276913643, decouple_loss:0.015314639545977116
loss_pred:0.058260004967451096, decouple_loss:0.01581764966249466
The generated pressure mean: 0.44509461522102356
loss_pred:0.05916398763656616, decouple_loss:0.015921395272016525
Iteration: 3233, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500610828399658
loss_pred:0.0525355227291584, decouple_loss:0.01690320484340191
The generated pressure mean: 0.44871577620506287
loss_pred:0.052543774247169495, decouple_loss:0.01712258718907833
The generated pressure mean: 0.44860050082206726
loss_pred:0.057526543736457825, decouple_loss:0.017301758751273155
Iteration: 3234, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45239534974098206
The generated pressure mean: 0.44945624470710754
loss_pred:0.059035107493400574, decouple_loss:0.014654501341283321
loss_pred:0.05420651286840439, decouple_loss:0.014987368136644363
The generated pressure mean: 0.45137831568717957
loss_pred:0.05343105271458626, decouple_loss:0.015314489603042603
Iteration: 3235, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44688665866851807
The generated pressure mean: 0.44544926285743713
loss_pred:0.05194442346692085, decouple_loss:0.01603083312511444
loss_pred:0.05276506021618843, decouple_loss:0.0163186714053154
The generated pressure mean: 0.44322705268859863
loss_pred:0.053298190236091614, decouple_loss:0.016010098159313202
Iteration: 3236, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44480186700820923
The generated pressure mean: 0.44633743166923523
loss_pred:0.056404341012239456, decouple_loss:0.014913114719092846
loss_pred:0.05310850217938423, decouple_loss:0.014751951210200787
The generated pressure mean: 0.4457600712776184
loss_pred:0.055808160454034805, decouple_loss:0.015137327834963799
Iteration: 3237, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44750937819480896
The generated pressure mean: 0.4469323456287384
loss_pred:0.0536554791033268, decouple_loss:0.01353730633854866
loss_pred:0.05519380047917366, decouple_loss:0.013337506912648678
The generated pressure mean: 0.44811540842056274
loss_pred:0.05401686206459999, decouple_loss:0.013569217175245285
Iteration: 3238, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4456566870212555
loss_pred:0.054743941873311996, decouple_loss:0.015184427611529827
The generated pressure mean: 0.4442736506462097
loss_pred:0.05575750023126602, decouple_loss:0.015149811282753944
The generated pressure mean: 0.444831520318985
loss_pred:0.05358310788869858, decouple_loss:0.015022528357803822
Iteration: 3239, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45159777998924255
The generated pressure mean: 0.4536104202270508
loss_pred:0.054741084575653076, decouple_loss:0.012966444715857506
loss_pred:0.052075017243623734, decouple_loss:0.013215165585279465
The generated pressure mean: 0.4516085684299469
loss_pred:0.05735820531845093, decouple_loss:0.012668758630752563
Iteration: 3240, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44810226559638977
loss_pred:0.054001759737730026, decouple_loss:0.016039447858929634
The generated pressure mean: 0.4477315843105316
loss_pred:0.05437173321843147, decouple_loss:0.01810135692358017
The generated pressure mean: 0.4496997892856598
loss_pred:0.052224043756723404, decouple_loss:0.01674024388194084
2023-04-17 00:17:49 testing...
The generated pressure mean: 0.4110475480556488
The generated pressure mean: 0.4111920893192291
The generated pressure mean: 0.4108552932739258
loss_pred:0.05848988890647888, decouple_loss:0.013898113742470741
loss_pred:0.057723887264728546, decouple_loss:0.014347621239721775
loss_pred:0.057559575885534286, decouple_loss:0.014172736555337906
WV_0_PC_0_EH_1_PS_40, loss: 0.058631427586078644, avg_mse: 0.06046566739678383
current test mse: 0.060466
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 3241, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44135499000549316
loss_pred:0.05102319270372391, decouple_loss:0.012359553948044777
The generated pressure mean: 0.44249871373176575
loss_pred:0.055325333029031754, decouple_loss:0.01215144619345665
The generated pressure mean: 0.4424804747104645
loss_pred:0.05086800083518028, decouple_loss:0.013143855147063732
Iteration: 3242, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.445087194442749
The generated pressure mean: 0.4456043839454651
loss_pred:0.052030548453330994, decouple_loss:0.01683112606406212
loss_pred:0.05181489512324333, decouple_loss:0.017182962968945503
The generated pressure mean: 0.44591662287712097
loss_pred:0.049728941172361374, decouple_loss:0.017399977892637253
Iteration: 3243, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491685628890991
loss_pred:0.053551651537418365, decouple_loss:0.01209245529025793
The generated pressure mean: 0.44659435749053955
loss_pred:0.05118757113814354, decouple_loss:0.012091104872524738
The generated pressure mean: 0.4475533962249756
loss_pred:0.053296349942684174, decouple_loss:0.012304428964853287
Iteration: 3244, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4515478312969208
loss_pred:0.050513043999671936, decouple_loss:0.017139794304966927
The generated pressure mean: 0.450519323348999
loss_pred:0.053506817668676376, decouple_loss:0.01671546697616577
The generated pressure mean: 0.4505254924297333
loss_pred:0.05201133340597153, decouple_loss:0.01726994663476944
Iteration: 3245, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442063271999359
loss_pred:0.053595706820487976, decouple_loss:0.015239724889397621
The generated pressure mean: 0.4444584846496582
loss_pred:0.05109165236353874, decouple_loss:0.014699653722345829
The generated pressure mean: 0.44301238656044006
loss_pred:0.05106290802359581, decouple_loss:0.013872032053768635
Iteration: 3246, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44420263171195984
The generated pressure mean: 0.44569844007492065loss_pred:0.05151784047484398, decouple_loss:0.01995787024497986
loss_pred:0.051647964864969254, decouple_loss:0.020334908738732338
The generated pressure mean: 0.44602856040000916
loss_pred:0.04802120476961136, decouple_loss:0.01948847435414791
Iteration: 3247, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4443802237510681
loss_pred:0.05330758914351463, decouple_loss:0.01519407145678997
The generated pressure mean: 0.4431893825531006
loss_pred:0.05183307081460953, decouple_loss:0.015565541572868824
The generated pressure mean: 0.4450358748435974
loss_pred:0.05416835844516754, decouple_loss:0.0151474978774786
Iteration: 3248, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45857682824134827
loss_pred:0.05090788006782532, decouple_loss:0.01583479344844818
The generated pressure mean: 0.46072298288345337
loss_pred:0.05374494567513466, decouple_loss:0.018076427280902863
The generated pressure mean: 0.45933088660240173
loss_pred:0.04765040799975395, decouple_loss:0.01737402379512787
Iteration: 3249, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44612443447113037
The generated pressure mean: 0.4457811415195465
loss_pred:0.051798757165670395, decouple_loss:0.01644526608288288
loss_pred:0.048755042254924774, decouple_loss:0.016638653352856636
The generated pressure mean: 0.44727370142936707
loss_pred:0.05114030838012695, decouple_loss:0.016342520713806152
Iteration: 3250, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44779980182647705
loss_pred:0.055424656718969345, decouple_loss:0.017235612496733665
The generated pressure mean: 0.4468654990196228
loss_pred:0.04706987366080284, decouple_loss:0.017440607771277428
The generated pressure mean: 0.44707173109054565
loss_pred:0.051442552357912064, decouple_loss:0.017475184053182602
2023-04-17 00:20:21 testing...
The generated pressure mean: 0.4115195870399475
The generated pressure mean: 0.4116188883781433
loss_pred:0.057203259319067, decouple_loss:0.014389176853001118
The generated pressure mean: 0.4114024043083191
loss_pred:0.05636513978242874, decouple_loss:0.01430196687579155
loss_pred:0.056231435388326645, decouple_loss:0.01429093349725008
WV_0_PC_0_EH_1_PS_40, loss: 0.057316314429044724, avg_mse: 0.05957562476396561
current test mse: 0.059576
Iteration: 3251, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4417833983898163
loss_pred:0.04990550875663757, decouple_loss:0.0141321225091815
The generated pressure mean: 0.4405314326286316
loss_pred:0.04841990768909454, decouple_loss:0.01537450309842825
The generated pressure mean: 0.44181492924690247
loss_pred:0.048266660422086716, decouple_loss:0.01473307330161333
Iteration: 3252, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4422479271888733
The generated pressure mean: 0.44057753682136536loss_pred:0.05085039511322975, decouple_loss:0.01743190549314022
loss_pred:0.047482844442129135, decouple_loss:0.017458299174904823
The generated pressure mean: 0.44173476099967957
loss_pred:0.05053338035941124, decouple_loss:0.01763191446661949
Iteration: 3253, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4530129134654999
loss_pred:0.04910537227988243, decouple_loss:0.017209209501743317
The generated pressure mean: 0.4542270004749298
loss_pred:0.05036931857466698, decouple_loss:0.015286225825548172
The generated pressure mean: 0.4544082581996918
loss_pred:0.04744068905711174, decouple_loss:0.015957772731781006
Iteration: 3254, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4455157518386841
loss_pred:0.048848237842321396, decouple_loss:0.01639648899435997
The generated pressure mean: 0.447750449180603
loss_pred:0.05244592949748039, decouple_loss:0.016022730618715286
The generated pressure mean: 0.44660118222236633
loss_pred:0.05216791853308678, decouple_loss:0.01605452597141266
Iteration: 3255, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45448777079582214
loss_pred:0.046910449862480164, decouple_loss:0.015219146385788918
The generated pressure mean: 0.4551929831504822
loss_pred:0.049604594707489014, decouple_loss:0.015501166693866253
The generated pressure mean: 0.4567357003688812
loss_pred:0.053000662475824356, decouple_loss:0.014965634793043137
Iteration: 3256, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43552732467651367
loss_pred:0.050703875720500946, decouple_loss:0.014221497811377048
The generated pressure mean: 0.43701472878456116
loss_pred:0.04937887564301491, decouple_loss:0.013714239932596684
The generated pressure mean: 0.43835878372192383
loss_pred:0.050389260053634644, decouple_loss:0.014469857327640057
Iteration: 3257, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4348818063735962
loss_pred:0.04960400611162186, decouple_loss:0.018709242343902588
The generated pressure mean: 0.4340307414531708
loss_pred:0.051670342683792114, decouple_loss:0.01849093846976757
The generated pressure mean: 0.4334600865840912
loss_pred:0.04947291314601898, decouple_loss:0.019427642226219177
Iteration: 3258, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45996183156967163
loss_pred:0.050497639924287796, decouple_loss:0.020567797124385834
The generated pressure mean: 0.4604608118534088
loss_pred:0.05322962626814842, decouple_loss:0.018744654953479767
The generated pressure mean: 0.46009698510169983
loss_pred:0.05208259075880051, decouple_loss:0.01863388530910015
Iteration: 3259, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4456422030925751
loss_pred:0.052731629461050034, decouple_loss:0.021531084552407265
The generated pressure mean: 0.4465865194797516
loss_pred:0.05429643765091896, decouple_loss:0.020229415968060493
The generated pressure mean: 0.4458296000957489
loss_pred:0.051336970180273056, decouple_loss:0.02079320140182972
Iteration: 3260, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45616933703422546
The generated pressure mean: 0.45714518427848816
loss_pred:0.05078209191560745, decouple_loss:0.0198831707239151
loss_pred:0.04882175475358963, decouple_loss:0.018839696422219276
The generated pressure mean: 0.45769554376602173
loss_pred:0.04862512648105621, decouple_loss:0.018520351499319077
2023-04-17 00:22:14 testing...
The generated pressure mean: 0.40539491176605225
The generated pressure mean: 0.40557870268821716
The generated pressure mean: 0.4053698778152466
loss_pred:0.05896433815360069, decouple_loss:0.020571155473589897
loss_pred:0.05767751485109329, decouple_loss:0.02096470631659031
loss_pred:0.057677000761032104, decouple_loss:0.02102763019502163
WV_0_PC_0_EH_1_PS_40, loss: 0.05914900824427605, avg_mse: 0.06187086179852486
current test mse: 0.061871
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 3261, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46269434690475464
loss_pred:0.05453300103545189, decouple_loss:0.01978435553610325
The generated pressure mean: 0.4621843993663788
The generated pressure mean: 0.4617339074611664
loss_pred:0.053405288606882095, decouple_loss:0.01925409771502018
loss_pred:0.054518986493349075, decouple_loss:0.01948370598256588
Iteration: 3262, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43896782398223877
The generated pressure mean: 0.44015318155288696
loss_pred:0.0510706827044487, decouple_loss:0.019743165001273155
loss_pred:0.049480196088552475, decouple_loss:0.019002152606844902
The generated pressure mean: 0.4390854239463806
loss_pred:0.05212045833468437, decouple_loss:0.019507916644215584
Iteration: 3263, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42093488574028015
loss_pred:0.05336187034845352, decouple_loss:0.018475240096449852
The generated pressure mean: 0.4214933216571808
loss_pred:0.050399407744407654, decouple_loss:0.01938282884657383
The generated pressure mean: 0.4207780957221985
loss_pred:0.0530959889292717, decouple_loss:0.01803618296980858
Iteration: 3264, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4294030964374542
The generated pressure mean: 0.43028777837753296
loss_pred:0.04902280867099762, decouple_loss:0.02082671783864498
loss_pred:0.05025402829051018, decouple_loss:0.02088097855448723
The generated pressure mean: 0.4290870428085327
loss_pred:0.04909443110227585, decouple_loss:0.021496200934052467
Iteration: 3265, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44760048389434814
loss_pred:0.05206219106912613, decouple_loss:0.018965015187859535
The generated pressure mean: 0.44700244069099426
loss_pred:0.05012545734643936, decouple_loss:0.018300063908100128
The generated pressure mean: 0.4461943507194519
loss_pred:0.052203062921762466, decouple_loss:0.019040431827306747
Iteration: 3266, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4602227807044983
The generated pressure mean: 0.4599452614784241loss_pred:0.05120594799518585, decouple_loss:0.01982145756483078
loss_pred:0.04846680909395218, decouple_loss:0.020002642646431923
The generated pressure mean: 0.45956429839134216
loss_pred:0.05277305096387863, decouple_loss:0.019395234063267708
Iteration: 3267, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4641560912132263
loss_pred:0.048549018800258636, decouple_loss:0.016156507655978203
The generated pressure mean: 0.4655752182006836
loss_pred:0.04925965517759323, decouple_loss:0.01578247919678688
The generated pressure mean: 0.4645889401435852
loss_pred:0.04803495854139328, decouple_loss:0.015967708081007004
Iteration: 3268, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4545319676399231
The generated pressure mean: 0.45822128653526306
loss_pred:0.049213893711566925, decouple_loss:0.021039322018623352
loss_pred:0.048204205930233, decouple_loss:0.021800238639116287
The generated pressure mean: 0.45521309971809387
loss_pred:0.05183911696076393, decouple_loss:0.021595072001218796
Iteration: 3269, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44330641627311707
The generated pressure mean: 0.4440779387950897
loss_pred:0.048825453966856, decouple_loss:0.015688195824623108
loss_pred:0.050131477415561676, decouple_loss:0.01604946330189705
The generated pressure mean: 0.4426797926425934
loss_pred:0.05027474835515022, decouple_loss:0.01610744185745716
Iteration: 3270, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4337446093559265
loss_pred:0.05025084689259529, decouple_loss:0.018583491444587708
The generated pressure mean: 0.4332861006259918
loss_pred:0.04719364270567894, decouple_loss:0.01845889911055565
The generated pressure mean: 0.432908296585083
loss_pred:0.04953145608305931, decouple_loss:0.019140318036079407
2023-04-17 00:24:44 testing...
The generated pressure mean: 0.4128657281398773
The generated pressure mean: 0.413009375333786
The generated pressure mean: 0.4126684069633484
loss_pred:0.05522454157471657, decouple_loss:0.013967529870569706
loss_pred:0.054631855338811874, decouple_loss:0.014236574992537498
loss_pred:0.053849224001169205, decouple_loss:0.014295320026576519
WV_0_PC_0_EH_1_PS_40, loss: 0.055276867002248764, avg_mse: 0.0580972395837307
current test mse: 0.058097
Iteration: 3271, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43496331572532654
loss_pred:0.04865336790680885, decouple_loss:0.014251016080379486
The generated pressure mean: 0.4348178207874298
loss_pred:0.04966675862669945, decouple_loss:0.014245829544961452
The generated pressure mean: 0.43414556980133057
loss_pred:0.04969099536538124, decouple_loss:0.01556557510048151
Iteration: 3272, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44351518154144287
loss_pred:0.045560285449028015, decouple_loss:0.019073067232966423
The generated pressure mean: 0.4440970718860626
loss_pred:0.04550262540578842, decouple_loss:0.019088517874479294
The generated pressure mean: 0.4434034526348114
loss_pred:0.04807855933904648, decouple_loss:0.019555579870939255
Iteration: 3273, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44952285289764404
loss_pred:0.047315675765275955, decouple_loss:0.014372773468494415
The generated pressure mean: 0.4484884440898895
loss_pred:0.047628458589315414, decouple_loss:0.01485899742692709
The generated pressure mean: 0.4488217532634735
loss_pred:0.047679927200078964, decouple_loss:0.014397160150110722
Iteration: 3274, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499448537826538
The generated pressure mean: 0.45009392499923706
loss_pred:0.049074798822402954, decouple_loss:0.018240822479128838
loss_pred:0.04826706275343895, decouple_loss:0.019051266834139824
The generated pressure mean: 0.4506694972515106
loss_pred:0.04564645141363144, decouple_loss:0.018070586025714874
Iteration: 3275, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508976340293884
The generated pressure mean: 0.4490153193473816
loss_pred:0.045717403292655945, decouple_loss:0.014891979284584522
loss_pred:0.0458485409617424, decouple_loss:0.014365123584866524
The generated pressure mean: 0.45079436898231506
loss_pred:0.048616599291563034, decouple_loss:0.01478584110736847
Iteration: 3276, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469951093196869
The generated pressure mean: 0.4468478560447693
loss_pred:0.048423778265714645, decouple_loss:0.01771537959575653
loss_pred:0.04628980532288551, decouple_loss:0.01824151538312435
The generated pressure mean: 0.4470368027687073
loss_pred:0.046526581048965454, decouple_loss:0.017825838178396225
Iteration: 3277, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4408055245876312
The generated pressure mean: 0.4400942623615265
loss_pred:0.04804887995123863, decouple_loss:0.013820148073136806
loss_pred:0.04433143511414528, decouple_loss:0.01357227936387062
The generated pressure mean: 0.44144922494888306
loss_pred:0.0492216981947422, decouple_loss:0.013604642823338509
Iteration: 3278, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45009055733680725
loss_pred:0.04484357312321663, decouple_loss:0.01887623965740204
The generated pressure mean: 0.4501599073410034
loss_pred:0.046672843396663666, decouple_loss:0.01914655789732933
The generated pressure mean: 0.4491562247276306
loss_pred:0.04681498184800148, decouple_loss:0.01960929110646248
Iteration: 3279, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4549098014831543
loss_pred:0.046142011880874634, decouple_loss:0.01533709280192852
The generated pressure mean: 0.4553053677082062
loss_pred:0.04582926630973816, decouple_loss:0.0153310876339674
The generated pressure mean: 0.4557840824127197
loss_pred:0.04734446108341217, decouple_loss:0.015253198333084583
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3280, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44100528955459595
loss_pred:0.04504721611738205, decouple_loss:0.018951883539557457
The generated pressure mean: 0.4430708885192871
loss_pred:0.04559783264994621, decouple_loss:0.019999606534838676
The generated pressure mean: 0.44316181540489197
loss_pred:0.04802398756146431, decouple_loss:0.019549138844013214
2023-04-17 00:26:38 testing...
The generated pressure mean: 0.41079962253570557
The generated pressure mean: 0.4109247624874115
The generated pressure mean: 0.4107874631881714
loss_pred:0.0539742186665535, decouple_loss:0.01930970512330532
loss_pred:0.052622873336076736, decouple_loss:0.019680390134453773
loss_pred:0.0533449649810791, decouple_loss:0.01975763402879238
WV_0_PC_0_EH_1_PS_40, loss: 0.05429314821958542, avg_mse: 0.05739093944430351
current test mse: 0.057391
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 3281, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442080557346344
loss_pred:0.04643101990222931, decouple_loss:0.01658383198082447
The generated pressure mean: 0.44383034110069275
loss_pred:0.04946938529610634, decouple_loss:0.017794014886021614
The generated pressure mean: 0.44122931361198425
loss_pred:0.04760236665606499, decouple_loss:0.017263799905776978
Iteration: 3282, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475630819797516
The generated pressure mean: 0.4463600516319275
loss_pred:0.04753795266151428, decouple_loss:0.01737138442695141
loss_pred:0.04597841203212738, decouple_loss:0.017135731875896454
The generated pressure mean: 0.4477604627609253
loss_pred:0.04860658198595047, decouple_loss:0.016790682449936867
Iteration: 3283, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43502622842788696
The generated pressure mean: 0.43334633111953735
loss_pred:0.04731227457523346, decouple_loss:0.017191516235470772
loss_pred:0.047356072813272476, decouple_loss:0.01728907786309719
The generated pressure mean: 0.4325164258480072
loss_pred:0.047379255294799805, decouple_loss:0.01748502627015114
Iteration: 3284, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4593215882778168
The generated pressure mean: 0.45955657958984375
loss_pred:0.045497845858335495, decouple_loss:0.014434605836868286
loss_pred:0.04576719552278519, decouple_loss:0.014642621390521526
The generated pressure mean: 0.4588102698326111
loss_pred:0.04809620976448059, decouple_loss:0.015263088047504425
Iteration: 3285, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4440217614173889
The generated pressure mean: 0.4433653652667999
loss_pred:0.04674946144223213, decouple_loss:0.015863241627812386
loss_pred:0.04561996832489967, decouple_loss:0.01514038722962141
The generated pressure mean: 0.4447154998779297
loss_pred:0.046253155916929245, decouple_loss:0.01563914492726326
Iteration: 3286, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500097930431366
The generated pressure mean: 0.4496103525161743
loss_pred:0.04588192328810692, decouple_loss:0.014627108350396156
loss_pred:0.04588298872113228, decouple_loss:0.014504135586321354
The generated pressure mean: 0.4498205780982971
loss_pred:0.044180043041706085, decouple_loss:0.014581489376723766
Iteration: 3287, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43724381923675537
loss_pred:0.046589288860559464, decouple_loss:0.014181877486407757
The generated pressure mean: 0.4374679923057556
loss_pred:0.0456928052008152, decouple_loss:0.01425097044557333
The generated pressure mean: 0.43763044476509094
loss_pred:0.044874731451272964, decouple_loss:0.014123959466814995
Iteration: 3288, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4410145878791809
loss_pred:0.04592735692858696, decouple_loss:0.013155845925211906
The generated pressure mean: 0.44331392645835876
loss_pred:0.04515276104211807, decouple_loss:0.013231092132627964
The generated pressure mean: 0.4424852430820465
loss_pred:0.04418029263615608, decouple_loss:0.012967408634722233
Iteration: 3289, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4536071717739105
loss_pred:0.045045360922813416, decouple_loss:0.012923987582325935
The generated pressure mean: 0.45335546135902405
loss_pred:0.043247923254966736, decouple_loss:0.012220135889947414
The generated pressure mean: 0.45261189341545105
loss_pred:0.04388655722141266, decouple_loss:0.012236620299518108
Iteration: 3290, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4422115981578827
loss_pred:0.0479322113096714, decouple_loss:0.015135440044105053
The generated pressure mean: 0.44234779477119446
loss_pred:0.04592661187052727, decouple_loss:0.015288162045180798
The generated pressure mean: 0.4420180916786194
loss_pred:0.0448288731276989, decouple_loss:0.015391024760901928
2023-04-17 00:29:10 testing...
The generated pressure mean: 0.40229684114456177
The generated pressure mean: 0.40254315733909607
The generated pressure mean: 0.4023739695549011
loss_pred:0.05760660767555237, decouple_loss:0.014107942581176758
loss_pred:0.05661730840802193, decouple_loss:0.014467966742813587
loss_pred:0.056743789464235306, decouple_loss:0.014606107957661152
WV_0_PC_0_EH_1_PS_40, loss: 0.05770894140005112, avg_mse: 0.06362573802471161
current test mse: 0.063626
Iteration: 3291, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47739461064338684
The generated pressure mean: 0.4779333472251892
loss_pred:0.04784901812672615, decouple_loss:0.012307951226830482
loss_pred:0.04816615954041481, decouple_loss:0.012140139006078243
The generated pressure mean: 0.4770372211933136
loss_pred:0.04773850739002228, decouple_loss:0.01237653847783804
Iteration: 3292, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42614665627479553
loss_pred:0.051857661455869675, decouple_loss:0.015315732918679714
The generated pressure mean: 0.4246531128883362
loss_pred:0.05004845932126045, decouple_loss:0.01447935402393341
The generated pressure mean: 0.42477649450302124
loss_pred:0.05058276653289795, decouple_loss:0.014634285122156143
Iteration: 3293, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4635704457759857
The generated pressure mean: 0.4636584520339966
loss_pred:0.04524937644600868, decouple_loss:0.016880882903933525
loss_pred:0.047124262899160385, decouple_loss:0.016359586268663406
The generated pressure mean: 0.4642828702926636
loss_pred:0.047461263835430145, decouple_loss:0.016447007656097412
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3294, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46617501974105835
The generated pressure mean: 0.4656500518321991loss_pred:0.04671663045883179, decouple_loss:0.014010312035679817
loss_pred:0.047762785106897354, decouple_loss:0.014226133935153484
The generated pressure mean: 0.46456143260002136
loss_pred:0.047811802476644516, decouple_loss:0.014270267449319363
Iteration: 3295, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4396914541721344
The generated pressure mean: 0.4386538863182068
loss_pred:0.04482365399599075, decouple_loss:0.018515825271606445
loss_pred:0.044626615941524506, decouple_loss:0.018602168187499046
The generated pressure mean: 0.4396574795246124
loss_pred:0.0455586276948452, decouple_loss:0.01881590113043785
Iteration: 3296, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4302239418029785
loss_pred:0.04525362700223923, decouple_loss:0.014363577589392662
The generated pressure mean: 0.43187326192855835
loss_pred:0.044735219329595566, decouple_loss:0.014378962107002735
The generated pressure mean: 0.4310459792613983
loss_pred:0.044940583407878876, decouple_loss:0.014335086569190025
Iteration: 3297, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4391329288482666
The generated pressure mean: 0.44097083806991577
loss_pred:0.04623010754585266, decouple_loss:0.01758989877998829
loss_pred:0.04574665054678917, decouple_loss:0.01695074327290058
The generated pressure mean: 0.4386803209781647
loss_pred:0.04369065910577774, decouple_loss:0.017004622146487236
Iteration: 3298, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478956162929535
The generated pressure mean: 0.4463060796260834
loss_pred:0.04620954021811485, decouple_loss:0.01568804495036602
loss_pred:0.045118268579244614, decouple_loss:0.015607371926307678
The generated pressure mean: 0.4464626610279083
loss_pred:0.04603966325521469, decouple_loss:0.01569654978811741
Iteration: 3299, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44596174359321594
loss_pred:0.04537041857838631, decouple_loss:0.01620723493397236
The generated pressure mean: 0.4435504674911499
loss_pred:0.04602089896798134, decouple_loss:0.01605009287595749
The generated pressure mean: 0.44341957569122314
loss_pred:0.04519316181540489, decouple_loss:0.01602587290108204
Iteration: 3300, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462815225124359
loss_pred:0.043814994394779205, decouple_loss:0.017374146729707718
The generated pressure mean: 0.4464528560638428
loss_pred:0.04536411911249161, decouple_loss:0.016982853412628174
The generated pressure mean: 0.4438196122646332
loss_pred:0.045895546674728394, decouple_loss:0.017267504706978798
2023-04-17 00:31:03 testing...
The generated pressure mean: 0.4102047383785248
The generated pressure mean: 0.4099544584751129
loss_pred:0.05314401909708977, decouple_loss:0.018806785345077515
The generated pressure mean: 0.41016295552253723
loss_pred:0.053585149347782135, decouple_loss:0.018266230821609497
loss_pred:0.052854716777801514, decouple_loss:0.01872836798429489
WV_0_PC_0_EH_1_PS_40, loss: 0.054124653339385986, avg_mse: 0.05800393968820572
current test mse: 0.058004
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 3301, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4451577961444855
loss_pred:0.04467890411615372, decouple_loss:0.0168402511626482
The generated pressure mean: 0.44856637716293335
The generated pressure mean: 0.447238564491272
loss_pred:0.0446450300514698, decouple_loss:0.01648934930562973
loss_pred:0.043037738651037216, decouple_loss:0.016727996990084648
Iteration: 3302, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44873476028442383
The generated pressure mean: 0.4457469880580902
loss_pred:0.04321399703621864, decouple_loss:0.01694549433887005
loss_pred:0.043855663388967514, decouple_loss:0.017277292907238007
The generated pressure mean: 0.4481251835823059
loss_pred:0.045015789568424225, decouple_loss:0.01805751398205757
Iteration: 3303, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473402202129364
The generated pressure mean: 0.44851943850517273
loss_pred:0.04297548159956932, decouple_loss:0.01783810928463936
loss_pred:0.041984573006629944, decouple_loss:0.01752571202814579
The generated pressure mean: 0.4478677213191986
loss_pred:0.044388189911842346, decouple_loss:0.01762167178094387
Iteration: 3304, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45016947388648987
The generated pressure mean: 0.4497065544128418loss_pred:0.04114922881126404, decouple_loss:0.015498955734074116
loss_pred:0.04438567906618118, decouple_loss:0.015473248437047005
The generated pressure mean: 0.4507128596305847
loss_pred:0.04467962682247162, decouple_loss:0.015589137561619282
Iteration: 3305, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448464035987854
The generated pressure mean: 0.44765704870224
loss_pred:0.04310337081551552, decouple_loss:0.017039207741618156
loss_pred:0.043981507420539856, decouple_loss:0.01721433736383915
The generated pressure mean: 0.44972148537635803
loss_pred:0.04259953275322914, decouple_loss:0.01689600944519043
Iteration: 3306, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43566516041755676
The generated pressure mean: 0.43514284491539
loss_pred:0.04229985922574997, decouple_loss:0.014978565275669098
loss_pred:0.04374377802014351, decouple_loss:0.01432516798377037
The generated pressure mean: 0.4341021180152893
loss_pred:0.044514816254377365, decouple_loss:0.014883325435221195
Iteration: 3307, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4308552145957947
The generated pressure mean: 0.4289884865283966
loss_pred:0.04227113351225853, decouple_loss:0.014402421191334724
loss_pred:0.04443319886922836, decouple_loss:0.013988954946398735
The generated pressure mean: 0.4317529797554016
loss_pred:0.04383545368909836, decouple_loss:0.014217875897884369
Iteration: 3308, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491766393184662
loss_pred:0.04111756011843681, decouple_loss:0.013745483942329884
The generated pressure mean: 0.4475339949131012
loss_pred:0.04349179565906525, decouple_loss:0.013773264363408089
The generated pressure mean: 0.44894611835479736
loss_pred:0.04065230116248131, decouple_loss:0.014586887322366238
Iteration: 3309, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4537750482559204
loss_pred:0.04186861217021942, decouple_loss:0.012479852885007858
The generated pressure mean: 0.45373713970184326
loss_pred:0.04183664172887802, decouple_loss:0.011972878128290176
The generated pressure mean: 0.45492202043533325
loss_pred:0.040504492819309235, decouple_loss:0.012093793600797653
Iteration: 3310, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4554670453071594
loss_pred:0.04291607812047005, decouple_loss:0.01279939990490675
The generated pressure mean: 0.4554564654827118
loss_pred:0.04182971641421318, decouple_loss:0.013994112610816956
The generated pressure mean: 0.4553372263908386
loss_pred:0.042495664209127426, decouple_loss:0.012810209766030312
2023-04-17 00:33:37 testing...
The generated pressure mean: 0.4081619381904602
The generated pressure mean: 0.40826869010925293
The generated pressure mean: 0.40845516324043274
loss_pred:0.05310047045350075, decouple_loss:0.01138918288052082
loss_pred:0.05261535942554474, decouple_loss:0.011576387099921703
loss_pred:0.052143413573503494, decouple_loss:0.011514275334775448
WV_0_PC_0_EH_1_PS_40, loss: 0.05319441482424736, avg_mse: 0.05796727538108826
current test mse: 0.057967
Iteration: 3311, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4557313024997711
loss_pred:0.042098261415958405, decouple_loss:0.011380772106349468
The generated pressure mean: 0.4548819065093994
loss_pred:0.04432325437664986, decouple_loss:0.011048785410821438
The generated pressure mean: 0.45632973313331604
loss_pred:0.04306602105498314, decouple_loss:0.010854235850274563
Iteration: 3312, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45486629009246826
loss_pred:0.04015984758734703, decouple_loss:0.011592213064432144
The generated pressure mean: 0.4551870822906494
loss_pred:0.040988944470882416, decouple_loss:0.011911929585039616
The generated pressure mean: 0.4539315104484558
loss_pred:0.04215087369084358, decouple_loss:0.011473764665424824
Iteration: 3313, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4302908480167389
loss_pred:0.043072961270809174, decouple_loss:0.013296023942530155
The generated pressure mean: 0.4292265474796295
loss_pred:0.042750898748636246, decouple_loss:0.012658548541367054
The generated pressure mean: 0.4302944540977478
loss_pred:0.04266301542520523, decouple_loss:0.012567234225571156
Iteration: 3314, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44806036353111267
loss_pred:0.04249631240963936, decouple_loss:0.012232812121510506
The generated pressure mean: 0.4489334225654602
loss_pred:0.04283891245722771, decouple_loss:0.012267586775124073
The generated pressure mean: 0.44867950677871704
loss_pred:0.04212195426225662, decouple_loss:0.012057570740580559
Iteration: 3315, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44911694526672363
loss_pred:0.0433465950191021, decouple_loss:0.011487796902656555
The generated pressure mean: 0.44838324189186096
loss_pred:0.04328069090843201, decouple_loss:0.011543135158717632
The generated pressure mean: 0.4484814703464508
loss_pred:0.04283780977129936, decouple_loss:0.011893079616129398
Iteration: 3316, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44736963510513306
loss_pred:0.04265847057104111, decouple_loss:0.010835903696715832
The generated pressure mean: 0.4485747516155243
The generated pressure mean: 0.44791659712791443
loss_pred:0.04139583185315132, decouple_loss:0.010998787358403206
loss_pred:0.041455432772636414, decouple_loss:0.010720324702560902
Iteration: 3317, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45391806960105896
loss_pred:0.0420696996152401, decouple_loss:0.009642262943089008
The generated pressure mean: 0.4558331072330475
loss_pred:0.04266156628727913, decouple_loss:0.010252591222524643
The generated pressure mean: 0.45431655645370483
loss_pred:0.039644308388233185, decouple_loss:0.009772292338311672
Iteration: 3318, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4567417800426483
loss_pred:0.04322374612092972, decouple_loss:0.011101906187832355
The generated pressure mean: 0.4565766751766205
The generated pressure mean: 0.45853400230407715
loss_pred:0.043007127940654755, decouple_loss:0.010831121355295181
loss_pred:0.044674888253211975, decouple_loss:0.010872049257159233
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3319, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4301045835018158
loss_pred:0.039984460920095444, decouple_loss:0.009644552133977413
The generated pressure mean: 0.43146204948425293
loss_pred:0.041036996990442276, decouple_loss:0.01020012516528368
The generated pressure mean: 0.4311775863170624
loss_pred:0.04046914353966713, decouple_loss:0.009612206369638443
Iteration: 3320, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4399012625217438
loss_pred:0.04100927710533142, decouple_loss:0.010440179146826267
The generated pressure mean: 0.43542030453681946
The generated pressure mean: 0.43714046478271484
loss_pred:0.04188200831413269, decouple_loss:0.010864991694688797
loss_pred:0.04068722203373909, decouple_loss:0.010400515049695969
2023-04-17 00:35:30 testing...
The generated pressure mean: 0.40752989053726196
The generated pressure mean: 0.40760037302970886
The generated pressure mean: 0.4079468846321106
loss_pred:0.05346839502453804, decouple_loss:0.011795560829341412
loss_pred:0.052893903106451035, decouple_loss:0.012180211022496223
loss_pred:0.052704066038131714, decouple_loss:0.012207470834255219
WV_0_PC_0_EH_1_PS_40, loss: 0.05362517759203911, avg_mse: 0.059410903602838516
current test mse: 0.059411
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 3321, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.459614634513855
loss_pred:0.04400976747274399, decouple_loss:0.012029130943119526
The generated pressure mean: 0.45878177881240845
loss_pred:0.04292828589677811, decouple_loss:0.011236629448831081
The generated pressure mean: 0.46054694056510925
loss_pred:0.043187081813812256, decouple_loss:0.012256942689418793
Iteration: 3322, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45320382714271545
loss_pred:0.04191229119896889, decouple_loss:0.009530787356197834
The generated pressure mean: 0.4524048864841461
loss_pred:0.03990095853805542, decouple_loss:0.009888308122754097
The generated pressure mean: 0.4534469544887543
loss_pred:0.042468562722206116, decouple_loss:0.009111353196203709
Iteration: 3323, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4364449679851532
loss_pred:0.04429061710834503, decouple_loss:0.010896803811192513
The generated pressure mean: 0.4383963942527771
loss_pred:0.04462823644280434, decouple_loss:0.010813905857503414
The generated pressure mean: 0.4367314577102661
loss_pred:0.04320097342133522, decouple_loss:0.0112818144261837
Iteration: 3324, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4418191909790039
loss_pred:0.03983648493885994, decouple_loss:0.01129316445440054
The generated pressure mean: 0.4407319724559784
loss_pred:0.03969377279281616, decouple_loss:0.010546119883656502
The generated pressure mean: 0.4426640272140503
loss_pred:0.04206196218729019, decouple_loss:0.012087170034646988
Iteration: 3325, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4438093304634094
loss_pred:0.041812051087617874, decouple_loss:0.010061703622341156
The generated pressure mean: 0.44491127133369446
loss_pred:0.04103913530707359, decouple_loss:0.010033397004008293
The generated pressure mean: 0.4446084797382355
loss_pred:0.04131213203072548, decouple_loss:0.009813663549721241
Iteration: 3326, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4548226296901703
The generated pressure mean: 0.45390254259109497
loss_pred:0.04224908724427223, decouple_loss:0.010592455044388771
loss_pred:0.042552221566438675, decouple_loss:0.011585618369281292
The generated pressure mean: 0.45351195335388184
loss_pred:0.03942365199327469, decouple_loss:0.010623826645314693
Iteration: 3327, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4563489556312561
loss_pred:0.04046718403697014, decouple_loss:0.009328210726380348
The generated pressure mean: 0.45385274291038513
loss_pred:0.04128992184996605, decouple_loss:0.008853326551616192
The generated pressure mean: 0.4549955725669861
loss_pred:0.03942129388451576, decouple_loss:0.008896473795175552
Iteration: 3328, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4339211583137512
loss_pred:0.04157710447907448, decouple_loss:0.011183000169694424
The generated pressure mean: 0.43549713492393494
loss_pred:0.043020185083150864, decouple_loss:0.011730708181858063
The generated pressure mean: 0.4346866011619568
loss_pred:0.041237134486436844, decouple_loss:0.01176648959517479
Iteration: 3329, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4613339900970459
loss_pred:0.04337099939584732, decouple_loss:0.011583695188164711
The generated pressure mean: 0.46013909578323364
The generated pressure mean: 0.46129414439201355
loss_pred:0.04273601248860359, decouple_loss:0.011848345398902893
loss_pred:0.04224571958184242, decouple_loss:0.011532866396009922
Iteration: 3330, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4392128586769104
loss_pred:0.04164804145693779, decouple_loss:0.009789731353521347
The generated pressure mean: 0.43572303652763367
loss_pred:0.03903719037771225, decouple_loss:0.009753101505339146
The generated pressure mean: 0.4415420889854431
loss_pred:0.04123903065919876, decouple_loss:0.009213009849190712
2023-04-17 00:37:59 testing...
The generated pressure mean: 0.4088420569896698
The generated pressure mean: 0.4089127480983734
loss_pred:0.05255800485610962, decouple_loss:0.010137359611690044
The generated pressure mean: 0.40937286615371704
loss_pred:0.052234530448913574, decouple_loss:0.010270263999700546
loss_pred:0.05161566659808159, decouple_loss:0.01042522769421339
WV_0_PC_0_EH_1_PS_40, loss: 0.05264994502067566, avg_mse: 0.05860554054379463
current test mse: 0.058606
Iteration: 3331, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45399877429008484
loss_pred:0.04175714775919914, decouple_loss:0.009325218386948109
The generated pressure mean: 0.4541696310043335
loss_pred:0.04147810861468315, decouple_loss:0.009881919249892235
The generated pressure mean: 0.45233240723609924
loss_pred:0.03853658214211464, decouple_loss:0.009705664590001106
Iteration: 3332, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4522210955619812
loss_pred:0.040237896144390106, decouple_loss:0.008855507709085941
The generated pressure mean: 0.4543686807155609
loss_pred:0.0410054475069046, decouple_loss:0.009005691856145859
The generated pressure mean: 0.45395025610923767
loss_pred:0.041033923625946045, decouple_loss:0.009176339954137802
Iteration: 3333, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43472903966903687
loss_pred:0.0417037270963192, decouple_loss:0.010261018760502338
The generated pressure mean: 0.4360051453113556
loss_pred:0.04163698852062225, decouple_loss:0.01017822977155447
The generated pressure mean: 0.4378829002380371
loss_pred:0.04043961688876152, decouple_loss:0.01032878365367651
Iteration: 3334, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45121005177497864
loss_pred:0.03884247690439224, decouple_loss:0.012073294259607792
The generated pressure mean: 0.4507445693016052
loss_pred:0.03856784477829933, decouple_loss:0.012161847203969955
The generated pressure mean: 0.4514211118221283
loss_pred:0.04154982417821884, decouple_loss:0.012216828763484955
Iteration: 3335, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44546815752983093
The generated pressure mean: 0.44551607966423035
loss_pred:0.04076356813311577, decouple_loss:0.009938268922269344
loss_pred:0.04095757007598877, decouple_loss:0.009111737832427025
The generated pressure mean: 0.4436873495578766
loss_pred:0.03864772990345955, decouple_loss:0.008826082572340965
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3336, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44586217403411865
loss_pred:0.04102769121527672, decouple_loss:0.008645307272672653
The generated pressure mean: 0.44613924622535706
loss_pred:0.04006749019026756, decouple_loss:0.009211558848619461
The generated pressure mean: 0.44452208280563354
loss_pred:0.040133584290742874, decouple_loss:0.009308677166700363
Iteration: 3337, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46455925703048706
loss_pred:0.04062066972255707, decouple_loss:0.010841365903615952
The generated pressure mean: 0.4643276035785675
loss_pred:0.03937167674303055, decouple_loss:0.010651415213942528
The generated pressure mean: 0.465678870677948
loss_pred:0.04189089685678482, decouple_loss:0.010930562391877174
Iteration: 3338, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4334833025932312
loss_pred:0.03874528780579567, decouple_loss:0.009710492566227913
The generated pressure mean: 0.43467816710472107
loss_pred:0.038120221346616745, decouple_loss:0.009633355773985386
The generated pressure mean: 0.4359716475009918
loss_pred:0.040555670857429504, decouple_loss:0.009813359938561916
Iteration: 3339, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4429115951061249
loss_pred:0.03919468820095062, decouple_loss:0.010674148797988892
The generated pressure mean: 0.443792462348938
loss_pred:0.040439605712890625, decouple_loss:0.010894042439758778
The generated pressure mean: 0.4411766231060028
loss_pred:0.03729984536767006, decouple_loss:0.010081359185278416
Iteration: 3340, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4606931507587433
loss_pred:0.041300829499959946, decouple_loss:0.009826219640672207
The generated pressure mean: 0.459959477186203
loss_pred:0.03899018466472626, decouple_loss:0.009748805314302444
The generated pressure mean: 0.461765319108963
loss_pred:0.04029032588005066, decouple_loss:0.009813066571950912
2023-04-17 00:39:53 testing...
The generated pressure mean: 0.4093458652496338
The generated pressure mean: 0.4094124436378479
loss_pred:0.05223577842116356, decouple_loss:0.01053395215421915
The generated pressure mean: 0.41006386280059814
loss_pred:0.051892008632421494, decouple_loss:0.01082987617701292
loss_pred:0.05130820348858833, decouple_loss:0.010899857617914677
WV_0_PC_0_EH_1_PS_40, loss: 0.05234972760081291, avg_mse: 0.05876711755990982
current test mse: 0.058767
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 3341, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45234864950180054
loss_pred:0.04590355232357979, decouple_loss:0.0106050381436944
The generated pressure mean: 0.45165005326271057
loss_pred:0.04557785391807556, decouple_loss:0.009610800072550774
The generated pressure mean: 0.45515963435173035
loss_pred:0.04488036781549454, decouple_loss:0.009291681461036205
Iteration: 3342, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44465935230255127
loss_pred:0.043472226709127426, decouple_loss:0.014615451917052269
The generated pressure mean: 0.44682347774505615
loss_pred:0.0429857112467289, decouple_loss:0.013963023200631142
The generated pressure mean: 0.44507184624671936
loss_pred:0.04029453918337822, decouple_loss:0.014383295550942421
Iteration: 3343, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.41898494958877563
The generated pressure mean: 0.41709545254707336
loss_pred:0.04152686148881912, decouple_loss:0.009249660186469555
loss_pred:0.041967250406742096, decouple_loss:0.009404169395565987
The generated pressure mean: 0.4209339916706085
loss_pred:0.043732900172472, decouple_loss:0.00983013678342104
Iteration: 3344, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.475821852684021
loss_pred:0.04467092081904411, decouple_loss:0.010775276459753513
The generated pressure mean: 0.47428226470947266
loss_pred:0.04090562090277672, decouple_loss:0.011595659889280796
The generated pressure mean: 0.4744887948036194
loss_pred:0.041475433856248856, decouple_loss:0.01128527894616127
Iteration: 3345, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500301480293274
loss_pred:0.042893484234809875, decouple_loss:0.010360297746956348
The generated pressure mean: 0.4465954005718231
loss_pred:0.03959975391626358, decouple_loss:0.009940552525222301
The generated pressure mean: 0.4469720125198364
loss_pred:0.043909672647714615, decouple_loss:0.010504321195185184
Iteration: 3346, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44700586795806885
loss_pred:0.04226744547486305, decouple_loss:0.012244579382240772
The generated pressure mean: 0.4453291893005371
loss_pred:0.0397922545671463, decouple_loss:0.01246264111250639
The generated pressure mean: 0.448801189661026
loss_pred:0.04300235956907272, decouple_loss:0.011467398144304752
Iteration: 3347, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4396476149559021
loss_pred:0.041761163622140884, decouple_loss:0.01087947841733694
The generated pressure mean: 0.4392804503440857
loss_pred:0.041475724428892136, decouple_loss:0.010269858874380589
The generated pressure mean: 0.43764469027519226
loss_pred:0.03925975412130356, decouple_loss:0.010580821894109249
Iteration: 3348, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4378608763217926
loss_pred:0.041032325476408005, decouple_loss:0.011833367869257927
The generated pressure mean: 0.4368074834346771
loss_pred:0.04300915449857712, decouple_loss:0.012745857238769531
The generated pressure mean: 0.43689000606536865
loss_pred:0.041351091116666794, decouple_loss:0.0122007355093956
Iteration: 3349, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.467113733291626
The generated pressure mean: 0.4660644233226776
loss_pred:0.04138137772679329, decouple_loss:0.011133573949337006
loss_pred:0.0409068688750267, decouple_loss:0.010743015445768833
The generated pressure mean: 0.46636295318603516
loss_pred:0.04094313085079193, decouple_loss:0.012079057283699512
Iteration: 3350, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496360123157501
The generated pressure mean: 0.4467390775680542
loss_pred:0.04087723046541214, decouple_loss:0.01371715497225523
loss_pred:0.03937578946352005, decouple_loss:0.013784575276076794
The generated pressure mean: 0.44852739572525024
loss_pred:0.04008500277996063, decouple_loss:0.013486488722264767
2023-04-17 00:42:25 testing...
The generated pressure mean: 0.4175204038619995
The generated pressure mean: 0.41783323884010315
The generated pressure mean: 0.4186420440673828
loss_pred:0.05223311856389046, decouple_loss:0.014736725017428398
loss_pred:0.05172380805015564, decouple_loss:0.01443914882838726
loss_pred:0.05163520947098732, decouple_loss:0.014394620433449745
WV_0_PC_0_EH_1_PS_40, loss: 0.05259022116661072, avg_mse: 0.05949586257338524
current test mse: 0.059496
Iteration: 3351, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4219471216201782
loss_pred:0.04402169957756996, decouple_loss:0.015529626980423927
The generated pressure mean: 0.4234888255596161
loss_pred:0.043944742530584335, decouple_loss:0.015640338882803917
The generated pressure mean: 0.42568352818489075
loss_pred:0.04222188889980316, decouple_loss:0.01577245444059372
Iteration: 3352, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4717903733253479
loss_pred:0.044775430113077164, decouple_loss:0.011372734792530537
The generated pressure mean: 0.47235628962516785
loss_pred:0.04154407978057861, decouple_loss:0.011813978664577007
The generated pressure mean: 0.475023478269577
loss_pred:0.042372092604637146, decouple_loss:0.011297234334051609
Iteration: 3353, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44479283690452576
loss_pred:0.03995456174015999, decouple_loss:0.019322341307997704
The generated pressure mean: 0.4427998661994934
loss_pred:0.03864346444606781, decouple_loss:0.019515763968229294
The generated pressure mean: 0.4437119662761688
loss_pred:0.03947756811976433, decouple_loss:0.019721684977412224
Iteration: 3354, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4445687234401703
loss_pred:0.04288661107420921, decouple_loss:0.014794611372053623
The generated pressure mean: 0.4413299262523651
loss_pred:0.03973134979605675, decouple_loss:0.014534425921738148
The generated pressure mean: 0.44803541898727417
loss_pred:0.04263973608613014, decouple_loss:0.01495347823947668
Iteration: 3355, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47391313314437866
loss_pred:0.04412347823381424, decouple_loss:0.018293043598532677
The generated pressure mean: 0.47363948822021484
loss_pred:0.044929999858140945, decouple_loss:0.018590012565255165
The generated pressure mean: 0.4741954803466797
loss_pred:0.04341977462172508, decouple_loss:0.018215171992778778
Iteration: 3356, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45276227593421936
loss_pred:0.03875449299812317, decouple_loss:0.012682071886956692
The generated pressure mean: 0.45379918813705444
loss_pred:0.04063268378376961, decouple_loss:0.01322846207767725
The generated pressure mean: 0.45329657196998596
loss_pred:0.039878930896520615, decouple_loss:0.013551240786910057
Iteration: 3357, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4145433008670807
loss_pred:0.04382939264178276, decouple_loss:0.01762995310127735
The generated pressure mean: 0.4142238199710846
loss_pred:0.04125106334686279, decouple_loss:0.01775110699236393
The generated pressure mean: 0.416281521320343
loss_pred:0.04182380065321922, decouple_loss:0.01766444928944111
Iteration: 3358, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490324854850769
loss_pred:0.0426088348031044, decouple_loss:0.013568557798862457
The generated pressure mean: 0.4482731819152832
loss_pred:0.042243823409080505, decouple_loss:0.0132566774263978
The generated pressure mean: 0.449933797121048
loss_pred:0.04145606979727745, decouple_loss:0.012583632953464985
Iteration: 3359, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47349604964256287
loss_pred:0.040279194712638855, decouple_loss:0.01510668732225895
The generated pressure mean: 0.47342145442962646
loss_pred:0.04019247740507126, decouple_loss:0.015115808695554733
The generated pressure mean: 0.4739900827407837
loss_pred:0.04102061316370964, decouple_loss:0.014794504269957542
Iteration: 3360, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4353087246417999
loss_pred:0.041532598435878754, decouple_loss:0.012089645490050316
The generated pressure mean: 0.44137316942214966
loss_pred:0.04198799282312393, decouple_loss:0.011550807394087315
The generated pressure mean: 0.43588000535964966
loss_pred:0.04271739721298218, decouple_loss:0.011633857153356075
2023-04-17 00:44:18 testing...
The generated pressure mean: 0.41806674003601074
The generated pressure mean: 0.4186110198497772
The generated pressure mean: 0.4197766184806824
loss_pred:0.05106072127819061, decouple_loss:0.014390372671186924
loss_pred:0.05040407180786133, decouple_loss:0.014076258055865765
loss_pred:0.05023106187582016, decouple_loss:0.014259020797908306
WV_0_PC_0_EH_1_PS_40, loss: 0.05127738043665886, avg_mse: 0.05802006646990776
current test mse: 0.05802
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 3361, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4184308648109436
loss_pred:0.03821486607193947, decouple_loss:0.015275945886969566
The generated pressure mean: 0.4172630310058594
The generated pressure mean: 0.4190000593662262
loss_pred:0.03884853422641754, decouple_loss:0.01630179025232792
loss_pred:0.03805612400174141, decouple_loss:0.015023761428892612
Iteration: 3362, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4514266550540924
The generated pressure mean: 0.44983819127082825
loss_pred:0.03990175947546959, decouple_loss:0.014297238551080227
loss_pred:0.04004276171326637, decouple_loss:0.014203822240233421
The generated pressure mean: 0.45093390345573425
loss_pred:0.0379183329641819, decouple_loss:0.016051411628723145
Iteration: 3363, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47747981548309326
loss_pred:0.03991367295384407, decouple_loss:0.012703388929367065
The generated pressure mean: 0.4732104539871216
loss_pred:0.03928511217236519, decouple_loss:0.012006016448140144
The generated pressure mean: 0.4784168303012848
loss_pred:0.03882642462849617, decouple_loss:0.011485862545669079
Iteration: 3364, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44790709018707275
The generated pressure mean: 0.44681787490844727
loss_pred:0.04038773477077484, decouple_loss:0.01604565419256687
loss_pred:0.04022882133722305, decouple_loss:0.016274092718958855
The generated pressure mean: 0.4497806131839752
loss_pred:0.03989095613360405, decouple_loss:0.015487153083086014
Iteration: 3365, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4401615560054779
The generated pressure mean: 0.4405011534690857
loss_pred:0.04093456268310547, decouple_loss:0.016245778650045395
loss_pred:0.039375219494104385, decouple_loss:0.01623956486582756
The generated pressure mean: 0.4389447569847107
loss_pred:0.03818914294242859, decouple_loss:0.01593329943716526
Iteration: 3366, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.453206866979599
The generated pressure mean: 0.4521656036376953
loss_pred:0.04029683396220207, decouple_loss:0.012382272630929947
loss_pred:0.03817794471979141, decouple_loss:0.013121738098561764
The generated pressure mean: 0.45420295000076294
loss_pred:0.03853125497698784, decouple_loss:0.012312863022089005
Iteration: 3367, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502851068973541
The generated pressure mean: 0.4522162973880768
loss_pred:0.037964511662721634, decouple_loss:0.013560370542109013
loss_pred:0.039496827870607376, decouple_loss:0.014341352507472038
The generated pressure mean: 0.4527881443500519
loss_pred:0.03782206401228905, decouple_loss:0.013476685620844364
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3368, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43133342266082764
loss_pred:0.03763291984796524, decouple_loss:0.013662264682352543
The generated pressure mean: 0.4318179786205292
loss_pred:0.03950256481766701, decouple_loss:0.013260804116725922
The generated pressure mean: 0.4325138330459595
loss_pred:0.03854944556951523, decouple_loss:0.013069081120193005
Iteration: 3369, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44501885771751404
loss_pred:0.04028434678912163, decouple_loss:0.012871215119957924
The generated pressure mean: 0.4435434937477112
loss_pred:0.03838805481791496, decouple_loss:0.01425232831388712
The generated pressure mean: 0.44845131039619446
loss_pred:0.04015402868390083, decouple_loss:0.013610245659947395
Iteration: 3370, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4534509479999542
loss_pred:0.03848995268344879, decouple_loss:0.013143520802259445
The generated pressure mean: 0.45368459820747375
loss_pred:0.039494045078754425, decouple_loss:0.01263449527323246
The generated pressure mean: 0.45172733068466187
loss_pred:0.03728966414928436, decouple_loss:0.012712210416793823
2023-04-17 00:46:48 testing...
The generated pressure mean: 0.4111107289791107
The generated pressure mean: 0.4113398492336273
The generated pressure mean: 0.4126526117324829
loss_pred:0.05116911232471466, decouple_loss:0.017026526853442192
loss_pred:0.05092858150601387, decouple_loss:0.01749524287879467
loss_pred:0.05048183351755142, decouple_loss:0.017796877771615982
WV_0_PC_0_EH_1_PS_40, loss: 0.05173182114958763, avg_mse: 0.05881175398826599
current test mse: 0.058812
Iteration: 3371, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468483626842499
loss_pred:0.03751114383339882, decouple_loss:0.014708864502608776
The generated pressure mean: 0.443972110748291
loss_pred:0.03906366974115372, decouple_loss:0.015203231945633888
The generated pressure mean: 0.4451981782913208
loss_pred:0.03942837938666344, decouple_loss:0.014878797344863415
Iteration: 3372, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468108117580414
loss_pred:0.0382368229329586, decouple_loss:0.014085447415709496
The generated pressure mean: 0.44914746284484863
loss_pred:0.036911193281412125, decouple_loss:0.014190541580319405
The generated pressure mean: 0.4481502175331116
loss_pred:0.03991403803229332, decouple_loss:0.014549470506608486
Iteration: 3373, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4521315395832062
loss_pred:0.03895308077335358, decouple_loss:0.012674866244196892
The generated pressure mean: 0.4493236243724823
loss_pred:0.03761368244886398, decouple_loss:0.013121741823852062
The generated pressure mean: 0.45243147015571594
loss_pred:0.03972474858164787, decouple_loss:0.013457137160003185
Iteration: 3374, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45364534854888916
loss_pred:0.03938222676515579, decouple_loss:0.012866935692727566
The generated pressure mean: 0.4508275091648102
loss_pred:0.037031389772892, decouple_loss:0.012533620931208134
The generated pressure mean: 0.45115065574645996
loss_pred:0.03862423822283745, decouple_loss:0.012852199375629425
Iteration: 3375, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43706661462783813
loss_pred:0.038362275809049606, decouple_loss:0.012162591330707073
The generated pressure mean: 0.43443724513053894
loss_pred:0.03822023794054985, decouple_loss:0.012315773405134678
The generated pressure mean: 0.4320959746837616
loss_pred:0.03988369181752205, decouple_loss:0.012281625531613827
Iteration: 3376, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44041019678115845
loss_pred:0.03842609003186226, decouple_loss:0.011681649833917618
The generated pressure mean: 0.43973833322525024
loss_pred:0.039184458553791046, decouple_loss:0.011259971186518669
The generated pressure mean: 0.44231927394866943
loss_pred:0.03735548257827759, decouple_loss:0.011119019240140915
Iteration: 3377, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45575273036956787
loss_pred:0.038042809814214706, decouple_loss:0.012669793330132961
The generated pressure mean: 0.45898526906967163
loss_pred:0.03679448366165161, decouple_loss:0.012456151656806469
The generated pressure mean: 0.4582764208316803
loss_pred:0.037769168615341187, decouple_loss:0.012574493885040283
Iteration: 3378, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45162826776504517The generated pressure mean: 0.4490659236907959
loss_pred:0.036336809396743774, decouple_loss:0.009954683482646942
loss_pred:0.03783443197607994, decouple_loss:0.009746982716023922
The generated pressure mean: 0.44994211196899414
loss_pred:0.03894729167222977, decouple_loss:0.009875476360321045
Iteration: 3379, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4338485300540924The generated pressure mean: 0.4360291063785553
loss_pred:0.037345003336668015, decouple_loss:0.013105208054184914
loss_pred:0.0375291183590889, decouple_loss:0.013155297376215458
The generated pressure mean: 0.43644243478775024
loss_pred:0.036746226251125336, decouple_loss:0.012984893284738064
Iteration: 3380, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4400969445705414
The generated pressure mean: 0.4396633505821228
loss_pred:0.03659487143158913, decouple_loss:0.01280977576971054
loss_pred:0.03786560893058777, decouple_loss:0.012679177336394787
The generated pressure mean: 0.43862664699554443
loss_pred:0.037054646760225296, decouple_loss:0.01300144661217928
2023-04-17 00:48:42 testing...
The generated pressure mean: 0.4095178544521332
The generated pressure mean: 0.40907809138298035
loss_pred:0.050129059702157974, decouple_loss:0.01497009675949812
The generated pressure mean: 0.41110479831695557
loss_pred:0.05071406066417694, decouple_loss:0.01467458438128233
loss_pred:0.0499565452337265, decouple_loss:0.015247272327542305
WV_0_PC_0_EH_1_PS_40, loss: 0.05101475119590759, avg_mse: 0.058484744280576706
current test mse: 0.058485
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 3381, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4535043239593506
loss_pred:0.037828076630830765, decouple_loss:0.013081050477921963
The generated pressure mean: 0.45356565713882446
loss_pred:0.037241604179143906, decouple_loss:0.012975857593119144
The generated pressure mean: 0.45594966411590576
loss_pred:0.036861829459667206, decouple_loss:0.013296492397785187
Iteration: 3382, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4625679850578308
The generated pressure mean: 0.46475014090538025
loss_pred:0.03751726821064949, decouple_loss:0.01169326901435852
loss_pred:0.0377291776239872, decouple_loss:0.012107590213418007
The generated pressure mean: 0.46291035413742065
loss_pred:0.03698009252548218, decouple_loss:0.011655276641249657
Iteration: 3383, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.438375324010849
The generated pressure mean: 0.43524929881095886
loss_pred:0.036511801183223724, decouple_loss:0.014253129251301289
loss_pred:0.03765912353992462, decouple_loss:0.014707833528518677
The generated pressure mean: 0.43538376688957214
loss_pred:0.036790881305933, decouple_loss:0.014441748149693012
Iteration: 3384, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44422969222068787
The generated pressure mean: 0.44378647208213806
loss_pred:0.03734587877988815, decouple_loss:0.01195188332349062
loss_pred:0.03770894184708595, decouple_loss:0.01112105417996645
The generated pressure mean: 0.4415029287338257
loss_pred:0.03983777016401291, decouple_loss:0.0110133346170187
Iteration: 3385, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45480722188949585
loss_pred:0.03794729337096214, decouple_loss:0.015804892405867577
The generated pressure mean: 0.4567424952983856
loss_pred:0.03645601496100426, decouple_loss:0.01666501723229885
The generated pressure mean: 0.4535658657550812
loss_pred:0.038342736661434174, decouple_loss:0.016176089644432068
Iteration: 3386, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45003941655158997
loss_pred:0.03659394383430481, decouple_loss:0.014246639795601368
The generated pressure mean: 0.4515467584133148
loss_pred:0.037312593311071396, decouple_loss:0.014332839287817478
The generated pressure mean: 0.4481954872608185
loss_pred:0.0363704189658165, decouple_loss:0.01358878705650568
Iteration: 3387, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4327593743801117
The generated pressure mean: 0.43168288469314575
loss_pred:0.037345003336668015, decouple_loss:0.015578370541334152
loss_pred:0.038497667759656906, decouple_loss:0.01541445404291153
The generated pressure mean: 0.4308096170425415
loss_pred:0.036391954869031906, decouple_loss:0.015673961490392685
Iteration: 3388, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45440810918807983
loss_pred:0.03845907747745514, decouple_loss:0.01310395635664463
The generated pressure mean: 0.4578210413455963
loss_pred:0.03584568575024605, decouple_loss:0.01450609602034092
The generated pressure mean: 0.45509687066078186
loss_pred:0.03855413943529129, decouple_loss:0.015000454150140285
Iteration: 3389, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4623197913169861
loss_pred:0.037782423198223114, decouple_loss:0.01754952222108841
The generated pressure mean: 0.4586080014705658
loss_pred:0.03692343831062317, decouple_loss:0.017624948173761368
The generated pressure mean: 0.45911645889282227
loss_pred:0.037124473601579666, decouple_loss:0.017853137105703354
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3390, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4410618841648102
loss_pred:0.03929942101240158, decouple_loss:0.012787600047886372
The generated pressure mean: 0.44019660353660583
loss_pred:0.03637343645095825, decouple_loss:0.01258061546832323
The generated pressure mean: 0.438050240278244
loss_pred:0.03668413311243057, decouple_loss:0.012831334955990314
2023-04-17 00:51:14 testing...
The generated pressure mean: 0.4161394238471985
The generated pressure mean: 0.41715508699417114
The generated pressure mean: 0.4184875786304474
loss_pred:0.049499329179525375, decouple_loss:0.017464973032474518
loss_pred:0.04956696927547455, decouple_loss:0.017812713980674744
loss_pred:0.0491013377904892, decouple_loss:0.01810108684003353
WV_0_PC_0_EH_1_PS_40, loss: 0.05027886480093002, avg_mse: 0.058052364736795425
current test mse: 0.058052
Iteration: 3391, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43306323885917664
The generated pressure mean: 0.4314989447593689
loss_pred:0.03749300166964531, decouple_loss:0.015964150428771973
loss_pred:0.037367139011621475, decouple_loss:0.0160230565816164
The generated pressure mean: 0.43462082743644714
loss_pred:0.03718878701329231, decouple_loss:0.01617322489619255
Iteration: 3392, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4654090106487274
loss_pred:0.0365777425467968, decouple_loss:0.010773712769150734
The generated pressure mean: 0.46619683504104614
loss_pred:0.03829245641827583, decouple_loss:0.011553263291716576
The generated pressure mean: 0.4695008397102356
loss_pred:0.03571651875972748, decouple_loss:0.010990063659846783
Iteration: 3393, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44935113191604614
The generated pressure mean: 0.4456549882888794
loss_pred:0.03408326953649521, decouple_loss:0.018538717180490494
loss_pred:0.03586602956056595, decouple_loss:0.018964340910315514
The generated pressure mean: 0.44857844710350037
loss_pred:0.03485368937253952, decouple_loss:0.01874920167028904
Iteration: 3394, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43114033341407776
The generated pressure mean: 0.43569445610046387
loss_pred:0.035812683403491974, decouple_loss:0.014918573200702667
loss_pred:0.03662564605474472, decouple_loss:0.015172644518315792
The generated pressure mean: 0.4336501955986023
loss_pred:0.03625280410051346, decouple_loss:0.014769629575312138
Iteration: 3395, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4593944549560547
The generated pressure mean: 0.4612776041030884
loss_pred:0.036110736429691315, decouple_loss:0.01717972941696644
loss_pred:0.03691000118851662, decouple_loss:0.017554787918925285
The generated pressure mean: 0.4632302522659302
loss_pred:0.035550378262996674, decouple_loss:0.017192967236042023
Iteration: 3396, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44101619720458984
The generated pressure mean: 0.4433947205543518
loss_pred:0.035813745111227036, decouple_loss:0.01708599552512169
loss_pred:0.03606820106506348, decouple_loss:0.016345372423529625
The generated pressure mean: 0.4432595670223236
loss_pred:0.038025714457035065, decouple_loss:0.01675601117312908
Iteration: 3397, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4391086995601654
loss_pred:0.0384533517062664, decouple_loss:0.014144254848361015
The generated pressure mean: 0.4434472918510437
loss_pred:0.036397360265254974, decouple_loss:0.013954759575426579
The generated pressure mean: 0.43791699409484863
loss_pred:0.03533362224698067, decouple_loss:0.014346543699502945
Iteration: 3398, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4593033492565155
The generated pressure mean: 0.4595785140991211
loss_pred:0.0374661423265934, decouple_loss:0.015764005482196808
loss_pred:0.03654388710856438, decouple_loss:0.016121719032526016
The generated pressure mean: 0.4597669839859009
loss_pred:0.03621738404035568, decouple_loss:0.015425017103552818
Iteration: 3399, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43847912549972534
loss_pred:0.03691278025507927, decouple_loss:0.014325574971735477
The generated pressure mean: 0.4395173192024231
loss_pred:0.0378391332924366, decouple_loss:0.01411008182913065
The generated pressure mean: 0.4364655315876007
loss_pred:0.0368436798453331, decouple_loss:0.013904676772654057
Iteration: 3400, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44766131043434143The generated pressure mean: 0.45088014006614685
loss_pred:0.03812016546726227, decouple_loss:0.012495862320065498loss_pred:0.03545808047056198, decouple_loss:0.011381315998733044
The generated pressure mean: 0.44854286313056946
loss_pred:0.03800057992339134, decouple_loss:0.012130518443882465
2023-04-17 00:53:07 testing...
The generated pressure mean: 0.4076906740665436
The generated pressure mean: 0.40852445363998413
The generated pressure mean: 0.41036850214004517
loss_pred:0.0496038943529129, decouple_loss:0.01688096858561039
loss_pred:0.0491044819355011, decouple_loss:0.017313996329903603
loss_pred:0.04862036928534508, decouple_loss:0.01728680543601513
WV_0_PC_0_EH_1_PS_40, loss: 0.04996761307120323, avg_mse: 0.05777886137366295
current test mse: 0.057779
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 3401, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46419018507003784
loss_pred:0.03625037893652916, decouple_loss:0.01633155345916748
The generated pressure mean: 0.46465426683425903
loss_pred:0.038526974618434906, decouple_loss:0.01652149111032486
The generated pressure mean: 0.4617602527141571
loss_pred:0.03748880699276924, decouple_loss:0.01601988635957241
Iteration: 3402, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.417658269405365
The generated pressure mean: 0.41791102290153503
loss_pred:0.03646853193640709, decouple_loss:0.011305910535156727
loss_pred:0.037462715059518814, decouple_loss:0.011090019717812538
The generated pressure mean: 0.4193778932094574
loss_pred:0.037158988416194916, decouple_loss:0.011514078825712204
Iteration: 3403, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4636865556240082
The generated pressure mean: 0.4590919315814972
loss_pred:0.038344938308000565, decouple_loss:0.01924419030547142
loss_pred:0.03693779557943344, decouple_loss:0.01927798241376877
The generated pressure mean: 0.46499162912368774
loss_pred:0.036699723452329636, decouple_loss:0.019190168008208275
Iteration: 3404, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45164862275123596
The generated pressure mean: 0.4525562524795532
loss_pred:0.036319658160209656, decouple_loss:0.014038042165338993
loss_pred:0.036966901272535324, decouple_loss:0.01406931597739458
The generated pressure mean: 0.45290517807006836
loss_pred:0.036741189658641815, decouple_loss:0.01403294038027525
Iteration: 3405, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4301554560661316
loss_pred:0.03892047330737114, decouple_loss:0.017596619203686714
The generated pressure mean: 0.43186819553375244
loss_pred:0.03757406026124954, decouple_loss:0.01746027171611786
The generated pressure mean: 0.4313923120498657
loss_pred:0.03664853051304817, decouple_loss:0.0176042802631855
Iteration: 3406, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452434778213501
The generated pressure mean: 0.44461724162101746
loss_pred:0.037263236939907074, decouple_loss:0.015735415741801262
loss_pred:0.037689290940761566, decouple_loss:0.0155448904260993
The generated pressure mean: 0.44626951217651367
loss_pred:0.037130486220121384, decouple_loss:0.015889419242739677
Iteration: 3407, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46402955055236816
The generated pressure mean: 0.46348339319229126
loss_pred:0.037979017943143845, decouple_loss:0.014293491840362549
loss_pred:0.0373539924621582, decouple_loss:0.01444648765027523
The generated pressure mean: 0.4627262353897095
loss_pred:0.03646552935242653, decouple_loss:0.014139443635940552
Iteration: 3408, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44296592473983765
loss_pred:0.03861787170171738, decouple_loss:0.015170109458267689
The generated pressure mean: 0.4401572048664093
loss_pred:0.037396419793367386, decouple_loss:0.014969032257795334
The generated pressure mean: 0.44347068667411804
loss_pred:0.03708069398999214, decouple_loss:0.014863850548863411
Iteration: 3409, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4355778992176056
loss_pred:0.03626967966556549, decouple_loss:0.012525461614131927
The generated pressure mean: 0.43676698207855225
loss_pred:0.0364065058529377, decouple_loss:0.012540200725197792
The generated pressure mean: 0.433371365070343
loss_pred:0.03723449632525444, decouple_loss:0.012085778638720512
Iteration: 3410, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46236786246299744
The generated pressure mean: 0.4676147699356079
loss_pred:0.03707480430603027, decouple_loss:0.013555748388171196
loss_pred:0.0370514839887619, decouple_loss:0.013879107311367989
The generated pressure mean: 0.46739667654037476
loss_pred:0.037693992257118225, decouple_loss:0.014579785987734795
2023-04-17 00:55:41 testing...
The generated pressure mean: 0.41566914319992065
The generated pressure mean: 0.41655680537223816
The generated pressure mean: 0.4182625412940979
loss_pred:0.04859885945916176, decouple_loss:0.01387739647179842
loss_pred:0.048164501786231995, decouple_loss:0.014337857253849506
loss_pred:0.048446349799633026, decouple_loss:0.014652150683104992
WV_0_PC_0_EH_1_PS_40, loss: 0.04911769554018974, avg_mse: 0.05715932697057724
current test mse: 0.057159
Iteration: 3411, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43452978134155273
The generated pressure mean: 0.43190547823905945
loss_pred:0.03665170073509216, decouple_loss:0.011848251335322857
loss_pred:0.036615367978811264, decouple_loss:0.01198562327772379
The generated pressure mean: 0.43490487337112427
loss_pred:0.03720507398247719, decouple_loss:0.011736955493688583
Iteration: 3412, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44701603055000305
loss_pred:0.0359921008348465, decouple_loss:0.009126977063715458
The generated pressure mean: 0.4491890072822571
loss_pred:0.03705272451043129, decouple_loss:0.008993728086352348
The generated pressure mean: 0.44852524995803833
loss_pred:0.03752189129590988, decouple_loss:0.009436517022550106
Iteration: 3413, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45111408829689026
The generated pressure mean: 0.45558393001556396loss_pred:0.038578495383262634, decouple_loss:0.012766285799443722
loss_pred:0.037569377571344376, decouple_loss:0.012753337621688843
The generated pressure mean: 0.4523230493068695
loss_pred:0.03684962913393974, decouple_loss:0.012442141771316528
Iteration: 3414, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4264219403266907
The generated pressure mean: 0.42899852991104126loss_pred:0.03817877918481827, decouple_loss:0.009131240658462048
loss_pred:0.03588423505425453, decouple_loss:0.009057998657226562
The generated pressure mean: 0.4276460111141205
loss_pred:0.037131428718566895, decouple_loss:0.009034724906086922
Iteration: 3415, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45895761251449585
The generated pressure mean: 0.46016499400138855
loss_pred:0.03560018911957741, decouple_loss:0.013640018180012703
loss_pred:0.036847133189439774, decouple_loss:0.013874053955078125
The generated pressure mean: 0.46139365434646606
loss_pred:0.0391332171857357, decouple_loss:0.013941372744739056
Iteration: 3416, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45415568351745605
The generated pressure mean: 0.4506656527519226
loss_pred:0.03687528520822525, decouple_loss:0.011868037283420563
loss_pred:0.03644579276442528, decouple_loss:0.010734595358371735
The generated pressure mean: 0.4541476368904114
loss_pred:0.03598489612340927, decouple_loss:0.01142315473407507
Iteration: 3417, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4318159222602844
The generated pressure mean: 0.43314406275749207
loss_pred:0.03589750453829765, decouple_loss:0.013825824484229088
loss_pred:0.03726240247488022, decouple_loss:0.013718592934310436
The generated pressure mean: 0.43121790885925293
loss_pred:0.036000050604343414, decouple_loss:0.013647593557834625
Iteration: 3418, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4588944911956787
The generated pressure mean: 0.4546889364719391
loss_pred:0.03635833412408829, decouple_loss:0.012592562474310398
loss_pred:0.037428997457027435, decouple_loss:0.012606191448867321
The generated pressure mean: 0.45742326974868774
loss_pred:0.03899950161576271, decouple_loss:0.012723006308078766
Iteration: 3419, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43234360218048096
The generated pressure mean: 0.43261590600013733
loss_pred:0.036891575902700424, decouple_loss:0.014717156998813152
loss_pred:0.03635548800230026, decouple_loss:0.01423591934144497
The generated pressure mean: 0.4351159930229187
loss_pred:0.03721322491765022, decouple_loss:0.014754797331988811
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3420, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4659521281719208
loss_pred:0.036587778478860855, decouple_loss:0.011351853609085083
The generated pressure mean: 0.4654524624347687
loss_pred:0.03752082958817482, decouple_loss:0.011383960954844952
The generated pressure mean: 0.4692780375480652
loss_pred:0.03919201344251633, decouple_loss:0.011306055821478367
2023-04-17 00:57:34 testing...
The generated pressure mean: 0.4155617654323578
The generated pressure mean: 0.41635945439338684
The generated pressure mean: 0.41867679357528687
loss_pred:0.04858590289950371, decouple_loss:0.012404260225594044
loss_pred:0.0481007844209671, decouple_loss:0.01257734838873148
loss_pred:0.04801620543003082, decouple_loss:0.012600545771420002
WV_0_PC_0_EH_1_PS_40, loss: 0.04886066913604736, avg_mse: 0.057546310126781464
current test mse: 0.057546
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 3421, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43918704986572266
loss_pred:0.0368705615401268, decouple_loss:0.013669454492628574
The generated pressure mean: 0.4378127157688141
loss_pred:0.036218948662281036, decouple_loss:0.012824575416743755
The generated pressure mean: 0.44216543436050415
loss_pred:0.03807239234447479, decouple_loss:0.013594229705631733
Iteration: 3422, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43004196882247925The generated pressure mean: 0.4310927391052246
loss_pred:0.03594193980097771, decouple_loss:0.012042631395161152
loss_pred:0.03687938675284386, decouple_loss:0.011504868045449257
The generated pressure mean: 0.4310235381126404
loss_pred:0.03713438659906387, decouple_loss:0.011563366279006004
Iteration: 3423, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46129992604255676
The generated pressure mean: 0.4677661061286926
loss_pred:0.03524197265505791, decouple_loss:0.011080932803452015
loss_pred:0.03484690189361572, decouple_loss:0.010611717589199543
The generated pressure mean: 0.4648476541042328
loss_pred:0.03479510173201561, decouple_loss:0.010865136049687862
Iteration: 3424, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44325554370880127
The generated pressure mean: 0.4431239366531372
loss_pred:0.03766224905848503, decouple_loss:0.010987654328346252
loss_pred:0.03688971325755119, decouple_loss:0.010822365991771221
The generated pressure mean: 0.4376445710659027
loss_pred:0.03502017259597778, decouple_loss:0.010907282121479511
Iteration: 3425, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44822388887405396
The generated pressure mean: 0.4426407217979431
loss_pred:0.03642874211072922, decouple_loss:0.012690854258835316
loss_pred:0.03684339299798012, decouple_loss:0.013469777069985867
The generated pressure mean: 0.4441462755203247
loss_pred:0.037848517298698425, decouple_loss:0.01295198779553175
Iteration: 3426, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487801790237427
The generated pressure mean: 0.4481029212474823
loss_pred:0.037176892161369324, decouple_loss:0.009512824937701225
loss_pred:0.0353534072637558, decouple_loss:0.00948681216686964
The generated pressure mean: 0.4500972032546997
loss_pred:0.03579823672771454, decouple_loss:0.009436577558517456
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3427, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4414333999156952
The generated pressure mean: 0.43970465660095215
loss_pred:0.035997241735458374, decouple_loss:0.013468064367771149
loss_pred:0.037388987839221954, decouple_loss:0.013434235006570816
The generated pressure mean: 0.44006070494651794
loss_pred:0.03637140244245529, decouple_loss:0.013564514927566051
Iteration: 3428, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4513542950153351
The generated pressure mean: 0.45276302099227905
loss_pred:0.03662390634417534, decouple_loss:0.011757781729102135
loss_pred:0.0349707156419754, decouple_loss:0.011697111651301384
The generated pressure mean: 0.4519887864589691
loss_pred:0.03657958284020424, decouple_loss:0.011469155550003052
Iteration: 3429, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45229771733283997
The generated pressure mean: 0.4531024098396301
loss_pred:0.03540165349841118, decouple_loss:0.011379878036677837
loss_pred:0.03721648454666138, decouple_loss:0.011912417598068714
The generated pressure mean: 0.4538876712322235
loss_pred:0.03598923236131668, decouple_loss:0.011542747728526592
Iteration: 3430, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4365858733654022
The generated pressure mean: 0.4377559423446655
loss_pred:0.037717390805482864, decouple_loss:0.012912762351334095
loss_pred:0.03744613006711006, decouple_loss:0.012966843321919441
The generated pressure mean: 0.4361083209514618
loss_pred:0.03704722970724106, decouple_loss:0.013160886242985725
2023-04-17 01:00:06 testing...
The generated pressure mean: 0.41180968284606934
The generated pressure mean: 0.4128689467906952
The generated pressure mean: 0.41529619693756104
loss_pred:0.04906560108065605, decouple_loss:0.012913823127746582
loss_pred:0.048113863915205, decouple_loss:0.013200302608311176
loss_pred:0.047855086624622345, decouple_loss:0.013567153364419937
WV_0_PC_0_EH_1_PS_40, loss: 0.049006205052137375, avg_mse: 0.058310460299253464
current test mse: 0.05831
Iteration: 3431, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.455846905708313
loss_pred:0.03490950167179108, decouple_loss:0.011348229832947254
The generated pressure mean: 0.45564576983451843
loss_pred:0.037674058228731155, decouple_loss:0.011014336720108986
The generated pressure mean: 0.4549795687198639
loss_pred:0.03720542788505554, decouple_loss:0.011042150668799877
Iteration: 3432, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43611037731170654
loss_pred:0.03639378398656845, decouple_loss:0.01120343804359436
The generated pressure mean: 0.4364892840385437
loss_pred:0.033714402467012405, decouple_loss:0.010719633661210537
The generated pressure mean: 0.43718504905700684
loss_pred:0.035324662923812866, decouple_loss:0.011014917865395546
Iteration: 3433, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4534088671207428
loss_pred:0.03809529170393944, decouple_loss:0.012055333703756332
The generated pressure mean: 0.45053860545158386
loss_pred:0.03731464594602585, decouple_loss:0.011095349676907063
The generated pressure mean: 0.4511936902999878
loss_pred:0.03546708822250366, decouple_loss:0.011064899154007435
Iteration: 3434, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45931196212768555
loss_pred:0.0358152762055397, decouple_loss:0.011258000507950783
The generated pressure mean: 0.46015745401382446
loss_pred:0.034802377223968506, decouple_loss:0.010584847070276737
The generated pressure mean: 0.4585701525211334
loss_pred:0.03603978827595711, decouple_loss:0.010463790036737919
Iteration: 3435, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42435941100120544
The generated pressure mean: 0.42596036195755005
loss_pred:0.035658109933137894, decouple_loss:0.010217759758234024
loss_pred:0.034772008657455444, decouple_loss:0.010048246942460537
The generated pressure mean: 0.4243543744087219
loss_pred:0.03777468204498291, decouple_loss:0.009991227649152279
Iteration: 3436, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4613291025161743
loss_pred:0.03744973614811897, decouple_loss:0.010628367774188519
The generated pressure mean: 0.46510636806488037
loss_pred:0.035936448723077774, decouple_loss:0.009935533627867699
The generated pressure mean: 0.45949289202690125
loss_pred:0.03600297123193741, decouple_loss:0.010132749564945698
Iteration: 3437, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45218291878700256
loss_pred:0.036563046276569366, decouple_loss:0.011449557729065418
The generated pressure mean: 0.4554133117198944
loss_pred:0.03704163804650307, decouple_loss:0.012329882010817528
The generated pressure mean: 0.4517846405506134
loss_pred:0.035346392542123795, decouple_loss:0.011665924452245235
Iteration: 3438, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.426927387714386
The generated pressure mean: 0.42605718970298767
loss_pred:0.03663576394319534, decouple_loss:0.010556026361882687
loss_pred:0.037067536264657974, decouple_loss:0.010747220367193222
The generated pressure mean: 0.4293098449707031
loss_pred:0.03373384475708008, decouple_loss:0.010297659784555435
Iteration: 3439, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47025907039642334
The generated pressure mean: 0.47110629081726074
loss_pred:0.03605487942695618, decouple_loss:0.01006808690726757
loss_pred:0.03561590984463692, decouple_loss:0.010350831784307957
The generated pressure mean: 0.4687129855155945
loss_pred:0.035794343799352646, decouple_loss:0.010326862335205078
Iteration: 3440, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42911869287490845
The generated pressure mean: 0.4280335307121277
loss_pred:0.03558533266186714, decouple_loss:0.010021642781794071
loss_pred:0.0368361733853817, decouple_loss:0.01018508244305849
The generated pressure mean: 0.42841437458992004
loss_pred:0.03457295894622803, decouple_loss:0.010164746083319187
2023-04-17 01:02:00 testing...
The generated pressure mean: 0.4132198393344879
The generated pressure mean: 0.41429054737091064
The generated pressure mean: 0.4162529706954956
loss_pred:0.04891526699066162, decouple_loss:0.010010084137320518
loss_pred:0.04802997410297394, decouple_loss:0.010209723375737667
loss_pred:0.047790348529815674, decouple_loss:0.010247841477394104
WV_0_PC_0_EH_1_PS_40, loss: 0.04875298961997032, avg_mse: 0.05844475328922272
current test mse: 0.058445
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 3441, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44533976912498474
loss_pred:0.035990748554468155, decouple_loss:0.00934863556176424
The generated pressure mean: 0.4453212022781372
The generated pressure mean: 0.4445725083351135loss_pred:0.035959333181381226, decouple_loss:0.00931604951620102
loss_pred:0.03641217574477196, decouple_loss:0.009188170544803143
Iteration: 3442, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47021588683128357The generated pressure mean: 0.4712650775909424
loss_pred:0.03523974120616913, decouple_loss:0.00925716944038868
loss_pred:0.03520188480615616, decouple_loss:0.009315915405750275
The generated pressure mean: 0.4745282232761383
loss_pred:0.03454200550913811, decouple_loss:0.009246962144970894
Iteration: 3443, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4294734001159668The generated pressure mean: 0.4287814497947693
loss_pred:0.03591785579919815, decouple_loss:0.008561079390347004
loss_pred:0.03469423949718475, decouple_loss:0.008901492692530155
The generated pressure mean: 0.4257383644580841
loss_pred:0.033437103033065796, decouple_loss:0.008624746464192867
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3444, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484131634235382
loss_pred:0.03565794602036476, decouple_loss:0.010584563948214054
The generated pressure mean: 0.4488551616668701
loss_pred:0.03621023893356323, decouple_loss:0.010724924504756927
The generated pressure mean: 0.44720253348350525
loss_pred:0.036207228899002075, decouple_loss:0.010688431560993195
Iteration: 3445, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4568997919559479
The generated pressure mean: 0.4515802562236786
loss_pred:0.03733649477362633, decouple_loss:0.00895217526704073
loss_pred:0.034826237708330154, decouple_loss:0.008911091834306717
The generated pressure mean: 0.4600255787372589
loss_pred:0.03594120964407921, decouple_loss:0.0087964478880167
Iteration: 3446, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4314182996749878
The generated pressure mean: 0.4357199966907501loss_pred:0.035838834941387177, decouple_loss:0.012216692790389061
loss_pred:0.03459244221448898, decouple_loss:0.01185101643204689
The generated pressure mean: 0.43800273537635803
loss_pred:0.036048561334609985, decouple_loss:0.011862734332680702
Iteration: 3447, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46266019344329834
The generated pressure mean: 0.46248432993888855
loss_pred:0.034867044538259506, decouple_loss:0.009404582902789116
loss_pred:0.03477215766906738, decouple_loss:0.00962493009865284
The generated pressure mean: 0.46227461099624634
loss_pred:0.03447209298610687, decouple_loss:0.009977521374821663
Iteration: 3448, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4384292662143707
The generated pressure mean: 0.43793296813964844
loss_pred:0.03474923595786095, decouple_loss:0.013011161237955093
loss_pred:0.03468576818704605, decouple_loss:0.012775583192706108
The generated pressure mean: 0.43909385800361633
loss_pred:0.03591528162360191, decouple_loss:0.01331455260515213
Iteration: 3449, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44665002822875977
loss_pred:0.03502225503325462, decouple_loss:0.010569566860795021
The generated pressure mean: 0.44383424520492554
loss_pred:0.034505169838666916, decouple_loss:0.010955478064715862
The generated pressure mean: 0.4471643567085266
loss_pred:0.03467051684856415, decouple_loss:0.01037726178765297
Iteration: 3450, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4549328684806824
loss_pred:0.034830786287784576, decouple_loss:0.010856226086616516
The generated pressure mean: 0.4588307738304138
loss_pred:0.0358104407787323, decouple_loss:0.01093394123017788
The generated pressure mean: 0.45651933550834656
loss_pred:0.03381834924221039, decouple_loss:0.011264554224908352
2023-04-17 01:04:33 testing...
The generated pressure mean: 0.41578856110572815
The generated pressure mean: 0.41693538427352905
The generated pressure mean: 0.4194044768810272
loss_pred:0.04767316207289696, decouple_loss:0.01149761863052845
loss_pred:0.04682961851358414, decouple_loss:0.01182862650603056
loss_pred:0.04668065160512924, decouple_loss:0.011819995939731598
WV_0_PC_0_EH_1_PS_40, loss: 0.04764691740274429, avg_mse: 0.05734584853053093
current test mse: 0.057346
Iteration: 3451, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44801920652389526
The generated pressure mean: 0.4462801516056061
loss_pred:0.03452285751700401, decouple_loss:0.010622553527355194
loss_pred:0.03556900843977928, decouple_loss:0.010815206915140152
The generated pressure mean: 0.4459640383720398
loss_pred:0.03420385345816612, decouple_loss:0.01059421431273222
Iteration: 3452, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4402977526187897
The generated pressure mean: 0.44091862440109253loss_pred:0.035359565168619156, decouple_loss:0.010561657138168812
loss_pred:0.03635968267917633, decouple_loss:0.010196154937148094
The generated pressure mean: 0.44099947810173035
loss_pred:0.035822197794914246, decouple_loss:0.010179723612964153
Iteration: 3453, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44707226753234863
loss_pred:0.03599951043725014, decouple_loss:0.010320225730538368
The generated pressure mean: 0.4492230713367462
loss_pred:0.03402302414178848, decouple_loss:0.010380479507148266
The generated pressure mean: 0.45002487301826477
loss_pred:0.03440261632204056, decouple_loss:0.010358234867453575
Iteration: 3454, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46100449562072754
loss_pred:0.035026680678129196, decouple_loss:0.009383801370859146
The generated pressure mean: 0.45365795493125916
loss_pred:0.034121815115213394, decouple_loss:0.009307237342000008
The generated pressure mean: 0.4545138478279114
loss_pred:0.03413693606853485, decouple_loss:0.009774735197424889
Iteration: 3455, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4326624572277069
loss_pred:0.03533059358596802, decouple_loss:0.009939168579876423
The generated pressure mean: 0.43564191460609436
loss_pred:0.03509986400604248, decouple_loss:0.01001619640737772
The generated pressure mean: 0.4335710406303406
loss_pred:0.035361889749765396, decouple_loss:0.009655945934355259
Iteration: 3456, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4594007134437561
loss_pred:0.034116994589567184, decouple_loss:0.009756749495863914
The generated pressure mean: 0.45904019474983215
loss_pred:0.0355435386300087, decouple_loss:0.009784114547073841
The generated pressure mean: 0.4520893692970276
loss_pred:0.035062726587057114, decouple_loss:0.01009033340960741
Iteration: 3457, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4582890570163727
loss_pred:0.03529474139213562, decouple_loss:0.009860390797257423
The generated pressure mean: 0.4608303904533386
loss_pred:0.03519941493868828, decouple_loss:0.009485890157520771
The generated pressure mean: 0.4608011245727539
loss_pred:0.034990012645721436, decouple_loss:0.009730073623359203
Iteration: 3458, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.41036126017570496
loss_pred:0.03551574796438217, decouple_loss:0.011327594518661499
The generated pressure mean: 0.41718676686286926
loss_pred:0.03514653816819191, decouple_loss:0.011204077862203121
The generated pressure mean: 0.41094544529914856
loss_pred:0.03603648766875267, decouple_loss:0.011505881324410439
Iteration: 3459, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.5082858800888062
The generated pressure mean: 0.5018685460090637
loss_pred:0.03581418842077255, decouple_loss:0.010853982530534267
loss_pred:0.035349875688552856, decouple_loss:0.011109204962849617
The generated pressure mean: 0.5027862787246704
loss_pred:0.03662092611193657, decouple_loss:0.010780752636492252
Iteration: 3460, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.40263089537620544
loss_pred:0.03501008078455925, decouple_loss:0.01223517581820488
The generated pressure mean: 0.40415894985198975
loss_pred:0.036481358110904694, decouple_loss:0.012331193313002586
The generated pressure mean: 0.4010269343852997
loss_pred:0.03597079962491989, decouple_loss:0.012416055426001549
2023-04-17 01:06:27 testing...
The generated pressure mean: 0.4067455530166626
The generated pressure mean: 0.40775999426841736
loss_pred:0.05168783664703369, decouple_loss:0.015075292438268661
The generated pressure mean: 0.4098682701587677
loss_pred:0.05100215598940849, decouple_loss:0.015340417623519897
loss_pred:0.050448860973119736, decouple_loss:0.015477778390049934
WV_0_PC_0_EH_1_PS_40, loss: 0.051811181008815765, avg_mse: 0.06355192512273788
current test mse: 0.063552
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 3461, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.474396288394928
loss_pred:0.03735290467739105, decouple_loss:0.014180045574903488
The generated pressure mean: 0.4672490060329437
loss_pred:0.0393478162586689, decouple_loss:0.013573328964412212
The generated pressure mean: 0.4657355844974518
loss_pred:0.03896922990679741, decouple_loss:0.013175849802792072
Iteration: 3462, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45895907282829285
loss_pred:0.037409838289022446, decouple_loss:0.01171807385981083
The generated pressure mean: 0.45931369066238403
loss_pred:0.036280322819948196, decouple_loss:0.012181511148810387
The generated pressure mean: 0.4622054994106293
loss_pred:0.03541973605751991, decouple_loss:0.01202922873198986
Iteration: 3463, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4136694073677063
The generated pressure mean: 0.41351088881492615
loss_pred:0.03594028577208519, decouple_loss:0.011734897270798683
loss_pred:0.03527730330824852, decouple_loss:0.011464569717645645
The generated pressure mean: 0.4162624180316925
loss_pred:0.036169011145830154, decouple_loss:0.011459876783192158
Iteration: 3464, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45217323303222656
The generated pressure mean: 0.4565824270248413
loss_pred:0.037444088608026505, decouple_loss:0.010640989057719707
loss_pred:0.033650368452072144, decouple_loss:0.010293809697031975
The generated pressure mean: 0.45814430713653564
loss_pred:0.038142915815114975, decouple_loss:0.011468586511909962
Iteration: 3465, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.477785587310791
The generated pressure mean: 0.47363173961639404
loss_pred:0.034684862941503525, decouple_loss:0.011483871378004551
loss_pred:0.03406168147921562, decouple_loss:0.01131372433155775
The generated pressure mean: 0.47557714581489563
loss_pred:0.03336988016963005, decouple_loss:0.011330588720738888
Iteration: 3466, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4275050163269043
loss_pred:0.03433355689048767, decouple_loss:0.010381491854786873
The generated pressure mean: 0.423782080411911
loss_pred:0.035595886409282684, decouple_loss:0.010259950533509254
The generated pressure mean: 0.4251662492752075
loss_pred:0.033007171005010605, decouple_loss:0.010398105718195438
Iteration: 3467, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4239307641983032
The generated pressure mean: 0.42667046189308167loss_pred:0.037471868097782135, decouple_loss:0.01073115412145853
loss_pred:0.034351617097854614, decouple_loss:0.010950849391520023
The generated pressure mean: 0.4252898693084717
loss_pred:0.033090490847826004, decouple_loss:0.01065608486533165
Iteration: 3468, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46527770161628723
loss_pred:0.03555190935730934, decouple_loss:0.012361901812255383
The generated pressure mean: 0.46550649404525757
loss_pred:0.03647073730826378, decouple_loss:0.012505843304097652
The generated pressure mean: 0.4674338102340698
loss_pred:0.032156411558389664, decouple_loss:0.012085255235433578
Iteration: 3469, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46451279520988464
loss_pred:0.03350507840514183, decouple_loss:0.011410154402256012
The generated pressure mean: 0.4632491171360016
loss_pred:0.03490925207734108, decouple_loss:0.011110498569905758
The generated pressure mean: 0.4624073803424835
loss_pred:0.03494535759091377, decouple_loss:0.011788992211222649
Iteration: 3470, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4243791997432709
loss_pred:0.036514762789011, decouple_loss:0.011037841439247131
The generated pressure mean: 0.4238649308681488
loss_pred:0.03440467268228531, decouple_loss:0.010793016292154789
The generated pressure mean: 0.42399176955223083
loss_pred:0.03273608535528183, decouple_loss:0.011458439752459526
2023-04-17 01:08:58 testing...
The generated pressure mean: 0.4144570529460907
The generated pressure mean: 0.4155954122543335
loss_pred:0.047646962106227875, decouple_loss:0.011897943913936615
The generated pressure mean: 0.41720935702323914
loss_pred:0.04688353091478348, decouple_loss:0.012024158611893654
loss_pred:0.04687465354800224, decouple_loss:0.011922313831746578
WV_0_PC_0_EH_1_PS_40, loss: 0.047732457518577576, avg_mse: 0.0573267936706543
current test mse: 0.057327
Iteration: 3471, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4363488554954529
The generated pressure mean: 0.437959760427475
loss_pred:0.03519296273589134, decouple_loss:0.01200456265360117
loss_pred:0.0348660834133625, decouple_loss:0.012767299078404903
The generated pressure mean: 0.435424268245697
loss_pred:0.034859396517276764, decouple_loss:0.012699450366199017
Iteration: 3472, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4678555130958557
loss_pred:0.033951885998249054, decouple_loss:0.010593636892735958
The generated pressure mean: 0.4682946801185608
loss_pred:0.03653467819094658, decouple_loss:0.010029250755906105
The generated pressure mean: 0.4646605849266052
loss_pred:0.03486332297325134, decouple_loss:0.010090023279190063
Iteration: 3473, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45379430055618286
loss_pred:0.0336654968559742, decouple_loss:0.011179549619555473
The generated pressure mean: 0.454578161239624
loss_pred:0.034899719059467316, decouple_loss:0.010905124247074127
The generated pressure mean: 0.4494544267654419
loss_pred:0.03537734970450401, decouple_loss:0.011148682795464993
Iteration: 3474, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.41659727692604065
loss_pred:0.033721063286066055, decouple_loss:0.011957251466810703
The generated pressure mean: 0.41671282052993774
loss_pred:0.03677785396575928, decouple_loss:0.012034840881824493
The generated pressure mean: 0.41743725538253784
loss_pred:0.03352852538228035, decouple_loss:0.011629813350737095
Iteration: 3475, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45474907755851746
loss_pred:0.03372596204280853, decouple_loss:0.008708624169230461
The generated pressure mean: 0.4583416283130646
loss_pred:0.033328067511320114, decouple_loss:0.008835007436573505
The generated pressure mean: 0.4582332968711853
loss_pred:0.03222138434648514, decouple_loss:0.008737482130527496
Iteration: 3476, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4665893614292145
loss_pred:0.03507417067885399, decouple_loss:0.012235105969011784
The generated pressure mean: 0.46636098623275757
loss_pred:0.03649779036641121, decouple_loss:0.012631700374186039
The generated pressure mean: 0.4674018323421478
loss_pred:0.034461766481399536, decouple_loss:0.012624850496649742
Iteration: 3477, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.433999240398407
loss_pred:0.033906929194927216, decouple_loss:0.011635009199380875
The generated pressure mean: 0.43123161792755127
loss_pred:0.032089218497276306, decouple_loss:0.0116591090336442
The generated pressure mean: 0.4316304922103882
loss_pred:0.03589387238025665, decouple_loss:0.01144090574234724
Iteration: 3478, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4361681044101715
loss_pred:0.033944323658943176, decouple_loss:0.010485772974789143
The generated pressure mean: 0.4331238567829132
loss_pred:0.03300775587558746, decouple_loss:0.010498743504285812
The generated pressure mean: 0.43666332960128784
loss_pred:0.03283446282148361, decouple_loss:0.010514494962990284
Iteration: 3479, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46353524923324585
The generated pressure mean: 0.46554505825042725
loss_pred:0.03301165625452995, decouple_loss:0.012512891553342342
loss_pred:0.03338680788874626, decouple_loss:0.012415279634296894
The generated pressure mean: 0.4646545946598053
loss_pred:0.03272490203380585, decouple_loss:0.012568706646561623
Iteration: 3480, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44371265172958374
loss_pred:0.03223414346575737, decouple_loss:0.010877550579607487
The generated pressure mean: 0.4417884051799774
loss_pred:0.03481719642877579, decouple_loss:0.010263481177389622
The generated pressure mean: 0.4404989182949066
loss_pred:0.03449258580803871, decouple_loss:0.010390222072601318
2023-04-17 01:10:51 testing...
The generated pressure mean: 0.41557440161705017
The generated pressure mean: 0.4170568883419037
The generated pressure mean: 0.4191325902938843
loss_pred:0.04853013902902603, decouple_loss:0.012859425507485867
loss_pred:0.047940317541360855, decouple_loss:0.013288147747516632
loss_pred:0.04792935401201248, decouple_loss:0.013244478963315487
WV_0_PC_0_EH_1_PS_40, loss: 0.04878980666399002, avg_mse: 0.060517679899930954
current test mse: 0.060518
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 3481, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44064414501190186
loss_pred:0.037269219756126404, decouple_loss:0.012574874795973301
The generated pressure mean: 0.4391976296901703
loss_pred:0.03792745620012283, decouple_loss:0.012200460769236088
The generated pressure mean: 0.44340649247169495
loss_pred:0.03961895406246185, decouple_loss:0.012925188057124615
Iteration: 3482, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43428701162338257
The generated pressure mean: 0.43397197127342224loss_pred:0.04019046202301979, decouple_loss:0.012538657523691654
loss_pred:0.0380176417529583, decouple_loss:0.01252793986350298
The generated pressure mean: 0.43246686458587646
loss_pred:0.03757753223180771, decouple_loss:0.012182758189737797
Iteration: 3483, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4558863639831543
loss_pred:0.03665481135249138, decouple_loss:0.010256333276629448
The generated pressure mean: 0.4577367603778839
loss_pred:0.037145987153053284, decouple_loss:0.010356752201914787
The generated pressure mean: 0.45893028378486633
loss_pred:0.03777264058589935, decouple_loss:0.010126360692083836
Iteration: 3484, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46011123061180115
loss_pred:0.03740768879652023, decouple_loss:0.013631467707455158
The generated pressure mean: 0.46255338191986084
loss_pred:0.0375186949968338, decouple_loss:0.013509388081729412
The generated pressure mean: 0.46195635199546814
loss_pred:0.03998793289065361, decouple_loss:0.013662027195096016
Iteration: 3485, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42344969511032104
loss_pred:0.038536056876182556, decouple_loss:0.01260578352957964
The generated pressure mean: 0.4196417033672333
loss_pred:0.04028414562344551, decouple_loss:0.010917381383478642
The generated pressure mean: 0.42177093029022217
loss_pred:0.03634687140583992, decouple_loss:0.011168797500431538
Iteration: 3486, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460473358631134
loss_pred:0.03708087280392647, decouple_loss:0.01123617310076952
The generated pressure mean: 0.44529321789741516
loss_pred:0.036914654076099396, decouple_loss:0.01170920766890049
The generated pressure mean: 0.4418797194957733
loss_pred:0.03724188357591629, decouple_loss:0.01092327106744051
Iteration: 3487, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47894251346588135
loss_pred:0.03933367505669594, decouple_loss:0.012090235948562622
The generated pressure mean: 0.47715213894844055
loss_pred:0.036187365651130676, decouple_loss:0.011816749349236488
The generated pressure mean: 0.47668910026550293
loss_pred:0.03674747049808502, decouple_loss:0.011843850836157799
Iteration: 3488, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43728578090667725
The generated pressure mean: 0.4351602792739868
loss_pred:0.03679558262228966, decouple_loss:0.010687756352126598
loss_pred:0.03771400451660156, decouple_loss:0.0110972560942173
The generated pressure mean: 0.4380839765071869
loss_pred:0.03841724619269371, decouple_loss:0.010923284105956554
Iteration: 3489, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4108187258243561
loss_pred:0.03491031005978584, decouple_loss:0.01074475608766079
The generated pressure mean: 0.4156460165977478
loss_pred:0.034990258514881134, decouple_loss:0.010586706921458244
The generated pressure mean: 0.41514143347740173
loss_pred:0.037168484181165695, decouple_loss:0.010293340310454369
Iteration: 3490, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47780612111091614
The generated pressure mean: 0.47607746720314026
loss_pred:0.03877634555101395, decouple_loss:0.011133951134979725
loss_pred:0.037408292293548584, decouple_loss:0.01164181437343359
The generated pressure mean: 0.4763072729110718
loss_pred:0.035764142870903015, decouple_loss:0.011446204036474228
2023-04-17 01:13:21 testing...
The generated pressure mean: 0.4089841842651367
The generated pressure mean: 0.41049396991729736
loss_pred:0.04950453341007233, decouple_loss:0.010553688742220402
The generated pressure mean: 0.4121784567832947
loss_pred:0.04786095768213272, decouple_loss:0.010863060131669044
loss_pred:0.04859543964266777, decouple_loss:0.010959944687783718
WV_0_PC_0_EH_1_PS_40, loss: 0.049193255603313446, avg_mse: 0.06090938672423363
current test mse: 0.060909
Iteration: 3491, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4625403881072998
loss_pred:0.03862224146723747, decouple_loss:0.009905061684548855
The generated pressure mean: 0.46337324380874634
loss_pred:0.03801612928509712, decouple_loss:0.009459976106882095
The generated pressure mean: 0.46176934242248535
loss_pred:0.03604022040963173, decouple_loss:0.009550250135362148
Iteration: 3492, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42371857166290283
loss_pred:0.03471110016107559, decouple_loss:0.012145275250077248
The generated pressure mean: 0.42450010776519775
loss_pred:0.03678997978568077, decouple_loss:0.012624057941138744
The generated pressure mean: 0.42843323945999146
loss_pred:0.03613029420375824, decouple_loss:0.01182530727237463
Iteration: 3493, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43350136280059814
loss_pred:0.035858288407325745, decouple_loss:0.00939927063882351
The generated pressure mean: 0.4366348683834076
loss_pred:0.038121141493320465, decouple_loss:0.009416159242391586
The generated pressure mean: 0.43428751826286316
loss_pred:0.035322852432727814, decouple_loss:0.009591316804289818
Iteration: 3494, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46549737453460693
loss_pred:0.038913510739803314, decouple_loss:0.011462959460914135
The generated pressure mean: 0.46348971128463745
loss_pred:0.03708600252866745, decouple_loss:0.011908864602446556
The generated pressure mean: 0.4637877345085144
loss_pred:0.03374800086021423, decouple_loss:0.012394402176141739
Iteration: 3495, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4606475830078125
loss_pred:0.03636007010936737, decouple_loss:0.0097332913428545
The generated pressure mean: 0.4616452157497406
loss_pred:0.03562259301543236, decouple_loss:0.010110090486705303
The generated pressure mean: 0.46457168459892273
loss_pred:0.03701139986515045, decouple_loss:0.011079653166234493
Iteration: 3496, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42292818427085876
loss_pred:0.03702182322740555, decouple_loss:0.011545340530574322
The generated pressure mean: 0.4292089641094208
loss_pred:0.03568270057439804, decouple_loss:0.01123742014169693
The generated pressure mean: 0.4310576021671295
loss_pred:0.03848803788423538, decouple_loss:0.012021368369460106
Iteration: 3497, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4516919255256653
loss_pred:0.03561696782708168, decouple_loss:0.011535466648638248
The generated pressure mean: 0.4477747976779938
loss_pred:0.03566630929708481, decouple_loss:0.01164332590997219
The generated pressure mean: 0.45633161067962646
loss_pred:0.03742790222167969, decouple_loss:0.01179277990013361
Iteration: 3498, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45643487572669983The generated pressure mean: 0.4570927023887634
loss_pred:0.04011686146259308, decouple_loss:0.011900265701115131loss_pred:0.035030119121074677, decouple_loss:0.011789413169026375
The generated pressure mean: 0.4520609378814697
loss_pred:0.03458932414650917, decouple_loss:0.01224179845303297
Iteration: 3499, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4275939166545868
The generated pressure mean: 0.42313510179519653
loss_pred:0.03787056356668472, decouple_loss:0.011726888827979565
loss_pred:0.03850235044956207, decouple_loss:0.010923593305051327
The generated pressure mean: 0.42765942215919495
loss_pred:0.037322305142879486, decouple_loss:0.01070497091859579
Iteration: 3500, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.48433026671409607
The generated pressure mean: 0.4824301600456238
loss_pred:0.04251238331198692, decouple_loss:0.015551340766251087
loss_pred:0.03751460835337639, decouple_loss:0.014576646499335766
The generated pressure mean: 0.4815451204776764
loss_pred:0.038261160254478455, decouple_loss:0.014738616533577442
2023-04-17 01:15:13 testing...
The generated pressure mean: 0.41575056314468384
The generated pressure mean: 0.41758832335472107
The generated pressure mean: 0.4196375608444214
loss_pred:0.04827488958835602, decouple_loss:0.012399526312947273
loss_pred:0.046837642788887024, decouple_loss:0.012192446738481522
loss_pred:0.0469248928129673, decouple_loss:0.012230277061462402
WV_0_PC_0_EH_1_PS_40, loss: 0.04795951396226883, avg_mse: 0.0595303475856781
current test mse: 0.05953
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 3501, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4425508975982666
loss_pred:0.03683795407414436, decouple_loss:0.012505657970905304
The generated pressure mean: 0.44482648372650146
loss_pred:0.03492707759141922, decouple_loss:0.012710058130323887
The generated pressure mean: 0.43884608149528503
loss_pred:0.037458185106515884, decouple_loss:0.012772392481565475
Iteration: 3502, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4153737425804138
loss_pred:0.036340150982141495, decouple_loss:0.011869838461279869
The generated pressure mean: 0.41394755244255066
loss_pred:0.035080354660749435, decouple_loss:0.011792811565101147
The generated pressure mean: 0.4152531325817108
loss_pred:0.034436579793691635, decouple_loss:0.01169789768755436
Iteration: 3503, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.48394063115119934
loss_pred:0.03558503836393356, decouple_loss:0.01609894447028637
The generated pressure mean: 0.4815809726715088
loss_pred:0.03421615809202194, decouple_loss:0.01611272618174553
The generated pressure mean: 0.48914721608161926
loss_pred:0.03662262111902237, decouple_loss:0.01653967797756195
Iteration: 3504, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4428909122943878
loss_pred:0.03391321375966072, decouple_loss:0.011569002643227577
The generated pressure mean: 0.445598840713501
loss_pred:0.03469856083393097, decouple_loss:0.011225258931517601
The generated pressure mean: 0.4453284442424774
loss_pred:0.03469063341617584, decouple_loss:0.01124674454331398
Iteration: 3505, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42924705147743225
loss_pred:0.034279998391866684, decouple_loss:0.014853611588478088
The generated pressure mean: 0.4285370707511902
loss_pred:0.03528023511171341, decouple_loss:0.015666015446186066
The generated pressure mean: 0.425677627325058
loss_pred:0.0361332967877388, decouple_loss:0.015040548518300056
Iteration: 3506, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4409925937652588
loss_pred:0.03548392280936241, decouple_loss:0.012133991345763206
The generated pressure mean: 0.443450003862381
The generated pressure mean: 0.4432951509952545
loss_pred:0.0338936522603035, decouple_loss:0.0122663713991642
loss_pred:0.03385847061872482, decouple_loss:0.012303384952247143
Iteration: 3507, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.453867107629776
loss_pred:0.03422573208808899, decouple_loss:0.01314333826303482
The generated pressure mean: 0.4550950825214386
loss_pred:0.03372149169445038, decouple_loss:0.01322212815284729
The generated pressure mean: 0.45544204115867615
loss_pred:0.03388705104589462, decouple_loss:0.012623706832528114
Iteration: 3508, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45451948046684265
loss_pred:0.03555608540773392, decouple_loss:0.011844954453408718
The generated pressure mean: 0.45174646377563477
The generated pressure mean: 0.45622333884239197
loss_pred:0.036116693168878555, decouple_loss:0.011727388948202133
loss_pred:0.03507693484425545, decouple_loss:0.011971468105912209
Iteration: 3509, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4389536678791046
loss_pred:0.0361245758831501, decouple_loss:0.010787646286189556
The generated pressure mean: 0.43788182735443115
loss_pred:0.036694712936878204, decouple_loss:0.011116879992187023
The generated pressure mean: 0.436888724565506
loss_pred:0.03541722521185875, decouple_loss:0.010673074051737785
Iteration: 3510, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495041072368622
loss_pred:0.03427818790078163, decouple_loss:0.012867939658463001
The generated pressure mean: 0.4544508755207062
The generated pressure mean: 0.44987139105796814
loss_pred:0.033855944871902466, decouple_loss:0.012751114554703236
loss_pred:0.03333817422389984, decouple_loss:0.01271052286028862
2023-04-17 01:17:44 testing...
The generated pressure mean: 0.41362202167510986
The generated pressure mean: 0.4154607951641083
The generated pressure mean: 0.4172223210334778
loss_pred:0.047060880810022354, decouple_loss:0.010693192481994629
loss_pred:0.04677879437804222, decouple_loss:0.010954390279948711
loss_pred:0.04553770646452904, decouple_loss:0.011003940366208553
WV_0_PC_0_EH_1_PS_40, loss: 0.04700332134962082, avg_mse: 0.058584630489349365
current test mse: 0.058585
Iteration: 3511, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46088555455207825
loss_pred:0.03517374396324158, decouple_loss:0.010032197460532188
The generated pressure mean: 0.4571962058544159
loss_pred:0.03567790240049362, decouple_loss:0.010072069242596626
The generated pressure mean: 0.458407461643219
loss_pred:0.0351567380130291, decouple_loss:0.009720287285745144
Iteration: 3512, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44107672572135925
loss_pred:0.03577953577041626, decouple_loss:0.011509234085679054
The generated pressure mean: 0.43758317828178406
loss_pred:0.03449806943535805, decouple_loss:0.0110123036429286
The generated pressure mean: 0.43662121891975403
loss_pred:0.032244790345430374, decouple_loss:0.011443769559264183
Iteration: 3513, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43010392785072327
loss_pred:0.03280691057443619, decouple_loss:0.010305066592991352
The generated pressure mean: 0.4328123927116394
loss_pred:0.03374543786048889, decouple_loss:0.010354981757700443
The generated pressure mean: 0.4311169385910034
loss_pred:0.03276209533214569, decouple_loss:0.010317647829651833
Iteration: 3514, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45353397727012634
loss_pred:0.033984605222940445, decouple_loss:0.009333566762506962
The generated pressure mean: 0.45856982469558716
loss_pred:0.03363293409347534, decouple_loss:0.00901938695460558
The generated pressure mean: 0.45701053738594055
loss_pred:0.03500901162624359, decouple_loss:0.008894662372767925
Iteration: 3515, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4545312225818634
loss_pred:0.03150909021496773, decouple_loss:0.010619166307151318
The generated pressure mean: 0.453325480222702
loss_pred:0.03299595043063164, decouple_loss:0.010904419235885143
The generated pressure mean: 0.45671752095222473
loss_pred:0.033396851271390915, decouple_loss:0.010444347746670246
Iteration: 3516, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4414331614971161
loss_pred:0.03286780044436455, decouple_loss:0.009862174279987812
The generated pressure mean: 0.44442689418792725
The generated pressure mean: 0.44111111760139465
loss_pred:0.03276332467794418, decouple_loss:0.009748528711497784
loss_pred:0.03275207057595253, decouple_loss:0.009565746411681175
Iteration: 3517, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43421682715415955
loss_pred:0.032882679253816605, decouple_loss:0.009991911239922047
The generated pressure mean: 0.43005698919296265
loss_pred:0.034194715321063995, decouple_loss:0.010628143325448036
The generated pressure mean: 0.43202513456344604
loss_pred:0.03204634413123131, decouple_loss:0.010563205927610397
Iteration: 3518, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43777844309806824
loss_pred:0.03394119814038277, decouple_loss:0.01138446107506752
The generated pressure mean: 0.43792209029197693
loss_pred:0.03315132483839989, decouple_loss:0.011480995453894138
The generated pressure mean: 0.43922996520996094
loss_pred:0.03380947187542915, decouple_loss:0.011557132005691528
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3519, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46123605966567993
loss_pred:0.0348072424530983, decouple_loss:0.010008706711232662
The generated pressure mean: 0.4617544412612915
The generated pressure mean: 0.4613967835903168
loss_pred:0.033143188804388046, decouple_loss:0.00966397114098072
loss_pred:0.03617899864912033, decouple_loss:0.0096132792532444
Iteration: 3520, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4664855897426605
loss_pred:0.033392831683158875, decouple_loss:0.012006528675556183
The generated pressure mean: 0.47331902384757996
loss_pred:0.03383885696530342, decouple_loss:0.01168888621032238
The generated pressure mean: 0.47030532360076904
loss_pred:0.033840738236904144, decouple_loss:0.011822921223938465
2023-04-17 01:19:37 testing...
The generated pressure mean: 0.4300575256347656
The generated pressure mean: 0.4275192320346832
The generated pressure mean: 0.43122121691703796
loss_pred:0.044777240604162216, decouple_loss:0.011224009096622467
loss_pred:0.044931650161743164, decouple_loss:0.010734244249761105
loss_pred:0.044540248811244965, decouple_loss:0.011210070922970772
WV_0_PC_0_EH_1_PS_40, loss: 0.04530252143740654, avg_mse: 0.05589757114648819
current test mse: 0.055898
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 3521, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.40240973234176636
loss_pred:0.035915255546569824, decouple_loss:0.00898214802145958
The generated pressure mean: 0.4045710265636444
loss_pred:0.03449749946594238, decouple_loss:0.009306474588811398
The generated pressure mean: 0.4030909538269043
loss_pred:0.03507918864488602, decouple_loss:0.008958318270742893
Iteration: 3522, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4622328281402588
The generated pressure mean: 0.46335944533348083
loss_pred:0.03315543383359909, decouple_loss:0.010769682936370373
loss_pred:0.03467028960585594, decouple_loss:0.0111355260014534
The generated pressure mean: 0.4626273810863495
loss_pred:0.03402316942811012, decouple_loss:0.010606718249619007
Iteration: 3523, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4825568199157715
loss_pred:0.03365307301282883, decouple_loss:0.009529324248433113
The generated pressure mean: 0.48441454768180847
loss_pred:0.03495020046830177, decouple_loss:0.010300110094249249
The generated pressure mean: 0.479107528924942
loss_pred:0.036017779260873795, decouple_loss:0.009166287258267403
Iteration: 3524, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42223602533340454
The generated pressure mean: 0.4263257086277008
loss_pred:0.03433859348297119, decouple_loss:0.011193324811756611
loss_pred:0.035031065344810486, decouple_loss:0.010761034674942493
The generated pressure mean: 0.4273698329925537
loss_pred:0.03293989971280098, decouple_loss:0.010363945737481117
Iteration: 3525, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4317608177661896
loss_pred:0.03372306376695633, decouple_loss:0.010439620353281498
The generated pressure mean: 0.4300583004951477
loss_pred:0.03423435986042023, decouple_loss:0.010402579791843891
The generated pressure mean: 0.43379080295562744
loss_pred:0.033780939877033234, decouple_loss:0.010701497085392475
Iteration: 3526, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4604625701904297
The generated pressure mean: 0.464079350233078
loss_pred:0.03371189907193184, decouple_loss:0.00924858171492815
loss_pred:0.03303075581789017, decouple_loss:0.009140575304627419
The generated pressure mean: 0.46409550309181213
loss_pred:0.03211117908358574, decouple_loss:0.008938350714743137
Iteration: 3527, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45835813879966736
loss_pred:0.03365054354071617, decouple_loss:0.008839401416480541
The generated pressure mean: 0.4600600302219391
loss_pred:0.03325365111231804, decouple_loss:0.009068324230611324
The generated pressure mean: 0.46319395303726196
loss_pred:0.032652970403432846, decouple_loss:0.008813013322651386
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3528, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43680962920188904
The generated pressure mean: 0.4329463839530945
loss_pred:0.032573577016592026, decouple_loss:0.00879526324570179
loss_pred:0.032915085554122925, decouple_loss:0.008996267803013325
The generated pressure mean: 0.43650293350219727
loss_pred:0.034042131155729294, decouple_loss:0.008919750340282917
Iteration: 3529, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4292981028556824The generated pressure mean: 0.42945536971092224
loss_pred:0.03322652354836464, decouple_loss:0.009418600238859653loss_pred:0.03384916111826897, decouple_loss:0.009889050386846066
The generated pressure mean: 0.42628300189971924
loss_pred:0.03380903601646423, decouple_loss:0.00954041164368391
Iteration: 3530, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4550757110118866
loss_pred:0.034826699644327164, decouple_loss:0.008116061799228191
The generated pressure mean: 0.45701152086257935
loss_pred:0.033269643783569336, decouple_loss:0.008158796466886997
The generated pressure mean: 0.45701128244400024
loss_pred:0.03364298492670059, decouple_loss:0.008458542637526989
2023-04-17 01:22:09 testing...
The generated pressure mean: 0.4089563190937042
The generated pressure mean: 0.4116626977920532
The generated pressure mean: 0.41291290521621704
loss_pred:0.046087928116321564, decouple_loss:0.010372364893555641
loss_pred:0.04516381770372391, decouple_loss:0.010596400126814842
loss_pred:0.04519018530845642, decouple_loss:0.010665146633982658
WV_0_PC_0_EH_1_PS_40, loss: 0.046007879078388214, avg_mse: 0.057836633175611496
current test mse: 0.057837
Iteration: 3531, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4725136458873749
loss_pred:0.033630046993494034, decouple_loss:0.009651717729866505
The generated pressure mean: 0.475278377532959
loss_pred:0.03411942720413208, decouple_loss:0.009575482457876205
The generated pressure mean: 0.47103071212768555
loss_pred:0.03330565616488457, decouple_loss:0.009072727523744106
Iteration: 3532, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43131279945373535
loss_pred:0.03301111236214638, decouple_loss:0.012935291975736618
The generated pressure mean: 0.43020859360694885
loss_pred:0.033573299646377563, decouple_loss:0.012965884059667587
The generated pressure mean: 0.4327695369720459
loss_pred:0.03446429595351219, decouple_loss:0.013014689087867737
Iteration: 3533, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4312051832675934
loss_pred:0.03377111256122589, decouple_loss:0.010203156620264053
The generated pressure mean: 0.4321429431438446
loss_pred:0.03241000697016716, decouple_loss:0.009751816280186176
The generated pressure mean: 0.4316208064556122
loss_pred:0.03336041420698166, decouple_loss:0.009822584688663483
Iteration: 3534, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4657297432422638
loss_pred:0.031195014715194702, decouple_loss:0.013828020542860031
The generated pressure mean: 0.4653398096561432
loss_pred:0.03375769779086113, decouple_loss:0.014339154586195946
The generated pressure mean: 0.4658670723438263
loss_pred:0.034452106803655624, decouple_loss:0.01419112365692854
Iteration: 3535, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4372732937335968
loss_pred:0.033248841762542725, decouple_loss:0.012109578587114811
The generated pressure mean: 0.43992936611175537
loss_pred:0.033797673881053925, decouple_loss:0.012096458114683628
The generated pressure mean: 0.43641844391822815
loss_pred:0.03366537019610405, decouple_loss:0.012361878529191017
Iteration: 3536, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47113075852394104
loss_pred:0.03254064545035362, decouple_loss:0.012368053197860718
The generated pressure mean: 0.47379088401794434
loss_pred:0.032783687114715576, decouple_loss:0.012279298156499863
The generated pressure mean: 0.4731277525424957
loss_pred:0.036450352519750595, decouple_loss:0.012194130569696426
Iteration: 3537, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4348030984401703
loss_pred:0.03312661498785019, decouple_loss:0.011861528269946575
The generated pressure mean: 0.4354967176914215
loss_pred:0.034206323325634, decouple_loss:0.011616521514952183
The generated pressure mean: 0.4341231882572174
loss_pred:0.03237996995449066, decouple_loss:0.01196312252432108
Iteration: 3538, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42980143427848816
loss_pred:0.03379911929368973, decouple_loss:0.010568848811089993
The generated pressure mean: 0.4295113682746887
loss_pred:0.03220681846141815, decouple_loss:0.010701779276132584
The generated pressure mean: 0.4284907877445221
loss_pred:0.03221970051527023, decouple_loss:0.011054747737944126
Iteration: 3539, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4627014398574829
loss_pred:0.03428934887051582, decouple_loss:0.011003057472407818
The generated pressure mean: 0.4645482003688812
loss_pred:0.03327525034546852, decouple_loss:0.011025805957615376
The generated pressure mean: 0.46133267879486084
loss_pred:0.031266745179891586, decouple_loss:0.011168568395078182
Iteration: 3540, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442881941795349
loss_pred:0.03392377495765686, decouple_loss:0.010497019626200199
The generated pressure mean: 0.44146859645843506
loss_pred:0.03290925174951553, decouple_loss:0.010926824994385242
The generated pressure mean: 0.44324803352355957
loss_pred:0.033958643674850464, decouple_loss:0.010536609217524529
2023-04-17 01:24:03 testing...
The generated pressure mean: 0.41456568241119385
The generated pressure mean: 0.4169620871543884
The generated pressure mean: 0.4183257818222046
loss_pred:0.04562339931726456, decouple_loss:0.010869679972529411
loss_pred:0.04466823861002922, decouple_loss:0.01096601877361536
loss_pred:0.044649992138147354, decouple_loss:0.010862375609576702
WV_0_PC_0_EH_1_PS_40, loss: 0.04552551358938217, avg_mse: 0.05683080106973648
current test mse: 0.056831
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 3541, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463501274585724
loss_pred:0.03338412940502167, decouple_loss:0.011051174253225327
The generated pressure mean: 0.44862812757492065
loss_pred:0.033079780638217926, decouple_loss:0.011032654903829098
The generated pressure mean: 0.44650697708129883
loss_pred:0.03198721259832382, decouple_loss:0.010448488406836987
Iteration: 3542, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4605455696582794
loss_pred:0.030955880880355835, decouple_loss:0.010023818351328373
The generated pressure mean: 0.45721447467803955
loss_pred:0.03275756537914276, decouple_loss:0.01006999984383583
The generated pressure mean: 0.4585013687610626
loss_pred:0.03382996842265129, decouple_loss:0.010511131025850773
Iteration: 3543, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42959097027778625
loss_pred:0.03382456302642822, decouple_loss:0.011589044705033302
The generated pressure mean: 0.4311249554157257
loss_pred:0.03219021111726761, decouple_loss:0.01097213663160801
The generated pressure mean: 0.43166184425354004
loss_pred:0.032108329236507416, decouple_loss:0.011045734398066998
Iteration: 3544, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4413304626941681
loss_pred:0.03384476155042648, decouple_loss:0.00888119451701641
The generated pressure mean: 0.44047558307647705
loss_pred:0.03311432525515556, decouple_loss:0.008872048929333687
The generated pressure mean: 0.44386059045791626
loss_pred:0.03235546499490738, decouple_loss:0.008990452624857426
Iteration: 3545, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4573303759098053
loss_pred:0.03209351375699043, decouple_loss:0.010309568606317043
The generated pressure mean: 0.4526832699775696
loss_pred:0.032886143773794174, decouple_loss:0.008829900063574314
The generated pressure mean: 0.45105764269828796
loss_pred:0.0322398766875267, decouple_loss:0.009215807542204857
Iteration: 3546, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4509775638580322
loss_pred:0.03156603127717972, decouple_loss:0.009334754198789597
The generated pressure mean: 0.4471582770347595
loss_pred:0.033512506633996964, decouple_loss:0.00986183900386095
The generated pressure mean: 0.44655635952949524
loss_pred:0.03300399333238602, decouple_loss:0.009773049503564835
Iteration: 3547, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4648300111293793
loss_pred:0.03321193531155586, decouple_loss:0.007895313203334808
The generated pressure mean: 0.46347305178642273
loss_pred:0.03147557005286217, decouple_loss:0.0076211499981582165
The generated pressure mean: 0.46255621314048767
loss_pred:0.03323490172624588, decouple_loss:0.007809875067323446
Iteration: 3548, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.41853323578834534
loss_pred:0.03187829628586769, decouple_loss:0.008402555249631405
The generated pressure mean: 0.4186905026435852
loss_pred:0.03157607093453407, decouple_loss:0.008265813812613487
The generated pressure mean: 0.42248469591140747
loss_pred:0.03324867784976959, decouple_loss:0.008262245915830135
Iteration: 3549, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447671502828598
loss_pred:0.03256084769964218, decouple_loss:0.00938346330076456
The generated pressure mean: 0.4454003870487213
loss_pred:0.03302087262272835, decouple_loss:0.009286191314458847
The generated pressure mean: 0.4475635588169098
loss_pred:0.031240252777934074, decouple_loss:0.010203927755355835
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3550, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46973758935928345
loss_pred:0.03267938271164894, decouple_loss:0.009911030530929565
The generated pressure mean: 0.47961217164993286
loss_pred:0.03399385139346123, decouple_loss:0.010237711481750011
The generated pressure mean: 0.47491857409477234
loss_pred:0.031475141644477844, decouple_loss:0.009543842636048794
2023-04-17 01:26:33 testing...
The generated pressure mean: 0.4252350628376007
The generated pressure mean: 0.42850279808044434
The generated pressure mean: 0.43022459745407104
loss_pred:0.04538901522755623, decouple_loss:0.011641663499176502
loss_pred:0.04457421973347664, decouple_loss:0.011954635381698608
loss_pred:0.04435065761208534, decouple_loss:0.012031781487166882
WV_0_PC_0_EH_1_PS_40, loss: 0.0453651025891304, avg_mse: 0.057293906807899475
current test mse: 0.057294
Iteration: 3551, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4140659272670746
loss_pred:0.033592451363801956, decouple_loss:0.010905367322266102
The generated pressure mean: 0.4124516248703003
loss_pred:0.031902313232421875, decouple_loss:0.009695828892290592
The generated pressure mean: 0.41439640522003174
loss_pred:0.0330231711268425, decouple_loss:0.010291350074112415
Iteration: 3552, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45171764492988586
The generated pressure mean: 0.4503255784511566
loss_pred:0.030651206150650978, decouple_loss:0.012207386083900928
loss_pred:0.03440551087260246, decouple_loss:0.012108850292861462
The generated pressure mean: 0.4504759609699249
loss_pred:0.03260216861963272, decouple_loss:0.012114224955439568
Iteration: 3553, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47695136070251465
loss_pred:0.03279925510287285, decouple_loss:0.011836512945592403
The generated pressure mean: 0.47288063168525696
loss_pred:0.0314796008169651, decouple_loss:0.011423132382333279
The generated pressure mean: 0.4756185710430145
loss_pred:0.03229451924562454, decouple_loss:0.011811177246272564
Iteration: 3554, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4404821991920471
loss_pred:0.03293602168560028, decouple_loss:0.012033147737383842
The generated pressure mean: 0.4392455220222473
loss_pred:0.03178766742348671, decouple_loss:0.012846755795180798
The generated pressure mean: 0.43605005741119385
loss_pred:0.032288335263729095, decouple_loss:0.012841789983212948
Iteration: 3555, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.41340723633766174
The generated pressure mean: 0.413130521774292
loss_pred:0.030713681131601334, decouple_loss:0.009940014220774174
loss_pred:0.03197028115391731, decouple_loss:0.010363789275288582
The generated pressure mean: 0.4145829379558563
loss_pred:0.03222665190696716, decouple_loss:0.009903758764266968
Iteration: 3556, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4593932330608368
loss_pred:0.03177698329091072, decouple_loss:0.013320288620889187
The generated pressure mean: 0.46297183632850647
loss_pred:0.03252477943897247, decouple_loss:0.013707533478736877
The generated pressure mean: 0.45939281582832336
loss_pred:0.03156232461333275, decouple_loss:0.013608348555862904
Iteration: 3557, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4627310335636139
The generated pressure mean: 0.4612377882003784
loss_pred:0.032733287662267685, decouple_loss:0.011501000262796879
loss_pred:0.03128279373049736, decouple_loss:0.010859344154596329
The generated pressure mean: 0.46571993827819824
loss_pred:0.0294980276376009, decouple_loss:0.010976364836096764
Iteration: 3558, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4361591339111328
The generated pressure mean: 0.4337179958820343
loss_pred:0.031200209632515907, decouple_loss:0.01158643513917923
loss_pred:0.03343731909990311, decouple_loss:0.01192241907119751
The generated pressure mean: 0.4340723752975464
loss_pred:0.032019492238759995, decouple_loss:0.01185902114957571
Iteration: 3559, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43995726108551025
The generated pressure mean: 0.4392489790916443
loss_pred:0.029682373628020287, decouple_loss:0.011824328452348709
loss_pred:0.0326894074678421, decouple_loss:0.011928907595574856
The generated pressure mean: 0.4387127757072449
loss_pred:0.031815748661756516, decouple_loss:0.011663414537906647
Iteration: 3560, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44619300961494446
The generated pressure mean: 0.4492897391319275
loss_pred:0.03126225247979164, decouple_loss:0.01024723146110773
loss_pred:0.02948540635406971, decouple_loss:0.010640998370945454
The generated pressure mean: 0.4469788074493408
loss_pred:0.03162842243909836, decouple_loss:0.010607130825519562
2023-04-17 01:28:27 testing...
The generated pressure mean: 0.4195653796195984
The generated pressure mean: 0.4160974323749542
loss_pred:0.04378564655780792, decouple_loss:0.012963563203811646
The generated pressure mean: 0.4212900698184967
loss_pred:0.04488968849182129, decouple_loss:0.012527493759989738
loss_pred:0.04370362311601639, decouple_loss:0.013035980984568596
WV_0_PC_0_EH_1_PS_40, loss: 0.04476843401789665, avg_mse: 0.05685651674866676
current test mse: 0.056857
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 3561, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4453881084918976
loss_pred:0.03110653907060623, decouple_loss:0.011598674580454826
The generated pressure mean: 0.45188820362091064
loss_pred:0.03161441907286644, decouple_loss:0.0112466374412179
The generated pressure mean: 0.44953665137290955
loss_pred:0.032318100333213806, decouple_loss:0.011945400387048721
Iteration: 3562, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4521762728691101
loss_pred:0.03220658376812935, decouple_loss:0.0106668034568429
The generated pressure mean: 0.4451104998588562
loss_pred:0.03119322471320629, decouple_loss:0.010600384324789047
The generated pressure mean: 0.44586578011512756
loss_pred:0.03369205817580223, decouple_loss:0.011003713123500347
Iteration: 3563, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45089563727378845
The generated pressure mean: 0.45497870445251465
loss_pred:0.033578045666217804, decouple_loss:0.00981371570378542
loss_pred:0.03487497940659523, decouple_loss:0.010285535827279091
The generated pressure mean: 0.455335795879364
loss_pred:0.03337365388870239, decouple_loss:0.010052960366010666
Iteration: 3564, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42979195713996887
The generated pressure mean: 0.42840245366096497
loss_pred:0.0378812700510025, decouple_loss:0.011353692971169949
loss_pred:0.03184891492128372, decouple_loss:0.011072622612118721
The generated pressure mean: 0.4311463534832001
loss_pred:0.03164241462945938, decouple_loss:0.010873799212276936
Iteration: 3565, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45758944749832153
The generated pressure mean: 0.4588842988014221
loss_pred:0.03329242020845413, decouple_loss:0.012067182920873165
loss_pred:0.034679219126701355, decouple_loss:0.011705407872796059
The generated pressure mean: 0.45773473381996155
loss_pred:0.03243641182780266, decouple_loss:0.01179905328899622
Iteration: 3566, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4407084882259369
The generated pressure mean: 0.4409619867801666
loss_pred:0.03354419767856598, decouple_loss:0.008346439339220524
loss_pred:0.0323171429336071, decouple_loss:0.008265752345323563
The generated pressure mean: 0.4443177282810211
loss_pred:0.032647762447595596, decouple_loss:0.008333827368915081
Iteration: 3567, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43791767954826355
The generated pressure mean: 0.43827542662620544
loss_pred:0.03477342426776886, decouple_loss:0.010841695591807365
The generated pressure mean: 0.43642932176589966loss_pred:0.03322991356253624, decouple_loss:0.009464102797210217
loss_pred:0.034238629043102264, decouple_loss:0.009642341174185276
Iteration: 3568, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4809668958187103
loss_pred:0.0337461493909359, decouple_loss:0.012429283000528812
The generated pressure mean: 0.4862852394580841
The generated pressure mean: 0.47787153720855713
loss_pred:0.03396620228886604, decouple_loss:0.013280059210956097
loss_pred:0.033981017768383026, decouple_loss:0.012024902738630772
Iteration: 3569, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4276600778102875
loss_pred:0.032887283712625504, decouple_loss:0.008971506729722023
The generated pressure mean: 0.43024808168411255
loss_pred:0.032849229872226715, decouple_loss:0.009453903883695602
The generated pressure mean: 0.43087100982666016
loss_pred:0.03270436078310013, decouple_loss:0.009037268348038197
Iteration: 3570, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4333644509315491
loss_pred:0.03342960774898529, decouple_loss:0.012248879298567772
The generated pressure mean: 0.43143430352211
The generated pressure mean: 0.43338489532470703
loss_pred:0.033166371285915375, decouple_loss:0.013392350636422634
loss_pred:0.03274305537343025, decouple_loss:0.011901646852493286
2023-04-17 01:30:56 testing...
The generated pressure mean: 0.4089566767215729
The generated pressure mean: 0.4122285544872284
The generated pressure mean: 0.41491422057151794
loss_pred:0.04741210490465164, decouple_loss:0.01139406580477953
loss_pred:0.04586297646164894, decouple_loss:0.011731555685400963
loss_pred:0.04577307403087616, decouple_loss:0.011630254797637463
WV_0_PC_0_EH_1_PS_40, loss: 0.04692865163087845, avg_mse: 0.06117453798651695
current test mse: 0.061175
Iteration: 3571, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4763064980506897
loss_pred:0.031814415007829666, decouple_loss:0.010568146593868732
The generated pressure mean: 0.4739822447299957
loss_pred:0.033519502729177475, decouple_loss:0.0105294706299901
The generated pressure mean: 0.4816454350948334
loss_pred:0.034263454377651215, decouple_loss:0.01111286599189043
Iteration: 3572, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44089147448539734
loss_pred:0.03256090730428696, decouple_loss:0.013259145431220531
The generated pressure mean: 0.4429389238357544
loss_pred:0.033896803855895996, decouple_loss:0.013932726345956326
The generated pressure mean: 0.442668080329895
loss_pred:0.03150150552392006, decouple_loss:0.01302087027579546
Iteration: 3573, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4259262681007385
loss_pred:0.032770030200481415, decouple_loss:0.011725405231118202
The generated pressure mean: 0.4316920340061188
loss_pred:0.03182389587163925, decouple_loss:0.011622114107012749
The generated pressure mean: 0.4297107458114624
loss_pred:0.032578300684690475, decouple_loss:0.011384750716388226
Iteration: 3574, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46197590231895447
The generated pressure mean: 0.45892995595932007
loss_pred:0.032996173948049545, decouple_loss:0.01004984974861145
loss_pred:0.03212651237845421, decouple_loss:0.0108041325584054
The generated pressure mean: 0.4646224081516266
loss_pred:0.0336788184940815, decouple_loss:0.010177618823945522
Iteration: 3575, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499320387840271
The generated pressure mean: 0.44580334424972534
loss_pred:0.032611098140478134, decouple_loss:0.013958434574306011
loss_pred:0.031795043498277664, decouple_loss:0.013377970084547997
The generated pressure mean: 0.44327548146247864
loss_pred:0.030700676143169403, decouple_loss:0.013199473731219769
Iteration: 3576, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4398854970932007
The generated pressure mean: 0.4457295536994934
loss_pred:0.03298107162117958, decouple_loss:0.010545709170401096
loss_pred:0.033826325088739395, decouple_loss:0.010703778825700283
The generated pressure mean: 0.44495323300361633
loss_pred:0.032160621136426926, decouple_loss:0.010723724961280823
Iteration: 3577, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4644056260585785
The generated pressure mean: 0.4676975905895233
loss_pred:0.03273935616016388, decouple_loss:0.014536413364112377
loss_pred:0.033520206809043884, decouple_loss:0.014419620856642723
The generated pressure mean: 0.4618975818157196
loss_pred:0.032352425158023834, decouple_loss:0.014323102310299873
Iteration: 3578, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4279962182044983
loss_pred:0.031776923686265945, decouple_loss:0.012361838482320309
The generated pressure mean: 0.4276004135608673
loss_pred:0.03388230875134468, decouple_loss:0.012515892274677753
The generated pressure mean: 0.4262504279613495
loss_pred:0.03186401352286339, decouple_loss:0.012200282886624336
Iteration: 3579, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467832148075104
loss_pred:0.03237025812268257, decouple_loss:0.01638242043554783
The generated pressure mean: 0.4466072618961334
loss_pred:0.032222092151641846, decouple_loss:0.015973012894392014
The generated pressure mean: 0.4465879499912262
loss_pred:0.03252539783716202, decouple_loss:0.016093244776129723
Iteration: 3580, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4729495644569397
loss_pred:0.03403126820921898, decouple_loss:0.012242117896676064
The generated pressure mean: 0.4726555645465851
loss_pred:0.03257933259010315, decouple_loss:0.01231741439551115
The generated pressure mean: 0.4741305708885193
loss_pred:0.032831043004989624, decouple_loss:0.012170132249593735
2023-04-17 01:32:50 testing...
The generated pressure mean: 0.4279208183288574
The generated pressure mean: 0.424263596534729
The generated pressure mean: 0.42953255772590637
loss_pred:0.04412185400724411, decouple_loss:0.017066149041056633
loss_pred:0.04514298588037491, decouple_loss:0.017025701701641083
loss_pred:0.0437895841896534, decouple_loss:0.0172418262809515
WV_0_PC_0_EH_1_PS_40, loss: 0.045207034796476364, avg_mse: 0.05726723372936249
current test mse: 0.057267
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
Iteration: 3581, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.41484636068344116
loss_pred:0.033070214092731476, decouple_loss:0.016929103061556816
The generated pressure mean: 0.4201052486896515
The generated pressure mean: 0.4165227711200714
loss_pred:0.03241242840886116, decouple_loss:0.016783714294433594
loss_pred:0.03475736081600189, decouple_loss:0.0167104359716177
Iteration: 3582, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4429803490638733
The generated pressure mean: 0.44750720262527466
loss_pred:0.034506481140851974, decouple_loss:0.012180634774267673
loss_pred:0.032638393342494965, decouple_loss:0.012020295485854149
The generated pressure mean: 0.44344669580459595
loss_pred:0.03242585062980652, decouple_loss:0.012400035746395588
Iteration: 3583, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4735002815723419
The generated pressure mean: 0.47344642877578735
loss_pred:0.03242366015911102, decouple_loss:0.014054475352168083
loss_pred:0.03337223082780838, decouple_loss:0.01517337467521429
The generated pressure mean: 0.4706360697746277
loss_pred:0.0336863212287426, decouple_loss:0.014905916526913643
Iteration: 3584, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4373742640018463
The generated pressure mean: 0.43668752908706665
loss_pred:0.032672327011823654, decouple_loss:0.01104645524173975
loss_pred:0.03318164125084877, decouple_loss:0.011294420808553696
The generated pressure mean: 0.43400371074676514
loss_pred:0.032728876918554306, decouple_loss:0.01093339268118143
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3585, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42214763164520264
The generated pressure mean: 0.4261428415775299
loss_pred:0.03266764059662819, decouple_loss:0.011298870667815208
loss_pred:0.03362785279750824, decouple_loss:0.01131865382194519
The generated pressure mean: 0.4187833368778229
loss_pred:0.03280974179506302, decouple_loss:0.01119945663958788
Iteration: 3586, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45922356843948364
The generated pressure mean: 0.46199503540992737
loss_pred:0.03208409249782562, decouple_loss:0.011851396411657333
loss_pred:0.03187086433172226, decouple_loss:0.011188926175236702
The generated pressure mean: 0.46297478675842285
loss_pred:0.033106729388237, decouple_loss:0.01107584498822689
Iteration: 3587, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4664813280105591
The generated pressure mean: 0.46399229764938354
loss_pred:0.033767081797122955, decouple_loss:0.009591637179255486
loss_pred:0.032265517860651016, decouple_loss:0.009515322744846344
The generated pressure mean: 0.46410730481147766
loss_pred:0.03395410627126694, decouple_loss:0.00987882912158966
Iteration: 3588, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4257600009441376
loss_pred:0.03376869857311249, decouple_loss:0.010019002482295036
The generated pressure mean: 0.4220897853374481
loss_pred:0.032366570085287094, decouple_loss:0.009816010482609272
The generated pressure mean: 0.42848601937294006
loss_pred:0.03186913952231407, decouple_loss:0.01002180390059948
Iteration: 3589, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4385049045085907
loss_pred:0.03364952281117439, decouple_loss:0.012026352807879448
The generated pressure mean: 0.4408514201641083
loss_pred:0.03189728781580925, decouple_loss:0.012316178530454636
The generated pressure mean: 0.44397255778312683
loss_pred:0.03212912008166313, decouple_loss:0.01229803916066885
Iteration: 3590, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4534545838832855
loss_pred:0.03137339651584625, decouple_loss:0.009942966513335705
The generated pressure mean: 0.45163631439208984
loss_pred:0.034001875668764114, decouple_loss:0.008822509087622166
The generated pressure mean: 0.4525948166847229
loss_pred:0.03164197877049446, decouple_loss:0.009339451789855957
2023-04-17 01:35:21 testing...
The generated pressure mean: 0.4150334894657135
The generated pressure mean: 0.41852515935897827
loss_pred:0.043844252824783325, decouple_loss:0.012517042458057404
The generated pressure mean: 0.4202255308628082
loss_pred:0.043019358068704605, decouple_loss:0.01269979402422905
loss_pred:0.04285524785518646, decouple_loss:0.01265779696404934
WV_0_PC_0_EH_1_PS_40, loss: 0.04387086629867554, avg_mse: 0.05605355277657509
current test mse: 0.056054
Iteration: 3591, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44879552721977234
loss_pred:0.03250029310584068, decouple_loss:0.012550919316709042
The generated pressure mean: 0.4492266774177551
loss_pred:0.03314670920372009, decouple_loss:0.012650989927351475
The generated pressure mean: 0.44789910316467285
loss_pred:0.031573280692100525, decouple_loss:0.012691082432866096
Iteration: 3592, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4420104920864105
loss_pred:0.030675671994686127, decouple_loss:0.008937719278037548
The generated pressure mean: 0.4420299828052521
loss_pred:0.03212501481175423, decouple_loss:0.008576630614697933
The generated pressure mean: 0.43933790922164917
loss_pred:0.03360160440206528, decouple_loss:0.008870611898601055
Iteration: 3593, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44457486271858215
loss_pred:0.03171774744987488, decouple_loss:0.012345838360488415
The generated pressure mean: 0.4463999569416046
loss_pred:0.03194096311926842, decouple_loss:0.012322435155510902
The generated pressure mean: 0.4464372992515564
loss_pred:0.03194332495331764, decouple_loss:0.01199487503618002
Iteration: 3594, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4546504020690918
loss_pred:0.03145430609583855, decouple_loss:0.010338682681322098
The generated pressure mean: 0.4550376832485199
loss_pred:0.030033348128199577, decouple_loss:0.010278931818902493
The generated pressure mean: 0.45674988627433777
loss_pred:0.034136686474084854, decouple_loss:0.010016708634793758
Iteration: 3595, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44635388255119324
loss_pred:0.03179415687918663, decouple_loss:0.010598274879157543
The generated pressure mean: 0.44236502051353455
loss_pred:0.030923614278435707, decouple_loss:0.010166550055146217
The generated pressure mean: 0.4429018497467041
loss_pred:0.03200671449303627, decouple_loss:0.010470106266438961
Iteration: 3596, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.430573970079422
loss_pred:0.031409040093421936, decouple_loss:0.008988851681351662
The generated pressure mean: 0.42730727791786194
loss_pred:0.030864544212818146, decouple_loss:0.009053818881511688
The generated pressure mean: 0.4301178753376007
loss_pred:0.031714264303445816, decouple_loss:0.009314189665019512
Iteration: 3597, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4574178457260132
loss_pred:0.03073015995323658, decouple_loss:0.011648613028228283
The generated pressure mean: 0.46102669835090637
loss_pred:0.033826783299446106, decouple_loss:0.01175663247704506
The generated pressure mean: 0.4564761221408844
loss_pred:0.03274407237768173, decouple_loss:0.011813433840870857
Iteration: 3598, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44879966974258423
loss_pred:0.03209715336561203, decouple_loss:0.009665832854807377
The generated pressure mean: 0.4472525119781494
loss_pred:0.03229445219039917, decouple_loss:0.010442785918712616
The generated pressure mean: 0.4457453489303589
loss_pred:0.03090234100818634, decouple_loss:0.009908598847687244
Iteration: 3599, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4530794024467468
loss_pred:0.03301597386598587, decouple_loss:0.011943643912672997
The generated pressure mean: 0.4499954879283905
loss_pred:0.032226648181676865, decouple_loss:0.012077771127223969
The generated pressure mean: 0.44816362857818604
loss_pred:0.031109871342778206, decouple_loss:0.012017120607197285
Iteration: 3600, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4369317293167114
loss_pred:0.03093767538666725, decouple_loss:0.01046185102313757
The generated pressure mean: 0.43696144223213196
loss_pred:0.034841664135456085, decouple_loss:0.010606439784169197
The generated pressure mean: 0.4363614022731781
loss_pred:0.0306849367916584, decouple_loss:0.010460157878696918
2023-04-17 01:37:15 testing...
The generated pressure mean: 0.41733938455581665
The generated pressure mean: 0.4204091727733612
The generated pressure mean: 0.4227049946784973
loss_pred:0.04438730329275131, decouple_loss:0.012056823819875717
loss_pred:0.043997809290885925, decouple_loss:0.012546234764158726
loss_pred:0.04410896077752113, decouple_loss:0.012490630149841309
WV_0_PC_0_EH_1_PS_40, loss: 0.04478291794657707, avg_mse: 0.05810496211051941
current test mse: 0.058105
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 3601, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4445839524269104
loss_pred:0.03203874081373215, decouple_loss:0.012169103138148785
The generated pressure mean: 0.44435104727745056
loss_pred:0.03141412138938904, decouple_loss:0.011885074898600578
The generated pressure mean: 0.4392748773097992
loss_pred:0.03241580352187157, decouple_loss:0.01130720879882574
Iteration: 3602, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488059878349304
The generated pressure mean: 0.4496905207633972
loss_pred:0.03107576072216034, decouple_loss:0.01187337376177311
loss_pred:0.031059805303812027, decouple_loss:0.011965601705014706
The generated pressure mean: 0.4495171904563904
loss_pred:0.033190079033374786, decouple_loss:0.01222720742225647
Iteration: 3603, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44016319513320923
The generated pressure mean: 0.44045984745025635
loss_pred:0.033873300999403, decouple_loss:0.010025860741734505
loss_pred:0.0328732505440712, decouple_loss:0.009652681648731232
The generated pressure mean: 0.44032078981399536
loss_pred:0.031553518027067184, decouple_loss:0.009266732260584831
Iteration: 3604, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.457919716835022
The generated pressure mean: 0.4630908668041229
loss_pred:0.03315788134932518, decouple_loss:0.010789570398628712
loss_pred:0.033845048397779465, decouple_loss:0.01154070720076561
The generated pressure mean: 0.45771467685699463
loss_pred:0.03247949853539467, decouple_loss:0.011442102491855621
Iteration: 3605, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44563359022140503
The generated pressure mean: 0.44877976179122925
loss_pred:0.03147325664758682, decouple_loss:0.011290613561868668
loss_pred:0.03254721686244011, decouple_loss:0.011333003640174866
The generated pressure mean: 0.44443580508232117
loss_pred:0.032062750309705734, decouple_loss:0.011693030595779419
Iteration: 3606, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43562212586402893The generated pressure mean: 0.4367114305496216
loss_pred:0.03403129056096077, decouple_loss:0.009866354987025261
loss_pred:0.031979117542505264, decouple_loss:0.010166806168854237
The generated pressure mean: 0.4353308081626892
loss_pred:0.03199206292629242, decouple_loss:0.009432961232960224
Iteration: 3607, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507042169570923
The generated pressure mean: 0.4521009027957916
loss_pred:0.03255107253789902, decouple_loss:0.013167613185942173
loss_pred:0.03071483038365841, decouple_loss:0.01298031397163868
The generated pressure mean: 0.4516785740852356
loss_pred:0.03351027891039848, decouple_loss:0.012825407087802887
Iteration: 3608, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4445660412311554
loss_pred:0.03076886013150215, decouple_loss:0.009904738515615463
The generated pressure mean: 0.4423593282699585
loss_pred:0.03274770826101303, decouple_loss:0.010438208468258381
The generated pressure mean: 0.44504162669181824
loss_pred:0.03315887972712517, decouple_loss:0.010498872958123684
Iteration: 3609, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4592305123806
loss_pred:0.031269825994968414, decouple_loss:0.01202467828989029
The generated pressure mean: 0.46160492300987244
loss_pred:0.03201206400990486, decouple_loss:0.012898593209683895
The generated pressure mean: 0.45897558331489563
loss_pred:0.03263574838638306, decouple_loss:0.01302205678075552
Iteration: 3610, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44197672605514526
loss_pred:0.030652636662125587, decouple_loss:0.011309204623103142
The generated pressure mean: 0.4446253776550293
loss_pred:0.03431030362844467, decouple_loss:0.012004968710243702
The generated pressure mean: 0.4425223767757416
loss_pred:0.03187202662229538, decouple_loss:0.011163330636918545
2023-04-17 01:39:44 testing...
The generated pressure mean: 0.42275017499923706
The generated pressure mean: 0.4271206557750702
loss_pred:0.04432550445199013, decouple_loss:0.011970475316047668
The generated pressure mean: 0.4295344054698944
loss_pred:0.043240223079919815, decouple_loss:0.012185897678136826
loss_pred:0.04354541748762131, decouple_loss:0.012352117337286472
WV_0_PC_0_EH_1_PS_40, loss: 0.044312190264463425, avg_mse: 0.05736824497580528
current test mse: 0.057368
Iteration: 3611, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4315732717514038
loss_pred:0.03130575641989708, decouple_loss:0.011423707008361816
The generated pressure mean: 0.43570029735565186
loss_pred:0.03246913105249405, decouple_loss:0.010435370728373528
The generated pressure mean: 0.4336245059967041
loss_pred:0.032528914511203766, decouple_loss:0.010893844068050385
Iteration: 3612, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47046995162963867
loss_pred:0.03324439376592636, decouple_loss:0.011121859773993492
The generated pressure mean: 0.46857479214668274
loss_pred:0.033082909882068634, decouple_loss:0.010799121111631393
The generated pressure mean: 0.46830856800079346
loss_pred:0.03140236437320709, decouple_loss:0.010840985924005508
Iteration: 3613, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4356389343738556
The generated pressure mean: 0.4352235794067383
loss_pred:0.031617920845746994, decouple_loss:0.011863657273352146
loss_pred:0.03194767236709595, decouple_loss:0.01258515752851963
The generated pressure mean: 0.4376480281352997
loss_pred:0.032198574393987656, decouple_loss:0.012892925180494785
Iteration: 3614, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44093945622444153
loss_pred:0.03346718102693558, decouple_loss:0.008749057538807392
The generated pressure mean: 0.4404798746109009
loss_pred:0.031903449445962906, decouple_loss:0.008593139238655567
The generated pressure mean: 0.4425133466720581
loss_pred:0.03326239064335823, decouple_loss:0.008794235996901989
Iteration: 3615, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45551905035972595
loss_pred:0.02989380992949009, decouple_loss:0.011772672645747662
The generated pressure mean: 0.4511200189590454
loss_pred:0.031210128217935562, decouple_loss:0.012097330763936043
The generated pressure mean: 0.45281070470809937
loss_pred:0.030112940818071365, decouple_loss:0.011422326788306236
Iteration: 3616, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45833712816238403
The generated pressure mean: 0.45078805088996887
loss_pred:0.03203292563557625, decouple_loss:0.010445834137499332
loss_pred:0.03249158710241318, decouple_loss:0.010160468518733978
The generated pressure mean: 0.45144620537757874
loss_pred:0.031717732548713684, decouple_loss:0.010469946078956127
Iteration: 3617, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45429015159606934
loss_pred:0.030492739751935005, decouple_loss:0.010846114717423916
The generated pressure mean: 0.45584040880203247
loss_pred:0.03175509348511696, decouple_loss:0.011178470216691494
The generated pressure mean: 0.45318397879600525
loss_pred:0.030466889962553978, decouple_loss:0.01081380620598793
Iteration: 3618, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4352238178253174
loss_pred:0.03158780187368393, decouple_loss:0.011694463901221752
The generated pressure mean: 0.4307360351085663
loss_pred:0.031773097813129425, decouple_loss:0.011592434719204903
The generated pressure mean: 0.43254125118255615
loss_pred:0.03096531145274639, decouple_loss:0.01202650647610426
Iteration: 3619, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43592947721481323
The generated pressure mean: 0.4348374903202057
loss_pred:0.03135257214307785, decouple_loss:0.011029117740690708
loss_pred:0.0303331445902586, decouple_loss:0.01091649942100048
The generated pressure mean: 0.4352910816669464
loss_pred:0.029912002384662628, decouple_loss:0.010499419644474983
Iteration: 3620, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46240881085395813
loss_pred:0.030594564974308014, decouple_loss:0.011194477789103985
The generated pressure mean: 0.4644448757171631
loss_pred:0.03042747639119625, decouple_loss:0.01089788880199194
The generated pressure mean: 0.46248334646224976
loss_pred:0.030135801061987877, decouple_loss:0.010997996665537357
2023-04-17 01:41:37 testing...
The generated pressure mean: 0.4156547784805298
The generated pressure mean: 0.4207906723022461
The generated pressure mean: 0.42276546359062195
loss_pred:0.04442610591650009, decouple_loss:0.012075268663465977
loss_pred:0.043163564056158066, decouple_loss:0.012515608221292496
loss_pred:0.04339786618947983, decouple_loss:0.012575552798807621
WV_0_PC_0_EH_1_PS_40, loss: 0.04428195580840111, avg_mse: 0.05795822665095329
current test mse: 0.057958
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 3621, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4550202786922455
loss_pred:0.03319358453154564, decouple_loss:0.01130426675081253
The generated pressure mean: 0.4587462246417999
The generated pressure mean: 0.45498597621917725
loss_pred:0.03005649335682392, decouple_loss:0.010730010457336903
loss_pred:0.03136830031871796, decouple_loss:0.011209622025489807
Iteration: 3622, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4346190392971039
loss_pred:0.029985306784510612, decouple_loss:0.011767475865781307
The generated pressure mean: 0.43197229504585266
loss_pred:0.030533701181411743, decouple_loss:0.012386158108711243
The generated pressure mean: 0.4316704571247101
loss_pred:0.03015422262251377, decouple_loss:0.012162762694060802
Iteration: 3623, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45142149925231934
The generated pressure mean: 0.4523090124130249
loss_pred:0.03184572234749794, decouple_loss:0.010541544295847416
loss_pred:0.030757233500480652, decouple_loss:0.010525407269597054
The generated pressure mean: 0.4546132981777191
loss_pred:0.031781673431396484, decouple_loss:0.010428674519062042
Iteration: 3624, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452805817127228
The generated pressure mean: 0.4465869665145874
loss_pred:0.029060831293463707, decouple_loss:0.01191674079746008
loss_pred:0.0311848483979702, decouple_loss:0.012050987221300602
The generated pressure mean: 0.4468776285648346
loss_pred:0.031277820467948914, decouple_loss:0.011950244195759296
Iteration: 3625, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43701809644699097
The generated pressure mean: 0.4406503736972809
loss_pred:0.029246291145682335, decouple_loss:0.01041236612945795
loss_pred:0.030025973916053772, decouple_loss:0.010475007817149162
The generated pressure mean: 0.4351562261581421
loss_pred:0.031365491449832916, decouple_loss:0.010296531952917576
Iteration: 3626, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463205933570862
loss_pred:0.02946019172668457, decouple_loss:0.012003451585769653
The generated pressure mean: 0.44919317960739136
loss_pred:0.031226959079504013, decouple_loss:0.012601032853126526
The generated pressure mean: 0.4502480626106262
loss_pred:0.030619340017437935, decouple_loss:0.013217800296843052
Iteration: 3627, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4554676413536072
loss_pred:0.03062530793249607, decouple_loss:0.009290603920817375
The generated pressure mean: 0.45409929752349854
loss_pred:0.03356702998280525, decouple_loss:0.009214797057211399
The generated pressure mean: 0.45503056049346924
loss_pred:0.03175012394785881, decouple_loss:0.009363989345729351
Iteration: 3628, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44548147916793823
The generated pressure mean: 0.44002610445022583
loss_pred:0.028649672865867615, decouple_loss:0.012400603853166103
loss_pred:0.03052365966141224, decouple_loss:0.01213528960943222
The generated pressure mean: 0.44345352053642273
loss_pred:0.03185730800032616, decouple_loss:0.011988447979092598
Iteration: 3629, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45108649134635925
The generated pressure mean: 0.45013079047203064
loss_pred:0.030996883288025856, decouple_loss:0.010768645443022251
loss_pred:0.029774555936455727, decouple_loss:0.010751546360552311
The generated pressure mean: 0.45179685950279236
loss_pred:0.029973506927490234, decouple_loss:0.010784636251628399
Iteration: 3630, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4393090307712555
loss_pred:0.031147578731179237, decouple_loss:0.009692609310150146
The generated pressure mean: 0.43616217374801636
loss_pred:0.0312567837536335, decouple_loss:0.009380573406815529
The generated pressure mean: 0.4418894946575165
loss_pred:0.02993830293416977, decouple_loss:0.009621121920645237
2023-04-17 01:44:08 testing...
The generated pressure mean: 0.41954612731933594
The generated pressure mean: 0.4241500496864319
The generated pressure mean: 0.42644888162612915
loss_pred:0.04248448833823204, decouple_loss:0.010809186846017838
loss_pred:0.04180353134870529, decouple_loss:0.011114608496427536
loss_pred:0.04139721766114235, decouple_loss:0.01121270377188921
WV_0_PC_0_EH_1_PS_40, loss: 0.04244735464453697, avg_mse: 0.05492192506790161
current test mse: 0.054922
Iteration: 3631, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44006413221359253
loss_pred:0.03120184689760208, decouple_loss:0.010721277445554733
The generated pressure mean: 0.4404308795928955
loss_pred:0.030513286590576172, decouple_loss:0.010572756640613079
The generated pressure mean: 0.4431983232498169
loss_pred:0.029810113832354546, decouple_loss:0.010252882726490498
Iteration: 3632, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4691503942012787
The generated pressure mean: 0.47108903527259827
loss_pred:0.029576897621154785, decouple_loss:0.008053801022469997
loss_pred:0.02867533080279827, decouple_loss:0.008091348223388195
The generated pressure mean: 0.47067591547966003
loss_pred:0.031112367287278175, decouple_loss:0.008111787028610706
Iteration: 3633, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43588143587112427
The generated pressure mean: 0.43276122212409973
loss_pred:0.031695399433374405, decouple_loss:0.008509640581905842
loss_pred:0.02954554371535778, decouple_loss:0.007937348447740078
The generated pressure mean: 0.4342176616191864
loss_pred:0.029723744839429855, decouple_loss:0.007977155968546867
Iteration: 3634, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449847936630249
The generated pressure mean: 0.4428088665008545
loss_pred:0.029687821865081787, decouple_loss:0.008824653923511505
loss_pred:0.03113284334540367, decouple_loss:0.008676579222083092
The generated pressure mean: 0.4433562755584717
loss_pred:0.02887367643415928, decouple_loss:0.009146209806203842
Iteration: 3635, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45806294679641724
loss_pred:0.03444088622927666, decouple_loss:0.0074217664077878
The generated pressure mean: 0.4568776488304138
loss_pred:0.02966202050447464, decouple_loss:0.007358576636761427
The generated pressure mean: 0.4555618464946747
loss_pred:0.029530255123972893, decouple_loss:0.007300268858671188
Iteration: 3636, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.40196144580841064
The generated pressure mean: 0.4074724316596985
loss_pred:0.031038496643304825, decouple_loss:0.01054331287741661
loss_pred:0.03042268380522728, decouple_loss:0.010179813951253891
The generated pressure mean: 0.40302297472953796
loss_pred:0.03186623379588127, decouple_loss:0.010316579602658749
Iteration: 3637, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.5116698145866394
The generated pressure mean: 0.49609389901161194
loss_pred:0.03167332336306572, decouple_loss:0.012498698197305202
loss_pred:0.030018819496035576, decouple_loss:0.011099928058683872
The generated pressure mean: 0.5095314979553223
loss_pred:0.030442941933870316, decouple_loss:0.012258355505764484
Iteration: 3638, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4400312900543213
loss_pred:0.031332168728113174, decouple_loss:0.01033275481313467
The generated pressure mean: 0.44137945771217346
loss_pred:0.029158294200897217, decouple_loss:0.0093512162566185
The generated pressure mean: 0.43871718645095825
loss_pred:0.0302592720836401, decouple_loss:0.009711859747767448
Iteration: 3639, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4158206582069397
loss_pred:0.02927342616021633, decouple_loss:0.00945658516138792
The generated pressure mean: 0.4096503257751465
loss_pred:0.030457084998488426, decouple_loss:0.00947044137865305
The generated pressure mean: 0.409675657749176
loss_pred:0.02957223914563656, decouple_loss:0.008837969973683357
Iteration: 3640, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46863844990730286
The generated pressure mean: 0.46887412667274475
loss_pred:0.03098759986460209, decouple_loss:0.014012630097568035
loss_pred:0.03094535693526268, decouple_loss:0.014126960188150406
The generated pressure mean: 0.47282758355140686
loss_pred:0.029517939314246178, decouple_loss:0.014276059344410896
2023-04-17 01:46:02 testing...
The generated pressure mean: 0.4176410436630249
The generated pressure mean: 0.4214000105857849
The generated pressure mean: 0.4230938255786896
loss_pred:0.0432625412940979, decouple_loss:0.010395933873951435
loss_pred:0.04200827330350876, decouple_loss:0.010621489025652409
loss_pred:0.04159367457032204, decouple_loss:0.01069579180330038
WV_0_PC_0_EH_1_PS_40, loss: 0.04281671345233917, avg_mse: 0.05520392954349518
current test mse: 0.055204
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 3641, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4403166174888611
loss_pred:0.031326066702604294, decouple_loss:0.009402625262737274
The generated pressure mean: 0.44330093264579773
loss_pred:0.031986355781555176, decouple_loss:0.009198815561830997
The generated pressure mean: 0.44246697425842285
loss_pred:0.030144773423671722, decouple_loss:0.009090924635529518
Iteration: 3642, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43382102251052856
loss_pred:0.0332140177488327, decouple_loss:0.013651523739099503
The generated pressure mean: 0.43107813596725464
loss_pred:0.0306133721023798, decouple_loss:0.01353397686034441
The generated pressure mean: 0.43196025490760803
loss_pred:0.029441887512803078, decouple_loss:0.013650687411427498
Iteration: 3643, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4696136713027954
The generated pressure mean: 0.4641683101654053
loss_pred:0.02987457439303398, decouple_loss:0.010698680765926838
loss_pred:0.03192038834095001, decouple_loss:0.01044919528067112
The generated pressure mean: 0.46546798944473267
loss_pred:0.028830811381340027, decouple_loss:0.00994629506021738
Iteration: 3644, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45311886072158813
The generated pressure mean: 0.4547443091869354
loss_pred:0.031662467867136, decouple_loss:0.012853137217462063
loss_pred:0.03060850128531456, decouple_loss:0.012505254708230495
The generated pressure mean: 0.455082505941391
loss_pred:0.03314089775085449, decouple_loss:0.012843186035752296
Iteration: 3645, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4184039533138275
The generated pressure mean: 0.42787131667137146
loss_pred:0.03275763615965843, decouple_loss:0.010757670737802982
loss_pred:0.031042778864502907, decouple_loss:0.010436625219881535
The generated pressure mean: 0.4223807454109192
loss_pred:0.030191004276275635, decouple_loss:0.010711376555263996
Iteration: 3646, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496109187602997
The generated pressure mean: 0.44844406843185425
loss_pred:0.030749842524528503, decouple_loss:0.01159626618027687
loss_pred:0.030597297474741936, decouple_loss:0.011418716050684452
The generated pressure mean: 0.4528708755970001
loss_pred:0.0299396812915802, decouple_loss:0.011059064418077469
Iteration: 3647, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4530203938484192
The generated pressure mean: 0.44947704672813416
loss_pred:0.02968905121088028, decouple_loss:0.008970588445663452
loss_pred:0.02856830507516861, decouple_loss:0.009208484552800655
The generated pressure mean: 0.4532721936702728
loss_pred:0.03301709145307541, decouple_loss:0.009198443964123726
Iteration: 3648, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45580723881721497
The generated pressure mean: 0.457357794046402
loss_pred:0.02897779457271099, decouple_loss:0.009916158393025398
loss_pred:0.030950792133808136, decouple_loss:0.009716658852994442
The generated pressure mean: 0.4584806561470032
loss_pred:0.029783407226204872, decouple_loss:0.00973934680223465
Iteration: 3649, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44353586435317993
The generated pressure mean: 0.4413417875766754
loss_pred:0.030717268586158752, decouple_loss:0.009504828602075577
loss_pred:0.03229255601763725, decouple_loss:0.009447220712900162
The generated pressure mean: 0.43865257501602173
loss_pred:0.03146252781152725, decouple_loss:0.009498211555182934
Iteration: 3650, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4434882402420044
The generated pressure mean: 0.44542115926742554
loss_pred:0.031857702881097794, decouple_loss:0.008992682211101055
loss_pred:0.030703140422701836, decouple_loss:0.009815643541514874
The generated pressure mean: 0.44735127687454224
loss_pred:0.03397926315665245, decouple_loss:0.00926299300044775
2023-04-17 01:48:50 testing...
The generated pressure mean: 0.4202198386192322
The generated pressure mean: 0.425723135471344
The generated pressure mean: 0.42787420749664307
loss_pred:0.04182140529155731, decouple_loss:0.011737465858459473
loss_pred:0.04062916338443756, decouple_loss:0.012248286046087742
loss_pred:0.0404488742351532, decouple_loss:0.012450153939425945
WV_0_PC_0_EH_1_PS_40, loss: 0.041573747992515564, avg_mse: 0.05349506065249443
current test mse: 0.053495
Iteration: 3651, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43655726313591003
loss_pred:0.03250668942928314, decouple_loss:0.011157035827636719
The generated pressure mean: 0.4276946485042572
loss_pred:0.029848909005522728, decouple_loss:0.010902469046413898
The generated pressure mean: 0.4366084933280945
loss_pred:0.029919300228357315, decouple_loss:0.010624155402183533
Iteration: 3652, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45822376012802124
The generated pressure mean: 0.45146670937538147
loss_pred:0.03365091606974602, decouple_loss:0.0092638423666358
loss_pred:0.029269011691212654, decouple_loss:0.009090334177017212
The generated pressure mean: 0.4479537010192871
loss_pred:0.030751461163163185, decouple_loss:0.009992184117436409
Iteration: 3653, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4651390612125397
loss_pred:0.032488830387592316, decouple_loss:0.011680989526212215
The generated pressure mean: 0.4686405062675476
loss_pred:0.032815463840961456, decouple_loss:0.0114247165620327
The generated pressure mean: 0.4651641547679901
loss_pred:0.030389446765184402, decouple_loss:0.011791720986366272
Iteration: 3654, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4114505350589752
loss_pred:0.031220005825161934, decouple_loss:0.01160113699734211
The generated pressure mean: 0.40794479846954346
loss_pred:0.03240373358130455, decouple_loss:0.011691738851368427
The generated pressure mean: 0.41501906514167786
loss_pred:0.031006580218672752, decouple_loss:0.011865969747304916
Iteration: 3655, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47801485657691956
loss_pred:0.03267225995659828, decouple_loss:0.012001749128103256
The generated pressure mean: 0.47648152709007263
loss_pred:0.03241490200161934, decouple_loss:0.01162052620202303
The generated pressure mean: 0.4743068516254425
loss_pred:0.031477779150009155, decouple_loss:0.011301879771053791
Iteration: 3656, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42681726813316345
The generated pressure mean: 0.4319453537464142
loss_pred:0.033280011266469955, decouple_loss:0.010803482495248318
loss_pred:0.03139772266149521, decouple_loss:0.01112587284296751
The generated pressure mean: 0.4327939748764038
loss_pred:0.029567183926701546, decouple_loss:0.010250333696603775
Iteration: 3657, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45028239488601685
loss_pred:0.030624259263277054, decouple_loss:0.010847579687833786
The generated pressure mean: 0.448024719953537
loss_pred:0.030530769377946854, decouple_loss:0.01074542012065649
The generated pressure mean: 0.4479209780693054
loss_pred:0.030969757586717606, decouple_loss:0.010804759338498116
Iteration: 3658, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4562044143676758
loss_pred:0.03064814954996109, decouple_loss:0.010248914361000061
The generated pressure mean: 0.45381346344947815
loss_pred:0.030253181234002113, decouple_loss:0.009884808212518692
The generated pressure mean: 0.4563017785549164
loss_pred:0.03180137276649475, decouple_loss:0.009805065579712391
Iteration: 3659, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44677793979644775
loss_pred:0.030901622027158737, decouple_loss:0.010777411982417107
The generated pressure mean: 0.44307589530944824
loss_pred:0.02883993647992611, decouple_loss:0.010760536417365074
The generated pressure mean: 0.4421752691268921
loss_pred:0.03168981894850731, decouple_loss:0.010643377900123596
Iteration: 3660, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4388061463832855
loss_pred:0.03168012201786041, decouple_loss:0.008973225019872189
The generated pressure mean: 0.44034287333488464
loss_pred:0.029635027050971985, decouple_loss:0.00908678863197565
The generated pressure mean: 0.4343789219856262
loss_pred:0.03227709233760834, decouple_loss:0.009485858492553234
2023-04-17 01:50:43 testing...
The generated pressure mean: 0.41467195749282837
The generated pressure mean: 0.4191182553768158
The generated pressure mean: 0.421208918094635
loss_pred:0.043138377368450165, decouple_loss:0.010850941762328148
loss_pred:0.04226773604750633, decouple_loss:0.011116500943899155
loss_pred:0.04179174080491066, decouple_loss:0.011211806908249855
WV_0_PC_0_EH_1_PS_40, loss: 0.042952269315719604, avg_mse: 0.056192632764577866
current test mse: 0.056193
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 3661, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45646730065345764
loss_pred:0.030879804864525795, decouple_loss:0.01030940841883421
The generated pressure mean: 0.4533131420612335
loss_pred:0.02919544279575348, decouple_loss:0.010224314406514168
The generated pressure mean: 0.4588330388069153
loss_pred:0.030073734000325203, decouple_loss:0.01010885275900364
Iteration: 3662, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44998490810394287
The generated pressure mean: 0.43952760100364685
loss_pred:0.030637217685580254, decouple_loss:0.009389416314661503
loss_pred:0.030322391539812088, decouple_loss:0.009296751581132412
The generated pressure mean: 0.44737187027931213
loss_pred:0.029447708278894424, decouple_loss:0.009145657531917095
Iteration: 3663, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4373492896556854
The generated pressure mean: 0.43677765130996704
loss_pred:0.030656607821583748, decouple_loss:0.008975213393568993
loss_pred:0.029511885717511177, decouple_loss:0.008440927602350712
The generated pressure mean: 0.4363360106945038
loss_pred:0.02902466244995594, decouple_loss:0.008934902027249336
Iteration: 3664, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46097975969314575
The generated pressure mean: 0.4578416645526886
loss_pred:0.029333356767892838, decouple_loss:0.00958484411239624
loss_pred:0.028698813170194626, decouple_loss:0.009594359435141087
The generated pressure mean: 0.46377283334732056
loss_pred:0.02907402440905571, decouple_loss:0.00909447018057108
Iteration: 3665, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4530490040779114
The generated pressure mean: 0.4565962851047516
loss_pred:0.029167795553803444, decouple_loss:0.008500379510223866
loss_pred:0.028623176738619804, decouple_loss:0.007962385192513466
The generated pressure mean: 0.45356807112693787
loss_pred:0.030090633779764175, decouple_loss:0.007940728217363358
Iteration: 3666, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43146824836730957
The generated pressure mean: 0.42997753620147705
loss_pred:0.029132628813385963, decouple_loss:0.008150843903422356
loss_pred:0.030123280361294746, decouple_loss:0.008396448567509651
The generated pressure mean: 0.4292300045490265
loss_pred:0.030572516843676567, decouple_loss:0.008376932702958584
Iteration: 3667, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43734562397003174
The generated pressure mean: 0.44210878014564514
loss_pred:0.02932034619152546, decouple_loss:0.007851982489228249
loss_pred:0.029131261631846428, decouple_loss:0.008147033862769604
The generated pressure mean: 0.4403959810733795
loss_pred:0.029968373477458954, decouple_loss:0.007880614139139652
Iteration: 3668, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4628414213657379
loss_pred:0.028489159420132637, decouple_loss:0.007417057175189257
The generated pressure mean: 0.4695647954940796
loss_pred:0.028371138498187065, decouple_loss:0.0073873563669621944
The generated pressure mean: 0.4651305675506592
loss_pred:0.029925165697932243, decouple_loss:0.007533381227403879
Iteration: 3669, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44798538088798523
loss_pred:0.029941897839307785, decouple_loss:0.008232343010604382
The generated pressure mean: 0.44916847348213196
loss_pred:0.02785939909517765, decouple_loss:0.008364161476492882
The generated pressure mean: 0.4538376033306122
loss_pred:0.028870536014437675, decouple_loss:0.008076486177742481
Iteration: 3670, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43363824486732483
loss_pred:0.029500920325517654, decouple_loss:0.007714834995567799
The generated pressure mean: 0.4383564591407776
loss_pred:0.030177311971783638, decouple_loss:0.008009374141693115
The generated pressure mean: 0.4358387589454651
loss_pred:0.03022387996315956, decouple_loss:0.0076775746420025826
2023-04-17 01:53:22 testing...
The generated pressure mean: 0.4153905212879181
The generated pressure mean: 0.4197404384613037
The generated pressure mean: 0.4218568801879883
loss_pred:0.043030790984630585, decouple_loss:0.00846864189952612
loss_pred:0.04224433749914169, decouple_loss:0.008784757927060127
loss_pred:0.041702065616846085, decouple_loss:0.009031560271978378
WV_0_PC_0_EH_1_PS_40, loss: 0.04276381433010101, avg_mse: 0.05638917535543442
current test mse: 0.056389
Iteration: 3671, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44655537605285645
loss_pred:0.03174678981304169, decouple_loss:0.008525359444320202
The generated pressure mean: 0.4531383812427521
loss_pred:0.03055565245449543, decouple_loss:0.008268503472208977
The generated pressure mean: 0.45333054661750793
loss_pred:0.028554027900099754, decouple_loss:0.008712392300367355
Iteration: 3672, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4429425895214081
loss_pred:0.028856873512268066, decouple_loss:0.006982460618019104
The generated pressure mean: 0.44504114985466003
loss_pred:0.02929695136845112, decouple_loss:0.006984701380133629
The generated pressure mean: 0.4457269608974457
loss_pred:0.03076600283384323, decouple_loss:0.00728321960195899
Iteration: 3673, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.441387802362442
The generated pressure mean: 0.4464695155620575
loss_pred:0.028916815295815468, decouple_loss:0.007948542013764381
loss_pred:0.029693178832530975, decouple_loss:0.007779797073453665
The generated pressure mean: 0.4437406659126282
loss_pred:0.030157092958688736, decouple_loss:0.007813460193574429
Iteration: 3674, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45547884702682495
The generated pressure mean: 0.45141804218292236
loss_pred:0.02962491102516651, decouple_loss:0.007015388924628496
loss_pred:0.029105670750141144, decouple_loss:0.008024546317756176
The generated pressure mean: 0.45189663767814636
loss_pred:0.028303852304816246, decouple_loss:0.006837612483650446
Iteration: 3675, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4557854235172272
loss_pred:0.030267100781202316, decouple_loss:0.0074670882895588875
The generated pressure mean: 0.4486345648765564
loss_pred:0.029057743027806282, decouple_loss:0.007600071374326944
The generated pressure mean: 0.44660264253616333
loss_pred:0.02882467769086361, decouple_loss:0.007417351473122835
Iteration: 3676, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44043970108032227
The generated pressure mean: 0.44596123695373535
loss_pred:0.02917567640542984, decouple_loss:0.0075559248216450214
loss_pred:0.030689794570207596, decouple_loss:0.008001541718840599
The generated pressure mean: 0.4361172914505005
loss_pred:0.029943566769361496, decouple_loss:0.007795420009642839
Iteration: 3677, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44441449642181396
The generated pressure mean: 0.44395843148231506
loss_pred:0.02777944691479206, decouple_loss:0.0073003401048481464
loss_pred:0.029975559562444687, decouple_loss:0.007645020727068186
The generated pressure mean: 0.44352155923843384
loss_pred:0.030121948570013046, decouple_loss:0.007104978896677494
Iteration: 3678, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4558447599411011
loss_pred:0.029350388795137405, decouple_loss:0.007639649324119091
The generated pressure mean: 0.449739545583725
loss_pred:0.030882516875863075, decouple_loss:0.00832608062773943
The generated pressure mean: 0.45139917731285095
loss_pred:0.028637729585170746, decouple_loss:0.008198593743145466
Iteration: 3679, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45085740089416504
The generated pressure mean: 0.45391157269477844
loss_pred:0.029832269996404648, decouple_loss:0.006905353162437677
loss_pred:0.02936341054737568, decouple_loss:0.006997954100370407
The generated pressure mean: 0.4506153166294098
loss_pred:0.0287909135222435, decouple_loss:0.007312969770282507
Iteration: 3680, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44234412908554077
The generated pressure mean: 0.43696022033691406
loss_pred:0.029098058119416237, decouple_loss:0.008726708590984344
loss_pred:0.030959684401750565, decouple_loss:0.007722846698015928
The generated pressure mean: 0.4353826940059662
loss_pred:0.028430243954062462, decouple_loss:0.00754216592758894
2023-04-17 01:55:15 testing...
The generated pressure mean: 0.4164141118526459
The generated pressure mean: 0.4212076663970947
The generated pressure mean: 0.4231341481208801
loss_pred:0.04131825268268585, decouple_loss:0.007249629590660334
loss_pred:0.04039112851023674, decouple_loss:0.007714618928730488
loss_pred:0.039683014154434204, decouple_loss:0.00785363931208849
WV_0_PC_0_EH_1_PS_40, loss: 0.04084443300962448, avg_mse: 0.05310332775115967
current test mse: 0.053103
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 3681, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4448528289794922
loss_pred:0.029057718813419342, decouple_loss:0.006484796293079853
The generated pressure mean: 0.45023036003112793
loss_pred:0.029890060424804688, decouple_loss:0.006417222786694765
The generated pressure mean: 0.448167622089386
loss_pred:0.027242857962846756, decouple_loss:0.00630026264116168
Iteration: 3682, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.455647349357605
The generated pressure mean: 0.45337897539138794
loss_pred:0.030725007876753807, decouple_loss:0.008140244521200657
loss_pred:0.02997950091958046, decouple_loss:0.00820677075535059
The generated pressure mean: 0.45445266366004944
loss_pred:0.02876979112625122, decouple_loss:0.007779478561133146
Iteration: 3683, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469152092933655
The generated pressure mean: 0.44401124119758606
loss_pred:0.029420100152492523, decouple_loss:0.006815567146986723
loss_pred:0.03165164962410927, decouple_loss:0.006986077409237623
The generated pressure mean: 0.4487607181072235
loss_pred:0.030424103140830994, decouple_loss:0.006834137719124556
Iteration: 3684, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4450300931930542
The generated pressure mean: 0.4395100474357605
loss_pred:0.028960734605789185, decouple_loss:0.008879510685801506
loss_pred:0.02858543209731579, decouple_loss:0.009002246893942356
The generated pressure mean: 0.4420180022716522
loss_pred:0.029080895707011223, decouple_loss:0.008434263989329338
Iteration: 3685, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44748663902282715
The generated pressure mean: 0.44879063963890076
loss_pred:0.03007166087627411, decouple_loss:0.007718868553638458
loss_pred:0.02934413030743599, decouple_loss:0.007684546522796154
The generated pressure mean: 0.44389551877975464
loss_pred:0.029266804456710815, decouple_loss:0.00790028553456068
Iteration: 3686, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4569401144981384The generated pressure mean: 0.45801842212677
loss_pred:0.03314444050192833, decouple_loss:0.00892042275518179
loss_pred:0.029385628178715706, decouple_loss:0.008548256009817123
The generated pressure mean: 0.4610166549682617
loss_pred:0.02873230166733265, decouple_loss:0.008315686136484146
Iteration: 3687, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.428159236907959
The generated pressure mean: 0.4369451105594635
loss_pred:0.029722770676016808, decouple_loss:0.009165512397885323
loss_pred:0.03193876892328262, decouple_loss:0.009380326606333256
The generated pressure mean: 0.43038269877433777
loss_pred:0.029716063290834427, decouple_loss:0.00961783342063427
Iteration: 3688, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.450823038816452
The generated pressure mean: 0.45161083340644836
loss_pred:0.030067184939980507, decouple_loss:0.00883561372756958
loss_pred:0.029340730980038643, decouple_loss:0.008822305127978325
The generated pressure mean: 0.4481167197227478
loss_pred:0.02846083976328373, decouple_loss:0.00869227945804596
Iteration: 3689, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45908018946647644
loss_pred:0.030824609100818634, decouple_loss:0.00930800847709179
The generated pressure mean: 0.46079543232917786
loss_pred:0.028416024520993233, decouple_loss:0.009847521781921387
The generated pressure mean: 0.4569742679595947
loss_pred:0.02780657447874546, decouple_loss:0.009658087976276875
Iteration: 3690, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42748016119003296
loss_pred:0.0300539992749691, decouple_loss:0.00893376860767603
The generated pressure mean: 0.42630499601364136
loss_pred:0.027720075100660324, decouple_loss:0.009004672057926655
The generated pressure mean: 0.4244157373905182
loss_pred:0.029591482132673264, decouple_loss:0.00914064235985279
2023-04-17 01:57:47 testing...
The generated pressure mean: 0.41508883237838745
The generated pressure mean: 0.4202745854854584
The generated pressure mean: 0.42213746905326843
loss_pred:0.04273942857980728, decouple_loss:0.010469178669154644
loss_pred:0.04174240678548813, decouple_loss:0.011013728566467762
loss_pred:0.041202522814273834, decouple_loss:0.011003587394952774
WV_0_PC_0_EH_1_PS_40, loss: 0.04243623465299606, avg_mse: 0.05571267753839493
current test mse: 0.055713
Iteration: 3691, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4530627429485321
The generated pressure mean: 0.4547688663005829
loss_pred:0.02809017337858677, decouple_loss:0.009387815371155739
loss_pred:0.03062414564192295, decouple_loss:0.009003118611872196
The generated pressure mean: 0.4531158208847046
loss_pred:0.031187109649181366, decouple_loss:0.009700393304228783
Iteration: 3692, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46550458669662476
loss_pred:0.02904461696743965, decouple_loss:0.008871132507920265
The generated pressure mean: 0.46239495277404785
loss_pred:0.029793133959174156, decouple_loss:0.008868534117937088
The generated pressure mean: 0.4644818603992462
loss_pred:0.028473496437072754, decouple_loss:0.00830937922000885
Iteration: 3693, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4232260584831238
loss_pred:0.028968730941414833, decouple_loss:0.008621911518275738
The generated pressure mean: 0.42109644412994385
loss_pred:0.028958307579159737, decouple_loss:0.008195769973099232
The generated pressure mean: 0.41663146018981934
loss_pred:0.030087845399975777, decouple_loss:0.008490399457514286
Iteration: 3694, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4837382435798645
The generated pressure mean: 0.4788598418235779
loss_pred:0.031170036643743515, decouple_loss:0.009415792301297188
loss_pred:0.03141453489661217, decouple_loss:0.009101903066039085
The generated pressure mean: 0.47509098052978516
loss_pred:0.029524613171815872, decouple_loss:0.00917226541787386
Iteration: 3695, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4327276349067688
The generated pressure mean: 0.42844441533088684
loss_pred:0.028335699811577797, decouple_loss:0.010244818404316902
loss_pred:0.029720794409513474, decouple_loss:0.010314792394638062
The generated pressure mean: 0.4282396137714386
loss_pred:0.031008070334792137, decouple_loss:0.010905478149652481
Iteration: 3696, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4311811327934265
loss_pred:0.028603380545973778, decouple_loss:0.010553965345025063
The generated pressure mean: 0.4373391568660736
loss_pred:0.029210001230239868, decouple_loss:0.011116537265479565
The generated pressure mean: 0.43306365609169006
loss_pred:0.029610976576805115, decouple_loss:0.010966322384774685
Iteration: 3697, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4658527076244354
loss_pred:0.02941146120429039, decouple_loss:0.010363881476223469
The generated pressure mean: 0.46598324179649353
loss_pred:0.028911717236042023, decouple_loss:0.01015535369515419
The generated pressure mean: 0.4626389741897583
loss_pred:0.02902272343635559, decouple_loss:0.010233142413198948
Iteration: 3698, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45264244079589844
loss_pred:0.02914058417081833, decouple_loss:0.011459222994744778
The generated pressure mean: 0.45073530077934265
loss_pred:0.03115178272128105, decouple_loss:0.011604920960962772
The generated pressure mean: 0.45642539858818054
loss_pred:0.029049227014183998, decouple_loss:0.011230024509131908
Iteration: 3699, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4318903684616089
loss_pred:0.02870352938771248, decouple_loss:0.010387877002358437
The generated pressure mean: 0.43437352776527405
loss_pred:0.03150292858481407, decouple_loss:0.010876698419451714
The generated pressure mean: 0.4350794851779938
loss_pred:0.030297698453068733, decouple_loss:0.010763505473732948
Iteration: 3700, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44146642088890076
loss_pred:0.02903970144689083, decouple_loss:0.010525870136916637
The generated pressure mean: 0.44766032695770264
loss_pred:0.03008699044585228, decouple_loss:0.010065300390124321
The generated pressure mean: 0.44540542364120483
loss_pred:0.0292942076921463, decouple_loss:0.010186456143856049
2023-04-17 01:59:40 testing...
The generated pressure mean: 0.41925451159477234
The generated pressure mean: 0.4140733778476715
loss_pred:0.041011784225702286, decouple_loss:0.010964963585138321
The generated pressure mean: 0.42153894901275635
loss_pred:0.04223530739545822, decouple_loss:0.010632272809743881
loss_pred:0.04073156788945198, decouple_loss:0.011155265383422375
WV_0_PC_0_EH_1_PS_40, loss: 0.04187209531664848, avg_mse: 0.055153388530015945
current test mse: 0.055153
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 3701, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4605993330478668
loss_pred:0.0314943827688694, decouple_loss:0.010712971910834312
The generated pressure mean: 0.4584340751171112
The generated pressure mean: 0.45906513929367065
loss_pred:0.029494667425751686, decouple_loss:0.010180394165217876
loss_pred:0.030516641214489937, decouple_loss:0.010305765084922314
Iteration: 3702, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.434281587600708
The generated pressure mean: 0.4388468265533447
loss_pred:0.029601965099573135, decouple_loss:0.010717378929257393
loss_pred:0.029242103919386864, decouple_loss:0.010350155644118786
The generated pressure mean: 0.43575480580329895
loss_pred:0.03366092965006828, decouple_loss:0.010805862955749035
Iteration: 3703, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4620310664176941
The generated pressure mean: 0.462487131357193
loss_pred:0.030914410948753357, decouple_loss:0.008588292635977268
loss_pred:0.030610550194978714, decouple_loss:0.008098067715764046
The generated pressure mean: 0.46270251274108887
loss_pred:0.029494518414139748, decouple_loss:0.008710582740604877
Iteration: 3704, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4413672387599945
The generated pressure mean: 0.43824338912963867
loss_pred:0.029334498569369316, decouple_loss:0.011137581430375576
loss_pred:0.028419427573680878, decouple_loss:0.011356603354215622
The generated pressure mean: 0.4403957426548004
loss_pred:0.029115302488207817, decouple_loss:0.011093281209468842
Iteration: 3705, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4381151497364044
The generated pressure mean: 0.4390923082828522
loss_pred:0.03113466128706932, decouple_loss:0.0084947869181633
loss_pred:0.03115411102771759, decouple_loss:0.008443977683782578
The generated pressure mean: 0.43687567114830017
loss_pred:0.02920033596456051, decouple_loss:0.008333612233400345
Iteration: 3706, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46040913462638855
The generated pressure mean: 0.4599117040634155
loss_pred:0.030320946127176285, decouple_loss:0.010280204936861992
loss_pred:0.029789794236421585, decouple_loss:0.009722059592604637
The generated pressure mean: 0.459123432636261
loss_pred:0.028637707233428955, decouple_loss:0.00942310318350792
Iteration: 3707, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507725238800049
The generated pressure mean: 0.45394814014434814
loss_pred:0.030219340696930885, decouple_loss:0.008669559843838215
loss_pred:0.030962465330958366, decouple_loss:0.008588667027652264
The generated pressure mean: 0.4550503194332123
loss_pred:0.03191462904214859, decouple_loss:0.008336431346833706
Iteration: 3708, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4345727562904358
The generated pressure mean: 0.4403037428855896
loss_pred:0.02942977286875248, decouple_loss:0.008537807501852512
loss_pred:0.030603522434830666, decouple_loss:0.008227155543863773
The generated pressure mean: 0.43706414103507996
loss_pred:0.02986272983253002, decouple_loss:0.00807633064687252
Iteration: 3709, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45142239332199097
loss_pred:0.029573990032076836, decouple_loss:0.008506624959409237
The generated pressure mean: 0.4536852538585663
loss_pred:0.03163035586476326, decouple_loss:0.008734496310353279
The generated pressure mean: 0.4529513120651245
loss_pred:0.030509110540151596, decouple_loss:0.008610781282186508
Iteration: 3710, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45213109254837036
The generated pressure mean: 0.44657257199287415
loss_pred:0.029370760545134544, decouple_loss:0.007635802961885929
loss_pred:0.028286578133702278, decouple_loss:0.007303303573280573
The generated pressure mean: 0.44446542859077454
loss_pred:0.029396839439868927, decouple_loss:0.007516049314290285
2023-04-17 02:02:10 testing...
The generated pressure mean: 0.41712692379951477
The generated pressure mean: 0.42215701937675476
The generated pressure mean: 0.42398181557655334
loss_pred:0.041344430297613144, decouple_loss:0.00830105785280466
loss_pred:0.040468938648700714, decouple_loss:0.008553179912269115
loss_pred:0.04004277288913727, decouple_loss:0.008670448325574398
WV_0_PC_0_EH_1_PS_40, loss: 0.04104412719607353, avg_mse: 0.05386659875512123
current test mse: 0.053867
Iteration: 3711, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.450847864151001
The generated pressure mean: 0.4514451324939728
loss_pred:0.031019235029816628, decouple_loss:0.007827083580195904
loss_pred:0.02857358567416668, decouple_loss:0.008239963091909885
The generated pressure mean: 0.4460460841655731
loss_pred:0.02841658890247345, decouple_loss:0.007870355620980263
Iteration: 3712, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45393824577331543
The generated pressure mean: 0.45166507363319397
loss_pred:0.030943110585212708, decouple_loss:0.008386000990867615
loss_pred:0.02998535893857479, decouple_loss:0.008155019022524357
The generated pressure mean: 0.4494137167930603
loss_pred:0.030834224075078964, decouple_loss:0.008017698302865028
Iteration: 3713, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44189292192459106
loss_pred:0.030710993334650993, decouple_loss:0.007645538076758385
The generated pressure mean: 0.43892353773117065
loss_pred:0.030992416664958, decouple_loss:0.0073122289031744
The generated pressure mean: 0.43856844305992126
loss_pred:0.03051607310771942, decouple_loss:0.007286630105227232
Iteration: 3714, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44394904375076294
loss_pred:0.028463231399655342, decouple_loss:0.009722638875246048
The generated pressure mean: 0.44404980540275574
loss_pred:0.02928667701780796, decouple_loss:0.009652362205088139
The generated pressure mean: 0.44150862097740173
loss_pred:0.03178137168288231, decouple_loss:0.009099733084440231
Iteration: 3715, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46880248188972473
loss_pred:0.030792243778705597, decouple_loss:0.007672568783164024
The generated pressure mean: 0.4694420099258423
loss_pred:0.028910070657730103, decouple_loss:0.007192990742623806
The generated pressure mean: 0.46154364943504333
loss_pred:0.029851939529180527, decouple_loss:0.007641149219125509
Iteration: 3716, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4330396354198456
loss_pred:0.028448008000850677, decouple_loss:0.008760412223637104
The generated pressure mean: 0.43771663308143616
loss_pred:0.028953196480870247, decouple_loss:0.008583322167396545
The generated pressure mean: 0.43778160214424133
loss_pred:0.03193387761712074, decouple_loss:0.008734939619898796
Iteration: 3717, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4417308270931244
loss_pred:0.030242392793297768, decouple_loss:0.008109050802886486
The generated pressure mean: 0.4408160150051117
loss_pred:0.0311882421374321, decouple_loss:0.007965807802975178
The generated pressure mean: 0.4422069787979126
loss_pred:0.029623063281178474, decouple_loss:0.007625035475939512
Iteration: 3718, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4678231179714203
The generated pressure mean: 0.4650767743587494
loss_pred:0.028825553134083748, decouple_loss:0.0072596725076437
loss_pred:0.02868206426501274, decouple_loss:0.007150357589125633
The generated pressure mean: 0.47212114930152893
loss_pred:0.028089940547943115, decouple_loss:0.007322135381400585
Iteration: 3719, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43481457233428955
loss_pred:0.02965659648180008, decouple_loss:0.008114976808428764
The generated pressure mean: 0.43477675318717957
loss_pred:0.029678581282496452, decouple_loss:0.008211684413254261
The generated pressure mean: 0.4399229884147644
loss_pred:0.030253153294324875, decouple_loss:0.008603349328041077
Iteration: 3720, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4373209774494171
The generated pressure mean: 0.44064274430274963
loss_pred:0.029781214892864227, decouple_loss:0.008624250069260597
loss_pred:0.02965492382645607, decouple_loss:0.008656231686472893
The generated pressure mean: 0.44062286615371704
loss_pred:0.02944950759410858, decouple_loss:0.008461029268801212
2023-04-17 02:04:03 testing...
The generated pressure mean: 0.41396424174308777
The generated pressure mean: 0.41974663734436035
The generated pressure mean: 0.4217051863670349
loss_pred:0.04293159395456314, decouple_loss:0.008580553345382214
loss_pred:0.0417683981359005, decouple_loss:0.009013589471578598
loss_pred:0.04129970818758011, decouple_loss:0.009252145886421204
WV_0_PC_0_EH_1_PS_40, loss: 0.04244733974337578, avg_mse: 0.05671655014157295
current test mse: 0.056717
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 3721, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46699240803718567
loss_pred:0.029364336282014847, decouple_loss:0.00829074252396822
The generated pressure mean: 0.4597790539264679
loss_pred:0.030877085402607918, decouple_loss:0.007645837496966124
The generated pressure mean: 0.46033936738967896
loss_pred:0.03054710105061531, decouple_loss:0.008005807176232338
Iteration: 3722, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4327787756919861
The generated pressure mean: 0.44008833169937134
loss_pred:0.030233001336455345, decouple_loss:0.0074872104451060295
loss_pred:0.029040973633527756, decouple_loss:0.007478585001081228
The generated pressure mean: 0.43639859557151794
loss_pred:0.03157954663038254, decouple_loss:0.00784675870090723
Iteration: 3723, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4565249979496002
The generated pressure mean: 0.45869773626327515
loss_pred:0.03080163523554802, decouple_loss:0.008537959307432175
loss_pred:0.02834339439868927, decouple_loss:0.008543229661881924
The generated pressure mean: 0.4572230577468872
loss_pred:0.02920396253466606, decouple_loss:0.008292878977954388
Iteration: 3724, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45260581374168396
The generated pressure mean: 0.45227229595184326
loss_pred:0.028866788372397423, decouple_loss:0.008958752267062664
loss_pred:0.029397163540124893, decouple_loss:0.008831553161144257
The generated pressure mean: 0.45450782775878906
loss_pred:0.029088372364640236, decouple_loss:0.008822443895041943
Iteration: 3725, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4299028515815735
The generated pressure mean: 0.43416982889175415
loss_pred:0.0301814042031765, decouple_loss:0.0072767967358231544
loss_pred:0.029510483145713806, decouple_loss:0.007303204853087664
The generated pressure mean: 0.42917656898498535
loss_pred:0.02855168841779232, decouple_loss:0.0071869948878884315
Iteration: 3726, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45297643542289734
The generated pressure mean: 0.4530719816684723
loss_pred:0.029901020228862762, decouple_loss:0.009205951355397701
loss_pred:0.02960258349776268, decouple_loss:0.009223835542798042
The generated pressure mean: 0.4555724859237671
loss_pred:0.029411446303129196, decouple_loss:0.0091669000685215
Iteration: 3727, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46081092953681946
The generated pressure mean: 0.4610206186771393
loss_pred:0.029435936361551285, decouple_loss:0.009738883003592491
loss_pred:0.029897982254624367, decouple_loss:0.010003654286265373
The generated pressure mean: 0.4574340283870697
loss_pred:0.028524847701191902, decouple_loss:0.009466771967709064
Iteration: 3728, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442969560623169
The generated pressure mean: 0.44505617022514343
loss_pred:0.028996914625167847, decouple_loss:0.008360516279935837
loss_pred:0.029821129515767097, decouple_loss:0.008263400755822659
The generated pressure mean: 0.4435940384864807
loss_pred:0.030572369694709778, decouple_loss:0.008231999352574348
Iteration: 3729, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44597405195236206
loss_pred:0.028810415416955948, decouple_loss:0.011840995401144028
The generated pressure mean: 0.4447002410888672
loss_pred:0.029229415580630302, decouple_loss:0.011684723198413849
The generated pressure mean: 0.4385734498500824
loss_pred:0.02745094522833824, decouple_loss:0.011416839435696602
Iteration: 3730, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469979703426361
loss_pred:0.02894621342420578, decouple_loss:0.011174158193171024
The generated pressure mean: 0.4460631012916565
loss_pred:0.028318272903561592, decouple_loss:0.010029524564743042
The generated pressure mean: 0.44867458939552307
loss_pred:0.02830699272453785, decouple_loss:0.010191386565566063
2023-04-17 02:06:39 testing...
The generated pressure mean: 0.4180402457714081
The generated pressure mean: 0.42319148778915405
loss_pred:0.04035312309861183, decouple_loss:0.010996988043189049
The generated pressure mean: 0.4254213869571686
loss_pred:0.03906591609120369, decouple_loss:0.01161796972155571
loss_pred:0.03887685015797615, decouple_loss:0.011626509949564934
WV_0_PC_0_EH_1_PS_40, loss: 0.04000265523791313, avg_mse: 0.05233052745461464
current test mse: 0.052331
Iteration: 3731, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447648823261261
The generated pressure mean: 0.44734659790992737
loss_pred:0.029262982308864594, decouple_loss:0.010371739976108074
loss_pred:0.028926389291882515, decouple_loss:0.010596992447972298
The generated pressure mean: 0.4417414665222168
loss_pred:0.028457673266530037, decouple_loss:0.009842674247920513
Iteration: 3732, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4621763825416565
The generated pressure mean: 0.4611075818538666
loss_pred:0.0282660573720932, decouple_loss:0.009509633295238018
loss_pred:0.029302574694156647, decouple_loss:0.00955553725361824
The generated pressure mean: 0.46097531914711
loss_pred:0.02967005781829357, decouple_loss:0.009758969768881798
Iteration: 3733, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482126832008362
The generated pressure mean: 0.4504186809062958
loss_pred:0.03049914911389351, decouple_loss:0.011090622283518314
loss_pred:0.03010900318622589, decouple_loss:0.011270266957581043
The generated pressure mean: 0.45396295189857483
loss_pred:0.027858197689056396, decouple_loss:0.010498766787350178
Iteration: 3734, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4301592707633972
The generated pressure mean: 0.4316282272338867
loss_pred:0.02896265685558319, decouple_loss:0.009196167811751366
loss_pred:0.02809692919254303, decouple_loss:0.009039626456797123
The generated pressure mean: 0.43302133679389954
loss_pred:0.028201797977089882, decouple_loss:0.009305618703365326
Iteration: 3735, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4404785633087158
The generated pressure mean: 0.4496278762817383
loss_pred:0.02699257805943489, decouple_loss:0.010782172903418541
loss_pred:0.02805454097688198, decouple_loss:0.010625239461660385
The generated pressure mean: 0.4497721791267395
loss_pred:0.029881052672863007, decouple_loss:0.010383904911577702
Iteration: 3736, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45525118708610535
The generated pressure mean: 0.45662158727645874
loss_pred:0.03026655688881874, decouple_loss:0.00908560398966074
loss_pred:0.029173891991376877, decouple_loss:0.009011760354042053
The generated pressure mean: 0.4632091522216797
loss_pred:0.028774188831448555, decouple_loss:0.00894505251199007
Iteration: 3737, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4528721868991852
loss_pred:0.02955343760550022, decouple_loss:0.00891508162021637
The generated pressure mean: 0.45807182788848877
loss_pred:0.02936973050236702, decouple_loss:0.009294161573052406
The generated pressure mean: 0.4509831666946411
loss_pred:0.029001183807849884, decouple_loss:0.009335792623460293
Iteration: 3738, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4434996545314789
The generated pressure mean: 0.44213950634002686
loss_pred:0.02855706959962845, decouple_loss:0.008570313453674316
loss_pred:0.02894805371761322, decouple_loss:0.008363104425370693
The generated pressure mean: 0.4403640627861023
loss_pred:0.029330415651202202, decouple_loss:0.008219203911721706
Iteration: 3739, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45387592911720276
The generated pressure mean: 0.4493717849254608
loss_pred:0.028177352622151375, decouple_loss:0.010750013403594494
loss_pred:0.02887560985982418, decouple_loss:0.009775128215551376
The generated pressure mean: 0.4482356607913971
loss_pred:0.02799433469772339, decouple_loss:0.01029968075454235
Iteration: 3740, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45030808448791504
loss_pred:0.02913428097963333, decouple_loss:0.00893481820821762
The generated pressure mean: 0.44742006063461304
loss_pred:0.027981871739029884, decouple_loss:0.009276146069169044
The generated pressure mean: 0.4492945671081543
loss_pred:0.029566926881670952, decouple_loss:0.008995016105473042
2023-04-17 02:08:30 testing...
The generated pressure mean: 0.4196048378944397
The generated pressure mean: 0.4250253140926361
The generated pressure mean: 0.42694395780563354
loss_pred:0.04100591689348221, decouple_loss:0.008334903046488762
loss_pred:0.040037013590335846, decouple_loss:0.008646279573440552
loss_pred:0.039992984384298325, decouple_loss:0.008805917575955391
WV_0_PC_0_EH_1_PS_40, loss: 0.04077509045600891, avg_mse: 0.05440904572606087
current test mse: 0.054409
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 3741, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44099941849708557
loss_pred:0.029340870678424835, decouple_loss:0.00853847898542881
The generated pressure mean: 0.4356887638568878
loss_pred:0.028132690116763115, decouple_loss:0.0085062887519598
The generated pressure mean: 0.43989822268486023
loss_pred:0.02747371606528759, decouple_loss:0.008102519437670708
Iteration: 3742, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46351897716522217
loss_pred:0.029422514140605927, decouple_loss:0.011764376424252987
The generated pressure mean: 0.46802693605422974
loss_pred:0.027899527922272682, decouple_loss:0.011776566505432129
The generated pressure mean: 0.4671887755393982
loss_pred:0.029852472245693207, decouple_loss:0.011581547558307648
Iteration: 3743, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4296141564846039
The generated pressure mean: 0.42738205194473267
loss_pred:0.029220597818493843, decouple_loss:0.008665310218930244
loss_pred:0.028346430510282516, decouple_loss:0.008895144797861576
The generated pressure mean: 0.42469730973243713
loss_pred:0.02803889475762844, decouple_loss:0.00889677181839943
Iteration: 3744, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4719834625720978
The generated pressure mean: 0.47091156244277954
loss_pred:0.029235072433948517, decouple_loss:0.012132533825933933
loss_pred:0.0287723820656538, decouple_loss:0.012489843182265759
The generated pressure mean: 0.47328394651412964
loss_pred:0.031832631677389145, decouple_loss:0.011824878863990307
Iteration: 3745, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4029715657234192
The generated pressure mean: 0.3980269134044647
loss_pred:0.030740074813365936, decouple_loss:0.010452406480908394
loss_pred:0.02950024977326393, decouple_loss:0.010661354288458824
The generated pressure mean: 0.4007675051689148
loss_pred:0.02918894775211811, decouple_loss:0.01050263550132513
Iteration: 3746, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4887738525867462
The generated pressure mean: 0.493691623210907
loss_pred:0.02773597277700901, decouple_loss:0.009584096260368824
loss_pred:0.03084614686667919, decouple_loss:0.009533936157822609
The generated pressure mean: 0.49070456624031067
loss_pred:0.028368240222334862, decouple_loss:0.009487682953476906
Iteration: 3747, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44570234417915344
The generated pressure mean: 0.44836434721946716
loss_pred:0.028343399986624718, decouple_loss:0.008686870336532593
loss_pred:0.028628263622522354, decouple_loss:0.00854687299579382
The generated pressure mean: 0.4508238136768341
loss_pred:0.029636355116963387, decouple_loss:0.008855030871927738
Iteration: 3748, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.40765905380249023
The generated pressure mean: 0.4060855507850647
loss_pred:0.029890526086091995, decouple_loss:0.008750585839152336
loss_pred:0.029036665335297585, decouple_loss:0.009174089878797531
The generated pressure mean: 0.4056428372859955
loss_pred:0.028550192713737488, decouple_loss:0.009015181101858616
Iteration: 3749, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47277718782424927
The generated pressure mean: 0.4757035970687866
loss_pred:0.02683093771338463, decouple_loss:0.007827485911548138
loss_pred:0.02800448052585125, decouple_loss:0.007602023892104626
The generated pressure mean: 0.47042718529701233
loss_pred:0.029295016080141068, decouple_loss:0.007789216469973326
Iteration: 3750, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47692081332206726
loss_pred:0.027608217671513557, decouple_loss:0.007810474373400211
The generated pressure mean: 0.47538572549819946
loss_pred:0.026779696345329285, decouple_loss:0.007434212137013674
The generated pressure mean: 0.47754421830177307
loss_pred:0.028744949027895927, decouple_loss:0.007813824340701103
2023-04-17 02:10:58 testing...
The generated pressure mean: 0.42167195677757263
The generated pressure mean: 0.42601460218429565
loss_pred:0.04112209752202034, decouple_loss:0.007721616420894861
The generated pressure mean: 0.42744776606559753
loss_pred:0.04064895957708359, decouple_loss:0.00796749722212553
loss_pred:0.0403553806245327, decouple_loss:0.007952394895255566
WV_0_PC_0_EH_1_PS_40, loss: 0.04110283777117729, avg_mse: 0.05459490418434143
current test mse: 0.054595
Iteration: 3751, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.41897666454315186The generated pressure mean: 0.4202975034713745
loss_pred:0.02878858707845211, decouple_loss:0.007953175343573093
loss_pred:0.030648481100797653, decouple_loss:0.007579339202493429
The generated pressure mean: 0.4201090931892395
loss_pred:0.029832087457180023, decouple_loss:0.007574096322059631
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3752, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44471845030784607
The generated pressure mean: 0.44439786672592163
loss_pred:0.02990005537867546, decouple_loss:0.008848320692777634
loss_pred:0.029270116239786148, decouple_loss:0.008650338277220726
The generated pressure mean: 0.448024183511734
loss_pred:0.028836162760853767, decouple_loss:0.008709589019417763
Iteration: 3753, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46255746483802795
The generated pressure mean: 0.46123072504997253
loss_pred:0.02945389598608017, decouple_loss:0.008721748366951942
loss_pred:0.029393384233117104, decouple_loss:0.008756255730986595
The generated pressure mean: 0.4619421660900116
loss_pred:0.02964872494339943, decouple_loss:0.008715217933058739
Iteration: 3754, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4256511628627777
The generated pressure mean: 0.4229765236377716
loss_pred:0.030552785843610764, decouple_loss:0.007802045904099941
loss_pred:0.02863449975848198, decouple_loss:0.007969418540596962
The generated pressure mean: 0.42629754543304443
loss_pred:0.029374638572335243, decouple_loss:0.00783073715865612
Iteration: 3755, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46157392859458923
loss_pred:0.027992265298962593, decouple_loss:0.006867270451039076
The generated pressure mean: 0.46171826124191284
loss_pred:0.028012970462441444, decouple_loss:0.006839239038527012
The generated pressure mean: 0.46338608860969543
loss_pred:0.030599093064665794, decouple_loss:0.0065329428762197495
Iteration: 3756, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45355358719825745
loss_pred:0.029560115188360214, decouple_loss:0.009653161279857159
The generated pressure mean: 0.4526558220386505
loss_pred:0.031143344938755035, decouple_loss:0.009939098730683327
The generated pressure mean: 0.45643991231918335
loss_pred:0.028832530602812767, decouple_loss:0.009829091839492321
Iteration: 3757, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.433456152677536
loss_pred:0.028255531564354897, decouple_loss:0.0073785181157290936
The generated pressure mean: 0.4342571496963501
loss_pred:0.027242906391620636, decouple_loss:0.007441135123372078
The generated pressure mean: 0.43505263328552246
loss_pred:0.028589529916644096, decouple_loss:0.007465652655810118
Iteration: 3758, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43497681617736816
loss_pred:0.029043005779385567, decouple_loss:0.010381489060819149
The generated pressure mean: 0.43335026502609253
loss_pred:0.027609728276729584, decouple_loss:0.010065117850899696
The generated pressure mean: 0.4258824288845062
loss_pred:0.02911643125116825, decouple_loss:0.010004461742937565
Iteration: 3759, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.466526597738266
The generated pressure mean: 0.46266090869903564loss_pred:0.027986343950033188, decouple_loss:0.00800124742090702
loss_pred:0.02796000987291336, decouple_loss:0.007579494267702103
The generated pressure mean: 0.465800017118454
loss_pred:0.027433207258582115, decouple_loss:0.007763656321913004
Iteration: 3760, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46847593784332275
loss_pred:0.028751643374562263, decouple_loss:0.00903576985001564
The generated pressure mean: 0.4663774073123932
loss_pred:0.029397355392575264, decouple_loss:0.009023845195770264
The generated pressure mean: 0.46691712737083435
loss_pred:0.029506143182516098, decouple_loss:0.009305806830525398
2023-04-17 02:12:50 testing...
The generated pressure mean: 0.4216020107269287
The generated pressure mean: 0.42625921964645386
The generated pressure mean: 0.42806005477905273
loss_pred:0.03980305790901184, decouple_loss:0.008330580778419971
loss_pred:0.03919847309589386, decouple_loss:0.008660465478897095
loss_pred:0.03894428908824921, decouple_loss:0.00885707326233387
WV_0_PC_0_EH_1_PS_40, loss: 0.03974607586860657, avg_mse: 0.05216381698846817
current test mse: 0.052164
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 3761, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4220801889896393
The generated pressure mean: 0.42490705847740173
loss_pred:0.027969492599368095, decouple_loss:0.008395157754421234
loss_pred:0.027425408363342285, decouple_loss:0.008233554661273956
The generated pressure mean: 0.41974693536758423
loss_pred:0.02742793597280979, decouple_loss:0.008287904784083366
Iteration: 3762, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43218284845352173
The generated pressure mean: 0.4333271384239197
loss_pred:0.028911709785461426, decouple_loss:0.007548568304628134
loss_pred:0.028697364032268524, decouple_loss:0.006926485802978277
The generated pressure mean: 0.4341166019439697
loss_pred:0.0293528214097023, decouple_loss:0.006899998988956213
Iteration: 3763, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4581238627433777
loss_pred:0.02901539020240307, decouple_loss:0.008254063315689564
The generated pressure mean: 0.4544445872306824
loss_pred:0.028362726792693138, decouple_loss:0.008378940634429455
The generated pressure mean: 0.45425310730934143
loss_pred:0.027785053476691246, decouple_loss:0.008054396137595177
Iteration: 3764, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47143036127090454
The generated pressure mean: 0.46670055389404297
loss_pred:0.029030514881014824, decouple_loss:0.007300053257495165
loss_pred:0.026358624920248985, decouple_loss:0.006955720949918032
The generated pressure mean: 0.4686892628669739
loss_pred:0.026536671444773674, decouple_loss:0.007408829405903816
Iteration: 3765, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44197580218315125
The generated pressure mean: 0.4439956247806549
loss_pred:0.027340268716216087, decouple_loss:0.00731921661645174
loss_pred:0.029251592233777046, decouple_loss:0.007797764148563147
The generated pressure mean: 0.43930768966674805
loss_pred:0.02676383964717388, decouple_loss:0.00746082654222846
Iteration: 3766, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.41995397210121155
The generated pressure mean: 0.4219503402709961
loss_pred:0.030534915626049042, decouple_loss:0.0066316938027739525
loss_pred:0.027784176170825958, decouple_loss:0.006758515257388353
The generated pressure mean: 0.4241492748260498
loss_pred:0.028626300394535065, decouple_loss:0.006526182871311903
Iteration: 3767, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4693391025066376
The generated pressure mean: 0.4665963649749756
loss_pred:0.02719278074800968, decouple_loss:0.0073274606838822365
loss_pred:0.029165148735046387, decouple_loss:0.007392094470560551
The generated pressure mean: 0.46629220247268677
loss_pred:0.027339136227965355, decouple_loss:0.007415135391056538
Iteration: 3768, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460650384426117
loss_pred:0.028977710753679276, decouple_loss:0.0070397513918578625
The generated pressure mean: 0.447654128074646
loss_pred:0.029392573982477188, decouple_loss:0.00697071710601449
The generated pressure mean: 0.4500950276851654
loss_pred:0.02718127891421318, decouple_loss:0.006869039498269558
Iteration: 3769, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43361589312553406
The generated pressure mean: 0.43423759937286377
loss_pred:0.027166951447725296, decouple_loss:0.00689734285697341
loss_pred:0.028095396235585213, decouple_loss:0.007105333264917135
The generated pressure mean: 0.434213787317276
loss_pred:0.02840328775346279, decouple_loss:0.006939782295376062
Iteration: 3770, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4567812383174896
loss_pred:0.027849016711115837, decouple_loss:0.0065667335875332355
The generated pressure mean: 0.4565749764442444
loss_pred:0.0283049363642931, decouple_loss:0.006708033848553896
The generated pressure mean: 0.45584920048713684
loss_pred:0.028289705514907837, decouple_loss:0.006632890086621046
2023-04-17 02:15:20 testing...
The generated pressure mean: 0.41564005613327026
The generated pressure mean: 0.4210108518600464
The generated pressure mean: 0.42365872859954834
loss_pred:0.04042186215519905, decouple_loss:0.008546024560928345
loss_pred:0.03963709995150566, decouple_loss:0.009122554212808609
loss_pred:0.03926117718219757, decouple_loss:0.00923231616616249
WV_0_PC_0_EH_1_PS_40, loss: 0.04022172838449478, avg_mse: 0.05359174311161041
current test mse: 0.053592
Iteration: 3771, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45271268486976624
The generated pressure mean: 0.44700440764427185
loss_pred:0.027881881222128868, decouple_loss:0.0072061968967318535
loss_pred:0.0264856219291687, decouple_loss:0.007059807423502207
The generated pressure mean: 0.4498825967311859
loss_pred:0.02732512541115284, decouple_loss:0.007238874677568674
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3772, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4544065296649933
loss_pred:0.02851887233555317, decouple_loss:0.006671896204352379
The generated pressure mean: 0.45840656757354736
loss_pred:0.030428597703576088, decouple_loss:0.006472775246948004
The generated pressure mean: 0.4550124406814575
loss_pred:0.02654246985912323, decouple_loss:0.006340899039059877
Iteration: 3773, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4248611330986023The generated pressure mean: 0.42762354016304016
loss_pred:0.028615521267056465, decouple_loss:0.006650947500020266
loss_pred:0.027094481512904167, decouple_loss:0.006728488486260176
The generated pressure mean: 0.4290716350078583
loss_pred:0.027850082144141197, decouple_loss:0.00669895438477397
Iteration: 3774, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45316803455352783
The generated pressure mean: 0.44922661781311035
loss_pred:0.02805468998849392, decouple_loss:0.006652236916124821
loss_pred:0.027853041887283325, decouple_loss:0.006349127274006605
The generated pressure mean: 0.45090311765670776
loss_pred:0.028326189145445824, decouple_loss:0.006486966740339994
Iteration: 3775, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4601452648639679
The generated pressure mean: 0.45683395862579346
loss_pred:0.028309525921940804, decouple_loss:0.006950478535145521
loss_pred:0.02762424759566784, decouple_loss:0.007286878768354654
The generated pressure mean: 0.4619695842266083
loss_pred:0.027973594143986702, decouple_loss:0.007166352588683367
Iteration: 3776, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4432849884033203
The generated pressure mean: 0.4447360634803772
loss_pred:0.027934281155467033, decouple_loss:0.0064029754139482975
loss_pred:0.028955118730664253, decouple_loss:0.0062177181243896484
The generated pressure mean: 0.44068583846092224
loss_pred:0.027768341824412346, decouple_loss:0.006141589488834143
Iteration: 3777, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4358706474304199
The generated pressure mean: 0.43590861558914185
loss_pred:0.02682117186486721, decouple_loss:0.0074598356150090694
loss_pred:0.027949977666139603, decouple_loss:0.007452939637005329
The generated pressure mean: 0.4374762773513794
loss_pred:0.02685059793293476, decouple_loss:0.007391531020402908
Iteration: 3778, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4509717524051666
loss_pred:0.028001099824905396, decouple_loss:0.007028382271528244
The generated pressure mean: 0.45154058933258057
loss_pred:0.026577064767479897, decouple_loss:0.006961043458431959
The generated pressure mean: 0.45353758335113525
loss_pred:0.028755808249115944, decouple_loss:0.006752511020749807
Iteration: 3779, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4594282805919647
loss_pred:0.026846760883927345, decouple_loss:0.007935522124171257
The generated pressure mean: 0.4584665298461914
loss_pred:0.027752874419093132, decouple_loss:0.007933070883154869
The generated pressure mean: 0.4616466462612152
loss_pred:0.027045100927352905, decouple_loss:0.007915752939879894
Iteration: 3780, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4383580684661865
loss_pred:0.027362773194909096, decouple_loss:0.007664510514587164
The generated pressure mean: 0.4404526352882385
loss_pred:0.0282198004424572, decouple_loss:0.007458031643182039
The generated pressure mean: 0.44393518567085266
loss_pred:0.028028763830661774, decouple_loss:0.0074959020130336285
2023-04-17 02:17:12 testing...
The generated pressure mean: 0.42084309458732605
The generated pressure mean: 0.4270790219306946
The generated pressure mean: 0.4291103482246399
loss_pred:0.03978065028786659, decouple_loss:0.008044172078371048
loss_pred:0.03904947638511658, decouple_loss:0.008598973974585533
loss_pred:0.0388127937912941, decouple_loss:0.008771450258791447
WV_0_PC_0_EH_1_PS_40, loss: 0.039637885987758636, avg_mse: 0.05278106406331062
current test mse: 0.052781
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 3781, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.428810715675354
loss_pred:0.02634713612496853, decouple_loss:0.007451685611158609
The generated pressure mean: 0.4294700622558594
loss_pred:0.028952492401003838, decouple_loss:0.008088638074696064
The generated pressure mean: 0.42613115906715393
loss_pred:0.028456201776862144, decouple_loss:0.007255269680172205
Iteration: 3782, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4566006064414978
The generated pressure mean: 0.4562107026576996
loss_pred:0.03022133745253086, decouple_loss:0.009837884455919266
loss_pred:0.02805475890636444, decouple_loss:0.009762285277247429
The generated pressure mean: 0.459458589553833
loss_pred:0.02743046171963215, decouple_loss:0.009477917104959488
Iteration: 3783, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.459974080324173
The generated pressure mean: 0.46314144134521484
loss_pred:0.028102897107601166, decouple_loss:0.00809553638100624
loss_pred:0.02769271470606327, decouple_loss:0.00804566778242588
The generated pressure mean: 0.4552464783191681
loss_pred:0.02638050727546215, decouple_loss:0.007726109586656094
Iteration: 3784, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4421845078468323
loss_pred:0.02499890886247158, decouple_loss:0.009725820273160934
The generated pressure mean: 0.4451669454574585
loss_pred:0.02896340936422348, decouple_loss:0.009499294683337212
The generated pressure mean: 0.4462869167327881
loss_pred:0.028044123202562332, decouple_loss:0.00918193906545639
Iteration: 3785, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45209649205207825
The generated pressure mean: 0.4528762996196747
loss_pred:0.027520446106791496, decouple_loss:0.008505508303642273
loss_pred:0.027396177873015404, decouple_loss:0.008788196370005608
The generated pressure mean: 0.4460463523864746
loss_pred:0.031040389090776443, decouple_loss:0.008763965219259262
Iteration: 3786, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42339256405830383
loss_pred:0.027821457013487816, decouple_loss:0.009136519394814968
The generated pressure mean: 0.4263230562210083
loss_pred:0.0270770825445652, decouple_loss:0.00871277879923582
The generated pressure mean: 0.42649123072624207
loss_pred:0.02699575386941433, decouple_loss:0.00909457542002201
Iteration: 3787, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46361202001571655
loss_pred:0.029412684962153435, decouple_loss:0.009765243157744408
The generated pressure mean: 0.4604555070400238
loss_pred:0.027003083378076553, decouple_loss:0.00907966773957014
The generated pressure mean: 0.4613713026046753
loss_pred:0.02813190221786499, decouple_loss:0.009215055964887142
Iteration: 3788, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.464923232793808
The generated pressure mean: 0.46637076139450073
loss_pred:0.028059834614396095, decouple_loss:0.008211841806769371
loss_pred:0.028200676664710045, decouple_loss:0.008548501878976822
The generated pressure mean: 0.4668642580509186
loss_pred:0.028093168511986732, decouple_loss:0.008375868201255798
Iteration: 3789, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.425941526889801The generated pressure mean: 0.42775025963783264
loss_pred:0.029356662184000015, decouple_loss:0.008994842879474163
loss_pred:0.028784306719899178, decouple_loss:0.009058866649866104
The generated pressure mean: 0.4345352053642273
loss_pred:0.028245192021131516, decouple_loss:0.008949564769864082
Iteration: 3790, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45315369963645935
loss_pred:0.02679683268070221, decouple_loss:0.008005931973457336
The generated pressure mean: 0.4491647481918335
loss_pred:0.029537539929151535, decouple_loss:0.007703548762947321
The generated pressure mean: 0.4503023028373718
loss_pred:0.026645217090845108, decouple_loss:0.007923559285700321
2023-04-17 02:19:39 testing...
The generated pressure mean: 0.41607388854026794
The generated pressure mean: 0.42207497358322144
The generated pressure mean: 0.42466625571250916
loss_pred:0.04260748624801636, decouple_loss:0.009004835970699787
loss_pred:0.0414891317486763, decouple_loss:0.009375213645398617
loss_pred:0.040931835770606995, decouple_loss:0.009685584343969822
WV_0_PC_0_EH_1_PS_40, loss: 0.04214391112327576, avg_mse: 0.05808177590370178
current test mse: 0.058082
Iteration: 3791, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506489932537079
loss_pred:0.028047246858477592, decouple_loss:0.008564027026295662
The generated pressure mean: 0.4492649734020233
loss_pred:0.027097120881080627, decouple_loss:0.008397720754146576
The generated pressure mean: 0.4497697949409485
loss_pred:0.03047172911465168, decouple_loss:0.008265668526291847
Iteration: 3792, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4236438274383545
loss_pred:0.028347305953502655, decouple_loss:0.008579520508646965
The generated pressure mean: 0.41883233189582825
loss_pred:0.026299666613340378, decouple_loss:0.008148538880050182
The generated pressure mean: 0.41679564118385315
loss_pred:0.030465368181467056, decouple_loss:0.008571392856538296
Iteration: 3793, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47684192657470703
loss_pred:0.02724851481616497, decouple_loss:0.00771866412833333
The generated pressure mean: 0.4763237237930298
loss_pred:0.028324365615844727, decouple_loss:0.00761838024482131
The generated pressure mean: 0.47247299551963806
loss_pred:0.027467332780361176, decouple_loss:0.007694094441831112
Iteration: 3794, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4661868214607239
The generated pressure mean: 0.4689643085002899
loss_pred:0.02689911052584648, decouple_loss:0.008459883742034435
loss_pred:0.026670899242162704, decouple_loss:0.008665047585964203
The generated pressure mean: 0.4700070023536682
loss_pred:0.027517123147845268, decouple_loss:0.008849915117025375
Iteration: 3795, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4163283109664917
loss_pred:0.027599016204476357, decouple_loss:0.009273571893572807
The generated pressure mean: 0.41701045632362366
loss_pred:0.026681827381253242, decouple_loss:0.009375014342367649
The generated pressure mean: 0.41597265005111694
loss_pred:0.028116101399064064, decouple_loss:0.00903385691344738
Iteration: 3796, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4401417672634125
loss_pred:0.02714698389172554, decouple_loss:0.007603819482028484
The generated pressure mean: 0.4404657781124115
loss_pred:0.026020508259534836, decouple_loss:0.007648222614079714
The generated pressure mean: 0.4433196485042572
loss_pred:0.027630379423499107, decouple_loss:0.00740406196564436
Iteration: 3797, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4674098789691925
loss_pred:0.027207937091588974, decouple_loss:0.00907911267131567
The generated pressure mean: 0.4695429503917694
loss_pred:0.02668769657611847, decouple_loss:0.009040944278240204
The generated pressure mean: 0.474246084690094
loss_pred:0.02667776681482792, decouple_loss:0.009273401461541653
Iteration: 3798, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45563846826553345The generated pressure mean: 0.45123186707496643
loss_pred:0.028026316314935684, decouple_loss:0.008220210671424866
loss_pred:0.02558513917028904, decouple_loss:0.008106905035674572
The generated pressure mean: 0.45238953828811646
loss_pred:0.027886642143130302, decouple_loss:0.00807129591703415
Iteration: 3799, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42938557267189026
loss_pred:0.02823018841445446, decouple_loss:0.008636250160634518
The generated pressure mean: 0.431572288274765
loss_pred:0.026839198544621468, decouple_loss:0.00858644675463438
The generated pressure mean: 0.4364522397518158
loss_pred:0.02786104567348957, decouple_loss:0.009120305068790913
Iteration: 3800, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44369250535964966
loss_pred:0.028614435344934464, decouple_loss:0.008185693062841892
The generated pressure mean: 0.4415304958820343
loss_pred:0.026768911629915237, decouple_loss:0.008314392529428005
The generated pressure mean: 0.44730985164642334
loss_pred:0.02913718856871128, decouple_loss:0.008092552423477173
2023-04-17 02:21:34 testing...
The generated pressure mean: 0.41253429651260376
The generated pressure mean: 0.4188574254512787
loss_pred:0.04152289777994156, decouple_loss:0.00975246075540781
The generated pressure mean: 0.42102155089378357
loss_pred:0.04012877866625786, decouple_loss:0.010370403528213501
loss_pred:0.03978103771805763, decouple_loss:0.010613673366606236
WV_0_PC_0_EH_1_PS_40, loss: 0.040989845991134644, avg_mse: 0.05551888048648834
current test mse: 0.055519
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 3801, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4604656994342804
loss_pred:0.027298612520098686, decouple_loss:0.008687963709235191
The generated pressure mean: 0.4624735713005066
loss_pred:0.029547104611992836, decouple_loss:0.008844680152833462
The generated pressure mean: 0.46419137716293335
loss_pred:0.028650280088186264, decouple_loss:0.008578061126172543
Iteration: 3802, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44461116194725037
The generated pressure mean: 0.44218629598617554
loss_pred:0.025483062490820885, decouple_loss:0.008872256614267826
loss_pred:0.026124613359570503, decouple_loss:0.008650898933410645
The generated pressure mean: 0.4427017271518707
loss_pred:0.0280087161809206, decouple_loss:0.008793310262262821
Iteration: 3803, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4323793053627014
The generated pressure mean: 0.43230098485946655
loss_pred:0.027798006311058998, decouple_loss:0.007808821275830269
loss_pred:0.02782672829926014, decouple_loss:0.0077815609984099865
The generated pressure mean: 0.43531760573387146
loss_pred:0.028744710609316826, decouple_loss:0.007978396490216255
Iteration: 3804, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4533225893974304
The generated pressure mean: 0.4545956552028656
loss_pred:0.028223421424627304, decouple_loss:0.008181825280189514
loss_pred:0.028919890522956848, decouple_loss:0.00823044590651989
The generated pressure mean: 0.45014268159866333
loss_pred:0.026731643825769424, decouple_loss:0.008140821941196918
Iteration: 3805, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4533311426639557
The generated pressure mean: 0.4514271914958954
loss_pred:0.026973458006978035, decouple_loss:0.008073663339018822
loss_pred:0.026921581476926804, decouple_loss:0.007772977463901043
The generated pressure mean: 0.4521278440952301
loss_pred:0.02776467613875866, decouple_loss:0.008013718761503696
Iteration: 3806, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481957256793976
The generated pressure mean: 0.44638997316360474
loss_pred:0.030633093789219856, decouple_loss:0.008836579509079456
loss_pred:0.026941318064928055, decouple_loss:0.008810595609247684
The generated pressure mean: 0.4450547695159912
loss_pred:0.02562476135790348, decouple_loss:0.008684947155416012
Iteration: 3807, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43488484621047974
loss_pred:0.029395943507552147, decouple_loss:0.006915316917002201
The generated pressure mean: 0.4439043700695038
loss_pred:0.027935797348618507, decouple_loss:0.007082193158566952
The generated pressure mean: 0.437782883644104
loss_pred:0.029367154464125633, decouple_loss:0.007201060652732849
Iteration: 3808, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44465887546539307
The generated pressure mean: 0.44267985224723816
loss_pred:0.027104929089546204, decouple_loss:0.008483503945171833
loss_pred:0.02662508562207222, decouple_loss:0.008512817323207855
The generated pressure mean: 0.44549721479415894
loss_pred:0.028880441561341286, decouple_loss:0.008607236668467522
Iteration: 3809, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46025800704956055
The generated pressure mean: 0.4571031630039215
loss_pred:0.03001249209046364, decouple_loss:0.00909356214106083
loss_pred:0.027272744104266167, decouple_loss:0.008701056241989136
The generated pressure mean: 0.45959943532943726
loss_pred:0.028493020683526993, decouple_loss:0.009031296707689762
Iteration: 3810, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4378162622451782
loss_pred:0.026102712377905846, decouple_loss:0.00713587598875165
The generated pressure mean: 0.4389636516571045
loss_pred:0.027662262320518494, decouple_loss:0.006683025509119034
The generated pressure mean: 0.4390314817428589
loss_pred:0.027208076789975166, decouple_loss:0.006850275211036205
2023-04-17 02:24:03 testing...
The generated pressure mean: 0.41783836483955383
The generated pressure mean: 0.42332398891448975
The generated pressure mean: 0.42523086071014404
loss_pred:0.039900340139865875, decouple_loss:0.011378969065845013
loss_pred:0.038775455206632614, decouple_loss:0.011877618730068207
loss_pred:0.03808685392141342, decouple_loss:0.01196079421788454
WV_0_PC_0_EH_1_PS_40, loss: 0.03950783982872963, avg_mse: 0.05224640667438507
current test mse: 0.052246
Iteration: 3811, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44040510058403015
loss_pred:0.02699156664311886, decouple_loss:0.009803887456655502
The generated pressure mean: 0.4400860369205475
loss_pred:0.02720564790070057, decouple_loss:0.009746944531798363
The generated pressure mean: 0.43586108088493347
loss_pred:0.026001999154686928, decouple_loss:0.010322123765945435
Iteration: 3812, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4585345387458801
loss_pred:0.02820601686835289, decouple_loss:0.008105700835585594
The generated pressure mean: 0.45444926619529724
loss_pred:0.026223599910736084, decouple_loss:0.007996264845132828
The generated pressure mean: 0.45467326045036316
loss_pred:0.028239451348781586, decouple_loss:0.00801253505051136
Iteration: 3813, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4514305293560028
loss_pred:0.028474172577261925, decouple_loss:0.009129242040216923
The generated pressure mean: 0.44952601194381714
loss_pred:0.029289307072758675, decouple_loss:0.008916572667658329
The generated pressure mean: 0.44813698530197144
loss_pred:0.030698049813508987, decouple_loss:0.00890702661126852
Iteration: 3814, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42372727394104004
loss_pred:0.02701101079583168, decouple_loss:0.00823140423744917
The generated pressure mean: 0.4232228696346283
loss_pred:0.02778887376189232, decouple_loss:0.007932452484965324
The generated pressure mean: 0.4274265468120575
loss_pred:0.026736557483673096, decouple_loss:0.007990891113877296
Iteration: 3815, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4676421880722046
loss_pred:0.02827085368335247, decouple_loss:0.00825735367834568
The generated pressure mean: 0.46548914909362793
loss_pred:0.027260102331638336, decouple_loss:0.008238041773438454
The generated pressure mean: 0.46787047386169434
loss_pred:0.027661927044391632, decouple_loss:0.008060894906520844
Iteration: 3816, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4615750014781952
loss_pred:0.02592414803802967, decouple_loss:0.008452161215245724
The generated pressure mean: 0.46518781781196594
loss_pred:0.028076162561774254, decouple_loss:0.008459798991680145
The generated pressure mean: 0.46350085735321045
loss_pred:0.027975063771009445, decouple_loss:0.008395865559577942
Iteration: 3817, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.429749071598053
loss_pred:0.028770823031663895, decouple_loss:0.007647173013538122
The generated pressure mean: 0.4304060637950897
loss_pred:0.028737394139170647, decouple_loss:0.0075866165570914745
The generated pressure mean: 0.4298425316810608
loss_pred:0.02819032035768032, decouple_loss:0.007423453964293003
Iteration: 3818, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4320509135723114
The generated pressure mean: 0.42996570467948914
loss_pred:0.027544252574443817, decouple_loss:0.00948595255613327
loss_pred:0.026483438909053802, decouple_loss:0.009194623678922653
The generated pressure mean: 0.4308134913444519
loss_pred:0.028698284178972244, decouple_loss:0.009453406557440758
Iteration: 3819, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47042208909988403
loss_pred:0.027308108285069466, decouple_loss:0.007537438068538904
The generated pressure mean: 0.4728367030620575
loss_pred:0.028644176200032234, decouple_loss:0.007820379920303822
The generated pressure mean: 0.4700412154197693
loss_pred:0.02792956866323948, decouple_loss:0.008426678366959095
Iteration: 3820, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45251601934432983
loss_pred:0.026304082944989204, decouple_loss:0.007359952200204134
The generated pressure mean: 0.45057734847068787
loss_pred:0.02677089534699917, decouple_loss:0.007330686319619417
The generated pressure mean: 0.45161089301109314
loss_pred:0.028122084215283394, decouple_loss:0.007447909563779831
2023-04-17 02:25:56 testing...
The generated pressure mean: 0.41965267062187195
The generated pressure mean: 0.4242081940174103
loss_pred:0.04071243107318878, decouple_loss:0.008640176616609097
The generated pressure mean: 0.42617279291152954
loss_pred:0.0396081805229187, decouple_loss:0.00861095730215311
loss_pred:0.03944640979170799, decouple_loss:0.00881930347532034
WV_0_PC_0_EH_1_PS_40, loss: 0.040356848388910294, avg_mse: 0.053995247930288315
current test mse: 0.053995
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 3821, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4312926232814789
loss_pred:0.028158213943243027, decouple_loss:0.00882591214030981
The generated pressure mean: 0.4300682246685028
loss_pred:0.026853743940591812, decouple_loss:0.008935944177210331
The generated pressure mean: 0.4287757873535156
loss_pred:0.0286801066249609, decouple_loss:0.009075864218175411
Iteration: 3822, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45121365785598755
The generated pressure mean: 0.4452948570251465
loss_pred:0.027588026598095894, decouple_loss:0.009430980309844017
loss_pred:0.027143171057105064, decouple_loss:0.008583158254623413
The generated pressure mean: 0.4493634104728699
loss_pred:0.026253052055835724, decouple_loss:0.008669479750096798
Iteration: 3823, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45342889428138733
The generated pressure mean: 0.4560631811618805
loss_pred:0.02804606780409813, decouple_loss:0.008338402025401592
loss_pred:0.028533654287457466, decouple_loss:0.008701931685209274
The generated pressure mean: 0.45692551136016846
loss_pred:0.02819722332060337, decouple_loss:0.008672982454299927
Iteration: 3824, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43768611550331116
The generated pressure mean: 0.44225046038627625
loss_pred:0.02719661220908165, decouple_loss:0.00926407054066658
loss_pred:0.0274646133184433, decouple_loss:0.00917617604136467
The generated pressure mean: 0.4417804181575775
loss_pred:0.026562491431832314, decouple_loss:0.009336506947875023
Iteration: 3825, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4410594403743744
The generated pressure mean: 0.445362389087677
loss_pred:0.027833927422761917, decouple_loss:0.009087548591196537
loss_pred:0.02636007033288479, decouple_loss:0.008697271347045898
The generated pressure mean: 0.44705942273139954
loss_pred:0.026930231600999832, decouple_loss:0.008550092577934265
Iteration: 3826, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4534689486026764
The generated pressure mean: 0.4562890827655792
loss_pred:0.027104858309030533, decouple_loss:0.008620272390544415
loss_pred:0.026918161660432816, decouple_loss:0.008585228584706783
The generated pressure mean: 0.4535669982433319
loss_pred:0.02760964073240757, decouple_loss:0.008321873843669891
Iteration: 3827, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4438614845275879
The generated pressure mean: 0.4468301236629486
loss_pred:0.027941962704062462, decouple_loss:0.009800591506063938
loss_pred:0.02839796617627144, decouple_loss:0.009372704662382603
The generated pressure mean: 0.44232210516929626
loss_pred:0.027732867747545242, decouple_loss:0.009252469055354595
Iteration: 3828, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43647584319114685
loss_pred:0.027187176048755646, decouple_loss:0.008189338259398937
The generated pressure mean: 0.4295353293418884
loss_pred:0.02849429100751877, decouple_loss:0.008336632512509823
The generated pressure mean: 0.4354266822338104
loss_pred:0.02837626077234745, decouple_loss:0.008189322426915169
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3829, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44944214820861816
The generated pressure mean: 0.4501137435436249
loss_pred:0.02620634250342846, decouple_loss:0.007695165928453207
loss_pred:0.029149401932954788, decouple_loss:0.009016528725624084
The generated pressure mean: 0.45424771308898926
loss_pred:0.028176821768283844, decouple_loss:0.008815632201731205
Iteration: 3830, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4626150131225586
The generated pressure mean: 0.4614127576351166
loss_pred:0.027507560327649117, decouple_loss:0.00929234828799963
loss_pred:0.02762339450418949, decouple_loss:0.009477016516029835
The generated pressure mean: 0.4628073573112488
loss_pred:0.027459299191832542, decouple_loss:0.009543525986373425
2023-04-17 02:28:29 testing...
The generated pressure mean: 0.42093685269355774
The generated pressure mean: 0.42770642042160034
The generated pressure mean: 0.4305259585380554
loss_pred:0.039711643010377884, decouple_loss:0.009629652835428715
loss_pred:0.038843072950839996, decouple_loss:0.010315770283341408loss_pred:0.03885235637426376, decouple_loss:0.010492146015167236
WV_0_PC_0_EH_1_PS_40, loss: 0.03964298218488693, avg_mse: 0.053557027131319046
current test mse: 0.053557
Iteration: 3831, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43385598063468933
loss_pred:0.02683733031153679, decouple_loss:0.00843608845025301
The generated pressure mean: 0.4337659478187561
loss_pred:0.026553867384791374, decouple_loss:0.008136609569191933
The generated pressure mean: 0.4356209933757782
loss_pred:0.02714778110384941, decouple_loss:0.00811635423451662
Iteration: 3832, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44505155086517334
loss_pred:0.028026800602674484, decouple_loss:0.011290404945611954
The generated pressure mean: 0.4485144317150116
loss_pred:0.027501380071043968, decouple_loss:0.01092903409153223
The generated pressure mean: 0.448030561208725
loss_pred:0.02749905362725258, decouple_loss:0.01168829295784235
Iteration: 3833, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44278526306152344
The generated pressure mean: 0.4370070993900299loss_pred:0.026975242421030998, decouple_loss:0.010040546767413616
loss_pred:0.025989409536123276, decouple_loss:0.009032989852130413
The generated pressure mean: 0.4357798397541046
loss_pred:0.026306739076972008, decouple_loss:0.009285141713917255
Iteration: 3834, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46304062008857727
The generated pressure mean: 0.46352311968803406
loss_pred:0.027102667838335037, decouple_loss:0.009415998123586178
loss_pred:0.026839420199394226, decouple_loss:0.009679080918431282
The generated pressure mean: 0.46377497911453247
loss_pred:0.02756211906671524, decouple_loss:0.00964268296957016
Iteration: 3835, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4530899226665497
The generated pressure mean: 0.4475678503513336
loss_pred:0.026793790981173515, decouple_loss:0.010162153281271458
loss_pred:0.027073722332715988, decouple_loss:0.010087573900818825
The generated pressure mean: 0.45025908946990967
loss_pred:0.027555249631404877, decouple_loss:0.009820082224905491
Iteration: 3836, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43168243765830994
loss_pred:0.02603246085345745, decouple_loss:0.009446605108678341
The generated pressure mean: 0.4340217113494873
loss_pred:0.026965055614709854, decouple_loss:0.009671155363321304
The generated pressure mean: 0.42816245555877686
loss_pred:0.027360016480088234, decouple_loss:0.009371394291520119
Iteration: 3837, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44994115829467773
The generated pressure mean: 0.4459596872329712
loss_pred:0.026212671771645546, decouple_loss:0.010271265171468258
loss_pred:0.02654215693473816, decouple_loss:0.010255773551762104
The generated pressure mean: 0.45339909195899963
loss_pred:0.026819946244359016, decouple_loss:0.0104410070925951
Iteration: 3838, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45632681250572205
loss_pred:0.027920201420783997, decouple_loss:0.00938817486166954
The generated pressure mean: 0.452755331993103
loss_pred:0.02655457891523838, decouple_loss:0.009067698381841183
The generated pressure mean: 0.4600549638271332
loss_pred:0.02644883468747139, decouple_loss:0.009520716033875942
Iteration: 3839, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44239044189453125
loss_pred:0.027848700061440468, decouple_loss:0.009546536952257156
The generated pressure mean: 0.4414684474468231
loss_pred:0.028618136420845985, decouple_loss:0.00963608454912901
The generated pressure mean: 0.4432870149612427
loss_pred:0.02679622173309326, decouple_loss:0.009479580447077751
Iteration: 3840, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482923448085785
The generated pressure mean: 0.4486454427242279
loss_pred:0.02682214230298996, decouple_loss:0.00782663095742464
loss_pred:0.025722820311784744, decouple_loss:0.008058489300310612
The generated pressure mean: 0.4493182897567749
loss_pred:0.02732658199965954, decouple_loss:0.007946275174617767
2023-04-17 02:30:22 testing...
The generated pressure mean: 0.41816386580467224
The generated pressure mean: 0.4239453077316284
The generated pressure mean: 0.4265579581260681
loss_pred:0.03884115442633629, decouple_loss:0.010650978423655033
loss_pred:0.0378781296312809, decouple_loss:0.011076569557189941
loss_pred:0.03766731545329094, decouple_loss:0.011102159507572651
WV_0_PC_0_EH_1_PS_40, loss: 0.038676030933856964, avg_mse: 0.05150993540883064
current test mse: 0.05151
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 3841, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44388681650161743
loss_pred:0.02631252445280552, decouple_loss:0.009772801771759987
The generated pressure mean: 0.4424666166305542
loss_pred:0.02987859956920147, decouple_loss:0.00928422436118126
The generated pressure mean: 0.4414328932762146
loss_pred:0.026758931577205658, decouple_loss:0.009444388560950756
Iteration: 3842, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45184144377708435
loss_pred:0.02888432703912258, decouple_loss:0.008363225497305393
The generated pressure mean: 0.4477804899215698
loss_pred:0.02585909515619278, decouple_loss:0.008214748464524746
The generated pressure mean: 0.45074453949928284
loss_pred:0.02694207802414894, decouple_loss:0.008276733569800854
Iteration: 3843, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4513164162635803
The generated pressure mean: 0.45165547728538513loss_pred:0.028528885915875435, decouple_loss:0.009048494510352612
loss_pred:0.027355950325727463, decouple_loss:0.008449230343103409
The generated pressure mean: 0.44820985198020935
loss_pred:0.029398778453469276, decouple_loss:0.008634318597614765
Iteration: 3844, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43466904759407043
loss_pred:0.028976058587431908, decouple_loss:0.008238950744271278
The generated pressure mean: 0.4337519407272339
loss_pred:0.027333851903676987, decouple_loss:0.008336645551025867
The generated pressure mean: 0.4383472204208374
loss_pred:0.026989975944161415, decouple_loss:0.0081930598244071
Iteration: 3845, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45317336916923523
loss_pred:0.027478400617837906, decouple_loss:0.007806208450347185
The generated pressure mean: 0.45796290040016174
loss_pred:0.026776136830449104, decouple_loss:0.007590936496853828
The generated pressure mean: 0.4584874212741852
loss_pred:0.029055878520011902, decouple_loss:0.007536175195127726
Iteration: 3846, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488068222999573
loss_pred:0.027466963976621628, decouple_loss:0.007781590335071087
The generated pressure mean: 0.4474335312843323
loss_pred:0.026219476014375687, decouple_loss:0.007671442348510027
The generated pressure mean: 0.4418964385986328
loss_pred:0.026972850784659386, decouple_loss:0.007749898359179497
Iteration: 3847, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44400349259376526
loss_pred:0.02904510498046875, decouple_loss:0.008699614554643631
The generated pressure mean: 0.4456931948661804
loss_pred:0.02881573513150215, decouple_loss:0.008810151368379593
The generated pressure mean: 0.44207891821861267
loss_pred:0.026701608672738075, decouple_loss:0.0082249715924263
Iteration: 3848, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488503634929657
The generated pressure mean: 0.4533313810825348
loss_pred:0.026697654277086258, decouple_loss:0.006563425064086914
loss_pred:0.028401007875800133, decouple_loss:0.006569203920662403
The generated pressure mean: 0.44808340072631836
loss_pred:0.0271009374409914, decouple_loss:0.006576236803084612
Iteration: 3849, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43300697207450867
loss_pred:0.02789771929383278, decouple_loss:0.009061676450073719
The generated pressure mean: 0.4321286678314209
loss_pred:0.028682589530944824, decouple_loss:0.009632839821279049
The generated pressure mean: 0.4403117001056671
loss_pred:0.02744455635547638, decouple_loss:0.008825784549117088
Iteration: 3850, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4701009690761566The generated pressure mean: 0.4706043303012848
loss_pred:0.029430894181132317, decouple_loss:0.00711892219260335
loss_pred:0.029031718149781227, decouple_loss:0.007110506761819124
The generated pressure mean: 0.4719293415546417
loss_pred:0.02802501618862152, decouple_loss:0.007286619860678911
2023-04-17 02:32:51 testing...
The generated pressure mean: 0.42373529076576233
The generated pressure mean: 0.4292316734790802
The generated pressure mean: 0.4315110445022583
loss_pred:0.03878353163599968, decouple_loss:0.010218216106295586
loss_pred:0.038134485483169556, decouple_loss:0.01064170803874731
loss_pred:0.03778524696826935, decouple_loss:0.01085277833044529
WV_0_PC_0_EH_1_PS_40, loss: 0.03876296803355217, avg_mse: 0.05168185755610466
current test mse: 0.051682
Iteration: 3851, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.41785383224487305
loss_pred:0.027950791642069817, decouple_loss:0.009292897768318653
The generated pressure mean: 0.41973060369491577
loss_pred:0.027205737307667732, decouple_loss:0.009320535697042942
The generated pressure mean: 0.419607013463974
loss_pred:0.026394279673695564, decouple_loss:0.009117375127971172
Iteration: 3852, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45564407110214233
loss_pred:0.028727231547236443, decouple_loss:0.008096721023321152
The generated pressure mean: 0.44995659589767456
loss_pred:0.026272304356098175, decouple_loss:0.008016930893063545
The generated pressure mean: 0.4513205587863922
loss_pred:0.026336923241615295, decouple_loss:0.007873308844864368
Iteration: 3853, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4734783470630646
loss_pred:0.027707459405064583, decouple_loss:0.007533398922532797
The generated pressure mean: 0.47514358162879944
loss_pred:0.026108628138899803, decouple_loss:0.007723178248852491
The generated pressure mean: 0.4784676730632782
loss_pred:0.028803391382098198, decouple_loss:0.007999062538146973
Iteration: 3854, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.41102656722068787
loss_pred:0.027532219886779785, decouple_loss:0.009436205960810184
The generated pressure mean: 0.4164508283138275
loss_pred:0.028210442513227463, decouple_loss:0.009943529032170773
The generated pressure mean: 0.4173438847064972
loss_pred:0.02810436487197876, decouple_loss:0.00936879962682724
Iteration: 3855, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4529880881309509
loss_pred:0.02706349454820156, decouple_loss:0.008103754371404648
The generated pressure mean: 0.44976532459259033
loss_pred:0.027598287910223007, decouple_loss:0.007699207402765751
The generated pressure mean: 0.45019134879112244
loss_pred:0.0276170801371336, decouple_loss:0.007460550870746374
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3856, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4591936469078064
loss_pred:0.026884544640779495, decouple_loss:0.009234793484210968
The generated pressure mean: 0.4576026499271393
The generated pressure mean: 0.4590076804161072
loss_pred:0.028377853333950043, decouple_loss:0.008489921689033508
loss_pred:0.027499256655573845, decouple_loss:0.008920125663280487
Iteration: 3857, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4371303915977478
loss_pred:0.02767765149474144, decouple_loss:0.006571619305759668
The generated pressure mean: 0.4414237439632416
loss_pred:0.02754838392138481, decouple_loss:0.006894059479236603
The generated pressure mean: 0.4370732605457306
loss_pred:0.02633984014391899, decouple_loss:0.006692742928862572
Iteration: 3858, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4439573884010315
loss_pred:0.028020286932587624, decouple_loss:0.007657941896468401
The generated pressure mean: 0.44457072019577026
loss_pred:0.02796303667128086, decouple_loss:0.0081543680280447
The generated pressure mean: 0.4488290548324585
loss_pred:0.026579219847917557, decouple_loss:0.007773463614284992
Iteration: 3859, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44884178042411804
loss_pred:0.03055165335536003, decouple_loss:0.008189181797206402
The generated pressure mean: 0.45006445050239563
loss_pred:0.027576874941587448, decouple_loss:0.008258537389338017
The generated pressure mean: 0.4473915696144104
loss_pred:0.027571802958846092, decouple_loss:0.008253837004303932
Iteration: 3860, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42818862199783325
loss_pred:0.029384057968854904, decouple_loss:0.006858502514660358
The generated pressure mean: 0.42609065771102905
loss_pred:0.02587863802909851, decouple_loss:0.00679842010140419
The generated pressure mean: 0.4266429543495178
loss_pred:0.02831176295876503, decouple_loss:0.006910576019436121
2023-04-17 02:34:44 testing...
The generated pressure mean: 0.4093019962310791
The generated pressure mean: 0.4148523807525635
loss_pred:0.040295328944921494, decouple_loss:0.010117401368916035
The generated pressure mean: 0.41674405336380005
loss_pred:0.039136212319135666, decouple_loss:0.01062826905399561
loss_pred:0.039013780653476715, decouple_loss:0.010714378207921982
WV_0_PC_0_EH_1_PS_40, loss: 0.040006108582019806, avg_mse: 0.0540330670773983
current test mse: 0.054033
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 3861, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46898651123046875
loss_pred:0.027652479708194733, decouple_loss:0.008301378227770329
The generated pressure mean: 0.47078457474708557
loss_pred:0.030880875885486603, decouple_loss:0.00927599798887968
The generated pressure mean: 0.46810129284858704
loss_pred:0.027255641296505928, decouple_loss:0.0086265429854393
Iteration: 3862, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.445467084646225
loss_pred:0.027395296841859818, decouple_loss:0.007465196307748556
The generated pressure mean: 0.44990187883377075
loss_pred:0.026744339615106583, decouple_loss:0.007069171406328678
The generated pressure mean: 0.44853249192237854
loss_pred:0.026044247671961784, decouple_loss:0.007045831065624952
Iteration: 3863, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43959492444992065
loss_pred:0.027566106989979744, decouple_loss:0.007280022371560335
The generated pressure mean: 0.4414493143558502
loss_pred:0.027549203485250473, decouple_loss:0.0070976498536765575
The generated pressure mean: 0.4478488266468048
loss_pred:0.025647947564721107, decouple_loss:0.007090902421623468
Iteration: 3864, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4420824944972992
The generated pressure mean: 0.4445931911468506loss_pred:0.026970431208610535, decouple_loss:0.0078107984736561775
loss_pred:0.026673920452594757, decouple_loss:0.007781612686812878
The generated pressure mean: 0.44531965255737305
loss_pred:0.02559596672654152, decouple_loss:0.007919729687273502
Iteration: 3865, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44327113032341003
loss_pred:0.0270130205899477, decouple_loss:0.006594816688448191
The generated pressure mean: 0.4391033947467804
loss_pred:0.026704968884587288, decouple_loss:0.006425783969461918
The generated pressure mean: 0.4397121071815491
loss_pred:0.026754913851618767, decouple_loss:0.006418923381716013
Iteration: 3866, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4595753848552704
loss_pred:0.026338888332247734, decouple_loss:0.007990565150976181
The generated pressure mean: 0.4573751986026764
loss_pred:0.02619447372853756, decouple_loss:0.008166640996932983
The generated pressure mean: 0.4610837996006012
loss_pred:0.027781933546066284, decouple_loss:0.008232081308960915
Iteration: 3867, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4420391917228699
loss_pred:0.029753990471363068, decouple_loss:0.006613139994442463
The generated pressure mean: 0.44885343313217163
loss_pred:0.026846900582313538, decouple_loss:0.00684480182826519
The generated pressure mean: 0.4449443221092224
loss_pred:0.026813281700015068, decouple_loss:0.00675429031252861
Iteration: 3868, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43935343623161316
loss_pred:0.02844773791730404, decouple_loss:0.006790278945118189
The generated pressure mean: 0.43946489691734314The generated pressure mean: 0.43678316473960876
loss_pred:0.03155723214149475, decouple_loss:0.007103838492184877
loss_pred:0.028042476624250412, decouple_loss:0.006822791416198015
Iteration: 3869, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491313695907593
The generated pressure mean: 0.4465741813182831
loss_pred:0.028207015246152878, decouple_loss:0.007347752805799246
loss_pred:0.02655206248164177, decouple_loss:0.0073578255251049995
The generated pressure mean: 0.4492317736148834
loss_pred:0.02724248729646206, decouple_loss:0.0074600884690880775
Iteration: 3870, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4553876221179962
loss_pred:0.027752190828323364, decouple_loss:0.007155777886509895
The generated pressure mean: 0.45614534616470337
loss_pred:0.026866409927606583, decouple_loss:0.0070417760871350765
The generated pressure mean: 0.457821786403656
loss_pred:0.026977280154824257, decouple_loss:0.007264805492013693
2023-04-17 02:37:12 testing...
The generated pressure mean: 0.42022109031677246
The generated pressure mean: 0.4263758361339569
The generated pressure mean: 0.4288768768310547
loss_pred:0.040834929794073105, decouple_loss:0.007504806853830814
loss_pred:0.039758387953042984, decouple_loss:0.0077985008247196674
loss_pred:0.03949121758341789, decouple_loss:0.008008244447410107
WV_0_PC_0_EH_1_PS_40, loss: 0.04041671007871628, avg_mse: 0.05543287470936775
current test mse: 0.055433
Iteration: 3871, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43460410833358765
loss_pred:0.02647985890507698, decouple_loss:0.006296014878898859
The generated pressure mean: 0.4300668239593506
loss_pred:0.027288921177387238, decouple_loss:0.006499387323856354
The generated pressure mean: 0.43538984656333923
loss_pred:0.027909159660339355, decouple_loss:0.006490856874734163
Iteration: 3872, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45280370116233826
loss_pred:0.02589862421154976, decouple_loss:0.0068948836997151375
The generated pressure mean: 0.45401573181152344
loss_pred:0.02706836722791195, decouple_loss:0.006813311483711004
The generated pressure mean: 0.45837077498435974
loss_pred:0.02695368230342865, decouple_loss:0.0072341421619057655
Iteration: 3873, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4558967649936676
loss_pred:0.027706576511263847, decouple_loss:0.0067122881300747395
The generated pressure mean: 0.45786964893341064
loss_pred:0.029082372784614563, decouple_loss:0.0072016967460513115
The generated pressure mean: 0.4564850926399231
loss_pred:0.026554672047495842, decouple_loss:0.006561216898262501
Iteration: 3874, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4334058165550232
loss_pred:0.026775233447551727, decouple_loss:0.0069221924059093
The generated pressure mean: 0.4320729672908783
loss_pred:0.027090473100543022, decouple_loss:0.006578007247298956
The generated pressure mean: 0.4295559227466583
loss_pred:0.02783784084022045, decouple_loss:0.00664267735555768
Iteration: 3875, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44830626249313354
loss_pred:0.026537945494055748, decouple_loss:0.007356568705290556
The generated pressure mean: 0.44177931547164917
loss_pred:0.02600686065852642, decouple_loss:0.007283095270395279
The generated pressure mean: 0.44714877009391785
loss_pred:0.026954155415296555, decouple_loss:0.007260458543896675
Iteration: 3876, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45990893244743347
loss_pred:0.027697892859578133, decouple_loss:0.006598932668566704
The generated pressure mean: 0.45962873101234436
loss_pred:0.027904773131012917, decouple_loss:0.007062272634357214
The generated pressure mean: 0.45810580253601074
loss_pred:0.027232429012656212, decouple_loss:0.006636365782469511
Iteration: 3877, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507521688938141
loss_pred:0.025505676865577698, decouple_loss:0.0074079809710383415
The generated pressure mean: 0.4476344585418701
loss_pred:0.0271710567176342, decouple_loss:0.007224853616207838
The generated pressure mean: 0.44744595885276794
loss_pred:0.025597918778657913, decouple_loss:0.007165650371462107
Iteration: 3878, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43917423486709595
The generated pressure mean: 0.44391360878944397
loss_pred:0.026185182854533195, decouple_loss:0.007378850132226944
loss_pred:0.02687542513012886, decouple_loss:0.0076094819232821465
The generated pressure mean: 0.43763020634651184
loss_pred:0.025830306112766266, decouple_loss:0.007227141410112381
Iteration: 3879, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4393278956413269
loss_pred:0.025250660255551338, decouple_loss:0.006783330347388983
The generated pressure mean: 0.4397726058959961
loss_pred:0.026636045426130295, decouple_loss:0.0067752934992313385
The generated pressure mean: 0.4448000490665436
loss_pred:0.026472419500350952, decouple_loss:0.006782494951039553
Iteration: 3880, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4562537372112274
loss_pred:0.028792500495910645, decouple_loss:0.006574052385985851
The generated pressure mean: 0.4555632472038269
loss_pred:0.028686625882983208, decouple_loss:0.006627216935157776
The generated pressure mean: 0.451835036277771
loss_pred:0.026757925748825073, decouple_loss:0.006354469805955887
2023-04-17 02:39:05 testing...
The generated pressure mean: 0.42190316319465637
The generated pressure mean: 0.429063081741333
The generated pressure mean: 0.4318113625049591
loss_pred:0.038614168763160706, decouple_loss:0.007442040368914604
loss_pred:0.037565987557172775, decouple_loss:0.00791154708713293
loss_pred:0.037523504346609116, decouple_loss:0.008137132972478867
WV_0_PC_0_EH_1_PS_40, loss: 0.03829273581504822, avg_mse: 0.05193537101149559
current test mse: 0.051935
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 3881, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43123945593833923
loss_pred:0.026294104754924774, decouple_loss:0.006814571097493172
The generated pressure mean: 0.4264294505119324
loss_pred:0.026922162622213364, decouple_loss:0.006737923249602318
The generated pressure mean: 0.428882896900177
loss_pred:0.027157200500369072, decouple_loss:0.006765523925423622
Iteration: 3882, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4592113494873047
The generated pressure mean: 0.45761609077453613
loss_pred:0.028104403987526894, decouple_loss:0.006868334952741861
loss_pred:0.026348130777478218, decouple_loss:0.006358064711093903
The generated pressure mean: 0.4523852467536926
loss_pred:0.026374144479632378, decouple_loss:0.006357474252581596
Iteration: 3883, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4520666003227234
loss_pred:0.027328526601195335, decouple_loss:0.00642686290666461
The generated pressure mean: 0.44444215297698975
loss_pred:0.026458999142050743, decouple_loss:0.006550293415784836
The generated pressure mean: 0.4512321650981903
loss_pred:0.02545820362865925, decouple_loss:0.006213727407157421
Iteration: 3884, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467567205429077
loss_pred:0.026572352275252342, decouple_loss:0.006493912078440189
The generated pressure mean: 0.4391358494758606
loss_pred:0.028012385591864586, decouple_loss:0.006515226326882839
The generated pressure mean: 0.4429641664028168
loss_pred:0.026235831901431084, decouple_loss:0.006260349415242672
Iteration: 3885, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483873248100281
loss_pred:0.026523061096668243, decouple_loss:0.00802290067076683
The generated pressure mean: 0.45363566279411316
loss_pred:0.027871157974004745, decouple_loss:0.008448625914752483
The generated pressure mean: 0.45100268721580505
loss_pred:0.02630736120045185, decouple_loss:0.008107050321996212
Iteration: 3886, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43110930919647217
loss_pred:0.02703010104596615, decouple_loss:0.008964736014604568
The generated pressure mean: 0.432587593793869
loss_pred:0.02856692299246788, decouple_loss:0.008786231279373169
The generated pressure mean: 0.43842369318008423
loss_pred:0.02780325338244438, decouple_loss:0.009546113200485706
Iteration: 3887, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4665331244468689
loss_pred:0.027240952476859093, decouple_loss:0.007824726402759552
The generated pressure mean: 0.46366390585899353
loss_pred:0.030396593734622, decouple_loss:0.0077110715210437775
The generated pressure mean: 0.4636944532394409
loss_pred:0.026338299736380577, decouple_loss:0.007450975943356752
Iteration: 3888, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42675310373306274
loss_pred:0.025905631482601166, decouple_loss:0.006682384293526411
The generated pressure mean: 0.42437514662742615
loss_pred:0.026295272633433342, decouple_loss:0.007052392233163118
The generated pressure mean: 0.4251980185508728
loss_pred:0.02731466479599476, decouple_loss:0.007261110004037619
Iteration: 3889, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4457385241985321
loss_pred:0.0255680363625288, decouple_loss:0.007698592729866505
The generated pressure mean: 0.4502280056476593
loss_pred:0.028080448508262634, decouple_loss:0.007537176366895437
The generated pressure mean: 0.45468413829803467
loss_pred:0.025791263207793236, decouple_loss:0.007222228683531284
Iteration: 3890, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46177938580513
The generated pressure mean: 0.4600569009780884loss_pred:0.026686809957027435, decouple_loss:0.007155976258218288
loss_pred:0.026490427553653717, decouple_loss:0.006886736489832401
The generated pressure mean: 0.46081405878067017
loss_pred:0.02569158561527729, decouple_loss:0.0067792912013828754
2023-04-17 02:41:36 testing...
The generated pressure mean: 0.4174291491508484
The generated pressure mean: 0.42328840494155884
loss_pred:0.03823601454496384, decouple_loss:0.007780042476952076
The generated pressure mean: 0.4254162907600403
loss_pred:0.037397611886262894, decouple_loss:0.008072815835475922
loss_pred:0.036872316151857376, decouple_loss:0.008233295753598213
WV_0_PC_0_EH_1_PS_40, loss: 0.03790341690182686, avg_mse: 0.0511791855096817
current test mse: 0.051179
Iteration: 3891, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43347257375717163
loss_pred:0.025279229506850243, decouple_loss:0.007056672126054764
The generated pressure mean: 0.4369181990623474
loss_pred:0.026052052155137062, decouple_loss:0.006791711784899235
The generated pressure mean: 0.44204485416412354
loss_pred:0.027181675657629967, decouple_loss:0.006939837243407965
Iteration: 3892, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44378185272216797
loss_pred:0.028077127411961555, decouple_loss:0.007098696194589138
The generated pressure mean: 0.44357168674468994
loss_pred:0.02822835184633732, decouple_loss:0.00662627536803484
The generated pressure mean: 0.44439423084259033
loss_pred:0.025614196434617043, decouple_loss:0.00693685794249177
Iteration: 3893, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483188986778259
loss_pred:0.027065459638834, decouple_loss:0.006910898257046938
The generated pressure mean: 0.4472174644470215
loss_pred:0.026855068281292915, decouple_loss:0.00696884049102664
The generated pressure mean: 0.4476785957813263
loss_pred:0.026222683489322662, decouple_loss:0.00678861141204834
Iteration: 3894, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4533345103263855
loss_pred:0.027434013783931732, decouple_loss:0.0064718034118413925
The generated pressure mean: 0.44913071393966675
loss_pred:0.026340803131461143, decouple_loss:0.0061635663732886314
The generated pressure mean: 0.45235058665275574
loss_pred:0.025882817804813385, decouple_loss:0.006240289658308029
Iteration: 3895, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44680482149124146
loss_pred:0.02889467403292656, decouple_loss:0.007987040095031261
The generated pressure mean: 0.4432354271411896
loss_pred:0.027256693691015244, decouple_loss:0.007230954244732857
The generated pressure mean: 0.44082900881767273
loss_pred:0.026545943692326546, decouple_loss:0.007855542004108429
Iteration: 3896, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43857628107070923
loss_pred:0.027067730203270912, decouple_loss:0.006953664124011993
The generated pressure mean: 0.4463803768157959
The generated pressure mean: 0.4413917064666748
loss_pred:0.025753207504749298, decouple_loss:0.006935596466064453
loss_pred:0.02701306901872158, decouple_loss:0.006936429534107447
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3897, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499428868293762
loss_pred:0.02682410180568695, decouple_loss:0.00755313690751791
The generated pressure mean: 0.45173776149749756
loss_pred:0.026111571118235588, decouple_loss:0.007690361700952053
The generated pressure mean: 0.4481060206890106
loss_pred:0.027300210669636726, decouple_loss:0.0077993134036660194
Iteration: 3898, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4531353712081909
The generated pressure mean: 0.4475533962249756
loss_pred:0.025914017111063004, decouple_loss:0.007013223133981228
loss_pred:0.028438715264201164, decouple_loss:0.007229367271065712
The generated pressure mean: 0.4513070583343506
loss_pred:0.02740839309990406, decouple_loss:0.006963904481381178
Iteration: 3899, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4390052855014801
loss_pred:0.02598893642425537, decouple_loss:0.009916654787957668
The generated pressure mean: 0.4410395920276642
loss_pred:0.026400834321975708, decouple_loss:0.010079137980937958
The generated pressure mean: 0.4369655251502991
loss_pred:0.026688162237405777, decouple_loss:0.009908175095915794
Iteration: 3900, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44345974922180176
loss_pred:0.024761760607361794, decouple_loss:0.0075561353005468845
The generated pressure mean: 0.44129231572151184
loss_pred:0.02542174980044365, decouple_loss:0.007539064157754183
The generated pressure mean: 0.44267308712005615
loss_pred:0.027689307928085327, decouple_loss:0.0075552393682301044
2023-04-17 02:43:29 testing...
The generated pressure mean: 0.4126438796520233
The generated pressure mean: 0.41858425736427307
The generated pressure mean: 0.42018240690231323
loss_pred:0.03908458724617958, decouple_loss:0.007747740019112825
loss_pred:0.03810720145702362, decouple_loss:0.007904750294983387
loss_pred:0.03759102150797844, decouple_loss:0.00802590698003769
WV_0_PC_0_EH_1_PS_40, loss: 0.03865557909011841, avg_mse: 0.05243094265460968
current test mse: 0.052431
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 3901, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4551427960395813
loss_pred:0.027812516316771507, decouple_loss:0.007073997054249048
The generated pressure mean: 0.46056461334228516
The generated pressure mean: 0.4636707901954651
loss_pred:0.02602100558578968, decouple_loss:0.007188003975898027
loss_pred:0.029412927106022835, decouple_loss:0.0075380983762443066
Iteration: 3902, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464910924434662
loss_pred:0.02590527944266796, decouple_loss:0.007804667577147484
The generated pressure mean: 0.4426276981830597
loss_pred:0.02730776183307171, decouple_loss:0.008093710988759995
The generated pressure mean: 0.4514222741127014
loss_pred:0.02640068531036377, decouple_loss:0.007607248146086931
Iteration: 3903, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42731010913848877
loss_pred:0.027318477630615234, decouple_loss:0.0075902631506323814
The generated pressure mean: 0.4271072745323181
loss_pred:0.027763068675994873, decouple_loss:0.007616263348609209
The generated pressure mean: 0.4300166368484497
loss_pred:0.02815685048699379, decouple_loss:0.007658904884010553
Iteration: 3904, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45844030380249023
The generated pressure mean: 0.45811155438423157
loss_pred:0.028325198218226433, decouple_loss:0.0063184574246406555
loss_pred:0.026581963524222374, decouple_loss:0.006419976707547903
The generated pressure mean: 0.4543130099773407
loss_pred:0.026455875486135483, decouple_loss:0.006569025106728077
Iteration: 3905, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4538455605506897
The generated pressure mean: 0.45586687326431274
loss_pred:0.027110081166028976, decouple_loss:0.007164996583014727
loss_pred:0.0296464990824461, decouple_loss:0.007187215145677328
The generated pressure mean: 0.45248541235923767
loss_pred:0.025385385379195213, decouple_loss:0.007445460185408592
Iteration: 3906, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44609740376472473The generated pressure mean: 0.442257285118103
loss_pred:0.026684634387493134, decouple_loss:0.007217269856482744
loss_pred:0.026613842695951462, decouple_loss:0.0069605568423867226
The generated pressure mean: 0.4468334913253784
loss_pred:0.027140675112605095, decouple_loss:0.006892737932503223
Iteration: 3907, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43901392817497253
The generated pressure mean: 0.4340539872646332
loss_pred:0.028950562700629234, decouple_loss:0.007097048684954643
loss_pred:0.02731596678495407, decouple_loss:0.006995123345404863
The generated pressure mean: 0.4348653256893158
loss_pred:0.02733808569610119, decouple_loss:0.007327920291572809
Iteration: 3908, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4380966126918793
loss_pred:0.02613624557852745, decouple_loss:0.006001162342727184
The generated pressure mean: 0.44169023633003235
The generated pressure mean: 0.4385046660900116
loss_pred:0.026012226939201355, decouple_loss:0.006052661221474409
loss_pred:0.026771098375320435, decouple_loss:0.005998596083372831
Iteration: 3909, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4717838168144226
loss_pred:0.027799438685178757, decouple_loss:0.00603918032720685
The generated pressure mean: 0.46586528420448303
loss_pred:0.02672397717833519, decouple_loss:0.006147064734250307
The generated pressure mean: 0.46362006664276123
loss_pred:0.026066476479172707, decouple_loss:0.005963308271020651
Iteration: 3910, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43906834721565247
loss_pred:0.030049573630094528, decouple_loss:0.0065447064116597176
The generated pressure mean: 0.4399128258228302
loss_pred:0.026022808626294136, decouple_loss:0.006441118661314249
The generated pressure mean: 0.44350695610046387
loss_pred:0.02644934505224228, decouple_loss:0.006429261993616819
2023-04-17 02:45:56 testing...
The generated pressure mean: 0.4260433316230774
The generated pressure mean: 0.4204842746257782
The generated pressure mean: 0.42785948514938354
loss_pred:0.03662179037928581, decouple_loss:0.008687869645655155
loss_pred:0.037899699062108994, decouple_loss:0.00826845783740282
loss_pred:0.03615497052669525, decouple_loss:0.008876270614564419
WV_0_PC_0_EH_1_PS_40, loss: 0.03732270002365112, avg_mse: 0.04982694610953331
current test mse: 0.049827
Iteration: 3911, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.425436794757843
loss_pred:0.02559577487409115, decouple_loss:0.007378673180937767
The generated pressure mean: 0.4299149811267853
loss_pred:0.03172610327601433, decouple_loss:0.007861186750233173
The generated pressure mean: 0.4310373365879059
loss_pred:0.025628261268138885, decouple_loss:0.0075350538827478886
Iteration: 3912, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44669151306152344
loss_pred:0.026789074763655663, decouple_loss:0.007302958518266678
The generated pressure mean: 0.4488420784473419
loss_pred:0.026830488815903664, decouple_loss:0.007960925810039043
The generated pressure mean: 0.4526321291923523
loss_pred:0.026059169322252274, decouple_loss:0.007755529601126909
Iteration: 3913, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.470104843378067
loss_pred:0.0281081460416317, decouple_loss:0.006498236209154129
The generated pressure mean: 0.4658658504486084
loss_pred:0.02745160460472107, decouple_loss:0.006418935488909483
The generated pressure mean: 0.4692530333995819
loss_pred:0.026766011491417885, decouple_loss:0.006356462836265564
Iteration: 3914, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4308069050312042
loss_pred:0.02841910719871521, decouple_loss:0.006995210889726877
The generated pressure mean: 0.43654823303222656
loss_pred:0.02675536461174488, decouple_loss:0.007025306113064289
The generated pressure mean: 0.43451228737831116
loss_pred:0.026633713394403458, decouple_loss:0.006842680741101503
Iteration: 3915, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45207932591438293
loss_pred:0.027700042352080345, decouple_loss:0.008167538791894913
The generated pressure mean: 0.4468495547771454
loss_pred:0.026228945702314377, decouple_loss:0.007887463085353374
The generated pressure mean: 0.45109039545059204
loss_pred:0.02603748068213463, decouple_loss:0.008272523991763592
Iteration: 3916, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44985026121139526
loss_pred:0.025357894599437714, decouple_loss:0.0063646528869867325
The generated pressure mean: 0.4497734308242798
loss_pred:0.02890634723007679, decouple_loss:0.006626967340707779
The generated pressure mean: 0.4451698362827301
loss_pred:0.026975972577929497, decouple_loss:0.006662329658865929
Iteration: 3917, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42503055930137634
loss_pred:0.027455763891339302, decouple_loss:0.00880626030266285
The generated pressure mean: 0.4250209331512451
loss_pred:0.027019072324037552, decouple_loss:0.009008888155221939
The generated pressure mean: 0.4242430329322815
loss_pred:0.027657903730869293, decouple_loss:0.008781220763921738
Iteration: 3918, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47666558623313904
loss_pred:0.028289083391427994, decouple_loss:0.007245597429573536
The generated pressure mean: 0.4722431004047394
The generated pressure mean: 0.47160205245018005
loss_pred:0.02537342719733715, decouple_loss:0.0067260232754051685
loss_pred:0.027648253366351128, decouple_loss:0.006598194595426321
Iteration: 3919, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4399242103099823
loss_pred:0.025687888264656067, decouple_loss:0.006921137683093548
The generated pressure mean: 0.44125428795814514
The generated pressure mean: 0.4417247176170349
loss_pred:0.02676658146083355, decouple_loss:0.007300051860511303
loss_pred:0.026252280920743942, decouple_loss:0.007138290908187628
Iteration: 3920, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44129541516304016
loss_pred:0.027028130367398262, decouple_loss:0.008375595323741436
The generated pressure mean: 0.44301190972328186
loss_pred:0.02608630061149597, decouple_loss:0.008412913419306278
The generated pressure mean: 0.4392842948436737
loss_pred:0.027655024081468582, decouple_loss:0.008309464901685715
2023-04-17 02:47:49 testing...
The generated pressure mean: 0.42297232151031494
The generated pressure mean: 0.4172753393650055
The generated pressure mean: 0.42571577429771423
loss_pred:0.0383303165435791, decouple_loss:0.00793071836233139
loss_pred:0.03932100534439087, decouple_loss:0.007604858838021755
loss_pred:0.037983186542987823, decouple_loss:0.00817929394543171
WV_0_PC_0_EH_1_PS_40, loss: 0.03894008696079254, avg_mse: 0.05351371690630913
current test mse: 0.053514
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 3921, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500269293785095
loss_pred:0.026381662115454674, decouple_loss:0.007302022073417902
The generated pressure mean: 0.447997123003006
loss_pred:0.02712760865688324, decouple_loss:0.00728770112618804
The generated pressure mean: 0.4450480043888092
loss_pred:0.026738205924630165, decouple_loss:0.007516922429203987
Iteration: 3922, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45222485065460205
The generated pressure mean: 0.4548027217388153
loss_pred:0.027132393792271614, decouple_loss:0.007669399958103895
loss_pred:0.02643517591059208, decouple_loss:0.007512901909649372
The generated pressure mean: 0.4550281763076782
loss_pred:0.027070460841059685, decouple_loss:0.007522012572735548
Iteration: 3923, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42847296595573425
The generated pressure mean: 0.4268774390220642
loss_pred:0.026377232745289803, decouple_loss:0.009410940110683441
loss_pred:0.025595763698220253, decouple_loss:0.009493696503341198
The generated pressure mean: 0.4316849112510681
loss_pred:0.026485886424779892, decouple_loss:0.008977723307907581
Iteration: 3924, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4577321410179138
The generated pressure mean: 0.45617297291755676
loss_pred:0.02764936164021492, decouple_loss:0.006186558865010738
loss_pred:0.025866137817502022, decouple_loss:0.006407986860722303
The generated pressure mean: 0.46432432532310486
loss_pred:0.028553375974297523, decouple_loss:0.0063559189438819885
Iteration: 3925, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4416438639163971
The generated pressure mean: 0.44241875410079956
loss_pred:0.025237398222088814, decouple_loss:0.007096138317137957
loss_pred:0.025800324976444244, decouple_loss:0.007120710331946611
The generated pressure mean: 0.44709575176239014
loss_pred:0.026178795844316483, decouple_loss:0.007248944602906704
Iteration: 3926, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4384320080280304The generated pressure mean: 0.44133973121643066
loss_pred:0.026754891499876976, decouple_loss:0.008658640086650848
loss_pred:0.02597886510193348, decouple_loss:0.00875014066696167
The generated pressure mean: 0.43693968653678894
loss_pred:0.026259776204824448, decouple_loss:0.008828584104776382
Iteration: 3927, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46503230929374695
The generated pressure mean: 0.47302666306495667
loss_pred:0.026816464960575104, decouple_loss:0.006913627032190561
loss_pred:0.026826146990060806, decouple_loss:0.007078398950397968
The generated pressure mean: 0.4675440192222595
loss_pred:0.026646621525287628, decouple_loss:0.007203744258731604
Iteration: 3928, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4331127107143402
loss_pred:0.02655729465186596, decouple_loss:0.007357978727668524
The generated pressure mean: 0.441397488117218
loss_pred:0.026459768414497375, decouple_loss:0.0072421301156282425
The generated pressure mean: 0.4325336813926697
loss_pred:0.027922971174120903, decouple_loss:0.007399415597319603
Iteration: 3929, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4245930314064026
The generated pressure mean: 0.42791548371315
loss_pred:0.027424858883023262, decouple_loss:0.006910879164934158
loss_pred:0.028436806052923203, decouple_loss:0.00695705134421587
The generated pressure mean: 0.42643699049949646
loss_pred:0.026476530358195305, decouple_loss:0.007003422360867262
Iteration: 3930, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.49044063687324524
loss_pred:0.026654016226530075, decouple_loss:0.007183476816862822
The generated pressure mean: 0.4957231879234314
The generated pressure mean: 0.4996604323387146
loss_pred:0.027822740375995636, decouple_loss:0.007540768012404442
loss_pred:0.028801174834370613, decouple_loss:0.0076252915896475315
2023-04-17 02:50:17 testing...
The generated pressure mean: 0.4280077815055847
The generated pressure mean: 0.4227049946784973
loss_pred:0.03734069690108299, decouple_loss:0.008566427044570446
The generated pressure mean: 0.42969805002212524
loss_pred:0.038507383316755295, decouple_loss:0.008563661947846413
loss_pred:0.0371268130838871, decouple_loss:0.008742683567106724
WV_0_PC_0_EH_1_PS_40, loss: 0.03808951377868652, avg_mse: 0.05128834396600723
current test mse: 0.051288
Iteration: 3931, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42524009943008423
loss_pred:0.025955507531762123, decouple_loss:0.008149894885718822
The generated pressure mean: 0.41999468207359314
loss_pred:0.027624815702438354, decouple_loss:0.008319759741425514
The generated pressure mean: 0.4258919954299927
loss_pred:0.026773540303111076, decouple_loss:0.007785856258124113
Iteration: 3932, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42050790786743164
loss_pred:0.026021217927336693, decouple_loss:0.007548429071903229
The generated pressure mean: 0.4269205629825592
loss_pred:0.02656390331685543, decouple_loss:0.007094386965036392
The generated pressure mean: 0.4261831045150757
loss_pred:0.024772312492132187, decouple_loss:0.007406959775835276
Iteration: 3933, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4699919819831848
loss_pred:0.02723582275211811, decouple_loss:0.008101536892354488
The generated pressure mean: 0.4707415699958801
loss_pred:0.025552023202180862, decouple_loss:0.007821747101843357
The generated pressure mean: 0.4673563539981842
loss_pred:0.02622848004102707, decouple_loss:0.00794778112322092
Iteration: 3934, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46294766664505005
loss_pred:0.025179360061883926, decouple_loss:0.0066727157682180405
The generated pressure mean: 0.4647004008293152
loss_pred:0.02602483332157135, decouple_loss:0.006481793709099293
The generated pressure mean: 0.4600563943386078
loss_pred:0.027347872033715248, decouple_loss:0.0063907247968018055
Iteration: 3935, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4234353303909302
loss_pred:0.026304710656404495, decouple_loss:0.008869025856256485
The generated pressure mean: 0.4246193766593933
loss_pred:0.025247495621442795, decouple_loss:0.008494074456393719
The generated pressure mean: 0.42613962292671204
loss_pred:0.026747524738311768, decouple_loss:0.008588097058236599
Iteration: 3936, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44130370020866394
loss_pred:0.0267246812582016, decouple_loss:0.006484163459390402
The generated pressure mean: 0.43400266766548157
loss_pred:0.02685433067381382, decouple_loss:0.006331481505185366
The generated pressure mean: 0.4409736394882202
loss_pred:0.027231872081756592, decouple_loss:0.006217672489583492
Iteration: 3937, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46935704350471497
loss_pred:0.02645626850426197, decouple_loss:0.008515387773513794
The generated pressure mean: 0.47191470861434937
loss_pred:0.026590727269649506, decouple_loss:0.008388910442590714
The generated pressure mean: 0.47292837500572205
loss_pred:0.02953214757144451, decouple_loss:0.008664351888000965
Iteration: 3938, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4439239203929901
loss_pred:0.02704703062772751, decouple_loss:0.00789352785795927
The generated pressure mean: 0.44633880257606506
The generated pressure mean: 0.4469571113586426
loss_pred:0.026501264423131943, decouple_loss:0.007469770032912493
loss_pred:0.027528801932930946, decouple_loss:0.007808831054717302
Iteration: 3939, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4266270399093628
loss_pred:0.026143187656998634, decouple_loss:0.007405451964586973
The generated pressure mean: 0.42616069316864014
loss_pred:0.02618059143424034, decouple_loss:0.007625374011695385
The generated pressure mean: 0.42262765765190125
loss_pred:0.026300394907593727, decouple_loss:0.007348823361098766
Iteration: 3940, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4538799524307251
loss_pred:0.02724633552134037, decouple_loss:0.006779007147997618
The generated pressure mean: 0.45554518699645996
loss_pred:0.027006566524505615, decouple_loss:0.006766052916646004
The generated pressure mean: 0.45420464873313904
loss_pred:0.02706962265074253, decouple_loss:0.006889168173074722
2023-04-17 02:52:10 testing...
The generated pressure mean: 0.417888879776001
The generated pressure mean: 0.4118756651878357
The generated pressure mean: 0.4198276996612549
loss_pred:0.038348425179719925, decouple_loss:0.008005163632333279
loss_pred:0.039649177342653275, decouple_loss:0.0074458373710513115
loss_pred:0.038378454744815826, decouple_loss:0.008205762133002281
WV_0_PC_0_EH_1_PS_40, loss: 0.039186298847198486, avg_mse: 0.05383332818746567
current test mse: 0.053833
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 3941, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4606872797012329
loss_pred:0.026260634884238243, decouple_loss:0.006480760406702757
The generated pressure mean: 0.4613550305366516
loss_pred:0.027798742055892944, decouple_loss:0.006911293603479862
The generated pressure mean: 0.46189939975738525
loss_pred:0.029512662440538406, decouple_loss:0.00684373639523983
Iteration: 3942, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.41861867904663086
The generated pressure mean: 0.42142975330352783
loss_pred:0.02880564145743847, decouple_loss:0.007413059007376432
loss_pred:0.027232369408011436, decouple_loss:0.007556813769042492
The generated pressure mean: 0.4167949855327606
loss_pred:0.027519291266798973, decouple_loss:0.0074371821247041225
Iteration: 3943, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.457441121339798
The generated pressure mean: 0.45923367142677307
loss_pred:0.027176115661859512, decouple_loss:0.007127639837563038
loss_pred:0.026794474571943283, decouple_loss:0.006921152118593454
The generated pressure mean: 0.45968300104141235
loss_pred:0.02547597512602806, decouple_loss:0.007042780518531799
Iteration: 3944, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4677751660346985
The generated pressure mean: 0.46896228194236755
loss_pred:0.02629685029387474, decouple_loss:0.007226877845823765
loss_pred:0.02638094499707222, decouple_loss:0.007448282558470964
The generated pressure mean: 0.4711928069591522
loss_pred:0.025449495762586594, decouple_loss:0.007130244746804237
Iteration: 3945, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4337090849876404
The generated pressure mean: 0.43280503153800964
loss_pred:0.028538256883621216, decouple_loss:0.007189314346760511
loss_pred:0.02723187580704689, decouple_loss:0.0072829341515898705
The generated pressure mean: 0.4365450441837311
loss_pred:0.025370579212903976, decouple_loss:0.007235667668282986
Iteration: 3946, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.428006649017334
The generated pressure mean: 0.43157413601875305
loss_pred:0.026936016976833344, decouple_loss:0.007132058031857014
loss_pred:0.027027100324630737, decouple_loss:0.007116402965039015
The generated pressure mean: 0.4301176071166992
loss_pred:0.026475390419363976, decouple_loss:0.006946017034351826
Iteration: 3947, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.461198091506958
loss_pred:0.024266622960567474, decouple_loss:0.006919028703123331
The generated pressure mean: 0.4570673406124115
loss_pred:0.026292551308870316, decouple_loss:0.006979185156524181
The generated pressure mean: 0.4622418284416199
loss_pred:0.02636188082396984, decouple_loss:0.007121493108570576
Iteration: 3948, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4646288752555847
loss_pred:0.026293855160474777, decouple_loss:0.0076227858662605286
The generated pressure mean: 0.4628078043460846
loss_pred:0.02578914724290371, decouple_loss:0.007824552245438099
The generated pressure mean: 0.46615004539489746
loss_pred:0.027168452739715576, decouple_loss:0.007787815760821104
Iteration: 3949, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4284988343715668
The generated pressure mean: 0.4275631010532379
loss_pred:0.02524145133793354, decouple_loss:0.0069721769541502
loss_pred:0.026974104344844818, decouple_loss:0.007086742669343948
The generated pressure mean: 0.4242016077041626
loss_pred:0.026238834485411644, decouple_loss:0.007047886960208416
Iteration: 3950, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43892937898635864
loss_pred:0.028630929067730904, decouple_loss:0.007035304792225361
The generated pressure mean: 0.43158796429634094
loss_pred:0.026234660297632217, decouple_loss:0.0066589368507266045
The generated pressure mean: 0.4338637888431549
loss_pred:0.026595814153552055, decouple_loss:0.006773826666176319
2023-04-17 02:54:41 testing...
The generated pressure mean: 0.41062942147254944
The generated pressure mean: 0.4162049889564514
The generated pressure mean: 0.418541818857193
loss_pred:0.03956107050180435, decouple_loss:0.007649247534573078
loss_pred:0.03837224468588829, decouple_loss:0.008015193045139313
loss_pred:0.03813887760043144, decouple_loss:0.008311941288411617
WV_0_PC_0_EH_1_PS_40, loss: 0.03909033536911011, avg_mse: 0.053523581475019455
current test mse: 0.053524
Iteration: 3951, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46286481618881226
loss_pred:0.025555046275258064, decouple_loss:0.006799483206123114
The generated pressure mean: 0.46329838037490845
loss_pred:0.02429485134780407, decouple_loss:0.006770753301680088
The generated pressure mean: 0.4687771499156952
loss_pred:0.026308516040444374, decouple_loss:0.0067880102433264256
Iteration: 3952, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46283188462257385
loss_pred:0.027253419160842896, decouple_loss:0.006624376401305199
The generated pressure mean: 0.4583750069141388
loss_pred:0.026153529062867165, decouple_loss:0.006619277410209179
The generated pressure mean: 0.45715805888175964
loss_pred:0.026259658858180046, decouple_loss:0.006875333841890097
Iteration: 3953, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42951980233192444
loss_pred:0.02607825957238674, decouple_loss:0.007038591895252466
The generated pressure mean: 0.4219842553138733
loss_pred:0.025139015167951584, decouple_loss:0.0071802325546741486
The generated pressure mean: 0.4284360408782959
loss_pred:0.025913460180163383, decouple_loss:0.006945293862372637
Iteration: 3954, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4379808306694031
loss_pred:0.02589023858308792, decouple_loss:0.0068909404799342155
The generated pressure mean: 0.43801313638687134
loss_pred:0.025726264342665672, decouple_loss:0.006678849458694458
The generated pressure mean: 0.4445546269416809
loss_pred:0.026740578934550285, decouple_loss:0.006813265848904848
Iteration: 3955, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4623492956161499
loss_pred:0.02730036899447441, decouple_loss:0.006104202009737492
The generated pressure mean: 0.45969030261039734
loss_pred:0.025649424642324448, decouple_loss:0.006237754598259926
The generated pressure mean: 0.4631805419921875
loss_pred:0.026770813390612602, decouple_loss:0.006176766939461231
Iteration: 3956, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45459237694740295
loss_pred:0.024562140926718712, decouple_loss:0.006196453236043453
The generated pressure mean: 0.44531384110450745
loss_pred:0.025740593671798706, decouple_loss:0.0062696486711502075
The generated pressure mean: 0.44889402389526367
loss_pred:0.02600792981684208, decouple_loss:0.0064063346944749355
Iteration: 3957, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4379880428314209
loss_pred:0.025418909266591072, decouple_loss:0.0070737204514443874
The generated pressure mean: 0.43892502784729004
loss_pred:0.026679715141654015, decouple_loss:0.00736889336258173
The generated pressure mean: 0.4420039653778076
loss_pred:0.025870513170957565, decouple_loss:0.007316467352211475
Iteration: 3958, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43989700078964233
loss_pred:0.025869552046060562, decouple_loss:0.006946096662431955
The generated pressure mean: 0.4421676993370056
loss_pred:0.025212926790118217, decouple_loss:0.00686704833060503
The generated pressure mean: 0.44670501351356506
loss_pred:0.02515048161149025, decouple_loss:0.007327334955334663
Iteration: 3959, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45224887132644653
loss_pred:0.024745019152760506, decouple_loss:0.006669956259429455
The generated pressure mean: 0.43945953249931335
loss_pred:0.025232575833797455, decouple_loss:0.006948987487703562
The generated pressure mean: 0.44635623693466187
loss_pred:0.0260454248636961, decouple_loss:0.006917392835021019
Iteration: 3960, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44699037075042725
loss_pred:0.027166660875082016, decouple_loss:0.005711281206458807
The generated pressure mean: 0.4458101689815521
loss_pred:0.026998143643140793, decouple_loss:0.005931937135756016
The generated pressure mean: 0.45529675483703613
loss_pred:0.025018855929374695, decouple_loss:0.00623446237295866
2023-04-17 02:56:34 testing...
The generated pressure mean: 0.4152646064758301
The generated pressure mean: 0.4218715727329254
The generated pressure mean: 0.4244149625301361
loss_pred:0.03861713781952858, decouple_loss:0.007350107189267874
loss_pred:0.037033308297395706, decouple_loss:0.00765029015019536
loss_pred:0.03721652179956436, decouple_loss:0.007891824468970299
WV_0_PC_0_EH_1_PS_40, loss: 0.03800385817885399, avg_mse: 0.051993515342473984
current test mse: 0.051994
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 3961, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45239031314849854
loss_pred:0.024896463379263878, decouple_loss:0.006939921993762255
The generated pressure mean: 0.45365938544273376
loss_pred:0.025329643860459328, decouple_loss:0.007103148847818375
The generated pressure mean: 0.44983813166618347
loss_pred:0.024597330018877983, decouple_loss:0.006802331656217575
Iteration: 3962, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43979036808013916
loss_pred:0.02451859787106514, decouple_loss:0.007242925930768251
The generated pressure mean: 0.44161155819892883
loss_pred:0.026329966261982918, decouple_loss:0.007336534559726715
The generated pressure mean: 0.4398987889289856
loss_pred:0.025474397465586662, decouple_loss:0.007136623840779066
Iteration: 3963, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44598254561424255
The generated pressure mean: 0.4488266110420227
loss_pred:0.024847056716680527, decouple_loss:0.007184216286987066
loss_pred:0.02648131735622883, decouple_loss:0.007559833116829395
The generated pressure mean: 0.44571295380592346
loss_pred:0.02674388512969017, decouple_loss:0.007540418300777674
Iteration: 3964, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4347898066043854
loss_pred:0.025106746703386307, decouple_loss:0.006351415999233723
The generated pressure mean: 0.433733195066452
loss_pred:0.02431299164891243, decouple_loss:0.0071086036041378975
The generated pressure mean: 0.4394635558128357
loss_pred:0.02558613009750843, decouple_loss:0.006523728370666504
Iteration: 3965, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45860809087753296
loss_pred:0.026069028303027153, decouple_loss:0.0062267049215734005
The generated pressure mean: 0.4473882019519806
loss_pred:0.02506185881793499, decouple_loss:0.006389094050973654
The generated pressure mean: 0.4544401168823242
loss_pred:0.024134447798132896, decouple_loss:0.006486931815743446
Iteration: 3966, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45657721161842346
loss_pred:0.024127915501594543, decouple_loss:0.005751751828938723
The generated pressure mean: 0.4546334147453308
loss_pred:0.025904269888997078, decouple_loss:0.005781847517937422
The generated pressure mean: 0.46045562624931335
loss_pred:0.02545790560543537, decouple_loss:0.005717036314308643
Iteration: 3967, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4514608085155487
loss_pred:0.027006106451153755, decouple_loss:0.0054538617841899395
The generated pressure mean: 0.44808849692344666
loss_pred:0.025677936151623726, decouple_loss:0.0056441654451191425
The generated pressure mean: 0.44753825664520264
loss_pred:0.02555941417813301, decouple_loss:0.005414011888206005
Iteration: 3968, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42696258425712585
loss_pred:0.026265164837241173, decouple_loss:0.005847938824445009
The generated pressure mean: 0.430614173412323
loss_pred:0.02401687577366829, decouple_loss:0.005845991894602776
The generated pressure mean: 0.43108731508255005
loss_pred:0.02560177445411682, decouple_loss:0.005417836830019951
Iteration: 3969, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45967376232147217
loss_pred:0.025779088959097862, decouple_loss:0.007857189513742924
The generated pressure mean: 0.4601040184497833
loss_pred:0.024526311084628105, decouple_loss:0.00828827079385519
The generated pressure mean: 0.46046289801597595
loss_pred:0.025875762104988098, decouple_loss:0.007864836603403091
Iteration: 3970, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500732421875
loss_pred:0.024166883900761604, decouple_loss:0.006823232397437096
The generated pressure mean: 0.44475704431533813
loss_pred:0.026116861030459404, decouple_loss:0.007125223521143198
The generated pressure mean: 0.4469483196735382
loss_pred:0.02696356736123562, decouple_loss:0.007215859834104776
2023-04-17 02:59:02 testing...
The generated pressure mean: 0.41460633277893066
The generated pressure mean: 0.422477662563324
The generated pressure mean: 0.425188273191452
loss_pred:0.039032045751810074, decouple_loss:0.007948806509375572
loss_pred:0.03757786005735397, decouple_loss:0.008597850799560547
loss_pred:0.037752117961645126, decouple_loss:0.008877580985426903
WV_0_PC_0_EH_1_PS_40, loss: 0.038544412702322006, avg_mse: 0.053422462195158005
current test mse: 0.053422
Iteration: 3971, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4613126814365387
loss_pred:0.025047048926353455, decouple_loss:0.006459493190050125
The generated pressure mean: 0.45745912194252014
loss_pred:0.024809544906020164, decouple_loss:0.006993893999606371
The generated pressure mean: 0.4515226185321808
loss_pred:0.025798393413424492, decouple_loss:0.006592512130737305
Iteration: 3972, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.437301367521286
loss_pred:0.026297686621546745, decouple_loss:0.006740522105246782
The generated pressure mean: 0.44323500990867615
loss_pred:0.024688225239515305, decouple_loss:0.006473679095506668
The generated pressure mean: 0.43653857707977295
loss_pred:0.025741595774888992, decouple_loss:0.0065965005196630955
Iteration: 3973, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4330430030822754
The generated pressure mean: 0.43483224511146545loss_pred:0.025313403457403183, decouple_loss:0.006044755224138498
loss_pred:0.02532435581088066, decouple_loss:0.005797928664833307
The generated pressure mean: 0.43965139985084534
loss_pred:0.026361584663391113, decouple_loss:0.005913145840167999
Iteration: 3974, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4546736776828766
The generated pressure mean: 0.4629339277744293loss_pred:0.02582426741719246, decouple_loss:0.0071192351169884205
loss_pred:0.026623068377375603, decouple_loss:0.006950095295906067
The generated pressure mean: 0.459867924451828
loss_pred:0.026959674432873726, decouple_loss:0.00738252280279994
Iteration: 3975, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4598194658756256
The generated pressure mean: 0.4588710069656372
loss_pred:0.02464977279305458, decouple_loss:0.006396592129021883
loss_pred:0.026345260441303253, decouple_loss:0.006493802648037672
The generated pressure mean: 0.4632554352283478
loss_pred:0.026162900030612946, decouple_loss:0.006728241685777903
Iteration: 3976, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4324406683444977
loss_pred:0.025859110057353973, decouple_loss:0.006254100706428289
The generated pressure mean: 0.4345744848251343
loss_pred:0.02609066665172577, decouple_loss:0.006227405741810799
The generated pressure mean: 0.43286168575286865
loss_pred:0.02515060268342495, decouple_loss:0.006462583784013987
Iteration: 3977, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4364706873893738
The generated pressure mean: 0.4393320083618164
loss_pred:0.02528519555926323, decouple_loss:0.006294148974120617
loss_pred:0.026553817093372345, decouple_loss:0.006427200511097908
The generated pressure mean: 0.4355389177799225
loss_pred:0.02493438310921192, decouple_loss:0.006250499747693539
Iteration: 3978, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4604491889476776
loss_pred:0.02572529762983322, decouple_loss:0.008467400446534157
The generated pressure mean: 0.46337002515792847
The generated pressure mean: 0.4587317109107971
loss_pred:0.024668842554092407, decouple_loss:0.008811603300273418
loss_pred:0.02746189944446087, decouple_loss:0.008708625100553036
Iteration: 3979, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4685254991054535
loss_pred:0.02532189153134823, decouple_loss:0.007588997017592192
The generated pressure mean: 0.47145703434944153
loss_pred:0.024015123024582863, decouple_loss:0.007869699969887733
The generated pressure mean: 0.4696918725967407
loss_pred:0.024676861241459846, decouple_loss:0.007737271022051573
Iteration: 3980, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4254192113876343
loss_pred:0.025938304141163826, decouple_loss:0.009250062517821789
The generated pressure mean: 0.4285143315792084
loss_pred:0.02484346553683281, decouple_loss:0.009364101104438305
The generated pressure mean: 0.4324304461479187
loss_pred:0.025262190029025078, decouple_loss:0.009203090332448483
2023-04-17 03:00:55 testing...
The generated pressure mean: 0.4201194941997528
The generated pressure mean: 0.4273626506328583
The generated pressure mean: 0.42997467517852783
loss_pred:0.03773912414908409, decouple_loss:0.00917506217956543
loss_pred:0.03726422041654587, decouple_loss:0.009719748981297016
loss_pred:0.03670115768909454, decouple_loss:0.009978785179555416
WV_0_PC_0_EH_1_PS_40, loss: 0.037716060876846313, avg_mse: 0.051681969314813614
current test mse: 0.051682
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 3981, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43321892619132996
loss_pred:0.026100901886820793, decouple_loss:0.00894196517765522
The generated pressure mean: 0.4300265610218048
loss_pred:0.026219530031085014, decouple_loss:0.00854349136352539
The generated pressure mean: 0.43538278341293335
loss_pred:0.02758396603167057, decouple_loss:0.008259850554168224
Iteration: 3982, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4618591368198395
loss_pred:0.025164920836687088, decouple_loss:0.0075035663321614265
The generated pressure mean: 0.4604419767856598
loss_pred:0.026797929778695107, decouple_loss:0.007232469040900469
The generated pressure mean: 0.464786171913147
loss_pred:0.02656298689544201, decouple_loss:0.00749606778845191
Iteration: 3983, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449615180492401
loss_pred:0.025811729952692986, decouple_loss:0.008817093446850777
The generated pressure mean: 0.4499339461326599
loss_pred:0.026363834738731384, decouple_loss:0.008848537690937519
The generated pressure mean: 0.44834449887275696
loss_pred:0.0253045242279768, decouple_loss:0.008564782328903675
Iteration: 3984, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4568159580230713
The generated pressure mean: 0.45939844846725464loss_pred:0.02751585654914379, decouple_loss:0.006774215959012508
loss_pred:0.027385195717215538, decouple_loss:0.006842162925750017
The generated pressure mean: 0.45916467905044556
loss_pred:0.026774732396006584, decouple_loss:0.0067785619758069515
Iteration: 3985, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45266181230545044
loss_pred:0.02676212787628174, decouple_loss:0.008727890439331532
The generated pressure mean: 0.4508727490901947
loss_pred:0.025933196768164635, decouple_loss:0.008554140105843544
The generated pressure mean: 0.4522877335548401
loss_pred:0.025689691305160522, decouple_loss:0.008689827285706997
Iteration: 3986, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4224514961242676
loss_pred:0.026675671339035034, decouple_loss:0.007435969542711973
The generated pressure mean: 0.42108649015426636
loss_pred:0.026196610182523727, decouple_loss:0.007521116174757481
The generated pressure mean: 0.42369699478149414
loss_pred:0.02690831385552883, decouple_loss:0.0074079521000385284
Iteration: 3987, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4575527012348175
loss_pred:0.025394169613718987, decouple_loss:0.008031686767935753
The generated pressure mean: 0.45918112993240356
loss_pred:0.02616371586918831, decouple_loss:0.008085460402071476
The generated pressure mean: 0.4555233120918274
loss_pred:0.025858988985419273, decouple_loss:0.00767448591068387
Iteration: 3988, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4719521403312683
loss_pred:0.026374049484729767, decouple_loss:0.0068468269892036915
The generated pressure mean: 0.4673740565776825
loss_pred:0.02653343230485916, decouple_loss:0.00670465175062418
The generated pressure mean: 0.46370407938957214
loss_pred:0.02612113580107689, decouple_loss:0.0067321923561394215
Iteration: 3989, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45183250308036804
loss_pred:0.027052510529756546, decouple_loss:0.007193233352154493
The generated pressure mean: 0.44957235455513
loss_pred:0.026014285162091255, decouple_loss:0.007081499323248863
The generated pressure mean: 0.44865113496780396
loss_pred:0.02651689015328884, decouple_loss:0.00713255163282156
Iteration: 3990, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4407961964607239
The generated pressure mean: 0.44350749254226685
loss_pred:0.026880651712417603, decouple_loss:0.00801606010645628
loss_pred:0.025489812716841698, decouple_loss:0.00800810195505619
The generated pressure mean: 0.44203147292137146
loss_pred:0.027022726833820343, decouple_loss:0.00784885510802269
2023-04-17 03:03:23 testing...
The generated pressure mean: 0.420780748128891
The generated pressure mean: 0.4273049533367157
The generated pressure mean: 0.4297127425670624
loss_pred:0.03859289363026619, decouple_loss:0.007613268215209246
loss_pred:0.03747463971376419, decouple_loss:0.007903337478637695
loss_pred:0.03706622123718262, decouple_loss:0.008024103939533234
WV_0_PC_0_EH_1_PS_40, loss: 0.038103602826595306, avg_mse: 0.052781589329242706
current test mse: 0.052782
Iteration: 3991, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43796059489250183
loss_pred:0.025229422375559807, decouple_loss:0.006876114755868912
The generated pressure mean: 0.43317195773124695
loss_pred:0.025200994685292244, decouple_loss:0.006857067812234163
The generated pressure mean: 0.44057002663612366
loss_pred:0.026053834706544876, decouple_loss:0.0068250009790062904
Iteration: 3992, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45127061009407043
loss_pred:0.024678727611899376, decouple_loss:0.006317659746855497
The generated pressure mean: 0.44328734278678894
loss_pred:0.025705549865961075, decouple_loss:0.0064672925509512424
The generated pressure mean: 0.4523048996925354
loss_pred:0.025979075580835342, decouple_loss:0.0066416761837899685
Iteration: 3993, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46458253264427185
loss_pred:0.027229467406868935, decouple_loss:0.0067605082876980305
The generated pressure mean: 0.4590838551521301
loss_pred:0.024661777541041374, decouple_loss:0.006822929717600346
The generated pressure mean: 0.4629860520362854
loss_pred:0.025580592453479767, decouple_loss:0.006806804332882166
Iteration: 3994, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4438708424568176
loss_pred:0.024685153737664223, decouple_loss:0.006620133761316538
The generated pressure mean: 0.4456541836261749
loss_pred:0.025861529633402824, decouple_loss:0.006829425692558289
The generated pressure mean: 0.44459569454193115
loss_pred:0.0261001568287611, decouple_loss:0.0066062272526323795
Iteration: 3995, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44839590787887573
loss_pred:0.02572837471961975, decouple_loss:0.006826401688158512
The generated pressure mean: 0.4494178593158722
loss_pred:0.026052052155137062, decouple_loss:0.006929897237569094
The generated pressure mean: 0.44871437549591064
loss_pred:0.024695949628949165, decouple_loss:0.0067856283858418465
Iteration: 3996, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45071670413017273
loss_pred:0.02491290681064129, decouple_loss:0.006160801742225885
The generated pressure mean: 0.4524928629398346
loss_pred:0.02569904923439026, decouple_loss:0.006175739225000143
The generated pressure mean: 0.4523104727268219
loss_pred:0.026081064715981483, decouple_loss:0.006123688537627459
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3997, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44602322578430176
loss_pred:0.02718479558825493, decouple_loss:0.0067491172812879086
The generated pressure mean: 0.44151729345321655
The generated pressure mean: 0.4362528324127197
loss_pred:0.025524606928229332, decouple_loss:0.006685703061521053
loss_pred:0.025721324607729912, decouple_loss:0.006576988846063614
Iteration: 3998, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45357123017311096
loss_pred:0.0270498339086771, decouple_loss:0.005775338038802147
The generated pressure mean: 0.45231184363365173
loss_pred:0.02516040951013565, decouple_loss:0.005666106939315796
The generated pressure mean: 0.4482015073299408
loss_pred:0.025305140763521194, decouple_loss:0.0059655229561030865
Iteration: 3999, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503699839115143
loss_pred:0.024861812591552734, decouple_loss:0.006275557447224855
The generated pressure mean: 0.45472559332847595
loss_pred:0.025807706639170647, decouple_loss:0.006044039037078619
The generated pressure mean: 0.450812429189682
loss_pred:0.025063106790184975, decouple_loss:0.00612545944750309
Iteration: 4000, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4619305729866028
loss_pred:0.026524284854531288, decouple_loss:0.007006412837654352
The generated pressure mean: 0.454593688249588
The generated pressure mean: 0.45435744524002075
loss_pred:0.025204431265592575, decouple_loss:0.007005759980529547
loss_pred:0.024044837802648544, decouple_loss:0.006806304212659597
2023-04-17 03:05:17 itr: 4000
training loss: [0.02438515 0.02687461 0.02555472]
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_0_EH_1_PS_40/model_4000.ckpt
2023-04-17 03:05:22 testing...
The generated pressure mean: 0.4175029993057251
The generated pressure mean: 0.4231700301170349
The generated pressure mean: 0.42488744854927063
loss_pred:0.03614308312535286, decouple_loss:0.006888176780194044
loss_pred:0.03542524576187134, decouple_loss:0.007162353955209255
loss_pred:0.03507613018155098, decouple_loss:0.007307751104235649
WV_0_PC_0_EH_1_PS_40, loss: 0.03590412437915802, avg_mse: 0.04833240061998367
current test mse: 0.048332
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 4001, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43805447220802307
loss_pred:0.025801487267017365, decouple_loss:0.006379881873726845
The generated pressure mean: 0.4393458664417267
loss_pred:0.024580618366599083, decouple_loss:0.0064117820002138615
The generated pressure mean: 0.43818211555480957
loss_pred:0.02519543655216694, decouple_loss:0.006677707191556692
Iteration: 4002, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4432976543903351
The generated pressure mean: 0.43996569514274597
loss_pred:0.02548222802579403, decouple_loss:0.005777404643595219
loss_pred:0.02470310404896736, decouple_loss:0.005581270903348923
The generated pressure mean: 0.44217896461486816
loss_pred:0.025677649304270744, decouple_loss:0.0057766372337937355
Iteration: 4003, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44609925150871277
The generated pressure mean: 0.4462834596633911
loss_pred:0.027656232938170433, decouple_loss:0.007287520915269852
loss_pred:0.02654949389398098, decouple_loss:0.007565234322100878
The generated pressure mean: 0.44563132524490356
loss_pred:0.02591646835207939, decouple_loss:0.007439199835062027
Iteration: 4004, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4433954954147339
The generated pressure mean: 0.4470272362232208
loss_pred:0.026131073012948036, decouple_loss:0.007429733872413635
loss_pred:0.024615902453660965, decouple_loss:0.007426674943417311
The generated pressure mean: 0.4454951584339142
loss_pred:0.02530510537326336, decouple_loss:0.007832364179193974
Iteration: 4005, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463774859905243
The generated pressure mean: 0.4485607147216797
loss_pred:0.025632744655013084, decouple_loss:0.0061912755481898785
loss_pred:0.02771259844303131, decouple_loss:0.006185910664498806
The generated pressure mean: 0.4494645297527313
loss_pred:0.025876345112919807, decouple_loss:0.006142590660601854
Iteration: 4006, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4530150890350342
loss_pred:0.02732015773653984, decouple_loss:0.005886264145374298
The generated pressure mean: 0.45376619696617126
loss_pred:0.025820035487413406, decouple_loss:0.006007703021168709
The generated pressure mean: 0.45165231823921204
loss_pred:0.025081008672714233, decouple_loss:0.005838857963681221
Iteration: 4007, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44618919491767883
loss_pred:0.024303361773490906, decouple_loss:0.006884847301989794
The generated pressure mean: 0.44162657856941223
loss_pred:0.025359388440847397, decouple_loss:0.0069994512014091015
The generated pressure mean: 0.44802141189575195
loss_pred:0.026087423786520958, decouple_loss:0.0073508755303919315
Iteration: 4008, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4337354004383087
loss_pred:0.02674860693514347, decouple_loss:0.00715603306889534
The generated pressure mean: 0.4383191466331482
loss_pred:0.026320427656173706, decouple_loss:0.006813763175159693
The generated pressure mean: 0.4275215268135071
loss_pred:0.025731995701789856, decouple_loss:0.007084927521646023
Iteration: 4009, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488092362880707
The generated pressure mean: 0.4528404176235199
loss_pred:0.026456443592905998, decouple_loss:0.005408222321420908
loss_pred:0.025771362707018852, decouple_loss:0.0055940099991858006
The generated pressure mean: 0.4514317214488983
loss_pred:0.025752665475010872, decouple_loss:0.005506810732185841
Iteration: 4010, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501139521598816
loss_pred:0.0265764519572258, decouple_loss:0.007564356550574303
The generated pressure mean: 0.44901639223098755
loss_pred:0.028308123350143433, decouple_loss:0.007805631496012211
The generated pressure mean: 0.45375993847846985
loss_pred:0.02655268833041191, decouple_loss:0.007729129865765572
2023-04-17 03:07:48 testing...
The generated pressure mean: 0.4152389466762543
The generated pressure mean: 0.4212649464607239
The generated pressure mean: 0.4230409562587738
loss_pred:0.037130266427993774, decouple_loss:0.008171789348125458
loss_pred:0.03607519343495369, decouple_loss:0.008645573630928993
loss_pred:0.03597763553261757, decouple_loss:0.008970720693469048
WV_0_PC_0_EH_1_PS_40, loss: 0.036824166774749756, avg_mse: 0.04977862164378166
current test mse: 0.049779
Iteration: 4011, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44514527916908264
loss_pred:0.026164811104536057, decouple_loss:0.006933359894901514
The generated pressure mean: 0.4435212016105652
loss_pred:0.026773298159241676, decouple_loss:0.007321605924516916
The generated pressure mean: 0.44196489453315735
loss_pred:0.025043034926056862, decouple_loss:0.007105193566530943
Iteration: 4012, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45175349712371826
The generated pressure mean: 0.44940292835235596
loss_pred:0.024639388546347618, decouple_loss:0.005759695544838905
loss_pred:0.025158273056149483, decouple_loss:0.005849285051226616
The generated pressure mean: 0.45164310932159424
loss_pred:0.025544384494423866, decouple_loss:0.006153647787868977
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4013, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480634927749634
The generated pressure mean: 0.4440251290798187loss_pred:0.02653517946600914, decouple_loss:0.006952326279133558
loss_pred:0.025249380618333817, decouple_loss:0.006989992689341307
The generated pressure mean: 0.44654688239097595
loss_pred:0.024937547743320465, decouple_loss:0.006915833335369825
Iteration: 4014, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43898576498031616
The generated pressure mean: 0.4437091052532196
loss_pred:0.026977624744176865, decouple_loss:0.006459683645516634
loss_pred:0.025176329538226128, decouple_loss:0.006297471467405558
The generated pressure mean: 0.44270193576812744
loss_pred:0.026644181460142136, decouple_loss:0.006296380423009396
Iteration: 4015, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44400620460510254The generated pressure mean: 0.4387907385826111
loss_pred:0.026638099923729897, decouple_loss:0.006582315545529127
loss_pred:0.026276342570781708, decouple_loss:0.006368118338286877
The generated pressure mean: 0.43925583362579346
loss_pred:0.02549774944782257, decouple_loss:0.006681304890662432
Iteration: 4016, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4552357494831085
The generated pressure mean: 0.44895461201667786
loss_pred:0.02538955584168434, decouple_loss:0.006726279854774475
loss_pred:0.025651128962635994, decouple_loss:0.007042222190648317
The generated pressure mean: 0.4536188542842865
loss_pred:0.025133876129984856, decouple_loss:0.006931664422154427
Iteration: 4017, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4534120559692383
The generated pressure mean: 0.45372021198272705
loss_pred:0.02521032840013504, decouple_loss:0.00656694732606411
loss_pred:0.026410933583974838, decouple_loss:0.006674689706414938
The generated pressure mean: 0.44451358914375305
loss_pred:0.025286855176091194, decouple_loss:0.006817364599555731
Iteration: 4018, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44710254669189453
loss_pred:0.025405332446098328, decouple_loss:0.0060687861405313015
The generated pressure mean: 0.448445588350296
loss_pred:0.025036657229065895, decouple_loss:0.005909545347094536
The generated pressure mean: 0.44305941462516785
loss_pred:0.024068458005785942, decouple_loss:0.005855341907590628
Iteration: 4019, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4410143494606018
The generated pressure mean: 0.43617334961891174
loss_pred:0.02629845403134823, decouple_loss:0.0057819196954369545
loss_pred:0.02660776674747467, decouple_loss:0.006143911741673946
The generated pressure mean: 0.44068312644958496
loss_pred:0.026140110567212105, decouple_loss:0.005738134030252695
Iteration: 4020, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442816972732544
The generated pressure mean: 0.4433150291442871
loss_pred:0.025739992037415504, decouple_loss:0.006468901876360178
loss_pred:0.02676393836736679, decouple_loss:0.006637130863964558
The generated pressure mean: 0.44625526666641235
loss_pred:0.025340784341096878, decouple_loss:0.006245061289519072
2023-04-17 03:09:41 testing...
The generated pressure mean: 0.4137515127658844
The generated pressure mean: 0.42029938101768494
loss_pred:0.03922434523701668, decouple_loss:0.008337189443409443
The generated pressure mean: 0.4230838716030121
loss_pred:0.0381966270506382, decouple_loss:0.008632954210042953
loss_pred:0.03749670460820198, decouple_loss:0.008738662116229534
WV_0_PC_0_EH_1_PS_40, loss: 0.038734372705221176, avg_mse: 0.05379347503185272
current test mse: 0.053793
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 4021, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45479562878608704
loss_pred:0.02521917037665844, decouple_loss:0.007378576789051294
The generated pressure mean: 0.4577644169330597
loss_pred:0.026179755106568336, decouple_loss:0.00798275601118803
The generated pressure mean: 0.4598006308078766
loss_pred:0.02473675087094307, decouple_loss:0.007717497646808624
Iteration: 4022, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44255852699279785
loss_pred:0.02580452524125576, decouple_loss:0.006048949435353279
The generated pressure mean: 0.4494423568248749
loss_pred:0.02559301070868969, decouple_loss:0.0063328524120152
The generated pressure mean: 0.44240057468414307
loss_pred:0.023718159645795822, decouple_loss:0.006277354899793863
Iteration: 4023, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45096808671951294
loss_pred:0.024530882015824318, decouple_loss:0.0058925701305270195
The generated pressure mean: 0.4550297260284424
loss_pred:0.026629380881786346, decouple_loss:0.005898505914956331
The generated pressure mean: 0.4539472758769989
loss_pred:0.024237271398305893, decouple_loss:0.006150286179035902
Iteration: 4024, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43674519658088684
loss_pred:0.025762813165783882, decouple_loss:0.007403600495308638
The generated pressure mean: 0.4397674798965454
loss_pred:0.025123465806245804, decouple_loss:0.00680525042116642
The generated pressure mean: 0.43558186292648315
loss_pred:0.02556423656642437, decouple_loss:0.007020181510597467
Iteration: 4025, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4541403353214264
loss_pred:0.02481403946876526, decouple_loss:0.008985791355371475
The generated pressure mean: 0.45391401648521423
loss_pred:0.025859499350190163, decouple_loss:0.009115844964981079
The generated pressure mean: 0.4529283344745636
loss_pred:0.026806935667991638, decouple_loss:0.008984426967799664
Iteration: 4026, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44436484575271606
The generated pressure mean: 0.44612130522727966
loss_pred:0.02477317489683628, decouple_loss:0.007281634025275707
loss_pred:0.025346919894218445, decouple_loss:0.007303732447326183
The generated pressure mean: 0.44209885597229004
loss_pred:0.024829696863889694, decouple_loss:0.006882110610604286
Iteration: 4027, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.454328715801239
loss_pred:0.024087943136692047, decouple_loss:0.007973423227667809
The generated pressure mean: 0.4541606903076172
loss_pred:0.02450511045753956, decouple_loss:0.008346022106707096
The generated pressure mean: 0.4522930681705475
loss_pred:0.023560352623462677, decouple_loss:0.008323592133820057
Iteration: 4028, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45394161343574524
loss_pred:0.025408511981368065, decouple_loss:0.009836370125412941
The generated pressure mean: 0.4546867609024048
loss_pred:0.02478347346186638, decouple_loss:0.009926577098667622
The generated pressure mean: 0.45793813467025757
loss_pred:0.025057105347514153, decouple_loss:0.009708013385534286
Iteration: 4029, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4272400438785553
The generated pressure mean: 0.42748311161994934
loss_pred:0.02582540363073349, decouple_loss:0.008529141545295715
loss_pred:0.02501022070646286, decouple_loss:0.00812606606632471
The generated pressure mean: 0.4174611568450928
loss_pred:0.02521025575697422, decouple_loss:0.008031408302485943
Iteration: 4030, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46433502435684204
The generated pressure mean: 0.4718162417411804
loss_pred:0.02425616979598999, decouple_loss:0.013230942189693451
loss_pred:0.02579963207244873, decouple_loss:0.013716309331357479
The generated pressure mean: 0.4614417552947998
loss_pred:0.02375858463346958, decouple_loss:0.013295675627887249
2023-04-17 03:12:09 testing...
The generated pressure mean: 0.41654524207115173
The generated pressure mean: 0.42321059107780457
The generated pressure mean: 0.42488712072372437
loss_pred:0.03748207539319992, decouple_loss:0.0103373471647501
loss_pred:0.03619834780693054, decouple_loss:0.010368932038545609
loss_pred:0.036266714334487915, decouple_loss:0.010567097924649715
WV_0_PC_0_EH_1_PS_40, loss: 0.03717026859521866, avg_mse: 0.05068286508321762
current test mse: 0.050683
Iteration: 4031, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449094235897064
loss_pred:0.02499680034816265, decouple_loss:0.00998192373663187
The generated pressure mean: 0.4396967887878418
loss_pred:0.024796003475785255, decouple_loss:0.009909091517329216
The generated pressure mean: 0.44670379161834717
loss_pred:0.0263308547437191, decouple_loss:0.009990881197154522
Iteration: 4032, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4395807981491089
loss_pred:0.024154063314199448, decouple_loss:0.011119858361780643
The generated pressure mean: 0.4517267644405365
loss_pred:0.027083102613687515, decouple_loss:0.011458254419267178
The generated pressure mean: 0.44483837485313416
loss_pred:0.025917956605553627, decouple_loss:0.01115984097123146
Iteration: 4033, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44739001989364624
loss_pred:0.02444521337747574, decouple_loss:0.009113937616348267
The generated pressure mean: 0.4532078504562378
loss_pred:0.02540672942996025, decouple_loss:0.009526276029646397
The generated pressure mean: 0.45203864574432373
loss_pred:0.02855513244867325, decouple_loss:0.009489607065916061
Iteration: 4034, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4338127672672272
loss_pred:0.024000026285648346, decouple_loss:0.012516363523900509
The generated pressure mean: 0.4287395775318146
loss_pred:0.024830138310790062, decouple_loss:0.012361244298517704
The generated pressure mean: 0.42897829413414
loss_pred:0.02377934381365776, decouple_loss:0.012460505589842796
Iteration: 4035, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46931371092796326
loss_pred:0.023526355624198914, decouple_loss:0.007226636167615652
The generated pressure mean: 0.4744892716407776
loss_pred:0.024526169523596764, decouple_loss:0.0071974825114011765
The generated pressure mean: 0.47303906083106995
loss_pred:0.025888755917549133, decouple_loss:0.007185438647866249
Iteration: 4036, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4593515396118164
loss_pred:0.024755826219916344, decouple_loss:0.009816577658057213
The generated pressure mean: 0.46063780784606934
loss_pred:0.02457941137254238, decouple_loss:0.009807250462472439
The generated pressure mean: 0.4532395601272583
loss_pred:0.023746928200125694, decouple_loss:0.00997992604970932
Iteration: 4037, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.416201651096344
loss_pred:0.025221239775419235, decouple_loss:0.007965764962136745
The generated pressure mean: 0.421151727437973
loss_pred:0.026356209069490433, decouple_loss:0.008069483563303947
The generated pressure mean: 0.4160945415496826
loss_pred:0.02611801028251648, decouple_loss:0.007997356355190277
Iteration: 4038, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4666193127632141
loss_pred:0.025729984045028687, decouple_loss:0.008564794436097145
The generated pressure mean: 0.4673626124858856
loss_pred:0.024200167506933212, decouple_loss:0.008195294998586178
The generated pressure mean: 0.46462738513946533
loss_pred:0.02384883537888527, decouple_loss:0.008257213048636913
Iteration: 4039, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44862818717956543
loss_pred:0.024298908188939095, decouple_loss:0.008991586975753307
The generated pressure mean: 0.4546959698200226
The generated pressure mean: 0.45373982191085815
loss_pred:0.025605643168091774, decouple_loss:0.008875038474798203
loss_pred:0.024043206125497818, decouple_loss:0.009060535579919815
Iteration: 4040, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44313889741897583
loss_pred:0.024548707529902458, decouple_loss:0.00713591231033206
The generated pressure mean: 0.4399736523628235
loss_pred:0.023105915635824203, decouple_loss:0.007088358048349619
The generated pressure mean: 0.4321027994155884
loss_pred:0.025562653318047523, decouple_loss:0.007047232706099749
2023-04-17 03:14:02 testing...
The generated pressure mean: 0.4145467281341553
The generated pressure mean: 0.4219851791858673
The generated pressure mean: 0.42393431067466736
loss_pred:0.038217220455408096, decouple_loss:0.009032748639583588
loss_pred:0.03675020486116409, decouple_loss:0.00914852973073721
loss_pred:0.036949239671230316, decouple_loss:0.009368805214762688
WV_0_PC_0_EH_1_PS_40, loss: 0.03776472434401512, avg_mse: 0.05225265771150589
current test mse: 0.052253
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 4041, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464258551597595
loss_pred:0.027098866179585457, decouple_loss:0.00894854124635458
The generated pressure mean: 0.4506814181804657
loss_pred:0.025204133242368698, decouple_loss:0.008870665915310383
The generated pressure mean: 0.4561576545238495
loss_pred:0.026907438412308693, decouple_loss:0.008760194294154644
Iteration: 4042, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44842860102653503The generated pressure mean: 0.4457915723323822
loss_pred:0.025436190888285637, decouple_loss:0.0075384038500487804
loss_pred:0.025033077225089073, decouple_loss:0.007447990123182535
The generated pressure mean: 0.45578646659851074
loss_pred:0.02624751813709736, decouple_loss:0.007472147233784199
Iteration: 4043, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43872523307800293
The generated pressure mean: 0.44055795669555664
loss_pred:0.025603964924812317, decouple_loss:0.006423058453947306
loss_pred:0.02519065886735916, decouple_loss:0.006264388561248779
The generated pressure mean: 0.43582817912101746
loss_pred:0.02577541582286358, decouple_loss:0.006536291912198067
Iteration: 4044, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44553497433662415
The generated pressure mean: 0.4552913308143616
loss_pred:0.025449741631746292, decouple_loss:0.008431565016508102
loss_pred:0.026461012661457062, decouple_loss:0.008528335951268673
The generated pressure mean: 0.44981902837753296
loss_pred:0.025931917130947113, decouple_loss:0.008292091079056263
Iteration: 4045, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4587506651878357
The generated pressure mean: 0.4563361704349518
loss_pred:0.024359019473195076, decouple_loss:0.006976397708058357
loss_pred:0.02493702806532383, decouple_loss:0.007018281612545252
The generated pressure mean: 0.45335260033607483
loss_pred:0.02591055817902088, decouple_loss:0.00697281351312995
Iteration: 4046, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44275951385498047
The generated pressure mean: 0.43981802463531494
loss_pred:0.02612282708287239, decouple_loss:0.007319702301174402
loss_pred:0.02471170946955681, decouple_loss:0.0073740300722420216
The generated pressure mean: 0.4389767348766327
loss_pred:0.02541588805615902, decouple_loss:0.007332412991672754
Iteration: 4047, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4448196291923523
The generated pressure mean: 0.4525264501571655
loss_pred:0.025457782670855522, decouple_loss:0.008381733670830727
loss_pred:0.025962231680750847, decouple_loss:0.007722769398242235
The generated pressure mean: 0.44748902320861816
loss_pred:0.02501882240176201, decouple_loss:0.008020691573619843
Iteration: 4048, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45224300026893616
loss_pred:0.02617003582417965, decouple_loss:0.006733034271746874
The generated pressure mean: 0.4545695185661316
loss_pred:0.026747219264507294, decouple_loss:0.006999621167778969
The generated pressure mean: 0.4574988782405853
loss_pred:0.024399422109127045, decouple_loss:0.006770180072635412
Iteration: 4049, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4297243356704712The generated pressure mean: 0.43523839116096497
loss_pred:0.02571357786655426, decouple_loss:0.007276072632521391
loss_pred:0.024759793654084206, decouple_loss:0.0072310920804739
The generated pressure mean: 0.4285328686237335
loss_pred:0.025031108409166336, decouple_loss:0.007092097774147987
Iteration: 4050, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4652639329433441
loss_pred:0.024623816832900047, decouple_loss:0.006470660213381052
The generated pressure mean: 0.46091076731681824
loss_pred:0.02664981037378311, decouple_loss:0.006340478081256151
The generated pressure mean: 0.4564421772956848
loss_pred:0.026000119745731354, decouple_loss:0.006521136499941349
2023-04-17 03:16:31 testing...
The generated pressure mean: 0.4161757528781891
The generated pressure mean: 0.42249301075935364
loss_pred:0.03833624720573425, decouple_loss:0.007247057743370533
The generated pressure mean: 0.42435887455940247
loss_pred:0.036998677998781204, decouple_loss:0.007415275555104017
loss_pred:0.03693842887878418, decouple_loss:0.007650547195225954
WV_0_PC_0_EH_1_PS_40, loss: 0.03779633343219757, avg_mse: 0.05200519785284996
current test mse: 0.052005
Iteration: 4051, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44530031085014343
loss_pred:0.025818290188908577, decouple_loss:0.0066746859811246395
The generated pressure mean: 0.4481337070465088
loss_pred:0.025898471474647522, decouple_loss:0.006935495417565107
The generated pressure mean: 0.45076629519462585
loss_pred:0.024828821420669556, decouple_loss:0.006613367237150669
Iteration: 4052, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44976598024368286
The generated pressure mean: 0.44596222043037415
loss_pred:0.02533799782395363, decouple_loss:0.006701033096760511
loss_pred:0.025292372331023216, decouple_loss:0.006437445525079966
The generated pressure mean: 0.44083142280578613
loss_pred:0.024475617334246635, decouple_loss:0.006531285122036934
Iteration: 4053, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4433402121067047
loss_pred:0.02561262995004654, decouple_loss:0.006898671854287386The generated pressure mean: 0.4519381523132324
loss_pred:0.025307903066277504, decouple_loss:0.006669070105999708
The generated pressure mean: 0.44235357642173767
loss_pred:0.024405164644122124, decouple_loss:0.006692858412861824
Iteration: 4054, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4533913731575012
The generated pressure mean: 0.4552218019962311
loss_pred:0.02606148086488247, decouple_loss:0.006411606911569834
loss_pred:0.026752930134534836, decouple_loss:0.006561164278537035
The generated pressure mean: 0.44398748874664307
loss_pred:0.02487768791615963, decouple_loss:0.0062990267761051655
Iteration: 4055, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4357404112815857
loss_pred:0.02474667690694332, decouple_loss:0.006784629076719284
The generated pressure mean: 0.43978288769721985
loss_pred:0.025680948048830032, decouple_loss:0.006593982223421335
The generated pressure mean: 0.44426262378692627
loss_pred:0.024820147082209587, decouple_loss:0.007378477603197098
Iteration: 4056, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4534091055393219
loss_pred:0.02560754120349884, decouple_loss:0.006380255334079266
The generated pressure mean: 0.4560069441795349
loss_pred:0.024977993220090866, decouple_loss:0.0062719169072806835
The generated pressure mean: 0.4533538818359375
loss_pred:0.02599293366074562, decouple_loss:0.006327047012746334
Iteration: 4057, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44979655742645264
loss_pred:0.024850906804203987, decouple_loss:0.006871927063912153
The generated pressure mean: 0.44926509261131287
loss_pred:0.02523360587656498, decouple_loss:0.006953809410333633
The generated pressure mean: 0.4526022970676422
loss_pred:0.026873286813497543, decouple_loss:0.00671435846015811
Iteration: 4058, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4419231116771698
The generated pressure mean: 0.44284406304359436
loss_pred:0.023901596665382385, decouple_loss:0.006259212736040354
loss_pred:0.023798644542694092, decouple_loss:0.00635004136711359
The generated pressure mean: 0.4485139846801758
loss_pred:0.024610886350274086, decouple_loss:0.0071211205795407295
Iteration: 4059, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45118746161460876The generated pressure mean: 0.4418873190879822
loss_pred:0.025843016803264618, decouple_loss:0.006751555949449539
loss_pred:0.025732098147273064, decouple_loss:0.006684545893222094
The generated pressure mean: 0.44638365507125854
loss_pred:0.025262925773859024, decouple_loss:0.006784167606383562
Iteration: 4060, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4593462347984314
The generated pressure mean: 0.4482833445072174
loss_pred:0.025032231584191322, decouple_loss:0.006015148479491472
loss_pred:0.02653799206018448, decouple_loss:0.006039578467607498
The generated pressure mean: 0.4560052752494812
loss_pred:0.024486109614372253, decouple_loss:0.005845796316862106
2023-04-17 03:18:24 testing...
The generated pressure mean: 0.41959062218666077
The generated pressure mean: 0.42587652802467346
loss_pred:0.03703946992754936, decouple_loss:0.006603115238249302
The generated pressure mean: 0.4278973340988159
loss_pred:0.03615820035338402, decouple_loss:0.006919079460203648
loss_pred:0.03556196019053459, decouple_loss:0.007179655600339174
WV_0_PC_0_EH_1_PS_40, loss: 0.036598242819309235, avg_mse: 0.050022006034851074
current test mse: 0.050022
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 4061, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43581077456474304
loss_pred:0.02437715046107769, decouple_loss:0.006147929932922125
The generated pressure mean: 0.4335334002971649
loss_pred:0.027076072990894318, decouple_loss:0.006282861344516277
The generated pressure mean: 0.4408853054046631
loss_pred:0.02419736422598362, decouple_loss:0.006479321978986263
Iteration: 4062, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479854702949524
loss_pred:0.024665992707014084, decouple_loss:0.006351378280669451
The generated pressure mean: 0.44709813594818115
loss_pred:0.02658054791390896, decouple_loss:0.006302285939455032
The generated pressure mean: 0.4400966167449951
loss_pred:0.025962185114622116, decouple_loss:0.006204763427376747
Iteration: 4063, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4609755277633667
The generated pressure mean: 0.4625142216682434
loss_pred:0.025854088366031647, decouple_loss:0.005376861430704594
loss_pred:0.024329733103513718, decouple_loss:0.0056552644819021225
The generated pressure mean: 0.45565375685691833
loss_pred:0.02562159113585949, decouple_loss:0.005637758411467075
Iteration: 4064, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4317305386066437
The generated pressure mean: 0.4286227822303772
loss_pred:0.024379020556807518, decouple_loss:0.00643398379907012
loss_pred:0.02476673386991024, decouple_loss:0.006620569154620171
The generated pressure mean: 0.43127813935279846
loss_pred:0.02811938151717186, decouple_loss:0.006776724010705948
Iteration: 4065, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46530717611312866
The generated pressure mean: 0.4651975929737091
loss_pred:0.02414417825639248, decouple_loss:0.007102260831743479
loss_pred:0.025895632803440094, decouple_loss:0.006935430224984884
The generated pressure mean: 0.47374287247657776
loss_pred:0.026726635172963142, decouple_loss:0.007343825418502092
Iteration: 4066, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4170084297657013The generated pressure mean: 0.4153626561164856
loss_pred:0.024638352915644646, decouple_loss:0.00830235704779625
loss_pred:0.025415778160095215, decouple_loss:0.008569445461034775
The generated pressure mean: 0.41776153445243835
loss_pred:0.02583557739853859, decouple_loss:0.008328738622367382
Iteration: 4067, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46770966053009033The generated pressure mean: 0.46677151322364807
loss_pred:0.025764228776097298, decouple_loss:0.008500924333930016
loss_pred:0.024804359301924706, decouple_loss:0.008162002079188824
The generated pressure mean: 0.4624636471271515
loss_pred:0.024803459644317627, decouple_loss:0.00840061902999878
Iteration: 4068, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4607947766780853
loss_pred:0.024036327376961708, decouple_loss:0.005797938443720341
The generated pressure mean: 0.4658431112766266
loss_pred:0.02375531941652298, decouple_loss:0.006125961430370808
The generated pressure mean: 0.46452581882476807
loss_pred:0.02548706904053688, decouple_loss:0.006098172627389431
Iteration: 4069, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.423796147108078
loss_pred:0.02493295818567276, decouple_loss:0.007254641968756914
The generated pressure mean: 0.428786039352417
loss_pred:0.02591772750020027, decouple_loss:0.007071685511618853
The generated pressure mean: 0.4228515923023224
loss_pred:0.02501634880900383, decouple_loss:0.00727804284542799
Iteration: 4070, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4418330788612366
loss_pred:0.024777613580226898, decouple_loss:0.007565013598650694
The generated pressure mean: 0.44529327750205994
loss_pred:0.023577017709612846, decouple_loss:0.0076605104841291904
The generated pressure mean: 0.44297370314598083
loss_pred:0.02699829638004303, decouple_loss:0.007723470218479633
2023-04-17 03:20:55 testing...
The generated pressure mean: 0.41319379210472107
The generated pressure mean: 0.41991639137268066
The generated pressure mean: 0.4216443598270416
loss_pred:0.03867652267217636, decouple_loss:0.006792368832975626
loss_pred:0.037321705371141434, decouple_loss:0.007235401310026646
loss_pred:0.037203945219516754, decouple_loss:0.007324261590838432
WV_0_PC_0_EH_1_PS_40, loss: 0.03808992728590965, avg_mse: 0.05307052284479141
current test mse: 0.053071
Iteration: 4071, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4569167196750641
loss_pred:0.025500431656837463, decouple_loss:0.006365868262946606
The generated pressure mean: 0.45940107107162476
loss_pred:0.023298662155866623, decouple_loss:0.006147599313408136
The generated pressure mean: 0.45552799105644226
loss_pred:0.024731693789362907, decouple_loss:0.006310203578323126
Iteration: 4072, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4368017017841339
loss_pred:0.02527114376425743, decouple_loss:0.006617318838834763
The generated pressure mean: 0.4448406994342804
loss_pred:0.024434486404061317, decouple_loss:0.00676577165722847
The generated pressure mean: 0.44126057624816895
loss_pred:0.024649720638990402, decouple_loss:0.006807088851928711
Iteration: 4073, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4447619318962097
loss_pred:0.02426297403872013, decouple_loss:0.005595374386757612
The generated pressure mean: 0.44153884053230286
loss_pred:0.024277271702885628, decouple_loss:0.005634860135614872
The generated pressure mean: 0.44469162821769714
loss_pred:0.02396559901535511, decouple_loss:0.005402654409408569
Iteration: 4074, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45823508501052856
loss_pred:0.024790754541754723, decouple_loss:0.006069188006222248
The generated pressure mean: 0.45651975274086
loss_pred:0.02506442926824093, decouple_loss:0.006041283719241619
The generated pressure mean: 0.4517727494239807
loss_pred:0.02294355072081089, decouple_loss:0.00606906320899725
Iteration: 4075, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4444906711578369
loss_pred:0.024818256497383118, decouple_loss:0.005916624329984188
The generated pressure mean: 0.4355532228946686
loss_pred:0.02521294541656971, decouple_loss:0.005788642913103104
The generated pressure mean: 0.4385925233364105
loss_pred:0.023688018321990967, decouple_loss:0.005979366134852171
Iteration: 4076, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44410619139671326
loss_pred:0.02395285665988922, decouple_loss:0.006043962202966213
The generated pressure mean: 0.44675397872924805
The generated pressure mean: 0.44399577379226685
loss_pred:0.02429339475929737, decouple_loss:0.006313935853540897
loss_pred:0.024702712893486023, decouple_loss:0.006202471908181906
Iteration: 4077, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45143911242485046
loss_pred:0.024077685549855232, decouple_loss:0.0069088926538825035
The generated pressure mean: 0.44814130663871765
loss_pred:0.024098413065075874, decouple_loss:0.006801142822951078
The generated pressure mean: 0.45469334721565247
loss_pred:0.026205552741885185, decouple_loss:0.006640489213168621
Iteration: 4078, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45259392261505127
loss_pred:0.024685189127922058, decouple_loss:0.007244528271257877
The generated pressure mean: 0.45329469442367554
loss_pred:0.02417547069489956, decouple_loss:0.007229852490127087
The generated pressure mean: 0.4530734717845917
loss_pred:0.02446817234158516, decouple_loss:0.007099676411598921
Iteration: 4079, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4311513602733612
loss_pred:0.025996766984462738, decouple_loss:0.008592239581048489
The generated pressure mean: 0.4367454946041107
The generated pressure mean: 0.4329231381416321
loss_pred:0.027079937979578972, decouple_loss:0.009517359547317028
loss_pred:0.02487245388329029, decouple_loss:0.009028434753417969
Iteration: 4080, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45169705152511597
loss_pred:0.02466704323887825, decouple_loss:0.008345691487193108
The generated pressure mean: 0.4484851360321045
loss_pred:0.025059401988983154, decouple_loss:0.008331477642059326
The generated pressure mean: 0.45066308975219727
loss_pred:0.025414032861590385, decouple_loss:0.008438563905656338
2023-04-17 03:22:48 testing...
The generated pressure mean: 0.41356176137924194
The generated pressure mean: 0.42096617817878723
The generated pressure mean: 0.42300766706466675
loss_pred:0.03786079213023186, decouple_loss:0.006602094974368811
loss_pred:0.036552544683218, decouple_loss:0.006984845735132694
loss_pred:0.03609873726963997, decouple_loss:0.007207604590803385
WV_0_PC_0_EH_1_PS_40, loss: 0.037183936685323715, avg_mse: 0.051436424255371094
current test mse: 0.051436
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 4081, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447614848613739
loss_pred:0.02525884285569191, decouple_loss:0.005776799749583006
The generated pressure mean: 0.45694470405578613
loss_pred:0.02405325323343277, decouple_loss:0.006075745914131403
The generated pressure mean: 0.4534662365913391
loss_pred:0.02674458734691143, decouple_loss:0.006037577986717224
Iteration: 4082, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44452908635139465
loss_pred:0.02452423982322216, decouple_loss:0.006045477464795113
The generated pressure mean: 0.44757080078125
loss_pred:0.02550388313829899, decouple_loss:0.006024506408721209
The generated pressure mean: 0.44017285108566284
loss_pred:0.026239411905407906, decouple_loss:0.006274383049458265
Iteration: 4083, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.450831800699234
loss_pred:0.025097187608480453, decouple_loss:0.007481600157916546
The generated pressure mean: 0.4477161467075348
loss_pred:0.024310877546668053, decouple_loss:0.007266813423484564
The generated pressure mean: 0.4532429575920105
loss_pred:0.026992151513695717, decouple_loss:0.0075636920519173145
Iteration: 4084, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43853598833084106
loss_pred:0.0255622249096632, decouple_loss:0.0065218741074204445
The generated pressure mean: 0.4436894655227661
loss_pred:0.02379908412694931, decouple_loss:0.006597400177270174
The generated pressure mean: 0.43536636233329773
loss_pred:0.024306517094373703, decouple_loss:0.006792278029024601
Iteration: 4085, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43965116143226624
loss_pred:0.024600137025117874, decouple_loss:0.007734042126685381
The generated pressure mean: 0.4416666328907013
loss_pred:0.023749403655529022, decouple_loss:0.007565430831164122
The generated pressure mean: 0.43953388929367065
loss_pred:0.024623068049550056, decouple_loss:0.007643118500709534
Iteration: 4086, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4576120674610138
loss_pred:0.02588341385126114, decouple_loss:0.009426821954548359
The generated pressure mean: 0.45581290125846863
loss_pred:0.025428609922528267, decouple_loss:0.008907773531973362
The generated pressure mean: 0.45049211382865906
loss_pred:0.02446679398417473, decouple_loss:0.00899918656796217
Iteration: 4087, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447199285030365
loss_pred:0.023628227412700653, decouple_loss:0.007992983795702457
The generated pressure mean: 0.44865480065345764
loss_pred:0.024321699514985085, decouple_loss:0.008118417114019394
The generated pressure mean: 0.4530419111251831
loss_pred:0.023854611441493034, decouple_loss:0.007979264482855797
Iteration: 4088, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43429893255233765
loss_pred:0.02468736097216606, decouple_loss:0.00983374658972025
The generated pressure mean: 0.4396074712276459
loss_pred:0.024023547768592834, decouple_loss:0.009576362557709217
The generated pressure mean: 0.441898375749588
loss_pred:0.024294773116707802, decouple_loss:0.009517508558928967
Iteration: 4089, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44488200545310974
loss_pred:0.027543630450963974, decouple_loss:0.007184358313679695
The generated pressure mean: 0.4508039951324463
loss_pred:0.024511447176337242, decouple_loss:0.007043164689093828
The generated pressure mean: 0.45008260011672974
loss_pred:0.024400731548666954, decouple_loss:0.0070655206218361855
Iteration: 4090, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4316997230052948
loss_pred:0.02561751753091812, decouple_loss:0.008854647167026997
The generated pressure mean: 0.4351732134819031
loss_pred:0.02405591309070587, decouple_loss:0.009086910635232925
The generated pressure mean: 0.4350404441356659
loss_pred:0.02438168041408062, decouple_loss:0.00948010478168726
2023-04-17 03:25:18 testing...
The generated pressure mean: 0.41416144371032715
The generated pressure mean: 0.4206218421459198
loss_pred:0.03657408803701401, decouple_loss:0.006693288218230009
The generated pressure mean: 0.42234450578689575
loss_pred:0.035400670021772385, decouple_loss:0.007075922098010778
loss_pred:0.035312142223119736, decouple_loss:0.007273330818861723
WV_0_PC_0_EH_1_PS_40, loss: 0.036113008856773376, avg_mse: 0.04930701106786728
current test mse: 0.049307
Iteration: 4091, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44711560010910034
loss_pred:0.025061102584004402, decouple_loss:0.005968425422906876
The generated pressure mean: 0.44233641028404236
loss_pred:0.025248659774661064, decouple_loss:0.006145514082163572
The generated pressure mean: 0.44992974400520325
loss_pred:0.02444731816649437, decouple_loss:0.005869423970580101
Iteration: 4092, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4627278447151184
loss_pred:0.025201471522450447, decouple_loss:0.007392216008156538
The generated pressure mean: 0.47247129678726196
loss_pred:0.02584221214056015, decouple_loss:0.007438706234097481
The generated pressure mean: 0.4606996178627014
loss_pred:0.02478443644940853, decouple_loss:0.007778829429298639
Iteration: 4093, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4325919449329376
loss_pred:0.023799046874046326, decouple_loss:0.00567690609022975
The generated pressure mean: 0.43264779448509216
loss_pred:0.024254608899354935, decouple_loss:0.005579307675361633
The generated pressure mean: 0.4325160086154938
loss_pred:0.02415684424340725, decouple_loss:0.005612582433968782
Iteration: 4094, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44622722268104553
The generated pressure mean: 0.440422385931015
loss_pred:0.023697495460510254, decouple_loss:0.0061610122211277485
loss_pred:0.02422594092786312, decouple_loss:0.006205710582435131
The generated pressure mean: 0.43567875027656555
loss_pred:0.024971630424261093, decouple_loss:0.005896080285310745
Iteration: 4095, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4560100734233856
The generated pressure mean: 0.45536839962005615
loss_pred:0.023823855444788933, decouple_loss:0.006065523251891136
loss_pred:0.023947114124894142, decouple_loss:0.006308175157755613
The generated pressure mean: 0.45925503969192505
loss_pred:0.02383042499423027, decouple_loss:0.006385171320289373
Iteration: 4096, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44489479064941406
The generated pressure mean: 0.4454699158668518
loss_pred:0.025097128003835678, decouple_loss:0.006177177187055349
loss_pred:0.02416137605905533, decouple_loss:0.006254582200199366
The generated pressure mean: 0.44676336646080017
loss_pred:0.02383197844028473, decouple_loss:0.00629819929599762
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4097, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42845454812049866
The generated pressure mean: 0.43234968185424805
loss_pred:0.02459654211997986, decouple_loss:0.005274682305753231
loss_pred:0.023911835625767708, decouple_loss:0.00519427889958024
The generated pressure mean: 0.42849862575531006
loss_pred:0.0249350406229496, decouple_loss:0.005287304054945707
Iteration: 4098, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45596393942832947
loss_pred:0.024558017030358315, decouple_loss:0.00713255163282156
The generated pressure mean: 0.46296507120132446
loss_pred:0.02444094978272915, decouple_loss:0.007115523796528578
The generated pressure mean: 0.46202778816223145
loss_pred:0.024021677672863007, decouple_loss:0.006856395397335291
Iteration: 4099, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508562386035919
loss_pred:0.024720141664147377, decouple_loss:0.007187464740127325
The generated pressure mean: 0.45316392183303833
loss_pred:0.02295803464949131, decouple_loss:0.0073041548021137714
The generated pressure mean: 0.4475696086883545
loss_pred:0.02410006895661354, decouple_loss:0.0070808962918818
Iteration: 4100, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43664082884788513
loss_pred:0.023603884503245354, decouple_loss:0.006885102950036526
The generated pressure mean: 0.44099000096321106
The generated pressure mean: 0.4378945231437683
loss_pred:0.02419881708920002, decouple_loss:0.007275597658008337
loss_pred:0.025457534939050674, decouple_loss:0.0069627962075173855
2023-04-17 03:27:11 testing...
The generated pressure mean: 0.41484636068344116
The generated pressure mean: 0.42181453108787537
loss_pred:0.03735547885298729, decouple_loss:0.006713129114359617
The generated pressure mean: 0.4238135516643524
loss_pred:0.03584527224302292, decouple_loss:0.007112904917448759
loss_pred:0.03601313754916191, decouple_loss:0.007291076239198446
WV_0_PC_0_EH_1_PS_40, loss: 0.03675658255815506, avg_mse: 0.05110376700758934
current test mse: 0.051104
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 4101, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44933298230171204
loss_pred:0.023940740153193474, decouple_loss:0.006574668455868959
The generated pressure mean: 0.4506348669528961
loss_pred:0.027675438672304153, decouple_loss:0.006814017426222563
The generated pressure mean: 0.45089662075042725
loss_pred:0.023936955258250237, decouple_loss:0.006816725712269545
Iteration: 4102, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42826077342033386The generated pressure mean: 0.4291882812976837
loss_pred:0.024517152458429337, decouple_loss:0.007813353091478348
loss_pred:0.02465173788368702, decouple_loss:0.007539185229688883
The generated pressure mean: 0.43049490451812744
loss_pred:0.02461407706141472, decouple_loss:0.0077661857940256596
Iteration: 4103, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4615430533885956
loss_pred:0.024859070777893066, decouple_loss:0.0074175684712827206
The generated pressure mean: 0.4621657133102417
loss_pred:0.024864759296178818, decouple_loss:0.007345966063439846
The generated pressure mean: 0.46120691299438477
loss_pred:0.024417318403720856, decouple_loss:0.007432782091200352
Iteration: 4104, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44878190755844116
The generated pressure mean: 0.44930338859558105
loss_pred:0.023811234161257744, decouple_loss:0.007116571068763733
loss_pred:0.025303369387984276, decouple_loss:0.00693977065384388
The generated pressure mean: 0.44748014211654663
loss_pred:0.02403695322573185, decouple_loss:0.006960746366530657
Iteration: 4105, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4384561777114868
loss_pred:0.024043582379817963, decouple_loss:0.0065131643787026405
The generated pressure mean: 0.4303509294986725
loss_pred:0.024453865364193916, decouple_loss:0.006654899101704359
The generated pressure mean: 0.4309898912906647
loss_pred:0.02422497235238552, decouple_loss:0.006542336195707321
Iteration: 4106, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4558272659778595
loss_pred:0.023251987993717194, decouple_loss:0.006787661463022232
The generated pressure mean: 0.4516027271747589
loss_pred:0.026260746642947197, decouple_loss:0.006802424322813749
The generated pressure mean: 0.4523400366306305
loss_pred:0.02474546991288662, decouple_loss:0.006784036755561829
Iteration: 4107, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476299583911896
loss_pred:0.02506561018526554, decouple_loss:0.006407049484550953
The generated pressure mean: 0.4515414237976074
loss_pred:0.024369576945900917, decouple_loss:0.006211244035512209
The generated pressure mean: 0.4464302659034729
loss_pred:0.024380289018154144, decouple_loss:0.00621742894873023
Iteration: 4108, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43689125776290894
The generated pressure mean: 0.43641138076782227
loss_pred:0.024550076574087143, decouple_loss:0.005617333110421896
loss_pred:0.02520984411239624, decouple_loss:0.005565460305660963
The generated pressure mean: 0.4410558044910431
loss_pred:0.0250441562384367, decouple_loss:0.005586307030171156
Iteration: 4109, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461854100227356
loss_pred:0.024220280349254608, decouple_loss:0.006401281803846359
The generated pressure mean: 0.44588786363601685
loss_pred:0.024093031883239746, decouple_loss:0.006308531854301691
The generated pressure mean: 0.4465668499469757
loss_pred:0.023980360478162766, decouple_loss:0.006379138678312302
Iteration: 4110, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45620688796043396
loss_pred:0.0255874153226614, decouple_loss:0.005750915966928005
The generated pressure mean: 0.45250970125198364
loss_pred:0.024085333570837975, decouple_loss:0.005732293706387281
The generated pressure mean: 0.4550338387489319
loss_pred:0.023974010720849037, decouple_loss:0.005941137205809355
2023-04-17 03:29:39 testing...
The generated pressure mean: 0.4179588854312897
The generated pressure mean: 0.42432424426078796
The generated pressure mean: 0.4261687994003296
loss_pred:0.03720445930957794, decouple_loss:0.008930442854762077
loss_pred:0.03622785210609436, decouple_loss:0.00936861615628004
loss_pred:0.03594033047556877, decouple_loss:0.009367266669869423
WV_0_PC_0_EH_1_PS_40, loss: 0.036918651312589645, avg_mse: 0.050724808126688004
current test mse: 0.050725
Iteration: 4111, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43512749671936035
loss_pred:0.024019237607717514, decouple_loss:0.007462362293154001
The generated pressure mean: 0.43248167634010315
loss_pred:0.025327764451503754, decouple_loss:0.007682750467211008
The generated pressure mean: 0.4376586079597473
loss_pred:0.02551201358437538, decouple_loss:0.007216582540422678
Iteration: 4112, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.455152690410614
loss_pred:0.024448681622743607, decouple_loss:0.007184821180999279
The generated pressure mean: 0.4592146873474121
loss_pred:0.02411326766014099, decouple_loss:0.007056014146655798
The generated pressure mean: 0.455996036529541
loss_pred:0.025040743872523308, decouple_loss:0.00719591835513711
Iteration: 4113, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44633185863494873
loss_pred:0.023669693619012833, decouple_loss:0.005843112710863352
The generated pressure mean: 0.44607067108154297
loss_pred:0.02522818185389042, decouple_loss:0.005760732106864452
The generated pressure mean: 0.4416608512401581
loss_pred:0.024087125435471535, decouple_loss:0.005977041553705931
Iteration: 4114, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4438246190547943
loss_pred:0.024784157052636147, decouple_loss:0.007743066176772118
The generated pressure mean: 0.4455513060092926
loss_pred:0.0234188474714756, decouple_loss:0.007801339961588383
The generated pressure mean: 0.44576016068458557
loss_pred:0.024030448868870735, decouple_loss:0.007444434799253941
Iteration: 4115, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4531219005584717
loss_pred:0.024757089093327522, decouple_loss:0.007415009196847677
The generated pressure mean: 0.451526403427124
loss_pred:0.024654056876897812, decouple_loss:0.007545883301645517
The generated pressure mean: 0.4521631896495819
loss_pred:0.023366043344140053, decouple_loss:0.007464477326720953
Iteration: 4116, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462130665779114
loss_pred:0.024796774610877037, decouple_loss:0.007074859458953142
The generated pressure mean: 0.4482134282588959
loss_pred:0.024306263774633408, decouple_loss:0.0069397445768117905
The generated pressure mean: 0.4455282688140869
loss_pred:0.024073628708720207, decouple_loss:0.0072187501937150955
Iteration: 4117, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.434770792722702
loss_pred:0.024230461567640305, decouple_loss:0.007815943099558353
The generated pressure mean: 0.4353526830673218
The generated pressure mean: 0.43425706028938293
loss_pred:0.023277711123228073, decouple_loss:0.008022747933864594
loss_pred:0.025194574147462845, decouple_loss:0.008128599263727665
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4118, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4516501724720001
loss_pred:0.02441822551190853, decouple_loss:0.007383438292890787
The generated pressure mean: 0.4551575481891632
loss_pred:0.024406448006629944, decouple_loss:0.007360995747148991
The generated pressure mean: 0.4543377757072449
loss_pred:0.02605382539331913, decouple_loss:0.00750274071469903
Iteration: 4119, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44359543919563293
The generated pressure mean: 0.4453510046005249
loss_pred:0.025765860453248024, decouple_loss:0.007152712903916836
loss_pred:0.024416452273726463, decouple_loss:0.007349409628659487
The generated pressure mean: 0.44301891326904297
loss_pred:0.02488858252763748, decouple_loss:0.007104698568582535
Iteration: 4120, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500037133693695
loss_pred:0.02374141849577427, decouple_loss:0.006046697497367859
The generated pressure mean: 0.4460334777832031
loss_pred:0.024230601266026497, decouple_loss:0.006087328307330608
The generated pressure mean: 0.4513174593448639
loss_pred:0.02328716218471527, decouple_loss:0.006057808641344309
2023-04-17 03:31:32 testing...
The generated pressure mean: 0.4155353009700775
The generated pressure mean: 0.42267856001853943
loss_pred:0.036052487790584564, decouple_loss:0.007995006628334522
The generated pressure mean: 0.42486658692359924
loss_pred:0.03477386385202408, decouple_loss:0.00853661634027958
loss_pred:0.03462948650121689, decouple_loss:0.008699634112417698
WV_0_PC_0_EH_1_PS_40, loss: 0.03557246923446655, avg_mse: 0.04861096665263176
current test mse: 0.048611
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 4121, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44295164942741394
loss_pred:0.02530781179666519, decouple_loss:0.006695290561765432
The generated pressure mean: 0.44523191452026367
The generated pressure mean: 0.4407791793346405
loss_pred:0.024744711816310883, decouple_loss:0.0067951856181025505
loss_pred:0.024188663810491562, decouple_loss:0.006788969971239567
Iteration: 4122, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45139867067337036
loss_pred:0.02583306096494198, decouple_loss:0.0059549580328166485
The generated pressure mean: 0.4524892270565033
loss_pred:0.023396918550133705, decouple_loss:0.006137941498309374
The generated pressure mean: 0.45040082931518555
loss_pred:0.024052459746599197, decouple_loss:0.005751919001340866
Iteration: 4123, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4295215308666229
loss_pred:0.02530853822827339, decouple_loss:0.006810437422245741
The generated pressure mean: 0.4332505166530609
loss_pred:0.024465685710310936, decouple_loss:0.006817001849412918
The generated pressure mean: 0.4329255521297455
loss_pred:0.02512303553521633, decouple_loss:0.006844113115221262
Iteration: 4124, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46499526500701904
loss_pred:0.02600499428808689, decouple_loss:0.009518535807728767
The generated pressure mean: 0.4664090871810913
loss_pred:0.026422087103128433, decouple_loss:0.010007849894464016
The generated pressure mean: 0.4585552215576172
loss_pred:0.02559160254895687, decouple_loss:0.009398287162184715
Iteration: 4125, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45073509216308594
loss_pred:0.02461097575724125, decouple_loss:0.00917389802634716
The generated pressure mean: 0.45279306173324585
loss_pred:0.025410261005163193, decouple_loss:0.009402942843735218
The generated pressure mean: 0.4516969621181488
loss_pred:0.02486203797161579, decouple_loss:0.009223194792866707
Iteration: 4126, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4297519624233246
loss_pred:0.024703770875930786, decouple_loss:0.00645774370059371
The generated pressure mean: 0.42735180258750916
loss_pred:0.02484727092087269, decouple_loss:0.0065347980707883835
The generated pressure mean: 0.4235583543777466
loss_pred:0.025186864659190178, decouple_loss:0.006671401672065258
Iteration: 4127, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45771631598472595
loss_pred:0.025506170466542244, decouple_loss:0.008385824970901012
The generated pressure mean: 0.4586486518383026
loss_pred:0.026342956349253654, decouple_loss:0.008540634997189045
The generated pressure mean: 0.45700135827064514
loss_pred:0.02380700223147869, decouple_loss:0.008257633075118065
Iteration: 4128, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4447609782218933
loss_pred:0.02326906844973564, decouple_loss:0.00744140800088644
The generated pressure mean: 0.44526851177215576
loss_pred:0.024441493675112724, decouple_loss:0.00753083685413003
The generated pressure mean: 0.44917765259742737
loss_pred:0.022902360185980797, decouple_loss:0.007404881529510021
Iteration: 4129, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43989941477775574
The generated pressure mean: 0.4404776692390442
loss_pred:0.023704860359430313, decouple_loss:0.007696711923927069
loss_pred:0.023616012185811996, decouple_loss:0.00781404972076416
The generated pressure mean: 0.44222739338874817
loss_pred:0.024803511798381805, decouple_loss:0.007858570665121078
Iteration: 4130, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498751759529114
loss_pred:0.0245281420648098, decouple_loss:0.006643510889261961
The generated pressure mean: 0.4471317231655121The generated pressure mean: 0.4486110508441925
loss_pred:0.02471098117530346, decouple_loss:0.0068710483610630035
loss_pred:0.02433858811855316, decouple_loss:0.006923948414623737
2023-04-17 03:34:02 testing...
The generated pressure mean: 0.4147838056087494
The generated pressure mean: 0.4218652844429016
loss_pred:0.03735924884676933, decouple_loss:0.008623892441391945
The generated pressure mean: 0.42396795749664307
loss_pred:0.03616366907954216, decouple_loss:0.009168758057057858
loss_pred:0.0361456535756588, decouple_loss:0.009343340992927551
WV_0_PC_0_EH_1_PS_40, loss: 0.03700845688581467, avg_mse: 0.051079005002975464
current test mse: 0.051079
Iteration: 4131, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452616274356842
loss_pred:0.024389488622546196, decouple_loss:0.0074338046833872795
The generated pressure mean: 0.450935959815979
loss_pred:0.02394547127187252, decouple_loss:0.007372742518782616
The generated pressure mean: 0.4560689330101013
loss_pred:0.025396157056093216, decouple_loss:0.007575186900794506
Iteration: 4132, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44866225123405457
loss_pred:0.022592414170503616, decouple_loss:0.007406740449368954
The generated pressure mean: 0.4465564489364624
loss_pred:0.024385597556829453, decouple_loss:0.007148547098040581
The generated pressure mean: 0.4453730881214142
loss_pred:0.025042394176125526, decouple_loss:0.007006324362009764
Iteration: 4133, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4368327260017395
loss_pred:0.024517159909009933, decouple_loss:0.0071951947174966335
The generated pressure mean: 0.43915510177612305
loss_pred:0.02599515952169895, decouple_loss:0.0069774845615029335
The generated pressure mean: 0.43851596117019653
loss_pred:0.024243459105491638, decouple_loss:0.006881339475512505
Iteration: 4134, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46012502908706665
loss_pred:0.024418573826551437, decouple_loss:0.005708675365895033
The generated pressure mean: 0.4615494906902313
loss_pred:0.02506260760128498, decouple_loss:0.00598255917429924
The generated pressure mean: 0.4624405801296234
loss_pred:0.024398652836680412, decouple_loss:0.0057190656661987305
Iteration: 4135, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4241504371166229
loss_pred:0.026711594313383102, decouple_loss:0.007734669838100672
The generated pressure mean: 0.42227327823638916
loss_pred:0.025660742074251175, decouple_loss:0.007703316863626242
The generated pressure mean: 0.4222224950790405
loss_pred:0.0249312873929739, decouple_loss:0.007692886982113123
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4136, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46810227632522583
loss_pred:0.0246333759278059, decouple_loss:0.006413223687559366
The generated pressure mean: 0.47145113348960876
loss_pred:0.026567019522190094, decouple_loss:0.006409804802387953
The generated pressure mean: 0.47195354104042053
loss_pred:0.02760717086493969, decouple_loss:0.006545421667397022
Iteration: 4137, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4319345951080322
loss_pred:0.02317408286035061, decouple_loss:0.006506976671516895
The generated pressure mean: 0.4317820072174072
loss_pred:0.023783814162015915, decouple_loss:0.006446160841733217
The generated pressure mean: 0.42919328808784485
loss_pred:0.025555627420544624, decouple_loss:0.006381309125572443
Iteration: 4138, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44581279158592224
loss_pred:0.023795487359166145, decouple_loss:0.00612699706107378
The generated pressure mean: 0.4465256631374359
loss_pred:0.02423792891204357, decouple_loss:0.006138465832918882
The generated pressure mean: 0.44454482197761536
loss_pred:0.023814113810658455, decouple_loss:0.00602707639336586
Iteration: 4139, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4597354531288147
loss_pred:0.023373866453766823, decouple_loss:0.005848302505910397
The generated pressure mean: 0.4566415548324585
loss_pred:0.023628005757927895, decouple_loss:0.006058435421437025
The generated pressure mean: 0.46058857440948486
loss_pred:0.024966010823845863, decouple_loss:0.005794892553240061
Iteration: 4140, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4390491843223572
loss_pred:0.026165282353758812, decouple_loss:0.006028305739164352
The generated pressure mean: 0.43368634581565857
loss_pred:0.024556823074817657, decouple_loss:0.006019829772412777
The generated pressure mean: 0.43551596999168396
loss_pred:0.024762369692325592, decouple_loss:0.006132754497230053
2023-04-17 03:35:55 testing...
The generated pressure mean: 0.4160626530647278
The generated pressure mean: 0.4236852526664734
loss_pred:0.036785420030355453, decouple_loss:0.007400772534310818
The generated pressure mean: 0.42560476064682007
loss_pred:0.035868532955646515, decouple_loss:0.00796295702457428
loss_pred:0.03557397425174713, decouple_loss:0.008179519325494766
WV_0_PC_0_EH_1_PS_40, loss: 0.03646836429834366, avg_mse: 0.050605323165655136
current test mse: 0.050605
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 4141, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4431600570678711
loss_pred:0.024706261232495308, decouple_loss:0.006504380144178867
The generated pressure mean: 0.44720080494880676
loss_pred:0.02418322116136551, decouple_loss:0.006029600743204355
The generated pressure mean: 0.4421519637107849
loss_pred:0.02405497245490551, decouple_loss:0.006616918835788965
Iteration: 4142, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45391845703125
loss_pred:0.025561491027474403, decouple_loss:0.00597802922129631
The generated pressure mean: 0.4555070698261261
loss_pred:0.023987244814634323, decouple_loss:0.005979007575660944
The generated pressure mean: 0.4544316232204437
loss_pred:0.025683995336294174, decouple_loss:0.005940093658864498
Iteration: 4143, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43727871775627136
The generated pressure mean: 0.43921610713005066
loss_pred:0.025504756718873978, decouple_loss:0.006343868561089039
loss_pred:0.023828554898500443, decouple_loss:0.006117318291217089
The generated pressure mean: 0.4440746605396271
loss_pred:0.024874728173017502, decouple_loss:0.00655218493193388
Iteration: 4144, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44872480630874634
loss_pred:0.025951921939849854, decouple_loss:0.006976548582315445
The generated pressure mean: 0.453974187374115
loss_pred:0.023500358685851097, decouple_loss:0.006966845598071814
The generated pressure mean: 0.45582225918769836
loss_pred:0.024053607136011124, decouple_loss:0.006489118095487356
Iteration: 4145, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499674141407013
loss_pred:0.026627464219927788, decouple_loss:0.006377424579113722
The generated pressure mean: 0.45007404685020447
loss_pred:0.02473139576613903, decouple_loss:0.0062105972319841385
The generated pressure mean: 0.45412400364875793
loss_pred:0.02439306676387787, decouple_loss:0.006305997259914875
Iteration: 4146, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43107014894485474
loss_pred:0.023716773837804794, decouple_loss:0.006192177999764681
The generated pressure mean: 0.42942771315574646
loss_pred:0.025172725319862366, decouple_loss:0.006200648378580809
The generated pressure mean: 0.42946329712867737
loss_pred:0.025295525789260864, decouple_loss:0.006492301356047392
Iteration: 4147, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4522334933280945
loss_pred:0.022976545616984367, decouple_loss:0.0060235895216465
The generated pressure mean: 0.45445725321769714
loss_pred:0.02447468414902687, decouple_loss:0.005857675336301327
The generated pressure mean: 0.45369887351989746
loss_pred:0.02429458685219288, decouple_loss:0.005957014858722687
Iteration: 4148, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46463456749916077
loss_pred:0.02300702966749668, decouple_loss:0.008219685405492783
The generated pressure mean: 0.46485635638237
loss_pred:0.022825928404927254, decouple_loss:0.008497395552694798
The generated pressure mean: 0.46829065680503845
loss_pred:0.023651473224163055, decouple_loss:0.007734242826700211
Iteration: 4149, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43650516867637634
loss_pred:0.025061236694455147, decouple_loss:0.006056060083210468
The generated pressure mean: 0.43653106689453125
loss_pred:0.023720698431134224, decouple_loss:0.006185157224535942
The generated pressure mean: 0.4393801987171173
loss_pred:0.026026317849755287, decouple_loss:0.005992488469928503
Iteration: 4150, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4422977566719055
loss_pred:0.024520613253116608, decouple_loss:0.008229333907365799
The generated pressure mean: 0.43697458505630493
loss_pred:0.024230236187577248, decouple_loss:0.008138428442180157
The generated pressure mean: 0.44181376695632935
loss_pred:0.02232182025909424, decouple_loss:0.008568032644689083
2023-04-17 03:38:31 testing...
The generated pressure mean: 0.41472309827804565
The generated pressure mean: 0.42058059573173523
The generated pressure mean: 0.42248645424842834
loss_pred:0.03681207448244095, decouple_loss:0.007348029874265194
loss_pred:0.03578199818730354, decouple_loss:0.00772440480068326
loss_pred:0.03564976900815964, decouple_loss:0.00790468044579029
WV_0_PC_0_EH_1_PS_40, loss: 0.03646423667669296, avg_mse: 0.050412215292453766
current test mse: 0.050412
Iteration: 4151, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44502025842666626
loss_pred:0.026496093720197678, decouple_loss:0.006744525860995054
The generated pressure mean: 0.44784435629844666
loss_pred:0.02185470052063465, decouple_loss:0.006599287036806345
The generated pressure mean: 0.4476919174194336
loss_pred:0.022902244701981544, decouple_loss:0.006595410872250795
Iteration: 4152, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44730624556541443
The generated pressure mean: 0.4480947256088257
loss_pred:0.024007434025406837, decouple_loss:0.007227711845189333
loss_pred:0.025886736810207367, decouple_loss:0.007336592301726341
The generated pressure mean: 0.4474712312221527
loss_pred:0.02515072003006935, decouple_loss:0.0075112273916602135
Iteration: 4153, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45816507935523987
The generated pressure mean: 0.455952525138855loss_pred:0.025658084079623222, decouple_loss:0.006541892420500517
loss_pred:0.02591356821358204, decouple_loss:0.006395537406206131
The generated pressure mean: 0.45363911986351013
loss_pred:0.024859515950083733, decouple_loss:0.006460192147642374
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4154, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45430347323417664
loss_pred:0.024944305419921875, decouple_loss:0.00696961535140872
The generated pressure mean: 0.44637325406074524
loss_pred:0.025246402248740196, decouple_loss:0.006874614395201206
The generated pressure mean: 0.44852083921432495
loss_pred:0.02453836426138878, decouple_loss:0.006714690010994673
Iteration: 4155, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43013766407966614
loss_pred:0.0250377394258976, decouple_loss:0.006144821643829346
The generated pressure mean: 0.4278715252876282
loss_pred:0.025470593944191933, decouple_loss:0.006205645855516195
The generated pressure mean: 0.4305669367313385
loss_pred:0.025153622031211853, decouple_loss:0.006239458452910185
Iteration: 4156, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4537540376186371
The generated pressure mean: 0.4560360610485077
loss_pred:0.026952294632792473, decouple_loss:0.0062248664908111095
loss_pred:0.02535010501742363, decouple_loss:0.006382670719176531
The generated pressure mean: 0.4514184594154358
loss_pred:0.023938247933983803, decouple_loss:0.006311031524091959
Iteration: 4157, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.460420697927475
The generated pressure mean: 0.46741998195648193
loss_pred:0.025839798152446747, decouple_loss:0.00666537182405591
loss_pred:0.025291582569479942, decouple_loss:0.0068615940399467945
The generated pressure mean: 0.46302762627601624
loss_pred:0.022917795926332474, decouple_loss:0.006813084706664085
Iteration: 4158, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43440818786621094
loss_pred:0.02402733825147152, decouple_loss:0.00663106981664896
The generated pressure mean: 0.4386969804763794
loss_pred:0.026046914979815483, decouple_loss:0.006539023015648127
The generated pressure mean: 0.4351189434528351
loss_pred:0.023891566321253777, decouple_loss:0.006394990254193544
Iteration: 4159, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43424245715141296
loss_pred:0.02412242256104946, decouple_loss:0.006804351694881916
The generated pressure mean: 0.43846943974494934
loss_pred:0.02402062714099884, decouple_loss:0.006720284000039101
The generated pressure mean: 0.433601975440979
loss_pred:0.026464562863111496, decouple_loss:0.007046790793538094
Iteration: 4160, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45798784494400024
loss_pred:0.02523181401193142, decouple_loss:0.006361853331327438
The generated pressure mean: 0.45494386553764343
loss_pred:0.02372470684349537, decouple_loss:0.005958213936537504
The generated pressure mean: 0.4531134366989136
loss_pred:0.025253962725400925, decouple_loss:0.006312352139502764
2023-04-17 03:40:25 testing...
The generated pressure mean: 0.4122157096862793
The generated pressure mean: 0.4189193546772003
The generated pressure mean: 0.4214918315410614
loss_pred:0.03789684548974037, decouple_loss:0.006983865052461624
loss_pred:0.03694084659218788, decouple_loss:0.007210225332528353
loss_pred:0.0363803468644619, decouple_loss:0.007440121844410896
WV_0_PC_0_EH_1_PS_40, loss: 0.03743325173854828, avg_mse: 0.0522945374250412
current test mse: 0.052295
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 4161, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45249977707862854
loss_pred:0.02558315172791481, decouple_loss:0.006554388906806707
The generated pressure mean: 0.4620083272457123
loss_pred:0.02563786879181862, decouple_loss:0.00712389824911952
The generated pressure mean: 0.4538736045360565
loss_pred:0.029498109593987465, decouple_loss:0.006904108449816704
Iteration: 4162, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4573334753513336
The generated pressure mean: 0.4544469714164734
loss_pred:0.023083923384547234, decouple_loss:0.007145014125853777
loss_pred:0.024589702486991882, decouple_loss:0.00699791731312871
The generated pressure mean: 0.4500636160373688
loss_pred:0.024689963087439537, decouple_loss:0.007377473171800375
Iteration: 4163, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43447762727737427
The generated pressure mean: 0.44344818592071533
loss_pred:0.024509409442543983, decouple_loss:0.006244095973670483
loss_pred:0.024390412494540215, decouple_loss:0.006048902869224548
The generated pressure mean: 0.43758365511894226
loss_pred:0.025567766278982162, decouple_loss:0.005880566313862801
Iteration: 4164, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42786380648612976
loss_pred:0.02536991983652115, decouple_loss:0.006369754206389189
The generated pressure mean: 0.43110528588294983
loss_pred:0.024602927267551422, decouple_loss:0.00651161652058363
The generated pressure mean: 0.42338383197784424
loss_pred:0.024269873276352882, decouple_loss:0.006928164511919022
Iteration: 4165, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4640270173549652
loss_pred:0.02545846812427044, decouple_loss:0.007083927281200886
The generated pressure mean: 0.47001945972442627
loss_pred:0.024116531014442444, decouple_loss:0.00686390558257699
The generated pressure mean: 0.46936824917793274
loss_pred:0.02572832629084587, decouple_loss:0.007099273148924112
Iteration: 4166, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4600379467010498
loss_pred:0.023568252101540565, decouple_loss:0.006380998995155096
The generated pressure mean: 0.45264461636543274
loss_pred:0.02454259619116783, decouple_loss:0.006726861000061035
The generated pressure mean: 0.4549034833908081
loss_pred:0.02517305687069893, decouple_loss:0.006169843953102827
Iteration: 4167, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43710625171661377
loss_pred:0.023919038474559784, decouple_loss:0.006040405482053757
The generated pressure mean: 0.44102853536605835
loss_pred:0.02481808327138424, decouple_loss:0.005985122639685869
The generated pressure mean: 0.43977096676826477
loss_pred:0.024874970316886902, decouple_loss:0.005980547051876783
Iteration: 4168, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4373498857021332
loss_pred:0.024409284815192223, decouple_loss:0.006036336999386549
The generated pressure mean: 0.4442981779575348
loss_pred:0.023510826751589775, decouple_loss:0.006010349374264479
The generated pressure mean: 0.44194990396499634
loss_pred:0.02323312871158123, decouple_loss:0.006143237929791212
Iteration: 4169, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4526333212852478
loss_pred:0.02434142865240574, decouple_loss:0.006129884626716375
The generated pressure mean: 0.4477789103984833
The generated pressure mean: 0.44472208619117737
loss_pred:0.025194823741912842, decouple_loss:0.006142361089587212
loss_pred:0.023943133652210236, decouple_loss:0.006081062369048595
Iteration: 4170, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44971880316734314
loss_pred:0.0265722144395113, decouple_loss:0.007189321797341108
The generated pressure mean: 0.45150551199913025
loss_pred:0.025241345167160034, decouple_loss:0.00734533928334713
The generated pressure mean: 0.4520578682422638
loss_pred:0.023694144561886787, decouple_loss:0.007112413644790649
2023-04-17 03:42:53 testing...
The generated pressure mean: 0.41315194964408875
The generated pressure mean: 0.4199396073818207
The generated pressure mean: 0.4219123423099518
loss_pred:0.037801593542099, decouple_loss:0.007221061736345291
loss_pred:0.036514896899461746, decouple_loss:0.007478088606148958
loss_pred:0.03635723516345024, decouple_loss:0.007811403833329678
WV_0_PC_0_EH_1_PS_40, loss: 0.03726641833782196, avg_mse: 0.05185989663004875
current test mse: 0.05186
Iteration: 4171, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44963425397872925
loss_pred:0.02683696150779724, decouple_loss:0.006489231251180172
The generated pressure mean: 0.4529198110103607
loss_pred:0.023810019716620445, decouple_loss:0.006446113809943199
The generated pressure mean: 0.45021796226501465
loss_pred:0.024791263043880463, decouple_loss:0.0064619798213243484
Iteration: 4172, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459627866744995
loss_pred:0.02231478877365589, decouple_loss:0.006819173227995634
The generated pressure mean: 0.44285717606544495
loss_pred:0.023237260058522224, decouple_loss:0.006570770405232906
The generated pressure mean: 0.4414057433605194
loss_pred:0.023539748042821884, decouple_loss:0.006727311760187149
Iteration: 4173, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44496041536331177
loss_pred:0.024073537439107895, decouple_loss:0.006515162065625191
The generated pressure mean: 0.4411661624908447
loss_pred:0.02552502229809761, decouple_loss:0.006444093771278858
The generated pressure mean: 0.44391578435897827
loss_pred:0.02362700179219246, decouple_loss:0.00676162401214242
Iteration: 4174, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44617268443107605
loss_pred:0.025561198592185974, decouple_loss:0.006528869271278381
The generated pressure mean: 0.44666576385498047
The generated pressure mean: 0.44386303424835205
loss_pred:0.024877801537513733, decouple_loss:0.006400877144187689
loss_pred:0.02552407793700695, decouple_loss:0.006374263670295477
Iteration: 4175, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4541289210319519
loss_pred:0.02380445972084999, decouple_loss:0.006510390900075436
The generated pressure mean: 0.4540433883666992
loss_pred:0.023752836510539055, decouple_loss:0.006272609811276197
The generated pressure mean: 0.4517565667629242
loss_pred:0.02503960393369198, decouple_loss:0.006093624047935009
Iteration: 4176, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45008233189582825
loss_pred:0.024277135729789734, decouple_loss:0.006991948466747999
The generated pressure mean: 0.44908615946769714
loss_pred:0.0247001014649868, decouple_loss:0.007192070130258799
The generated pressure mean: 0.4476723074913025
loss_pred:0.023529792204499245, decouple_loss:0.007621649652719498
Iteration: 4177, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465339481830597
loss_pred:0.024479683488607407, decouple_loss:0.006067041307687759
The generated pressure mean: 0.44940972328186035
loss_pred:0.024709170684218407, decouple_loss:0.005959111265838146
The generated pressure mean: 0.44410938024520874
loss_pred:0.023216966539621353, decouple_loss:0.006066323257982731
Iteration: 4178, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44913503527641296
loss_pred:0.02452593296766281, decouple_loss:0.006447650957852602
The generated pressure mean: 0.4513271749019623
The generated pressure mean: 0.4508301913738251
loss_pred:0.024680111557245255, decouple_loss:0.006882254034280777
loss_pred:0.024315273389220238, decouple_loss:0.006470107939094305
Iteration: 4179, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4370310604572296
loss_pred:0.024805573746562004, decouple_loss:0.007568661123514175
The generated pressure mean: 0.4407474994659424
The generated pressure mean: 0.43945467472076416
loss_pred:0.02385883219540119, decouple_loss:0.007133746985346079
loss_pred:0.025432486087083817, decouple_loss:0.007330404594540596
Iteration: 4180, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4513115882873535
loss_pred:0.023362090811133385, decouple_loss:0.006118475459516048
The generated pressure mean: 0.45036542415618896
loss_pred:0.022281484678387642, decouple_loss:0.0058005498722195625
The generated pressure mean: 0.4521595537662506
loss_pred:0.024122588336467743, decouple_loss:0.005957655142992735
2023-04-17 03:44:47 testing...
The generated pressure mean: 0.4153797924518585
The generated pressure mean: 0.4232304096221924
The generated pressure mean: 0.42538392543792725
loss_pred:0.03699357062578201, decouple_loss:0.006191906984895468
loss_pred:0.03556946665048599, decouple_loss:0.006582511123269796
loss_pred:0.035244811326265335, decouple_loss:0.00686758803203702
WV_0_PC_0_EH_1_PS_40, loss: 0.03626331686973572, avg_mse: 0.05049780383706093
current test mse: 0.050498
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 4181, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4397745132446289
loss_pred:0.024222133681178093, decouple_loss:0.005770310293883085
The generated pressure mean: 0.44055142998695374
loss_pred:0.02465619519352913, decouple_loss:0.005607398692518473
The generated pressure mean: 0.449800968170166
loss_pred:0.022777443751692772, decouple_loss:0.0056387451477348804
Iteration: 4182, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4521757662296295
The generated pressure mean: 0.4537853002548218loss_pred:0.025627179071307182, decouple_loss:0.006775295361876488
loss_pred:0.02624576911330223, decouple_loss:0.006534501910209656
The generated pressure mean: 0.4521980583667755
loss_pred:0.023441588506102562, decouple_loss:0.006828444078564644
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4183, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45134663581848145
The generated pressure mean: 0.44824010133743286
loss_pred:0.023721178993582726, decouple_loss:0.0058997091837227345
loss_pred:0.02320055663585663, decouple_loss:0.005706084426492453
The generated pressure mean: 0.44885918498039246
loss_pred:0.02441822551190853, decouple_loss:0.0060006421990692616
Iteration: 4184, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4313611686229706
The generated pressure mean: 0.4320138096809387
loss_pred:0.023847049102187157, decouple_loss:0.006343774031847715
loss_pred:0.0259166918694973, decouple_loss:0.006523229647427797
The generated pressure mean: 0.4347412884235382
loss_pred:0.02419576607644558, decouple_loss:0.006713243201375008
Iteration: 4185, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4535023272037506
The generated pressure mean: 0.44474664330482483
loss_pred:0.023542029783129692, decouple_loss:0.007357460912317038
loss_pred:0.02334749698638916, decouple_loss:0.007685843855142593
The generated pressure mean: 0.4551088511943817
loss_pred:0.02505161613225937, decouple_loss:0.008339420892298222
Iteration: 4186, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45028141140937805
The generated pressure mean: 0.45523953437805176
loss_pred:0.023257127031683922, decouple_loss:0.012088817544281483
loss_pred:0.024425391107797623, decouple_loss:0.01200504507869482
The generated pressure mean: 0.4447162449359894
loss_pred:0.024189451709389687, decouple_loss:0.01161537878215313
Iteration: 4187, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44168514013290405
The generated pressure mean: 0.44516852498054504
loss_pred:0.022146139293909073, decouple_loss:0.007311298046261072
loss_pred:0.024111049249768257, decouple_loss:0.0073938253335654736
The generated pressure mean: 0.44530677795410156
loss_pred:0.023077763617038727, decouple_loss:0.007465559057891369
Iteration: 4188, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4430576264858246
loss_pred:0.02318611741065979, decouple_loss:0.010518379509449005
The generated pressure mean: 0.44633156061172485
The generated pressure mean: 0.443623423576355
loss_pred:0.024805307388305664, decouple_loss:0.01049093622714281
loss_pred:0.02442091330885887, decouple_loss:0.010416485369205475
Iteration: 4189, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45440271496772766
loss_pred:0.022714558988809586, decouple_loss:0.008208177052438259
The generated pressure mean: 0.4486795961856842
loss_pred:0.023546259850263596, decouple_loss:0.00840552244335413
The generated pressure mean: 0.4586293399333954
loss_pred:0.023972397670149803, decouple_loss:0.008293450810015202
Iteration: 4190, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43755480647087097
loss_pred:0.02648739516735077, decouple_loss:0.009044645354151726
The generated pressure mean: 0.4429314434528351
loss_pred:0.023235121741890907, decouple_loss:0.00895063579082489
The generated pressure mean: 0.4411086142063141
loss_pred:0.023817727342247963, decouple_loss:0.008821596391499043
2023-04-17 03:47:14 testing...
The generated pressure mean: 0.4160272181034088
The generated pressure mean: 0.4230562448501587
The generated pressure mean: 0.4251852333545685
loss_pred:0.036460429430007935, decouple_loss:0.008630635216832161
loss_pred:0.0353403314948082, decouple_loss:0.008832610212266445
loss_pred:0.035134539008140564, decouple_loss:0.009026438929140568
WV_0_PC_0_EH_1_PS_40, loss: 0.03608659654855728, avg_mse: 0.049751169979572296
current test mse: 0.049751
Iteration: 4191, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44839590787887573
loss_pred:0.02321847900748253, decouple_loss:0.007978946901857853
The generated pressure mean: 0.44312041997909546
loss_pred:0.024041492491960526, decouple_loss:0.007544959429651499
The generated pressure mean: 0.44711217284202576
loss_pred:0.024675898253917694, decouple_loss:0.007772176526486874
Iteration: 4192, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4547068178653717
loss_pred:0.022600118070840836, decouple_loss:0.007727484684437513
The generated pressure mean: 0.45533618330955505
loss_pred:0.02208549529314041, decouple_loss:0.007458318956196308
The generated pressure mean: 0.454482764005661
loss_pred:0.02255943790078163, decouple_loss:0.007413738872855902
Iteration: 4193, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4445902407169342
loss_pred:0.023407956585288048, decouple_loss:0.00707201287150383
The generated pressure mean: 0.44546452164649963
loss_pred:0.022808661684393883, decouple_loss:0.007206764537841082
The generated pressure mean: 0.44296184182167053
loss_pred:0.023736169561743736, decouple_loss:0.007333284709602594
Iteration: 4194, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44701308012008667
loss_pred:0.02334981970489025, decouple_loss:0.009076680056750774
The generated pressure mean: 0.444117933511734
loss_pred:0.024708053097128868, decouple_loss:0.008961845189332962
The generated pressure mean: 0.4486992061138153
loss_pred:0.02463071420788765, decouple_loss:0.008964975364506245
Iteration: 4195, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43013957142829895
loss_pred:0.023509860038757324, decouple_loss:0.0061385976150631905
The generated pressure mean: 0.43860459327697754
loss_pred:0.02342696487903595, decouple_loss:0.005969199351966381
The generated pressure mean: 0.4365852475166321
loss_pred:0.023765284568071365, decouple_loss:0.00611315481364727
Iteration: 4196, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4518975019454956
loss_pred:0.024063153192400932, decouple_loss:0.009725606068968773
The generated pressure mean: 0.45495760440826416
loss_pred:0.022780757397413254, decouple_loss:0.009479576721787453
The generated pressure mean: 0.4507504105567932
loss_pred:0.022388670593500137, decouple_loss:0.009407003410160542
Iteration: 4197, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4549950957298279
loss_pred:0.023139676079154015, decouple_loss:0.0065345801413059235
The generated pressure mean: 0.45843520760536194
The generated pressure mean: 0.45717814564704895
loss_pred:0.023510633036494255, decouple_loss:0.0065597775392234325
loss_pred:0.02223324030637741, decouple_loss:0.006499114446341991
Iteration: 4198, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4431040287017822
loss_pred:0.023786354809999466, decouple_loss:0.007844545878469944
The generated pressure mean: 0.4425133168697357
loss_pred:0.02352503500878811, decouple_loss:0.007874276489019394
The generated pressure mean: 0.4486565887928009
loss_pred:0.023147083818912506, decouple_loss:0.007722184062004089
Iteration: 4199, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43216514587402344
loss_pred:0.0222894549369812, decouple_loss:0.0074585555121302605
The generated pressure mean: 0.43106400966644287
loss_pred:0.02243470586836338, decouple_loss:0.007303209975361824
The generated pressure mean: 0.42902812361717224
loss_pred:0.022124726325273514, decouple_loss:0.007340387441217899
Iteration: 4200, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45690739154815674
loss_pred:0.023022674024105072, decouple_loss:0.005929088685661554
The generated pressure mean: 0.45814454555511475
loss_pred:0.023488035425543785, decouple_loss:0.006031983532011509
The generated pressure mean: 0.4544856548309326
loss_pred:0.022810090333223343, decouple_loss:0.0059808725491166115
2023-04-17 03:49:07 testing...
The generated pressure mean: 0.42449089884757996
The generated pressure mean: 0.41809508204460144
loss_pred:0.03528337553143501, decouple_loss:0.007125312928110361
The generated pressure mean: 0.42622917890548706
loss_pred:0.03613046184182167, decouple_loss:0.006984962150454521
loss_pred:0.034827426075935364, decouple_loss:0.007359808310866356
WV_0_PC_0_EH_1_PS_40, loss: 0.03577158972620964, avg_mse: 0.04917202889919281
current test mse: 0.049172
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 4201, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44152534008026123
loss_pred:0.024007849395275116, decouple_loss:0.006225076504051685
The generated pressure mean: 0.4413389265537262
The generated pressure mean: 0.44031843543052673
loss_pred:0.02329220250248909, decouple_loss:0.006450907792896032
loss_pred:0.023447833955287933, decouple_loss:0.006441298872232437
Iteration: 4202, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46170535683631897
loss_pred:0.02398023009300232, decouple_loss:0.006015762221068144
The generated pressure mean: 0.4631507992744446
loss_pred:0.022890813648700714, decouple_loss:0.006344737950712442
The generated pressure mean: 0.4591730535030365
loss_pred:0.023676451295614243, decouple_loss:0.006011867430061102
Iteration: 4203, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4248901307582855
loss_pred:0.023734770715236664, decouple_loss:0.006873896345496178
The generated pressure mean: 0.4224042594432831
loss_pred:0.024965425953269005, decouple_loss:0.007123749703168869
The generated pressure mean: 0.42609742283821106
loss_pred:0.02196190506219864, decouple_loss:0.006703723222017288
Iteration: 4204, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45545247197151184
loss_pred:0.023084105923771858, decouple_loss:0.006503323558717966
The generated pressure mean: 0.4564438462257385
loss_pred:0.022069580852985382, decouple_loss:0.006548264995217323
The generated pressure mean: 0.4558882713317871
loss_pred:0.025912633165717125, decouple_loss:0.006586591247469187
Iteration: 4205, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45371213555336
loss_pred:0.022615963593125343, decouple_loss:0.006780185271054506
The generated pressure mean: 0.45288795232772827
loss_pred:0.023282863199710846, decouple_loss:0.006772955413907766
The generated pressure mean: 0.4512614607810974
loss_pred:0.024286305531859398, decouple_loss:0.006748140789568424
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4206, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44217076897621155
The generated pressure mean: 0.4464990496635437
loss_pred:0.02377176471054554, decouple_loss:0.005545853171497583
loss_pred:0.021866386756300926, decouple_loss:0.005537550896406174
The generated pressure mean: 0.44214901328086853
loss_pred:0.02292809449136257, decouple_loss:0.0055174375884234905
Iteration: 4207, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45236167311668396
loss_pred:0.02422322891652584, decouple_loss:0.006281511392444372
The generated pressure mean: 0.4535738229751587
The generated pressure mean: 0.45320865511894226loss_pred:0.022430242970585823, decouple_loss:0.006536503788083792
loss_pred:0.02439471334218979, decouple_loss:0.006193706300109625
Iteration: 4208, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44056105613708496
loss_pred:0.02379743941128254, decouple_loss:0.005599565338343382
The generated pressure mean: 0.443094938993454
loss_pred:0.022450776770710945, decouple_loss:0.005446301773190498
The generated pressure mean: 0.4373394548892975
loss_pred:0.02517596073448658, decouple_loss:0.005471329670399427
Iteration: 4209, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492233097553253
loss_pred:0.0230725035071373, decouple_loss:0.006815614178776741
The generated pressure mean: 0.45045650005340576
loss_pred:0.024584701284766197, decouple_loss:0.007218315731734037
The generated pressure mean: 0.4445471465587616
loss_pred:0.023974617943167686, decouple_loss:0.0067155202850699425
Iteration: 4210, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4402759373188019
loss_pred:0.02477264776825905, decouple_loss:0.0060257515870034695
The generated pressure mean: 0.43789106607437134
loss_pred:0.024187160655856133, decouple_loss:0.00602487800642848The generated pressure mean: 0.43760237097740173
loss_pred:0.02412368170917034, decouple_loss:0.006101214326918125
2023-04-17 03:51:35 testing...
The generated pressure mean: 0.41078102588653564
The generated pressure mean: 0.41817060112953186
loss_pred:0.03880317509174347, decouple_loss:0.005907641723752022
The generated pressure mean: 0.42006781697273254
loss_pred:0.03715788200497627, decouple_loss:0.00641357246786356
loss_pred:0.03701074793934822, decouple_loss:0.006520159542560577
WV_0_PC_0_EH_1_PS_40, loss: 0.03797129541635513, avg_mse: 0.0538252517580986
current test mse: 0.053825
Iteration: 4211, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46456244587898254
loss_pred:0.02420494332909584, decouple_loss:0.005175726488232613
The generated pressure mean: 0.4654403328895569
loss_pred:0.022801298648118973, decouple_loss:0.005284697283059359
The generated pressure mean: 0.46665236353874207
loss_pred:0.022341903299093246, decouple_loss:0.00524468719959259
Iteration: 4212, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4357408285140991
loss_pred:0.02504655532538891, decouple_loss:0.0052869245409965515
The generated pressure mean: 0.43421345949172974
loss_pred:0.02247573435306549, decouple_loss:0.005465592257678509
The generated pressure mean: 0.4432617127895355
loss_pred:0.022482262924313545, decouple_loss:0.005195240955799818
Iteration: 4213, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42923155426979065
loss_pred:0.022929953411221504, decouple_loss:0.00559281138703227
The generated pressure mean: 0.4335712194442749
loss_pred:0.02246568538248539, decouple_loss:0.005604313686490059
The generated pressure mean: 0.432061105966568
loss_pred:0.02483363077044487, decouple_loss:0.005804301239550114
Iteration: 4214, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4650828242301941
loss_pred:0.022616969421505928, decouple_loss:0.0056663015857338905
The generated pressure mean: 0.4692670702934265
loss_pred:0.025351550430059433, decouple_loss:0.005708407610654831
The generated pressure mean: 0.46417346596717834
loss_pred:0.02449990250170231, decouple_loss:0.005951780825853348
Iteration: 4215, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44273316860198975
The generated pressure mean: 0.4411110281944275
loss_pred:0.023027051240205765, decouple_loss:0.005186710972338915
loss_pred:0.02368275634944439, decouple_loss:0.005091720260679722
The generated pressure mean: 0.44324901700019836
loss_pred:0.022685863077640533, decouple_loss:0.00495265144854784
Iteration: 4216, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43598413467407227
The generated pressure mean: 0.43355801701545715
loss_pred:0.02268468402326107, decouple_loss:0.006012382451444864
loss_pred:0.023173589259386063, decouple_loss:0.005975149106234312
The generated pressure mean: 0.43467003107070923
loss_pred:0.025791967287659645, decouple_loss:0.0061194514855742455
Iteration: 4217, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4647843837738037
loss_pred:0.023453641682863235, decouple_loss:0.00587766757234931
The generated pressure mean: 0.4654107689857483
loss_pred:0.024043118581175804, decouple_loss:0.005586558021605015
The generated pressure mean: 0.4655357003211975
loss_pred:0.02403956651687622, decouple_loss:0.006058265455067158
Iteration: 4218, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4349919557571411
loss_pred:0.02481929399073124, decouple_loss:0.006237328052520752
The generated pressure mean: 0.4367334842681885
loss_pred:0.023561837151646614, decouple_loss:0.006197135429829359
The generated pressure mean: 0.4379528760910034
loss_pred:0.023563796654343605, decouple_loss:0.0062838164158165455
Iteration: 4219, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43852293491363525
loss_pred:0.021912438794970512, decouple_loss:0.006558098364621401
The generated pressure mean: 0.43797215819358826
loss_pred:0.023352254182100296, decouple_loss:0.006388921290636063
The generated pressure mean: 0.43259555101394653
loss_pred:0.023206420242786407, decouple_loss:0.006217598915100098
Iteration: 4220, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.471450537443161
loss_pred:0.023566100746393204, decouple_loss:0.006835938431322575
The generated pressure mean: 0.4657212495803833
loss_pred:0.023929037153720856, decouple_loss:0.006704435683786869
The generated pressure mean: 0.4649363160133362
loss_pred:0.024129975587129593, decouple_loss:0.006719626020640135
2023-04-17 03:53:28 testing...
The generated pressure mean: 0.4189203381538391
The generated pressure mean: 0.42594805359840393
loss_pred:0.03605291247367859, decouple_loss:0.007695494685322046
The generated pressure mean: 0.42799466848373413
loss_pred:0.03489363566040993, decouple_loss:0.007920347154140472
loss_pred:0.034676164388656616, decouple_loss:0.008068503811955452
WV_0_PC_0_EH_1_PS_40, loss: 0.03560230880975723, avg_mse: 0.049074821174144745
current test mse: 0.049075
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 4221, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4374653697013855
loss_pred:0.02366798371076584, decouple_loss:0.0073903631418943405
The generated pressure mean: 0.4332098960876465
loss_pred:0.024195250123739243, decouple_loss:0.007155651692301035
The generated pressure mean: 0.43478715419769287
loss_pred:0.024443648755550385, decouple_loss:0.006652606185525656
Iteration: 4222, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4420481324195862
loss_pred:0.023163769394159317, decouple_loss:0.00679692393168807
The generated pressure mean: 0.4405216574668884
loss_pred:0.024134768173098564, decouple_loss:0.0068706632591784
The generated pressure mean: 0.44293564558029175
loss_pred:0.024616654962301254, decouple_loss:0.0067840078845620155
Iteration: 4223, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4625648558139801
loss_pred:0.024028362706303596, decouple_loss:0.007547042332589626
The generated pressure mean: 0.45482176542282104
loss_pred:0.024578789249062538, decouple_loss:0.007712008897215128
The generated pressure mean: 0.4578023850917816
loss_pred:0.024678144603967667, decouple_loss:0.007939174771308899
Iteration: 4224, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43768101930618286
loss_pred:0.02330620028078556, decouple_loss:0.006655015051364899
The generated pressure mean: 0.43618154525756836
The generated pressure mean: 0.4386007785797119
loss_pred:0.02485845237970352, decouple_loss:0.006579895503818989
loss_pred:0.024568451568484306, decouple_loss:0.006736877374351025
Iteration: 4225, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43754851818084717
The generated pressure mean: 0.43306976556777954
loss_pred:0.023120826110243797, decouple_loss:0.007335497532039881
loss_pred:0.023041553795337677, decouple_loss:0.007593597285449505
The generated pressure mean: 0.4388425350189209
loss_pred:0.024819670245051384, decouple_loss:0.0076895118691027164
Iteration: 4226, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4608886241912842
The generated pressure mean: 0.4596000909805298
loss_pred:0.02303421124815941, decouple_loss:0.006944491062313318
loss_pred:0.024112839251756668, decouple_loss:0.007120431400835514
The generated pressure mean: 0.4627716839313507
loss_pred:0.02425237186253071, decouple_loss:0.007035341579467058
Iteration: 4227, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.458497554063797
loss_pred:0.02341471053659916, decouple_loss:0.0069861640222370625
The generated pressure mean: 0.458222359418869
The generated pressure mean: 0.45772698521614075
loss_pred:0.02454238012433052, decouple_loss:0.0067342231050133705
loss_pred:0.023703036829829216, decouple_loss:0.006833644583821297
Iteration: 4228, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.41857296228408813
The generated pressure mean: 0.4267895519733429
loss_pred:0.024198710918426514, decouple_loss:0.00725665083155036
loss_pred:0.02399447374045849, decouple_loss:0.007205383386462927
The generated pressure mean: 0.4198949933052063
loss_pred:0.024239689111709595, decouple_loss:0.007111300714313984
Iteration: 4229, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.441261351108551
loss_pred:0.024936920031905174, decouple_loss:0.006109920796006918
The generated pressure mean: 0.4526810050010681
loss_pred:0.022760793566703796, decouple_loss:0.006055021192878485
The generated pressure mean: 0.4507051408290863
loss_pred:0.024509774520993233, decouple_loss:0.006096768658608198
Iteration: 4230, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4587950110435486
loss_pred:0.024148117750883102, decouple_loss:0.006601943634450436
The generated pressure mean: 0.45768502354621887
loss_pred:0.023502444848418236, decouple_loss:0.006494988687336445
The generated pressure mean: 0.4616537094116211
loss_pred:0.024246737360954285, decouple_loss:0.0066437628120183945
2023-04-17 03:55:58 testing...
The generated pressure mean: 0.4166938066482544
The generated pressure mean: 0.42382991313934326
The generated pressure mean: 0.4258771538734436
loss_pred:0.035936545580625534, decouple_loss:0.0068488833494484425
loss_pred:0.03451650217175484, decouple_loss:0.007129098754376173
loss_pred:0.03442193940281868, decouple_loss:0.007258165627717972
WV_0_PC_0_EH_1_PS_40, loss: 0.035312265157699585, avg_mse: 0.04865199327468872
current test mse: 0.048652
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4231, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4369085133075714
loss_pred:0.024409910663962364, decouple_loss:0.006645544432103634
The generated pressure mean: 0.4391997754573822
The generated pressure mean: 0.4347749650478363
loss_pred:0.023836685344576836, decouple_loss:0.006564650684595108
loss_pred:0.022377053275704384, decouple_loss:0.00686541898176074
Iteration: 4232, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43586888909339905
loss_pred:0.023891953751444817, decouple_loss:0.006211321800947189
The generated pressure mean: 0.4362456202507019
loss_pred:0.02410716377198696, decouple_loss:0.006117603275924921
The generated pressure mean: 0.43798357248306274
loss_pred:0.02370418980717659, decouple_loss:0.006205876357853413
Iteration: 4233, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46131715178489685
loss_pred:0.02320055291056633, decouple_loss:0.006053839344531298
The generated pressure mean: 0.4639554023742676
loss_pred:0.02478598803281784, decouple_loss:0.006259453017264605
The generated pressure mean: 0.46598511934280396
loss_pred:0.0244445763528347, decouple_loss:0.005935680586844683
Iteration: 4234, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43560653924942017
loss_pred:0.024286849424242973, decouple_loss:0.007073665503412485
The generated pressure mean: 0.43385401368141174
The generated pressure mean: 0.43545201420783997
loss_pred:0.024879882112145424, decouple_loss:0.006747270934283733
loss_pred:0.02422463707625866, decouple_loss:0.00664102379232645
Iteration: 4235, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4556702971458435
loss_pred:0.023505717515945435, decouple_loss:0.00620416272431612
The generated pressure mean: 0.44930410385131836
loss_pred:0.023506833240389824, decouple_loss:0.006391593720763922
The generated pressure mean: 0.449200838804245
loss_pred:0.02290879562497139, decouple_loss:0.006106242071837187
Iteration: 4236, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4451795220375061
loss_pred:0.02498379535973072, decouple_loss:0.0070462822914123535
The generated pressure mean: 0.45115700364112854
loss_pred:0.024146748706698418, decouple_loss:0.007262153085321188
The generated pressure mean: 0.4493216276168823
loss_pred:0.02259735018014908, decouple_loss:0.0071637919172644615
Iteration: 4237, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4414229691028595
loss_pred:0.024590851739048958, decouple_loss:0.0058599067851901054
The generated pressure mean: 0.4391883611679077
loss_pred:0.022978074848651886, decouple_loss:0.005885486491024494
The generated pressure mean: 0.43643832206726074
loss_pred:0.02515827864408493, decouple_loss:0.0059205759316682816
Iteration: 4238, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44421136379241943
The generated pressure mean: 0.4505683481693268
loss_pred:0.024282047525048256, decouple_loss:0.0064475699327886105
loss_pred:0.024042265489697456, decouple_loss:0.0065963296219706535
The generated pressure mean: 0.4476759135723114
loss_pred:0.023999573662877083, decouple_loss:0.006719311233609915
Iteration: 4239, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492644965648651
loss_pred:0.024758227169513702, decouple_loss:0.00551883690059185
The generated pressure mean: 0.44529634714126587
loss_pred:0.023479657247662544, decouple_loss:0.005659847054630518
The generated pressure mean: 0.4464681148529053
loss_pred:0.02388431318104267, decouple_loss:0.005709274671971798
Iteration: 4240, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502536952495575
loss_pred:0.023885617032647133, decouple_loss:0.006087763234972954
The generated pressure mean: 0.45190176367759705
loss_pred:0.024471629410982132, decouple_loss:0.006384783424437046
The generated pressure mean: 0.43877968192100525
loss_pred:0.022122014313936234, decouple_loss:0.0063145640306174755
2023-04-17 03:57:51 testing...
The generated pressure mean: 0.4143645465373993
The generated pressure mean: 0.4213164448738098
The generated pressure mean: 0.42369183897972107
loss_pred:0.0353783555328846, decouple_loss:0.006038502790033817
loss_pred:0.03421490266919136, decouple_loss:0.006554806139320135
loss_pred:0.03410196676850319, decouple_loss:0.006673106458038092
WV_0_PC_0_EH_1_PS_40, loss: 0.034886181354522705, avg_mse: 0.04822743684053421
current test mse: 0.048227
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 4241, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4426345229148865
loss_pred:0.02336026169359684, decouple_loss:0.00549808144569397
The generated pressure mean: 0.4462747275829315
loss_pred:0.023422325029969215, decouple_loss:0.005260725039988756
The generated pressure mean: 0.449647456407547
loss_pred:0.023103592917323112, decouple_loss:0.00523451017215848
Iteration: 4242, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463045299053192
loss_pred:0.024435481056571007, decouple_loss:0.0062801288440823555
The generated pressure mean: 0.44306090474128723
loss_pred:0.023781491443514824, decouple_loss:0.0063138133846223354
The generated pressure mean: 0.44892388582229614
loss_pred:0.025145145133137703, decouple_loss:0.006363800261169672
Iteration: 4243, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507178068161011
loss_pred:0.02448766678571701, decouple_loss:0.005301108118146658
The generated pressure mean: 0.45426246523857117
loss_pred:0.023420382291078568, decouple_loss:0.005285047926008701
The generated pressure mean: 0.45352107286453247
loss_pred:0.024394100531935692, decouple_loss:0.005432454869151115
Iteration: 4244, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4374983310699463
loss_pred:0.023691194131970406, decouple_loss:0.006605040282011032
The generated pressure mean: 0.44240111112594604
The generated pressure mean: 0.4402422606945038
loss_pred:0.02595479041337967, decouple_loss:0.006819107104092836
loss_pred:0.025091715157032013, decouple_loss:0.007026375271379948
Iteration: 4245, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.437294065952301
loss_pred:0.022278405725955963, decouple_loss:0.0062124538235366344
The generated pressure mean: 0.4325106143951416
loss_pred:0.025837253779172897, decouple_loss:0.006184387486428022
The generated pressure mean: 0.43077394366264343
loss_pred:0.024380384013056755, decouple_loss:0.0062256185337901115
Iteration: 4246, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4736906588077545
loss_pred:0.0261599849909544, decouple_loss:0.0071232495829463005
The generated pressure mean: 0.4718784689903259
loss_pred:0.02465159259736538, decouple_loss:0.006792581174522638
The generated pressure mean: 0.47181686758995056
loss_pred:0.02385590597987175, decouple_loss:0.006828176788985729
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4247, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4428286850452423
loss_pred:0.024513961747288704, decouple_loss:0.005787367466837168
The generated pressure mean: 0.44338998198509216
loss_pred:0.023908639326691628, decouple_loss:0.005807456560432911
The generated pressure mean: 0.4419879615306854
loss_pred:0.023863309994339943, decouple_loss:0.00580013869330287
Iteration: 4248, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.426493763923645
loss_pred:0.024380113929510117, decouple_loss:0.0063675628043711185
The generated pressure mean: 0.43384605646133423
loss_pred:0.02383485622704029, decouple_loss:0.006187888793647289
The generated pressure mean: 0.4263724982738495
loss_pred:0.02423878386616707, decouple_loss:0.006460671313107014
Iteration: 4249, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4629055857658386
loss_pred:0.025295976549386978, decouple_loss:0.006806952878832817
The generated pressure mean: 0.45642995834350586
loss_pred:0.023839697241783142, decouple_loss:0.006500774063169956
The generated pressure mean: 0.4591827988624573
loss_pred:0.024825923144817352, decouple_loss:0.006586992181837559
Iteration: 4250, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470939636230469
loss_pred:0.023527227342128754, decouple_loss:0.005778235848993063
The generated pressure mean: 0.44876518845558167
loss_pred:0.023994427174329758, decouple_loss:0.0060050105676054955
The generated pressure mean: 0.4455319344997406
loss_pred:0.02343015931546688, decouple_loss:0.005669823382049799
2023-04-17 04:00:20 testing...
The generated pressure mean: 0.4139382243156433
The generated pressure mean: 0.42093655467033386
The generated pressure mean: 0.4230891466140747
loss_pred:0.03659527748823166, decouple_loss:0.007008816115558147
loss_pred:0.03551311045885086, decouple_loss:0.007625148631632328
loss_pred:0.03483348339796066, decouple_loss:0.007815576158463955
WV_0_PC_0_EH_1_PS_40, loss: 0.03602145239710808, avg_mse: 0.05030382052063942
current test mse: 0.050304
Iteration: 4251, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45231738686561584
loss_pred:0.024536019191145897, decouple_loss:0.006391097791492939
The generated pressure mean: 0.44823411107063293
loss_pred:0.023123329505324364, decouple_loss:0.006198842078447342
The generated pressure mean: 0.4466717839241028
loss_pred:0.023197945207357407, decouple_loss:0.006435316521674395
Iteration: 4252, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44507738947868347
loss_pred:0.022891035303473473, decouple_loss:0.006727525498718023
The generated pressure mean: 0.4385918080806732
loss_pred:0.024438316002488136, decouple_loss:0.006513927131891251
The generated pressure mean: 0.441496342420578
loss_pred:0.023669546470046043, decouple_loss:0.007196280173957348
Iteration: 4253, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4349268078804016
loss_pred:0.024932444095611572, decouple_loss:0.006020008120685816
The generated pressure mean: 0.43577811121940613
loss_pred:0.022870460525155067, decouple_loss:0.006285153795033693
The generated pressure mean: 0.4341444671154022
loss_pred:0.023246467113494873, decouple_loss:0.006342426873743534
Iteration: 4254, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4619285464286804
loss_pred:0.024659691378474236, decouple_loss:0.00633805338293314
The generated pressure mean: 0.45753103494644165
The generated pressure mean: 0.45982837677001953
loss_pred:0.02520231530070305, decouple_loss:0.006572767626494169
loss_pred:0.023978548124432564, decouple_loss:0.006272708065807819
Iteration: 4255, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4621531069278717
loss_pred:0.02506304532289505, decouple_loss:0.006958725396543741
The generated pressure mean: 0.4562721848487854
loss_pred:0.025025883689522743, decouple_loss:0.006586142349988222
The generated pressure mean: 0.46375033259391785
loss_pred:0.023658350110054016, decouple_loss:0.006807943340390921
Iteration: 4256, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42965593934059143
loss_pred:0.024965446442365646, decouple_loss:0.005983214359730482
The generated pressure mean: 0.4260796904563904
loss_pred:0.02481263317167759, decouple_loss:0.006019551306962967
The generated pressure mean: 0.425030916929245
loss_pred:0.023455388844013214, decouple_loss:0.006147134117782116
Iteration: 4257, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4380212426185608
loss_pred:0.022545842453837395, decouple_loss:0.00593541469424963
The generated pressure mean: 0.4381818175315857
loss_pred:0.02328006736934185, decouple_loss:0.005942934192717075
The generated pressure mean: 0.43778279423713684
loss_pred:0.023799993097782135, decouple_loss:0.0059961494989693165
Iteration: 4258, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4643489122390747
loss_pred:0.022707054391503334, decouple_loss:0.006615570746362209
The generated pressure mean: 0.4668077826499939
loss_pred:0.0230212714523077, decouple_loss:0.0067424834705889225
The generated pressure mean: 0.46625205874443054
loss_pred:0.022895745933055878, decouple_loss:0.0066361334174871445
Iteration: 4259, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4529343247413635
loss_pred:0.02364746481180191, decouple_loss:0.005908619612455368
The generated pressure mean: 0.4552539885044098
loss_pred:0.024468641728162766, decouple_loss:0.0057831513695418835
The generated pressure mean: 0.4557347297668457
loss_pred:0.02464623749256134, decouple_loss:0.005660975817590952
Iteration: 4260, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43190908432006836
loss_pred:0.023980602622032166, decouple_loss:0.006051618605852127
The generated pressure mean: 0.43154892325401306
loss_pred:0.023739520460367203, decouple_loss:0.006270126905292273
The generated pressure mean: 0.42979833483695984
loss_pred:0.024363785982131958, decouple_loss:0.006493316497653723
2023-04-17 04:02:13 testing...
The generated pressure mean: 0.4135039150714874
The generated pressure mean: 0.4200231730937958
The generated pressure mean: 0.42193400859832764
loss_pred:0.03738715872168541, decouple_loss:0.007400339934974909
loss_pred:0.03618476539850235, decouple_loss:0.007826081477105618
loss_pred:0.03594246134161949, decouple_loss:0.007997944951057434
WV_0_PC_0_EH_1_PS_40, loss: 0.036891870200634, avg_mse: 0.05193288251757622
current test mse: 0.051933
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 4261, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442887306213379
loss_pred:0.023147929459810257, decouple_loss:0.0064834412187337875
The generated pressure mean: 0.45141273736953735
loss_pred:0.024281857535243034, decouple_loss:0.006546862423419952
The generated pressure mean: 0.44962799549102783
loss_pred:0.025703515857458115, decouple_loss:0.006867025513201952
Iteration: 4262, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4356856048107147
loss_pred:0.022711098194122314, decouple_loss:0.007031469605863094
The generated pressure mean: 0.43697163462638855
loss_pred:0.02456078492105007, decouple_loss:0.006739701610058546
The generated pressure mean: 0.43472713232040405
loss_pred:0.024069396778941154, decouple_loss:0.006664485204964876
Iteration: 4263, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46172767877578735
The generated pressure mean: 0.46550318598747253
loss_pred:0.023640437051653862, decouple_loss:0.007207097951322794
loss_pred:0.02431471273303032, decouple_loss:0.007319844327867031
The generated pressure mean: 0.45918774604797363
loss_pred:0.02286779135465622, decouple_loss:0.007020794786512852
Iteration: 4264, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4606568217277527
The generated pressure mean: 0.4563043415546417
loss_pred:0.023291638121008873, decouple_loss:0.0063042230904102325
loss_pred:0.023944875225424767, decouple_loss:0.006226009223610163
The generated pressure mean: 0.4566155970096588
loss_pred:0.023940328508615494, decouple_loss:0.006349385716021061
Iteration: 4265, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43749433755874634
loss_pred:0.02426428347826004, decouple_loss:0.007052980829030275
The generated pressure mean: 0.4353135824203491
loss_pred:0.022692890837788582, decouple_loss:0.006667328532785177
The generated pressure mean: 0.4365772008895874
loss_pred:0.023338062688708305, decouple_loss:0.007099682930856943
Iteration: 4266, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4393254816532135
loss_pred:0.023856107145547867, decouple_loss:0.007828879170119762
The generated pressure mean: 0.4358365535736084
loss_pred:0.023369334638118744, decouple_loss:0.00784869771450758
The generated pressure mean: 0.43535327911376953
loss_pred:0.025503987446427345, decouple_loss:0.007942448370158672
Iteration: 4267, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4456692636013031
loss_pred:0.02534244768321514, decouple_loss:0.0060929199680686
The generated pressure mean: 0.44000616669654846
loss_pred:0.022032255306839943, decouple_loss:0.006080346181988716
The generated pressure mean: 0.44329333305358887
loss_pred:0.02303520403802395, decouple_loss:0.006140409503132105
Iteration: 4268, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4589596688747406
loss_pred:0.02485833130776882, decouple_loss:0.005830773618072271
The generated pressure mean: 0.45858001708984375
loss_pred:0.02310151234269142, decouple_loss:0.005499945022165775
The generated pressure mean: 0.45336031913757324
loss_pred:0.023033376783132553, decouple_loss:0.005766953341662884
Iteration: 4269, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45274174213409424
loss_pred:0.0231039896607399, decouple_loss:0.007614258676767349
The generated pressure mean: 0.45997580885887146
loss_pred:0.02273494377732277, decouple_loss:0.007463316898792982
The generated pressure mean: 0.4610593318939209
loss_pred:0.023608844727277756, decouple_loss:0.007489797659218311
Iteration: 4270, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4407157599925995
loss_pred:0.022898413240909576, decouple_loss:0.007021843455731869
The generated pressure mean: 0.43911004066467285
The generated pressure mean: 0.43966391682624817
loss_pred:0.023350393399596214, decouple_loss:0.006814361549913883
loss_pred:0.02416013553738594, decouple_loss:0.006870389450341463
2023-04-17 04:04:44 testing...
The generated pressure mean: 0.4166116416454315
The generated pressure mean: 0.4239548444747925
The generated pressure mean: 0.4260477125644684
loss_pred:0.03564872220158577, decouple_loss:0.006172529887408018
loss_pred:0.03458352014422417, decouple_loss:0.0068203904666006565
loss_pred:0.034426841884851456, decouple_loss:0.006975436117500067
WV_0_PC_0_EH_1_PS_40, loss: 0.03521917015314102, avg_mse: 0.049039386212825775
current test mse: 0.049039
Iteration: 4271, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4430125951766968
loss_pred:0.022630030289292336, decouple_loss:0.005070480052381754
The generated pressure mean: 0.4379505515098572
loss_pred:0.02274039201438427, decouple_loss:0.005295159295201302
The generated pressure mean: 0.4435478448867798
loss_pred:0.02267814427614212, decouple_loss:0.005096779204905033
Iteration: 4272, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4512329399585724
loss_pred:0.02357095293700695, decouple_loss:0.007294927723705769
The generated pressure mean: 0.45800647139549255
loss_pred:0.02308390662074089, decouple_loss:0.006824661046266556
The generated pressure mean: 0.4553435146808624
loss_pred:0.022927582263946533, decouple_loss:0.006673561409115791
Iteration: 4273, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464709758758545
loss_pred:0.022756105288863182, decouple_loss:0.005789938382804394
The generated pressure mean: 0.4473379850387573
loss_pred:0.02353149652481079, decouple_loss:0.005804532207548618
The generated pressure mean: 0.4482229948043823
loss_pred:0.02344147488474846, decouple_loss:0.005764877423644066
Iteration: 4274, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4443933963775635
loss_pred:0.022977275773882866, decouple_loss:0.005530440714210272
The generated pressure mean: 0.45023855566978455
loss_pred:0.022672703489661217, decouple_loss:0.005297102965414524
The generated pressure mean: 0.44819724559783936
loss_pred:0.02388140559196472, decouple_loss:0.005560324527323246
Iteration: 4275, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504536986351013
loss_pred:0.023423321545124054, decouple_loss:0.005564882420003414
The generated pressure mean: 0.44331902265548706
loss_pred:0.023947823792696, decouple_loss:0.005264407489448786
The generated pressure mean: 0.4491581320762634
loss_pred:0.02347424067556858, decouple_loss:0.005256522446870804
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4276, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44417452812194824
loss_pred:0.022509939968585968, decouple_loss:0.006742004305124283
The generated pressure mean: 0.44944044947624207
loss_pred:0.023981278762221336, decouple_loss:0.006805441342294216
The generated pressure mean: 0.4489310085773468
loss_pred:0.023791762068867683, decouple_loss:0.006666240748018026
Iteration: 4277, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4386279582977295
loss_pred:0.022885793820023537, decouple_loss:0.005996719002723694
The generated pressure mean: 0.43755069375038147
loss_pred:0.02332337386906147, decouple_loss:0.005954243708401918
The generated pressure mean: 0.44060876965522766
loss_pred:0.02368016354739666, decouple_loss:0.005934006068855524
Iteration: 4278, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4551842510700226
loss_pred:0.02305634133517742, decouple_loss:0.0048079341650009155
The generated pressure mean: 0.4505552351474762
loss_pred:0.02353951893746853, decouple_loss:0.004830776248127222
The generated pressure mean: 0.44175854325294495
loss_pred:0.023137526586651802, decouple_loss:0.00478740967810154
Iteration: 4279, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46078628301620483
loss_pred:0.022127319127321243, decouple_loss:0.004957035183906555
The generated pressure mean: 0.45840558409690857
loss_pred:0.023109493777155876, decouple_loss:0.0049104536883533
The generated pressure mean: 0.46455034613609314
loss_pred:0.02342759259045124, decouple_loss:0.004763880744576454
Iteration: 4280, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44143146276474
loss_pred:0.02271093986928463, decouple_loss:0.004894816782325506
The generated pressure mean: 0.44042131304740906
loss_pred:0.024309441447257996, decouple_loss:0.004829037003219128
The generated pressure mean: 0.4347008466720581
loss_pred:0.022195138037204742, decouple_loss:0.0050338637083768845
2023-04-17 04:06:37 testing...
The generated pressure mean: 0.41795793175697327
The generated pressure mean: 0.4249914288520813
The generated pressure mean: 0.42724862694740295
loss_pred:0.03589434176683426, decouple_loss:0.006170309614390135
loss_pred:0.03463975340127945, decouple_loss:0.006778379436582327
loss_pred:0.03421445190906525, decouple_loss:0.006940948776900768
WV_0_PC_0_EH_1_PS_40, loss: 0.03524767607450485, avg_mse: 0.049127884209156036
current test mse: 0.049128
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 4281, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4394661784172058
loss_pred:0.021763024851679802, decouple_loss:0.0050012799911201
The generated pressure mean: 0.438522607088089
The generated pressure mean: 0.4353584945201874loss_pred:0.02176050841808319, decouple_loss:0.005086529068648815
loss_pred:0.02360430546104908, decouple_loss:0.005264351610094309
Iteration: 4282, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45652565360069275
loss_pred:0.024404767900705338, decouple_loss:0.00525806425139308
The generated pressure mean: 0.4608553349971771
loss_pred:0.0247305016964674, decouple_loss:0.005373786669224501
The generated pressure mean: 0.45908328890800476
loss_pred:0.022019537165760994, decouple_loss:0.005398808047175407
Iteration: 4283, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.439012736082077
loss_pred:0.0223490409553051, decouple_loss:0.0047177900560200214
The generated pressure mean: 0.4331512451171875
loss_pred:0.022712118923664093, decouple_loss:0.005073843523859978
The generated pressure mean: 0.43453335762023926
loss_pred:0.024469858035445213, decouple_loss:0.004688011482357979
Iteration: 4284, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45850318670272827
The generated pressure mean: 0.46212902665138245
loss_pred:0.02452407404780388, decouple_loss:0.005362956319004297
loss_pred:0.022858550772070885, decouple_loss:0.0056051332503557205
The generated pressure mean: 0.4570758044719696
loss_pred:0.02285022661089897, decouple_loss:0.0055985599756240845
Iteration: 4285, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449964165687561
The generated pressure mean: 0.4465463161468506
loss_pred:0.02260497771203518, decouple_loss:0.004799105226993561
loss_pred:0.023986997082829475, decouple_loss:0.004723637830466032
The generated pressure mean: 0.4514188766479492
loss_pred:0.021897556260228157, decouple_loss:0.005063991528004408
Iteration: 4286, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43045929074287415
The generated pressure mean: 0.43430787324905396
loss_pred:0.02414017543196678, decouple_loss:0.005947033409029245
loss_pred:0.02318752184510231, decouple_loss:0.005900227930396795
The generated pressure mean: 0.42872318625450134
loss_pred:0.022785114124417305, decouple_loss:0.005799944046884775
Iteration: 4287, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4458625614643097
loss_pred:0.023702066391706467, decouple_loss:0.006568255368620157
The generated pressure mean: 0.44938182830810547
loss_pred:0.024318603798747063, decouple_loss:0.006791664753109217
The generated pressure mean: 0.45254963636398315
loss_pred:0.02220442146062851, decouple_loss:0.006633643060922623
Iteration: 4288, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4723655581474304
loss_pred:0.024234268814325333, decouple_loss:0.005934481509029865
The generated pressure mean: 0.47206589579582214
loss_pred:0.023098204284906387, decouple_loss:0.005778761580586433
The generated pressure mean: 0.4719889163970947
loss_pred:0.023271871730685234, decouple_loss:0.005694186314940453
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4289, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43372976779937744
loss_pred:0.0252364594489336, decouple_loss:0.0064109917730093
The generated pressure mean: 0.4371922016143799
loss_pred:0.025014881044626236, decouple_loss:0.006487847305834293
The generated pressure mean: 0.4389127194881439
loss_pred:0.022782105952501297, decouple_loss:0.006514702923595905
Iteration: 4290, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4206129014492035
loss_pred:0.022517357021570206, decouple_loss:0.0063622985035181046
The generated pressure mean: 0.42225831747055054
loss_pred:0.02417217753827572, decouple_loss:0.006215839646756649
The generated pressure mean: 0.42056819796562195
loss_pred:0.022632870823144913, decouple_loss:0.0059271217323839664
2023-04-17 04:09:12 testing...
The generated pressure mean: 0.410552442073822
The generated pressure mean: 0.4183368682861328
The generated pressure mean: 0.4209369719028473
loss_pred:0.03898058086633682, decouple_loss:0.006868254393339157
loss_pred:0.037820834666490555, decouple_loss:0.007279294542968273
loss_pred:0.037102699279785156, decouple_loss:0.007467054296284914
WV_0_PC_0_EH_1_PS_40, loss: 0.03832828253507614, avg_mse: 0.05493469908833504
current test mse: 0.054935
Iteration: 4291, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4647067189216614
loss_pred:0.02334301359951496, decouple_loss:0.005946489050984383
The generated pressure mean: 0.4669051468372345
loss_pred:0.02510644681751728, decouple_loss:0.006162184290587902
The generated pressure mean: 0.46717527508735657
loss_pred:0.024097247049212456, decouple_loss:0.006071592215448618
Iteration: 4292, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4554101228713989
loss_pred:0.02514897845685482, decouple_loss:0.006599145010113716
The generated pressure mean: 0.4482724368572235
loss_pred:0.02436751127243042, decouple_loss:0.00649197306483984
The generated pressure mean: 0.44773608446121216
loss_pred:0.023564431816339493, decouple_loss:0.006666882894933224
Iteration: 4293, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44260433316230774
loss_pred:0.02325477823615074, decouple_loss:0.006473293527960777
The generated pressure mean: 0.4428079128265381
loss_pred:0.025391139090061188, decouple_loss:0.006395633798092604
The generated pressure mean: 0.4461224675178528
loss_pred:0.02410918101668358, decouple_loss:0.006661408115178347
Iteration: 4294, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4518013298511505
loss_pred:0.024160316213965416, decouple_loss:0.00657502980902791
The generated pressure mean: 0.44493770599365234
The generated pressure mean: 0.4528476595878601
loss_pred:0.023462044075131416, decouple_loss:0.006470890715718269
loss_pred:0.023723458871245384, decouple_loss:0.006647482514381409
Iteration: 4295, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43852517008781433
loss_pred:0.02268638089299202, decouple_loss:0.006116211414337158
The generated pressure mean: 0.4368686378002167
loss_pred:0.02322549745440483, decouple_loss:0.006288457196205854
The generated pressure mean: 0.4341961145401001
loss_pred:0.02429456077516079, decouple_loss:0.006613284815102816
Iteration: 4296, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45907843112945557
loss_pred:0.02458745241165161, decouple_loss:0.005723383743315935
The generated pressure mean: 0.45756953954696655
The generated pressure mean: 0.4569855332374573
loss_pred:0.022319480776786804, decouple_loss:0.005859937984496355
loss_pred:0.021973369643092155, decouple_loss:0.005777194630354643
Iteration: 4297, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44838425517082214
loss_pred:0.023745225742459297, decouple_loss:0.006778399925678968
The generated pressure mean: 0.4418882429599762
loss_pred:0.024257974699139595, decouple_loss:0.006291736848652363
The generated pressure mean: 0.44653457403182983
loss_pred:0.022885296493768692, decouple_loss:0.006385383661836386
Iteration: 4298, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43502068519592285
loss_pred:0.02391836605966091, decouple_loss:0.0052882833406329155
The generated pressure mean: 0.4393081068992615
loss_pred:0.021285567432641983, decouple_loss:0.005358648952096701
The generated pressure mean: 0.4353369474411011
loss_pred:0.021922843530774117, decouple_loss:0.0056149037554860115
Iteration: 4299, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44785627722740173
loss_pred:0.02287966012954712, decouple_loss:0.005496893543750048
The generated pressure mean: 0.4526131749153137
The generated pressure mean: 0.4516727924346924
loss_pred:0.02528226561844349, decouple_loss:0.005512967240065336
loss_pred:0.021930132061243057, decouple_loss:0.0054551525972783566
Iteration: 4300, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45097240805625916
loss_pred:0.02337809093296528, decouple_loss:0.005507727153599262
The generated pressure mean: 0.45642444491386414
The generated pressure mean: 0.4555262625217438
loss_pred:0.027166564017534256, decouple_loss:0.00561211071908474
loss_pred:0.023106897249817848, decouple_loss:0.005596669390797615
2023-04-17 04:11:05 testing...
The generated pressure mean: 0.4216843545436859
The generated pressure mean: 0.42932599782943726
loss_pred:0.03686508536338806, decouple_loss:0.006435568910092115
The generated pressure mean: 0.4313482940196991
loss_pred:0.03582298383116722, decouple_loss:0.006894444115459919
loss_pred:0.03529644012451172, decouple_loss:0.007162838242948055
WV_0_PC_0_EH_1_PS_40, loss: 0.03633638843894005, avg_mse: 0.05096539855003357
current test mse: 0.050965
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 4301, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4271640479564667
loss_pred:0.024733206257224083, decouple_loss:0.005855225957930088
The generated pressure mean: 0.4244826138019562
loss_pred:0.023707617074251175, decouple_loss:0.005586337763816118
The generated pressure mean: 0.42405426502227783
loss_pred:0.026576247066259384, decouple_loss:0.005869203247129917
Iteration: 4302, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45599430799484253
The generated pressure mean: 0.45567262172698975
loss_pred:0.025193413719534874, decouple_loss:0.0061533087864518166
loss_pred:0.027452224865555763, decouple_loss:0.0061063384637236595
The generated pressure mean: 0.45536258816719055
loss_pred:0.025232868269085884, decouple_loss:0.006041314918547869
Iteration: 4303, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44333121180534363
The generated pressure mean: 0.4495421051979065
loss_pred:0.02528473734855652, decouple_loss:0.005840004421770573
loss_pred:0.024177568033337593, decouple_loss:0.005952666979283094
The generated pressure mean: 0.44950994849205017
loss_pred:0.02449331432580948, decouple_loss:0.00578331109136343
Iteration: 4304, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44456103444099426
The generated pressure mean: 0.45113426446914673
loss_pred:0.02572661079466343, decouple_loss:0.006122983526438475
loss_pred:0.023724019527435303, decouple_loss:0.006281357724219561
The generated pressure mean: 0.4517662823200226
loss_pred:0.023796746507287025, decouple_loss:0.006493035703897476
Iteration: 4305, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4411928057670593
The generated pressure mean: 0.4436858296394348
loss_pred:0.023488879203796387, decouple_loss:0.005473122000694275
loss_pred:0.024318870157003403, decouple_loss:0.005844533443450928
The generated pressure mean: 0.4398943781852722
loss_pred:0.024187646806240082, decouple_loss:0.00543260807171464
Iteration: 4306, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480510652065277
The generated pressure mean: 0.4414524435997009
loss_pred:0.02486615628004074, decouple_loss:0.0064497957937419415
loss_pred:0.026794416829943657, decouple_loss:0.006380951032042503
The generated pressure mean: 0.44321244955062866
loss_pred:0.025777554139494896, decouple_loss:0.00653384905308485
Iteration: 4307, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4556499123573303
The generated pressure mean: 0.45415592193603516
loss_pred:0.024689754471182823, decouple_loss:0.006321508437395096
loss_pred:0.024762583896517754, decouple_loss:0.007013929542154074
The generated pressure mean: 0.46016281843185425
loss_pred:0.02555621601641178, decouple_loss:0.006863121874630451
Iteration: 4308, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4388737976551056
The generated pressure mean: 0.44394177198410034
loss_pred:0.024063721299171448, decouple_loss:0.006158069707453251
loss_pred:0.02275601215660572, decouple_loss:0.005980241112411022
The generated pressure mean: 0.44154733419418335
loss_pred:0.02336917258799076, decouple_loss:0.005936840549111366
Iteration: 4309, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442308843135834
loss_pred:0.02401619963347912, decouple_loss:0.005951377563178539
The generated pressure mean: 0.4507666826248169
loss_pred:0.023961570113897324, decouple_loss:0.005911778658628464
The generated pressure mean: 0.44858318567276
loss_pred:0.02531389705836773, decouple_loss:0.0058231535367667675
Iteration: 4310, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43725526332855225
loss_pred:0.023915275931358337, decouple_loss:0.00555392075330019
The generated pressure mean: 0.44393396377563477
loss_pred:0.023322036489844322, decouple_loss:0.005572055000811815
The generated pressure mean: 0.4389572739601135
loss_pred:0.025078214704990387, decouple_loss:0.005572319030761719
2023-04-17 04:13:33 testing...
The generated pressure mean: 0.4161882996559143
The generated pressure mean: 0.4252126216888428
The generated pressure mean: 0.42844152450561523
loss_pred:0.03871212154626846, decouple_loss:0.006421547383069992
loss_pred:0.036914873868227005, decouple_loss:0.006790408864617348
loss_pred:0.03678196296095848, decouple_loss:0.007081195246428251
WV_0_PC_0_EH_1_PS_40, loss: 0.037807874381542206, avg_mse: 0.05431508272886276
current test mse: 0.054315
Iteration: 4311, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4444194734096527
The generated pressure mean: 0.4492597281932831
loss_pred:0.02415604330599308, decouple_loss:0.005799606442451477
loss_pred:0.023356106132268906, decouple_loss:0.005661680828779936
The generated pressure mean: 0.4516545832157135
loss_pred:0.02416631020605564, decouple_loss:0.0058530340902507305
Iteration: 4312, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45882946252822876
loss_pred:0.02480124682188034, decouple_loss:0.0049786935560405254
The generated pressure mean: 0.4554443955421448
loss_pred:0.026287663727998734, decouple_loss:0.004910178016871214
The generated pressure mean: 0.4578760862350464
loss_pred:0.025900689885020256, decouple_loss:0.0049669076688587666
Iteration: 4313, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4111635684967041
loss_pred:0.025206340476870537, decouple_loss:0.005414703395217657
The generated pressure mean: 0.4164997935295105
loss_pred:0.024129346013069153, decouple_loss:0.0055961161851882935
The generated pressure mean: 0.4168940484523773
loss_pred:0.025911035016179085, decouple_loss:0.0058107818476855755
Iteration: 4314, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4758419692516327
loss_pred:0.024723486974835396, decouple_loss:0.005587359424680471
The generated pressure mean: 0.47129499912261963
loss_pred:0.027987029403448105, decouple_loss:0.005461313296109438
The generated pressure mean: 0.46967023611068726
loss_pred:0.02505108155310154, decouple_loss:0.005307321902364492
Iteration: 4315, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44317981600761414
The generated pressure mean: 0.44289788603782654
loss_pred:0.02611371874809265, decouple_loss:0.007066902704536915
loss_pred:0.024398649111390114, decouple_loss:0.006824115291237831
The generated pressure mean: 0.443468302488327
loss_pred:0.025578057393431664, decouple_loss:0.007146472577005625
Iteration: 4316, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4385654032230377
loss_pred:0.02552926167845726, decouple_loss:0.005672283936291933
The generated pressure mean: 0.4434165954589844
loss_pred:0.024760516360402107, decouple_loss:0.005481799133121967
The generated pressure mean: 0.4420408308506012
loss_pred:0.0245661661028862, decouple_loss:0.005705482792109251
Iteration: 4317, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493538439273834
The generated pressure mean: 0.4585907757282257
loss_pred:0.02375446818768978, decouple_loss:0.005861598066985607
loss_pred:0.023718886077404022, decouple_loss:0.005760909058153629
The generated pressure mean: 0.4495795667171478
loss_pred:0.0235810074955225, decouple_loss:0.005807686597108841
Iteration: 4318, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44929343461990356
loss_pred:0.02389136143028736, decouple_loss:0.0059036086313426495
The generated pressure mean: 0.4490070343017578
loss_pred:0.02364642731845379, decouple_loss:0.005728678312152624
The generated pressure mean: 0.4400952458381653
loss_pred:0.023287123069167137, decouple_loss:0.005846623331308365
Iteration: 4319, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43982139229774475
loss_pred:0.024421803653240204, decouple_loss:0.0052811335772275925
The generated pressure mean: 0.4392063319683075
loss_pred:0.025878291577100754, decouple_loss:0.005592626985162497
The generated pressure mean: 0.44445550441741943
loss_pred:0.024168623611330986, decouple_loss:0.005328070372343063
Iteration: 4320, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488661587238312
loss_pred:0.024122651666402817, decouple_loss:0.006788880564272404
The generated pressure mean: 0.4455380439758301
loss_pred:0.023572096601128578, decouple_loss:0.006636546924710274
The generated pressure mean: 0.4470117688179016
loss_pred:0.02618532069027424, decouple_loss:0.0067852265201509
2023-04-17 04:15:26 testing...
The generated pressure mean: 0.4166322946548462
The generated pressure mean: 0.4239100217819214
loss_pred:0.037301450967788696, decouple_loss:0.006232376676052809
The generated pressure mean: 0.42653876543045044
loss_pred:0.03589194640517235, decouple_loss:0.006585456430912018
loss_pred:0.03514017537236214, decouple_loss:0.006828767713159323
WV_0_PC_0_EH_1_PS_40, loss: 0.03643863648176193, avg_mse: 0.0517154224216938
current test mse: 0.051715
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 4321, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4421558380126953
loss_pred:0.0234951414167881, decouple_loss:0.005996569059789181
The generated pressure mean: 0.4400694668292999
loss_pred:0.025141851976513863, decouple_loss:0.005833636503666639
The generated pressure mean: 0.44218710064888
loss_pred:0.022010497748851776, decouple_loss:0.0057860673405230045
Iteration: 4322, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482407569885254
The generated pressure mean: 0.4427635967731476
loss_pred:0.02426539734005928, decouple_loss:0.005842643789947033
loss_pred:0.022840263321995735, decouple_loss:0.005764486733824015
The generated pressure mean: 0.4484527111053467
loss_pred:0.024006320163607597, decouple_loss:0.005921029020100832
Iteration: 4323, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46393299102783203
The generated pressure mean: 0.46288713812828064
loss_pred:0.022518152371048927, decouple_loss:0.005765089765191078
loss_pred:0.02337862178683281, decouple_loss:0.005846185609698296
The generated pressure mean: 0.46618056297302246
loss_pred:0.024687275290489197, decouple_loss:0.006135315168648958
Iteration: 4324, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4453451335430145
The generated pressure mean: 0.4456491768360138
loss_pred:0.02438165806233883, decouple_loss:0.00675830477848649
loss_pred:0.02479085884988308, decouple_loss:0.006621296517550945
The generated pressure mean: 0.44729217886924744
loss_pred:0.022066161036491394, decouple_loss:0.006593851838260889
Iteration: 4325, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4235790967941284
The generated pressure mean: 0.424386590719223
loss_pred:0.023058900609612465, decouple_loss:0.005951862316578627
loss_pred:0.022445105016231537, decouple_loss:0.006006551440805197
The generated pressure mean: 0.4242360293865204
loss_pred:0.02487103082239628, decouple_loss:0.006127378903329372
Iteration: 4326, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44822293519973755
The generated pressure mean: 0.44793832302093506
loss_pred:0.022824348881840706, decouple_loss:0.00671368045732379
loss_pred:0.023111052811145782, decouple_loss:0.006737879943102598
The generated pressure mean: 0.452423095703125
loss_pred:0.02248506061732769, decouple_loss:0.006458062678575516
Iteration: 4327, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45554712414741516
The generated pressure mean: 0.4535588026046753
loss_pred:0.02389451675117016, decouple_loss:0.006487349048256874
loss_pred:0.021946925669908524, decouple_loss:0.0065951356664299965
The generated pressure mean: 0.45669934153556824
loss_pred:0.02399909682571888, decouple_loss:0.00677082221955061
Iteration: 4328, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4563283324241638
The generated pressure mean: 0.45278534293174744
loss_pred:0.023687606677412987, decouple_loss:0.005926988087594509
loss_pred:0.0235468540340662, decouple_loss:0.006101828534156084
The generated pressure mean: 0.4532924294471741
loss_pred:0.023612821474671364, decouple_loss:0.0061470624059438705
Iteration: 4329, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4390031099319458
The generated pressure mean: 0.4435836374759674
loss_pred:0.022458093240857124, decouple_loss:0.005243009887635708
loss_pred:0.023525221273303032, decouple_loss:0.005375953856855631
The generated pressure mean: 0.44536784291267395
loss_pred:0.02382851578295231, decouple_loss:0.005556103773415089
Iteration: 4330, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4330277442932129
loss_pred:0.023967545479536057, decouple_loss:0.005805579945445061
The generated pressure mean: 0.43303993344306946
loss_pred:0.022084200754761696, decouple_loss:0.005739049986004829
The generated pressure mean: 0.430788516998291
loss_pred:0.021850096061825752, decouple_loss:0.005956145003437996
2023-04-17 04:17:56 testing...
The generated pressure mean: 0.41446393728256226
The generated pressure mean: 0.42193490266799927
The generated pressure mean: 0.4243815243244171
loss_pred:0.03648494929075241, decouple_loss:0.006018378306180239
loss_pred:0.03568180277943611, decouple_loss:0.006640516687184572
loss_pred:0.03528841212391853, decouple_loss:0.006837037857621908
WV_0_PC_0_EH_1_PS_40, loss: 0.03614331781864166, avg_mse: 0.050926778465509415
current test mse: 0.050927
Iteration: 4331, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45911750197410583
The generated pressure mean: 0.4543377459049225
loss_pred:0.022645127028226852, decouple_loss:0.005311013199388981
loss_pred:0.023570483550429344, decouple_loss:0.005096226464956999
The generated pressure mean: 0.45272296667099
loss_pred:0.022127699106931686, decouple_loss:0.005053231492638588
Iteration: 4332, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4558708667755127
loss_pred:0.02285548485815525, decouple_loss:0.006143360398709774
The generated pressure mean: 0.4511639177799225
loss_pred:0.02346131019294262, decouple_loss:0.006332654505968094
The generated pressure mean: 0.45637261867523193
loss_pred:0.021788818761706352, decouple_loss:0.006224191281944513
Iteration: 4333, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44750526547431946The generated pressure mean: 0.4417799115180969
loss_pred:0.02270103059709072, decouple_loss:0.005402626935392618
loss_pred:0.022883892059326172, decouple_loss:0.005405410658568144
The generated pressure mean: 0.44315874576568604
loss_pred:0.02292785607278347, decouple_loss:0.0054572997614741325
Iteration: 4334, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4391862154006958
loss_pred:0.02375645563006401, decouple_loss:0.0062996805645525455
The generated pressure mean: 0.4412821829319
loss_pred:0.022810418158769608, decouple_loss:0.006487151142209768
The generated pressure mean: 0.4406452178955078
loss_pred:0.023328211158514023, decouple_loss:0.006307670380920172
Iteration: 4335, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502202570438385
loss_pred:0.023033656179904938, decouple_loss:0.005665269214659929
The generated pressure mean: 0.4474533498287201
loss_pred:0.023110250011086464, decouple_loss:0.005798569414764643
The generated pressure mean: 0.45095133781433105
loss_pred:0.022702105343341827, decouple_loss:0.005664484575390816
Iteration: 4336, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44573360681533813
loss_pred:0.024711284786462784, decouple_loss:0.006432614289224148
The generated pressure mean: 0.4454190731048584
loss_pred:0.02313738502562046, decouple_loss:0.006099659483879805
The generated pressure mean: 0.4471145272254944
loss_pred:0.02547340653836727, decouple_loss:0.006176375318318605
Iteration: 4337, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4532913267612457
The generated pressure mean: 0.4505992531776428
loss_pred:0.022615628316998482, decouple_loss:0.006186704616993666
loss_pred:0.022866539657115936, decouple_loss:0.00621245801448822
The generated pressure mean: 0.45008960366249084
loss_pred:0.023441528901457787, decouple_loss:0.006195686291903257
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4338, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4521641135215759
loss_pred:0.022541241720318794, decouple_loss:0.005196924787014723
The generated pressure mean: 0.44814175367355347
loss_pred:0.02431962825357914, decouple_loss:0.005090679042041302
The generated pressure mean: 0.4441479742527008
loss_pred:0.023994645103812218, decouple_loss:0.0053802612237632275
Iteration: 4339, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4285828769207001
loss_pred:0.023332204669713974, decouple_loss:0.007139225490391254
The generated pressure mean: 0.4285644292831421
loss_pred:0.023807881399989128, decouple_loss:0.0069974311627447605
The generated pressure mean: 0.4314805865287781
loss_pred:0.022997340187430382, decouple_loss:0.006982838734984398
Iteration: 4340, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46262165904045105
loss_pred:0.0238096434623003, decouple_loss:0.005625322461128235
The generated pressure mean: 0.4606499671936035
loss_pred:0.022762177512049675, decouple_loss:0.005381062626838684
The generated pressure mean: 0.4597596824169159
loss_pred:0.022130899131298065, decouple_loss:0.005531781818717718
2023-04-17 04:19:49 testing...
The generated pressure mean: 0.4156911075115204
The generated pressure mean: 0.4218224883079529
loss_pred:0.0366724394261837, decouple_loss:0.00711195869371295
The generated pressure mean: 0.42392638325691223
loss_pred:0.03547040373086929, decouple_loss:0.007514533586800098
loss_pred:0.03550567477941513, decouple_loss:0.007716391235589981
WV_0_PC_0_EH_1_PS_40, loss: 0.03625522181391716, avg_mse: 0.0504966676235199
current test mse: 0.050497
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 4341, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44675716757774353
loss_pred:0.023991117253899574, decouple_loss:0.00626991456374526
The generated pressure mean: 0.4458819031715393
loss_pred:0.022755563259124756, decouple_loss:0.006291852332651615
The generated pressure mean: 0.4520203471183777
loss_pred:0.022614046931266785, decouple_loss:0.006311467383056879
Iteration: 4342, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4385000765323639
loss_pred:0.023526737466454506, decouple_loss:0.006204480770975351
The generated pressure mean: 0.4422280788421631
loss_pred:0.024587640538811684, decouple_loss:0.006323514971882105
The generated pressure mean: 0.4438982903957367
loss_pred:0.024622587487101555, decouple_loss:0.006302082445472479
Iteration: 4343, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44972342252731323
The generated pressure mean: 0.45414820313453674
loss_pred:0.024608997628092766, decouple_loss:0.006386945489794016
loss_pred:0.022334929555654526, decouple_loss:0.006007950287312269
The generated pressure mean: 0.4534364342689514
loss_pred:0.023700742051005363, decouple_loss:0.006328402552753687
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4344, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4523490071296692
The generated pressure mean: 0.44705498218536377
loss_pred:0.02389289066195488, decouple_loss:0.005531879607588053
loss_pred:0.023621940985322, decouple_loss:0.005376167595386505
The generated pressure mean: 0.44716453552246094
loss_pred:0.023083535954356194, decouple_loss:0.005584653001278639
Iteration: 4345, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44449761509895325
The generated pressure mean: 0.4386022984981537
loss_pred:0.02329818345606327, decouple_loss:0.005850466433912516
loss_pred:0.02495458349585533, decouple_loss:0.0058074528351426125
The generated pressure mean: 0.44522497057914734
loss_pred:0.021836847066879272, decouple_loss:0.006032214500010014
Iteration: 4346, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4441643953323364
The generated pressure mean: 0.44487902522087097
loss_pred:0.02378254570066929, decouple_loss:0.005852178670465946
loss_pred:0.023006919771432877, decouple_loss:0.005945572163909674
The generated pressure mean: 0.44334983825683594
loss_pred:0.02303028479218483, decouple_loss:0.006061851046979427
Iteration: 4347, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4560481309890747
The generated pressure mean: 0.45514318346977234
loss_pred:0.022960051894187927, decouple_loss:0.007769471500068903
loss_pred:0.023564813658595085, decouple_loss:0.007884540595114231
The generated pressure mean: 0.45513808727264404
loss_pred:0.024569956585764885, decouple_loss:0.008257262408733368
Iteration: 4348, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44573384523391724
loss_pred:0.02435355633497238, decouple_loss:0.0075269122608006
The generated pressure mean: 0.4464136064052582
loss_pred:0.023792346939444542, decouple_loss:0.0074874297715723515
The generated pressure mean: 0.44094663858413696
loss_pred:0.024639151990413666, decouple_loss:0.00737852742895484
Iteration: 4349, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46341949701309204
loss_pred:0.02384970337152481, decouple_loss:0.005199016071856022
The generated pressure mean: 0.4608069956302643
loss_pred:0.023656412959098816, decouple_loss:0.0050825621001422405
The generated pressure mean: 0.45854517817497253
loss_pred:0.023017026484012604, decouple_loss:0.005098012741655111
Iteration: 4350, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43543684482574463
loss_pred:0.022685114294290543, decouple_loss:0.007585346233099699
The generated pressure mean: 0.436167448759079
loss_pred:0.024150900542736053, decouple_loss:0.00793512724339962
The generated pressure mean: 0.435401976108551
loss_pred:0.024957779794931412, decouple_loss:0.007863561622798443
2023-04-17 04:22:21 testing...
The generated pressure mean: 0.4165811240673065
The generated pressure mean: 0.4230043888092041
The generated pressure mean: 0.4247882068157196
loss_pred:0.035479623824357986, decouple_loss:0.007326089311391115
loss_pred:0.03462788090109825, decouple_loss:0.007744231726974249
loss_pred:0.034586355090141296, decouple_loss:0.007937822490930557
WV_0_PC_0_EH_1_PS_40, loss: 0.03528142347931862, avg_mse: 0.04876822978258133
current test mse: 0.048768
Iteration: 4351, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44703614711761475
loss_pred:0.02428407035768032, decouple_loss:0.006514856591820717
The generated pressure mean: 0.44537702202796936
loss_pred:0.0225080493837595, decouple_loss:0.006593883503228426
The generated pressure mean: 0.44116464257240295
loss_pred:0.024294443428516388, decouple_loss:0.006577145308256149
Iteration: 4352, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4566792845726013
The generated pressure mean: 0.4603126049041748loss_pred:0.02297842688858509, decouple_loss:0.006721602752804756
loss_pred:0.024229325354099274, decouple_loss:0.007213565520942211
The generated pressure mean: 0.4604319632053375
loss_pred:0.023387644439935684, decouple_loss:0.00647262716665864
Iteration: 4353, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4427410066127777
loss_pred:0.024001052603125572, decouple_loss:0.007567544933408499
The generated pressure mean: 0.44223955273628235
loss_pred:0.024391116574406624, decouple_loss:0.007700662594288588
The generated pressure mean: 0.4447753429412842
loss_pred:0.022676613181829453, decouple_loss:0.007570274639874697
Iteration: 4354, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460747539997101
loss_pred:0.02434651181101799, decouple_loss:0.006204784382134676
The generated pressure mean: 0.44405418634414673
loss_pred:0.02443777583539486, decouple_loss:0.005906641483306885
The generated pressure mean: 0.4440956711769104
loss_pred:0.025038255378603935, decouple_loss:0.00611682515591383
Iteration: 4355, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45732828974723816
loss_pred:0.022723985835909843, decouple_loss:0.007883804850280285
The generated pressure mean: 0.4619048535823822
loss_pred:0.024260874837636948, decouple_loss:0.008023965172469616
The generated pressure mean: 0.4597087800502777
loss_pred:0.023441791534423828, decouple_loss:0.007934246212244034
Iteration: 4356, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44113418459892273
loss_pred:0.024181833490729332, decouple_loss:0.006034228019416332
The generated pressure mean: 0.4409809410572052
loss_pred:0.022554853931069374, decouple_loss:0.0059907385148108006
The generated pressure mean: 0.43995150923728943
loss_pred:0.023802105337381363, decouple_loss:0.006279885768890381
Iteration: 4357, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45244792103767395
loss_pred:0.02387770637869835, decouple_loss:0.007773978635668755
The generated pressure mean: 0.4449520707130432
loss_pred:0.026722954586148262, decouple_loss:0.007877144031226635
The generated pressure mean: 0.45119616389274597
loss_pred:0.024304892867803574, decouple_loss:0.007564429193735123
Iteration: 4358, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4428824186325073
loss_pred:0.022508015856146812, decouple_loss:0.005573522299528122
The generated pressure mean: 0.44357407093048096
loss_pred:0.023623954504728317, decouple_loss:0.0055984016507864
The generated pressure mean: 0.43888431787490845
loss_pred:0.024479499086737633, decouple_loss:0.00552930124104023
Iteration: 4359, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4525822699069977
loss_pred:0.02332143858075142, decouple_loss:0.006889553740620613
The generated pressure mean: 0.4484274983406067
loss_pred:0.023321950808167458, decouple_loss:0.0068085696548223495
The generated pressure mean: 0.44900044798851013
loss_pred:0.024570295587182045, decouple_loss:0.00686019379645586
Iteration: 4360, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45366936922073364
loss_pred:0.023748399689793587, decouple_loss:0.005922042299062014
The generated pressure mean: 0.44979944825172424
loss_pred:0.024384932592511177, decouple_loss:0.005946220830082893
The generated pressure mean: 0.45045891404151917
loss_pred:0.023655030876398087, decouple_loss:0.0060621509328484535
2023-04-17 04:24:14 testing...
The generated pressure mean: 0.41666069626808167
The generated pressure mean: 0.42311590909957886
loss_pred:0.03604616969823837, decouple_loss:0.006879654247313738
The generated pressure mean: 0.4253983497619629
loss_pred:0.03517138957977295, decouple_loss:0.0071476418524980545
loss_pred:0.034638967365026474, decouple_loss:0.007359053008258343
WV_0_PC_0_EH_1_PS_40, loss: 0.035641949623823166, avg_mse: 0.04985174536705017
current test mse: 0.049852
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 4361, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4401398003101349
loss_pred:0.023834973573684692, decouple_loss:0.00616332795470953
The generated pressure mean: 0.4402535855770111
The generated pressure mean: 0.44220149517059326
loss_pred:0.023033851757645607, decouple_loss:0.006146073807030916
loss_pred:0.022657666355371475, decouple_loss:0.006275380961596966
Iteration: 4362, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44846484065055847
The generated pressure mean: 0.44930416345596313
loss_pred:0.024306196719408035, decouple_loss:0.0074142469093203545
loss_pred:0.02350354567170143, decouple_loss:0.007359570357948542
The generated pressure mean: 0.4543037712574005
loss_pred:0.02298729494214058, decouple_loss:0.007436402607709169
Iteration: 4363, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4423947334289551
The generated pressure mean: 0.44612884521484375
loss_pred:0.023253308609128, decouple_loss:0.005696394015103579
loss_pred:0.024258928373456, decouple_loss:0.00567376846447587
The generated pressure mean: 0.4416041672229767
loss_pred:0.023211779072880745, decouple_loss:0.005687270779162645
Iteration: 4364, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45171481370925903
The generated pressure mean: 0.45154473185539246
loss_pred:0.02370968461036682, decouple_loss:0.006941320840269327
loss_pred:0.023335907608270645, decouple_loss:0.0073028565384447575
The generated pressure mean: 0.45164114236831665
loss_pred:0.022359542548656464, decouple_loss:0.006981441751122475
Iteration: 4365, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44775107502937317
loss_pred:0.022645121440291405, decouple_loss:0.0058213877491652966
The generated pressure mean: 0.4423719048500061
loss_pred:0.023337841033935547, decouple_loss:0.005964602343738079
The generated pressure mean: 0.44504594802856445
loss_pred:0.022876039147377014, decouple_loss:0.005686845164746046
Iteration: 4366, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4380606710910797
The generated pressure mean: 0.43303602933883667
loss_pred:0.02434430830180645, decouple_loss:0.007021624129265547
loss_pred:0.023461410775780678, decouple_loss:0.00701824389398098
The generated pressure mean: 0.44115322828292847
loss_pred:0.023748379200696945, decouple_loss:0.006963583640754223
Iteration: 4367, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45755237340927124
The generated pressure mean: 0.45408573746681213
loss_pred:0.022802770137786865, decouple_loss:0.006740387063473463
loss_pred:0.022458447143435478, decouple_loss:0.0066079203970730305
The generated pressure mean: 0.45827776193618774
loss_pred:0.022775281220674515, decouple_loss:0.006934206932783127
Iteration: 4368, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44117268919944763
loss_pred:0.024076825007796288, decouple_loss:0.007282715756446123
The generated pressure mean: 0.442082941532135
loss_pred:0.022860664874315262, decouple_loss:0.00709125492721796
The generated pressure mean: 0.44464951753616333
loss_pred:0.022139500826597214, decouple_loss:0.0070594362914562225
Iteration: 4369, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43737930059432983
loss_pred:0.022951198741793633, decouple_loss:0.007800883147865534
The generated pressure mean: 0.4438041150569916
loss_pred:0.022614840418100357, decouple_loss:0.007575998082756996
The generated pressure mean: 0.44109901785850525
loss_pred:0.023690074682235718, decouple_loss:0.007715085055679083
Iteration: 4370, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4578356146812439
loss_pred:0.023666543886065483, decouple_loss:0.0073893251828849316
The generated pressure mean: 0.4598182737827301
loss_pred:0.02340034581720829, decouple_loss:0.0071517545729875565
The generated pressure mean: 0.4521050453186035
loss_pred:0.022877981886267662, decouple_loss:0.007648829370737076
2023-04-17 04:26:53 testing...
The generated pressure mean: 0.41618385910987854
The generated pressure mean: 0.42424529790878296
loss_pred:0.03542531281709671, decouple_loss:0.006733558140695095
The generated pressure mean: 0.42652976512908936
loss_pred:0.0340738371014595, decouple_loss:0.007131775841116905
loss_pred:0.03382786735892296, decouple_loss:0.007350480649620295
WV_0_PC_0_EH_1_PS_40, loss: 0.034795936197042465, avg_mse: 0.048721399158239365
current test mse: 0.048721
Iteration: 4371, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44041192531585693
loss_pred:0.02233978733420372, decouple_loss:0.006343405693769455
The generated pressure mean: 0.44703415036201477
loss_pred:0.022971363738179207, decouple_loss:0.006464024540036917
The generated pressure mean: 0.4482535719871521
loss_pred:0.022906210273504257, decouple_loss:0.00647507281973958
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4372, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44002604484558105
loss_pred:0.023113371804356575, decouple_loss:0.00679022166877985
The generated pressure mean: 0.4320070147514343
loss_pred:0.024133892729878426, decouple_loss:0.006574532948434353
The generated pressure mean: 0.43549665808677673
loss_pred:0.022072643041610718, decouple_loss:0.006772495806217194
Iteration: 4373, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.455844908952713
loss_pred:0.022749099880456924, decouple_loss:0.006357319187372923
The generated pressure mean: 0.45715007185935974
loss_pred:0.022340618073940277, decouple_loss:0.006255322601646185
The generated pressure mean: 0.45292431116104126
loss_pred:0.022898748517036438, decouple_loss:0.006194375921040773
Iteration: 4374, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44565558433532715
loss_pred:0.021418321877717972, decouple_loss:0.005692876875400543
The generated pressure mean: 0.44101381301879883
loss_pred:0.02612592838704586, decouple_loss:0.005707202944904566
The generated pressure mean: 0.4435814917087555
loss_pred:0.023075280711054802, decouple_loss:0.005566122010350227
Iteration: 4375, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4427386224269867
The generated pressure mean: 0.44988346099853516
loss_pred:0.02314835786819458, decouple_loss:0.004891370888799429
loss_pred:0.023277604952454567, decouple_loss:0.005000111646950245
The generated pressure mean: 0.44921979308128357
loss_pred:0.02096291445195675, decouple_loss:0.005120896268635988
Iteration: 4376, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44245225191116333
The generated pressure mean: 0.4391396641731262loss_pred:0.022482261061668396, decouple_loss:0.005655793473124504
loss_pred:0.022639280185103416, decouple_loss:0.005607962608337402
The generated pressure mean: 0.44392797350883484
loss_pred:0.02302461676299572, decouple_loss:0.005750829819589853
Iteration: 4377, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44934436678886414
loss_pred:0.025321146473288536, decouple_loss:0.005361983552575111
The generated pressure mean: 0.4411942660808563
loss_pred:0.02289053425192833, decouple_loss:0.005152421072125435
The generated pressure mean: 0.45116591453552246
loss_pred:0.02106219343841076, decouple_loss:0.005185720510780811
Iteration: 4378, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462115466594696
The generated pressure mean: 0.44165921211242676
loss_pred:0.02401859499514103, decouple_loss:0.006706704385578632
loss_pred:0.02316875196993351, decouple_loss:0.006232837215065956
The generated pressure mean: 0.4422765076160431
loss_pred:0.02359992265701294, decouple_loss:0.006547965575009584
Iteration: 4379, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44563034176826477
loss_pred:0.023614808917045593, decouple_loss:0.00597800500690937
The generated pressure mean: 0.4417859613895416
loss_pred:0.02274336665868759, decouple_loss:0.005716122221201658
The generated pressure mean: 0.446773886680603
loss_pred:0.023787623271346092, decouple_loss:0.005647735204547644
Iteration: 4380, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4632549583911896
loss_pred:0.02332385629415512, decouple_loss:0.004843418952077627
The generated pressure mean: 0.4623279571533203
loss_pred:0.02311733178794384, decouple_loss:0.005007643718272448
The generated pressure mean: 0.45736756920814514
loss_pred:0.02236226014792919, decouple_loss:0.004639692138880491
2023-04-17 04:28:46 testing...
The generated pressure mean: 0.41649794578552246
The generated pressure mean: 0.4240860641002655
The generated pressure mean: 0.42579641938209534
loss_pred:0.03574361652135849, decouple_loss:0.006422845181077719
loss_pred:0.03448115661740303, decouple_loss:0.006725081708282232
loss_pred:0.03466842696070671, decouple_loss:0.006862371228635311
WV_0_PC_0_EH_1_PS_40, loss: 0.03529790788888931, avg_mse: 0.04952452331781387
current test mse: 0.049525
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 4381, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4447162449359894
loss_pred:0.02183675579726696, decouple_loss:0.005871175322681665
The generated pressure mean: 0.4400474727153778
loss_pred:0.02339458279311657, decouple_loss:0.006174922920763493
The generated pressure mean: 0.44543901085853577
loss_pred:0.02461928501725197, decouple_loss:0.005997495725750923
Iteration: 4382, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4328763484954834
loss_pred:0.023153401911258698, decouple_loss:0.00523595605045557
The generated pressure mean: 0.43562525510787964
loss_pred:0.02404518984258175, decouple_loss:0.0052008735947310925
The generated pressure mean: 0.4316387176513672
loss_pred:0.023260697722434998, decouple_loss:0.005236427765339613
Iteration: 4383, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4711157977581024
loss_pred:0.024881558492779732, decouple_loss:0.0069219740107655525
The generated pressure mean: 0.46839383244514465
loss_pred:0.02246985211968422, decouple_loss:0.006609414238482714
The generated pressure mean: 0.4683387577533722
loss_pred:0.022884350270032883, decouple_loss:0.006896864622831345
Iteration: 4384, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44489821791648865
loss_pred:0.02310394123196602, decouple_loss:0.0053106676787137985
The generated pressure mean: 0.4446485638618469
loss_pred:0.02364732325077057, decouple_loss:0.005469002295285463
The generated pressure mean: 0.44710537791252136
loss_pred:0.022912662476301193, decouple_loss:0.00530687952414155
Iteration: 4385, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43015387654304504
loss_pred:0.022784937173128128, decouple_loss:0.005822750739753246
The generated pressure mean: 0.4316481649875641
loss_pred:0.02369023486971855, decouple_loss:0.006031479220837355
The generated pressure mean: 0.43556877970695496
loss_pred:0.023761769756674767, decouple_loss:0.006037540268152952
Iteration: 4386, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45449724793434143
loss_pred:0.02437717281281948, decouple_loss:0.006835631560534239
The generated pressure mean: 0.4566664397716522
The generated pressure mean: 0.45647698640823364
loss_pred:0.022405928000807762, decouple_loss:0.006820581387728453
loss_pred:0.022298481315374374, decouple_loss:0.007279912009835243
Iteration: 4387, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45744001865386963
loss_pred:0.02392689697444439, decouple_loss:0.005125587340444326
The generated pressure mean: 0.45554280281066895
loss_pred:0.023107388988137245, decouple_loss:0.005152109079062939
The generated pressure mean: 0.45293107628822327
loss_pred:0.023480748757719994, decouple_loss:0.0052053797990083694
Iteration: 4388, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4350757896900177
loss_pred:0.023170968517661095, decouple_loss:0.007746382150799036
The generated pressure mean: 0.4380899667739868
loss_pred:0.024659790098667145, decouple_loss:0.0077354577369987965
The generated pressure mean: 0.4375256299972534
loss_pred:0.02345718815922737, decouple_loss:0.007545003667473793
Iteration: 4389, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4406387507915497
loss_pred:0.024203311651945114, decouple_loss:0.005715337581932545
The generated pressure mean: 0.4463314712047577
loss_pred:0.021988293156027794, decouple_loss:0.005631419830024242
The generated pressure mean: 0.44187402725219727
loss_pred:0.023324498906731606, decouple_loss:0.006099892780184746
Iteration: 4390, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4574176073074341
loss_pred:0.02284890227019787, decouple_loss:0.007270356640219688
The generated pressure mean: 0.4504340887069702
The generated pressure mean: 0.4510155916213989
loss_pred:0.02364915981888771, decouple_loss:0.006983874831348658
loss_pred:0.023494841530919075, decouple_loss:0.00688460748642683

2023-04-17 04:31:14 testing...
The generated pressure mean: 0.4151512682437897
The generated pressure mean: 0.42317840456962585
The generated pressure mean: 0.4250290095806122
loss_pred:0.036509111523628235, decouple_loss:0.006837609224021435
loss_pred:0.03539099916815758, decouple_loss:0.0073369331657886505
loss_pred:0.03556068241596222, decouple_loss:0.007077830843627453
WV_0_PC_0_EH_1_PS_40, loss: 0.0361744724214077, avg_mse: 0.051276274025440216
current test mse: 0.051276
Iteration: 4391, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4520401656627655
The generated pressure mean: 0.45082566142082214
loss_pred:0.022688480094075203, decouple_loss:0.006092678289860487
loss_pred:0.02400742843747139, decouple_loss:0.006170147564262152
The generated pressure mean: 0.4547293782234192
loss_pred:0.023739805445075035, decouple_loss:0.006077570840716362
Iteration: 4392, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44180843234062195
loss_pred:0.023849355056881905, decouple_loss:0.00633039977401495
The generated pressure mean: 0.44255393743515015
loss_pred:0.021821320056915283, decouple_loss:0.00617445632815361
The generated pressure mean: 0.4437989294528961
loss_pred:0.02294173464179039, decouple_loss:0.006155800074338913
Iteration: 4393, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43240538239479065
The generated pressure mean: 0.44086286425590515
loss_pred:0.023926761001348495, decouple_loss:0.007228440139442682
loss_pred:0.023951884359121323, decouple_loss:0.007507286500185728
The generated pressure mean: 0.43654435873031616
loss_pred:0.02347049117088318, decouple_loss:0.007133779115974903
Iteration: 4394, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46080613136291504
loss_pred:0.02405659481883049, decouple_loss:0.006886535789817572
The generated pressure mean: 0.4582972228527069
loss_pred:0.02320045232772827, decouple_loss:0.006701692007482052
The generated pressure mean: 0.4553004205226898
loss_pred:0.023078327998518944, decouple_loss:0.007335919886827469
Iteration: 4395, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487929344177246
loss_pred:0.02415982261300087, decouple_loss:0.0067789386957883835
The generated pressure mean: 0.4596998393535614
loss_pred:0.023200057446956635, decouple_loss:0.007075582165271044
The generated pressure mean: 0.4521932303905487
loss_pred:0.023698177188634872, decouple_loss:0.007091319654136896
Iteration: 4396, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4264337122440338
loss_pred:0.02290385589003563, decouple_loss:0.007854408584535122
The generated pressure mean: 0.42755115032196045
loss_pred:0.023526379838585854, decouple_loss:0.007650736719369888
The generated pressure mean: 0.4303666055202484
loss_pred:0.023048844188451767, decouple_loss:0.007840697653591633
Iteration: 4397, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4620094299316406
loss_pred:0.023546511307358742, decouple_loss:0.007100190035998821
The generated pressure mean: 0.46330446004867554
loss_pred:0.02218828909099102, decouple_loss:0.007299504242837429
The generated pressure mean: 0.4624006152153015
loss_pred:0.02290823869407177, decouple_loss:0.0072109210304915905
Iteration: 4398, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473649859428406
loss_pred:0.022882681339979172, decouple_loss:0.006427498534321785
The generated pressure mean: 0.4379168748855591
loss_pred:0.024340901523828506, decouple_loss:0.006590191274881363
The generated pressure mean: 0.44647684693336487
loss_pred:0.02302299067378044, decouple_loss:0.006414160132408142
Iteration: 4399, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4347609281539917
loss_pred:0.023385347798466682, decouple_loss:0.006772978696972132
The generated pressure mean: 0.4347180426120758
loss_pred:0.022076182067394257, decouple_loss:0.006452851928770542
The generated pressure mean: 0.44738152623176575
loss_pred:0.0239794310182333, decouple_loss:0.006618985440582037
Iteration: 4400, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4611334502696991
loss_pred:0.02377934940159321, decouple_loss:0.00648502679541707
The generated pressure mean: 0.46641507744789124
loss_pred:0.022222353145480156, decouple_loss:0.006574850529432297
The generated pressure mean: 0.4631653130054474
loss_pred:0.022500010207295418, decouple_loss:0.006419842131435871
2023-04-17 04:33:07 testing...
The generated pressure mean: 0.41537564992904663
The generated pressure mean: 0.4236709475517273
The generated pressure mean: 0.42609456181526184
loss_pred:0.03692404553294182, decouple_loss:0.0068030874244868755
loss_pred:0.035231925547122955, decouple_loss:0.007182345725595951
loss_pred:0.0352134108543396, decouple_loss:0.007509133778512478
WV_0_PC_0_EH_1_PS_40, loss: 0.036148037761449814, avg_mse: 0.051122378557920456
current test mse: 0.051122
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
Iteration: 4401, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464303255081177
loss_pred:0.02525745891034603, decouple_loss:0.005964186508208513
The generated pressure mean: 0.451524555683136
loss_pred:0.025180689990520477, decouple_loss:0.006130603142082691
The generated pressure mean: 0.44557613134384155
loss_pred:0.02503339573740959, decouple_loss:0.005869222339242697
Iteration: 4402, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42356106638908386
The generated pressure mean: 0.4208388924598694
loss_pred:0.022987809032201767, decouple_loss:0.006733381189405918
loss_pred:0.025238310918211937, decouple_loss:0.006671397481113672
The generated pressure mean: 0.42381903529167175
loss_pred:0.024641957134008408, decouple_loss:0.006684876978397369
Iteration: 4403, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45650941133499146
loss_pred:0.023624824360013008, decouple_loss:0.005935144145041704
The generated pressure mean: 0.4542655944824219
loss_pred:0.02310783416032791, decouple_loss:0.0060156118124723434
The generated pressure mean: 0.4649564325809479
loss_pred:0.023300906643271446, decouple_loss:0.005919009447097778
Iteration: 4404, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4520520865917206
The generated pressure mean: 0.4554263651371002
loss_pred:0.02452637441456318, decouple_loss:0.006599653046578169
loss_pred:0.023498110473155975, decouple_loss:0.00639736233279109
The generated pressure mean: 0.4557369351387024
loss_pred:0.023885736241936684, decouple_loss:0.0064222305081784725
Iteration: 4405, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44501781463623047
loss_pred:0.02466004155576229, decouple_loss:0.00614122161641717
The generated pressure mean: 0.44511279463768005
loss_pred:0.0249525997787714, decouple_loss:0.006197230890393257
The generated pressure mean: 0.44752323627471924
loss_pred:0.025899745523929596, decouple_loss:0.006205024663358927
Iteration: 4406, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.426289826631546
The generated pressure mean: 0.42722591757774353
loss_pred:0.024227824062108994, decouple_loss:0.006121670827269554
loss_pred:0.024698274210095406, decouple_loss:0.005935170222073793
The generated pressure mean: 0.4292662441730499
loss_pred:0.0238095261156559, decouple_loss:0.005998483393341303
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4407, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479732811450958
The generated pressure mean: 0.4385993182659149
loss_pred:0.024694601073861122, decouple_loss:0.006086426787078381
loss_pred:0.02233092114329338, decouple_loss:0.005704388953745365
The generated pressure mean: 0.43981441855430603
loss_pred:0.02336917445063591, decouple_loss:0.005993836559355259
Iteration: 4408, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4571138322353363
loss_pred:0.023752490058541298, decouple_loss:0.006474588066339493
The generated pressure mean: 0.4636566936969757
loss_pred:0.023718468844890594, decouple_loss:0.006329564843326807
The generated pressure mean: 0.460214763879776
loss_pred:0.024806616827845573, decouple_loss:0.006372392643243074
Iteration: 4409, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45820295810699463
The generated pressure mean: 0.4575963020324707
loss_pred:0.026563040912151337, decouple_loss:0.004992048256099224
loss_pred:0.025047460570931435, decouple_loss:0.005003703758120537
The generated pressure mean: 0.46218276023864746
loss_pred:0.023282980546355247, decouple_loss:0.004989452660083771
Iteration: 4410, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4166775643825531
The generated pressure mean: 0.42108166217803955loss_pred:0.024451490491628647, decouple_loss:0.006377823650836945
loss_pred:0.024210672825574875, decouple_loss:0.006201327778398991
The generated pressure mean: 0.4197724759578705
loss_pred:0.023490019142627716, decouple_loss:0.0065641808323562145
2023-04-17 04:35:41 testing...
The generated pressure mean: 0.4131224453449249
The generated pressure mean: 0.4202577471733093
The generated pressure mean: 0.4221329391002655
loss_pred:0.03909004479646683, decouple_loss:0.006336623337119818
loss_pred:0.037846896797418594, decouple_loss:0.006706504616886377
loss_pred:0.03800081089138985, decouple_loss:0.00678412988781929
WV_0_PC_0_EH_1_PS_40, loss: 0.038643039762973785, avg_mse: 0.05573692545294762
current test mse: 0.055737
Iteration: 4411, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45356762409210205
loss_pred:0.02425164170563221, decouple_loss:0.00565802026540041
The generated pressure mean: 0.450570672750473
loss_pred:0.022721780464053154, decouple_loss:0.005595551338046789
The generated pressure mean: 0.4512466490268707
loss_pred:0.02382528781890869, decouple_loss:0.005505086854100227
Iteration: 4412, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44693222641944885
loss_pred:0.024984968826174736, decouple_loss:0.005359984934329987
The generated pressure mean: 0.4508628845214844
loss_pred:0.02339605800807476, decouple_loss:0.005352172069251537
The generated pressure mean: 0.45576438307762146
loss_pred:0.024907656013965607, decouple_loss:0.005447267554700375
Iteration: 4413, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4246550500392914
loss_pred:0.02427060902118683, decouple_loss:0.005081822630017996
The generated pressure mean: 0.42659443616867065
loss_pred:0.024944527074694633, decouple_loss:0.005051702726632357
The generated pressure mean: 0.4268660545349121
loss_pred:0.024588361382484436, decouple_loss:0.0051543572917580605
Iteration: 4414, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47720545530319214
loss_pred:0.02620110474526882, decouple_loss:0.0068178907968103886
The generated pressure mean: 0.4788156747817993
loss_pred:0.02454608492553234, decouple_loss:0.006545822601765394
The generated pressure mean: 0.4790689945220947
loss_pred:0.023455368354916573, decouple_loss:0.006594887934625149
Iteration: 4415, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43615543842315674
loss_pred:0.024443602189421654, decouple_loss:0.006303868256509304
The generated pressure mean: 0.43800491094589233
loss_pred:0.023473069071769714, decouple_loss:0.0065151541493833065
The generated pressure mean: 0.4352506995201111
loss_pred:0.02364366501569748, decouple_loss:0.006638047285377979
Iteration: 4416, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42831242084503174
loss_pred:0.02231706865131855, decouple_loss:0.005129680968821049
The generated pressure mean: 0.4210180342197418
loss_pred:0.02315490134060383, decouple_loss:0.005471913143992424
The generated pressure mean: 0.4275304675102234
loss_pred:0.02263433299958706, decouple_loss:0.00521777244284749
Iteration: 4417, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4512390196323395
The generated pressure mean: 0.45171913504600525
loss_pred:0.0226887259632349, decouple_loss:0.0074183023534715176
loss_pred:0.024522464722394943, decouple_loss:0.007957501336932182
The generated pressure mean: 0.45278552174568176
loss_pred:0.02294616773724556, decouple_loss:0.0076109603978693485
Iteration: 4418, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4591468870639801
The generated pressure mean: 0.46016934514045715loss_pred:0.025763019919395447, decouple_loss:0.005543832201510668
loss_pred:0.02349916845560074, decouple_loss:0.005750121548771858
The generated pressure mean: 0.4592134356498718
loss_pred:0.02369735576212406, decouple_loss:0.005559095647186041
Iteration: 4419, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42501142621040344
loss_pred:0.025266023352742195, decouple_loss:0.007858939468860626
The generated pressure mean: 0.4267059862613678
loss_pred:0.02525743655860424, decouple_loss:0.007577251642942429
The generated pressure mean: 0.4218937158584595
loss_pred:0.022891348227858543, decouple_loss:0.007958878763020039
Iteration: 4420, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.451977401971817
The generated pressure mean: 0.4466418921947479
loss_pred:0.02316160500049591, decouple_loss:0.005703069735318422
loss_pred:0.02460169978439808, decouple_loss:0.0056726750917732716
The generated pressure mean: 0.4505396783351898
loss_pred:0.025326156988739967, decouple_loss:0.005520379636436701
2023-04-17 04:37:35 testing...
The generated pressure mean: 0.4119621813297272
The generated pressure mean: 0.41785043478012085
The generated pressure mean: 0.42017632722854614
loss_pred:0.036380667239427567, decouple_loss:0.007633695378899574
loss_pred:0.035795748233795166, decouple_loss:0.007996493019163609
loss_pred:0.03511945530772209, decouple_loss:0.008108856156468391
WV_0_PC_0_EH_1_PS_40, loss: 0.036160942167043686, avg_mse: 0.05048723146319389
current test mse: 0.050487
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 4421, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4552629292011261
loss_pred:0.02519475668668747, decouple_loss:0.007030955981463194
The generated pressure mean: 0.45203089714050293
The generated pressure mean: 0.45762526988983154
loss_pred:0.02675328589975834, decouple_loss:0.006947244983166456
loss_pred:0.023939959704875946, decouple_loss:0.006897039245814085
Iteration: 4422, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45646440982818604
The generated pressure mean: 0.4576469957828522
loss_pred:0.02375413104891777, decouple_loss:0.00613745441660285
loss_pred:0.02259887009859085, decouple_loss:0.0066224620677530766
The generated pressure mean: 0.4576365351676941
loss_pred:0.024761507287621498, decouple_loss:0.006304499693214893
Iteration: 4423, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4343307614326477
loss_pred:0.02279639057815075, decouple_loss:0.00524446414783597
The generated pressure mean: 0.43694618344306946
loss_pred:0.02305814065039158, decouple_loss:0.005358119960874319
The generated pressure mean: 0.4360804259777069
loss_pred:0.022597620263695717, decouple_loss:0.005478061269968748
Iteration: 4424, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43070685863494873
The generated pressure mean: 0.4294409155845642
loss_pred:0.023544754832983017, decouple_loss:0.006152712740004063
loss_pred:0.023757606744766235, decouple_loss:0.005936293862760067
The generated pressure mean: 0.42822328209877014
loss_pred:0.022775664925575256, decouple_loss:0.0058176894672214985
Iteration: 4425, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4610995650291443
loss_pred:0.025393443182110786, decouple_loss:0.00533980131149292
The generated pressure mean: 0.4627056121826172
loss_pred:0.024222252890467644, decouple_loss:0.005235984921455383
The generated pressure mean: 0.4579397737979889
loss_pred:0.022298943251371384, decouple_loss:0.005225075408816338
Iteration: 4426, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4512380361557007
loss_pred:0.02317839488387108, decouple_loss:0.00586701137945056
The generated pressure mean: 0.4529059827327728
loss_pred:0.02437755838036537, decouple_loss:0.005698713473975658
The generated pressure mean: 0.45578351616859436
loss_pred:0.022651588544249535, decouple_loss:0.0059582144021987915
Iteration: 4427, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44336363673210144
loss_pred:0.02441292442381382, decouple_loss:0.0056580714881420135
The generated pressure mean: 0.43801289796829224
loss_pred:0.023531746119260788, decouple_loss:0.0053908140398561954
The generated pressure mean: 0.43944990634918213
loss_pred:0.024361860007047653, decouple_loss:0.005689379759132862
Iteration: 4428, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4518805146217346
The generated pressure mean: 0.4544127285480499
loss_pred:0.022168317809700966, decouple_loss:0.005332112777978182
loss_pred:0.024004442617297173, decouple_loss:0.005447808653116226
The generated pressure mean: 0.4563722014427185
loss_pred:0.023279130458831787, decouple_loss:0.0053010485135018826
Iteration: 4429, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4432606101036072
loss_pred:0.022926900535821915, decouple_loss:0.005699698347598314
The generated pressure mean: 0.43937838077545166
loss_pred:0.02551340125501156, decouple_loss:0.005894786212593317
The generated pressure mean: 0.4394589066505432
loss_pred:0.024163957685232162, decouple_loss:0.0056178150698542595
Iteration: 4430, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43336018919944763
The generated pressure mean: 0.4329240620136261loss_pred:0.0232087392359972, decouple_loss:0.005329042673110962
loss_pred:0.02270997315645218, decouple_loss:0.005348130129277706
The generated pressure mean: 0.43339666724205017
loss_pred:0.024336477741599083, decouple_loss:0.0053483871743083
2023-04-17 04:40:03 testing...
The generated pressure mean: 0.4131179451942444
The generated pressure mean: 0.4205282926559448
The generated pressure mean: 0.4229929745197296
loss_pred:0.03883243352174759, decouple_loss:0.006091374438256025
loss_pred:0.03729425370693207, decouple_loss:0.006452226545661688
loss_pred:0.03707057237625122, decouple_loss:0.0066734738647937775
WV_0_PC_0_EH_1_PS_40, loss: 0.03805270418524742, avg_mse: 0.054534912109375
current test mse: 0.054535
Iteration: 4431, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4553476572036743
loss_pred:0.023510875180363655, decouple_loss:0.005441027693450451
The generated pressure mean: 0.4505084156990051
loss_pred:0.023774372413754463, decouple_loss:0.005237108562141657
The generated pressure mean: 0.4510166049003601
loss_pred:0.022282294929027557, decouple_loss:0.005340985022485256
Iteration: 4432, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45627251267433167
loss_pred:0.02180165983736515, decouple_loss:0.005136469844728708
The generated pressure mean: 0.4584864377975464
loss_pred:0.02114863693714142, decouple_loss:0.005193006247282028
The generated pressure mean: 0.4598087668418884
loss_pred:0.023014497011899948, decouple_loss:0.005378996953368187
Iteration: 4433, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43957847356796265
loss_pred:0.02302154153585434, decouple_loss:0.0051941112615168095
The generated pressure mean: 0.43827342987060547
loss_pred:0.022445745766162872, decouple_loss:0.005166663788259029
The generated pressure mean: 0.43783295154571533
loss_pred:0.022733628749847412, decouple_loss:0.00520668039098382
Iteration: 4434, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43548300862312317
loss_pred:0.023072797805070877, decouple_loss:0.005183360539376736
The generated pressure mean: 0.43906739354133606
loss_pred:0.023127974942326546, decouple_loss:0.0052896179258823395
The generated pressure mean: 0.4398704469203949
loss_pred:0.02291223220527172, decouple_loss:0.005457624793052673
Iteration: 4435, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45546963810920715
loss_pred:0.02327294647693634, decouple_loss:0.005643787328153849
The generated pressure mean: 0.44958212971687317
loss_pred:0.02218911424279213, decouple_loss:0.005297735799103975
The generated pressure mean: 0.4622681140899658
loss_pred:0.023029735311865807, decouple_loss:0.005513784475624561
Iteration: 4436, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486921429634094
loss_pred:0.02430456131696701, decouple_loss:0.006421745754778385
The generated pressure mean: 0.4474838376045227
loss_pred:0.022028792649507523, decouple_loss:0.006767223123461008
The generated pressure mean: 0.4451209306716919
loss_pred:0.021901173517107964, decouple_loss:0.006419498473405838
Iteration: 4437, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494398534297943
loss_pred:0.022626932710409164, decouple_loss:0.005528527777642012
The generated pressure mean: 0.4458136558532715
loss_pred:0.0227339044213295, decouple_loss:0.0056479196064174175
The generated pressure mean: 0.44311821460723877
loss_pred:0.02303827367722988, decouple_loss:0.005612622480839491
Iteration: 4438, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44493454694747925
loss_pred:0.021744785830378532, decouple_loss:0.004749146290123463
The generated pressure mean: 0.44236838817596436
loss_pred:0.023091820999979973, decouple_loss:0.004656362812966108
The generated pressure mean: 0.4467506408691406
loss_pred:0.02306513488292694, decouple_loss:0.004616611171513796
Iteration: 4439, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4533504247665405
loss_pred:0.02378683350980282, decouple_loss:0.005213215947151184
The generated pressure mean: 0.45333659648895264
loss_pred:0.022405020892620087, decouple_loss:0.005309834145009518
The generated pressure mean: 0.45170360803604126
loss_pred:0.022816330194473267, decouple_loss:0.005393250845372677
Iteration: 4440, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4421388804912567
loss_pred:0.023331323638558388, decouple_loss:0.005142692476511002
The generated pressure mean: 0.4421197474002838
loss_pred:0.022047314792871475, decouple_loss:0.0051162363961339
The generated pressure mean: 0.4419960081577301
loss_pred:0.023803379386663437, decouple_loss:0.005251607391983271
2023-04-17 04:41:56 testing...
The generated pressure mean: 0.42539507150650024
The generated pressure mean: 0.41759929060935974
The generated pressure mean: 0.4282059967517853
loss_pred:0.0341515876352787, decouple_loss:0.006874543149024248
loss_pred:0.035522691905498505, decouple_loss:0.006556998938322067
loss_pred:0.03405753895640373, decouple_loss:0.007084747776389122
WV_0_PC_0_EH_1_PS_40, loss: 0.03491921350359917, avg_mse: 0.048921793699264526
current test mse: 0.048922
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 4441, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4357660412788391
loss_pred:0.023414986208081245, decouple_loss:0.0054968250915408134
The generated pressure mean: 0.4421236217021942
loss_pred:0.02264505624771118, decouple_loss:0.005392713472247124
The generated pressure mean: 0.4409548342227936
loss_pred:0.02270212583243847, decouple_loss:0.005461445543915033
Iteration: 4442, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4590892791748047
loss_pred:0.022279057651758194, decouple_loss:0.005394909996539354
The generated pressure mean: 0.45978814363479614
loss_pred:0.021838853135704994, decouple_loss:0.005357922054827213
The generated pressure mean: 0.4602380692958832
loss_pred:0.021864237263798714, decouple_loss:0.005244850646704435
Iteration: 4443, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45380699634552
The generated pressure mean: 0.4554358124732971loss_pred:0.02237510494887829, decouple_loss:0.005449441261589527
loss_pred:0.023880885913968086, decouple_loss:0.005448522046208382
The generated pressure mean: 0.453021377325058
loss_pred:0.02225743979215622, decouple_loss:0.005439372733235359
Iteration: 4444, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4333992600440979
The generated pressure mean: 0.43211618065834045
loss_pred:0.021573461592197418, decouple_loss:0.005519954487681389
loss_pred:0.02325882762670517, decouple_loss:0.005338639486581087
The generated pressure mean: 0.4307021200656891
loss_pred:0.02351236343383789, decouple_loss:0.00545228086411953
Iteration: 4445, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45121628046035767
The generated pressure mean: 0.44908562302589417
loss_pred:0.021711284294724464, decouple_loss:0.004735857248306274
loss_pred:0.022015418857336044, decouple_loss:0.00468036625534296
The generated pressure mean: 0.44717633724212646
loss_pred:0.022648582234978676, decouple_loss:0.0046903337351977825
Iteration: 4446, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.462568074464798
The generated pressure mean: 0.4590897560119629
loss_pred:0.023330550640821457, decouple_loss:0.004983771126717329
loss_pred:0.021918395534157753, decouple_loss:0.00516495481133461
The generated pressure mean: 0.46245908737182617
loss_pred:0.02272162213921547, decouple_loss:0.0047918157652020454
Iteration: 4447, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43428143858909607
The generated pressure mean: 0.4392741322517395
loss_pred:0.022967923432588577, decouple_loss:0.005178963765501976
loss_pred:0.02264348603785038, decouple_loss:0.005287065636366606
The generated pressure mean: 0.4338926672935486
loss_pred:0.021232845261693, decouple_loss:0.00528834480792284
Iteration: 4448, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44306546449661255
loss_pred:0.021430302411317825, decouple_loss:0.005613448563963175
The generated pressure mean: 0.43890589475631714
loss_pred:0.023309487849473953, decouple_loss:0.005838447250425816
The generated pressure mean: 0.4420977532863617
loss_pred:0.022256456315517426, decouple_loss:0.005643167067319155
Iteration: 4449, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45937493443489075
loss_pred:0.021996380761265755, decouple_loss:0.005404351279139519
The generated pressure mean: 0.45800140500068665
loss_pred:0.021894359961152077, decouple_loss:0.005433312151581049
The generated pressure mean: 0.4582177996635437
loss_pred:0.021359089761972427, decouple_loss:0.005500800907611847
Iteration: 4450, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44139859080314636
loss_pred:0.022090023383498192, decouple_loss:0.004907901864498854
The generated pressure mean: 0.4442524313926697
The generated pressure mean: 0.44019341468811035
loss_pred:0.022358525544404984, decouple_loss:0.005060235038399696
loss_pred:0.023570865392684937, decouple_loss:0.005128331016749144
2023-04-17 04:44:24 testing...
The generated pressure mean: 0.41668999195098877
The generated pressure mean: 0.4255600571632385
The generated pressure mean: 0.42858749628067017
loss_pred:0.03607930243015289, decouple_loss:0.006648721639066935
loss_pred:0.03484954312443733, decouple_loss:0.0070859165862202644
loss_pred:0.0345904678106308, decouple_loss:0.007281101308763027
WV_0_PC_0_EH_1_PS_40, loss: 0.035523369908332825, avg_mse: 0.05047993361949921
current test mse: 0.05048
Iteration: 4451, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4412870705127716
loss_pred:0.024905545637011528, decouple_loss:0.005822525359690189
The generated pressure mean: 0.44430240988731384
loss_pred:0.021809976547956467, decouple_loss:0.005627472884953022
The generated pressure mean: 0.44260188937187195
loss_pred:0.022379282861948013, decouple_loss:0.005876046139746904
Iteration: 4452, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4570329487323761
loss_pred:0.021384716033935547, decouple_loss:0.00439089722931385
The generated pressure mean: 0.4578450918197632
loss_pred:0.023508762940764427, decouple_loss:0.004644667264074087
The generated pressure mean: 0.4537840783596039
loss_pred:0.024157965555787086, decouple_loss:0.00473098736256361
Iteration: 4453, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442013204097748
loss_pred:0.023617789149284363, decouple_loss:0.006892008241266012
The generated pressure mean: 0.4454856216907501
loss_pred:0.02156323939561844, decouple_loss:0.006896869745105505
The generated pressure mean: 0.44273698329925537
loss_pred:0.02124965749680996, decouple_loss:0.006779543589800596
Iteration: 4454, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43481072783470154
loss_pred:0.021809065714478493, decouple_loss:0.005891792010515928
The generated pressure mean: 0.4369063377380371
loss_pred:0.02167823724448681, decouple_loss:0.006129610817879438
The generated pressure mean: 0.4355025291442871
loss_pred:0.022489918395876884, decouple_loss:0.005933500360697508
Iteration: 4455, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44867202639579773
loss_pred:0.022570641711354256, decouple_loss:0.005844006780534983The generated pressure mean: 0.45269426703453064
loss_pred:0.02243323065340519, decouple_loss:0.005941368639469147
The generated pressure mean: 0.4507107138633728
loss_pred:0.022122390568256378, decouple_loss:0.0062400707975029945
Iteration: 4456, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4618447721004486
loss_pred:0.02295900695025921, decouple_loss:0.0063896747305989265
The generated pressure mean: 0.4592873156070709
loss_pred:0.021689819172024727, decouple_loss:0.006423553451895714
The generated pressure mean: 0.4599161148071289
loss_pred:0.021131867542862892, decouple_loss:0.006350389216095209
Iteration: 4457, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4440673887729645
loss_pred:0.02310008741915226, decouple_loss:0.005448788870126009
The generated pressure mean: 0.4357350170612335
loss_pred:0.023556234315037727, decouple_loss:0.005505039822310209
The generated pressure mean: 0.4456672966480255
loss_pred:0.021975470706820488, decouple_loss:0.0054167406633496284
Iteration: 4458, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4357384443283081
loss_pred:0.023643232882022858, decouple_loss:0.006466708146035671
The generated pressure mean: 0.43737903237342834
loss_pred:0.022717036306858063, decouple_loss:0.006457278039306402
The generated pressure mean: 0.4354580044746399
loss_pred:0.023067930713295937, decouple_loss:0.006764997728168964
Iteration: 4459, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44847625494003296
loss_pred:0.02314065583050251, decouple_loss:0.005419048015028238
The generated pressure mean: 0.45064181089401245
loss_pred:0.023173147812485695, decouple_loss:0.005163201596587896
The generated pressure mean: 0.4504662752151489
loss_pred:0.022466327995061874, decouple_loss:0.005268619395792484
Iteration: 4460, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4624558389186859
loss_pred:0.02231641672551632, decouple_loss:0.007071161177009344
The generated pressure mean: 0.4583241641521454
loss_pred:0.021885031834244728, decouple_loss:0.007075312081724405
The generated pressure mean: 0.4585287570953369
loss_pred:0.022476494312286377, decouple_loss:0.007242689374834299
2023-04-17 04:46:17 testing...
The generated pressure mean: 0.4148067235946655
The generated pressure mean: 0.4223257601261139
The generated pressure mean: 0.42516472935676575
loss_pred:0.03627180680632591, decouple_loss:0.006864613387733698
loss_pred:0.03524008393287659, decouple_loss:0.0073889922350645065
loss_pred:0.03534168004989624, decouple_loss:0.007196176331490278
WV_0_PC_0_EH_1_PS_40, loss: 0.03597535192966461, avg_mse: 0.051052823662757874
current test mse: 0.051053
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 4461, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507496953010559
loss_pred:0.022388970479369164, decouple_loss:0.005768136586993933
The generated pressure mean: 0.4457499384880066
loss_pred:0.021873852238059044, decouple_loss:0.005817907862365246
The generated pressure mean: 0.45143914222717285
loss_pred:0.02415519952774048, decouple_loss:0.00612081540748477
Iteration: 4462, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42998772859573364
loss_pred:0.022617554292082787, decouple_loss:0.005207142326980829
The generated pressure mean: 0.4325169324874878
loss_pred:0.023801863193511963, decouple_loss:0.005209519527852535
The generated pressure mean: 0.43233802914619446
loss_pred:0.023409061133861542, decouple_loss:0.005105242133140564
Iteration: 4463, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44934016466140747
The generated pressure mean: 0.44765910506248474
loss_pred:0.02270270138978958, decouple_loss:0.007470185402780771
loss_pred:0.02330809272825718, decouple_loss:0.00766828702762723
The generated pressure mean: 0.4505577087402344
loss_pred:0.023832591250538826, decouple_loss:0.007456012070178986
Iteration: 4464, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494883716106415
loss_pred:0.022346753627061844, decouple_loss:0.006537534762173891
The generated pressure mean: 0.4466760456562042
loss_pred:0.02216016873717308, decouple_loss:0.006289450917392969
The generated pressure mean: 0.4501718282699585
loss_pred:0.023628689348697662, decouple_loss:0.006415004841983318
Iteration: 4465, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492187201976776
The generated pressure mean: 0.44935157895088196
loss_pred:0.022151848301291466, decouple_loss:0.006663813255727291
loss_pred:0.02199479751288891, decouple_loss:0.006485031917691231
The generated pressure mean: 0.45118170976638794
loss_pred:0.02207304909825325, decouple_loss:0.006509432103484869
Iteration: 4466, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44855165481567383
loss_pred:0.02369021624326706, decouple_loss:0.005730982404202223
The generated pressure mean: 0.45257702469825745
The generated pressure mean: 0.4443591833114624
loss_pred:0.02166474610567093, decouple_loss:0.005943050142377615
loss_pred:0.020900726318359375, decouple_loss:0.005900280084460974
Iteration: 4467, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44304385781288147
loss_pred:0.02205180935561657, decouple_loss:0.006171300075948238
The generated pressure mean: 0.4427579641342163
loss_pred:0.026161834597587585, decouple_loss:0.006668003275990486
The generated pressure mean: 0.4405081272125244
loss_pred:0.021727370098233223, decouple_loss:0.006318361032754183
Iteration: 4468, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447445809841156
loss_pred:0.02343657985329628, decouple_loss:0.006205467972904444
The generated pressure mean: 0.43582838773727417
loss_pred:0.022933850064873695, decouple_loss:0.006148132495582104
The generated pressure mean: 0.44486308097839355
loss_pred:0.021997859701514244, decouple_loss:0.006178810261189938
Iteration: 4469, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495731294155121
loss_pred:0.022226128727197647, decouple_loss:0.005594168324023485
The generated pressure mean: 0.45335355401039124
loss_pred:0.022895893082022667, decouple_loss:0.005657533649355173
The generated pressure mean: 0.44713646173477173
loss_pred:0.02309427410364151, decouple_loss:0.005559269338846207
Iteration: 4470, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43996480107307434
loss_pred:0.0234004408121109, decouple_loss:0.005949970800429583
The generated pressure mean: 0.4425972104072571
loss_pred:0.0235414020717144, decouple_loss:0.005760768428444862
The generated pressure mean: 0.44074273109436035
loss_pred:0.023364068940281868, decouple_loss:0.0060766832903027534
2023-04-17 04:48:41 testing...
The generated pressure mean: 0.41333669424057007
The generated pressure mean: 0.42065396904945374
The generated pressure mean: 0.4236704409122467
loss_pred:0.03630935773253441, decouple_loss:0.006575902923941612
loss_pred:0.035129666328430176, decouple_loss:0.0069590285420417786
loss_pred:0.034885331988334656, decouple_loss:0.0072228373028337955
WV_0_PC_0_EH_1_PS_40, loss: 0.03578741475939751, avg_mse: 0.050976868718862534
current test mse: 0.050977
Iteration: 4471, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45758315920829773
loss_pred:0.023113001137971878, decouple_loss:0.00600341847166419
The generated pressure mean: 0.4510234296321869
loss_pred:0.02298896759748459, decouple_loss:0.0058767832815647125
The generated pressure mean: 0.44562143087387085
loss_pred:0.023813411593437195, decouple_loss:0.005961088929325342
Iteration: 4472, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4453625977039337
loss_pred:0.0249739158898592, decouple_loss:0.0056489938870072365
The generated pressure mean: 0.44268348813056946
loss_pred:0.022617770358920097, decouple_loss:0.005510080140084028
The generated pressure mean: 0.4453657865524292
loss_pred:0.02289191447198391, decouple_loss:0.0054541355930268764
Iteration: 4473, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4436168670654297
loss_pred:0.022930588573217392, decouple_loss:0.005788360256701708
The generated pressure mean: 0.4353320598602295
loss_pred:0.02328934706747532, decouple_loss:0.0057684192433953285
The generated pressure mean: 0.4397253692150116
loss_pred:0.02332780323922634, decouple_loss:0.005929626990109682
Iteration: 4474, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4626100957393646
loss_pred:0.02386121079325676, decouple_loss:0.005074318964034319
The generated pressure mean: 0.4625048041343689
loss_pred:0.023389026522636414, decouple_loss:0.0049687703140079975
The generated pressure mean: 0.4661675691604614
loss_pred:0.024414654821157455, decouple_loss:0.00514384638518095
Iteration: 4475, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479368031024933
loss_pred:0.022281598299741745, decouple_loss:0.006254636216908693
The generated pressure mean: 0.4388972818851471
loss_pred:0.023470159620046616, decouple_loss:0.006305122282356024
The generated pressure mean: 0.4458262324333191
loss_pred:0.02175011672079563, decouple_loss:0.006322037428617477
Iteration: 4476, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44218501448631287
loss_pred:0.022949043661355972, decouple_loss:0.004506920929998159
The generated pressure mean: 0.4388124346733093
loss_pred:0.021995700895786285, decouple_loss:0.0045919171534478664
The generated pressure mean: 0.4398985505104065
loss_pred:0.02256757766008377, decouple_loss:0.0044466592371463776
Iteration: 4477, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44613200426101685
loss_pred:0.024049660190939903, decouple_loss:0.005548843648284674
The generated pressure mean: 0.44538190960884094
loss_pred:0.024331646040081978, decouple_loss:0.0053625889122486115
The generated pressure mean: 0.4367213845252991
loss_pred:0.022801486775279045, decouple_loss:0.005509347189217806
Iteration: 4478, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45837295055389404
loss_pred:0.023381071165204048, decouple_loss:0.005782891996204853
The generated pressure mean: 0.44944876432418823
loss_pred:0.023088667541742325, decouple_loss:0.0056912582367658615
The generated pressure mean: 0.45850318670272827
loss_pred:0.02268817462027073, decouple_loss:0.005792994983494282
Iteration: 4479, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4456157684326172
loss_pred:0.02266518957912922, decouple_loss:0.005592385306954384
The generated pressure mean: 0.4551076591014862
loss_pred:0.022635431960225105, decouple_loss:0.005573377013206482
The generated pressure mean: 0.44894060492515564
loss_pred:0.023974591866135597, decouple_loss:0.005622550379484892
Iteration: 4480, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43461498618125916
loss_pred:0.022553952410817146, decouple_loss:0.005383639596402645
The generated pressure mean: 0.43232303857803345
loss_pred:0.022706931456923485, decouple_loss:0.005525118205696344
The generated pressure mean: 0.4293563663959503
loss_pred:0.024516742676496506, decouple_loss:0.005450412631034851
2023-04-17 04:50:34 testing...
The generated pressure mean: 0.42202216386795044
The generated pressure mean: 0.4128776490688324
The generated pressure mean: 0.42500558495521545
loss_pred:0.03525781258940697, decouple_loss:0.006737543735653162
loss_pred:0.03652158007025719, decouple_loss:0.006373687647283077
loss_pred:0.03495964780449867, decouple_loss:0.006886179093271494
WV_0_PC_0_EH_1_PS_40, loss: 0.03591297194361687, avg_mse: 0.0518290139734745
current test mse: 0.051829
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 4481, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4562312066555023
loss_pred:0.02187783271074295, decouple_loss:0.0056139216758310795
The generated pressure mean: 0.4575740098953247
loss_pred:0.022592561319470406, decouple_loss:0.005712432786822319
The generated pressure mean: 0.45599299669265747
loss_pred:0.0210235808044672, decouple_loss:0.0056200167164206505
Iteration: 4482, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4604378044605255
The generated pressure mean: 0.45262864232063293
loss_pred:0.022762270644307137, decouple_loss:0.006312679033726454
loss_pred:0.02210475690662861, decouple_loss:0.006261769682168961
The generated pressure mean: 0.4516623318195343
loss_pred:0.022070778533816338, decouple_loss:0.006055871024727821
Iteration: 4483, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44024330377578735
loss_pred:0.022049983963370323, decouple_loss:0.004871150013059378
The generated pressure mean: 0.4401058256626129
loss_pred:0.022048020735383034, decouple_loss:0.004881577100604773
The generated pressure mean: 0.4371338188648224
loss_pred:0.021235426887869835, decouple_loss:0.004884319379925728
Iteration: 4484, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44677889347076416
loss_pred:0.022409144788980484, decouple_loss:0.005628847051411867
The generated pressure mean: 0.44733813405036926
loss_pred:0.021574119105935097, decouple_loss:0.0053564817644655704
The generated pressure mean: 0.4476067125797272
loss_pred:0.022981438785791397, decouple_loss:0.005435123108327389
Iteration: 4485, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46040552854537964
loss_pred:0.022817067801952362, decouple_loss:0.005304018501192331
The generated pressure mean: 0.45875564217567444
loss_pred:0.02304021455347538, decouple_loss:0.005217403173446655
The generated pressure mean: 0.45666438341140747
loss_pred:0.023253707215189934, decouple_loss:0.005059875547885895
Iteration: 4486, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.433681845664978
loss_pred:0.020885799080133438, decouple_loss:0.004960532765835524
The generated pressure mean: 0.4319852888584137
loss_pred:0.024517320096492767, decouple_loss:0.004965413827449083
The generated pressure mean: 0.4320117235183716
loss_pred:0.021650303155183792, decouple_loss:0.004871613811701536
Iteration: 4487, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44430121779441833
loss_pred:0.023033490404486656, decouple_loss:0.006123888306319714
The generated pressure mean: 0.4420159161090851
loss_pred:0.021648850291967392, decouple_loss:0.005807281471788883
The generated pressure mean: 0.44004252552986145
loss_pred:0.022881148383021355, decouple_loss:0.006120861042290926
Iteration: 4488, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45018258690834045
The generated pressure mean: 0.4538102149963379
loss_pred:0.023473896086215973, decouple_loss:0.004848341923207045
loss_pred:0.02424797974526882, decouple_loss:0.004846019670367241
The generated pressure mean: 0.44937190413475037
loss_pred:0.022021153941750526, decouple_loss:0.0048513151705265045
Iteration: 4489, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4537704586982727
loss_pred:0.02279391512274742, decouple_loss:0.005368283484131098
The generated pressure mean: 0.45570889115333557
loss_pred:0.0231322068721056, decouple_loss:0.005513784009963274
The generated pressure mean: 0.44981515407562256
loss_pred:0.021434487774968147, decouple_loss:0.005860299803316593
Iteration: 4490, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485466778278351The generated pressure mean: 0.4544993042945862
loss_pred:0.02229415439069271, decouple_loss:0.005466779228299856loss_pred:0.024353651329874992, decouple_loss:0.005543037783354521
The generated pressure mean: 0.45649057626724243
loss_pred:0.022854067385196686, decouple_loss:0.005565689876675606
2023-04-17 04:53:00 testing...
The generated pressure mean: 0.42193347215652466
The generated pressure mean: 0.4300161898136139
loss_pred:0.03550514578819275, decouple_loss:0.006431564688682556
The generated pressure mean: 0.43244290351867676
loss_pred:0.034522462636232376, decouple_loss:0.006751285400241613
loss_pred:0.034170232713222504, decouple_loss:0.0069291130639612675
WV_0_PC_0_EH_1_PS_40, loss: 0.035067811608314514, avg_mse: 0.049395233392715454
current test mse: 0.049395
Iteration: 4491, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.41314199566841125
loss_pred:0.024003751575946808, decouple_loss:0.005787225440144539
The generated pressure mean: 0.42044126987457275
loss_pred:0.022097287699580193, decouple_loss:0.0057210056111216545
The generated pressure mean: 0.41907998919487
loss_pred:0.02385939657688141, decouple_loss:0.005751980468630791
Iteration: 4492, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46254652738571167
loss_pred:0.022540109232068062, decouple_loss:0.005632135085761547
The generated pressure mean: 0.4605003297328949
loss_pred:0.022694097831845284, decouple_loss:0.005710188299417496
The generated pressure mean: 0.457680344581604
loss_pred:0.024498188868165016, decouple_loss:0.005917672999203205
Iteration: 4493, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46890950202941895
loss_pred:0.021206943318247795, decouple_loss:0.004500259179621935
The generated pressure mean: 0.4769887924194336
loss_pred:0.021313976496458054, decouple_loss:0.0044817738234996796
The generated pressure mean: 0.47394898533821106
loss_pred:0.024150963872671127, decouple_loss:0.004759620875120163
Iteration: 4494, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4364404082298279
The generated pressure mean: 0.43717026710510254
loss_pred:0.022527562454342842, decouple_loss:0.005729647818952799
loss_pred:0.02097950503230095, decouple_loss:0.005494344513863325
The generated pressure mean: 0.4360814094543457
loss_pred:0.022541936486959457, decouple_loss:0.005640307441353798
Iteration: 4495, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.421105295419693
loss_pred:0.0211982149630785, decouple_loss:0.0057582310400903225
The generated pressure mean: 0.42943722009658813
loss_pred:0.02259998954832554, decouple_loss:0.005472532939165831
The generated pressure mean: 0.42608359456062317
loss_pred:0.022507362067699432, decouple_loss:0.005596259608864784
Iteration: 4496, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4547441899776459
loss_pred:0.02365204319357872, decouple_loss:0.005733479745686054
The generated pressure mean: 0.456891804933548
loss_pred:0.02301744371652603, decouple_loss:0.005829337984323502
The generated pressure mean: 0.4547237157821655
loss_pred:0.02180192805826664, decouple_loss:0.005641065072268248
Iteration: 4497, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497288763523102
loss_pred:0.023854564875364304, decouple_loss:0.0055182743817567825
The generated pressure mean: 0.452951043844223
loss_pred:0.023154260590672493, decouple_loss:0.005574625451117754
The generated pressure mean: 0.4525502026081085
loss_pred:0.022206155583262444, decouple_loss:0.0055524008348584175
Iteration: 4498, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504822790622711
loss_pred:0.02277110330760479, decouple_loss:0.005861151497811079
The generated pressure mean: 0.44760820269584656
loss_pred:0.02330080047249794, decouple_loss:0.005938742775470018
The generated pressure mean: 0.44889864325523376
loss_pred:0.021893586963415146, decouple_loss:0.005763384513556957
Iteration: 4499, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4415037930011749
loss_pred:0.024752778932452202, decouple_loss:0.005739680025726557
The generated pressure mean: 0.4382456839084625
loss_pred:0.023826291784644127, decouple_loss:0.005675859749317169
The generated pressure mean: 0.4457547068595886
loss_pred:0.021391818299889565, decouple_loss:0.005447303410619497
Iteration: 4500, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45209023356437683
loss_pred:0.021113600581884384, decouple_loss:0.004472637083381414
The generated pressure mean: 0.4512801468372345
loss_pred:0.022198885679244995, decouple_loss:0.004613556433469057
The generated pressure mean: 0.4538159668445587
loss_pred:0.024059142917394638, decouple_loss:0.004736032336950302
2023-04-17 04:54:53 testing...
The generated pressure mean: 0.4147029221057892
The generated pressure mean: 0.42272114753723145
The generated pressure mean: 0.4255399703979492
loss_pred:0.035869475454092026, decouple_loss:0.006710920948535204
loss_pred:0.03467598184943199, decouple_loss:0.007056000642478466
loss_pred:0.03434183448553085, decouple_loss:0.007327266037464142
WV_0_PC_0_EH_1_PS_40, loss: 0.03531400114297867, avg_mse: 0.050130683928728104
current test mse: 0.050131
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 4501, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472082257270813
loss_pred:0.023038338869810104, decouple_loss:0.005976849235594273
The generated pressure mean: 0.4570099711418152
loss_pred:0.023240074515342712, decouple_loss:0.0060011218301951885The generated pressure mean: 0.4531666338443756
loss_pred:0.022498082369565964, decouple_loss:0.006094994023442268
Iteration: 4502, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4284680187702179
loss_pred:0.02274920977652073, decouple_loss:0.005346798803657293
The generated pressure mean: 0.43087512254714966
loss_pred:0.022772500291466713, decouple_loss:0.005754318553954363
The generated pressure mean: 0.42871078848838806
loss_pred:0.021982813253998756, decouple_loss:0.0055252970196306705
Iteration: 4503, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45664918422698975
loss_pred:0.0211808942258358, decouple_loss:0.004703938029706478
The generated pressure mean: 0.4589252769947052
loss_pred:0.021201172843575478, decouple_loss:0.004712539725005627
The generated pressure mean: 0.4548521339893341
loss_pred:0.02165386825799942, decouple_loss:0.0048883892595767975
Iteration: 4504, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4538285434246063
loss_pred:0.02200951613485813, decouple_loss:0.005363775417208672
The generated pressure mean: 0.45552748441696167
loss_pred:0.02379619888961315, decouple_loss:0.005039604380726814
The generated pressure mean: 0.45296427607536316
loss_pred:0.02266019769012928, decouple_loss:0.005138180684298277
Iteration: 4505, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42215901613235474
loss_pred:0.02185641974210739, decouple_loss:0.00503308791667223
The generated pressure mean: 0.414642870426178
loss_pred:0.02337821014225483, decouple_loss:0.0049856556579470634
The generated pressure mean: 0.41794681549072266
loss_pred:0.023462334647774696, decouple_loss:0.0048575131222605705
Iteration: 4506, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4525112211704254
loss_pred:0.022636450827121735, decouple_loss:0.00509318383410573
The generated pressure mean: 0.45202314853668213
loss_pred:0.021758899092674255, decouple_loss:0.005100607872009277
The generated pressure mean: 0.4513186514377594
loss_pred:0.021937590092420578, decouple_loss:0.005456666927784681
Iteration: 4507, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4751192033290863
loss_pred:0.023611238226294518, decouple_loss:0.005688938312232494
The generated pressure mean: 0.4740326404571533
loss_pred:0.024993358179926872, decouple_loss:0.0059279100969433784
The generated pressure mean: 0.47506535053253174
loss_pred:0.021326493471860886, decouple_loss:0.005571384914219379
Iteration: 4508, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43769413232803345
loss_pred:0.02330099418759346, decouple_loss:0.005549215245991945
The generated pressure mean: 0.4380113184452057
loss_pred:0.023085182532668114, decouple_loss:0.005618186667561531
The generated pressure mean: 0.43378275632858276
loss_pred:0.02304036356508732, decouple_loss:0.005516409873962402
Iteration: 4509, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4404943287372589
loss_pred:0.02282695844769478, decouple_loss:0.006292744539678097
The generated pressure mean: 0.4467311501502991
loss_pred:0.02212292142212391, decouple_loss:0.0062265596352517605
The generated pressure mean: 0.4432319700717926
loss_pred:0.02335561439394951, decouple_loss:0.006339178886264563
Iteration: 4510, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44736745953559875
loss_pred:0.024632005020976067, decouple_loss:0.005791392643004656
The generated pressure mean: 0.4469718039035797
loss_pred:0.02281283400952816, decouple_loss:0.006048283539712429
The generated pressure mean: 0.4506514370441437
loss_pred:0.02409117855131626, decouple_loss:0.00602230429649353
2023-04-17 04:57:18 testing...
The generated pressure mean: 0.41919684410095215
The generated pressure mean: 0.4266897737979889
The generated pressure mean: 0.4291287660598755
loss_pred:0.035865020006895065, decouple_loss:0.006589566357433796
loss_pred:0.034896012395620346, decouple_loss:0.006963199470192194
loss_pred:0.03478865697979927, decouple_loss:0.007250986061990261
WV_0_PC_0_EH_1_PS_40, loss: 0.035529956221580505, avg_mse: 0.05011283606290817
current test mse: 0.050113
Iteration: 4511, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43307408690452576
loss_pred:0.02325625531375408, decouple_loss:0.005886127706617117
The generated pressure mean: 0.4319364130496979
loss_pred:0.021916275843977928, decouple_loss:0.005605363752692938
The generated pressure mean: 0.432190477848053
loss_pred:0.02238965965807438, decouple_loss:0.006023609545081854
Iteration: 4512, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45330822467803955
loss_pred:0.022955358028411865, decouple_loss:0.0064850905910134315
The generated pressure mean: 0.4469464421272278
loss_pred:0.023210076615214348, decouple_loss:0.00637115677818656
The generated pressure mean: 0.453607439994812
loss_pred:0.025344548746943474, decouple_loss:0.0064270226284861565
Iteration: 4513, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4634000360965729
loss_pred:0.021597353741526604, decouple_loss:0.0055407271720469
The generated pressure mean: 0.4581536650657654
loss_pred:0.02201697789132595, decouple_loss:0.005397327244281769
The generated pressure mean: 0.46130242943763733
loss_pred:0.022000188007950783, decouple_loss:0.005453676450997591
Iteration: 4514, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44278568029403687
loss_pred:0.022419622167944908, decouple_loss:0.006860262248665094
The generated pressure mean: 0.4433620870113373
loss_pred:0.022004127502441406, decouple_loss:0.006513525731861591
The generated pressure mean: 0.4471816420555115
loss_pred:0.021885238587856293, decouple_loss:0.006830739788711071
Iteration: 4515, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4417254626750946
loss_pred:0.02296493388712406, decouple_loss:0.006223384290933609
The generated pressure mean: 0.43500879406929016
loss_pred:0.02273022010922432, decouple_loss:0.006336976774036884
The generated pressure mean: 0.43815332651138306
loss_pred:0.02355043776333332, decouple_loss:0.006084542255848646
Iteration: 4516, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.456417441368103
loss_pred:0.02361459471285343, decouple_loss:0.006029514595866203
The generated pressure mean: 0.45568254590034485
loss_pred:0.022965174168348312, decouple_loss:0.006063994951546192
The generated pressure mean: 0.4547942280769348
loss_pred:0.022677557542920113, decouple_loss:0.006255966145545244
Iteration: 4517, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4512525498867035
loss_pred:0.020595580339431763, decouple_loss:0.006874957587569952
The generated pressure mean: 0.45286205410957336
loss_pred:0.022219356149435043, decouple_loss:0.006746406201273203
The generated pressure mean: 0.45393359661102295
loss_pred:0.020538700744509697, decouple_loss:0.006931298412382603
Iteration: 4518, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.441417932510376
loss_pred:0.02266540750861168, decouple_loss:0.00652955612167716
The generated pressure mean: 0.4445105493068695
loss_pred:0.023862482979893684, decouple_loss:0.006546473130583763
The generated pressure mean: 0.443388432264328
loss_pred:0.022699126973748207, decouple_loss:0.006460961885750294
Iteration: 4519, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4353732168674469
loss_pred:0.022514505311846733, decouple_loss:0.006692918948829174
The generated pressure mean: 0.44251397252082825
loss_pred:0.02070033736526966, decouple_loss:0.007090101018548012
The generated pressure mean: 0.43444693088531494
loss_pred:0.02173171564936638, decouple_loss:0.0070737432688474655
Iteration: 4520, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45628005266189575
loss_pred:0.021758781746029854, decouple_loss:0.006026031915098429
The generated pressure mean: 0.44497737288475037
loss_pred:0.022216035053133965, decouple_loss:0.006191094871610403
The generated pressure mean: 0.4481789469718933
loss_pred:0.02123904973268509, decouple_loss:0.0061628068797290325
2023-04-17 04:59:11 testing...
The generated pressure mean: 0.41139188408851624
The generated pressure mean: 0.4196133315563202
The generated pressure mean: 0.42214831709861755
loss_pred:0.03734959289431572, decouple_loss:0.00836711935698986
loss_pred:0.035720549523830414, decouple_loss:0.008682731539011002
loss_pred:0.03539969027042389, decouple_loss:0.008732862770557404
WV_0_PC_0_EH_1_PS_40, loss: 0.036586325615644455, avg_mse: 0.05244055762887001
current test mse: 0.052441
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 4521, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46182215213775635
loss_pred:0.027745507657527924, decouple_loss:0.007872458547353745
The generated pressure mean: 0.46000969409942627
loss_pred:0.022971313446760178, decouple_loss:0.007691910490393639
The generated pressure mean: 0.46353375911712646
loss_pred:0.024203576147556305, decouple_loss:0.00791596807539463
Iteration: 4522, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4234086275100708
The generated pressure mean: 0.4295234680175781
loss_pred:0.023767393082380295, decouple_loss:0.005410510580986738
loss_pred:0.024940695613622665, decouple_loss:0.005555332638323307
The generated pressure mean: 0.4250449538230896
loss_pred:0.027686862275004387, decouple_loss:0.00550578348338604
Iteration: 4523, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502410292625427
loss_pred:0.02501274272799492, decouple_loss:0.008294348604977131
The generated pressure mean: 0.441977858543396
loss_pred:0.023265531286597252, decouple_loss:0.00854623131453991
The generated pressure mean: 0.442571759223938
loss_pred:0.024802811443805695, decouple_loss:0.008799967356026173
Iteration: 4524, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46534451842308044
The generated pressure mean: 0.4633237421512604
loss_pred:0.027377810329198837, decouple_loss:0.0064423056319355965
loss_pred:0.023817723616957664, decouple_loss:0.006217931397259235
The generated pressure mean: 0.46422216296195984
loss_pred:0.02382965385913849, decouple_loss:0.006244744174182415
Iteration: 4525, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4380428194999695The generated pressure mean: 0.43547677993774414
loss_pred:0.02321065030992031, decouple_loss:0.00886508822441101
loss_pred:0.022080516442656517, decouple_loss:0.009040464647114277
The generated pressure mean: 0.4373144209384918
loss_pred:0.024576643481850624, decouple_loss:0.008971244096755981
Iteration: 4526, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44112902879714966
The generated pressure mean: 0.43993204832077026
loss_pred:0.02220364473760128, decouple_loss:0.006944635417312384
loss_pred:0.023762717843055725, decouple_loss:0.007093991618603468
The generated pressure mean: 0.4405534267425537
loss_pred:0.023113572970032692, decouple_loss:0.006811830215156078
Iteration: 4527, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4615820646286011
The generated pressure mean: 0.4650478661060333
loss_pred:0.022766025736927986, decouple_loss:0.00734004657715559
loss_pred:0.023594005033373833, decouple_loss:0.007495382335036993
The generated pressure mean: 0.4663698971271515
loss_pred:0.022845759987831116, decouple_loss:0.007430674508213997
Iteration: 4528, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45470520853996277
loss_pred:0.02323918789625168, decouple_loss:0.0065809073857963085
The generated pressure mean: 0.4546290636062622
loss_pred:0.023468269035220146, decouple_loss:0.006794353481382132
The generated pressure mean: 0.45461130142211914
loss_pred:0.02474343217909336, decouple_loss:0.006433260161429644
Iteration: 4529, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4392469525337219
The generated pressure mean: 0.4325404465198517
loss_pred:0.02450781874358654, decouple_loss:0.007355696056038141
loss_pred:0.02469784952700138, decouple_loss:0.007184702903032303
The generated pressure mean: 0.4319913685321808
loss_pred:0.022518688812851906, decouple_loss:0.007472882512956858
Iteration: 4530, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4378366470336914
loss_pred:0.0241115540266037, decouple_loss:0.0063331518322229385
The generated pressure mean: 0.4377291202545166
loss_pred:0.023015154525637627, decouple_loss:0.006390837486833334
The generated pressure mean: 0.4348372519016266
loss_pred:0.0238181184977293, decouple_loss:0.006161988712847233
2023-04-17 05:01:36 testing...
The generated pressure mean: 0.41121673583984375
The generated pressure mean: 0.41867461800575256
loss_pred:0.03693506494164467, decouple_loss:0.0075973328202962875
The generated pressure mean: 0.4207563102245331
loss_pred:0.035865966230630875, decouple_loss:0.007800595369189978
loss_pred:0.03543654829263687, decouple_loss:0.008069870062172413
WV_0_PC_0_EH_1_PS_40, loss: 0.03647032380104065, avg_mse: 0.05185512825846672
current test mse: 0.051855
Iteration: 4531, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4628385901451111
loss_pred:0.024191778153181076, decouple_loss:0.006679899990558624
The generated pressure mean: 0.4622636139392853
loss_pred:0.022992508485913277, decouple_loss:0.006679046433418989
The generated pressure mean: 0.462822288274765
loss_pred:0.02422172762453556, decouple_loss:0.006752138026058674
Iteration: 4532, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45938125252723694
The generated pressure mean: 0.45926108956336975
loss_pred:0.024175241589546204, decouple_loss:0.006233182270079851
loss_pred:0.02423441782593727, decouple_loss:0.006082484498620033
The generated pressure mean: 0.4601629078388214
loss_pred:0.02245180867612362, decouple_loss:0.006018190179020166
Iteration: 4533, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43143224716186523
loss_pred:0.024695072323083878, decouple_loss:0.007251042872667313
The generated pressure mean: 0.43196338415145874
loss_pred:0.024279698729515076, decouple_loss:0.007172462530434132
The generated pressure mean: 0.4352705776691437
loss_pred:0.024209506809711456, decouple_loss:0.007196694612503052
Iteration: 4534, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4417300224304199
loss_pred:0.023098144680261612, decouple_loss:0.005377723835408688
The generated pressure mean: 0.44272172451019287
loss_pred:0.02482053078711033, decouple_loss:0.005565237253904343
The generated pressure mean: 0.44027382135391235
loss_pred:0.021669872105121613, decouple_loss:0.005343717522919178
Iteration: 4535, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507029950618744
loss_pred:0.02441789023578167, decouple_loss:0.006917142774909735
The generated pressure mean: 0.4494260847568512
loss_pred:0.02402656525373459, decouple_loss:0.006740105804055929
The generated pressure mean: 0.44947540760040283
loss_pred:0.024539340287446976, decouple_loss:0.007207851856946945
Iteration: 4536, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4535837173461914
loss_pred:0.026097029447555542, decouple_loss:0.005802996456623077
The generated pressure mean: 0.45505398511886597
loss_pred:0.02450348436832428, decouple_loss:0.005691103171557188
The generated pressure mean: 0.45360779762268066
loss_pred:0.024013636633753777, decouple_loss:0.005664623808115721
Iteration: 4537, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460681974887848
loss_pred:0.02206507883965969, decouple_loss:0.0065401410683989525
The generated pressure mean: 0.45063626766204834
loss_pred:0.023182276636362076, decouple_loss:0.0063734292052686214
The generated pressure mean: 0.4491230845451355
loss_pred:0.023749005049467087, decouple_loss:0.006628908216953278
Iteration: 4538, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.441496342420578
loss_pred:0.021806158125400543, decouple_loss:0.007289783097803593
The generated pressure mean: 0.4420456290245056
loss_pred:0.024240078404545784, decouple_loss:0.007461617235094309
The generated pressure mean: 0.4408389627933502
loss_pred:0.02292434312403202, decouple_loss:0.0073610213585197926
Iteration: 4539, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44544318318367004
loss_pred:0.0218918826431036, decouple_loss:0.006076888646930456
The generated pressure mean: 0.44138938188552856
loss_pred:0.022065110504627228, decouple_loss:0.0062517742626369
The generated pressure mean: 0.44606083631515503
loss_pred:0.02340509369969368, decouple_loss:0.006203313358128071
Iteration: 4540, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4566958248615265
loss_pred:0.024027341976761818, decouple_loss:0.0074038440361619
The generated pressure mean: 0.4599913954734802
loss_pred:0.02355084754526615, decouple_loss:0.007591106463223696
The generated pressure mean: 0.4595882296562195
loss_pred:0.02414492703974247, decouple_loss:0.007678814232349396
2023-04-17 05:03:29 testing...
The generated pressure mean: 0.42242833971977234
The generated pressure mean: 0.414584219455719
The generated pressure mean: 0.4250463843345642
loss_pred:0.03400922194123268, decouple_loss:0.007659534458070993
loss_pred:0.03535139188170433, decouple_loss:0.007430024910718203
loss_pred:0.033730365335941315, decouple_loss:0.00783891323953867
WV_0_PC_0_EH_1_PS_40, loss: 0.034745801240205765, avg_mse: 0.04875646531581879
current test mse: 0.048756
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 4541, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4433198869228363
loss_pred:0.021304765716195107, decouple_loss:0.006431239657104015
The generated pressure mean: 0.4413152039051056
The generated pressure mean: 0.4526928663253784
loss_pred:0.022599656134843826, decouple_loss:0.0066350786946713924
loss_pred:0.023456577211618423, decouple_loss:0.006568968296051025
Iteration: 4542, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44419899582862854The generated pressure mean: 0.4437847435474396
loss_pred:0.022168634459376335, decouple_loss:0.007845209911465645
loss_pred:0.021760061383247375, decouple_loss:0.007294550072401762
The generated pressure mean: 0.44153082370758057
loss_pred:0.022499363869428635, decouple_loss:0.0074422420002520084
Iteration: 4543, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4440520405769348
The generated pressure mean: 0.45231935381889343loss_pred:0.022042589262127876, decouple_loss:0.007682311814278364
loss_pred:0.022577742114663124, decouple_loss:0.00784795917570591
The generated pressure mean: 0.4476865231990814
loss_pred:0.021679192781448364, decouple_loss:0.007866906002163887
Iteration: 4544, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45500150322914124
loss_pred:0.022597545757889748, decouple_loss:0.006459622643887997
The generated pressure mean: 0.4572795629501343
loss_pred:0.022134721279144287, decouple_loss:0.006624695844948292
The generated pressure mean: 0.4530368447303772
loss_pred:0.023368805646896362, decouple_loss:0.0066170403733849525
Iteration: 4545, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4445349872112274
loss_pred:0.02241787314414978, decouple_loss:0.007158062420785427
The generated pressure mean: 0.449065625667572
loss_pred:0.02416333556175232, decouple_loss:0.007446160539984703
The generated pressure mean: 0.44684988260269165
loss_pred:0.02355736307799816, decouple_loss:0.0074135842733085155
Iteration: 4546, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44240236282348633
loss_pred:0.022035324946045876, decouple_loss:0.00678753899410367
The generated pressure mean: 0.4391564130783081
loss_pred:0.022512435913085938, decouple_loss:0.006763339042663574
The generated pressure mean: 0.4365748167037964
loss_pred:0.02296815812587738, decouple_loss:0.006693163886666298
Iteration: 4547, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4521622359752655
loss_pred:0.02253153920173645, decouple_loss:0.006828729063272476
The generated pressure mean: 0.4465644955635071
loss_pred:0.021688301116228104, decouple_loss:0.006831808015704155
The generated pressure mean: 0.44996872544288635
loss_pred:0.02281043864786625, decouple_loss:0.006987921427935362
Iteration: 4548, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4573289453983307
loss_pred:0.021977070719003677, decouple_loss:0.006247594952583313
The generated pressure mean: 0.45326849818229675
loss_pred:0.023181969299912453, decouple_loss:0.00612677400931716
The generated pressure mean: 0.4567496180534363
loss_pred:0.024126749485731125, decouple_loss:0.006326690316200256
Iteration: 4549, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497019648551941
loss_pred:0.0227730181068182, decouple_loss:0.00674035120755434
The generated pressure mean: 0.4490576982498169
loss_pred:0.02235936000943184, decouple_loss:0.006627329159528017
The generated pressure mean: 0.4506872296333313
loss_pred:0.02313341200351715, decouple_loss:0.006691500078886747
Iteration: 4550, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4406840205192566
loss_pred:0.023519551381468773, decouple_loss:0.005265770945698023
The generated pressure mean: 0.4373616874217987
loss_pred:0.02288748510181904, decouple_loss:0.005559020210057497
The generated pressure mean: 0.43220055103302
loss_pred:0.022371960803866386, decouple_loss:0.005161497741937637
2023-04-17 05:06:04 testing...
The generated pressure mean: 0.41481828689575195
The generated pressure mean: 0.4229808747768402
loss_pred:0.03521623834967613, decouple_loss:0.008371733129024506
The generated pressure mean: 0.4253813922405243
loss_pred:0.033899031579494476, decouple_loss:0.008612996898591518
loss_pred:0.033818624913692474, decouple_loss:0.008857393637299538
WV_0_PC_0_EH_1_PS_40, loss: 0.034742001444101334, avg_mse: 0.04886699840426445
current test mse: 0.048867
Iteration: 4551, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45704343914985657The generated pressure mean: 0.45575618743896484
loss_pred:0.021796055138111115, decouple_loss:0.007749142125248909
loss_pred:0.02184874936938286, decouple_loss:0.007909074425697327
The generated pressure mean: 0.4540683329105377
loss_pred:0.02236814983189106, decouple_loss:0.007938375696539879
Iteration: 4552, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448001891374588
The generated pressure mean: 0.45304062962532043
loss_pred:0.022556129842996597, decouple_loss:0.005614776164293289
loss_pred:0.023369843140244484, decouple_loss:0.005570146255195141
The generated pressure mean: 0.45554620027542114
loss_pred:0.021819984540343285, decouple_loss:0.005708829965442419
Iteration: 4553, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4426743686199188
The generated pressure mean: 0.4422469437122345
loss_pred:0.02292763441801071, decouple_loss:0.009149146266281605
loss_pred:0.02178248018026352, decouple_loss:0.009038886986672878
The generated pressure mean: 0.43712809681892395
loss_pred:0.022391699254512787, decouple_loss:0.009051606990396976
Iteration: 4554, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4540473222732544
The generated pressure mean: 0.45127058029174805
loss_pred:0.022157451137900352, decouple_loss:0.005945518612861633
loss_pred:0.02275674417614937, decouple_loss:0.005785094574093819
The generated pressure mean: 0.4552054703235626
loss_pred:0.023437276482582092, decouple_loss:0.005869988352060318
Iteration: 4555, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499359130859375
The generated pressure mean: 0.4449746608734131
loss_pred:0.02271108888089657, decouple_loss:0.009580127894878387
loss_pred:0.023305242881178856, decouple_loss:0.009732488542795181
The generated pressure mean: 0.4499787390232086
loss_pred:0.022615190595388412, decouple_loss:0.009666064754128456
Iteration: 4556, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43993040919303894
The generated pressure mean: 0.4446423649787903
loss_pred:0.02279817685484886, decouple_loss:0.006775811314582825
loss_pred:0.022534966468811035, decouple_loss:0.006844677496701479
The generated pressure mean: 0.4442354738712311
loss_pred:0.022574130445718765, decouple_loss:0.00671008788049221
Iteration: 4557, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4547145962715149
loss_pred:0.022252267226576805, decouple_loss:0.009723632596433163
The generated pressure mean: 0.45113465189933777
loss_pred:0.022012626752257347, decouple_loss:0.010083486326038837
The generated pressure mean: 0.4532216787338257
loss_pred:0.02241227962076664, decouple_loss:0.009719422087073326
Iteration: 4558, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45631173253059387
loss_pred:0.02300970070064068, decouple_loss:0.005875093396753073
The generated pressure mean: 0.456293523311615
loss_pred:0.02394769713282585, decouple_loss:0.005875371862202883
The generated pressure mean: 0.45173966884613037
loss_pred:0.02287711203098297, decouple_loss:0.0057597048580646515
Iteration: 4559, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479294717311859
loss_pred:0.021808281540870667, decouple_loss:0.009851626120507717
The generated pressure mean: 0.44270211458206177
loss_pred:0.02292535826563835, decouple_loss:0.010230679996311665
The generated pressure mean: 0.44329288601875305
loss_pred:0.02360362745821476, decouple_loss:0.010084127075970173
Iteration: 4560, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.458529531955719
loss_pred:0.024594459682703018, decouple_loss:0.006154597736895084
The generated pressure mean: 0.4563162624835968
loss_pred:0.0235920250415802, decouple_loss:0.006049966439604759
The generated pressure mean: 0.44985127449035645
loss_pred:0.023270150646567345, decouple_loss:0.006306408904492855
2023-04-17 05:07:57 testing...
The generated pressure mean: 0.4215241074562073
The generated pressure mean: 0.42900797724723816
The generated pressure mean: 0.43141666054725647
loss_pred:0.0348806269466877, decouple_loss:0.009813020937144756
loss_pred:0.03378387168049812, decouple_loss:0.010215740650892258
loss_pred:0.0338708758354187, decouple_loss:0.010356642305850983
WV_0_PC_0_EH_1_PS_40, loss: 0.03468488156795502, avg_mse: 0.04844110459089279
current test mse: 0.048441
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 4561, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42854076623916626
loss_pred:0.022980328649282455, decouple_loss:0.009533196687698364
The generated pressure mean: 0.4277569353580475
loss_pred:0.022942904382944107, decouple_loss:0.009613597765564919
The generated pressure mean: 0.42477118968963623
loss_pred:0.023375002667307854, decouple_loss:0.009313744492828846
Iteration: 4562, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4543828070163727The generated pressure mean: 0.45727667212486267
loss_pred:0.022091351449489594, decouple_loss:0.007695894688367844
loss_pred:0.02304236963391304, decouple_loss:0.007644998840987682
The generated pressure mean: 0.4515976011753082
loss_pred:0.023716092109680176, decouple_loss:0.007496376987546682
Iteration: 4563, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45988696813583374
The generated pressure mean: 0.4586828947067261
loss_pred:0.02250203676521778, decouple_loss:0.009832150302827358
loss_pred:0.021912766620516777, decouple_loss:0.009952272288501263
The generated pressure mean: 0.45898327231407166
loss_pred:0.02343733049929142, decouple_loss:0.009866257198154926
Iteration: 4564, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4430118203163147
The generated pressure mean: 0.43727630376815796
loss_pred:0.02287612110376358, decouple_loss:0.008878410793840885
loss_pred:0.022576557472348213, decouple_loss:0.00885915756225586
The generated pressure mean: 0.44413501024246216
loss_pred:0.022364091128110886, decouple_loss:0.008588340133428574
Iteration: 4565, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469453990459442
The generated pressure mean: 0.4467930197715759
loss_pred:0.023173034191131592, decouple_loss:0.008333618752658367
loss_pred:0.02182634174823761, decouple_loss:0.008423637598752975
The generated pressure mean: 0.44775235652923584
loss_pred:0.021946774795651436, decouple_loss:0.008352464064955711
Iteration: 4566, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4397912621498108
loss_pred:0.022353120148181915, decouple_loss:0.007179710082709789
The generated pressure mean: 0.4438352584838867
loss_pred:0.02300681360065937, decouple_loss:0.007233157753944397
The generated pressure mean: 0.4431118071079254
loss_pred:0.02170419506728649, decouple_loss:0.007742128800600767
Iteration: 4567, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4437427818775177
The generated pressure mean: 0.4383738934993744
loss_pred:0.021316315978765488, decouple_loss:0.00749166077002883
loss_pred:0.02298188954591751, decouple_loss:0.007864351384341717
The generated pressure mean: 0.44380074739456177
loss_pred:0.02125198021531105, decouple_loss:0.007456790655851364
Iteration: 4568, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45738473534584045
loss_pred:0.022610347718000412, decouple_loss:0.006915566511452198
The generated pressure mean: 0.45873740315437317
loss_pred:0.0222493764013052, decouple_loss:0.006957009434700012
The generated pressure mean: 0.4607379734516144
loss_pred:0.023949038237333298, decouple_loss:0.006647156085819006
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4569, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4575314223766327
The generated pressure mean: 0.45736122131347656
loss_pred:0.021829556673765182, decouple_loss:0.006928571965545416
loss_pred:0.022268900647759438, decouple_loss:0.006684102583676577
The generated pressure mean: 0.45560339093208313
loss_pred:0.021405184641480446, decouple_loss:0.006412656977772713
Iteration: 4570, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43634265661239624
loss_pred:0.023512059822678566, decouple_loss:0.005253211595118046
The generated pressure mean: 0.4312452971935272
loss_pred:0.023341046646237373, decouple_loss:0.005461503751575947
The generated pressure mean: 0.4334646463394165
loss_pred:0.022367354482412338, decouple_loss:0.0053705680184066296
2023-04-17 05:10:23 testing...
The generated pressure mean: 0.4180084466934204
The generated pressure mean: 0.4259190857410431
loss_pred:0.0338621623814106, decouple_loss:0.006323258858174086
The generated pressure mean: 0.4287032186985016
loss_pred:0.032787468284368515, decouple_loss:0.0067062173038721085
loss_pred:0.03237910568714142, decouple_loss:0.006875818595290184
WV_0_PC_0_EH_1_PS_40, loss: 0.03334133327007294, avg_mse: 0.046587876975536346
current test mse: 0.046588
Iteration: 4571, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44182878732681274
loss_pred:0.022035444155335426, decouple_loss:0.005848774220794439
The generated pressure mean: 0.43800467252731323
loss_pred:0.021397316828370094, decouple_loss:0.005793474148958921
The generated pressure mean: 0.4369191825389862
loss_pred:0.023149365559220314, decouple_loss:0.005478745326399803
Iteration: 4572, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45298120379447937
The generated pressure mean: 0.4498681426048279
loss_pred:0.02251313626766205, decouple_loss:0.004983826540410519
loss_pred:0.0220659077167511, decouple_loss:0.005102597642689943
The generated pressure mean: 0.45383498072624207
loss_pred:0.02330693043768406, decouple_loss:0.005306185223162174
Iteration: 4573, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44558942317962646
The generated pressure mean: 0.45049670338630676
loss_pred:0.02266615629196167, decouple_loss:0.005478583741933107
loss_pred:0.024419892579317093, decouple_loss:0.005230495240539312
The generated pressure mean: 0.44532305002212524
loss_pred:0.023163434118032455, decouple_loss:0.005246974993497133
Iteration: 4574, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4516412019729614
The generated pressure mean: 0.45086079835891724
loss_pred:0.02149643376469612, decouple_loss:0.005403466522693634
loss_pred:0.02336631342768669, decouple_loss:0.005816603545099497
The generated pressure mean: 0.4540694057941437
loss_pred:0.022855177521705627, decouple_loss:0.0057098823599517345
Iteration: 4575, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44424688816070557
The generated pressure mean: 0.44187453389167786
loss_pred:0.021259598433971405, decouple_loss:0.005675636697560549
loss_pred:0.023016849532723427, decouple_loss:0.0057626706548035145
The generated pressure mean: 0.43648776412010193
loss_pred:0.024719471111893654, decouple_loss:0.005618020426481962
Iteration: 4576, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43958941102027893
The generated pressure mean: 0.44224390387535095
loss_pred:0.02194548025727272, decouple_loss:0.004964576102793217
loss_pred:0.02244025468826294, decouple_loss:0.004908349830657244
The generated pressure mean: 0.4401901662349701
loss_pred:0.023174714297056198, decouple_loss:0.004935926292091608
Iteration: 4577, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4593732953071594
loss_pred:0.02191825583577156, decouple_loss:0.0047756885178387165
The generated pressure mean: 0.46105462312698364
loss_pred:0.02198956534266472, decouple_loss:0.004609781317412853
The generated pressure mean: 0.4565154016017914
loss_pred:0.02165241725742817, decouple_loss:0.004667030647397041
Iteration: 4578, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4538215100765228
The generated pressure mean: 0.4501149356365204
loss_pred:0.022480392828583717, decouple_loss:0.005044787656515837
loss_pred:0.021962396800518036, decouple_loss:0.005124328657984734
The generated pressure mean: 0.4559929072856903
loss_pred:0.02250366099178791, decouple_loss:0.004944482818245888
Iteration: 4579, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.430257111787796
loss_pred:0.021076006814837456, decouple_loss:0.005193582270294428
The generated pressure mean: 0.429452121257782
loss_pred:0.022404327988624573, decouple_loss:0.005319518037140369
The generated pressure mean: 0.4287761151790619
loss_pred:0.022893566638231277, decouple_loss:0.005351112224161625
Iteration: 4580, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44734129309654236
loss_pred:0.02100938931107521, decouple_loss:0.006850970443338156
The generated pressure mean: 0.45171329379081726
loss_pred:0.022078705951571465, decouple_loss:0.0067616598680615425
The generated pressure mean: 0.44779035449028015
loss_pred:0.021308280527591705, decouple_loss:0.006879549939185381
2023-04-17 05:12:16 testing...
The generated pressure mean: 0.4115583896636963
The generated pressure mean: 0.41874900460243225
The generated pressure mean: 0.42116525769233704
loss_pred:0.03532683476805687, decouple_loss:0.005707192700356245
loss_pred:0.034366674721241, decouple_loss:0.0061944592744112015
loss_pred:0.03400051221251488, decouple_loss:0.006357906851917505
WV_0_PC_0_EH_1_PS_40, loss: 0.0348690003156662, avg_mse: 0.049387671053409576
current test mse: 0.049388
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 4581, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45734795928001404
loss_pred:0.022963497787714005, decouple_loss:0.005073405336588621
The generated pressure mean: 0.4616711437702179
The generated pressure mean: 0.4602866470813751
loss_pred:0.023566987365484238, decouple_loss:0.00530764926224947
loss_pred:0.022077906876802444, decouple_loss:0.0052353572100400925
Iteration: 4582, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.445872962474823
The generated pressure mean: 0.44473814964294434
loss_pred:0.023205729201436043, decouple_loss:0.005503898952156305
loss_pred:0.022174576297402382, decouple_loss:0.005751713644713163
The generated pressure mean: 0.4463925063610077
loss_pred:0.022173291072249413, decouple_loss:0.005632036365568638
Iteration: 4583, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4348222017288208
loss_pred:0.022616762667894363, decouple_loss:0.004984688013792038
The generated pressure mean: 0.43877312541007996
loss_pred:0.022764358669519424, decouple_loss:0.004896725993603468
The generated pressure mean: 0.437345027923584
loss_pred:0.024052999913692474, decouple_loss:0.005121838767081499
Iteration: 4584, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504077434539795
loss_pred:0.021675167605280876, decouple_loss:0.005658971145749092
The generated pressure mean: 0.4504045248031616
loss_pred:0.02420237846672535, decouple_loss:0.005667508579790592
The generated pressure mean: 0.44489729404449463
loss_pred:0.022104419767856598, decouple_loss:0.0058768452145159245
Iteration: 4585, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44854283332824707
loss_pred:0.021778427064418793, decouple_loss:0.004506351426243782
The generated pressure mean: 0.45076924562454224
loss_pred:0.021680977195501328, decouple_loss:0.004475913476198912
The generated pressure mean: 0.44571879506111145
loss_pred:0.021298957988619804, decouple_loss:0.0046247681602835655
Iteration: 4586, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473693370819092
The generated pressure mean: 0.4450249671936035
loss_pred:0.022814320400357246, decouple_loss:0.00443961750715971
loss_pred:0.02467259019613266, decouple_loss:0.004627968184649944
The generated pressure mean: 0.45166224241256714
loss_pred:0.02143942005932331, decouple_loss:0.004533407744020224
Iteration: 4587, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44382765889167786
The generated pressure mean: 0.43868187069892883
loss_pred:0.02226322889328003, decouple_loss:0.00441012904047966
loss_pred:0.02127242647111416, decouple_loss:0.0042492663487792015
The generated pressure mean: 0.44376179575920105
loss_pred:0.021531105041503906, decouple_loss:0.004510021302849054
Iteration: 4588, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44316601753234863
The generated pressure mean: 0.44272419810295105
loss_pred:0.021174905821681023, decouple_loss:0.004851744044572115
loss_pred:0.022799955680966377, decouple_loss:0.0045381090603768826
The generated pressure mean: 0.4460184872150421
loss_pred:0.023168670013546944, decouple_loss:0.004644252825528383
Iteration: 4589, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45589566230773926
loss_pred:0.022495878860354424, decouple_loss:0.005056277848780155
The generated pressure mean: 0.45751166343688965
loss_pred:0.021965112537145615, decouple_loss:0.0053686280734837055
The generated pressure mean: 0.4567120373249054
loss_pred:0.021706273779273033, decouple_loss:0.005131913349032402
Iteration: 4590, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45657631754875183
loss_pred:0.02210511639714241, decouple_loss:0.005679791327565908
The generated pressure mean: 0.451673686504364
loss_pred:0.022691912949085236, decouple_loss:0.00548858568072319
The generated pressure mean: 0.45709022879600525
loss_pred:0.02219882793724537, decouple_loss:0.005411690566688776
2023-04-17 05:14:45 testing...
The generated pressure mean: 0.4176308512687683
The generated pressure mean: 0.4258270859718323
loss_pred:0.03405178338289261, decouple_loss:0.005528823472559452
The generated pressure mean: 0.4283379018306732
loss_pred:0.033028535544872284, decouple_loss:0.006055655423551798
loss_pred:0.033023592084646225, decouple_loss:0.006318180821835995
WV_0_PC_0_EH_1_PS_40, loss: 0.033666349947452545, avg_mse: 0.047449056059122086
current test mse: 0.047449
Iteration: 4591, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44028475880622864
loss_pred:0.022689543664455414, decouple_loss:0.005023890174925327
The generated pressure mean: 0.443461149930954
loss_pred:0.021606238558888435, decouple_loss:0.0047942292876541615
The generated pressure mean: 0.4393543303012848
loss_pred:0.021899431943893433, decouple_loss:0.0049210418947041035
Iteration: 4592, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4359091818332672
The generated pressure mean: 0.4342447519302368
loss_pred:0.022702984511852264, decouple_loss:0.0057583521120250225
loss_pred:0.02216511219739914, decouple_loss:0.005411276128143072
The generated pressure mean: 0.4392172396183014
loss_pred:0.022271597757935524, decouple_loss:0.005153942387551069
Iteration: 4593, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.453339546918869
The generated pressure mean: 0.4528637230396271
loss_pred:0.021564528346061707, decouple_loss:0.005289694759994745
loss_pred:0.022604547441005707, decouple_loss:0.005289548542350531
The generated pressure mean: 0.4539931118488312
loss_pred:0.022535478696227074, decouple_loss:0.005522480700165033
Iteration: 4594, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45645251870155334
The generated pressure mean: 0.4516157805919647
loss_pred:0.022480543702840805, decouple_loss:0.004954593256115913
loss_pred:0.021433882415294647, decouple_loss:0.0044597177766263485
The generated pressure mean: 0.4556388854980469
loss_pred:0.022706132382154465, decouple_loss:0.0045767128467559814
Iteration: 4595, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44249090552330017
The generated pressure mean: 0.43966445326805115
loss_pred:0.021434033289551735, decouple_loss:0.006001800764352083
loss_pred:0.021278327330946922, decouple_loss:0.005760997999459505
The generated pressure mean: 0.4391455352306366
loss_pred:0.023618916049599648, decouple_loss:0.005751045420765877
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4596, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45656320452690125
The generated pressure mean: 0.4521932899951935
loss_pred:0.02267121523618698, decouple_loss:0.004837747197598219
loss_pred:0.02220856212079525, decouple_loss:0.00497498270124197
The generated pressure mean: 0.4496992528438568
loss_pred:0.022071151062846184, decouple_loss:0.00469254981726408
Iteration: 4597, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44799262285232544
The generated pressure mean: 0.4508496820926666
loss_pred:0.022809576243162155, decouple_loss:0.004604239482432604
loss_pred:0.02361476421356201, decouple_loss:0.0047219921834766865
The generated pressure mean: 0.44615310430526733
loss_pred:0.022983135655522346, decouple_loss:0.004417268559336662
Iteration: 4598, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43393823504447937
loss_pred:0.022423742339015007, decouple_loss:0.0061018578708171844
The generated pressure mean: 0.4323999583721161
loss_pred:0.02127828821539879, decouple_loss:0.006048469804227352
The generated pressure mean: 0.4328504502773285
loss_pred:0.022639404982328415, decouple_loss:0.005848139990121126
Iteration: 4599, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44719135761260986
loss_pred:0.022450368851423264, decouple_loss:0.004633522126823664
The generated pressure mean: 0.4494118392467499
loss_pred:0.022854607552289963, decouple_loss:0.00461083697155118
The generated pressure mean: 0.4489441514015198
loss_pred:0.0209167692810297, decouple_loss:0.004345493391156197
Iteration: 4600, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46111491322517395
loss_pred:0.022033091634511948, decouple_loss:0.0054791090078651905
The generated pressure mean: 0.4603259861469269
loss_pred:0.02122252807021141, decouple_loss:0.00540661858394742
The generated pressure mean: 0.4643251895904541
loss_pred:0.024112354964017868, decouple_loss:0.005024040583521128
2023-04-17 05:16:39 testing...
The generated pressure mean: 0.41647666692733765
The generated pressure mean: 0.4239204525947571
loss_pred:0.03428664803504944, decouple_loss:0.006267423275858164
The generated pressure mean: 0.42633774876594543
loss_pred:0.033185530453920364, decouple_loss:0.006615194492042065
loss_pred:0.03295867517590523, decouple_loss:0.0067632924765348434
WV_0_PC_0_EH_1_PS_40, loss: 0.033804383128881454, avg_mse: 0.047606211155653
current test mse: 0.047606
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 4601, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44224366545677185
loss_pred:0.02300412580370903, decouple_loss:0.005783638451248407
The generated pressure mean: 0.44484102725982666
loss_pred:0.02283225581049919, decouple_loss:0.005820972844958305
The generated pressure mean: 0.43823784589767456
loss_pred:0.022930817678570747, decouple_loss:0.005779470317065716
Iteration: 4602, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4298447072505951
loss_pred:0.021061990410089493, decouple_loss:0.00470146955922246
The generated pressure mean: 0.4317665100097656
loss_pred:0.022785084322094917, decouple_loss:0.004340906161814928
The generated pressure mean: 0.4306103587150574
loss_pred:0.021972984075546265, decouple_loss:0.004431919194757938
Iteration: 4603, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45358338952064514
The generated pressure mean: 0.4553738832473755
loss_pred:0.02205132693052292, decouple_loss:0.005229451227933168
loss_pred:0.02085477113723755, decouple_loss:0.005313904955983162
The generated pressure mean: 0.45347630977630615
loss_pred:0.021575121209025383, decouple_loss:0.004995409399271011
Iteration: 4604, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45852920413017273
The generated pressure mean: 0.45657163858413696
loss_pred:0.021464986726641655, decouple_loss:0.006065015681087971
loss_pred:0.022167261689901352, decouple_loss:0.005742771551012993
The generated pressure mean: 0.455539733171463
loss_pred:0.021549580618739128, decouple_loss:0.005928522441536188
Iteration: 4605, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4441233277320862
loss_pred:0.022158237174153328, decouple_loss:0.005256222561001778
The generated pressure mean: 0.4434989094734192
loss_pred:0.021839771419763565, decouple_loss:0.005088018253445625
The generated pressure mean: 0.44664648175239563
loss_pred:0.022295942530035973, decouple_loss:0.005416131112724543
Iteration: 4606, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45692121982574463
loss_pred:0.02204141952097416, decouple_loss:0.0055860127322375774
The generated pressure mean: 0.4459071457386017
loss_pred:0.020982449874281883, decouple_loss:0.004861399531364441
The generated pressure mean: 0.45421716570854187
loss_pred:0.022955114021897316, decouple_loss:0.005574520211666822
Iteration: 4607, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4454338848590851
loss_pred:0.02345247194170952, decouple_loss:0.005468811374157667
The generated pressure mean: 0.4442816972732544
loss_pred:0.021616892889142036, decouple_loss:0.005085872486233711
The generated pressure mean: 0.44989675283432007
loss_pred:0.021569550037384033, decouple_loss:0.005387833807617426
Iteration: 4608, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44310250878334045
The generated pressure mean: 0.4396072328090668
loss_pred:0.024239545688033104, decouple_loss:0.005316820461302996
loss_pred:0.022695232182741165, decouple_loss:0.005301634781062603
The generated pressure mean: 0.4387173056602478
loss_pred:0.02349119447171688, decouple_loss:0.005104342475533485
Iteration: 4609, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473901689052582
The generated pressure mean: 0.45282310247421265
loss_pred:0.021128101274371147, decouple_loss:0.00795698631554842
loss_pred:0.02221268229186535, decouple_loss:0.007715994026511908
The generated pressure mean: 0.4471573829650879
loss_pred:0.021619372069835663, decouple_loss:0.007976101711392403
Iteration: 4610, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45734134316444397
loss_pred:0.02244032919406891, decouple_loss:0.005177011247724295
The generated pressure mean: 0.4600454866886139
loss_pred:0.02270902320742607, decouple_loss:0.005391226150095463
The generated pressure mean: 0.4629587233066559
loss_pred:0.022054292261600494, decouple_loss:0.005041479133069515
2023-04-17 05:19:09 testing...
The generated pressure mean: 0.4184449315071106
The generated pressure mean: 0.42640525102615356
loss_pred:0.03546871617436409, decouple_loss:0.007172369863837957
The generated pressure mean: 0.4290872812271118
loss_pred:0.03396651893854141, decouple_loss:0.007572677452117205
loss_pred:0.034085530787706375, decouple_loss:0.007809702306985855
WV_0_PC_0_EH_1_PS_40, loss: 0.034882836043834686, avg_mse: 0.04950740560889244
current test mse: 0.049507
Iteration: 4611, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4368421733379364
loss_pred:0.023191507905721664, decouple_loss:0.006274519953876734
The generated pressure mean: 0.43510693311691284
loss_pred:0.01947925239801407, decouple_loss:0.006019778084009886
The generated pressure mean: 0.43625345826148987
loss_pred:0.022337524220347404, decouple_loss:0.006030982825905085
Iteration: 4612, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44235512614250183
loss_pred:0.0214032381772995, decouple_loss:0.007965952157974243
The generated pressure mean: 0.44525718688964844
loss_pred:0.02148485742509365, decouple_loss:0.008251359686255455
The generated pressure mean: 0.44279879331588745
loss_pred:0.022650297731161118, decouple_loss:0.008032850921154022
Iteration: 4613, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44480860233306885
loss_pred:0.02063603699207306, decouple_loss:0.005479240324348211
The generated pressure mean: 0.44881942868232727
loss_pred:0.021703379228711128, decouple_loss:0.005748524330556393
The generated pressure mean: 0.44811779260635376
loss_pred:0.023006897419691086, decouple_loss:0.005514639429748058
Iteration: 4614, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45982620120048523
loss_pred:0.022199224680662155, decouple_loss:0.007448144722729921
The generated pressure mean: 0.4575084149837494
loss_pred:0.02039274014532566, decouple_loss:0.007211613934487104
The generated pressure mean: 0.4497690200805664
loss_pred:0.020493870601058006, decouple_loss:0.0074537391774356365
Iteration: 4615, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4450300633907318
loss_pred:0.020858490839600563, decouple_loss:0.005496020894497633
The generated pressure mean: 0.449672132730484
loss_pred:0.022844063118100166, decouple_loss:0.005450479220598936
The generated pressure mean: 0.45097050070762634
loss_pred:0.022931642830371857, decouple_loss:0.0055211749859154224
Iteration: 4616, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4514206349849701
loss_pred:0.02171126939356327, decouple_loss:0.005126967094838619
The generated pressure mean: 0.4510732889175415
The generated pressure mean: 0.45129629969596863
loss_pred:0.022700687870383263, decouple_loss:0.005004471633583307
loss_pred:0.021734559908509254, decouple_loss:0.00503365695476532
Iteration: 4617, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43255046010017395
loss_pred:0.021439969539642334, decouple_loss:0.006414022762328386
The generated pressure mean: 0.4330493211746216
loss_pred:0.02080109901726246, decouple_loss:0.0063581764698028564
The generated pressure mean: 0.4300231635570526
loss_pred:0.02078818716108799, decouple_loss:0.0061906445771455765
Iteration: 4618, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4447614848613739
loss_pred:0.020717088133096695, decouple_loss:0.0060005225241184235
The generated pressure mean: 0.44512543082237244
loss_pred:0.02345270849764347, decouple_loss:0.006009858567267656
The generated pressure mean: 0.44873884320259094
loss_pred:0.02024066634476185, decouple_loss:0.006144238170236349
Iteration: 4619, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47061917185783386
loss_pred:0.022405581548810005, decouple_loss:0.004530951380729675
The generated pressure mean: 0.46868377923965454
loss_pred:0.02195347100496292, decouple_loss:0.004322675988078117
The generated pressure mean: 0.47067341208457947
loss_pred:0.022444583475589752, decouple_loss:0.004578322637826204
Iteration: 4620, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44314339756965637
loss_pred:0.024381352588534355, decouple_loss:0.00555233983322978
The generated pressure mean: 0.44434595108032227
loss_pred:0.023850111290812492, decouple_loss:0.005455872975289822
The generated pressure mean: 0.44559887051582336
loss_pred:0.02253224328160286, decouple_loss:0.00557209737598896
2023-04-17 05:21:02 testing...
The generated pressure mean: 0.4214150011539459
The generated pressure mean: 0.42818012833595276
loss_pred:0.034723635762929916, decouple_loss:0.005660031456500292
The generated pressure mean: 0.43008679151535034
loss_pred:0.03369856998324394, decouple_loss:0.0060247271321713924
loss_pred:0.03337891399860382, decouple_loss:0.006251323502510786
WV_0_PC_0_EH_1_PS_40, loss: 0.034232646226882935, avg_mse: 0.048019297420978546
current test mse: 0.048019
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 4621, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42177292704582214
loss_pred:0.02341657504439354, decouple_loss:0.005278851371258497
The generated pressure mean: 0.421268492937088
loss_pred:0.020940637215971947, decouple_loss:0.005315217189490795
The generated pressure mean: 0.4209515452384949
loss_pred:0.02284829132258892, decouple_loss:0.00534891476854682
Iteration: 4622, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4612269103527069
The generated pressure mean: 0.4561070203781128
loss_pred:0.021873310208320618, decouple_loss:0.005073002073913813
loss_pred:0.02347550541162491, decouple_loss:0.004994191695004702
The generated pressure mean: 0.4633370339870453
loss_pred:0.023662814870476723, decouple_loss:0.005069029051810503
Iteration: 4623, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.456270694732666
The generated pressure mean: 0.4595864713191986
loss_pred:0.021528417244553566, decouple_loss:0.005328014027327299
loss_pred:0.022464118897914886, decouple_loss:0.005296369548887014
The generated pressure mean: 0.457274854183197
loss_pred:0.02243211679160595, decouple_loss:0.0053252228535711765
Iteration: 4624, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4382883906364441
loss_pred:0.021168267354369164, decouple_loss:0.005981880240142345
The generated pressure mean: 0.4391065239906311
loss_pred:0.022241484373807907, decouple_loss:0.005877502262592316
The generated pressure mean: 0.43889111280441284
loss_pred:0.022946566343307495, decouple_loss:0.006072428543120623
Iteration: 4625, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44459566473960876
The generated pressure mean: 0.44503965973854065
loss_pred:0.02125181257724762, decouple_loss:0.004704403690993786
loss_pred:0.02284793183207512, decouple_loss:0.0048247529193758965
The generated pressure mean: 0.4458503723144531
loss_pred:0.0226738303899765, decouple_loss:0.00468535115942359
Iteration: 4626, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4430321753025055
The generated pressure mean: 0.4433955252170563
loss_pred:0.02063925936818123, decouple_loss:0.005386026576161385
loss_pred:0.023077871650457382, decouple_loss:0.005587173160165548
The generated pressure mean: 0.4430588483810425
loss_pred:0.020427633076906204, decouple_loss:0.0054060616530478
Iteration: 4627, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4454231560230255
The generated pressure mean: 0.44817501306533813
loss_pred:0.02190319448709488, decouple_loss:0.005320817697793245
loss_pred:0.02206585556268692, decouple_loss:0.0051277754828333855
The generated pressure mean: 0.44835329055786133
loss_pred:0.0248329546302557, decouple_loss:0.005468450952321291
Iteration: 4628, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.458617240190506
loss_pred:0.020244687795639038, decouple_loss:0.005121306981891394
The generated pressure mean: 0.45456209778785706
loss_pred:0.02191653847694397, decouple_loss:0.005476645193994045
The generated pressure mean: 0.45254769921302795
loss_pred:0.02278938889503479, decouple_loss:0.004926109686493874
Iteration: 4629, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4438443183898926
loss_pred:0.022618265822529793, decouple_loss:0.004831039812415838The generated pressure mean: 0.4458611011505127
loss_pred:0.021040724590420723, decouple_loss:0.004926422145217657
The generated pressure mean: 0.4452037513256073
loss_pred:0.02276819944381714, decouple_loss:0.0052252598106861115
Iteration: 4630, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4378829300403595
loss_pred:0.021101025864481926, decouple_loss:0.005070175975561142
The generated pressure mean: 0.4411080777645111
loss_pred:0.022675270214676857, decouple_loss:0.0049984692595899105
The generated pressure mean: 0.43836742639541626
loss_pred:0.020375419408082962, decouple_loss:0.005004077218472958
2023-04-17 05:23:29 testing...
The generated pressure mean: 0.41573774814605713
The generated pressure mean: 0.42363524436950684
The generated pressure mean: 0.4265705943107605
loss_pred:0.03501569852232933, decouple_loss:0.005395018961280584
loss_pred:0.03388388454914093, decouple_loss:0.0056961914524436
loss_pred:0.0336930975317955, decouple_loss:0.005989681929349899
WV_0_PC_0_EH_1_PS_40, loss: 0.03448224067687988, avg_mse: 0.049078319221735
current test mse: 0.049078
Iteration: 4631, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4437573254108429
loss_pred:0.020800193771719933, decouple_loss:0.004858920816332102
The generated pressure mean: 0.44565349817276
loss_pred:0.021319229155778885, decouple_loss:0.0046114008873701096
The generated pressure mean: 0.4476250410079956
loss_pred:0.024037789553403854, decouple_loss:0.004987296182662249
Iteration: 4632, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4578031897544861
loss_pred:0.02314542606472969, decouple_loss:0.005145425908267498
The generated pressure mean: 0.4528728127479553
loss_pred:0.02265947498381138, decouple_loss:0.005252053961157799
The generated pressure mean: 0.4569375514984131
loss_pred:0.02231510356068611, decouple_loss:0.005094117019325495
Iteration: 4633, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44700732827186584
The generated pressure mean: 0.44284945726394653
loss_pred:0.021346617490053177, decouple_loss:0.004576381295919418
loss_pred:0.020457597449421883, decouple_loss:0.00442633917555213
The generated pressure mean: 0.44598257541656494
loss_pred:0.020771540701389313, decouple_loss:0.004585171118378639
Iteration: 4634, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44104480743408203
loss_pred:0.021718580275774002, decouple_loss:0.00532957399263978
The generated pressure mean: 0.4391259551048279
loss_pred:0.0252141822129488, decouple_loss:0.005187127739191055
The generated pressure mean: 0.4378129541873932
loss_pred:0.02019982598721981, decouple_loss:0.005480807740241289
Iteration: 4635, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44257494807243347
loss_pred:0.02371980808675289, decouple_loss:0.004583226051181555
The generated pressure mean: 0.4425770938396454
loss_pred:0.022616062313318253, decouple_loss:0.004057722166180611
The generated pressure mean: 0.44046950340270996
loss_pred:0.023052604869008064, decouple_loss:0.0043973177671432495
Iteration: 4636, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4558223485946655
The generated pressure mean: 0.45829781889915466
loss_pred:0.022472966462373734, decouple_loss:0.004754492547363043
loss_pred:0.021702483296394348, decouple_loss:0.004798118025064468
The generated pressure mean: 0.4579828381538391
loss_pred:0.022512460127472878, decouple_loss:0.004782434087246656
Iteration: 4637, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44589293003082275
loss_pred:0.02398439683020115, decouple_loss:0.0049522751942276955
The generated pressure mean: 0.44945549964904785
loss_pred:0.0227751936763525, decouple_loss:0.0047482773661613464
The generated pressure mean: 0.44634371995925903
loss_pred:0.022543488070368767, decouple_loss:0.004625767469406128
Iteration: 4638, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4358372092247009
loss_pred:0.020655561238527298, decouple_loss:0.004139614757150412
The generated pressure mean: 0.437925785779953
loss_pred:0.022214410826563835, decouple_loss:0.004457514733076096
The generated pressure mean: 0.43498843908309937
loss_pred:0.02063319832086563, decouple_loss:0.00428086007013917
Iteration: 4639, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45375216007232666
loss_pred:0.02075350284576416, decouple_loss:0.0047142687253654
The generated pressure mean: 0.4545733630657196
loss_pred:0.021830331534147263, decouple_loss:0.0048505812883377075
The generated pressure mean: 0.4594302475452423
loss_pred:0.021692350506782532, decouple_loss:0.004999171476811171
Iteration: 4640, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45142459869384766
loss_pred:0.020884664729237556, decouple_loss:0.005026885773986578
The generated pressure mean: 0.4508723020553589
loss_pred:0.022294534370303154, decouple_loss:0.005043158773332834
The generated pressure mean: 0.4545678198337555
loss_pred:0.022359998896718025, decouple_loss:0.005218564998358488
2023-04-17 05:25:23 testing...
The generated pressure mean: 0.4173678457736969
The generated pressure mean: 0.4255373179912567
The generated pressure mean: 0.42820295691490173
loss_pred:0.035957057029008865, decouple_loss:0.0055479733273386955
loss_pred:0.0344984270632267, decouple_loss:0.0059547447599470615
loss_pred:0.0343390554189682, decouple_loss:0.005769520066678524
WV_0_PC_0_EH_1_PS_40, loss: 0.035219382494688034, avg_mse: 0.05035196989774704
current test mse: 0.050352
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 4641, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.436458021402359
loss_pred:0.02314765565097332, decouple_loss:0.004834111779928207
The generated pressure mean: 0.440038800239563
loss_pred:0.021851401776075363, decouple_loss:0.004885129164904356
The generated pressure mean: 0.4352962076663971
loss_pred:0.02214852161705494, decouple_loss:0.004755410365760326
Iteration: 4642, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480442404747009
loss_pred:0.023796355351805687, decouple_loss:0.00479236152023077
The generated pressure mean: 0.4462466537952423
loss_pred:0.02323693223297596, decouple_loss:0.005084841046482325
The generated pressure mean: 0.4466507136821747
loss_pred:0.023148899897933006, decouple_loss:0.004845696501433849
Iteration: 4643, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4447183907032013
loss_pred:0.022255470976233482, decouple_loss:0.005074628163129091
The generated pressure mean: 0.4411933720111847
loss_pred:0.02249925211071968, decouple_loss:0.005326388869434595
The generated pressure mean: 0.44705042243003845
loss_pred:0.02202991209924221, decouple_loss:0.005099633242934942
Iteration: 4644, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45221054553985596
loss_pred:0.02187243103981018, decouple_loss:0.0052833170630037785
The generated pressure mean: 0.4475756883621216
loss_pred:0.02422456257045269, decouple_loss:0.004686091095209122
The generated pressure mean: 0.4461010992527008
loss_pred:0.02136542648077011, decouple_loss:0.005085230804979801
Iteration: 4645, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44773074984550476
loss_pred:0.022014755755662918, decouple_loss:0.00481052091345191
The generated pressure mean: 0.4493711590766907
loss_pred:0.023288728669285774, decouple_loss:0.004820987582206726
The generated pressure mean: 0.4510940909385681
loss_pred:0.020989790558815002, decouple_loss:0.004750242922455072
Iteration: 4646, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446416974067688
loss_pred:0.02047046087682247, decouple_loss:0.00477174948900938
The generated pressure mean: 0.4488736391067505
loss_pred:0.021557586267590523, decouple_loss:0.005063129588961601
The generated pressure mean: 0.4474093019962311
loss_pred:0.02207716554403305, decouple_loss:0.005362984724342823
Iteration: 4647, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44606781005859375
loss_pred:0.023071711882948875, decouple_loss:0.005335358902812004
The generated pressure mean: 0.447142094373703
loss_pred:0.02320965565741062, decouple_loss:0.005096134264022112
The generated pressure mean: 0.444664865732193
loss_pred:0.02324580028653145, decouple_loss:0.00546845281496644
Iteration: 4648, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4371519982814789
loss_pred:0.02129667066037655, decouple_loss:0.004469491541385651
The generated pressure mean: 0.4317239820957184
loss_pred:0.02285870350897312, decouple_loss:0.004664386156946421
The generated pressure mean: 0.4361092746257782
loss_pred:0.022719644010066986, decouple_loss:0.005015166942030191
Iteration: 4649, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4551619589328766
The generated pressure mean: 0.45279979705810547
loss_pred:0.022667406126856804, decouple_loss:0.006532892119139433
loss_pred:0.021601468324661255, decouple_loss:0.006472264416515827
The generated pressure mean: 0.45510947704315186
loss_pred:0.022785715758800507, decouple_loss:0.006743284873664379
Iteration: 4650, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4521211087703705The generated pressure mean: 0.4547409117221832
loss_pred:0.021945854648947716, decouple_loss:0.0053742993623018265
loss_pred:0.022352026775479317, decouple_loss:0.005338971968740225
The generated pressure mean: 0.4540340304374695
loss_pred:0.022429753094911575, decouple_loss:0.0054905652068555355
2023-04-17 05:27:57 testing...
The generated pressure mean: 0.4147718548774719
The generated pressure mean: 0.42224055528640747
The generated pressure mean: 0.4244783818721771
loss_pred:0.03501245751976967, decouple_loss:0.007301974110305309
loss_pred:0.0340135432779789, decouple_loss:0.007497235666960478
loss_pred:0.03397181257605553, decouple_loss:0.0075893886387348175
WV_0_PC_0_EH_1_PS_40, loss: 0.034705750644207, avg_mse: 0.049344588071107864
current test mse: 0.049345
Iteration: 4651, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45060887932777405
loss_pred:0.02219194360077381, decouple_loss:0.006328816991299391
The generated pressure mean: 0.44693711400032043
loss_pred:0.022731153294444084, decouple_loss:0.006248465273529291
The generated pressure mean: 0.45030340552330017
loss_pred:0.022475043311715126, decouple_loss:0.0060409363359212875
Iteration: 4652, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4298735558986664
loss_pred:0.023458918556571007, decouple_loss:0.00721531268209219
The generated pressure mean: 0.4251213073730469
loss_pred:0.021927794441580772, decouple_loss:0.007233832497149706
The generated pressure mean: 0.4355575442314148
loss_pred:0.022878531366586685, decouple_loss:0.007231783587485552
Iteration: 4653, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465912878513336
loss_pred:0.02239416539669037, decouple_loss:0.005956149194389582
The generated pressure mean: 0.4431338906288147
loss_pred:0.022440029308199883, decouple_loss:0.006200979929417372
The generated pressure mean: 0.44591376185417175
loss_pred:0.021560678258538246, decouple_loss:0.00582437589764595
Iteration: 4654, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46498122811317444
loss_pred:0.02273300103843212, decouple_loss:0.007568706758320332
The generated pressure mean: 0.45879900455474854
loss_pred:0.021345719695091248, decouple_loss:0.007599958684295416
The generated pressure mean: 0.45874202251434326
loss_pred:0.023555487394332886, decouple_loss:0.007568868342787027
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4655, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505656659603119
loss_pred:0.021071836352348328, decouple_loss:0.006206330843269825
The generated pressure mean: 0.45258629322052
loss_pred:0.021507887169718742, decouple_loss:0.006440389435738325
The generated pressure mean: 0.45009317994117737
loss_pred:0.02187913842499256, decouple_loss:0.006406696513295174
Iteration: 4656, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43898805975914
loss_pred:0.022993527352809906, decouple_loss:0.006777128204703331
The generated pressure mean: 0.43868523836135864
loss_pred:0.02156819961965084, decouple_loss:0.006850559264421463
The generated pressure mean: 0.43444207310676575
loss_pred:0.021764598786830902, decouple_loss:0.006955320481210947
Iteration: 4657, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4432414174079895
loss_pred:0.02189970575273037, decouple_loss:0.005809767171740532
The generated pressure mean: 0.44276806712150574
loss_pred:0.02318478934466839, decouple_loss:0.00614177854731679
The generated pressure mean: 0.43731769919395447
loss_pred:0.022532708942890167, decouple_loss:0.005807261914014816
Iteration: 4658, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4555201232433319
loss_pred:0.022331561893224716, decouple_loss:0.0070830052718520164
The generated pressure mean: 0.45351237058639526
loss_pred:0.022001370787620544, decouple_loss:0.007168909534811974
The generated pressure mean: 0.4539605975151062
loss_pred:0.02201898954808712, decouple_loss:0.00729299196973443
Iteration: 4659, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44685277342796326
loss_pred:0.021422674879431725, decouple_loss:0.006099056452512741
The generated pressure mean: 0.44786134362220764
loss_pred:0.022234372794628143, decouple_loss:0.006070663221180439
The generated pressure mean: 0.44661200046539307
loss_pred:0.02184201218187809, decouple_loss:0.005983734969049692
Iteration: 4660, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4421123266220093
loss_pred:0.021225715056061745, decouple_loss:0.00671149417757988
The generated pressure mean: 0.440742552280426
loss_pred:0.021964235231280327, decouple_loss:0.007165183313190937
The generated pressure mean: 0.44998663663864136
loss_pred:0.02253117598593235, decouple_loss:0.0070753139443695545
2023-04-17 05:29:52 testing...
The generated pressure mean: 0.41964930295944214
The generated pressure mean: 0.41229891777038574
loss_pred:0.03389032930135727, decouple_loss:0.006711699068546295
The generated pressure mean: 0.42200830578804016
loss_pred:0.03534110262989998, decouple_loss:0.006489359308034182
loss_pred:0.03376216068863869, decouple_loss:0.006900344509631395
WV_0_PC_0_EH_1_PS_40, loss: 0.03466622158885002, avg_mse: 0.0493609756231308
current test mse: 0.049361
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 4661, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4515841007232666
loss_pred:0.020993150770664215, decouple_loss:0.005783451721072197
The generated pressure mean: 0.4564000964164734
loss_pred:0.023177186027169228, decouple_loss:0.00578498188406229
The generated pressure mean: 0.4544077515602112
loss_pred:0.021969350054860115, decouple_loss:0.005820176564157009
Iteration: 4662, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44396525621414185
loss_pred:0.023269306868314743, decouple_loss:0.007513300981372595
The generated pressure mean: 0.4427128732204437
loss_pred:0.023539947345852852, decouple_loss:0.007604275364428759
The generated pressure mean: 0.4469778537750244
loss_pred:0.022622279822826385, decouple_loss:0.007426907308399677
Iteration: 4663, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43447819352149963
The generated pressure mean: 0.43997374176979065
loss_pred:0.02240571193397045, decouple_loss:0.0064266095869243145
loss_pred:0.021994391456246376, decouple_loss:0.006398184224963188
The generated pressure mean: 0.43942031264305115
loss_pred:0.02223954349756241, decouple_loss:0.006587413605302572
Iteration: 4664, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45449116826057434
loss_pred:0.02108612097799778, decouple_loss:0.007329473737627268
The generated pressure mean: 0.4583248198032379
loss_pred:0.022851046174764633, decouple_loss:0.007374358829110861
The generated pressure mean: 0.4531491994857788
loss_pred:0.022010518237948418, decouple_loss:0.0073823812417685986
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4665, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478289783000946
loss_pred:0.022677086293697357, decouple_loss:0.006727786734700203
The generated pressure mean: 0.4494064450263977
loss_pred:0.021729426458477974, decouple_loss:0.006515395361930132
The generated pressure mean: 0.4490005075931549
loss_pred:0.02214570716023445, decouple_loss:0.006384008564054966
Iteration: 4666, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4352603852748871
loss_pred:0.02089400216937065, decouple_loss:0.007715463172644377
The generated pressure mean: 0.4343349039554596
loss_pred:0.02258310839533806, decouple_loss:0.007928039878606796
The generated pressure mean: 0.4326886832714081
loss_pred:0.02213338576257229, decouple_loss:0.007918037474155426
Iteration: 4667, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44606614112854004
loss_pred:0.024346759542822838, decouple_loss:0.006612238008528948
The generated pressure mean: 0.4443550705909729
loss_pred:0.023213688284158707, decouple_loss:0.006244456861168146
The generated pressure mean: 0.44402915239334106
loss_pred:0.022871512919664383, decouple_loss:0.006522002164274454
Iteration: 4668, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45174670219421387
The generated pressure mean: 0.46201127767562866
loss_pred:0.023494932800531387, decouple_loss:0.007910468615591526
loss_pred:0.024433240294456482, decouple_loss:0.0076211001724004745
The generated pressure mean: 0.45810678601264954
loss_pred:0.023077789694070816, decouple_loss:0.007751020602881908
Iteration: 4669, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4425452947616577
loss_pred:0.0226589348167181, decouple_loss:0.005404174327850342
The generated pressure mean: 0.4467233121395111
loss_pred:0.022138454020023346, decouple_loss:0.005296323914080858
The generated pressure mean: 0.44611480832099915
loss_pred:0.02184675633907318, decouple_loss:0.005146184470504522
Iteration: 4670, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4347274899482727
The generated pressure mean: 0.4390646815299988
loss_pred:0.0237750131636858, decouple_loss:0.008297483436763287
loss_pred:0.021270878612995148, decouple_loss:0.008517500944435596
The generated pressure mean: 0.4339825510978699
loss_pred:0.022102370858192444, decouple_loss:0.00822671689093113
2023-04-17 05:32:21 testing...
The generated pressure mean: 0.4235363304615021
The generated pressure mean: 0.41582173109054565
loss_pred:0.03379097208380699, decouple_loss:0.006124171428382397
The generated pressure mean: 0.4263065457344055
loss_pred:0.03445011004805565, decouple_loss:0.005781316664069891
loss_pred:0.03352472186088562, decouple_loss:0.006411696784198284
WV_0_PC_0_EH_1_PS_40, loss: 0.034227222204208374, avg_mse: 0.04859736189246178
current test mse: 0.048597
Iteration: 4671, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44733595848083496
loss_pred:0.022374529391527176, decouple_loss:0.004815610591322184
The generated pressure mean: 0.44529813528060913
loss_pred:0.021977253258228302, decouple_loss:0.0047792186960577965
The generated pressure mean: 0.4515259861946106
loss_pred:0.020932428538799286, decouple_loss:0.004955545533448458
Iteration: 4672, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484146237373352
loss_pred:0.02123343199491501, decouple_loss:0.008245841600000858
The generated pressure mean: 0.44469112157821655
loss_pred:0.022544754669070244, decouple_loss:0.008378229103982449
The generated pressure mean: 0.4502932131290436
loss_pred:0.02254898101091385, decouple_loss:0.008244053460657597
Iteration: 4673, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4568876028060913
loss_pred:0.02212986722588539, decouple_loss:0.005923832766711712
The generated pressure mean: 0.4544888734817505
loss_pred:0.021874230355024338, decouple_loss:0.005822599865496159
The generated pressure mean: 0.45687541365623474
loss_pred:0.021136583760380745, decouple_loss:0.006078113801777363
Iteration: 4674, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44754254817962646
loss_pred:0.022694865241646767, decouple_loss:0.006743428763002157
The generated pressure mean: 0.44314002990722656
loss_pred:0.021843384951353073, decouple_loss:0.006500537507236004
The generated pressure mean: 0.4439157545566559
loss_pred:0.023128148168325424, decouple_loss:0.0065391696989536285
Iteration: 4675, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43540358543395996
loss_pred:0.02301640436053276, decouple_loss:0.005861865356564522
The generated pressure mean: 0.4417315721511841
loss_pred:0.023178985342383385, decouple_loss:0.005854427814483643
The generated pressure mean: 0.4390502870082855
loss_pred:0.0210836511105299, decouple_loss:0.005935208406299353
Iteration: 4676, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501011371612549
The generated pressure mean: 0.4464224874973297
loss_pred:0.022085966542363167, decouple_loss:0.006555505096912384
loss_pred:0.02165101282298565, decouple_loss:0.006804493255913258
The generated pressure mean: 0.45454123616218567
loss_pred:0.02139587700366974, decouple_loss:0.0067666806280612946
Iteration: 4677, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4528997838497162
loss_pred:0.021206775680184364, decouple_loss:0.005809977650642395
The generated pressure mean: 0.45623260736465454
The generated pressure mean: 0.4530322551727295
loss_pred:0.023684805259108543, decouple_loss:0.005442086607217789
loss_pred:0.023083053529262543, decouple_loss:0.005749954842031002
Iteration: 4678, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4348268210887909
loss_pred:0.023608917370438576, decouple_loss:0.006625394802540541
The generated pressure mean: 0.43901196122169495
loss_pred:0.022582750767469406, decouple_loss:0.006600146181881428
The generated pressure mean: 0.43420594930648804
loss_pred:0.02352895401418209, decouple_loss:0.00670502008870244
Iteration: 4679, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473111033439636
loss_pred:0.024145644158124924, decouple_loss:0.007152035366743803
The generated pressure mean: 0.4488407075405121
loss_pred:0.02287732996046543, decouple_loss:0.007056295871734619
The generated pressure mean: 0.45245495438575745
loss_pred:0.02268679440021515, decouple_loss:0.007307854946702719
Iteration: 4680, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44436952471733093
loss_pred:0.023728428408503532, decouple_loss:0.00644313357770443
The generated pressure mean: 0.45086798071861267
The generated pressure mean: 0.44759514927864075
loss_pred:0.024073030799627304, decouple_loss:0.006161719560623169
loss_pred:0.02315574698150158, decouple_loss:0.0062582534737885
2023-04-17 05:34:15 testing...
The generated pressure mean: 0.41527843475341797
The generated pressure mean: 0.4234335422515869
loss_pred:0.03422226011753082, decouple_loss:0.007086911704391241
The generated pressure mean: 0.426017701625824
loss_pred:0.03299494460225105, decouple_loss:0.007397940382361412
loss_pred:0.03306211158633232, decouple_loss:0.0074586449190974236
WV_0_PC_0_EH_1_PS_40, loss: 0.0337921641767025, avg_mse: 0.04775921255350113
current test mse: 0.047759
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 4681, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44393569231033325
loss_pred:0.02321925014257431, decouple_loss:0.005800612736493349
The generated pressure mean: 0.4531072974205017
loss_pred:0.022681523114442825, decouple_loss:0.006178791634738445
The generated pressure mean: 0.44658973813056946
loss_pred:0.022778445854783058, decouple_loss:0.005579797551035881
Iteration: 4682, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46095696091651917
loss_pred:0.022942647337913513, decouple_loss:0.0067460001446306705
The generated pressure mean: 0.45892760157585144
loss_pred:0.023209521546959877, decouple_loss:0.006803696043789387
The generated pressure mean: 0.46079379320144653
loss_pred:0.02254798263311386, decouple_loss:0.006745156366378069
Iteration: 4683, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43222716450691223
loss_pred:0.021240724250674248, decouple_loss:0.0050932858139276505
The generated pressure mean: 0.4339047372341156
loss_pred:0.021978992968797684, decouple_loss:0.005298337899148464
The generated pressure mean: 0.4305732548236847
loss_pred:0.02283068560063839, decouple_loss:0.005453471094369888
Iteration: 4684, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44553735852241516
loss_pred:0.022157050669193268, decouple_loss:0.005392333026975393
The generated pressure mean: 0.44281336665153503
loss_pred:0.022867901250720024, decouple_loss:0.005612421315163374
The generated pressure mean: 0.4473024308681488
loss_pred:0.023127401247620583, decouple_loss:0.006241109687834978
Iteration: 4685, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4537397027015686
loss_pred:0.02212226577103138, decouple_loss:0.005911557469516993
The generated pressure mean: 0.45929965376853943
loss_pred:0.023293528705835342, decouple_loss:0.005914062261581421
The generated pressure mean: 0.4546584486961365
loss_pred:0.02317173220217228, decouple_loss:0.005754869896918535
Iteration: 4686, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4529958963394165
loss_pred:0.021174956113100052, decouple_loss:0.0049870978109538555
The generated pressure mean: 0.4550957977771759
loss_pred:0.021560266613960266, decouple_loss:0.005041369702666998
The generated pressure mean: 0.4544553756713867
loss_pred:0.02251741662621498, decouple_loss:0.005097921472042799
Iteration: 4687, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44741037487983704
loss_pred:0.024069689214229584, decouple_loss:0.006311528850346804
The generated pressure mean: 0.4463464915752411
loss_pred:0.020913708955049515, decouple_loss:0.006306558847427368
The generated pressure mean: 0.4433935284614563
loss_pred:0.02043733187019825, decouple_loss:0.006472002249211073
Iteration: 4688, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42868712544441223
The generated pressure mean: 0.4275660812854767
loss_pred:0.021985022351145744, decouple_loss:0.005770829040557146
loss_pred:0.021909818053245544, decouple_loss:0.005922780372202396
The generated pressure mean: 0.4287203848361969
loss_pred:0.02135767601430416, decouple_loss:0.005729738622903824
Iteration: 4689, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45067745447158813
loss_pred:0.022881295531988144, decouple_loss:0.00516516761854291
The generated pressure mean: 0.44741198420524597
loss_pred:0.022732822224497795, decouple_loss:0.005303081590682268
The generated pressure mean: 0.44523051381111145
loss_pred:0.02202712930738926, decouple_loss:0.005276697687804699
Iteration: 4690, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46318691968917847
loss_pred:0.021097803488373756, decouple_loss:0.004870891105383635
The generated pressure mean: 0.4694419205188751
loss_pred:0.02136416547000408, decouple_loss:0.004609331022948027
The generated pressure mean: 0.4666909873485565
loss_pred:0.024428270757198334, decouple_loss:0.004539955873042345
2023-04-17 05:36:41 testing...
The generated pressure mean: 0.41945672035217285
The generated pressure mean: 0.42686471343040466
The generated pressure mean: 0.42945805191993713
loss_pred:0.0350976288318634, decouple_loss:0.006968344561755657
loss_pred:0.0343591645359993, decouple_loss:0.006970590446144342
loss_pred:0.033721067011356354, decouple_loss:0.00700468709692359
WV_0_PC_0_EH_1_PS_40, loss: 0.034741681069135666, avg_mse: 0.04946433752775192
current test mse: 0.049464
Iteration: 4691, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4307141602039337
loss_pred:0.02255992777645588, decouple_loss:0.005872576031833887
The generated pressure mean: 0.43061208724975586
loss_pred:0.021836210042238235, decouple_loss:0.005918876733630896
The generated pressure mean: 0.4261741638183594
loss_pred:0.024721605703234673, decouple_loss:0.005935152061283588
Iteration: 4692, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4517693817615509
The generated pressure mean: 0.44985726475715637
loss_pred:0.021505139768123627, decouple_loss:0.005571920424699783
loss_pred:0.023388560861349106, decouple_loss:0.00584398303180933
The generated pressure mean: 0.44484418630599976
loss_pred:0.021433809772133827, decouple_loss:0.005736988037824631
Iteration: 4693, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4534284472465515
The generated pressure mean: 0.45223185420036316
loss_pred:0.0225266944617033, decouple_loss:0.004412743262946606
loss_pred:0.022493939846754074, decouple_loss:0.004779161885380745
The generated pressure mean: 0.45424461364746094
loss_pred:0.02287241630256176, decouple_loss:0.004417459946125746
Iteration: 4694, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4352355897426605
loss_pred:0.021218759939074516, decouple_loss:0.006025775335729122
The generated pressure mean: 0.4432837665081024
loss_pred:0.022510500624775887, decouple_loss:0.006027028895914555
The generated pressure mean: 0.4403134882450104
loss_pred:0.022722961381077766, decouple_loss:0.0059838020242750645
Iteration: 4695, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46451547741889954
loss_pred:0.02490399405360222, decouple_loss:0.005608614068478346
The generated pressure mean: 0.46490031480789185
loss_pred:0.02287856675684452, decouple_loss:0.005454493220895529
The generated pressure mean: 0.4622957110404968
loss_pred:0.02203994430601597, decouple_loss:0.005484079476445913
Iteration: 4696, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.438917338848114
The generated pressure mean: 0.4335724115371704
loss_pred:0.0220304187387228, decouple_loss:0.004546219017356634
loss_pred:0.023196928203105927, decouple_loss:0.004891171585768461
The generated pressure mean: 0.43566104769706726
loss_pred:0.021673552691936493, decouple_loss:0.004601277876645327
Iteration: 4697, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44265878200531006
The generated pressure mean: 0.4449017643928528
loss_pred:0.0227641724050045, decouple_loss:0.005405392963439226
loss_pred:0.022277409210801125, decouple_loss:0.0053728981874883175
The generated pressure mean: 0.44597604870796204
loss_pred:0.021861586719751358, decouple_loss:0.005271528381854296
Iteration: 4698, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44533947110176086
loss_pred:0.022587517276406288, decouple_loss:0.005448938347399235
The generated pressure mean: 0.44782331585884094
loss_pred:0.02285081148147583, decouple_loss:0.005341825075447559
The generated pressure mean: 0.43715545535087585
loss_pred:0.021433943882584572, decouple_loss:0.005260838661342859
Iteration: 4699, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.440840482711792
loss_pred:0.022926704958081245, decouple_loss:0.004361329134553671
The generated pressure mean: 0.4436640739440918
loss_pred:0.023173654451966286, decouple_loss:0.004431047942489386
The generated pressure mean: 0.44574108719825745
loss_pred:0.021721743047237396, decouple_loss:0.004502603784203529
Iteration: 4700, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46170517802238464
loss_pred:0.022600961849093437, decouple_loss:0.004894805606454611
The generated pressure mean: 0.46013307571411133
loss_pred:0.023356273770332336, decouple_loss:0.004611725453287363
The generated pressure mean: 0.4606053829193115
loss_pred:0.023528892546892166, decouple_loss:0.004569484852254391
2023-04-17 05:38:34 testing...
The generated pressure mean: 0.4144202768802643
The generated pressure mean: 0.42221614718437195
loss_pred:0.035575997084379196, decouple_loss:0.005385150201618671
The generated pressure mean: 0.42492765188217163
loss_pred:0.034157127141952515, decouple_loss:0.00570651376619935
loss_pred:0.03437655791640282, decouple_loss:0.005864284001290798
WV_0_PC_0_EH_1_PS_40, loss: 0.034985825419425964, avg_mse: 0.050266873091459274
current test mse: 0.050267
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 4701, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483797252178192
loss_pred:0.02135417051613331, decouple_loss:0.00457984022796154
The generated pressure mean: 0.44866958260536194
loss_pred:0.02200043387711048, decouple_loss:0.004674587398767471
The generated pressure mean: 0.4508383274078369
loss_pred:0.022234570235013962, decouple_loss:0.0047453623265028
Iteration: 4702, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43204477429389954
The generated pressure mean: 0.43466994166374207
loss_pred:0.020948011428117752, decouple_loss:0.004685545805841684
loss_pred:0.021415099501609802, decouple_loss:0.004559973254799843
The generated pressure mean: 0.4373434782028198
loss_pred:0.022059008479118347, decouple_loss:0.004589778836816549
Iteration: 4703, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.440308153629303The generated pressure mean: 0.4422536790370941
loss_pred:0.022123707458376884, decouple_loss:0.00490193534642458
loss_pred:0.02253296785056591, decouple_loss:0.005081248469650745
The generated pressure mean: 0.44582870602607727
loss_pred:0.02040553279221058, decouple_loss:0.005005335435271263
Iteration: 4704, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4429256319999695
The generated pressure mean: 0.4464796185493469
loss_pred:0.02139231003820896, decouple_loss:0.005189163610339165
loss_pred:0.0208973977714777, decouple_loss:0.005261270795017481
The generated pressure mean: 0.44088268280029297
loss_pred:0.022410057485103607, decouple_loss:0.00542563758790493
Iteration: 4705, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44739001989364624
The generated pressure mean: 0.4509488344192505
loss_pred:0.021847181022167206, decouple_loss:0.00492376321926713
loss_pred:0.02308555692434311, decouple_loss:0.005003060679882765
The generated pressure mean: 0.4450114965438843
loss_pred:0.02250097133219242, decouple_loss:0.005059535149484873
Iteration: 4706, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4591035544872284
The generated pressure mean: 0.4616553485393524
loss_pred:0.02162928506731987, decouple_loss:0.005454086698591709
loss_pred:0.021838555112481117, decouple_loss:0.005240330006927252
The generated pressure mean: 0.4595511555671692
loss_pred:0.021945450454950333, decouple_loss:0.005230809096246958
Iteration: 4707, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496983587741852The generated pressure mean: 0.44573426246643066
loss_pred:0.023566704243421555, decouple_loss:0.005384364631026983
loss_pred:0.023279711604118347, decouple_loss:0.005338982678949833
The generated pressure mean: 0.4450281262397766
loss_pred:0.02165173925459385, decouple_loss:0.00538825336843729
Iteration: 4708, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.425495982170105
The generated pressure mean: 0.4305509626865387
loss_pred:0.020992575213313103, decouple_loss:0.005091314669698477
loss_pred:0.021896842867136, decouple_loss:0.005166173446923494
The generated pressure mean: 0.4323922395706177
loss_pred:0.02318074181675911, decouple_loss:0.00499305734410882
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4709, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4551640748977661
loss_pred:0.021433141082525253, decouple_loss:0.004904701374471188
The generated pressure mean: 0.4503837525844574
loss_pred:0.02472139149904251, decouple_loss:0.005112903192639351
The generated pressure mean: 0.45305562019348145
loss_pred:0.021919317543506622, decouple_loss:0.004803980700671673
Iteration: 4710, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43354532122612
loss_pred:0.02325006015598774, decouple_loss:0.005053384229540825
The generated pressure mean: 0.4351438283920288
loss_pred:0.022036897018551826, decouple_loss:0.005003698170185089
The generated pressure mean: 0.44338271021842957
loss_pred:0.020363368093967438, decouple_loss:0.004822635557502508
2023-04-17 05:41:03 testing...
The generated pressure mean: 0.4131821393966675
The generated pressure mean: 0.42015936970710754
loss_pred:0.03474891185760498, decouple_loss:0.006586125120520592
The generated pressure mean: 0.42289432883262634
loss_pred:0.03386526182293892, decouple_loss:0.006832750514149666
loss_pred:0.03351543843746185, decouple_loss:0.006897479761391878
WV_0_PC_0_EH_1_PS_40, loss: 0.03438180685043335, avg_mse: 0.04867507144808769
current test mse: 0.048675
Iteration: 4711, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45172980427742004
loss_pred:0.023001525551080704, decouple_loss:0.0055060237646102905
The generated pressure mean: 0.4545340836048126
loss_pred:0.02081802487373352, decouple_loss:0.005165301728993654
The generated pressure mean: 0.4525113105773926
loss_pred:0.024386754259467125, decouple_loss:0.005459524225443602
Iteration: 4712, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46084311604499817
loss_pred:0.02247081883251667, decouple_loss:0.005332562141120434
The generated pressure mean: 0.4590185284614563
loss_pred:0.023244351148605347, decouple_loss:0.005502478219568729
The generated pressure mean: 0.4578271806240082
loss_pred:0.023238807916641235, decouple_loss:0.005474155303090811
Iteration: 4713, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.41745999455451965
loss_pred:0.021955003961920738, decouple_loss:0.004764967132359743The generated pressure mean: 0.42325305938720703
loss_pred:0.0224471352994442, decouple_loss:0.00468639750033617
The generated pressure mean: 0.4203700125217438
loss_pred:0.021265210583806038, decouple_loss:0.0046886601485311985
Iteration: 4714, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44044414162635803
loss_pred:0.022339608520269394, decouple_loss:0.0046884436160326
The generated pressure mean: 0.44258832931518555
loss_pred:0.022076159715652466, decouple_loss:0.004742410033941269
The generated pressure mean: 0.44609004259109497
loss_pred:0.021499674767255783, decouple_loss:0.00465421611443162
Iteration: 4715, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46838781237602234
loss_pred:0.02184867113828659, decouple_loss:0.004946550820022821
The generated pressure mean: 0.4646296501159668
loss_pred:0.02503115125000477, decouple_loss:0.004962526727467775
The generated pressure mean: 0.4704494774341583
loss_pred:0.02036266028881073, decouple_loss:0.004746471997350454
Iteration: 4716, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4456326365470886
loss_pred:0.023184554651379585, decouple_loss:0.0051775407046079636
The generated pressure mean: 0.4478461742401123
loss_pred:0.02147245965898037, decouple_loss:0.005030327942222357
The generated pressure mean: 0.4466952383518219
loss_pred:0.021867943927645683, decouple_loss:0.004936035256832838
Iteration: 4717, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43068453669548035
loss_pred:0.024146487936377525, decouple_loss:0.00477199861779809
The generated pressure mean: 0.4249442219734192
loss_pred:0.02270495519042015, decouple_loss:0.004834473133087158
The generated pressure mean: 0.42840006947517395
loss_pred:0.02353382483124733, decouple_loss:0.004988083615899086
Iteration: 4718, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44761067628860474
The generated pressure mean: 0.4484627842903137
loss_pred:0.02108919434249401, decouple_loss:0.00494312634691596
loss_pred:0.02278102934360504, decouple_loss:0.004944166634231806
The generated pressure mean: 0.448337197303772
loss_pred:0.025699596852064133, decouple_loss:0.005149620585143566
Iteration: 4719, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44882187247276306
The generated pressure mean: 0.4481706917285919
loss_pred:0.02131708897650242, decouple_loss:0.005002453923225403
loss_pred:0.021461306139826775, decouple_loss:0.005124847870320082
The generated pressure mean: 0.4522625803947449
loss_pred:0.02178291417658329, decouple_loss:0.005099991802126169
Iteration: 4720, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44775065779685974
loss_pred:0.022040164098143578, decouple_loss:0.004744809120893478
The generated pressure mean: 0.45110347867012024
loss_pred:0.022113682702183723, decouple_loss:0.004730404354631901
The generated pressure mean: 0.4489913582801819
loss_pred:0.022906728088855743, decouple_loss:0.0048686140216887
2023-04-17 05:42:56 testing...
The generated pressure mean: 0.41474440693855286
The generated pressure mean: 0.4220859110355377
loss_pred:0.03474866971373558, decouple_loss:0.005305116530507803
The generated pressure mean: 0.424996554851532
loss_pred:0.033666107803583145, decouple_loss:0.005688087549060583
loss_pred:0.03342721238732338, decouple_loss:0.005988855846226215
WV_0_PC_0_EH_1_PS_40, loss: 0.03423036262392998, avg_mse: 0.04886464774608612
current test mse: 0.048865
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 4721, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44557273387908936
loss_pred:0.022419966757297516, decouple_loss:0.004924720618873835
The generated pressure mean: 0.4465958774089813
loss_pred:0.0225855503231287, decouple_loss:0.005280268844217062
The generated pressure mean: 0.44416800141334534
loss_pred:0.02337704598903656, decouple_loss:0.005073851905763149
Iteration: 4722, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4384430944919586
The generated pressure mean: 0.4412119388580322loss_pred:0.02310446836054325, decouple_loss:0.0044117155484855175
loss_pred:0.02405732497572899, decouple_loss:0.00436477130278945
The generated pressure mean: 0.43747925758361816
loss_pred:0.022213324904441833, decouple_loss:0.004398383665829897
Iteration: 4723, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45442885160446167
The generated pressure mean: 0.4507628381252289
loss_pred:0.022827036678791046, decouple_loss:0.004972287453711033
loss_pred:0.023244982585310936, decouple_loss:0.004701837431639433
The generated pressure mean: 0.4534456729888916
loss_pred:0.020920641720294952, decouple_loss:0.004878564737737179
Iteration: 4724, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44362491369247437
The generated pressure mean: 0.4435274004936218
loss_pred:0.024230044335126877, decouple_loss:0.004317587707191706
loss_pred:0.022951755672693253, decouple_loss:0.004677005112171173
The generated pressure mean: 0.44648027420043945
loss_pred:0.023109061643481255, decouple_loss:0.00437952671200037
Iteration: 4725, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4392127990722656
The generated pressure mean: 0.43430155515670776
loss_pred:0.024387137964367867, decouple_loss:0.005090711638331413
loss_pred:0.022969190031290054, decouple_loss:0.005188542418181896
The generated pressure mean: 0.4383610785007477
loss_pred:0.023630693554878235, decouple_loss:0.004926069639623165
Iteration: 4726, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4680165648460388
The generated pressure mean: 0.4662984013557434
loss_pred:0.022847304120659828, decouple_loss:0.004244607873260975
loss_pred:0.022356852889060974, decouple_loss:0.004152154549956322
The generated pressure mean: 0.4664573669433594
loss_pred:0.022213049232959747, decouple_loss:0.004504587966948748
Iteration: 4727, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462739825248718
The generated pressure mean: 0.4440762996673584
loss_pred:0.021511061117053032, decouple_loss:0.004641348961740732
loss_pred:0.02185508795082569, decouple_loss:0.004810776561498642
The generated pressure mean: 0.4398789703845978
loss_pred:0.021848492324352264, decouple_loss:0.004485233221203089
Iteration: 4728, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42580267786979675
loss_pred:0.02105664648115635, decouple_loss:0.004792131949216127
The generated pressure mean: 0.42659205198287964
loss_pred:0.02187911421060562, decouple_loss:0.00489735696464777
The generated pressure mean: 0.42496898770332336
loss_pred:0.02198432758450508, decouple_loss:0.0047254315577447414
Iteration: 4729, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45293474197387695
loss_pred:0.023502567782998085, decouple_loss:0.004862399771809578
The generated pressure mean: 0.452871710062027
loss_pred:0.023027567192912102, decouple_loss:0.004292199853807688
The generated pressure mean: 0.4499313533306122
loss_pred:0.021384473890066147, decouple_loss:0.00436975946649909
Iteration: 4730, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4640829563140869
The generated pressure mean: 0.4651891887187958
loss_pred:0.022806309163570404, decouple_loss:0.00442230561748147
loss_pred:0.02251370996236801, decouple_loss:0.004343705251812935
The generated pressure mean: 0.46833011507987976
loss_pred:0.024257788434624672, decouple_loss:0.004437326453626156
2023-04-17 05:45:25 testing...
The generated pressure mean: 0.4180239140987396
The generated pressure mean: 0.426004022359848
loss_pred:0.03375549614429474, decouple_loss:0.005501440726220608
The generated pressure mean: 0.42927274107933044
loss_pred:0.03294551372528076, decouple_loss:0.005658192094415426
loss_pred:0.0328512080013752, decouple_loss:0.0057808635756373405
WV_0_PC_0_EH_1_PS_40, loss: 0.033466413617134094, avg_mse: 0.04734065383672714
current test mse: 0.047341
Iteration: 4731, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43429070711135864
loss_pred:0.023789776489138603, decouple_loss:0.004973696079105139
The generated pressure mean: 0.43175870180130005
loss_pred:0.022425511851906776, decouple_loss:0.004890393000096083
The generated pressure mean: 0.43442466855049133
loss_pred:0.024798283353447914, decouple_loss:0.004872424528002739
Iteration: 4732, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4384033977985382
loss_pred:0.022370509803295135, decouple_loss:0.004774495959281921
The generated pressure mean: 0.44061991572380066
loss_pred:0.02151671051979065, decouple_loss:0.004780265036970377
The generated pressure mean: 0.4439486563205719
loss_pred:0.023976601660251617, decouple_loss:0.004557918757200241
Iteration: 4733, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4535638391971588
loss_pred:0.022447044029831886, decouple_loss:0.004227999597787857
The generated pressure mean: 0.45549455285072327
loss_pred:0.023266514763236046, decouple_loss:0.004223586991429329
The generated pressure mean: 0.45370975136756897
loss_pred:0.021012073382735252, decouple_loss:0.004151887726038694
Iteration: 4734, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490579068660736
loss_pred:0.02248394675552845, decouple_loss:0.005137319676578045
The generated pressure mean: 0.44668737053871155
loss_pred:0.022238092496991158, decouple_loss:0.005037381779402494
The generated pressure mean: 0.4486367702484131
loss_pred:0.02353059872984886, decouple_loss:0.0050256261602044106
Iteration: 4735, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4362969696521759
loss_pred:0.0224593598395586, decouple_loss:0.00523426104336977
The generated pressure mean: 0.43914374709129333
loss_pred:0.023161862045526505, decouple_loss:0.005279507488012314
The generated pressure mean: 0.43804723024368286
loss_pred:0.022872481495141983, decouple_loss:0.005477097816765308
Iteration: 4736, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45035067200660706
loss_pred:0.021343253552913666, decouple_loss:0.004251506179571152
The generated pressure mean: 0.4501875936985016
loss_pred:0.02230965346097946, decouple_loss:0.004075045231729746
The generated pressure mean: 0.45352500677108765
loss_pred:0.021755510941147804, decouple_loss:0.004111920017749071
Iteration: 4737, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4518957734107971
loss_pred:0.021493269130587578, decouple_loss:0.004884280730038881
The generated pressure mean: 0.45453548431396484
The generated pressure mean: 0.4521501660346985
loss_pred:0.022212328389286995, decouple_loss:0.004954638425260782
loss_pred:0.02220502309501171, decouple_loss:0.005083282478153706
Iteration: 4738, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4445190727710724
loss_pred:0.02221628464758396, decouple_loss:0.005577785894274712
The generated pressure mean: 0.44201377034187317
loss_pred:0.02131062000989914, decouple_loss:0.005757653154432774
The generated pressure mean: 0.4409472942352295
loss_pred:0.021828625351190567, decouple_loss:0.0057309893891215324
Iteration: 4739, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4401933550834656
loss_pred:0.022333869710564613, decouple_loss:0.0040226043201982975
The generated pressure mean: 0.4412854313850403
loss_pred:0.021166544407606125, decouple_loss:0.003977231215685606
The generated pressure mean: 0.43783819675445557
loss_pred:0.02140679769217968, decouple_loss:0.0042016287334263325
Iteration: 4740, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4514559805393219
loss_pred:0.022375598549842834, decouple_loss:0.005179900676012039
The generated pressure mean: 0.44626060128211975
loss_pred:0.021773383021354675, decouple_loss:0.0050242021679878235
The generated pressure mean: 0.4486481547355652
loss_pred:0.0211085993796587, decouple_loss:0.005112641025334597
2023-04-17 05:47:18 testing...
The generated pressure mean: 0.41426220536231995
The generated pressure mean: 0.4229656457901001
The generated pressure mean: 0.4263656437397003
loss_pred:0.03573663532733917, decouple_loss:0.006243864540010691
loss_pred:0.034343887120485306, decouple_loss:0.006595277693122625
loss_pred:0.03412448614835739, decouple_loss:0.006366257555782795
WV_0_PC_0_EH_1_PS_40, loss: 0.035055093467235565, avg_mse: 0.05068359151482582
current test mse: 0.050684
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 4741, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4541594982147217
loss_pred:0.021536948159337044, decouple_loss:0.005749728996306658
The generated pressure mean: 0.44998499751091003
loss_pred:0.02202279306948185, decouple_loss:0.005772602278739214
The generated pressure mean: 0.4497765004634857
loss_pred:0.021605782210826874, decouple_loss:0.006014610640704632
Iteration: 4742, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45065292716026306
loss_pred:0.022610969841480255, decouple_loss:0.004118051379919052
The generated pressure mean: 0.44343554973602295
loss_pred:0.022309107705950737, decouple_loss:0.0042600785382092
The generated pressure mean: 0.4469052255153656
loss_pred:0.02139916829764843, decouple_loss:0.004235337022691965
Iteration: 4743, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44212397933006287
loss_pred:0.02177830971777439, decouple_loss:0.005060992669314146
The generated pressure mean: 0.4452519416809082
loss_pred:0.021740397438406944, decouple_loss:0.005234349053353071
The generated pressure mean: 0.43887317180633545
loss_pred:0.021573461592197418, decouple_loss:0.005075221415609121
Iteration: 4744, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464181959629059
loss_pred:0.023246392607688904, decouple_loss:0.005911654327064753
The generated pressure mean: 0.45203086733818054
loss_pred:0.022679103538393974, decouple_loss:0.00594262033700943
The generated pressure mean: 0.4520556926727295
loss_pred:0.021919256076216698, decouple_loss:0.00607946515083313
Iteration: 4745, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44915059208869934
The generated pressure mean: 0.4462414085865021
loss_pred:0.02200978808104992, decouple_loss:0.004338894505053759
loss_pred:0.022227374836802483, decouple_loss:0.004217717796564102
The generated pressure mean: 0.44665059447288513
loss_pred:0.023517897352576256, decouple_loss:0.004180113784968853
Iteration: 4746, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4387769103050232
loss_pred:0.022806497290730476, decouple_loss:0.0055893887765705585
The generated pressure mean: 0.43429070711135864
loss_pred:0.02278914302587509, decouple_loss:0.0057555437088012695
The generated pressure mean: 0.43573540449142456
loss_pred:0.02125447802245617, decouple_loss:0.00575278140604496
Iteration: 4747, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45117777585983276
The generated pressure mean: 0.45464202761650085
loss_pred:0.02163250558078289, decouple_loss:0.0054603805765509605
loss_pred:0.022727282717823982, decouple_loss:0.005070152692496777
The generated pressure mean: 0.4501763880252838
loss_pred:0.02239678055047989, decouple_loss:0.005407698452472687
Iteration: 4748, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4543471336364746
loss_pred:0.021148081868886948, decouple_loss:0.00467646773904562
The generated pressure mean: 0.4518314003944397
loss_pred:0.020444100722670555, decouple_loss:0.0048419516533613205
The generated pressure mean: 0.4520389437675476
loss_pred:0.022767210379242897, decouple_loss:0.004795669112354517
Iteration: 4749, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4413926899433136
loss_pred:0.021995222195982933, decouple_loss:0.0063529228791594505
The generated pressure mean: 0.44072818756103516
loss_pred:0.02170402929186821, decouple_loss:0.006093510892242193
The generated pressure mean: 0.4477941691875458
loss_pred:0.0226096473634243, decouple_loss:0.006079412531107664
Iteration: 4750, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44920945167541504
loss_pred:0.022416822612285614, decouple_loss:0.00524376705288887
The generated pressure mean: 0.44824573397636414
The generated pressure mean: 0.4534456431865692
loss_pred:0.020370490849018097, decouple_loss:0.005203831009566784
loss_pred:0.02175687626004219, decouple_loss:0.005116833373904228
2023-04-17 05:49:45 testing...
The generated pressure mean: 0.4242804944515228
The generated pressure mean: 0.4162883758544922
The generated pressure mean: 0.42743465304374695
loss_pred:0.03300502151250839, decouple_loss:0.005793717224150896
loss_pred:0.033938389271497726, decouple_loss:0.005513079464435577
loss_pred:0.0327865406870842, decouple_loss:0.0060571772046387196
WV_0_PC_0_EH_1_PS_40, loss: 0.03353271633386612, avg_mse: 0.047970786690711975
current test mse: 0.047971
Iteration: 4751, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44702786207199097
The generated pressure mean: 0.4475689232349396
loss_pred:0.02130414918065071, decouple_loss:0.004675491712987423
loss_pred:0.020580440759658813, decouple_loss:0.004637765698134899
The generated pressure mean: 0.44622698426246643
loss_pred:0.02112206071615219, decouple_loss:0.004760376643389463
Iteration: 4752, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4403766989707947
loss_pred:0.022506358101963997, decouple_loss:0.006150367204099894
The generated pressure mean: 0.443089097738266
loss_pred:0.020877130329608917, decouple_loss:0.006095327436923981
The generated pressure mean: 0.44231560826301575
loss_pred:0.02116890251636505, decouple_loss:0.006302833557128906
Iteration: 4753, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478961229324341
loss_pred:0.022266924381256104, decouple_loss:0.004723775666207075
The generated pressure mean: 0.44775399565696716
loss_pred:0.021087979897856712, decouple_loss:0.004728402942419052
The generated pressure mean: 0.44763290882110596
loss_pred:0.02117936685681343, decouple_loss:0.0046996669843792915
Iteration: 4754, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485890865325928
loss_pred:0.027338571846485138, decouple_loss:0.006052100565284491
The generated pressure mean: 0.45149844884872437
loss_pred:0.02085031196475029, decouple_loss:0.006063393782824278
The generated pressure mean: 0.4506845772266388
loss_pred:0.02238394133746624, decouple_loss:0.006115081254392862
Iteration: 4755, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.41786399483680725
loss_pred:0.021522901952266693, decouple_loss:0.006325329188257456
The generated pressure mean: 0.42205050587654114
loss_pred:0.022500086575746536, decouple_loss:0.006031462457031012
The generated pressure mean: 0.4164581000804901
loss_pred:0.022097786888480186, decouple_loss:0.006056304555386305
Iteration: 4756, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4510740339756012
loss_pred:0.023194676265120506, decouple_loss:0.005610289517790079
The generated pressure mean: 0.4512728452682495
loss_pred:0.021470656618475914, decouple_loss:0.005539899691939354
The generated pressure mean: 0.4538193643093109
loss_pred:0.022413203492760658, decouple_loss:0.005783798173069954
Iteration: 4757, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4810299575328827
loss_pred:0.022851774469017982, decouple_loss:0.005428561475127935
The generated pressure mean: 0.47270408272743225
loss_pred:0.023178081959486008, decouple_loss:0.005491544958204031
The generated pressure mean: 0.4727311134338379
loss_pred:0.023054951801896095, decouple_loss:0.005528844427317381
Iteration: 4758, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43683063983917236
loss_pred:0.023025523871183395, decouple_loss:0.005582720506936312
The generated pressure mean: 0.4353901147842407
loss_pred:0.02172844111919403, decouple_loss:0.005585233215242624
The generated pressure mean: 0.43823912739753723
loss_pred:0.02305425889790058, decouple_loss:0.005483697634190321
Iteration: 4759, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42931729555130005
loss_pred:0.020570198073983192, decouple_loss:0.004548320546746254
The generated pressure mean: 0.42571088671684265
loss_pred:0.022229408845305443, decouple_loss:0.0042604487389326096
The generated pressure mean: 0.4277414381504059
loss_pred:0.02423093654215336, decouple_loss:0.004472114611417055
Iteration: 4760, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45035725831985474
loss_pred:0.020489148795604706, decouple_loss:0.004969511181116104
The generated pressure mean: 0.449310302734375
loss_pred:0.023014122620224953, decouple_loss:0.004895718302577734
The generated pressure mean: 0.4568760097026825
loss_pred:0.021447334438562393, decouple_loss:0.004911575932055712
2023-04-17 05:51:39 testing...
The generated pressure mean: 0.4132935702800751
The generated pressure mean: 0.42174434661865234
The generated pressure mean: 0.4255591332912445
loss_pred:0.037463847547769547, decouple_loss:0.004987271502614021
loss_pred:0.036517184227705, decouple_loss:0.005278351251035929
loss_pred:0.03634092956781387, decouple_loss:0.005542023107409477
WV_0_PC_0_EH_1_PS_40, loss: 0.0370374470949173, avg_mse: 0.054752979427576065
current test mse: 0.054753
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 4761, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.461948961019516
loss_pred:0.02312704361975193, decouple_loss:0.004380795639008284
The generated pressure mean: 0.45951974391937256
loss_pred:0.021275300532579422, decouple_loss:0.004117767326533794
The generated pressure mean: 0.4563908874988556
loss_pred:0.022918028756976128, decouple_loss:0.004351489711552858
Iteration: 4762, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4291928708553314
The generated pressure mean: 0.4286918044090271
loss_pred:0.021734710782766342, decouple_loss:0.00430072657763958
loss_pred:0.022300774231553078, decouple_loss:0.004184471443295479
The generated pressure mean: 0.4288618564605713
loss_pred:0.0236338023096323, decouple_loss:0.004235078580677509
Iteration: 4763, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4544333815574646
The generated pressure mean: 0.4508798122406006
loss_pred:0.022831972688436508, decouple_loss:0.004453086759895086
loss_pred:0.02400980517268181, decouple_loss:0.0047105420380830765
The generated pressure mean: 0.4525514841079712
loss_pred:0.022527435794472694, decouple_loss:0.004211455583572388
Iteration: 4764, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449124276638031
The generated pressure mean: 0.45453205704689026
loss_pred:0.021165180951356888, decouple_loss:0.004566033370792866
loss_pred:0.021753787994384766, decouple_loss:0.004786492791026831
The generated pressure mean: 0.45486170053482056
loss_pred:0.022387878969311714, decouple_loss:0.00491929380223155
Iteration: 4765, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44618433713912964
loss_pred:0.021389301866292953, decouple_loss:0.004649066831916571
The generated pressure mean: 0.4496648609638214
loss_pred:0.02108115702867508, decouple_loss:0.004519751761108637
The generated pressure mean: 0.4410947859287262
loss_pred:0.023870136588811874, decouple_loss:0.004536395892500877
Iteration: 4766, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508037269115448
The generated pressure mean: 0.4503115713596344
loss_pred:0.02119816094636917, decouple_loss:0.004727671388536692
loss_pred:0.021319249644875526, decouple_loss:0.00478900084272027
The generated pressure mean: 0.44503912329673767
loss_pred:0.021482279524207115, decouple_loss:0.004793009255081415
Iteration: 4767, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44785642623901367
The generated pressure mean: 0.4529198706150055loss_pred:0.02113582193851471, decouple_loss:0.004497456829994917
loss_pred:0.022085638716816902, decouple_loss:0.004610199946910143
The generated pressure mean: 0.4452377259731293
loss_pred:0.021404707804322243, decouple_loss:0.004325677640736103
Iteration: 4768, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43811383843421936
The generated pressure mean: 0.44156453013420105
loss_pred:0.020038317888975143, decouple_loss:0.004393175709992647
loss_pred:0.021780431270599365, decouple_loss:0.004780659917742014
The generated pressure mean: 0.4317632019519806
loss_pred:0.02146870084106922, decouple_loss:0.00480609480291605
Iteration: 4769, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481172263622284
loss_pred:0.020839985460042953, decouple_loss:0.00451385835185647
The generated pressure mean: 0.4471549391746521
loss_pred:0.021288752555847168, decouple_loss:0.004390413407236338
The generated pressure mean: 0.4390595257282257
loss_pred:0.02294277399778366, decouple_loss:0.004791951272636652
Iteration: 4770, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4517398178577423
The generated pressure mean: 0.4536563456058502
loss_pred:0.022049807012081146, decouple_loss:0.005334382876753807
loss_pred:0.02157953754067421, decouple_loss:0.005394244100898504
The generated pressure mean: 0.4520321190357208
loss_pred:0.023760275915265083, decouple_loss:0.0056792027316987514
2023-04-17 05:54:07 testing...
The generated pressure mean: 0.41422390937805176
The generated pressure mean: 0.4220682680606842
loss_pred:0.034190576523542404, decouple_loss:0.005287889391183853
The generated pressure mean: 0.4248824417591095
loss_pred:0.033005133271217346, decouple_loss:0.0054837604984641075
loss_pred:0.032974500209093094, decouple_loss:0.00565588753670454
WV_0_PC_0_EH_1_PS_40, loss: 0.03366386145353317, avg_mse: 0.04810724034905434
current test mse: 0.048107
Iteration: 4771, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4448978900909424
loss_pred:0.021600067615509033, decouple_loss:0.004199746996164322
The generated pressure mean: 0.44831791520118713
loss_pred:0.021962733939290047, decouple_loss:0.004268688149750233
The generated pressure mean: 0.4441142976284027
loss_pred:0.021998604759573936, decouple_loss:0.004199701827019453
Iteration: 4772, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44807013869285583
loss_pred:0.02296333946287632, decouple_loss:0.006480741780251265
The generated pressure mean: 0.44146728515625
loss_pred:0.023150494322180748, decouple_loss:0.0064309509471058846
The generated pressure mean: 0.44466355443000793
loss_pred:0.020364224910736084, decouple_loss:0.006196592468768358
Iteration: 4773, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44319048523902893
The generated pressure mean: 0.4430420994758606
loss_pred:0.022784968838095665, decouple_loss:0.004557688720524311
loss_pred:0.022098027169704437, decouple_loss:0.0044842371717095375
The generated pressure mean: 0.4443373382091522
loss_pred:0.02236911654472351, decouple_loss:0.004570881836116314
Iteration: 4774, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465593099594116
loss_pred:0.023323141038417816, decouple_loss:0.004211877007037401
The generated pressure mean: 0.45303651690483093
loss_pred:0.02085360698401928, decouple_loss:0.004126519896090031
The generated pressure mean: 0.44715943932533264
loss_pred:0.020973557606339455, decouple_loss:0.004192000720649958
Iteration: 4775, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4548770487308502
loss_pred:0.022260533645749092, decouple_loss:0.00603523151949048
The generated pressure mean: 0.44623416662216187
loss_pred:0.02193724364042282, decouple_loss:0.006124686449766159
The generated pressure mean: 0.4507869780063629
loss_pred:0.02152763120830059, decouple_loss:0.005813112948089838
Iteration: 4776, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4407762289047241
loss_pred:0.021144650876522064, decouple_loss:0.004663833882659674
The generated pressure mean: 0.43830034136772156
The generated pressure mean: 0.44344091415405273
loss_pred:0.022839490324258804, decouple_loss:0.004499154165387154
loss_pred:0.021992092952132225, decouple_loss:0.00440299604088068
Iteration: 4777, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4406142234802246
loss_pred:0.0206177718937397, decouple_loss:0.004287969786673784
The generated pressure mean: 0.4397338032722473
loss_pred:0.02188187465071678, decouple_loss:0.004046989139169455
The generated pressure mean: 0.4472815692424774
loss_pred:0.020891135558485985, decouple_loss:0.004265185911208391
Iteration: 4778, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4550549387931824
loss_pred:0.022259235382080078, decouple_loss:0.004933653865009546
The generated pressure mean: 0.45184555649757385
loss_pred:0.021478883922100067, decouple_loss:0.0049107749946415424
The generated pressure mean: 0.4539056420326233
loss_pred:0.021978147327899933, decouple_loss:0.005059353541582823
Iteration: 4779, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45088374614715576
loss_pred:0.023621978238224983, decouple_loss:0.004662871360778809
The generated pressure mean: 0.45187509059906006
The generated pressure mean: 0.45049309730529785
loss_pred:0.02166459523141384, decouple_loss:0.004605086985975504
loss_pred:0.020641589537262917, decouple_loss:0.004654363729059696
Iteration: 4780, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43461206555366516
loss_pred:0.02126288041472435, decouple_loss:0.004807449411600828
The generated pressure mean: 0.4380451440811157
The generated pressure mean: 0.42800024151802063
loss_pred:0.021285399794578552, decouple_loss:0.004896262660622597
loss_pred:0.02159322425723076, decouple_loss:0.004900006577372551
2023-04-17 05:56:00 testing...
The generated pressure mean: 0.4245671331882477
The generated pressure mean: 0.41614285111427307
loss_pred:0.034818682819604874, decouple_loss:0.005773562006652355
The generated pressure mean: 0.42706432938575745
loss_pred:0.03646953031420708, decouple_loss:0.0054930527694523335
loss_pred:0.03483956307172775, decouple_loss:0.005985001567751169
WV_0_PC_0_EH_1_PS_40, loss: 0.03566345199942589, avg_mse: 0.051815345883369446
current test mse: 0.051815
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 4781, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4455060362815857
loss_pred:0.02139381878077984, decouple_loss:0.004602598957717419
The generated pressure mean: 0.44965896010398865
loss_pred:0.02131732739508152, decouple_loss:0.004615880083292723
The generated pressure mean: 0.44057005643844604
loss_pred:0.020990267395973206, decouple_loss:0.004774936940521002
Iteration: 4782, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4528837502002716
The generated pressure mean: 0.45761221647262573
loss_pred:0.02124440111219883, decouple_loss:0.004786876030266285
loss_pred:0.021550891920924187, decouple_loss:0.004533210303634405
The generated pressure mean: 0.4560536742210388
loss_pred:0.022987036034464836, decouple_loss:0.004668001085519791
Iteration: 4783, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4533146023750305
The generated pressure mean: 0.4557282328605652
loss_pred:0.021852802485227585, decouple_loss:0.005856045056134462
loss_pred:0.02409416064620018, decouple_loss:0.0055413623340427876
The generated pressure mean: 0.4519358277320862
loss_pred:0.02180938981473446, decouple_loss:0.005712533835321665
Iteration: 4784, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4376811683177948
loss_pred:0.021374264732003212, decouple_loss:0.0047977389767766
The generated pressure mean: 0.4388613998889923
loss_pred:0.022372514009475708, decouple_loss:0.004788069054484367
The generated pressure mean: 0.43822935223579407
loss_pred:0.02112032286822796, decouple_loss:0.004703015089035034
Iteration: 4785, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44661882519721985
loss_pred:0.02195977047085762, decouple_loss:0.005101116839796305
The generated pressure mean: 0.44208505749702454
loss_pred:0.02088472992181778, decouple_loss:0.004772215150296688
The generated pressure mean: 0.4451047480106354
loss_pred:0.021541433408856392, decouple_loss:0.005100998096168041
Iteration: 4786, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508998692035675
The generated pressure mean: 0.4509499967098236
loss_pred:0.021326502785086632, decouple_loss:0.004791295621544123
loss_pred:0.023214692249894142, decouple_loss:0.004849829711019993
The generated pressure mean: 0.4481937885284424
loss_pred:0.02336474135518074, decouple_loss:0.004882627632468939
Iteration: 4787, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481017291545868
The generated pressure mean: 0.4452345371246338
loss_pred:0.02299708127975464, decouple_loss:0.005424828268587589
loss_pred:0.022453419864177704, decouple_loss:0.005197865888476372
The generated pressure mean: 0.44650110602378845
loss_pred:0.023813795298337936, decouple_loss:0.005220953840762377
Iteration: 4788, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44429856538772583
loss_pred:0.0212594922631979, decouple_loss:0.004426921252161264
The generated pressure mean: 0.4430253505706787
loss_pred:0.020684359595179558, decouple_loss:0.004604213405400515
The generated pressure mean: 0.4430030286312103
loss_pred:0.02364610880613327, decouple_loss:0.004723286721855402
Iteration: 4789, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498407542705536
The generated pressure mean: 0.449515163898468
loss_pred:0.02168256603181362, decouple_loss:0.004732598550617695
loss_pred:0.020787112414836884, decouple_loss:0.004983036778867245
The generated pressure mean: 0.4520658552646637
loss_pred:0.020985357463359833, decouple_loss:0.00489404983818531
Iteration: 4790, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508119523525238
loss_pred:0.02162589132785797, decouple_loss:0.0048082806169986725
The generated pressure mean: 0.4491455852985382
loss_pred:0.022562483325600624, decouple_loss:0.004959451034665108
The generated pressure mean: 0.4535946249961853
loss_pred:0.02364162914454937, decouple_loss:0.004850470926612616
2023-04-17 05:58:26 testing...
The generated pressure mean: 0.41612234711647034
The generated pressure mean: 0.4246636927127838
The generated pressure mean: 0.4278359115123749
loss_pred:0.03410884365439415, decouple_loss:0.005440954118967056
loss_pred:0.0329890139400959, decouple_loss:0.005708896089345217
loss_pred:0.03267478570342064, decouple_loss:0.005904633551836014
WV_0_PC_0_EH_1_PS_40, loss: 0.03354179114103317, avg_mse: 0.047941192984580994
current test mse: 0.047941
Iteration: 4791, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4364853501319885
loss_pred:0.021712779998779297, decouple_loss:0.004681187681853771
The generated pressure mean: 0.44322434067726135
loss_pred:0.021416977047920227, decouple_loss:0.004532143007963896
The generated pressure mean: 0.443153977394104
loss_pred:0.022366788238286972, decouple_loss:0.0045980047434568405
Iteration: 4792, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44475746154785156
loss_pred:0.022009532898664474, decouple_loss:0.005658190231770277
The generated pressure mean: 0.44766944646835327
loss_pred:0.020647527649998665, decouple_loss:0.005972821265459061
The generated pressure mean: 0.44631427526474
loss_pred:0.022940032184123993, decouple_loss:0.005590193439275026
Iteration: 4793, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45373621582984924
loss_pred:0.02321186102926731, decouple_loss:0.004897098056972027
The generated pressure mean: 0.4493168294429779
loss_pred:0.021771904081106186, decouple_loss:0.004757949151098728
The generated pressure mean: 0.4499894380569458
loss_pred:0.023015907034277916, decouple_loss:0.004793674685060978
Iteration: 4794, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45453450083732605
loss_pred:0.022725656628608704, decouple_loss:0.007301669102162123
The generated pressure mean: 0.44801485538482666
loss_pred:0.022383196279406548, decouple_loss:0.007214713376015425
The generated pressure mean: 0.4477730393409729
loss_pred:0.021150557324290276, decouple_loss:0.006998784840106964
Iteration: 4795, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487370550632477
loss_pred:0.023214289918541908, decouple_loss:0.00603402778506279
The generated pressure mean: 0.44809213280677795
loss_pred:0.021761367097496986, decouple_loss:0.006019207648932934
The generated pressure mean: 0.4454866945743561
loss_pred:0.021393656730651855, decouple_loss:0.005919074639678001
Iteration: 4796, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44669869542121887
loss_pred:0.02105792798101902, decouple_loss:0.009062803350389004
The generated pressure mean: 0.4407811462879181
The generated pressure mean: 0.4404003322124481
loss_pred:0.02157873660326004, decouple_loss:0.009305841289460659
loss_pred:0.021399999037384987, decouple_loss:0.008458208292722702
Iteration: 4797, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45085394382476807
loss_pred:0.0234221238642931, decouple_loss:0.006493547465652227
The generated pressure mean: 0.4553547501564026
loss_pred:0.02200004830956459, decouple_loss:0.006628730800002813
The generated pressure mean: 0.45435529947280884
loss_pred:0.0204043947160244, decouple_loss:0.006555747240781784
Iteration: 4798, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44440728425979614
loss_pred:0.0217597559094429, decouple_loss:0.007806624285876751
The generated pressure mean: 0.4475695788860321
The generated pressure mean: 0.4457460045814514
loss_pred:0.02102290652692318, decouple_loss:0.007912717759609222
loss_pred:0.022338557988405228, decouple_loss:0.007927010767161846
Iteration: 4799, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44465139508247375
loss_pred:0.02209819108247757, decouple_loss:0.006241840776056051
The generated pressure mean: 0.4529871642589569
loss_pred:0.023080045357346535, decouple_loss:0.006274532992392778
The generated pressure mean: 0.44675517082214355
loss_pred:0.020756326615810394, decouple_loss:0.006135123781859875
Iteration: 4800, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44692370295524597
loss_pred:0.02219339646399021, decouple_loss:0.005376758053898811
The generated pressure mean: 0.4457399249076843
loss_pred:0.02129276469349861, decouple_loss:0.005480801220983267
The generated pressure mean: 0.44663676619529724
loss_pred:0.020492034032940865, decouple_loss:0.005997662432491779
2023-04-17 06:00:19 testing...
The generated pressure mean: 0.42454442381858826
The generated pressure mean: 0.41518038511276245
loss_pred:0.03387065604329109, decouple_loss:0.007119623012840748
The generated pressure mean: 0.4281086027622223
loss_pred:0.03508177772164345, decouple_loss:0.006840240675956011
loss_pred:0.03318677470088005, decouple_loss:0.007386025972664356
WV_0_PC_0_EH_1_PS_40, loss: 0.03440216928720474, avg_mse: 0.04992521554231644
current test mse: 0.049925
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 4801, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479430615901947
loss_pred:0.022291995584964752, decouple_loss:0.006235700566321611
The generated pressure mean: 0.44871121644973755
loss_pred:0.02176562137901783, decouple_loss:0.006559847854077816
The generated pressure mean: 0.44467389583587646
loss_pred:0.022058838978409767, decouple_loss:0.006386732682585716
Iteration: 4802, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4410453736782074
The generated pressure mean: 0.44426867365837097
loss_pred:0.022633221000432968, decouple_loss:0.005287747364491224
loss_pred:0.022605564445257187, decouple_loss:0.005159494001418352
The generated pressure mean: 0.4476490020751953
loss_pred:0.023936044424772263, decouple_loss:0.005238494370132685
Iteration: 4803, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4571143686771393
The generated pressure mean: 0.45656874775886536
loss_pred:0.022081756964325905, decouple_loss:0.0047131977044045925
loss_pred:0.02051488868892193, decouple_loss:0.004652863368391991
The generated pressure mean: 0.4585643708705902
loss_pred:0.02076769806444645, decouple_loss:0.004712630994617939
Iteration: 4804, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4519840180873871The generated pressure mean: 0.45399630069732666
loss_pred:0.02208549901843071, decouple_loss:0.00610813032835722
loss_pred:0.02146773971617222, decouple_loss:0.006243234965950251
The generated pressure mean: 0.45386338233947754
loss_pred:0.02139906771481037, decouple_loss:0.00627174461260438
Iteration: 4805, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4397789537906647
The generated pressure mean: 0.43817993998527527
loss_pred:0.022459935396909714, decouple_loss:0.005020934157073498
loss_pred:0.0224248468875885, decouple_loss:0.00476327259093523
The generated pressure mean: 0.44032588601112366
loss_pred:0.022342488169670105, decouple_loss:0.004797565750777721
Iteration: 4806, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459429383277893
The generated pressure mean: 0.45311596989631653
loss_pred:0.021764550358057022, decouple_loss:0.004479017108678818
loss_pred:0.022452229633927345, decouple_loss:0.0044915215112268925
The generated pressure mean: 0.4500829577445984
loss_pred:0.021987149491906166, decouple_loss:0.004536091815680265
Iteration: 4807, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.454307496547699
The generated pressure mean: 0.4547032415866852
loss_pred:0.022211022675037384, decouple_loss:0.005487493239343166
loss_pred:0.02111056074500084, decouple_loss:0.005391694139689207
The generated pressure mean: 0.44902101159095764
loss_pred:0.022279944270849228, decouple_loss:0.005466710776090622
Iteration: 4808, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483773112297058
loss_pred:0.022411128506064415, decouple_loss:0.004670816473662853
The generated pressure mean: 0.44779860973358154
loss_pred:0.021602429449558258, decouple_loss:0.004587239120155573
The generated pressure mean: 0.4488507807254791
loss_pred:0.022474749013781548, decouple_loss:0.004502246621996164
Iteration: 4809, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.442368745803833
The generated pressure mean: 0.4422703683376312
loss_pred:0.022546939551830292, decouple_loss:0.004489599261432886
loss_pred:0.020764783024787903, decouple_loss:0.004423476289957762
The generated pressure mean: 0.44302383065223694
loss_pred:0.022179698571562767, decouple_loss:0.004461408127099276
Iteration: 4810, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498782753944397
loss_pred:0.023726938292384148, decouple_loss:0.004024503752589226
The generated pressure mean: 0.4567511975765228
loss_pred:0.022390933707356453, decouple_loss:0.004063897766172886
The generated pressure mean: 0.4495721757411957
loss_pred:0.02153867855668068, decouple_loss:0.004226129502058029
2023-04-17 06:02:47 testing...
The generated pressure mean: 0.4138754904270172
The generated pressure mean: 0.42253372073173523
The generated pressure mean: 0.4260009527206421
loss_pred:0.03494443744421005, decouple_loss:0.005783901549875736
loss_pred:0.0338897705078125, decouple_loss:0.006038012448698282
loss_pred:0.03365946188569069, decouple_loss:0.006229373160749674
WV_0_PC_0_EH_1_PS_40, loss: 0.03446541354060173, avg_mse: 0.05004588142037392
current test mse: 0.050046
Iteration: 4811, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4514409303665161
loss_pred:0.021365929394960403, decouple_loss:0.004977010190486908
The generated pressure mean: 0.45178931951522827
loss_pred:0.020475320518016815, decouple_loss:0.0047146230936050415
The generated pressure mean: 0.45964500308036804
loss_pred:0.02250954695045948, decouple_loss:0.004963555373251438
Iteration: 4812, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498870372772217
loss_pred:0.02178274653851986, decouple_loss:0.005035786889493465
The generated pressure mean: 0.4475598633289337
loss_pred:0.02234470099210739, decouple_loss:0.005527580622583628
The generated pressure mean: 0.4452713131904602
loss_pred:0.021177688613533974, decouple_loss:0.00519833667203784
Iteration: 4813, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4405611455440521
loss_pred:0.021519221365451813, decouple_loss:0.004529610276222229
The generated pressure mean: 0.4423656463623047
loss_pred:0.022843429818749428, decouple_loss:0.004764591343700886
The generated pressure mean: 0.44267794489860535
loss_pred:0.020502915605902672, decouple_loss:0.004752731416374445
Iteration: 4814, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45801880955696106
loss_pred:0.022378144785761833, decouple_loss:0.004038434009999037
The generated pressure mean: 0.45429015159606934
loss_pred:0.02264864183962345, decouple_loss:0.0039621395990252495
The generated pressure mean: 0.45404133200645447
loss_pred:0.020759660750627518, decouple_loss:0.004077140241861343
Iteration: 4815, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483749270439148
loss_pred:0.022307585924863815, decouple_loss:0.005659937858581543
The generated pressure mean: 0.4530673921108246
loss_pred:0.02285589650273323, decouple_loss:0.005357314832508564
The generated pressure mean: 0.4539605975151062
loss_pred:0.021780479699373245, decouple_loss:0.005406499840319157
Iteration: 4816, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4431339204311371
loss_pred:0.02150709368288517, decouple_loss:0.005057081114500761
The generated pressure mean: 0.43939724564552307
loss_pred:0.020928094163537025, decouple_loss:0.005468577612191439
The generated pressure mean: 0.4439035952091217
loss_pred:0.021913396194577217, decouple_loss:0.005123501643538475
Iteration: 4817, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446193128824234
loss_pred:0.02284076251089573, decouple_loss:0.003848015097901225
The generated pressure mean: 0.44705334305763245
loss_pred:0.02097734436392784, decouple_loss:0.003919344861060381
The generated pressure mean: 0.44666191935539246
loss_pred:0.02457580529153347, decouple_loss:0.003930909559130669
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4818, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45807790756225586
loss_pred:0.022274261340498924, decouple_loss:0.005390118341892958
The generated pressure mean: 0.4669116139411926
loss_pred:0.021644586697220802, decouple_loss:0.005076928995549679
The generated pressure mean: 0.4602283239364624
loss_pred:0.021224772557616234, decouple_loss:0.005441271234303713
Iteration: 4819, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44680336117744446
loss_pred:0.021418960765004158, decouple_loss:0.004276562947779894
The generated pressure mean: 0.4539220333099365
loss_pred:0.02192147821187973, decouple_loss:0.00448014959692955
The generated pressure mean: 0.44996315240859985
loss_pred:0.021792521700263023, decouple_loss:0.004252844490110874
Iteration: 4820, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43137025833129883
loss_pred:0.02112451009452343, decouple_loss:0.004569286480545998
The generated pressure mean: 0.43409571051597595
loss_pred:0.021128589287400246, decouple_loss:0.004692733287811279
The generated pressure mean: 0.43127676844596863
loss_pred:0.022662071511149406, decouple_loss:0.004645918030291796
2023-04-17 06:04:40 testing...
The generated pressure mean: 0.4208468496799469
The generated pressure mean: 0.4133121967315674
The generated pressure mean: 0.42333686351776123
loss_pred:0.0325428806245327, decouple_loss:0.005042867735028267
loss_pred:0.033610906451940536, decouple_loss:0.004770512226969004
loss_pred:0.03233063220977783, decouple_loss:0.005260175559669733
WV_0_PC_0_EH_1_PS_40, loss: 0.0330793671309948, avg_mse: 0.04716610908508301
current test mse: 0.047166
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 4821, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4548049867153168
loss_pred:0.022383185103535652, decouple_loss:0.004317492246627808
The generated pressure mean: 0.4515475630760193
loss_pred:0.02101743407547474, decouple_loss:0.004228787496685982
The generated pressure mean: 0.4494467079639435
loss_pred:0.021614206954836845, decouple_loss:0.0041917734779417515
Iteration: 4822, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45358386635780334
loss_pred:0.021773457527160645, decouple_loss:0.004590061493217945
The generated pressure mean: 0.459878146648407
loss_pred:0.02104378119111061, decouple_loss:0.004324667621403933
The generated pressure mean: 0.4601761996746063
loss_pred:0.021936947479844093, decouple_loss:0.004578188993036747
Iteration: 4823, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463299512863159
loss_pred:0.02142087183892727, decouple_loss:0.004140890669077635
The generated pressure mean: 0.445629358291626
loss_pred:0.022393688559532166, decouple_loss:0.004209309816360474
The generated pressure mean: 0.44179433584213257
loss_pred:0.022020598873496056, decouple_loss:0.004157075192779303
Iteration: 4824, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43605920672416687
loss_pred:0.021653171628713608, decouple_loss:0.004819497466087341
The generated pressure mean: 0.4385742247104645
loss_pred:0.021475408226251602, decouple_loss:0.0048027741722762585
The generated pressure mean: 0.43531617522239685
loss_pred:0.020972833037376404, decouple_loss:0.004717865493148565
Iteration: 4825, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4433070719242096
The generated pressure mean: 0.443514347076416
loss_pred:0.0220659002661705, decouple_loss:0.004049870651215315
loss_pred:0.022362427785992622, decouple_loss:0.003830822417512536
The generated pressure mean: 0.44018664956092834
loss_pred:0.021543141454458237, decouple_loss:0.003755338490009308
Iteration: 4826, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4548664689064026
loss_pred:0.022440457716584206, decouple_loss:0.004216343630105257
The generated pressure mean: 0.4510963559150696
The generated pressure mean: 0.4526013135910034
loss_pred:0.02132641151547432, decouple_loss:0.0043161348439753056
loss_pred:0.020983587950468063, decouple_loss:0.004014414735138416
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4827, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45461392402648926
loss_pred:0.0206307303160429, decouple_loss:0.004154582042247057
The generated pressure mean: 0.45327892899513245
loss_pred:0.022845039144158363, decouple_loss:0.004298774991184473
The generated pressure mean: 0.45359399914741516
loss_pred:0.02198396995663643, decouple_loss:0.004519545938819647
Iteration: 4828, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43883711099624634
The generated pressure mean: 0.44381871819496155
loss_pred:0.021771403029561043, decouple_loss:0.005216097924858332
loss_pred:0.02287059649825096, decouple_loss:0.0051843575201928616
The generated pressure mean: 0.44203057885169983
loss_pred:0.02157696522772312, decouple_loss:0.0050627319142222404
Iteration: 4829, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.437926322221756
loss_pred:0.02301345393061638, decouple_loss:0.0043671391904354095
The generated pressure mean: 0.43468189239501953
loss_pred:0.022403351962566376, decouple_loss:0.0043574064038693905
The generated pressure mean: 0.434903085231781
loss_pred:0.021500540897250175, decouple_loss:0.004318268038332462
Iteration: 4830, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45422661304473877
loss_pred:0.020992187783122063, decouple_loss:0.004565345123410225
The generated pressure mean: 0.45159196853637695
loss_pred:0.021231848746538162, decouple_loss:0.004387713503092527
The generated pressure mean: 0.45009341835975647
loss_pred:0.023224078118801117, decouple_loss:0.004468181636184454
2023-04-17 06:07:08 testing...
The generated pressure mean: 0.4152604639530182
The generated pressure mean: 0.42324233055114746
loss_pred:0.03311771899461746, decouple_loss:0.006553875282406807
The generated pressure mean: 0.42548662424087524
loss_pred:0.03186337649822235, decouple_loss:0.006691308692097664
loss_pred:0.03169605880975723, decouple_loss:0.0068771736696362495
WV_0_PC_0_EH_1_PS_40, loss: 0.03256108984351158, avg_mse: 0.04587096348404884
current test mse: 0.045871
Iteration: 4831, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44623327255249023
loss_pred:0.021642962470650673, decouple_loss:0.005855870898813009
The generated pressure mean: 0.4493767321109772
loss_pred:0.02063681185245514, decouple_loss:0.005563167855143547
The generated pressure mean: 0.44716304540634155
loss_pred:0.022356240078806877, decouple_loss:0.005756980273872614
Iteration: 4832, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44921085238456726
loss_pred:0.02249184064567089, decouple_loss:0.004408384207636118
The generated pressure mean: 0.45082637667655945
loss_pred:0.022033778950572014, decouple_loss:0.004502436611801386
The generated pressure mean: 0.4480106830596924
loss_pred:0.021518589928746223, decouple_loss:0.0044019389897584915
Iteration: 4833, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4414130449295044
The generated pressure mean: 0.4417390823364258
loss_pred:0.019991988316178322, decouple_loss:0.004820691421627998
loss_pred:0.02208319865167141, decouple_loss:0.004959602374583483
The generated pressure mean: 0.44245773553848267
loss_pred:0.022364888340234756, decouple_loss:0.004564338829368353
Iteration: 4834, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44718772172927856
loss_pred:0.021092461422085762, decouple_loss:0.005176127422600985
The generated pressure mean: 0.4443393051624298
loss_pred:0.02122412621974945, decouple_loss:0.005166524555534124
The generated pressure mean: 0.44512003660202026
loss_pred:0.02118651010096073, decouple_loss:0.005246775224804878
Iteration: 4835, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43984827399253845
The generated pressure mean: 0.4453539252281189
loss_pred:0.02225138060748577, decouple_loss:0.004757195711135864
loss_pred:0.023061182349920273, decouple_loss:0.0048136282712221146
The generated pressure mean: 0.44000428915023804
loss_pred:0.021638693287968636, decouple_loss:0.004825224634259939
Iteration: 4836, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4550752341747284
The generated pressure mean: 0.4441136419773102
loss_pred:0.02224748395383358, decouple_loss:0.004402911756187677
loss_pred:0.021057728677988052, decouple_loss:0.004427594598382711
The generated pressure mean: 0.4541369676589966
loss_pred:0.021943531930446625, decouple_loss:0.00440771272405982
Iteration: 4837, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44222939014434814
The generated pressure mean: 0.4444252848625183
loss_pred:0.0209499541670084, decouple_loss:0.004347074311226606
loss_pred:0.021709714084863663, decouple_loss:0.004439368844032288
The generated pressure mean: 0.4486848711967468
loss_pred:0.02463010512292385, decouple_loss:0.004446768667548895
Iteration: 4838, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43199092149734497
loss_pred:0.022586481645703316, decouple_loss:0.004381722304970026
The generated pressure mean: 0.43577542901039124
The generated pressure mean: 0.43266561627388
loss_pred:0.02270912379026413, decouple_loss:0.004342291504144669
loss_pred:0.022201543673872948, decouple_loss:0.004637287929654121
Iteration: 4839, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45632174611091614
loss_pred:0.020456060767173767, decouple_loss:0.003587373299524188
The generated pressure mean: 0.45462462306022644
loss_pred:0.023371299728751183, decouple_loss:0.0036820184905081987
The generated pressure mean: 0.4549896717071533
loss_pred:0.021742766723036766, decouple_loss:0.0035687836352735758
Iteration: 4840, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43846485018730164
loss_pred:0.021440349519252777, decouple_loss:0.004362745210528374
The generated pressure mean: 0.4435502886772156
The generated pressure mean: 0.4438891112804413
loss_pred:0.021138746291399002, decouple_loss:0.004134380724281073
loss_pred:0.02271399460732937, decouple_loss:0.00426057493314147
2023-04-17 06:09:01 testing...
The generated pressure mean: 0.41310712695121765
The generated pressure mean: 0.4205583333969116
The generated pressure mean: 0.4230305552482605
loss_pred:0.03575586527585983, decouple_loss:0.0051027038134634495
loss_pred:0.034279875457286835, decouple_loss:0.0053619323298335075
loss_pred:0.03402711823582649, decouple_loss:0.005575480870902538
WV_0_PC_0_EH_1_PS_40, loss: 0.03495495766401291, avg_mse: 0.0504525750875473
current test mse: 0.050453
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 4841, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.459576815366745
loss_pred:0.0210278257727623, decouple_loss:0.004835677798837423
The generated pressure mean: 0.45637232065200806
loss_pred:0.021634923294186592, decouple_loss:0.004887660965323448
The generated pressure mean: 0.45199793577194214
loss_pred:0.021802444010972977, decouple_loss:0.004615158773958683
Iteration: 4842, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461458921432495
loss_pred:0.020048508420586586, decouple_loss:0.004569804761558771
The generated pressure mean: 0.4504491984844208
loss_pred:0.022112570703029633, decouple_loss:0.0046187094412744045
The generated pressure mean: 0.4536249041557312
loss_pred:0.02159835956990719, decouple_loss:0.004700001794844866
Iteration: 4843, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4415247440338135
loss_pred:0.0207758117467165, decouple_loss:0.0058237770572304726
The generated pressure mean: 0.439409077167511
loss_pred:0.022119900211691856, decouple_loss:0.00577436201274395
The generated pressure mean: 0.4403396546840668
loss_pred:0.02160363458096981, decouple_loss:0.005795048549771309
Iteration: 4844, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4426482617855072
loss_pred:0.020559102296829224, decouple_loss:0.004617913626134396
The generated pressure mean: 0.4389805197715759
loss_pred:0.02111807093024254, decouple_loss:0.0047684707678854465
The generated pressure mean: 0.44280603528022766
loss_pred:0.020840667188167572, decouple_loss:0.004602119326591492
Iteration: 4845, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45568782091140747
loss_pred:0.022428350523114204, decouple_loss:0.004645483568310738
The generated pressure mean: 0.4603240191936493
loss_pred:0.02120952121913433, decouple_loss:0.004665698856115341
The generated pressure mean: 0.4565296769142151
loss_pred:0.0197108443826437, decouple_loss:0.0047820620238780975
Iteration: 4846, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44603052735328674
loss_pred:0.02157524786889553, decouple_loss:0.004331166855990887
The generated pressure mean: 0.45188283920288086
loss_pred:0.020817499607801437, decouple_loss:0.004143387079238892
The generated pressure mean: 0.44191262125968933
loss_pred:0.021205643191933632, decouple_loss:0.004381265956908464
Iteration: 4847, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44612422585487366
loss_pred:0.01915285922586918, decouple_loss:0.0044943648390471935
The generated pressure mean: 0.4435385465621948
loss_pred:0.022786995396018028, decouple_loss:0.004401134792715311
The generated pressure mean: 0.4447200298309326
loss_pred:0.0197959765791893, decouple_loss:0.004502871073782444
Iteration: 4848, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44556689262390137
loss_pred:0.020802035927772522, decouple_loss:0.00419860053807497
The generated pressure mean: 0.446856290102005
The generated pressure mean: 0.44957563281059265
loss_pred:0.022628484293818474, decouple_loss:0.004280072636902332
loss_pred:0.021165551617741585, decouple_loss:0.004247964359819889
Iteration: 4849, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4439975917339325
loss_pred:0.022035203874111176, decouple_loss:0.004385461565107107
The generated pressure mean: 0.4456673562526703
loss_pred:0.020651452243328094, decouple_loss:0.004165098071098328
The generated pressure mean: 0.4466264247894287
loss_pred:0.02029193565249443, decouple_loss:0.0043008350767195225
Iteration: 4850, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.453689843416214
The generated pressure mean: 0.45246779918670654
loss_pred:0.020917154848575592, decouple_loss:0.004650680348277092
loss_pred:0.0222617257386446, decouple_loss:0.004661706276237965
The generated pressure mean: 0.45210009813308716
loss_pred:0.021327964961528778, decouple_loss:0.004767581354826689
2023-04-17 06:11:28 testing...
The generated pressure mean: 0.41518813371658325
The generated pressure mean: 0.42389270663261414
The generated pressure mean: 0.4268942177295685
loss_pred:0.034227073192596436, decouple_loss:0.005363273434340954
loss_pred:0.03290995955467224, decouple_loss:0.005473259836435318
loss_pred:0.03295549750328064, decouple_loss:0.005676263011991978
WV_0_PC_0_EH_1_PS_40, loss: 0.033639393746852875, avg_mse: 0.0484452061355114
current test mse: 0.048445
Iteration: 4851, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4519903063774109
loss_pred:0.020635755732655525, decouple_loss:0.004269180819392204
The generated pressure mean: 0.4509156048297882
loss_pred:0.022158073261380196, decouple_loss:0.004341651685535908
The generated pressure mean: 0.4482337236404419
loss_pred:0.02070775255560875, decouple_loss:0.004333459306508303
Iteration: 4852, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44646432995796204
loss_pred:0.02215096913278103, decouple_loss:0.0049046967178583145
The generated pressure mean: 0.44318073987960815
loss_pred:0.0213925763964653, decouple_loss:0.004835533443838358
The generated pressure mean: 0.4440585672855377
loss_pred:0.021431786939501762, decouple_loss:0.004865592811256647
Iteration: 4853, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44003748893737793
loss_pred:0.020705515518784523, decouple_loss:0.00405569514259696
The generated pressure mean: 0.44547775387763977
loss_pred:0.020261595025658607, decouple_loss:0.004312595818191767
The generated pressure mean: 0.4420631527900696
loss_pred:0.02025463618338108, decouple_loss:0.0044957492500543594
Iteration: 4854, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4531729519367218
loss_pred:0.01930200308561325, decouple_loss:0.004892020486295223
The generated pressure mean: 0.4579983949661255
loss_pred:0.021069176495075226, decouple_loss:0.004893259145319462
The generated pressure mean: 0.46033975481987
loss_pred:0.020937489345669746, decouple_loss:0.00491824047639966
Iteration: 4855, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447060227394104
loss_pred:0.021418320015072823, decouple_loss:0.003967163152992725
The generated pressure mean: 0.44925034046173096
loss_pred:0.02026495710015297, decouple_loss:0.0037387991324067116
The generated pressure mean: 0.4490950107574463
loss_pred:0.020506728440523148, decouple_loss:0.0039011244662106037
Iteration: 4856, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497523605823517
loss_pred:0.02165222354233265, decouple_loss:0.004322243854403496
The generated pressure mean: 0.4495302438735962
The generated pressure mean: 0.45176056027412415
loss_pred:0.019715258851647377, decouple_loss:0.0046305893920362
loss_pred:0.020052023231983185, decouple_loss:0.004571552388370037
Iteration: 4857, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4361110329627991
loss_pred:0.02070424146950245, decouple_loss:0.004116242751479149
The generated pressure mean: 0.4333289861679077
loss_pred:0.020726243034005165, decouple_loss:0.004046292044222355
The generated pressure mean: 0.44252628087997437
loss_pred:0.02024606242775917, decouple_loss:0.004279265180230141
Iteration: 4858, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45158255100250244
The generated pressure mean: 0.45473340153694153
loss_pred:0.022244054824113846, decouple_loss:0.004702985752373934
loss_pred:0.021671049296855927, decouple_loss:0.004665840417146683
The generated pressure mean: 0.45361265540122986
loss_pred:0.020067710429430008, decouple_loss:0.0048176199197769165
Iteration: 4859, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4554818868637085
loss_pred:0.02273212932050228, decouple_loss:0.005733111873269081
The generated pressure mean: 0.4514380991458893
loss_pred:0.01958005502820015, decouple_loss:0.00600211787968874
The generated pressure mean: 0.45566830039024353
loss_pred:0.021328093484044075, decouple_loss:0.005923150572925806
Iteration: 4860, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44347503781318665
loss_pred:0.020624840632081032, decouple_loss:0.004423364531248808
The generated pressure mean: 0.4459065794944763
loss_pred:0.021828722208738327, decouple_loss:0.004148292820900679
The generated pressure mean: 0.44611096382141113
loss_pred:0.019624464213848114, decouple_loss:0.00434162188321352
2023-04-17 06:13:21 testing...
The generated pressure mean: 0.41700008511543274
The generated pressure mean: 0.4260401427745819
The generated pressure mean: 0.4288998544216156
loss_pred:0.03313874080777168, decouple_loss:0.0065239532850682735
loss_pred:0.03205811232328415, decouple_loss:0.006961842533200979
loss_pred:0.03189198300242424, decouple_loss:0.007106419187039137
WV_0_PC_0_EH_1_PS_40, loss: 0.03270614892244339, avg_mse: 0.04678870737552643
current test mse: 0.046789
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 4861, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44564497470855713
loss_pred:0.02064335159957409, decouple_loss:0.005660422146320343
The generated pressure mean: 0.43952736258506775
The generated pressure mean: 0.44579917192459106
loss_pred:0.02249501831829548, decouple_loss:0.005738136358559132
loss_pred:0.021659409627318382, decouple_loss:0.005888132378458977
Iteration: 4862, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4569114148616791The generated pressure mean: 0.4462532103061676
loss_pred:0.021487915888428688, decouple_loss:0.0044356463477015495loss_pred:0.021685859188437462, decouple_loss:0.004752962850034237
The generated pressure mean: 0.4517729878425598
loss_pred:0.02153589017689228, decouple_loss:0.004889348987489939
Iteration: 4863, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4440305531024933The generated pressure mean: 0.44612476229667664
loss_pred:0.02195509895682335, decouple_loss:0.004817429929971695
loss_pred:0.023189684376120567, decouple_loss:0.004683429840952158
The generated pressure mean: 0.4494582414627075
loss_pred:0.022339243441820145, decouple_loss:0.004679027013480663
Iteration: 4864, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4381674528121948
The generated pressure mean: 0.43682798743247986
loss_pred:0.020104914903640747, decouple_loss:0.004065977409482002
loss_pred:0.02127525396645069, decouple_loss:0.004170507192611694
The generated pressure mean: 0.4308052361011505
loss_pred:0.021302279084920883, decouple_loss:0.004091597627848387
Iteration: 4865, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4530976116657257
The generated pressure mean: 0.45649248361587524
loss_pred:0.021444665268063545, decouple_loss:0.00433523440733552
loss_pred:0.0222175233066082, decouple_loss:0.004259967710822821
The generated pressure mean: 0.45743393898010254
loss_pred:0.021364685148000717, decouple_loss:0.004147129599004984
Iteration: 4866, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45963987708091736
The generated pressure mean: 0.4650574028491974
loss_pred:0.021042214706540108, decouple_loss:0.004256133455783129
loss_pred:0.02205955982208252, decouple_loss:0.004261212423443794
The generated pressure mean: 0.470868855714798
loss_pred:0.021824030205607414, decouple_loss:0.004386178683489561
Iteration: 4867, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4315313994884491
The generated pressure mean: 0.43071070313453674
loss_pred:0.021119778975844383, decouple_loss:0.004566585645079613
loss_pred:0.021194232627749443, decouple_loss:0.004608397837728262
The generated pressure mean: 0.43299543857574463
loss_pred:0.021867789328098297, decouple_loss:0.004430533852428198
Iteration: 4868, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4402031898498535
The generated pressure mean: 0.446635901927948
loss_pred:0.022001497447490692, decouple_loss:0.004953315015882254
loss_pred:0.022764939814805984, decouple_loss:0.0049769943580031395
The generated pressure mean: 0.44697391986846924
loss_pred:0.021584833040833473, decouple_loss:0.005040549207478762
Iteration: 4869, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487883448600769
loss_pred:0.0202934630215168, decouple_loss:0.004561802837997675
The generated pressure mean: 0.45794039964675903
loss_pred:0.023645583540201187, decouple_loss:0.004628553055226803
The generated pressure mean: 0.4601845145225525
loss_pred:0.02100646309554577, decouple_loss:0.004481121432036161
Iteration: 4870, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4411413371562958
loss_pred:0.022317366674542427, decouple_loss:0.004069310147315264
The generated pressure mean: 0.44632232189178467
loss_pred:0.02032429352402687, decouple_loss:0.00402360875159502
The generated pressure mean: 0.44720470905303955
loss_pred:0.02173989824950695, decouple_loss:0.003884644713252783
2023-04-17 06:15:50 testing...
The generated pressure mean: 0.41604289412498474
The generated pressure mean: 0.4244134724140167
The generated pressure mean: 0.427112340927124
loss_pred:0.03304611146450043, decouple_loss:0.005849724635481834
loss_pred:0.03241056948900223, decouple_loss:0.005889042746275663
loss_pred:0.031842850148677826, decouple_loss:0.006139182485640049
WV_0_PC_0_EH_1_PS_40, loss: 0.03273114562034607, avg_mse: 0.04664665460586548
current test mse: 0.046647
Iteration: 4871, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44646158814430237
loss_pred:0.02216634713113308, decouple_loss:0.004964967258274555
The generated pressure mean: 0.44172537326812744
loss_pred:0.021078214049339294, decouple_loss:0.004777288530021906
The generated pressure mean: 0.45053109526634216
loss_pred:0.02212759107351303, decouple_loss:0.004973108414560556
Iteration: 4872, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44543203711509705
loss_pred:0.021253440529108047, decouple_loss:0.004142996855080128
The generated pressure mean: 0.4505898952484131
loss_pred:0.021952325478196144, decouple_loss:0.0041847797110676765
The generated pressure mean: 0.45754310488700867
loss_pred:0.0215753223747015, decouple_loss:0.004245372489094734
Iteration: 4873, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448991596698761
loss_pred:0.020970534533262253, decouple_loss:0.004651673603802919
The generated pressure mean: 0.44465118646621704
loss_pred:0.02390975132584572, decouple_loss:0.004644273780286312
The generated pressure mean: 0.44367715716362
loss_pred:0.022186188027262688, decouple_loss:0.004619348794221878
Iteration: 4874, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4370386004447937
loss_pred:0.02310752123594284, decouple_loss:0.004802567884325981
The generated pressure mean: 0.4335480034351349
loss_pred:0.022680973634123802, decouple_loss:0.004771479871124029
The generated pressure mean: 0.43962571024894714
loss_pred:0.022169476374983788, decouple_loss:0.0043961950577795506
Iteration: 4875, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4591207802295685
loss_pred:0.022508949041366577, decouple_loss:0.00452707102522254
The generated pressure mean: 0.46761763095855713
loss_pred:0.021704483777284622, decouple_loss:0.004309859126806259
The generated pressure mean: 0.4644570052623749
loss_pred:0.022326650097966194, decouple_loss:0.00435591209679842
Iteration: 4876, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4616105258464813
loss_pred:0.020397242158651352, decouple_loss:0.0047239577397704124
The generated pressure mean: 0.4528713822364807
loss_pred:0.02053222618997097, decouple_loss:0.004467800259590149
The generated pressure mean: 0.45088276267051697
loss_pred:0.02196972258388996, decouple_loss:0.0046336413361132145
Iteration: 4877, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4256442189216614
loss_pred:0.024316729977726936, decouple_loss:0.004536446183919907
The generated pressure mean: 0.4297316372394562
loss_pred:0.02184883877635002, decouple_loss:0.0043944865465164185
The generated pressure mean: 0.4303056299686432
loss_pred:0.022305505350232124, decouple_loss:0.004447165410965681
Iteration: 4878, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503096342086792
loss_pred:0.02032819576561451, decouple_loss:0.004009840078651905
The generated pressure mean: 0.4564155042171478
loss_pred:0.023530900478363037, decouple_loss:0.004224220756441355
The generated pressure mean: 0.45631304383277893
loss_pred:0.021802790462970734, decouple_loss:0.00394588615745306
Iteration: 4879, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491109549999237
loss_pred:0.022357793524861336, decouple_loss:0.004713373724371195
The generated pressure mean: 0.4504210352897644
loss_pred:0.023156167939305305, decouple_loss:0.004702457692474127
The generated pressure mean: 0.44932687282562256
loss_pred:0.02149605192244053, decouple_loss:0.005028384737670422
Iteration: 4880, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44464346766471863
loss_pred:0.021909115836024284, decouple_loss:0.004980701021850109
The generated pressure mean: 0.4520665109157562
loss_pred:0.022372087463736534, decouple_loss:0.005036179441958666
The generated pressure mean: 0.446157842874527
loss_pred:0.021907400339841843, decouple_loss:0.005108436103910208
2023-04-17 06:17:43 testing...
The generated pressure mean: 0.4132719039916992
The generated pressure mean: 0.4216776192188263
The generated pressure mean: 0.42494508624076843
loss_pred:0.035284943878650665, decouple_loss:0.004940034355968237
loss_pred:0.034005701541900635, decouple_loss:0.005017254035919905
loss_pred:0.03378777951002121, decouple_loss:0.005250738002359867
WV_0_PC_0_EH_1_PS_40, loss: 0.03461294248700142, avg_mse: 0.05069277808070183
current test mse: 0.050693
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 4881, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4538702666759491
loss_pred:0.021525323390960693, decouple_loss:0.00399842020124197
The generated pressure mean: 0.45067548751831055
The generated pressure mean: 0.4488453269004822loss_pred:0.022412966936826706, decouple_loss:0.004069749731570482
loss_pred:0.021225348114967346, decouple_loss:0.004158667754381895
Iteration: 4882, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43103939294815063
The generated pressure mean: 0.4298732876777649
loss_pred:0.022162461653351784, decouple_loss:0.004138034302741289
loss_pred:0.021413840353488922, decouple_loss:0.004159531556069851
The generated pressure mean: 0.42623165249824524
loss_pred:0.021010424941778183, decouple_loss:0.004073630087077618
Iteration: 4883, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44978955388069153
The generated pressure mean: 0.45522341132164
loss_pred:0.021206902340054512, decouple_loss:0.004887133836746216
loss_pred:0.021071655675768852, decouple_loss:0.004786765668541193
The generated pressure mean: 0.4472237825393677
loss_pred:0.0193497147411108, decouple_loss:0.0049118767492473125
Iteration: 4884, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4629363715648651
The generated pressure mean: 0.4682372808456421
loss_pred:0.02188989147543907, decouple_loss:0.00412855576723814
loss_pred:0.020172061398625374, decouple_loss:0.0042717345058918
The generated pressure mean: 0.47098758816719055
loss_pred:0.021113695576786995, decouple_loss:0.004257097374647856
Iteration: 4885, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44590452313423157
The generated pressure mean: 0.4447970986366272
loss_pred:0.020744865760207176, decouple_loss:0.00451930845156312
loss_pred:0.02025928720831871, decouple_loss:0.004660848993808031
The generated pressure mean: 0.44485488533973694
loss_pred:0.02080453373491764, decouple_loss:0.00450417585670948
Iteration: 4886, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42032378911972046
The generated pressure mean: 0.4246681034564972
loss_pred:0.02166471630334854, decouple_loss:0.004024140071123838
loss_pred:0.022367918863892555, decouple_loss:0.004213553853332996
The generated pressure mean: 0.4289872348308563
loss_pred:0.020686376839876175, decouple_loss:0.00404857425019145
Iteration: 4887, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4529148042201996
loss_pred:0.02204241417348385, decouple_loss:0.00420560734346509
The generated pressure mean: 0.4573495090007782
loss_pred:0.020440664142370224, decouple_loss:0.00407857820391655
The generated pressure mean: 0.4599059522151947
loss_pred:0.02117890492081642, decouple_loss:0.004106981214135885
Iteration: 4888, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47118687629699707
The generated pressure mean: 0.4654116630554199
loss_pred:0.021110933274030685, decouple_loss:0.004759418778121471
loss_pred:0.021739235147833824, decouple_loss:0.004751771688461304
The generated pressure mean: 0.4630835950374603
loss_pred:0.02046833373606205, decouple_loss:0.004760443232953548
Iteration: 4889, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44125550985336304
The generated pressure mean: 0.4407464861869812
loss_pred:0.021483495831489563, decouple_loss:0.004327508620917797
loss_pred:0.019711583852767944, decouple_loss:0.004111039452254772
The generated pressure mean: 0.44248539209365845
loss_pred:0.02007065899670124, decouple_loss:0.003984961658716202
Iteration: 4890, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42687681317329407
loss_pred:0.021088458597660065, decouple_loss:0.004570820834487677
The generated pressure mean: 0.43300849199295044
loss_pred:0.022232651710510254, decouple_loss:0.004614728502929211
The generated pressure mean: 0.4272380471229553
loss_pred:0.021841662004590034, decouple_loss:0.00455305865034461
2023-04-17 06:20:14 testing...
The generated pressure mean: 0.4222742021083832
The generated pressure mean: 0.4137103259563446
The generated pressure mean: 0.425081342458725
loss_pred:0.03322792425751686, decouple_loss:0.005657325033098459
loss_pred:0.03447515517473221, decouple_loss:0.00548540661111474
loss_pred:0.032919976860284805, decouple_loss:0.005778644233942032
WV_0_PC_0_EH_1_PS_40, loss: 0.03382304310798645, avg_mse: 0.04894597455859184
current test mse: 0.048946
Iteration: 4891, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4542163908481598
The generated pressure mean: 0.44941994547843933
loss_pred:0.020477373152971268, decouple_loss:0.004396974109113216
loss_pred:0.023137381300330162, decouple_loss:0.004707589279860258
The generated pressure mean: 0.4483584761619568
loss_pred:0.0205666683614254, decouple_loss:0.004706301726400852
Iteration: 4892, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45946991443634033
The generated pressure mean: 0.4574733078479767
loss_pred:0.0211733840405941, decouple_loss:0.005235942546278238
loss_pred:0.021166294813156128, decouple_loss:0.005360797978937626
The generated pressure mean: 0.45983749628067017
loss_pred:0.02144290879368782, decouple_loss:0.005265275482088327
Iteration: 4893, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4429706633090973
The generated pressure mean: 0.44478675723075867
loss_pred:0.021038733422756195, decouple_loss:0.004800371825695038
loss_pred:0.021536972373723984, decouple_loss:0.00461256317794323
The generated pressure mean: 0.4436573386192322
loss_pred:0.021072212606668472, decouple_loss:0.004775370005518198
Iteration: 4894, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43441885709762573
The generated pressure mean: 0.4412854015827179
loss_pred:0.02065819688141346, decouple_loss:0.0054400027729570866
loss_pred:0.0216397512704134, decouple_loss:0.005464429501444101
The generated pressure mean: 0.4413767457008362
loss_pred:0.020951660349965096, decouple_loss:0.005830580834299326
Iteration: 4895, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477440118789673
The generated pressure mean: 0.45342200994491577
loss_pred:0.020726066082715988, decouple_loss:0.005226830020546913
loss_pred:0.020495513454079628, decouple_loss:0.005108664743602276
The generated pressure mean: 0.4513660967350006
loss_pred:0.02090778946876526, decouple_loss:0.005159915424883366
Iteration: 4896, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4593793749809265
The generated pressure mean: 0.4569331705570221
loss_pred:0.020268671214580536, decouple_loss:0.004656125325709581
loss_pred:0.020639605820178986, decouple_loss:0.004670499358326197
The generated pressure mean: 0.4575190246105194
loss_pred:0.020313825458288193, decouple_loss:0.005045891739428043
Iteration: 4897, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.443188339471817
The generated pressure mean: 0.43990907073020935
loss_pred:0.02053728699684143, decouple_loss:0.005020958371460438
loss_pred:0.020311884582042694, decouple_loss:0.00499185873195529
The generated pressure mean: 0.44257503747940063
loss_pred:0.02067423239350319, decouple_loss:0.004992690868675709
Iteration: 4898, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.440274178981781
The generated pressure mean: 0.4423052966594696loss_pred:0.020206768065690994, decouple_loss:0.004568282514810562
loss_pred:0.02071552723646164, decouple_loss:0.004276608116924763
The generated pressure mean: 0.44117113947868347
loss_pred:0.020525796338915825, decouple_loss:0.004149733576923609
Iteration: 4899, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45343708992004395
loss_pred:0.021260811015963554, decouple_loss:0.004016211722046137
The generated pressure mean: 0.4536329209804535
loss_pred:0.02039242722094059, decouple_loss:0.004027915187180042
The generated pressure mean: 0.4552963376045227
loss_pred:0.020308177918195724, decouple_loss:0.003916006535291672
Iteration: 4900, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45223501324653625
The generated pressure mean: 0.45098376274108887
loss_pred:0.022111637517809868, decouple_loss:0.0038850337732583284
loss_pred:0.02080707624554634, decouple_loss:0.003982226829975843
The generated pressure mean: 0.4537215232849121
loss_pred:0.02082582376897335, decouple_loss:0.003984679002314806
2023-04-17 06:22:05 testing...
The generated pressure mean: 0.41697585582733154
The generated pressure mean: 0.4249007999897003
loss_pred:0.033867087215185165, decouple_loss:0.004763592500239611
The generated pressure mean: 0.42812272906303406
loss_pred:0.032705072313547134, decouple_loss:0.005041732918471098
loss_pred:0.032358232885599136, decouple_loss:0.005327423103153706
WV_0_PC_0_EH_1_PS_40, loss: 0.03322901204228401, avg_mse: 0.04759262502193451
current test mse: 0.047593
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 4901, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4384152591228485
loss_pred:0.023150883615016937, decouple_loss:0.004208147991448641
The generated pressure mean: 0.4375683069229126
loss_pred:0.02264181338250637, decouple_loss:0.004217554349452257
The generated pressure mean: 0.4388076663017273
loss_pred:0.019785763695836067, decouple_loss:0.0038752409163862467
Iteration: 4902, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4239961802959442
The generated pressure mean: 0.41962742805480957
loss_pred:0.022025693207979202, decouple_loss:0.005016770213842392
loss_pred:0.02264728955924511, decouple_loss:0.005073999520391226
The generated pressure mean: 0.4217168390750885
loss_pred:0.022121241316199303, decouple_loss:0.0051620835438370705
Iteration: 4903, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4680052399635315
The generated pressure mean: 0.46300914883613586loss_pred:0.022371239960193634, decouple_loss:0.005361950024962425
loss_pred:0.023043042048811913, decouple_loss:0.00548821035772562
The generated pressure mean: 0.4626213312149048
loss_pred:0.021490266546607018, decouple_loss:0.005501835141330957
Iteration: 4904, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45262813568115234
loss_pred:0.019947417080402374, decouple_loss:0.004668105393648148
The generated pressure mean: 0.45228445529937744
loss_pred:0.021094413474202156, decouple_loss:0.004609050694853067
The generated pressure mean: 0.45442360639572144
loss_pred:0.020815765485167503, decouple_loss:0.004786589648574591
Iteration: 4905, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44912654161453247
loss_pred:0.021978648379445076, decouple_loss:0.004363151732832193
The generated pressure mean: 0.438310444355011
loss_pred:0.021165207028388977, decouple_loss:0.004087791778147221
The generated pressure mean: 0.4389660954475403
loss_pred:0.024562904611229897, decouple_loss:0.004083920735865831
Iteration: 4906, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44238385558128357
loss_pred:0.02071850374341011, decouple_loss:0.006024042144417763
The generated pressure mean: 0.44106876850128174
loss_pred:0.021290112286806107, decouple_loss:0.005903088022023439
The generated pressure mean: 0.4441477954387665
loss_pred:0.021269777789711952, decouple_loss:0.006079664919525385
Iteration: 4907, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4399552643299103
loss_pred:0.02169664204120636, decouple_loss:0.004465055651962757
The generated pressure mean: 0.4416636526584625
loss_pred:0.0218855869024992, decouple_loss:0.00444172415882349
The generated pressure mean: 0.437318354845047
loss_pred:0.022423557937145233, decouple_loss:0.004498383495956659
Iteration: 4908, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43592554330825806The generated pressure mean: 0.43378859758377075
loss_pred:0.021068498492240906, decouple_loss:0.004904038738459349
loss_pred:0.021173184737563133, decouple_loss:0.0049591585993766785
The generated pressure mean: 0.44130852818489075
loss_pred:0.02025473490357399, decouple_loss:0.00485609145835042
Iteration: 4909, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46361687779426575
The generated pressure mean: 0.4630998969078064
loss_pred:0.020507173612713814, decouple_loss:0.005446028895676136
loss_pred:0.0203162282705307, decouple_loss:0.0058777667582035065
The generated pressure mean: 0.46206554770469666
loss_pred:0.02221217006444931, decouple_loss:0.005674003157764673
Iteration: 4910, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45501765608787537
The generated pressure mean: 0.4508013427257538
loss_pred:0.022332079708576202, decouple_loss:0.004258525557816029
loss_pred:0.020925160497426987, decouple_loss:0.004227255005389452
The generated pressure mean: 0.45561057329177856
loss_pred:0.02048572152853012, decouple_loss:0.004434102680534124
2023-04-17 06:24:32 testing...
The generated pressure mean: 0.4169221818447113
The generated pressure mean: 0.42456912994384766
The generated pressure mean: 0.4275297224521637
loss_pred:0.03390839323401451, decouple_loss:0.004700551275163889
loss_pred:0.032666631042957306, decouple_loss:0.004934533499181271
loss_pred:0.03259572759270668, decouple_loss:0.005160473752766848
WV_0_PC_0_EH_1_PS_40, loss: 0.03330351039767265, avg_mse: 0.04780425876379013
current test mse: 0.047804
Iteration: 4911, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43343332409858704
loss_pred:0.021155545487999916, decouple_loss:0.004418051801621914
The generated pressure mean: 0.43973320722579956
loss_pred:0.02198292873799801, decouple_loss:0.004342574626207352
The generated pressure mean: 0.4351479411125183
loss_pred:0.021406710147857666, decouple_loss:0.0043929340317845345
Iteration: 4912, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4397815763950348
The generated pressure mean: 0.4347755014896393
loss_pred:0.021856853738427162, decouple_loss:0.00442556943744421
loss_pred:0.02079853042960167, decouple_loss:0.004160653334110975
The generated pressure mean: 0.4323071241378784
loss_pred:0.02045152150094509, decouple_loss:0.00431206775829196
Iteration: 4913, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504106044769287
loss_pred:0.020236577838659286, decouple_loss:0.00472183246165514
The generated pressure mean: 0.4479908049106598
loss_pred:0.021947266533970833, decouple_loss:0.004776195157319307
The generated pressure mean: 0.44985103607177734
loss_pred:0.020576635375618935, decouple_loss:0.004572977777570486
Iteration: 4914, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46089622378349304
loss_pred:0.02113250270485878, decouple_loss:0.005036930553615093
The generated pressure mean: 0.4577331840991974
loss_pred:0.021593723446130753, decouple_loss:0.005078285466879606
The generated pressure mean: 0.4604296386241913
loss_pred:0.020746778696775436, decouple_loss:0.005320894997566938
Iteration: 4915, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44544926285743713
The generated pressure mean: 0.44464626908302307
loss_pred:0.02141703851521015, decouple_loss:0.0043874504044651985
loss_pred:0.02040959894657135, decouple_loss:0.004453590605407953
The generated pressure mean: 0.45125582814216614
loss_pred:0.020639438182115555, decouple_loss:0.004338323138654232
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4916, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43498268723487854
The generated pressure mean: 0.43152910470962524
loss_pred:0.02022540755569935, decouple_loss:0.003915460780262947
loss_pred:0.023474566638469696, decouple_loss:0.004309872165322304
The generated pressure mean: 0.43047505617141724
loss_pred:0.020546413958072662, decouple_loss:0.004134832881391048
Iteration: 4917, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4440029263496399
The generated pressure mean: 0.44245022535324097
loss_pred:0.021167907863855362, decouple_loss:0.0046718125231564045
loss_pred:0.021097561344504356, decouple_loss:0.0047086020931601524
The generated pressure mean: 0.4411650598049164
loss_pred:0.02451939322054386, decouple_loss:0.004566934425383806
Iteration: 4918, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4396257996559143
loss_pred:0.02084638923406601, decouple_loss:0.004499906208366156
The generated pressure mean: 0.44277623295783997
loss_pred:0.020014688372612, decouple_loss:0.004213412292301655
The generated pressure mean: 0.4477718770503998
loss_pred:0.021712755784392357, decouple_loss:0.004512961953878403
Iteration: 4919, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4600522220134735
The generated pressure mean: 0.45644471049308777
loss_pred:0.020755328238010406, decouple_loss:0.003908771555870771
loss_pred:0.021619854494929314, decouple_loss:0.003995740786194801
The generated pressure mean: 0.45498377084732056
loss_pred:0.020263148471713066, decouple_loss:0.0039938767440617085
Iteration: 4920, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45046043395996094
loss_pred:0.020618706941604614, decouple_loss:0.0036689548287540674
The generated pressure mean: 0.4449766278266907
loss_pred:0.020627928897738457, decouple_loss:0.003951679449528456
The generated pressure mean: 0.44880345463752747
loss_pred:0.02047739550471306, decouple_loss:0.003703419119119644
2023-04-17 06:26:24 testing...
The generated pressure mean: 0.4175432324409485
The generated pressure mean: 0.4254623055458069
The generated pressure mean: 0.42818015813827515
loss_pred:0.03333374857902527, decouple_loss:0.004680928774178028
loss_pred:0.03224846348166466, decouple_loss:0.004983601160347462
loss_pred:0.03207335248589516, decouple_loss:0.005180711857974529
WV_0_PC_0_EH_1_PS_40, loss: 0.03279927372932434, avg_mse: 0.046763379126787186
current test mse: 0.046763
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 4921, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43160906434059143
loss_pred:0.021315863355994225, decouple_loss:0.004216418601572514
The generated pressure mean: 0.4345359802246094
loss_pred:0.023148182779550552, decouple_loss:0.004435628652572632
The generated pressure mean: 0.4359779357910156
loss_pred:0.022117186337709427, decouple_loss:0.004363325424492359
Iteration: 4922, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462338387966156
The generated pressure mean: 0.44426336884498596
loss_pred:0.02129490114748478, decouple_loss:0.004225032404065132
loss_pred:0.021970972418785095, decouple_loss:0.004157570190727711
The generated pressure mean: 0.447896808385849
loss_pred:0.0212879478931427, decouple_loss:0.004362097475677729
Iteration: 4923, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4580432176589966
The generated pressure mean: 0.460121750831604
loss_pred:0.020829159766435623, decouple_loss:0.004668633919209242
loss_pred:0.020919745787978172, decouple_loss:0.0045457747764885426
The generated pressure mean: 0.4533296525478363
loss_pred:0.021260829642415047, decouple_loss:0.004787321202456951
Iteration: 4924, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44959476590156555
The generated pressure mean: 0.4479362964630127
loss_pred:0.022455068305134773, decouple_loss:0.004186816047877073
loss_pred:0.021214744076132774, decouple_loss:0.004263908136636019
The generated pressure mean: 0.4472576975822449
loss_pred:0.022183319553732872, decouple_loss:0.004313930403441191
Iteration: 4925, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474004805088043
loss_pred:0.02122463658452034, decouple_loss:0.00497459527105093
The generated pressure mean: 0.44838178157806396
loss_pred:0.020631494000554085, decouple_loss:0.005061357282102108
The generated pressure mean: 0.44854095578193665
loss_pred:0.02200516313314438, decouple_loss:0.004872017540037632
Iteration: 4926, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4410734474658966
The generated pressure mean: 0.4322880804538727
loss_pred:0.020658792927861214, decouple_loss:0.004101898986846209
loss_pred:0.021406138315796852, decouple_loss:0.0040320949628949165
The generated pressure mean: 0.4416830241680145
loss_pred:0.02152322605252266, decouple_loss:0.004057437181472778
Iteration: 4927, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.439711332321167
The generated pressure mean: 0.4393632709980011
loss_pred:0.021614432334899902, decouple_loss:0.004869821015745401
loss_pred:0.02098909206688404, decouple_loss:0.004642603453248739
The generated pressure mean: 0.4394190013408661
loss_pred:0.02071579545736313, decouple_loss:0.004816217347979546
Iteration: 4928, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4561135768890381
The generated pressure mean: 0.45647361874580383
loss_pred:0.021373869851231575, decouple_loss:0.0043739983811974525
loss_pred:0.02116747573018074, decouple_loss:0.004547694697976112
The generated pressure mean: 0.4548323452472687
loss_pred:0.02064332738518715, decouple_loss:0.004596534185111523
Iteration: 4929, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45558983087539673
The generated pressure mean: 0.45432454347610474
loss_pred:0.021779319271445274, decouple_loss:0.0048416475765407085
loss_pred:0.02107950858771801, decouple_loss:0.004722157958894968
The generated pressure mean: 0.45273101329803467
loss_pred:0.021550022065639496, decouple_loss:0.00490480475127697
Iteration: 4930, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4429437816143036
loss_pred:0.020926285535097122, decouple_loss:0.00434508640319109The generated pressure mean: 0.4418182373046875
loss_pred:0.02156924642622471, decouple_loss:0.004272125195711851
The generated pressure mean: 0.44132253527641296
loss_pred:0.021474841982126236, decouple_loss:0.004311155062168837
2023-04-17 06:28:48 testing...
The generated pressure mean: 0.41695159673690796
The generated pressure mean: 0.4257766604423523
The generated pressure mean: 0.428714781999588
loss_pred:0.03343045711517334, decouple_loss:0.005291290581226349
loss_pred:0.0321519561111927, decouple_loss:0.0057392604649066925
loss_pred:0.03218972310423851, decouple_loss:0.005908058490604162
WV_0_PC_0_EH_1_PS_40, loss: 0.03287302330136299, avg_mse: 0.047163523733615875
current test mse: 0.047164
Iteration: 4931, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4332682490348816
loss_pred:0.01988743431866169, decouple_loss:0.004795439075678587
The generated pressure mean: 0.4375091791152954
loss_pred:0.02008633501827717, decouple_loss:0.00473696319386363
The generated pressure mean: 0.43466609716415405
loss_pred:0.020956583321094513, decouple_loss:0.004644264001399279
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4932, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44644424319267273
loss_pred:0.021362803876399994, decouple_loss:0.004200072959065437
The generated pressure mean: 0.4525541067123413
loss_pred:0.02387690171599388, decouple_loss:0.00394261721521616
The generated pressure mean: 0.45037704706192017
loss_pred:0.020259302109479904, decouple_loss:0.004281070549041033
Iteration: 4933, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44681861996650696
loss_pred:0.021704675629734993, decouple_loss:0.004011789336800575
The generated pressure mean: 0.4458504319190979
loss_pred:0.02318110316991806, decouple_loss:0.003992878366261721
The generated pressure mean: 0.4496656656265259
loss_pred:0.021032867953181267, decouple_loss:0.004039914347231388
Iteration: 4934, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44880881905555725
loss_pred:0.021152250468730927, decouple_loss:0.0041450513526797295
The generated pressure mean: 0.4504871368408203
loss_pred:0.020785164088010788, decouple_loss:0.004200107418000698
The generated pressure mean: 0.4498589038848877
loss_pred:0.021190373227000237, decouple_loss:0.004389080684632063
Iteration: 4935, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44380220770835876
loss_pred:0.020587632432579994, decouple_loss:0.005705758463591337
The generated pressure mean: 0.44440004229545593
loss_pred:0.021596303209662437, decouple_loss:0.005733441561460495
The generated pressure mean: 0.440179705619812
loss_pred:0.021398445591330528, decouple_loss:0.005795188248157501
Iteration: 4936, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44831717014312744
The generated pressure mean: 0.44765153527259827
loss_pred:0.020890654996037483, decouple_loss:0.004145173355937004
loss_pred:0.020966200157999992, decouple_loss:0.004177204333245754
The generated pressure mean: 0.4458884298801422
loss_pred:0.021277371793985367, decouple_loss:0.004162893630564213
Iteration: 4937, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4387637972831726
loss_pred:0.02000552788376808, decouple_loss:0.004673671443015337
The generated pressure mean: 0.4402433931827545
loss_pred:0.02493097633123398, decouple_loss:0.004692286252975464
The generated pressure mean: 0.43803870677948
loss_pred:0.021360060200095177, decouple_loss:0.004690802190452814
Iteration: 4938, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44898998737335205
loss_pred:0.019824422895908356, decouple_loss:0.005495195742696524
The generated pressure mean: 0.45169442892074585
loss_pred:0.020098989829421043, decouple_loss:0.005654938519001007
The generated pressure mean: 0.45119181275367737
loss_pred:0.022163916379213333, decouple_loss:0.0056457421742379665
Iteration: 4939, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.457933634519577
loss_pred:0.021158898249268532, decouple_loss:0.0043912287801504135
The generated pressure mean: 0.4543159604072571
loss_pred:0.021742863580584526, decouple_loss:0.004392004106193781
The generated pressure mean: 0.4562121331691742
loss_pred:0.020697129890322685, decouple_loss:0.004228776786476374
Iteration: 4940, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477388560771942
loss_pred:0.020399698987603188, decouple_loss:0.00532206054776907
The generated pressure mean: 0.445707768201828
loss_pred:0.020232273265719414, decouple_loss:0.005416341125965118
The generated pressure mean: 0.4417881667613983
loss_pred:0.020725924521684647, decouple_loss:0.005351817235350609
2023-04-17 06:30:40 testing...
The generated pressure mean: 0.4165264666080475
The generated pressure mean: 0.42356178164482117
loss_pred:0.03395235165953636, decouple_loss:0.005470592528581619
The generated pressure mean: 0.42615658044815063
loss_pred:0.032655809074640274, decouple_loss:0.005743422079831362
loss_pred:0.03241502866148949, decouple_loss:0.005926128942519426
WV_0_PC_0_EH_1_PS_40, loss: 0.03329339995980263, avg_mse: 0.04768436774611473
current test mse: 0.047684
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 4941, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4343961775302887
loss_pred:0.02246963605284691, decouple_loss:0.004667780827730894
The generated pressure mean: 0.4365650713443756
loss_pred:0.02305884100496769, decouple_loss:0.004614646080881357
The generated pressure mean: 0.44087716937065125
loss_pred:0.021007154136896133, decouple_loss:0.004603162407875061
Iteration: 4942, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4425579607486725
The generated pressure mean: 0.44514256715774536
loss_pred:0.020831182599067688, decouple_loss:0.004175699781626463
loss_pred:0.020850352942943573, decouple_loss:0.004063539672642946
The generated pressure mean: 0.4427901804447174
loss_pred:0.021822262555360794, decouple_loss:0.004049883224070072
Iteration: 4943, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4600231647491455
The generated pressure mean: 0.458046019077301
loss_pred:0.022734450176358223, decouple_loss:0.0038432052824646235
loss_pred:0.02005680836737156, decouple_loss:0.00374600850045681
The generated pressure mean: 0.4609208405017853
loss_pred:0.02155158296227455, decouple_loss:0.0036989354994148016
Iteration: 4944, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4370138347148895
The generated pressure mean: 0.43963733315467834
loss_pred:0.021717313677072525, decouple_loss:0.004385943058878183
loss_pred:0.022658688947558403, decouple_loss:0.004183201584964991
The generated pressure mean: 0.43633222579956055
loss_pred:0.02124464511871338, decouple_loss:0.00444456422701478
Iteration: 4945, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44536763429641724
loss_pred:0.022541088983416557, decouple_loss:0.00450234254822135
The generated pressure mean: 0.4467410445213318
loss_pred:0.021367384120821953, decouple_loss:0.004527767188847065
The generated pressure mean: 0.445977121591568
loss_pred:0.019982270896434784, decouple_loss:0.0043581463396549225
Iteration: 4946, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4513207674026489
loss_pred:0.021361935883760452, decouple_loss:0.003701322479173541
The generated pressure mean: 0.4514055550098419
loss_pred:0.021018194034695625, decouple_loss:0.0035965987481176853
The generated pressure mean: 0.4481566250324249
loss_pred:0.021552208811044693, decouple_loss:0.003790784627199173
Iteration: 4947, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4408404529094696
loss_pred:0.02243531309068203, decouple_loss:0.004000305198132992
The generated pressure mean: 0.4376296401023865
loss_pred:0.02113187499344349, decouple_loss:0.004107583314180374
The generated pressure mean: 0.44703376293182373
loss_pred:0.021720491349697113, decouple_loss:0.004031909164041281
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4948, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483877718448639
The generated pressure mean: 0.45233774185180664
loss_pred:0.019860999658703804, decouple_loss:0.004047384485602379
loss_pred:0.01932181790471077, decouple_loss:0.004055595491081476
The generated pressure mean: 0.45499905943870544
loss_pred:0.020364660769701004, decouple_loss:0.004079041071236134
Iteration: 4949, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44897350668907166
loss_pred:0.02183345891535282, decouple_loss:0.003901769407093525
The generated pressure mean: 0.44215935468673706
loss_pred:0.02074565552175045, decouple_loss:0.0038915732875466347
The generated pressure mean: 0.4466259777545929
loss_pred:0.02049919217824936, decouple_loss:0.003846186213195324
Iteration: 4950, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44087082147598267
loss_pred:0.019420770928263664, decouple_loss:0.0036465362645685673
The generated pressure mean: 0.44121044874191284
loss_pred:0.020841402933001518, decouple_loss:0.0036518790293484926
The generated pressure mean: 0.438448429107666
loss_pred:0.02042095549404621, decouple_loss:0.003668692195788026
2023-04-17 06:33:08 testing...
The generated pressure mean: 0.4151631295681
The generated pressure mean: 0.4227391183376312
loss_pred:0.03311549872159958, decouple_loss:0.0049227150157094
The generated pressure mean: 0.425290584564209
loss_pred:0.03216008096933365, decouple_loss:0.005173421930521727
loss_pred:0.03187950327992439, decouple_loss:0.005364798475056887
WV_0_PC_0_EH_1_PS_40, loss: 0.03264271095395088, avg_mse: 0.04654300957918167
current test mse: 0.046543
Iteration: 4951, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44569888710975647
The generated pressure mean: 0.44976434111595154
loss_pred:0.019881095737218857, decouple_loss:0.003952318802475929
loss_pred:0.02036127634346485, decouple_loss:0.0041955262422561646
The generated pressure mean: 0.4472801089286804
loss_pred:0.020700745284557343, decouple_loss:0.0041080135852098465
Iteration: 4952, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4523521661758423
The generated pressure mean: 0.4485469460487366
loss_pred:0.018848540261387825, decouple_loss:0.004737345967441797
loss_pred:0.020778337493538857, decouple_loss:0.0048887222073972225
The generated pressure mean: 0.44810062646865845
loss_pred:0.020398665219545364, decouple_loss:0.004748484119772911
Iteration: 4953, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44770514965057373
The generated pressure mean: 0.4478015899658203
loss_pred:0.021502535790205002, decouple_loss:0.005202330648899078
loss_pred:0.019988497719168663, decouple_loss:0.005259240046143532
The generated pressure mean: 0.4451679587364197
loss_pred:0.02015497162938118, decouple_loss:0.005193775985389948
Iteration: 4954, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44265589118003845
The generated pressure mean: 0.4396739602088928
loss_pred:0.02151568979024887, decouple_loss:0.004518801812082529
loss_pred:0.021121101453900337, decouple_loss:0.0045458972454071045
The generated pressure mean: 0.4394988417625427
loss_pred:0.020943889394402504, decouple_loss:0.004724553320556879
Iteration: 4955, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44080814719200134
The generated pressure mean: 0.45118361711502075
loss_pred:0.021603552624583244, decouple_loss:0.00560946948826313
loss_pred:0.023171210661530495, decouple_loss:0.005576994735747576
The generated pressure mean: 0.445339560508728
loss_pred:0.020543023943901062, decouple_loss:0.005451841279864311
Iteration: 4956, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504176378250122
The generated pressure mean: 0.4514683187007904
loss_pred:0.021499302238225937, decouple_loss:0.0050621856935322285
loss_pred:0.020936300978064537, decouple_loss:0.004886983893811703
The generated pressure mean: 0.4498434066772461
loss_pred:0.020140010863542557, decouple_loss:0.004770148545503616
Iteration: 4957, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4441283047199249
loss_pred:0.020714396610856056, decouple_loss:0.003944799304008484
The generated pressure mean: 0.4433959722518921
loss_pred:0.02096237614750862, decouple_loss:0.003951413091272116
The generated pressure mean: 0.44631290435791016
loss_pred:0.02147146314382553, decouple_loss:0.0038916596677154303
Iteration: 4958, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473419189453125
loss_pred:0.020574074238538742, decouple_loss:0.004549182485789061
The generated pressure mean: 0.44717806577682495
loss_pred:0.020522555336356163, decouple_loss:0.004706121515482664
The generated pressure mean: 0.4475889801979065
loss_pred:0.021014627069234848, decouple_loss:0.004641454666852951
Iteration: 4959, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44295734167099
loss_pred:0.020975593477487564, decouple_loss:0.00472579849883914
The generated pressure mean: 0.4474436342716217
loss_pred:0.021010642871260643, decouple_loss:0.004733906127512455
The generated pressure mean: 0.447814404964447
loss_pred:0.021187253296375275, decouple_loss:0.004833891522139311
Iteration: 4960, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44349369406700134
loss_pred:0.02030356042087078, decouple_loss:0.003775916760787368
The generated pressure mean: 0.44055500626564026
loss_pred:0.02036425471305847, decouple_loss:0.004119141027331352
The generated pressure mean: 0.44062551856040955
loss_pred:0.021951869130134583, decouple_loss:0.003849433735013008
2023-04-17 06:34:59 testing...
The generated pressure mean: 0.4139268398284912
The generated pressure mean: 0.4218937158584595
The generated pressure mean: 0.42510583996772766
loss_pred:0.03480846434831619, decouple_loss:0.004874576348811388
loss_pred:0.03370280563831329, decouple_loss:0.0051117283292114735
loss_pred:0.03330518677830696, decouple_loss:0.005278583150357008
WV_0_PC_0_EH_1_PS_40, loss: 0.03419323265552521, avg_mse: 0.04963095858693123
current test mse: 0.049631
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 4961, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4509713649749756
loss_pred:0.021186435595154762, decouple_loss:0.004218291025608778
The generated pressure mean: 0.4584261476993561
loss_pred:0.022188236936926842, decouple_loss:0.004402466118335724
The generated pressure mean: 0.45491036772727966
loss_pred:0.01953662931919098, decouple_loss:0.004230542108416557
Iteration: 4962, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496822953224182
The generated pressure mean: 0.4530330002307892
loss_pred:0.019494056701660156, decouple_loss:0.0047355289570987225
loss_pred:0.02118680626153946, decouple_loss:0.004780084826052189
The generated pressure mean: 0.45132195949554443
loss_pred:0.019406404346227646, decouple_loss:0.004958308767527342
Iteration: 4963, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4350259602069855
The generated pressure mean: 0.4349544644355774
loss_pred:0.021960711106657982, decouple_loss:0.0042313034646213055
loss_pred:0.02092795819044113, decouple_loss:0.004391515161842108
The generated pressure mean: 0.43185099959373474
loss_pred:0.020997004583477974, decouple_loss:0.004373942967504263
Iteration: 4964, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45487651228904724
The generated pressure mean: 0.45664820075035095
loss_pred:0.02041839063167572, decouple_loss:0.003557011717930436
loss_pred:0.02207857556641102, decouple_loss:0.003418629989027977
The generated pressure mean: 0.453565388917923
loss_pred:0.02427913434803486, decouple_loss:0.003603805787861347
Iteration: 4965, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43602535128593445
The generated pressure mean: 0.4367109537124634
loss_pred:0.023582473397254944, decouple_loss:0.003694639541208744
loss_pred:0.022471804171800613, decouple_loss:0.0037708752788603306
The generated pressure mean: 0.4377616345882416
loss_pred:0.020894909277558327, decouple_loss:0.003664727322757244
Iteration: 4966, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46061113476753235
The generated pressure mean: 0.4558653235435486
loss_pred:0.020207954570651054, decouple_loss:0.004136538598686457
loss_pred:0.02144465036690235, decouple_loss:0.0041803354397416115
The generated pressure mean: 0.45887404680252075
loss_pred:0.019854532554745674, decouple_loss:0.0042523969896137714
Iteration: 4967, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44917193055152893The generated pressure mean: 0.4493896961212158
loss_pred:0.02228589542210102, decouple_loss:0.003825497580692172
loss_pred:0.02131088450551033, decouple_loss:0.003730855882167816
The generated pressure mean: 0.4512207806110382
loss_pred:0.020886598154902458, decouple_loss:0.0036847444716840982
Iteration: 4968, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43379929661750793
The generated pressure mean: 0.4337012469768524
loss_pred:0.023458654060959816, decouple_loss:0.0038381514605134726
loss_pred:0.021890977397561073, decouple_loss:0.0037287231534719467
The generated pressure mean: 0.43443790078163147
loss_pred:0.021310320124030113, decouple_loss:0.0036543759051710367
Iteration: 4969, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.459948867559433
loss_pred:0.021928926929831505, decouple_loss:0.00433796551078558
The generated pressure mean: 0.4608570337295532
loss_pred:0.020586669445037842, decouple_loss:0.0040888492949306965
The generated pressure mean: 0.46088120341300964
loss_pred:0.020495083183050156, decouple_loss:0.004146535415202379
Iteration: 4970, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45038506388664246
The generated pressure mean: 0.45747289061546326
loss_pred:0.021887600421905518, decouple_loss:0.004595089238137007
loss_pred:0.020758992061018944, decouple_loss:0.004731003660708666
The generated pressure mean: 0.4561837613582611
loss_pred:0.021517280489206314, decouple_loss:0.004704998340457678
2023-04-17 06:37:25 testing...
The generated pressure mean: 0.4165582060813904
The generated pressure mean: 0.4236072897911072
The generated pressure mean: 0.42654308676719666
loss_pred:0.033965084701776505, decouple_loss:0.0048524183221161366
loss_pred:0.03291189298033714, decouple_loss:0.005108199082314968
loss_pred:0.03276872634887695, decouple_loss:0.005269942805171013
WV_0_PC_0_EH_1_PS_40, loss: 0.033469077199697495, avg_mse: 0.04841059818863869
current test mse: 0.048411
Iteration: 4971, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43884092569351196
The generated pressure mean: 0.4448338449001312
loss_pred:0.02207435853779316, decouple_loss:0.00408547418192029
loss_pred:0.02140054851770401, decouple_loss:0.004193322733044624
The generated pressure mean: 0.44025662541389465
loss_pred:0.019097913056612015, decouple_loss:0.003971409052610397
Iteration: 4972, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4355103075504303
The generated pressure mean: 0.43077611923217773
loss_pred:0.023572798818349838, decouple_loss:0.005470802541822195
loss_pred:0.02202123962342739, decouple_loss:0.005390900187194347
The generated pressure mean: 0.4309290051460266
loss_pred:0.022003289312124252, decouple_loss:0.005359073635190725
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4973, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45571550726890564
The generated pressure mean: 0.4547593891620636
loss_pred:0.019558565691113472, decouple_loss:0.005392218939960003
loss_pred:0.02060452662408352, decouple_loss:0.005085356533527374
The generated pressure mean: 0.45097991824150085
loss_pred:0.019824983552098274, decouple_loss:0.005281546618789434
Iteration: 4974, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45473918318748474
The generated pressure mean: 0.45979833602905273
loss_pred:0.021561559289693832, decouple_loss:0.004927941597998142
loss_pred:0.0213184654712677, decouple_loss:0.00510329008102417
The generated pressure mean: 0.4558684825897217
loss_pred:0.022260673344135284, decouple_loss:0.005231037735939026
Iteration: 4975, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44831985235214233
The generated pressure mean: 0.45241981744766235
loss_pred:0.021615806967020035, decouple_loss:0.004905871115624905
loss_pred:0.020873863250017166, decouple_loss:0.004829309415072203
The generated pressure mean: 0.4503266215324402
loss_pred:0.021896513178944588, decouple_loss:0.005094960331916809
Iteration: 4976, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44220051169395447
loss_pred:0.02355268783867359, decouple_loss:0.005100778769701719
The generated pressure mean: 0.44358766078948975
loss_pred:0.02014022506773472, decouple_loss:0.0051453690975904465
The generated pressure mean: 0.4400460720062256
loss_pred:0.022560827434062958, decouple_loss:0.005100708454847336
Iteration: 4977, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.429459810256958
loss_pred:0.020466206595301628, decouple_loss:0.004203204996883869
The generated pressure mean: 0.43504664301872253
loss_pred:0.019572457298636436, decouple_loss:0.0041168383322656155
The generated pressure mean: 0.43144476413726807
loss_pred:0.020609525963664055, decouple_loss:0.004246779251843691
Iteration: 4978, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4532146155834198
The generated pressure mean: 0.4600372016429901
loss_pred:0.020187998190522194, decouple_loss:0.0042181601747870445
loss_pred:0.020750194787979126, decouple_loss:0.0044228327460587025
The generated pressure mean: 0.45646902918815613
loss_pred:0.019752217456698418, decouple_loss:0.004243147559463978
Iteration: 4979, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4591729938983917
loss_pred:0.020246032625436783, decouple_loss:0.0039642564952373505
The generated pressure mean: 0.4604845941066742
loss_pred:0.021859638392925262, decouple_loss:0.004121861886233091
The generated pressure mean: 0.4622851610183716
loss_pred:0.02101786993443966, decouple_loss:0.003985568881034851
Iteration: 4980, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4409356117248535
The generated pressure mean: 0.43313518166542053
loss_pred:0.020005589351058006, decouple_loss:0.003860538126900792
loss_pred:0.021277666091918945, decouple_loss:0.003917898517102003
The generated pressure mean: 0.43425917625427246
loss_pred:0.021193761378526688, decouple_loss:0.0038037127815186977
2023-04-17 06:39:16 testing...
The generated pressure mean: 0.4158368408679962
The generated pressure mean: 0.4236832559108734
The generated pressure mean: 0.42651352286338806
loss_pred:0.03351489081978798, decouple_loss:0.0053048282861709595
loss_pred:0.032627638429403305, decouple_loss:0.005655962973833084
loss_pred:0.032409388571977615, decouple_loss:0.005794445518404245
WV_0_PC_0_EH_1_PS_40, loss: 0.033129893243312836, avg_mse: 0.047640103846788406
current test mse: 0.04764
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 4981, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4457557499408722
loss_pred:0.02034037746489048, decouple_loss:0.005257532931864262
The generated pressure mean: 0.4419080913066864
The generated pressure mean: 0.44363492727279663
loss_pred:0.02074742503464222, decouple_loss:0.005195712670683861
loss_pred:0.021663736552000046, decouple_loss:0.0051814415492117405
Iteration: 4982, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484274983406067The generated pressure mean: 0.4546847343444824
loss_pred:0.021783579140901566, decouple_loss:0.004701814614236355
loss_pred:0.02120004966855049, decouple_loss:0.004958359524607658
The generated pressure mean: 0.4495241940021515
loss_pred:0.019444579258561134, decouple_loss:0.004898802377283573
Iteration: 4983, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4514915943145752The generated pressure mean: 0.4436207413673401
loss_pred:0.019696157425642014, decouple_loss:0.004201150964945555
loss_pred:0.02233962155878544, decouple_loss:0.004468705505132675
The generated pressure mean: 0.4413810968399048
loss_pred:0.02123686857521534, decouple_loss:0.004281892441213131
Iteration: 4984, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4510493278503418
loss_pred:0.021069873124361038, decouple_loss:0.0043175118044018745
The generated pressure mean: 0.4573171138763428
loss_pred:0.019709255546331406, decouple_loss:0.004658550024032593
The generated pressure mean: 0.4518279731273651
loss_pred:0.02116250991821289, decouple_loss:0.004519328474998474
Iteration: 4985, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45196953415870667
The generated pressure mean: 0.45528221130371094
loss_pred:0.02119412086904049, decouple_loss:0.004797232337296009
loss_pred:0.021221822127699852, decouple_loss:0.004720653407275677
The generated pressure mean: 0.45248714089393616
loss_pred:0.021276351064443588, decouple_loss:0.004847934003919363
Iteration: 4986, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4387228488922119
The generated pressure mean: 0.442170113325119
loss_pred:0.020828641951084137, decouple_loss:0.004615812096744776
loss_pred:0.021566243842244148, decouple_loss:0.00514797680079937
The generated pressure mean: 0.4351758360862732
loss_pred:0.020836664363741875, decouple_loss:0.0047793458215892315
Iteration: 4987, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44356927275657654The generated pressure mean: 0.4494069516658783
loss_pred:0.021101823076605797, decouple_loss:0.004490383435040712
loss_pred:0.019893020391464233, decouple_loss:0.004263498820364475
The generated pressure mean: 0.44804316759109497
loss_pred:0.019889026880264282, decouple_loss:0.004129501059651375
Iteration: 4988, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4519209861755371
The generated pressure mean: 0.4555044174194336
loss_pred:0.021844007074832916, decouple_loss:0.0038238968700170517
loss_pred:0.021474406123161316, decouple_loss:0.0036686663515865803
The generated pressure mean: 0.4546801745891571
loss_pred:0.02067260816693306, decouple_loss:0.0038255455438047647
Iteration: 4989, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44003453850746155
loss_pred:0.02226034738123417, decouple_loss:0.004702314734458923
The generated pressure mean: 0.43979915976524353
loss_pred:0.021988241001963615, decouple_loss:0.004789599683135748
The generated pressure mean: 0.43704870343208313
loss_pred:0.021398356184363365, decouple_loss:0.004757653921842575
Iteration: 4990, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44470012187957764
The generated pressure mean: 0.4502635896205902
loss_pred:0.020234471186995506, decouple_loss:0.0041536143980920315
loss_pred:0.021401621401309967, decouple_loss:0.004004972986876965
The generated pressure mean: 0.44003376364707947
loss_pred:0.021295031532645226, decouple_loss:0.004046199843287468
2023-04-17 06:41:41 testing...
The generated pressure mean: 0.412203311920166
The generated pressure mean: 0.41994327306747437
The generated pressure mean: 0.42321908473968506
loss_pred:0.034425389021635056, decouple_loss:0.004316945560276508
loss_pred:0.03332294896245003, decouple_loss:0.004637830425053835
loss_pred:0.032931357622146606, decouple_loss:0.004846679978072643
WV_0_PC_0_EH_1_PS_40, loss: 0.033789925277233124, avg_mse: 0.04894739016890526
current test mse: 0.048947
Iteration: 4991, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4582061171531677
The generated pressure mean: 0.45407480001449585
loss_pred:0.02178790792822838, decouple_loss:0.004106168635189533
loss_pred:0.022142117843031883, decouple_loss:0.0038616519887000322
The generated pressure mean: 0.45876502990722656
loss_pred:0.021071335300803185, decouple_loss:0.003916558809578419
Iteration: 4992, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4425133466720581The generated pressure mean: 0.4397693872451782
loss_pred:0.02221611700952053, decouple_loss:0.0035693999379873276
loss_pred:0.020818496122956276, decouple_loss:0.003635937348008156
The generated pressure mean: 0.43946948647499084
loss_pred:0.02113404870033264, decouple_loss:0.0035263069439679384
Iteration: 4993, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462469816207886
The generated pressure mean: 0.44190850853919983
loss_pred:0.019720274955034256, decouple_loss:0.004489734303206205
loss_pred:0.02127082832157612, decouple_loss:0.0045241122134029865
The generated pressure mean: 0.4438683092594147
loss_pred:0.020533563569188118, decouple_loss:0.004573987331241369
Iteration: 4994, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45166948437690735
loss_pred:0.021294401958584785, decouple_loss:0.004543147515505552
The generated pressure mean: 0.45056748390197754
loss_pred:0.021939555183053017, decouple_loss:0.004459217190742493
The generated pressure mean: 0.45655861496925354
loss_pred:0.021439865231513977, decouple_loss:0.004337662365287542
Iteration: 4995, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473585784435272The generated pressure mean: 0.4480755031108856
loss_pred:0.021869312971830368, decouple_loss:0.004280536435544491
loss_pred:0.02221929468214512, decouple_loss:0.004245413467288017
The generated pressure mean: 0.4505171477794647
loss_pred:0.021802788600325584, decouple_loss:0.0045784274116158485
Iteration: 4996, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44456836581230164
The generated pressure mean: 0.44283655285835266
loss_pred:0.022834857925772667, decouple_loss:0.004767734557390213
loss_pred:0.021732989698648453, decouple_loss:0.0049019367434084415
The generated pressure mean: 0.44273731112480164
loss_pred:0.022329306229948997, decouple_loss:0.005128223914653063
Iteration: 4997, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4528740346431732
The generated pressure mean: 0.4504539370536804
loss_pred:0.02173316292464733, decouple_loss:0.004258245695382357
loss_pred:0.020965486764907837, decouple_loss:0.00420412328094244
The generated pressure mean: 0.4498782455921173
loss_pred:0.019955726340413094, decouple_loss:0.004057791084051132
Iteration: 4998, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44762876629829407
loss_pred:0.019472884014248848, decouple_loss:0.004059789702296257
The generated pressure mean: 0.44421935081481934
loss_pred:0.021215353161096573, decouple_loss:0.004065961576998234
The generated pressure mean: 0.4479959011077881
loss_pred:0.021359965205192566, decouple_loss:0.003993346821516752
Iteration: 4999, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44288310408592224
The generated pressure mean: 0.4436953067779541loss_pred:0.020517943426966667, decouple_loss:0.0038950482849031687
loss_pred:0.02077842317521572, decouple_loss:0.004197339992970228
The generated pressure mean: 0.44145941734313965
loss_pred:0.019910693168640137, decouple_loss:0.004312262870371342
Iteration: 5000, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43996816873550415
loss_pred:0.020786631852388382, decouple_loss:0.005019990727305412
The generated pressure mean: 0.43885722756385803
loss_pred:0.02115892618894577, decouple_loss:0.005681721493601799
The generated pressure mean: 0.4377625584602356
loss_pred:0.02111664228141308, decouple_loss:0.005777476821094751
2023-04-17 06:43:32 itr: 5000
training loss: [0.02140552 0.02144301 0.02103763]
2023-04-17 06:43:32 testing...
The generated pressure mean: 0.41028574109077454
The generated pressure mean: 0.41929754614830017
The generated pressure mean: 0.4223784804344177
loss_pred:0.034814123064279556, decouple_loss:0.005193362943828106
loss_pred:0.03357969596982002, decouple_loss:0.005453544668853283
loss_pred:0.03366083651781082, decouple_loss:0.0055853817611932755
WV_0_PC_0_EH_1_PS_40, loss: 0.03428875654935837, avg_mse: 0.049931272864341736
current test mse: 0.049931
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 5001, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4686497151851654
loss_pred:0.021149300038814545, decouple_loss:0.004737563896924257
The generated pressure mean: 0.46615445613861084
loss_pred:0.021542582660913467, decouple_loss:0.0048769693821668625
The generated pressure mean: 0.46513938903808594
loss_pred:0.021241815760731697, decouple_loss:0.004795592278242111
Iteration: 5002, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44733357429504395
loss_pred:0.02064739353954792, decouple_loss:0.0035251853987574577
The generated pressure mean: 0.4523365795612335
loss_pred:0.021160472184419632, decouple_loss:0.0036058586556464434
The generated pressure mean: 0.4431353509426117
loss_pred:0.02001439593732357, decouple_loss:0.0034963893704116344
Iteration: 5003, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43259382247924805
The generated pressure mean: 0.4312647879123688
loss_pred:0.02203693613409996, decouple_loss:0.003744271118193865
loss_pred:0.020926011726260185, decouple_loss:0.0035652206279337406
The generated pressure mean: 0.4316498637199402
loss_pred:0.020778482779860497, decouple_loss:0.0036968437489122152
Iteration: 5004, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44584542512893677
The generated pressure mean: 0.44520747661590576
loss_pred:0.02076457254588604, decouple_loss:0.00414302060380578
loss_pred:0.019206270575523376, decouple_loss:0.004408901557326317
The generated pressure mean: 0.4489781856536865
loss_pred:0.021913694217801094, decouple_loss:0.0040591927245259285
Iteration: 5005, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470670223236084
The generated pressure mean: 0.45747703313827515
loss_pred:0.020465927198529243, decouple_loss:0.004041511099785566
loss_pred:0.019910434260964394, decouple_loss:0.004286161158233881
The generated pressure mean: 0.45252710580825806
loss_pred:0.020312318578362465, decouple_loss:0.004063334781676531
Iteration: 5006, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43890178203582764
The generated pressure mean: 0.4375571310520172
loss_pred:0.01987190917134285, decouple_loss:0.0038387058302760124
loss_pred:0.020286083221435547, decouple_loss:0.00396581320092082
The generated pressure mean: 0.43973761796951294
loss_pred:0.020826691761612892, decouple_loss:0.003985983319580555
Iteration: 5007, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4445776045322418
The generated pressure mean: 0.4481714069843292
loss_pred:0.02067163959145546, decouple_loss:0.0051152054220438
loss_pred:0.019889209419488907, decouple_loss:0.005073492880910635
The generated pressure mean: 0.44870954751968384
loss_pred:0.020855356007814407, decouple_loss:0.0050665647722780704
Iteration: 5008, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.453500360250473
The generated pressure mean: 0.45073795318603516
loss_pred:0.0196809284389019, decouple_loss:0.004031182266771793
loss_pred:0.019450943917036057, decouple_loss:0.003966342657804489
The generated pressure mean: 0.44601044058799744
loss_pred:0.02079262211918831, decouple_loss:0.004100231919437647
Iteration: 5009, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44258826971054077
loss_pred:0.020160038024187088, decouple_loss:0.003720753826200962
The generated pressure mean: 0.4471137225627899
loss_pred:0.020386116579174995, decouple_loss:0.00370754930190742
The generated pressure mean: 0.45039474964141846
loss_pred:0.02109599858522415, decouple_loss:0.003689506556838751
Iteration: 5010, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43929678201675415
loss_pred:0.019714247435331345, decouple_loss:0.0037144282832741737
The generated pressure mean: 0.44687747955322266
loss_pred:0.019509799778461456, decouple_loss:0.0036587659269571304
The generated pressure mean: 0.4462856352329254
loss_pred:0.02047133632004261, decouple_loss:0.003842063946649432
2023-04-17 06:45:57 testing...
The generated pressure mean: 0.4149196147918701
The generated pressure mean: 0.4230353832244873
The generated pressure mean: 0.4259271025657654
loss_pred:0.034623123705387115, decouple_loss:0.0038617148529738188
loss_pred:0.033177152276039124, decouple_loss:0.004193938337266445
loss_pred:0.03316013887524605, decouple_loss:0.004324235487729311
WV_0_PC_0_EH_1_PS_40, loss: 0.03385980427265167, avg_mse: 0.04934023693203926
current test mse: 0.04934
Iteration: 5011, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44555047154426575
The generated pressure mean: 0.44087591767311096
loss_pred:0.02070162259042263, decouple_loss:0.003203037427738309
loss_pred:0.02002108283340931, decouple_loss:0.003150031203404069
The generated pressure mean: 0.44823378324508667
loss_pred:0.02000715211033821, decouple_loss:0.003094328800216317
Iteration: 5012, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501938223838806
The generated pressure mean: 0.44984737038612366
loss_pred:0.019276844337582588, decouple_loss:0.0038993218913674355
loss_pred:0.02134709805250168, decouple_loss:0.003957008942961693
The generated pressure mean: 0.44990742206573486
loss_pred:0.019217779859900475, decouple_loss:0.0039215655997395515
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5013, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496600031852722The generated pressure mean: 0.45125600695610046
loss_pred:0.02016853541135788, decouple_loss:0.004419766832143068
loss_pred:0.019362106919288635, decouple_loss:0.004594922531396151
The generated pressure mean: 0.4436141550540924
loss_pred:0.020315974950790405, decouple_loss:0.004638648591935635
Iteration: 5014, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4423852860927582
The generated pressure mean: 0.4441537857055664
loss_pred:0.019212953746318817, decouple_loss:0.0037998505868017673
loss_pred:0.019447743892669678, decouple_loss:0.0038766067009419203
The generated pressure mean: 0.44892576336860657
loss_pred:0.01945333369076252, decouple_loss:0.003808102570474148
Iteration: 5015, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44815030694007874
loss_pred:0.020292101427912712, decouple_loss:0.003168872557580471
The generated pressure mean: 0.4399559199810028
loss_pred:0.019033027812838554, decouple_loss:0.0033008765894919634
The generated pressure mean: 0.44446301460266113
loss_pred:0.020715370774269104, decouple_loss:0.0031871527899056673
Iteration: 5016, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467528164386749
loss_pred:0.01918884739279747, decouple_loss:0.0034748397301882505
The generated pressure mean: 0.44102901220321655
loss_pred:0.01994367688894272, decouple_loss:0.00355399283580482
The generated pressure mean: 0.4438782334327698
loss_pred:0.02060019038617611, decouple_loss:0.003489649621769786
Iteration: 5017, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482014775276184
loss_pred:0.018934478983283043, decouple_loss:0.003681605914607644
The generated pressure mean: 0.4482327103614807
loss_pred:0.020943503826856613, decouple_loss:0.003605687990784645
The generated pressure mean: 0.4583384394645691
loss_pred:0.02154797874391079, decouple_loss:0.00375892361626029
Iteration: 5018, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44130992889404297
loss_pred:0.019665999338030815, decouple_loss:0.004004239570349455
The generated pressure mean: 0.44150009751319885
loss_pred:0.018996207043528557, decouple_loss:0.003961680456995964
The generated pressure mean: 0.43980443477630615
loss_pred:0.020138170570135117, decouple_loss:0.00398799404501915
Iteration: 5019, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45213407278060913
The generated pressure mean: 0.44840750098228455
loss_pred:0.020812323316931725, decouple_loss:0.004222226329147816
loss_pred:0.02198646031320095, decouple_loss:0.0044219354167580605
The generated pressure mean: 0.4522049129009247
loss_pred:0.020432844758033752, decouple_loss:0.004459933377802372
Iteration: 5020, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43891048431396484
The generated pressure mean: 0.4409797191619873
loss_pred:0.019709909334778786, decouple_loss:0.004392258822917938
loss_pred:0.019107885658740997, decouple_loss:0.004414854571223259
The generated pressure mean: 0.43575677275657654
loss_pred:0.020465221256017685, decouple_loss:0.004713160917162895
2023-04-17 06:47:48 testing...
The generated pressure mean: 0.4220706522464752
The generated pressure mean: 0.41388070583343506
loss_pred:0.03245387226343155, decouple_loss:0.004663418047130108
The generated pressure mean: 0.42518535256385803
loss_pred:0.033678848296403885, decouple_loss:0.004280146211385727
loss_pred:0.032445162534713745, decouple_loss:0.004800853319466114
WV_0_PC_0_EH_1_PS_40, loss: 0.03308836743235588, avg_mse: 0.04799225553870201
current test mse: 0.047992
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 5021, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45217186212539673
loss_pred:0.01859649270772934, decouple_loss:0.0036351545713841915
The generated pressure mean: 0.4501405954360962
loss_pred:0.0194397009909153, decouple_loss:0.003552357666194439
The generated pressure mean: 0.4528033137321472
loss_pred:0.02078333869576454, decouple_loss:0.0036026767920702696
Iteration: 5022, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4550885856151581
The generated pressure mean: 0.4509654939174652
loss_pred:0.019900595769286156, decouple_loss:0.0036129734944552183
loss_pred:0.02026032656431198, decouple_loss:0.003589299274608493
The generated pressure mean: 0.4559306502342224
loss_pred:0.02280786633491516, decouple_loss:0.0037537210155278444
Iteration: 5023, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4326992630958557
The generated pressure mean: 0.4334334135055542
loss_pred:0.019902722910046577, decouple_loss:0.00399503530934453
loss_pred:0.019315430894494057, decouple_loss:0.004186650272458792
The generated pressure mean: 0.43140631914138794
loss_pred:0.021565452218055725, decouple_loss:0.004107372835278511
Iteration: 5024, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45026150345802307
The generated pressure mean: 0.44456779956817627
loss_pred:0.020188108086586, decouple_loss:0.003643512260168791
loss_pred:0.020182739943265915, decouple_loss:0.0038431526627391577
The generated pressure mean: 0.4470668435096741
loss_pred:0.020996736362576485, decouple_loss:0.003800362814217806
Iteration: 5025, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45298153162002563
The generated pressure mean: 0.4573937952518463
loss_pred:0.020220927894115448, decouple_loss:0.0031578883063048124
loss_pred:0.021552106365561485, decouple_loss:0.003115881234407425
The generated pressure mean: 0.45581862330436707
loss_pred:0.02127212844789028, decouple_loss:0.003279808210209012
Iteration: 5026, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4453161656856537
The generated pressure mean: 0.4503101408481598
loss_pred:0.019990690052509308, decouple_loss:0.0037637283094227314
loss_pred:0.019703872501850128, decouple_loss:0.0038374445866793394
The generated pressure mean: 0.44181156158447266
loss_pred:0.02014521323144436, decouple_loss:0.0037317622918635607
Iteration: 5027, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44063133001327515The generated pressure mean: 0.4429624080657959
loss_pred:0.019505124539136887, decouple_loss:0.003839796641841531
loss_pred:0.019186899065971375, decouple_loss:0.0037656952627003193
The generated pressure mean: 0.4359974265098572
loss_pred:0.02041662111878395, decouple_loss:0.0037127824034541845
Iteration: 5028, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4553873836994171The generated pressure mean: 0.4488009214401245
loss_pred:0.01965753547847271, decouple_loss:0.0032153611537069082
loss_pred:0.02003946341574192, decouple_loss:0.003353473963215947
The generated pressure mean: 0.4498195946216583
loss_pred:0.020568376407027245, decouple_loss:0.003277307376265526
Iteration: 5029, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45621010661125183
loss_pred:0.019390586763620377, decouple_loss:0.0033024682197719812
The generated pressure mean: 0.4496585428714752
loss_pred:0.019940229132771492, decouple_loss:0.003305642167106271
The generated pressure mean: 0.44864708185195923
loss_pred:0.020601531490683556, decouple_loss:0.003287441097199917
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5030, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4382858872413635
The generated pressure mean: 0.44259440898895264
loss_pred:0.020358024165034294, decouple_loss:0.003112061182036996
loss_pred:0.02073398046195507, decouple_loss:0.0031074697617441416
The generated pressure mean: 0.4382123649120331
loss_pred:0.01986205019056797, decouple_loss:0.0030607033986598253
2023-04-17 06:50:14 testing...
The generated pressure mean: 0.4139529764652252
The generated pressure mean: 0.4221981167793274
The generated pressure mean: 0.4250187277793884
loss_pred:0.03265570476651192, decouple_loss:0.004407697357237339
loss_pred:0.031511709094047546, decouple_loss:0.004905980546027422
loss_pred:0.031429726630449295, decouple_loss:0.005010092165321112
WV_0_PC_0_EH_1_PS_40, loss: 0.03210444375872612, avg_mse: 0.046091675758361816
current test mse: 0.046092
Iteration: 5031, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44839680194854736
The generated pressure mean: 0.44948822259902954
loss_pred:0.02105872705578804, decouple_loss:0.0036217847373336554
loss_pred:0.02206542156636715, decouple_loss:0.0035841199569404125
The generated pressure mean: 0.445461243391037
loss_pred:0.020886408165097237, decouple_loss:0.0037530201952904463
Iteration: 5032, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4457680881023407
The generated pressure mean: 0.4476976692676544
loss_pred:0.01993715390563011, decouple_loss:0.0035055861808359623
loss_pred:0.021667422726750374, decouple_loss:0.003523870836943388
The generated pressure mean: 0.44983047246932983
loss_pred:0.022259488701820374, decouple_loss:0.0036488680634647608
Iteration: 5033, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43504810333251953
loss_pred:0.02134428545832634, decouple_loss:0.004026542883366346
The generated pressure mean: 0.43309709429740906
loss_pred:0.020297560840845108, decouple_loss:0.003931886982172728
The generated pressure mean: 0.42995333671569824
loss_pred:0.018987474963068962, decouple_loss:0.003967163152992725
Iteration: 5034, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4608110189437866
loss_pred:0.02022557146847248, decouple_loss:0.003549391869455576
The generated pressure mean: 0.4578520655632019
loss_pred:0.02058582380414009, decouple_loss:0.003659134730696678
The generated pressure mean: 0.45453038811683655
loss_pred:0.02011222206056118, decouple_loss:0.003889599582180381
Iteration: 5035, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45923078060150146
loss_pred:0.019766973331570625, decouple_loss:0.004005140624940395
The generated pressure mean: 0.4635424315929413
loss_pred:0.020048584789037704, decouple_loss:0.0037417812272906303
The generated pressure mean: 0.4606601595878601
loss_pred:0.021002676337957382, decouple_loss:0.003908079117536545
Iteration: 5036, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43685653805732727
loss_pred:0.019051047042012215, decouple_loss:0.003506277920678258
The generated pressure mean: 0.43875324726104736
loss_pred:0.021119847893714905, decouple_loss:0.003645764896646142
The generated pressure mean: 0.4337213933467865
loss_pred:0.019481681287288666, decouple_loss:0.00348673015832901
Iteration: 5037, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4393549859523773
loss_pred:0.020304836332798004, decouple_loss:0.003862990764901042
The generated pressure mean: 0.4396437108516693
loss_pred:0.02105122059583664, decouple_loss:0.003910097759217024
The generated pressure mean: 0.44222286343574524
loss_pred:0.020376117900013924, decouple_loss:0.004053641576319933
Iteration: 5038, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45891156792640686
loss_pred:0.019628655165433884, decouple_loss:0.0043875472620129585
The generated pressure mean: 0.4611814320087433
loss_pred:0.021859582513570786, decouple_loss:0.004567368887364864
The generated pressure mean: 0.45838120579719543
loss_pred:0.01968797668814659, decouple_loss:0.004398351535201073
Iteration: 5039, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4389897882938385
The generated pressure mean: 0.4404029846191406
loss_pred:0.01925741694867611, decouple_loss:0.005057893227785826
loss_pred:0.020761564373970032, decouple_loss:0.005293747875839472
The generated pressure mean: 0.440853089094162
loss_pred:0.018697386607527733, decouple_loss:0.004952058661729097
Iteration: 5040, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43671029806137085
loss_pred:0.019670812413096428, decouple_loss:0.0038403579965233803
The generated pressure mean: 0.4367595314979553
loss_pred:0.020020591095089912, decouple_loss:0.0037835536058992147
The generated pressure mean: 0.4372209310531616
loss_pred:0.02057480253279209, decouple_loss:0.0038769335951656103
2023-04-17 06:52:05 testing...
The generated pressure mean: 0.41905447840690613
The generated pressure mean: 0.41054293513298035
The generated pressure mean: 0.4222193956375122
loss_pred:0.03363126143813133, decouple_loss:0.0054505495354533195
loss_pred:0.035023245960474014, decouple_loss:0.0049917311407625675
loss_pred:0.03334144875407219, decouple_loss:0.00559295155107975
WV_0_PC_0_EH_1_PS_40, loss: 0.0342659056186676, avg_mse: 0.050254546105861664
current test mse: 0.050255
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 5041, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4583210349082947
loss_pred:0.02077731303870678, decouple_loss:0.004266140982508659
The generated pressure mean: 0.4619152247905731The generated pressure mean: 0.4604245722293854
loss_pred:0.02395688183605671, decouple_loss:0.004133165348321199
loss_pred:0.02060410939157009, decouple_loss:0.004227178171277046
Iteration: 5042, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42891812324523926
loss_pred:0.02360004559159279, decouple_loss:0.004313038662075996
The generated pressure mean: 0.4332413375377655
loss_pred:0.02205062471330166, decouple_loss:0.004466185811907053
The generated pressure mean: 0.4293809235095978
loss_pred:0.02034314163029194, decouple_loss:0.00416849460452795
Iteration: 5043, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45373454689979553
The generated pressure mean: 0.45832541584968567loss_pred:0.02123110182583332, decouple_loss:0.0049843862652778625
loss_pred:0.02194153144955635, decouple_loss:0.005154578480869532
The generated pressure mean: 0.45497986674308777
loss_pred:0.02295607142150402, decouple_loss:0.005363722797483206
Iteration: 5044, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4588785469532013
loss_pred:0.02164618670940399, decouple_loss:0.006771966349333525
The generated pressure mean: 0.4597860276699066
loss_pred:0.01996886543929577, decouple_loss:0.006691507529467344
The generated pressure mean: 0.46059608459472656
loss_pred:0.021478356793522835, decouple_loss:0.006798494141548872
Iteration: 5045, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4270447790622711
The generated pressure mean: 0.4311710596084595
loss_pred:0.020537031814455986, decouple_loss:0.004270576406270266
loss_pred:0.020739899948239326, decouple_loss:0.004248100332915783
The generated pressure mean: 0.435344934463501
loss_pred:0.02086588181555271, decouple_loss:0.004107586573809385
Iteration: 5046, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.445559024810791
loss_pred:0.022490298375487328, decouple_loss:0.005204362329095602
The generated pressure mean: 0.44937631487846375
loss_pred:0.019971603527665138, decouple_loss:0.004881037399172783
The generated pressure mean: 0.4429801404476166
loss_pred:0.02110373042523861, decouple_loss:0.004950766451656818
Iteration: 5047, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4615446925163269
loss_pred:0.021039564162492752, decouple_loss:0.0060652452521026134
The generated pressure mean: 0.46422335505485535
loss_pred:0.02035895548760891, decouple_loss:0.006159796379506588
The generated pressure mean: 0.46153387427330017
loss_pred:0.02117973566055298, decouple_loss:0.006345255300402641
Iteration: 5048, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44080018997192383
loss_pred:0.021532637998461723, decouple_loss:0.004545082338154316
The generated pressure mean: 0.44266027212142944
loss_pred:0.021045763045549393, decouple_loss:0.004643822554498911
The generated pressure mean: 0.4476200342178345
loss_pred:0.02074381709098816, decouple_loss:0.0045325253158807755
Iteration: 5049, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43732908368110657
The generated pressure mean: 0.43417221307754517
loss_pred:0.020389055833220482, decouple_loss:0.006485999561846256
loss_pred:0.0207687895745039, decouple_loss:0.006523427087813616
The generated pressure mean: 0.4395134150981903
loss_pred:0.02100803330540657, decouple_loss:0.006526574492454529
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5050, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44492530822753906
loss_pred:0.0213725995272398, decouple_loss:0.005906615871936083
The generated pressure mean: 0.4525820314884186
loss_pred:0.020633840933442116, decouple_loss:0.005888499319553375
The generated pressure mean: 0.4531317353248596
loss_pred:0.021715197712183, decouple_loss:0.005906903650611639
2023-04-17 06:54:44 testing...
The generated pressure mean: 0.41459399461746216
The generated pressure mean: 0.4217705726623535
The generated pressure mean: 0.42429879307746887
loss_pred:0.034910768270492554, decouple_loss:0.005600634962320328
loss_pred:0.03348736837506294, decouple_loss:0.0060039181262254715
loss_pred:0.03375435993075371, decouple_loss:0.006132075097411871
WV_0_PC_0_EH_1_PS_40, loss: 0.03434644266963005, avg_mse: 0.049912162125110626
current test mse: 0.049912
Iteration: 5051, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44831913709640503
The generated pressure mean: 0.4471522271633148
loss_pred:0.022767946124076843, decouple_loss:0.005171291995793581
loss_pred:0.021539412438869476, decouple_loss:0.005254363175481558
The generated pressure mean: 0.4426327347755432
loss_pred:0.020210914313793182, decouple_loss:0.00521145761013031
Iteration: 5052, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44112256169319153The generated pressure mean: 0.4392464756965637
loss_pred:0.02540586329996586, decouple_loss:0.005287598352879286
loss_pred:0.020301327109336853, decouple_loss:0.005031828302890062
The generated pressure mean: 0.43908435106277466
loss_pred:0.021971778944134712, decouple_loss:0.005195381119847298
Iteration: 5053, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486980438232422
The generated pressure mean: 0.4508151113986969
loss_pred:0.020475447177886963, decouple_loss:0.004453232046216726
loss_pred:0.020968135446310043, decouple_loss:0.004645817447453737
The generated pressure mean: 0.4539549946784973
loss_pred:0.02172994799911976, decouple_loss:0.004831721540540457
Iteration: 5054, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4456375241279602
The generated pressure mean: 0.4523802399635315
loss_pred:0.02155216783285141, decouple_loss:0.005621396936476231
loss_pred:0.02125069499015808, decouple_loss:0.005653192289173603
The generated pressure mean: 0.4554646909236908
loss_pred:0.020434042438864708, decouple_loss:0.00562719302251935
Iteration: 5055, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44105371832847595
The generated pressure mean: 0.43369200825691223
loss_pred:0.021107807755470276, decouple_loss:0.004348693881183863
loss_pred:0.019849011674523354, decouple_loss:0.004301255103200674
The generated pressure mean: 0.4355480670928955
loss_pred:0.0215893741697073, decouple_loss:0.004241828341037035
Iteration: 5056, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44776177406311035
The generated pressure mean: 0.4390706419944763
loss_pred:0.021694784983992577, decouple_loss:0.004391434136778116
loss_pred:0.02197916805744171, decouple_loss:0.004720247816294432
The generated pressure mean: 0.4486430287361145
loss_pred:0.021366849541664124, decouple_loss:0.004625064320862293
Iteration: 5057, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4566834270954132
loss_pred:0.021311670541763306, decouple_loss:0.005084129516035318
The generated pressure mean: 0.45896390080451965
loss_pred:0.020187413319945335, decouple_loss:0.005243967287242413
The generated pressure mean: 0.45925891399383545
loss_pred:0.02138195000588894, decouple_loss:0.004845494870096445
Iteration: 5058, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43387970328330994
loss_pred:0.021079756319522858, decouple_loss:0.004442755598574877
The generated pressure mean: 0.43361103534698486
loss_pred:0.020940519869327545, decouple_loss:0.00430363928899169
The generated pressure mean: 0.43628445267677307
loss_pred:0.020117156207561493, decouple_loss:0.004260921850800514
Iteration: 5059, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43447843194007874
The generated pressure mean: 0.4356854259967804loss_pred:0.02059882879257202, decouple_loss:0.005159433931112289
loss_pred:0.02172076888382435, decouple_loss:0.005138244014233351
The generated pressure mean: 0.4340359568595886
loss_pred:0.020087866112589836, decouple_loss:0.005217991303652525
Iteration: 5060, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4610835909843445
loss_pred:0.021316833794116974, decouple_loss:0.005074024200439453
The generated pressure mean: 0.46127521991729736
loss_pred:0.019811298698186874, decouple_loss:0.005210626404732466
The generated pressure mean: 0.46041589975357056
loss_pred:0.01973062939941883, decouple_loss:0.005104171112179756
2023-04-17 06:56:35 testing...
The generated pressure mean: 0.4117414355278015
The generated pressure mean: 0.41935357451438904
loss_pred:0.034534063190221786, decouple_loss:0.005182324908673763
The generated pressure mean: 0.421785444021225
loss_pred:0.03294350206851959, decouple_loss:0.0056116217747330666
loss_pred:0.033024176955223083, decouple_loss:0.005721607711166143
WV_0_PC_0_EH_1_PS_40, loss: 0.03377583995461464, avg_mse: 0.0490257628262043
current test mse: 0.049026
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 5061, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45256954431533813
loss_pred:0.02126486599445343, decouple_loss:0.004831589292734861
The generated pressure mean: 0.45481815934181213
loss_pred:0.02017339877784252, decouple_loss:0.004738673567771912
The generated pressure mean: 0.4570501148700714
loss_pred:0.02113831229507923, decouple_loss:0.004572839010506868
Iteration: 5062, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4337392747402191
The generated pressure mean: 0.432940810918808
loss_pred:0.022100431844592094, decouple_loss:0.0056528327986598015
loss_pred:0.020855503156781197, decouple_loss:0.005751539953052998
The generated pressure mean: 0.4349941909313202
loss_pred:0.020634129643440247, decouple_loss:0.005629460792988539
Iteration: 5063, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44641247391700745
The generated pressure mean: 0.4429652690887451
loss_pred:0.0220901258289814, decouple_loss:0.004564267583191395
loss_pred:0.020619643852114677, decouple_loss:0.004405313637107611
The generated pressure mean: 0.4436388611793518
loss_pred:0.021783331409096718, decouple_loss:0.004690887872129679
Iteration: 5064, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494646489620209
loss_pred:0.02437526360154152, decouple_loss:0.004794408567249775
The generated pressure mean: 0.45040279626846313
loss_pred:0.021159928292036057, decouple_loss:0.00479378504678607
The generated pressure mean: 0.4517335891723633
loss_pred:0.021063903346657753, decouple_loss:0.00492883613333106
Iteration: 5065, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4431036710739136
The generated pressure mean: 0.4369228780269623
loss_pred:0.021235253661870956, decouple_loss:0.004969729110598564
loss_pred:0.021531010046601295, decouple_loss:0.0050939940847456455
The generated pressure mean: 0.43978315591812134
loss_pred:0.02091357856988907, decouple_loss:0.0051759034395217896
Iteration: 5066, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44254249334335327
The generated pressure mean: 0.44798728823661804
loss_pred:0.020606333389878273, decouple_loss:0.00446469709277153
loss_pred:0.022057903930544853, decouple_loss:0.0043160500936210155
The generated pressure mean: 0.4442116618156433
loss_pred:0.020580312237143517, decouple_loss:0.0043286350555717945
Iteration: 5067, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4543444812297821
The generated pressure mean: 0.4483967125415802
loss_pred:0.021512025967240334, decouple_loss:0.003967848606407642
loss_pred:0.020276522263884544, decouple_loss:0.004093664698302746
The generated pressure mean: 0.45819100737571716
loss_pred:0.02148936688899994, decouple_loss:0.0036645359359681606
Iteration: 5068, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495408236980438
The generated pressure mean: 0.45211803913116455
loss_pred:0.020438779145479202, decouple_loss:0.004278223030269146
loss_pred:0.021234318614006042, decouple_loss:0.00437841285020113
The generated pressure mean: 0.45489901304244995
loss_pred:0.02243468165397644, decouple_loss:0.0043666791170835495
Iteration: 5069, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507736563682556
loss_pred:0.02276579663157463, decouple_loss:0.004621964413672686
The generated pressure mean: 0.44370824098587036
loss_pred:0.020238308236002922, decouple_loss:0.004906179383397102
The generated pressure mean: 0.4455421566963196
loss_pred:0.019983477890491486, decouple_loss:0.0045145126059651375
Iteration: 5070, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4357542097568512
loss_pred:0.021250508725643158, decouple_loss:0.004639112390577793
The generated pressure mean: 0.43277761340141296
loss_pred:0.021593768149614334, decouple_loss:0.004366847220808268
The generated pressure mean: 0.43094974756240845
loss_pred:0.02142932265996933, decouple_loss:0.004509434103965759
2023-04-17 06:59:01 testing...
The generated pressure mean: 0.41418612003326416
The generated pressure mean: 0.42219072580337524
loss_pred:0.03423956781625748, decouple_loss:0.005268156062811613
The generated pressure mean: 0.4252122938632965
loss_pred:0.0336129330098629, decouple_loss:0.0055707115679979324
loss_pred:0.03353884443640709, decouple_loss:0.005812218878418207
WV_0_PC_0_EH_1_PS_40, loss: 0.034074634313583374, avg_mse: 0.04973489046096802
current test mse: 0.049735
Iteration: 5071, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4524614214897156
The generated pressure mean: 0.44947168231010437
loss_pred:0.02139522321522236, decouple_loss:0.004381077364087105
loss_pred:0.021346157416701317, decouple_loss:0.004074308555573225
The generated pressure mean: 0.4496445953845978
loss_pred:0.01975005865097046, decouple_loss:0.0043394844979047775
Iteration: 5072, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4590238034725189
The generated pressure mean: 0.4590100944042206
loss_pred:0.019910408183932304, decouple_loss:0.003900982439517975
loss_pred:0.021017277613282204, decouple_loss:0.004132553935050964
The generated pressure mean: 0.4529336392879486
loss_pred:0.019446833059191704, decouple_loss:0.003973950631916523
Iteration: 5073, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4425690472126007
The generated pressure mean: 0.445894718170166
loss_pred:0.01898406259715557, decouple_loss:0.003813912160694599
loss_pred:0.021853730082511902, decouple_loss:0.0038028601557016373
The generated pressure mean: 0.4454745650291443
loss_pred:0.02103445492684841, decouple_loss:0.0038705833721905947
Iteration: 5074, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4369320571422577
loss_pred:0.021345196291804314, decouple_loss:0.004074628930538893
The generated pressure mean: 0.4367798864841461
loss_pred:0.02218978852033615, decouple_loss:0.0039302329532802105
The generated pressure mean: 0.44005286693573
loss_pred:0.020420704036951065, decouple_loss:0.003934652078896761
Iteration: 5075, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473741054534912
loss_pred:0.02276272140443325, decouple_loss:0.0035819096956402063
The generated pressure mean: 0.4439223110675812
loss_pred:0.021934034302830696, decouple_loss:0.003698829561471939
The generated pressure mean: 0.44925040006637573
loss_pred:0.021838674321770668, decouple_loss:0.003752391552552581
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5076, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45215779542922974
loss_pred:0.020859047770500183, decouple_loss:0.003785055363550782
The generated pressure mean: 0.45094382762908936
loss_pred:0.02101108431816101, decouple_loss:0.0038509760051965714
The generated pressure mean: 0.44674113392829895
loss_pred:0.021213004365563393, decouple_loss:0.004013005178421736
Iteration: 5077, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489176273345947
The generated pressure mean: 0.444584459066391
loss_pred:0.020187685266137123, decouple_loss:0.004133399575948715
loss_pred:0.02115461975336075, decouple_loss:0.004281215835362673
The generated pressure mean: 0.44289180636405945
loss_pred:0.02168658934533596, decouple_loss:0.0041077276691794395
Iteration: 5078, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44702187180519104
The generated pressure mean: 0.44544336199760437loss_pred:0.020654913038015366, decouple_loss:0.003682073438540101
loss_pred:0.02080906741321087, decouple_loss:0.00366881862282753
The generated pressure mean: 0.4494299292564392
loss_pred:0.01964603364467621, decouple_loss:0.00377902714535594
Iteration: 5079, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44950389862060547
loss_pred:0.019670572131872177, decouple_loss:0.0036802610848098993
The generated pressure mean: 0.44908031821250916
loss_pred:0.020031774416565895, decouple_loss:0.003699040273204446
The generated pressure mean: 0.4480970501899719
loss_pred:0.02037055976688862, decouple_loss:0.0035890520084649324
Iteration: 5080, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4448688328266144
loss_pred:0.02128794975578785, decouple_loss:0.003586654318496585
The generated pressure mean: 0.4502609670162201
loss_pred:0.02121836692094803, decouple_loss:0.003760615363717079
The generated pressure mean: 0.4472276270389557
loss_pred:0.019856030121445656, decouple_loss:0.0036792317405343056
2023-04-17 07:00:52 testing...
The generated pressure mean: 0.4142705202102661
The generated pressure mean: 0.42210662364959717
The generated pressure mean: 0.42424967885017395
loss_pred:0.03346266597509384, decouple_loss:0.004436226561665535
loss_pred:0.032351985573768616, decouple_loss:0.004854327067732811
loss_pred:0.0322418287396431, decouple_loss:0.005060919560492039
WV_0_PC_0_EH_1_PS_40, loss: 0.03292468562722206, avg_mse: 0.04768965765833855
current test mse: 0.04769
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 5081, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44732779264450073
loss_pred:0.02161780185997486, decouple_loss:0.003620509058237076
The generated pressure mean: 0.44693008065223694
loss_pred:0.019797004759311676, decouple_loss:0.0035219755955040455
The generated pressure mean: 0.4446229934692383
loss_pred:0.021484598517417908, decouple_loss:0.0035675205290317535
Iteration: 5082, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4426986873149872
The generated pressure mean: 0.43671703338623047
loss_pred:0.020738964900374413, decouple_loss:0.0040747858583927155
loss_pred:0.021637490019202232, decouple_loss:0.003782788058742881
The generated pressure mean: 0.449005126953125
loss_pred:0.021276962012052536, decouple_loss:0.0037737982347607613
Iteration: 5083, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4586746096611023
loss_pred:0.021115420386195183, decouple_loss:0.003870710264891386
The generated pressure mean: 0.45155373215675354
loss_pred:0.020193373784422874, decouple_loss:0.00398669857531786
The generated pressure mean: 0.45464539527893066
loss_pred:0.021703818812966347, decouple_loss:0.00393020361661911
Iteration: 5084, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44220590591430664
The generated pressure mean: 0.44309934973716736
loss_pred:0.020827950909733772, decouple_loss:0.004265632480382919
loss_pred:0.021607335656881332, decouple_loss:0.0046636853367090225
The generated pressure mean: 0.44621741771698
loss_pred:0.020565954968333244, decouple_loss:0.0043138740584254265
Iteration: 5085, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44710102677345276
The generated pressure mean: 0.44405123591423035
loss_pred:0.021553967148065567, decouple_loss:0.004977299366146326
loss_pred:0.019656604155898094, decouple_loss:0.004855215549468994
The generated pressure mean: 0.43958374857902527
loss_pred:0.021255318075418472, decouple_loss:0.004949552938342094
Iteration: 5086, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44766417145729065
The generated pressure mean: 0.4430191218852997
loss_pred:0.020696420222520828, decouple_loss:0.0040230234153568745
loss_pred:0.018903104588389397, decouple_loss:0.0039904736913740635
The generated pressure mean: 0.44774240255355835
loss_pred:0.02018933743238449, decouple_loss:0.0038648981135338545
Iteration: 5087, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45514464378356934The generated pressure mean: 0.4560886025428772
loss_pred:0.02185566909611225, decouple_loss:0.003985118120908737
loss_pred:0.020563997328281403, decouple_loss:0.003994216676801443
The generated pressure mean: 0.45178645849227905
loss_pred:0.020751168951392174, decouple_loss:0.003935083746910095
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5088, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471038579940796
The generated pressure mean: 0.44074058532714844
loss_pred:0.01947532407939434, decouple_loss:0.003651362145319581
loss_pred:0.020133327692747116, decouple_loss:0.00373904500156641
The generated pressure mean: 0.443941593170166
loss_pred:0.019797101616859436, decouple_loss:0.0038011071737855673
Iteration: 5089, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488363564014435
The generated pressure mean: 0.44548481702804565
loss_pred:0.02112552337348461, decouple_loss:0.004182237666100264
loss_pred:0.020000584423542023, decouple_loss:0.004139125347137451
The generated pressure mean: 0.44624435901641846
loss_pred:0.022088466212153435, decouple_loss:0.004087501671165228
Iteration: 5090, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4546741247177124
The generated pressure mean: 0.44846534729003906
loss_pred:0.020027676597237587, decouple_loss:0.0038551122415810823
loss_pred:0.021155424416065216, decouple_loss:0.004053680691868067
The generated pressure mean: 0.4483080506324768
loss_pred:0.020253784954547882, decouple_loss:0.00383052253164351
2023-04-17 07:03:19 testing...
The generated pressure mean: 0.4159218370914459
The generated pressure mean: 0.42419716715812683
loss_pred:0.03302747756242752, decouple_loss:0.004767809063196182
The generated pressure mean: 0.4266488254070282
loss_pred:0.03193512558937073, decouple_loss:0.004964214749634266
loss_pred:0.031707219779491425, decouple_loss:0.0051369317807257175
WV_0_PC_0_EH_1_PS_40, loss: 0.03247109055519104, avg_mse: 0.04670119285583496
current test mse: 0.046701
Iteration: 5091, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449405074119568
The generated pressure mean: 0.4423984885215759
loss_pred:0.021804820746183395, decouple_loss:0.004094851203262806
loss_pred:0.020872291177511215, decouple_loss:0.004034549929201603
The generated pressure mean: 0.43989986181259155
loss_pred:0.019982503727078438, decouple_loss:0.004043280147016048
Iteration: 5092, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4414352476596832
The generated pressure mean: 0.44644004106521606loss_pred:0.02106091007590294, decouple_loss:0.004117234610021114
loss_pred:0.02010052464902401, decouple_loss:0.004111051559448242
The generated pressure mean: 0.4439755380153656
loss_pred:0.021463364362716675, decouple_loss:0.004048120230436325
Iteration: 5093, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496689736843109
The generated pressure mean: 0.4545474052429199
loss_pred:0.0203016959130764, decouple_loss:0.003666280535981059
loss_pred:0.02030865289270878, decouple_loss:0.0038094311021268368
The generated pressure mean: 0.4503660798072815
loss_pred:0.0219914261251688, decouple_loss:0.0038494523614645004
Iteration: 5094, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503985345363617
The generated pressure mean: 0.44601911306381226
loss_pred:0.019868167117238045, decouple_loss:0.00399846863001585
loss_pred:0.02067657932639122, decouple_loss:0.0040070898830890656
The generated pressure mean: 0.4539472758769989
loss_pred:0.020111363381147385, decouple_loss:0.004006288014352322
Iteration: 5095, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465057849884033
The generated pressure mean: 0.4473443329334259
loss_pred:0.01980648748576641, decouple_loss:0.0043608215637505054
loss_pred:0.01910492219030857, decouple_loss:0.004082775674760342
The generated pressure mean: 0.45222002267837524
loss_pred:0.02064618282020092, decouple_loss:0.004023528192192316
Iteration: 5096, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44058388471603394
The generated pressure mean: 0.4424182176589966
loss_pred:0.020817624405026436, decouple_loss:0.004435867536813021
loss_pred:0.020230934023857117, decouple_loss:0.004346910864114761
The generated pressure mean: 0.4415764808654785
loss_pred:0.020139310508966446, decouple_loss:0.004413510672748089
Iteration: 5097, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45285969972610474
The generated pressure mean: 0.4515872597694397
loss_pred:0.020620407536625862, decouple_loss:0.003578046802431345
loss_pred:0.019920164719223976, decouple_loss:0.0036448719911277294
The generated pressure mean: 0.4519079029560089
loss_pred:0.022310355678200722, decouple_loss:0.003553961170837283
Iteration: 5098, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43886762857437134
loss_pred:0.02068878524005413, decouple_loss:0.003915293142199516
The generated pressure mean: 0.4453706443309784
loss_pred:0.020962359383702278, decouple_loss:0.0039987447671592236
The generated pressure mean: 0.44669827818870544
loss_pred:0.020886514335870743, decouple_loss:0.0039952718652784824
Iteration: 5099, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4536155164241791
The generated pressure mean: 0.4453977942466736
loss_pred:0.020925277844071388, decouple_loss:0.004012519959360361
loss_pred:0.019558623433113098, decouple_loss:0.004179656505584717
The generated pressure mean: 0.4526080787181854
loss_pred:0.020045572891831398, decouple_loss:0.004225846379995346
Iteration: 5100, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45479366183280945
loss_pred:0.020119599997997284, decouple_loss:0.0038744208868592978
The generated pressure mean: 0.45300522446632385
loss_pred:0.01889028586447239, decouple_loss:0.00396534102037549
The generated pressure mean: 0.45201292634010315
loss_pred:0.02034853957593441, decouple_loss:0.003909926395863295
2023-04-17 07:05:10 testing...
The generated pressure mean: 0.4235825538635254
The generated pressure mean: 0.41582897305488586
The generated pressure mean: 0.4260597825050354
loss_pred:0.03165251389145851, decouple_loss:0.0050515951588749886
loss_pred:0.03261001408100128, decouple_loss:0.004730852320790291
loss_pred:0.031449053436517715, decouple_loss:0.005144377704709768
WV_0_PC_0_EH_1_PS_40, loss: 0.03215264156460762, avg_mse: 0.04622410237789154
current test mse: 0.046224
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 5101, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44227516651153564
loss_pred:0.020408358424901962, decouple_loss:0.003947542980313301
The generated pressure mean: 0.44463953375816345
loss_pred:0.021709542721509933, decouple_loss:0.004123042803257704
The generated pressure mean: 0.4475257098674774
loss_pred:0.020779861137270927, decouple_loss:0.004082455299794674
Iteration: 5102, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43807563185691833
The generated pressure mean: 0.43566450476646423
loss_pred:0.019896375015378, decouple_loss:0.004491710104048252
loss_pred:0.0206270944327116, decouple_loss:0.004697272088378668
The generated pressure mean: 0.43657344579696655
loss_pred:0.021435203030705452, decouple_loss:0.00450238399207592
Iteration: 5103, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461055099964142
The generated pressure mean: 0.44943952560424805
loss_pred:0.019979869946837425, decouple_loss:0.003964422270655632
loss_pred:0.01928585208952427, decouple_loss:0.00388470571488142
The generated pressure mean: 0.4482169449329376
loss_pred:0.018790772184729576, decouple_loss:0.003953748848289251
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5104, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459393620491028
The generated pressure mean: 0.4532066583633423
loss_pred:0.020945949479937553, decouple_loss:0.004591931588947773
loss_pred:0.022956984117627144, decouple_loss:0.004544564988464117
The generated pressure mean: 0.4466942250728607
loss_pred:0.020932059735059738, decouple_loss:0.004249355290085077
Iteration: 5105, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45317426323890686
The generated pressure mean: 0.44872555136680603
loss_pred:0.02034228853881359, decouple_loss:0.005536355078220367
loss_pred:0.022377977147698402, decouple_loss:0.005353740882128477
The generated pressure mean: 0.4551258385181427
loss_pred:0.019029097631573677, decouple_loss:0.005269254092127085
Iteration: 5106, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4445146322250366The generated pressure mean: 0.44819775223731995
loss_pred:0.020476896315813065, decouple_loss:0.005170683842152357
loss_pred:0.021631352603435516, decouple_loss:0.005286883562803268
The generated pressure mean: 0.4400291442871094
loss_pred:0.021829385310411453, decouple_loss:0.005332121159881353
Iteration: 5107, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43533360958099365
The generated pressure mean: 0.44073545932769775
loss_pred:0.021421220153570175, decouple_loss:0.005344805307686329
loss_pred:0.02044603042304516, decouple_loss:0.0052977013401687145
The generated pressure mean: 0.43982189893722534
loss_pred:0.020509786903858185, decouple_loss:0.005382198840379715
Iteration: 5108, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4536217153072357
loss_pred:0.019487932324409485, decouple_loss:0.005712679121643305
The generated pressure mean: 0.4569557011127472
loss_pred:0.019980907440185547, decouple_loss:0.005543337669223547
The generated pressure mean: 0.45104578137397766
loss_pred:0.01969480887055397, decouple_loss:0.005843603052198887
Iteration: 5109, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4551916718482971
The generated pressure mean: 0.4546196162700653
loss_pred:0.019443536177277565, decouple_loss:0.006086476147174835
loss_pred:0.020439891144633293, decouple_loss:0.006235270295292139
The generated pressure mean: 0.4522535502910614
loss_pred:0.020399263128638268, decouple_loss:0.006022641900926828
Iteration: 5110, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44398149847984314
loss_pred:0.01984218694269657, decouple_loss:0.006450190674513578
The generated pressure mean: 0.443300724029541
loss_pred:0.02022673189640045, decouple_loss:0.006554693914949894
The generated pressure mean: 0.4424135684967041
loss_pred:0.019807763397693634, decouple_loss:0.006405562162399292
2023-04-17 07:07:35 testing...
The generated pressure mean: 0.4153599441051483
The generated pressure mean: 0.42279815673828125
The generated pressure mean: 0.42526668310165405
loss_pred:0.03284497186541557, decouple_loss:0.005452722776681185
loss_pred:0.03194918856024742, decouple_loss:0.005676216911524534
loss_pred:0.03184996172785759, decouple_loss:0.005755160469561815
WV_0_PC_0_EH_1_PS_40, loss: 0.03249610960483551, avg_mse: 0.04680037125945091
current test mse: 0.0468
Iteration: 5111, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44135475158691406
The generated pressure mean: 0.4405120313167572
loss_pred:0.021593153476715088, decouple_loss:0.00517445569857955
loss_pred:0.021618517115712166, decouple_loss:0.005083243362605572
The generated pressure mean: 0.4465336501598358
loss_pred:0.023039259016513824, decouple_loss:0.005252255126833916
Iteration: 5112, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4424996078014374
loss_pred:0.020538004115223885, decouple_loss:0.006857661064714193
The generated pressure mean: 0.44689738750457764
loss_pred:0.019124824553728104, decouple_loss:0.007017557509243488
The generated pressure mean: 0.4399370849132538
loss_pred:0.01965903677046299, decouple_loss:0.007186992093920708
Iteration: 5113, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4514193832874298
loss_pred:0.020322732627391815, decouple_loss:0.005290956236422062
The generated pressure mean: 0.44555243849754333
loss_pred:0.020914331078529358, decouple_loss:0.005332173779606819
The generated pressure mean: 0.45094144344329834
loss_pred:0.02073548547923565, decouple_loss:0.005377881694585085
Iteration: 5114, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469701945781708
loss_pred:0.01987970806658268, decouple_loss:0.007583929691463709
The generated pressure mean: 0.44823434948921204
loss_pred:0.0187345203012228, decouple_loss:0.007358069997280836
The generated pressure mean: 0.449114590883255
loss_pred:0.020740732550621033, decouple_loss:0.007776215672492981
Iteration: 5115, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45312100648880005
The generated pressure mean: 0.4475563168525696
loss_pred:0.0200213473290205, decouple_loss:0.005022252444177866
loss_pred:0.019931090995669365, decouple_loss:0.0050372350960969925
The generated pressure mean: 0.45366036891937256
loss_pred:0.019121777266263962, decouple_loss:0.004854263737797737
Iteration: 5116, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4433211088180542
loss_pred:0.020163772627711296, decouple_loss:0.007114756852388382
The generated pressure mean: 0.44815143942832947
loss_pred:0.02083492837846279, decouple_loss:0.007350501604378223
The generated pressure mean: 0.4508030116558075
loss_pred:0.019697966054081917, decouple_loss:0.007358933798968792
Iteration: 5117, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4282190799713135
loss_pred:0.021715465933084488, decouple_loss:0.004124871455132961
The generated pressure mean: 0.4257187843322754
loss_pred:0.019900379702448845, decouple_loss:0.003789916168898344
The generated pressure mean: 0.43200233578681946
loss_pred:0.021853599697351456, decouple_loss:0.0039725955575704575
Iteration: 5118, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4588157534599304
loss_pred:0.020666630938649178, decouple_loss:0.005992055870592594
The generated pressure mean: 0.4582589864730835
loss_pred:0.020448749884963036, decouple_loss:0.005687677301466465
The generated pressure mean: 0.4594707190990448
loss_pred:0.021694522351026535, decouple_loss:0.005918425042182207
Iteration: 5119, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.444990873336792
The generated pressure mean: 0.44464728236198425
loss_pred:0.02085445076227188, decouple_loss:0.004491098690778017
loss_pred:0.02059088461101055, decouple_loss:0.004302547313272953
The generated pressure mean: 0.44843390583992004
loss_pred:0.020673315972089767, decouple_loss:0.004271176178008318
Iteration: 5120, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45010876655578613
The generated pressure mean: 0.4469299018383026
loss_pred:0.01858924701809883, decouple_loss:0.0050907135009765625
loss_pred:0.01977708749473095, decouple_loss:0.004810555838048458
The generated pressure mean: 0.44669315218925476
loss_pred:0.021162856370210648, decouple_loss:0.004917139653116465
2023-04-17 07:09:27 testing...
The generated pressure mean: 0.41414615511894226
The generated pressure mean: 0.4224338233470917
The generated pressure mean: 0.42526745796203613
loss_pred:0.03407609835267067, decouple_loss:0.00572122260928154
loss_pred:0.03269028663635254, decouple_loss:0.005930117331445217
loss_pred:0.032876960933208466, decouple_loss:0.005967133212834597
WV_0_PC_0_EH_1_PS_40, loss: 0.033508092164993286, avg_mse: 0.04922342300415039
current test mse: 0.049223
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 5121, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461648166179657
loss_pred:0.020649202167987823, decouple_loss:0.005169481970369816
The generated pressure mean: 0.4515021741390228
The generated pressure mean: 0.4459618628025055
loss_pred:0.022164326161146164, decouple_loss:0.0053147366270422935
loss_pred:0.02144688367843628, decouple_loss:0.005393464118242264
Iteration: 5122, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43775710463523865
The generated pressure mean: 0.44699838757514954
loss_pred:0.021882889792323112, decouple_loss:0.004269493278115988
loss_pred:0.021661007776856422, decouple_loss:0.0043654292821884155
The generated pressure mean: 0.4425990879535675
loss_pred:0.022709032520651817, decouple_loss:0.004205865319818258
Iteration: 5123, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4453604221343994
loss_pred:0.021625682711601257, decouple_loss:0.004318393301218748
The generated pressure mean: 0.44933876395225525
loss_pred:0.022061889991164207, decouple_loss:0.004286748357117176
The generated pressure mean: 0.44175809621810913
loss_pred:0.022071225568652153, decouple_loss:0.0042366571724414825
Iteration: 5124, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45166438817977905
loss_pred:0.022696342319250107, decouple_loss:0.004813286941498518
The generated pressure mean: 0.44387272000312805
loss_pred:0.021780233830213547, decouple_loss:0.004720895551145077
The generated pressure mean: 0.44888216257095337
loss_pred:0.02133077383041382, decouple_loss:0.004782336298376322
Iteration: 5125, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4567454159259796
loss_pred:0.024077197536826134, decouple_loss:0.006023196969181299
The generated pressure mean: 0.45167285203933716
loss_pred:0.020660188049077988, decouple_loss:0.006057035177946091
The generated pressure mean: 0.4533047378063202
loss_pred:0.020134685561060905, decouple_loss:0.005948722828179598
Iteration: 5126, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4373808801174164
loss_pred:0.020869335159659386, decouple_loss:0.004005001857876778
The generated pressure mean: 0.44464027881622314
loss_pred:0.023058397695422173, decouple_loss:0.00412579532712698
The generated pressure mean: 0.44151565432548523
loss_pred:0.020719949156045914, decouple_loss:0.004011054057627916
Iteration: 5127, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4403538703918457
loss_pred:0.02038589119911194, decouple_loss:0.006403214763849974
The generated pressure mean: 0.4448895752429962
loss_pred:0.02078634686768055, decouple_loss:0.006331505253911018
The generated pressure mean: 0.4420959949493408
loss_pred:0.023968225345015526, decouple_loss:0.006185777019709349
Iteration: 5128, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4607243835926056
The generated pressure mean: 0.4615442156791687
loss_pred:0.02174564078450203, decouple_loss:0.004395973868668079
loss_pred:0.021146584302186966, decouple_loss:0.004265594761818647
The generated pressure mean: 0.46163779497146606
loss_pred:0.022578595206141472, decouple_loss:0.004272370599210262
Iteration: 5129, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4401414096355438
The generated pressure mean: 0.4305228292942047loss_pred:0.02266286499798298, decouple_loss:0.005253389477729797
loss_pred:0.021593885496258736, decouple_loss:0.005362320225685835
The generated pressure mean: 0.443651020526886
loss_pred:0.021590344607830048, decouple_loss:0.0055348859168589115
Iteration: 5130, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43962445855140686
The generated pressure mean: 0.4377017021179199
loss_pred:0.02089615724980831, decouple_loss:0.00447721965610981
loss_pred:0.021160010248422623, decouple_loss:0.004400947596877813
The generated pressure mean: 0.4417174160480499
loss_pred:0.02111068367958069, decouple_loss:0.004696421790868044
2023-04-17 07:11:52 testing...
The generated pressure mean: 0.4134828448295593
The generated pressure mean: 0.42073071002960205
The generated pressure mean: 0.423737496137619
loss_pred:0.03488127887248993, decouple_loss:0.005253741983324289
loss_pred:0.03329933434724808, decouple_loss:0.005590385291725397
loss_pred:0.03339218348264694, decouple_loss:0.005855056457221508
WV_0_PC_0_EH_1_PS_40, loss: 0.03413591906428337, avg_mse: 0.049944501370191574
current test mse: 0.049944
Iteration: 5131, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45457667112350464
The generated pressure mean: 0.4545980393886566
loss_pred:0.020376799628138542, decouple_loss:0.004758071154356003
loss_pred:0.02281685173511505, decouple_loss:0.004669873975217342
The generated pressure mean: 0.45433396100997925
loss_pred:0.019835250452160835, decouple_loss:0.0048747798427939415
Iteration: 5132, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45283952355384827
The generated pressure mean: 0.4433276057243347
loss_pred:0.024154765531420708, decouple_loss:0.004762906115502119
loss_pred:0.020901596173644066, decouple_loss:0.004661680664867163
The generated pressure mean: 0.44422104954719543
loss_pred:0.02197330817580223, decouple_loss:0.004841782618314028
Iteration: 5133, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43454018235206604
The generated pressure mean: 0.4358411133289337
loss_pred:0.0207848958671093, decouple_loss:0.004697320517152548
loss_pred:0.021701378747820854, decouple_loss:0.005353926215320826
The generated pressure mean: 0.4378329813480377
loss_pred:0.021103350445628166, decouple_loss:0.005271123256534338
Iteration: 5134, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4572116434574127
loss_pred:0.021484581753611565, decouple_loss:0.004623716697096825
The generated pressure mean: 0.45092153549194336
loss_pred:0.02261977642774582, decouple_loss:0.005097693298012018
The generated pressure mean: 0.4551629424095154
loss_pred:0.02075185626745224, decouple_loss:0.00475330650806427
Iteration: 5135, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4554102420806885
The generated pressure mean: 0.454963743686676
loss_pred:0.02106580324470997, decouple_loss:0.004435436800122261
loss_pred:0.02071545645594597, decouple_loss:0.0044943285174667835
The generated pressure mean: 0.4552416205406189
loss_pred:0.02201572246849537, decouple_loss:0.004596884828060865
Iteration: 5136, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43168744444847107
The generated pressure mean: 0.4393296539783478
loss_pred:0.02202870510518551, decouple_loss:0.004211840219795704
loss_pred:0.019848724827170372, decouple_loss:0.003993321675807238
The generated pressure mean: 0.43918171525001526
loss_pred:0.02103063277900219, decouple_loss:0.004169681575149298
Iteration: 5137, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4411543309688568
The generated pressure mean: 0.43977090716362
loss_pred:0.02236093208193779, decouple_loss:0.0043692574836313725
loss_pred:0.02121242880821228, decouple_loss:0.003862205892801285
The generated pressure mean: 0.4422817528247833
loss_pred:0.022386692464351654, decouple_loss:0.004062758293002844
Iteration: 5138, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4598100781440735
loss_pred:0.024292564019560814, decouple_loss:0.0038276859559118748
The generated pressure mean: 0.4545968770980835
loss_pred:0.02176174335181713, decouple_loss:0.0038649598136544228
The generated pressure mean: 0.45551517605781555
loss_pred:0.023074854165315628, decouple_loss:0.0039847902953624725
Iteration: 5139, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4359208643436432
The generated pressure mean: 0.43659764528274536
loss_pred:0.020174138247966766, decouple_loss:0.003890987951308489
loss_pred:0.022010544314980507, decouple_loss:0.004437140189111233
The generated pressure mean: 0.43274569511413574
loss_pred:0.02158495783805847, decouple_loss:0.003906611353158951
Iteration: 5140, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4511178433895111
loss_pred:0.022618845105171204, decouple_loss:0.004440333694219589
The generated pressure mean: 0.4449324607849121
loss_pred:0.021006420254707336, decouple_loss:0.004161028657108545
The generated pressure mean: 0.4480305016040802
loss_pred:0.022037476301193237, decouple_loss:0.004883752204477787
2023-04-17 07:13:44 testing...
The generated pressure mean: 0.4130764305591583
The generated pressure mean: 0.4214157164096832
loss_pred:0.03619266301393509, decouple_loss:0.006923329550772905
The generated pressure mean: 0.4239206910133362
loss_pred:0.035125430673360825, decouple_loss:0.007396523375064135
loss_pred:0.03495176509022713, decouple_loss:0.00758884334936738
WV_0_PC_0_EH_1_PS_40, loss: 0.03578843176364899, avg_mse: 0.05303880199790001
current test mse: 0.053039
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 5141, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45351269841194153
loss_pred:0.021609045565128326, decouple_loss:0.00548870675265789
The generated pressure mean: 0.45693764090538025
loss_pred:0.021477237343788147, decouple_loss:0.005419044755399227
The generated pressure mean: 0.4573008418083191
loss_pred:0.02148667722940445, decouple_loss:0.005361713003367186
Iteration: 5142, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44568386673927307
The generated pressure mean: 0.44414278864860535
loss_pred:0.021578697487711906, decouple_loss:0.005487861577421427
loss_pred:0.02055634930729866, decouple_loss:0.005771016236394644
The generated pressure mean: 0.4446564018726349
loss_pred:0.02149185910820961, decouple_loss:0.005729456897825003
Iteration: 5143, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4430544078350067
The generated pressure mean: 0.4441077709197998
loss_pred:0.02225358784198761, decouple_loss:0.004417461343109608
loss_pred:0.021627433598041534, decouple_loss:0.004580892156809568
The generated pressure mean: 0.44542521238327026
loss_pred:0.020433150231838226, decouple_loss:0.004506600089371204
Iteration: 5144, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44436442852020264
The generated pressure mean: 0.44851741194725037
loss_pred:0.02096680924296379, decouple_loss:0.004830915480852127
loss_pred:0.021332357078790665, decouple_loss:0.004688823129981756
The generated pressure mean: 0.44471001625061035
loss_pred:0.020903462544083595, decouple_loss:0.00485819298774004
Iteration: 5145, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44324231147766113
The generated pressure mean: 0.44087713956832886
loss_pred:0.02017226442694664, decouple_loss:0.006644511129707098
loss_pred:0.019729457795619965, decouple_loss:0.006837808061391115
The generated pressure mean: 0.4450421929359436
loss_pred:0.020153287798166275, decouple_loss:0.006755567621439695
Iteration: 5146, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4417192041873932
The generated pressure mean: 0.44264474511146545
loss_pred:0.0199366994202137, decouple_loss:0.004544420167803764
loss_pred:0.021058116108179092, decouple_loss:0.004614654462784529
The generated pressure mean: 0.4405815899372101
loss_pred:0.023266682401299477, decouple_loss:0.00474211061373353
Iteration: 5147, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44637835025787354
The generated pressure mean: 0.45355111360549927
loss_pred:0.02128712832927704, decouple_loss:0.005621668882668018
loss_pred:0.022440122440457344, decouple_loss:0.006007015705108643
The generated pressure mean: 0.45344892144203186
loss_pred:0.020745528861880302, decouple_loss:0.005771480966359377
Iteration: 5148, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4590270519256592
loss_pred:0.020687991753220558, decouple_loss:0.005389713216573
The generated pressure mean: 0.46360963582992554
loss_pred:0.02014719322323799, decouple_loss:0.005363671109080315
The generated pressure mean: 0.46271762251853943
loss_pred:0.019502606242895126, decouple_loss:0.005073902662843466
Iteration: 5149, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4408904016017914
The generated pressure mean: 0.43961963057518005
loss_pred:0.020118724554777145, decouple_loss:0.004634175915271044
loss_pred:0.021085644140839577, decouple_loss:0.004708124324679375
The generated pressure mean: 0.43874767422676086
loss_pred:0.02014964073896408, decouple_loss:0.004772386513650417
Iteration: 5150, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4312434494495392
loss_pred:0.02103164978325367, decouple_loss:0.006165388971567154
The generated pressure mean: 0.4311721920967102
loss_pred:0.019143689423799515, decouple_loss:0.0061347302980721
The generated pressure mean: 0.42773404717445374
loss_pred:0.020815346390008926, decouple_loss:0.006235819309949875
2023-04-17 07:16:15 testing...
The generated pressure mean: 0.4139356315135956
The generated pressure mean: 0.42184317111968994
loss_pred:0.03469020500779152, decouple_loss:0.005507160909473896
The generated pressure mean: 0.4244205355644226
loss_pred:0.03392237797379494, decouple_loss:0.005955399014055729
loss_pred:0.03370049595832825, decouple_loss:0.006111783441156149
WV_0_PC_0_EH_1_PS_40, loss: 0.03439726680517197, avg_mse: 0.050434261560440063
current test mse: 0.050434
Iteration: 5151, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44936302304267883
loss_pred:0.020473038777709007, decouple_loss:0.004910314455628395
The generated pressure mean: 0.4482906758785248
loss_pred:0.019752731546759605, decouple_loss:0.004717913456261158
The generated pressure mean: 0.447118878364563
loss_pred:0.020868437364697456, decouple_loss:0.0047501386143267155
Iteration: 5152, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4684702157974243
loss_pred:0.02270207554101944, decouple_loss:0.005597763694822788
The generated pressure mean: 0.46305879950523376
loss_pred:0.020145654678344727, decouple_loss:0.005608987528830767
The generated pressure mean: 0.46690061688423157
loss_pred:0.021832264959812164, decouple_loss:0.005765908397734165
Iteration: 5153, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.440002977848053
loss_pred:0.01981082558631897, decouple_loss:0.004621455911546946
The generated pressure mean: 0.4425199627876282
loss_pred:0.020240209996700287, decouple_loss:0.004729294218122959
The generated pressure mean: 0.44166848063468933
loss_pred:0.02100461535155773, decouple_loss:0.004697503987699747
Iteration: 5154, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42592379450798035
loss_pred:0.021847059950232506, decouple_loss:0.005625345278531313
The generated pressure mean: 0.42666709423065186
loss_pred:0.020730644464492798, decouple_loss:0.005511109251528978
The generated pressure mean: 0.42408716678619385
loss_pred:0.020403316244482994, decouple_loss:0.005852873902767897
Iteration: 5155, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45131435990333557
The generated pressure mean: 0.44642484188079834
loss_pred:0.021348079666495323, decouple_loss:0.00461663119494915
loss_pred:0.020314790308475494, decouple_loss:0.004583068657666445
The generated pressure mean: 0.4481346607208252
loss_pred:0.020529072731733322, decouple_loss:0.004576832056045532
Iteration: 5156, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4644472897052765
The generated pressure mean: 0.4663766622543335
loss_pred:0.022563684731721878, decouple_loss:0.005099417641758919
loss_pred:0.021461758762598038, decouple_loss:0.004964607302099466
The generated pressure mean: 0.47194966673851013
loss_pred:0.021528882905840874, decouple_loss:0.004957251716405153
Iteration: 5157, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44403910636901855
The generated pressure mean: 0.4465409219264984
loss_pred:0.021777484565973282, decouple_loss:0.004778770729899406
loss_pred:0.020198827609419823, decouple_loss:0.0046173338778316975
The generated pressure mean: 0.44747427105903625
loss_pred:0.019259929656982422, decouple_loss:0.004498718306422234
Iteration: 5158, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43489575386047363
loss_pred:0.019291723147034645, decouple_loss:0.00444877240806818
The generated pressure mean: 0.4368029534816742
loss_pred:0.022463439032435417, decouple_loss:0.00454184552654624
The generated pressure mean: 0.43582722544670105
loss_pred:0.01986389234662056, decouple_loss:0.004466741345822811
Iteration: 5159, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4382115602493286
loss_pred:0.02317221648991108, decouple_loss:0.0039785695262253284
The generated pressure mean: 0.4363557696342468
loss_pred:0.02048744075000286, decouple_loss:0.004098512697964907
The generated pressure mean: 0.44177132844924927
loss_pred:0.021336745470762253, decouple_loss:0.004133652895689011
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5160, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44043639302253723
loss_pred:0.019803781062364578, decouple_loss:0.004255157895386219
The generated pressure mean: 0.44724053144454956
loss_pred:0.022375699132680893, decouple_loss:0.004359255079180002
The generated pressure mean: 0.4463077187538147
loss_pred:0.021649116650223732, decouple_loss:0.004172746557742357
2023-04-17 07:18:09 testing...
The generated pressure mean: 0.4123868942260742
The generated pressure mean: 0.4210921823978424
The generated pressure mean: 0.42434874176979065
loss_pred:0.033697862178087234, decouple_loss:0.004882148001343012
loss_pred:0.03221304342150688, decouple_loss:0.0050718216225504875
loss_pred:0.03204513341188431, decouple_loss:0.005333145149052143
WV_0_PC_0_EH_1_PS_40, loss: 0.032906800508499146, avg_mse: 0.04805042967200279
current test mse: 0.04805
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 5161, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4537827670574188
loss_pred:0.022211825475096703, decouple_loss:0.0043953279964625835
The generated pressure mean: 0.4524019956588745
loss_pred:0.02031526528298855, decouple_loss:0.0043027810752391815
The generated pressure mean: 0.4546806216239929
loss_pred:0.02136685699224472, decouple_loss:0.0038995842915028334
Iteration: 5162, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4553021788597107
The generated pressure mean: 0.4529265761375427
loss_pred:0.020806362852454185, decouple_loss:0.004119758028537035
loss_pred:0.02160671539604664, decouple_loss:0.004058748949319124
The generated pressure mean: 0.45455634593963623
loss_pred:0.020106704905629158, decouple_loss:0.003991005942225456
Iteration: 5163, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44066664576530457
The generated pressure mean: 0.44217559695243835
loss_pred:0.020030224695801735, decouple_loss:0.0037845878396183252
loss_pred:0.021292515099048615, decouple_loss:0.004018652718514204
The generated pressure mean: 0.44507455825805664
loss_pred:0.021450471132993698, decouple_loss:0.003779427148401737
Iteration: 5164, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.442597359418869
The generated pressure mean: 0.44543468952178955
loss_pred:0.021177543327212334, decouple_loss:0.0038301541935652494
loss_pred:0.023189468309283257, decouple_loss:0.003715352388098836
The generated pressure mean: 0.4430384039878845
loss_pred:0.02154848538339138, decouple_loss:0.0036027340684086084
Iteration: 5165, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44765979051589966
The generated pressure mean: 0.4461171627044678
loss_pred:0.02106129378080368, decouple_loss:0.003747623646631837
loss_pred:0.020747974514961243, decouple_loss:0.0036082735750824213
The generated pressure mean: 0.4490690529346466
loss_pred:0.020037777721881866, decouple_loss:0.0037406240589916706
Iteration: 5166, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.458270788192749
The generated pressure mean: 0.45287802815437317
loss_pred:0.020317688584327698, decouple_loss:0.003987377975136042
loss_pred:0.02249201014637947, decouple_loss:0.003986875992268324
The generated pressure mean: 0.45779600739479065
loss_pred:0.02098742499947548, decouple_loss:0.004210665822029114
Iteration: 5167, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4395977854728699
The generated pressure mean: 0.44386911392211914
loss_pred:0.02267310954630375, decouple_loss:0.0043632094748318195
loss_pred:0.020401015877723694, decouple_loss:0.00426711980253458
The generated pressure mean: 0.4421837329864502
loss_pred:0.02050849050283432, decouple_loss:0.004439011216163635
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5168, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44817936420440674
loss_pred:0.02076110802590847, decouple_loss:0.004542050417512655
The generated pressure mean: 0.44631361961364746
loss_pred:0.02001241035759449, decouple_loss:0.004645644687116146
The generated pressure mean: 0.4489462375640869
loss_pred:0.02037372626364231, decouple_loss:0.004865438677370548
Iteration: 5169, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507896304130554
loss_pred:0.019759729504585266, decouple_loss:0.003732752287760377
The generated pressure mean: 0.45416930317878723
loss_pred:0.020295802503824234, decouple_loss:0.003697036998346448
The generated pressure mean: 0.4539329707622528
loss_pred:0.019965363666415215, decouple_loss:0.003707421710714698
Iteration: 5170, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4377806782722473
loss_pred:0.021127255633473396, decouple_loss:0.0036050269845873117
The generated pressure mean: 0.44283121824264526
loss_pred:0.02234562858939171, decouple_loss:0.0036517383996397257
The generated pressure mean: 0.4423537850379944
loss_pred:0.019730612635612488, decouple_loss:0.0037565617822110653
2023-04-17 07:20:38 testing...
The generated pressure mean: 0.4148796796798706
The generated pressure mean: 0.4226039946079254
loss_pred:0.033408477902412415, decouple_loss:0.0045806774869561195
The generated pressure mean: 0.42539650201797485
loss_pred:0.03279611095786095, decouple_loss:0.004841543268412352
loss_pred:0.032620783895254135, decouple_loss:0.005041017662733793
WV_0_PC_0_EH_1_PS_40, loss: 0.03318284451961517, avg_mse: 0.048400793224573135
current test mse: 0.048401
Iteration: 5171, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44643089175224304
loss_pred:0.022107193246483803, decouple_loss:0.0038262102752923965
The generated pressure mean: 0.4463726580142975
loss_pred:0.02053101733326912, decouple_loss:0.0038223392330110073
The generated pressure mean: 0.44941163063049316
loss_pred:0.02120177447795868, decouple_loss:0.003805742599070072
Iteration: 5172, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44972601532936096
loss_pred:0.01969480887055397, decouple_loss:0.0036757260095328093
The generated pressure mean: 0.4463007152080536
loss_pred:0.02095433697104454, decouple_loss:0.004054652526974678
The generated pressure mean: 0.44905275106430054
loss_pred:0.019344428554177284, decouple_loss:0.0039053752552717924
Iteration: 5173, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4602249264717102
loss_pred:0.02059139311313629, decouple_loss:0.004085245076566935
The generated pressure mean: 0.4550831615924835
loss_pred:0.019580887630581856, decouple_loss:0.004042846616357565
The generated pressure mean: 0.4568908214569092
loss_pred:0.020220408216118813, decouple_loss:0.00403232267126441
Iteration: 5174, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44586440920829773
loss_pred:0.020173711702227592, decouple_loss:0.004207149613648653
The generated pressure mean: 0.445794016122818
loss_pred:0.020113494247198105, decouple_loss:0.0042218975722789764
The generated pressure mean: 0.449567586183548
loss_pred:0.020256344228982925, decouple_loss:0.004279583692550659
Iteration: 5175, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43983206152915955
loss_pred:0.02035301923751831, decouple_loss:0.003960128873586655
The generated pressure mean: 0.4391579031944275
loss_pred:0.020714789628982544, decouple_loss:0.003997934516519308
The generated pressure mean: 0.440842866897583
loss_pred:0.022321077063679695, decouple_loss:0.003997382242232561
Iteration: 5176, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43810054659843445
loss_pred:0.021654535084962845, decouple_loss:0.003941727336496115
The generated pressure mean: 0.4363130033016205
loss_pred:0.021373404189944267, decouple_loss:0.004100326914340258
The generated pressure mean: 0.43568289279937744
loss_pred:0.020638901740312576, decouple_loss:0.003913613967597485
Iteration: 5177, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4632163643836975
The generated pressure mean: 0.46224918961524963loss_pred:0.020454609766602516, decouple_loss:0.004691950511187315
loss_pred:0.020611731335520744, decouple_loss:0.004726978484541178
The generated pressure mean: 0.4603031873703003
loss_pred:0.01933273859322071, decouple_loss:0.004412641283124685
Iteration: 5178, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499921202659607
loss_pred:0.01996591128408909, decouple_loss:0.004550001583993435
The generated pressure mean: 0.4503999352455139
loss_pred:0.02162567898631096, decouple_loss:0.00455938745290041
The generated pressure mean: 0.45219704508781433
loss_pred:0.019576244056224823, decouple_loss:0.004558623302727938
Iteration: 5179, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43948379158973694
loss_pred:0.02131451852619648, decouple_loss:0.003935186192393303
The generated pressure mean: 0.4378199875354767
loss_pred:0.020662495866417885, decouple_loss:0.003921093884855509
The generated pressure mean: 0.43821457028388977
loss_pred:0.020897923037409782, decouple_loss:0.0037541661877185106
Iteration: 5180, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4545458257198334
loss_pred:0.02057778462767601, decouple_loss:0.0032787113450467587
The generated pressure mean: 0.4564269781112671
loss_pred:0.021531516686081886, decouple_loss:0.0035621104761958122
The generated pressure mean: 0.4536355137825012
loss_pred:0.020649287849664688, decouple_loss:0.003436730708926916
2023-04-17 07:22:31 testing...
The generated pressure mean: 0.4205459952354431
The generated pressure mean: 0.4124922454357147
loss_pred:0.0343933068215847, decouple_loss:0.0043503958731889725
loss_pred:0.0356610044836998, decouple_loss:0.004095979034900665
The generated pressure mean: 0.4235178232192993
loss_pred:0.03440922498703003, decouple_loss:0.0045584579929709435
WV_0_PC_0_EH_1_PS_40, loss: 0.03503792732954025, avg_mse: 0.051917705684900284
current test mse: 0.051918
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 5181, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4548831284046173
loss_pred:0.0218785610049963, decouple_loss:0.0033379062078893185
The generated pressure mean: 0.4507991671562195
loss_pred:0.020446868613362312, decouple_loss:0.003350656246766448
The generated pressure mean: 0.4557960033416748
loss_pred:0.020098963752388954, decouple_loss:0.0031348331831395626
Iteration: 5182, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4267425239086151
The generated pressure mean: 0.42254647612571716
loss_pred:0.020553022623062134, decouple_loss:0.0036287952680140734
loss_pred:0.02028425969183445, decouple_loss:0.0036149886436760426
The generated pressure mean: 0.4255647361278534
loss_pred:0.018973246216773987, decouple_loss:0.003779688850045204
Iteration: 5183, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504101574420929The generated pressure mean: 0.4406631886959076
loss_pred:0.01882798597216606, decouple_loss:0.0036402910482138395loss_pred:0.01945294253528118, decouple_loss:0.003652266226708889
The generated pressure mean: 0.4491066336631775
loss_pred:0.019731471315026283, decouple_loss:0.0035820475313812494
Iteration: 5184, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4685896337032318
The generated pressure mean: 0.46714478731155396
loss_pred:0.022394219413399696, decouple_loss:0.003974004648625851
loss_pred:0.019090894609689713, decouple_loss:0.003727484727278352
The generated pressure mean: 0.4648933410644531
loss_pred:0.019730493426322937, decouple_loss:0.00380612607114017
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5185, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4380887746810913
The generated pressure mean: 0.4437654912471771
loss_pred:0.021706154569983482, decouple_loss:0.004647140856832266
loss_pred:0.02115034870803356, decouple_loss:0.004558219108730555
The generated pressure mean: 0.4366806745529175
loss_pred:0.019457198679447174, decouple_loss:0.004106700420379639
Iteration: 5186, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4344817101955414
The generated pressure mean: 0.4312301576137543
loss_pred:0.020594369620084763, decouple_loss:0.003593411995097995
loss_pred:0.020282668992877007, decouple_loss:0.003639759961515665
The generated pressure mean: 0.43100833892822266
loss_pred:0.02008272521197796, decouple_loss:0.0037560437340289354
Iteration: 5187, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.460105299949646
loss_pred:0.020223241299390793, decouple_loss:0.003981688525527716
The generated pressure mean: 0.4560741186141968
loss_pred:0.02094094268977642, decouple_loss:0.004312765318900347
The generated pressure mean: 0.4546337425708771
loss_pred:0.020146386697888374, decouple_loss:0.004029047675430775
Iteration: 5188, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4514158368110657
loss_pred:0.02198837883770466, decouple_loss:0.003962616436183453
The generated pressure mean: 0.4498002231121063
loss_pred:0.01986956223845482, decouple_loss:0.0038333856500685215
The generated pressure mean: 0.4566349983215332
loss_pred:0.019480697810649872, decouple_loss:0.00374703505076468
Iteration: 5189, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43072637915611267
loss_pred:0.01953108236193657, decouple_loss:0.003840463235974312
The generated pressure mean: 0.4330771863460541
loss_pred:0.022858530282974243, decouple_loss:0.003704063594341278
The generated pressure mean: 0.4281403720378876
loss_pred:0.019606413319706917, decouple_loss:0.0038215764798223972
Iteration: 5190, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4409363269805908
The generated pressure mean: 0.44614550471305847
loss_pred:0.020061062648892403, decouple_loss:0.003743187990039587
loss_pred:0.020506957545876503, decouple_loss:0.00366339017637074
The generated pressure mean: 0.4447961151599884
loss_pred:0.020929569378495216, decouple_loss:0.003657420864328742
2023-04-17 07:25:04 testing...
The generated pressure mean: 0.4106667935848236
The generated pressure mean: 0.41928407549858093
loss_pred:0.03542451187968254, decouple_loss:0.004592771641910076
The generated pressure mean: 0.4221683740615845
loss_pred:0.034282468259334564, decouple_loss:0.004931963514536619
loss_pred:0.034314416348934174, decouple_loss:0.005163662601262331
WV_0_PC_0_EH_1_PS_40, loss: 0.03491860628128052, avg_mse: 0.05152168869972229
current test mse: 0.051522
Iteration: 5191, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4617023766040802
The generated pressure mean: 0.4595365524291992
loss_pred:0.01996883749961853, decouple_loss:0.003920769318938255
loss_pred:0.021661467850208282, decouple_loss:0.003998566884547472
The generated pressure mean: 0.4610825479030609
loss_pred:0.02275199629366398, decouple_loss:0.004034548997879028
Iteration: 5192, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4298122823238373
The generated pressure mean: 0.43552151322364807
loss_pred:0.020566368475556374, decouple_loss:0.004594576545059681
loss_pred:0.01864364929497242, decouple_loss:0.004524983931332827
The generated pressure mean: 0.4306434094905853
loss_pred:0.021782727912068367, decouple_loss:0.004555718507617712
Iteration: 5193, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4520420730113983
loss_pred:0.02121632732450962, decouple_loss:0.0034894465934485197
The generated pressure mean: 0.4497421383857727
loss_pred:0.019887316972017288, decouple_loss:0.0034375519026070833
The generated pressure mean: 0.44768527150154114
loss_pred:0.022841548547148705, decouple_loss:0.0035055309999734163
Iteration: 5194, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493577778339386
loss_pred:0.02022681199014187, decouple_loss:0.004165972582995892
The generated pressure mean: 0.45469117164611816
loss_pred:0.020725388079881668, decouple_loss:0.004193206783384085
The generated pressure mean: 0.45459648966789246
loss_pred:0.02041834592819214, decouple_loss:0.003981484100222588
Iteration: 5195, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4426036775112152
loss_pred:0.0204157717525959, decouple_loss:0.0037685094866901636
The generated pressure mean: 0.447981595993042
loss_pred:0.02157806232571602, decouple_loss:0.003761828877031803
The generated pressure mean: 0.44601893424987793
loss_pred:0.019743438810110092, decouple_loss:0.003713047131896019
Iteration: 5196, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43652909994125366
loss_pred:0.020797517150640488, decouple_loss:0.004043025895953178
The generated pressure mean: 0.4342261552810669
loss_pred:0.019841203466057777, decouple_loss:0.003938273526728153
The generated pressure mean: 0.43612387776374817
loss_pred:0.020812461152672768, decouple_loss:0.003970345947891474
Iteration: 5197, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4518907070159912
loss_pred:0.020418770611286163, decouple_loss:0.003771892748773098
The generated pressure mean: 0.4490703046321869
loss_pred:0.022502990439534187, decouple_loss:0.0037189549766480923
The generated pressure mean: 0.45049676299095154
loss_pred:0.022030744701623917, decouple_loss:0.003805281827226281
Iteration: 5198, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45182666182518005
loss_pred:0.02168390527367592, decouple_loss:0.004517015535384417
The generated pressure mean: 0.4445039629936218
loss_pred:0.021330688148736954, decouple_loss:0.004560578614473343
The generated pressure mean: 0.44526538252830505
loss_pred:0.02084207534790039, decouple_loss:0.004497721791267395
Iteration: 5199, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44320234656333923
loss_pred:0.023977620527148247, decouple_loss:0.004261225927621126
The generated pressure mean: 0.4485473334789276
loss_pred:0.02081546001136303, decouple_loss:0.00399792892858386
The generated pressure mean: 0.4454294443130493
loss_pred:0.020747561007738113, decouple_loss:0.0042518447153270245
Iteration: 5200, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43778377771377563
loss_pred:0.022193295881152153, decouple_loss:0.00424795551225543
The generated pressure mean: 0.44135618209838867
loss_pred:0.018877338618040085, decouple_loss:0.0041380831971764565
The generated pressure mean: 0.43761518597602844
loss_pred:0.021103234961628914, decouple_loss:0.00422932393848896
2023-04-17 07:26:57 testing...
The generated pressure mean: 0.4145069122314453
The generated pressure mean: 0.4218130111694336
The generated pressure mean: 0.42400825023651123
loss_pred:0.03386891260743141, decouple_loss:0.005161781329661608
loss_pred:0.032911837100982666, decouple_loss:0.005334673915058374
loss_pred:0.033146388828754425, decouple_loss:0.005511278752237558
WV_0_PC_0_EH_1_PS_40, loss: 0.03357584401965141, avg_mse: 0.04865945875644684
current test mse: 0.048659
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 5201, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502582550048828
The generated pressure mean: 0.4498274028301239loss_pred:0.021498067304491997, decouple_loss:0.004401721525937319
loss_pred:0.01988152042031288, decouple_loss:0.004361108411103487
The generated pressure mean: 0.4461636543273926
loss_pred:0.02081519365310669, decouple_loss:0.004196207504719496
Iteration: 5202, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46176907420158386
The generated pressure mean: 0.45913270115852356
loss_pred:0.02010846510529518, decouple_loss:0.004254643339663744
loss_pred:0.02168056182563305, decouple_loss:0.004581416491419077
The generated pressure mean: 0.46104544401168823
loss_pred:0.021735306829214096, decouple_loss:0.004780068062245846
Iteration: 5203, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4375699460506439
loss_pred:0.02038935385644436, decouple_loss:0.003654900938272476
The generated pressure mean: 0.4348571300506592
loss_pred:0.020636489614844322, decouple_loss:0.0036644332576543093
The generated pressure mean: 0.4372738003730774
loss_pred:0.020591268315911293, decouple_loss:0.003681390779092908
Iteration: 5204, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44865652918815613
The generated pressure mean: 0.44487959146499634
loss_pred:0.022339854389429092, decouple_loss:0.004430130124092102
loss_pred:0.022007983177900314, decouple_loss:0.004547585267573595
The generated pressure mean: 0.44106343388557434
loss_pred:0.020615331828594208, decouple_loss:0.0044361501932144165
Iteration: 5205, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44917866587638855
The generated pressure mean: 0.45400136709213257
loss_pred:0.021018238738179207, decouple_loss:0.005082402843981981
loss_pred:0.020552262663841248, decouple_loss:0.004700446035712957
The generated pressure mean: 0.4530796706676483
loss_pred:0.02189859002828598, decouple_loss:0.004950548987835646
Iteration: 5206, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4524975121021271
The generated pressure mean: 0.4523159861564636
loss_pred:0.02084946632385254, decouple_loss:0.004124246072024107
loss_pred:0.02112312987446785, decouple_loss:0.004316068720072508
The generated pressure mean: 0.44904065132141113
loss_pred:0.02004743553698063, decouple_loss:0.004182665143162012
Iteration: 5207, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44879966974258423
The generated pressure mean: 0.4442622661590576
loss_pred:0.021227046847343445, decouple_loss:0.0054208217188715935
loss_pred:0.02066303789615631, decouple_loss:0.005337238311767578
The generated pressure mean: 0.44407421350479126
loss_pred:0.020957497879862785, decouple_loss:0.00524586346000433
Iteration: 5208, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4552200734615326
loss_pred:0.02238505333662033, decouple_loss:0.004787233658134937
The generated pressure mean: 0.44828376173973083
loss_pred:0.01999577321112156, decouple_loss:0.004326437134295702
The generated pressure mean: 0.44401270151138306
loss_pred:0.019280515611171722, decouple_loss:0.004471784457564354
Iteration: 5209, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4396970272064209
loss_pred:0.021418914198875427, decouple_loss:0.004448251333087683
The generated pressure mean: 0.4431813359260559
loss_pred:0.01934012770652771, decouple_loss:0.004427643492817879
The generated pressure mean: 0.4401164948940277
loss_pred:0.021447336301207542, decouple_loss:0.004386927466839552
Iteration: 5210, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4511105418205261
loss_pred:0.02069011889398098, decouple_loss:0.0046554324217140675
The generated pressure mean: 0.45379188656806946
loss_pred:0.019724050536751747, decouple_loss:0.004866511095315218
The generated pressure mean: 0.45562100410461426
loss_pred:0.020612314343452454, decouple_loss:0.004838031250983477
2023-04-17 07:29:26 testing...
The generated pressure mean: 0.412409245967865
The generated pressure mean: 0.4200036823749542
loss_pred:0.034418635070323944, decouple_loss:0.0049412865191698074
The generated pressure mean: 0.4220132529735565
loss_pred:0.03324751555919647, decouple_loss:0.005219514947384596
loss_pred:0.03308626264333725, decouple_loss:0.005365652032196522
WV_0_PC_0_EH_1_PS_40, loss: 0.033842913806438446, avg_mse: 0.04917144775390625
current test mse: 0.049171
Iteration: 5211, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45867064595222473
loss_pred:0.020307065919041634, decouple_loss:0.004387625493109226
The generated pressure mean: 0.452735036611557
loss_pred:0.01987016201019287, decouple_loss:0.004098596051335335
The generated pressure mean: 0.4487587511539459
loss_pred:0.0206039696931839, decouple_loss:0.004165415186434984
Iteration: 5212, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4414004683494568
loss_pred:0.020875776186585426, decouple_loss:0.004874577280133963
The generated pressure mean: 0.44478535652160645
loss_pred:0.02188652567565441, decouple_loss:0.004653928801417351
The generated pressure mean: 0.43788373470306396
loss_pred:0.020628672093153, decouple_loss:0.004710504785180092
Iteration: 5213, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464786946773529
The generated pressure mean: 0.44343578815460205
loss_pred:0.02013513445854187, decouple_loss:0.004541759379208088
loss_pred:0.01961487904191017, decouple_loss:0.0043130116537213326
The generated pressure mean: 0.4490125775337219
loss_pred:0.020915674045681953, decouple_loss:0.004383792635053396
Iteration: 5214, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480109214782715
The generated pressure mean: 0.4452914893627167
loss_pred:0.020146053284406662, decouple_loss:0.004686466883867979
loss_pred:0.019663160666823387, decouple_loss:0.004669349640607834
The generated pressure mean: 0.4472651779651642
loss_pred:0.019822634756565094, decouple_loss:0.004408101085573435
Iteration: 5215, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4438798725605011
The generated pressure mean: 0.4498765468597412
loss_pred:0.020017549395561218, decouple_loss:0.004174757283180952
loss_pred:0.021173996850848198, decouple_loss:0.004195577930659056
The generated pressure mean: 0.45075902342796326
loss_pred:0.02023986540734768, decouple_loss:0.004231477156281471
Iteration: 5216, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44950971007347107
loss_pred:0.020112132653594017, decouple_loss:0.00393924955278635
The generated pressure mean: 0.4509229063987732
loss_pred:0.020612098276615143, decouple_loss:0.004022696521133184
The generated pressure mean: 0.45091602206230164
loss_pred:0.020335489884018898, decouple_loss:0.004028063267469406
Iteration: 5217, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449487030506134
The generated pressure mean: 0.4375273883342743
loss_pred:0.01984616182744503, decouple_loss:0.004246795084327459
loss_pred:0.01980060525238514, decouple_loss:0.004147952422499657
The generated pressure mean: 0.4465438425540924
loss_pred:0.020542483776807785, decouple_loss:0.004170865751802921
Iteration: 5218, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44895437359809875
The generated pressure mean: 0.4510922431945801
loss_pred:0.019758932292461395, decouple_loss:0.004517373628914356
loss_pred:0.020888909697532654, decouple_loss:0.004486944526433945
The generated pressure mean: 0.44828319549560547
loss_pred:0.02078813873231411, decouple_loss:0.0042823064140975475
Iteration: 5219, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468977451324463
The generated pressure mean: 0.45180490612983704
loss_pred:0.019931579008698463, decouple_loss:0.004307658411562443
loss_pred:0.020090974867343903, decouple_loss:0.003923448268324137
The generated pressure mean: 0.4515335261821747
loss_pred:0.02086959220468998, decouple_loss:0.0038304568734019995
Iteration: 5220, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505999684333801
The generated pressure mean: 0.45025989413261414
loss_pred:0.02060040645301342, decouple_loss:0.0038109172601252794
loss_pred:0.022174302488565445, decouple_loss:0.00398206664249301
The generated pressure mean: 0.44380173087120056
loss_pred:0.02073732390999794, decouple_loss:0.004134779330343008
2023-04-17 07:31:20 testing...
The generated pressure mean: 0.4244486093521118
The generated pressure mean: 0.4157921075820923
The generated pressure mean: 0.4274967312812805
loss_pred:0.03200628608465195, decouple_loss:0.004189696162939072
loss_pred:0.03301168978214264, decouple_loss:0.004007839597761631
loss_pred:0.0317588709294796, decouple_loss:0.004370661452412605
WV_0_PC_0_EH_1_PS_40, loss: 0.03246841952204704, avg_mse: 0.04706824943423271
current test mse: 0.047068
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5221, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44579368829727173
loss_pred:0.022624392062425613, decouple_loss:0.0035837062168866396
The generated pressure mean: 0.4444449543952942
loss_pred:0.02340260148048401, decouple_loss:0.0035612944047898054
The generated pressure mean: 0.43868979811668396
loss_pred:0.01994640752673149, decouple_loss:0.0035640352871268988
Iteration: 5222, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43860432505607605
The generated pressure mean: 0.44113102555274963
loss_pred:0.022945130243897438, decouple_loss:0.004048103000968695
loss_pred:0.02075585536658764, decouple_loss:0.003967043478041887
The generated pressure mean: 0.44542792439460754
loss_pred:0.024025646969676018, decouple_loss:0.00402476591989398
Iteration: 5223, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44711732864379883
The generated pressure mean: 0.44174855947494507
loss_pred:0.020546123385429382, decouple_loss:0.0037778173573315144
loss_pred:0.0218410175293684, decouple_loss:0.0037274539936333895
The generated pressure mean: 0.439414918422699
loss_pred:0.020172832533717155, decouple_loss:0.0037525021471083164
Iteration: 5224, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44985243678092957
loss_pred:0.020716341212391853, decouple_loss:0.0036300381179898977
The generated pressure mean: 0.4450913667678833
loss_pred:0.020102741196751595, decouple_loss:0.003773031523451209
The generated pressure mean: 0.4460478723049164
loss_pred:0.020027944818139076, decouple_loss:0.0035064443945884705
Iteration: 5225, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4510202705860138
loss_pred:0.022548265755176544, decouple_loss:0.0034422038588672876
The generated pressure mean: 0.44668129086494446
loss_pred:0.020893683657050133, decouple_loss:0.0035401044879108667
The generated pressure mean: 0.44913285970687866
loss_pred:0.02145390771329403, decouple_loss:0.0034678850788623095
Iteration: 5226, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45548781752586365
loss_pred:0.02237122505903244, decouple_loss:0.0038257595151662827
The generated pressure mean: 0.45328113436698914
loss_pred:0.021994173526763916, decouple_loss:0.003562665544450283
The generated pressure mean: 0.4516158699989319
loss_pred:0.02225641719996929, decouple_loss:0.0036680817138403654
Iteration: 5227, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4404502809047699
loss_pred:0.02148006297647953, decouple_loss:0.0037426636554300785
The generated pressure mean: 0.4334215819835663
loss_pred:0.019975857809185982, decouple_loss:0.0039544967003166676
The generated pressure mean: 0.4372178018093109
loss_pred:0.02088158018887043, decouple_loss:0.0038662259466946125
Iteration: 5228, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4438822567462921
loss_pred:0.02187766134738922, decouple_loss:0.003826643107458949
The generated pressure mean: 0.44229766726493835
loss_pred:0.021708358079195023, decouple_loss:0.0037670317105948925
The generated pressure mean: 0.4455520510673523
loss_pred:0.02057739533483982, decouple_loss:0.0037353718653321266
Iteration: 5229, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43860194087028503
loss_pred:0.021970465779304504, decouple_loss:0.0035802251659333706
The generated pressure mean: 0.44418027997016907
loss_pred:0.019794851541519165, decouple_loss:0.003521551610901952
The generated pressure mean: 0.4402419328689575
loss_pred:0.019589684903621674, decouple_loss:0.0037117016036063433
Iteration: 5230, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4562850594520569
loss_pred:0.024389924481511116, decouple_loss:0.003618621965870261
The generated pressure mean: 0.45805624127388
loss_pred:0.021551596000790596, decouple_loss:0.003593090223148465
The generated pressure mean: 0.4518106281757355
loss_pred:0.021377719938755035, decouple_loss:0.003616896690800786
2023-04-17 07:33:51 testing...
The generated pressure mean: 0.41593435406684875
The generated pressure mean: 0.42341578006744385
The generated pressure mean: 0.426138699054718
loss_pred:0.03222470358014107, decouple_loss:0.004629172850400209
loss_pred:0.030790822580456734, decouple_loss:0.005083919037133455
loss_pred:0.03155720233917236, decouple_loss:0.004979646299034357
WV_0_PC_0_EH_1_PS_40, loss: 0.031769122928380966, avg_mse: 0.04570972919464111
current test mse: 0.04571
Iteration: 5231, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44035637378692627
loss_pred:0.020219678059220314, decouple_loss:0.004195314832031727
The generated pressure mean: 0.43833646178245544
loss_pred:0.02013733610510826, decouple_loss:0.004044402856379747
The generated pressure mean: 0.43587419390678406
loss_pred:0.021842854097485542, decouple_loss:0.003967862110584974
Iteration: 5232, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4391326606273651
The generated pressure mean: 0.43988174200057983
loss_pred:0.02122536487877369, decouple_loss:0.0040728310123085976
loss_pred:0.020133014768362045, decouple_loss:0.004014793783426285
The generated pressure mean: 0.43813416361808777
loss_pred:0.021156486123800278, decouple_loss:0.003858019597828388
Iteration: 5233, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45115602016448975
The generated pressure mean: 0.4481135904788971
loss_pred:0.02153337374329567, decouple_loss:0.0035654122475534678
loss_pred:0.01932338997721672, decouple_loss:0.003576516406610608
The generated pressure mean: 0.45131248235702515
loss_pred:0.020616665482521057, decouple_loss:0.003446584567427635
Iteration: 5234, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4651787281036377
The generated pressure mean: 0.45626020431518555
loss_pred:0.02081107161939144, decouple_loss:0.004142771475017071
loss_pred:0.020497368648648262, decouple_loss:0.003974824212491512
The generated pressure mean: 0.45569249987602234
loss_pred:0.021737312898039818, decouple_loss:0.004274846985936165
Iteration: 5235, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4366432726383209
The generated pressure mean: 0.43735694885253906
loss_pred:0.020736653357744217, decouple_loss:0.003706394461914897
loss_pred:0.019910067319869995, decouple_loss:0.003631772706285119
The generated pressure mean: 0.4366576373577118
loss_pred:0.021212751045823097, decouple_loss:0.0037459267769008875
Iteration: 5236, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44657498598098755The generated pressure mean: 0.44352632761001587
loss_pred:0.0211354847997427, decouple_loss:0.0036002725828438997
loss_pred:0.02154192142188549, decouple_loss:0.003784630447626114
The generated pressure mean: 0.4397119879722595
loss_pred:0.02015678957104683, decouple_loss:0.00376978050917387
Iteration: 5237, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44886788725852966
The generated pressure mean: 0.4466817080974579
loss_pred:0.021497439593076706, decouple_loss:0.0038083656691014767
loss_pred:0.020426824688911438, decouple_loss:0.003824492683634162
The generated pressure mean: 0.44946086406707764
loss_pred:0.0220605731010437, decouple_loss:0.0037665124982595444
Iteration: 5238, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43985405564308167
loss_pred:0.02276536263525486, decouple_loss:0.004154409747570753
The generated pressure mean: 0.4392860233783722
loss_pred:0.01972832717001438, decouple_loss:0.004255734849721193
The generated pressure mean: 0.4377822279930115
loss_pred:0.021251332014799118, decouple_loss:0.004113560076802969
Iteration: 5239, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44665274024009705
loss_pred:0.023266121745109558, decouple_loss:0.003814436960965395
The generated pressure mean: 0.4418870806694031
loss_pred:0.020971260964870453, decouple_loss:0.0037832746747881174
The generated pressure mean: 0.4424443542957306
loss_pred:0.0202346108853817, decouple_loss:0.0037808301858603954
Iteration: 5240, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4573265612125397
loss_pred:0.02063129097223282, decouple_loss:0.00426394771784544
The generated pressure mean: 0.4528006911277771
loss_pred:0.02025325782597065, decouple_loss:0.004088397137820721
The generated pressure mean: 0.4611753225326538
loss_pred:0.022600874304771423, decouple_loss:0.0042634750716388226
2023-04-17 07:35:45 testing...
The generated pressure mean: 0.41558149456977844
The generated pressure mean: 0.42323726415634155
The generated pressure mean: 0.42513856291770935
loss_pred:0.0331047959625721, decouple_loss:0.004748017061501741
loss_pred:0.03209796920418739, decouple_loss:0.005010513123124838
loss_pred:0.03201764449477196, decouple_loss:0.005216232966631651
WV_0_PC_0_EH_1_PS_40, loss: 0.03265638276934624, avg_mse: 0.047084152698516846
current test mse: 0.047084
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 5241, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4419299364089966
loss_pred:0.02279782108962536, decouple_loss:0.004401171114295721
The generated pressure mean: 0.44860029220581055
loss_pred:0.02032095566391945, decouple_loss:0.0042859530076384544
The generated pressure mean: 0.44261205196380615
loss_pred:0.020337847992777824, decouple_loss:0.004323615226894617
Iteration: 5242, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4548965394496918
The generated pressure mean: 0.4497203528881073
loss_pred:0.02134968340396881, decouple_loss:0.005153866484761238
loss_pred:0.021018628031015396, decouple_loss:0.005225971341133118
The generated pressure mean: 0.4489305913448334
loss_pred:0.02038324810564518, decouple_loss:0.005265611223876476
Iteration: 5243, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4360162317752838
The generated pressure mean: 0.4455588459968567
loss_pred:0.020919615402817726, decouple_loss:0.004424709361046553
loss_pred:0.02056724578142166, decouple_loss:0.004311765544116497
The generated pressure mean: 0.4377349019050598
loss_pred:0.018855085596442223, decouple_loss:0.004395219963043928
Iteration: 5244, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43785718083381653
The generated pressure mean: 0.4355372190475464
loss_pred:0.021226083859801292, decouple_loss:0.00474885618314147
loss_pred:0.02225496806204319, decouple_loss:0.004792609717696905
The generated pressure mean: 0.44032248854637146
loss_pred:0.021784711629152298, decouple_loss:0.004748835228383541
Iteration: 5245, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46023938059806824
The generated pressure mean: 0.46688055992126465
loss_pred:0.019977562129497528, decouple_loss:0.005008474923670292
loss_pred:0.02371247671544552, decouple_loss:0.004694672767072916
The generated pressure mean: 0.45389214158058167
loss_pred:0.023299584165215492, decouple_loss:0.004670176655054092
Iteration: 5246, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4306196868419647
The generated pressure mean: 0.4328979551792145
loss_pred:0.02134859375655651, decouple_loss:0.004205914214253426
loss_pred:0.01916128769516945, decouple_loss:0.004111051093786955
The generated pressure mean: 0.43721288442611694
loss_pred:0.020579755306243896, decouple_loss:0.004204967524856329
Iteration: 5247, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44902515411376953
The generated pressure mean: 0.44616222381591797
loss_pred:0.023772386834025383, decouple_loss:0.005555997136980295
loss_pred:0.020153580233454704, decouple_loss:0.005305884871631861
The generated pressure mean: 0.44820961356163025
loss_pred:0.021410567685961723, decouple_loss:0.005365088582038879
Iteration: 5248, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489947259426117
The generated pressure mean: 0.451113760471344
loss_pred:0.020324254408478737, decouple_loss:0.004777221474796534
loss_pred:0.0205250047147274, decouple_loss:0.004739643074572086
The generated pressure mean: 0.4510246217250824
loss_pred:0.022387003526091576, decouple_loss:0.004712423775345087
Iteration: 5249, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45019176602363586
The generated pressure mean: 0.4496144652366638
loss_pred:0.021069657057523727, decouple_loss:0.004633907228708267
loss_pred:0.020370688289403915, decouple_loss:0.004736490081995726
The generated pressure mean: 0.45018792152404785
loss_pred:0.02119455114006996, decouple_loss:0.004459418822079897
Iteration: 5250, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44342857599258423
loss_pred:0.020326105877757072, decouple_loss:0.004252958577126265
The generated pressure mean: 0.442889004945755
loss_pred:0.02255963534116745, decouple_loss:0.004295400809496641
The generated pressure mean: 0.4451552927494049
loss_pred:0.021498210728168488, decouple_loss:0.004324878100305796
2023-04-17 07:38:13 testing...
The generated pressure mean: 0.4184507429599762
The generated pressure mean: 0.42547735571861267
loss_pred:0.03362638130784035, decouple_loss:0.00485197314992547
The generated pressure mean: 0.4280197322368622
loss_pred:0.033036213368177414, decouple_loss:0.005152836441993713
loss_pred:0.03235708549618721, decouple_loss:0.0053658983670175076
WV_0_PC_0_EH_1_PS_40, loss: 0.033262740820646286, avg_mse: 0.048398882150650024
current test mse: 0.048399
Iteration: 5251, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4333174526691437
loss_pred:0.022813482210040092, decouple_loss:0.004587783012539148
The generated pressure mean: 0.4306533634662628
loss_pred:0.020720357075333595, decouple_loss:0.0046003288589417934
The generated pressure mean: 0.43096673488616943
loss_pred:0.01969115063548088, decouple_loss:0.004573139827698469
Iteration: 5252, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4617953896522522
loss_pred:0.021067868918180466, decouple_loss:0.004416983108967543
The generated pressure mean: 0.46140795946121216
loss_pred:0.020830417051911354, decouple_loss:0.004607877228409052
The generated pressure mean: 0.46202343702316284
loss_pred:0.02001340501010418, decouple_loss:0.004651480820029974
Iteration: 5253, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4533584713935852
The generated pressure mean: 0.45020177960395813
loss_pred:0.021160759031772614, decouple_loss:0.004160501528531313
loss_pred:0.02213427796959877, decouple_loss:0.004226600285619497
The generated pressure mean: 0.4494878947734833
loss_pred:0.020345671102404594, decouple_loss:0.004101770464330912
Iteration: 5254, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4224604368209839
loss_pred:0.02118106558918953, decouple_loss:0.004045632667839527
The generated pressure mean: 0.42965224385261536
loss_pred:0.020254382863640785, decouple_loss:0.003954095765948296
The generated pressure mean: 0.42420944571495056
loss_pred:0.0199719350785017, decouple_loss:0.003938307054340839
Iteration: 5255, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4536900520324707
The generated pressure mean: 0.45326676964759827
loss_pred:0.02312096767127514, decouple_loss:0.004071131348609924
loss_pred:0.01973578706383705, decouple_loss:0.004120876546949148
The generated pressure mean: 0.45449313521385193
loss_pred:0.02267291769385338, decouple_loss:0.004073526244610548
Iteration: 5256, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4608395993709564
The generated pressure mean: 0.4610450565814972
loss_pred:0.020414721220731735, decouple_loss:0.00415456248447299
loss_pred:0.02016274631023407, decouple_loss:0.004074151627719402
The generated pressure mean: 0.46081623435020447
loss_pred:0.021447721868753433, decouple_loss:0.00412097480148077
Iteration: 5257, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43527597188949585
loss_pred:0.019057204946875572, decouple_loss:0.003758600912988186
The generated pressure mean: 0.4338158369064331
loss_pred:0.020298907533288002, decouple_loss:0.0037001969758421183
The generated pressure mean: 0.43263718485832214
loss_pred:0.019839255139231682, decouple_loss:0.0036679375916719437
Iteration: 5258, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4341721534729004
loss_pred:0.019963402301073074, decouple_loss:0.0037726948503404856
The generated pressure mean: 0.43450379371643066
loss_pred:0.019944576546549797, decouple_loss:0.0038299933075904846
The generated pressure mean: 0.4335448741912842
loss_pred:0.02020098641514778, decouple_loss:0.003812402253970504
Iteration: 5259, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4524957537651062
The generated pressure mean: 0.4543146789073944
loss_pred:0.02156676910817623, decouple_loss:0.0035446989350020885
loss_pred:0.0226614810526371, decouple_loss:0.003537449985742569
The generated pressure mean: 0.45348504185676575
loss_pred:0.020198598504066467, decouple_loss:0.0038276019040495157
Iteration: 5260, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46586352586746216
loss_pred:0.020691603422164917, decouple_loss:0.0037580530624836683
The generated pressure mean: 0.46496036648750305
loss_pred:0.020567622035741806, decouple_loss:0.003867612686008215
The generated pressure mean: 0.4652740955352783
loss_pred:0.02080014906823635, decouple_loss:0.003713864367455244
2023-04-17 07:40:07 testing...
The generated pressure mean: 0.41626691818237305
The generated pressure mean: 0.4233704209327698
loss_pred:0.03364141657948494, decouple_loss:0.004339086823165417
The generated pressure mean: 0.4265940487384796
loss_pred:0.03271258622407913, decouple_loss:0.00465458445250988
loss_pred:0.03268349543213844, decouple_loss:0.004921008367091417
WV_0_PC_0_EH_1_PS_40, loss: 0.03324441239237785, avg_mse: 0.04869226738810539
current test mse: 0.048692
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 5261, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472392201423645
loss_pred:0.0192999430000782, decouple_loss:0.003564761485904455
The generated pressure mean: 0.44709184765815735
loss_pred:0.01891501247882843, decouple_loss:0.0039011084008961916
The generated pressure mean: 0.4460580050945282
loss_pred:0.020959382876753807, decouple_loss:0.003919652197510004
Iteration: 5262, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4317905008792877
loss_pred:0.01974131353199482, decouple_loss:0.0038925441913306713
The generated pressure mean: 0.42768576741218567
loss_pred:0.021186228841543198, decouple_loss:0.003731742035597563
The generated pressure mean: 0.4302886128425598
loss_pred:0.020580366253852844, decouple_loss:0.0037579659838229418
Iteration: 5263, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44812870025634766
The generated pressure mean: 0.44032126665115356loss_pred:0.019883617758750916, decouple_loss:0.003560038283467293
loss_pred:0.020634541288018227, decouple_loss:0.0037332933861762285
The generated pressure mean: 0.44162610173225403
loss_pred:0.018953103572130203, decouple_loss:0.0036616583820432425
Iteration: 5264, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.454871267080307
The generated pressure mean: 0.45372965931892395
loss_pred:0.019273964688181877, decouple_loss:0.004088665824383497
loss_pred:0.019432170316576958, decouple_loss:0.0046349745243787766
The generated pressure mean: 0.4542156755924225
loss_pred:0.019600847736001015, decouple_loss:0.004492540378123522
Iteration: 5265, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4579302966594696
The generated pressure mean: 0.4539982080459595
loss_pred:0.01843785122036934, decouple_loss:0.0043890406377613544
loss_pred:0.02034723572432995, decouple_loss:0.004479750990867615
The generated pressure mean: 0.4507391154766083
loss_pred:0.019250251352787018, decouple_loss:0.004311295226216316
Iteration: 5266, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447734534740448
The generated pressure mean: 0.44882792234420776
loss_pred:0.02020244486629963, decouple_loss:0.0033991183154284954
loss_pred:0.01937311328947544, decouple_loss:0.003456812584772706
The generated pressure mean: 0.45123055577278137
loss_pred:0.02224520966410637, decouple_loss:0.003494440810754895
Iteration: 5267, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.437152624130249
The generated pressure mean: 0.4451199769973755
loss_pred:0.020423168316483498, decouple_loss:0.0034119042102247477
loss_pred:0.01924215443432331, decouple_loss:0.00338737852871418
The generated pressure mean: 0.4430577754974365
loss_pred:0.020097695291042328, decouple_loss:0.003430956741794944
Iteration: 5268, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44287174940109253
The generated pressure mean: 0.43998950719833374
loss_pred:0.017946407198905945, decouple_loss:0.003818751545622945
loss_pred:0.02030353993177414, decouple_loss:0.003879034658893943
The generated pressure mean: 0.4409003257751465
loss_pred:0.019000252708792686, decouple_loss:0.0038643707521259785
Iteration: 5269, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44727715849876404
loss_pred:0.021412499248981476, decouple_loss:0.0042650289833545685
The generated pressure mean: 0.4444360136985779
loss_pred:0.020638521760702133, decouple_loss:0.004213429056107998
The generated pressure mean: 0.43945056200027466
loss_pred:0.019728632643818855, decouple_loss:0.004177814349532127
Iteration: 5270, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46117687225341797
The generated pressure mean: 0.45976001024246216
loss_pred:0.019593587145209312, decouple_loss:0.003990080673247576
loss_pred:0.019204918295145035, decouple_loss:0.004024080000817776
The generated pressure mean: 0.4598165452480316
loss_pred:0.019818773493170738, decouple_loss:0.004094737581908703
2023-04-17 07:42:36 testing...
The generated pressure mean: 0.41397979855537415
The generated pressure mean: 0.4218156337738037
loss_pred:0.033346302807331085, decouple_loss:0.004183070734143257
The generated pressure mean: 0.4245956540107727
loss_pred:0.032303646206855774, decouple_loss:0.004448849242180586
loss_pred:0.031947072595357895, decouple_loss:0.004681914113461971
WV_0_PC_0_EH_1_PS_40, loss: 0.032754238694906235, avg_mse: 0.04790177568793297
current test mse: 0.047902
Iteration: 5271, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44711166620254517
loss_pred:0.02029087021946907, decouple_loss:0.0034768907353281975
The generated pressure mean: 0.4496065676212311
loss_pred:0.02107595093548298, decouple_loss:0.0033769647125154734
The generated pressure mean: 0.4489886462688446
loss_pred:0.019741572439670563, decouple_loss:0.003553654532879591
Iteration: 5272, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43541717529296875
loss_pred:0.02058292180299759, decouple_loss:0.003560601035133004
The generated pressure mean: 0.4372504651546478
loss_pred:0.01971612498164177, decouple_loss:0.003578804899007082
The generated pressure mean: 0.43586239218711853
loss_pred:0.01886487565934658, decouple_loss:0.003432638943195343
Iteration: 5273, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44958236813545227
loss_pred:0.020252812653779984, decouple_loss:0.004007771145552397
The generated pressure mean: 0.4498499929904938
loss_pred:0.01919877901673317, decouple_loss:0.004159861244261265
The generated pressure mean: 0.44863393902778625
loss_pred:0.020457129925489426, decouple_loss:0.003987451549619436
Iteration: 5274, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44461071491241455
loss_pred:0.01957862451672554, decouple_loss:0.00436837924644351
The generated pressure mean: 0.4456106126308441
loss_pred:0.019217485561966896, decouple_loss:0.004472761880606413
The generated pressure mean: 0.4477576017379761
loss_pred:0.018915044143795967, decouple_loss:0.0046316348016262054
Iteration: 5275, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44665494561195374
loss_pred:0.020787294954061508, decouple_loss:0.00346986367367208
The generated pressure mean: 0.4470437467098236
loss_pred:0.021654343232512474, decouple_loss:0.0035481909289956093
The generated pressure mean: 0.4460470974445343
loss_pred:0.019864244386553764, decouple_loss:0.0035312275867909193
Iteration: 5276, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46153026819229126
loss_pred:0.018946930766105652, decouple_loss:0.003384615993127227
The generated pressure mean: 0.46090224385261536
loss_pred:0.01967570371925831, decouple_loss:0.003497478784993291
The generated pressure mean: 0.4620518386363983
loss_pred:0.020114853978157043, decouple_loss:0.003495316719636321
Iteration: 5277, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43747678399086
loss_pred:0.0202422384172678, decouple_loss:0.0034099214244633913
The generated pressure mean: 0.4356498122215271
loss_pred:0.019200893118977547, decouple_loss:0.003369972575455904
The generated pressure mean: 0.4408518970012665
loss_pred:0.021092677488923073, decouple_loss:0.0035101433750241995
Iteration: 5278, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4322415292263031
loss_pred:0.021124228835105896, decouple_loss:0.002971216104924679
The generated pressure mean: 0.43288323283195496
loss_pred:0.020715409889817238, decouple_loss:0.002863760804757476
The generated pressure mean: 0.4338317811489105
loss_pred:0.020882222801446915, decouple_loss:0.0028790358919650316
Iteration: 5279, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507204294204712
loss_pred:0.020557571202516556, decouple_loss:0.004185816738754511
The generated pressure mean: 0.45000502467155457
loss_pred:0.019545651972293854, decouple_loss:0.00397581746801734
The generated pressure mean: 0.4546818435192108
loss_pred:0.02050865814089775, decouple_loss:0.00401730602607131
Iteration: 5280, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4533393085002899
loss_pred:0.019073665142059326, decouple_loss:0.004021276719868183
The generated pressure mean: 0.45407795906066895
loss_pred:0.019637949764728546, decouple_loss:0.003963670693337917
The generated pressure mean: 0.45563873648643494
loss_pred:0.020887622609734535, decouple_loss:0.004109218250960112
2023-04-17 07:44:30 testing...
The generated pressure mean: 0.4126494228839874
The generated pressure mean: 0.42052510380744934
The generated pressure mean: 0.42367032170295715
loss_pred:0.03308515250682831, decouple_loss:0.004416613839566708
loss_pred:0.03212997689843178, decouple_loss:0.004682553932070732
loss_pred:0.031809642910957336, decouple_loss:0.004875097889453173
WV_0_PC_0_EH_1_PS_40, loss: 0.032574497163295746, avg_mse: 0.047617245465517044
current test mse: 0.047617
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 5281, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45040658116340637
loss_pred:0.019844161346554756, decouple_loss:0.0036134326364845037
The generated pressure mean: 0.4537524878978729
The generated pressure mean: 0.4545716941356659
loss_pred:0.021054470911622047, decouple_loss:0.003870998276397586
loss_pred:0.022016165778040886, decouple_loss:0.003903402481228113
Iteration: 5282, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478493630886078
The generated pressure mean: 0.4476567506790161
loss_pred:0.02078389748930931, decouple_loss:0.0033285128884017467
loss_pred:0.02010704018175602, decouple_loss:0.0033724408131092787
The generated pressure mean: 0.4456344544887543
loss_pred:0.02194611169397831, decouple_loss:0.0034427661448717117
Iteration: 5283, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4304152727127075
The generated pressure mean: 0.4337593615055084
loss_pred:0.01968463696539402, decouple_loss:0.003884038655087352
loss_pred:0.022201383486390114, decouple_loss:0.0038534977938979864
The generated pressure mean: 0.43632134795188904
loss_pred:0.022436650469899178, decouple_loss:0.0038622431457042694
Iteration: 5284, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4418486952781677
The generated pressure mean: 0.4447577893733978
loss_pred:0.020846398547291756, decouple_loss:0.0043057044968008995
loss_pred:0.019618438556790352, decouple_loss:0.003962314687669277
The generated pressure mean: 0.447802871465683
loss_pred:0.02148616500198841, decouple_loss:0.004268965683877468
Iteration: 5285, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45647409558296204
loss_pred:0.020342322066426277, decouple_loss:0.00404256209731102
The generated pressure mean: 0.45778411626815796
loss_pred:0.02286274917423725, decouple_loss:0.004197192844003439
The generated pressure mean: 0.45306098461151123
loss_pred:0.020467914640903473, decouple_loss:0.00403788173571229
Iteration: 5286, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4398467540740967
The generated pressure mean: 0.4350295960903168
loss_pred:0.021230846643447876, decouple_loss:0.004406128078699112
loss_pred:0.02211970090866089, decouple_loss:0.0042206719517707825
The generated pressure mean: 0.43632400035858154
loss_pred:0.01993020810186863, decouple_loss:0.0042546698823571205
Iteration: 5287, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44963058829307556
The generated pressure mean: 0.45797497034072876
loss_pred:0.019648652523756027, decouple_loss:0.004110024310648441
loss_pred:0.020101113244891167, decouple_loss:0.004105555824935436
The generated pressure mean: 0.453488826751709
loss_pred:0.020487749949097633, decouple_loss:0.004068744368851185
Iteration: 5288, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45193690061569214
The generated pressure mean: 0.4573477804660797loss_pred:0.021678490564227104, decouple_loss:0.003964103292673826
loss_pred:0.018992522731423378, decouple_loss:0.0035554971545934677
The generated pressure mean: 0.4527496099472046
loss_pred:0.022655649110674858, decouple_loss:0.004068917129188776
Iteration: 5289, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4353305697441101
loss_pred:0.020301761105656624, decouple_loss:0.004501747898757458
The generated pressure mean: 0.43399283289909363
loss_pred:0.019459819421172142, decouple_loss:0.004659140948206186
The generated pressure mean: 0.4367125332355499
loss_pred:0.022104060277342796, decouple_loss:0.004488580394536257
Iteration: 5290, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462302625179291
loss_pred:0.019828224554657936, decouple_loss:0.0038812016136944294
The generated pressure mean: 0.4480080008506775
loss_pred:0.020714348182082176, decouple_loss:0.003978544380515814
The generated pressure mean: 0.4467696249485016
loss_pred:0.021113639697432518, decouple_loss:0.004062106367200613
2023-04-17 07:46:58 testing...
The generated pressure mean: 0.41368740797042847
The generated pressure mean: 0.4211198687553406
The generated pressure mean: 0.4241354167461395
loss_pred:0.03444801643490791, decouple_loss:0.003574896603822708
loss_pred:0.03291908651590347, decouple_loss:0.0038875213358551264
loss_pred:0.03279254212975502, decouple_loss:0.004108885768800974
WV_0_PC_0_EH_1_PS_40, loss: 0.03357940539717674, avg_mse: 0.04934464395046234
current test mse: 0.049345
Iteration: 5291, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479408860206604
loss_pred:0.020775901153683662, decouple_loss:0.0029019140638411045
The generated pressure mean: 0.4434696137905121
loss_pred:0.02103380113840103, decouple_loss:0.003174323821440339
The generated pressure mean: 0.4512210488319397
loss_pred:0.02019943669438362, decouple_loss:0.003000474302098155
Iteration: 5292, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4406551420688629
loss_pred:0.022052308544516563, decouple_loss:0.003617056179791689
The generated pressure mean: 0.44810572266578674
loss_pred:0.021013760939240456, decouple_loss:0.0034444406628608704
The generated pressure mean: 0.4417326748371124
loss_pred:0.021902460604906082, decouple_loss:0.003413864178583026
Iteration: 5293, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.444219172000885
The generated pressure mean: 0.45158782601356506
loss_pred:0.0204180758446455, decouple_loss:0.0031489222310483456
loss_pred:0.018703320994973183, decouple_loss:0.0030719756614416838
The generated pressure mean: 0.45334556698799133
loss_pred:0.019029399380087852, decouple_loss:0.0030619914177805185
Iteration: 5294, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45328786969184875
The generated pressure mean: 0.4500015676021576
loss_pred:0.019819719716906548, decouple_loss:0.0032240638975054026
loss_pred:0.02141924761235714, decouple_loss:0.003505141707137227
The generated pressure mean: 0.45184874534606934
loss_pred:0.019800588488578796, decouple_loss:0.0032779937610030174
Iteration: 5295, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43513166904449463
The generated pressure mean: 0.4353601336479187
loss_pred:0.01902259700000286, decouple_loss:0.0032992749474942684
loss_pred:0.020066717639565468, decouple_loss:0.003379588946700096
The generated pressure mean: 0.4448072910308838
loss_pred:0.020190857350826263, decouple_loss:0.003455535974353552
Iteration: 5296, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44495370984077454
The generated pressure mean: 0.44974637031555176
loss_pred:0.019035425037145615, decouple_loss:0.003842446953058243
loss_pred:0.0189556535333395, decouple_loss:0.003829701105132699
The generated pressure mean: 0.44328340888023376
loss_pred:0.019533779472112656, decouple_loss:0.0038201292045414448
Iteration: 5297, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4439895451068878
The generated pressure mean: 0.44951707124710083
loss_pred:0.020495260134339333, decouple_loss:0.004048277623951435
loss_pred:0.022034937515854836, decouple_loss:0.0038881106302142143
The generated pressure mean: 0.45468670129776
loss_pred:0.020846087485551834, decouple_loss:0.003963116556406021
Iteration: 5298, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43146347999572754
loss_pred:0.02086693048477173, decouple_loss:0.0034648964647203684The generated pressure mean: 0.4291576147079468
loss_pred:0.019742179661989212, decouple_loss:0.0035579258110374212
The generated pressure mean: 0.42691269516944885
loss_pred:0.020240258425474167, decouple_loss:0.0037609634455293417
Iteration: 5299, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45566773414611816
loss_pred:0.020816834643483162, decouple_loss:0.003779209218919277
The generated pressure mean: 0.45243310928344727
loss_pred:0.020037967711687088, decouple_loss:0.0036261919885873795
The generated pressure mean: 0.4525476098060608
loss_pred:0.02117466740310192, decouple_loss:0.003717291634529829
Iteration: 5300, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46725019812583923
loss_pred:0.02260839007794857, decouple_loss:0.0036692440044134855
The generated pressure mean: 0.4656662344932556
loss_pred:0.021906327456235886, decouple_loss:0.003659929847344756
The generated pressure mean: 0.4642399847507477
loss_pred:0.020775627344846725, decouple_loss:0.0038831678684800863
2023-04-17 07:48:51 testing...
The generated pressure mean: 0.41910478472709656
The generated pressure mean: 0.4261013865470886
The generated pressure mean: 0.4290648102760315
loss_pred:0.033780571073293686, decouple_loss:0.004471396561712027
loss_pred:0.032427821308374405, decouple_loss:0.004808549303561449
loss_pred:0.03246036916971207, decouple_loss:0.004626336507499218
WV_0_PC_0_EH_1_PS_40, loss: 0.03312135860323906, avg_mse: 0.04850071668624878
current test mse: 0.048501
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 5301, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42647549510002136
loss_pred:0.02206600457429886, decouple_loss:0.003934452310204506
The generated pressure mean: 0.4293493926525116
The generated pressure mean: 0.4296177327632904loss_pred:0.020143207162618637, decouple_loss:0.0038399456534534693
loss_pred:0.019588423892855644, decouple_loss:0.003901309333741665
Iteration: 5302, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44502103328704834
The generated pressure mean: 0.44168955087661743
loss_pred:0.020648373290896416, decouple_loss:0.00366013846360147
loss_pred:0.020948514342308044, decouple_loss:0.0035669903736561537
The generated pressure mean: 0.44270047545433044
loss_pred:0.020052285864949226, decouple_loss:0.0034849022049456835
Iteration: 5303, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45455971360206604
The generated pressure mean: 0.455665647983551
loss_pred:0.019269971176981926, decouple_loss:0.0032870781142264605
loss_pred:0.020302506163716316, decouple_loss:0.0033611073158681393
The generated pressure mean: 0.45441508293151855
loss_pred:0.019758256152272224, decouple_loss:0.003223378909751773
Iteration: 5304, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45261090993881226
The generated pressure mean: 0.45253679156303406
loss_pred:0.02066028118133545, decouple_loss:0.004183448385447264
loss_pred:0.019415341317653656, decouple_loss:0.0044114491902291775
The generated pressure mean: 0.4508458375930786
loss_pred:0.022421803325414658, decouple_loss:0.00432036817073822
Iteration: 5305, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4399528205394745
The generated pressure mean: 0.444396436214447
loss_pred:0.02033795788884163, decouple_loss:0.0038243441376835108
loss_pred:0.019902734085917473, decouple_loss:0.0035517090000212193
The generated pressure mean: 0.4379820227622986
loss_pred:0.021598581224679947, decouple_loss:0.0036520063877105713
Iteration: 5306, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4438563883304596
The generated pressure mean: 0.44057920575141907
loss_pred:0.020122701302170753, decouple_loss:0.003960059490054846
loss_pred:0.019316835328936577, decouple_loss:0.003954946529120207
The generated pressure mean: 0.4458571970462799
loss_pred:0.02070268802344799, decouple_loss:0.004019902553409338
Iteration: 5307, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4570698142051697
The generated pressure mean: 0.45547914505004883
loss_pred:0.020214833319187164, decouple_loss:0.003909074701368809
loss_pred:0.018591010943055153, decouple_loss:0.003728592535480857
The generated pressure mean: 0.4521061182022095
loss_pred:0.020184172317385674, decouple_loss:0.0038049931172281504
Iteration: 5308, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4514712691307068
loss_pred:0.020198605954647064, decouple_loss:0.003912766929715872
The generated pressure mean: 0.45386940240859985
loss_pred:0.02069709822535515, decouple_loss:0.0040113478899002075
The generated pressure mean: 0.4458307921886444
loss_pred:0.01985296420753002, decouple_loss:0.003932000137865543
Iteration: 5309, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43969181180000305
The generated pressure mean: 0.4407638609409332
loss_pred:0.02012348361313343, decouple_loss:0.0038058513309806585
loss_pred:0.01999722607433796, decouple_loss:0.003952527418732643
The generated pressure mean: 0.4476374387741089
loss_pred:0.01964702270925045, decouple_loss:0.004023137502372265
Iteration: 5310, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4446953237056732
The generated pressure mean: 0.4436267912387848loss_pred:0.02021763101220131, decouple_loss:0.003283808007836342
loss_pred:0.020223457366228104, decouple_loss:0.003447579452767968
The generated pressure mean: 0.44437551498413086
loss_pred:0.01931258849799633, decouple_loss:0.003343472257256508
2023-04-17 07:51:20 testing...
The generated pressure mean: 0.41582491993904114
The generated pressure mean: 0.4238782227039337
loss_pred:0.03440298140048981, decouple_loss:0.005507723893970251
The generated pressure mean: 0.4264683723449707
loss_pred:0.03345876187086105, decouple_loss:0.0055791353806853294
loss_pred:0.03309942036867142, decouple_loss:0.005884654354304075
WV_0_PC_0_EH_1_PS_40, loss: 0.03393658250570297, avg_mse: 0.04984397441148758
current test mse: 0.049844
Iteration: 5311, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487527906894684
loss_pred:0.020252646878361702, decouple_loss:0.004973906558007002
The generated pressure mean: 0.4462890923023224
loss_pred:0.020243963226675987, decouple_loss:0.004802046809345484
The generated pressure mean: 0.4449688196182251
loss_pred:0.020928407087922096, decouple_loss:0.0047309426590800285
Iteration: 5312, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45254960656166077
loss_pred:0.0199823509901762, decouple_loss:0.0033512627705931664
The generated pressure mean: 0.45136332511901855
loss_pred:0.019756637513637543, decouple_loss:0.0035213602241128683
The generated pressure mean: 0.4468546509742737
loss_pred:0.0191426370292902, decouple_loss:0.003350309794768691
Iteration: 5313, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45508259534835815
loss_pred:0.019574476405978203, decouple_loss:0.004927607253193855
The generated pressure mean: 0.4535191059112549
loss_pred:0.021995441988110542, decouple_loss:0.004851166158914566
The generated pressure mean: 0.44998112320899963
loss_pred:0.020200930535793304, decouple_loss:0.0048019494861364365
Iteration: 5314, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4337047040462494
loss_pred:0.01915861666202545, decouple_loss:0.0037384098395705223
The generated pressure mean: 0.4379543960094452
loss_pred:0.01974370889365673, decouple_loss:0.003737999824807048
The generated pressure mean: 0.4385858476161957
loss_pred:0.02093113213777542, decouple_loss:0.0036894865334033966
Iteration: 5315, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4455525279045105
loss_pred:0.020679831504821777, decouple_loss:0.004635157994925976
The generated pressure mean: 0.4469800889492035
loss_pred:0.02030598558485508, decouple_loss:0.0046704900451004505
The generated pressure mean: 0.448230504989624
loss_pred:0.019527310505509377, decouple_loss:0.0048520853742957115
Iteration: 5316, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4524005651473999
loss_pred:0.02041335217654705, decouple_loss:0.003989506047219038
The generated pressure mean: 0.4546128511428833
loss_pred:0.01973920315504074, decouple_loss:0.003950665704905987
The generated pressure mean: 0.4506708085536957
loss_pred:0.019764075055718422, decouple_loss:0.004003547597676516
Iteration: 5317, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44495880603790283
loss_pred:0.020321013405919075, decouple_loss:0.004022566135972738
The generated pressure mean: 0.44592633843421936
loss_pred:0.019667748361825943, decouple_loss:0.00405647698789835
The generated pressure mean: 0.44478610157966614
loss_pred:0.019341567531228065, decouple_loss:0.00403788173571229
Iteration: 5318, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4552162289619446
loss_pred:0.018980419263243675, decouple_loss:0.00518288416787982
The generated pressure mean: 0.4537707269191742
loss_pred:0.020530859008431435, decouple_loss:0.0051617673598229885
The generated pressure mean: 0.4486437141895294
loss_pred:0.020065419375896454, decouple_loss:0.005247372202575207
Iteration: 5319, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473532438278198
loss_pred:0.020727666094899178, decouple_loss:0.00439408840611577
The generated pressure mean: 0.4432678520679474
loss_pred:0.01906200498342514, decouple_loss:0.004519472364336252
The generated pressure mean: 0.45335084199905396
loss_pred:0.019983014091849327, decouple_loss:0.004512430168688297
Iteration: 5320, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.440096378326416
loss_pred:0.019505558535456657, decouple_loss:0.0036490701604634523
The generated pressure mean: 0.44244271516799927
loss_pred:0.02072008326649666, decouple_loss:0.0038219536654651165
The generated pressure mean: 0.4415178596973419
loss_pred:0.021935921162366867, decouple_loss:0.003908829297870398
2023-04-17 07:53:15 testing...
The generated pressure mean: 0.4141567647457123
The generated pressure mean: 0.42186301946640015
loss_pred:0.03441285714507103, decouple_loss:0.005957182962447405
The generated pressure mean: 0.4238930642604828
loss_pred:0.03294330835342407, decouple_loss:0.00624891696497798
loss_pred:0.03301335871219635, decouple_loss:0.006436331197619438
WV_0_PC_0_EH_1_PS_40, loss: 0.0337672159075737, avg_mse: 0.04935535788536072
current test mse: 0.049355
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 5321, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4519987106323242
loss_pred:0.020607421174645424, decouple_loss:0.004945588298141956
The generated pressure mean: 0.44978296756744385
loss_pred:0.0187239907681942, decouple_loss:0.005175501573830843
The generated pressure mean: 0.449613094329834
loss_pred:0.02011360414326191, decouple_loss:0.0050036790780723095
Iteration: 5322, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44886550307273865
loss_pred:0.02138468064367771, decouple_loss:0.004626349546015263
The generated pressure mean: 0.4521602690219879
loss_pred:0.02112724632024765, decouple_loss:0.0045489659532904625
The generated pressure mean: 0.447073757648468
loss_pred:0.02257997915148735, decouple_loss:0.00455807987600565
Iteration: 5323, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43569931387901306
loss_pred:0.020870938897132874, decouple_loss:0.004398459102958441
The generated pressure mean: 0.43383169174194336
loss_pred:0.019760362803936005, decouple_loss:0.004416185896843672
The generated pressure mean: 0.4417901635169983
loss_pred:0.021338513121008873, decouple_loss:0.004598761908710003
Iteration: 5324, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489714801311493
loss_pred:0.021847698837518692, decouple_loss:0.004168963525444269
The generated pressure mean: 0.4536600112915039
loss_pred:0.019011832773685455, decouple_loss:0.0041724154725670815
The generated pressure mean: 0.4575878381729126
loss_pred:0.022313369438052177, decouple_loss:0.004412299487739801
Iteration: 5325, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44564250111579895
loss_pred:0.01911313459277153, decouple_loss:0.005549149587750435
The generated pressure mean: 0.4400540292263031
loss_pred:0.021757256239652634, decouple_loss:0.005324282217770815
The generated pressure mean: 0.44170230627059937
loss_pred:0.02048521861433983, decouple_loss:0.005257159471511841
Iteration: 5326, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4515407681465149
loss_pred:0.019258245825767517, decouple_loss:0.004512509796768427
The generated pressure mean: 0.44498467445373535
loss_pred:0.019904445856809616, decouple_loss:0.00451888469979167
The generated pressure mean: 0.4465467631816864
loss_pred:0.020106669515371323, decouple_loss:0.004522584844380617
Iteration: 5327, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483407437801361
loss_pred:0.022008929401636124, decouple_loss:0.004818602465093136
The generated pressure mean: 0.4471096098423004
loss_pred:0.020451340824365616, decouple_loss:0.004698383621871471
The generated pressure mean: 0.44504034519195557
loss_pred:0.01824107952415943, decouple_loss:0.005045690108090639
Iteration: 5328, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460395574569702
loss_pred:0.020584076642990112, decouple_loss:0.004672834649682045
The generated pressure mean: 0.44727301597595215
loss_pred:0.019130446016788483, decouple_loss:0.004711969755589962
The generated pressure mean: 0.4436226189136505
loss_pred:0.02013513445854187, decouple_loss:0.004636425990611315
Iteration: 5329, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44510582089424133
loss_pred:0.020534316077828407, decouple_loss:0.004185445606708527
The generated pressure mean: 0.44449904561042786
loss_pred:0.020579548552632332, decouple_loss:0.004225744865834713
The generated pressure mean: 0.4507462978363037
loss_pred:0.019450843334197998, decouple_loss:0.004182086326181889
Iteration: 5330, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45553144812583923
loss_pred:0.019552692770957947, decouple_loss:0.004798947833478451
The generated pressure mean: 0.4496271312236786
loss_pred:0.019433006644248962, decouple_loss:0.004673338960856199
The generated pressure mean: 0.4527454376220703
loss_pred:0.01940790005028248, decouple_loss:0.004721902310848236
2023-04-17 07:55:43 testing...
The generated pressure mean: 0.4155234098434448
The generated pressure mean: 0.42412686347961426
The generated pressure mean: 0.42621538043022156
loss_pred:0.03255116194486618, decouple_loss:0.004858220927417278
loss_pred:0.031935278326272964, decouple_loss:0.0051680756732821465
loss_pred:0.03125711902976036, decouple_loss:0.005377978086471558
WV_0_PC_0_EH_1_PS_40, loss: 0.032171256840229034, avg_mse: 0.046648845076560974
current test mse: 0.046649
Iteration: 5331, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44876182079315186
loss_pred:0.020560797303915024, decouple_loss:0.004226701334118843
The generated pressure mean: 0.4439204931259155
loss_pred:0.020311487838625908, decouple_loss:0.004253298509865999
The generated pressure mean: 0.44686421751976013
loss_pred:0.02057667449116707, decouple_loss:0.004150870721787214
Iteration: 5332, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43521949648857117
loss_pred:0.01903652399778366, decouple_loss:0.004473833367228508
The generated pressure mean: 0.43794456124305725
loss_pred:0.01902097836136818, decouple_loss:0.004544838331639767
The generated pressure mean: 0.4424215853214264
loss_pred:0.019564976915717125, decouple_loss:0.0044357855804264545
Iteration: 5333, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4552658200263977
loss_pred:0.019163979217410088, decouple_loss:0.004194107372313738
The generated pressure mean: 0.4475904405117035
loss_pred:0.020125530660152435, decouple_loss:0.0041181715205311775
The generated pressure mean: 0.4534802734851837
loss_pred:0.019609631970524788, decouple_loss:0.004050890449434519
Iteration: 5334, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476575255393982
loss_pred:0.020975643768906593, decouple_loss:0.0038560430984944105
The generated pressure mean: 0.4482589066028595
loss_pred:0.02184077352285385, decouple_loss:0.003931720741093159
The generated pressure mean: 0.44987747073173523
loss_pred:0.01950797624886036, decouple_loss:0.003853438189253211
Iteration: 5335, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4404612183570862
loss_pred:0.018482761457562447, decouple_loss:0.0037280649412423372
The generated pressure mean: 0.44624975323677063
loss_pred:0.019492916762828827, decouple_loss:0.0037453791592270136
The generated pressure mean: 0.4413103461265564
loss_pred:0.018802782520651817, decouple_loss:0.0037805114407092333
Iteration: 5336, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473954439163208
loss_pred:0.019103625789284706, decouple_loss:0.003997765481472015
The generated pressure mean: 0.4503236711025238
loss_pred:0.019641855731606483, decouple_loss:0.003866089740768075
The generated pressure mean: 0.4432913661003113
loss_pred:0.02169005759060383, decouple_loss:0.004199585411697626
Iteration: 5337, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447323739528656
loss_pred:0.019397467374801636, decouple_loss:0.0036312732845544815
The generated pressure mean: 0.4475495219230652
loss_pred:0.019663628190755844, decouple_loss:0.0032226741313934326
The generated pressure mean: 0.4507552981376648
loss_pred:0.019738681614398956, decouple_loss:0.0033278255723416805
Iteration: 5338, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487738311290741
loss_pred:0.020534072071313858, decouple_loss:0.0038613537326455116
The generated pressure mean: 0.44436541199684143
The generated pressure mean: 0.44526055455207825
loss_pred:0.020985517650842667, decouple_loss:0.0037222544196993113
loss_pred:0.02221098728477955, decouple_loss:0.0038007674738764763
Iteration: 5339, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43919819593429565
loss_pred:0.020405011251568794, decouple_loss:0.0038473301101475954
The generated pressure mean: 0.4445742666721344
The generated pressure mean: 0.4397742748260498
loss_pred:0.020919129252433777, decouple_loss:0.003832551185041666
loss_pred:0.01958654634654522, decouple_loss:0.003665580879896879
Iteration: 5340, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492132365703583
loss_pred:0.01956358551979065, decouple_loss:0.004611755255609751
The generated pressure mean: 0.45620793104171753
loss_pred:0.018928661942481995, decouple_loss:0.004498667549341917
The generated pressure mean: 0.46095335483551025
loss_pred:0.01910756155848503, decouple_loss:0.004402180202305317
2023-04-17 07:57:37 testing...
The generated pressure mean: 0.412861704826355
The generated pressure mean: 0.4200586974620819
loss_pred:0.03471817448735237, decouple_loss:0.0044211638160049915
The generated pressure mean: 0.42259103059768677
loss_pred:0.03405943512916565, decouple_loss:0.0045928508043289185
loss_pred:0.0335935540497303, decouple_loss:0.004701363388448954
WV_0_PC_0_EH_1_PS_40, loss: 0.03435231372714043, avg_mse: 0.05096006020903587
current test mse: 0.05096
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 5341, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4528450071811676
loss_pred:0.02219114452600479, decouple_loss:0.003706629853695631
The generated pressure mean: 0.4573589861392975
loss_pred:0.020984604954719543, decouple_loss:0.0037158115301281214
The generated pressure mean: 0.45375970005989075
loss_pred:0.021427525207400322, decouple_loss:0.0036436831578612328
Iteration: 5342, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4314817488193512
loss_pred:0.02106081321835518, decouple_loss:0.003727163653820753
The generated pressure mean: 0.4320802390575409
loss_pred:0.021206805482506752, decouple_loss:0.003752338234335184
The generated pressure mean: 0.4318031966686249
loss_pred:0.02126886323094368, decouple_loss:0.0037532574497163296
Iteration: 5343, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462803900241852
loss_pred:0.020140117034316063, decouple_loss:0.003953498788177967
The generated pressure mean: 0.44748619198799133
loss_pred:0.021663226187229156, decouple_loss:0.003846139879897237
The generated pressure mean: 0.44529396295547485
loss_pred:0.020895499736070633, decouple_loss:0.004054725170135498
Iteration: 5344, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4560081362724304
loss_pred:0.02111658826470375, decouple_loss:0.0036370817106217146
The generated pressure mean: 0.4596927762031555
loss_pred:0.022095296531915665, decouple_loss:0.0038219415582716465
The generated pressure mean: 0.4620805084705353
loss_pred:0.02045002393424511, decouple_loss:0.0037550560664385557
Iteration: 5345, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45283204317092896
loss_pred:0.021316343918442726, decouple_loss:0.003853160422295332
The generated pressure mean: 0.45054638385772705
loss_pred:0.019213957712054253, decouple_loss:0.003568045562133193
The generated pressure mean: 0.4527716040611267
loss_pred:0.02062223292887211, decouple_loss:0.0037477565929293633
Iteration: 5346, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4416298568248749
loss_pred:0.021227668970823288, decouple_loss:0.003463477361947298
The generated pressure mean: 0.44107410311698914
loss_pred:0.021934688091278076, decouple_loss:0.00346450530923903
The generated pressure mean: 0.43842971324920654
loss_pred:0.020352797582745552, decouple_loss:0.003433000994846225
Iteration: 5347, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4412350654602051
loss_pred:0.02050039730966091, decouple_loss:0.0030717975459992886
The generated pressure mean: 0.4398629367351532
loss_pred:0.02071722410619259, decouple_loss:0.0032225260511040688
The generated pressure mean: 0.4414370357990265
loss_pred:0.021459350362420082, decouple_loss:0.003250237088650465
Iteration: 5348, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45774781703948975
The generated pressure mean: 0.45472702383995056
loss_pred:0.021317854523658752, decouple_loss:0.0038388920947909355
loss_pred:0.021482456475496292, decouple_loss:0.0037313480861485004
The generated pressure mean: 0.45542430877685547
loss_pred:0.021447695791721344, decouple_loss:0.003922662697732449
Iteration: 5349, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4457477331161499
The generated pressure mean: 0.44447585940361023
loss_pred:0.02029336616396904, decouple_loss:0.005200391169637442
loss_pred:0.020751584321260452, decouple_loss:0.005371140316128731
The generated pressure mean: 0.4448421895503998
loss_pred:0.021193992346525192, decouple_loss:0.0053748320788145065
Iteration: 5350, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45138058066368103
The generated pressure mean: 0.44780656695365906loss_pred:0.01889958046376705, decouple_loss:0.0035689608193933964
loss_pred:0.019757399335503578, decouple_loss:0.0035916182678192854
The generated pressure mean: 0.44810721278190613
loss_pred:0.019471509382128716, decouple_loss:0.0035249823704361916
2023-04-17 08:00:04 testing...
The generated pressure mean: 0.4148348867893219
The generated pressure mean: 0.4219321608543396
The generated pressure mean: 0.42412543296813965
loss_pred:0.03322833776473999, decouple_loss:0.004103029612451792
loss_pred:0.03215046972036362, decouple_loss:0.004373705014586449
loss_pred:0.031960055232048035, decouple_loss:0.0045834011398255825
WV_0_PC_0_EH_1_PS_40, loss: 0.03266395628452301, avg_mse: 0.04750976338982582
current test mse: 0.04751
Iteration: 5351, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494585692882538
loss_pred:0.02082165703177452, decouple_loss:0.003594860900193453
The generated pressure mean: 0.4471452832221985
loss_pred:0.02098294161260128, decouple_loss:0.0035768181551247835
The generated pressure mean: 0.44926366209983826
loss_pred:0.022191543132066727, decouple_loss:0.003522760234773159
Iteration: 5352, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4395825266838074
loss_pred:0.019726727157831192, decouple_loss:0.004330234602093697
The generated pressure mean: 0.4408550262451172
loss_pred:0.019424572587013245, decouple_loss:0.004264444578438997
The generated pressure mean: 0.4471498429775238
loss_pred:0.020452456548810005, decouple_loss:0.004508754704147577
Iteration: 5353, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44871893525123596
loss_pred:0.022488348186016083, decouple_loss:0.004536693915724754
The generated pressure mean: 0.4511112868785858
loss_pred:0.021326366811990738, decouple_loss:0.0044821943156421185
The generated pressure mean: 0.45201990008354187
loss_pred:0.0214847419410944, decouple_loss:0.004615504294633865
Iteration: 5354, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44925665855407715
loss_pred:0.020041102543473244, decouple_loss:0.003142714500427246
The generated pressure mean: 0.4497654139995575
loss_pred:0.01964709162712097, decouple_loss:0.0031925116200000048
The generated pressure mean: 0.44627994298934937
loss_pred:0.021177904680371284, decouple_loss:0.0032202666625380516
Iteration: 5355, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4444528818130493
loss_pred:0.02262859418988228, decouple_loss:0.003286713734269142
The generated pressure mean: 0.4467940032482147
loss_pred:0.02167341113090515, decouple_loss:0.003148389281705022
The generated pressure mean: 0.4425518810749054
loss_pred:0.020994532853364944, decouple_loss:0.0033378193620592356
Iteration: 5356, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4413452446460724
loss_pred:0.020697256550192833, decouple_loss:0.0033902341965585947
The generated pressure mean: 0.4399714469909668
loss_pred:0.019960926845669746, decouple_loss:0.0034025595523416996
The generated pressure mean: 0.44763627648353577
loss_pred:0.0212892834097147, decouple_loss:0.0034835580736398697
Iteration: 5357, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4431108236312866
The generated pressure mean: 0.448432594537735loss_pred:0.020574240013957024, decouple_loss:0.0038476421032100916
loss_pred:0.02231713756918907, decouple_loss:0.003905778517946601
The generated pressure mean: 0.4473636746406555
loss_pred:0.02120821736752987, decouple_loss:0.004074523225426674
Iteration: 5358, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4633959233760834
The generated pressure mean: 0.4656665623188019
loss_pred:0.02006407082080841, decouple_loss:0.004556707106530666
loss_pred:0.020505394786596298, decouple_loss:0.004697456490248442
The generated pressure mean: 0.46637895703315735
loss_pred:0.021698148921132088, decouple_loss:0.004590726923197508
Iteration: 5359, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44238707423210144
loss_pred:0.01994810812175274, decouple_loss:0.0037049243692308664
The generated pressure mean: 0.445068895816803
loss_pred:0.021884901449084282, decouple_loss:0.003728447947651148
The generated pressure mean: 0.44285666942596436
loss_pred:0.020725665614008904, decouple_loss:0.003776346333324909
Iteration: 5360, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43960094451904297
loss_pred:0.019982503727078438, decouple_loss:0.0029735714197158813
The generated pressure mean: 0.43857237696647644
loss_pred:0.020416224375367165, decouple_loss:0.0030821224208921194
The generated pressure mean: 0.440193235874176
loss_pred:0.020530806854367256, decouple_loss:0.003128418233245611
2023-04-17 08:01:59 testing...
The generated pressure mean: 0.4143354594707489
The generated pressure mean: 0.42155420780181885
loss_pred:0.0329134538769722, decouple_loss:0.00523931672796607
The generated pressure mean: 0.4238277077674866
loss_pred:0.031873736530542374, decouple_loss:0.005408087745308876
loss_pred:0.03150982782244682, decouple_loss:0.0055441949516534805
WV_0_PC_0_EH_1_PS_40, loss: 0.032368868589401245, avg_mse: 0.04674948751926422
current test mse: 0.046749
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 5361, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4540475010871887
loss_pred:0.02186465822160244, decouple_loss:0.0046245078556239605
The generated pressure mean: 0.44808724522590637
loss_pred:0.020242488011717796, decouple_loss:0.004489365499466658
The generated pressure mean: 0.454071968793869
loss_pred:0.021090945228934288, decouple_loss:0.004645832348614931
Iteration: 5362, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.445340096950531
loss_pred:0.019929014146327972, decouple_loss:0.003780023194849491
The generated pressure mean: 0.4448607563972473
loss_pred:0.019819116219878197, decouple_loss:0.0037748159375041723
The generated pressure mean: 0.44569429755210876
loss_pred:0.022063834592700005, decouple_loss:0.003843590384349227
Iteration: 5363, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.455343097448349
The generated pressure mean: 0.4545322358608246loss_pred:0.020162656903266907, decouple_loss:0.003902266500517726
loss_pred:0.02041817642748356, decouple_loss:0.0039665233343839645
The generated pressure mean: 0.4544360339641571
loss_pred:0.021068768575787544, decouple_loss:0.004026292823255062
Iteration: 5364, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488011598587036
loss_pred:0.02083572745323181, decouple_loss:0.00373488268814981
The generated pressure mean: 0.4480150043964386
loss_pred:0.021831609308719635, decouple_loss:0.0036414419300854206
The generated pressure mean: 0.4427599012851715
loss_pred:0.023745598271489143, decouple_loss:0.0036202850751578808
Iteration: 5365, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4314350485801697
The generated pressure mean: 0.43274638056755066
loss_pred:0.021188272163271904, decouple_loss:0.004299659747630358
loss_pred:0.02075286954641342, decouple_loss:0.004261506721377373
The generated pressure mean: 0.43474024534225464
loss_pred:0.01993746869266033, decouple_loss:0.0042541553266346455
Iteration: 5366, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4590856730937958
loss_pred:0.02177954465150833, decouple_loss:0.003907404839992523
The generated pressure mean: 0.45675307512283325
loss_pred:0.02221214771270752, decouple_loss:0.00398575933650136
The generated pressure mean: 0.4614681303501129
loss_pred:0.019411558285355568, decouple_loss:0.00394653994590044
Iteration: 5367, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4512893259525299
loss_pred:0.01942405477166176, decouple_loss:0.004758960101753473
The generated pressure mean: 0.45351821184158325
loss_pred:0.020680401474237442, decouple_loss:0.004736488219350576
The generated pressure mean: 0.44821950793266296
loss_pred:0.01934747025370598, decouple_loss:0.004933995194733143
Iteration: 5368, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4379209578037262
The generated pressure mean: 0.4464118778705597
loss_pred:0.020549707114696503, decouple_loss:0.0040333508513867855
loss_pred:0.020201876759529114, decouple_loss:0.004029700066894293
The generated pressure mean: 0.443297803401947
loss_pred:0.022505123168230057, decouple_loss:0.004111583344638348
Iteration: 5369, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4512523412704468
The generated pressure mean: 0.4492124915122986
loss_pred:0.021262582391500473, decouple_loss:0.004247212316840887
loss_pred:0.0191999189555645, decouple_loss:0.004210665822029114
The generated pressure mean: 0.450984388589859
loss_pred:0.020256850868463516, decouple_loss:0.003989398945122957
Iteration: 5370, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44859400391578674
loss_pred:0.018871530890464783, decouple_loss:0.004612639546394348
The generated pressure mean: 0.44997259974479675
loss_pred:0.01971314288675785, decouple_loss:0.004691337700933218
The generated pressure mean: 0.4536898732185364
loss_pred:0.022303413599729538, decouple_loss:0.004848374519497156
2023-04-17 08:04:32 testing...
The generated pressure mean: 0.4142647981643677
The generated pressure mean: 0.4228438436985016
loss_pred:0.03494026139378548, decouple_loss:0.0047048102132976055
The generated pressure mean: 0.42465218901634216
loss_pred:0.0335017666220665, decouple_loss:0.004916188307106495
loss_pred:0.03350069746375084, decouple_loss:0.005129714962095022
WV_0_PC_0_EH_1_PS_40, loss: 0.03422675281763077, avg_mse: 0.05070502683520317
current test mse: 0.050705
Iteration: 5371, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44594335556030273
loss_pred:0.01977020502090454, decouple_loss:0.004136764444410801
The generated pressure mean: 0.4421118199825287
loss_pred:0.021537385880947113, decouple_loss:0.004287208896130323
The generated pressure mean: 0.445136696100235
loss_pred:0.018948275595903397, decouple_loss:0.004090777598321438
Iteration: 5372, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44254717230796814
loss_pred:0.020571762695908546, decouple_loss:0.0036371531896293163
The generated pressure mean: 0.44487980008125305
loss_pred:0.02210209332406521, decouple_loss:0.0037153775338083506
The generated pressure mean: 0.44829344749450684
loss_pred:0.020405525341629982, decouple_loss:0.0036449471954256296
Iteration: 5373, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45016422867774963The generated pressure mean: 0.45082128047943115
loss_pred:0.020895471796393394, decouple_loss:0.004726747516542673loss_pred:0.02042354829609394, decouple_loss:0.004776699002832174
The generated pressure mean: 0.44751277565956116
loss_pred:0.020044878125190735, decouple_loss:0.0046878475695848465
Iteration: 5374, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.458114355802536
The generated pressure mean: 0.4562581777572632
loss_pred:0.020730044692754745, decouple_loss:0.0037946337834000587
loss_pred:0.022095784544944763, decouple_loss:0.0037871135864406824
The generated pressure mean: 0.4586418569087982
loss_pred:0.01948491670191288, decouple_loss:0.0038158553652465343
Iteration: 5375, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4456374943256378
The generated pressure mean: 0.44756826758384705
loss_pred:0.020686613395810127, decouple_loss:0.003840468591079116
loss_pred:0.019612370058894157, decouple_loss:0.003820338286459446
The generated pressure mean: 0.4457155466079712
loss_pred:0.02092624455690384, decouple_loss:0.0038654054515063763
Iteration: 5376, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4421404004096985
The generated pressure mean: 0.44729363918304443
loss_pred:0.019822562113404274, decouple_loss:0.0037732089404016733
loss_pred:0.022316716611385345, decouple_loss:0.003920745104551315
The generated pressure mean: 0.4453697204589844
loss_pred:0.022096579894423485, decouple_loss:0.003920337650924921
Iteration: 5377, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44107210636138916
loss_pred:0.020399130880832672, decouple_loss:0.0036684831138700247
The generated pressure mean: 0.4360528290271759
loss_pred:0.020112082362174988, decouple_loss:0.0037298137322068214
The generated pressure mean: 0.43919795751571655
loss_pred:0.021224144846200943, decouple_loss:0.0035820158664137125
Iteration: 5378, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45061150193214417
loss_pred:0.020137103274464607, decouple_loss:0.0037419700529426336
The generated pressure mean: 0.44963234663009644
loss_pred:0.021284911781549454, decouple_loss:0.0036438414826989174
The generated pressure mean: 0.4522535800933838
loss_pred:0.021372804418206215, decouple_loss:0.0036543516907840967
Iteration: 5379, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4543030261993408The generated pressure mean: 0.45259860157966614
loss_pred:0.020566321909427643, decouple_loss:0.003615723457187414
loss_pred:0.02103171870112419, decouple_loss:0.0036726428661495447
The generated pressure mean: 0.45659542083740234
loss_pred:0.020825320854783058, decouple_loss:0.003545920830219984
Iteration: 5380, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4522543251514435
loss_pred:0.020921656861901283, decouple_loss:0.0041475240141153336
The generated pressure mean: 0.450346976518631
loss_pred:0.022940602153539658, decouple_loss:0.004173077177256346
The generated pressure mean: 0.4480465054512024
loss_pred:0.01963024213910103, decouple_loss:0.004166954662650824
2023-04-17 08:06:26 testing...
The generated pressure mean: 0.4149887263774872
The generated pressure mean: 0.42279279232025146
The generated pressure mean: 0.4253065884113312
loss_pred:0.033433813601732254, decouple_loss:0.004865983035415411
loss_pred:0.03241974860429764, decouple_loss:0.005168174859136343
loss_pred:0.03218640387058258, decouple_loss:0.005340763833373785
WV_0_PC_0_EH_1_PS_40, loss: 0.03293623775243759, avg_mse: 0.0481736995279789
current test mse: 0.048174
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 5381, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447579562664032
loss_pred:0.01942780241370201, decouple_loss:0.004198010079562664
The generated pressure mean: 0.4491930603981018
loss_pred:0.02102222666144371, decouple_loss:0.0041132234036922455
The generated pressure mean: 0.4466794729232788
loss_pred:0.019720958545804024, decouple_loss:0.004305584356188774
Iteration: 5382, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44026610255241394
loss_pred:0.020920543000102043, decouple_loss:0.0035398006439208984
The generated pressure mean: 0.4412012994289398
loss_pred:0.021339310333132744, decouple_loss:0.0033829028252512217
The generated pressure mean: 0.4392149746417999
loss_pred:0.02059425599873066, decouple_loss:0.003534031566232443
Iteration: 5383, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.442636638879776
loss_pred:0.020368250086903572, decouple_loss:0.00423236982896924
The generated pressure mean: 0.44166597723960876
loss_pred:0.023243259638547897, decouple_loss:0.004200797528028488
The generated pressure mean: 0.44814732670783997
loss_pred:0.02069847472012043, decouple_loss:0.004162197466939688
Iteration: 5384, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482836127281189
loss_pred:0.01935453712940216, decouple_loss:0.004336903337389231
The generated pressure mean: 0.4481692612171173
loss_pred:0.018754279240965843, decouple_loss:0.004345632623881102
The generated pressure mean: 0.44756099581718445
loss_pred:0.02273235097527504, decouple_loss:0.004446250852197409
Iteration: 5385, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508560001850128
loss_pred:0.020987821742892265, decouple_loss:0.0034418159630149603
The generated pressure mean: 0.4463866055011749
loss_pred:0.021189207211136818, decouple_loss:0.003484212327748537
The generated pressure mean: 0.4503476023674011
loss_pred:0.019955739378929138, decouple_loss:0.0034453810658305883
Iteration: 5386, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442434310913086
loss_pred:0.021066682413220406, decouple_loss:0.0041291601955890656
The generated pressure mean: 0.45014870166778564
loss_pred:0.02055843360722065, decouple_loss:0.004013048019260168
The generated pressure mean: 0.45005834102630615
loss_pred:0.019142404198646545, decouple_loss:0.004187856800854206
Iteration: 5387, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44191697239875793
loss_pred:0.020561764016747475, decouple_loss:0.0037114403676241636
The generated pressure mean: 0.4450579583644867
loss_pred:0.01870773360133171, decouple_loss:0.0038300510495901108
The generated pressure mean: 0.443799763917923
loss_pred:0.01945326291024685, decouple_loss:0.003829949302598834
Iteration: 5388, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44467437267303467
The generated pressure mean: 0.44489115476608276
loss_pred:0.02068166993558407, decouple_loss:0.003102394286543131
loss_pred:0.01850602775812149, decouple_loss:0.0031559783965349197
The generated pressure mean: 0.4428899586200714
loss_pred:0.02011205442249775, decouple_loss:0.0032788137905299664
Iteration: 5389, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500695466995239
loss_pred:0.02095220796763897, decouple_loss:0.003136955900117755
The generated pressure mean: 0.4536059498786926
loss_pred:0.020458219572901726, decouple_loss:0.0032221749424934387
The generated pressure mean: 0.45445501804351807
loss_pred:0.020700249820947647, decouple_loss:0.00324042490683496
Iteration: 5390, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44316565990448
loss_pred:0.01971924677491188, decouple_loss:0.003146048402413726
The generated pressure mean: 0.4412223994731903
loss_pred:0.019937831908464432, decouple_loss:0.0031504326034337282
The generated pressure mean: 0.44645392894744873
loss_pred:0.020655745640397072, decouple_loss:0.0030598733574151993
2023-04-17 08:09:00 testing...
The generated pressure mean: 0.41631391644477844
The generated pressure mean: 0.4229513704776764
The generated pressure mean: 0.42583167552948
loss_pred:0.03234196826815605, decouple_loss:0.003939692862331867
loss_pred:0.031548138707876205, decouple_loss:0.0041324361227452755
loss_pred:0.031125281006097794, decouple_loss:0.004343798849731684
WV_0_PC_0_EH_1_PS_40, loss: 0.03187873214483261, avg_mse: 0.04608992114663124
current test mse: 0.04609
Iteration: 5391, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4388561546802521
loss_pred:0.01991616003215313, decouple_loss:0.003161071101203561
The generated pressure mean: 0.4417232275009155
loss_pred:0.021163813769817352, decouple_loss:0.003047853009775281
The generated pressure mean: 0.4386918842792511
loss_pred:0.0214928537607193, decouple_loss:0.003275790950283408
Iteration: 5392, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502682685852051
loss_pred:0.02035219967365265, decouple_loss:0.0034458087757229805
The generated pressure mean: 0.45245400071144104
loss_pred:0.020252414047718048, decouple_loss:0.003325781784951687
The generated pressure mean: 0.4464830160140991
loss_pred:0.019137930124998093, decouple_loss:0.003504666732624173
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5393, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4589065611362457
loss_pred:0.020137792453169823, decouple_loss:0.0034093856811523438
The generated pressure mean: 0.4571569859981537
loss_pred:0.02033792808651924, decouple_loss:0.0033824273850768805
The generated pressure mean: 0.45728081464767456
loss_pred:0.019151803106069565, decouple_loss:0.0034962352365255356
Iteration: 5394, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43849825859069824
loss_pred:0.018419232219457626, decouple_loss:0.003050012281164527
The generated pressure mean: 0.43908336758613586
loss_pred:0.02055133879184723, decouple_loss:0.0030997071880847216
The generated pressure mean: 0.44013774394989014
loss_pred:0.020230678841471672, decouple_loss:0.0030747263226658106
Iteration: 5395, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44580280780792236
The generated pressure mean: 0.44057539105415344
loss_pred:0.021587617695331573, decouple_loss:0.003239403245970607
loss_pred:0.020165421068668365, decouple_loss:0.0030927497427910566
The generated pressure mean: 0.44199123978614807
loss_pred:0.019109241664409637, decouple_loss:0.0032698216382414103
Iteration: 5396, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446091890335083
loss_pred:0.02065066434442997, decouple_loss:0.004602296277880669
The generated pressure mean: 0.44839537143707275
loss_pred:0.019047599285840988, decouple_loss:0.004722094163298607
The generated pressure mean: 0.4479442536830902
loss_pred:0.020457834005355835, decouple_loss:0.004505187273025513
Iteration: 5397, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44592151045799255
loss_pred:0.020229844376444817, decouple_loss:0.004037939943373203
The generated pressure mean: 0.44996142387390137
loss_pred:0.020651645958423615, decouple_loss:0.004096014425158501
The generated pressure mean: 0.45026111602783203
loss_pred:0.02277587354183197, decouple_loss:0.004011255688965321
Iteration: 5398, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4444330632686615
loss_pred:0.0191099364310503, decouple_loss:0.0034858747385442257
The generated pressure mean: 0.44776663184165955
loss_pred:0.019423089921474457, decouple_loss:0.003450958523899317
The generated pressure mean: 0.4437716007232666
loss_pred:0.020254630595445633, decouple_loss:0.0033642391208559275
Iteration: 5399, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45057690143585205
loss_pred:0.021602291613817215, decouple_loss:0.004660184495151043
The generated pressure mean: 0.44773462414741516
loss_pred:0.019775332883000374, decouple_loss:0.004656926728785038
The generated pressure mean: 0.44912999868392944
loss_pred:0.020760774612426758, decouple_loss:0.0047150603495538235
Iteration: 5400, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4408590793609619
loss_pred:0.019429026171565056, decouple_loss:0.003927362151443958
The generated pressure mean: 0.44520440697669983
loss_pred:0.020786114037036896, decouple_loss:0.004051127005368471
The generated pressure mean: 0.44405052065849304
loss_pred:0.01998874731361866, decouple_loss:0.0038798449095338583
2023-04-17 08:10:54 testing...
The generated pressure mean: 0.41451263427734375
The generated pressure mean: 0.421663373708725
loss_pred:0.03191472217440605, decouple_loss:0.0050934720784425735
The generated pressure mean: 0.4243778586387634
loss_pred:0.030851995572447777, decouple_loss:0.00535610131919384
loss_pred:0.03045371174812317, decouple_loss:0.00538977375254035
WV_0_PC_0_EH_1_PS_40, loss: 0.03133746609091759, avg_mse: 0.04502888768911362
current test mse: 0.045029
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 5401, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497290551662445
loss_pred:0.021680762991309166, decouple_loss:0.004473372828215361
The generated pressure mean: 0.44595155119895935
loss_pred:0.02012212947010994, decouple_loss:0.004543393850326538
The generated pressure mean: 0.4466829001903534
loss_pred:0.01999252289533615, decouple_loss:0.004372407216578722
Iteration: 5402, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45441827178001404
loss_pred:0.02042829990386963, decouple_loss:0.004906830377876759
The generated pressure mean: 0.451992928981781
loss_pred:0.020419439300894737, decouple_loss:0.004881363827735186
The generated pressure mean: 0.45408499240875244
loss_pred:0.019202442839741707, decouple_loss:0.004638300277292728
Iteration: 5403, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44838637113571167
The generated pressure mean: 0.44756314158439636
loss_pred:0.019619684666395187, decouple_loss:0.0036715813912451267
loss_pred:0.020941823720932007, decouple_loss:0.0037983963266015053
The generated pressure mean: 0.44353216886520386
loss_pred:0.019334876909852028, decouple_loss:0.003651771927252412
Iteration: 5404, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44464245438575745
The generated pressure mean: 0.44179394841194153
loss_pred:0.01992461271584034, decouple_loss:0.0036642886698246002
loss_pred:0.020400425419211388, decouple_loss:0.0037558444309979677
The generated pressure mean: 0.4420917332172394
loss_pred:0.019088640809059143, decouple_loss:0.0036147397477179766
Iteration: 5405, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45124948024749756
loss_pred:0.020858069881796837, decouple_loss:0.00436509819701314
The generated pressure mean: 0.44693148136138916
loss_pred:0.019311778247356415, decouple_loss:0.0044847154058516026
The generated pressure mean: 0.4483296573162079
loss_pred:0.02235272340476513, decouple_loss:0.0044641983695328236
Iteration: 5406, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4400392770767212
The generated pressure mean: 0.44480589032173157loss_pred:0.020075663924217224, decouple_loss:0.0032129534520208836
loss_pred:0.018323082476854324, decouple_loss:0.00322235026396811
The generated pressure mean: 0.44291770458221436
loss_pred:0.01851312257349491, decouple_loss:0.003184561850503087
Iteration: 5407, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45182788372039795
loss_pred:0.020785614848136902, decouple_loss:0.0035670551005750895
The generated pressure mean: 0.44811081886291504
loss_pred:0.019416959956288338, decouple_loss:0.0035890431609004736
The generated pressure mean: 0.4492667019367218
loss_pred:0.01938728429377079, decouple_loss:0.003406456671655178
Iteration: 5408, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505520462989807
The generated pressure mean: 0.4573311507701874
loss_pred:0.020089590921998024, decouple_loss:0.00439717061817646
loss_pred:0.0209495909512043, decouple_loss:0.004408437758684158
The generated pressure mean: 0.4536488950252533
loss_pred:0.02157459780573845, decouple_loss:0.0044876448810100555
Iteration: 5409, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43357813358306885
The generated pressure mean: 0.437761127948761
loss_pred:0.020181382074952126, decouple_loss:0.004014142323285341
loss_pred:0.01893763616681099, decouple_loss:0.004062429536134005
The generated pressure mean: 0.43322500586509705
loss_pred:0.020761732012033463, decouple_loss:0.003958053421229124
Iteration: 5410, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4450426995754242
loss_pred:0.019727887585759163, decouple_loss:0.003889769548550248
The generated pressure mean: 0.4476662278175354
loss_pred:0.02011791244149208, decouple_loss:0.004089562688022852
The generated pressure mean: 0.4457291066646576
loss_pred:0.019433941692113876, decouple_loss:0.003980153240263462
2023-04-17 08:13:30 testing...
The generated pressure mean: 0.41312772035598755
The generated pressure mean: 0.42073291540145874
The generated pressure mean: 0.42376288771629333
loss_pred:0.03288309648633003, decouple_loss:0.004402732476592064
loss_pred:0.03186052292585373, decouple_loss:0.004715141840279102
loss_pred:0.03160949796438217, decouple_loss:0.004947124049067497
WV_0_PC_0_EH_1_PS_40, loss: 0.03235212340950966, avg_mse: 0.04724094644188881
current test mse: 0.047241
Iteration: 5411, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45838719606399536
The generated pressure mean: 0.45397821068763733
loss_pred:0.021631138399243355, decouple_loss:0.003893560031428933
loss_pred:0.019604312255978584, decouple_loss:0.003669295459985733
The generated pressure mean: 0.45823073387145996
loss_pred:0.022563597187399864, decouple_loss:0.003862569807097316
Iteration: 5412, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4342923164367676
loss_pred:0.019740736111998558, decouple_loss:0.003892194479703903
The generated pressure mean: 0.4364299774169922
loss_pred:0.019622568041086197, decouple_loss:0.0036756626795977354
The generated pressure mean: 0.4374989867210388
loss_pred:0.018671182915568352, decouple_loss:0.003592030145227909
Iteration: 5413, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4527290463447571
loss_pred:0.02003355883061886, decouple_loss:0.00349799613468349
The generated pressure mean: 0.4526844620704651
loss_pred:0.023806016892194748, decouple_loss:0.0038170928601175547
The generated pressure mean: 0.44818371534347534
loss_pred:0.01959204114973545, decouple_loss:0.0034284864086657763
Iteration: 5414, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485936462879181
The generated pressure mean: 0.4458974599838257
loss_pred:0.019078275188803673, decouple_loss:0.004649101756513119
loss_pred:0.021101217716932297, decouple_loss:0.00472169229760766
The generated pressure mean: 0.443587988615036
loss_pred:0.0196452084928751, decouple_loss:0.0049037323333323
Iteration: 5415, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469691514968872
The generated pressure mean: 0.44869598746299744
loss_pred:0.01969347707927227, decouple_loss:0.005749166943132877
loss_pred:0.02029820904135704, decouple_loss:0.0057359435595571995
The generated pressure mean: 0.44508495926856995
loss_pred:0.020362719893455505, decouple_loss:0.005802628118544817
Iteration: 5416, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45162802934646606
The generated pressure mean: 0.44886890053749084loss_pred:0.018803199753165245, decouple_loss:0.00330028566531837
loss_pred:0.02119522914290428, decouple_loss:0.0033805633429437876
The generated pressure mean: 0.45153459906578064
loss_pred:0.021682819351553917, decouple_loss:0.003203439526259899
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5417, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43837854266166687
loss_pred:0.020278865471482277, decouple_loss:0.006765848491340876The generated pressure mean: 0.43321266770362854
loss_pred:0.019874224439263344, decouple_loss:0.006745585706084967
The generated pressure mean: 0.43641024827957153
loss_pred:0.02015068754553795, decouple_loss:0.0068525709211826324
Iteration: 5418, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4528433680534363
loss_pred:0.020793916657567024, decouple_loss:0.003929232247173786The generated pressure mean: 0.4524501860141754
loss_pred:0.021407708525657654, decouple_loss:0.004061609972268343
The generated pressure mean: 0.45093509554862976
loss_pred:0.01928393542766571, decouple_loss:0.0038204870652407408
Iteration: 5419, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45630139112472534
loss_pred:0.018866727128624916, decouple_loss:0.004954210016876459
The generated pressure mean: 0.456846684217453
loss_pred:0.020226044580340385, decouple_loss:0.004933678079396486
The generated pressure mean: 0.4552150368690491
loss_pred:0.019810417667031288, decouple_loss:0.004976669326424599
Iteration: 5420, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43689045310020447
loss_pred:0.01901835948228836, decouple_loss:0.005009017419070005
The generated pressure mean: 0.4372054934501648
loss_pred:0.02065633051097393, decouple_loss:0.004879148676991463
The generated pressure mean: 0.43127262592315674
loss_pred:0.022896496579051018, decouple_loss:0.005031328182667494
2023-04-17 08:15:23 testing...
The generated pressure mean: 0.41554147005081177
The generated pressure mean: 0.423434853553772
The generated pressure mean: 0.4259442687034607
loss_pred:0.03217471390962601, decouple_loss:0.004468380473554134
loss_pred:0.03133393079042435, decouple_loss:0.004646832589060068
loss_pred:0.03093031421303749, decouple_loss:0.004773447755724192
WV_0_PC_0_EH_1_PS_40, loss: 0.03171113133430481, avg_mse: 0.046010181307792664
current test mse: 0.04601
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 5421, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44147443771362305
loss_pred:0.021486645564436913, decouple_loss:0.003832097165286541
The generated pressure mean: 0.44406118988990784
The generated pressure mean: 0.440835565328598
loss_pred:0.020190410315990448, decouple_loss:0.003958878107368946
loss_pred:0.02101805806159973, decouple_loss:0.0038624911103397608
Iteration: 5422, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4532850682735443
The generated pressure mean: 0.4599817395210266
loss_pred:0.021677974611520767, decouple_loss:0.0036338376812636852
loss_pred:0.0213166456669569, decouple_loss:0.0034157533664256334
The generated pressure mean: 0.4568384885787964
loss_pred:0.018987685441970825, decouple_loss:0.003858092473819852
Iteration: 5423, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4435749351978302
The generated pressure mean: 0.43911153078079224
loss_pred:0.018814459443092346, decouple_loss:0.004242315888404846
loss_pred:0.01770668849349022, decouple_loss:0.004365847446024418
The generated pressure mean: 0.4420224130153656
loss_pred:0.01995799131691456, decouple_loss:0.004173876717686653
Iteration: 5424, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498257339000702
The generated pressure mean: 0.4533211290836334
loss_pred:0.019423142075538635, decouple_loss:0.0037796725519001484
loss_pred:0.019331084564328194, decouple_loss:0.0038747095968574286
The generated pressure mean: 0.4518934488296509
loss_pred:0.0204324871301651, decouple_loss:0.0037892633117735386
Iteration: 5425, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4560677707195282
The generated pressure mean: 0.4517275393009186
loss_pred:0.020570019260048866, decouple_loss:0.0035776321310549974
loss_pred:0.019144440069794655, decouple_loss:0.0035194302909076214
The generated pressure mean: 0.4545881152153015
loss_pred:0.018830854445695877, decouple_loss:0.0036239619366824627
Iteration: 5426, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4316447675228119
loss_pred:0.02027970738708973, decouple_loss:0.004392632748931646
The generated pressure mean: 0.43449169397354126
loss_pred:0.02035982720553875, decouple_loss:0.004561194684356451
The generated pressure mean: 0.4319126009941101
loss_pred:0.02034023031592369, decouple_loss:0.004491726402193308
Iteration: 5427, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44667690992355347
The generated pressure mean: 0.4407329559326172
loss_pred:0.01855320669710636, decouple_loss:0.003981501795351505
loss_pred:0.019134491682052612, decouple_loss:0.0038199780974537134
The generated pressure mean: 0.4484883248806
loss_pred:0.01996033266186714, decouple_loss:0.004037598147988319
Iteration: 5428, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46547093987464905
loss_pred:0.019515546038746834, decouple_loss:0.0033701742067933083
The generated pressure mean: 0.4578849673271179
loss_pred:0.01994524523615837, decouple_loss:0.0034227182622998953
The generated pressure mean: 0.4651671051979065
loss_pred:0.020845279097557068, decouple_loss:0.0036142561584711075
Iteration: 5429, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44841140508651733
The generated pressure mean: 0.4486229419708252
loss_pred:0.01952296681702137, decouple_loss:0.004297835752367973
loss_pred:0.01920153573155403, decouple_loss:0.004102247767150402
The generated pressure mean: 0.44565916061401367
loss_pred:0.019449423998594284, decouple_loss:0.00416202237829566
Iteration: 5430, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44183114171028137
The generated pressure mean: 0.43914875388145447
loss_pred:0.02087511494755745, decouple_loss:0.0034928051754832268
loss_pred:0.02130972221493721, decouple_loss:0.0033982424065470695
The generated pressure mean: 0.44129523634910583
loss_pred:0.01940089650452137, decouple_loss:0.003276954172179103
2023-04-17 08:17:59 testing...
The generated pressure mean: 0.4161319136619568
The generated pressure mean: 0.423795610666275
loss_pred:0.03298715502023697, decouple_loss:0.004312098026275635
The generated pressure mean: 0.42612239718437195
loss_pred:0.03193244710564613, decouple_loss:0.0046036578714847565
loss_pred:0.031790073961019516, decouple_loss:0.0047002206556499004
WV_0_PC_0_EH_1_PS_40, loss: 0.03246349096298218, avg_mse: 0.047103554010391235
current test mse: 0.047104
Iteration: 5431, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4364842176437378
loss_pred:0.01984064094722271, decouple_loss:0.003889132523909211
The generated pressure mean: 0.4354603588581085
loss_pred:0.020023275166749954, decouple_loss:0.003576082643121481
The generated pressure mean: 0.4334883987903595
loss_pred:0.019733836874365807, decouple_loss:0.0037897853180766106
Iteration: 5432, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45397451519966125
loss_pred:0.019904371351003647, decouple_loss:0.0036799428053200245
The generated pressure mean: 0.4525321424007416
loss_pred:0.020501235499978065, decouple_loss:0.0036007508169859648
The generated pressure mean: 0.45307037234306335
loss_pred:0.020687878131866455, decouple_loss:0.0036618246231228113
Iteration: 5433, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45574402809143066
loss_pred:0.018732784315943718, decouple_loss:0.0036776154302060604
The generated pressure mean: 0.46134817600250244
loss_pred:0.01964684948325157, decouple_loss:0.003562518395483494
The generated pressure mean: 0.4586656987667084
loss_pred:0.018953735008835793, decouple_loss:0.0035690099466592073
Iteration: 5434, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486476480960846
loss_pred:0.01882188953459263, decouple_loss:0.0037767498288303614
The generated pressure mean: 0.4558476209640503
loss_pred:0.019607368856668472, decouple_loss:0.0034923090133816004
The generated pressure mean: 0.4490378201007843
loss_pred:0.0178990438580513, decouple_loss:0.0035754945129156113
Iteration: 5435, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4345967173576355
loss_pred:0.019224369898438454, decouple_loss:0.0034870817326009274
The generated pressure mean: 0.43524104356765747
loss_pred:0.01907951943576336, decouple_loss:0.003558902535587549
The generated pressure mean: 0.43719351291656494
loss_pred:0.019758576527237892, decouple_loss:0.0033882008865475655
Iteration: 5436, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44710439443588257
loss_pred:0.019813967868685722, decouple_loss:0.003904419019818306
The generated pressure mean: 0.4514842927455902
loss_pred:0.022893182933330536, decouple_loss:0.0038274582475423813
The generated pressure mean: 0.44423460960388184
loss_pred:0.018003012984991074, decouple_loss:0.0039000187534838915
Iteration: 5437, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44578006863594055
The generated pressure mean: 0.4494633078575134
loss_pred:0.020439621061086655, decouple_loss:0.003446208545938134
loss_pred:0.02136136032640934, decouple_loss:0.0036847623996436596
The generated pressure mean: 0.445390909910202
loss_pred:0.02049790881574154, decouple_loss:0.0035547346342355013
Iteration: 5438, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496006667613983
loss_pred:0.019624901935458183, decouple_loss:0.003662973875179887
The generated pressure mean: 0.45458996295928955
loss_pred:0.019215986132621765, decouple_loss:0.003610736457630992
The generated pressure mean: 0.45184963941574097
loss_pred:0.019413532689213753, decouple_loss:0.0037048596423119307
Iteration: 5439, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45135006308555603
loss_pred:0.021150190383195877, decouple_loss:0.004348576068878174
The generated pressure mean: 0.4533221423625946
loss_pred:0.019906651228666306, decouple_loss:0.004399836994707584
The generated pressure mean: 0.4529854953289032
loss_pred:0.020891882479190826, decouple_loss:0.004354874603450298
Iteration: 5440, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44442254304885864
loss_pred:0.0184819083660841, decouple_loss:0.003877925220876932
The generated pressure mean: 0.44565752148628235
loss_pred:0.019710974767804146, decouple_loss:0.003917789552360773
The generated pressure mean: 0.44667041301727295
loss_pred:0.01892166957259178, decouple_loss:0.0040317620150744915
2023-04-17 08:19:53 testing...
The generated pressure mean: 0.4160190522670746
The generated pressure mean: 0.42356574535369873
loss_pred:0.03293465077877045, decouple_loss:0.0041165780276060104
The generated pressure mean: 0.4262794852256775
loss_pred:0.03199604153633118, decouple_loss:0.00438183918595314
loss_pred:0.03167123720049858, decouple_loss:0.004577915649861097
WV_0_PC_0_EH_1_PS_40, loss: 0.03241858631372452, avg_mse: 0.04713384062051773
current test mse: 0.047134
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 5441, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4355640709400177
loss_pred:0.020221197977662086, decouple_loss:0.00361109571531415
The generated pressure mean: 0.44256240129470825
loss_pred:0.018437985330820084, decouple_loss:0.0035701319575309753
The generated pressure mean: 0.440155565738678
loss_pred:0.021939655765891075, decouple_loss:0.0036101010628044605
Iteration: 5442, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44250839948654175
The generated pressure mean: 0.4432256519794464
loss_pred:0.019811056554317474, decouple_loss:0.004008984658867121
loss_pred:0.020033901557326317, decouple_loss:0.004038255196064711
The generated pressure mean: 0.44338876008987427
loss_pred:0.019678492099046707, decouple_loss:0.0038067176938056946
Iteration: 5443, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44643470644950867
The generated pressure mean: 0.4450782537460327
loss_pred:0.02049248293042183, decouple_loss:0.0036419087555259466
loss_pred:0.021158475428819656, decouple_loss:0.003733636811375618
The generated pressure mean: 0.4482616186141968
loss_pred:0.02007126621901989, decouple_loss:0.0036600884050130844
Iteration: 5444, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4572538733482361
The generated pressure mean: 0.45757248997688293
loss_pred:0.019380424171686172, decouple_loss:0.0036536483094096184
loss_pred:0.01964658498764038, decouple_loss:0.0038785571232438087
The generated pressure mean: 0.45394307374954224
loss_pred:0.018869664520025253, decouple_loss:0.0036372379399836063
Iteration: 5445, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4447561800479889
The generated pressure mean: 0.4477520287036896
loss_pred:0.018721656873822212, decouple_loss:0.004562957212328911
loss_pred:0.020018141716718674, decouple_loss:0.004508272744715214
The generated pressure mean: 0.4456530809402466
loss_pred:0.019536687061190605, decouple_loss:0.004820347763597965
Iteration: 5446, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452601969242096
The generated pressure mean: 0.445874959230423
loss_pred:0.020308561623096466, decouple_loss:0.003939805552363396
loss_pred:0.018783142790198326, decouple_loss:0.0037987101823091507
The generated pressure mean: 0.44274094700813293
loss_pred:0.02032637968659401, decouple_loss:0.004008056595921516
Iteration: 5447, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4430907070636749
The generated pressure mean: 0.44898173213005066
loss_pred:0.01858455315232277, decouple_loss:0.004461399279534817
loss_pred:0.02019120566546917, decouple_loss:0.004484215285629034
The generated pressure mean: 0.4483310580253601
loss_pred:0.0200088769197464, decouple_loss:0.004331798292696476
Iteration: 5448, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464367926120758
The generated pressure mean: 0.44574204087257385
loss_pred:0.020164795219898224, decouple_loss:0.004677681718021631
loss_pred:0.01897083781659603, decouple_loss:0.0047036525793373585
The generated pressure mean: 0.4435141682624817
loss_pred:0.02003527618944645, decouple_loss:0.004595937207341194
Iteration: 5449, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44506189227104187
The generated pressure mean: 0.4445141851902008
loss_pred:0.019897708669304848, decouple_loss:0.003976432140916586
loss_pred:0.020778313279151917, decouple_loss:0.004092303104698658
The generated pressure mean: 0.45266562700271606
loss_pred:0.021956276148557663, decouple_loss:0.003956791013479233
Iteration: 5450, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4362024962902069
The generated pressure mean: 0.4375258684158325
loss_pred:0.01944255456328392, decouple_loss:0.003925733733922243
loss_pred:0.019123347476124763, decouple_loss:0.003996719140559435
The generated pressure mean: 0.43846508860588074
loss_pred:0.019398309290409088, decouple_loss:0.0038941672537475824
2023-04-17 08:22:23 testing...
The generated pressure mean: 0.4122975766658783
The generated pressure mean: 0.4206990599632263
The generated pressure mean: 0.4236374497413635
loss_pred:0.03397931158542633, decouple_loss:0.004325601737946272
loss_pred:0.03300796076655388, decouple_loss:0.004494185093790293
loss_pred:0.032349586486816406, decouple_loss:0.004687323234975338
WV_0_PC_0_EH_1_PS_40, loss: 0.03333740681409836, avg_mse: 0.049429211765527725
current test mse: 0.049429
Iteration: 5451, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45177003741264343
loss_pred:0.02010997198522091, decouple_loss:0.0037380829453468323
The generated pressure mean: 0.4521391689777374
loss_pred:0.019424553960561752, decouple_loss:0.0036799393128603697
The generated pressure mean: 0.4516482949256897
loss_pred:0.021535901352763176, decouple_loss:0.003783180145546794
Iteration: 5452, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468533396720886
loss_pred:0.01997150108218193, decouple_loss:0.003550466615706682
The generated pressure mean: 0.44655948877334595
loss_pred:0.02163228578865528, decouple_loss:0.0035242163576185703
The generated pressure mean: 0.44768044352531433
loss_pred:0.019067073240876198, decouple_loss:0.003484830493107438
Iteration: 5453, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4437602460384369
loss_pred:0.019473498687148094, decouple_loss:0.0037097660824656487
The generated pressure mean: 0.4457452595233917
loss_pred:0.02133040502667427, decouple_loss:0.004000779706984758
The generated pressure mean: 0.4442284107208252
loss_pred:0.021591681987047195, decouple_loss:0.0036896117962896824
Iteration: 5454, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45192503929138184
The generated pressure mean: 0.4559554159641266
loss_pred:0.019389837980270386, decouple_loss:0.003847071435302496
loss_pred:0.02083282545208931, decouple_loss:0.003741032676771283
The generated pressure mean: 0.4556029736995697
loss_pred:0.019354328513145447, decouple_loss:0.0038175357040017843
Iteration: 5455, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44402220845222473
The generated pressure mean: 0.4427174925804138
loss_pred:0.01933911256492138, decouple_loss:0.0037181146908551455
loss_pred:0.019826315343379974, decouple_loss:0.0035598594695329666
The generated pressure mean: 0.4440340995788574
loss_pred:0.02116403542459011, decouple_loss:0.0036482473369687796
Iteration: 5456, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44262048602104187
loss_pred:0.019205650314688683, decouple_loss:0.003908783663064241
The generated pressure mean: 0.44369006156921387
loss_pred:0.019567271694540977, decouple_loss:0.0039007384330034256
The generated pressure mean: 0.44581443071365356
loss_pred:0.02109454572200775, decouple_loss:0.0038453389424830675
Iteration: 5457, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44432002305984497
loss_pred:0.020589783787727356, decouple_loss:0.004338826518505812
The generated pressure mean: 0.44570136070251465
loss_pred:0.020969048142433167, decouple_loss:0.004357874393463135
The generated pressure mean: 0.44416543841362
loss_pred:0.021071286872029305, decouple_loss:0.004354080650955439
Iteration: 5458, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45291823148727417
loss_pred:0.021124228835105896, decouple_loss:0.003869249252602458
The generated pressure mean: 0.4552052319049835
loss_pred:0.019785771146416664, decouple_loss:0.00398755818605423
The generated pressure mean: 0.452936589717865
loss_pred:0.019793681800365448, decouple_loss:0.0038662878796458244
Iteration: 5459, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4444153904914856
loss_pred:0.020130835473537445, decouple_loss:0.003528246423229575
The generated pressure mean: 0.4428964853286743
loss_pred:0.01858971081674099, decouple_loss:0.003546101739630103
The generated pressure mean: 0.4426003098487854
loss_pred:0.01901409588754177, decouple_loss:0.0034829010255634785
Iteration: 5460, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4396507740020752
loss_pred:0.020644698292016983, decouple_loss:0.00362885813228786
The generated pressure mean: 0.44590434432029724
loss_pred:0.020111890509724617, decouple_loss:0.0036357177887111902
The generated pressure mean: 0.44312378764152527
loss_pred:0.020451659336686134, decouple_loss:0.0036618723534047604
2023-04-17 08:24:16 testing...
The generated pressure mean: 0.4142577052116394
The generated pressure mean: 0.4230393171310425
loss_pred:0.033255599439144135, decouple_loss:0.004187426064163446
The generated pressure mean: 0.4258783161640167
loss_pred:0.032056257128715515, decouple_loss:0.004244450945407152
loss_pred:0.03179241716861725, decouple_loss:0.0045887380838394165
WV_0_PC_0_EH_1_PS_40, loss: 0.03258510306477547, avg_mse: 0.04790612310171127
current test mse: 0.047906
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 5461, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464245140552521
loss_pred:0.020272066816687584, decouple_loss:0.003586108796298504
The generated pressure mean: 0.4535728693008423
loss_pred:0.01962130144238472, decouple_loss:0.0034644529223442078
The generated pressure mean: 0.44688257575035095
loss_pred:0.02091904915869236, decouple_loss:0.003536590840667486
Iteration: 5462, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4413639008998871
The generated pressure mean: 0.4460048973560333
loss_pred:0.021611882373690605, decouple_loss:0.0036479919217526913
loss_pred:0.020000537857413292, decouple_loss:0.003916069865226746
The generated pressure mean: 0.43969473242759705
loss_pred:0.02095818519592285, decouple_loss:0.003867261577397585
Iteration: 5463, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4515577554702759
The generated pressure mean: 0.44726991653442383
loss_pred:0.021139955148100853, decouple_loss:0.004198288545012474
loss_pred:0.019453080371022224, decouple_loss:0.004220881033688784
The generated pressure mean: 0.4483051002025604
loss_pred:0.01883556880056858, decouple_loss:0.004156776703894138
Iteration: 5464, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489128589630127
The generated pressure mean: 0.4451170563697815
loss_pred:0.019284632056951523, decouple_loss:0.003691993420943618
loss_pred:0.020651761442422867, decouple_loss:0.003964767791330814
The generated pressure mean: 0.447027325630188
loss_pred:0.021094221621751785, decouple_loss:0.003790295450016856
Iteration: 5465, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476490020751953
The generated pressure mean: 0.4458666741847992
loss_pred:0.021145522594451904, decouple_loss:0.00325018260627985
loss_pred:0.019358672201633453, decouple_loss:0.0033487449400126934
The generated pressure mean: 0.44548299908638
loss_pred:0.020571302622556686, decouple_loss:0.003485059132799506
Iteration: 5466, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44343581795692444
The generated pressure mean: 0.4465997815132141
loss_pred:0.018991803750395775, decouple_loss:0.0032758458983153105
loss_pred:0.020420381799340248, decouple_loss:0.00315652834251523
The generated pressure mean: 0.4448148310184479
loss_pred:0.019634457305073738, decouple_loss:0.0032724211923778057
Iteration: 5467, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488465487957001
The generated pressure mean: 0.4467582404613495
loss_pred:0.021212300285696983, decouple_loss:0.0039039405528455973
loss_pred:0.020313691347837448, decouple_loss:0.003965525887906551
The generated pressure mean: 0.45510590076446533
loss_pred:0.020177925005555153, decouple_loss:0.0037497240118682384
Iteration: 5468, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44784894585609436
The generated pressure mean: 0.44611915946006775
loss_pred:0.01980169117450714, decouple_loss:0.003625348675996065
loss_pred:0.01941961608827114, decouple_loss:0.0035766619257628918
The generated pressure mean: 0.44725337624549866
loss_pred:0.019432736560702324, decouple_loss:0.003640446113422513
Iteration: 5469, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43679311871528625
loss_pred:0.01942509412765503, decouple_loss:0.003573371795937419
The generated pressure mean: 0.4395131766796112
loss_pred:0.019160090014338493, decouple_loss:0.0035938676446676254
The generated pressure mean: 0.43409404158592224
loss_pred:0.019615307450294495, decouple_loss:0.0037218788638710976
Iteration: 5470, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465484023094177
loss_pred:0.02026209607720375, decouple_loss:0.0037847841158509254
The generated pressure mean: 0.45058152079582214
loss_pred:0.018938841298222542, decouple_loss:0.003816052107140422
The generated pressure mean: 0.4495023190975189
loss_pred:0.019920604303479195, decouple_loss:0.0038978431839495897
2023-04-17 08:26:52 testing...
The generated pressure mean: 0.40994322299957275
The generated pressure mean: 0.4179443120956421
loss_pred:0.03525272011756897, decouple_loss:0.0039990851655602455
The generated pressure mean: 0.4201357662677765
loss_pred:0.03406839445233345, decouple_loss:0.0043158759362995625
loss_pred:0.03395245596766472, decouple_loss:0.004513306077569723
WV_0_PC_0_EH_1_PS_40, loss: 0.03463833034038544, avg_mse: 0.051576875150203705
current test mse: 0.051577
Iteration: 5471, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46439626812934875
loss_pred:0.01958394981920719, decouple_loss:0.0035806307569146156
The generated pressure mean: 0.4595712423324585
loss_pred:0.020101463422179222, decouple_loss:0.003577000694349408
The generated pressure mean: 0.45598092675209045
loss_pred:0.019641857594251633, decouple_loss:0.003632022300735116
Iteration: 5472, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4413966238498688
loss_pred:0.020220093429088593, decouple_loss:0.003349622478708625
The generated pressure mean: 0.4437711834907532
loss_pred:0.02035043016076088, decouple_loss:0.0032975298818200827
The generated pressure mean: 0.4424550235271454
loss_pred:0.019151758402585983, decouple_loss:0.003386153606697917
Iteration: 5473, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.433076947927475
loss_pred:0.02076662704348564, decouple_loss:0.0032030686270445585
The generated pressure mean: 0.4327465295791626
loss_pred:0.01897571235895157, decouple_loss:0.0029857028275728226
The generated pressure mean: 0.4350484311580658
loss_pred:0.02036307379603386, decouple_loss:0.003110789228230715
Iteration: 5474, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45091530680656433
loss_pred:0.020242856815457344, decouple_loss:0.003303589764982462
The generated pressure mean: 0.45235782861709595
loss_pred:0.02109888382256031, decouple_loss:0.0032704730983823538
The generated pressure mean: 0.45495089888572693
loss_pred:0.019219759851694107, decouple_loss:0.00323037663474679
Iteration: 5475, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44241249561309814
loss_pred:0.02050459198653698, decouple_loss:0.0033706992398947477
The generated pressure mean: 0.44045713543891907
loss_pred:0.019584763795137405, decouple_loss:0.0036724063102155924
The generated pressure mean: 0.4401104748249054
loss_pred:0.01957548037171364, decouple_loss:0.003279178636148572
Iteration: 5476, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44927430152893066
loss_pred:0.019228987395763397, decouple_loss:0.004202841781079769
The generated pressure mean: 0.4503699839115143
loss_pred:0.02008097805082798, decouple_loss:0.004111978691071272
The generated pressure mean: 0.4533650279045105
loss_pred:0.019186655059456825, decouple_loss:0.0041597699746489525
Iteration: 5477, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45090189576148987
loss_pred:0.019266841933131218, decouple_loss:0.0031802987214177847
The generated pressure mean: 0.4540385901927948
loss_pred:0.0202926192432642, decouple_loss:0.0032663687597960234
The generated pressure mean: 0.45480969548225403
loss_pred:0.020276574417948723, decouple_loss:0.003276047995314002
Iteration: 5478, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4414718449115753
loss_pred:0.021442757919430733, decouple_loss:0.0035631617065519094
The generated pressure mean: 0.44264906644821167
loss_pred:0.020052336156368256, decouple_loss:0.0035239183343946934
The generated pressure mean: 0.44224467873573303
loss_pred:0.020860418677330017, decouple_loss:0.0035776535514742136
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5479, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4389955699443817
loss_pred:0.02092970721423626, decouple_loss:0.004232405684888363
The generated pressure mean: 0.43507683277130127
loss_pred:0.021395450457930565, decouple_loss:0.004223973024636507
The generated pressure mean: 0.4376017153263092
loss_pred:0.01961820386350155, decouple_loss:0.0040499987080693245
Iteration: 5480, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45649999380111694
loss_pred:0.020399903878569603, decouple_loss:0.0032941813115030527
The generated pressure mean: 0.45487287640571594
loss_pred:0.0187520869076252, decouple_loss:0.003068760968744755
The generated pressure mean: 0.45814841985702515
loss_pred:0.019609905779361725, decouple_loss:0.0032113187480717897
2023-04-17 08:28:46 testing...
The generated pressure mean: 0.4124816060066223
The generated pressure mean: 0.42057836055755615
loss_pred:0.033257149159908295, decouple_loss:0.0037662137765437365
The generated pressure mean: 0.42334166169166565
loss_pred:0.03198808431625366, decouple_loss:0.004092184826731682
loss_pred:0.032053135335445404, decouple_loss:0.004215262830257416
WV_0_PC_0_EH_1_PS_40, loss: 0.03263401612639427, avg_mse: 0.047835301607847214
current test mse: 0.047835
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 5481, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45064088702201843
loss_pred:0.01963343657553196, decouple_loss:0.0033301322255283594
The generated pressure mean: 0.453813374042511
The generated pressure mean: 0.450004518032074
loss_pred:0.020945947617292404, decouple_loss:0.003256353782489896
loss_pred:0.020995505154132843, decouple_loss:0.00327868084423244
Iteration: 5482, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4396096467971802
The generated pressure mean: 0.437101811170578
loss_pred:0.01990658976137638, decouple_loss:0.003909053280949593
loss_pred:0.02176472917199135, decouple_loss:0.004077557940036058
The generated pressure mean: 0.43787088990211487
loss_pred:0.01993308775126934, decouple_loss:0.004083814565092325
Iteration: 5483, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44888168573379517
The generated pressure mean: 0.4493708312511444
loss_pred:0.021077046170830727, decouple_loss:0.0035233446396887302
loss_pred:0.020996758714318275, decouple_loss:0.0034629732836037874
The generated pressure mean: 0.4512677490711212
loss_pred:0.021715784445405006, decouple_loss:0.003629568498581648
Iteration: 5484, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494989216327667
The generated pressure mean: 0.4466193914413452
loss_pred:0.019501706585288048, decouple_loss:0.0029790590051561594
loss_pred:0.02026737481355667, decouple_loss:0.002983072539791465
The generated pressure mean: 0.44154971837997437
loss_pred:0.02021142467856407, decouple_loss:0.0033101874869316816
Iteration: 5485, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4535028040409088
The generated pressure mean: 0.4545421004295349
loss_pred:0.020388474687933922, decouple_loss:0.004023036919534206
loss_pred:0.02118942327797413, decouple_loss:0.003957883454859257
The generated pressure mean: 0.4552721381187439
loss_pred:0.021158691495656967, decouple_loss:0.004002623725682497
Iteration: 5486, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4408003091812134
The generated pressure mean: 0.43554604053497314
loss_pred:0.021550491452217102, decouple_loss:0.00369684724137187
loss_pred:0.02017364278435707, decouple_loss:0.003874576650559902
The generated pressure mean: 0.4343287944793701
loss_pred:0.022064728662371635, decouple_loss:0.003880502888932824
Iteration: 5487, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471787214279175
The generated pressure mean: 0.4487431049346924
loss_pred:0.0203546229749918, decouple_loss:0.003340609837323427
loss_pred:0.020068008452653885, decouple_loss:0.0033355781342834234
The generated pressure mean: 0.43742039799690247
loss_pred:0.02042006142437458, decouple_loss:0.0033372610341757536
Iteration: 5488, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508852958679199
The generated pressure mean: 0.4527882933616638
loss_pred:0.01931384764611721, decouple_loss:0.002830411773175001
loss_pred:0.02079957164824009, decouple_loss:0.0028926213271915913
The generated pressure mean: 0.4494607150554657
loss_pred:0.019637608900666237, decouple_loss:0.002905785571783781
Iteration: 5489, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4517872631549835
loss_pred:0.02028791606426239, decouple_loss:0.0030384741257876158
The generated pressure mean: 0.4526672661304474
loss_pred:0.018823819234967232, decouple_loss:0.0031399910803884268
The generated pressure mean: 0.44848331809043884
loss_pred:0.020755622535943985, decouple_loss:0.003044277895241976
Iteration: 5490, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44056418538093567
The generated pressure mean: 0.44109129905700684
loss_pred:0.021810734644532204, decouple_loss:0.003100247588008642
loss_pred:0.02011135406792164, decouple_loss:0.0031258254311978817
The generated pressure mean: 0.44549885392189026
loss_pred:0.020575668662786484, decouple_loss:0.00317560276016593
2023-04-17 08:31:18 testing...
The generated pressure mean: 0.4145486652851105
The generated pressure mean: 0.4223838746547699
The generated pressure mean: 0.4250752329826355
loss_pred:0.03254571929574013, decouple_loss:0.004134411457926035
loss_pred:0.03162599354982376, decouple_loss:0.004482974763959646
loss_pred:0.03173828125, decouple_loss:0.004628273658454418
WV_0_PC_0_EH_1_PS_40, loss: 0.03219076246023178, avg_mse: 0.046873804181814194
current test mse: 0.046874
Iteration: 5491, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44378724694252014
loss_pred:0.019343694671988487, decouple_loss:0.003681979840621352
The generated pressure mean: 0.44233497977256775
loss_pred:0.019906282424926758, decouple_loss:0.003634120337665081
The generated pressure mean: 0.44454529881477356
loss_pred:0.021434566006064415, decouple_loss:0.003687128657475114
Iteration: 5492, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4520893394947052
The generated pressure mean: 0.4539605677127838
loss_pred:0.02008649706840515, decouple_loss:0.003937162924557924
loss_pred:0.02039881981909275, decouple_loss:0.004052483011037111
The generated pressure mean: 0.45193588733673096
loss_pred:0.020771224051713943, decouple_loss:0.004083315841853619
Iteration: 5493, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506702721118927
loss_pred:0.020762819796800613, decouple_loss:0.0032804543152451515
The generated pressure mean: 0.449627548456192
loss_pred:0.02038205787539482, decouple_loss:0.0033432382624596357
The generated pressure mean: 0.44617959856987
loss_pred:0.019412856549024582, decouple_loss:0.0032483823597431183
Iteration: 5494, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4435107409954071
The generated pressure mean: 0.44390231370925903
loss_pred:0.019676558673381805, decouple_loss:0.003612036816775799
loss_pred:0.02103443071246147, decouple_loss:0.0037648240104317665
The generated pressure mean: 0.44410786032676697
loss_pred:0.021465878933668137, decouple_loss:0.0035712996032088995
Iteration: 5495, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43599173426628113
The generated pressure mean: 0.43811213970184326
loss_pred:0.01974981650710106, decouple_loss:0.0036229535471647978
loss_pred:0.020503483712673187, decouple_loss:0.0037749011535197496
The generated pressure mean: 0.43756231665611267
loss_pred:0.020336298272013664, decouple_loss:0.0038819231558591127
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5496, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4514315128326416
The generated pressure mean: 0.4513196349143982
loss_pred:0.018434928730130196, decouple_loss:0.003086565528064966
loss_pred:0.02160109020769596, decouple_loss:0.003250713227316737
The generated pressure mean: 0.4547598659992218
loss_pred:0.020113591104745865, decouple_loss:0.0033860071562230587
Iteration: 5497, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4608195722103119
loss_pred:0.0217752568423748, decouple_loss:0.003386463737115264
The generated pressure mean: 0.4560370147228241
loss_pred:0.020969947800040245, decouple_loss:0.0033848541788756847
The generated pressure mean: 0.45949041843414307
loss_pred:0.019610600546002388, decouple_loss:0.003285798477008939
Iteration: 5498, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4381937086582184
loss_pred:0.02053169719874859, decouple_loss:0.0031671631149947643
The generated pressure mean: 0.4417240619659424
loss_pred:0.020709911361336708, decouple_loss:0.003189238952472806
The generated pressure mean: 0.43517160415649414
loss_pred:0.021382508799433708, decouple_loss:0.0032250620424747467
Iteration: 5499, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43897220492362976
The generated pressure mean: 0.44318830966949463loss_pred:0.020972728729248047, decouple_loss:0.003709839191287756
loss_pred:0.01976102590560913, decouple_loss:0.003767931368201971
The generated pressure mean: 0.43933406472206116
loss_pred:0.019976342096924782, decouple_loss:0.0037720364052802324
Iteration: 5500, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508931338787079
The generated pressure mean: 0.45004701614379883
loss_pred:0.01907438598573208, decouple_loss:0.0040030586533248425
loss_pred:0.020066052675247192, decouple_loss:0.003950107377022505
The generated pressure mean: 0.4502711296081543
loss_pred:0.02028752490878105, decouple_loss:0.00402147276327014
2023-04-17 08:33:11 testing...
The generated pressure mean: 0.4138140082359314
The generated pressure mean: 0.4220258295536041
loss_pred:0.03283659741282463, decouple_loss:0.0039933472871780396
The generated pressure mean: 0.42422908544540405
loss_pred:0.031925033777952194, decouple_loss:0.00421937694773078
loss_pred:0.031930070370435715, decouple_loss:0.004378264769911766
WV_0_PC_0_EH_1_PS_40, loss: 0.0324404202401638, avg_mse: 0.04731571674346924
current test mse: 0.047316
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 5501, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500306248664856
loss_pred:0.020244687795639038, decouple_loss:0.0037286211736500263
The generated pressure mean: 0.4523347318172455
The generated pressure mean: 0.45272156596183777
loss_pred:0.01992417685687542, decouple_loss:0.003382449271157384
loss_pred:0.018907010555267334, decouple_loss:0.0034962897188961506
Iteration: 5502, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44339466094970703The generated pressure mean: 0.44466620683670044
loss_pred:0.021274955943226814, decouple_loss:0.00344198034144938loss_pred:0.01976519450545311, decouple_loss:0.003576934337615967
The generated pressure mean: 0.4419439733028412
loss_pred:0.020190099254250526, decouple_loss:0.003589692059904337
Iteration: 5503, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44617024064064026
The generated pressure mean: 0.4476450979709625
loss_pred:0.0191911980509758, decouple_loss:0.0034177943598479033
loss_pred:0.01935459114611149, decouple_loss:0.0033316160552203655
The generated pressure mean: 0.4503785967826843
loss_pred:0.01983206532895565, decouple_loss:0.0033706938847899437
Iteration: 5504, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44596177339553833The generated pressure mean: 0.448006808757782
loss_pred:0.02157493866980076, decouple_loss:0.0034453650005161762
loss_pred:0.019936474040150642, decouple_loss:0.0033559638541191816
The generated pressure mean: 0.4422290623188019
loss_pred:0.019126737490296364, decouple_loss:0.003363177180290222
Iteration: 5505, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4441927969455719
The generated pressure mean: 0.44550254940986633
loss_pred:0.0215953066945076, decouple_loss:0.0033267298713326454
loss_pred:0.019700676202774048, decouple_loss:0.003279494121670723
The generated pressure mean: 0.4482898414134979
loss_pred:0.020480332896113396, decouple_loss:0.0031845695339143276
Iteration: 5506, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44110536575317383
The generated pressure mean: 0.44555437564849854
loss_pred:0.01926407776772976, decouple_loss:0.0034764339216053486
loss_pred:0.020870648324489594, decouple_loss:0.0034863585606217384
The generated pressure mean: 0.43789663910865784
loss_pred:0.01933678612112999, decouple_loss:0.0035468905698508024
Iteration: 5507, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4543653428554535
The generated pressure mean: 0.45870158076286316
loss_pred:0.019412260502576828, decouple_loss:0.003635801374912262
loss_pred:0.02240043692290783, decouple_loss:0.003845295635983348
The generated pressure mean: 0.45535287261009216
loss_pred:0.01896548829972744, decouple_loss:0.003732461016625166
Iteration: 5508, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4433669149875641
The generated pressure mean: 0.43924999237060547
loss_pred:0.02053838036954403, decouple_loss:0.00399627024307847
loss_pred:0.01914891041815281, decouple_loss:0.003991507459431887
The generated pressure mean: 0.4449484646320343
loss_pred:0.01934012584388256, decouple_loss:0.003888428444042802
Iteration: 5509, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44508489966392517
loss_pred:0.020017752423882484, decouple_loss:0.0034388701897114515
The generated pressure mean: 0.44594448804855347
loss_pred:0.02114105597138405, decouple_loss:0.003521580481901765
The generated pressure mean: 0.4473462998867035
loss_pred:0.022584514692425728, decouple_loss:0.003218695754185319
Iteration: 5510, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4436613619327545
loss_pred:0.019453926011919975, decouple_loss:0.004652711562812328
The generated pressure mean: 0.4361896812915802
loss_pred:0.021131420508027077, decouple_loss:0.004525152966380119
The generated pressure mean: 0.4350299835205078
loss_pred:0.02104801870882511, decouple_loss:0.00444180378690362
2023-04-17 08:35:42 testing...
The generated pressure mean: 0.4227360785007477
The generated pressure mean: 0.4126570224761963
The generated pressure mean: 0.42485126852989197
loss_pred:0.03345286101102829, decouple_loss:0.004879734944552183
loss_pred:0.035059716552495956, decouple_loss:0.004688658751547337
loss_pred:0.03341643139719963, decouple_loss:0.005026570986956358
WV_0_PC_0_EH_1_PS_40, loss: 0.03421958535909653, avg_mse: 0.051218245178461075
current test mse: 0.051218
Iteration: 5511, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45905062556266785
loss_pred:0.020152276381850243, decouple_loss:0.003759918035939336
The generated pressure mean: 0.4603944420814514
loss_pred:0.02047751657664776, decouple_loss:0.004055330064147711
The generated pressure mean: 0.4561573266983032
loss_pred:0.020410306751728058, decouple_loss:0.0038126178551465273
Iteration: 5512, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44276633858680725
loss_pred:0.020418213680386543, decouple_loss:0.0047242240980267525
The generated pressure mean: 0.44769054651260376
loss_pred:0.020000800490379333, decouple_loss:0.004877758212387562
The generated pressure mean: 0.44392991065979004
loss_pred:0.021296963095664978, decouple_loss:0.004570559598505497
Iteration: 5513, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4389652907848358
loss_pred:0.020267318934202194, decouple_loss:0.004286902956664562
The generated pressure mean: 0.4387335479259491
loss_pred:0.018880287185311317, decouple_loss:0.004278363194316626
The generated pressure mean: 0.4383313059806824
loss_pred:0.019689608365297318, decouple_loss:0.004304181784391403
Iteration: 5514, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44789475202560425
loss_pred:0.020587923005223274, decouple_loss:0.0036962716840207577
The generated pressure mean: 0.44492092728614807
loss_pred:0.019403962418437004, decouple_loss:0.003926423378288746
The generated pressure mean: 0.4409293830394745
loss_pred:0.02203492820262909, decouple_loss:0.003627850441262126
Iteration: 5515, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4533569812774658
loss_pred:0.019411282613873482, decouple_loss:0.004317191895097494
The generated pressure mean: 0.45432141423225403
loss_pred:0.02150612138211727, decouple_loss:0.004239525645971298
The generated pressure mean: 0.45665985345840454
loss_pred:0.019050585106015205, decouple_loss:0.004355382639914751
Iteration: 5516, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45174285769462585
loss_pred:0.020237356424331665, decouple_loss:0.0034136807080358267
The generated pressure mean: 0.4535813629627228
loss_pred:0.019207525998353958, decouple_loss:0.003525702515617013
The generated pressure mean: 0.4518146812915802
loss_pred:0.019051019102334976, decouple_loss:0.0032640916761010885
Iteration: 5517, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43934616446495056
The generated pressure mean: 0.4380685091018677loss_pred:0.019456660374999046, decouple_loss:0.0035109221935272217
loss_pred:0.019602036103606224, decouple_loss:0.00381711358204484
The generated pressure mean: 0.4352465867996216
loss_pred:0.019007250666618347, decouple_loss:0.003788640722632408
Iteration: 5518, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4379642903804779
loss_pred:0.02041681855916977, decouple_loss:0.003709223819896579
The generated pressure mean: 0.43582963943481445
loss_pred:0.02376645803451538, decouple_loss:0.003672822145745158
The generated pressure mean: 0.44011390209198
loss_pred:0.02069663815200329, decouple_loss:0.003644090611487627
Iteration: 5519, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4388902485370636
loss_pred:0.018547195941209793, decouple_loss:0.003455929923802614
The generated pressure mean: 0.4300573766231537
loss_pred:0.02093215472996235, decouple_loss:0.0032969145104289055
The generated pressure mean: 0.4357602894306183
loss_pred:0.02135213278234005, decouple_loss:0.003403250128030777
Iteration: 5520, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47075626254081726
loss_pred:0.01982814632356167, decouple_loss:0.0035497567150741816
The generated pressure mean: 0.4740274250507355
loss_pred:0.020811013877391815, decouple_loss:0.0034499256871640682
The generated pressure mean: 0.47618430852890015
loss_pred:0.02048133872449398, decouple_loss:0.003418210195377469
2023-04-17 08:37:36 testing...
The generated pressure mean: 0.41408398747444153
The generated pressure mean: 0.4220007658004761
The generated pressure mean: 0.4248007535934448
loss_pred:0.03440774977207184, decouple_loss:0.004451506771147251
loss_pred:0.03299221396446228, decouple_loss:0.004778978414833546
loss_pred:0.032968416810035706, decouple_loss:0.005018734838813543
WV_0_PC_0_EH_1_PS_40, loss: 0.03369361534714699, avg_mse: 0.0498766265809536
current test mse: 0.049877
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 5521, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44991809129714966
loss_pred:0.020961415022611618, decouple_loss:0.0038266279734671116
The generated pressure mean: 0.4487387537956238
loss_pred:0.02189202979207039, decouple_loss:0.0040177274495363235
The generated pressure mean: 0.44499844312667847
loss_pred:0.02130402997136116, decouple_loss:0.004068940412253141
Iteration: 5522, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4179271459579468
The generated pressure mean: 0.4166746437549591
loss_pred:0.021237347275018692, decouple_loss:0.0034758548717945814
loss_pred:0.02014942467212677, decouple_loss:0.003406676696613431
The generated pressure mean: 0.4230707585811615
loss_pred:0.020519886165857315, decouple_loss:0.00347582483664155
Iteration: 5523, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483110308647156
The generated pressure mean: 0.4539012908935547
loss_pred:0.020646216347813606, decouple_loss:0.004122038837522268
loss_pred:0.019617239013314247, decouple_loss:0.004157935734838247
The generated pressure mean: 0.45207977294921875
loss_pred:0.020381631329655647, decouple_loss:0.004065410234034061
Iteration: 5524, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4607886075973511
The generated pressure mean: 0.4643538296222687
loss_pred:0.02037886716425419, decouple_loss:0.0041541773825883865
loss_pred:0.02160940319299698, decouple_loss:0.004007476847618818
The generated pressure mean: 0.4657662510871887
loss_pred:0.01974760740995407, decouple_loss:0.0041743372566998005
Iteration: 5525, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4403045177459717
The generated pressure mean: 0.4421330988407135
loss_pred:0.0207977257668972, decouple_loss:0.0038203743752092123
loss_pred:0.02254265733063221, decouple_loss:0.0038090308662503958
The generated pressure mean: 0.4423708915710449
loss_pred:0.020223740488290787, decouple_loss:0.003668684745207429
Iteration: 5526, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43407079577445984
The generated pressure mean: 0.4372996389865875
loss_pred:0.019399408251047134, decouple_loss:0.003965048119425774
loss_pred:0.019906679168343544, decouple_loss:0.003862143727019429
The generated pressure mean: 0.4333980679512024
loss_pred:0.020560381934046745, decouple_loss:0.003923510666936636
Iteration: 5527, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4416986405849457
The generated pressure mean: 0.4442785680294037
loss_pred:0.01855400577187538, decouple_loss:0.0040607750415802
loss_pred:0.020171087235212326, decouple_loss:0.0040720608085393906
The generated pressure mean: 0.4402927756309509
loss_pred:0.01836865395307541, decouple_loss:0.004186281468719244
Iteration: 5528, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4618741571903229
The generated pressure mean: 0.46228593587875366
loss_pred:0.02130475640296936, decouple_loss:0.003958527464419603
loss_pred:0.019893042743206024, decouple_loss:0.0037390077486634254
The generated pressure mean: 0.4624972343444824
loss_pred:0.022254610434174538, decouple_loss:0.0037236132193356752
Iteration: 5529, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4307699501514435
loss_pred:0.021494120359420776, decouple_loss:0.0038430029526352882
The generated pressure mean: 0.4301864206790924
loss_pred:0.020410267636179924, decouple_loss:0.0037233270704746246
The generated pressure mean: 0.42722395062446594
loss_pred:0.020806800574064255, decouple_loss:0.003635189263150096
Iteration: 5530, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4512050449848175
loss_pred:0.020809607580304146, decouple_loss:0.0036614076234400272
The generated pressure mean: 0.45236000418663025
loss_pred:0.019689565524458885, decouple_loss:0.0036801898386329412
The generated pressure mean: 0.44885483384132385
loss_pred:0.020681675523519516, decouple_loss:0.003749978030100465
2023-04-17 08:40:12 testing...
The generated pressure mean: 0.4139270782470703
The generated pressure mean: 0.42124947905540466
The generated pressure mean: 0.42408043146133423
loss_pred:0.03356652706861496, decouple_loss:0.0038931556046009064
loss_pred:0.03244711458683014, decouple_loss:0.00415116036310792
loss_pred:0.03239731118083, decouple_loss:0.004295799415558577
WV_0_PC_0_EH_1_PS_40, loss: 0.03300932049751282, avg_mse: 0.04868759959936142
current test mse: 0.048688
Iteration: 5531, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468463659286499
The generated pressure mean: 0.445629358291626
loss_pred:0.019321246072649956, decouple_loss:0.0035350036341696978
loss_pred:0.019554510712623596, decouple_loss:0.0035038162022829056
The generated pressure mean: 0.443550705909729
loss_pred:0.01984051801264286, decouple_loss:0.003530934453010559
Iteration: 5532, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4518943727016449
loss_pred:0.020314710214734077, decouple_loss:0.0033828639425337315
The generated pressure mean: 0.44943127036094666
loss_pred:0.021299300715327263, decouple_loss:0.003500044811517
The generated pressure mean: 0.4502228796482086
loss_pred:0.019969392567873, decouple_loss:0.003535700496286154
Iteration: 5533, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4453374743461609
The generated pressure mean: 0.4473024010658264
loss_pred:0.02013215236365795, decouple_loss:0.004648313391953707
loss_pred:0.02076963149011135, decouple_loss:0.004630958195775747
The generated pressure mean: 0.4405484199523926
loss_pred:0.02150770090520382, decouple_loss:0.004754472523927689
Iteration: 5534, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44458144903182983
loss_pred:0.019593961536884308, decouple_loss:0.0034151070285588503
The generated pressure mean: 0.4430299997329712
loss_pred:0.020754199475049973, decouple_loss:0.0035632862709462643
The generated pressure mean: 0.440155029296875
loss_pred:0.01998419500887394, decouple_loss:0.003389970399439335
Iteration: 5535, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44690847396850586
loss_pred:0.021143633872270584, decouple_loss:0.0037807035259902477
The generated pressure mean: 0.4512690603733063
loss_pred:0.020028145983815193, decouple_loss:0.003751816228032112
The generated pressure mean: 0.45443010330200195
loss_pred:0.018984347581863403, decouple_loss:0.0038168372120708227
Iteration: 5536, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4448049068450928
loss_pred:0.019862204790115356, decouple_loss:0.004099736921489239
The generated pressure mean: 0.4469999372959137
loss_pred:0.020319659262895584, decouple_loss:0.004023711197078228
The generated pressure mean: 0.4431530833244324
loss_pred:0.020262163132429123, decouple_loss:0.003975675906985998
Iteration: 5537, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479200541973114
loss_pred:0.020416127517819405, decouple_loss:0.003827230539172888
The generated pressure mean: 0.4511285722255707
loss_pred:0.021190550178289413, decouple_loss:0.0035908969584852457
The generated pressure mean: 0.4553587734699249
loss_pred:0.019184913486242294, decouple_loss:0.0037661134265363216
Iteration: 5538, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4390677213668823
The generated pressure mean: 0.4356818199157715
loss_pred:0.019714361056685448, decouple_loss:0.004202932585030794
loss_pred:0.019125476479530334, decouple_loss:0.0042470586486160755
The generated pressure mean: 0.4423910081386566
loss_pred:0.019175538793206215, decouple_loss:0.004134627990424633
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5539, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44283318519592285
loss_pred:0.019489428028464317, decouple_loss:0.0035600445698946714
The generated pressure mean: 0.43802228569984436
loss_pred:0.02124650776386261, decouple_loss:0.0036108617205172777
The generated pressure mean: 0.4403773546218872
loss_pred:0.02044641599059105, decouple_loss:0.0036595992278307676
Iteration: 5540, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45414894819259644
The generated pressure mean: 0.4541124999523163
loss_pred:0.018999570980668068, decouple_loss:0.0033583284821361303
loss_pred:0.02193790301680565, decouple_loss:0.0035365549847483635
The generated pressure mean: 0.454319030046463
loss_pred:0.01944308541715145, decouple_loss:0.003476934740319848
2023-04-17 08:42:06 testing...
The generated pressure mean: 0.41531902551651
The generated pressure mean: 0.4215589761734009
loss_pred:0.03195037692785263, decouple_loss:0.004286294337362051
The generated pressure mean: 0.424103319644928
loss_pred:0.030913934111595154, decouple_loss:0.0046191089786589146
loss_pred:0.0308995321393013, decouple_loss:0.004829548764973879
WV_0_PC_0_EH_1_PS_40, loss: 0.03148353099822998, avg_mse: 0.045284103602170944
current test mse: 0.045284
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 5541, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4425782561302185
loss_pred:0.02004202827811241, decouple_loss:0.003848186694085598
The generated pressure mean: 0.44148290157318115
loss_pred:0.019934915006160736, decouple_loss:0.00368405319750309
The generated pressure mean: 0.43676817417144775
loss_pred:0.02103213220834732, decouple_loss:0.0037040873430669308
Iteration: 5542, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44324564933776855
The generated pressure mean: 0.44474726915359497
loss_pred:0.021017828956246376, decouple_loss:0.0036844387650489807
loss_pred:0.020842349156737328, decouple_loss:0.0038966848514974117
The generated pressure mean: 0.44121798872947693
loss_pred:0.021497925743460655, decouple_loss:0.003738467814400792
Iteration: 5543, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4528786242008209
loss_pred:0.021520104259252548, decouple_loss:0.003331043291836977
The generated pressure mean: 0.4561071991920471
loss_pred:0.022397954016923904, decouple_loss:0.0034114597365260124
The generated pressure mean: 0.4581635892391205
loss_pred:0.020679352805018425, decouple_loss:0.0032254704274237156
Iteration: 5544, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44380807876586914
loss_pred:0.019528599455952644, decouple_loss:0.003901200369000435
The generated pressure mean: 0.44717687368392944
loss_pred:0.021668044850230217, decouple_loss:0.003812342183664441
The generated pressure mean: 0.4445277750492096
loss_pred:0.020203106105327606, decouple_loss:0.003904937533661723
Iteration: 5545, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4397566318511963
loss_pred:0.0214831605553627, decouple_loss:0.003859300399199128
The generated pressure mean: 0.4362408220767975
loss_pred:0.020458823069930077, decouple_loss:0.003977860789746046
The generated pressure mean: 0.4357021450996399
loss_pred:0.019660193473100662, decouple_loss:0.003800042672082782
Iteration: 5546, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502909779548645
loss_pred:0.019572820514440536, decouple_loss:0.0034466274082660675
The generated pressure mean: 0.45217326283454895
loss_pred:0.021060314029455185, decouple_loss:0.0035203241277486086
The generated pressure mean: 0.4546145498752594
loss_pred:0.019457586109638214, decouple_loss:0.003430550917983055
Iteration: 5547, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469122886657715
The generated pressure mean: 0.4462459087371826
loss_pred:0.018871232867240906, decouple_loss:0.0034298880491405725
loss_pred:0.019823618233203888, decouple_loss:0.0034638717770576477
The generated pressure mean: 0.4433193802833557
loss_pred:0.01877041906118393, decouple_loss:0.0035134737845510244
Iteration: 5548, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4409889876842499
loss_pred:0.020107921212911606, decouple_loss:0.0037555319722741842
The generated pressure mean: 0.44099777936935425
loss_pred:0.022330325096845627, decouple_loss:0.0036503418814390898
The generated pressure mean: 0.44498521089553833
loss_pred:0.022111566737294197, decouple_loss:0.003657067660242319
Iteration: 5549, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471510350704193
loss_pred:0.022553730756044388, decouple_loss:0.0037350456696003675
The generated pressure mean: 0.44441235065460205
loss_pred:0.019720032811164856, decouple_loss:0.0037850691005587578
The generated pressure mean: 0.4458392560482025
loss_pred:0.019715288653969765, decouple_loss:0.0036674318835139275
Iteration: 5550, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4523185193538666
loss_pred:0.019726792350411415, decouple_loss:0.00377069809474051
The generated pressure mean: 0.45471644401550293
loss_pred:0.020754173398017883, decouple_loss:0.003753682365640998
The generated pressure mean: 0.45089057087898254
loss_pred:0.019213752821087837, decouple_loss:0.0037524080835282803
2023-04-17 08:44:35 testing...
The generated pressure mean: 0.4146060645580292
The generated pressure mean: 0.4220370650291443
loss_pred:0.03368975594639778, decouple_loss:0.004717789124697447
The generated pressure mean: 0.4244965612888336
loss_pred:0.032253388315439224, decouple_loss:0.004802090115845203
loss_pred:0.032323673367500305, decouple_loss:0.004956461954861879
WV_0_PC_0_EH_1_PS_40, loss: 0.03299688175320625, avg_mse: 0.0484650544822216
current test mse: 0.048465
Iteration: 5551, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442010819911957
The generated pressure mean: 0.4471302628517151
loss_pred:0.02002222277224064, decouple_loss:0.004151160828769207
loss_pred:0.019825126975774765, decouple_loss:0.004221531096845865
The generated pressure mean: 0.4460461139678955
loss_pred:0.020566627383232117, decouple_loss:0.00416669063270092
Iteration: 5552, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4403937757015228
loss_pred:0.018884392455220222, decouple_loss:0.004215553868561983
The generated pressure mean: 0.44224151968955994
loss_pred:0.019247718155384064, decouple_loss:0.004314176272600889
The generated pressure mean: 0.44266730546951294
loss_pred:0.020375022664666176, decouple_loss:0.0043534026481211185
Iteration: 5553, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4455339312553406
The generated pressure mean: 0.4453035593032837
loss_pred:0.019318709149956703, decouple_loss:0.00369642092846334
loss_pred:0.020244484767317772, decouple_loss:0.0037196490447968245
The generated pressure mean: 0.4452797472476959
loss_pred:0.020104046911001205, decouple_loss:0.0038112327456474304
Iteration: 5554, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45326194167137146
The generated pressure mean: 0.45362356305122375
loss_pred:0.01972048170864582, decouple_loss:0.005094647873193026
loss_pred:0.021892061457037926, decouple_loss:0.0052594756707549095
The generated pressure mean: 0.45205116271972656
loss_pred:0.0218440480530262, decouple_loss:0.0051662493497133255
Iteration: 5555, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43909794092178345
The generated pressure mean: 0.44267764687538147
loss_pred:0.0205413606017828, decouple_loss:0.004141907207667828
loss_pred:0.021350007504224777, decouple_loss:0.0040228464640676975
The generated pressure mean: 0.4408693015575409
loss_pred:0.021901872009038925, decouple_loss:0.0039319805800914764
Iteration: 5556, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44827941060066223
The generated pressure mean: 0.4505103826522827
loss_pred:0.019469505175948143, decouple_loss:0.0036968172062188387
loss_pred:0.019971217960119247, decouple_loss:0.0036414091009646654
The generated pressure mean: 0.4468673765659332
loss_pred:0.02315322868525982, decouple_loss:0.0039794850163161755
Iteration: 5557, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44032883644104004
The generated pressure mean: 0.44024837017059326
loss_pred:0.020294027402997017, decouple_loss:0.004516530781984329
loss_pred:0.019955022260546684, decouple_loss:0.004510452039539814
The generated pressure mean: 0.4409695267677307
loss_pred:0.019303947687149048, decouple_loss:0.004540753550827503
Iteration: 5558, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464931786060333
loss_pred:0.019785216078162193, decouple_loss:0.003898266702890396
The generated pressure mean: 0.4436279535293579
loss_pred:0.019676247611641884, decouple_loss:0.003774043405428529
The generated pressure mean: 0.4440559446811676
loss_pred:0.020113985985517502, decouple_loss:0.0039347498677670956
Iteration: 5559, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4524294137954712
loss_pred:0.020365403965115547, decouple_loss:0.0038291148375719786
The generated pressure mean: 0.4552619457244873
loss_pred:0.019956795498728752, decouple_loss:0.0037005487829446793
The generated pressure mean: 0.456728994846344
loss_pred:0.01991676725447178, decouple_loss:0.0036802731920033693
Iteration: 5560, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497886896133423
loss_pred:0.019315999001264572, decouple_loss:0.004026416689157486
The generated pressure mean: 0.4523366093635559
loss_pred:0.019601602107286453, decouple_loss:0.004002997651696205
The generated pressure mean: 0.45461586117744446
loss_pred:0.019840681925415993, decouple_loss:0.004233337473124266
2023-04-17 08:46:28 testing...
The generated pressure mean: 0.41500261425971985
The generated pressure mean: 0.4219400882720947
loss_pred:0.03310456499457359, decouple_loss:0.004301333334296942
The generated pressure mean: 0.42443346977233887
loss_pred:0.031834278255701065, decouple_loss:0.004499803297221661
loss_pred:0.03173784911632538, decouple_loss:0.004585770890116692
WV_0_PC_0_EH_1_PS_40, loss: 0.03244867920875549, avg_mse: 0.04743953421711922
current test mse: 0.04744
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 5561, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44311630725860596
loss_pred:0.020198147743940353, decouple_loss:0.003899272531270981
The generated pressure mean: 0.4450584053993225
The generated pressure mean: 0.4399465024471283
loss_pred:0.020073700696229935, decouple_loss:0.0038492288440465927
loss_pred:0.02035667560994625, decouple_loss:0.003702503861859441
Iteration: 5562, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4414622187614441
The generated pressure mean: 0.4375990629196167
loss_pred:0.01945195533335209, decouple_loss:0.004955388605594635
loss_pred:0.019764810800552368, decouple_loss:0.004839285742491484
The generated pressure mean: 0.4413820207118988
loss_pred:0.01993103325366974, decouple_loss:0.004863036330789328
Iteration: 5563, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45055097341537476
The generated pressure mean: 0.45131707191467285
loss_pred:0.018870355561375618, decouple_loss:0.0039028828032314777
loss_pred:0.02025524340569973, decouple_loss:0.0038170446641743183
The generated pressure mean: 0.4503789246082306
loss_pred:0.020144721493124962, decouple_loss:0.003937223926186562
Iteration: 5564, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4437926113605499
The generated pressure mean: 0.4478994309902191
loss_pred:0.023292550817131996, decouple_loss:0.004253328777849674
loss_pred:0.022888455539941788, decouple_loss:0.004132821224629879
The generated pressure mean: 0.4429709017276764
loss_pred:0.01960049755871296, decouple_loss:0.004258993547409773
Iteration: 5565, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43528082966804504
The generated pressure mean: 0.43434128165245056
loss_pred:0.020196206867694855, decouple_loss:0.004232446197420359
loss_pred:0.01981522887945175, decouple_loss:0.004344550892710686
The generated pressure mean: 0.43938538432121277
loss_pred:0.019857235252857208, decouple_loss:0.004305806010961533
Iteration: 5566, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45522016286849976
The generated pressure mean: 0.4536561071872711
loss_pred:0.01930657960474491, decouple_loss:0.005462711676955223
loss_pred:0.018878187984228134, decouple_loss:0.005224841646850109
The generated pressure mean: 0.45789480209350586
loss_pred:0.020289119333028793, decouple_loss:0.004990951158106327
Iteration: 5567, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4588211476802826
The generated pressure mean: 0.4580879807472229
loss_pred:0.0198785699903965, decouple_loss:0.005589905194938183
loss_pred:0.020121807232499123, decouple_loss:0.0055932519026100636
The generated pressure mean: 0.45836830139160156
loss_pred:0.01930125430226326, decouple_loss:0.005671478342264891
Iteration: 5568, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4320443272590637
loss_pred:0.020866209641098976, decouple_loss:0.004816177301108837
The generated pressure mean: 0.4354359209537506
loss_pred:0.02050921879708767, decouple_loss:0.004988914355635643
The generated pressure mean: 0.4284229874610901
loss_pred:0.021711308509111404, decouple_loss:0.004944077227264643
Iteration: 5569, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482099413871765
The generated pressure mean: 0.4456218481063843
loss_pred:0.021277662366628647, decouple_loss:0.005965799558907747
loss_pred:0.01990133710205555, decouple_loss:0.005777457728981972
The generated pressure mean: 0.44962480664253235
loss_pred:0.020812267437577248, decouple_loss:0.00589634757488966
Iteration: 5570, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488358795642853
The generated pressure mean: 0.4557535648345947
loss_pred:0.019506901502609253, decouple_loss:0.0034815443214029074
loss_pred:0.018958084285259247, decouple_loss:0.0034052759874612093
The generated pressure mean: 0.4515649676322937
loss_pred:0.021159224212169647, decouple_loss:0.003458002582192421
2023-04-17 08:48:58 testing...
The generated pressure mean: 0.41621121764183044
The generated pressure mean: 0.4248237907886505
loss_pred:0.03333673253655434, decouple_loss:0.0052043367177248
The generated pressure mean: 0.4273271858692169
loss_pred:0.03204677253961563, decouple_loss:0.005369214806705713
loss_pred:0.03205419331789017, decouple_loss:0.005514702759683132
WV_0_PC_0_EH_1_PS_40, loss: 0.03274737298488617, avg_mse: 0.04793471470475197
current test mse: 0.047935
Iteration: 5571, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43915194272994995The generated pressure mean: 0.43873330950737
loss_pred:0.01979093998670578, decouple_loss:0.004815834108740091
loss_pred:0.020947545766830444, decouple_loss:0.004698639269918203
The generated pressure mean: 0.43830329179763794
loss_pred:0.020766517147421837, decouple_loss:0.004706118255853653
Iteration: 5572, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495810866355896
The generated pressure mean: 0.4488794505596161
loss_pred:0.01872844062745571, decouple_loss:0.004745651502162218
loss_pred:0.020282259210944176, decouple_loss:0.004678958561271429
The generated pressure mean: 0.4477045238018036
loss_pred:0.02045031636953354, decouple_loss:0.004908145405352116
Iteration: 5573, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4541129469871521
loss_pred:0.02052399516105652, decouple_loss:0.0038361072074621916
The generated pressure mean: 0.4546395242214203
loss_pred:0.021033743396401405, decouple_loss:0.003587188199162483
The generated pressure mean: 0.45687732100486755
loss_pred:0.01897575333714485, decouple_loss:0.0036588842049241066
Iteration: 5574, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44567185640335083
loss_pred:0.019461480900645256, decouple_loss:0.003541496116667986
The generated pressure mean: 0.4432830214500427
loss_pred:0.020827263593673706, decouple_loss:0.003235377836972475
The generated pressure mean: 0.44410231709480286
loss_pred:0.019548727199435234, decouple_loss:0.003068708349019289
Iteration: 5575, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4396299719810486
loss_pred:0.019763754680752754, decouple_loss:0.0038537413347512484
The generated pressure mean: 0.437765896320343
loss_pred:0.020050931721925735, decouple_loss:0.003956829663366079
The generated pressure mean: 0.4369722306728363
loss_pred:0.02109851874411106, decouple_loss:0.0039870659820735455
Iteration: 5576, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504821002483368
loss_pred:0.0205682460218668, decouple_loss:0.0037141675129532814
The generated pressure mean: 0.4503158926963806
loss_pred:0.019582603126764297, decouple_loss:0.0033845598809421062
The generated pressure mean: 0.45208799839019775
loss_pred:0.021806493401527405, decouple_loss:0.0034755512606352568
Iteration: 5577, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4457201659679413
loss_pred:0.020385222509503365, decouple_loss:0.003674701787531376
The generated pressure mean: 0.45100048184394836
loss_pred:0.020680265501141548, decouple_loss:0.003908085636794567
The generated pressure mean: 0.4509425163269043
loss_pred:0.02067052572965622, decouple_loss:0.0036507362965494394
Iteration: 5578, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44068920612335205
loss_pred:0.021795975044369698, decouple_loss:0.0038667628541588783
The generated pressure mean: 0.43603071570396423
loss_pred:0.020248636603355408, decouple_loss:0.003961366601288319
The generated pressure mean: 0.441310852766037
loss_pred:0.02239399030804634, decouple_loss:0.004007377196103334
Iteration: 5579, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44893741607666016
loss_pred:0.02023068070411682, decouple_loss:0.0035775857977569103
The generated pressure mean: 0.45240315794944763
loss_pred:0.019561637192964554, decouple_loss:0.00347955827601254
The generated pressure mean: 0.4455607533454895
loss_pred:0.019005006179213524, decouple_loss:0.0034500714391469955
Iteration: 5580, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45136338472366333
loss_pred:0.02137538231909275, decouple_loss:0.003481844440102577
The generated pressure mean: 0.4551820755004883
loss_pred:0.02171320654451847, decouple_loss:0.003435369348153472
The generated pressure mean: 0.4555472433567047
loss_pred:0.019864847883582115, decouple_loss:0.00329045788384974
2023-04-17 08:50:51 testing...
The generated pressure mean: 0.4239962697029114
The generated pressure mean: 0.4163160026073456
The generated pressure mean: 0.42596471309661865
loss_pred:0.031096747145056725, decouple_loss:0.003993717022240162
loss_pred:0.032290175557136536, decouple_loss:0.003775808960199356
loss_pred:0.030883826315402985, decouple_loss:0.004160511773079634
WV_0_PC_0_EH_1_PS_40, loss: 0.03162241727113724, avg_mse: 0.0458807609975338
current test mse: 0.045881
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 5581, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4324934780597687
loss_pred:0.019193515181541443, decouple_loss:0.0031744304578751326
The generated pressure mean: 0.4410414695739746
The generated pressure mean: 0.4386588931083679
loss_pred:0.02119755744934082, decouple_loss:0.003247948596253991
loss_pred:0.019715789705514908, decouple_loss:0.0033308202400803566
Iteration: 5582, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44359299540519714
The generated pressure mean: 0.44195085763931274
loss_pred:0.019351858645677567, decouple_loss:0.003447148250415921
loss_pred:0.0206278245896101, decouple_loss:0.0034878342412412167
The generated pressure mean: 0.43335363268852234
loss_pred:0.020065007731318474, decouple_loss:0.0035105999559164047
Iteration: 5583, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45523759722709656
loss_pred:0.020416945219039917, decouple_loss:0.0034615900367498398The generated pressure mean: 0.4593040645122528
loss_pred:0.01860649138689041, decouple_loss:0.003224332584068179
The generated pressure mean: 0.45376306772232056
loss_pred:0.019403863698244095, decouple_loss:0.00340555002912879
Iteration: 5584, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4523220658302307
loss_pred:0.01937023550271988, decouple_loss:0.003515205578878522
The generated pressure mean: 0.44995421171188354
loss_pred:0.021821167320013046, decouple_loss:0.00357285188511014
The generated pressure mean: 0.4472399353981018
loss_pred:0.021795496344566345, decouple_loss:0.003624165430665016
Iteration: 5585, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42930689454078674
The generated pressure mean: 0.43293893337249756
loss_pred:0.020723488181829453, decouple_loss:0.003733407473191619
loss_pred:0.024201739579439163, decouple_loss:0.0038454649038612843
The generated pressure mean: 0.43623191118240356
loss_pred:0.019851645454764366, decouple_loss:0.003632121253758669
Iteration: 5586, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494597315788269
The generated pressure mean: 0.45168596506118774
loss_pred:0.02052060328423977, decouple_loss:0.005747073795646429
loss_pred:0.021459799259901047, decouple_loss:0.00583077734336257
The generated pressure mean: 0.4498303532600403
loss_pred:0.020489685237407684, decouple_loss:0.00588096072897315
Iteration: 5587, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4583826959133148
The generated pressure mean: 0.4577673673629761
loss_pred:0.019563157111406326, decouple_loss:0.004850677214562893
loss_pred:0.01844695396721363, decouple_loss:0.004584022331982851
The generated pressure mean: 0.45752644538879395
loss_pred:0.02050125040113926, decouple_loss:0.004754763096570969
Iteration: 5588, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4436087906360626
The generated pressure mean: 0.4412047564983368
loss_pred:0.020926008000969887, decouple_loss:0.0034123952500522137
loss_pred:0.020493239164352417, decouple_loss:0.0034897583536803722
The generated pressure mean: 0.44091564416885376
loss_pred:0.01979585736989975, decouple_loss:0.0034743184223771095
Iteration: 5589, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4371205270290375
The generated pressure mean: 0.44074833393096924
loss_pred:0.02094121463596821, decouple_loss:0.005102441646158695
loss_pred:0.020407166332006454, decouple_loss:0.004879279527813196
The generated pressure mean: 0.4420652985572815
loss_pred:0.02039281092584133, decouple_loss:0.004898053593933582
Iteration: 5590, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4450245201587677
loss_pred:0.019797256216406822, decouple_loss:0.004846140276640654
The generated pressure mean: 0.44616594910621643
loss_pred:0.020307647064328194, decouple_loss:0.005112982355058193
The generated pressure mean: 0.4460016191005707
loss_pred:0.021078435704112053, decouple_loss:0.005068900063633919
2023-04-17 08:53:24 testing...
The generated pressure mean: 0.41381901502609253
The generated pressure mean: 0.4201031029224396
The generated pressure mean: 0.4222145676612854
loss_pred:0.03507709503173828, decouple_loss:0.004678979981690645
loss_pred:0.03375373035669327, decouple_loss:0.004747842438519001
loss_pred:0.033972129225730896, decouple_loss:0.004838121123611927
WV_0_PC_0_EH_1_PS_40, loss: 0.03450540080666542, avg_mse: 0.050743505358695984
current test mse: 0.050744
Iteration: 5591, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462173581123352
loss_pred:0.02074960619211197, decouple_loss:0.004139518830925226
The generated pressure mean: 0.4405617117881775
loss_pred:0.019702279940247536, decouple_loss:0.004100740887224674
The generated pressure mean: 0.4446087181568146
loss_pred:0.01951010338962078, decouple_loss:0.004304275847971439
Iteration: 5592, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45635151863098145
loss_pred:0.018400762230157852, decouple_loss:0.004545490723103285
The generated pressure mean: 0.4551182687282562
loss_pred:0.019230373203754425, decouple_loss:0.004602015018463135
The generated pressure mean: 0.45444971323013306
loss_pred:0.01853267289698124, decouple_loss:0.004372054245322943
Iteration: 5593, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492681324481964
loss_pred:0.020257234573364258, decouple_loss:0.003978432156145573
The generated pressure mean: 0.4553832709789276
loss_pred:0.01867213472723961, decouple_loss:0.0041220770217478275
The generated pressure mean: 0.45481640100479126
loss_pred:0.02076566405594349, decouple_loss:0.004483070690184832
Iteration: 5594, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44019538164138794
loss_pred:0.021516554057598114, decouple_loss:0.004069989081472158
The generated pressure mean: 0.4387074112892151
loss_pred:0.019048824906349182, decouple_loss:0.003839998971670866
The generated pressure mean: 0.440983384847641
loss_pred:0.017669884487986565, decouple_loss:0.003931077197194099
Iteration: 5595, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43679162859916687
loss_pred:0.02031848020851612, decouple_loss:0.003820734564214945
The generated pressure mean: 0.440012127161026
loss_pred:0.018483052030205727, decouple_loss:0.0037138243205845356
The generated pressure mean: 0.4280511438846588
loss_pred:0.019328517839312553, decouple_loss:0.0038182747084647417
Iteration: 5596, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448300838470459
loss_pred:0.02100110612809658, decouple_loss:0.0034122327342629433
The generated pressure mean: 0.4589517116546631
The generated pressure mean: 0.4548577070236206
loss_pred:0.018776575103402138, decouple_loss:0.003497917437925935
loss_pred:0.019843855872750282, decouple_loss:0.0034755149390548468
Iteration: 5597, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44882458448410034
loss_pred:0.020242635160684586, decouple_loss:0.003454311517998576
The generated pressure mean: 0.4542342722415924
loss_pred:0.018214793875813484, decouple_loss:0.003250340698286891
The generated pressure mean: 0.4538609981536865
loss_pred:0.020011741667985916, decouple_loss:0.0033241703640669584
Iteration: 5598, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4376260042190552
loss_pred:0.020071014761924744, decouple_loss:0.0034526416566222906
The generated pressure mean: 0.4339452087879181
loss_pred:0.02042018063366413, decouple_loss:0.003360183909535408
The generated pressure mean: 0.4429638683795929
loss_pred:0.020437510684132576, decouple_loss:0.003530181013047695
Iteration: 5599, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4456670880317688
loss_pred:0.019157640635967255, decouple_loss:0.0041513084433972836
The generated pressure mean: 0.4493429958820343
loss_pred:0.019074950367212296, decouple_loss:0.004062109161168337
The generated pressure mean: 0.4407796263694763
loss_pred:0.022713273763656616, decouple_loss:0.004100059624761343
Iteration: 5600, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452863335609436
loss_pred:0.02230553887784481, decouple_loss:0.004669034853577614
The generated pressure mean: 0.4488123953342438
loss_pred:0.020905928686261177, decouple_loss:0.004678583238273859
The generated pressure mean: 0.44314080476760864
loss_pred:0.020264573395252228, decouple_loss:0.0044251661747694016
2023-04-17 08:55:18 testing...
The generated pressure mean: 0.41497135162353516
The generated pressure mean: 0.4226285517215729
The generated pressure mean: 0.42497512698173523
loss_pred:0.03305797651410103, decouple_loss:0.004477089270949364
loss_pred:0.03177846968173981, decouple_loss:0.004604276269674301
loss_pred:0.03177201375365257, decouple_loss:0.00475264759734273
WV_0_PC_0_EH_1_PS_40, loss: 0.032433390617370605, avg_mse: 0.04730282351374626
current test mse: 0.047303
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 5601, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.439912348985672
loss_pred:0.020733539015054703, decouple_loss:0.003880606032907963
The generated pressure mean: 0.4442148506641388
loss_pred:0.020465491339564323, decouple_loss:0.003928517922759056
The generated pressure mean: 0.44388359785079956
loss_pred:0.018298450857400894, decouple_loss:0.003858436830341816
Iteration: 5602, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45844703912734985
loss_pred:0.020548125728964806, decouple_loss:0.003353027394041419The generated pressure mean: 0.4560961127281189
loss_pred:0.019877389073371887, decouple_loss:0.0034616217017173767
The generated pressure mean: 0.45704385638237
loss_pred:0.01954626478254795, decouple_loss:0.003357429290190339
Iteration: 5603, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45448821783065796
loss_pred:0.019724559038877487, decouple_loss:0.0032556101214140654
The generated pressure mean: 0.45105406641960144
loss_pred:0.01926896721124649, decouple_loss:0.003404720453545451
The generated pressure mean: 0.45209869742393494
loss_pred:0.019843077287077904, decouple_loss:0.003355825785547495
Iteration: 5604, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4392853379249573
loss_pred:0.022192196920514107, decouple_loss:0.003675880143418908
The generated pressure mean: 0.4343053996562958
loss_pred:0.019585544243454933, decouple_loss:0.0037952749989926815
The generated pressure mean: 0.43386077880859375
loss_pred:0.01926606334745884, decouple_loss:0.0035346681252121925
Iteration: 5605, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44122055172920227
loss_pred:0.02059447206556797, decouple_loss:0.004334295634180307
The generated pressure mean: 0.44625943899154663
loss_pred:0.019542915746569633, decouple_loss:0.004352805204689503
The generated pressure mean: 0.44487032294273376
loss_pred:0.018822934478521347, decouple_loss:0.004370668437331915
Iteration: 5606, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482516348361969
The generated pressure mean: 0.4554567337036133
loss_pred:0.02028694376349449, decouple_loss:0.003844481660053134
loss_pred:0.019744081422686577, decouple_loss:0.004081818740814924
The generated pressure mean: 0.45327720046043396
loss_pred:0.018979845568537712, decouple_loss:0.0038943435065448284
Iteration: 5607, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44999951124191284
The generated pressure mean: 0.453763872385025
loss_pred:0.02101246826350689, decouple_loss:0.0037096648011356592
loss_pred:0.01931944489479065, decouple_loss:0.0036762196104973555
The generated pressure mean: 0.4499936103820801
loss_pred:0.0209103524684906, decouple_loss:0.0038688231725245714
Iteration: 5608, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43355780839920044
loss_pred:0.018778247758746147, decouple_loss:0.0036610278766602278
The generated pressure mean: 0.43675336241722107
loss_pred:0.02028796821832657, decouple_loss:0.003537087934091687
The generated pressure mean: 0.4388856291770935
loss_pred:0.02035249024629593, decouple_loss:0.0035446255933493376
Iteration: 5609, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4512732923030853
loss_pred:0.02109660394489765, decouple_loss:0.003950626589357853
The generated pressure mean: 0.44252684712409973
loss_pred:0.020694905892014503, decouple_loss:0.004104634281247854
The generated pressure mean: 0.4499521553516388
loss_pred:0.018763231113553047, decouple_loss:0.0037638256326317787
Iteration: 5610, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4539933502674103
loss_pred:0.02190694771707058, decouple_loss:0.00425080768764019
The generated pressure mean: 0.4496229887008667
loss_pred:0.019658606499433517, decouple_loss:0.004347111564129591
The generated pressure mean: 0.45213061571121216
loss_pred:0.02326422743499279, decouple_loss:0.004459479358047247
2023-04-17 08:57:47 testing...
The generated pressure mean: 0.4165819585323334
The generated pressure mean: 0.42432165145874023
loss_pred:0.032041821628808975, decouple_loss:0.0044576856307685375
The generated pressure mean: 0.42708247900009155
loss_pred:0.03125004097819328, decouple_loss:0.0047390637919306755
loss_pred:0.030775019899010658, decouple_loss:0.004949548747390509
WV_0_PC_0_EH_1_PS_40, loss: 0.031591400504112244, avg_mse: 0.04555816575884819
current test mse: 0.045558
Iteration: 5611, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44089892506599426
loss_pred:0.018936825916171074, decouple_loss:0.004054255783557892
The generated pressure mean: 0.4409039318561554
loss_pred:0.022215135395526886, decouple_loss:0.004048672970384359
The generated pressure mean: 0.4408726692199707
loss_pred:0.019562331959605217, decouple_loss:0.004181250464171171
Iteration: 5612, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4529113471508026
loss_pred:0.01972663588821888, decouple_loss:0.004135735332965851
The generated pressure mean: 0.4491734206676483
loss_pred:0.01875138282775879, decouple_loss:0.004106801934540272
The generated pressure mean: 0.4523845613002777
loss_pred:0.018709508702158928, decouple_loss:0.004155654925853014
Iteration: 5613, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478051960468292
loss_pred:0.019896330311894417, decouple_loss:0.0049741934053599834
The generated pressure mean: 0.44848769903182983
loss_pred:0.019542379304766655, decouple_loss:0.005056509282439947
The generated pressure mean: 0.44843459129333496
loss_pred:0.020012902095913887, decouple_loss:0.005158586427569389
Iteration: 5614, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43819496035575867
loss_pred:0.021175744011998177, decouple_loss:0.004220583941787481
The generated pressure mean: 0.4412866234779358
loss_pred:0.02065623737871647, decouple_loss:0.0042199683375656605
The generated pressure mean: 0.43858030438423157
loss_pred:0.02047748677432537, decouple_loss:0.0041953194886446
Iteration: 5615, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505593776702881
loss_pred:0.020977267995476723, decouple_loss:0.004508221056312323
The generated pressure mean: 0.44843965768814087
loss_pred:0.019703250378370285, decouple_loss:0.004895288962870836
The generated pressure mean: 0.4519946575164795
loss_pred:0.020087050274014473, decouple_loss:0.004691470880061388
Iteration: 5616, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484729468822479
loss_pred:0.019085176289081573, decouple_loss:0.004309241659939289
The generated pressure mean: 0.4534177780151367
loss_pred:0.020097186788916588, decouple_loss:0.004216959234327078
The generated pressure mean: 0.45444774627685547
loss_pred:0.01948128268122673, decouple_loss:0.004286443814635277
Iteration: 5617, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4453122317790985
loss_pred:0.019955061376094818, decouple_loss:0.003580056596547365
The generated pressure mean: 0.4479924440383911
loss_pred:0.019697662442922592, decouple_loss:0.003527882508933544
The generated pressure mean: 0.4514417350292206
loss_pred:0.020054003223776817, decouple_loss:0.0036943601444363594
Iteration: 5618, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.441314697265625
loss_pred:0.018677402287721634, decouple_loss:0.004168026614934206
The generated pressure mean: 0.4430723190307617
loss_pred:0.020155631005764008, decouple_loss:0.004366246052086353
The generated pressure mean: 0.44478315114974976
loss_pred:0.019109230488538742, decouple_loss:0.004077750723809004
Iteration: 5619, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45010697841644287
The generated pressure mean: 0.45457184314727783
loss_pred:0.01940431259572506, decouple_loss:0.003978954162448645
loss_pred:0.022886358201503754, decouple_loss:0.003967454191297293
The generated pressure mean: 0.4500519633293152
loss_pred:0.02038942091166973, decouple_loss:0.003910749219357967
Iteration: 5620, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4421634078025818
The generated pressure mean: 0.4408677816390991
loss_pred:0.01847309246659279, decouple_loss:0.004273839760571718
loss_pred:0.019466392695903778, decouple_loss:0.004186738282442093
The generated pressure mean: 0.4382057785987854
loss_pred:0.020643141120672226, decouple_loss:0.004369966220110655
2023-04-17 08:59:41 testing...
The generated pressure mean: 0.4157261252403259
The generated pressure mean: 0.4238961338996887
The generated pressure mean: 0.42630845308303833
loss_pred:0.03442234918475151, decouple_loss:0.004294334910809994
loss_pred:0.03324137628078461, decouple_loss:0.00451879296451807loss_pred:0.03275226056575775, decouple_loss:0.004718163516372442
WV_0_PC_0_EH_1_PS_40, loss: 0.033697519451379776, avg_mse: 0.04992401972413063
current test mse: 0.049924
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 5621, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449772834777832
loss_pred:0.022252408787608147, decouple_loss:0.004086636006832123
The generated pressure mean: 0.4408828318119049
The generated pressure mean: 0.44538968801498413
loss_pred:0.02101041190326214, decouple_loss:0.004010139498859644
loss_pred:0.02177678421139717, decouple_loss:0.004221231676638126
Iteration: 5622, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490468502044678
The generated pressure mean: 0.4526938498020172
loss_pred:0.019320717081427574, decouple_loss:0.003938040230423212
loss_pred:0.02260647527873516, decouple_loss:0.004045457579195499
The generated pressure mean: 0.4493805170059204
loss_pred:0.02154211886227131, decouple_loss:0.0040557244792580605
Iteration: 5623, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488787353038788
The generated pressure mean: 0.4529143273830414
loss_pred:0.020872119814157486, decouple_loss:0.004043362569063902
loss_pred:0.021031206473708153, decouple_loss:0.003810124471783638
The generated pressure mean: 0.45414960384368896
loss_pred:0.022437382489442825, decouple_loss:0.0038440334610641003
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5624, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45328474044799805
The generated pressure mean: 0.4618425965309143loss_pred:0.02037588134407997, decouple_loss:0.0039236280135810375
loss_pred:0.020946074277162552, decouple_loss:0.00393645977601409
The generated pressure mean: 0.44856470823287964
loss_pred:0.01979070156812668, decouple_loss:0.003951601684093475
Iteration: 5625, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503538906574249
The generated pressure mean: 0.45455676317214966
loss_pred:0.021184124052524567, decouple_loss:0.004225466400384903
loss_pred:0.020174603909254074, decouple_loss:0.003999634180217981
The generated pressure mean: 0.45707982778549194
loss_pred:0.0198329146951437, decouple_loss:0.004256029613316059
Iteration: 5626, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44189393520355225
loss_pred:0.019572053104639053, decouple_loss:0.0034952068235725164
The generated pressure mean: 0.4378311038017273
loss_pred:0.021809404715895653, decouple_loss:0.0036851800978183746
The generated pressure mean: 0.44167521595954895
loss_pred:0.02108249068260193, decouple_loss:0.003571269800886512
Iteration: 5627, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447622150182724
The generated pressure mean: 0.4474228024482727
loss_pred:0.02106197364628315, decouple_loss:0.003689039032906294
loss_pred:0.021349472925066948, decouple_loss:0.0037816334515810013
The generated pressure mean: 0.4442810118198395
loss_pred:0.020405827090144157, decouple_loss:0.0038529078010469675
Iteration: 5628, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476388692855835
The generated pressure mean: 0.4463421106338501
loss_pred:0.020466109737753868, decouple_loss:0.003528399858623743
loss_pred:0.018797338008880615, decouple_loss:0.0035148400347679853
The generated pressure mean: 0.44570299983024597
loss_pred:0.020812837406992912, decouple_loss:0.0036669743712991476
Iteration: 5629, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45047512650489807
The generated pressure mean: 0.4444481134414673
loss_pred:0.02008911781013012, decouple_loss:0.0033114098478108644
loss_pred:0.020040523260831833, decouple_loss:0.003248051041737199
The generated pressure mean: 0.44870075583457947
loss_pred:0.020900949835777283, decouple_loss:0.0032812010031193495
Iteration: 5630, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45406827330589294
loss_pred:0.01986456662416458, decouple_loss:0.003996779210865498
The generated pressure mean: 0.4560961127281189
loss_pred:0.019745921716094017, decouple_loss:0.004096392076462507
The generated pressure mean: 0.45618805289268494
loss_pred:0.020270274952054024, decouple_loss:0.0038786991499364376
2023-04-17 09:02:13 testing...
The generated pressure mean: 0.4151524305343628
The generated pressure mean: 0.4227270483970642
loss_pred:0.03302742540836334, decouple_loss:0.00502801826223731
The generated pressure mean: 0.4253622591495514
loss_pred:0.031908463686704636, decouple_loss:0.0052917394787073135
loss_pred:0.031795796006917953, decouple_loss:0.005429329816251993
WV_0_PC_0_EH_1_PS_40, loss: 0.03250638395547867, avg_mse: 0.04743382707238197
current test mse: 0.047434
Iteration: 5631, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4435611367225647
loss_pred:0.022135108709335327, decouple_loss:0.004695787560194731
The generated pressure mean: 0.44910573959350586
loss_pred:0.019920190796256065, decouple_loss:0.004461150150746107
The generated pressure mean: 0.4457249045372009
loss_pred:0.02154223993420601, decouple_loss:0.0047173877246677876
Iteration: 5632, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4551369845867157
loss_pred:0.01906144805252552, decouple_loss:0.0036198764573782682
The generated pressure mean: 0.45614805817604065
loss_pred:0.02113855816423893, decouple_loss:0.0038418853655457497
The generated pressure mean: 0.4568256437778473
loss_pred:0.019282961264252663, decouple_loss:0.003579367883503437
Iteration: 5633, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485529363155365
loss_pred:0.01997377909719944, decouple_loss:0.0035988884046673775
The generated pressure mean: 0.44639670848846436
loss_pred:0.01933351159095764, decouple_loss:0.003784103784710169
The generated pressure mean: 0.44585543870925903
loss_pred:0.020284166559576988, decouple_loss:0.0037037041038274765
Iteration: 5634, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4386558532714844
loss_pred:0.023017484694719315, decouple_loss:0.0038820686750113964
The generated pressure mean: 0.4381833076477051
loss_pred:0.02275589480996132, decouple_loss:0.003999226726591587
The generated pressure mean: 0.43776169419288635
loss_pred:0.020375313237309456, decouple_loss:0.003817796939983964
Iteration: 5635, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4585077464580536
loss_pred:0.01883113570511341, decouple_loss:0.003747371258214116
The generated pressure mean: 0.45802828669548035
loss_pred:0.02041381224989891, decouple_loss:0.0037634370382875204
The generated pressure mean: 0.45843347907066345
loss_pred:0.021183257922530174, decouple_loss:0.003856113413348794
Iteration: 5636, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470098912715912
loss_pred:0.021335193887352943, decouple_loss:0.0032547793816775084
The generated pressure mean: 0.44530192017555237
The generated pressure mean: 0.4437233507633209
loss_pred:0.019723929464817047, decouple_loss:0.0033630668185651302
loss_pred:0.02017238177359104, decouple_loss:0.0033800641540437937
Iteration: 5637, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44618260860443115
loss_pred:0.02110089547932148, decouple_loss:0.0030354573391377926
The generated pressure mean: 0.44645917415618896
loss_pred:0.01924159750342369, decouple_loss:0.0028950627893209457
The generated pressure mean: 0.44666609168052673
loss_pred:0.018688101321458817, decouple_loss:0.002993587404489517
Iteration: 5638, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45049935579299927
loss_pred:0.019562378525733948, decouple_loss:0.0034931383561342955
The generated pressure mean: 0.4462123513221741
loss_pred:0.020891321823000908, decouple_loss:0.0033742720261216164
The generated pressure mean: 0.45612695813179016
loss_pred:0.0205776896327734, decouple_loss:0.0034241541288793087
Iteration: 5639, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499548375606537
The generated pressure mean: 0.4440351724624634
loss_pred:0.021165024489164352, decouple_loss:0.003502099309116602
loss_pred:0.019429022446274757, decouple_loss:0.0035878405906260014
The generated pressure mean: 0.44836264848709106
loss_pred:0.01956212893128395, decouple_loss:0.00352086266502738
Iteration: 5640, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4431474208831787
loss_pred:0.019779227674007416, decouple_loss:0.0031214028131216764
The generated pressure mean: 0.4416704475879669
loss_pred:0.019292348995804787, decouple_loss:0.0030499636195600033
The generated pressure mean: 0.44691842794418335
loss_pred:0.019613172858953476, decouple_loss:0.0030921532306820154
2023-04-17 09:04:07 testing...
The generated pressure mean: 0.41298946738243103
The generated pressure mean: 0.42042866349220276
The generated pressure mean: 0.4232906699180603
loss_pred:0.03325486183166504, decouple_loss:0.004125513602048159
loss_pred:0.031841814517974854, decouple_loss:0.004448962397873402
loss_pred:0.03170425817370415, decouple_loss:0.004606309346854687
WV_0_PC_0_EH_1_PS_40, loss: 0.03248665854334831, avg_mse: 0.04755404219031334
current test mse: 0.047554
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 5641, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45654308795928955
loss_pred:0.020215701311826706, decouple_loss:0.0035873998422175646
The generated pressure mean: 0.45284363627433777
loss_pred:0.02055930905044079, decouple_loss:0.003418641397729516
The generated pressure mean: 0.4560270607471466
loss_pred:0.02086734212934971, decouple_loss:0.0035050525330007076
Iteration: 5642, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44443759322166443
loss_pred:0.019601313397288322, decouple_loss:0.0033017441164702177
The generated pressure mean: 0.44603633880615234
loss_pred:0.02103515900671482, decouple_loss:0.0032729918602854013
The generated pressure mean: 0.4474930465221405
loss_pred:0.019466081634163857, decouple_loss:0.0032366912346333265
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5643, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43573155999183655
loss_pred:0.020336728543043137, decouple_loss:0.0036547526251524687
The generated pressure mean: 0.4329553544521332
loss_pred:0.01800430193543434, decouple_loss:0.003457397222518921
The generated pressure mean: 0.437906950712204
loss_pred:0.01888030208647251, decouple_loss:0.003455683123320341
Iteration: 5644, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44631609320640564
loss_pred:0.019976986572146416, decouple_loss:0.0032559663522988558
The generated pressure mean: 0.44804051518440247
loss_pred:0.01995820365846157, decouple_loss:0.0031288471072912216
The generated pressure mean: 0.44168198108673096
loss_pred:0.020619899034500122, decouple_loss:0.003232174087315798
Iteration: 5645, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45204341411590576
loss_pred:0.019648928195238113, decouple_loss:0.004077014047652483
The generated pressure mean: 0.45455166697502136
loss_pred:0.019991522654891014, decouple_loss:0.004209174774587154
The generated pressure mean: 0.45233866572380066
loss_pred:0.02114894613623619, decouple_loss:0.0040742335841059685
Iteration: 5646, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483681917190552
loss_pred:0.020639872178435326, decouple_loss:0.004221884999424219
The generated pressure mean: 0.44035330414772034
loss_pred:0.01955447345972061, decouple_loss:0.004094402771443129
The generated pressure mean: 0.4481634795665741
loss_pred:0.02192019671201706, decouple_loss:0.003953670617192984
Iteration: 5647, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44871094822883606
loss_pred:0.02042650245130062, decouple_loss:0.0035691026132553816
The generated pressure mean: 0.4485047459602356
loss_pred:0.02072099596261978, decouple_loss:0.0034920971374958754
The generated pressure mean: 0.448890745639801
loss_pred:0.019472412765026093, decouple_loss:0.003686596406623721
Iteration: 5648, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467797875404358
loss_pred:0.020029574632644653, decouple_loss:0.003517302218824625
The generated pressure mean: 0.4506607949733734
loss_pred:0.019574036821722984, decouple_loss:0.0033285021781921387
The generated pressure mean: 0.4449707567691803
loss_pred:0.02024880237877369, decouple_loss:0.0033421083353459835
Iteration: 5649, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43767961859703064
loss_pred:0.019146563485264778, decouple_loss:0.0031849113292992115
The generated pressure mean: 0.4389914274215698
loss_pred:0.022700170055031776, decouple_loss:0.0033488995395600796
The generated pressure mean: 0.4345073401927948
loss_pred:0.019108841195702553, decouple_loss:0.003117689397186041
Iteration: 5650, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4361630976200104
loss_pred:0.01983870565891266, decouple_loss:0.004098065197467804
The generated pressure mean: 0.44281744956970215
loss_pred:0.01917843334376812, decouple_loss:0.003701339475810528
The generated pressure mean: 0.4421829879283905
loss_pred:0.021073222160339355, decouple_loss:0.0038057747296988964
2023-04-17 09:06:35 testing...
The generated pressure mean: 0.4212363064289093
The generated pressure mean: 0.4122954308986664
The generated pressure mean: 0.4245529770851135
loss_pred:0.03210378810763359, decouple_loss:0.005641336087137461
loss_pred:0.03330494090914726, decouple_loss:0.00534001225605607
loss_pred:0.03194524720311165, decouple_loss:0.005743864923715591
WV_0_PC_0_EH_1_PS_40, loss: 0.03273008018732071, avg_mse: 0.048225246369838715
current test mse: 0.048225
Iteration: 5651, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45638349652290344
loss_pred:0.01990765705704689, decouple_loss:0.005023816600441933
The generated pressure mean: 0.4572758376598358
loss_pred:0.01824033446609974, decouple_loss:0.004607947543263435
The generated pressure mean: 0.4608024060726166
loss_pred:0.02019490674138069, decouple_loss:0.004869509022682905
Iteration: 5652, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4548153579235077
loss_pred:0.0202415119856596, decouple_loss:0.00328273419290781
The generated pressure mean: 0.45239993929862976
loss_pred:0.019218921661376953, decouple_loss:0.003213190473616123
The generated pressure mean: 0.4519851803779602
loss_pred:0.01960219442844391, decouple_loss:0.0032778203021734953
Iteration: 5653, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43831542134284973
loss_pred:0.0187830850481987, decouple_loss:0.003562543774023652
The generated pressure mean: 0.438883513212204
loss_pred:0.01978153921663761, decouple_loss:0.0034087048843503
The generated pressure mean: 0.43460527062416077
loss_pred:0.021695643663406372, decouple_loss:0.0037368270568549633
Iteration: 5654, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43851178884506226
loss_pred:0.019340386614203453, decouple_loss:0.004886757116764784
The generated pressure mean: 0.43415120244026184
loss_pred:0.02103731594979763, decouple_loss:0.004894263576716185
The generated pressure mean: 0.4367329180240631
loss_pred:0.01981233060359955, decouple_loss:0.004890472162514925
Iteration: 5655, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4568342864513397
loss_pred:0.019894400611519814, decouple_loss:0.0036745804827660322
The generated pressure mean: 0.4555003345012665
loss_pred:0.021701322868466377, decouple_loss:0.00399539340287447
The generated pressure mean: 0.4541682004928589
loss_pred:0.019259385764598846, decouple_loss:0.004091373644769192
Iteration: 5656, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492017328739166
loss_pred:0.020130516961216927, decouple_loss:0.0049256933853030205
The generated pressure mean: 0.44839170575141907
loss_pred:0.020825590938329697, decouple_loss:0.005239051766693592
The generated pressure mean: 0.45206528902053833
loss_pred:0.020383616909384727, decouple_loss:0.005064714699983597
Iteration: 5657, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43980562686920166
loss_pred:0.019333411008119583, decouple_loss:0.003519029589369893
The generated pressure mean: 0.4379303455352783
loss_pred:0.019369948655366898, decouple_loss:0.00351233989931643
The generated pressure mean: 0.4327673614025116
loss_pred:0.02101903408765793, decouple_loss:0.0034914829302579165
Iteration: 5658, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4446949064731598
loss_pred:0.022223806008696556, decouple_loss:0.00402826676145196
The generated pressure mean: 0.4449911415576935
loss_pred:0.01992763951420784, decouple_loss:0.004218596499413252
The generated pressure mean: 0.4435608983039856
loss_pred:0.018763288855552673, decouple_loss:0.004138760734349489
Iteration: 5659, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465610384941101
loss_pred:0.019578726962208748, decouple_loss:0.004517385270446539
The generated pressure mean: 0.44432714581489563
loss_pred:0.019825143739581108, decouple_loss:0.004478435032069683
The generated pressure mean: 0.44534966349601746
loss_pred:0.019775861874222755, decouple_loss:0.0045838067308068275
Iteration: 5660, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500201344490051
loss_pred:0.01940859481692314, decouple_loss:0.003840570105239749
The generated pressure mean: 0.44887518882751465
loss_pred:0.02069227769970894, decouple_loss:0.0036353804171085358
The generated pressure mean: 0.4543762803077698
loss_pred:0.01999008096754551, decouple_loss:0.0038719086442142725
2023-04-17 09:08:30 testing...
The generated pressure mean: 0.41494858264923096
The generated pressure mean: 0.4225790202617645
loss_pred:0.03235309571027756, decouple_loss:0.0042104572057724
The generated pressure mean: 0.4252244830131531
loss_pred:0.031293902546167374, decouple_loss:0.004498698282986879
loss_pred:0.03119306080043316, decouple_loss:0.004646611865609884
WV_0_PC_0_EH_1_PS_40, loss: 0.031835950911045074, avg_mse: 0.04659612104296684
current test mse: 0.046596
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 5661, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486784040927887
loss_pred:0.02061348780989647, decouple_loss:0.0038576393853873014
The generated pressure mean: 0.44615983963012695
loss_pred:0.019469156861305237, decouple_loss:0.004177871625870466
The generated pressure mean: 0.44987717270851135
loss_pred:0.01985262893140316, decouple_loss:0.0038386075757443905
Iteration: 5662, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4448290169239044
loss_pred:0.02110644429922104, decouple_loss:0.00398596003651619
The generated pressure mean: 0.4399409890174866
loss_pred:0.01878977194428444, decouple_loss:0.003893572138622403
The generated pressure mean: 0.4416792690753937
loss_pred:0.018964942544698715, decouple_loss:0.004012640565633774
Iteration: 5663, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4548114538192749
loss_pred:0.0183830875903368, decouple_loss:0.0030902603175491095
The generated pressure mean: 0.4505961239337921
loss_pred:0.020189546048641205, decouple_loss:0.0031815674155950546
The generated pressure mean: 0.45076316595077515
loss_pred:0.01901821978390217, decouple_loss:0.003115191590040922
Iteration: 5664, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475952684879303
loss_pred:0.020000627264380455, decouple_loss:0.004526365548372269
The generated pressure mean: 0.4495559334754944
loss_pred:0.019701268523931503, decouple_loss:0.004739485681056976
The generated pressure mean: 0.4452555477619171
loss_pred:0.018835030496120453, decouple_loss:0.004489518236368895
Iteration: 5665, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504188001155853
loss_pred:0.018424425274133682, decouple_loss:0.003479609964415431
The generated pressure mean: 0.45202353596687317
loss_pred:0.018840542063117027, decouple_loss:0.003478101221844554
The generated pressure mean: 0.45305147767066956
loss_pred:0.01941254362463951, decouple_loss:0.003593038534745574
Iteration: 5666, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4541754126548767
loss_pred:0.01855236291885376, decouple_loss:0.004052270669490099
The generated pressure mean: 0.4453052878379822
loss_pred:0.02112051285803318, decouple_loss:0.004285010974854231
The generated pressure mean: 0.45217451453208923
loss_pred:0.01805785857141018, decouple_loss:0.004084118641912937
Iteration: 5667, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4422205090522766
loss_pred:0.018995141610503197, decouple_loss:0.004398498684167862
The generated pressure mean: 0.4422372877597809
loss_pred:0.01925627700984478, decouple_loss:0.004322339314967394
The generated pressure mean: 0.44195011258125305
loss_pred:0.02035614103078842, decouple_loss:0.004445440601557493
Iteration: 5668, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449496865272522
loss_pred:0.018059225752949715, decouple_loss:0.004112591501325369
The generated pressure mean: 0.44619059562683105
loss_pred:0.019645199179649353, decouple_loss:0.004269923083484173
The generated pressure mean: 0.44823750853538513
loss_pred:0.019114486873149872, decouple_loss:0.004149682354182005
Iteration: 5669, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.452755868434906
loss_pred:0.01703268475830555, decouple_loss:0.003652552841231227
The generated pressure mean: 0.4499957859516144
loss_pred:0.020068394020199776, decouple_loss:0.003632939187809825
The generated pressure mean: 0.4550090730190277
loss_pred:0.020626921206712723, decouple_loss:0.0036984700709581375
Iteration: 5670, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4420771896839142
loss_pred:0.019301822409033775, decouple_loss:0.004530563019216061
The generated pressure mean: 0.44489404559135437
loss_pred:0.020262207835912704, decouple_loss:0.004577219020575285
The generated pressure mean: 0.4456937313079834
loss_pred:0.01983555220067501, decouple_loss:0.004548921249806881
2023-04-17 09:10:57 testing...
The generated pressure mean: 0.4145035147666931
The generated pressure mean: 0.42222875356674194
The generated pressure mean: 0.4246574342250824
loss_pred:0.032746318727731705, decouple_loss:0.004656702745705843
loss_pred:0.031497467309236526, decouple_loss:0.004888918716460466
loss_pred:0.03131383657455444, decouple_loss:0.004987136460840702
WV_0_PC_0_EH_1_PS_40, loss: 0.03209475427865982, avg_mse: 0.047168999910354614
current test mse: 0.047169
Iteration: 5671, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45037031173706055
loss_pred:0.018581625074148178, decouple_loss:0.003988233860582113
The generated pressure mean: 0.4562876224517822
loss_pred:0.01848527602851391, decouple_loss:0.004022921435534954
The generated pressure mean: 0.4442600607872009
loss_pred:0.01878226362168789, decouple_loss:0.0039872112683951855
Iteration: 5672, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44970113039016724
loss_pred:0.018998384475708008, decouple_loss:0.00552076380699873
The generated pressure mean: 0.4462498426437378
loss_pred:0.019035138189792633, decouple_loss:0.005562037695199251
The generated pressure mean: 0.4454878568649292
loss_pred:0.020237110555171967, decouple_loss:0.0056951818987727165
Iteration: 5673, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43729111552238464
loss_pred:0.017656495794653893, decouple_loss:0.003719132859259844
The generated pressure mean: 0.4398692548274994
loss_pred:0.019221490249037743, decouple_loss:0.0037601981312036514
The generated pressure mean: 0.4349563419818878
loss_pred:0.018636194989085197, decouple_loss:0.0035782689228653908
Iteration: 5674, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4584706425666809
loss_pred:0.018396954983472824, decouple_loss:0.004611601587384939
The generated pressure mean: 0.4586451053619385
loss_pred:0.018750209361314774, decouple_loss:0.0045381756499409676
The generated pressure mean: 0.46286073327064514
loss_pred:0.019392628222703934, decouple_loss:0.004892950877547264
Iteration: 5675, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4556484520435333
loss_pred:0.020081758499145508, decouple_loss:0.0035168530885130167
The generated pressure mean: 0.458858460187912
loss_pred:0.0176311656832695, decouple_loss:0.0034582705702632666
The generated pressure mean: 0.46102821826934814
loss_pred:0.020408865064382553, decouple_loss:0.0033806576393544674
Iteration: 5676, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.430122971534729
loss_pred:0.018069930374622345, decouple_loss:0.0045330217108130455
The generated pressure mean: 0.42333516478538513
loss_pred:0.018394140526652336, decouple_loss:0.004350792616605759
The generated pressure mean: 0.4297342598438263
loss_pred:0.019604522734880447, decouple_loss:0.0045072166249156
Iteration: 5677, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4426948130130768
loss_pred:0.01838197000324726, decouple_loss:0.0031812938395887613
The generated pressure mean: 0.4458756148815155
loss_pred:0.019225919619202614, decouple_loss:0.003272630739957094
The generated pressure mean: 0.44437065720558167
loss_pred:0.019777486100792885, decouple_loss:0.00332292215898633
Iteration: 5678, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46737003326416016
loss_pred:0.021304311230778694, decouple_loss:0.0037744950968772173
The generated pressure mean: 0.4669402837753296
loss_pred:0.018799448385834694, decouple_loss:0.00373087078332901
The generated pressure mean: 0.4659075438976288
loss_pred:0.019254939630627632, decouple_loss:0.0037710387259721756
Iteration: 5679, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469536542892456
loss_pred:0.019025489687919617, decouple_loss:0.003741329535841942
The generated pressure mean: 0.4524609446525574
loss_pred:0.019128207117319107, decouple_loss:0.0038185371086001396
The generated pressure mean: 0.44371140003204346
loss_pred:0.017860034480690956, decouple_loss:0.003823230043053627
Iteration: 5680, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4291311502456665
loss_pred:0.018779044970870018, decouple_loss:0.00380206061527133
The generated pressure mean: 0.4329814910888672
loss_pred:0.019557295367121696, decouple_loss:0.0036117376293987036
The generated pressure mean: 0.43031513690948486
loss_pred:0.0190103892236948, decouple_loss:0.0037470408715307713
2023-04-17 09:12:51 testing...
The generated pressure mean: 0.4190952777862549
The generated pressure mean: 0.4113486409187317
loss_pred:0.032850831747055054, decouple_loss:0.004495854023844004
The generated pressure mean: 0.4219890534877777
loss_pred:0.03409207984805107, decouple_loss:0.004366891458630562
loss_pred:0.03260939195752144, decouple_loss:0.004587594419717789
WV_0_PC_0_EH_1_PS_40, loss: 0.033408273011446, avg_mse: 0.04968688637018204
current test mse: 0.049687
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 5681, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4641973078250885
loss_pred:0.019355902448296547, decouple_loss:0.0034534879960119724
The generated pressure mean: 0.46180376410484314
loss_pred:0.01980656571686268, decouple_loss:0.003592104883864522
The generated pressure mean: 0.4639532268047333
loss_pred:0.019072484225034714, decouple_loss:0.0035081326495856047
Iteration: 5682, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4510017931461334
loss_pred:0.018723350018262863, decouple_loss:0.003463881090283394
The generated pressure mean: 0.4518815279006958
loss_pred:0.020775968208909035, decouple_loss:0.003572435351088643
The generated pressure mean: 0.4581979513168335
loss_pred:0.01900729537010193, decouple_loss:0.003477337071672082
Iteration: 5683, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43192246556282043
loss_pred:0.018968593329191208, decouple_loss:0.0040846820920705795
The generated pressure mean: 0.4347606897354126
loss_pred:0.020118501037359238, decouple_loss:0.003906678408384323
The generated pressure mean: 0.4388052523136139
loss_pred:0.019696570932865143, decouple_loss:0.003920470830053091
Iteration: 5684, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44346514344215393
loss_pred:0.018718743696808815, decouple_loss:0.0037924933712929487
The generated pressure mean: 0.43692106008529663
loss_pred:0.01991235837340355, decouple_loss:0.0037687041331082582
The generated pressure mean: 0.4457913637161255
loss_pred:0.02058238722383976, decouple_loss:0.003977228421717882
Iteration: 5685, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45686861872673035
The generated pressure mean: 0.4565099775791168
loss_pred:0.02073989063501358, decouple_loss:0.0033132515382021666
loss_pred:0.020660651847720146, decouple_loss:0.003296916140243411
The generated pressure mean: 0.45873749256134033
loss_pred:0.019330214709043503, decouple_loss:0.003208564128726721
Iteration: 5686, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44802889227867126
loss_pred:0.019410276785492897, decouple_loss:0.0037096356973052025
The generated pressure mean: 0.4569602310657501
loss_pred:0.019483918324112892, decouple_loss:0.003610381856560707
The generated pressure mean: 0.44701287150382996
loss_pred:0.021663984283804893, decouple_loss:0.0037630966398864985
Iteration: 5687, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43731802701950073
loss_pred:0.019450632855296135, decouple_loss:0.004145624116063118
The generated pressure mean: 0.44181811809539795
loss_pred:0.019640618935227394, decouple_loss:0.003856214927509427
The generated pressure mean: 0.44602638483047485
loss_pred:0.019810324534773827, decouple_loss:0.003875232534483075
Iteration: 5688, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44790905714035034
loss_pred:0.018713688477873802, decouple_loss:0.0032775572035461664
The generated pressure mean: 0.4453239142894745The generated pressure mean: 0.4457625150680542
loss_pred:0.019780559465289116, decouple_loss:0.0033509270288050175
loss_pred:0.019248267635703087, decouple_loss:0.0033536432310938835
Iteration: 5689, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45659616589546204
loss_pred:0.019266553223133087, decouple_loss:0.0033383811824023724
The generated pressure mean: 0.45001229643821716
loss_pred:0.019800687208771706, decouple_loss:0.003425958100706339
The generated pressure mean: 0.4482588469982147
loss_pred:0.019487397745251656, decouple_loss:0.0034010992385447025
Iteration: 5690, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45203515887260437
loss_pred:0.022980013862252235, decouple_loss:0.003597776172682643
The generated pressure mean: 0.4503476917743683
loss_pred:0.021127866581082344, decouple_loss:0.0033450021874159575
The generated pressure mean: 0.4456512928009033
loss_pred:0.019539760425686836, decouple_loss:0.003540338948369026
2023-04-17 09:15:20 testing...
The generated pressure mean: 0.41543614864349365
The generated pressure mean: 0.42356449365615845
loss_pred:0.032700203359127045, decouple_loss:0.004013683181256056
The generated pressure mean: 0.42630696296691895
loss_pred:0.031626444309949875, decouple_loss:0.004237885121256113
loss_pred:0.031485043466091156, decouple_loss:0.0043826838955283165
WV_0_PC_0_EH_1_PS_40, loss: 0.03214780241250992, avg_mse: 0.047093577682971954
current test mse: 0.047094
Iteration: 5691, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43511345982551575
loss_pred:0.020105192437767982, decouple_loss:0.003523182822391391
The generated pressure mean: 0.44807255268096924
loss_pred:0.021622806787490845, decouple_loss:0.003636348992586136
The generated pressure mean: 0.4454061686992645
loss_pred:0.019771263003349304, decouple_loss:0.0036802473478019238
Iteration: 5692, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45762285590171814
loss_pred:0.01997767761349678, decouple_loss:0.0036424899008125067
The generated pressure mean: 0.4457015097141266
loss_pred:0.02027055062353611, decouple_loss:0.0034483112394809723
The generated pressure mean: 0.45063140988349915
loss_pred:0.02015460468828678, decouple_loss:0.003312209155410528
Iteration: 5693, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4531111717224121
loss_pred:0.018669219687581062, decouple_loss:0.0033474531956017017
The generated pressure mean: 0.44238048791885376
loss_pred:0.019155962392687798, decouple_loss:0.0032849900890141726
The generated pressure mean: 0.4457550644874573
loss_pred:0.019250916317105293, decouple_loss:0.0033709018025547266
Iteration: 5694, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44517630338668823
loss_pred:0.019717713817954063, decouple_loss:0.0038522458635270596
The generated pressure mean: 0.448723703622818
loss_pred:0.018834812566637993, decouple_loss:0.003666333621367812
The generated pressure mean: 0.445825457572937
loss_pred:0.019050536677241325, decouple_loss:0.00384348863735795
Iteration: 5695, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45471271872520447
loss_pred:0.019820919260382652, decouple_loss:0.003468155860900879
The generated pressure mean: 0.45461609959602356
loss_pred:0.021495528519153595, decouple_loss:0.0034636883065104485
The generated pressure mean: 0.446322500705719
loss_pred:0.01980307698249817, decouple_loss:0.0034462481271475554
Iteration: 5696, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44692304730415344
loss_pred:0.019776135683059692, decouple_loss:0.0031356948893517256
The generated pressure mean: 0.4427574872970581
loss_pred:0.01895863190293312, decouple_loss:0.003186943009495735
The generated pressure mean: 0.44315826892852783
loss_pred:0.02179335616528988, decouple_loss:0.0032412661239504814
Iteration: 5697, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4562639594078064
loss_pred:0.019613787531852722, decouple_loss:0.004046204965561628
The generated pressure mean: 0.45147472620010376
loss_pred:0.01966922916471958, decouple_loss:0.004066800698637962
The generated pressure mean: 0.4527047276496887
loss_pred:0.019992202520370483, decouple_loss:0.003877110779285431
Iteration: 5698, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.442177951335907
loss_pred:0.019146641716361046, decouple_loss:0.0037580812349915504
The generated pressure mean: 0.44321465492248535
loss_pred:0.02022542804479599, decouple_loss:0.0038259883876889944
The generated pressure mean: 0.4412652850151062
loss_pred:0.020560365170240402, decouple_loss:0.0037435058038681746
Iteration: 5699, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4422886073589325
loss_pred:0.021580973640084267, decouple_loss:0.0033471216447651386
The generated pressure mean: 0.450564980506897
The generated pressure mean: 0.4391745924949646
loss_pred:0.020933181047439575, decouple_loss:0.003425243543460965
loss_pred:0.01977628841996193, decouple_loss:0.0034353623632341623
Iteration: 5700, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448184072971344
loss_pred:0.019064437597990036, decouple_loss:0.003146958304569125
The generated pressure mean: 0.4482850730419159
loss_pred:0.01961759477853775, decouple_loss:0.003153235651552677
The generated pressure mean: 0.4473046362400055
loss_pred:0.019319063052535057, decouple_loss:0.003152519464492798
2023-04-17 09:17:13 testing...
The generated pressure mean: 0.4195156991481781
The generated pressure mean: 0.41212791204452515
The generated pressure mean: 0.42199820280075073
loss_pred:0.03281973674893379, decouple_loss:0.004368591587990522
loss_pred:0.03407880291342735, decouple_loss:0.00423141336068511
loss_pred:0.032580140978097916, decouple_loss:0.00457202410325408
WV_0_PC_0_EH_1_PS_40, loss: 0.03337909281253815, avg_mse: 0.049209512770175934
current test mse: 0.04921
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 5701, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45851612091064453
loss_pred:0.018786786124110222, decouple_loss:0.0034226723946630955
The generated pressure mean: 0.45747265219688416
loss_pred:0.019990690052509308, decouple_loss:0.0035749771632254124
The generated pressure mean: 0.4574081599712372
loss_pred:0.018849004060029984, decouple_loss:0.003566344967111945
Iteration: 5702, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507409334182739
The generated pressure mean: 0.45054349303245544
loss_pred:0.019053541123867035, decouple_loss:0.0032568711321800947
loss_pred:0.01918070949614048, decouple_loss:0.003491485957056284
The generated pressure mean: 0.44377776980400085
loss_pred:0.01933910883963108, decouple_loss:0.003503047628328204
Iteration: 5703, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479175806045532
loss_pred:0.018753746524453163, decouple_loss:0.004092149902135134
The generated pressure mean: 0.445470929145813
loss_pred:0.019106652587652206, decouple_loss:0.004038465209305286
The generated pressure mean: 0.4408094584941864
loss_pred:0.018746541813015938, decouple_loss:0.00410577142611146
Iteration: 5704, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4390215575695038
loss_pred:0.01847052201628685, decouple_loss:0.0037745509762316942
The generated pressure mean: 0.4363498389720917
loss_pred:0.02267240360379219, decouple_loss:0.0038157859817147255
The generated pressure mean: 0.4389059841632843
loss_pred:0.02049967832863331, decouple_loss:0.004004052374511957
Iteration: 5705, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43753141164779663
The generated pressure mean: 0.4382829964160919
loss_pred:0.019776245579123497, decouple_loss:0.004322902299463749
loss_pred:0.0196639783680439, decouple_loss:0.0044520096853375435
The generated pressure mean: 0.4386564791202545
loss_pred:0.019417837262153625, decouple_loss:0.004114965442568064
Iteration: 5706, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45759183168411255
The generated pressure mean: 0.4607405960559845
loss_pred:0.019609225913882256, decouple_loss:0.0035989973694086075
loss_pred:0.019106587395071983, decouple_loss:0.003589290427044034
The generated pressure mean: 0.4600338041782379
loss_pred:0.018890349194407463, decouple_loss:0.003562726778909564
Iteration: 5707, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4524421989917755
The generated pressure mean: 0.45554792881011963loss_pred:0.01851675659418106, decouple_loss:0.004195760935544968
loss_pred:0.019006427377462387, decouple_loss:0.004528790712356567
The generated pressure mean: 0.45467135310173035
loss_pred:0.019238872453570366, decouple_loss:0.004528235178440809
Iteration: 5708, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489208459854126
loss_pred:0.019376227632164955, decouple_loss:0.003932807128876448
The generated pressure mean: 0.4437476396560669
loss_pred:0.017900848761200905, decouple_loss:0.0038907143753021955
The generated pressure mean: 0.4476851224899292
loss_pred:0.02041764184832573, decouple_loss:0.0038474295288324356
Iteration: 5709, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4300678074359894
loss_pred:0.019590912386775017, decouple_loss:0.003818234195932746
The generated pressure mean: 0.43677499890327454
loss_pred:0.020403102040290833, decouple_loss:0.003846977138891816
The generated pressure mean: 0.43057140707969666
loss_pred:0.019482705742120743, decouple_loss:0.0037731248885393143
Iteration: 5710, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495755136013031
loss_pred:0.018972555175423622, decouple_loss:0.004150419495999813
The generated pressure mean: 0.45224690437316895
loss_pred:0.01900714449584484, decouple_loss:0.004423179198056459
The generated pressure mean: 0.4487285017967224
loss_pred:0.01957450620830059, decouple_loss:0.004307279363274574
2023-04-17 09:19:55 testing...
The generated pressure mean: 0.41195911169052124
The generated pressure mean: 0.4194541275501251
The generated pressure mean: 0.421613872051239
loss_pred:0.0340917594730854, decouple_loss:0.004512866027653217
loss_pred:0.03261687234044075, decouple_loss:0.004706495441496372
loss_pred:0.03248909115791321, decouple_loss:0.004832109902054071
WV_0_PC_0_EH_1_PS_40, loss: 0.03330010175704956, avg_mse: 0.04920167475938797
current test mse: 0.049202
Iteration: 5711, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45186880230903625
loss_pred:0.019085967913269997, decouple_loss:0.0039007114246487617
The generated pressure mean: 0.4578512907028198
loss_pred:0.018718823790550232, decouple_loss:0.003979054745286703
The generated pressure mean: 0.4579273462295532
loss_pred:0.019397340714931488, decouple_loss:0.003926625940948725
Iteration: 5712, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4536733329296112
loss_pred:0.019402267411351204, decouple_loss:0.004079950973391533
The generated pressure mean: 0.45003756880760193
loss_pred:0.01871306262910366, decouple_loss:0.004220358561724424
The generated pressure mean: 0.444685161113739
loss_pred:0.019371146336197853, decouple_loss:0.00416429340839386
Iteration: 5713, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4376183748245239
loss_pred:0.018350888043642044, decouple_loss:0.004196392372250557
The generated pressure mean: 0.4411412477493286
loss_pred:0.019583968445658684, decouple_loss:0.004107061307877302
The generated pressure mean: 0.4442066550254822
loss_pred:0.019250160083174706, decouple_loss:0.0041118403896689415
Iteration: 5714, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44257500767707825
The generated pressure mean: 0.4446852505207062loss_pred:0.019207552075386047, decouple_loss:0.00382154225371778
loss_pred:0.019050991162657738, decouple_loss:0.0038452758453786373
The generated pressure mean: 0.44245487451553345
loss_pred:0.018221773207187653, decouple_loss:0.0037997865583747625
Iteration: 5715, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4521001875400543
The generated pressure mean: 0.4459887444972992
loss_pred:0.020466215908527374, decouple_loss:0.004134648479521275
loss_pred:0.017872480675578117, decouple_loss:0.00416460121050477
The generated pressure mean: 0.44763946533203125
loss_pred:0.018008913844823837, decouple_loss:0.004162547178566456
Iteration: 5716, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45438313484191895
The generated pressure mean: 0.45126572251319885
loss_pred:0.01997385174036026, decouple_loss:0.0038208949845284224
loss_pred:0.0193606186658144, decouple_loss:0.003929785918444395
The generated pressure mean: 0.45420461893081665
loss_pred:0.01785561628639698, decouple_loss:0.003671464743092656
Iteration: 5717, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479978680610657
loss_pred:0.01825890876352787, decouple_loss:0.004525589756667614
The generated pressure mean: 0.44240808486938477
loss_pred:0.019041769206523895, decouple_loss:0.004552691243588924
The generated pressure mean: 0.4460328221321106
loss_pred:0.020916571840643883, decouple_loss:0.004531899467110634
Iteration: 5718, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43607082962989807
loss_pred:0.01978958770632744, decouple_loss:0.0034440893214195967
The generated pressure mean: 0.44145628809928894
loss_pred:0.01885324716567993, decouple_loss:0.0033227261155843735
The generated pressure mean: 0.4343077540397644
loss_pred:0.019616955891251564, decouple_loss:0.00346489273943007
Iteration: 5719, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44891345500946045
loss_pred:0.01880062185227871, decouple_loss:0.004711486399173737
The generated pressure mean: 0.45079806447029114
loss_pred:0.01987561210989952, decouple_loss:0.004563702270388603
The generated pressure mean: 0.4499610960483551
loss_pred:0.01927802711725235, decouple_loss:0.004525546450167894
Iteration: 5720, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489484131336212
loss_pred:0.02022363618016243, decouple_loss:0.004328802227973938
The generated pressure mean: 0.45333924889564514
loss_pred:0.020874066278338432, decouple_loss:0.004386002663522959
The generated pressure mean: 0.450517475605011
loss_pred:0.020427796989679337, decouple_loss:0.004349542316049337
2023-04-17 09:21:48 testing...
The generated pressure mean: 0.41532349586486816
The generated pressure mean: 0.42336297035217285
loss_pred:0.03195275738835335, decouple_loss:0.004516203422099352
The generated pressure mean: 0.42606475949287415
loss_pred:0.03061566688120365, decouple_loss:0.00467640208080411
loss_pred:0.030523648485541344, decouple_loss:0.004836241248995066
WV_0_PC_0_EH_1_PS_40, loss: 0.03126450628042221, avg_mse: 0.04561772570014
current test mse: 0.045618
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 5721, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4335557520389557
loss_pred:0.019520854577422142, decouple_loss:0.004037976264953613
The generated pressure mean: 0.4413173198699951
loss_pred:0.018377071246504784, decouple_loss:0.004136946052312851
The generated pressure mean: 0.44530755281448364
loss_pred:0.018344972282648087, decouple_loss:0.004158277530223131
Iteration: 5722, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478912353515625
The generated pressure mean: 0.44524431228637695
loss_pred:0.020231330767273903, decouple_loss:0.004025813192129135
loss_pred:0.019607217982411385, decouple_loss:0.003997888416051865
The generated pressure mean: 0.44616132974624634
loss_pred:0.019642166793346405, decouple_loss:0.003991421777755022
Iteration: 5723, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44441643357276917
The generated pressure mean: 0.4407693147659302
loss_pred:0.018415043130517006, decouple_loss:0.0035536992363631725
loss_pred:0.01944386027753353, decouple_loss:0.0036507267504930496
The generated pressure mean: 0.4428670108318329
loss_pred:0.02106182649731636, decouple_loss:0.003521262900903821
Iteration: 5724, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.441699355840683
The generated pressure mean: 0.44004377722740173
loss_pred:0.02035951241850853, decouple_loss:0.0034443221520632505
loss_pred:0.019861852750182152, decouple_loss:0.0034993740264326334
The generated pressure mean: 0.43954718112945557
loss_pred:0.019843708723783493, decouple_loss:0.0034466141369193792
Iteration: 5725, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4527260661125183
loss_pred:0.01987403631210327, decouple_loss:0.0033444976434111595
The generated pressure mean: 0.45880886912345886
loss_pred:0.019682684913277626, decouple_loss:0.0031539397314190865
The generated pressure mean: 0.45285487174987793
loss_pred:0.020067574456334114, decouple_loss:0.003268251195549965
Iteration: 5726, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4424784183502197
The generated pressure mean: 0.44222503900527954
loss_pred:0.02009299397468567, decouple_loss:0.0035709573421627283
loss_pred:0.019024763256311417, decouple_loss:0.0035649272613227367
The generated pressure mean: 0.44785797595977783
loss_pred:0.01926065795123577, decouple_loss:0.003503150073811412
Iteration: 5727, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4421202838420868The generated pressure mean: 0.44342198967933655
loss_pred:0.018771793693304062, decouple_loss:0.004204621538519859
loss_pred:0.01875159703195095, decouple_loss:0.003979234956204891
The generated pressure mean: 0.44140395522117615
loss_pred:0.01992816850543022, decouple_loss:0.004078555852174759
Iteration: 5728, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44980522990226746
loss_pred:0.020355219021439552, decouple_loss:0.003214215161278844
The generated pressure mean: 0.4447861909866333
loss_pred:0.01953067258000374, decouple_loss:0.003314572386443615
The generated pressure mean: 0.4489193558692932
loss_pred:0.020053187385201454, decouple_loss:0.0029874949250370264
Iteration: 5729, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4396052658557892
loss_pred:0.019126417115330696, decouple_loss:0.0034072650596499443
The generated pressure mean: 0.43414223194122314
loss_pred:0.018797706812620163, decouple_loss:0.0034066836815327406
The generated pressure mean: 0.4395320415496826
loss_pred:0.019076868891716003, decouple_loss:0.0033791197929531336
Iteration: 5730, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4443624019622803
The generated pressure mean: 0.44973745942115784
loss_pred:0.021600401028990746, decouple_loss:0.0038434683810919523
loss_pred:0.018451744690537453, decouple_loss:0.003901314688846469
The generated pressure mean: 0.4500211775302887
loss_pred:0.020597757771611214, decouple_loss:0.003756787860766053
2023-04-17 09:24:31 testing...
The generated pressure mean: 0.4136364161968231
The generated pressure mean: 0.4216651916503906
The generated pressure mean: 0.42465266585350037
loss_pred:0.03388262540102005, decouple_loss:0.0041162436828017235
loss_pred:0.032822661101818085, decouple_loss:0.004294299054890871
loss_pred:0.03242771327495575, decouple_loss:0.0043881298042833805
WV_0_PC_0_EH_1_PS_40, loss: 0.03325764462351799, avg_mse: 0.04942727088928223
current test mse: 0.049427
Iteration: 5731, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44922754168510437
The generated pressure mean: 0.46210744976997375
loss_pred:0.01945418305695057, decouple_loss:0.0034538451582193375
loss_pred:0.019966818392276764, decouple_loss:0.003403759328648448
The generated pressure mean: 0.4514729082584381
loss_pred:0.019600920379161835, decouple_loss:0.0034525510855019093
Iteration: 5732, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4369668662548065
loss_pred:0.019474361091852188, decouple_loss:0.00330518651753664
The generated pressure mean: 0.4361811578273773
loss_pred:0.02066529169678688, decouple_loss:0.003085799515247345
The generated pressure mean: 0.43515801429748535
loss_pred:0.01999579556286335, decouple_loss:0.0030919755809009075
Iteration: 5733, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44149133563041687
The generated pressure mean: 0.445182740688324
loss_pred:0.018896659836173058, decouple_loss:0.0036098577547818422
loss_pred:0.018533460795879364, decouple_loss:0.003797445446252823
The generated pressure mean: 0.43615493178367615
loss_pred:0.01829621195793152, decouple_loss:0.0038535974454134703
Iteration: 5734, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45456281304359436
The generated pressure mean: 0.4513861835002899
loss_pred:0.020133240148425102, decouple_loss:0.00354013848118484
loss_pred:0.01846642605960369, decouple_loss:0.003462855936959386
The generated pressure mean: 0.45349541306495667
loss_pred:0.01934065856039524, decouple_loss:0.0036469423212110996
Iteration: 5735, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46049579977989197
The generated pressure mean: 0.46289828419685364
loss_pred:0.019201437011361122, decouple_loss:0.003730371128767729
loss_pred:0.0200263150036335, decouple_loss:0.003785793436691165
The generated pressure mean: 0.45155006647109985
loss_pred:0.019632995128631592, decouple_loss:0.0037200902588665485
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5736, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4327286183834076The generated pressure mean: 0.43411973118782043
loss_pred:0.01888829655945301, decouple_loss:0.004121353384107351
loss_pred:0.02148420736193657, decouple_loss:0.004298274405300617
The generated pressure mean: 0.42850765585899353
loss_pred:0.01896527409553528, decouple_loss:0.004167413804680109
Iteration: 5737, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466596245765686
The generated pressure mean: 0.44799867272377014
loss_pred:0.019642939791083336, decouple_loss:0.003350593848153949
loss_pred:0.019042007625102997, decouple_loss:0.003339190036058426
The generated pressure mean: 0.4435608983039856
loss_pred:0.019505487754940987, decouple_loss:0.0033942630980163813
Iteration: 5738, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45144522190093994
loss_pred:0.018216576427221298, decouple_loss:0.003823415841907263
The generated pressure mean: 0.45067939162254333
loss_pred:0.018267182633280754, decouple_loss:0.003734907368198037
The generated pressure mean: 0.4520828425884247
loss_pred:0.018043814226984978, decouple_loss:0.0039826794527471066
Iteration: 5739, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4445550739765167
The generated pressure mean: 0.4476725161075592
loss_pred:0.018755413591861725, decouple_loss:0.004602320957928896
loss_pred:0.018788831308484077, decouple_loss:0.004410862922668457
The generated pressure mean: 0.44287505745887756
loss_pred:0.020778559148311615, decouple_loss:0.004545529838651419
Iteration: 5740, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4409256875514984
loss_pred:0.01912744715809822, decouple_loss:0.0037304339930415154
The generated pressure mean: 0.44370725750923157
loss_pred:0.01898413710296154, decouple_loss:0.0037465994246304035
The generated pressure mean: 0.44471636414527893
loss_pred:0.018069155514240265, decouple_loss:0.0038162271957844496
2023-04-17 09:26:24 testing...
The generated pressure mean: 0.41261783242225647
The generated pressure mean: 0.42077335715293884
The generated pressure mean: 0.42324593663215637
loss_pred:0.0325896255671978, decouple_loss:0.005363182630389929
loss_pred:0.03165538236498833, decouple_loss:0.005589283537119627
loss_pred:0.03124469332396984, decouple_loss:0.005738439038395882
WV_0_PC_0_EH_1_PS_40, loss: 0.03210808336734772, avg_mse: 0.04726677015423775
current test mse: 0.047267
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 5741, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45601439476013184
loss_pred:0.01962730847299099, decouple_loss:0.004646832589060068
The generated pressure mean: 0.458706259727478
The generated pressure mean: 0.4551710784435272
loss_pred:0.018482403829693794, decouple_loss:0.0047300574369728565
loss_pred:0.02028326317667961, decouple_loss:0.004773091059178114
Iteration: 5742, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44292041659355164
The generated pressure mean: 0.44224587082862854
loss_pred:0.020203959196805954, decouple_loss:0.004053252749145031
loss_pred:0.021083978936076164, decouple_loss:0.0042230309918522835
The generated pressure mean: 0.443502277135849
loss_pred:0.018731368705630302, decouple_loss:0.004258931148797274
Iteration: 5743, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42264464497566223
loss_pred:0.020974289625883102, decouple_loss:0.004254726693034172
The generated pressure mean: 0.42291930317878723
loss_pred:0.018872441723942757, decouple_loss:0.004340712446719408
The generated pressure mean: 0.42608198523521423
loss_pred:0.020327091217041016, decouple_loss:0.00426208833232522
Iteration: 5744, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4564206004142761
The generated pressure mean: 0.45863354206085205
loss_pred:0.021234415471553802, decouple_loss:0.004565112758427858
loss_pred:0.02085902914404869, decouple_loss:0.0045734853483736515
The generated pressure mean: 0.45688945055007935
loss_pred:0.02149074338376522, decouple_loss:0.004618462175130844
Iteration: 5745, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486886262893677
The generated pressure mean: 0.44736698269844055
loss_pred:0.021672748029232025, decouple_loss:0.005297743249684572
loss_pred:0.01882884092628956, decouple_loss:0.005409734323620796
The generated pressure mean: 0.44446587562561035
loss_pred:0.021528145298361778, decouple_loss:0.005347537808120251
Iteration: 5746, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4543408751487732
The generated pressure mean: 0.455972284078598
loss_pred:0.01992720365524292, decouple_loss:0.0045155854895710945
loss_pred:0.019890133291482925, decouple_loss:0.004326995462179184
The generated pressure mean: 0.4549808204174042
loss_pred:0.02031572535634041, decouple_loss:0.004541852977126837
Iteration: 5747, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43937990069389343
The generated pressure mean: 0.44103118777275085
loss_pred:0.020407630130648613, decouple_loss:0.004327153787016869
loss_pred:0.02140558883547783, decouple_loss:0.004426428582519293
The generated pressure mean: 0.43992552161216736
loss_pred:0.019460106268525124, decouple_loss:0.004307297058403492
Iteration: 5748, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42835748195648193
loss_pred:0.019529609009623528, decouple_loss:0.004067849833518267
The generated pressure mean: 0.43015676736831665
loss_pred:0.021003754809498787, decouple_loss:0.004333400633186102
The generated pressure mean: 0.42632412910461426
loss_pred:0.01921452023088932, decouple_loss:0.004279869608581066
Iteration: 5749, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46008118987083435
The generated pressure mean: 0.45744839310646057
loss_pred:0.01880192942917347, decouple_loss:0.005674552172422409
loss_pred:0.01981513947248459, decouple_loss:0.005600688047707081
The generated pressure mean: 0.4614991545677185
loss_pred:0.020375045016407967, decouple_loss:0.0054324110969901085
Iteration: 5750, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4659592807292938
The generated pressure mean: 0.4661887288093567
loss_pred:0.02013910748064518, decouple_loss:0.004759771749377251
loss_pred:0.020468903705477715, decouple_loss:0.004511919803917408
The generated pressure mean: 0.46738898754119873
loss_pred:0.019754037261009216, decouple_loss:0.004465845879167318
2023-04-17 09:28:54 testing...
The generated pressure mean: 0.4162544310092926
The generated pressure mean: 0.42237457633018494
The generated pressure mean: 0.4251706600189209
loss_pred:0.032454147934913635, decouple_loss:0.0064926184713840485
loss_pred:0.03156907856464386, decouple_loss:0.006740021985024214
loss_pred:0.03144233301281929, decouple_loss:0.006894036661833525
WV_0_PC_0_EH_1_PS_40, loss: 0.0321572981774807, avg_mse: 0.04705432802438736
current test mse: 0.047054
Iteration: 5751, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4335789382457733
The generated pressure mean: 0.4365377128124237
loss_pred:0.01957310363650322, decouple_loss:0.0062313927337527275
loss_pred:0.019556941464543343, decouple_loss:0.00618637353181839
The generated pressure mean: 0.4319864511489868
loss_pred:0.020472858101129532, decouple_loss:0.006238287780433893
Iteration: 5752, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42933914065361023
The generated pressure mean: 0.42974767088890076
loss_pred:0.020252352580428123, decouple_loss:0.0052021462470293045
loss_pred:0.02171303890645504, decouple_loss:0.00539260683581233
The generated pressure mean: 0.4299445152282715
loss_pred:0.019822100177407265, decouple_loss:0.0053067896515131
Iteration: 5753, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45488473773002625
The generated pressure mean: 0.4589000642299652
loss_pred:0.0186757929623127, decouple_loss:0.006015994120389223
loss_pred:0.018571922555565834, decouple_loss:0.005899972748011351
The generated pressure mean: 0.46157342195510864
loss_pred:0.019870342686772346, decouple_loss:0.006084958557039499
Iteration: 5754, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46480968594551086
loss_pred:0.01875353790819645, decouple_loss:0.004261902533471584
The generated pressure mean: 0.45920541882514954
loss_pred:0.02106407657265663, decouple_loss:0.004274626262485981
The generated pressure mean: 0.4637092053890228
loss_pred:0.019744252786040306, decouple_loss:0.0041757067665457726
Iteration: 5755, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4284120798110962
loss_pred:0.019394250586628914, decouple_loss:0.005745705682784319
The generated pressure mean: 0.4281812012195587
loss_pred:0.020299628376960754, decouple_loss:0.0058955042622983456
The generated pressure mean: 0.430992990732193
loss_pred:0.019178295508027077, decouple_loss:0.005933602340519428
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5756, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4378313422203064
The generated pressure mean: 0.4353354275226593
loss_pred:0.0195505041629076, decouple_loss:0.0037258088123053312
loss_pred:0.01935534179210663, decouple_loss:0.00379516975954175
The generated pressure mean: 0.4385473430156708
loss_pred:0.019867120310664177, decouple_loss:0.003731058444827795
Iteration: 5757, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4559275805950165
The generated pressure mean: 0.45427873730659485
loss_pred:0.019473619759082794, decouple_loss:0.005778911057859659
loss_pred:0.019947240129113197, decouple_loss:0.005799845792353153
The generated pressure mean: 0.45833009481430054
loss_pred:0.019646253436803818, decouple_loss:0.005782297812402248
Iteration: 5758, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4573154151439667
loss_pred:0.019868331030011177, decouple_loss:0.00392420869320631
The generated pressure mean: 0.4538966119289398
loss_pred:0.020205991342663765, decouple_loss:0.003896338166669011
The generated pressure mean: 0.45300549268722534
loss_pred:0.019780373200774193, decouple_loss:0.003964581061154604
Iteration: 5759, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462698698043823
The generated pressure mean: 0.4452762305736542
loss_pred:0.019463827833533287, decouple_loss:0.0064377631060779095
loss_pred:0.018459629267454147, decouple_loss:0.006458438467234373
The generated pressure mean: 0.447320818901062
loss_pred:0.01992778107523918, decouple_loss:0.006420176941901445
Iteration: 5760, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43964239954948425
The generated pressure mean: 0.44337987899780273
loss_pred:0.018560728058218956, decouple_loss:0.0036749904975295067
loss_pred:0.02055593952536583, decouple_loss:0.003812251379713416
The generated pressure mean: 0.4442928433418274
loss_pred:0.019074639305472374, decouple_loss:0.0036864522844552994
2023-04-17 09:30:47 testing...
The generated pressure mean: 0.4231833517551422
The generated pressure mean: 0.4150293469429016
The generated pressure mean: 0.42615807056427
loss_pred:0.03252997249364853, decouple_loss:0.008022388443350792
loss_pred:0.03350966051220894, decouple_loss:0.007652346044778824
loss_pred:0.03250781446695328, decouple_loss:0.008137606084346771
WV_0_PC_0_EH_1_PS_40, loss: 0.03324602171778679, avg_mse: 0.049525726586580276
current test mse: 0.049526
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 5761, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44341349601745605
loss_pred:0.019221866503357887, decouple_loss:0.0068027423694729805
The generated pressure mean: 0.4409210979938507
loss_pred:0.019259212538599968, decouple_loss:0.006481655407696962
The generated pressure mean: 0.4398309886455536
loss_pred:0.0192880816757679, decouple_loss:0.006571234203875065
Iteration: 5762, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45161107182502747
The generated pressure mean: 0.44715484976768494
loss_pred:0.018726710230112076, decouple_loss:0.003865557024255395
loss_pred:0.019752144813537598, decouple_loss:0.003849347122013569
The generated pressure mean: 0.4510709047317505
loss_pred:0.019995301961898804, decouple_loss:0.003855929709970951
Iteration: 5763, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495126008987427
loss_pred:0.01874055154621601, decouple_loss:0.004961684346199036
The generated pressure mean: 0.45206335186958313
loss_pred:0.018867390230298042, decouple_loss:0.005042875651270151
The generated pressure mean: 0.44802355766296387
loss_pred:0.018671512603759766, decouple_loss:0.005257154814898968
Iteration: 5764, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44926559925079346
loss_pred:0.019517727196216583, decouple_loss:0.005432864185422659
The generated pressure mean: 0.4387507140636444
loss_pred:0.019698066636919975, decouple_loss:0.005511575378477573
The generated pressure mean: 0.44462987780570984
loss_pred:0.01967007853090763, decouple_loss:0.005510877817869186
Iteration: 5765, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44596582651138306
loss_pred:0.021362537518143654, decouple_loss:0.00420472351834178
The generated pressure mean: 0.44460591673851013
loss_pred:0.01940203830599785, decouple_loss:0.004258720204234123
The generated pressure mean: 0.4437641203403473
loss_pred:0.018428806215524673, decouple_loss:0.0041173603385686874
Iteration: 5766, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44367220997810364
loss_pred:0.019985634833574295, decouple_loss:0.005264772102236748
The generated pressure mean: 0.4471803605556488
loss_pred:0.018457861617207527, decouple_loss:0.005343226715922356
The generated pressure mean: 0.445502370595932
loss_pred:0.02139672264456749, decouple_loss:0.005249970126897097
Iteration: 5767, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501657783985138
loss_pred:0.020127464085817337, decouple_loss:0.004621010273694992
The generated pressure mean: 0.4451822340488434
loss_pred:0.01875046268105507, decouple_loss:0.004641320556402206
The generated pressure mean: 0.4423123598098755
loss_pred:0.019200844690203667, decouple_loss:0.00473241601139307
Iteration: 5768, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491961598396301
loss_pred:0.01933918707072735, decouple_loss:0.003376263426616788
The generated pressure mean: 0.44969695806503296
loss_pred:0.01967240497469902, decouple_loss:0.0033620765898376703
The generated pressure mean: 0.44463062286376953
loss_pred:0.019510677084326744, decouple_loss:0.0034261548426002264
Iteration: 5769, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44582104682922363
The generated pressure mean: 0.44904446601867676
loss_pred:0.018338525667786598, decouple_loss:0.003954736515879631
loss_pred:0.018078159540891647, decouple_loss:0.00372273288667202
The generated pressure mean: 0.4451865255832672
loss_pred:0.019469507038593292, decouple_loss:0.0038506786804646254
Iteration: 5770, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485011696815491
The generated pressure mean: 0.4479381740093231loss_pred:0.019782086834311485, decouple_loss:0.003202649299055338
loss_pred:0.01928873546421528, decouple_loss:0.003298751078546047
The generated pressure mean: 0.44462889432907104
loss_pred:0.019260184839367867, decouple_loss:0.003299090778455138
2023-04-17 09:33:24 testing...
The generated pressure mean: 0.4139418601989746
The generated pressure mean: 0.4217817187309265
The generated pressure mean: 0.42492347955703735
loss_pred:0.03365983068943024, decouple_loss:0.003858371404930949
loss_pred:0.03232641518115997, decouple_loss:0.0042290231212973595
loss_pred:0.03199025243520737, decouple_loss:0.004404464736580849
WV_0_PC_0_EH_1_PS_40, loss: 0.032867029309272766, avg_mse: 0.04858231917023659
current test mse: 0.048582
Iteration: 5771, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44740405678749084
loss_pred:0.018837520852684975, decouple_loss:0.00297338655218482
The generated pressure mean: 0.4481271207332611
loss_pred:0.02004573866724968, decouple_loss:0.0031614366453140974
The generated pressure mean: 0.4454454183578491
loss_pred:0.020923834294080734, decouple_loss:0.0031051209662109613
Iteration: 5772, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4455393850803375
The generated pressure mean: 0.44908657670021057
loss_pred:0.019555795937776566, decouple_loss:0.0031418760772794485
loss_pred:0.018407316878437996, decouple_loss:0.0031300242990255356
The generated pressure mean: 0.44646549224853516
loss_pred:0.019679613411426544, decouple_loss:0.0031518840696662664
Iteration: 5773, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44484052062034607
loss_pred:0.01947212591767311, decouple_loss:0.002894109347835183
The generated pressure mean: 0.4385644197463989
loss_pred:0.01962311752140522, decouple_loss:0.002876035636290908
The generated pressure mean: 0.44132187962532043
loss_pred:0.01850508153438568, decouple_loss:0.0029759223107248545
Iteration: 5774, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4396323561668396
The generated pressure mean: 0.43932873010635376
loss_pred:0.019717680290341377, decouple_loss:0.0033195659052580595
loss_pred:0.019665196537971497, decouple_loss:0.0033294649329036474
The generated pressure mean: 0.4405513107776642
loss_pred:0.01891137659549713, decouple_loss:0.0033212853595614433
Iteration: 5775, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45102718472480774
The generated pressure mean: 0.45254597067832947
loss_pred:0.018965013325214386, decouple_loss:0.0030320545192807913
loss_pred:0.019024815410375595, decouple_loss:0.0032034616451710463
The generated pressure mean: 0.4499962329864502
loss_pred:0.018914442509412766, decouple_loss:0.0030724050011485815
Iteration: 5776, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45938560366630554
The generated pressure mean: 0.4586319029331207
loss_pred:0.01876930333673954, decouple_loss:0.003346121171489358
loss_pred:0.018520371988415718, decouple_loss:0.0033990051597356796
The generated pressure mean: 0.45337727665901184
loss_pred:0.023856397718191147, decouple_loss:0.0034412576351314783
Iteration: 5777, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43263405561447144
loss_pred:0.019864747300744057, decouple_loss:0.003672753693535924
The generated pressure mean: 0.4344346821308136
loss_pred:0.018795568495988846, decouple_loss:0.003483642591163516
The generated pressure mean: 0.4369630813598633
loss_pred:0.018538139760494232, decouple_loss:0.0035727047361433506
Iteration: 5778, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43982604146003723
The generated pressure mean: 0.4389892816543579
loss_pred:0.01942305825650692, decouple_loss:0.0034932540729641914
loss_pred:0.019203685224056244, decouple_loss:0.0034336599055677652
The generated pressure mean: 0.44022247195243835
loss_pred:0.019055474549531937, decouple_loss:0.0031823781318962574
Iteration: 5779, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4543682038784027
loss_pred:0.01845403015613556, decouple_loss:0.0030756983906030655
The generated pressure mean: 0.45270833373069763
loss_pred:0.018001191318035126, decouple_loss:0.0029558944515883923
The generated pressure mean: 0.45011693239212036
loss_pred:0.01960582286119461, decouple_loss:0.003080794122070074
Iteration: 5780, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4516315162181854
The generated pressure mean: 0.4544520080089569
loss_pred:0.01840895228087902, decouple_loss:0.00293431943282485
loss_pred:0.018485700711607933, decouple_loss:0.002864860463887453
The generated pressure mean: 0.4559987783432007
loss_pred:0.019213084131479263, decouple_loss:0.0028155529871582985
2023-04-17 09:35:18 testing...
The generated pressure mean: 0.4142264127731323
The generated pressure mean: 0.4207315146923065
The generated pressure mean: 0.4237247109413147
loss_pred:0.033628303557634354, decouple_loss:0.0035508822184056044
loss_pred:0.03273652493953705, decouple_loss:0.003900847164914012
loss_pred:0.032755304127931595, decouple_loss:0.004005225375294685
WV_0_PC_0_EH_1_PS_40, loss: 0.033230993896722794, avg_mse: 0.04919268935918808
current test mse: 0.049193
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 5781, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4514841139316559
loss_pred:0.01984700746834278, decouple_loss:0.0031538372859358788
The generated pressure mean: 0.4434413015842438
loss_pred:0.020028118044137955, decouple_loss:0.0030982065945863724
The generated pressure mean: 0.44720131158828735
loss_pred:0.019493350759148598, decouple_loss:0.00310818781144917
Iteration: 5782, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4445165991783142
The generated pressure mean: 0.44249072670936584
loss_pred:0.019273066893219948, decouple_loss:0.0036846690345555544
loss_pred:0.023233236744999886, decouple_loss:0.0038030529394745827
The generated pressure mean: 0.44253119826316833
loss_pred:0.018722396343946457, decouple_loss:0.0037553850561380386
Iteration: 5783, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4341343939304352
The generated pressure mean: 0.4341070055961609
loss_pred:0.0190996453166008, decouple_loss:0.005763857625424862
loss_pred:0.021093741059303284, decouple_loss:0.005637819413095713
The generated pressure mean: 0.434772253036499
loss_pred:0.02093564346432686, decouple_loss:0.005670445971190929
Iteration: 5784, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44810357689857483
loss_pred:0.018384989351034164, decouple_loss:0.0038081337697803974
The generated pressure mean: 0.44728556275367737
loss_pred:0.01957903429865837, decouple_loss:0.003606955287978053
The generated pressure mean: 0.4516066014766693
loss_pred:0.018899744376540184, decouple_loss:0.0036227251403033733
Iteration: 5785, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45690447092056274
loss_pred:0.021601727232336998, decouple_loss:0.005400104448199272
The generated pressure mean: 0.45795008540153503
loss_pred:0.019932519644498825, decouple_loss:0.0053540910594165325
The generated pressure mean: 0.4582241475582123
loss_pred:0.018937012180685997, decouple_loss:0.005161919165402651
Iteration: 5786, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4430495798587799
loss_pred:0.01902039535343647, decouple_loss:0.004247970879077911
The generated pressure mean: 0.44584131240844727
loss_pred:0.01988298073410988, decouple_loss:0.004585673101246357
The generated pressure mean: 0.44249746203422546
loss_pred:0.019661668688058853, decouple_loss:0.004431207664310932
Iteration: 5787, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4415419101715088
loss_pred:0.019947661086916924, decouple_loss:0.004045003093779087
The generated pressure mean: 0.44179436564445496
loss_pred:0.02066858857870102, decouple_loss:0.004033680073916912
The generated pressure mean: 0.4444720447063446
loss_pred:0.0195881649851799, decouple_loss:0.004021348897367716
Iteration: 5788, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4445541799068451
loss_pred:0.01807805709540844, decouple_loss:0.005400173831731081
The generated pressure mean: 0.44949159026145935
loss_pred:0.019345592707395554, decouple_loss:0.005454761907458305
The generated pressure mean: 0.44843414425849915
loss_pred:0.020019201561808586, decouple_loss:0.00543101504445076
Iteration: 5789, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477732479572296
The generated pressure mean: 0.44741225242614746
loss_pred:0.02001882717013359, decouple_loss:0.0038705067709088326
loss_pred:0.022318484261631966, decouple_loss:0.00389523571357131
The generated pressure mean: 0.4491068422794342
loss_pred:0.021145012229681015, decouple_loss:0.003895227797329426
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5790, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4526946246623993
loss_pred:0.018397120758891106, decouple_loss:0.0037965881638228893
The generated pressure mean: 0.4542686343193054
loss_pred:0.018764520063996315, decouple_loss:0.0039030946791172028
The generated pressure mean: 0.45466649532318115
loss_pred:0.020454153418540955, decouple_loss:0.003958593122661114
2023-04-17 09:37:58 testing...
The generated pressure mean: 0.4146961271762848
The generated pressure mean: 0.4218258857727051
The generated pressure mean: 0.42496752738952637
loss_pred:0.03348243609070778, decouple_loss:0.0047387657687067986
loss_pred:0.03210299462080002, decouple_loss:0.005016405135393143
loss_pred:0.03205081820487976, decouple_loss:0.005075688473880291
WV_0_PC_0_EH_1_PS_40, loss: 0.0327925980091095, avg_mse: 0.048549529165029526
current test mse: 0.04855
Iteration: 5791, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4435102045536041
The generated pressure mean: 0.4400131404399872loss_pred:0.021266158670186996, decouple_loss:0.004040106665343046
loss_pred:0.0198490172624588, decouple_loss:0.004048597067594528
The generated pressure mean: 0.43970465660095215
loss_pred:0.018537446856498718, decouple_loss:0.004146719817072153
Iteration: 5792, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4381893575191498
The generated pressure mean: 0.43626856803894043
loss_pred:0.02007647417485714, decouple_loss:0.003576074494048953
loss_pred:0.020242566242814064, decouple_loss:0.0033740701619535685
The generated pressure mean: 0.44137606024742126
loss_pred:0.020256394520401955, decouple_loss:0.003381524235010147
Iteration: 5793, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45492079854011536
loss_pred:0.01820582151412964, decouple_loss:0.003778006648644805
The generated pressure mean: 0.457158625125885
loss_pred:0.01810801587998867, decouple_loss:0.0036756014451384544
The generated pressure mean: 0.45273420214653015
loss_pred:0.01991281472146511, decouple_loss:0.003644257318228483
Iteration: 5794, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500465989112854
The generated pressure mean: 0.45194414258003235
loss_pred:0.018834618851542473, decouple_loss:0.003671357873827219
loss_pred:0.0204327292740345, decouple_loss:0.003644737647846341
The generated pressure mean: 0.4552285671234131
loss_pred:0.02007652260363102, decouple_loss:0.0036835777573287487
Iteration: 5795, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484488368034363
The generated pressure mean: 0.44854339957237244loss_pred:0.018763501197099686, decouple_loss:0.0032417585607618093
loss_pred:0.019199371337890625, decouple_loss:0.0032310530077666044
The generated pressure mean: 0.44211310148239136
loss_pred:0.01898566447198391, decouple_loss:0.003318889532238245
Iteration: 5796, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4450233578681946
loss_pred:0.019632181152701378, decouple_loss:0.00377466413192451
The generated pressure mean: 0.43837040662765503
loss_pred:0.018354641273617744, decouple_loss:0.003597521921619773
The generated pressure mean: 0.44226524233818054
loss_pred:0.018611012026667595, decouple_loss:0.0036742882803082466
Iteration: 5797, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44572532176971436
loss_pred:0.020574431866407394, decouple_loss:0.0035204635933041573
The generated pressure mean: 0.4491775631904602
loss_pred:0.018243519589304924, decouple_loss:0.003714177757501602
The generated pressure mean: 0.4491642117500305
loss_pred:0.018033180385828018, decouple_loss:0.0035831709392368793
Iteration: 5798, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44751983880996704
The generated pressure mean: 0.4477355480194092
loss_pred:0.018360188230872154, decouple_loss:0.0031951696146279573
loss_pred:0.01920916885137558, decouple_loss:0.0032093925401568413
The generated pressure mean: 0.44804665446281433
loss_pred:0.019585663452744484, decouple_loss:0.0033561433665454388
Iteration: 5799, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4518955647945404
The generated pressure mean: 0.44809284806251526
loss_pred:0.018952181562781334, decouple_loss:0.003225266234949231
loss_pred:0.019182782620191574, decouple_loss:0.0032100784592330456
The generated pressure mean: 0.44525688886642456
loss_pred:0.021358944475650787, decouple_loss:0.00334999174810946
Iteration: 5800, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45135506987571716
The generated pressure mean: 0.44702351093292236
loss_pred:0.018303342163562775, decouple_loss:0.0038681060541421175
loss_pred:0.020082971081137657, decouple_loss:0.0037934414576739073
The generated pressure mean: 0.45147567987442017
loss_pred:0.02001718431711197, decouple_loss:0.0037400636356323957
2023-04-17 09:39:52 testing...
The generated pressure mean: 0.41560783982276917
The generated pressure mean: 0.42367318272590637
The generated pressure mean: 0.42670154571533203
loss_pred:0.031564753502607346, decouple_loss:0.004288030322641134
loss_pred:0.03055286593735218, decouple_loss:0.004582410678267479
loss_pred:0.02997681125998497, decouple_loss:0.004817851819097996
WV_0_PC_0_EH_1_PS_40, loss: 0.030926283448934555, avg_mse: 0.045217812061309814
current test mse: 0.045218
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 5801, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4401228427886963
loss_pred:0.01882633939385414, decouple_loss:0.003826744854450226
The generated pressure mean: 0.43972378969192505
loss_pred:0.020130235701799393, decouple_loss:0.003551659407094121
The generated pressure mean: 0.438675194978714
loss_pred:0.020969130098819733, decouple_loss:0.003651403822004795
Iteration: 5802, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4413713216781616
The generated pressure mean: 0.45154544711112976
loss_pred:0.018534010276198387, decouple_loss:0.0032314711716026068
loss_pred:0.018085181713104248, decouple_loss:0.003131058532744646
The generated pressure mean: 0.4476456642150879
loss_pred:0.0187384020537138, decouple_loss:0.0029906148556619883
Iteration: 5803, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4535887837409973
The generated pressure mean: 0.4594508707523346
loss_pred:0.019307022914290428, decouple_loss:0.00364519446156919
loss_pred:0.018586596474051476, decouple_loss:0.0036229491233825684
The generated pressure mean: 0.45893409848213196
loss_pred:0.0199568048119545, decouple_loss:0.0035907200071960688
Iteration: 5804, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4439736604690552
The generated pressure mean: 0.4440014362335205
loss_pred:0.0194809902459383, decouple_loss:0.004377321340143681
loss_pred:0.019848303869366646, decouple_loss:0.0044907801784574986
The generated pressure mean: 0.44669610261917114
loss_pred:0.01993446610867977, decouple_loss:0.0042653135024011135
Iteration: 5805, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43329620361328125
The generated pressure mean: 0.4377354383468628
loss_pred:0.019903115928173065, decouple_loss:0.0038180039264261723
loss_pred:0.020239397883415222, decouple_loss:0.0038652888033539057
The generated pressure mean: 0.43817976117134094
loss_pred:0.02042643167078495, decouple_loss:0.0039607766084373
Iteration: 5806, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45776987075805664
The generated pressure mean: 0.45587217807769775
loss_pred:0.01865248754620552, decouple_loss:0.0037462045438587666
loss_pred:0.018853088840842247, decouple_loss:0.0037939983885735273
The generated pressure mean: 0.45230337977409363
loss_pred:0.01925024762749672, decouple_loss:0.0038453678134828806
Iteration: 5807, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45314136147499084
The generated pressure mean: 0.4576393961906433
loss_pred:0.020146062597632408, decouple_loss:0.0036582211032509804
loss_pred:0.01864962838590145, decouple_loss:0.003822251921519637
The generated pressure mean: 0.45446670055389404
loss_pred:0.018008138984441757, decouple_loss:0.0034564384259283543
Iteration: 5808, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4368606507778168
The generated pressure mean: 0.4389548897743225
loss_pred:0.018723029643297195, decouple_loss:0.003341811243444681
loss_pred:0.019223812967538834, decouple_loss:0.003266373183578253
The generated pressure mean: 0.434663861989975
loss_pred:0.018950294703245163, decouple_loss:0.0033977569546550512
Iteration: 5809, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44377124309539795
The generated pressure mean: 0.45219138264656067loss_pred:0.01977802813053131, decouple_loss:0.003249825444072485
loss_pred:0.018890466541051865, decouple_loss:0.0031736979726701975
The generated pressure mean: 0.4489050805568695
loss_pred:0.01757180131971836, decouple_loss:0.003062864998355508
Iteration: 5810, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45721033215522766
loss_pred:0.019493060186505318, decouple_loss:0.0028931889683008194
The generated pressure mean: 0.45680996775627136
loss_pred:0.0202686358243227, decouple_loss:0.002827166812494397
The generated pressure mean: 0.45082005858421326
loss_pred:0.019614065065979958, decouple_loss:0.0028790293727070093
2023-04-17 09:42:24 testing...
The generated pressure mean: 0.4156911075115204
The generated pressure mean: 0.42395058274269104
The generated pressure mean: 0.4265376031398773
loss_pred:0.031975653022527695, decouple_loss:0.00374296260997653
loss_pred:0.030751217156648636, decouple_loss:0.003919343464076519
loss_pred:0.030666906386613846, decouple_loss:0.004094994161278009
WV_0_PC_0_EH_1_PS_40, loss: 0.03132721781730652, avg_mse: 0.04580990597605705
current test mse: 0.04581
Iteration: 5811, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44463905692100525
The generated pressure mean: 0.44404634833335876
loss_pred:0.021425820887088776, decouple_loss:0.0030312363523989916
loss_pred:0.018808947876095772, decouple_loss:0.0030168727971613407
The generated pressure mean: 0.4439142644405365
loss_pred:0.020305544137954712, decouple_loss:0.0031141447834670544
Iteration: 5812, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4421543776988983
The generated pressure mean: 0.4443287253379822
loss_pred:0.01935034617781639, decouple_loss:0.0030308167915791273
loss_pred:0.019838925451040268, decouple_loss:0.002868966432288289
The generated pressure mean: 0.44544991850852966
loss_pred:0.020063534379005432, decouple_loss:0.002999488264322281
Iteration: 5813, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489419162273407
The generated pressure mean: 0.44066905975341797
loss_pred:0.019600514322519302, decouple_loss:0.003917013294994831
loss_pred:0.018520455807447433, decouple_loss:0.003907380625605583
The generated pressure mean: 0.44386377930641174
loss_pred:0.01957445777952671, decouple_loss:0.0038923092652112246
Iteration: 5814, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45600658655166626
The generated pressure mean: 0.46173954010009766
loss_pred:0.020002730190753937, decouple_loss:0.003398737171664834
loss_pred:0.019098350778222084, decouple_loss:0.003384378971531987
The generated pressure mean: 0.4590141773223877
loss_pred:0.018964499235153198, decouple_loss:0.0032994479406625032
Iteration: 5815, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4518769383430481
The generated pressure mean: 0.44722050428390503
loss_pred:0.019756684079766273, decouple_loss:0.003165439236909151
loss_pred:0.02021629363298416, decouple_loss:0.0030530921649187803
The generated pressure mean: 0.4503752291202545
loss_pred:0.020295696333050728, decouple_loss:0.0030804439447820187
Iteration: 5816, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4381439685821533
loss_pred:0.02101311832666397, decouple_loss:0.0032324986532330513
The generated pressure mean: 0.43976327776908875
loss_pred:0.019202494993805885, decouple_loss:0.0032539779786020517
The generated pressure mean: 0.44111889600753784
loss_pred:0.018927648663520813, decouple_loss:0.0031424483750015497
Iteration: 5817, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4436909556388855
loss_pred:0.020277200266718864, decouple_loss:0.003767589805647731
The generated pressure mean: 0.45195692777633667
loss_pred:0.018802259117364883, decouple_loss:0.00381278689019382
The generated pressure mean: 0.44992056488990784
loss_pred:0.020357774570584297, decouple_loss:0.0038434856105595827
Iteration: 5818, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4415605068206787
loss_pred:0.021942870691418648, decouple_loss:0.0034937781747430563
The generated pressure mean: 0.44556981325149536
The generated pressure mean: 0.44332972168922424
loss_pred:0.01812172122299671, decouple_loss:0.003262666752561927
loss_pred:0.01904914155602455, decouple_loss:0.003378619672730565
Iteration: 5819, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468144476413727
loss_pred:0.019447406753897667, decouple_loss:0.0032777702435851097
The generated pressure mean: 0.44477638602256775
The generated pressure mean: 0.44331735372543335loss_pred:0.01944441720843315, decouple_loss:0.003586196107789874
loss_pred:0.019638797268271446, decouple_loss:0.0032845877576619387
Iteration: 5820, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45575839281082153
loss_pred:0.019963860511779785, decouple_loss:0.003114496124908328
The generated pressure mean: 0.45363637804985046
loss_pred:0.019510293379426003, decouple_loss:0.003038577502593398
The generated pressure mean: 0.4533120393753052
loss_pred:0.018488112837076187, decouple_loss:0.0032065068371593952
2023-04-17 09:44:17 testing...
The generated pressure mean: 0.413472443819046
The generated pressure mean: 0.4215473234653473
The generated pressure mean: 0.42456015944480896
loss_pred:0.03355894982814789, decouple_loss:0.003981061279773712
loss_pred:0.03274872899055481, decouple_loss:0.004150428343564272
loss_pred:0.03258112072944641, decouple_loss:0.004336874466389418
WV_0_PC_0_EH_1_PS_40, loss: 0.03317074105143547, avg_mse: 0.04948938265442848
current test mse: 0.049489
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 5821, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467953145503998
loss_pred:0.018559467047452927, decouple_loss:0.00343687878921628
The generated pressure mean: 0.45282843708992004
loss_pred:0.018643155694007874, decouple_loss:0.0033580223098397255
The generated pressure mean: 0.45263439416885376
loss_pred:0.02071784995496273, decouple_loss:0.003414271865040064
Iteration: 5822, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4363575875759125
The generated pressure mean: 0.4351101815700531
loss_pred:0.018927382305264473, decouple_loss:0.0032095264177769423
loss_pred:0.01909412257373333, decouple_loss:0.003391253761947155
The generated pressure mean: 0.43411386013031006
loss_pred:0.01784364879131317, decouple_loss:0.0032752726692706347
Iteration: 5823, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4444604218006134
loss_pred:0.020222168415784836, decouple_loss:0.0030394094064831734
The generated pressure mean: 0.43923094868659973
loss_pred:0.019433103501796722, decouple_loss:0.0032676844857633114
The generated pressure mean: 0.44276854395866394
loss_pred:0.019566191360354424, decouple_loss:0.00303840939886868
Iteration: 5824, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4527634382247925
The generated pressure mean: 0.4582916498184204
loss_pred:0.019696537405252457, decouple_loss:0.0036592555698007345
loss_pred:0.02030668966472149, decouple_loss:0.0038740027230232954
The generated pressure mean: 0.45623672008514404
loss_pred:0.017926905304193497, decouple_loss:0.003979590721428394
Iteration: 5825, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4445279538631439
The generated pressure mean: 0.4452126920223236
loss_pred:0.019764622673392296, decouple_loss:0.0035609754268079996
loss_pred:0.018538568168878555, decouple_loss:0.0035077447537332773
The generated pressure mean: 0.4454173743724823
loss_pred:0.01979709602892399, decouple_loss:0.0037027120124548674
Iteration: 5826, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.437038779258728
loss_pred:0.018702777102589607, decouple_loss:0.0031057957094162703
The generated pressure mean: 0.43871554732322693
loss_pred:0.018707511946558952, decouple_loss:0.0033182145562022924
The generated pressure mean: 0.44147175550460815
loss_pred:0.01859096996486187, decouple_loss:0.003112228587269783
Iteration: 5827, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44923266768455505
The generated pressure mean: 0.4529779255390167
loss_pred:0.018612908199429512, decouple_loss:0.003091659164056182
loss_pred:0.018767129629850388, decouple_loss:0.0029559640679508448
The generated pressure mean: 0.45192858576774597
loss_pred:0.016706308349967003, decouple_loss:0.002919413149356842
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5828, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4521638751029968
loss_pred:0.01917182095348835, decouple_loss:0.003723623463883996
The generated pressure mean: 0.44885119795799255
loss_pred:0.019603876397013664, decouple_loss:0.003687425283715129
The generated pressure mean: 0.44597333669662476
loss_pred:0.01972820796072483, decouple_loss:0.003796153236180544
Iteration: 5829, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4358249306678772
The generated pressure mean: 0.44388532638549805
loss_pred:0.01804729364812374, decouple_loss:0.0033324810210615396
loss_pred:0.01859370246529579, decouple_loss:0.0032049077562987804
The generated pressure mean: 0.445588082075119
loss_pred:0.01888299733400345, decouple_loss:0.0033189989626407623
Iteration: 5830, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45227813720703125
loss_pred:0.018946317955851555, decouple_loss:0.002627813257277012
The generated pressure mean: 0.4468599557876587
loss_pred:0.0202745720744133, decouple_loss:0.0025003990158438683
The generated pressure mean: 0.4454541504383087
loss_pred:0.018178945407271385, decouple_loss:0.002513989806175232
2023-04-17 09:46:44 testing...
The generated pressure mean: 0.415162056684494
The generated pressure mean: 0.42255982756614685
loss_pred:0.03176369145512581, decouple_loss:0.0037884805351495743
The generated pressure mean: 0.4252621829509735
loss_pred:0.03059941530227661, decouple_loss:0.0040157269686460495
loss_pred:0.03043312206864357, decouple_loss:0.004147653933614492
WV_0_PC_0_EH_1_PS_40, loss: 0.03113127499818802, avg_mse: 0.045410893857479095
current test mse: 0.045411
Iteration: 5831, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44334274530410767
loss_pred:0.020162256434559822, decouple_loss:0.0029836404137313366
The generated pressure mean: 0.43787041306495667
loss_pred:0.01786532811820507, decouple_loss:0.0030773791950196028
The generated pressure mean: 0.4452613890171051
loss_pred:0.019706398248672485, decouple_loss:0.0030362962279468775
Iteration: 5832, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45151078701019287
loss_pred:0.01970488205552101, decouple_loss:0.0032056011259555817
The generated pressure mean: 0.4480385482311249
loss_pred:0.022061660885810852, decouple_loss:0.003356357803568244
The generated pressure mean: 0.4491797387599945
loss_pred:0.019306432455778122, decouple_loss:0.0033641343470662832
Iteration: 5833, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4419788420200348
loss_pred:0.01917443796992302, decouple_loss:0.0026503554545342922
The generated pressure mean: 0.4435921609401703
loss_pred:0.018264107406139374, decouple_loss:0.0026338647585362196
The generated pressure mean: 0.43831905722618103
loss_pred:0.01871165819466114, decouple_loss:0.002655669115483761
Iteration: 5834, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452163875102997
loss_pred:0.017943713814020157, decouple_loss:0.002846465678885579
The generated pressure mean: 0.44758132100105286
loss_pred:0.01929028518497944, decouple_loss:0.002914439421147108
The generated pressure mean: 0.4440993666648865
loss_pred:0.018213383853435516, decouple_loss:0.002892702352255583
Iteration: 5835, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44698140025138855
loss_pred:0.0178840272128582, decouple_loss:0.004360643215477467
The generated pressure mean: 0.45298999547958374
loss_pred:0.019187718629837036, decouple_loss:0.004350310657173395
The generated pressure mean: 0.45206865668296814
loss_pred:0.018745044246315956, decouple_loss:0.004414692521095276
Iteration: 5836, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44439324736595154
loss_pred:0.01851029321551323, decouple_loss:0.00291989604011178
The generated pressure mean: 0.4469509422779083
loss_pred:0.019175255671143532, decouple_loss:0.002944644307717681
The generated pressure mean: 0.446323961019516
loss_pred:0.018401440232992172, decouple_loss:0.002932980190962553
Iteration: 5837, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500441253185272
loss_pred:0.019045080989599228, decouple_loss:0.004574064631015062
The generated pressure mean: 0.44602999091148376
loss_pred:0.018192457035183907, decouple_loss:0.0045374128967523575
The generated pressure mean: 0.4528680741786957
loss_pred:0.018520519137382507, decouple_loss:0.004685194697231054
Iteration: 5838, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4362989068031311
loss_pred:0.018444187939167023, decouple_loss:0.0034357879776507616
The generated pressure mean: 0.4359733760356903
loss_pred:0.01750561222434044, decouple_loss:0.0034820837900042534
The generated pressure mean: 0.43755656480789185
loss_pred:0.020499039441347122, decouple_loss:0.0033716775942593813
Iteration: 5839, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4422110617160797
loss_pred:0.018735909834504128, decouple_loss:0.0030130823142826557
The generated pressure mean: 0.44699618220329285
loss_pred:0.01981789991259575, decouple_loss:0.003068330232053995
The generated pressure mean: 0.4450058043003082
loss_pred:0.01952013000845909, decouple_loss:0.003165653208270669
Iteration: 5840, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44816720485687256
The generated pressure mean: 0.45815932750701904
loss_pred:0.02043631114065647, decouple_loss:0.004013052210211754
loss_pred:0.01857576332986355, decouple_loss:0.003839411772787571
The generated pressure mean: 0.4500798285007477
loss_pred:0.01993756927549839, decouple_loss:0.003846399951726198
2023-04-17 09:48:38 testing...
The generated pressure mean: 0.41269949078559875
The generated pressure mean: 0.4204382002353668
The generated pressure mean: 0.4229111671447754
loss_pred:0.032270397990942, decouple_loss:0.0047977459616959095
loss_pred:0.031012430787086487, decouple_loss:0.005048496648669243
loss_pred:0.030709726735949516, decouple_loss:0.005189693532884121
WV_0_PC_0_EH_1_PS_40, loss: 0.03158145397901535, avg_mse: 0.046453218907117844
current test mse: 0.046453
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 5841, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505700469017029
loss_pred:0.019159262999892235, decouple_loss:0.00444253021851182
The generated pressure mean: 0.4515582323074341
loss_pred:0.02026502974331379, decouple_loss:0.0042017302475869656
The generated pressure mean: 0.44793030619621277
loss_pred:0.018029076978564262, decouple_loss:0.004247759934514761
Iteration: 5842, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4379624128341675
The generated pressure mean: 0.4409239590167999
loss_pred:0.01980840414762497, decouple_loss:0.0031510626431554556
loss_pred:0.01883929967880249, decouple_loss:0.0030307674314826727
The generated pressure mean: 0.43796083331108093
loss_pred:0.019951123744249344, decouple_loss:0.0031573607120662928
Iteration: 5843, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44928860664367676
loss_pred:0.019067350775003433, decouple_loss:0.0034642128739506006
The generated pressure mean: 0.44513076543807983
loss_pred:0.018463551998138428, decouple_loss:0.0034912556875497103
The generated pressure mean: 0.4514888823032379
loss_pred:0.020718896761536598, decouple_loss:0.0035918676294386387
Iteration: 5844, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45179277658462524
The generated pressure mean: 0.45025235414505005
loss_pred:0.01838667318224907, decouple_loss:0.004094487521797419
loss_pred:0.017955487594008446, decouple_loss:0.004062360618263483
The generated pressure mean: 0.44789740443229675
loss_pred:0.018531648442149162, decouple_loss:0.004090694710612297
Iteration: 5845, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466942548751831
The generated pressure mean: 0.4499908983707428
loss_pred:0.01868549734354019, decouple_loss:0.003977340646088123
loss_pred:0.01871555857360363, decouple_loss:0.0038875548634678125
The generated pressure mean: 0.44137701392173767
loss_pred:0.017670301720499992, decouple_loss:0.003896228037774563
Iteration: 5846, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45012879371643066
The generated pressure mean: 0.4542601406574249
loss_pred:0.019935568794608116, decouple_loss:0.004552021156996489
loss_pred:0.017994936555624008, decouple_loss:0.004461486358195543
The generated pressure mean: 0.45061996579170227
loss_pred:0.01852104626595974, decouple_loss:0.004411919973790646
Iteration: 5847, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4330662488937378
The generated pressure mean: 0.4359738230705261
loss_pred:0.018862932920455933, decouple_loss:0.0032033531460911036
loss_pred:0.01944785751402378, decouple_loss:0.0033708696719259024
The generated pressure mean: 0.4394579231739044
loss_pred:0.018821215257048607, decouple_loss:0.0032516098581254482
Iteration: 5848, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44160544872283936
loss_pred:0.017580419778823853, decouple_loss:0.0030482003930956125
The generated pressure mean: 0.4485902488231659
loss_pred:0.01979488506913185, decouple_loss:0.0030475487001240253
The generated pressure mean: 0.44250255823135376
loss_pred:0.01938951015472412, decouple_loss:0.0031325435265898705
Iteration: 5849, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4587101936340332
The generated pressure mean: 0.46158525347709656
loss_pred:0.019170302897691727, decouple_loss:0.003392586251720786
loss_pred:0.01759965345263481, decouple_loss:0.003627522150054574
The generated pressure mean: 0.46192803978919983
loss_pred:0.018077638000249863, decouple_loss:0.003361897775903344
Iteration: 5850, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44784948229789734
loss_pred:0.019119447097182274, decouple_loss:0.0038928664289414883
The generated pressure mean: 0.4470841586589813
loss_pred:0.0193942803889513, decouple_loss:0.0038041826337575912
The generated pressure mean: 0.44907239079475403
loss_pred:0.01908515766263008, decouple_loss:0.003760599298402667
2023-04-17 09:51:06 testing...
The generated pressure mean: 0.41559985280036926
The generated pressure mean: 0.42342889308929443
loss_pred:0.03197779878973961, decouple_loss:0.0034401859156787395
The generated pressure mean: 0.42589321732521057
loss_pred:0.03080652840435505, decouple_loss:0.0037525834050029516
loss_pred:0.030371379107236862, decouple_loss:0.003953223116695881
WV_0_PC_0_EH_1_PS_40, loss: 0.031237667426466942, avg_mse: 0.046021126210689545
current test mse: 0.046021
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5851, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.439426988363266
loss_pred:0.017785754054784775, decouple_loss:0.002547903684899211
The generated pressure mean: 0.4387246370315552
loss_pred:0.019291352480649948, decouple_loss:0.0026858909986913204
The generated pressure mean: 0.4383564889431
loss_pred:0.018602831289172173, decouple_loss:0.0025423860643059015
Iteration: 5852, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44525209069252014
loss_pred:0.017345037311315536, decouple_loss:0.004194842651486397
The generated pressure mean: 0.4497925341129303
loss_pred:0.018938476219773293, decouple_loss:0.004038336221128702
The generated pressure mean: 0.44386541843414307
loss_pred:0.018502989783883095, decouple_loss:0.003837637370452285
Iteration: 5853, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44895729422569275
loss_pred:0.019188962876796722, decouple_loss:0.0031424211338162422
The generated pressure mean: 0.4495655298233032
loss_pred:0.019852707162499428, decouple_loss:0.003233526600524783
The generated pressure mean: 0.4516613781452179
loss_pred:0.019578199833631516, decouple_loss:0.00323476642370224
Iteration: 5854, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4542514383792877
loss_pred:0.018154462799429893, decouple_loss:0.003404370741918683
The generated pressure mean: 0.45296093821525574
loss_pred:0.019868701696395874, decouple_loss:0.0033954312093555927
The generated pressure mean: 0.4503762125968933
loss_pred:0.018410949036478996, decouple_loss:0.0033142559695988894
Iteration: 5855, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45103195309638977
loss_pred:0.01869085803627968, decouple_loss:0.003703477792441845
The generated pressure mean: 0.4423447549343109
loss_pred:0.01875448040664196, decouple_loss:0.0037085942458361387
The generated pressure mean: 0.44504985213279724
loss_pred:0.018650775775313377, decouple_loss:0.003599071642383933
Iteration: 5856, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.439022034406662
loss_pred:0.01934300735592842, decouple_loss:0.0027324233669787645
The generated pressure mean: 0.44106778502464294
loss_pred:0.02105546183884144, decouple_loss:0.00301801017485559
The generated pressure mean: 0.4376281499862671
loss_pred:0.019699089229106903, decouple_loss:0.00294152251444757
Iteration: 5857, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44225630164146423
loss_pred:0.02003643475472927, decouple_loss:0.0038075712509453297
The generated pressure mean: 0.4415992796421051
loss_pred:0.018144506961107254, decouple_loss:0.00423997500911355
The generated pressure mean: 0.44525542855262756
loss_pred:0.018779920414090157, decouple_loss:0.004021004308015108
Iteration: 5858, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44810789823532104
loss_pred:0.01888229511678219, decouple_loss:0.0034737626556307077
The generated pressure mean: 0.4486818015575409
loss_pred:0.01999046467244625, decouple_loss:0.003376859240233898
The generated pressure mean: 0.44993507862091064
loss_pred:0.01845415309071541, decouple_loss:0.0033746380358934402
Iteration: 5859, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44720423221588135
loss_pred:0.019498147070407867, decouple_loss:0.0037183950189501047
The generated pressure mean: 0.4439873993396759
loss_pred:0.018390076234936714, decouple_loss:0.003626229241490364
The generated pressure mean: 0.4483067989349365
loss_pred:0.021685929968953133, decouple_loss:0.0037985327653586864
Iteration: 5860, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45315805077552795
loss_pred:0.019275596365332603, decouple_loss:0.003059886861592531
The generated pressure mean: 0.45577719807624817
loss_pred:0.017163708806037903, decouple_loss:0.0031541173812001944
The generated pressure mean: 0.45167192816734314
loss_pred:0.019101127982139587, decouple_loss:0.0031831422820687294
2023-04-17 09:52:58 testing...
The generated pressure mean: 0.41371020674705505
The generated pressure mean: 0.421424001455307
loss_pred:0.03178538754582405, decouple_loss:0.00432243850082159
The generated pressure mean: 0.42384445667266846
loss_pred:0.030637985095381737, decouple_loss:0.0045255571603775024
loss_pred:0.030384238809347153, decouple_loss:0.00472941854968667
WV_0_PC_0_EH_1_PS_40, loss: 0.031162161380052567, avg_mse: 0.04539389908313751
current test mse: 0.045394
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5861, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466892182826996
loss_pred:0.01876169443130493, decouple_loss:0.0035398865584284067
The generated pressure mean: 0.44718602299690247
loss_pred:0.01849665679037571, decouple_loss:0.0035287518985569477
The generated pressure mean: 0.4474274814128876
loss_pred:0.019228873774409294, decouple_loss:0.0035078353248536587
Iteration: 5862, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4339478313922882
loss_pred:0.018615620210766792, decouple_loss:0.004630491603165865
The generated pressure mean: 0.43686893582344055
loss_pred:0.02173272706568241, decouple_loss:0.004283647984266281
The generated pressure mean: 0.43719351291656494
loss_pred:0.01996300183236599, decouple_loss:0.004139658063650131
Iteration: 5863, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44850897789001465
loss_pred:0.01990165375173092, decouple_loss:0.0036414761561900377
The generated pressure mean: 0.44975343346595764
loss_pred:0.019062627106904984, decouple_loss:0.0035996728111058474
The generated pressure mean: 0.4439140260219574
loss_pred:0.019422460347414017, decouple_loss:0.0038352333940565586
Iteration: 5864, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492051899433136
loss_pred:0.019217338413000107, decouple_loss:0.003446906106546521
The generated pressure mean: 0.45091140270233154
loss_pred:0.020419079810380936, decouple_loss:0.00346210110001266
The generated pressure mean: 0.45938050746917725
loss_pred:0.024289453402161598, decouple_loss:0.003496768418699503
Iteration: 5865, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4267670810222626
loss_pred:0.019231827929615974, decouple_loss:0.003443678840994835
The generated pressure mean: 0.4256248474121094
loss_pred:0.019825289025902748, decouple_loss:0.0036479562986642122
The generated pressure mean: 0.4221254289150238
loss_pred:0.019760042428970337, decouple_loss:0.0035346809308975935
Iteration: 5866, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500771462917328
loss_pred:0.019555633887648582, decouple_loss:0.004111250396817923
The generated pressure mean: 0.4484734535217285
loss_pred:0.02131594531238079, decouple_loss:0.00411200849339366
The generated pressure mean: 0.44513168931007385
loss_pred:0.019948234781622887, decouple_loss:0.004029678180813789
Iteration: 5867, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4547489881515503
The generated pressure mean: 0.46677273511886597
loss_pred:0.018450843170285225, decouple_loss:0.0037765123415738344
loss_pred:0.019736273214221, decouple_loss:0.003876259783282876
The generated pressure mean: 0.45795178413391113
loss_pred:0.020085522904992104, decouple_loss:0.003931484650820494
Iteration: 5868, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492219388484955
loss_pred:0.020461421459913254, decouple_loss:0.0033051164355129004
The generated pressure mean: 0.4487990140914917
loss_pred:0.019250404089689255, decouple_loss:0.003077545901760459
The generated pressure mean: 0.44791507720947266
loss_pred:0.01867036707699299, decouple_loss:0.0030594919808208942
Iteration: 5869, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43239378929138184
loss_pred:0.01882615126669407, decouple_loss:0.0032708682119846344
The generated pressure mean: 0.4333082139492035
loss_pred:0.01924922689795494, decouple_loss:0.003142173634842038
The generated pressure mean: 0.4357379674911499
loss_pred:0.018662195652723312, decouple_loss:0.0032018532510846853
Iteration: 5870, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476431608200073
loss_pred:0.019107339903712273, decouple_loss:0.003072071820497513
The generated pressure mean: 0.44777023792266846
loss_pred:0.01986309140920639, decouple_loss:0.0030749544966965914
The generated pressure mean: 0.4493125379085541
loss_pred:0.019311726093292236, decouple_loss:0.0030350196175277233
2023-04-17 09:55:38 testing...
The generated pressure mean: 0.41489866375923157
The generated pressure mean: 0.42058393359184265
The generated pressure mean: 0.422600656747818
loss_pred:0.03363834694027901, decouple_loss:0.003759742947295308
loss_pred:0.03262334689497948, decouple_loss:0.003841303288936615
loss_pred:0.03283485397696495, decouple_loss:0.003977765794843435
WV_0_PC_0_EH_1_PS_40, loss: 0.0332251638174057, avg_mse: 0.04911254346370697
current test mse: 0.049113
Iteration: 5871, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4425968825817108
loss_pred:0.021529631689190865, decouple_loss:0.0031107107643038034
The generated pressure mean: 0.4485202133655548
loss_pred:0.01942141354084015, decouple_loss:0.003254996845498681
The generated pressure mean: 0.44739699363708496
loss_pred:0.018061112612485886, decouple_loss:0.0034188437275588512
Iteration: 5872, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4433998465538025
loss_pred:0.019726356491446495, decouple_loss:0.003978102467954159
The generated pressure mean: 0.440965473651886
loss_pred:0.02029532752931118, decouple_loss:0.004053742624819279
The generated pressure mean: 0.44796624779701233
loss_pred:0.01929585263133049, decouple_loss:0.004052278585731983
Iteration: 5873, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4457077085971832
loss_pred:0.02008330449461937, decouple_loss:0.0029786573722958565
The generated pressure mean: 0.4465126097202301
loss_pred:0.018080661073327065, decouple_loss:0.0028725643642246723
The generated pressure mean: 0.4504872262477875
loss_pred:0.02013586275279522, decouple_loss:0.00310722878202796
Iteration: 5874, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4422629773616791
loss_pred:0.020746594294905663, decouple_loss:0.003578439587727189
The generated pressure mean: 0.43891826272010803
loss_pred:0.021290550008416176, decouple_loss:0.003373862477019429
The generated pressure mean: 0.4354836940765381
loss_pred:0.021596448495984077, decouple_loss:0.0033918023109436035
Iteration: 5875, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44694092869758606
loss_pred:0.019787877798080444, decouple_loss:0.002994094043970108
The generated pressure mean: 0.4472820460796356
loss_pred:0.0207989364862442, decouple_loss:0.0027882505673915148
The generated pressure mean: 0.4499324858188629
loss_pred:0.019018232822418213, decouple_loss:0.0028262401465326548
Iteration: 5876, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44617506861686707
loss_pred:0.018489815294742584, decouple_loss:0.003510886337608099
The generated pressure mean: 0.44211795926094055
loss_pred:0.020690010860562325, decouple_loss:0.0037746895104646683
The generated pressure mean: 0.4482806622982025
loss_pred:0.018483007326722145, decouple_loss:0.0036778259091079235
Iteration: 5877, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45096614956855774
loss_pred:0.01927151158452034, decouple_loss:0.0033896551467478275
The generated pressure mean: 0.45413869619369507
loss_pred:0.019053008407354355, decouple_loss:0.0032965000718832016
The generated pressure mean: 0.451321005821228
loss_pred:0.019075507298111916, decouple_loss:0.003347332589328289
Iteration: 5878, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44921109080314636
loss_pred:0.01973968744277954, decouple_loss:0.003139850217849016
The generated pressure mean: 0.4574578106403351
loss_pred:0.019987408071756363, decouple_loss:0.0031444011256098747
The generated pressure mean: 0.4504377841949463
loss_pred:0.01981961727142334, decouple_loss:0.0030686885584145784
Iteration: 5879, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43378663063049316
loss_pred:0.019492585211992264, decouple_loss:0.003153003752231598
The generated pressure mean: 0.43351244926452637
loss_pred:0.018680905923247337, decouple_loss:0.0029931096360087395
The generated pressure mean: 0.4284462034702301
loss_pred:0.019977763295173645, decouple_loss:0.003160754917189479
Iteration: 5880, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43741375207901
loss_pred:0.019886862486600876, decouple_loss:0.002953348448500037
The generated pressure mean: 0.44576767086982727
loss_pred:0.020293375477194786, decouple_loss:0.002928992500528693
The generated pressure mean: 0.44192901253700256
loss_pred:0.01942473091185093, decouple_loss:0.0031359398271888494
2023-04-17 09:57:31 testing...
The generated pressure mean: 0.41195130348205566
The generated pressure mean: 0.4197694659233093
The generated pressure mean: 0.4219614863395691
loss_pred:0.033695053309202194, decouple_loss:0.0035404213704168797
loss_pred:0.0328894667327404, decouple_loss:0.0038127584848552942
loss_pred:0.032647933810949326, decouple_loss:0.003945748321712017
WV_0_PC_0_EH_1_PS_40, loss: 0.03326579928398132, avg_mse: 0.049599263817071915
current test mse: 0.049599
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 5881, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.461433470249176
loss_pred:0.020247390493750572, decouple_loss:0.003123420989140868
The generated pressure mean: 0.4536131024360657
loss_pred:0.019204696640372276, decouple_loss:0.0030732830055058002
The generated pressure mean: 0.4550427794456482
loss_pred:0.020309850573539734, decouple_loss:0.003170630894601345
Iteration: 5882, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44728752970695496
loss_pred:0.019721850752830505, decouple_loss:0.003611091524362564
The generated pressure mean: 0.4485021233558655
loss_pred:0.020727798342704773, decouple_loss:0.003614042652770877
The generated pressure mean: 0.44356071949005127
loss_pred:0.020100949332118034, decouple_loss:0.003566393628716469
Iteration: 5883, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480290412902832
loss_pred:0.019400840625166893, decouple_loss:0.0036666805390268564
The generated pressure mean: 0.4461354911327362
loss_pred:0.01893564686179161, decouple_loss:0.003733836580067873
The generated pressure mean: 0.4468660354614258
loss_pred:0.021367860957980156, decouple_loss:0.0036180715542286634
Iteration: 5884, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44904986023902893
loss_pred:0.018674474209547043, decouple_loss:0.0034242039546370506
The generated pressure mean: 0.44830313324928284
loss_pred:0.01942623034119606, decouple_loss:0.0034393914975225925
The generated pressure mean: 0.445882111787796
loss_pred:0.018247168511152267, decouple_loss:0.0033689800184220076
Iteration: 5885, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43878817558288574
loss_pred:0.020294444635510445, decouple_loss:0.0033854739740490913
The generated pressure mean: 0.44212546944618225
loss_pred:0.019017202779650688, decouple_loss:0.0033925450406968594
The generated pressure mean: 0.44097602367401123
loss_pred:0.019710734486579895, decouple_loss:0.0032986446749418974
Iteration: 5886, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44473445415496826
loss_pred:0.018440954387187958, decouple_loss:0.003324049524962902The generated pressure mean: 0.4425475001335144
loss_pred:0.019941935315728188, decouple_loss:0.0033465672750025988
The generated pressure mean: 0.4416608512401581
loss_pred:0.01781623251736164, decouple_loss:0.0033107094932347536
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5887, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4569195806980133
loss_pred:0.01935831643640995, decouple_loss:0.002947706962004304
The generated pressure mean: 0.4533389210700989
loss_pred:0.018225086852908134, decouple_loss:0.003088788129389286
The generated pressure mean: 0.45522862672805786
loss_pred:0.021298715844750404, decouple_loss:0.0030211161356419325
Iteration: 5888, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45270535349845886
loss_pred:0.02039404958486557, decouple_loss:0.003301607444882393
The generated pressure mean: 0.445906400680542
loss_pred:0.018702484667301178, decouple_loss:0.0031956860329955816
The generated pressure mean: 0.4506067633628845
loss_pred:0.020056763663887978, decouple_loss:0.00314447027631104
Iteration: 5889, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4456337094306946
loss_pred:0.019084760919213295, decouple_loss:0.0028795795515179634
The generated pressure mean: 0.44174039363861084
loss_pred:0.019075004383921623, decouple_loss:0.0028115662280470133
The generated pressure mean: 0.44438067078590393
loss_pred:0.019204892218112946, decouple_loss:0.002870741533115506
Iteration: 5890, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43964043259620667
loss_pred:0.020875660702586174, decouple_loss:0.0031317579559981823
The generated pressure mean: 0.4373534023761749
loss_pred:0.01991604082286358, decouple_loss:0.0031276531517505646
The generated pressure mean: 0.44036996364593506
loss_pred:0.02030455879867077, decouple_loss:0.003272638190537691
2023-04-17 10:00:03 testing...
The generated pressure mean: 0.4126184582710266
The generated pressure mean: 0.4206644892692566
The generated pressure mean: 0.4228772222995758
loss_pred:0.033613331615924835, decouple_loss:0.003537316108122468
loss_pred:0.03260243311524391, decouple_loss:0.0038468812126666307
loss_pred:0.032163023948669434, decouple_loss:0.00391955953091383
WV_0_PC_0_EH_1_PS_40, loss: 0.032981328666210175, avg_mse: 0.04908054694533348
current test mse: 0.049081
Iteration: 5891, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491450786590576
loss_pred:0.01955161802470684, decouple_loss:0.0028605321422219276
The generated pressure mean: 0.4492151141166687
loss_pred:0.021547680720686913, decouple_loss:0.0027856959495693445
The generated pressure mean: 0.4518128037452698
loss_pred:0.02040606178343296, decouple_loss:0.0029174601659178734
Iteration: 5892, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43626323342323303
loss_pred:0.020281454548239708, decouple_loss:0.0030571322422474623
The generated pressure mean: 0.43501871824264526
loss_pred:0.02013101615011692, decouple_loss:0.0029625054448843002
The generated pressure mean: 0.4436691999435425
loss_pred:0.02097209356725216, decouple_loss:0.0030695858877152205
Iteration: 5893, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45115742087364197
loss_pred:0.019520478323101997, decouple_loss:0.003773023374378681
The generated pressure mean: 0.44895458221435547
loss_pred:0.01837310753762722, decouple_loss:0.0038070527371019125
The generated pressure mean: 0.45134031772613525
loss_pred:0.019044645130634308, decouple_loss:0.0038130516186356544
Iteration: 5894, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46373215317726135
loss_pred:0.020943518728017807, decouple_loss:0.0036062647122889757
The generated pressure mean: 0.45888397097587585
loss_pred:0.019790105521678925, decouple_loss:0.0034115591552108526
The generated pressure mean: 0.4566531479358673
loss_pred:0.018703998997807503, decouple_loss:0.003389856079593301
Iteration: 5895, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43882492184638977
loss_pred:0.017872942611575127, decouple_loss:0.0037219764199107885
The generated pressure mean: 0.431897908449173
loss_pred:0.01885628141462803, decouple_loss:0.004157267045229673
The generated pressure mean: 0.43628382682800293
loss_pred:0.019002163782715797, decouple_loss:0.0038789876271039248
Iteration: 5896, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4365376830101013
loss_pred:0.01801307685673237, decouple_loss:0.0032075047492980957
The generated pressure mean: 0.4328763782978058
loss_pred:0.01949547976255417, decouple_loss:0.0031202491372823715
The generated pressure mean: 0.4313614070415497
loss_pred:0.02028854563832283, decouple_loss:0.0030998438596725464
Iteration: 5897, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4611826241016388
loss_pred:0.017685459926724434, decouple_loss:0.0027026846073567867
The generated pressure mean: 0.46534544229507446
The generated pressure mean: 0.46685370802879333
loss_pred:0.019273145124316216, decouple_loss:0.0026929511222988367
loss_pred:0.019879546016454697, decouple_loss:0.00277244602330029
Iteration: 5898, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45879268646240234
The generated pressure mean: 0.4552435576915741
loss_pred:0.01863814890384674, decouple_loss:0.0027908324263989925
loss_pred:0.018995214253664017, decouple_loss:0.0027148385997861624
The generated pressure mean: 0.4546527862548828
loss_pred:0.01894203945994377, decouple_loss:0.002778977155685425
Iteration: 5899, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4270322918891907
loss_pred:0.017994243651628494, decouple_loss:0.0026766574010252953
The generated pressure mean: 0.4326218366622925
The generated pressure mean: 0.42828261852264404
loss_pred:0.020370593294501305, decouple_loss:0.0027152032125741243
loss_pred:0.01920490898191929, decouple_loss:0.00278845033608377
Iteration: 5900, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4386001527309418
loss_pred:0.01892158016562462, decouple_loss:0.002970847999677062
The generated pressure mean: 0.44335439801216125
loss_pred:0.018929200246930122, decouple_loss:0.0029461956582963467
The generated pressure mean: 0.4439106583595276
loss_pred:0.01934727653861046, decouple_loss:0.0029732619877904654
2023-04-17 10:01:56 testing...
The generated pressure mean: 0.4162614643573761
The generated pressure mean: 0.40921011567115784
The generated pressure mean: 0.4186456501483917
loss_pred:0.03236125782132149, decouple_loss:0.00403550686314702
loss_pred:0.033575043082237244, decouple_loss:0.0036183500196784735
loss_pred:0.03211225941777229, decouple_loss:0.00422071386128664
WV_0_PC_0_EH_1_PS_40, loss: 0.032880764454603195, avg_mse: 0.04877401888370514
current test mse: 0.048774
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 5901, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4637073278427124
loss_pred:0.019685424864292145, decouple_loss:0.0030910992063581944
The generated pressure mean: 0.46152836084365845
loss_pred:0.017962085083127022, decouple_loss:0.0032023254316300154
The generated pressure mean: 0.46369239687919617
loss_pred:0.019226856529712677, decouple_loss:0.003162822686135769
Iteration: 5902, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43822184205055237
loss_pred:0.019746411591768265, decouple_loss:0.0033753905445337296
The generated pressure mean: 0.4468071162700653
loss_pred:0.01903989166021347, decouple_loss:0.0034943227656185627
The generated pressure mean: 0.4399666488170624
loss_pred:0.01915190927684307, decouple_loss:0.0033083483576774597
Iteration: 5903, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4421027600765228
The generated pressure mean: 0.44336214661598206
loss_pred:0.019843682646751404, decouple_loss:0.002472854219377041
loss_pred:0.019024869427084923, decouple_loss:0.0025533477310091257
The generated pressure mean: 0.43657514452934265
loss_pred:0.019854383543133736, decouple_loss:0.002436443231999874
Iteration: 5904, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4518023729324341
loss_pred:0.019305933266878128, decouple_loss:0.0043129464611411095
The generated pressure mean: 0.45189356803894043
loss_pred:0.017809288576245308, decouple_loss:0.0044307890348136425
The generated pressure mean: 0.45703721046447754
loss_pred:0.01850491762161255, decouple_loss:0.004270095843821764
Iteration: 5905, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4511938691139221
loss_pred:0.019449401646852493, decouple_loss:0.003367549739778042
The generated pressure mean: 0.4478326141834259
loss_pred:0.019474273547530174, decouple_loss:0.0032076318748295307
The generated pressure mean: 0.455208957195282
loss_pred:0.019634351134300232, decouple_loss:0.0031558119226247072
Iteration: 5906, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469868540763855
The generated pressure mean: 0.44496116042137146
loss_pred:0.021177735179662704, decouple_loss:0.00287614855915308
loss_pred:0.01861637458205223, decouple_loss:0.0031147762201726437
The generated pressure mean: 0.4412303566932678
loss_pred:0.019367240369319916, decouple_loss:0.003173557808622718
Iteration: 5907, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44649451971054077
loss_pred:0.01970938965678215, decouple_loss:0.0031322480645030737
The generated pressure mean: 0.4443427622318268
loss_pred:0.019864521920681, decouple_loss:0.0033062954898923635
The generated pressure mean: 0.4452400207519531
loss_pred:0.018669413402676582, decouple_loss:0.0030055081006139517
Iteration: 5908, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44699838757514954
The generated pressure mean: 0.445096880197525
loss_pred:0.018319638445973396, decouple_loss:0.0031249909661710262
loss_pred:0.018984975293278694, decouple_loss:0.0031458046287298203
The generated pressure mean: 0.4459756910800934
loss_pred:0.018795520067214966, decouple_loss:0.0033113337121903896
Iteration: 5909, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44624775648117065
The generated pressure mean: 0.4437140226364136
loss_pred:0.019524086266756058, decouple_loss:0.0029651890508830547
loss_pred:0.019076896831393242, decouple_loss:0.0030141249299049377
The generated pressure mean: 0.4479508399963379
loss_pred:0.02015463262796402, decouple_loss:0.002942324848845601
Iteration: 5910, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44670242071151733
loss_pred:0.019432973116636276, decouple_loss:0.0032349899411201477
The generated pressure mean: 0.44776642322540283
loss_pred:0.017886493355035782, decouple_loss:0.00340064219199121
The generated pressure mean: 0.44698959589004517
loss_pred:0.018095694482326508, decouple_loss:0.0033652952406555414
2023-04-17 10:04:40 testing...
The generated pressure mean: 0.4128078818321228
The generated pressure mean: 0.42063120007514954
The generated pressure mean: 0.4236584007740021
loss_pred:0.032980822026729584, decouple_loss:0.004934665281325579
loss_pred:0.031632062047719955, decouple_loss:0.00527925044298172
loss_pred:0.031211931258440018, decouple_loss:0.005604658741503954
WV_0_PC_0_EH_1_PS_40, loss: 0.0322052501142025, avg_mse: 0.04794980585575104
current test mse: 0.04795
Iteration: 5911, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486510157585144
The generated pressure mean: 0.45310965180397034loss_pred:0.01848709210753441, decouple_loss:0.004373741801828146
loss_pred:0.020501624792814255, decouple_loss:0.0045813568867743015
The generated pressure mean: 0.44704726338386536
loss_pred:0.0188505370169878, decouple_loss:0.004662458784878254
Iteration: 5912, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44493424892425537
loss_pred:0.018821828067302704, decouple_loss:0.0030458662658929825
The generated pressure mean: 0.44595590233802795
loss_pred:0.019140876829624176, decouple_loss:0.003083527088165283
The generated pressure mean: 0.44281965494155884
loss_pred:0.018613308668136597, decouple_loss:0.0030174001585692167
Iteration: 5913, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44792065024375916
loss_pred:0.018916750326752663, decouple_loss:0.0030789999291300774
The generated pressure mean: 0.45104002952575684
loss_pred:0.01851842738687992, decouple_loss:0.0030754595063626766
The generated pressure mean: 0.4446413815021515
loss_pred:0.019516102969646454, decouple_loss:0.0031114311423152685
Iteration: 5914, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44600650668144226
loss_pred:0.018714768812060356, decouple_loss:0.003688268829137087
The generated pressure mean: 0.44764256477355957
loss_pred:0.018533729016780853, decouple_loss:0.0037813945673406124
The generated pressure mean: 0.4479129910469055
loss_pred:0.018742632120847702, decouple_loss:0.0038194458466023207
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5915, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447146475315094
loss_pred:0.018813876435160637, decouple_loss:0.003422516630962491
The generated pressure mean: 0.4475623071193695
loss_pred:0.018314732238650322, decouple_loss:0.0035816803574562073
The generated pressure mean: 0.4449225962162018
loss_pred:0.01845066249370575, decouple_loss:0.003554105758666992
Iteration: 5916, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481954574584961
loss_pred:0.01888784021139145, decouple_loss:0.0032596185337752104
The generated pressure mean: 0.45543673634529114
loss_pred:0.019500115886330605, decouple_loss:0.003148008370772004
The generated pressure mean: 0.4501822292804718
loss_pred:0.018686803057789803, decouple_loss:0.0032338732853531837
Iteration: 5917, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44423621892929077
loss_pred:0.020013049244880676, decouple_loss:0.0026996275410056114
The generated pressure mean: 0.44508087635040283
loss_pred:0.019674116745591164, decouple_loss:0.0026117106899619102
The generated pressure mean: 0.4464961886405945
loss_pred:0.02160424180328846, decouple_loss:0.0025946958921849728
Iteration: 5918, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449411630630493
loss_pred:0.01847054623067379, decouple_loss:0.0028480265755206347
The generated pressure mean: 0.4462902247905731
The generated pressure mean: 0.44887781143188477loss_pred:0.018831243738532066, decouple_loss:0.002882166765630245
loss_pred:0.019314449280500412, decouple_loss:0.002919468330219388
Iteration: 5919, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4435802698135376
loss_pred:0.019629161804914474, decouple_loss:0.003130040830001235
The generated pressure mean: 0.4495526850223541
The generated pressure mean: 0.45208311080932617
loss_pred:0.018718168139457703, decouple_loss:0.003034257795661688
loss_pred:0.018794963136315346, decouple_loss:0.0030390028841793537
Iteration: 5920, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499923288822174
loss_pred:0.018760275095701218, decouple_loss:0.003368864767253399
The generated pressure mean: 0.450886607170105
loss_pred:0.019281258806586266, decouple_loss:0.003490799805149436
The generated pressure mean: 0.44643568992614746
loss_pred:0.020514626055955887, decouple_loss:0.003269829787313938
2023-04-17 10:06:33 testing...
The generated pressure mean: 0.4147024154663086
The generated pressure mean: 0.42169496417045593
The generated pressure mean: 0.42395806312561035
loss_pred:0.03199824318289757, decouple_loss:0.004000294487923384
loss_pred:0.03084360435605049, decouple_loss:0.004296816885471344
loss_pred:0.030500119552016258, decouple_loss:0.004513503983616829
WV_0_PC_0_EH_1_PS_40, loss: 0.0313275009393692, avg_mse: 0.04569865018129349
current test mse: 0.045699
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 5921, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4429122805595398
loss_pred:0.019092606380581856, decouple_loss:0.003436747007071972
The generated pressure mean: 0.4393075406551361
The generated pressure mean: 0.4449962079524994loss_pred:0.019116029143333435, decouple_loss:0.0035546107683330774
loss_pred:0.01859201118350029, decouple_loss:0.0035145655274391174
Iteration: 5922, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.455573171377182
The generated pressure mean: 0.45782434940338135
loss_pred:0.019690148532390594, decouple_loss:0.0028888785745948553
loss_pred:0.01926443912088871, decouple_loss:0.002950654597952962
The generated pressure mean: 0.4528310298919678
loss_pred:0.01869991235435009, decouple_loss:0.002983130980283022
Iteration: 5923, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4395681917667389
The generated pressure mean: 0.4479435682296753
loss_pred:0.019268320873379707, decouple_loss:0.0034116869792342186
loss_pred:0.01911705918610096, decouple_loss:0.003396551590412855
The generated pressure mean: 0.4452958106994629
loss_pred:0.018385473638772964, decouple_loss:0.003367594676092267
Iteration: 5924, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44289106130599976
The generated pressure mean: 0.4393860101699829
loss_pred:0.01793314889073372, decouple_loss:0.0032606511376798153
loss_pred:0.019058305770158768, decouple_loss:0.0032387999817728996
The generated pressure mean: 0.4401765763759613
loss_pred:0.017748378217220306, decouple_loss:0.0032133047934621572
Iteration: 5925, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4512708783149719
loss_pred:0.018607523292303085, decouple_loss:0.0034115316811949015
The generated pressure mean: 0.4454842507839203
loss_pred:0.018900932744145393, decouple_loss:0.003225239459425211
The generated pressure mean: 0.44495099782943726
loss_pred:0.019050301983952522, decouple_loss:0.0032671974040567875
Iteration: 5926, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473781883716583
loss_pred:0.018218141049146652, decouple_loss:0.0028805139008909464
The generated pressure mean: 0.4437779188156128
The generated pressure mean: 0.441666841506958
loss_pred:0.018920231610536575, decouple_loss:0.0030022046994417906
loss_pred:0.019372103735804558, decouple_loss:0.002864062087610364
Iteration: 5927, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4458535313606262
The generated pressure mean: 0.45045924186706543
loss_pred:0.020222213119268417, decouple_loss:0.003737929742783308
loss_pred:0.020368516445159912, decouple_loss:0.0037387688644230366
The generated pressure mean: 0.4487881362438202
loss_pred:0.018801184371113777, decouple_loss:0.003620363771915436
Iteration: 5928, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501838982105255
loss_pred:0.018023593351244926, decouple_loss:0.003822272876277566
The generated pressure mean: 0.4456236958503723
loss_pred:0.018307635560631752, decouple_loss:0.0037681544199585915
The generated pressure mean: 0.44418540596961975
loss_pred:0.018889296799898148, decouple_loss:0.0038349174428731203
Iteration: 5929, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44267919659614563
loss_pred:0.019045379012823105, decouple_loss:0.003116910345852375
The generated pressure mean: 0.44545477628707886
loss_pred:0.01850430853664875, decouple_loss:0.003192090429365635
The generated pressure mean: 0.44512563943862915
loss_pred:0.02077595889568329, decouple_loss:0.002968949032947421
Iteration: 5930, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45346033573150635
The generated pressure mean: 0.46018749475479126
loss_pred:0.017637724056839943, decouple_loss:0.0042054252699017525
loss_pred:0.019774289801716805, decouple_loss:0.004213937092572451
The generated pressure mean: 0.45623648166656494
loss_pred:0.019232522696256638, decouple_loss:0.004305684007704258
2023-04-17 10:09:04 testing...
The generated pressure mean: 0.41378962993621826
The generated pressure mean: 0.4214255213737488
loss_pred:0.03372487053275108, decouple_loss:0.0041799587197601795
The generated pressure mean: 0.4239227771759033
loss_pred:0.03241066262125969, decouple_loss:0.004404796287417412
loss_pred:0.032150670886039734, decouple_loss:0.0047398777678608894
WV_0_PC_0_EH_1_PS_40, loss: 0.03298414871096611, avg_mse: 0.0491567924618721
current test mse: 0.049157
Iteration: 5931, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4532294273376465
loss_pred:0.01862848922610283, decouple_loss:0.0037668365985155106
The generated pressure mean: 0.45230957865715027
loss_pred:0.018246004357933998, decouple_loss:0.003478800877928734
The generated pressure mean: 0.4482864737510681
loss_pred:0.01830599270761013, decouple_loss:0.003529864829033613
Iteration: 5932, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43125060200691223
loss_pred:0.02148916758596897, decouple_loss:0.0036441117990761995
The generated pressure mean: 0.4325794279575348
loss_pred:0.018475286662578583, decouple_loss:0.0034448732621967793
The generated pressure mean: 0.4318060576915741
loss_pred:0.018279630690813065, decouple_loss:0.0035268967039883137
Iteration: 5933, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4457281827926636
loss_pred:0.019191402941942215, decouple_loss:0.004165791906416416
The generated pressure mean: 0.4455409646034241
loss_pred:0.019404640421271324, decouple_loss:0.003890387015417218
The generated pressure mean: 0.4502398669719696
loss_pred:0.018775613978505135, decouple_loss:0.0038849005941301584
Iteration: 5934, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4671885073184967
loss_pred:0.01866881735622883, decouple_loss:0.0033669148106127977
The generated pressure mean: 0.4603499174118042
loss_pred:0.02067062444984913, decouple_loss:0.0032785695511847734
The generated pressure mean: 0.46981319785118103
loss_pred:0.019198695197701454, decouple_loss:0.0035627756733447313
Iteration: 5935, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4317600131034851
loss_pred:0.018252288922667503, decouple_loss:0.0036573237739503384
The generated pressure mean: 0.43233436346054077
loss_pred:0.019596723839640617, decouple_loss:0.0036415704526007175
The generated pressure mean: 0.4314899444580078
loss_pred:0.0185542032122612, decouple_loss:0.0035043074749410152
Iteration: 5936, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4363653361797333
loss_pred:0.01815364882349968, decouple_loss:0.0035094537306576967
The generated pressure mean: 0.4387695789337158
The generated pressure mean: 0.43491029739379883
loss_pred:0.017984872683882713, decouple_loss:0.0035320278257131577
loss_pred:0.018033890053629875, decouple_loss:0.0035738747101277113
Iteration: 5937, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46293309330940247
loss_pred:0.018422486260533333, decouple_loss:0.0033521330915391445
The generated pressure mean: 0.46538931131362915
loss_pred:0.017693862318992615, decouple_loss:0.0033477714750915766
The generated pressure mean: 0.46015992760658264
loss_pred:0.019267311319708824, decouple_loss:0.0032425278332084417
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5938, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4599387049674988
loss_pred:0.019704097881913185, decouple_loss:0.003476082580164075
The generated pressure mean: 0.4582005441188812
loss_pred:0.021093636751174927, decouple_loss:0.003302948782220483
The generated pressure mean: 0.450226366519928
loss_pred:0.01871364936232567, decouple_loss:0.0034118660259991884
Iteration: 5939, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4375181198120117
loss_pred:0.02039407752454281, decouple_loss:0.0038693181704729795
The generated pressure mean: 0.42960694432258606
loss_pred:0.020013954490423203, decouple_loss:0.003969382494688034
The generated pressure mean: 0.43331143260002136
loss_pred:0.0185574721544981, decouple_loss:0.003669761586934328
Iteration: 5940, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4428310692310333
loss_pred:0.020494794473052025, decouple_loss:0.0032907063141465187
The generated pressure mean: 0.43861308693885803
loss_pred:0.01971687562763691, decouple_loss:0.003182621207088232
The generated pressure mean: 0.4375571310520172
loss_pred:0.01938553899526596, decouple_loss:0.0031664271373301744
2023-04-17 10:10:57 testing...
The generated pressure mean: 0.41388437151908875
The generated pressure mean: 0.4214795231819153
The generated pressure mean: 0.4251651167869568
loss_pred:0.03264114633202553, decouple_loss:0.0038366196677088737
loss_pred:0.031420521438121796, decouple_loss:0.004050425253808498
loss_pred:0.030999837443232536, decouple_loss:0.004214253276586533
WV_0_PC_0_EH_1_PS_40, loss: 0.03188885748386383, avg_mse: 0.04713176190853119
current test mse: 0.047132
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 5941, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4511358439922333
loss_pred:0.021787920966744423, decouple_loss:0.003494163742288947
The generated pressure mean: 0.451191246509552
loss_pred:0.01933152973651886, decouple_loss:0.00348460441455245
The generated pressure mean: 0.4507597088813782
loss_pred:0.019860757514834404, decouple_loss:0.003327019512653351
Iteration: 5942, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472354054450989
loss_pred:0.020960278809070587, decouple_loss:0.0037230290472507477
The generated pressure mean: 0.452608197927475
loss_pred:0.020675551146268845, decouple_loss:0.003731556935235858
The generated pressure mean: 0.45398765802383423
loss_pred:0.021776733919978142, decouple_loss:0.003732641227543354
Iteration: 5943, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4420032799243927
loss_pred:0.020794522017240524, decouple_loss:0.004157042596489191
The generated pressure mean: 0.4455220401287079
loss_pred:0.019791100174188614, decouple_loss:0.003929820843040943
The generated pressure mean: 0.4427976906299591
loss_pred:0.021220382302999496, decouple_loss:0.0038947106804698706
Iteration: 5944, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45204025506973267
loss_pred:0.020953930914402008, decouple_loss:0.0031431601382791996
The generated pressure mean: 0.4484573304653168
loss_pred:0.021419022232294083, decouple_loss:0.003141127061098814
The generated pressure mean: 0.4497656226158142
loss_pred:0.022210853174328804, decouple_loss:0.0033098366111516953
Iteration: 5945, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4277942180633545
loss_pred:0.0187076423317194, decouple_loss:0.004108240827918053
The generated pressure mean: 0.4341842830181122
loss_pred:0.019738327711820602, decouple_loss:0.004042420070618391
The generated pressure mean: 0.43423783779144287
loss_pred:0.019599013030529022, decouple_loss:0.004002465400844812
Iteration: 5946, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45119303464889526
loss_pred:0.01957414485514164, decouple_loss:0.004153399262577295
The generated pressure mean: 0.4500797986984253
The generated pressure mean: 0.44969063997268677loss_pred:0.019500315189361572, decouple_loss:0.004113161936402321
loss_pred:0.020192556083202362, decouple_loss:0.004169394262135029
Iteration: 5947, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4629422426223755
loss_pred:0.01949397847056389, decouple_loss:0.0036591775715351105
The generated pressure mean: 0.4636882543563843
loss_pred:0.02021094411611557, decouple_loss:0.003794647054746747
The generated pressure mean: 0.46902909874916077
loss_pred:0.020123744383454323, decouple_loss:0.003658828791230917
Iteration: 5948, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43953245878219604
loss_pred:0.01953345723450184, decouple_loss:0.004063033033162355
The generated pressure mean: 0.44225162267684937
loss_pred:0.01852332428097725, decouple_loss:0.00402644369751215
The generated pressure mean: 0.43921932578086853
loss_pred:0.019342150539159775, decouple_loss:0.004067827481776476
Iteration: 5949, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4311339855194092
loss_pred:0.019761301577091217, decouple_loss:0.0041753025725483894
The generated pressure mean: 0.4332144558429718
loss_pred:0.020441504195332527, decouple_loss:0.004056454636156559
The generated pressure mean: 0.4314902722835541
loss_pred:0.018990840762853622, decouple_loss:0.004156860057264566
Iteration: 5950, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45710206031799316
loss_pred:0.02022933028638363, decouple_loss:0.0035195020027458668
The generated pressure mean: 0.45374739170074463
loss_pred:0.01887695863842964, decouple_loss:0.0033194541465491056
The generated pressure mean: 0.4484398066997528
loss_pred:0.01941179484128952, decouple_loss:0.0034875778947025537
2023-04-17 10:13:25 testing...
The generated pressure mean: 0.4115654230117798
The generated pressure mean: 0.4191838502883911
The generated pressure mean: 0.4225640892982483
loss_pred:0.034247588366270065, decouple_loss:0.004340608604252338
loss_pred:0.03253159672021866, decouple_loss:0.00439487537369132
loss_pred:0.032562367618083954, decouple_loss:0.004732378292828798
WV_0_PC_0_EH_1_PS_40, loss: 0.03333831578493118, avg_mse: 0.04993093013763428
current test mse: 0.049931
Iteration: 5951, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45328623056411743
loss_pred:0.020257435739040375, decouple_loss:0.003753694938495755
The generated pressure mean: 0.45418858528137207
loss_pred:0.019788850098848343, decouple_loss:0.0037980948109179735
The generated pressure mean: 0.4565739929676056
loss_pred:0.0209348164498806, decouple_loss:0.0037467870861291885
Iteration: 5952, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4390689432621002
loss_pred:0.021084820851683617, decouple_loss:0.0035943363327533007
The generated pressure mean: 0.445039838552475
loss_pred:0.02064513973891735, decouple_loss:0.0034295632503926754
The generated pressure mean: 0.440620094537735
loss_pred:0.02199217677116394, decouple_loss:0.003593606408685446
Iteration: 5953, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44340991973876953
loss_pred:0.02076069451868534, decouple_loss:0.00365387462079525
The generated pressure mean: 0.45259764790534973
loss_pred:0.021119095385074615, decouple_loss:0.0035475457552820444
The generated pressure mean: 0.4513949453830719
loss_pred:0.019337480887770653, decouple_loss:0.0036528317723423243
Iteration: 5954, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4539942145347595
loss_pred:0.01904311031103134, decouple_loss:0.0035610273480415344
The generated pressure mean: 0.4411262273788452
loss_pred:0.019268440082669258, decouple_loss:0.0035471769515424967
The generated pressure mean: 0.4464733600616455
loss_pred:0.01893097162246704, decouple_loss:0.0036683245562016964
Iteration: 5955, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44692590832710266
loss_pred:0.02040616050362587, decouple_loss:0.004024312365800142
The generated pressure mean: 0.4452608823776245
loss_pred:0.01889406144618988, decouple_loss:0.003977280110120773
The generated pressure mean: 0.44998979568481445
loss_pred:0.0198111142963171, decouple_loss:0.004056427162140608
Iteration: 5956, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4359467625617981
loss_pred:0.020033368840813637, decouple_loss:0.002757284790277481
The generated pressure mean: 0.4420204162597656
loss_pred:0.02151121385395527, decouple_loss:0.0028408695943653584
The generated pressure mean: 0.44072991609573364
loss_pred:0.02262680046260357, decouple_loss:0.002742212964221835
Iteration: 5957, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4408799409866333
loss_pred:0.01990886591374874, decouple_loss:0.003485139925032854
The generated pressure mean: 0.44885969161987305
loss_pred:0.019697993993759155, decouple_loss:0.0036870166659355164
The generated pressure mean: 0.44083690643310547
loss_pred:0.018955275416374207, decouple_loss:0.00350551656447351
Iteration: 5958, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4596225917339325
loss_pred:0.01877073384821415, decouple_loss:0.0030952938832342625
The generated pressure mean: 0.4632307291030884
loss_pred:0.020015709102153778, decouple_loss:0.0031748756300657988
The generated pressure mean: 0.4576895534992218
loss_pred:0.019744589924812317, decouple_loss:0.0033057499676942825
Iteration: 5959, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44658032059669495
loss_pred:0.019897226244211197, decouple_loss:0.0031519143376499414
The generated pressure mean: 0.4449063539505005
loss_pred:0.02003582753241062, decouple_loss:0.0033682379871606827
The generated pressure mean: 0.45341920852661133
loss_pred:0.020042784512043, decouple_loss:0.0034687835723161697
Iteration: 5960, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4399324059486389
loss_pred:0.02004891261458397, decouple_loss:0.003510372946038842
The generated pressure mean: 0.4387594163417816
loss_pred:0.01953049562871456, decouple_loss:0.0034252319019287825
The generated pressure mean: 0.43529486656188965
loss_pred:0.020914047956466675, decouple_loss:0.0035735969431698322
2023-04-17 10:15:18 testing...
The generated pressure mean: 0.41383007168769836
The generated pressure mean: 0.4220961034297943
The generated pressure mean: 0.4251943826675415
loss_pred:0.034665003418922424, decouple_loss:0.0034490483812987804
loss_pred:0.033807672560214996, decouple_loss:0.003625382436439395
loss_pred:0.033415328711271286, decouple_loss:0.003824335290119052
WV_0_PC_0_EH_1_PS_40, loss: 0.034144312143325806, avg_mse: 0.0517263300716877
current test mse: 0.051726
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 5961, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4529154598712921
loss_pred:0.018714705482125282, decouple_loss:0.002945643151178956
The generated pressure mean: 0.45277783274650574
loss_pred:0.0186780858784914, decouple_loss:0.0031766414176672697
The generated pressure mean: 0.4505191147327423
loss_pred:0.01859920099377632, decouple_loss:0.003110716585069895
Iteration: 5962, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44755375385284424
The generated pressure mean: 0.4503704309463501
loss_pred:0.0190799031406641, decouple_loss:0.003416683292016387
loss_pred:0.019187625497579575, decouple_loss:0.0033641646150499582
The generated pressure mean: 0.4537010192871094
loss_pred:0.01891300641000271, decouple_loss:0.0033612684346735477
Iteration: 5963, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4374558627605438
loss_pred:0.020407691597938538, decouple_loss:0.0031986196991056204
The generated pressure mean: 0.43547192215919495
loss_pred:0.017833201214671135, decouple_loss:0.003171057440340519
The generated pressure mean: 0.435359388589859
loss_pred:0.019151946529746056, decouple_loss:0.0032868904527276754
Iteration: 5964, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474312365055084
The generated pressure mean: 0.44713395833969116
loss_pred:0.020437024533748627, decouple_loss:0.003519704332575202
loss_pred:0.018852751702070236, decouple_loss:0.0035390376579016447
The generated pressure mean: 0.4487093687057495
loss_pred:0.018328597769141197, decouple_loss:0.00357801909558475
Iteration: 5965, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466766119003296
loss_pred:0.017899541184306145, decouple_loss:0.0046077268198132515
The generated pressure mean: 0.4494669437408447
loss_pred:0.01843561790883541, decouple_loss:0.004724235739558935
The generated pressure mean: 0.4428609311580658
loss_pred:0.018497757613658905, decouple_loss:0.004873338155448437
Iteration: 5966, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4444044828414917
loss_pred:0.02057967707514763, decouple_loss:0.0035514547489583492
The generated pressure mean: 0.4482145607471466
loss_pred:0.02010510116815567, decouple_loss:0.0033370591700077057The generated pressure mean: 0.44350120425224304
loss_pred:0.019165724515914917, decouple_loss:0.0032906709238886833
Iteration: 5967, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45862889289855957
The generated pressure mean: 0.458707332611084
loss_pred:0.01916852779686451, decouple_loss:0.004602763801813126
loss_pred:0.01812814548611641, decouple_loss:0.004232518840581179
The generated pressure mean: 0.4569014012813568
loss_pred:0.019672337919473648, decouple_loss:0.004560322500765324
Iteration: 5968, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477042853832245
The generated pressure mean: 0.4509182274341583
loss_pred:0.018864834681153297, decouple_loss:0.0037064843345433474
loss_pred:0.01859276369214058, decouple_loss:0.0038212232757359743
The generated pressure mean: 0.4481557011604309
loss_pred:0.022082598879933357, decouple_loss:0.003812188748270273
Iteration: 5969, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43198254704475403
The generated pressure mean: 0.4262409806251526
loss_pred:0.020365651696920395, decouple_loss:0.00424204533919692
loss_pred:0.01980406790971756, decouple_loss:0.004410353489220142
The generated pressure mean: 0.4286481440067291
loss_pred:0.019450051710009575, decouple_loss:0.0044309902004897594
Iteration: 5970, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44087767601013184
loss_pred:0.018094509840011597, decouple_loss:0.0046676588244736195
The generated pressure mean: 0.44123467803001404
loss_pred:0.019794438034296036, decouple_loss:0.004579929634928703
The generated pressure mean: 0.43896082043647766
loss_pred:0.020086724311113358, decouple_loss:0.004623785614967346
2023-04-17 10:18:14 testing...
The generated pressure mean: 0.4113968312740326
The generated pressure mean: 0.4189983010292053
The generated pressure mean: 0.4222854971885681
loss_pred:0.0354611799120903, decouple_loss:0.004265524912625551
loss_pred:0.034537699073553085, decouple_loss:0.004502702970057726
loss_pred:0.033643562346696854, decouple_loss:0.004623408429324627
WV_0_PC_0_EH_1_PS_40, loss: 0.034770675003528595, avg_mse: 0.0525769367814064
current test mse: 0.052577
Iteration: 5971, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46168243885040283
loss_pred:0.019894849509000778, decouple_loss:0.0037821391597390175
The generated pressure mean: 0.46289485692977905
loss_pred:0.020743442699313164, decouple_loss:0.003748496063053608
The generated pressure mean: 0.4626835882663727
loss_pred:0.019629182294011116, decouple_loss:0.0037777358666062355
Iteration: 5972, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44261401891708374
loss_pred:0.017686694860458374, decouple_loss:0.0038262091111391783
The generated pressure mean: 0.44069331884384155
loss_pred:0.020745784044265747, decouple_loss:0.0038540540263056755
The generated pressure mean: 0.44031447172164917
loss_pred:0.019703993573784828, decouple_loss:0.0038869355339556932
Iteration: 5973, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44569453597068787
loss_pred:0.019607312977313995, decouple_loss:0.005052731838077307
The generated pressure mean: 0.4397088587284088
loss_pred:0.018016178160905838, decouple_loss:0.005314809735864401
The generated pressure mean: 0.44033434987068176
loss_pred:0.020233402028679848, decouple_loss:0.004967959597706795
Iteration: 5974, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4413764178752899
loss_pred:0.01861351542174816, decouple_loss:0.004376234486699104
The generated pressure mean: 0.4441782832145691
loss_pred:0.017933901399374008, decouple_loss:0.0042312489822506905
The generated pressure mean: 0.44799062609672546
loss_pred:0.01835857331752777, decouple_loss:0.00463571771979332
Iteration: 5975, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498218894004822
loss_pred:0.019124040380120277, decouple_loss:0.00453516049310565
The generated pressure mean: 0.45033156871795654
loss_pred:0.018861377611756325, decouple_loss:0.004584267735481262
The generated pressure mean: 0.450150728225708
loss_pred:0.02029772475361824, decouple_loss:0.004510699305683374
Iteration: 5976, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499267041683197
loss_pred:0.019774669781327248, decouple_loss:0.0047659012489020824
The generated pressure mean: 0.44818994402885437
loss_pred:0.02089209109544754, decouple_loss:0.004707152955234051
The generated pressure mean: 0.4496857821941376
loss_pred:0.018871570006012917, decouple_loss:0.005100707523524761
Iteration: 5977, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4438164234161377
loss_pred:0.01938311941921711, decouple_loss:0.004309182520955801
The generated pressure mean: 0.44819363951683044
loss_pred:0.01973518170416355, decouple_loss:0.004335334058851004
The generated pressure mean: 0.4461055397987366
loss_pred:0.018262604251503944, decouple_loss:0.004423095844686031
Iteration: 5978, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44596001505851746
loss_pred:0.018215546384453773, decouple_loss:0.004869458265602589
The generated pressure mean: 0.44543835520744324
loss_pred:0.01821361482143402, decouple_loss:0.004835831932723522
The generated pressure mean: 0.44368064403533936
loss_pred:0.019420120865106583, decouple_loss:0.004835762549191713
Iteration: 5979, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4458481967449188
The generated pressure mean: 0.4410991370677948loss_pred:0.019628729671239853, decouple_loss:0.0035574589855968952
loss_pred:0.01955481991171837, decouple_loss:0.003509144764393568
The generated pressure mean: 0.44158217310905457
loss_pred:0.019189802929759026, decouple_loss:0.0034088112879544497
Iteration: 5980, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481775164604187
loss_pred:0.018865685909986496, decouple_loss:0.004511143546551466
The generated pressure mean: 0.45028436183929443
loss_pred:0.019510572776198387, decouple_loss:0.004417154472321272
The generated pressure mean: 0.45186418294906616
loss_pred:0.020341170951724052, decouple_loss:0.004508658777922392
2023-04-17 10:20:07 testing...
The generated pressure mean: 0.41479381918907166
The generated pressure mean: 0.42273959517478943
The generated pressure mean: 0.42560461163520813
loss_pred:0.03250322490930557, decouple_loss:0.004071326926350594
loss_pred:0.0314229279756546, decouple_loss:0.004324018955230713
loss_pred:0.03096134215593338, decouple_loss:0.004448466002941132
WV_0_PC_0_EH_1_PS_40, loss: 0.03184323012828827, avg_mse: 0.046861257404088974
current test mse: 0.046861
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 5981, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4424271285533905
loss_pred:0.01858588680624962, decouple_loss:0.003532870439812541
The generated pressure mean: 0.43924084305763245
loss_pred:0.020272115245461464, decouple_loss:0.0036481006536632776
The generated pressure mean: 0.4456598162651062
loss_pred:0.020203234627842903, decouple_loss:0.003553160233423114
Iteration: 5982, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4545210301876068
The generated pressure mean: 0.45576030015945435
loss_pred:0.022412942722439766, decouple_loss:0.003972047008574009
loss_pred:0.020259330049157143, decouple_loss:0.003773181466385722
The generated pressure mean: 0.4555359482765198
loss_pred:0.02083618938922882, decouple_loss:0.003937876783311367
Iteration: 5983, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43147024512290955
loss_pred:0.019887221977114677, decouple_loss:0.003530553774908185
The generated pressure mean: 0.4360559582710266
loss_pred:0.01986153982579708, decouple_loss:0.003700368572026491
The generated pressure mean: 0.431591272354126
loss_pred:0.019333619624376297, decouple_loss:0.00329019408673048
Iteration: 5984, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4515284597873688
loss_pred:0.01823306456208229, decouple_loss:0.0037728059105575085
The generated pressure mean: 0.45742887258529663
loss_pred:0.019395606592297554, decouple_loss:0.003949352074414492
The generated pressure mean: 0.45679593086242676
loss_pred:0.019835444167256355, decouple_loss:0.003914474509656429
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5985, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4533725082874298
The generated pressure mean: 0.45409756898880005
loss_pred:0.019533323124051094, decouple_loss:0.004079403821378946
loss_pred:0.019512465223670006, decouple_loss:0.004183759447187185
The generated pressure mean: 0.4525812268257141
loss_pred:0.018153507262468338, decouple_loss:0.004101633559912443
Iteration: 5986, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4409254491329193
loss_pred:0.02087918296456337, decouple_loss:0.0032342523336410522
The generated pressure mean: 0.4422578513622284
The generated pressure mean: 0.44144323468208313
loss_pred:0.01889565959572792, decouple_loss:0.0031297027599066496
loss_pred:0.01908099465072155, decouple_loss:0.003196364501491189
Iteration: 5987, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.443557471036911
loss_pred:0.02115023322403431, decouple_loss:0.004137828946113586
The generated pressure mean: 0.4415496289730072
loss_pred:0.019230730831623077, decouple_loss:0.004369363188743591
The generated pressure mean: 0.43993696570396423
loss_pred:0.02043789252638817, decouple_loss:0.004183290991932154
Iteration: 5988, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502008259296417
loss_pred:0.01975482515990734, decouple_loss:0.003915654495358467
The generated pressure mean: 0.45490479469299316
loss_pred:0.02151935175061226, decouple_loss:0.003947767429053783
The generated pressure mean: 0.4518550634384155
loss_pred:0.019501257687807083, decouple_loss:0.0038241122383624315
Iteration: 5989, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45242154598236084
loss_pred:0.018692802637815475, decouple_loss:0.0032135655637830496
The generated pressure mean: 0.4527210295200348
loss_pred:0.02062382735311985, decouple_loss:0.0032928832806646824
The generated pressure mean: 0.45541656017303467
loss_pred:0.01882573775947094, decouple_loss:0.0032575884833931923
Iteration: 5990, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4386284351348877
loss_pred:0.020605241879820824, decouple_loss:0.0031850750092417
The generated pressure mean: 0.4411666691303253
The generated pressure mean: 0.4424523115158081loss_pred:0.019825372844934464, decouple_loss:0.003217290621250868
loss_pred:0.020403683185577393, decouple_loss:0.0031772698275744915
2023-04-17 10:22:42 testing...
The generated pressure mean: 0.41451793909072876
The generated pressure mean: 0.42115524411201477
The generated pressure mean: 0.4242907464504242
loss_pred:0.032184898853302, decouple_loss:0.004070079419761896
loss_pred:0.031311482191085815, decouple_loss:0.004301767796278
loss_pred:0.030973272398114204, decouple_loss:0.004376615863293409
WV_0_PC_0_EH_1_PS_40, loss: 0.03170236200094223, avg_mse: 0.046414151787757874
current test mse: 0.046414
Iteration: 5991, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4457872211933136
loss_pred:0.01842345856130123, decouple_loss:0.003254454117268324
The generated pressure mean: 0.44260063767433167
loss_pred:0.019161295145750046, decouple_loss:0.0032224413007497787
The generated pressure mean: 0.44497013092041016
loss_pred:0.02053607441484928, decouple_loss:0.0032867782283574343
Iteration: 5992, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4586118757724762
loss_pred:0.021532321348786354, decouple_loss:0.003243550192564726
The generated pressure mean: 0.4541899859905243
loss_pred:0.019538244232535362, decouple_loss:0.0031216349452733994
The generated pressure mean: 0.45451971888542175
loss_pred:0.018442314118146896, decouple_loss:0.003085828386247158
Iteration: 5993, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466142952442169
loss_pred:0.020786501467227936, decouple_loss:0.003225460648536682
The generated pressure mean: 0.4442121088504791
loss_pred:0.01922818273305893, decouple_loss:0.002947163302451372
The generated pressure mean: 0.44644561409950256
loss_pred:0.01800990290939808, decouple_loss:0.0028412267565727234
Iteration: 5994, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4421784579753876
The generated pressure mean: 0.44456422328948975
loss_pred:0.01906490884721279, decouple_loss:0.0028788624331355095
loss_pred:0.01867954060435295, decouple_loss:0.002867035334929824
The generated pressure mean: 0.44070932269096375
loss_pred:0.020120296627283096, decouple_loss:0.00285375420935452
Iteration: 5995, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490634500980377
loss_pred:0.018191592767834663, decouple_loss:0.003171892836689949
The generated pressure mean: 0.4455942213535309
loss_pred:0.01874767802655697, decouple_loss:0.0032135252840816975
The generated pressure mean: 0.44634777307510376
loss_pred:0.019090447574853897, decouple_loss:0.0031726860906928778
Iteration: 5996, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4532894194126129
loss_pred:0.021018143743276596, decouple_loss:0.003232769202440977
The generated pressure mean: 0.4517700970172882
loss_pred:0.01870044879615307, decouple_loss:0.0031757927499711514
The generated pressure mean: 0.45520326495170593
loss_pred:0.019421525299549103, decouple_loss:0.0033368612639606
Iteration: 5997, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4443691074848175
The generated pressure mean: 0.4443614184856415
loss_pred:0.018225425854325294, decouple_loss:0.0031460472382605076
loss_pred:0.01961270160973072, decouple_loss:0.0034751947969198227
The generated pressure mean: 0.44185152649879456
loss_pred:0.019372468814253807, decouple_loss:0.0032085522543638945
Iteration: 5998, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44825515151023865
loss_pred:0.019238881766796112, decouple_loss:0.003011055989190936
The generated pressure mean: 0.4445992708206177
The generated pressure mean: 0.4424768388271332
loss_pred:0.02139914035797119, decouple_loss:0.003177409991621971
loss_pred:0.020691702142357826, decouple_loss:0.0031155559699982405
Iteration: 5999, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4537143111228943
loss_pred:0.018490780144929886, decouple_loss:0.0027562372852116823
The generated pressure mean: 0.45659124851226807
loss_pred:0.0185374915599823, decouple_loss:0.002814838197082281
The generated pressure mean: 0.45285093784332275
loss_pred:0.017852049320936203, decouple_loss:0.0027315800543874502
Iteration: 6000, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4520375430583954
loss_pred:0.01769556663930416, decouple_loss:0.0034154332242906094
The generated pressure mean: 0.4502853751182556
loss_pred:0.021402498707175255, decouple_loss:0.0032342062331736088
The generated pressure mean: 0.4481654763221741
loss_pred:0.018249982967972755, decouple_loss:0.0033746727276593447
2023-04-17 10:24:35 itr: 6000
training loss: [0.01841872 0.01786634 0.02156421]
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_0_EH_1_PS_40/model_6000.ckpt
2023-04-17 10:24:39 testing...
The generated pressure mean: 0.4170447587966919
The generated pressure mean: 0.42517051100730896
The generated pressure mean: 0.4283920228481293
loss_pred:0.031854692846536636, decouple_loss:0.0035457597114145756
loss_pred:0.03090510703623295, decouple_loss:0.0037806194741278887
loss_pred:0.030709346756339073, decouple_loss:0.003941612783819437
WV_0_PC_0_EH_1_PS_40, loss: 0.031344182789325714, avg_mse: 0.046151429414749146
current test mse: 0.046151
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 6001, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4406246542930603
loss_pred:0.019747454673051834, decouple_loss:0.0029323981143534184
The generated pressure mean: 0.4357389211654663
loss_pred:0.019659340381622314, decouple_loss:0.0031868545338511467
The generated pressure mean: 0.43837136030197144
loss_pred:0.019356744363904, decouple_loss:0.003244072664529085
Iteration: 6002, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44835036993026733
The generated pressure mean: 0.4467502534389496
loss_pred:0.018860628828406334, decouple_loss:0.0038842298090457916
loss_pred:0.018402758985757828, decouple_loss:0.003595789195969701
The generated pressure mean: 0.4463575482368469
loss_pred:0.02034742385149002, decouple_loss:0.0035383079666644335
Iteration: 6003, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4510079324245453
The generated pressure mean: 0.451653391122818loss_pred:0.022796696051955223, decouple_loss:0.004162706434726715
loss_pred:0.02045527659356594, decouple_loss:0.004056583158671856
The generated pressure mean: 0.44588252902030945
loss_pred:0.01942000724375248, decouple_loss:0.004146534483879805
Iteration: 6004, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4375007450580597
The generated pressure mean: 0.43321970105171204
loss_pred:0.016862256452441216, decouple_loss:0.0032463481184095144
loss_pred:0.02043420821428299, decouple_loss:0.0032391531858593225
The generated pressure mean: 0.4360724091529846
loss_pred:0.019067276269197464, decouple_loss:0.0032851682044565678
Iteration: 6005, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4432391822338104
loss_pred:0.01869148015975952, decouple_loss:0.0035667670890688896
The generated pressure mean: 0.44360193610191345
loss_pred:0.019798196852207184, decouple_loss:0.0035514517221599817
The generated pressure mean: 0.4463045299053192
loss_pred:0.020802052691578865, decouple_loss:0.003737263847142458
Iteration: 6006, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45146146416664124
loss_pred:0.01851879246532917, decouple_loss:0.0035106323193758726
The generated pressure mean: 0.4565449357032776
loss_pred:0.021450480446219444, decouple_loss:0.003641246585175395
The generated pressure mean: 0.45527905225753784
loss_pred:0.020090699195861816, decouple_loss:0.003510026726871729
Iteration: 6007, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44763168692588806
The generated pressure mean: 0.4406300187110901
loss_pred:0.018214650452136993, decouple_loss:0.00397803308442235
loss_pred:0.018807891756296158, decouple_loss:0.003982096910476685
The generated pressure mean: 0.44267186522483826
loss_pred:0.019864339381456375, decouple_loss:0.004013638943433762
Iteration: 6008, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468136131763458
loss_pred:0.018615296110510826, decouple_loss:0.003495828714221716
The generated pressure mean: 0.4429675042629242
loss_pred:0.01941312476992607, decouple_loss:0.0032982882112264633
The generated pressure mean: 0.44880789518356323
loss_pred:0.020013101398944855, decouple_loss:0.0033603969495743513
Iteration: 6009, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44520971179008484
The generated pressure mean: 0.4443635940551758
loss_pred:0.01829300820827484, decouple_loss:0.003201377345249057
loss_pred:0.020135194063186646, decouple_loss:0.003472145413979888
The generated pressure mean: 0.43990328907966614
loss_pred:0.0197967067360878, decouple_loss:0.0035240992438048124
Iteration: 6010, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43960919976234436
The generated pressure mean: 0.44235149025917053
loss_pred:0.01897536963224411, decouple_loss:0.004142154939472675
loss_pred:0.020084518939256668, decouple_loss:0.004254727624356747
The generated pressure mean: 0.4452718496322632
loss_pred:0.017785130068659782, decouple_loss:0.004113461822271347
2023-04-17 10:27:09 testing...
The generated pressure mean: 0.41232380270957947
The generated pressure mean: 0.4210646450519562
The generated pressure mean: 0.42443186044692993
loss_pred:0.03281748294830322, decouple_loss:0.003970509395003319
loss_pred:0.03138842061161995, decouple_loss:0.0042027742601931095
loss_pred:0.03123684972524643, decouple_loss:0.004439730197191238
WV_0_PC_0_EH_1_PS_40, loss: 0.03202446922659874, avg_mse: 0.04787572845816612
current test mse: 0.047876
Iteration: 6011, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45136016607284546
The generated pressure mean: 0.4534870386123657
loss_pred:0.018985699862241745, decouple_loss:0.003633524989709258
loss_pred:0.018617531284689903, decouple_loss:0.0034836987033486366
The generated pressure mean: 0.4527251422405243
loss_pred:0.01836233399808407, decouple_loss:0.0036313491873443127
Iteration: 6012, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.453264981508255
loss_pred:0.018869807943701744, decouple_loss:0.002897013910114765
The generated pressure mean: 0.4459179639816284
loss_pred:0.018707210198044777, decouple_loss:0.0029767025262117386
The generated pressure mean: 0.4501952826976776
loss_pred:0.01813514530658722, decouple_loss:0.002835796447470784
Iteration: 6013, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44342848658561707
The generated pressure mean: 0.4391389787197113loss_pred:0.01850021630525589, decouple_loss:0.0037229459267109632
loss_pred:0.018069323152303696, decouple_loss:0.003712248522788286
The generated pressure mean: 0.44339248538017273
loss_pred:0.019473910331726074, decouple_loss:0.003665215102955699
Iteration: 6014, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44027090072631836
The generated pressure mean: 0.4428386986255646
loss_pred:0.0208600964397192, decouple_loss:0.004037879873067141
loss_pred:0.018761565908789635, decouple_loss:0.004143219441175461
The generated pressure mean: 0.4422341287136078
loss_pred:0.018841050565242767, decouple_loss:0.0040307254530489445
Iteration: 6015, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4443250596523285
The generated pressure mean: 0.4474666118621826
loss_pred:0.01937159337103367, decouple_loss:0.003174214856699109
loss_pred:0.019223488867282867, decouple_loss:0.003090963000431657
The generated pressure mean: 0.446106493473053
loss_pred:0.018418099731206894, decouple_loss:0.0030928405467420816
Iteration: 6016, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45636722445487976
The generated pressure mean: 0.4506269097328186
loss_pred:0.018387556076049805, decouple_loss:0.0029768708627671003
loss_pred:0.018619703128933907, decouple_loss:0.0029285519849509
The generated pressure mean: 0.4467591643333435
loss_pred:0.01956780068576336, decouple_loss:0.0030557664576917887
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 6017, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44397714734077454
The generated pressure mean: 0.4459604024887085
loss_pred:0.018773607909679413, decouple_loss:0.002812957391142845
loss_pred:0.020546339452266693, decouple_loss:0.00288791093043983
The generated pressure mean: 0.45211535692214966
loss_pred:0.019855165854096413, decouple_loss:0.003017876297235489
Iteration: 6018, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43353602290153503
loss_pred:0.020131424069404602, decouple_loss:0.0031385307665914297
The generated pressure mean: 0.43188610672950745
loss_pred:0.020903510972857475, decouple_loss:0.003083752002567053
The generated pressure mean: 0.43895772099494934
loss_pred:0.020985938608646393, decouple_loss:0.003114926628768444
Iteration: 6019, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44618311524391174
loss_pred:0.018393591046333313, decouple_loss:0.0033475609961897135
The generated pressure mean: 0.44659343361854553
loss_pred:0.01937994547188282, decouple_loss:0.003276244970038533
The generated pressure mean: 0.44696280360221863
loss_pred:0.018867190927267075, decouple_loss:0.0033743218518793583
Iteration: 6020, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4580865204334259
The generated pressure mean: 0.4549122750759125
loss_pred:0.01891247183084488, decouple_loss:0.0032933091279119253
loss_pred:0.017416471615433693, decouple_loss:0.0034144038800150156
The generated pressure mean: 0.45660802721977234
loss_pred:0.019190385937690735, decouple_loss:0.0033085839822888374
2023-04-17 10:29:00 testing...
The generated pressure mean: 0.4213266372680664
The generated pressure mean: 0.4131358563899994
The generated pressure mean: 0.42419636249542236
loss_pred:0.0315486416220665, decouple_loss:0.00406124209985137
loss_pred:0.032904934138059616, decouple_loss:0.00393828796222806
loss_pred:0.031003370881080627, decouple_loss:0.004232287406921387
WV_0_PC_0_EH_1_PS_40, loss: 0.03202284872531891, avg_mse: 0.04733700677752495
current test mse: 0.047337
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 6021, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4557003676891327
loss_pred:0.018714528530836105, decouple_loss:0.003714565187692642
The generated pressure mean: 0.4541562497615814
The generated pressure mean: 0.4535667300224304
loss_pred:0.01946963183581829, decouple_loss:0.0036468387115746737
loss_pred:0.020907487720251083, decouple_loss:0.003561422461643815
Iteration: 6022, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4398050606250763
The generated pressure mean: 0.442053884267807
loss_pred:0.019582457840442657, decouple_loss:0.004185514524579048
loss_pred:0.020224949344992638, decouple_loss:0.00409361720085144
The generated pressure mean: 0.4427160322666168
loss_pred:0.01884990744292736, decouple_loss:0.004225973971188068
Iteration: 6023, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43902868032455444
loss_pred:0.01941790245473385, decouple_loss:0.0037673786282539368
The generated pressure mean: 0.43876010179519653
loss_pred:0.01863454468548298, decouple_loss:0.003624045057222247
The generated pressure mean: 0.43516573309898376
loss_pred:0.01940174773335457, decouple_loss:0.003918550908565521
Iteration: 6024, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45578938722610474
The generated pressure mean: 0.453622043132782
loss_pred:0.019312603399157524, decouple_loss:0.004670481197535992
loss_pred:0.018605997785925865, decouple_loss:0.004824378527700901
The generated pressure mean: 0.45129531621932983
loss_pred:0.018642116338014603, decouple_loss:0.00493360310792923
Iteration: 6025, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4541182518005371
The generated pressure mean: 0.4480590224266052
loss_pred:0.019977519288659096, decouple_loss:0.003734992351382971
loss_pred:0.01821443997323513, decouple_loss:0.0035554422065615654
The generated pressure mean: 0.46139973402023315
loss_pred:0.020617689937353134, decouple_loss:0.003613763488829136
Iteration: 6026, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4422084391117096
The generated pressure mean: 0.4443921744823456
loss_pred:0.020411154255270958, decouple_loss:0.005001829005777836
loss_pred:0.01917693018913269, decouple_loss:0.004970243666321039
The generated pressure mean: 0.4436834752559662
loss_pred:0.018459666520357132, decouple_loss:0.0051363022066652775
Iteration: 6027, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4425686001777649
The generated pressure mean: 0.44222792983055115loss_pred:0.02033289335668087, decouple_loss:0.0038876954931765795
loss_pred:0.02015908993780613, decouple_loss:0.004096210468560457
The generated pressure mean: 0.4478054642677307
loss_pred:0.020826280117034912, decouple_loss:0.003967315424233675
Iteration: 6028, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494996666908264
loss_pred:0.017988795414566994, decouple_loss:0.0047868299297988415
The generated pressure mean: 0.44808229804039
loss_pred:0.018806304782629013, decouple_loss:0.004830776713788509
The generated pressure mean: 0.4475938379764557
loss_pred:0.019463885575532913, decouple_loss:0.0048272195272147655
Iteration: 6029, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4522983431816101
The generated pressure mean: 0.44978904724121094
loss_pred:0.019672652706503868, decouple_loss:0.0039060215931385756
loss_pred:0.018870245665311813, decouple_loss:0.003807191736996174
The generated pressure mean: 0.4536792039871216
loss_pred:0.01917477697134018, decouple_loss:0.003970786463469267
Iteration: 6030, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44849884510040283The generated pressure mean: 0.4434949457645416
loss_pred:0.01950027421116829, decouple_loss:0.003499246435239911loss_pred:0.020093979313969612, decouple_loss:0.0033379297237843275
The generated pressure mean: 0.4488897919654846
loss_pred:0.019394688308238983, decouple_loss:0.003379005705937743
2023-04-17 10:31:28 testing...
The generated pressure mean: 0.41392573714256287
The generated pressure mean: 0.42339566349983215
The generated pressure mean: 0.4264101982116699
loss_pred:0.033089153468608856, decouple_loss:0.004567443393170834
loss_pred:0.031998541206121445, decouple_loss:0.004850576166063547
loss_pred:0.03158843144774437, decouple_loss:0.005067281424999237
WV_0_PC_0_EH_1_PS_40, loss: 0.03246679902076721, avg_mse: 0.048948753625154495
current test mse: 0.048949
Iteration: 6031, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4526384174823761
loss_pred:0.018494965508580208, decouple_loss:0.004116082098335028
The generated pressure mean: 0.44887465238571167
loss_pred:0.019576238468289375, decouple_loss:0.004226098768413067
The generated pressure mean: 0.4496178925037384
loss_pred:0.01938997395336628, decouple_loss:0.00411171093583107
Iteration: 6032, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43878695368766785
loss_pred:0.018790053203701973, decouple_loss:0.004041134845465422
The generated pressure mean: 0.44346320629119873
loss_pred:0.019262129440903664, decouple_loss:0.00402132049202919
The generated pressure mean: 0.44050920009613037
loss_pred:0.020659947767853737, decouple_loss:0.003979654051363468
Iteration: 6033, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4513893127441406
loss_pred:0.021264977753162384, decouple_loss:0.00404060585424304
The generated pressure mean: 0.4542134404182434
loss_pred:0.01961478218436241, decouple_loss:0.00392021844163537
The generated pressure mean: 0.45275142788887024
loss_pred:0.01908985525369644, decouple_loss:0.004166025202721357
Iteration: 6034, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4369553029537201
loss_pred:0.018349621444940567, decouple_loss:0.0038772050756961107
The generated pressure mean: 0.4403045177459717
loss_pred:0.020520903170108795, decouple_loss:0.0038448020350188017
The generated pressure mean: 0.4342860281467438
loss_pred:0.019240960478782654, decouple_loss:0.0036347343120723963
Iteration: 6035, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469626843929291
loss_pred:0.018378861248493195, decouple_loss:0.003035829635336995The generated pressure mean: 0.45231902599334717
loss_pred:0.019561462104320526, decouple_loss:0.0030535508412867785
The generated pressure mean: 0.45255783200263977
loss_pred:0.01887856051325798, decouple_loss:0.003150485223159194
Iteration: 6036, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.462420791387558
loss_pred:0.01961394026875496, decouple_loss:0.0033011517953127623
The generated pressure mean: 0.45583319664001465
loss_pred:0.017940068617463112, decouple_loss:0.003375329775735736
The generated pressure mean: 0.46465688943862915
loss_pred:0.019139263778924942, decouple_loss:0.0033514590468257666
Iteration: 6037, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43709689378738403
loss_pred:0.018989255651831627, decouple_loss:0.002606839407235384
The generated pressure mean: 0.438949316740036
loss_pred:0.019518757238984108, decouple_loss:0.0026844392996281385
The generated pressure mean: 0.4345363676548004
loss_pred:0.018510369583964348, decouple_loss:0.0026446024421602488
Iteration: 6038, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4352933168411255
loss_pred:0.02048981562256813, decouple_loss:0.0036715830210596323
The generated pressure mean: 0.43400415778160095
loss_pred:0.018879204988479614, decouple_loss:0.0034232160542160273
The generated pressure mean: 0.43562814593315125
loss_pred:0.019350768998265266, decouple_loss:0.0032781723421067
Iteration: 6039, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4567464590072632
loss_pred:0.017822647467255592, decouple_loss:0.00310721923597157
The generated pressure mean: 0.457075297832489
loss_pred:0.01884712651371956, decouple_loss:0.0031922534108161926
The generated pressure mean: 0.45509737730026245
loss_pred:0.019069496542215347, decouple_loss:0.0031097112223505974
Iteration: 6040, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4604262113571167
loss_pred:0.01878327876329422, decouple_loss:0.003261064412072301
The generated pressure mean: 0.45772305130958557
loss_pred:0.01982111670076847, decouple_loss:0.003216818906366825
The generated pressure mean: 0.4550142288208008
loss_pred:0.018895845860242844, decouple_loss:0.0032026241533458233
2023-04-17 10:33:22 testing...
The generated pressure mean: 0.4149562418460846
The generated pressure mean: 0.4220936894416809
The generated pressure mean: 0.4249674379825592
loss_pred:0.03221137076616287, decouple_loss:0.004149308893829584
loss_pred:0.030980916693806648, decouple_loss:0.0043652672320604324
loss_pred:0.030701372772455215, decouple_loss:0.00451211491599679
WV_0_PC_0_EH_1_PS_40, loss: 0.03151499852538109, avg_mse: 0.04661857709288597
current test mse: 0.046619
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
Iteration: 6041, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43633052706718445
loss_pred:0.019330866634845734, decouple_loss:0.0038680799771100283
The generated pressure mean: 0.4443345367908478
loss_pred:0.01927139051258564, decouple_loss:0.0036887414753437042
The generated pressure mean: 0.4378896653652191
loss_pred:0.020317768678069115, decouple_loss:0.003879221621900797
Iteration: 6042, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44172653555870056
The generated pressure mean: 0.4388791620731354
loss_pred:0.020126517862081528, decouple_loss:0.003265680745244026
loss_pred:0.020493002608418465, decouple_loss:0.003438119776546955
The generated pressure mean: 0.4383319020271301
loss_pred:0.019822867587208748, decouple_loss:0.0035663594026118517
Iteration: 6043, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497879147529602
The generated pressure mean: 0.4491408169269562
loss_pred:0.021312234923243523, decouple_loss:0.003202585270628333
loss_pred:0.019823018461465836, decouple_loss:0.003130949568003416
The generated pressure mean: 0.44972658157348633
loss_pred:0.019565371796488762, decouple_loss:0.003225086024031043
Iteration: 6044, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4390247166156769
The generated pressure mean: 0.4455748498439789
loss_pred:0.018971987068653107, decouple_loss:0.0037786317989230156
loss_pred:0.019704191014170647, decouple_loss:0.0035089312586933374
The generated pressure mean: 0.4443347156047821
loss_pred:0.01959817484021187, decouple_loss:0.0037549789994955063
Iteration: 6045, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44346755743026733The generated pressure mean: 0.44588062167167664
loss_pred:0.01943385601043701, decouple_loss:0.0032490878365933895
loss_pred:0.0202272217720747, decouple_loss:0.0032233144156634808
The generated pressure mean: 0.4407653510570526
loss_pred:0.020112650468945503, decouple_loss:0.003345207776874304
Iteration: 6046, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4530523419380188The generated pressure mean: 0.44791117310523987
loss_pred:0.01872009038925171, decouple_loss:0.0031467918306589127loss_pred:0.019278738647699356, decouple_loss:0.0031870503444224596
The generated pressure mean: 0.45616379380226135
loss_pred:0.01886480115354061, decouple_loss:0.003134074155241251
Iteration: 6047, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45375555753707886
The generated pressure mean: 0.45073196291923523
loss_pred:0.02075284905731678, decouple_loss:0.003958164248615503
loss_pred:0.01948075369000435, decouple_loss:0.0042089126072824
The generated pressure mean: 0.45532071590423584
loss_pred:0.019892577081918716, decouple_loss:0.004086617846041918
Iteration: 6048, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4323166310787201
The generated pressure mean: 0.43464845418930054
loss_pred:0.020576588809490204, decouple_loss:0.003061003750190139
loss_pred:0.020326748490333557, decouple_loss:0.003037493210285902
The generated pressure mean: 0.43849438428878784
loss_pred:0.018373476341366768, decouple_loss:0.0029996722005307674
Iteration: 6049, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4363687038421631
The generated pressure mean: 0.4343249499797821
loss_pred:0.019964419305324554, decouple_loss:0.0034728667233139277
loss_pred:0.02126370184123516, decouple_loss:0.0034649367444217205
The generated pressure mean: 0.43373432755470276
loss_pred:0.019390227273106575, decouple_loss:0.003514795331284404
Iteration: 6050, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4543808400630951The generated pressure mean: 0.45278260111808777
loss_pred:0.019631387665867805, decouple_loss:0.0036171211395412683
loss_pred:0.01928086392581463, decouple_loss:0.003703662659972906
The generated pressure mean: 0.45058950781822205
loss_pred:0.019749954342842102, decouple_loss:0.003622278105467558
2023-04-17 10:35:56 testing...
The generated pressure mean: 0.4133363664150238
The generated pressure mean: 0.42106345295906067
loss_pred:0.03204686939716339, decouple_loss:0.003686146344989538
The generated pressure mean: 0.42396068572998047
loss_pred:0.030945001170039177, decouple_loss:0.003926925361156464
loss_pred:0.030417146161198616, decouple_loss:0.004001581575721502
WV_0_PC_0_EH_1_PS_40, loss: 0.0313299186527729, avg_mse: 0.04620342329144478
current test mse: 0.046203
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 6051, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4561774432659149
loss_pred:0.021428028121590614, decouple_loss:0.003184365341439843
The generated pressure mean: 0.4502708613872528
loss_pred:0.018628939986228943, decouple_loss:0.0029840709175914526
The generated pressure mean: 0.4491862952709198
loss_pred:0.019210800528526306, decouple_loss:0.0030386948492377996
Iteration: 6052, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44310352206230164
loss_pred:0.019161149859428406, decouple_loss:0.003027919912710786
The generated pressure mean: 0.4544845223426819
loss_pred:0.020578457042574883, decouple_loss:0.003258919343352318
The generated pressure mean: 0.45067065954208374
loss_pred:0.020127685740590096, decouple_loss:0.00307463388890028
Iteration: 6053, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4321507513523102
loss_pred:0.018792901188135147, decouple_loss:0.003293869784101844
The generated pressure mean: 0.4349493682384491
loss_pred:0.01935330033302307, decouple_loss:0.003295921254903078
The generated pressure mean: 0.4326918423175812
loss_pred:0.018427547067403793, decouple_loss:0.003467800095677376
Iteration: 6054, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44503432512283325
loss_pred:0.01982976496219635, decouple_loss:0.0030579527374356985
The generated pressure mean: 0.44795435667037964
loss_pred:0.021113991737365723, decouple_loss:0.003203540574759245
The generated pressure mean: 0.4439546465873718
loss_pred:0.01936199516057968, decouple_loss:0.0032355650328099728
Iteration: 6055, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4419296085834503
loss_pred:0.02007110044360161, decouple_loss:0.002952678594738245
The generated pressure mean: 0.4442286491394043
loss_pred:0.021417776122689247, decouple_loss:0.002938134828582406
The generated pressure mean: 0.4435434937477112
loss_pred:0.019486509263515472, decouple_loss:0.0029893985483795404
Iteration: 6056, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4526336193084717
loss_pred:0.01985342800617218, decouple_loss:0.002918141894042492
The generated pressure mean: 0.451815664768219
loss_pred:0.020244905725121498, decouple_loss:0.0027941351290792227
The generated pressure mean: 0.4562707543373108
loss_pred:0.02092512510716915, decouple_loss:0.002960074692964554
Iteration: 6057, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44401875138282776
loss_pred:0.0192880779504776, decouple_loss:0.002802665578201413
The generated pressure mean: 0.4467836022377014
loss_pred:0.020329119637608528, decouple_loss:0.0028213071636855602
The generated pressure mean: 0.4415399730205536
loss_pred:0.020202312618494034, decouple_loss:0.0028605726547539234
Iteration: 6058, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4505043625831604
The generated pressure mean: 0.44592803716659546
loss_pred:0.02415851503610611, decouple_loss:0.0029224203899502754
loss_pred:0.01855875365436077, decouple_loss:0.0028104917146265507
The generated pressure mean: 0.4468313455581665
loss_pred:0.020803656429052353, decouple_loss:0.0029693194665014744
Iteration: 6059, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43905073404312134
loss_pred:0.01887919381260872, decouple_loss:0.0032517306972295046
The generated pressure mean: 0.4398757219314575
loss_pred:0.020816128700971603, decouple_loss:0.0034172721207141876
The generated pressure mean: 0.44257035851478577
loss_pred:0.02308553084731102, decouple_loss:0.003216650802642107
Iteration: 6060, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471248388290405
loss_pred:0.01884331926703453, decouple_loss:0.0030142238829284906
The generated pressure mean: 0.4432893395423889
loss_pred:0.023789873346686363, decouple_loss:0.0030388017185032368
The generated pressure mean: 0.43991464376449585
loss_pred:0.020367614924907684, decouple_loss:0.0031603071838617325
2023-04-17 10:37:49 testing...
The generated pressure mean: 0.4146471619606018
The generated pressure mean: 0.4216322600841522
The generated pressure mean: 0.4242038428783417
loss_pred:0.03247598186135292, decouple_loss:0.003205907065421343
loss_pred:0.03144121542572975, decouple_loss:0.003549466375261545
loss_pred:0.03110944665968418, decouple_loss:0.003699558787047863
WV_0_PC_0_EH_1_PS_40, loss: 0.03184979781508446, avg_mse: 0.04704345762729645
current test mse: 0.047043
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 6061, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452817440032959
loss_pred:0.01772836409509182, decouple_loss:0.0029685799963772297
The generated pressure mean: 0.44357943534851074
loss_pred:0.019443022087216377, decouple_loss:0.003061199327930808
The generated pressure mean: 0.43900907039642334
loss_pred:0.020276956260204315, decouple_loss:0.0030581955797970295
Iteration: 6062, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45397353172302246
The generated pressure mean: 0.45227429270744324
loss_pred:0.018814701586961746, decouple_loss:0.0028698211535811424
loss_pred:0.020455630496144295, decouple_loss:0.0028878310695290565
The generated pressure mean: 0.4549922049045563
loss_pred:0.018772918730974197, decouple_loss:0.0028843034524470568
Iteration: 6063, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471002221107483
loss_pred:0.018908819183707237, decouple_loss:0.004030127543956041
The generated pressure mean: 0.4470612704753876
loss_pred:0.019853442907333374, decouple_loss:0.003933745436370373
The generated pressure mean: 0.4415634870529175
loss_pred:0.018549475818872452, decouple_loss:0.003837979631498456
Iteration: 6064, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449063837528229
loss_pred:0.019846750423312187, decouple_loss:0.0034874447155743837
The generated pressure mean: 0.4424556791782379
loss_pred:0.01927315443754196, decouple_loss:0.003535804571583867
The generated pressure mean: 0.44111502170562744
loss_pred:0.01951439678668976, decouple_loss:0.0035378190223127604
Iteration: 6065, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.444530725479126
loss_pred:0.017603052780032158, decouple_loss:0.0030823710840195417
The generated pressure mean: 0.44571202993392944
loss_pred:0.01996585540473461, decouple_loss:0.0031549257691949606
The generated pressure mean: 0.4425510764122009
loss_pred:0.0199943445622921, decouple_loss:0.0031211362220346928
Iteration: 6066, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44554826617240906
loss_pred:0.019931035116314888, decouple_loss:0.004290608689188957
The generated pressure mean: 0.4496435225009918
loss_pred:0.018431320786476135, decouple_loss:0.004319815896451473
The generated pressure mean: 0.4537345767021179
loss_pred:0.018764778971672058, decouple_loss:0.004224489443004131
Iteration: 6067, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44215452671051025
loss_pred:0.018429549410939217, decouple_loss:0.0031497173476964235
The generated pressure mean: 0.44442951679229736
loss_pred:0.01929396577179432, decouple_loss:0.0031536968890577555
The generated pressure mean: 0.44756361842155457
loss_pred:0.018661363050341606, decouple_loss:0.003301021410152316
Iteration: 6068, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492497444152832
loss_pred:0.017175382003188133, decouple_loss:0.0036457807291299105
The generated pressure mean: 0.45051494240760803
loss_pred:0.019684763625264168, decouple_loss:0.003790204180404544
The generated pressure mean: 0.45018455386161804
loss_pred:0.019093340262770653, decouple_loss:0.0035797851160168648
Iteration: 6069, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4433429539203644
The generated pressure mean: 0.4432249069213867
loss_pred:0.019628046080470085, decouple_loss:0.003585333004593849
loss_pred:0.019306650385260582, decouple_loss:0.00359302363358438
The generated pressure mean: 0.44506216049194336
loss_pred:0.018640559166669846, decouple_loss:0.003573174588382244
Iteration: 6070, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43986794352531433
loss_pred:0.019373469054698944, decouple_loss:0.0035088660661131144The generated pressure mean: 0.4412098228931427
loss_pred:0.017821406945586205, decouple_loss:0.0034406816121190786
The generated pressure mean: 0.4393867552280426
loss_pred:0.018534906208515167, decouple_loss:0.0033373706974089146
2023-04-17 10:40:19 testing...
The generated pressure mean: 0.4130862057209015
The generated pressure mean: 0.4205518066883087
loss_pred:0.03320131450891495, decouple_loss:0.0037311245687305927
The generated pressure mean: 0.4225930869579315
loss_pred:0.03202255070209503, decouple_loss:0.003915280569344759
loss_pred:0.03187321871519089, decouple_loss:0.004057093057781458
WV_0_PC_0_EH_1_PS_40, loss: 0.03256075456738472, avg_mse: 0.048571012914180756
current test mse: 0.048571
Iteration: 6071, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4531671702861786
The generated pressure mean: 0.45159539580345154
loss_pred:0.019878260791301727, decouple_loss:0.003339035203680396
loss_pred:0.017966432496905327, decouple_loss:0.003468137700110674
The generated pressure mean: 0.447414755821228
loss_pred:0.018469642847776413, decouple_loss:0.0035370890982449055
Iteration: 6072, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.450810045003891
The generated pressure mean: 0.44847580790519714
loss_pred:0.019219383597373962, decouple_loss:0.0028439818415790796
loss_pred:0.0191695187240839, decouple_loss:0.0028869607485830784
The generated pressure mean: 0.45225030183792114
loss_pred:0.017727429047226906, decouple_loss:0.0028810733929276466
Iteration: 6073, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44454124569892883
The generated pressure mean: 0.4414790868759155
loss_pred:0.017344284802675247, decouple_loss:0.0028044700156897306
loss_pred:0.019023828208446503, decouple_loss:0.002744547789916396
The generated pressure mean: 0.44452160596847534
loss_pred:0.019485853612422943, decouple_loss:0.002673529554158449
Iteration: 6074, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469435513019562
The generated pressure mean: 0.4470358192920685
loss_pred:0.019669879227876663, decouple_loss:0.0032237342093139887
loss_pred:0.01805201917886734, decouple_loss:0.003313045483082533
The generated pressure mean: 0.44965678453445435
loss_pred:0.02011995203793049, decouple_loss:0.003356597386300564
Iteration: 6075, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43826717138290405
The generated pressure mean: 0.435689777135849
loss_pred:0.021130723878741264, decouple_loss:0.0029064505361020565
loss_pred:0.01921577751636505, decouple_loss:0.003113815560936928
The generated pressure mean: 0.442963182926178
loss_pred:0.0191202275454998, decouple_loss:0.0029896306805312634
Iteration: 6076, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4456220865249634
The generated pressure mean: 0.44491007924079895
loss_pred:0.018110765144228935, decouple_loss:0.0029421146027743816
loss_pred:0.019603000953793526, decouple_loss:0.0030303082894533873
The generated pressure mean: 0.442253440618515
loss_pred:0.019153179600834846, decouple_loss:0.002977559808641672
Iteration: 6077, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4521879255771637
The generated pressure mean: 0.45748084783554077
loss_pred:0.01779567264020443, decouple_loss:0.0026700147427618504
loss_pred:0.019920356571674347, decouple_loss:0.002724763471633196
The generated pressure mean: 0.4553121030330658
loss_pred:0.018973274156451225, decouple_loss:0.002768327249214053
Iteration: 6078, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503301680088043
loss_pred:0.020498687401413918, decouple_loss:0.0035234384704381227
The generated pressure mean: 0.4490605294704437
loss_pred:0.018815265968441963, decouple_loss:0.003390653757378459
The generated pressure mean: 0.4487345814704895
loss_pred:0.018238749355077744, decouple_loss:0.003504798747599125
Iteration: 6079, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4387286603450775
loss_pred:0.019699962809681892, decouple_loss:0.002974549075588584
The generated pressure mean: 0.4314843416213989
loss_pred:0.018484007567167282, decouple_loss:0.002950528170913458
The generated pressure mean: 0.4343086779117584
loss_pred:0.01918327622115612, decouple_loss:0.0030327653512358665
Iteration: 6080, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4568042457103729
loss_pred:0.019529184326529503, decouple_loss:0.004243069794028997
The generated pressure mean: 0.45048874616622925
loss_pred:0.019211985170841217, decouple_loss:0.003860984230414033
The generated pressure mean: 0.45179012417793274
loss_pred:0.019849177449941635, decouple_loss:0.004059704951941967
2023-04-17 10:42:12 testing...
The generated pressure mean: 0.4147259294986725
The generated pressure mean: 0.42271649837493896
loss_pred:0.032428767532110214, decouple_loss:0.003495204960927367
The generated pressure mean: 0.42535659670829773
loss_pred:0.03136133775115013, decouple_loss:0.0036101853474974632
loss_pred:0.03111434169113636, decouple_loss:0.003826117841526866
WV_0_PC_0_EH_1_PS_40, loss: 0.031817007809877396, avg_mse: 0.04736630618572235
current test mse: 0.047366
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 6081, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494777023792267
loss_pred:0.019118936732411385, decouple_loss:0.002891324460506439
The generated pressure mean: 0.44363483786582947
loss_pred:0.019308848306536674, decouple_loss:0.002885126043111086
The generated pressure mean: 0.4441409409046173
loss_pred:0.018489299342036247, decouple_loss:0.002940874081104994
Iteration: 6082, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503686726093292
loss_pred:0.017624063417315483, decouple_loss:0.0033480175770819187
The generated pressure mean: 0.45055246353149414
loss_pred:0.01800726167857647, decouple_loss:0.0032957533840090036
The generated pressure mean: 0.44980183243751526
loss_pred:0.019622372463345528, decouple_loss:0.0033804932609200478
Iteration: 6083, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4425806999206543
The generated pressure mean: 0.44772040843963623
loss_pred:0.018157975748181343, decouple_loss:0.004173802211880684
loss_pred:0.01858450099825859, decouple_loss:0.003945620264858007
The generated pressure mean: 0.4443083703517914
loss_pred:0.01785155199468136, decouple_loss:0.004143064375966787
Iteration: 6084, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459596276283264The generated pressure mean: 0.44596830010414124
loss_pred:0.02040472812950611, decouple_loss:0.0026483582332730293
loss_pred:0.01772923767566681, decouple_loss:0.0026041625533252954
The generated pressure mean: 0.44540297985076904
loss_pred:0.018423881381750107, decouple_loss:0.00265317689627409
Iteration: 6085, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44341644644737244
The generated pressure mean: 0.4423946142196655
loss_pred:0.018153931945562363, decouple_loss:0.0029985480941832066
loss_pred:0.0186744537204504, decouple_loss:0.0030170404352247715
The generated pressure mean: 0.44401612877845764
loss_pred:0.019085675477981567, decouple_loss:0.0030524171888828278
Iteration: 6086, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44672733545303345
The generated pressure mean: 0.44690972566604614
loss_pred:0.019674062728881836, decouple_loss:0.004209393169730902
loss_pred:0.01802581362426281, decouple_loss:0.003993569407612085
The generated pressure mean: 0.44819530844688416
loss_pred:0.018740804865956306, decouple_loss:0.00395539216697216
Iteration: 6087, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4540296792984009
loss_pred:0.018576379865407944, decouple_loss:0.0027368678711354733
The generated pressure mean: 0.4545685648918152
loss_pred:0.018634779378771782, decouple_loss:0.002580194268375635
The generated pressure mean: 0.45564064383506775
loss_pred:0.01877543330192566, decouple_loss:0.0028329435735940933
Iteration: 6088, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44946810603141785
The generated pressure mean: 0.44779473543167114
loss_pred:0.018529672175645828, decouple_loss:0.002771482104435563
loss_pred:0.019768286496400833, decouple_loss:0.0028063482604920864
The generated pressure mean: 0.4497978091239929
loss_pred:0.018166810274124146, decouple_loss:0.0027019709814339876
Iteration: 6089, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4402894377708435
loss_pred:0.01884869486093521, decouple_loss:0.003890781430527568
The generated pressure mean: 0.4376363158226013
loss_pred:0.018428752198815346, decouple_loss:0.0038008447736501694
The generated pressure mean: 0.4361533224582672
loss_pred:0.01913815550506115, decouple_loss:0.0037251028697937727
Iteration: 6090, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476034343242645
loss_pred:0.017911024391651154, decouple_loss:0.0027185811195522547
The generated pressure mean: 0.4466761648654938
loss_pred:0.017568040639162064, decouple_loss:0.0026807314716279507
The generated pressure mean: 0.44654029607772827
loss_pred:0.01933044195175171, decouple_loss:0.002847263589501381
2023-04-17 10:44:47 testing...
The generated pressure mean: 0.4148383140563965
The generated pressure mean: 0.42345935106277466
The generated pressure mean: 0.4264518916606903
loss_pred:0.03264433890581131, decouple_loss:0.003254819894209504
loss_pred:0.03134920448064804, decouple_loss:0.0034267615992575884
loss_pred:0.031179599463939667, decouple_loss:0.003569728462025523
WV_0_PC_0_EH_1_PS_40, loss: 0.0318952351808548, avg_mse: 0.04783478006720543
current test mse: 0.047835
Iteration: 6091, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4510069191455841
loss_pred:0.019003460183739662, decouple_loss:0.0027267406694591045
The generated pressure mean: 0.443636029958725
loss_pred:0.01932135783135891, decouple_loss:0.002670099725946784
The generated pressure mean: 0.45146632194519043
loss_pred:0.019037386402487755, decouple_loss:0.002802019938826561
Iteration: 6092, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4433845579624176
The generated pressure mean: 0.4387226104736328
loss_pred:0.017818503081798553, decouple_loss:0.0029872588347643614
loss_pred:0.01828329637646675, decouple_loss:0.0031166330445557833
The generated pressure mean: 0.4423646628856659
loss_pred:0.018901923671364784, decouple_loss:0.002979803830385208
Iteration: 6093, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4568994343280792
loss_pred:0.01842593029141426, decouple_loss:0.0033331557642668486
The generated pressure mean: 0.4590853452682495
loss_pred:0.019565904513001442, decouple_loss:0.003381134010851383
The generated pressure mean: 0.45761650800704956
loss_pred:0.01896449364721775, decouple_loss:0.0034193946048617363
Iteration: 6094, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44299858808517456
The generated pressure mean: 0.4446581304073334
loss_pred:0.01919778436422348, decouple_loss:0.003266899613663554
loss_pred:0.018397973850369453, decouple_loss:0.0031097899191081524
The generated pressure mean: 0.4433504343032837
loss_pred:0.017547979950904846, decouple_loss:0.0030451114289462566
Iteration: 6095, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44672614336013794
loss_pred:0.017676811665296555, decouple_loss:0.003136593149974942
The generated pressure mean: 0.4416404664516449
loss_pred:0.018462276086211205, decouple_loss:0.0030391463078558445
The generated pressure mean: 0.4432709515094757
loss_pred:0.017762565985322, decouple_loss:0.002985570579767227
Iteration: 6096, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44693291187286377
The generated pressure mean: 0.44538646936416626
loss_pred:0.01715093106031418, decouple_loss:0.0033381155226379633
loss_pred:0.018989089876413345, decouple_loss:0.0033634307328611612
The generated pressure mean: 0.447072833776474
loss_pred:0.018823033198714256, decouple_loss:0.0033886691089719534
Iteration: 6097, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483623504638672
loss_pred:0.01902017928659916, decouple_loss:0.002989014610648155
The generated pressure mean: 0.44664672017097473
loss_pred:0.01758687198162079, decouple_loss:0.002919647842645645
The generated pressure mean: 0.4491947889328003
loss_pred:0.018663812428712845, decouple_loss:0.003036113455891609
Iteration: 6098, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45182740688323975
The generated pressure mean: 0.452137291431427
loss_pred:0.01759764365851879, decouple_loss:0.0036637934390455484
loss_pred:0.0174862127751112, decouple_loss:0.003628808306530118
The generated pressure mean: 0.453439325094223
loss_pred:0.017969906330108643, decouple_loss:0.003454660065472126
Iteration: 6099, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44916611909866333
loss_pred:0.017397843301296234, decouple_loss:0.003989815711975098
The generated pressure mean: 0.4472125470638275
loss_pred:0.018762851133942604, decouple_loss:0.004064799286425114
The generated pressure mean: 0.44334620237350464
loss_pred:0.019618723541498184, decouple_loss:0.0039113243110477924
Iteration: 6100, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4385005831718445
loss_pred:0.019130077213048935, decouple_loss:0.0032241635490208864
The generated pressure mean: 0.43298256397247314
loss_pred:0.019739961251616478, decouple_loss:0.003243181621655822
The generated pressure mean: 0.4296873211860657
loss_pred:0.01971011608839035, decouple_loss:0.0032732258550822735
2023-04-17 10:46:41 testing...
The generated pressure mean: 0.41467663645744324
The generated pressure mean: 0.4231230318546295
The generated pressure mean: 0.42605817317962646
loss_pred:0.0333540216088295, decouple_loss:0.004136546514928341
loss_pred:0.03162622079253197, decouple_loss:0.004645514767616987
loss_pred:0.03183489292860031, decouple_loss:0.004412578418850899
WV_0_PC_0_EH_1_PS_40, loss: 0.03249162435531616, avg_mse: 0.04867447912693024
current test mse: 0.048674
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 6101, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506462812423706
loss_pred:0.018276948481798172, decouple_loss:0.0036031228955835104
The generated pressure mean: 0.4528297483921051
The generated pressure mean: 0.4429703950881958
loss_pred:0.018895702436566353, decouple_loss:0.003602032782509923
loss_pred:0.019431861117482185, decouple_loss:0.003691584337502718
Iteration: 6102, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45496952533721924
loss_pred:0.019463099539279938, decouple_loss:0.004447670187801123
The generated pressure mean: 0.4574369192123413
loss_pred:0.018992925062775612, decouple_loss:0.004480481147766113
The generated pressure mean: 0.456569641828537
loss_pred:0.01801951788365841, decouple_loss:0.004508489277213812
Iteration: 6103, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44642969965934753
loss_pred:0.02127351611852646, decouple_loss:0.0035106693394482136
The generated pressure mean: 0.44826841354370117
loss_pred:0.018575452268123627, decouple_loss:0.0034515063744038343
The generated pressure mean: 0.44334676861763
loss_pred:0.01774095557630062, decouple_loss:0.003420330351218581
Iteration: 6104, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4435163140296936
The generated pressure mean: 0.4445720911026001loss_pred:0.02124840021133423, decouple_loss:0.004634917248040438
loss_pred:0.018674563616514206, decouple_loss:0.004747531842440367
The generated pressure mean: 0.44077834486961365
loss_pred:0.01997159793972969, decouple_loss:0.004630324896425009
Iteration: 6105, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4421018064022064
The generated pressure mean: 0.4388769268989563
loss_pred:0.019726358354091644, decouple_loss:0.003249882021918893
loss_pred:0.01905658282339573, decouple_loss:0.0031786325853317976
The generated pressure mean: 0.44096434116363525
loss_pred:0.017736732959747314, decouple_loss:0.003067194949835539
Iteration: 6106, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479227066040039
The generated pressure mean: 0.44749894738197327
loss_pred:0.019397687166929245, decouple_loss:0.0037307485472410917
loss_pred:0.019924497231841087, decouple_loss:0.0038573581259697676
The generated pressure mean: 0.4486263394355774
loss_pred:0.019099188968539238, decouple_loss:0.0036492710933089256
Iteration: 6107, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4411856532096863
The generated pressure mean: 0.44641727209091187
loss_pred:0.018775036558508873, decouple_loss:0.0037151945289224386
loss_pred:0.018699340522289276, decouple_loss:0.003637561108916998
The generated pressure mean: 0.452254980802536
loss_pred:0.02120225876569748, decouple_loss:0.003633868182078004
Iteration: 6108, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467085301876068
loss_pred:0.018647929653525352, decouple_loss:0.00300194532610476
The generated pressure mean: 0.45139431953430176
loss_pred:0.01926124095916748, decouple_loss:0.002976124407723546
The generated pressure mean: 0.4580540955066681
loss_pred:0.018622083589434624, decouple_loss:0.00298286066390574
Iteration: 6109, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460507035255432
The generated pressure mean: 0.45141857862472534
loss_pred:0.01999104954302311, decouple_loss:0.0026663492899388075
loss_pred:0.01964176818728447, decouple_loss:0.002530396217480302
The generated pressure mean: 0.4493432939052582
loss_pred:0.01926577463746071, decouple_loss:0.0025586688425391912
Iteration: 6110, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43133193254470825
The generated pressure mean: 0.43236273527145386
loss_pred:0.01863943412899971, decouple_loss:0.003279077121987939
loss_pred:0.0200046356767416, decouple_loss:0.0032528326846659184
The generated pressure mean: 0.4312032163143158
loss_pred:0.01894318126142025, decouple_loss:0.00326391845010221
2023-04-17 10:49:09 testing...
The generated pressure mean: 0.41331610083580017
The generated pressure mean: 0.42061927914619446
The generated pressure mean: 0.4228077232837677
loss_pred:0.03358367085456848, decouple_loss:0.0040433211252093315
loss_pred:0.03239584341645241, decouple_loss:0.004275696352124214
loss_pred:0.0320042259991169, decouple_loss:0.004484161734580994
WV_0_PC_0_EH_1_PS_40, loss: 0.032874636352062225, avg_mse: 0.04898594319820404
current test mse: 0.048986
Iteration: 6111, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45474547147750854
The generated pressure mean: 0.4499295949935913
loss_pred:0.01954369619488716, decouple_loss:0.003548674052581191
loss_pred:0.019019508734345436, decouple_loss:0.003534045536071062
The generated pressure mean: 0.4468436539173126
loss_pred:0.019937507808208466, decouple_loss:0.0034212260507047176
Iteration: 6112, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4539843797683716
The generated pressure mean: 0.4504663348197937
loss_pred:0.018231140449643135, decouple_loss:0.0036931424401700497
loss_pred:0.018655389547348022, decouple_loss:0.003757965052500367
The generated pressure mean: 0.459437757730484
loss_pred:0.019162271171808243, decouple_loss:0.003731923643499613
Iteration: 6113, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4447377920150757
The generated pressure mean: 0.44755426049232483
loss_pred:0.018684804439544678, decouple_loss:0.0034878395963460207
loss_pred:0.02126299776136875, decouple_loss:0.00346600404009223
The generated pressure mean: 0.4473367929458618
loss_pred:0.018940314650535583, decouple_loss:0.003424704307690263
Iteration: 6114, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44343599677085876
The generated pressure mean: 0.4420451819896698
loss_pred:0.02039421536028385, decouple_loss:0.003133027348667383
loss_pred:0.018085075542330742, decouple_loss:0.003033930202946067
The generated pressure mean: 0.440446138381958
loss_pred:0.020103944465517998, decouple_loss:0.003008719300851226
Iteration: 6115, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44748440384864807
loss_pred:0.019192950800061226, decouple_loss:0.0030149214435368776
The generated pressure mean: 0.4491809606552124
loss_pred:0.01849948614835739, decouple_loss:0.0028961917851120234
The generated pressure mean: 0.4465593099594116
loss_pred:0.0183709729462862, decouple_loss:0.0029127816669642925
Iteration: 6116, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481101930141449
The generated pressure mean: 0.4537571966648102
loss_pred:0.018125537782907486, decouple_loss:0.003079083049669862
loss_pred:0.01871216483414173, decouple_loss:0.0029745367355644703
The generated pressure mean: 0.4474318325519562
loss_pred:0.019354267045855522, decouple_loss:0.0030853848438709974
Iteration: 6117, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43809834122657776
loss_pred:0.019072897732257843, decouple_loss:0.0034328936599195004
The generated pressure mean: 0.4450123608112335
loss_pred:0.020170362666249275, decouple_loss:0.0034941984340548515
The generated pressure mean: 0.4461436867713928
loss_pred:0.02009688876569271, decouple_loss:0.0033518525306135416
Iteration: 6118, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4318810999393463
loss_pred:0.01859927736222744, decouple_loss:0.0030382180120795965
The generated pressure mean: 0.43390122056007385
loss_pred:0.01858738251030445, decouple_loss:0.003150716656818986
The generated pressure mean: 0.43528205156326294
loss_pred:0.01949421688914299, decouple_loss:0.0030343167018145323
Iteration: 6119, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4590086340904236
The generated pressure mean: 0.4570118188858032
loss_pred:0.019183579832315445, decouple_loss:0.0026027201674878597
loss_pred:0.017406200990080833, decouple_loss:0.0026940652169287205
The generated pressure mean: 0.45617374777793884
loss_pred:0.018707698211073875, decouple_loss:0.0027311628218740225
Iteration: 6120, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45035848021507263
loss_pred:0.018156349658966064, decouple_loss:0.0030453254003077745
The generated pressure mean: 0.4523584246635437
loss_pred:0.01939558982849121, decouple_loss:0.0030287806876003742
The generated pressure mean: 0.45294979214668274
loss_pred:0.0195798147469759, decouple_loss:0.002924710977822542
2023-04-17 10:51:02 testing...
The generated pressure mean: 0.41476401686668396
The generated pressure mean: 0.4211696684360504
The generated pressure mean: 0.4235774576663971
loss_pred:0.032683469355106354, decouple_loss:0.003056013025343418
loss_pred:0.031094631180167198, decouple_loss:0.003321555908769369
loss_pred:0.031078284606337547, decouple_loss:0.003478843718767166
WV_0_PC_0_EH_1_PS_40, loss: 0.03178307041525841, avg_mse: 0.04719538986682892
current test mse: 0.047195
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 6121, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4421471953392029
loss_pred:0.018623828887939453, decouple_loss:0.002685391344130039
The generated pressure mean: 0.44758349657058716
loss_pred:0.018929829820990562, decouple_loss:0.002686344552785158
The generated pressure mean: 0.44319280982017517
loss_pred:0.018021799623966217, decouple_loss:0.002651424612849951
Iteration: 6122, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4419313371181488
The generated pressure mean: 0.4466351270675659
loss_pred:0.018657725304365158, decouple_loss:0.002844757167622447
loss_pred:0.018453296273946762, decouple_loss:0.002814691746607423
The generated pressure mean: 0.4421635568141937
loss_pred:0.018765579909086227, decouple_loss:0.002799335867166519
Iteration: 6123, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477837383747101
The generated pressure mean: 0.4486648142337799
loss_pred:0.019292689859867096, decouple_loss:0.0028199900407344103
loss_pred:0.017972344532608986, decouple_loss:0.002952560316771269
The generated pressure mean: 0.44953453540802
loss_pred:0.019065527245402336, decouple_loss:0.002974523464217782
Iteration: 6124, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4446931779384613
The generated pressure mean: 0.447838693857193
loss_pred:0.01774449273943901, decouple_loss:0.0037707951851189137
loss_pred:0.019045952707529068, decouple_loss:0.003784751519560814
The generated pressure mean: 0.44195684790611267
loss_pred:0.019546452909708023, decouple_loss:0.003888907376676798
Iteration: 6125, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4455326199531555
The generated pressure mean: 0.44373342394828796
loss_pred:0.017562849447131157, decouple_loss:0.003161607077345252
loss_pred:0.01747949980199337, decouple_loss:0.003082224866375327
The generated pressure mean: 0.44336268305778503
loss_pred:0.017401454970240593, decouple_loss:0.0030001376289874315
Iteration: 6126, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45712965726852417
The generated pressure mean: 0.45840439200401306
loss_pred:0.01826774701476097, decouple_loss:0.0031188877765089273
loss_pred:0.018499726429581642, decouple_loss:0.0033071148209273815
The generated pressure mean: 0.45653992891311646
loss_pred:0.019189845770597458, decouple_loss:0.0032168645411729813
Iteration: 6127, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44437262415885925The generated pressure mean: 0.44155943393707275
loss_pred:0.01883993297815323, decouple_loss:0.0028101082425564528
loss_pred:0.01811273768544197, decouple_loss:0.0027996916323900223
The generated pressure mean: 0.44253823161125183
loss_pred:0.019123122096061707, decouple_loss:0.002877912949770689
Iteration: 6128, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4421844780445099
The generated pressure mean: 0.4362977147102356
loss_pred:0.018162177875638008, decouple_loss:0.0029591028578579426
loss_pred:0.018086960539221764, decouple_loss:0.0029125488363206387
The generated pressure mean: 0.43480047583580017
loss_pred:0.017960062250494957, decouple_loss:0.003010339569300413
Iteration: 6129, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45500674843788147
The generated pressure mean: 0.4549572169780731
loss_pred:0.020786890760064125, decouple_loss:0.00333933113142848
loss_pred:0.018081622198224068, decouple_loss:0.003306127618998289
The generated pressure mean: 0.4554435908794403
loss_pred:0.019038110971450806, decouple_loss:0.0031143708620220423
Iteration: 6130, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44123736023902893
The generated pressure mean: 0.44212907552719116
loss_pred:0.019209563732147217, decouple_loss:0.003407796612009406
loss_pred:0.019106635823845863, decouple_loss:0.0032646385952830315
The generated pressure mean: 0.4462083578109741
loss_pred:0.019939681515097618, decouple_loss:0.0032106060534715652
2023-04-17 10:53:29 testing...
The generated pressure mean: 0.4146255850791931
The generated pressure mean: 0.4231337010860443
The generated pressure mean: 0.4257661700248718
loss_pred:0.03289515897631645, decouple_loss:0.003954752814024687
loss_pred:0.03172382712364197, decouple_loss:0.004144066944718361
loss_pred:0.031098347157239914, decouple_loss:0.004387645982205868
WV_0_PC_0_EH_1_PS_40, loss: 0.03211388736963272, avg_mse: 0.048161450773477554
current test mse: 0.048161
Iteration: 6131, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4551762640476227
The generated pressure mean: 0.4559902548789978
loss_pred:0.020016685128211975, decouple_loss:0.0034076145384460688
loss_pred:0.0192585289478302, decouple_loss:0.003329809522256255
The generated pressure mean: 0.454755961894989
loss_pred:0.019423257559537888, decouple_loss:0.003356065135449171
Iteration: 6132, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43942058086395264
loss_pred:0.019907161593437195, decouple_loss:0.0034061174374073744
The generated pressure mean: 0.43408265709877014
loss_pred:0.019177725538611412, decouple_loss:0.0032785837538540363
The generated pressure mean: 0.4399838149547577
loss_pred:0.0179587472230196, decouple_loss:0.003319612005725503
Iteration: 6133, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466022551059723
loss_pred:0.0204133540391922, decouple_loss:0.0033459244295954704
The generated pressure mean: 0.45017459988594055
loss_pred:0.018924128264188766, decouple_loss:0.0033065129537135363
The generated pressure mean: 0.44774866104125977
loss_pred:0.018863124772906303, decouple_loss:0.003398418426513672
Iteration: 6134, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45565521717071533
The generated pressure mean: 0.4534798264503479
loss_pred:0.01915617659687996, decouple_loss:0.003379373112693429
loss_pred:0.018239570781588554, decouple_loss:0.0033656731247901917
The generated pressure mean: 0.45449501276016235
loss_pred:0.019801225513219833, decouple_loss:0.003321596421301365
Iteration: 6135, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470038115978241
The generated pressure mean: 0.4454179108142853
loss_pred:0.018875179812312126, decouple_loss:0.0029923482798039913
loss_pred:0.019492991268634796, decouple_loss:0.0030584558844566345
The generated pressure mean: 0.44251748919487
loss_pred:0.01809668354690075, decouple_loss:0.0031448176596313715
Iteration: 6136, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4371678829193115
loss_pred:0.018359046429395676, decouple_loss:0.002897653728723526
The generated pressure mean: 0.4410507380962372
loss_pred:0.0181274451315403, decouple_loss:0.0029030859004706144
The generated pressure mean: 0.4379662275314331
loss_pred:0.017765218392014503, decouple_loss:0.0027666091918945312
Iteration: 6137, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44976410269737244
loss_pred:0.01738785021007061, decouple_loss:0.0026143842842429876
The generated pressure mean: 0.4533664286136627
loss_pred:0.017818260937929153, decouple_loss:0.00259140832349658
The generated pressure mean: 0.45835691690444946
loss_pred:0.019350703805685043, decouple_loss:0.0027251243591308594
Iteration: 6138, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45052018761634827
The generated pressure mean: 0.4564814269542694
loss_pred:0.01873551495373249, decouple_loss:0.002957372460514307
loss_pred:0.01895502395927906, decouple_loss:0.0028572059236466885
The generated pressure mean: 0.4609735906124115
loss_pred:0.01811404526233673, decouple_loss:0.0029330826364457607
Iteration: 6139, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43439874053001404
loss_pred:0.01849481090903282, decouple_loss:0.002743927063420415
The generated pressure mean: 0.4434819519519806
loss_pred:0.01897275075316429, decouple_loss:0.002943536266684532
The generated pressure mean: 0.43829086422920227
loss_pred:0.01844179816544056, decouple_loss:0.002801555208861828
Iteration: 6140, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4433569014072418
loss_pred:0.01742556132376194, decouple_loss:0.002892651129513979
The generated pressure mean: 0.44382381439208984
loss_pred:0.01760387420654297, decouple_loss:0.002858566353097558
The generated pressure mean: 0.4427497982978821
loss_pred:0.01813989318907261, decouple_loss:0.0029264409095048904
2023-04-17 10:55:23 testing...
The generated pressure mean: 0.41348662972450256
The generated pressure mean: 0.42181196808815
loss_pred:0.033260446041822433, decouple_loss:0.00376721378415823
The generated pressure mean: 0.42510175704956055
loss_pred:0.032067086547613144, decouple_loss:0.003940308466553688
loss_pred:0.03149373456835747, decouple_loss:0.004134615417569876
WV_0_PC_0_EH_1_PS_40, loss: 0.032471127808094025, avg_mse: 0.04908282309770584
current test mse: 0.049083
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 6141, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44996148347854614
loss_pred:0.018343092873692513, decouple_loss:0.0031602983362972736
The generated pressure mean: 0.45506376028060913
loss_pred:0.018449191004037857, decouple_loss:0.0032216254621744156
The generated pressure mean: 0.4526026248931885
loss_pred:0.017559969797730446, decouple_loss:0.003120230743661523
Iteration: 6142, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4363366961479187
The generated pressure mean: 0.4348268210887909
loss_pred:0.018413962796330452, decouple_loss:0.0029697860591113567
loss_pred:0.01778416335582733, decouple_loss:0.003028586972504854
The generated pressure mean: 0.4403499364852905
loss_pred:0.0193426925688982, decouple_loss:0.0030384811107069254
Iteration: 6143, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4608132243156433
loss_pred:0.01834934391081333, decouple_loss:0.0033496522810310125
The generated pressure mean: 0.4583335816860199
loss_pred:0.01961110532283783, decouple_loss:0.003482254222035408
The generated pressure mean: 0.46588605642318726
loss_pred:0.01945226639509201, decouple_loss:0.0033903007861226797
Iteration: 6144, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44025734066963196
The generated pressure mean: 0.4419591426849365loss_pred:0.017638541758060455, decouple_loss:0.002920445753261447
loss_pred:0.017670994624495506, decouple_loss:0.0028507562819868326
The generated pressure mean: 0.44112393260002136
loss_pred:0.021085599437355995, decouple_loss:0.0030226437374949455
Iteration: 6145, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43855440616607666
The generated pressure mean: 0.4352492392063141
loss_pred:0.021362222731113434, decouple_loss:0.0035856664180755615
loss_pred:0.01784718595445156, decouple_loss:0.003365126671269536
The generated pressure mean: 0.4335077702999115
loss_pred:0.01849752478301525, decouple_loss:0.003373035229742527
Iteration: 6146, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4517066478729248
The generated pressure mean: 0.45874518156051636
loss_pred:0.01727277785539627, decouple_loss:0.003781173611059785
loss_pred:0.01812317967414856, decouple_loss:0.0036864373832941055
The generated pressure mean: 0.4518580138683319
loss_pred:0.019519513472914696, decouple_loss:0.0036561512388288975
Iteration: 6147, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4586619436740875
The generated pressure mean: 0.45644697546958923loss_pred:0.017885776236653328, decouple_loss:0.003027906408533454
loss_pred:0.021010909229516983, decouple_loss:0.0028946874663233757
The generated pressure mean: 0.45941293239593506
loss_pred:0.018247945234179497, decouple_loss:0.0030504355672746897
Iteration: 6148, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43724939227104187
loss_pred:0.019597114995121956, decouple_loss:0.0037277385126799345
The generated pressure mean: 0.43919113278388977
loss_pred:0.01940230093896389, decouple_loss:0.003773418953642249
The generated pressure mean: 0.4402276873588562
loss_pred:0.017841141670942307, decouple_loss:0.003678145119920373
Iteration: 6149, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.430972158908844
loss_pred:0.01874547451734543, decouple_loss:0.0036014181096106768
The generated pressure mean: 0.43158239126205444
loss_pred:0.02027856931090355, decouple_loss:0.0034020710736513138
The generated pressure mean: 0.4283561706542969
loss_pred:0.019257495179772377, decouple_loss:0.0035864501260221004
Iteration: 6150, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493354856967926
loss_pred:0.020268255844712257, decouple_loss:0.003271728055551648
The generated pressure mean: 0.4533002972602844
loss_pred:0.017627345398068428, decouple_loss:0.0030564467888325453
The generated pressure mean: 0.455099493265152
loss_pred:0.017820505425333977, decouple_loss:0.0030402999836951494
2023-04-17 10:57:52 testing...
The generated pressure mean: 0.4094323515892029
The generated pressure mean: 0.4167215824127197
The generated pressure mean: 0.419811487197876
loss_pred:0.034396693110466, decouple_loss:0.0045257993042469025
loss_pred:0.03311708942055702, decouple_loss:0.0046278382651507854
loss_pred:0.03241477161645889, decouple_loss:0.004751931875944138
WV_0_PC_0_EH_1_PS_40, loss: 0.033541277050971985, avg_mse: 0.05047878995537758
current test mse: 0.050479
Iteration: 6151, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46109360456466675
The generated pressure mean: 0.46259137988090515
loss_pred:0.018441198393702507, decouple_loss:0.00376823334954679
loss_pred:0.018986573442816734, decouple_loss:0.003907537553459406
The generated pressure mean: 0.4658603072166443
loss_pred:0.018002314493060112, decouple_loss:0.0036778016947209835
Iteration: 6152, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44029104709625244
loss_pred:0.018442699685692787, decouple_loss:0.0035014175809919834
The generated pressure mean: 0.4394782781600952
loss_pred:0.019483959302306175, decouple_loss:0.003654009895399213
The generated pressure mean: 0.4451378285884857
loss_pred:0.01814315840601921, decouple_loss:0.003650364000350237
Iteration: 6153, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4420006573200226
loss_pred:0.017317920923233032, decouple_loss:0.0028917123563587666
The generated pressure mean: 0.4446335732936859
loss_pred:0.01738942787051201, decouple_loss:0.0029953420162200928
The generated pressure mean: 0.4410136938095093
loss_pred:0.018485914915800095, decouple_loss:0.003090247744694352
Iteration: 6154, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498463571071625
The generated pressure mean: 0.45083507895469666loss_pred:0.020125210285186768, decouple_loss:0.003184505505487323
loss_pred:0.01781456358730793, decouple_loss:0.0032828582916408777
The generated pressure mean: 0.4483383595943451
loss_pred:0.018434569239616394, decouple_loss:0.003408911172300577
Iteration: 6155, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4456443786621094
loss_pred:0.019275102764368057, decouple_loss:0.0036343345418572426
The generated pressure mean: 0.441052109003067
loss_pred:0.01913185603916645, decouple_loss:0.003415878629311919
The generated pressure mean: 0.4453834295272827
loss_pred:0.018448803573846817, decouple_loss:0.0032880513463169336
Iteration: 6156, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478866457939148
loss_pred:0.019390709698200226, decouple_loss:0.00351145351305604
The generated pressure mean: 0.44484958052635193
loss_pred:0.01770957000553608, decouple_loss:0.0033980663865804672
The generated pressure mean: 0.44630926847457886
loss_pred:0.017510300502181053, decouple_loss:0.0033396941144019365
Iteration: 6157, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45928964018821716
loss_pred:0.017956694588065147, decouple_loss:0.0033678309991955757
The generated pressure mean: 0.45504507422447205
loss_pred:0.017970511689782143, decouple_loss:0.003264683298766613
The generated pressure mean: 0.4537624418735504
loss_pred:0.018248241394758224, decouple_loss:0.0036473029758781195
Iteration: 6158, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475550055503845
The generated pressure mean: 0.4446611702442169
loss_pred:0.018422769382596016, decouple_loss:0.0033868232276290655
loss_pred:0.01891721598803997, decouple_loss:0.003432661294937134
The generated pressure mean: 0.4448227882385254
loss_pred:0.01970662921667099, decouple_loss:0.0032591670751571655
Iteration: 6159, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4409385025501251
loss_pred:0.018955344334244728, decouple_loss:0.0030416937079280615
The generated pressure mean: 0.44048014283180237
loss_pred:0.01815630868077278, decouple_loss:0.0030667593237012625
The generated pressure mean: 0.4391826391220093
loss_pred:0.017792649567127228, decouple_loss:0.002960288431495428
Iteration: 6160, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45184147357940674
The generated pressure mean: 0.4412775933742523
loss_pred:0.017724933102726936, decouple_loss:0.0033171330578625202
loss_pred:0.018506797030568123, decouple_loss:0.0029671955853700638
The generated pressure mean: 0.44352635741233826
loss_pred:0.018820729106664658, decouple_loss:0.0030936950352042913
2023-04-17 10:59:46 testing...
The generated pressure mean: 0.41281118988990784
The generated pressure mean: 0.42117735743522644
The generated pressure mean: 0.4243105351924896
loss_pred:0.03464020788669586, decouple_loss:0.003782569197937846
loss_pred:0.03348398581147194, decouple_loss:0.003994190599769354
loss_pred:0.032657358795404434, decouple_loss:0.004244446754455566
WV_0_PC_0_EH_1_PS_40, loss: 0.033794205635786057, avg_mse: 0.05147967115044594
current test mse: 0.05148
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 6161, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4602295160293579
loss_pred:0.01984655112028122, decouple_loss:0.003463289700448513
The generated pressure mean: 0.45856186747550964
loss_pred:0.019386596977710724, decouple_loss:0.0034958072938024998
The generated pressure mean: 0.45650678873062134
loss_pred:0.019353870302438736, decouple_loss:0.0033838956151157618
Iteration: 6162, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44261297583580017
loss_pred:0.018736757338047028, decouple_loss:0.0031906701624393463
The generated pressure mean: 0.44298264384269714
loss_pred:0.0193015243858099, decouple_loss:0.003128346521407366
The generated pressure mean: 0.4414284825325012
loss_pred:0.019406404346227646, decouple_loss:0.0031569399870932102
Iteration: 6163, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4379652440547943
loss_pred:0.020092414692044258, decouple_loss:0.0036389906890690327
The generated pressure mean: 0.43659287691116333
loss_pred:0.020156018435955048, decouple_loss:0.0035513993352651596
The generated pressure mean: 0.4372251033782959
loss_pred:0.01869615539908409, decouple_loss:0.0035435163881629705
Iteration: 6164, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4584902226924896
loss_pred:0.020489538088440895, decouple_loss:0.0033554008696228266
The generated pressure mean: 0.46647459268569946
loss_pred:0.022233445197343826, decouple_loss:0.0035566017031669617
The generated pressure mean: 0.45919451117515564
loss_pred:0.01920999400317669, decouple_loss:0.0034316028468310833
Iteration: 6165, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44002702832221985
The generated pressure mean: 0.44362878799438477
loss_pred:0.017841806635260582, decouple_loss:0.002643412910401821
loss_pred:0.018398664891719818, decouple_loss:0.0027942871674895287
The generated pressure mean: 0.4428711235523224
loss_pred:0.019595591351389885, decouple_loss:0.002754413988441229
Iteration: 6166, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44411078095436096
loss_pred:0.020690275356173515, decouple_loss:0.0033012430649250746
The generated pressure mean: 0.4375937581062317
loss_pred:0.019241444766521454, decouple_loss:0.0033605042845010757
The generated pressure mean: 0.43902483582496643
loss_pred:0.020114971324801445, decouple_loss:0.0032943375408649445
Iteration: 6167, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45700955390930176
loss_pred:0.01946830190718174, decouple_loss:0.003305715275928378
The generated pressure mean: 0.4521116614341736
loss_pred:0.019655006006360054, decouple_loss:0.002982780337333679
The generated pressure mean: 0.45342332124710083
loss_pred:0.018836135044693947, decouple_loss:0.0030138171277940273
Iteration: 6168, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484652876853943
loss_pred:0.019378039985895157, decouple_loss:0.002947927685454488
The generated pressure mean: 0.4515635669231415
loss_pred:0.019664769992232323, decouple_loss:0.003014835063368082
The generated pressure mean: 0.4517834186553955
loss_pred:0.019944729283452034, decouple_loss:0.0030453470535576344
Iteration: 6169, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4410792887210846
loss_pred:0.01914982870221138, decouple_loss:0.003293442539870739
The generated pressure mean: 0.43782368302345276
loss_pred:0.017897576093673706, decouple_loss:0.003530096961185336
The generated pressure mean: 0.44029945135116577
loss_pred:0.01974952593445778, decouple_loss:0.00327073666267097
Iteration: 6170, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44403141736984253
loss_pred:0.017758915200829506, decouple_loss:0.003493781667202711
The generated pressure mean: 0.4432904124259949
loss_pred:0.018643461167812347, decouple_loss:0.0037434815894812346
The generated pressure mean: 0.4464969336986542
loss_pred:0.019578717648983, decouple_loss:0.003609269857406616
2023-04-17 11:02:14 testing...
The generated pressure mean: 0.4108440577983856
The generated pressure mean: 0.41847532987594604
loss_pred:0.032889772206544876, decouple_loss:0.003631778061389923
The generated pressure mean: 0.4217657148838043
loss_pred:0.031635530292987823, decouple_loss:0.003779604332521558
loss_pred:0.03111839108169079, decouple_loss:0.004088388290256262
WV_0_PC_0_EH_1_PS_40, loss: 0.032072898000478745, avg_mse: 0.04801509529352188
current test mse: 0.048015
Iteration: 6171, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4586307406425476
The generated pressure mean: 0.4560387134552002
loss_pred:0.019905386492609978, decouple_loss:0.0031132069416344166
loss_pred:0.01842907816171646, decouple_loss:0.0028672737535089254
The generated pressure mean: 0.4598674178123474
loss_pred:0.02122299186885357, decouple_loss:0.0031158619094640017
Iteration: 6172, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490984380245209
The generated pressure mean: 0.4467361271381378
loss_pred:0.01982782408595085, decouple_loss:0.002869313582777977
loss_pred:0.018925825133919716, decouple_loss:0.0029499726369976997
The generated pressure mean: 0.4486640989780426
loss_pred:0.018902376294136047, decouple_loss:0.002842986723408103
Iteration: 6173, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4380769431591034
The generated pressure mean: 0.4363223612308502
loss_pred:0.01845395192503929, decouple_loss:0.003325480269268155
loss_pred:0.019814597442746162, decouple_loss:0.0033568621147423983
The generated pressure mean: 0.43659669160842896
loss_pred:0.017992105334997177, decouple_loss:0.003178944578394294
Iteration: 6174, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45054882764816284The generated pressure mean: 0.4443526864051819
loss_pred:0.020046968013048172, decouple_loss:0.0032240678556263447
loss_pred:0.021683311089873314, decouple_loss:0.0035121003165841103
The generated pressure mean: 0.44824323058128357
loss_pred:0.020328093320131302, decouple_loss:0.0032856196630746126
Iteration: 6175, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4515639841556549
The generated pressure mean: 0.45266783237457275
loss_pred:0.02048610709607601, decouple_loss:0.003618345595896244
loss_pred:0.018543913960456848, decouple_loss:0.0035660266876220703
The generated pressure mean: 0.4507042169570923
loss_pred:0.019003242254257202, decouple_loss:0.003662764560431242
Iteration: 6176, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.453707754611969
The generated pressure mean: 0.4554097056388855
loss_pred:0.019859516993165016, decouple_loss:0.003201035549864173
loss_pred:0.020012129098176956, decouple_loss:0.00308858510106802
The generated pressure mean: 0.457914263010025
loss_pred:0.018144285306334496, decouple_loss:0.0031352099031209946
Iteration: 6177, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44670403003692627
The generated pressure mean: 0.4505482614040375
loss_pred:0.019350729882717133, decouple_loss:0.004165863152593374
loss_pred:0.019641898572444916, decouple_loss:0.0038939351215958595
The generated pressure mean: 0.44660139083862305
loss_pred:0.021373098716139793, decouple_loss:0.004017524421215057
Iteration: 6178, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4347246289253235
loss_pred:0.019253356382250786, decouple_loss:0.004780277144163847
The generated pressure mean: 0.43474334478378296
loss_pred:0.019888825714588165, decouple_loss:0.004663410596549511
The generated pressure mean: 0.4330967664718628
loss_pred:0.01973583921790123, decouple_loss:0.00471258582547307
Iteration: 6179, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45339682698249817
loss_pred:0.01959700882434845, decouple_loss:0.003953044768422842
The generated pressure mean: 0.44613632559776306
loss_pred:0.01836671121418476, decouple_loss:0.003966599702835083
The generated pressure mean: 0.4486079514026642
loss_pred:0.01990244910120964, decouple_loss:0.0038423403166234493
Iteration: 6180, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46155574917793274
loss_pred:0.018058182671666145, decouple_loss:0.0045142825692892075
The generated pressure mean: 0.45861339569091797
loss_pred:0.019211212173104286, decouple_loss:0.004519008100032806
The generated pressure mean: 0.45844265818595886
loss_pred:0.019134338945150375, decouple_loss:0.00456644594669342
2023-04-17 11:04:08 testing...
The generated pressure mean: 0.41357940435409546
The generated pressure mean: 0.42155811190605164
The generated pressure mean: 0.4250790476799011
loss_pred:0.032023679465055466, decouple_loss:0.004011973273009062
loss_pred:0.03095083124935627, decouple_loss:0.004267820622771978
loss_pred:0.030429145321249962, decouple_loss:0.004319280385971069
WV_0_PC_0_EH_1_PS_40, loss: 0.03134453669190407, avg_mse: 0.04664628952741623
current test mse: 0.046646
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 6181, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475277066230774
loss_pred:0.019355636090040207, decouple_loss:0.0037049471866339445
The generated pressure mean: 0.45120689272880554
The generated pressure mean: 0.44879162311553955
loss_pred:0.01940685696899891, decouple_loss:0.0035359871108084917
loss_pred:0.01927013136446476, decouple_loss:0.003662210190668702
Iteration: 6182, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43680810928344727
The generated pressure mean: 0.4379846751689911
loss_pred:0.019749119877815247, decouple_loss:0.0036216864828020334
loss_pred:0.01976667158305645, decouple_loss:0.0036596928257495165
The generated pressure mean: 0.44135308265686035
loss_pred:0.019094770774245262, decouple_loss:0.003745199181139469
Iteration: 6183, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497501850128174
The generated pressure mean: 0.44468721747398376
loss_pred:0.019107384607195854, decouple_loss:0.003631005762144923
loss_pred:0.020263701677322388, decouple_loss:0.0037276907823979855
The generated pressure mean: 0.4453185796737671
loss_pred:0.019315805286169052, decouple_loss:0.0037343285512179136
Iteration: 6184, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44923293590545654
The generated pressure mean: 0.4412670135498047
loss_pred:0.019173678010702133, decouple_loss:0.0032545907888561487
loss_pred:0.017101913690567017, decouple_loss:0.0030696201138198376
The generated pressure mean: 0.45436638593673706
loss_pred:0.01894359104335308, decouple_loss:0.0030541096348315477
Iteration: 6185, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4561513364315033
The generated pressure mean: 0.45056357979774475
loss_pred:0.019353186711668968, decouple_loss:0.003586600301787257
loss_pred:0.01942647434771061, decouple_loss:0.0035988111048936844
The generated pressure mean: 0.45383980870246887
loss_pred:0.018306348472833633, decouple_loss:0.0035801802296191454
Iteration: 6186, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45136040449142456
The generated pressure mean: 0.4484691619873047
loss_pred:0.018720846623182297, decouple_loss:0.0030391139443963766
loss_pred:0.01968313381075859, decouple_loss:0.0030298009514808655
The generated pressure mean: 0.44551944732666016
loss_pred:0.018504692241549492, decouple_loss:0.0032648970372974873
Iteration: 6187, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45470064878463745
The generated pressure mean: 0.44631171226501465
loss_pred:0.019464634358882904, decouple_loss:0.003894370049238205
loss_pred:0.021339597180485725, decouple_loss:0.0037204197142273188
The generated pressure mean: 0.4512042999267578
loss_pred:0.018544530496001244, decouple_loss:0.003766499925404787
Iteration: 6188, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4284301996231079
The generated pressure mean: 0.4293553829193115
loss_pred:0.019727425649762154, decouple_loss:0.0033734359312802553
loss_pred:0.019946051761507988, decouple_loss:0.003459935775026679
The generated pressure mean: 0.4264761209487915
loss_pred:0.019570395350456238, decouple_loss:0.0034464243799448013
Iteration: 6189, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45782917737960815
The generated pressure mean: 0.45512527227401733
loss_pred:0.01983923278748989, decouple_loss:0.0034922906197607517
loss_pred:0.01856909692287445, decouple_loss:0.0034733477514237165
The generated pressure mean: 0.4550279378890991
loss_pred:0.019677137956023216, decouple_loss:0.003661675611510873
Iteration: 6190, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46344220638275146
The generated pressure mean: 0.4685843586921692
loss_pred:0.01913600228726864, decouple_loss:0.003441808046773076
loss_pred:0.019639423117041588, decouple_loss:0.003556955838575959
The generated pressure mean: 0.4652971625328064
loss_pred:0.020199956372380257, decouple_loss:0.0036196443252265453
2023-04-17 11:06:38 testing...
The generated pressure mean: 0.4169069230556488
The generated pressure mean: 0.42481935024261475
loss_pred:0.03318922966718674, decouple_loss:0.004447425249963999
The generated pressure mean: 0.42855513095855713
loss_pred:0.03182714805006981, decouple_loss:0.004624051507562399
loss_pred:0.03163032606244087, decouple_loss:0.00484853982925415
WV_0_PC_0_EH_1_PS_40, loss: 0.03244756907224655, avg_mse: 0.048666469752788544
current test mse: 0.048666
Iteration: 6191, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4367806911468506
loss_pred:0.01942540891468525, decouple_loss:0.0039014029316604137
The generated pressure mean: 0.44192180037498474
loss_pred:0.01838711090385914, decouple_loss:0.0039030921179801226
The generated pressure mean: 0.4425964653491974
loss_pred:0.018306002020835876, decouple_loss:0.0038390555419027805
Iteration: 6192, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4368557929992676
The generated pressure mean: 0.4354812800884247
loss_pred:0.01901996321976185, decouple_loss:0.003872024128213525
loss_pred:0.019257210195064545, decouple_loss:0.003832623828202486
The generated pressure mean: 0.4369753301143646
loss_pred:0.018466005101799965, decouple_loss:0.0038217431865632534
Iteration: 6193, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4549270272254944
The generated pressure mean: 0.4546865224838257
loss_pred:0.01970864087343216, decouple_loss:0.0031367524061352015
loss_pred:0.020616216585040092, decouple_loss:0.003381845075637102
The generated pressure mean: 0.4526350796222687
loss_pred:0.019300216808915138, decouple_loss:0.0032083485275506973
Iteration: 6194, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44698813557624817
The generated pressure mean: 0.44812387228012085loss_pred:0.019593995064496994, decouple_loss:0.004993504378944635
loss_pred:0.0184011273086071, decouple_loss:0.004778931383043528
The generated pressure mean: 0.4508863687515259
loss_pred:0.01870867982506752, decouple_loss:0.004917214158922434
Iteration: 6195, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4511154294013977
The generated pressure mean: 0.4461742341518402
loss_pred:0.02060949057340622, decouple_loss:0.0036071010399609804
loss_pred:0.019613128155469894, decouple_loss:0.0035891293082386255
The generated pressure mean: 0.45236822962760925
loss_pred:0.01828804425895214, decouple_loss:0.003596104681491852
Iteration: 6196, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.444186270236969
The generated pressure mean: 0.4486180245876312
loss_pred:0.019585439935326576, decouple_loss:0.003473525634035468
loss_pred:0.019658278673887253, decouple_loss:0.003499325830489397
The generated pressure mean: 0.448022723197937
loss_pred:0.018745899200439453, decouple_loss:0.0036204627249389887
Iteration: 6197, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44797593355178833
loss_pred:0.020603198558092117, decouple_loss:0.0037268579471856356
The generated pressure mean: 0.44922634959220886
loss_pred:0.019931139424443245, decouple_loss:0.0037510721012949944
The generated pressure mean: 0.4441615045070648
loss_pred:0.019810453057289124, decouple_loss:0.003619027091190219
Iteration: 6198, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4531649947166443
loss_pred:0.018487028777599335, decouple_loss:0.003236112417653203
The generated pressure mean: 0.4457336962223053
loss_pred:0.01808048225939274, decouple_loss:0.003135174047201872
The generated pressure mean: 0.4505354166030884
loss_pred:0.018422698602080345, decouple_loss:0.0029544392600655556
Iteration: 6199, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44482606649398804
The generated pressure mean: 0.4501360356807709
loss_pred:0.01933121494948864, decouple_loss:0.003368084318935871
loss_pred:0.020916219800710678, decouple_loss:0.0033089241478592157
The generated pressure mean: 0.4503127932548523
loss_pred:0.019266823306679726, decouple_loss:0.0033073057420551777
Iteration: 6200, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.442672461271286
loss_pred:0.020423760637640953, decouple_loss:0.0029194785747677088
The generated pressure mean: 0.44099512696266174
loss_pred:0.018406981602311134, decouple_loss:0.0030430906917899847
The generated pressure mean: 0.44013139605522156
loss_pred:0.020588787272572517, decouple_loss:0.0030166192445904016
2023-04-17 11:08:32 testing...
The generated pressure mean: 0.4209938645362854
The generated pressure mean: 0.413219690322876
The generated pressure mean: 0.4247865378856659
loss_pred:0.03195229917764664, decouple_loss:0.004097167402505875
loss_pred:0.03269359469413757, decouple_loss:0.003947660326957703
loss_pred:0.031225193291902542, decouple_loss:0.004355659708380699
WV_0_PC_0_EH_1_PS_40, loss: 0.03216370567679405, avg_mse: 0.048454076051712036
current test mse: 0.048454
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 6201, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44907134771347046
The generated pressure mean: 0.45012953877449036
loss_pred:0.01796642132103443, decouple_loss:0.0035099030937999487
loss_pred:0.019564544782042503, decouple_loss:0.0034285669680684805
The generated pressure mean: 0.44740405678749084
loss_pred:0.019867848604917526, decouple_loss:0.0035532775800675154
Iteration: 6202, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4516032636165619
loss_pred:0.018948087468743324, decouple_loss:0.0027144744526594877The generated pressure mean: 0.45127981901168823
loss_pred:0.018956663087010384, decouple_loss:0.0028510212432593107
The generated pressure mean: 0.4499310553073883
loss_pred:0.018992915749549866, decouple_loss:0.002801191294565797
Iteration: 6203, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44187062978744507
loss_pred:0.019939476624131203, decouple_loss:0.003215805161744356
The generated pressure mean: 0.44660231471061707
loss_pred:0.018347367644309998, decouple_loss:0.003251551417633891
The generated pressure mean: 0.4467853307723999
loss_pred:0.019109752029180527, decouple_loss:0.0032181821297854185
Iteration: 6204, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4430607855319977
loss_pred:0.01771584339439869, decouple_loss:0.002823948860168457
The generated pressure mean: 0.4478732645511627
loss_pred:0.020782405510544777, decouple_loss:0.002770913066342473
The generated pressure mean: 0.44211551547050476
loss_pred:0.020982999354600906, decouple_loss:0.002682260936126113
Iteration: 6205, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447296142578125
The generated pressure mean: 0.44799527525901794
loss_pred:0.01953333243727684, decouple_loss:0.0028075778391212225
loss_pred:0.01771683245897293, decouple_loss:0.0027943963650614023
The generated pressure mean: 0.4488433599472046
loss_pred:0.019526880234479904, decouple_loss:0.0028956755995750427
Iteration: 6206, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449051320552826
loss_pred:0.01935252547264099, decouple_loss:0.0033985881600528955
The generated pressure mean: 0.4436125159263611
loss_pred:0.01849699579179287, decouple_loss:0.0033099744468927383
The generated pressure mean: 0.44338974356651306
loss_pred:0.018284037709236145, decouple_loss:0.003248782828450203
Iteration: 6207, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44284743070602417
The generated pressure mean: 0.4442993998527527
loss_pred:0.018313581123948097, decouple_loss:0.003067179350182414
loss_pred:0.022152045741677284, decouple_loss:0.0034138159826397896
The generated pressure mean: 0.44463735818862915
loss_pred:0.01826487109065056, decouple_loss:0.003051584819331765
Iteration: 6208, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45364871621131897
loss_pred:0.018066443502902985, decouple_loss:0.0030213999561965466
The generated pressure mean: 0.45221197605133057
loss_pred:0.01933537796139717, decouple_loss:0.002934796502813697
The generated pressure mean: 0.4512501060962677
loss_pred:0.018738673999905586, decouple_loss:0.002908122492954135
Iteration: 6209, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.445189505815506
loss_pred:0.018750876188278198, decouple_loss:0.003097584703937173
The generated pressure mean: 0.4437881112098694
loss_pred:0.018214432522654533, decouple_loss:0.0030640088953077793
The generated pressure mean: 0.44537100195884705
loss_pred:0.019854148849844933, decouple_loss:0.003143471898511052
Iteration: 6210, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44375571608543396
The generated pressure mean: 0.44452908635139465
loss_pred:0.01836363971233368, decouple_loss:0.0032420854549854994
loss_pred:0.01970241218805313, decouple_loss:0.0033294919412583113
The generated pressure mean: 0.4424751102924347
loss_pred:0.01915852352976799, decouple_loss:0.003251891816034913
2023-04-17 11:10:59 testing...
The generated pressure mean: 0.41263726353645325
The generated pressure mean: 0.4205605089664459
loss_pred:0.0327860452234745, decouple_loss:0.0036692097783088684
The generated pressure mean: 0.4243503510951996
loss_pred:0.031760260462760925, decouple_loss:0.00385268428362906
loss_pred:0.030918249860405922, decouple_loss:0.0040750871412456036
WV_0_PC_0_EH_1_PS_40, loss: 0.03201480209827423, avg_mse: 0.04818708077073097
current test mse: 0.048187
Iteration: 6211, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44897541403770447
The generated pressure mean: 0.4504535496234894
loss_pred:0.018285080790519714, decouple_loss:0.0034450970124453306
loss_pred:0.018455589190125465, decouple_loss:0.0033128850627690554
The generated pressure mean: 0.44975924491882324
loss_pred:0.017968209460377693, decouple_loss:0.003277306444942951
Iteration: 6212, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45209693908691406
The generated pressure mean: 0.4517555236816406
loss_pred:0.018128352239727974, decouple_loss:0.0030271552968770266
loss_pred:0.01887546479701996, decouple_loss:0.0031052890699356794
The generated pressure mean: 0.4526430070400238
loss_pred:0.01743132248520851, decouple_loss:0.0030639260075986385
Iteration: 6213, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44118738174438477
The generated pressure mean: 0.4384503662586212
loss_pred:0.019650816917419434, decouple_loss:0.0032599319238215685
loss_pred:0.020158186554908752, decouple_loss:0.003294439287856221
The generated pressure mean: 0.4401980936527252
loss_pred:0.019105833023786545, decouple_loss:0.003316749120131135
Iteration: 6214, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44267919659614563
The generated pressure mean: 0.439740389585495
loss_pred:0.0190819650888443, decouple_loss:0.0031819038558751345
loss_pred:0.018511679023504257, decouple_loss:0.003165805246680975
The generated pressure mean: 0.4422505497932434
loss_pred:0.019290274009108543, decouple_loss:0.003265524748712778
Iteration: 6215, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4557403326034546
loss_pred:0.019488617777824402, decouple_loss:0.0032076318748295307
The generated pressure mean: 0.4551411271095276
loss_pred:0.01815878599882126, decouple_loss:0.0031729789916425943
The generated pressure mean: 0.45292040705680847
loss_pred:0.01887165568768978, decouple_loss:0.0031126115936785936
Iteration: 6216, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4510522782802582
loss_pred:0.020266709849238396, decouple_loss:0.002989387372508645
The generated pressure mean: 0.4458984434604645
loss_pred:0.017829935997724533, decouple_loss:0.002854360733181238
The generated pressure mean: 0.4469750225543976
loss_pred:0.020950114354491234, decouple_loss:0.00299847312271595
Iteration: 6217, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4323970377445221
The generated pressure mean: 0.43247953057289124
loss_pred:0.020323025062680244, decouple_loss:0.0026644866447895765
loss_pred:0.01905103027820587, decouple_loss:0.002761388663202524
The generated pressure mean: 0.4331587553024292
loss_pred:0.01790616102516651, decouple_loss:0.0027893311344087124
Iteration: 6218, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4538777768611908
loss_pred:0.01875491812825203, decouple_loss:0.002826705574989319
The generated pressure mean: 0.4513171315193176
loss_pred:0.017996400594711304, decouple_loss:0.00301295961253345
The generated pressure mean: 0.45661333203315735
loss_pred:0.0189327672123909, decouple_loss:0.0027739356737583876
Iteration: 6219, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4603990614414215
loss_pred:0.0193332489579916, decouple_loss:0.0026990429032593966
The generated pressure mean: 0.4603995978832245
loss_pred:0.018594486638903618, decouple_loss:0.002658289624378085
The generated pressure mean: 0.4653235673904419
loss_pred:0.018399232998490334, decouple_loss:0.002653599949553609
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 6220, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44398432970046997
loss_pred:0.018443843349814415, decouple_loss:0.0032922907266765833
The generated pressure mean: 0.4418679475784302
loss_pred:0.01785670593380928, decouple_loss:0.003349725157022476
The generated pressure mean: 0.44281527400016785
loss_pred:0.018534094095230103, decouple_loss:0.003405035473406315
2023-04-17 11:12:52 testing...
The generated pressure mean: 0.42303696274757385
The generated pressure mean: 0.41620466113090515
The generated pressure mean: 0.4261065423488617
loss_pred:0.030857320874929428, decouple_loss:0.0039755008183419704
loss_pred:0.03191152960062027, decouple_loss:0.0037828637287020683
loss_pred:0.030556609854102135, decouple_loss:0.004113329574465752
WV_0_PC_0_EH_1_PS_40, loss: 0.031306348741054535, avg_mse: 0.04644983634352684
current test mse: 0.04645
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 6221, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43671149015426636
loss_pred:0.018913306295871735, decouple_loss:0.0033134419936686754
The generated pressure mean: 0.4354623258113861
loss_pred:0.019469453021883965, decouple_loss:0.0033760161604732275
The generated pressure mean: 0.43989264965057373
loss_pred:0.01828702725470066, decouple_loss:0.003249417059123516
Iteration: 6222, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479796290397644
The generated pressure mean: 0.45096349716186523
loss_pred:0.01814655400812626, decouple_loss:0.0026379250921308994
loss_pred:0.01967398077249527, decouple_loss:0.002397719072178006
The generated pressure mean: 0.44884926080703735
loss_pred:0.01870371773838997, decouple_loss:0.0023961141705513
Iteration: 6223, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498141407966614
loss_pred:0.02026372216641903, decouple_loss:0.002621142193675041
The generated pressure mean: 0.44681161642074585
loss_pred:0.018534163013100624, decouple_loss:0.0023903921246528625
The generated pressure mean: 0.451083779335022
loss_pred:0.017812592908740044, decouple_loss:0.0024402651470154524
Iteration: 6224, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4419931471347809
The generated pressure mean: 0.44437354803085327
loss_pred:0.019167911261320114, decouple_loss:0.0024931845255196095
loss_pred:0.02079097367823124, decouple_loss:0.002475268207490444
The generated pressure mean: 0.4439990520477295
loss_pred:0.01726182922720909, decouple_loss:0.002483097370713949
Iteration: 6225, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463839828968048The generated pressure mean: 0.4456973373889923
loss_pred:0.019267311319708824, decouple_loss:0.0027082685846835375
loss_pred:0.016746986657381058, decouple_loss:0.0025584171526134014
The generated pressure mean: 0.44619911909103394
loss_pred:0.01869770511984825, decouple_loss:0.0025274907238781452
Iteration: 6226, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4557022452354431
The generated pressure mean: 0.45154836773872375
loss_pred:0.019519947469234467, decouple_loss:0.0024334315676242113
loss_pred:0.018833134323358536, decouple_loss:0.002449055202305317
The generated pressure mean: 0.4535505473613739
loss_pred:0.018436748534440994, decouple_loss:0.0023895076010376215
Iteration: 6227, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44565433263778687
The generated pressure mean: 0.44118553400039673
loss_pred:0.017723403871059418, decouple_loss:0.002260820008814335
loss_pred:0.018326448276638985, decouple_loss:0.002306658076122403
The generated pressure mean: 0.4448342025279999
loss_pred:0.018205884844064713, decouple_loss:0.00232832133769989
Iteration: 6228, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45102640986442566
loss_pred:0.018007788807153702, decouple_loss:0.002397701609879732
The generated pressure mean: 0.45180264115333557
loss_pred:0.018636170774698257, decouple_loss:0.0023977598175406456
The generated pressure mean: 0.45517444610595703
loss_pred:0.018690146505832672, decouple_loss:0.0023904487024992704
Iteration: 6229, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4416147470474243
loss_pred:0.018221279606223106, decouple_loss:0.0029968491289764643
The generated pressure mean: 0.4399707019329071
loss_pred:0.019708503037691116, decouple_loss:0.003116772510111332
The generated pressure mean: 0.44524437189102173
loss_pred:0.01821569725871086, decouple_loss:0.0029557067900896072
Iteration: 6230, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442667067050934
loss_pred:0.019289840012788773, decouple_loss:0.003236459568142891
The generated pressure mean: 0.4434548318386078
loss_pred:0.01712772250175476, decouple_loss:0.0032545661088079214
The generated pressure mean: 0.44316789507865906
loss_pred:0.01940290257334709, decouple_loss:0.003177948761731386
2023-04-17 11:15:28 testing...
The generated pressure mean: 0.41351884603500366
The generated pressure mean: 0.4207022488117218
loss_pred:0.031476255506277084, decouple_loss:0.003458914812654257
The generated pressure mean: 0.423694908618927
loss_pred:0.030344875529408455, decouple_loss:0.00362137402407825
loss_pred:0.030160073190927505, decouple_loss:0.003666197881102562
WV_0_PC_0_EH_1_PS_40, loss: 0.03083951026201248, avg_mse: 0.04562607407569885
current test mse: 0.045626
Iteration: 6231, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4451902210712433
loss_pred:0.018258262425661087, decouple_loss:0.0027776281349360943The generated pressure mean: 0.44554322957992554
loss_pred:0.018614307045936584, decouple_loss:0.002799692563712597
The generated pressure mean: 0.4463917016983032
loss_pred:0.018856845796108246, decouple_loss:0.0026677728164941072
Iteration: 6232, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44669151306152344
loss_pred:0.01750468648970127, decouple_loss:0.003335852175951004
The generated pressure mean: 0.4465709626674652
loss_pred:0.01799158938229084, decouple_loss:0.0031931016128510237
The generated pressure mean: 0.4486544132232666
loss_pred:0.019356200471520424, decouple_loss:0.0031485671643167734
Iteration: 6233, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44944441318511963
loss_pred:0.018182817846536636, decouple_loss:0.002980704652145505
The generated pressure mean: 0.4540768265724182
loss_pred:0.01952710561454296, decouple_loss:0.003044077893719077
The generated pressure mean: 0.4536679983139038
loss_pred:0.019621729850769043, decouple_loss:0.002999009797349572
Iteration: 6234, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44238245487213135
The generated pressure mean: 0.4444204866886139
loss_pred:0.019335230812430382, decouple_loss:0.003373650135472417
loss_pred:0.019717862829566002, decouple_loss:0.0031892319675534964
The generated pressure mean: 0.4457996189594269
loss_pred:0.018934698775410652, decouple_loss:0.003040181938558817
Iteration: 6235, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460579752922058
The generated pressure mean: 0.44728273153305054
loss_pred:0.02118661068379879, decouple_loss:0.0030922750011086464
loss_pred:0.020549345761537552, decouple_loss:0.0030985837802290916
The generated pressure mean: 0.4465295970439911
loss_pred:0.01850556954741478, decouple_loss:0.0030042408034205437
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 6236, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44149717688560486
The generated pressure mean: 0.44404980540275574
loss_pred:0.018560344353318214, decouple_loss:0.0027487289626151323
loss_pred:0.018255721777677536, decouple_loss:0.0027387915179133415
The generated pressure mean: 0.44737279415130615
loss_pred:0.019387757405638695, decouple_loss:0.002853182377293706
Iteration: 6237, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44915443658828735
loss_pred:0.018942944705486298, decouple_loss:0.003451953176409006
The generated pressure mean: 0.4496298134326935
loss_pred:0.019030682742595673, decouple_loss:0.0033606861252337694
The generated pressure mean: 0.4497838020324707
loss_pred:0.01864543743431568, decouple_loss:0.003432635450735688
Iteration: 6238, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44751644134521484
The generated pressure mean: 0.45114657282829285
loss_pred:0.018070708960294724, decouple_loss:0.0036186526995152235
loss_pred:0.017495153471827507, decouple_loss:0.0037452608812600374
The generated pressure mean: 0.4460929036140442
loss_pred:0.018271345645189285, decouple_loss:0.0035705077461898327
Iteration: 6239, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45099103450775146
The generated pressure mean: 0.4446357190608978
loss_pred:0.020169546827673912, decouple_loss:0.0033381192479282618
loss_pred:0.018776295706629753, decouple_loss:0.0034045004285871983
The generated pressure mean: 0.4451998472213745
loss_pred:0.019339680671691895, decouple_loss:0.0033829808235168457
Iteration: 6240, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44390031695365906
The generated pressure mean: 0.44777145981788635
loss_pred:0.018418345600366592, decouple_loss:0.0034181016962975264
loss_pred:0.01876980997622013, decouple_loss:0.0033507701009511948
The generated pressure mean: 0.4441017210483551
loss_pred:0.018230680376291275, decouple_loss:0.003375508589670062
2023-04-17 11:17:21 testing...
The generated pressure mean: 0.41407009959220886
The generated pressure mean: 0.42270195484161377
The generated pressure mean: 0.4261070191860199
loss_pred:0.03310241550207138, decouple_loss:0.0030530854128301144
loss_pred:0.032152146100997925, decouple_loss:0.003318192670121789
loss_pred:0.03205149248242378, decouple_loss:0.0034451312385499477
WV_0_PC_0_EH_1_PS_40, loss: 0.03259895741939545, avg_mse: 0.049465473741292953
current test mse: 0.049465
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 6241, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446346640586853
loss_pred:0.01979650929570198, decouple_loss:0.002584571484476328
The generated pressure mean: 0.4488571286201477
loss_pred:0.017985684797167778, decouple_loss:0.002775107743218541
The generated pressure mean: 0.4499548673629761
loss_pred:0.021534061059355736, decouple_loss:0.002435609931126237
Iteration: 6242, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4238114058971405
The generated pressure mean: 0.4263392388820648
loss_pred:0.019057834520936012, decouple_loss:0.0029436489567160606
loss_pred:0.017676396295428276, decouple_loss:0.002927528228610754
The generated pressure mean: 0.42459988594055176
loss_pred:0.018082333728671074, decouple_loss:0.0029357988387346268
Iteration: 6243, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506264925003052
loss_pred:0.01899612881243229, decouple_loss:0.0033207936212420464
The generated pressure mean: 0.45198526978492737
loss_pred:0.017630187794566154, decouple_loss:0.0035002781078219414
The generated pressure mean: 0.45061978697776794
loss_pred:0.019471319392323494, decouple_loss:0.0034062862396240234
Iteration: 6244, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4712609350681305The generated pressure mean: 0.4691903293132782
loss_pred:0.01794668659567833, decouple_loss:0.0035633703228086233
loss_pred:0.021155543625354767, decouple_loss:0.0035171546041965485
The generated pressure mean: 0.46911874413490295
loss_pred:0.019734269008040428, decouple_loss:0.0034845666959881783
Iteration: 6245, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44922056794166565
loss_pred:0.02015635557472706, decouple_loss:0.0027298314962536097
The generated pressure mean: 0.44369402527809143
loss_pred:0.01785947009921074, decouple_loss:0.0027941116131842136
The generated pressure mean: 0.4451131224632263
loss_pred:0.01951727643609047, decouple_loss:0.002700634766370058
Iteration: 6246, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4348159432411194
loss_pred:0.017902566120028496, decouple_loss:0.0032222806476056576
The generated pressure mean: 0.4346594512462616
loss_pred:0.017883144319057465, decouple_loss:0.0033219594042748213
The generated pressure mean: 0.434798002243042
loss_pred:0.018298093229532242, decouple_loss:0.0032830056734383106
Iteration: 6247, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45479816198349
loss_pred:0.01850411668419838, decouple_loss:0.0031743128784000874
The generated pressure mean: 0.45437878370285034
loss_pred:0.0174228698015213, decouple_loss:0.00319358566775918
The generated pressure mean: 0.45638906955718994
loss_pred:0.01830224320292473, decouple_loss:0.003089205827564001
Iteration: 6248, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44510212540626526
The generated pressure mean: 0.4526343047618866
loss_pred:0.0177865382283926, decouple_loss:0.00301378290168941
loss_pred:0.018752923235297203, decouple_loss:0.0030604784842580557
The generated pressure mean: 0.4508659243583679
loss_pred:0.018795156851410866, decouple_loss:0.0030573117546737194
Iteration: 6249, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44259294867515564
loss_pred:0.02077101729810238, decouple_loss:0.0028837239369750023
The generated pressure mean: 0.4433518052101135
loss_pred:0.01892862096428871, decouple_loss:0.0028705487493425608
The generated pressure mean: 0.4418069124221802
loss_pred:0.01917235180735588, decouple_loss:0.0028649428859353065
Iteration: 6250, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44807636737823486The generated pressure mean: 0.44246795773506165
loss_pred:0.02010500803589821, decouple_loss:0.0031249397434294224
loss_pred:0.01716359332203865, decouple_loss:0.00304093724116683
The generated pressure mean: 0.44547995924949646
loss_pred:0.017613351345062256, decouple_loss:0.003044344484806061
2023-04-17 11:19:53 testing...
The generated pressure mean: 0.41280823945999146
The generated pressure mean: 0.4193080961704254
The generated pressure mean: 0.42305436730384827
loss_pred:0.03498121723532677, decouple_loss:0.003401639871299267
loss_pred:0.03334035351872444, decouple_loss:0.0035149180330336094
loss_pred:0.03282993659377098, decouple_loss:0.0036701676435768604
WV_0_PC_0_EH_1_PS_40, loss: 0.03389361500740051, avg_mse: 0.05110197514295578
current test mse: 0.051102
Iteration: 6251, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44558948278427124
loss_pred:0.016769301146268845, decouple_loss:0.0028141553048044443
The generated pressure mean: 0.45079007744789124
loss_pred:0.01780720241367817, decouple_loss:0.0027251692954450846
The generated pressure mean: 0.4507735073566437
loss_pred:0.02079300954937935, decouple_loss:0.002803557086735964
Iteration: 6252, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449068605899811
loss_pred:0.017737384885549545, decouple_loss:0.002945287385955453The generated pressure mean: 0.4452291429042816
loss_pred:0.019188983365893364, decouple_loss:0.0030772939790040255
The generated pressure mean: 0.44807446002960205
loss_pred:0.018736111000180244, decouple_loss:0.0030127528589218855
Iteration: 6253, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44823649525642395
The generated pressure mean: 0.4505589008331299
loss_pred:0.018379971385002136, decouple_loss:0.003247590968385339
loss_pred:0.020219774916768074, decouple_loss:0.0032016709446907043
The generated pressure mean: 0.45110711455345154
loss_pred:0.01957237906754017, decouple_loss:0.003239396959543228
Iteration: 6254, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.455964058637619
loss_pred:0.01759505085647106, decouple_loss:0.0033137688878923655
The generated pressure mean: 0.4592386782169342
loss_pred:0.018871452659368515, decouple_loss:0.003477703547105193
The generated pressure mean: 0.4595010280609131
loss_pred:0.01864819973707199, decouple_loss:0.003489886177703738
Iteration: 6255, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44403529167175293
The generated pressure mean: 0.44429129362106323
loss_pred:0.018454235047101974, decouple_loss:0.0031507103703916073
loss_pred:0.01906052976846695, decouple_loss:0.0032192340586334467
The generated pressure mean: 0.44385966658592224
loss_pred:0.016611194238066673, decouple_loss:0.0031980013009160757
Iteration: 6256, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4326390326023102
loss_pred:0.016973409801721573, decouple_loss:0.0033872066996991634
The generated pressure mean: 0.4353587329387665
loss_pred:0.019801490008831024, decouple_loss:0.003416657680645585
The generated pressure mean: 0.43197154998779297
loss_pred:0.02052992396056652, decouple_loss:0.0035106309223920107
Iteration: 6257, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4525981843471527
loss_pred:0.018606625497341156, decouple_loss:0.003535813419148326
The generated pressure mean: 0.4543982446193695
loss_pred:0.018984772264957428, decouple_loss:0.003432125085964799
The generated pressure mean: 0.4557406008243561
loss_pred:0.018373077735304832, decouple_loss:0.0033714324235916138
Iteration: 6258, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4589196741580963
The generated pressure mean: 0.4553670287132263
loss_pred:0.018456025049090385, decouple_loss:0.0037095462903380394
loss_pred:0.018048476427793503, decouple_loss:0.0035984341520816088
The generated pressure mean: 0.4586048126220703
loss_pred:0.01902828738093376, decouple_loss:0.0036347759887576103
Iteration: 6259, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44499126076698303
loss_pred:0.018528219312429428, decouple_loss:0.0033746380358934402
The generated pressure mean: 0.44318535923957825
loss_pred:0.01968304067850113, decouple_loss:0.003393207909539342
The generated pressure mean: 0.43789443373680115
loss_pred:0.017251281067728996, decouple_loss:0.003244788618758321
Iteration: 6260, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4377777576446533
loss_pred:0.018336737528443336, decouple_loss:0.003936480265110731
The generated pressure mean: 0.4429094195365906
loss_pred:0.018068939447402954, decouple_loss:0.003873860463500023
The generated pressure mean: 0.44520819187164307
loss_pred:0.01834721490740776, decouple_loss:0.004008709918707609
2023-04-17 11:21:47 testing...
The generated pressure mean: 0.4131816029548645
The generated pressure mean: 0.42192432284355164
The generated pressure mean: 0.42509952187538147
loss_pred:0.033531080931425095, decouple_loss:0.004072493873536587
loss_pred:0.032360177487134933, decouple_loss:0.00417149206623435
loss_pred:0.031809620559215546, decouple_loss:0.004155075643211603
WV_0_PC_0_EH_1_PS_40, loss: 0.03277361020445824, avg_mse: 0.04979469254612923
current test mse: 0.049795
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 6261, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506411552429199
loss_pred:0.01837281323969364, decouple_loss:0.0035405424423515797
The generated pressure mean: 0.4493977129459381
The generated pressure mean: 0.4489138424396515
loss_pred:0.017976507544517517, decouple_loss:0.0035134260542690754
loss_pred:0.017678499221801758, decouple_loss:0.0036890245974063873
Iteration: 6262, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4519045650959015
The generated pressure mean: 0.4509980082511902
loss_pred:0.020322203636169434, decouple_loss:0.00390338315628469
loss_pred:0.018384147435426712, decouple_loss:0.003815714968368411
The generated pressure mean: 0.4539225995540619
loss_pred:0.018443623557686806, decouple_loss:0.0037662906106561422
Iteration: 6263, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4396215081214905
loss_pred:0.018744224682450294, decouple_loss:0.003679134650155902
The generated pressure mean: 0.4438474476337433
loss_pred:0.021421469748020172, decouple_loss:0.0038175552617758512
The generated pressure mean: 0.44738468527793884
loss_pred:0.018499640747904778, decouple_loss:0.003914883825927973
Iteration: 6264, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4372106194496155
loss_pred:0.019362889230251312, decouple_loss:0.0037720443215221167
The generated pressure mean: 0.4385471045970917
loss_pred:0.018917284905910492, decouple_loss:0.003749157302081585
The generated pressure mean: 0.4409078359603882
loss_pred:0.019493576139211655, decouple_loss:0.0035678832791745663
Iteration: 6265, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499480128288269
The generated pressure mean: 0.4509488344192505loss_pred:0.017901655286550522, decouple_loss:0.0029652738012373447
loss_pred:0.019658314064145088, decouple_loss:0.0029730373062193394
The generated pressure mean: 0.44992595911026
loss_pred:0.018283341079950333, decouple_loss:0.0030036221724003553
Iteration: 6266, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469173848628998
The generated pressure mean: 0.4469820559024811
loss_pred:0.0188110563904047, decouple_loss:0.003333978820592165
loss_pred:0.019428933039307594, decouple_loss:0.0034006312489509583
The generated pressure mean: 0.4484795331954956
loss_pred:0.018068470060825348, decouple_loss:0.0030723644886165857
Iteration: 6267, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44992539286613464
The generated pressure mean: 0.4477570950984955
loss_pred:0.01695662923157215, decouple_loss:0.0031047214288264513
loss_pred:0.0209990032017231, decouple_loss:0.003036217764019966
The generated pressure mean: 0.4492540657520294
loss_pred:0.017367174848914146, decouple_loss:0.003118558321148157
Iteration: 6268, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4439035952091217
loss_pred:0.018625805154442787, decouple_loss:0.0031526994425803423
The generated pressure mean: 0.4425656795501709
loss_pred:0.018219102174043655, decouple_loss:0.0032306199427694082
The generated pressure mean: 0.4401901364326477
loss_pred:0.020216036587953568, decouple_loss:0.0031552694272249937
Iteration: 6269, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44296419620513916
loss_pred:0.018635155633091927, decouple_loss:0.0032040190417319536
The generated pressure mean: 0.44287657737731934
loss_pred:0.019556447863578796, decouple_loss:0.0032899435609579086
The generated pressure mean: 0.438747763633728
loss_pred:0.0191196259111166, decouple_loss:0.003309763502329588
Iteration: 6270, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45319652557373047
The generated pressure mean: 0.45457345247268677
loss_pred:0.019052112475037575, decouple_loss:0.0030090459622442722
loss_pred:0.018148520961403847, decouple_loss:0.0029577771201729774
The generated pressure mean: 0.4560650885105133
loss_pred:0.01809556968510151, decouple_loss:0.0031348485499620438
2023-04-17 11:24:14 testing...
The generated pressure mean: 0.4143170714378357
The generated pressure mean: 0.4225042760372162
The generated pressure mean: 0.42621490359306335
loss_pred:0.032977741211652756, decouple_loss:0.003623182885348797
loss_pred:0.03167051821947098, decouple_loss:0.003923701122403145
loss_pred:0.03170742467045784, decouple_loss:0.0037392014637589455
WV_0_PC_0_EH_1_PS_40, loss: 0.03230666369199753, avg_mse: 0.04881289228796959
current test mse: 0.048813
Iteration: 6271, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4509293735027313
loss_pred:0.01897202618420124, decouple_loss:0.0034013185650110245
The generated pressure mean: 0.44843003153800964
loss_pred:0.018367651849985123, decouple_loss:0.003290539840236306
The generated pressure mean: 0.44622793793678284
loss_pred:0.0168607234954834, decouple_loss:0.003383536823093891
Iteration: 6272, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4427150785923004
The generated pressure mean: 0.4435368478298187
loss_pred:0.018062064424157143, decouple_loss:0.0031856317073106766
loss_pred:0.016678063198924065, decouple_loss:0.003104642266407609
The generated pressure mean: 0.44460099935531616
loss_pred:0.017367718741297722, decouple_loss:0.0033035490196198225
Iteration: 6273, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4433538615703583
loss_pred:0.019608857110142708, decouple_loss:0.003411770099774003
The generated pressure mean: 0.4438115060329437
loss_pred:0.019074227660894394, decouple_loss:0.0033828113228082657
The generated pressure mean: 0.4468417167663574
loss_pred:0.019489813596010208, decouple_loss:0.0032896269112825394
Iteration: 6274, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44661465287208557
loss_pred:0.01777028851211071, decouple_loss:0.0037660051602870226
The generated pressure mean: 0.4466612637042999
loss_pred:0.018399540334939957, decouple_loss:0.003781842300668359
The generated pressure mean: 0.4437832534313202
loss_pred:0.018756525591015816, decouple_loss:0.003733257297426462
Iteration: 6275, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45041364431381226
loss_pred:0.019764384254813194, decouple_loss:0.0030175819993019104
The generated pressure mean: 0.4503602087497711
loss_pred:0.018963003531098366, decouple_loss:0.003100173780694604
The generated pressure mean: 0.4466264247894287
loss_pred:0.017722131684422493, decouple_loss:0.0032019182108342648
Iteration: 6276, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481692612171173
loss_pred:0.019931623712182045, decouple_loss:0.003238576464354992
The generated pressure mean: 0.44637465476989746
loss_pred:0.018558751791715622, decouple_loss:0.003238699398934841
The generated pressure mean: 0.4442325830459595
loss_pred:0.018940243870019913, decouple_loss:0.003393033053725958
Iteration: 6277, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488728940486908
loss_pred:0.017986677587032318, decouple_loss:0.002655480057001114
The generated pressure mean: 0.44276538491249084
loss_pred:0.018105491995811462, decouple_loss:0.0026474876794964075
The generated pressure mean: 0.43905553221702576
loss_pred:0.017946826294064522, decouple_loss:0.0027218549512326717
Iteration: 6278, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45187973976135254
loss_pred:0.017714258283376694, decouple_loss:0.002503967611119151
The generated pressure mean: 0.45081737637519836
loss_pred:0.01980346441268921, decouple_loss:0.0024459625128656626
The generated pressure mean: 0.45071712136268616
loss_pred:0.01986960507929325, decouple_loss:0.002410643268376589
Iteration: 6279, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4433175027370453
The generated pressure mean: 0.4437471032142639
loss_pred:0.018485261127352715, decouple_loss:0.0028609582222998142
loss_pred:0.018572404980659485, decouple_loss:0.002808541990816593
The generated pressure mean: 0.4399363100528717
loss_pred:0.019391397014260292, decouple_loss:0.0028709962498396635
Iteration: 6280, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462709426879883
loss_pred:0.018322277814149857, decouple_loss:0.00305457366630435
The generated pressure mean: 0.4464607238769531
loss_pred:0.01740119978785515, decouple_loss:0.003170906100422144
The generated pressure mean: 0.4478650391101837
loss_pred:0.01954541727900505, decouple_loss:0.0029746752697974443
2023-04-17 11:26:08 testing...
The generated pressure mean: 0.41297370195388794
The generated pressure mean: 0.4211426377296448
loss_pred:0.03198089450597763, decouple_loss:0.0030241706408560276
The generated pressure mean: 0.4245029091835022
loss_pred:0.030644509941339493, decouple_loss:0.0031692003831267357
loss_pred:0.03017944097518921, decouple_loss:0.0033339771907776594
WV_0_PC_0_EH_1_PS_40, loss: 0.031093738973140717, avg_mse: 0.04637250676751137
current test mse: 0.046373
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 6281, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44926005601882935
loss_pred:0.019294429570436478, decouple_loss:0.0027704029344022274
The generated pressure mean: 0.45262953639030457
loss_pred:0.01921144500374794, decouple_loss:0.0026912554167211056
The generated pressure mean: 0.45253244042396545
loss_pred:0.018517887219786644, decouple_loss:0.0027358890511095524
Iteration: 6282, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4423900246620178
The generated pressure mean: 0.4429416060447693
loss_pred:0.01899540424346924, decouple_loss:0.002819526707753539
loss_pred:0.019268006086349487, decouple_loss:0.002740714466199279
The generated pressure mean: 0.4371420443058014
loss_pred:0.018130483105778694, decouple_loss:0.002783539006486535
Iteration: 6283, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460905194282532
The generated pressure mean: 0.4459092617034912
loss_pred:0.01834332011640072, decouple_loss:0.0027775918133556843
loss_pred:0.01836017519235611, decouple_loss:0.0026678277645260096
The generated pressure mean: 0.44430482387542725
loss_pred:0.01988624781370163, decouple_loss:0.002633703174069524
Iteration: 6284, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45201432704925537
The generated pressure mean: 0.45213860273361206
loss_pred:0.018360622227191925, decouple_loss:0.0026160371489822865
loss_pred:0.018014147877693176, decouple_loss:0.0025604378897696733
The generated pressure mean: 0.4484174847602844
loss_pred:0.01879528909921646, decouple_loss:0.002565620234236121
Iteration: 6285, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44937369227409363
The generated pressure mean: 0.449483722448349
loss_pred:0.01850701868534088, decouple_loss:0.0031274210195988417
loss_pred:0.01950107514858246, decouple_loss:0.0031643931288272142
The generated pressure mean: 0.4510405659675598
loss_pred:0.01834999769926071, decouple_loss:0.0031096001621335745
Iteration: 6286, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.435637503862381
The generated pressure mean: 0.441297709941864
loss_pred:0.018623534590005875, decouple_loss:0.0030852833297103643
loss_pred:0.01940157450735569, decouple_loss:0.003245767904445529
The generated pressure mean: 0.44182583689689636
loss_pred:0.01865381747484207, decouple_loss:0.003159275045618415
Iteration: 6287, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44432932138442993
The generated pressure mean: 0.448817640542984
loss_pred:0.018445312976837158, decouple_loss:0.0022989462595432997
loss_pred:0.01970570534467697, decouple_loss:0.0022657024674117565
The generated pressure mean: 0.44395938515663147
loss_pred:0.01902831718325615, decouple_loss:0.002330180024728179
Iteration: 6288, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.452377587556839
loss_pred:0.018202953040599823, decouple_loss:0.0030475480016320944
The generated pressure mean: 0.4514580965042114
loss_pred:0.019505813717842102, decouple_loss:0.0029374740552157164
The generated pressure mean: 0.4455994963645935
loss_pred:0.017252206802368164, decouple_loss:0.0029527931474149227
Iteration: 6289, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477928876876831
The generated pressure mean: 0.448386013507843
loss_pred:0.018719302490353584, decouple_loss:0.0032442864030599594
loss_pred:0.018753666430711746, decouple_loss:0.0031841059681028128
The generated pressure mean: 0.4466034770011902
loss_pred:0.019033538177609444, decouple_loss:0.0033201677724719048
Iteration: 6290, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44556206464767456
loss_pred:0.018180472776293755, decouple_loss:0.002677934244275093
The generated pressure mean: 0.4401509761810303
loss_pred:0.018505053594708443, decouple_loss:0.0026770601980388165
The generated pressure mean: 0.443061888217926
loss_pred:0.018610352650284767, decouple_loss:0.002648381981998682
2023-04-17 11:28:40 testing...
The generated pressure mean: 0.4133392572402954
The generated pressure mean: 0.4208468794822693
loss_pred:0.032199759036302567, decouple_loss:0.0037451284006237984
The generated pressure mean: 0.4241631329059601
loss_pred:0.03095422126352787, decouple_loss:0.00401278305798769
loss_pred:0.03072550520300865, decouple_loss:0.0041972859762609005
WV_0_PC_0_EH_1_PS_40, loss: 0.031492412090301514, avg_mse: 0.04678613692522049
current test mse: 0.046786
Iteration: 6291, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45109134912490845
loss_pred:0.019346244633197784, decouple_loss:0.0034146110992878675
The generated pressure mean: 0.4474283456802368
loss_pred:0.01876235008239746, decouple_loss:0.003171012969687581
The generated pressure mean: 0.44567909836769104
loss_pred:0.018199270591139793, decouple_loss:0.0032336870208382607
Iteration: 6292, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44573837518692017
loss_pred:0.019804134964942932, decouple_loss:0.004206288140267134
The generated pressure mean: 0.4480164051055908
loss_pred:0.018913690000772476, decouple_loss:0.0038982704281806946
The generated pressure mean: 0.44841715693473816
loss_pred:0.01970561034977436, decouple_loss:0.004199199844151735
Iteration: 6293, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4427543878555298
loss_pred:0.01838655397295952, decouple_loss:0.00297222170047462
The generated pressure mean: 0.4411146640777588
loss_pred:0.0172952301800251, decouple_loss:0.0031680127140134573
The generated pressure mean: 0.44342470169067383
loss_pred:0.01897883601486683, decouple_loss:0.0029545507859438658
Iteration: 6294, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497619569301605
The generated pressure mean: 0.44807371497154236
loss_pred:0.01787281036376953, decouple_loss:0.0028217395301908255
loss_pred:0.01945735327899456, decouple_loss:0.002883918583393097
The generated pressure mean: 0.4481717348098755
loss_pred:0.018608082085847855, decouple_loss:0.0027596496511250734
Iteration: 6295, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4541921615600586
loss_pred:0.017775695770978928, decouple_loss:0.0030707407277077436
The generated pressure mean: 0.4517478346824646
loss_pred:0.017324738204479218, decouple_loss:0.0031788386404514313
The generated pressure mean: 0.45133742690086365
loss_pred:0.018592046573758125, decouple_loss:0.0031355833634734154
Iteration: 6296, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4393613934516907
The generated pressure mean: 0.43911775946617126loss_pred:0.018247589468955994, decouple_loss:0.0029636353719979525
loss_pred:0.0181086715310812, decouple_loss:0.0029471819289028645
The generated pressure mean: 0.4360125660896301
loss_pred:0.018589727580547333, decouple_loss:0.002935670781880617
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 6297, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45002758502960205
The generated pressure mean: 0.44908756017684937
loss_pred:0.018262311816215515, decouple_loss:0.0027269935235381126
loss_pred:0.017492130398750305, decouple_loss:0.0029177668038755655
The generated pressure mean: 0.4476551115512848
loss_pred:0.01896096020936966, decouple_loss:0.002732474124059081
Iteration: 6298, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4554780125617981
loss_pred:0.017930306494235992, decouple_loss:0.0026429579593241215
The generated pressure mean: 0.4445788860321045
loss_pred:0.017597908154129982, decouple_loss:0.002749455627053976
The generated pressure mean: 0.45236343145370483
loss_pred:0.018241439014673233, decouple_loss:0.002847519936040044
Iteration: 6299, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44514039158821106
loss_pred:0.01779775321483612, decouple_loss:0.0029550697654485703
The generated pressure mean: 0.447353333234787
loss_pred:0.017642192542552948, decouple_loss:0.0031634122133255005
The generated pressure mean: 0.44477978348731995
loss_pred:0.018133286386728287, decouple_loss:0.002850262215360999
Iteration: 6300, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464779794216156
loss_pred:0.018729550763964653, decouple_loss:0.002725530182942748
The generated pressure mean: 0.4420061409473419
loss_pred:0.0185167845338583, decouple_loss:0.002718566916882992
The generated pressure mean: 0.44386300444602966
loss_pred:0.018908189609646797, decouple_loss:0.0026842609513550997
2023-04-17 11:30:34 testing...
The generated pressure mean: 0.41389432549476624
The generated pressure mean: 0.42110201716423035
loss_pred:0.0325758270919323, decouple_loss:0.003380408277735114
The generated pressure mean: 0.4245002269744873
loss_pred:0.03134278953075409, decouple_loss:0.003667233744636178
loss_pred:0.03140968084335327, decouple_loss:0.003687451360747218
WV_0_PC_0_EH_1_PS_40, loss: 0.031955018639564514, avg_mse: 0.047986309975385666
current test mse: 0.047986
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 6301, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4453698992729187
loss_pred:0.018996523693203926, decouple_loss:0.003045701887458563
The generated pressure mean: 0.447951078414917
loss_pred:0.019526632502675056, decouple_loss:0.002833412028849125
The generated pressure mean: 0.44963982701301575
loss_pred:0.018670087680220604, decouple_loss:0.002914959564805031
Iteration: 6302, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4418240785598755The generated pressure mean: 0.4408785402774811
loss_pred:0.01995617151260376, decouple_loss:0.003013288602232933loss_pred:0.017729591578245163, decouple_loss:0.0030007020104676485
The generated pressure mean: 0.44095808267593384
loss_pred:0.020210718736052513, decouple_loss:0.0030318396165966988
Iteration: 6303, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45354992151260376
The generated pressure mean: 0.4507686495780945
loss_pred:0.020972486585378647, decouple_loss:0.0038210060447454453
loss_pred:0.017552385106682777, decouple_loss:0.0036232813727110624
The generated pressure mean: 0.4483547806739807
loss_pred:0.021575763821601868, decouple_loss:0.003923467360436916
Iteration: 6304, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44226616621017456
The generated pressure mean: 0.44246336817741394
loss_pred:0.01810617558658123, decouple_loss:0.003168262541294098
loss_pred:0.02150428481400013, decouple_loss:0.0032147224992513657
The generated pressure mean: 0.446028470993042
loss_pred:0.01929633505642414, decouple_loss:0.003055470995604992
Iteration: 6305, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4533480703830719
The generated pressure mean: 0.4479692876338959
loss_pred:0.01988026686012745, decouple_loss:0.0033129840157926083
loss_pred:0.018793489784002304, decouple_loss:0.0033261647913604975
The generated pressure mean: 0.4479920268058777
loss_pred:0.018888577818870544, decouple_loss:0.003361818613484502
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 6306, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481678605079651
loss_pred:0.019861813634634018, decouple_loss:0.0038597409147769213
The generated pressure mean: 0.4471239745616913
loss_pred:0.018845515325665474, decouple_loss:0.003842891426756978
The generated pressure mean: 0.4436233937740326
loss_pred:0.019344696775078773, decouple_loss:0.003860211232677102
Iteration: 6307, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44517800211906433The generated pressure mean: 0.4459470808506012
loss_pred:0.018479123711586, decouple_loss:0.0027499981224536896loss_pred:0.019466226920485497, decouple_loss:0.0027816796209663153
The generated pressure mean: 0.44766324758529663
loss_pred:0.02087712287902832, decouple_loss:0.00286164996214211
Iteration: 6308, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477766454219818
loss_pred:0.020514246076345444, decouple_loss:0.003557671094313264
The generated pressure mean: 0.4439714848995209
loss_pred:0.019193176180124283, decouple_loss:0.0038692005909979343
The generated pressure mean: 0.45127350091934204
loss_pred:0.018982410430908203, decouple_loss:0.0035690651275217533
Iteration: 6309, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448864609003067
The generated pressure mean: 0.4435071349143982
loss_pred:0.01870903931558132, decouple_loss:0.002875441452488303
loss_pred:0.02070326916873455, decouple_loss:0.0028549442067742348
The generated pressure mean: 0.447671502828598
loss_pred:0.018244748935103416, decouple_loss:0.0028533663135021925
Iteration: 6310, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4381253123283386
The generated pressure mean: 0.43743351101875305
loss_pred:0.01883487030863762, decouple_loss:0.0033445991575717926
loss_pred:0.018315095454454422, decouple_loss:0.0032892460003495216
The generated pressure mean: 0.4386398196220398
loss_pred:0.01838393695652485, decouple_loss:0.0030680361669510603
2023-04-17 11:33:03 testing...
The generated pressure mean: 0.4126971960067749
The generated pressure mean: 0.42092758417129517
The generated pressure mean: 0.4242623746395111
loss_pred:0.03211648389697075, decouple_loss:0.0039424230344593525
loss_pred:0.03086119331419468, decouple_loss:0.00416488666087389
loss_pred:0.030285105109214783, decouple_loss:0.0043685040436685085
WV_0_PC_0_EH_1_PS_40, loss: 0.031295523047447205, avg_mse: 0.04665574058890343
current test mse: 0.046656
Iteration: 6311, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499974250793457
loss_pred:0.018257664516568184, decouple_loss:0.003574076108634472
The generated pressure mean: 0.4542049467563629
loss_pred:0.018053149804472923, decouple_loss:0.0035215304233133793
The generated pressure mean: 0.44953277707099915
loss_pred:0.019516974687576294, decouple_loss:0.0035654616076499224
Iteration: 6312, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45185115933418274
loss_pred:0.02019158937036991, decouple_loss:0.003356698900461197
The generated pressure mean: 0.452998548746109
loss_pred:0.02117578499019146, decouple_loss:0.0033465896267443895
The generated pressure mean: 0.4556320607662201
loss_pred:0.019190195947885513, decouple_loss:0.003208266803994775
Iteration: 6313, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4369099736213684
The generated pressure mean: 0.4354366660118103loss_pred:0.01976162940263748, decouple_loss:0.0031504034996032715
loss_pred:0.01962563581764698, decouple_loss:0.0031995936296880245
The generated pressure mean: 0.4369739294052124
loss_pred:0.01904185116291046, decouple_loss:0.0029103218112140894
Iteration: 6314, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44700872898101807
loss_pred:0.0189896859228611, decouple_loss:0.0031087915413081646
The generated pressure mean: 0.4459846317768097
loss_pred:0.019191738218069077, decouple_loss:0.0029149705078452826
The generated pressure mean: 0.44716790318489075
loss_pred:0.018854977563023567, decouple_loss:0.0030754220206290483
Iteration: 6315, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45685532689094543
loss_pred:0.018409647047519684, decouple_loss:0.002828561468049884
The generated pressure mean: 0.4545912742614746
loss_pred:0.02079365961253643, decouple_loss:0.002731860149651766
The generated pressure mean: 0.45548510551452637
loss_pred:0.01899222657084465, decouple_loss:0.0027817341033369303
Iteration: 6316, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4374297857284546
loss_pred:0.018558252602815628, decouple_loss:0.0032293004915118217
The generated pressure mean: 0.43994709849357605
loss_pred:0.019092317670583725, decouple_loss:0.0033572118263691664
The generated pressure mean: 0.43202027678489685
loss_pred:0.01898551546037197, decouple_loss:0.0033556874841451645
Iteration: 6317, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43642812967300415
loss_pred:0.018492411822080612, decouple_loss:0.0032646027393639088
The generated pressure mean: 0.4404573142528534
loss_pred:0.02026374079287052, decouple_loss:0.0032229083590209484
The generated pressure mean: 0.4379352033138275
loss_pred:0.021044529974460602, decouple_loss:0.003321551252156496
Iteration: 6318, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45962759852409363
loss_pred:0.017662202939391136, decouple_loss:0.0033392070326954126
The generated pressure mean: 0.45944535732269287
loss_pred:0.02010973170399666, decouple_loss:0.0034590759314596653
The generated pressure mean: 0.4591215252876282
loss_pred:0.01823132112622261, decouple_loss:0.0031100409105420113
Iteration: 6319, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45626142621040344
loss_pred:0.018976345658302307, decouple_loss:0.003159231971949339
The generated pressure mean: 0.4547082483768463
loss_pred:0.019421860575675964, decouple_loss:0.0032357745803892612
The generated pressure mean: 0.4516949951648712
loss_pred:0.019268272444605827, decouple_loss:0.0032136363442987204
Iteration: 6320, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43698593974113464
loss_pred:0.018068674951791763, decouple_loss:0.0031635372433811426
The generated pressure mean: 0.43605944514274597
loss_pred:0.019399134442210197, decouple_loss:0.003196350997313857
The generated pressure mean: 0.437966912984848
loss_pred:0.019865017384290695, decouple_loss:0.0031182277016341686
2023-04-17 11:34:58 testing...
The generated pressure mean: 0.41538673639297485
The generated pressure mean: 0.42290499806404114
The generated pressure mean: 0.42604732513427734
loss_pred:0.03211215138435364, decouple_loss:0.004024415276944637
loss_pred:0.030628155916929245, decouple_loss:0.004231116268783808
loss_pred:0.030215993523597717, decouple_loss:0.0045096795074641705
WV_0_PC_0_EH_1_PS_40, loss: 0.03119818866252899, avg_mse: 0.0465131439268589
current test mse: 0.046513
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 6321, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44594547152519226
loss_pred:0.017781110480427742, decouple_loss:0.003376428736373782
The generated pressure mean: 0.4477667212486267
loss_pred:0.018098197877407074, decouple_loss:0.0035495420452207327
The generated pressure mean: 0.4424876272678375
loss_pred:0.017702490091323853, decouple_loss:0.003310070838779211
Iteration: 6322, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4528907537460327
The generated pressure mean: 0.4477722942829132
loss_pred:0.017505517229437828, decouple_loss:0.002779634902253747
loss_pred:0.01857910118997097, decouple_loss:0.002761672716587782
The generated pressure mean: 0.4499443471431732
loss_pred:0.01781177893280983, decouple_loss:0.0030477414838969707
Iteration: 6323, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44972240924835205
loss_pred:0.019208896905183792, decouple_loss:0.0033169963862746954
The generated pressure mean: 0.4446990191936493
loss_pred:0.0173107348382473, decouple_loss:0.003380805253982544
The generated pressure mean: 0.44536808133125305
loss_pred:0.019440555945038795, decouple_loss:0.0034213184844702482
Iteration: 6324, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44842100143432617
loss_pred:0.023181891068816185, decouple_loss:0.0032571495976299047
The generated pressure mean: 0.44407713413238525
loss_pred:0.017657190561294556, decouple_loss:0.003221465041860938
The generated pressure mean: 0.4437338411808014
loss_pred:0.01925859972834587, decouple_loss:0.003154753241688013
Iteration: 6325, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4357966482639313
loss_pred:0.020104041323065758, decouple_loss:0.0033915627282112837
The generated pressure mean: 0.43334394693374634
loss_pred:0.019086403772234917, decouple_loss:0.0031187001150101423
The generated pressure mean: 0.4399102032184601
loss_pred:0.01842845045030117, decouple_loss:0.002860366366803646
Iteration: 6326, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45502111315727234
loss_pred:0.02390357106924057, decouple_loss:0.002845078706741333
The generated pressure mean: 0.4541807472705841
loss_pred:0.019168123602867126, decouple_loss:0.0028518957551568747
The generated pressure mean: 0.4580160975456238
loss_pred:0.01900847814977169, decouple_loss:0.0027436360251158476
Iteration: 6327, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.417693167924881
loss_pred:0.019694870337843895, decouple_loss:0.0028987363912165165
The generated pressure mean: 0.41623014211654663
loss_pred:0.018328050151467323, decouple_loss:0.002863000612705946
The generated pressure mean: 0.42380058765411377
loss_pred:0.019029630348086357, decouple_loss:0.002839077264070511
Iteration: 6328, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45591405034065247
The generated pressure mean: 0.4592472016811371
loss_pred:0.018492499366402626, decouple_loss:0.003772023366764188
loss_pred:0.02009863592684269, decouple_loss:0.003894170979037881
The generated pressure mean: 0.45370808243751526
loss_pred:0.020256822928786278, decouple_loss:0.0038029232528060675
Iteration: 6329, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.47897690534591675
loss_pred:0.01721438579261303, decouple_loss:0.0037705199792981148
The generated pressure mean: 0.47225645184516907
loss_pred:0.019808148965239525, decouple_loss:0.0038622552528977394
The generated pressure mean: 0.4749031960964203
loss_pred:0.018078692257404327, decouple_loss:0.0037945557851344347
Iteration: 6330, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4407004117965698
loss_pred:0.018422318622469902, decouple_loss:0.0034936030860990286
The generated pressure mean: 0.43458524346351624
loss_pred:0.019867844879627228, decouple_loss:0.0034441608004271984
The generated pressure mean: 0.44352927803993225
loss_pred:0.01912650465965271, decouple_loss:0.0036661988124251366
2023-04-17 11:37:31 testing...
The generated pressure mean: 0.41968008875846863
The generated pressure mean: 0.4268665909767151
The generated pressure mean: 0.4296400547027588
loss_pred:0.033766090869903564, decouple_loss:0.003292948240414262
loss_pred:0.032805364578962326, decouple_loss:0.0035120181273669004
loss_pred:0.032741330564022064, decouple_loss:0.0037129942793399096
WV_0_PC_0_EH_1_PS_40, loss: 0.03327956423163414, avg_mse: 0.05056655779480934
current test mse: 0.050567
Iteration: 6331, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4237755537033081
loss_pred:0.01909147948026657, decouple_loss:0.0029761961195617914
The generated pressure mean: 0.4241679608821869
loss_pred:0.018654625862836838, decouple_loss:0.0029038891661912203
The generated pressure mean: 0.4188103973865509
loss_pred:0.019153492525219917, decouple_loss:0.002797783585265279
Iteration: 6332, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4534970819950104
loss_pred:0.01733941026031971, decouple_loss:0.0034292053896933794
The generated pressure mean: 0.4488767683506012
loss_pred:0.018515950068831444, decouple_loss:0.0035939787048846483
The generated pressure mean: 0.4532228708267212
loss_pred:0.018773896619677544, decouple_loss:0.003567502135410905
Iteration: 6333, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4585414230823517
loss_pred:0.019973287358880043, decouple_loss:0.0027722613885998726
The generated pressure mean: 0.4659597873687744
loss_pred:0.019245494157075882, decouple_loss:0.002705617807805538
The generated pressure mean: 0.4674491286277771
loss_pred:0.01876012794673443, decouple_loss:0.0027817999944090843
Iteration: 6334, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44810211658477783
loss_pred:0.019902434200048447, decouple_loss:0.00331475050188601
The generated pressure mean: 0.443183958530426
loss_pred:0.017995106056332588, decouple_loss:0.003136872546747327
The generated pressure mean: 0.4431128203868866
loss_pred:0.01859183982014656, decouple_loss:0.0029985459987074137
Iteration: 6335, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4414999783039093
loss_pred:0.018883615732192993, decouple_loss:0.0026755109429359436
The generated pressure mean: 0.445794016122818
loss_pred:0.019505709409713745, decouple_loss:0.0025614083278924227
The generated pressure mean: 0.44072356820106506
loss_pred:0.018885480239987373, decouple_loss:0.0025022896006703377
Iteration: 6336, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4456044137477875
loss_pred:0.018723219633102417, decouple_loss:0.0029236692935228348
The generated pressure mean: 0.44431859254837036
loss_pred:0.018556298688054085, decouple_loss:0.0029611289501190186
The generated pressure mean: 0.4473576843738556
loss_pred:0.018304863944649696, decouple_loss:0.0030054068192839622
Iteration: 6337, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44303980469703674
loss_pred:0.02120298519730568, decouple_loss:0.003165887203067541
The generated pressure mean: 0.4397163987159729
loss_pred:0.019458133727312088, decouple_loss:0.003364594653248787
The generated pressure mean: 0.44302430748939514
loss_pred:0.018236344680190086, decouple_loss:0.0032728782389312983
Iteration: 6338, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4403655529022217
loss_pred:0.017554419115185738, decouple_loss:0.002824971452355385
The generated pressure mean: 0.4437887966632843
The generated pressure mean: 0.44024208188056946
loss_pred:0.020219823345541954, decouple_loss:0.002898136153817177
loss_pred:0.01867956668138504, decouple_loss:0.002869216026738286
Iteration: 6339, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.458065927028656
loss_pred:0.018249331042170525, decouple_loss:0.003389187855646014
The generated pressure mean: 0.4614979922771454
loss_pred:0.01978277415037155, decouple_loss:0.0035724372137337923
The generated pressure mean: 0.46039003133773804
loss_pred:0.02038513869047165, decouple_loss:0.003625542391091585
Iteration: 6340, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43941637873649597
loss_pred:0.02105950377881527, decouple_loss:0.0036782799288630486
The generated pressure mean: 0.44343405961990356
loss_pred:0.01873408444225788, decouple_loss:0.003739147912710905
The generated pressure mean: 0.44481730461120605
loss_pred:0.019778965041041374, decouple_loss:0.003717261366546154
2023-04-17 11:39:26 testing...
The generated pressure mean: 0.415042906999588
The generated pressure mean: 0.4219612181186676
The generated pressure mean: 0.42427709698677063
loss_pred:0.032062605023384094, decouple_loss:0.003979308530688286
loss_pred:0.03117539919912815, decouple_loss:0.004156504292041063
loss_pred:0.030870482325553894, decouple_loss:0.0043053096160292625
WV_0_PC_0_EH_1_PS_40, loss: 0.03157684952020645, avg_mse: 0.04673013463616371
current test mse: 0.04673
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 6341, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4358273446559906
loss_pred:0.018289972096681595, decouple_loss:0.003576281014829874
The generated pressure mean: 0.4368594288825989
loss_pred:0.020832492038607597, decouple_loss:0.003513892414048314
The generated pressure mean: 0.43636074662208557
loss_pred:0.018886225298047066, decouple_loss:0.0037492753472179174
Iteration: 6342, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45273905992507935
The generated pressure mean: 0.44753605127334595
loss_pred:0.01918863132596016, decouple_loss:0.0028036797884851694
loss_pred:0.01861705258488655, decouple_loss:0.002758011454716325
The generated pressure mean: 0.45152828097343445
loss_pred:0.018915077671408653, decouple_loss:0.002872510114684701
Iteration: 6343, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44934290647506714
The generated pressure mean: 0.44577115774154663
loss_pred:0.017239578068256378, decouple_loss:0.002676889533177018
loss_pred:0.019370978698134422, decouple_loss:0.002585932146757841
The generated pressure mean: 0.4451582431793213
loss_pred:0.02133517526090145, decouple_loss:0.0026947332080453634
Iteration: 6344, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4320736229419708
The generated pressure mean: 0.43200814723968506
loss_pred:0.017949970439076424, decouple_loss:0.0026425763498991728
loss_pred:0.018311304971575737, decouple_loss:0.0028916362207382917
The generated pressure mean: 0.4307616949081421
loss_pred:0.021092167124152184, decouple_loss:0.0028548846021294594
Iteration: 6345, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4559348523616791
The generated pressure mean: 0.4589495360851288
loss_pred:0.018900344148278236, decouple_loss:0.0035346252843737602
loss_pred:0.01890379935503006, decouple_loss:0.003384463954716921
The generated pressure mean: 0.45982515811920166
loss_pred:0.017527718096971512, decouple_loss:0.0033487151376903057
Iteration: 6346, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498450458049774
The generated pressure mean: 0.45013514161109924
loss_pred:0.01931581273674965, decouple_loss:0.0037911958061158657
loss_pred:0.019550804048776627, decouple_loss:0.003563249483704567
The generated pressure mean: 0.45726025104522705
loss_pred:0.019100168719887733, decouple_loss:0.003808157052844763
Iteration: 6347, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4359205365180969
The generated pressure mean: 0.42969268560409546
loss_pred:0.01920238509774208, decouple_loss:0.002960100769996643
loss_pred:0.0186486653983593, decouple_loss:0.0030617769807577133
The generated pressure mean: 0.4346844255924225
loss_pred:0.019794858992099762, decouple_loss:0.002969641936942935
Iteration: 6348, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44913700222969055
The generated pressure mean: 0.4466232657432556
loss_pred:0.01833532378077507, decouple_loss:0.003044713521376252
loss_pred:0.019733548164367676, decouple_loss:0.0029924188274890184
The generated pressure mean: 0.4442639648914337
loss_pred:0.019747279584407806, decouple_loss:0.002987205982208252
Iteration: 6349, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4553290903568268
The generated pressure mean: 0.45037972927093506
loss_pred:0.016770269721746445, decouple_loss:0.0035755943972617388
loss_pred:0.019383838400244713, decouple_loss:0.003491966752335429
The generated pressure mean: 0.4509658217430115
loss_pred:0.01890784502029419, decouple_loss:0.003548624459654093
Iteration: 6350, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44366464018821716
The generated pressure mean: 0.44264301657676697
loss_pred:0.019491998478770256, decouple_loss:0.0032710502855479717
loss_pred:0.018677981570363045, decouple_loss:0.003319293726235628
The generated pressure mean: 0.44543564319610596
loss_pred:0.020065048709511757, decouple_loss:0.0033334463369101286
2023-04-17 11:42:03 testing...
The generated pressure mean: 0.41311949491500854
The generated pressure mean: 0.4212305545806885
The generated pressure mean: 0.4244324564933777
loss_pred:0.03488058224320412, decouple_loss:0.003811836475506425
loss_pred:0.033434998244047165, decouple_loss:0.004063497297465801
loss_pred:0.033409085124731064, decouple_loss:0.004246806260198355
WV_0_PC_0_EH_1_PS_40, loss: 0.034110259264707565, avg_mse: 0.05226985365152359
current test mse: 0.05227
Iteration: 6351, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45040690898895264
loss_pred:0.020111791789531708, decouple_loss:0.0032897412311285734
The generated pressure mean: 0.44751232862472534
loss_pred:0.019339829683303833, decouple_loss:0.003159706247970462
The generated pressure mean: 0.44777166843414307
loss_pred:0.018714990466833115, decouple_loss:0.0033937895204871893
Iteration: 6352, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442491829395294
The generated pressure mean: 0.4454696774482727
loss_pred:0.017825458198785782, decouple_loss:0.0033826136495918036
loss_pred:0.018690424039959908, decouple_loss:0.0032187439501285553
The generated pressure mean: 0.4432249665260315
loss_pred:0.018689507618546486, decouple_loss:0.003280727658420801
Iteration: 6353, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44243812561035156
The generated pressure mean: 0.4384724795818329
loss_pred:0.01869775727391243, decouple_loss:0.002879369305446744
loss_pred:0.019732244312763214, decouple_loss:0.0029528685845434666
The generated pressure mean: 0.4395879805088043
loss_pred:0.019094055518507957, decouple_loss:0.00276417238637805
Iteration: 6354, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4526346027851105
The generated pressure mean: 0.45415863394737244
loss_pred:0.01783270388841629, decouple_loss:0.003318486036732793
loss_pred:0.019755763933062553, decouple_loss:0.0032336583826690912
The generated pressure mean: 0.4568822383880615
loss_pred:0.017677046358585358, decouple_loss:0.003400198882445693
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 6355, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43739208579063416
The generated pressure mean: 0.4424813687801361
loss_pred:0.01910369098186493, decouple_loss:0.003863091580569744
loss_pred:0.019508924335241318, decouple_loss:0.0038091265596449375
The generated pressure mean: 0.4401828944683075
loss_pred:0.019535498693585396, decouple_loss:0.0037793766241520643
Iteration: 6356, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44415703415870667
The generated pressure mean: 0.4440045654773712
loss_pred:0.01787121593952179, decouple_loss:0.002853204496204853
loss_pred:0.01849878765642643, decouple_loss:0.002898117294535041
The generated pressure mean: 0.4401981830596924
loss_pred:0.018735507503151894, decouple_loss:0.002879783045500517
Iteration: 6357, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4565061330795288
The generated pressure mean: 0.45474570989608765
loss_pred:0.019053762778639793, decouple_loss:0.0041237156838178635
loss_pred:0.019207946956157684, decouple_loss:0.004157219547778368
The generated pressure mean: 0.4552534818649292
loss_pred:0.01753639616072178, decouple_loss:0.003964055795222521
Iteration: 6358, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4511181712150574
loss_pred:0.017980773001909256, decouple_loss:0.0031201045494526625
The generated pressure mean: 0.4457095265388489
loss_pred:0.01885851100087166, decouple_loss:0.0033045043237507343
The generated pressure mean: 0.44738465547561646
loss_pred:0.01811923086643219, decouple_loss:0.0033108158968389034
Iteration: 6359, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4445299208164215
loss_pred:0.01862839236855507, decouple_loss:0.003739714389666915
The generated pressure mean: 0.4371909499168396
loss_pred:0.018492931500077248, decouple_loss:0.003798452438786626
The generated pressure mean: 0.44272691011428833
loss_pred:0.018979378044605255, decouple_loss:0.0037197310011833906
Iteration: 6360, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44312891364097595
loss_pred:0.0184941329061985, decouple_loss:0.003337697358801961
The generated pressure mean: 0.44601887464523315
loss_pred:0.019071519374847412, decouple_loss:0.0033174592535942793
The generated pressure mean: 0.4457927942276001
loss_pred:0.021054938435554504, decouple_loss:0.0032357792370021343
2023-04-17 11:43:56 testing...
The generated pressure mean: 0.4131942391395569
The generated pressure mean: 0.42061135172843933
The generated pressure mean: 0.4240192174911499
loss_pred:0.03222457692027092, decouple_loss:0.0037462515756487846
loss_pred:0.031118998304009438, decouple_loss:0.004007276147603989
loss_pred:0.03068508766591549, decouple_loss:0.004171394743025303
WV_0_PC_0_EH_1_PS_40, loss: 0.03154163807630539, avg_mse: 0.046980973333120346
current test mse: 0.046981
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 6361, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44537603855133057
loss_pred:0.018447212874889374, decouple_loss:0.003494041971862316
The generated pressure mean: 0.4472411870956421
loss_pred:0.019151244312524796, decouple_loss:0.0036757816560566425
The generated pressure mean: 0.44372379779815674
loss_pred:0.019962547346949577, decouple_loss:0.0036389015149325132
Iteration: 6362, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489176869392395
The generated pressure mean: 0.4498130977153778
loss_pred:0.02025773376226425, decouple_loss:0.003187738824635744
loss_pred:0.01923992484807968, decouple_loss:0.0030642696656286716
The generated pressure mean: 0.4459732174873352
loss_pred:0.018860964104533195, decouple_loss:0.003280759323388338
Iteration: 6363, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4457490146160126
The generated pressure mean: 0.44441524147987366loss_pred:0.019809821620583534, decouple_loss:0.0033926276955753565
loss_pred:0.019298411905765533, decouple_loss:0.003212917596101761
The generated pressure mean: 0.4416187107563019
loss_pred:0.020294833928346634, decouple_loss:0.0032013095915317535
Iteration: 6364, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4429037570953369The generated pressure mean: 0.4449559450149536
loss_pred:0.018595805391669273, decouple_loss:0.0029301566537469625
loss_pred:0.01906479150056839, decouple_loss:0.0031139773782342672
The generated pressure mean: 0.44282934069633484
loss_pred:0.019967207685112953, decouple_loss:0.0030681102070957422
Iteration: 6365, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4521927535533905
The generated pressure mean: 0.45144209265708923
loss_pred:0.01924290508031845, decouple_loss:0.0029666314367204905
loss_pred:0.019628364592790604, decouple_loss:0.002855935599654913
The generated pressure mean: 0.45223698019981384
loss_pred:0.018567150458693504, decouple_loss:0.0030292633455246687
Iteration: 6366, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45123106241226196
The generated pressure mean: 0.4562213122844696loss_pred:0.01968119479715824, decouple_loss:0.002925157779827714
loss_pred:0.019761743023991585, decouple_loss:0.00303699285723269
The generated pressure mean: 0.4531233608722687
loss_pred:0.020718473941087723, decouple_loss:0.0029789370018988848
Iteration: 6367, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4395294487476349
The generated pressure mean: 0.4358610510826111
loss_pred:0.018123533576726913, decouple_loss:0.0029253996908664703
loss_pred:0.018571678549051285, decouple_loss:0.002952864160761237
The generated pressure mean: 0.4382092356681824
loss_pred:0.01809108257293701, decouple_loss:0.0029208376072347164
Iteration: 6368, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4397147595882416
The generated pressure mean: 0.44086754322052
loss_pred:0.018587805330753326, decouple_loss:0.003075087210163474
loss_pred:0.019274797290563583, decouple_loss:0.003099588444456458
The generated pressure mean: 0.44464802742004395
loss_pred:0.018915662541985512, decouple_loss:0.003168273949995637
Iteration: 6369, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4535205066204071
loss_pred:0.01890496537089348, decouple_loss:0.0029246932826936245
The generated pressure mean: 0.45661085844039917
loss_pred:0.019660893827676773, decouple_loss:0.003029002109542489
The generated pressure mean: 0.45197203755378723
loss_pred:0.019638005644083023, decouple_loss:0.003310359548777342
Iteration: 6370, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461134970188141
loss_pred:0.019474100321531296, decouple_loss:0.003157961182296276
The generated pressure mean: 0.442610502243042
loss_pred:0.019388243556022644, decouple_loss:0.003173032309859991
The generated pressure mean: 0.4457022547721863
loss_pred:0.020338747650384903, decouple_loss:0.0031480826437473297
2023-04-17 11:46:35 testing...
The generated pressure mean: 0.4138004183769226
The generated pressure mean: 0.4218192398548126
The generated pressure mean: 0.4245398938655853
loss_pred:0.032669246196746826, decouple_loss:0.00371083477512002
loss_pred:0.031127512454986572, decouple_loss:0.003912819549441338
loss_pred:0.03101716935634613, decouple_loss:0.004193860571831465
WV_0_PC_0_EH_1_PS_40, loss: 0.031801603734493256, avg_mse: 0.04757485166192055
current test mse: 0.047575
Iteration: 6371, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44427672028541565
loss_pred:0.01882966049015522, decouple_loss:0.003382464637979865
The generated pressure mean: 0.44284263253211975
loss_pred:0.019119316712021828, decouple_loss:0.0034431300591677427
The generated pressure mean: 0.44394034147262573
loss_pred:0.01929521933197975, decouple_loss:0.003348825266584754
Iteration: 6372, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4454871118068695
The generated pressure mean: 0.4443356990814209
loss_pred:0.01799141615629196, decouple_loss:0.002875490579754114
loss_pred:0.01858573406934738, decouple_loss:0.002943421248346567
The generated pressure mean: 0.44856342673301697
loss_pred:0.018444107845425606, decouple_loss:0.002870063530281186
Iteration: 6373, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508236348628998
The generated pressure mean: 0.4512339234352112
loss_pred:0.018213918432593346, decouple_loss:0.0029739944729954004
loss_pred:0.019165026023983955, decouple_loss:0.0031113827135413885
The generated pressure mean: 0.4528559744358063
loss_pred:0.018940186128020287, decouple_loss:0.0031030704267323017
Iteration: 6374, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44326645135879517
The generated pressure mean: 0.44074350595474243
loss_pred:0.02079034596681595, decouple_loss:0.0031502980273216963
loss_pred:0.018421873450279236, decouple_loss:0.0031581935472786427
The generated pressure mean: 0.4419548809528351
loss_pred:0.018090900033712387, decouple_loss:0.0032249358482658863
Iteration: 6375, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44878342747688293
The generated pressure mean: 0.4500068724155426
loss_pred:0.018186016008257866, decouple_loss:0.003000575117766857
loss_pred:0.021522363647818565, decouple_loss:0.0030268260743469
The generated pressure mean: 0.4488367736339569
loss_pred:0.020626718178391457, decouple_loss:0.0028216317296028137
Iteration: 6376, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4400646984577179
The generated pressure mean: 0.44305646419525146
loss_pred:0.01920640654861927, decouple_loss:0.0028463969938457012
loss_pred:0.02103506028652191, decouple_loss:0.0028662944678217173
The generated pressure mean: 0.43888166546821594
loss_pred:0.01868273876607418, decouple_loss:0.002858682069927454
Iteration: 6377, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44655030965805054
The generated pressure mean: 0.4441627860069275
loss_pred:0.019726959988474846, decouple_loss:0.0029522825498133898
loss_pred:0.01795222796499729, decouple_loss:0.0029277526773512363
The generated pressure mean: 0.4478747248649597
loss_pred:0.018192075192928314, decouple_loss:0.002889040159061551
Iteration: 6378, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45304620265960693
loss_pred:0.020389024168252945, decouple_loss:0.0027937779668718576
The generated pressure mean: 0.45294803380966187
loss_pred:0.020635489374399185, decouple_loss:0.00280557363294065
The generated pressure mean: 0.4498964548110962
loss_pred:0.017856867983937263, decouple_loss:0.0027772709727287292
Iteration: 6379, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4427596926689148
loss_pred:0.01825672760605812, decouple_loss:0.003193110227584839
The generated pressure mean: 0.44418564438819885
loss_pred:0.019283253699541092, decouple_loss:0.003120397450402379
The generated pressure mean: 0.4413844347000122
loss_pred:0.018293946981430054, decouple_loss:0.0031357912812381983
Iteration: 6380, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481104910373688
loss_pred:0.017929378896951675, decouple_loss:0.0026505666319280863
The generated pressure mean: 0.44708138704299927
loss_pred:0.018065767362713814, decouple_loss:0.0025054635480046272
The generated pressure mean: 0.451560378074646
loss_pred:0.01834317110478878, decouple_loss:0.0024603987112641335
2023-04-17 11:48:28 testing...
The generated pressure mean: 0.41471219062805176
The generated pressure mean: 0.4224509298801422
loss_pred:0.03374619409441948, decouple_loss:0.0033829400781542063
The generated pressure mean: 0.4257984161376953
loss_pred:0.03229372948408127, decouple_loss:0.0035837336909025908
loss_pred:0.03215738758444786, decouple_loss:0.0037505500949919224
WV_0_PC_0_EH_1_PS_40, loss: 0.03291105851531029, avg_mse: 0.04974328354001045
current test mse: 0.049743
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 6381, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44875985383987427
loss_pred:0.02098265290260315, decouple_loss:0.0027368597220629454
The generated pressure mean: 0.44757717847824097
loss_pred:0.021505091339349747, decouple_loss:0.0027569420635700226
The generated pressure mean: 0.4462817907333374
loss_pred:0.018515391275286674, decouple_loss:0.002706088125705719
Iteration: 6382, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42627787590026855
The generated pressure mean: 0.42680954933166504
loss_pred:0.018537525087594986, decouple_loss:0.0027875385712832212
loss_pred:0.019533785060048103, decouple_loss:0.0026786834932863712
The generated pressure mean: 0.42547398805618286
loss_pred:0.01889425329864025, decouple_loss:0.0027142385952174664
Iteration: 6383, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45630648732185364
The generated pressure mean: 0.45295456051826477
loss_pred:0.01864287257194519, decouple_loss:0.0027463992591947317
loss_pred:0.01863543502986431, decouple_loss:0.0028431015089154243
The generated pressure mean: 0.45908409357070923
loss_pred:0.02519114501774311, decouple_loss:0.002943409839645028
Iteration: 6384, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4446107745170593
The generated pressure mean: 0.44626230001449585
loss_pred:0.02115427516400814, decouple_loss:0.002725649857893586
loss_pred:0.0190384890884161, decouple_loss:0.0026947602164000273
The generated pressure mean: 0.4435272216796875
loss_pred:0.01961022987961769, decouple_loss:0.0026941662654280663
Iteration: 6385, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4408870339393616
loss_pred:0.018393442034721375, decouple_loss:0.0036965052131563425
The generated pressure mean: 0.4437144696712494
loss_pred:0.020042290911078453, decouple_loss:0.003863084129989147
The generated pressure mean: 0.44358813762664795
loss_pred:0.019294077530503273, decouple_loss:0.003859221702441573
Iteration: 6386, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496002495288849
The generated pressure mean: 0.4448366165161133
loss_pred:0.019546860828995705, decouple_loss:0.0037051502149552107
loss_pred:0.01920965686440468, decouple_loss:0.00374193349853158
The generated pressure mean: 0.44742539525032043
loss_pred:0.018929019570350647, decouple_loss:0.003778238780796528
Iteration: 6387, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486962556838989
The generated pressure mean: 0.44743189215660095
loss_pred:0.02032650262117386, decouple_loss:0.0030394087079912424
loss_pred:0.02199704386293888, decouple_loss:0.0030785680282860994
The generated pressure mean: 0.4462980329990387
loss_pred:0.023129170760512352, decouple_loss:0.0030188991222530603
Iteration: 6388, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4257325530052185
loss_pred:0.01979670487344265, decouple_loss:0.0034017835278064013
The generated pressure mean: 0.4272998869419098
loss_pred:0.02045094221830368, decouple_loss:0.003452742239460349
The generated pressure mean: 0.43082916736602783
loss_pred:0.020705679431557655, decouple_loss:0.0035601244308054447
Iteration: 6389, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44811180233955383
The generated pressure mean: 0.44632500410079956
loss_pred:0.02232382819056511, decouple_loss:0.0036718465853482485
loss_pred:0.021894212812185287, decouple_loss:0.00365148251876235
The generated pressure mean: 0.45034295320510864
loss_pred:0.020635221153497696, decouple_loss:0.003755361307412386
Iteration: 6390, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46285611391067505
The generated pressure mean: 0.46217602491378784
loss_pred:0.0198567733168602, decouple_loss:0.003909969236701727
loss_pred:0.019288355484604836, decouple_loss:0.003893827321007848
The generated pressure mean: 0.46593257784843445
loss_pred:0.018776046112179756, decouple_loss:0.0038084934931248426
2023-04-17 11:51:00 testing...
The generated pressure mean: 0.4099123477935791
The generated pressure mean: 0.4185549318790436
The generated pressure mean: 0.41572532057762146
loss_pred:0.03805559128522873, decouple_loss:0.0038831362035125494
loss_pred:0.036722056567668915, decouple_loss:0.004177707713097334
loss_pred:0.03695271909236908, decouple_loss:0.004038216546177864
WV_0_PC_0_EH_1_PS_40, loss: 0.03744510933756828, avg_mse: 0.05806267261505127
current test mse: 0.058063
Iteration: 6391, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4570579528808594
loss_pred:0.018962154164910316, decouple_loss:0.0035509758163243532
The generated pressure mean: 0.45826488733291626
loss_pred:0.020815493538975716, decouple_loss:0.003534602466970682
The generated pressure mean: 0.4565727710723877
loss_pred:0.018589366227388382, decouple_loss:0.003578054253011942
Iteration: 6392, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43504729866981506
loss_pred:0.01836802251636982, decouple_loss:0.003590068779885769
The generated pressure mean: 0.4412659704685211
loss_pred:0.01988224871456623, decouple_loss:0.0036164498887956142
The generated pressure mean: 0.43918541073799133
loss_pred:0.01980607397854328, decouple_loss:0.0036348027642816305
Iteration: 6393, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4354676604270935
loss_pred:0.019001508131623268, decouple_loss:0.003731865668669343
The generated pressure mean: 0.43130016326904297
loss_pred:0.021336765959858894, decouple_loss:0.00391383608803153
The generated pressure mean: 0.4351881444454193
loss_pred:0.01850510574877262, decouple_loss:0.0039055782835930586
Iteration: 6394, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4377197027206421
loss_pred:0.01867212913930416, decouple_loss:0.0032775430008769035
The generated pressure mean: 0.4372694790363312
loss_pred:0.018474774435162544, decouple_loss:0.0031595646869391203
The generated pressure mean: 0.43965041637420654
loss_pred:0.019479073584079742, decouple_loss:0.003279987955465913
Iteration: 6395, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45530784130096436
loss_pred:0.0203565564006567, decouple_loss:0.004139855038374662
The generated pressure mean: 0.45397594571113586
loss_pred:0.020199785009026527, decouple_loss:0.004122110083699226
The generated pressure mean: 0.4531668722629547
loss_pred:0.018978698179125786, decouple_loss:0.0042351349256932735
Iteration: 6396, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44563227891921997
loss_pred:0.01938481256365776, decouple_loss:0.0036142009776085615
The generated pressure mean: 0.44846978783607483
loss_pred:0.01842358335852623, decouple_loss:0.003661487950012088
The generated pressure mean: 0.4478783905506134
loss_pred:0.018300462514162064, decouple_loss:0.003726462833583355
Iteration: 6397, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4456319212913513
loss_pred:0.018225466832518578, decouple_loss:0.0038406862877309322
The generated pressure mean: 0.4433774948120117
loss_pred:0.02218690887093544, decouple_loss:0.0036180594470351934
The generated pressure mean: 0.44558408856391907
loss_pred:0.01914091221988201, decouple_loss:0.003610085928812623
Iteration: 6398, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.452627032995224
loss_pred:0.02101898193359375, decouple_loss:0.0033053329680114985
The generated pressure mean: 0.4555697739124298
loss_pred:0.018770067021250725, decouple_loss:0.003286089515313506
The generated pressure mean: 0.4494134783744812
loss_pred:0.0191819928586483, decouple_loss:0.0033338749781250954
Iteration: 6399, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44232168793678284
loss_pred:0.019839491695165634, decouple_loss:0.003584424965083599
The generated pressure mean: 0.438752144575119The generated pressure mean: 0.44373220205307007
loss_pred:0.018711186945438385, decouple_loss:0.003624016884714365
loss_pred:0.018299046903848648, decouple_loss:0.003459920873865485
Iteration: 6400, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4399312138557434
loss_pred:0.01907533034682274, decouple_loss:0.00427271518856287
The generated pressure mean: 0.44318103790283203
loss_pred:0.020043231546878815, decouple_loss:0.004203123040497303
The generated pressure mean: 0.44111570715904236
loss_pred:0.020170828327536583, decouple_loss:0.004266771022230387
2023-04-17 11:52:53 testing...
The generated pressure mean: 0.41525304317474365
The generated pressure mean: 0.42301374673843384
loss_pred:0.03511955589056015, decouple_loss:0.004099758341908455
The generated pressure mean: 0.42622554302215576
loss_pred:0.03377024084329605, decouple_loss:0.004279746674001217
loss_pred:0.033368807286024094, decouple_loss:0.004489550366997719
WV_0_PC_0_EH_1_PS_40, loss: 0.03430068492889404, avg_mse: 0.052282605320215225
current test mse: 0.052283
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 6401, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479772746562958
loss_pred:0.019045008346438408, decouple_loss:0.00348680536262691
The generated pressure mean: 0.44794976711273193
loss_pred:0.018728982657194138, decouple_loss:0.0034488344099372625The generated pressure mean: 0.44820651412010193
loss_pred:0.018585385754704475, decouple_loss:0.0033250811975449324
Iteration: 6402, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4534202218055725
loss_pred:0.019646482542157173, decouple_loss:0.003920227754861116
The generated pressure mean: 0.4538361132144928
loss_pred:0.018028516322374344, decouple_loss:0.0039201341569423676
The generated pressure mean: 0.4533170163631439
loss_pred:0.018503263592720032, decouple_loss:0.0038554819766432047
Iteration: 6403, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44245249032974243
loss_pred:0.017989223822951317, decouple_loss:0.0034646529238671064
The generated pressure mean: 0.44141626358032227
loss_pred:0.018780851736664772, decouple_loss:0.0033748066052794456
The generated pressure mean: 0.43748244643211365
loss_pred:0.01940297894179821, decouple_loss:0.003464614972472191
Iteration: 6404, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44405627250671387
loss_pred:0.018651975318789482, decouple_loss:0.0039029736071825027
The generated pressure mean: 0.441158652305603
loss_pred:0.019519520923495293, decouple_loss:0.003973746672272682
The generated pressure mean: 0.4417838156223297
loss_pred:0.019301554188132286, decouple_loss:0.003955187741667032
Iteration: 6405, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4545954465866089
loss_pred:0.02050718665122986, decouple_loss:0.003048899117857218
The generated pressure mean: 0.4504637122154236
loss_pred:0.018573710694909096, decouple_loss:0.002915827790275216
The generated pressure mean: 0.45221972465515137
loss_pred:0.019189059734344482, decouple_loss:0.0030794795602560043
Iteration: 6406, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4547298848628998
loss_pred:0.01910640299320221, decouple_loss:0.0032312790863215923
The generated pressure mean: 0.4554949104785919
The generated pressure mean: 0.4510728716850281
loss_pred:0.0190147552639246, decouple_loss:0.003299543634057045
loss_pred:0.019927991554141045, decouple_loss:0.003094010753557086
Iteration: 6407, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4270409941673279
loss_pred:0.018291309475898743, decouple_loss:0.0033585818018764257
The generated pressure mean: 0.43483296036720276
The generated pressure mean: 0.4397956132888794loss_pred:0.019376413896679878, decouple_loss:0.003488401649519801
loss_pred:0.01968827098608017, decouple_loss:0.0034680753014981747
Iteration: 6408, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43418875336647034
loss_pred:0.019077129662036896, decouple_loss:0.0032724933698773384
The generated pressure mean: 0.43247726559638977
loss_pred:0.020483728498220444, decouple_loss:0.0033337301574647427
The generated pressure mean: 0.43594637513160706
loss_pred:0.019559577107429504, decouple_loss:0.0032576406374573708
Iteration: 6409, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.463201642036438
The generated pressure mean: 0.4624287784099579
loss_pred:0.01952385902404785, decouple_loss:0.004078337457031012
loss_pred:0.017988983541727066, decouple_loss:0.0040201786905527115
The generated pressure mean: 0.4620431959629059
loss_pred:0.018425147980451584, decouple_loss:0.003984295297414064
Iteration: 6410, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4554691016674042
The generated pressure mean: 0.45516061782836914
loss_pred:0.017940174788236618, decouple_loss:0.003235345706343651
loss_pred:0.019436294212937355, decouple_loss:0.003399585373699665
The generated pressure mean: 0.4541378617286682
loss_pred:0.019191330298781395, decouple_loss:0.0033028079196810722
2023-04-17 11:55:23 testing...
The generated pressure mean: 0.4158798158168793
The generated pressure mean: 0.4221797287464142
The generated pressure mean: 0.4248959720134735
loss_pred:0.0320337675511837, decouple_loss:0.004629714414477348
loss_pred:0.031022632494568825, decouple_loss:0.004859191831201315
loss_pred:0.030610522255301476, decouple_loss:0.004943383391946554
WV_0_PC_0_EH_1_PS_40, loss: 0.03146284446120262, avg_mse: 0.04664359241724014
current test mse: 0.046644
Iteration: 6411, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43507933616638184
loss_pred:0.018407145515084267, decouple_loss:0.003965263720601797
The generated pressure mean: 0.42876991629600525
loss_pred:0.0190570205450058, decouple_loss:0.0041153631173074245
The generated pressure mean: 0.43542689085006714
loss_pred:0.017518706619739532, decouple_loss:0.0041341218166053295
Iteration: 6412, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45537859201431274
loss_pred:0.017741113901138306, decouple_loss:0.002888719318434596
The generated pressure mean: 0.44533562660217285
loss_pred:0.018815958872437477, decouple_loss:0.0029903342947363853
The generated pressure mean: 0.4491548538208008
loss_pred:0.018388846889138222, decouple_loss:0.0029567431192845106
Iteration: 6413, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.454154372215271
loss_pred:0.01843213103711605, decouple_loss:0.0031185774132609367
The generated pressure mean: 0.45639291405677795
loss_pred:0.017843900248408318, decouple_loss:0.003188345581293106
The generated pressure mean: 0.45644208788871765
loss_pred:0.01890234835445881, decouple_loss:0.0031999791972339153
Iteration: 6414, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4417288303375244
loss_pred:0.016975993290543556, decouple_loss:0.003521866165101528
The generated pressure mean: 0.4400995075702667
loss_pred:0.019062161445617676, decouple_loss:0.003781112376600504
The generated pressure mean: 0.44195055961608887
loss_pred:0.019848819822072983, decouple_loss:0.003532781032845378
Iteration: 6415, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4380091428756714
The generated pressure mean: 0.4360681176185608
loss_pred:0.01913066953420639, decouple_loss:0.003198928665369749
loss_pred:0.01894468069076538, decouple_loss:0.0033026724122464657
The generated pressure mean: 0.4376702606678009
loss_pred:0.018572814762592316, decouple_loss:0.0031829848885536194
Iteration: 6416, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4443269968032837
The generated pressure mean: 0.4526483714580536
loss_pred:0.01919606514275074, decouple_loss:0.002719126408919692
loss_pred:0.019123537465929985, decouple_loss:0.002822643145918846
The generated pressure mean: 0.451751708984375
loss_pred:0.0193669181317091, decouple_loss:0.002737106056883931
Iteration: 6417, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44250547885894775
The generated pressure mean: 0.442430704832077
loss_pred:0.018362004309892654, decouple_loss:0.0028914110735058784
loss_pred:0.01783364824950695, decouple_loss:0.00292971427552402
The generated pressure mean: 0.44223716855049133
loss_pred:0.0192338265478611, decouple_loss:0.0028102670330554247
Iteration: 6418, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4538140296936035
loss_pred:0.01832795888185501, decouple_loss:0.0034716264344751835
The generated pressure mean: 0.4431993067264557
loss_pred:0.01876346953213215, decouple_loss:0.0037736271042376757
The generated pressure mean: 0.45189934968948364
loss_pred:0.019789474084973335, decouple_loss:0.0036393040791153908
Iteration: 6419, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45639923214912415
loss_pred:0.018587626516819, decouple_loss:0.003441086271777749
The generated pressure mean: 0.4536810517311096
loss_pred:0.018760304898023605, decouple_loss:0.003354379441589117
The generated pressure mean: 0.45276278257369995
loss_pred:0.019844496622681618, decouple_loss:0.003456149250268936
Iteration: 6420, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44733041524887085
loss_pred:0.018027355894446373, decouple_loss:0.0031339251436293125
The generated pressure mean: 0.4447137415409088
The generated pressure mean: 0.4424249827861786
loss_pred:0.018424900248646736, decouple_loss:0.0030105398036539555
loss_pred:0.02028760127723217, decouple_loss:0.003019035328179598
2023-04-17 11:57:17 testing...
The generated pressure mean: 0.416359007358551
The generated pressure mean: 0.42359837889671326
The generated pressure mean: 0.42634329199790955
loss_pred:0.032000698149204254, decouple_loss:0.003949975594878197
loss_pred:0.030716508626937866, decouple_loss:0.00416807783767581
loss_pred:0.03067765384912491, decouple_loss:0.0043043773621320724
WV_0_PC_0_EH_1_PS_40, loss: 0.031338661909103394, avg_mse: 0.0466277115046978
current test mse: 0.046628
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 6421, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43569815158843994
loss_pred:0.019771043211221695, decouple_loss:0.003607832593843341
The generated pressure mean: 0.43365907669067383
loss_pred:0.01837935298681259, decouple_loss:0.003566676750779152
The generated pressure mean: 0.43406111001968384
loss_pred:0.020188817754387856, decouple_loss:0.0037529340479522943
Iteration: 6422, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4582135081291199
The generated pressure mean: 0.45682185888290405
loss_pred:0.018164390698075294, decouple_loss:0.0033082691952586174
loss_pred:0.017963511869311333, decouple_loss:0.0032662164885550737
The generated pressure mean: 0.46103253960609436
loss_pred:0.019314628094434738, decouple_loss:0.0033399511594325304
Iteration: 6423, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4603124260902405
The generated pressure mean: 0.4642408788204193
loss_pred:0.018474144861102104, decouple_loss:0.00255791493691504
loss_pred:0.017295805737376213, decouple_loss:0.0025544334203004837
The generated pressure mean: 0.4602394998073578
loss_pred:0.018754867836833, decouple_loss:0.0025474040303379297
Iteration: 6424, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43157732486724854
loss_pred:0.01774274744093418, decouple_loss:0.0030454699881374836
The generated pressure mean: 0.43526747822761536
loss_pred:0.018922636285424232, decouple_loss:0.0029782778583467007
The generated pressure mean: 0.4351082146167755
loss_pred:0.019401127472519875, decouple_loss:0.003210695693269372
Iteration: 6425, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43813782930374146
loss_pred:0.017682703211903572, decouple_loss:0.0031688532326370478
The generated pressure mean: 0.4365346431732178
loss_pred:0.019808461889624596, decouple_loss:0.0032940141391009092
The generated pressure mean: 0.4395515024662018
loss_pred:0.018444515764713287, decouple_loss:0.0032581512350589037
Iteration: 6426, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4594547748565674
loss_pred:0.019856272265315056, decouple_loss:0.0028446835931390524
The generated pressure mean: 0.4559554159641266
loss_pred:0.0192380603402853, decouple_loss:0.002920710016041994
The generated pressure mean: 0.4567897617816925
loss_pred:0.020357031375169754, decouple_loss:0.0028432197868824005
Iteration: 6427, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44516292214393616
loss_pred:0.0202268548309803, decouple_loss:0.002897775499150157
The generated pressure mean: 0.44725921750068665
loss_pred:0.018798379227519035, decouple_loss:0.002953740069642663
The generated pressure mean: 0.44886863231658936
loss_pred:0.018095167353749275, decouple_loss:0.003043008502572775
Iteration: 6428, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496690332889557
loss_pred:0.017845015972852707, decouple_loss:0.003048424609005451
The generated pressure mean: 0.44637346267700195The generated pressure mean: 0.4456784427165985
loss_pred:0.018342820927500725, decouple_loss:0.003155621001496911
loss_pred:0.018743466585874557, decouple_loss:0.003196950303390622
Iteration: 6429, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44608962535858154
loss_pred:0.021496377885341644, decouple_loss:0.004193983040750027
The generated pressure mean: 0.4425972104072571
The generated pressure mean: 0.44596606492996216
loss_pred:0.018736332654953003, decouple_loss:0.003997073508799076
loss_pred:0.016606392338871956, decouple_loss:0.004076614044606686
Iteration: 6430, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44839760661125183
loss_pred:0.0186772383749485, decouple_loss:0.003853684989735484
The generated pressure mean: 0.445090115070343
loss_pred:0.01885637640953064, decouple_loss:0.004077041056007147
The generated pressure mean: 0.44493207335472107
loss_pred:0.017445959150791168, decouple_loss:0.003787427442148328
2023-04-17 11:59:43 testing...
The generated pressure mean: 0.4124135375022888
The generated pressure mean: 0.41977056860923767
The generated pressure mean: 0.42324697971343994
loss_pred:0.03303596377372742, decouple_loss:0.004061504267156124
loss_pred:0.03188702091574669, decouple_loss:0.004220463801175356
loss_pred:0.0312298946082592, decouple_loss:0.004389872308820486
WV_0_PC_0_EH_1_PS_40, loss: 0.032262157648801804, avg_mse: 0.0484156496822834
current test mse: 0.048416
Iteration: 6431, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4563199579715729
loss_pred:0.019410336390137672, decouple_loss:0.0035616101231426
The generated pressure mean: 0.4524044692516327
loss_pred:0.018301941454410553, decouple_loss:0.0034215145278722048
The generated pressure mean: 0.45231500267982483
loss_pred:0.01976398378610611, decouple_loss:0.003420599503442645
Iteration: 6432, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4443061351776123
loss_pred:0.018314020708203316, decouple_loss:0.004200358409434557
The generated pressure mean: 0.4452415108680725
loss_pred:0.019961420446634293, decouple_loss:0.003845358034595847
The generated pressure mean: 0.44770070910453796
loss_pred:0.018063917756080627, decouple_loss:0.0038443231023848057
Iteration: 6433, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44922158122062683
loss_pred:0.019871337339282036, decouple_loss:0.0038843138609081507
The generated pressure mean: 0.447834312915802
loss_pred:0.01856806129217148, decouple_loss:0.004066080786287785
The generated pressure mean: 0.44380491971969604
loss_pred:0.01939171738922596, decouple_loss:0.003977611195296049
Iteration: 6434, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465554654598236
loss_pred:0.019079195335507393, decouple_loss:0.003470675554126501
The generated pressure mean: 0.4458109438419342
loss_pred:0.01841987855732441, decouple_loss:0.0036082558799535036
The generated pressure mean: 0.4494282007217407
loss_pred:0.02108435519039631, decouple_loss:0.003503091400489211
Iteration: 6435, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44776007533073425
loss_pred:0.018761560320854187, decouple_loss:0.0029982971027493477
The generated pressure mean: 0.4484933316707611
loss_pred:0.02080259658396244, decouple_loss:0.0031214768532663584
The generated pressure mean: 0.4471256136894226
loss_pred:0.018230218440294266, decouple_loss:0.002987686777487397
Iteration: 6436, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45043179392814636
loss_pred:0.01888662949204445, decouple_loss:0.0038773403503000736
The generated pressure mean: 0.44802528619766235
loss_pred:0.017637507990002632, decouple_loss:0.003632421139627695
The generated pressure mean: 0.44522348046302795
loss_pred:0.018852777779102325, decouple_loss:0.003848676336929202
Iteration: 6437, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44433361291885376
loss_pred:0.01714302971959114, decouple_loss:0.003579864976927638
The generated pressure mean: 0.44655635952949524
loss_pred:0.018719272688031197, decouple_loss:0.0036570497322827578
The generated pressure mean: 0.44566136598587036
loss_pred:0.01804252155125141, decouple_loss:0.0035248049534857273
Iteration: 6438, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44638192653656006
loss_pred:0.019291356205940247, decouple_loss:0.0033008544705808163
The generated pressure mean: 0.4383474290370941
loss_pred:0.017680928111076355, decouple_loss:0.0032954856287688017
The generated pressure mean: 0.44772961735725403
loss_pred:0.018731968477368355, decouple_loss:0.0034672776237130165
Iteration: 6439, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4524841010570526
loss_pred:0.018907971680164337, decouple_loss:0.004239410627633333
The generated pressure mean: 0.4487725794315338
loss_pred:0.020414020866155624, decouple_loss:0.004399361088871956
The generated pressure mean: 0.4528299868106842
loss_pred:0.018365927040576935, decouple_loss:0.0042213574051856995
Iteration: 6440, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45127418637275696
loss_pred:0.01827344298362732, decouple_loss:0.00297257537022233
The generated pressure mean: 0.4505162239074707
loss_pred:0.02281198278069496, decouple_loss:0.0030817296355962753
The generated pressure mean: 0.44669023156166077
loss_pred:0.019042234867811203, decouple_loss:0.003081279108300805
2023-04-17 12:01:36 testing...
The generated pressure mean: 0.4203675389289856
The generated pressure mean: 0.42716073989868164
The generated pressure mean: 0.4306221008300781
loss_pred:0.03152802214026451, decouple_loss:0.003850542940199375
loss_pred:0.030941911041736603, decouple_loss:0.003972257487475872
loss_pred:0.029980642721056938, decouple_loss:0.004099622368812561
WV_0_PC_0_EH_1_PS_40, loss: 0.031015565618872643, avg_mse: 0.045910149812698364
current test mse: 0.04591
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 6441, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4269554018974304
loss_pred:0.020834188908338547, decouple_loss:0.0031717887613922358
The generated pressure mean: 0.427148699760437
loss_pred:0.018563710153102875, decouple_loss:0.00311918742954731
The generated pressure mean: 0.4295361042022705
loss_pred:0.019301120191812515, decouple_loss:0.0032648658379912376
Iteration: 6442, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.455248087644577
loss_pred:0.01882229745388031, decouple_loss:0.003540683537721634
The generated pressure mean: 0.45430999994277954
loss_pred:0.019534049555659294, decouple_loss:0.003537373151630163
The generated pressure mean: 0.4544526934623718
loss_pred:0.02045716717839241, decouple_loss:0.0035296985879540443
Iteration: 6443, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4602333903312683
loss_pred:0.01908269338309765, decouple_loss:0.0028884473722428083
The generated pressure mean: 0.46220162510871887
loss_pred:0.018508348613977432, decouple_loss:0.002919205231592059
The generated pressure mean: 0.4652060568332672
loss_pred:0.018792370334267616, decouple_loss:0.002954446477815509
Iteration: 6444, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44722840189933777
loss_pred:0.01973063126206398, decouple_loss:0.0033749097492545843
The generated pressure mean: 0.44747182726860046
loss_pred:0.01893199048936367, decouple_loss:0.003283565863966942
The generated pressure mean: 0.44868090748786926
loss_pred:0.019227225333452225, decouple_loss:0.0033050095662474632
Iteration: 6445, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43280792236328125
loss_pred:0.01999688148498535, decouple_loss:0.003726266324520111
The generated pressure mean: 0.4370228350162506
loss_pred:0.02019122615456581, decouple_loss:0.0035314064007252455
The generated pressure mean: 0.435414582490921
loss_pred:0.018706023693084717, decouple_loss:0.003508857684209943
Iteration: 6446, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4539754092693329
loss_pred:0.01813875325024128, decouple_loss:0.002832818543538451
The generated pressure mean: 0.45497748255729675
loss_pred:0.01872268319129944, decouple_loss:0.0028789115604013205
The generated pressure mean: 0.45493823289871216
loss_pred:0.0181814506649971, decouple_loss:0.0029207004699856043
Iteration: 6447, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.459044486284256
loss_pred:0.018699005246162415, decouple_loss:0.003872120752930641
The generated pressure mean: 0.45684003829956055
loss_pred:0.019856832921504974, decouple_loss:0.003739177016541362
The generated pressure mean: 0.45754995942115784
loss_pred:0.019006896764039993, decouple_loss:0.003808933310210705
Iteration: 6448, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44139137864112854
loss_pred:0.02096090279519558, decouple_loss:0.0034889013040810823
The generated pressure mean: 0.4472223222255707
loss_pred:0.01994377188384533, decouple_loss:0.003391190664842725
The generated pressure mean: 0.44301995635032654
loss_pred:0.019017258659005165, decouple_loss:0.003465349553152919
Iteration: 6449, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4394369125366211
loss_pred:0.018278976902365685, decouple_loss:0.003555483417585492
The generated pressure mean: 0.4370766282081604
loss_pred:0.01974738948047161, decouple_loss:0.0034128010738641024
The generated pressure mean: 0.4328407943248749
loss_pred:0.01827181689441204, decouple_loss:0.0032943764235824347
Iteration: 6450, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45370444655418396
loss_pred:0.019180214032530785, decouple_loss:0.0032556988298892975
The generated pressure mean: 0.4599350392818451
loss_pred:0.019569935277104378, decouple_loss:0.003269218374043703
The generated pressure mean: 0.4573713541030884
loss_pred:0.01809915527701378, decouple_loss:0.0031801213044673204
2023-04-17 12:04:05 testing...
The generated pressure mean: 0.4142507314682007
The generated pressure mean: 0.4214605987071991
loss_pred:0.033428385853767395, decouple_loss:0.004208320286124945
The generated pressure mean: 0.4242911636829376
loss_pred:0.032393235713243484, decouple_loss:0.0044199516996741295
loss_pred:0.03178217262029648, decouple_loss:0.004579604137688875
WV_0_PC_0_EH_1_PS_40, loss: 0.03275473043322563, avg_mse: 0.049130622297525406
current test mse: 0.049131
Iteration: 6451, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4509315490722656
loss_pred:0.020668458193540573, decouple_loss:0.0038025586400181055
The generated pressure mean: 0.4534362554550171
loss_pred:0.022103160619735718, decouple_loss:0.003837048774585128
The generated pressure mean: 0.4546012282371521
loss_pred:0.01801539584994316, decouple_loss:0.0037353269290179014
Iteration: 6452, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4456441402435303
loss_pred:0.019848421216011047, decouple_loss:0.003259219927713275
The generated pressure mean: 0.44172438979148865
loss_pred:0.018784305080771446, decouple_loss:0.0032263307366520166
The generated pressure mean: 0.44352948665618896
loss_pred:0.019834667444229126, decouple_loss:0.003141625551506877
Iteration: 6453, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45123177766799927
loss_pred:0.02004878781735897, decouple_loss:0.0031042189802974463
The generated pressure mean: 0.45023205876350403
loss_pred:0.019167877733707428, decouple_loss:0.00325942225754261
The generated pressure mean: 0.45152023434638977
loss_pred:0.017755627632141113, decouple_loss:0.00318319839425385
Iteration: 6454, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483157694339752
loss_pred:0.021011384204030037, decouple_loss:0.00395111832767725
The generated pressure mean: 0.446479856967926
loss_pred:0.01928037218749523, decouple_loss:0.0038637889083474874
The generated pressure mean: 0.4481734335422516
loss_pred:0.020177680999040604, decouple_loss:0.004127103369683027
Iteration: 6455, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4425719678401947
loss_pred:0.021390646696090698, decouple_loss:0.003121362067759037
The generated pressure mean: 0.44712069630622864
loss_pred:0.018987413495779037, decouple_loss:0.0030521806329488754
The generated pressure mean: 0.4404914677143097
loss_pred:0.020465224981307983, decouple_loss:0.0031124406959861517
Iteration: 6456, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492127299308777
loss_pred:0.01896224543452263, decouple_loss:0.004269783850759268
The generated pressure mean: 0.4521905481815338
loss_pred:0.017485376447439194, decouple_loss:0.00443798303604126
The generated pressure mean: 0.4512627422809601
loss_pred:0.018265889957547188, decouple_loss:0.004411825444549322
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 6457, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45576465129852295
loss_pred:0.01874428801238537, decouple_loss:0.0032204806338995695
The generated pressure mean: 0.46023282408714294
loss_pred:0.0186143908649683, decouple_loss:0.003213506890460849
The generated pressure mean: 0.45475900173187256
loss_pred:0.020107407122850418, decouple_loss:0.0030961257871240377
Iteration: 6458, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4397743046283722
loss_pred:0.018161829560995102, decouple_loss:0.0036159574519842863
The generated pressure mean: 0.44436943531036377
The generated pressure mean: 0.44150418043136597
loss_pred:0.020585376769304276, decouple_loss:0.0034994177985936403
loss_pred:0.020888283848762512, decouple_loss:0.0036251945421099663
Iteration: 6459, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43997350335121155
loss_pred:0.019641214981675148, decouple_loss:0.003092373488470912
The generated pressure mean: 0.4323255121707916
loss_pred:0.018299993127584457, decouple_loss:0.002887582639232278
The generated pressure mean: 0.4339403212070465
loss_pred:0.020216839388012886, decouple_loss:0.0030410054605454206
Iteration: 6460, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4610755741596222
loss_pred:0.0196341834962368, decouple_loss:0.0030591990798711777
The generated pressure mean: 0.45917457342147827
The generated pressure mean: 0.4605613052845001
loss_pred:0.01843462884426117, decouple_loss:0.00314420647919178
loss_pred:0.02039874903857708, decouple_loss:0.003096046857535839
2023-04-17 12:05:59 testing...
The generated pressure mean: 0.4110286831855774
The generated pressure mean: 0.41872262954711914
The generated pressure mean: 0.4214993417263031
loss_pred:0.03371104598045349, decouple_loss:0.0036045138258486986
loss_pred:0.032226283103227615, decouple_loss:0.0038993756752461195
loss_pred:0.03188902512192726, decouple_loss:0.004045660141855478
WV_0_PC_0_EH_1_PS_40, loss: 0.03280127793550491, avg_mse: 0.04944775626063347
current test mse: 0.049448
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 6461, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45981714129447937
loss_pred:0.019258631393313408, decouple_loss:0.0031451042741537094
The generated pressure mean: 0.46099168062210083
loss_pred:0.019209910184144974, decouple_loss:0.003123080125078559
The generated pressure mean: 0.4554841220378876
loss_pred:0.019527198746800423, decouple_loss:0.003116825595498085
Iteration: 6462, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43862220644950867
The generated pressure mean: 0.43986690044403076
loss_pred:0.02034701406955719, decouple_loss:0.002824844093993306
loss_pred:0.01917235367000103, decouple_loss:0.002771907253190875
The generated pressure mean: 0.4382994771003723
loss_pred:0.019206279888749123, decouple_loss:0.0029894530307501554
Iteration: 6463, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44054368138313293
The generated pressure mean: 0.4377167522907257
loss_pred:0.020354434847831726, decouple_loss:0.002822504611685872
loss_pred:0.020419389009475708, decouple_loss:0.0029864455573260784
The generated pressure mean: 0.44012051820755005
loss_pred:0.018090078607201576, decouple_loss:0.0028818638529628515
Iteration: 6464, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44582340121269226
loss_pred:0.018527541309595108, decouple_loss:0.003286537015810609
The generated pressure mean: 0.4458273649215698
loss_pred:0.017194628715515137, decouple_loss:0.003255894174799323
The generated pressure mean: 0.44318732619285583
loss_pred:0.020017853006720543, decouple_loss:0.0033005704171955585
Iteration: 6465, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480736255645752
The generated pressure mean: 0.44305914640426636
loss_pred:0.01881800778210163, decouple_loss:0.00289308768697083
loss_pred:0.019260026514530182, decouple_loss:0.0031113538425415754
The generated pressure mean: 0.44646155834198
loss_pred:0.020313287153840065, decouple_loss:0.0028480563778430223
Iteration: 6466, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4451890289783478
loss_pred:0.018990736454725266, decouple_loss:0.002816269174218178
The generated pressure mean: 0.44252169132232666
loss_pred:0.018293658271431923, decouple_loss:0.0029441455844789743
The generated pressure mean: 0.4463975131511688
loss_pred:0.019633987918496132, decouple_loss:0.0029555754736065865
Iteration: 6467, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45132380723953247
loss_pred:0.021161813288927078, decouple_loss:0.0030552581883966923
The generated pressure mean: 0.4494820535182953
loss_pred:0.020470676943659782, decouple_loss:0.0031306915916502476
The generated pressure mean: 0.4538746178150177
loss_pred:0.020318595692515373, decouple_loss:0.0030942498706281185
Iteration: 6468, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44539937376976013
The generated pressure mean: 0.4444516897201538
loss_pred:0.018395112827420235, decouple_loss:0.0033654230646789074
loss_pred:0.020712578669190407, decouple_loss:0.0034441431052982807
The generated pressure mean: 0.4478219151496887
loss_pred:0.02012156881392002, decouple_loss:0.003403792157769203
Iteration: 6469, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42954596877098083
loss_pred:0.018210764974355698, decouple_loss:0.0038573218043893576
The generated pressure mean: 0.4336700141429901
loss_pred:0.019659245386719704, decouple_loss:0.00383285665884614
The generated pressure mean: 0.43527737259864807
loss_pred:0.02077340893447399, decouple_loss:0.0037747386377304792
Iteration: 6470, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460318982601166
loss_pred:0.021958528086543083, decouple_loss:0.0032109636813402176
The generated pressure mean: 0.4514351189136505
loss_pred:0.020425518974661827, decouple_loss:0.003117538755759597
The generated pressure mean: 0.4493785500526428
loss_pred:0.01876666769385338, decouple_loss:0.0036426051519811153
2023-04-17 12:08:39 testing...
The generated pressure mean: 0.41302013397216797
The generated pressure mean: 0.4194508194923401
loss_pred:0.031708892434835434, decouple_loss:0.00363808567635715
The generated pressure mean: 0.42217928171157837
loss_pred:0.03055807761847973, decouple_loss:0.003917088266462088
loss_pred:0.030270617455244064, decouple_loss:0.004061125684529543
WV_0_PC_0_EH_1_PS_40, loss: 0.031039468944072723, avg_mse: 0.04582958668470383
current test mse: 0.04583
Iteration: 6471, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4435475766658783
loss_pred:0.019104618579149246, decouple_loss:0.003302144119516015
The generated pressure mean: 0.4446587562561035
loss_pred:0.020342061296105385, decouple_loss:0.0031787517946213484
The generated pressure mean: 0.44226449728012085
loss_pred:0.019074754789471626, decouple_loss:0.0032069929875433445
Iteration: 6472, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4528036415576935
loss_pred:0.021845953539013863, decouple_loss:0.00430919136852026
The generated pressure mean: 0.45062798261642456
loss_pred:0.01865983009338379, decouple_loss:0.004375913646072149
The generated pressure mean: 0.4529978632926941
loss_pred:0.01965181902050972, decouple_loss:0.004172598477452993
Iteration: 6473, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.450886607170105
loss_pred:0.017937855795025826, decouple_loss:0.002923802472651005
The generated pressure mean: 0.4479145407676697
loss_pred:0.01951502077281475, decouple_loss:0.0030037611722946167
The generated pressure mean: 0.45345595479011536
loss_pred:0.020022666081786156, decouple_loss:0.003077349392697215
Iteration: 6474, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4376848638057709
loss_pred:0.018606651574373245, decouple_loss:0.0026437535416334867
The generated pressure mean: 0.4365389049053192
loss_pred:0.020833032205700874, decouple_loss:0.002594660734757781
The generated pressure mean: 0.43978774547576904
loss_pred:0.0204538032412529, decouple_loss:0.002572752069681883
Iteration: 6475, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4453926980495453
loss_pred:0.01792295277118683, decouple_loss:0.0032214000821113586
The generated pressure mean: 0.44297167658805847
loss_pred:0.018457023426890373, decouple_loss:0.003296028356999159
The generated pressure mean: 0.44058454036712646
loss_pred:0.017804976552724838, decouple_loss:0.0032902562525123358
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 6476, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45091333985328674
The generated pressure mean: 0.455325722694397
loss_pred:0.022742731496691704, decouple_loss:0.0034368017222732306
loss_pred:0.018389275297522545, decouple_loss:0.0028325612656772137
The generated pressure mean: 0.4518184959888458
loss_pred:0.019907040521502495, decouple_loss:0.0030785880517214537
Iteration: 6477, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4340859055519104
loss_pred:0.018829699605703354, decouple_loss:0.003189074108377099
The generated pressure mean: 0.428139865398407
loss_pred:0.018076986074447632, decouple_loss:0.003112450474873185
The generated pressure mean: 0.42827242612838745
loss_pred:0.019176073372364044, decouple_loss:0.0032757252920418978
Iteration: 6478, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442700147628784
The generated pressure mean: 0.44339418411254883
loss_pred:0.018642669543623924, decouple_loss:0.002985983621329069
loss_pred:0.019054073840379715, decouple_loss:0.002926571760326624
The generated pressure mean: 0.4425069987773895
loss_pred:0.018982460722327232, decouple_loss:0.0029044917318969965
Iteration: 6479, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46625107526779175
loss_pred:0.020990541204810143, decouple_loss:0.002412640955299139
The generated pressure mean: 0.46220043301582336
loss_pred:0.018206501379609108, decouple_loss:0.0023610100615769625
The generated pressure mean: 0.46167102456092834
loss_pred:0.018981127068400383, decouple_loss:0.002459628274664283
Iteration: 6480, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475225806236267
loss_pred:0.01948937401175499, decouple_loss:0.0029592926148325205
The generated pressure mean: 0.448818176984787
loss_pred:0.020492715761065483, decouple_loss:0.002952268347144127
The generated pressure mean: 0.4454445540904999
loss_pred:0.021074878051877022, decouple_loss:0.0030278251506388187
2023-04-17 12:10:33 testing...
The generated pressure mean: 0.41773757338523865
The generated pressure mean: 0.42642584443092346
The generated pressure mean: 0.42919763922691345
loss_pred:0.03150707110762596, decouple_loss:0.0037970650009810925
loss_pred:0.03044908307492733, decouple_loss:0.0041202157735824585
loss_pred:0.030079012736678123, decouple_loss:0.004239060450345278
WV_0_PC_0_EH_1_PS_40, loss: 0.030880993232131004, avg_mse: 0.04616611823439598
current test mse: 0.046166
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 6481, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43361663818359375
loss_pred:0.018092304468154907, decouple_loss:0.003152894088998437
The generated pressure mean: 0.4348302483558655
loss_pred:0.020781364291906357, decouple_loss:0.0032212904188781977
The generated pressure mean: 0.4333551824092865
loss_pred:0.019032051786780357, decouple_loss:0.003139370121061802
Iteration: 6482, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477851092815399
The generated pressure mean: 0.44495338201522827
loss_pred:0.019133271649479866, decouple_loss:0.0028933805879205465
loss_pred:0.01997603289783001, decouple_loss:0.003099258290603757
The generated pressure mean: 0.4471260607242584
loss_pred:0.017451351508498192, decouple_loss:0.0031306517776101828
Iteration: 6483, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45111915469169617
loss_pred:0.018925519660115242, decouple_loss:0.0028663708362728357
The generated pressure mean: 0.4529929459095001
loss_pred:0.018765008077025414, decouple_loss:0.0028576552867889404
The generated pressure mean: 0.45273125171661377
loss_pred:0.017987338826060295, decouple_loss:0.003121008863672614
Iteration: 6484, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44016775488853455
The generated pressure mean: 0.44413867592811584
loss_pred:0.018082767724990845, decouple_loss:0.002615807345137
loss_pred:0.01676986925303936, decouple_loss:0.002575734630227089
The generated pressure mean: 0.44150036573410034
loss_pred:0.018089938908815384, decouple_loss:0.002543513895943761
Iteration: 6485, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45440399646759033
The generated pressure mean: 0.4506124258041382
loss_pred:0.01716143824160099, decouple_loss:0.0031332899816334248
loss_pred:0.017771990969777107, decouple_loss:0.0027064625173807144
The generated pressure mean: 0.4566062390804291
loss_pred:0.01725679449737072, decouple_loss:0.0030155424028635025
Iteration: 6486, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45635706186294556
The generated pressure mean: 0.45844724774360657
loss_pred:0.017101701349020004, decouple_loss:0.003095237771049142
loss_pred:0.01853756047785282, decouple_loss:0.0030847368761897087
The generated pressure mean: 0.45754241943359375
loss_pred:0.018492484465241432, decouple_loss:0.002947565633803606
Iteration: 6487, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44071781635284424
loss_pred:0.017533686012029648, decouple_loss:0.0025624309200793505
The generated pressure mean: 0.44428524374961853
loss_pred:0.01723872497677803, decouple_loss:0.0025748659390956163
The generated pressure mean: 0.4428892135620117
loss_pred:0.01815437525510788, decouple_loss:0.0025924888905137777
Iteration: 6488, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44687607884407043
loss_pred:0.018399283289909363, decouple_loss:0.0034968629479408264
The generated pressure mean: 0.4481096565723419The generated pressure mean: 0.44037505984306335
loss_pred:0.018091486766934395, decouple_loss:0.0036221558693796396
loss_pred:0.0182212945073843, decouple_loss:0.0030896456446498632
Iteration: 6489, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484800398349762
loss_pred:0.018688630312681198, decouple_loss:0.0026330784894526005
The generated pressure mean: 0.4478757977485657
loss_pred:0.018564555794000626, decouple_loss:0.002554153325036168
The generated pressure mean: 0.4418923258781433
loss_pred:0.01836070977151394, decouple_loss:0.002547235693782568
Iteration: 6490, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4518931210041046
The generated pressure mean: 0.4523022174835205
loss_pred:0.019087255001068115, decouple_loss:0.0033104605972766876
loss_pred:0.019442008808255196, decouple_loss:0.003296127775683999
The generated pressure mean: 0.4543391466140747
loss_pred:0.020438961684703827, decouple_loss:0.003143137088045478
2023-04-17 12:13:02 testing...
The generated pressure mean: 0.4155423939228058
The generated pressure mean: 0.4234086275100708
loss_pred:0.03228775039315224, decouple_loss:0.0041732885874807835
The generated pressure mean: 0.42599955201148987
loss_pred:0.0313807912170887, decouple_loss:0.004301502835005522
loss_pred:0.03057871013879776, decouple_loss:0.004398976918309927
WV_0_PC_0_EH_1_PS_40, loss: 0.03163031488656998, avg_mse: 0.047105349600315094
current test mse: 0.047105
Iteration: 6491, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44308093190193176
loss_pred:0.019049718976020813, decouple_loss:0.0035440800711512566
The generated pressure mean: 0.4363554120063782
loss_pred:0.020097149536013603, decouple_loss:0.003354420652613044
The generated pressure mean: 0.4401441514492035
loss_pred:0.01803247630596161, decouple_loss:0.0036461809650063515
Iteration: 6492, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476367235183716
loss_pred:0.01876189187169075, decouple_loss:0.0029033091850578785
The generated pressure mean: 0.4481198489665985
loss_pred:0.018592212349176407, decouple_loss:0.0027691645082086325
The generated pressure mean: 0.44344404339790344
loss_pred:0.018173083662986755, decouple_loss:0.0026587757747620344
Iteration: 6493, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4516759216785431
loss_pred:0.01771296188235283, decouple_loss:0.0025278343819081783
The generated pressure mean: 0.45646005868911743
loss_pred:0.01831270009279251, decouple_loss:0.0024729224387556314
The generated pressure mean: 0.45372867584228516
loss_pred:0.01778213307261467, decouple_loss:0.0024308525025844574
Iteration: 6494, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4529535472393036
loss_pred:0.01751541905105114, decouple_loss:0.003048456972464919
The generated pressure mean: 0.4594280421733856
loss_pred:0.018387332558631897, decouple_loss:0.0029400167986750603
The generated pressure mean: 0.45516109466552734
loss_pred:0.018351783975958824, decouple_loss:0.0029783272184431553
Iteration: 6495, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.440245658159256
loss_pred:0.01926238089799881, decouple_loss:0.0030282139778137207
The generated pressure mean: 0.4459323287010193
loss_pred:0.0175272598862648, decouple_loss:0.0028954341541975737
The generated pressure mean: 0.44466927647590637
loss_pred:0.01839945651590824, decouple_loss:0.0030463077127933502
Iteration: 6496, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44796207547187805
loss_pred:0.020324386656284332, decouple_loss:0.0029862546361982822
The generated pressure mean: 0.44368457794189453
loss_pred:0.01860828325152397, decouple_loss:0.0029718412552028894
The generated pressure mean: 0.444335401058197
loss_pred:0.017451858147978783, decouple_loss:0.002982545644044876
Iteration: 6497, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44965434074401855
loss_pred:0.01754513569176197, decouple_loss:0.0028713683132082224
The generated pressure mean: 0.4439966678619385
loss_pred:0.017807278782129288, decouple_loss:0.0028534578159451485
The generated pressure mean: 0.44703665375709534
loss_pred:0.018577774986624718, decouple_loss:0.0028091645799577236
Iteration: 6498, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44968292117118835
loss_pred:0.018150337040424347, decouple_loss:0.002614291151985526
The generated pressure mean: 0.44910719990730286
loss_pred:0.01864743046462536, decouple_loss:0.002494655316695571
The generated pressure mean: 0.45472103357315063
loss_pred:0.01826287806034088, decouple_loss:0.0026037537027150393
Iteration: 6499, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44990330934524536
loss_pred:0.01840207725763321, decouple_loss:0.0034093146678060293
The generated pressure mean: 0.4544748365879059
loss_pred:0.018143994733691216, decouple_loss:0.003546107094734907
The generated pressure mean: 0.4505087733268738
loss_pred:0.01845458336174488, decouple_loss:0.003449422074481845
Iteration: 6500, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44121119379997253
loss_pred:0.018785037100315094, decouple_loss:0.0027960268780589104
The generated pressure mean: 0.4404014050960541
loss_pred:0.018585415557026863, decouple_loss:0.0028055389411747456
The generated pressure mean: 0.4386526644229889
loss_pred:0.017054952681064606, decouple_loss:0.002765357494354248
2023-04-17 12:14:56 testing...
The generated pressure mean: 0.4143884479999542
The generated pressure mean: 0.42181870341300964
The generated pressure mean: 0.42473283410072327
loss_pred:0.03281715512275696, decouple_loss:0.00395894143730402
loss_pred:0.031225334852933884, decouple_loss:0.004201129078865051
loss_pred:0.031024102121591568, decouple_loss:0.004430768080055714
WV_0_PC_0_EH_1_PS_40, loss: 0.03189871460199356, avg_mse: 0.047768522053956985
current test mse: 0.047769
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 6501, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44790083169937134
loss_pred:0.019167378544807434, decouple_loss:0.003299019066616893
The generated pressure mean: 0.4424996078014374
loss_pred:0.018467560410499573, decouple_loss:0.003524856874719262
The generated pressure mean: 0.4507172107696533
loss_pred:0.018725480884313583, decouple_loss:0.003524253610521555
Iteration: 6502, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45530447363853455
loss_pred:0.019198371097445488, decouple_loss:0.0028318692930042744
The generated pressure mean: 0.4509130120277405
loss_pred:0.018016524612903595, decouple_loss:0.002712978282943368
The generated pressure mean: 0.4579929709434509
loss_pred:0.020225243642926216, decouple_loss:0.0028215190395712852
Iteration: 6503, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44911226630210876
loss_pred:0.01905563846230507, decouple_loss:0.002696430077776313
The generated pressure mean: 0.4401395618915558
loss_pred:0.01833237148821354, decouple_loss:0.0026012922171503305
The generated pressure mean: 0.4426223337650299
loss_pred:0.01906208135187626, decouple_loss:0.0026001438964158297
Iteration: 6504, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4438150227069855
The generated pressure mean: 0.4412359893321991
loss_pred:0.017033115029335022, decouple_loss:0.0026854337193071842
loss_pred:0.020812520757317543, decouple_loss:0.0026647637132555246
The generated pressure mean: 0.4454922080039978
loss_pred:0.01825243979692459, decouple_loss:0.002618401776999235
Iteration: 6505, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44038647413253784
loss_pred:0.019089767709374428, decouple_loss:0.0031205429695546627
The generated pressure mean: 0.43906161189079285
loss_pred:0.01809285767376423, decouple_loss:0.0029345895163714886
The generated pressure mean: 0.44528910517692566
loss_pred:0.018925203010439873, decouple_loss:0.003042124677449465
Iteration: 6506, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44955122470855713
loss_pred:0.018780741840600967, decouple_loss:0.002649057423695922
The generated pressure mean: 0.45569849014282227
loss_pred:0.019709007814526558, decouple_loss:0.002584312343969941
The generated pressure mean: 0.4525317847728729
loss_pred:0.01864863932132721, decouple_loss:0.0024970658123493195
Iteration: 6507, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45761701464653015
loss_pred:0.01947203278541565, decouple_loss:0.002402231330052018
The generated pressure mean: 0.45718586444854736
loss_pred:0.019758837297558784, decouple_loss:0.0025175383780151606
The generated pressure mean: 0.45072951912879944
loss_pred:0.018776217475533485, decouple_loss:0.0024187196977436543
Iteration: 6508, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493923485279083
loss_pred:0.019980039447546005, decouple_loss:0.003241571132093668
The generated pressure mean: 0.44667136669158936
loss_pred:0.019968664273619652, decouple_loss:0.0032817258033901453
The generated pressure mean: 0.44923144578933716
loss_pred:0.017939746379852295, decouple_loss:0.0032655491959303617
Iteration: 6509, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4404772222042084
loss_pred:0.018788080662488937, decouple_loss:0.0028569973073899746
The generated pressure mean: 0.44162991642951965
The generated pressure mean: 0.44255131483078003
loss_pred:0.018171468749642372, decouple_loss:0.002989999484270811
loss_pred:0.01818588562309742, decouple_loss:0.003023205092176795
Iteration: 6510, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497672915458679
loss_pred:0.017731256783008575, decouple_loss:0.0024393321946263313
The generated pressure mean: 0.43975743651390076
loss_pred:0.018302593380212784, decouple_loss:0.002574101323261857
The generated pressure mean: 0.4439994692802429
loss_pred:0.019763652235269547, decouple_loss:0.0024694139137864113
2023-04-17 12:17:26 testing...
The generated pressure mean: 0.41471388936042786
The generated pressure mean: 0.4223623275756836
The generated pressure mean: 0.42548224329948425
loss_pred:0.03186241537332535, decouple_loss:0.003949967212975025
loss_pred:0.0307837575674057, decouple_loss:0.004126544110476971
loss_pred:0.030449090525507927, decouple_loss:0.0042438805103302
WV_0_PC_0_EH_1_PS_40, loss: 0.031237095594406128, avg_mse: 0.04664993658661842
current test mse: 0.04665
Iteration: 6511, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474877715110779
loss_pred:0.018530331552028656, decouple_loss:0.003879053983837366
The generated pressure mean: 0.44823476672172546
loss_pred:0.018732458353042603, decouple_loss:0.003952488303184509
The generated pressure mean: 0.4427186846733093
loss_pred:0.017458314076066017, decouple_loss:0.0038021535146981478
Iteration: 6512, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503558576107025
loss_pred:0.017751863226294518, decouple_loss:0.00284848315641284
The generated pressure mean: 0.45069536566734314
loss_pred:0.018128830939531326, decouple_loss:0.002865036716684699
The generated pressure mean: 0.45705753564834595
loss_pred:0.018569763749837875, decouple_loss:0.002903596730902791
Iteration: 6513, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.451766699552536
loss_pred:0.017717666923999786, decouple_loss:0.0038547746371477842
The generated pressure mean: 0.45128417015075684
loss_pred:0.02244407683610916, decouple_loss:0.0036283775698393583
The generated pressure mean: 0.46189865469932556
loss_pred:0.01901576668024063, decouple_loss:0.0038148595485836267
Iteration: 6514, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43718069791793823
loss_pred:0.019300028681755066, decouple_loss:0.0024042539298534393
The generated pressure mean: 0.4395069181919098
loss_pred:0.018533451482653618, decouple_loss:0.0024104048497974873
The generated pressure mean: 0.4383685886859894
loss_pred:0.01868097297847271, decouple_loss:0.0023518940433859825
Iteration: 6515, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4435134530067444
loss_pred:0.020369431003928185, decouple_loss:0.0024264201056212187
The generated pressure mean: 0.44942528009414673
loss_pred:0.019066669046878815, decouple_loss:0.002402332378551364
The generated pressure mean: 0.44900909066200256
loss_pred:0.018254712224006653, decouple_loss:0.002319956663995981
Iteration: 6516, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4545840919017792
loss_pred:0.01866765506565571, decouple_loss:0.002332786563783884
The generated pressure mean: 0.4476924240589142
loss_pred:0.019738713279366493, decouple_loss:0.00235450966283679
The generated pressure mean: 0.44838982820510864
loss_pred:0.018241483718156815, decouple_loss:0.002293699886649847
Iteration: 6517, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447512149810791
loss_pred:0.01927412673830986, decouple_loss:0.002719753421843052
The generated pressure mean: 0.44410935044288635
loss_pred:0.01928800530731678, decouple_loss:0.0026226206682622433
The generated pressure mean: 0.4468054473400116
loss_pred:0.01789805106818676, decouple_loss:0.0026539205573499203
Iteration: 6518, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44815948605537415
loss_pred:0.019171226769685745, decouple_loss:0.004570488352328539
The generated pressure mean: 0.4522574543952942
loss_pred:0.019808001816272736, decouple_loss:0.004448044579476118
The generated pressure mean: 0.45410996675491333
loss_pred:0.01939956098794937, decouple_loss:0.004301353357732296
Iteration: 6519, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43341124057769775
loss_pred:0.018152913078665733, decouple_loss:0.0025666109286248684
The generated pressure mean: 0.43319404125213623
The generated pressure mean: 0.4292669892311096
loss_pred:0.01898357830941677, decouple_loss:0.00268114753998816
loss_pred:0.021103432402014732, decouple_loss:0.0027118076104670763
Iteration: 6520, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45202329754829407
loss_pred:0.01914689503610134, decouple_loss:0.00366066861897707
The generated pressure mean: 0.44998395442962646
loss_pred:0.020884893834590912, decouple_loss:0.0036120691802352667
The generated pressure mean: 0.4478115141391754
loss_pred:0.020121436566114426, decouple_loss:0.0036746624391525984
2023-04-17 12:19:19 testing...
The generated pressure mean: 0.41054534912109375
The generated pressure mean: 0.41902631521224976
loss_pred:0.03417341411113739, decouple_loss:0.0037855796981602907
The generated pressure mean: 0.42100441455841064
loss_pred:0.0327705442905426, decouple_loss:0.003934269770979881
loss_pred:0.032271552830934525, decouple_loss:0.004181852098554373
WV_0_PC_0_EH_1_PS_40, loss: 0.033270202577114105, avg_mse: 0.05025423690676689
current test mse: 0.050254
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 6521, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4630836546421051
loss_pred:0.018638508394360542, decouple_loss:0.003320168936625123
The generated pressure mean: 0.45990055799484253
loss_pred:0.018808720633387566, decouple_loss:0.0033080512657761574
The generated pressure mean: 0.46334385871887207
loss_pred:0.017859064042568207, decouple_loss:0.003275163471698761
Iteration: 6522, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44904395937919617
loss_pred:0.018347956240177155, decouple_loss:0.0027941407170146704
The generated pressure mean: 0.4489503800868988
loss_pred:0.018027080222964287, decouple_loss:0.002899689134210348
The generated pressure mean: 0.4491962194442749
loss_pred:0.01780444197356701, decouple_loss:0.0028424588963389397
Iteration: 6523, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43872785568237305
The generated pressure mean: 0.436687707901001loss_pred:0.017606062814593315, decouple_loss:0.003516174852848053
loss_pred:0.01774711348116398, decouple_loss:0.0034362399019300938
The generated pressure mean: 0.43092742562294006
loss_pred:0.018004242330789566, decouple_loss:0.0033748506102710962
Iteration: 6524, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471656084060669
loss_pred:0.019311588257551193, decouple_loss:0.003229449037462473
The generated pressure mean: 0.44356459379196167
loss_pred:0.018310850486159325, decouple_loss:0.003080759895965457
The generated pressure mean: 0.44990426301956177
loss_pred:0.017831280827522278, decouple_loss:0.003001151140779257
Iteration: 6525, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4548361599445343
loss_pred:0.01867496222257614, decouple_loss:0.0031920168548822403
The generated pressure mean: 0.45108747482299805
loss_pred:0.01835612580180168, decouple_loss:0.0033959802240133286
The generated pressure mean: 0.45286670327186584
loss_pred:0.017691094428300858, decouple_loss:0.003109907964244485
Iteration: 6526, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4399556517601013
loss_pred:0.019179975613951683, decouple_loss:0.0026992945931851864
The generated pressure mean: 0.4417685568332672
loss_pred:0.018358398228883743, decouple_loss:0.0024868196342140436
The generated pressure mean: 0.4467933773994446
loss_pred:0.018359236419200897, decouple_loss:0.002526817610487342
Iteration: 6527, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43779003620147705
loss_pred:0.01754935458302498, decouple_loss:0.0031275085639208555
The generated pressure mean: 0.4363904893398285
loss_pred:0.018907632678747177, decouple_loss:0.003078434383496642
The generated pressure mean: 0.44319063425064087
loss_pred:0.0179947167634964, decouple_loss:0.0030981535091996193
Iteration: 6528, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4513367712497711
The generated pressure mean: 0.4579271972179413loss_pred:0.019576948136091232, decouple_loss:0.0031351810321211815
loss_pred:0.01676054671406746, decouple_loss:0.003054874250665307
The generated pressure mean: 0.4518471956253052
loss_pred:0.019444908946752548, decouple_loss:0.003264810424298048
Iteration: 6529, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45205602049827576
loss_pred:0.017717311158776283, decouple_loss:0.0024900606367737055
The generated pressure mean: 0.4568103849887848
loss_pred:0.017307782545685768, decouple_loss:0.0026184513699263334
The generated pressure mean: 0.45486778020858765
loss_pred:0.019351031631231308, decouple_loss:0.0025381571613252163
Iteration: 6530, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442913830280304
loss_pred:0.017969904467463493, decouple_loss:0.002353459596633911
The generated pressure mean: 0.4455948770046234
loss_pred:0.018521014600992203, decouple_loss:0.002217171946540475
The generated pressure mean: 0.4423631727695465
loss_pred:0.019291896373033524, decouple_loss:0.0022853021509945393
2023-04-17 12:21:48 testing...
The generated pressure mean: 0.4158576726913452
The generated pressure mean: 0.42343175411224365
The generated pressure mean: 0.4262027442455292
loss_pred:0.031902212649583817, decouple_loss:0.003295610658824444
loss_pred:0.03038308396935463, decouple_loss:0.00341815291903913
loss_pred:0.02974134311079979, decouple_loss:0.003532983362674713
WV_0_PC_0_EH_1_PS_40, loss: 0.030846325680613518, avg_mse: 0.04590768367052078
current test mse: 0.045908
Iteration: 6531, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4374009370803833
loss_pred:0.017166301608085632, decouple_loss:0.0027416921220719814
The generated pressure mean: 0.4373467266559601
loss_pred:0.018517622724175453, decouple_loss:0.002870796015486121
The generated pressure mean: 0.43985602259635925
loss_pred:0.016863999888300896, decouple_loss:0.0027518661227077246
Iteration: 6532, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44934308528900146
loss_pred:0.018821466714143753, decouple_loss:0.0024750272277742624
The generated pressure mean: 0.44477424025535583
loss_pred:0.0178394615650177, decouple_loss:0.0024686043616384268
The generated pressure mean: 0.4462863802909851
loss_pred:0.01734296791255474, decouple_loss:0.002404655097052455
Iteration: 6533, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45063337683677673
loss_pred:0.018621351569890976, decouple_loss:0.0022922877687960863
The generated pressure mean: 0.4487423896789551
loss_pred:0.018418600782752037, decouple_loss:0.0025215407367795706
The generated pressure mean: 0.4461915194988251
loss_pred:0.017248813062906265, decouple_loss:0.002394689479842782
Iteration: 6534, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44787755608558655
loss_pred:0.01862511783838272, decouple_loss:0.0025287019088864326
The generated pressure mean: 0.44969305396080017
loss_pred:0.017894038930535316, decouple_loss:0.002465881872922182
The generated pressure mean: 0.45159050822257996
loss_pred:0.020526772364974022, decouple_loss:0.002462870441377163
Iteration: 6535, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4525619447231293
loss_pred:0.01978442072868347, decouple_loss:0.0027133149560540915
The generated pressure mean: 0.45258867740631104
loss_pred:0.018505973741412163, decouple_loss:0.002654732670634985
The generated pressure mean: 0.455116331577301
loss_pred:0.01754569076001644, decouple_loss:0.002550018485635519
Iteration: 6536, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4373609721660614
loss_pred:0.017818346619606018, decouple_loss:0.002707309555262327
The generated pressure mean: 0.44178640842437744
loss_pred:0.01780083030462265, decouple_loss:0.002552286721765995
The generated pressure mean: 0.4358336627483368
loss_pred:0.018762456253170967, decouple_loss:0.0026875322218984365
Iteration: 6537, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4437762498855591
loss_pred:0.017975516617298126, decouple_loss:0.002893795259296894
The generated pressure mean: 0.4405413269996643
loss_pred:0.017655765637755394, decouple_loss:0.0028204922564327717
The generated pressure mean: 0.4405766725540161
loss_pred:0.01796012744307518, decouple_loss:0.0032085825223475695
Iteration: 6538, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4513990879058838
loss_pred:0.017986014485359192, decouple_loss:0.003283509984612465
The generated pressure mean: 0.45458224415779114
The generated pressure mean: 0.4515349864959717
loss_pred:0.018309764564037323, decouple_loss:0.003235871670767665
loss_pred:0.019630655646324158, decouple_loss:0.0032273768447339535
Iteration: 6539, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.443755179643631
loss_pred:0.018085487186908722, decouple_loss:0.0030788485892117023
The generated pressure mean: 0.4456574320793152
loss_pred:0.017508363351225853, decouple_loss:0.0032010332215577364
The generated pressure mean: 0.4479495584964752
loss_pred:0.01886225864291191, decouple_loss:0.0028782461304217577
Iteration: 6540, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4394432306289673
loss_pred:0.018995851278305054, decouple_loss:0.0028698190581053495
The generated pressure mean: 0.4453069269657135
loss_pred:0.01679069548845291, decouple_loss:0.00274036917835474
The generated pressure mean: 0.4396902918815613
loss_pred:0.019070709124207497, decouple_loss:0.002950292779132724
2023-04-17 12:23:41 testing...
The generated pressure mean: 0.41941794753074646
The generated pressure mean: 0.412185937166214
The generated pressure mean: 0.4221856892108917
loss_pred:0.030953017994761467, decouple_loss:0.0036529668141156435
loss_pred:0.03238876909017563, decouple_loss:0.0034376869443804026
loss_pred:0.03062419220805168, decouple_loss:0.003827253356575966
WV_0_PC_0_EH_1_PS_40, loss: 0.031503960490226746, avg_mse: 0.04702996835112572
current test mse: 0.04703
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 6541, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472953677177429
loss_pred:0.017496511340141296, decouple_loss:0.003135623410344124
The generated pressure mean: 0.4443248510360718
loss_pred:0.01834987848997116, decouple_loss:0.0029049678705632687
The generated pressure mean: 0.4477747678756714
loss_pred:0.01754661835730076, decouple_loss:0.002933854702860117
Iteration: 6542, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45474791526794434
The generated pressure mean: 0.46029937267303467
loss_pred:0.01716063916683197, decouple_loss:0.0029264017939567566
loss_pred:0.020953921601176262, decouple_loss:0.0031400765292346478
The generated pressure mean: 0.45177149772644043
loss_pred:0.018663082271814346, decouple_loss:0.0030221969354897738
Iteration: 6543, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43847304582595825
The generated pressure mean: 0.4405086934566498
loss_pred:0.018794767558574677, decouple_loss:0.0026250772643834352
loss_pred:0.018199454993009567, decouple_loss:0.0026705313939601183
The generated pressure mean: 0.43814003467559814
loss_pred:0.018116293475031853, decouple_loss:0.002738961949944496
Iteration: 6544, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4443497359752655
The generated pressure mean: 0.4478485882282257
loss_pred:0.019393833354115486, decouple_loss:0.0025747662875801325
loss_pred:0.017555003985762596, decouple_loss:0.002585627371445298
The generated pressure mean: 0.4434892237186432
loss_pred:0.0196998231112957, decouple_loss:0.0026206010952591896
Iteration: 6545, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44747471809387207
The generated pressure mean: 0.44320783019065857
loss_pred:0.017246410250663757, decouple_loss:0.002468391787260771
loss_pred:0.0179535374045372, decouple_loss:0.002457889961078763
The generated pressure mean: 0.44799044728279114
loss_pred:0.018262658268213272, decouple_loss:0.002558365697041154
Iteration: 6546, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467232823371887The generated pressure mean: 0.44297000765800476
loss_pred:0.017738202586770058, decouple_loss:0.002312995493412018
loss_pred:0.01883120648562908, decouple_loss:0.0023537410888820887
The generated pressure mean: 0.44454607367515564
loss_pred:0.017342016100883484, decouple_loss:0.0023743032943457365
Iteration: 6547, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44880616664886475
The generated pressure mean: 0.44347721338272095
loss_pred:0.017125895246863365, decouple_loss:0.00234027486294508
loss_pred:0.01959550753235817, decouple_loss:0.002277916530147195
The generated pressure mean: 0.4429025650024414
loss_pred:0.01761597953736782, decouple_loss:0.002411718713119626
Iteration: 6548, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4510163962841034
loss_pred:0.017826365306973457, decouple_loss:0.0025794575922191143
The generated pressure mean: 0.4387911260128021
loss_pred:0.018035657703876495, decouple_loss:0.002518595429137349
The generated pressure mean: 0.44382283091545105
loss_pred:0.018760722130537033, decouple_loss:0.0025393525138497353
Iteration: 6549, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4441029131412506
loss_pred:0.01835629716515541, decouple_loss:0.0026928847655653954
The generated pressure mean: 0.4400123357772827
loss_pred:0.01828101836144924, decouple_loss:0.002608633367344737
The generated pressure mean: 0.44346559047698975
loss_pred:0.017701607197523117, decouple_loss:0.0026306372601538897
Iteration: 6550, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4539910554885864
loss_pred:0.01796082593500614, decouple_loss:0.0025086572859436274
The generated pressure mean: 0.44712817668914795
loss_pred:0.018146876245737076, decouple_loss:0.0025542466901242733
The generated pressure mean: 0.4527634382247925
loss_pred:0.020009806379675865, decouple_loss:0.002478992333635688
2023-04-17 12:26:12 testing...
The generated pressure mean: 0.42167285084724426
The generated pressure mean: 0.414562851190567
The generated pressure mean: 0.42467182874679565
loss_pred:0.03029913455247879, decouple_loss:0.0032169539481401443
loss_pred:0.031221682205796242, decouple_loss:0.0030337634962052107
loss_pred:0.029623262584209442, decouple_loss:0.003290178719907999
WV_0_PC_0_EH_1_PS_40, loss: 0.030540375038981438, avg_mse: 0.045359302312135696
current test mse: 0.045359
Iteration: 6551, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4385738670825958
loss_pred:0.018421640619635582, decouple_loss:0.0026010225992649794
The generated pressure mean: 0.44492605328559875
loss_pred:0.01718212105333805, decouple_loss:0.002553584985435009
The generated pressure mean: 0.44503358006477356
loss_pred:0.017571784555912018, decouple_loss:0.0025800103321671486
Iteration: 6552, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4354178309440613
loss_pred:0.017817428335547447, decouple_loss:0.002443842589855194
The generated pressure mean: 0.43543925881385803
loss_pred:0.01820199564099312, decouple_loss:0.0025516427122056484
The generated pressure mean: 0.43850335478782654
loss_pred:0.01863626390695572, decouple_loss:0.002556960564106703
Iteration: 6553, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45858651399612427
loss_pred:0.017487673088908195, decouple_loss:0.002401391975581646
The generated pressure mean: 0.4539352059364319
loss_pred:0.018885008990764618, decouple_loss:0.0025186981074512005
The generated pressure mean: 0.4587676227092743
loss_pred:0.01804000325500965, decouple_loss:0.0025603407993912697
Iteration: 6554, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487416446208954
loss_pred:0.01750761829316616, decouple_loss:0.0025770352222025394
The generated pressure mean: 0.4460151791572571
loss_pred:0.01789398118853569, decouple_loss:0.0025781886652112007
The generated pressure mean: 0.4479858875274658
loss_pred:0.01828043721616268, decouple_loss:0.002748285187408328
Iteration: 6555, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4343535900115967The generated pressure mean: 0.42800477147102356
loss_pred:0.017413390800356865, decouple_loss:0.003361588576808572
loss_pred:0.01823003776371479, decouple_loss:0.003176945960149169
The generated pressure mean: 0.43005290627479553
loss_pred:0.019895341247320175, decouple_loss:0.0032341377809643745
Iteration: 6556, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4516274333000183
The generated pressure mean: 0.4506255090236664
loss_pred:0.016967231407761574, decouple_loss:0.0028612115420401096
loss_pred:0.01992308348417282, decouple_loss:0.0028764705639332533
The generated pressure mean: 0.4544641673564911
loss_pred:0.01782480999827385, decouple_loss:0.002877149498090148
Iteration: 6557, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45496609807014465
loss_pred:0.018917249515652657, decouple_loss:0.0034802162554115057
The generated pressure mean: 0.4521867632865906
loss_pred:0.01947416365146637, decouple_loss:0.0034626051783561707
The generated pressure mean: 0.45756083726882935
loss_pred:0.017315883189439774, decouple_loss:0.0035794032737612724
Iteration: 6558, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488573968410492
loss_pred:0.01762513630092144, decouple_loss:0.0027213238645344973
The generated pressure mean: 0.4483097493648529
loss_pred:0.01778167299926281, decouple_loss:0.002721969271078706
The generated pressure mean: 0.4427832067012787
loss_pred:0.01842259243130684, decouple_loss:0.002787877805531025
Iteration: 6559, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4391375482082367
loss_pred:0.01894977129995823, decouple_loss:0.003377234563231468
The generated pressure mean: 0.43434587121009827
loss_pred:0.018869254738092422, decouple_loss:0.003492694580927491
The generated pressure mean: 0.43849775195121765
loss_pred:0.018151957541704178, decouple_loss:0.00353673892095685
Iteration: 6560, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44558897614479065
loss_pred:0.01847902312874794, decouple_loss:0.0029259463772177696
The generated pressure mean: 0.4441203773021698
loss_pred:0.01709340699017048, decouple_loss:0.0028323426377028227
The generated pressure mean: 0.4423454999923706
loss_pred:0.018588488921523094, decouple_loss:0.002834718907251954
2023-04-17 12:28:06 testing...
The generated pressure mean: 0.41923266649246216
The generated pressure mean: 0.4123212993144989
The generated pressure mean: 0.4222865402698517
loss_pred:0.031775716692209244, decouple_loss:0.0032712575048208237
loss_pred:0.03269610181450844, decouple_loss:0.0031249034218490124
loss_pred:0.031276341527700424, decouple_loss:0.003435437800362706
WV_0_PC_0_EH_1_PS_40, loss: 0.03207991644740105, avg_mse: 0.04815315827727318
current test mse: 0.048153
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 6561, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45054638385772705
loss_pred:0.018868418410420418, decouple_loss:0.002795182866975665
The generated pressure mean: 0.4463592767715454
The generated pressure mean: 0.4470664858818054
loss_pred:0.018051428720355034, decouple_loss:0.0027617523446679115
loss_pred:0.019076988101005554, decouple_loss:0.0025944821536540985
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 6562, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44678518176078796
The generated pressure mean: 0.4499109089374542
loss_pred:0.017788181081414223, decouple_loss:0.002965192776173353
loss_pred:0.018365371972322464, decouple_loss:0.0029511351604014635
The generated pressure mean: 0.45190170407295227
loss_pred:0.01824086531996727, decouple_loss:0.002900825347751379
Iteration: 6563, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463425278663635
loss_pred:0.019465479999780655, decouple_loss:0.002704818733036518
The generated pressure mean: 0.44965583086013794
loss_pred:0.020184921100735664, decouple_loss:0.0027229085098952055
The generated pressure mean: 0.4434607923030853
loss_pred:0.018282094970345497, decouple_loss:0.002709467662498355
Iteration: 6564, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44483986496925354
The generated pressure mean: 0.4437238276004791
loss_pred:0.018211498856544495, decouple_loss:0.0025331112556159496
loss_pred:0.017967933788895607, decouple_loss:0.0025573030579835176
The generated pressure mean: 0.44201505184173584
loss_pred:0.01876130700111389, decouple_loss:0.002458331873640418
Iteration: 6565, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478358328342438
The generated pressure mean: 0.446475088596344
loss_pred:0.01817883923649788, decouple_loss:0.002548548625782132
loss_pred:0.017476456239819527, decouple_loss:0.002653034869581461
The generated pressure mean: 0.44879385828971863
loss_pred:0.018203651532530785, decouple_loss:0.0025402468163520098
Iteration: 6566, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4458458125591278
The generated pressure mean: 0.4507690370082855
loss_pred:0.019650805741548538, decouple_loss:0.0025745639577507973
loss_pred:0.018996385857462883, decouple_loss:0.002686041174456477
The generated pressure mean: 0.445686399936676
loss_pred:0.02298918552696705, decouple_loss:0.0026913119945675135
Iteration: 6567, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43009358644485474The generated pressure mean: 0.42988258600234985
loss_pred:0.01792115718126297, decouple_loss:0.003249086206778884
loss_pred:0.018925081938505173, decouple_loss:0.003267670748755336
The generated pressure mean: 0.42746084928512573
loss_pred:0.01873580366373062, decouple_loss:0.003290426218882203
Iteration: 6568, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44830387830734253
The generated pressure mean: 0.4485667049884796
loss_pred:0.019551105797290802, decouple_loss:0.002832567086443305
loss_pred:0.018865695223212242, decouple_loss:0.002984958700835705
The generated pressure mean: 0.4499135911464691
loss_pred:0.01848899945616722, decouple_loss:0.00290082604624331
Iteration: 6569, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46173498034477234
The generated pressure mean: 0.4616537094116211
loss_pred:0.018434181809425354, decouple_loss:0.00283825839869678
loss_pred:0.0206300038844347, decouple_loss:0.0027246265672147274
The generated pressure mean: 0.4616825580596924
loss_pred:0.01960192620754242, decouple_loss:0.0027088308706879616
Iteration: 6570, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44343897700309753
The generated pressure mean: 0.44211116433143616
loss_pred:0.0172522384673357, decouple_loss:0.003758508013561368
loss_pred:0.019083814695477486, decouple_loss:0.003731262404471636
The generated pressure mean: 0.43985065817832947
loss_pred:0.017488321289420128, decouple_loss:0.0037957557942718267
2023-04-17 12:30:33 testing...
The generated pressure mean: 0.4144929349422455
The generated pressure mean: 0.4230635166168213
The generated pressure mean: 0.4258425533771515
loss_pred:0.035182952880859375, decouple_loss:0.0037037732545286417
loss_pred:0.0333348773419857, decouple_loss:0.0038584754802286625
loss_pred:0.033532947301864624, decouple_loss:0.003968179691582918
WV_0_PC_0_EH_1_PS_40, loss: 0.034209102392196655, avg_mse: 0.053279727697372437
current test mse: 0.05328
Iteration: 6571, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4321771562099457
The generated pressure mean: 0.4368761479854584
loss_pred:0.018656378611922264, decouple_loss:0.00313140032812953
loss_pred:0.018369752913713455, decouple_loss:0.003097698325291276
The generated pressure mean: 0.43368294835090637
loss_pred:0.017975008115172386, decouple_loss:0.0031883304473012686
Iteration: 6572, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4547453820705414
The generated pressure mean: 0.4474782645702362
loss_pred:0.017488332465291023, decouple_loss:0.0029053804464638233
loss_pred:0.018898680806159973, decouple_loss:0.002872050041332841
The generated pressure mean: 0.4481194317340851
loss_pred:0.018841998651623726, decouple_loss:0.002835004823282361
Iteration: 6573, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4596148133277893
The generated pressure mean: 0.4565713107585907
loss_pred:0.01774086430668831, decouple_loss:0.003943330142647028
loss_pred:0.01869676075875759, decouple_loss:0.004162116441875696
The generated pressure mean: 0.45683667063713074
loss_pred:0.01915583573281765, decouple_loss:0.004008033312857151
Iteration: 6574, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4419260323047638
loss_pred:0.017752349376678467, decouple_loss:0.0032087245490401983
The generated pressure mean: 0.4415411651134491
loss_pred:0.01800372824072838, decouple_loss:0.003184973495081067
The generated pressure mean: 0.44580715894699097
loss_pred:0.01797848753631115, decouple_loss:0.0033724033273756504
Iteration: 6575, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43867582082748413
The generated pressure mean: 0.43600112199783325
loss_pred:0.01705373264849186, decouple_loss:0.0029834818560630083
loss_pred:0.017144709825515747, decouple_loss:0.003100066911429167
The generated pressure mean: 0.43694108724594116
loss_pred:0.019715387374162674, decouple_loss:0.0031025500502437353
Iteration: 6576, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493125379085541The generated pressure mean: 0.44676870107650757
loss_pred:0.01873931661248207, decouple_loss:0.004265408497303724
loss_pred:0.018839193508028984, decouple_loss:0.004226301331073046
The generated pressure mean: 0.448236882686615
loss_pred:0.02054297737777233, decouple_loss:0.004267488606274128
Iteration: 6577, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4538230299949646
loss_pred:0.018246395513415337, decouple_loss:0.0030775810591876507
The generated pressure mean: 0.45543456077575684
loss_pred:0.017763910815119743, decouple_loss:0.0031022168695926666
The generated pressure mean: 0.4516803026199341
loss_pred:0.017684118822216988, decouple_loss:0.0031029731035232544
Iteration: 6578, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483908414840698
loss_pred:0.018870102241635323, decouple_loss:0.003704368369653821
The generated pressure mean: 0.44772377610206604
loss_pred:0.018009502440690994, decouple_loss:0.0037239904049783945
The generated pressure mean: 0.4447048008441925
loss_pred:0.018985053524374962, decouple_loss:0.003637593472376466
Iteration: 6579, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4364243745803833
loss_pred:0.018088875338435173, decouple_loss:0.003198286285623908
The generated pressure mean: 0.4431089162826538
loss_pred:0.01771320402622223, decouple_loss:0.003066074335947633
The generated pressure mean: 0.4406890869140625
loss_pred:0.021202852949500084, decouple_loss:0.0029857137706130743
Iteration: 6580, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4308266043663025
loss_pred:0.017856094986200333, decouple_loss:0.002815421437844634
The generated pressure mean: 0.43606629967689514
loss_pred:0.017668481916189194, decouple_loss:0.002764246892184019
The generated pressure mean: 0.4349100887775421
loss_pred:0.018796062096953392, decouple_loss:0.0029507072176784277
2023-04-17 12:32:27 testing...
The generated pressure mean: 0.4157710671424866
The generated pressure mean: 0.4105939269065857
The generated pressure mean: 0.4187565743923187
loss_pred:0.03277317434549332, decouple_loss:0.0041810451075434685
loss_pred:0.033526208251714706, decouple_loss:0.004018173553049564
loss_pred:0.03234945982694626, decouple_loss:0.004293001722544432
WV_0_PC_0_EH_1_PS_40, loss: 0.03309115394949913, avg_mse: 0.049659792333841324
current test mse: 0.04966
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 6581, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45881223678588867
loss_pred:0.01745840720832348, decouple_loss:0.0034468071535229683
The generated pressure mean: 0.45890548825263977
loss_pred:0.02271190658211708, decouple_loss:0.003553724614903331
The generated pressure mean: 0.46009284257888794
loss_pred:0.01792922429740429, decouple_loss:0.0034384382888674736
Iteration: 6582, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493836462497711The generated pressure mean: 0.44865620136260986
loss_pred:0.018002932891249657, decouple_loss:0.0030815189238637686loss_pred:0.01786174438893795, decouple_loss:0.003192746080458164
The generated pressure mean: 0.44902968406677246
loss_pred:0.018746718764305115, decouple_loss:0.003277367679402232
Iteration: 6583, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4363822638988495The generated pressure mean: 0.43958762288093567
loss_pred:0.020584089681506157, decouple_loss:0.003019931958988309
loss_pred:0.017285065725445747, decouple_loss:0.0028779746498912573
The generated pressure mean: 0.43597835302352905
loss_pred:0.017793921753764153, decouple_loss:0.002875401871278882
Iteration: 6584, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44435152411460876The generated pressure mean: 0.44637516140937805
loss_pred:0.018512113019824028, decouple_loss:0.0027087246999144554loss_pred:0.017155414447188377, decouple_loss:0.0027260170318186283
The generated pressure mean: 0.4515414237976074
loss_pred:0.017376074567437172, decouple_loss:0.002687449799850583
Iteration: 6585, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466099739074707
The generated pressure mean: 0.4503064453601837
loss_pred:0.017617063596844673, decouple_loss:0.003393299877643585
loss_pred:0.01927792839705944, decouple_loss:0.003361807204782963
The generated pressure mean: 0.44450026750564575
loss_pred:0.018140999600291252, decouple_loss:0.003482172265648842
Iteration: 6586, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.443227618932724
The generated pressure mean: 0.4400266110897064
loss_pred:0.018280576914548874, decouple_loss:0.0029771276749670506
loss_pred:0.019741524010896683, decouple_loss:0.002965963911265135
The generated pressure mean: 0.44552239775657654
loss_pred:0.018866846337914467, decouple_loss:0.0029822979122400284
Iteration: 6587, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4553234279155731
The generated pressure mean: 0.4529133439064026
loss_pred:0.020486077293753624, decouple_loss:0.0023390392307192087
loss_pred:0.018742721527814865, decouple_loss:0.002323184860870242
The generated pressure mean: 0.4528084397315979
loss_pred:0.01895030401647091, decouple_loss:0.0023524423595517874
Iteration: 6588, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4430340528488159
The generated pressure mean: 0.4426359534263611
loss_pred:0.01956227608025074, decouple_loss:0.0030893755611032248
loss_pred:0.018060501664876938, decouple_loss:0.0029430128633975983
The generated pressure mean: 0.44281283020973206
loss_pred:0.019039804115891457, decouple_loss:0.003073947736993432
Iteration: 6589, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43295103311538696
loss_pred:0.01827186532318592, decouple_loss:0.0028157616034150124
The generated pressure mean: 0.4345284700393677
loss_pred:0.018318550661206245, decouple_loss:0.002858763327822089
The generated pressure mean: 0.4338669180870056
loss_pred:0.017596393823623657, decouple_loss:0.0028966772370040417
Iteration: 6590, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45343881845474243
loss_pred:0.020149797201156616, decouple_loss:0.0027187142986804247
The generated pressure mean: 0.4509480893611908
loss_pred:0.018519077450037003, decouple_loss:0.002563231624662876
The generated pressure mean: 0.45101407170295715
loss_pred:0.018595997244119644, decouple_loss:0.002700790762901306
2023-04-17 12:34:59 testing...
The generated pressure mean: 0.4181241989135742
The generated pressure mean: 0.4116840958595276
The generated pressure mean: 0.42110514640808105
loss_pred:0.03163394704461098, decouple_loss:0.003766071517020464
loss_pred:0.03283742070198059, decouple_loss:0.0035178710240870714
loss_pred:0.031306035816669464, decouple_loss:0.0038710886146873236
WV_0_PC_0_EH_1_PS_40, loss: 0.032111719250679016, avg_mse: 0.048326846212148666
current test mse: 0.048327
Iteration: 6591, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45033320784568787
loss_pred:0.017781822010874748, decouple_loss:0.0027322210371494293
The generated pressure mean: 0.45124804973602295
loss_pred:0.01890692487359047, decouple_loss:0.002829698147252202
The generated pressure mean: 0.4495968818664551
loss_pred:0.018640460446476936, decouple_loss:0.0027759585063904524
Iteration: 6592, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4537935256958008
loss_pred:0.018511779606342316, decouple_loss:0.0027899823617190123
The generated pressure mean: 0.45178696513175964
loss_pred:0.018916213884949684, decouple_loss:0.0029043916147202253
The generated pressure mean: 0.4520203769207001
loss_pred:0.018855229020118713, decouple_loss:0.0028153310995548964
Iteration: 6593, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44669488072395325
The generated pressure mean: 0.44062551856040955
loss_pred:0.02002294734120369, decouple_loss:0.002583949826657772
loss_pred:0.01944446563720703, decouple_loss:0.0025679937098175287
The generated pressure mean: 0.44509178400039673
loss_pred:0.017887519672513008, decouple_loss:0.002566110109910369
Iteration: 6594, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4238312840461731
The generated pressure mean: 0.42244213819503784
loss_pred:0.019759979099035263, decouple_loss:0.0024703550152480602
loss_pred:0.02012748271226883, decouple_loss:0.0024106199853122234
The generated pressure mean: 0.4247879385948181
loss_pred:0.01861198991537094, decouple_loss:0.0024380937684327364
Iteration: 6595, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4545630216598511
The generated pressure mean: 0.4563758075237274
loss_pred:0.021144753322005272, decouple_loss:0.0025656833313405514
loss_pred:0.01870136149227619, decouple_loss:0.0026813799049705267
The generated pressure mean: 0.45426854491233826
loss_pred:0.01835389994084835, decouple_loss:0.002546867122873664
Iteration: 6596, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.457202285528183
The generated pressure mean: 0.4519491493701935
loss_pred:0.017626574262976646, decouple_loss:0.00311547820456326
loss_pred:0.018389398232102394, decouple_loss:0.00303895166143775
The generated pressure mean: 0.4522891044616699
loss_pred:0.017891164869070053, decouple_loss:0.0031092106364667416
Iteration: 6597, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4445454180240631
The generated pressure mean: 0.4511736035346985
loss_pred:0.017364883795380592, decouple_loss:0.0026318675372749567
loss_pred:0.018344851210713387, decouple_loss:0.0026616568211466074
The generated pressure mean: 0.44463086128234863
loss_pred:0.01885487139225006, decouple_loss:0.0027014429215341806
Iteration: 6598, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4412766098976135
loss_pred:0.01796434074640274, decouple_loss:0.0029724936466664076
The generated pressure mean: 0.44212672114372253
loss_pred:0.016764286905527115, decouple_loss:0.0029326353687793016
The generated pressure mean: 0.43819865584373474
loss_pred:0.017716024070978165, decouple_loss:0.0030534069519490004
Iteration: 6599, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468080997467041
loss_pred:0.01891949027776718, decouple_loss:0.0031505099032074213
The generated pressure mean: 0.4460872411727905
loss_pred:0.01783760078251362, decouple_loss:0.003147307550534606
The generated pressure mean: 0.44635888934135437
loss_pred:0.017335310578346252, decouple_loss:0.003171164309605956
Iteration: 6600, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508760869503021
loss_pred:0.021107351407408714, decouple_loss:0.002386463573202491
The generated pressure mean: 0.4476120173931122
loss_pred:0.020631607621908188, decouple_loss:0.002531358739361167
The generated pressure mean: 0.44498729705810547
loss_pred:0.017660150304436684, decouple_loss:0.0024196053855121136
2023-04-17 12:36:54 testing...
The generated pressure mean: 0.4159375727176666
The generated pressure mean: 0.422187864780426
The generated pressure mean: 0.4243970811367035
loss_pred:0.031127948313951492, decouple_loss:0.0030504222959280014
loss_pred:0.030311575159430504, decouple_loss:0.003262629732489586
loss_pred:0.029853345826268196, decouple_loss:0.0033411795739084482
WV_0_PC_0_EH_1_PS_40, loss: 0.03059186041355133, avg_mse: 0.045178428292274475
current test mse: 0.045178
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 6601, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43598246574401855
loss_pred:0.019310567528009415, decouple_loss:0.002570125972852111
The generated pressure mean: 0.43858903646469116
loss_pred:0.018627149984240532, decouple_loss:0.002649105852469802
The generated pressure mean: 0.4390355050563812
loss_pred:0.019513098523020744, decouple_loss:0.002597601618617773
Iteration: 6602, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4420422911643982
The generated pressure mean: 0.4426502585411072
loss_pred:0.019319705665111542, decouple_loss:0.002676544012501836
loss_pred:0.02007008157670498, decouple_loss:0.0025039708707481623
The generated pressure mean: 0.4449499547481537
loss_pred:0.01873261295258999, decouple_loss:0.002563083777204156
Iteration: 6603, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4532181918621063
loss_pred:0.01886940747499466, decouple_loss:0.003012673230841756
The generated pressure mean: 0.45167845487594604
loss_pred:0.018752679228782654, decouple_loss:0.002811842132359743
The generated pressure mean: 0.4561058580875397
loss_pred:0.01831701397895813, decouple_loss:0.002776355016976595
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 6604, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503963589668274
loss_pred:0.019118832424283028, decouple_loss:0.0029940686654299498
The generated pressure mean: 0.4518609046936035
loss_pred:0.017086045816540718, decouple_loss:0.0029329571407288313
The generated pressure mean: 0.45438286662101746
loss_pred:0.017979923635721207, decouple_loss:0.0029275508131831884
Iteration: 6605, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44271841645240784
loss_pred:0.016738612204790115, decouple_loss:0.0024848312605172396
The generated pressure mean: 0.4376389980316162
loss_pred:0.018537381663918495, decouple_loss:0.002469223691150546
The generated pressure mean: 0.44454559683799744
loss_pred:0.01750428043305874, decouple_loss:0.0024942667223513126
Iteration: 6606, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475843012332916
loss_pred:0.01931135356426239, decouple_loss:0.0028539698105305433
The generated pressure mean: 0.44647204875946045
The generated pressure mean: 0.4511360824108124
loss_pred:0.020438827574253082, decouple_loss:0.0028023819904774427
loss_pred:0.01865200139582157, decouple_loss:0.0028273253701627254
Iteration: 6607, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460204243659973
loss_pred:0.018409855663776398, decouple_loss:0.0026410261634737253
The generated pressure mean: 0.44578155875205994
loss_pred:0.021592918783426285, decouple_loss:0.0025384288746863604
The generated pressure mean: 0.44414910674095154
loss_pred:0.01844201795756817, decouple_loss:0.002617199905216694
Iteration: 6608, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42840540409088135
loss_pred:0.01737668737769127, decouple_loss:0.002676115371286869
The generated pressure mean: 0.432782381772995
loss_pred:0.02007267437875271, decouple_loss:0.002812105929479003
The generated pressure mean: 0.43076202273368835
loss_pred:0.019015900790691376, decouple_loss:0.0028172857128083706
Iteration: 6609, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45007020235061646
loss_pred:0.01853988505899906, decouple_loss:0.002708234591409564
The generated pressure mean: 0.44977280497550964
loss_pred:0.02092617191374302, decouple_loss:0.002614715602248907
The generated pressure mean: 0.45145100355148315
loss_pred:0.01827048882842064, decouple_loss:0.0026428562123328447
Iteration: 6610, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4693249464035034
loss_pred:0.01919534243643284, decouple_loss:0.002633912255987525
The generated pressure mean: 0.4645666778087616
loss_pred:0.01825481466948986, decouple_loss:0.0026152993086725473
The generated pressure mean: 0.47395214438438416
loss_pred:0.020304478704929352, decouple_loss:0.002764255041256547
2023-04-17 12:39:27 testing...
The generated pressure mean: 0.4141204059123993
The generated pressure mean: 0.42153167724609375
The generated pressure mean: 0.4243100583553314
loss_pred:0.03196945786476135, decouple_loss:0.0028884385246783495
loss_pred:0.03093305416405201, decouple_loss:0.003124873386695981
loss_pred:0.030688446015119553, decouple_loss:0.0032514960039407015
WV_0_PC_0_EH_1_PS_40, loss: 0.03135140240192413, avg_mse: 0.046998441219329834
current test mse: 0.046998
Iteration: 6611, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44830322265625
loss_pred:0.017106274142861366, decouple_loss:0.0024283290840685368
The generated pressure mean: 0.4460061490535736
loss_pred:0.018917933106422424, decouple_loss:0.0023785694502294064
The generated pressure mean: 0.4438106417655945
loss_pred:0.018895244225859642, decouple_loss:0.0024020399432629347
Iteration: 6612, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4276530146598816
loss_pred:0.019203519448637962, decouple_loss:0.0029495623894035816
The generated pressure mean: 0.43223145604133606
loss_pred:0.016707297414541245, decouple_loss:0.002987150102853775
The generated pressure mean: 0.4325670003890991
loss_pred:0.018005313351750374, decouple_loss:0.0030031625647097826
Iteration: 6613, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4421123266220093
loss_pred:0.017970426008105278, decouple_loss:0.003454474499449134
The generated pressure mean: 0.43888938426971436
loss_pred:0.019801832735538483, decouple_loss:0.003413929371163249
The generated pressure mean: 0.44362327456474304
loss_pred:0.01689462922513485, decouple_loss:0.0032871973235160112
Iteration: 6614, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45771491527557373
loss_pred:0.0189747866243124, decouple_loss:0.0024714574683457613
The generated pressure mean: 0.4574272930622101
loss_pred:0.019186604768037796, decouple_loss:0.0026410387363284826
The generated pressure mean: 0.4538279175758362
loss_pred:0.018820758908987045, decouple_loss:0.0024723252281546593
Iteration: 6615, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473539888858795
loss_pred:0.018520023673772812, decouple_loss:0.003237965749576688
The generated pressure mean: 0.44563961029052734
loss_pred:0.020238682627677917, decouple_loss:0.0031297653913497925
The generated pressure mean: 0.44526970386505127
loss_pred:0.01721801608800888, decouple_loss:0.0032931831665337086
Iteration: 6616, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4439411461353302
loss_pred:0.018619535490870476, decouple_loss:0.003308443119749427
The generated pressure mean: 0.4426541030406952
loss_pred:0.018393859267234802, decouple_loss:0.0032220487482845783
The generated pressure mean: 0.44752365350723267
loss_pred:0.017979148775339127, decouple_loss:0.0031790935900062323
Iteration: 6617, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44983920454978943
loss_pred:0.018490027636289597, decouple_loss:0.0032415662426501513
The generated pressure mean: 0.44927978515625
loss_pred:0.01777106523513794, decouple_loss:0.0033072554506361485
The generated pressure mean: 0.4505084455013275
loss_pred:0.018775325268507004, decouple_loss:0.003275128547102213
Iteration: 6618, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466717839241028
loss_pred:0.019647235050797462, decouple_loss:0.002714485162869096
The generated pressure mean: 0.45047512650489807
loss_pred:0.01811305247247219, decouple_loss:0.0028135839384049177
The generated pressure mean: 0.4503270387649536
loss_pred:0.018877629190683365, decouple_loss:0.0027615567669272423
Iteration: 6619, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4538293182849884
loss_pred:0.018689526244997978, decouple_loss:0.0032085839193314314
The generated pressure mean: 0.4470345973968506
loss_pred:0.019432224333286285, decouple_loss:0.0032913556788116693
The generated pressure mean: 0.4526257812976837
loss_pred:0.018091458827257156, decouple_loss:0.0032808794640004635
Iteration: 6620, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44502097368240356
loss_pred:0.019222062081098557, decouple_loss:0.002784219104796648
The generated pressure mean: 0.4448729455471039
loss_pred:0.016810450702905655, decouple_loss:0.002736346796154976
The generated pressure mean: 0.4430094361305237
loss_pred:0.020062746480107307, decouple_loss:0.0028210189193487167
2023-04-17 12:41:20 testing...
The generated pressure mean: 0.41465523838996887
The generated pressure mean: 0.42249763011932373
loss_pred:0.03388739749789238, decouple_loss:0.0033908190671354532
The generated pressure mean: 0.42551687359809875
loss_pred:0.03228338807821274, decouple_loss:0.0035480831284075975
loss_pred:0.03220628201961517, decouple_loss:0.003617249196395278
WV_0_PC_0_EH_1_PS_40, loss: 0.032968293875455856, avg_mse: 0.05037490651011467
current test mse: 0.050375
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 6621, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44341912865638733
loss_pred:0.019137581810355186, decouple_loss:0.002871511969715357
The generated pressure mean: 0.4466872811317444
loss_pred:0.017849285155534744, decouple_loss:0.00292227603495121
The generated pressure mean: 0.4442451596260071
loss_pred:0.020199786871671677, decouple_loss:0.0030284826643764973
Iteration: 6622, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4405389130115509
The generated pressure mean: 0.4478755593299866
loss_pred:0.019668245688080788, decouple_loss:0.003188733709976077
loss_pred:0.01807560957968235, decouple_loss:0.0030601422768086195
The generated pressure mean: 0.4387994408607483
loss_pred:0.018832989037036896, decouple_loss:0.003207126632332802
Iteration: 6623, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45074760913848877The generated pressure mean: 0.4489544630050659
loss_pred:0.01857265830039978, decouple_loss:0.0028908599633723497
loss_pred:0.018243713304400444, decouple_loss:0.0028349391650408506
The generated pressure mean: 0.4508083164691925
loss_pred:0.02012452483177185, decouple_loss:0.0029194115195423365
Iteration: 6624, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44944027066230774
The generated pressure mean: 0.4483022391796112
loss_pred:0.019467590376734734, decouple_loss:0.0027823224663734436
loss_pred:0.01799038238823414, decouple_loss:0.002787180943414569
The generated pressure mean: 0.44901660084724426
loss_pred:0.020092954859137535, decouple_loss:0.0028430158272385597
Iteration: 6625, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44913381338119507
loss_pred:0.019064487889409065, decouple_loss:0.003239760175347328
The generated pressure mean: 0.4462953805923462
loss_pred:0.020879969000816345, decouple_loss:0.003402329981327057
The generated pressure mean: 0.44988885521888733
loss_pred:0.019354507327079773, decouple_loss:0.003283475525677204
Iteration: 6626, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4441318213939667
loss_pred:0.019249755889177322, decouple_loss:0.002788463607430458
The generated pressure mean: 0.4413137137889862
loss_pred:0.018808845430612564, decouple_loss:0.002867687726393342
The generated pressure mean: 0.43700507283210754
loss_pred:0.019218018278479576, decouple_loss:0.0028721734415739775
Iteration: 6627, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44925156235694885
loss_pred:0.018365096300840378, decouple_loss:0.0029224816244095564
The generated pressure mean: 0.4481549859046936
loss_pred:0.016975531354546547, decouple_loss:0.002858015475794673
The generated pressure mean: 0.44932806491851807
loss_pred:0.018946567550301552, decouple_loss:0.002752174623310566
Iteration: 6628, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45311111211776733
loss_pred:0.017788054421544075, decouple_loss:0.0028853658586740494
The generated pressure mean: 0.4521399736404419
loss_pred:0.017554977908730507, decouple_loss:0.002968801651149988
The generated pressure mean: 0.4573439359664917
loss_pred:0.0207687821239233, decouple_loss:0.002974351868033409
Iteration: 6629, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4436917006969452
loss_pred:0.01921512931585312, decouple_loss:0.002955483505502343
The generated pressure mean: 0.447520911693573
loss_pred:0.018300319090485573, decouple_loss:0.0028624043334275484
The generated pressure mean: 0.4464600682258606
loss_pred:0.017599033191800117, decouple_loss:0.002830203389748931
Iteration: 6630, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4440925717353821
The generated pressure mean: 0.4423404335975647
loss_pred:0.01929129660129547, decouple_loss:0.0030001134146004915
loss_pred:0.01710420474410057, decouple_loss:0.003163321176543832
The generated pressure mean: 0.4390431344509125
loss_pred:0.019035354256629944, decouple_loss:0.003050317754969001
2023-04-17 12:43:51 testing...
The generated pressure mean: 0.4146024286746979
The generated pressure mean: 0.4220311939716339
The generated pressure mean: 0.4250966012477875
loss_pred:0.03292316198348999, decouple_loss:0.0032110526226460934
loss_pred:0.03162223473191261, decouple_loss:0.003399371402338147
loss_pred:0.03140370920300484, decouple_loss:0.0033839065581560135
WV_0_PC_0_EH_1_PS_40, loss: 0.03214960917830467, avg_mse: 0.048429813235998154
current test mse: 0.04843
Iteration: 6631, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4436638653278351
loss_pred:0.01890099048614502, decouple_loss:0.0024858317337930202
The generated pressure mean: 0.44498950242996216
loss_pred:0.018340636044740677, decouple_loss:0.0026713565457612276
The generated pressure mean: 0.44076308608055115
loss_pred:0.018249135464429855, decouple_loss:0.0026205279864370823
Iteration: 6632, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4511144161224365
loss_pred:0.02203015610575676, decouple_loss:0.002571200020611286
The generated pressure mean: 0.4560827910900116
loss_pred:0.0165461003780365, decouple_loss:0.002660662867128849
The generated pressure mean: 0.45519596338272095
loss_pred:0.017804181203246117, decouple_loss:0.002638422418385744
Iteration: 6633, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4445159435272217
loss_pred:0.01747451163828373, decouple_loss:0.0026117628440260887
The generated pressure mean: 0.45014452934265137
loss_pred:0.018597444519400597, decouple_loss:0.002801832975819707
The generated pressure mean: 0.4484615623950958
loss_pred:0.018050573766231537, decouple_loss:0.0026384969241917133
Iteration: 6634, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44885730743408203
loss_pred:0.019126681610941887, decouple_loss:0.0026792895514518023
The generated pressure mean: 0.4487987756729126
loss_pred:0.018879801034927368, decouple_loss:0.002647093031555414
The generated pressure mean: 0.4451914429664612
loss_pred:0.018260318785905838, decouple_loss:0.0026294400449842215
Iteration: 6635, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44259679317474365
loss_pred:0.019690677523612976, decouple_loss:0.002773579675704241
The generated pressure mean: 0.4445003569126129
loss_pred:0.0165727399289608, decouple_loss:0.0026984596624970436
The generated pressure mean: 0.4429160952568054
loss_pred:0.017422499135136604, decouple_loss:0.002732084598392248
Iteration: 6636, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4423368275165558
loss_pred:0.018730327486991882, decouple_loss:0.0028337968979030848
The generated pressure mean: 0.44488394260406494
loss_pred:0.020056091248989105, decouple_loss:0.0030192071571946144
The generated pressure mean: 0.4420170187950134
loss_pred:0.017711829394102097, decouple_loss:0.002869316143915057
Iteration: 6637, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44915103912353516
loss_pred:0.018336517736315727, decouple_loss:0.0028401827439665794
The generated pressure mean: 0.44601795077323914
loss_pred:0.018015114590525627, decouple_loss:0.002881821012124419
The generated pressure mean: 0.4517003297805786
loss_pred:0.01985030248761177, decouple_loss:0.0028333421796560287
Iteration: 6638, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4424111247062683
loss_pred:0.019297529011964798, decouple_loss:0.0027411160990595818
The generated pressure mean: 0.44821736216545105
loss_pred:0.017553655430674553, decouple_loss:0.0027555765118449926
The generated pressure mean: 0.4461272954940796
loss_pred:0.01774848811328411, decouple_loss:0.0025478233583271503
Iteration: 6639, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45158204436302185
loss_pred:0.01846718229353428, decouple_loss:0.0030042489524930716
The generated pressure mean: 0.44756078720092773
loss_pred:0.016865773126482964, decouple_loss:0.002954467199742794
The generated pressure mean: 0.45191943645477295
loss_pred:0.02766193449497223, decouple_loss:0.003033397486433387
Iteration: 6640, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.41736793518066406
loss_pred:0.018436159938573837, decouple_loss:0.0026520797982811928
The generated pressure mean: 0.42176681756973267
loss_pred:0.020145976915955544, decouple_loss:0.0026551643386483192
The generated pressure mean: 0.42520809173583984
loss_pred:0.0203815046697855, decouple_loss:0.0026519212406128645
2023-04-17 12:45:46 testing...
The generated pressure mean: 0.4090050160884857
The generated pressure mean: 0.41340118646621704
The generated pressure mean: 0.4146864116191864
loss_pred:0.04034421220421791, decouple_loss:0.00339025747962296
loss_pred:0.03939506784081459, decouple_loss:0.0035749319940805435
loss_pred:0.03863903507590294, decouple_loss:0.003665478201583028
WV_0_PC_0_EH_1_PS_40, loss: 0.03963661938905716, avg_mse: 0.06227358058094978
current test mse: 0.062274
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 6641, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4602397084236145
loss_pred:0.019774561747908592, decouple_loss:0.002993783913552761
The generated pressure mean: 0.4575794041156769
loss_pred:0.01887676492333412, decouple_loss:0.0029856606852263212
The generated pressure mean: 0.4600387513637543
loss_pred:0.017778148874640465, decouple_loss:0.0029343939386308193
Iteration: 6642, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4586045444011688
The generated pressure mean: 0.4553835093975067
loss_pred:0.019795367494225502, decouple_loss:0.0031750404741615057
loss_pred:0.02053609862923622, decouple_loss:0.003153176512569189
The generated pressure mean: 0.4600830376148224
loss_pred:0.018015781417489052, decouple_loss:0.003133387304842472
Iteration: 6643, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43018174171447754
The generated pressure mean: 0.4320090711116791
loss_pred:0.021182939410209656, decouple_loss:0.002886286238208413
loss_pred:0.019750481471419334, decouple_loss:0.002961899386718869
The generated pressure mean: 0.4265342056751251
loss_pred:0.020720617845654488, decouple_loss:0.0029232879169285297
Iteration: 6644, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4416791498661041
The generated pressure mean: 0.4447824954986572
loss_pred:0.02017117291688919, decouple_loss:0.003314313245937228
loss_pred:0.01800774410367012, decouple_loss:0.003068816615268588
The generated pressure mean: 0.4476844072341919
loss_pred:0.018791809678077698, decouple_loss:0.003173980861902237
Iteration: 6645, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.464709997177124
The generated pressure mean: 0.46108487248420715
loss_pred:0.018482070416212082, decouple_loss:0.003009022679179907
loss_pred:0.017701387405395508, decouple_loss:0.0030469975899904966
The generated pressure mean: 0.4550461173057556
loss_pred:0.017596369609236717, decouple_loss:0.003156157210469246
Iteration: 6646, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499596953392029The generated pressure mean: 0.45327743887901306
loss_pred:0.019067522138357162, decouple_loss:0.0035538077354431152
loss_pred:0.019540797919034958, decouple_loss:0.0035626287572085857
The generated pressure mean: 0.4558517336845398
loss_pred:0.020127704367041588, decouple_loss:0.003559353295713663
Iteration: 6647, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4344714283943176
The generated pressure mean: 0.4338238835334778
loss_pred:0.018419181928038597, decouple_loss:0.00336882914416492
loss_pred:0.01871279627084732, decouple_loss:0.0033963460009545088
The generated pressure mean: 0.43593829870224
loss_pred:0.018609747290611267, decouple_loss:0.00343500473536551
Iteration: 6648, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44477149844169617
loss_pred:0.01723300665616989, decouple_loss:0.0031164465472102165
The generated pressure mean: 0.44185522198677063
loss_pred:0.017687760293483734, decouple_loss:0.0030079251155257225
The generated pressure mean: 0.4426170587539673
loss_pred:0.02005685493350029, decouple_loss:0.00293845240958035
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 6649, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44744765758514404
loss_pred:0.01976761966943741, decouple_loss:0.0035766460932791233
The generated pressure mean: 0.4435061514377594
loss_pred:0.01877366006374359, decouple_loss:0.0035748512018471956
The generated pressure mean: 0.44625306129455566
loss_pred:0.018015051260590553, decouple_loss:0.0034660876262933016
Iteration: 6650, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470905661582947
loss_pred:0.019947409629821777, decouple_loss:0.003347943536937237
The generated pressure mean: 0.44759777188301086
loss_pred:0.017951663583517075, decouple_loss:0.0032453995663672686
The generated pressure mean: 0.44847580790519714
loss_pred:0.01952683925628662, decouple_loss:0.003403047565370798
2023-04-17 12:48:15 testing...
The generated pressure mean: 0.4142821729183197
The generated pressure mean: 0.42267176508903503
loss_pred:0.034663572907447815, decouple_loss:0.0038934468757361174
The generated pressure mean: 0.4255896210670471
loss_pred:0.03320077806711197, decouple_loss:0.004199972841888666
loss_pred:0.03291012719273567, decouple_loss:0.004249208606779575
WV_0_PC_0_EH_1_PS_40, loss: 0.03379720449447632, avg_mse: 0.05175846442580223
current test mse: 0.051758
Iteration: 6651, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474911093711853
loss_pred:0.019691824913024902, decouple_loss:0.003435224760323763
The generated pressure mean: 0.45145317912101746
loss_pred:0.017290279269218445, decouple_loss:0.0032818191684782505
The generated pressure mean: 0.44319313764572144
loss_pred:0.019903628155589104, decouple_loss:0.0033741160295903683
Iteration: 6652, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4424697756767273
loss_pred:0.017001040279865265, decouple_loss:0.0030933497473597527
The generated pressure mean: 0.44131362438201904
loss_pred:0.018680943176150322, decouple_loss:0.0031652471516281366
The generated pressure mean: 0.43994492292404175
loss_pred:0.01801476627588272, decouple_loss:0.003108179895207286
Iteration: 6653, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44391632080078125
loss_pred:0.01953151822090149, decouple_loss:0.0033672666177153587
The generated pressure mean: 0.44374099373817444
loss_pred:0.017444508150219917, decouple_loss:0.0032543865963816643
The generated pressure mean: 0.44572681188583374
loss_pred:0.01792621985077858, decouple_loss:0.0032916166819632053
Iteration: 6654, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4595203995704651
loss_pred:0.018822988495230675, decouple_loss:0.0034011690877377987
The generated pressure mean: 0.4568122327327728
loss_pred:0.019763577729463577, decouple_loss:0.0034360357094556093
The generated pressure mean: 0.45776236057281494
loss_pred:0.019013335928320885, decouple_loss:0.0032487015705555677
Iteration: 6655, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44741931557655334
loss_pred:0.017529092729091644, decouple_loss:0.003531666472554207
The generated pressure mean: 0.44413623213768005
loss_pred:0.01821293495595455, decouple_loss:0.0033412675838917494
The generated pressure mean: 0.4418998062610626
loss_pred:0.016915684565901756, decouple_loss:0.0033843351993709803
Iteration: 6656, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43714383244514465
loss_pred:0.018925240263342857, decouple_loss:0.003354511922225356
The generated pressure mean: 0.4374333918094635
The generated pressure mean: 0.4359401762485504
loss_pred:0.018926557153463364, decouple_loss:0.0034474723506718874
loss_pred:0.017711671069264412, decouple_loss:0.00335732102394104
Iteration: 6657, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487047791481018
loss_pred:0.020583895966410637, decouple_loss:0.003146122908219695
The generated pressure mean: 0.44134095311164856
loss_pred:0.017594516277313232, decouple_loss:0.0031079764012247324
The generated pressure mean: 0.4445088505744934
loss_pred:0.01883695088326931, decouple_loss:0.003092666855081916
Iteration: 6658, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44972339272499084
loss_pred:0.01864692196249962, decouple_loss:0.0034538886975497007
The generated pressure mean: 0.4491179287433624
loss_pred:0.018872035667300224, decouple_loss:0.0035474940668791533
The generated pressure mean: 0.44738686084747314
loss_pred:0.019267115741968155, decouple_loss:0.003468088572844863
Iteration: 6659, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44411274790763855
loss_pred:0.01866227760910988, decouple_loss:0.0032873291056603193
The generated pressure mean: 0.44771409034729004
loss_pred:0.01729770563542843, decouple_loss:0.0033279431518167257
The generated pressure mean: 0.4444485902786255
loss_pred:0.017887644469738007, decouple_loss:0.003304010257124901
Iteration: 6660, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4438115358352661
loss_pred:0.01704154908657074, decouple_loss:0.0031110059935599566
The generated pressure mean: 0.44829002022743225
loss_pred:0.020227450877428055, decouple_loss:0.00317176035605371
The generated pressure mean: 0.4471285045146942
loss_pred:0.018494244664907455, decouple_loss:0.0031999018974602222
2023-04-17 12:50:08 testing...
The generated pressure mean: 0.41381141543388367
The generated pressure mean: 0.4207902252674103
loss_pred:0.032074857503175735, decouple_loss:0.0038136912044137716
The generated pressure mean: 0.4240170419216156
loss_pred:0.03113069385290146, decouple_loss:0.003972189500927925
loss_pred:0.0308405552059412, decouple_loss:0.004003183916211128
WV_0_PC_0_EH_1_PS_40, loss: 0.031545188277959824, avg_mse: 0.04736753925681114
current test mse: 0.047368
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 6661, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44776448607444763
The generated pressure mean: 0.45193788409233093
loss_pred:0.017331864684820175, decouple_loss:0.0033485270105302334
loss_pred:0.017907144501805305, decouple_loss:0.003383640432730317
The generated pressure mean: 0.4455699324607849
loss_pred:0.01911916956305504, decouple_loss:0.0032496051862835884
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 6662, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464063048362732
The generated pressure mean: 0.44350719451904297
loss_pred:0.01849500462412834, decouple_loss:0.003120044944807887
loss_pred:0.019250402227044106, decouple_loss:0.00301471003331244
The generated pressure mean: 0.44564464688301086
loss_pred:0.017725134268403053, decouple_loss:0.002988706808537245
Iteration: 6663, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4432426691055298
The generated pressure mean: 0.4461729824542999
loss_pred:0.01734057627618313, decouple_loss:0.003092697821557522
loss_pred:0.018372729420661926, decouple_loss:0.0030449412297457457
The generated pressure mean: 0.4481237530708313
loss_pred:0.017658744007349014, decouple_loss:0.0030719179194420576
Iteration: 6664, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44782909750938416
The generated pressure mean: 0.44687968492507935
loss_pred:0.01764514483511448, decouple_loss:0.0031368990894407034
loss_pred:0.018775977194309235, decouple_loss:0.003038354916498065
The generated pressure mean: 0.44710788130760193
loss_pred:0.01761295087635517, decouple_loss:0.00301507581025362
Iteration: 6665, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490698575973511
The generated pressure mean: 0.44676509499549866
loss_pred:0.017592448741197586, decouple_loss:0.002609978197142482
loss_pred:0.019068749621510506, decouple_loss:0.0025752978399395943
The generated pressure mean: 0.44645145535469055
loss_pred:0.017849545925855637, decouple_loss:0.0025859049055725336
Iteration: 6666, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4418245851993561
The generated pressure mean: 0.4437970519065857
loss_pred:0.020400846377015114, decouple_loss:0.0030424422584474087
loss_pred:0.020500939339399338, decouple_loss:0.00296819512732327
The generated pressure mean: 0.4410746693611145
loss_pred:0.018472881987690926, decouple_loss:0.003023173427209258
Iteration: 6667, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43557238578796387
The generated pressure mean: 0.4367715120315552
loss_pred:0.021875925362110138, decouple_loss:0.0027570431120693684
loss_pred:0.018319260329008102, decouple_loss:0.002699078293517232
The generated pressure mean: 0.440329909324646
loss_pred:0.01669023558497429, decouple_loss:0.002712823450565338
Iteration: 6668, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45247966051101685The generated pressure mean: 0.45271599292755127
loss_pred:0.017560362815856934, decouple_loss:0.002780178328976035
loss_pred:0.018688002601265907, decouple_loss:0.0026917082723230124
The generated pressure mean: 0.45575466752052307
loss_pred:0.016916541382670403, decouple_loss:0.0027998436708003283
Iteration: 6669, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45799630880355835
The generated pressure mean: 0.4586818814277649
loss_pred:0.018088461831212044, decouple_loss:0.002589812967926264
loss_pred:0.01811979152262211, decouple_loss:0.0027040664572268724
The generated pressure mean: 0.4603863060474396
loss_pred:0.017296724021434784, decouple_loss:0.0026993826031684875
Iteration: 6670, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44188830256462097
loss_pred:0.019196024164557457, decouple_loss:0.0027442630380392075
The generated pressure mean: 0.4456018805503845
loss_pred:0.017718372866511345, decouple_loss:0.0026491417083889246
The generated pressure mean: 0.44286713004112244
loss_pred:0.018472541123628616, decouple_loss:0.002680776407942176
2023-04-17 12:52:40 testing...
The generated pressure mean: 0.41565820574760437
The generated pressure mean: 0.4232770502567291
loss_pred:0.03187079727649689, decouple_loss:0.003298346186056733
The generated pressure mean: 0.42678388953208923
loss_pred:0.030751410871744156, decouple_loss:0.003465835703536868
loss_pred:0.03062852844595909, decouple_loss:0.00359560688957572
WV_0_PC_0_EH_1_PS_40, loss: 0.03125624358654022, avg_mse: 0.04698837921023369
current test mse: 0.046988
Iteration: 6671, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44208064675331116
loss_pred:0.01890738308429718, decouple_loss:0.002914074109867215
The generated pressure mean: 0.4409366846084595
loss_pred:0.0186553206294775, decouple_loss:0.0028677252121269703
The generated pressure mean: 0.43798592686653137
loss_pred:0.019158104434609413, decouple_loss:0.002982881385833025
Iteration: 6672, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447954922914505
The generated pressure mean: 0.44765475392341614
loss_pred:0.017259102314710617, decouple_loss:0.002492438303306699
loss_pred:0.019288968294858932, decouple_loss:0.0027327609714120626
The generated pressure mean: 0.44782555103302
loss_pred:0.020977426320314407, decouple_loss:0.0026167570613324642
Iteration: 6673, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43974390625953674
loss_pred:0.017342401668429375, decouple_loss:0.002801578026264906
The generated pressure mean: 0.4419777989387512
loss_pred:0.018355337902903557, decouple_loss:0.0027357342187315226
The generated pressure mean: 0.44330084323883057
loss_pred:0.01768973097205162, decouple_loss:0.0028110858984291553
Iteration: 6674, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476505219936371
loss_pred:0.017969844862818718, decouple_loss:0.002619078615680337
The generated pressure mean: 0.45220503211021423
loss_pred:0.01655322127044201, decouple_loss:0.0025122705847024918
The generated pressure mean: 0.45389580726623535
loss_pred:0.01731112413108349, decouple_loss:0.002656875178217888
Iteration: 6675, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45533862709999084
loss_pred:0.018278883770108223, decouple_loss:0.002577272243797779
The generated pressure mean: 0.45277056097984314
loss_pred:0.01842033863067627, decouple_loss:0.002430807799100876
The generated pressure mean: 0.4470005929470062
loss_pred:0.017809556797146797, decouple_loss:0.0025585158728063107
Iteration: 6676, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4409829080104828
loss_pred:0.01664837636053562, decouple_loss:0.003306831931695342
The generated pressure mean: 0.444452702999115
loss_pred:0.01873498596251011, decouple_loss:0.0032335116993635893
The generated pressure mean: 0.44847986102104187
loss_pred:0.01827971823513508, decouple_loss:0.0034759193658828735
Iteration: 6677, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.439885675907135
loss_pred:0.019168473780155182, decouple_loss:0.0029112049378454685
The generated pressure mean: 0.44002825021743774
loss_pred:0.017064303159713745, decouple_loss:0.0028321717400103807
The generated pressure mean: 0.44046834111213684
loss_pred:0.017637941986322403, decouple_loss:0.00281936745159328
Iteration: 6678, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446572870016098
loss_pred:0.018560267984867096, decouple_loss:0.0027892934158444405
The generated pressure mean: 0.4455133378505707
loss_pred:0.02078905887901783, decouple_loss:0.002619800390675664
The generated pressure mean: 0.45168548822402954
loss_pred:0.016936616972088814, decouple_loss:0.0025965427048504353
Iteration: 6679, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.443947970867157
loss_pred:0.019041307270526886, decouple_loss:0.0029209800995886326
The generated pressure mean: 0.44369322061538696
loss_pred:0.018385767936706543, decouple_loss:0.0028488750103861094
The generated pressure mean: 0.4413011968135834
loss_pred:0.019434088841080666, decouple_loss:0.0028560629580169916
Iteration: 6680, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4520586431026459
loss_pred:0.01760333590209484, decouple_loss:0.0027516211848706007
The generated pressure mean: 0.4552924931049347
loss_pred:0.018053151667118073, decouple_loss:0.002892978023737669
The generated pressure mean: 0.45409095287323
loss_pred:0.01866109110414982, decouple_loss:0.0027782507240772247
2023-04-17 12:54:33 testing...
The generated pressure mean: 0.4185141921043396
The generated pressure mean: 0.4118134379386902
The generated pressure mean: 0.42182978987693787
loss_pred:0.033000215888023376, decouple_loss:0.0037690438330173492
loss_pred:0.03427191451191902, decouple_loss:0.0034260908141732216
loss_pred:0.032440654933452606, decouple_loss:0.003934632521122694
WV_0_PC_0_EH_1_PS_40, loss: 0.03342309221625328, avg_mse: 0.051041167229413986
current test mse: 0.051041
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 6681, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45319968461990356
loss_pred:0.01713411696255207, decouple_loss:0.0028293707873672247
The generated pressure mean: 0.457839697599411
loss_pred:0.019112946465611458, decouple_loss:0.002777715213596821
The generated pressure mean: 0.45503678917884827
loss_pred:0.017646346241235733, decouple_loss:0.002761353738605976
Iteration: 6682, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43704473972320557The generated pressure mean: 0.43885189294815063
loss_pred:0.017944736406207085, decouple_loss:0.0027126669883728027loss_pred:0.018435100093483925, decouple_loss:0.002824070630595088
The generated pressure mean: 0.43890058994293213
loss_pred:0.020241789519786835, decouple_loss:0.0028262450359761715
Iteration: 6683, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4432576596736908
loss_pred:0.018112534657120705, decouple_loss:0.0026765286456793547
The generated pressure mean: 0.44346290826797485
loss_pred:0.01799934171140194, decouple_loss:0.002636195393279195
The generated pressure mean: 0.4465314447879791
loss_pred:0.019308777526021004, decouple_loss:0.002525819232687354
Iteration: 6684, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44697654247283936
loss_pred:0.01741643436253071, decouple_loss:0.0026482646353542805
The generated pressure mean: 0.443015992641449
loss_pred:0.01914195343852043, decouple_loss:0.00285867927595973
The generated pressure mean: 0.45405319333076477
loss_pred:0.019685769453644753, decouple_loss:0.002786301774904132
Iteration: 6685, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4424689710140228
loss_pred:0.018087053671479225, decouple_loss:0.0031295379158109426
The generated pressure mean: 0.4424014687538147
loss_pred:0.018483659252524376, decouple_loss:0.0032441490329802036
The generated pressure mean: 0.44108477234840393
loss_pred:0.020455021411180496, decouple_loss:0.0032624113373458385
Iteration: 6686, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44562381505966187
loss_pred:0.018927674740552902, decouple_loss:0.002852140460163355
The generated pressure mean: 0.4426622986793518
loss_pred:0.018366582691669464, decouple_loss:0.0028912152629345655
The generated pressure mean: 0.4490841031074524
loss_pred:0.019314412027597427, decouple_loss:0.0030897429678589106
Iteration: 6687, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.445221483707428
loss_pred:0.01945609599351883, decouple_loss:0.002864140085875988
The generated pressure mean: 0.4446978271007538
loss_pred:0.019788505509495735, decouple_loss:0.003103092545643449
The generated pressure mean: 0.44221189618110657
loss_pred:0.018150098621845245, decouple_loss:0.0027680406346917152
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 6688, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44633227586746216
loss_pred:0.02060808055102825, decouple_loss:0.002714129164814949
The generated pressure mean: 0.4454467296600342
loss_pred:0.017767077311873436, decouple_loss:0.002735209185630083
The generated pressure mean: 0.448612779378891
loss_pred:0.019215179607272148, decouple_loss:0.00264919875189662
Iteration: 6689, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44018813967704773
loss_pred:0.01985454186797142, decouple_loss:0.002783291507512331
The generated pressure mean: 0.44279855489730835
loss_pred:0.017502928152680397, decouple_loss:0.0027063905727118254
The generated pressure mean: 0.4474215507507324
loss_pred:0.018482938408851624, decouple_loss:0.0028189499862492085
Iteration: 6690, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4512404203414917
loss_pred:0.019457919523119926, decouple_loss:0.0026598304975777864
The generated pressure mean: 0.45270076394081116
loss_pred:0.019347699359059334, decouple_loss:0.0027114786207675934
The generated pressure mean: 0.4569563567638397
loss_pred:0.019079457968473434, decouple_loss:0.002569061005488038
2023-04-17 12:57:07 testing...
The generated pressure mean: 0.42110055685043335
The generated pressure mean: 0.4130399823188782
The generated pressure mean: 0.42444953322410583
loss_pred:0.03223574906587601, decouple_loss:0.0036646893713623285
loss_pred:0.03340713679790497, decouple_loss:0.003383922390639782
loss_pred:0.032075587660074234, decouple_loss:0.003788555506616831
WV_0_PC_0_EH_1_PS_40, loss: 0.03275344520807266, avg_mse: 0.04996080324053764
current test mse: 0.049961
Iteration: 6691, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44758111238479614
The generated pressure mean: 0.4481712579727173
loss_pred:0.018537554889917374, decouple_loss:0.002884818473830819
loss_pred:0.019304146990180016, decouple_loss:0.002955743810161948
The generated pressure mean: 0.44325321912765503
loss_pred:0.018375057727098465, decouple_loss:0.002917354926466942
Iteration: 6692, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44261616468429565
The generated pressure mean: 0.43812304735183716
loss_pred:0.01903255097568035, decouple_loss:0.002411861438304186
loss_pred:0.017264455556869507, decouple_loss:0.00245352229103446
The generated pressure mean: 0.44083285331726074
loss_pred:0.018901292234659195, decouple_loss:0.0024819006212055683
Iteration: 6693, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43723639845848083
The generated pressure mean: 0.4421526789665222
loss_pred:0.01778978295624256, decouple_loss:0.003242095001041889
loss_pred:0.01765964739024639, decouple_loss:0.0030061020515859127
The generated pressure mean: 0.43834635615348816
loss_pred:0.01706148311495781, decouple_loss:0.0034503822680562735
Iteration: 6694, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481693506240845
loss_pred:0.01883062906563282, decouple_loss:0.0036334111355245113
The generated pressure mean: 0.44905561208724976
loss_pred:0.01909528113901615, decouple_loss:0.0038354576099663973
The generated pressure mean: 0.4483463168144226
loss_pred:0.018513163551688194, decouple_loss:0.003922890871763229
Iteration: 6695, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4557187259197235The generated pressure mean: 0.4489959478378296
loss_pred:0.018885107710957527, decouple_loss:0.003197271376848221
loss_pred:0.019730975851416588, decouple_loss:0.003155482467263937
The generated pressure mean: 0.4526330232620239
loss_pred:0.01735784113407135, decouple_loss:0.0031840461306273937
Iteration: 6696, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43876510858535767
loss_pred:0.01896844431757927, decouple_loss:0.004015590064227581
The generated pressure mean: 0.44404834508895874
loss_pred:0.017462125048041344, decouple_loss:0.004249782767146826
The generated pressure mean: 0.44114550948143005
loss_pred:0.017286701127886772, decouple_loss:0.004564345348626375
Iteration: 6697, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447385311126709
The generated pressure mean: 0.44066113233566284
loss_pred:0.01838202029466629, decouple_loss:0.0034819680731743574
loss_pred:0.017760662361979485, decouple_loss:0.003526153275743127
The generated pressure mean: 0.44586050510406494
loss_pred:0.01736428216099739, decouple_loss:0.0035222796723246574
Iteration: 6698, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45573869347572327
The generated pressure mean: 0.455390989780426
loss_pred:0.018101703375577927, decouple_loss:0.0033221570774912834
loss_pred:0.0177756380289793, decouple_loss:0.0033184397034347057
The generated pressure mean: 0.45306041836738586
loss_pred:0.020049922168254852, decouple_loss:0.003299998352304101
Iteration: 6699, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493870735168457
loss_pred:0.017371375113725662, decouple_loss:0.003140105167403817
The generated pressure mean: 0.4441314935684204
loss_pred:0.01773902401328087, decouple_loss:0.003353517036885023
The generated pressure mean: 0.4421458840370178
loss_pred:0.01851765625178814, decouple_loss:0.0033721132203936577
Iteration: 6700, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43771204352378845
loss_pred:0.019742416217923164, decouple_loss:0.0029375527519732714
The generated pressure mean: 0.4356464445590973
loss_pred:0.01930856518447399, decouple_loss:0.0029215500690042973
The generated pressure mean: 0.44364920258522034
loss_pred:0.019873347133398056, decouple_loss:0.002873748540878296
2023-04-17 12:59:01 testing...
The generated pressure mean: 0.42129895091056824
The generated pressure mean: 0.4146895110607147
loss_pred:0.030470378696918488, decouple_loss:0.0032699049916118383
The generated pressure mean: 0.4238477647304535
loss_pred:0.0314847007393837, decouple_loss:0.0029664216563105583
loss_pred:0.030266456305980682, decouple_loss:0.00336660398170352
WV_0_PC_0_EH_1_PS_40, loss: 0.030900564044713974, avg_mse: 0.04598022624850273
current test mse: 0.04598
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 6701, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43965262174606323
loss_pred:0.019022328779101372, decouple_loss:0.002599369501695037
The generated pressure mean: 0.44147878885269165
The generated pressure mean: 0.4408916234970093loss_pred:0.017932461574673653, decouple_loss:0.0025878578890115023
loss_pred:0.01836962252855301, decouple_loss:0.0025629957672208548
Iteration: 6702, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4510537087917328
loss_pred:0.017757119610905647, decouple_loss:0.002868893789127469
The generated pressure mean: 0.45490923523902893
loss_pred:0.021231282502412796, decouple_loss:0.002862154506146908
The generated pressure mean: 0.45284032821655273
loss_pred:0.018866412341594696, decouple_loss:0.002826572861522436
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 6703, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470072090625763
The generated pressure mean: 0.44851866364479065
loss_pred:0.019803382456302643, decouple_loss:0.002903609536588192
loss_pred:0.017261425033211708, decouple_loss:0.003045429475605488
The generated pressure mean: 0.45308053493499756
loss_pred:0.01778435707092285, decouple_loss:0.0029019673820585012
Iteration: 6704, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4448893070220947
The generated pressure mean: 0.44768428802490234
loss_pred:0.018164925277233124, decouple_loss:0.0029155868105590343
loss_pred:0.020108817145228386, decouple_loss:0.0030294363386929035
The generated pressure mean: 0.4474712908267975
loss_pred:0.02118903398513794, decouple_loss:0.0030155114363878965
Iteration: 6705, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4331674575805664
The generated pressure mean: 0.433930367231369
loss_pred:0.01904534175992012, decouple_loss:0.0031331649515777826
loss_pred:0.0185072161257267, decouple_loss:0.0031737068202346563
The generated pressure mean: 0.4364100694656372
loss_pred:0.01854032091796398, decouple_loss:0.003111685859039426
Iteration: 6706, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489898979663849
The generated pressure mean: 0.4497168958187103
loss_pred:0.019428158178925514, decouple_loss:0.0028382132295519114
loss_pred:0.01785600185394287, decouple_loss:0.002681282116100192
The generated pressure mean: 0.45149239897727966
loss_pred:0.01955176703631878, decouple_loss:0.0028466039802879095
Iteration: 6707, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500001072883606
The generated pressure mean: 0.4486216604709625
loss_pred:0.0192271675914526, decouple_loss:0.00246901111677289
loss_pred:0.017713822424411774, decouple_loss:0.002639555372297764
The generated pressure mean: 0.44963616132736206
loss_pred:0.01938585564494133, decouple_loss:0.0025660127867013216
Iteration: 6708, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4522881507873535
loss_pred:0.01726563088595867, decouple_loss:0.0024737860076129436
The generated pressure mean: 0.44813117384910583
loss_pred:0.01845584250986576, decouple_loss:0.0025901098269969225
The generated pressure mean: 0.4501597583293915
loss_pred:0.017239399254322052, decouple_loss:0.0025057352613657713
Iteration: 6709, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44773903489112854
loss_pred:0.019974300637841225, decouple_loss:0.0025314847007393837
The generated pressure mean: 0.44510146975517273
loss_pred:0.018282679840922356, decouple_loss:0.002651205286383629
The generated pressure mean: 0.4470638036727905
loss_pred:0.017716851085424423, decouple_loss:0.0023625637404620647
Iteration: 6710, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.443175345659256
The generated pressure mean: 0.4374019205570221
loss_pred:0.01752491667866707, decouple_loss:0.002662172308191657
loss_pred:0.017471643164753914, decouple_loss:0.0026732992846518755
The generated pressure mean: 0.43661752343177795
loss_pred:0.018512284383177757, decouple_loss:0.0027585478965193033
2023-04-17 13:01:34 testing...
The generated pressure mean: 0.41373366117477417
The generated pressure mean: 0.420855313539505
The generated pressure mean: 0.4240007698535919
loss_pred:0.0316961370408535, decouple_loss:0.003170300042256713
loss_pred:0.030884135514497757, decouple_loss:0.0033676435705274343
loss_pred:0.030371438711881638, decouple_loss:0.003533890238031745
WV_0_PC_0_EH_1_PS_40, loss: 0.031151767820119858, avg_mse: 0.046715147793293
current test mse: 0.046715
Iteration: 6711, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44973224401474
loss_pred:0.018170194700360298, decouple_loss:0.0024536866694688797
The generated pressure mean: 0.4493175446987152
loss_pred:0.017779778689146042, decouple_loss:0.0025403806939721107
The generated pressure mean: 0.4505884051322937
loss_pred:0.01937832683324814, decouple_loss:0.002453872933983803
Iteration: 6712, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474642276763916
loss_pred:0.017474358901381493, decouple_loss:0.0025046756491065025
The generated pressure mean: 0.44374337792396545
loss_pred:0.017589839175343513, decouple_loss:0.0025718093384057283
The generated pressure mean: 0.44557517766952515
loss_pred:0.017556101083755493, decouple_loss:0.0024249216075986624
Iteration: 6713, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474150538444519
The generated pressure mean: 0.4458872079849243
loss_pred:0.019059788435697556, decouple_loss:0.002670313697308302
loss_pred:0.01879986748099327, decouple_loss:0.002595362486317754
The generated pressure mean: 0.44383907318115234
loss_pred:0.016649466007947922, decouple_loss:0.0027280785143375397
Iteration: 6714, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44506460428237915
The generated pressure mean: 0.4416416585445404
loss_pred:0.018418991938233376, decouple_loss:0.0021902709268033504
loss_pred:0.017139334231615067, decouple_loss:0.0023163766600191593
The generated pressure mean: 0.4491584002971649
loss_pred:0.01833527162671089, decouple_loss:0.002241309965029359
Iteration: 6715, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44940465688705444
loss_pred:0.0189497172832489, decouple_loss:0.0025996039621531963
The generated pressure mean: 0.4488697648048401
loss_pred:0.020924162119627, decouple_loss:0.0025472992565482855
The generated pressure mean: 0.446000337600708
loss_pred:0.01918223686516285, decouple_loss:0.0025409210938960314
Iteration: 6716, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4431527554988861
loss_pred:0.01732555590569973, decouple_loss:0.0024063605815172195
The generated pressure mean: 0.44453006982803345
loss_pred:0.016732463613152504, decouple_loss:0.00268383976072073
The generated pressure mean: 0.44275227189064026
loss_pred:0.018790939822793007, decouple_loss:0.0026870521251112223
Iteration: 6717, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44175776839256287
loss_pred:0.019775085151195526, decouple_loss:0.002661125734448433
The generated pressure mean: 0.4477427303791046
loss_pred:0.01705661229789257, decouple_loss:0.002532034181058407
The generated pressure mean: 0.4454940855503082
loss_pred:0.018012870103120804, decouple_loss:0.002533741295337677
Iteration: 6718, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45180901885032654
The generated pressure mean: 0.4505538046360016
loss_pred:0.017263138666749, decouple_loss:0.0030377632938325405
loss_pred:0.01860404945909977, decouple_loss:0.0028778063133358955
The generated pressure mean: 0.45651042461395264
loss_pred:0.018936414271593094, decouple_loss:0.0031099654734134674
Iteration: 6719, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4451211988925934
The generated pressure mean: 0.44709983468055725
loss_pred:0.01775893196463585, decouple_loss:0.002449289197102189
loss_pred:0.017607057467103004, decouple_loss:0.002456434303894639
The generated pressure mean: 0.4473629295825958
loss_pred:0.01793275959789753, decouple_loss:0.0025130969006568193
Iteration: 6720, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44693616032600403
loss_pred:0.016993127763271332, decouple_loss:0.002668416127562523
The generated pressure mean: 0.4486960768699646
loss_pred:0.01868484541773796, decouple_loss:0.002607063390314579
The generated pressure mean: 0.44956156611442566
loss_pred:0.019363926723599434, decouple_loss:0.00266990321688354
2023-04-17 13:03:27 testing...
The generated pressure mean: 0.4224837124347687
The generated pressure mean: 0.41425079107284546
The generated pressure mean: 0.4260236918926239
loss_pred:0.03181961923837662, decouple_loss:0.0034454865381121635
loss_pred:0.03273662552237511, decouple_loss:0.0032262024469673634
loss_pred:0.031203463673591614, decouple_loss:0.003614134853705764
WV_0_PC_0_EH_1_PS_40, loss: 0.03209133446216583, avg_mse: 0.04904111102223396
current test mse: 0.049041
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 6721, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4445590376853943
loss_pred:0.018595056608319283, decouple_loss:0.0025447362568229437
The generated pressure mean: 0.4477182924747467
The generated pressure mean: 0.4467912018299103
loss_pred:0.018156995996832848, decouple_loss:0.0024791776668280363
loss_pred:0.01745053194463253, decouple_loss:0.0024401519913226366
Iteration: 6722, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4383126497268677
The generated pressure mean: 0.4366132915019989
loss_pred:0.019634973257780075, decouple_loss:0.0022263145074248314
loss_pred:0.01850062981247902, decouple_loss:0.0022805293556302786
The generated pressure mean: 0.4481465518474579
loss_pred:0.0182744562625885, decouple_loss:0.0022661329712718725
Iteration: 6723, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4453067183494568
loss_pred:0.018813401460647583, decouple_loss:0.002913642907515168
The generated pressure mean: 0.44322270154953003
loss_pred:0.018244542181491852, decouple_loss:0.0027282023802399635
The generated pressure mean: 0.44569364190101624
loss_pred:0.017250336706638336, decouple_loss:0.002736783353611827
Iteration: 6724, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45382609963417053
The generated pressure mean: 0.4562563896179199
loss_pred:0.017734987661242485, decouple_loss:0.0028773206286132336
loss_pred:0.01860690861940384, decouple_loss:0.0028566939290612936
The generated pressure mean: 0.44835370779037476
loss_pred:0.018959179520606995, decouple_loss:0.002780652604997158
Iteration: 6725, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45198854804039
The generated pressure mean: 0.4449946880340576
loss_pred:0.01827526092529297, decouple_loss:0.0024679042398929596
loss_pred:0.018322980031371117, decouple_loss:0.0024563984479755163
The generated pressure mean: 0.45261549949645996
loss_pred:0.017607731744647026, decouple_loss:0.002460390329360962
Iteration: 6726, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44958966970443726
loss_pred:0.018286176025867462, decouple_loss:0.0033226667437702417
The generated pressure mean: 0.45172449946403503
loss_pred:0.018003227189183235, decouple_loss:0.0033331094309687614
The generated pressure mean: 0.4478350579738617
loss_pred:0.01900506764650345, decouple_loss:0.0033037965185940266
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 6727, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43507322669029236
loss_pred:0.018050692975521088, decouple_loss:0.003129213349893689
The generated pressure mean: 0.43680539727211
loss_pred:0.019722584635019302, decouple_loss:0.0030855650547891855
The generated pressure mean: 0.441275417804718
loss_pred:0.0188750009983778, decouple_loss:0.0029394093435257673
Iteration: 6728, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44897395372390747
loss_pred:0.019144557416439056, decouple_loss:0.0022369613870978355
The generated pressure mean: 0.4502744972705841
loss_pred:0.017568262293934822, decouple_loss:0.0023506670258939266
The generated pressure mean: 0.4479380249977112
loss_pred:0.017311325296759605, decouple_loss:0.0024356357753276825
Iteration: 6729, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484601616859436
loss_pred:0.018423648551106453, decouple_loss:0.003464372828602791
The generated pressure mean: 0.4501817524433136
loss_pred:0.018585579469799995, decouple_loss:0.003501530271023512
The generated pressure mean: 0.4480557441711426
loss_pred:0.018355343490839005, decouple_loss:0.0036471779458224773
Iteration: 6730, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45063310861587524The generated pressure mean: 0.44649454951286316
loss_pred:0.01881330832839012, decouple_loss:0.0025687594898045063
loss_pred:0.018335822969675064, decouple_loss:0.0026483081746846437
The generated pressure mean: 0.44657570123672485
loss_pred:0.018365049734711647, decouple_loss:0.0026031823363155127
2023-04-17 13:06:01 testing...
The generated pressure mean: 0.4133520722389221
The generated pressure mean: 0.41964098811149597
loss_pred:0.031710851937532425, decouple_loss:0.0034164332319051027
The generated pressure mean: 0.4227977395057678
loss_pred:0.030508877709507942, decouple_loss:0.003621121635660529
loss_pred:0.030330127105116844, decouple_loss:0.003703791880980134
WV_0_PC_0_EH_1_PS_40, loss: 0.031028976663947105, avg_mse: 0.046447720378637314
current test mse: 0.046448
Iteration: 6731, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4433651864528656
loss_pred:0.01698014698922634, decouple_loss:0.002893601544201374
The generated pressure mean: 0.4420373737812042
loss_pred:0.016983887180685997, decouple_loss:0.0028835011180490255
The generated pressure mean: 0.4480131268501282
loss_pred:0.019290920346975327, decouple_loss:0.003039658535271883
Iteration: 6732, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4523051381111145
loss_pred:0.01800733618438244, decouple_loss:0.0028574371244758368
The generated pressure mean: 0.45379847288131714
loss_pred:0.017977818846702576, decouple_loss:0.0029641303699463606
The generated pressure mean: 0.4539552628993988
loss_pred:0.019070524722337723, decouple_loss:0.0028700155671685934
Iteration: 6733, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4419117569923401
loss_pred:0.017281055450439453, decouple_loss:0.002592596458271146
The generated pressure mean: 0.44247564673423767
loss_pred:0.017766224220395088, decouple_loss:0.002496910747140646
The generated pressure mean: 0.44276002049446106
loss_pred:0.017583848908543587, decouple_loss:0.002616907237097621
Iteration: 6734, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4444863200187683
The generated pressure mean: 0.44337356090545654
loss_pred:0.016681069508194923, decouple_loss:0.002354881726205349
loss_pred:0.019578682258725166, decouple_loss:0.0025008635129779577
The generated pressure mean: 0.4401295483112335
loss_pred:0.018989816308021545, decouple_loss:0.0025859996676445007
Iteration: 6735, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4510786235332489
loss_pred:0.01893606409430504, decouple_loss:0.0030678794719278812
The generated pressure mean: 0.4553678333759308
loss_pred:0.01826869323849678, decouple_loss:0.003073766129091382
The generated pressure mean: 0.4568706750869751
loss_pred:0.020055387169122696, decouple_loss:0.0031068394891917706
Iteration: 6736, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43957194685935974
loss_pred:0.018230006098747253, decouple_loss:0.00314705609343946
The generated pressure mean: 0.44296935200691223
loss_pred:0.018075745552778244, decouple_loss:0.0032262885943055153
The generated pressure mean: 0.43937966227531433
loss_pred:0.017345888540148735, decouple_loss:0.0031732528004795313
Iteration: 6737, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44385573267936707
loss_pred:0.01750139333307743, decouple_loss:0.003302796510979533
The generated pressure mean: 0.4508625566959381
loss_pred:0.021751346066594124, decouple_loss:0.00296673527918756
The generated pressure mean: 0.44690078496932983
loss_pred:0.018363002687692642, decouple_loss:0.0031364355236291885
Iteration: 6738, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45117199420928955
loss_pred:0.01720288395881653, decouple_loss:0.0025452577974647284
The generated pressure mean: 0.4510035812854767
loss_pred:0.01757866144180298, decouple_loss:0.002553628059104085
The generated pressure mean: 0.4517645239830017
loss_pred:0.01768317259848118, decouple_loss:0.0026964335702359676
Iteration: 6739, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45201918482780457
The generated pressure mean: 0.4580453932285309
loss_pred:0.018241260200738907, decouple_loss:0.0026207109913229942
loss_pred:0.018393127247691154, decouple_loss:0.002625195775181055
The generated pressure mean: 0.44962579011917114
loss_pred:0.02078385092318058, decouple_loss:0.0025915871374309063
Iteration: 6740, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43344932794570923
loss_pred:0.01785941980779171, decouple_loss:0.002976308111101389
The generated pressure mean: 0.4365161061286926
loss_pred:0.019958700984716415, decouple_loss:0.003037960734218359
The generated pressure mean: 0.4324450194835663
loss_pred:0.01795344240963459, decouple_loss:0.0026980850379914045
2023-04-17 13:07:54 testing...
The generated pressure mean: 0.4142935276031494
The generated pressure mean: 0.42160001397132874
loss_pred:0.03311311826109886, decouple_loss:0.0033081327565014362
The generated pressure mean: 0.42533940076828003
loss_pred:0.03176185116171837, decouple_loss:0.0036133776884526014
loss_pred:0.03135966137051582, decouple_loss:0.0036274304147809744
WV_0_PC_0_EH_1_PS_40, loss: 0.03225402534008026, avg_mse: 0.0489761047065258
current test mse: 0.048976
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 6741, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44735464453697205
loss_pred:0.017701037228107452, decouple_loss:0.0026830509305000305
The generated pressure mean: 0.4427909255027771
loss_pred:0.017617102712392807, decouple_loss:0.0026377548929303885
The generated pressure mean: 0.446167528629303
loss_pred:0.01795312762260437, decouple_loss:0.002715851878747344
Iteration: 6742, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46138620376586914
The generated pressure mean: 0.4658438563346863
loss_pred:0.01836501620709896, decouple_loss:0.0030366992577910423
loss_pred:0.019144607707858086, decouple_loss:0.0029237386770546436
The generated pressure mean: 0.4599696695804596
loss_pred:0.017180247232317924, decouple_loss:0.002935153665021062
Iteration: 6743, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44117748737335205
The generated pressure mean: 0.4393905699253082
loss_pred:0.017858032137155533, decouple_loss:0.0028697983361780643
loss_pred:0.018667206168174744, decouple_loss:0.0028905002400279045
The generated pressure mean: 0.440062016248703
loss_pred:0.01948859728872776, decouple_loss:0.0029623378068208694
Iteration: 6744, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43278658390045166
The generated pressure mean: 0.4280582070350647
loss_pred:0.016824688762426376, decouple_loss:0.003382638329640031
loss_pred:0.021984849125146866, decouple_loss:0.0034981882199645042
The generated pressure mean: 0.42880526185035706
loss_pred:0.018778031691908836, decouple_loss:0.0034801431465893984
Iteration: 6745, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508715867996216
The generated pressure mean: 0.4527468979358673
loss_pred:0.017376314848661423, decouple_loss:0.0035245418548583984
loss_pred:0.018337229266762733, decouple_loss:0.003523530438542366
The generated pressure mean: 0.45822465419769287
loss_pred:0.016783079132437706, decouple_loss:0.003444693749770522
Iteration: 6746, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4566928744316101
The generated pressure mean: 0.4580451548099518
loss_pred:0.017623886466026306, decouple_loss:0.0028507106471806765
loss_pred:0.019783392548561096, decouple_loss:0.002762103220447898
The generated pressure mean: 0.45577505230903625
loss_pred:0.0196896530687809, decouple_loss:0.002844620728865266
Iteration: 6747, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.427068829536438
The generated pressure mean: 0.4391540288925171
loss_pred:0.01815004087984562, decouple_loss:0.0034850158262997866
loss_pred:0.018724258989095688, decouple_loss:0.003533413866534829
The generated pressure mean: 0.4303463399410248
loss_pred:0.018833378329873085, decouple_loss:0.0034920135512948036
Iteration: 6748, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44840532541275024
The generated pressure mean: 0.4444706439971924
loss_pred:0.01771540567278862, decouple_loss:0.002750229788944125
loss_pred:0.017310356721282005, decouple_loss:0.0027340927626937628
The generated pressure mean: 0.44745081663131714
loss_pred:0.018096517771482468, decouple_loss:0.0027488742489367723
Iteration: 6749, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46293315291404724
loss_pred:0.018947741016745567, decouple_loss:0.0036257768515497446
The generated pressure mean: 0.45898547768592834
loss_pred:0.016293691471219063, decouple_loss:0.0036825803108513355
The generated pressure mean: 0.45881345868110657
loss_pred:0.018925940617918968, decouple_loss:0.003596779191866517
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 6750, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4446687698364258The generated pressure mean: 0.45248284935951233
loss_pred:0.017703142017126083, decouple_loss:0.0030735551845282316
loss_pred:0.018403757363557816, decouple_loss:0.0031583979725837708
The generated pressure mean: 0.44713518023490906
loss_pred:0.016610506922006607, decouple_loss:0.003095849882811308
2023-04-17 13:10:24 testing...
The generated pressure mean: 0.41571882367134094
The generated pressure mean: 0.4223038852214813
loss_pred:0.031898383051157, decouple_loss:0.0035793804563581944
The generated pressure mean: 0.4253617227077484
loss_pred:0.03101189248263836, decouple_loss:0.0038522924296557903
loss_pred:0.030459312722086906, decouple_loss:0.003944681957364082
WV_0_PC_0_EH_1_PS_40, loss: 0.03131280466914177, avg_mse: 0.046899136155843735
current test mse: 0.046899
Iteration: 6751, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4357215464115143
The generated pressure mean: 0.4364754259586334
loss_pred:0.01637798175215721, decouple_loss:0.0033701269421726465
loss_pred:0.018335672095417976, decouple_loss:0.00354001484811306
The generated pressure mean: 0.43984857201576233
loss_pred:0.017345286905765533, decouple_loss:0.0032942290417850018
Iteration: 6752, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43994489312171936
The generated pressure mean: 0.4461959898471832
loss_pred:0.01963445357978344, decouple_loss:0.0027516165282577276
loss_pred:0.016454003751277924, decouple_loss:0.002759372815489769
The generated pressure mean: 0.4393678605556488
loss_pred:0.01699221320450306, decouple_loss:0.002760960953310132
Iteration: 6753, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45092150568962097
The generated pressure mean: 0.4533276855945587
loss_pred:0.017654012888669968, decouple_loss:0.003261095844209194
loss_pred:0.018035629764199257, decouple_loss:0.003093939973041415
The generated pressure mean: 0.44602206349372864
loss_pred:0.018064523115754128, decouple_loss:0.00324164517223835
Iteration: 6754, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45101410150527954
The generated pressure mean: 0.45217952132225037
loss_pred:0.018229885026812553, decouple_loss:0.003011841094121337
loss_pred:0.018126249313354492, decouple_loss:0.0030281399376690388
The generated pressure mean: 0.4507099688053131
loss_pred:0.01729271374642849, decouple_loss:0.002947587752714753
Iteration: 6755, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473520815372467
The generated pressure mean: 0.44251683354377747
loss_pred:0.017362182959914207, decouple_loss:0.002540978603065014
loss_pred:0.019089777022600174, decouple_loss:0.0025462426710873842
The generated pressure mean: 0.44011032581329346
loss_pred:0.018112516030669212, decouple_loss:0.002490179380401969
Iteration: 6756, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4456687271595001
The generated pressure mean: 0.43783673644065857
loss_pred:0.018777040764689445, decouple_loss:0.0025791062507778406
loss_pred:0.01860765926539898, decouple_loss:0.0025051282718777657
The generated pressure mean: 0.4453152120113373
loss_pred:0.017959153279662132, decouple_loss:0.0026309331879019737
Iteration: 6757, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4518466889858246The generated pressure mean: 0.4497486650943756
loss_pred:0.016400473192334175, decouple_loss:0.0027924252208322287
loss_pred:0.01792147010564804, decouple_loss:0.002547931158915162
The generated pressure mean: 0.4499742090702057
loss_pred:0.018241172656416893, decouple_loss:0.002682576421648264
Iteration: 6758, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44535717368125916
loss_pred:0.018330872058868408, decouple_loss:0.003021866548806429
The generated pressure mean: 0.4442499876022339
loss_pred:0.02006159909069538, decouple_loss:0.003048196667805314
The generated pressure mean: 0.4495611786842346
loss_pred:0.01883838325738907, decouple_loss:0.0029478692449629307
Iteration: 6759, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4340924024581909
loss_pred:0.017469247803092003, decouple_loss:0.003817672608420253
The generated pressure mean: 0.4379367232322693
loss_pred:0.0187302827835083, decouple_loss:0.004109877627342939
The generated pressure mean: 0.44123604893684387
loss_pred:0.017125574871897697, decouple_loss:0.003934644628316164
Iteration: 6760, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466380178928375
loss_pred:0.018852801993489265, decouple_loss:0.003245500149205327
The generated pressure mean: 0.45097315311431885
loss_pred:0.017781488597393036, decouple_loss:0.003184524131938815
The generated pressure mean: 0.4479627013206482
loss_pred:0.01737026683986187, decouple_loss:0.0031308045145124197
2023-04-17 13:12:18 testing...
The generated pressure mean: 0.41953912377357483
The generated pressure mean: 0.4117118716239929
loss_pred:0.03131880238652229, decouple_loss:0.0033749747090041637
The generated pressure mean: 0.4228113889694214
loss_pred:0.03239330276846886, decouple_loss:0.0031194628681987524
loss_pred:0.030955035239458084, decouple_loss:0.003437876934185624
WV_0_PC_0_EH_1_PS_40, loss: 0.03172125667333603, avg_mse: 0.048310961574316025
current test mse: 0.048311
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 6761, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464593231678009
loss_pred:0.020334359258413315, decouple_loss:0.002984960563480854
The generated pressure mean: 0.44815677404403687
loss_pred:0.019270243123173714, decouple_loss:0.002927834168076515
The generated pressure mean: 0.45440542697906494
loss_pred:0.01867830567061901, decouple_loss:0.0032812419813126326
Iteration: 6762, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44981908798217773
loss_pred:0.0194404274225235, decouple_loss:0.0030254016164690256
The generated pressure mean: 0.44793227314949036
loss_pred:0.01798906736075878, decouple_loss:0.003297177841886878
The generated pressure mean: 0.45323604345321655
loss_pred:0.02035965770483017, decouple_loss:0.0032688449136912823
Iteration: 6763, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43894460797309875
The generated pressure mean: 0.4423931837081909
loss_pred:0.019346849992871284, decouple_loss:0.0030741633381694555
loss_pred:0.01891949027776718, decouple_loss:0.0030971935484558344
The generated pressure mean: 0.4395774304866791
loss_pred:0.019002914428710938, decouple_loss:0.003133360529318452
Iteration: 6764, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43786779046058655
The generated pressure mean: 0.4401828944683075
loss_pred:0.019142834469676018, decouple_loss:0.0024312762543559074
loss_pred:0.021318096667528152, decouple_loss:0.0023676331620663404
The generated pressure mean: 0.4394887089729309
loss_pred:0.01773790270090103, decouple_loss:0.002284417627379298
Iteration: 6765, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45872950553894043
The generated pressure mean: 0.4533533453941345
loss_pred:0.020627353340387344, decouple_loss:0.0028362383600324392
loss_pred:0.01872723549604416, decouple_loss:0.0028297831304371357
The generated pressure mean: 0.4515690803527832
loss_pred:0.018677430227398872, decouple_loss:0.0027453689835965633
Iteration: 6766, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.454703152179718
The generated pressure mean: 0.45435163378715515
loss_pred:0.01891801320016384, decouple_loss:0.0032529474701732397
loss_pred:0.018529577180743217, decouple_loss:0.0033636160660535097
The generated pressure mean: 0.45010972023010254
loss_pred:0.018579604104161263, decouple_loss:0.003154142526909709
Iteration: 6767, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44894930720329285
The generated pressure mean: 0.45039859414100647
loss_pred:0.020855508744716644, decouple_loss:0.0031855308916419744
loss_pred:0.019173623993992805, decouple_loss:0.0030476776883006096
The generated pressure mean: 0.4373707175254822
loss_pred:0.018285837024450302, decouple_loss:0.0030451982747763395
Iteration: 6768, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4406203329563141
loss_pred:0.017598876729607582, decouple_loss:0.00268191029317677
The generated pressure mean: 0.43856683373451233
loss_pred:0.018137101083993912, decouple_loss:0.0027452632784843445
The generated pressure mean: 0.44007307291030884
loss_pred:0.018566813319921494, decouple_loss:0.0027000312693417072
Iteration: 6769, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44331419467926025
loss_pred:0.020803358405828476, decouple_loss:0.002721799071878195
The generated pressure mean: 0.4544181823730469
loss_pred:0.019396087154746056, decouple_loss:0.0027441387064754963
The generated pressure mean: 0.4454039931297302
loss_pred:0.019225509837269783, decouple_loss:0.0027480449061840773
Iteration: 6770, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44319912791252136
The generated pressure mean: 0.4391253888607025
loss_pred:0.017683709040284157, decouple_loss:0.0027808749582618475
loss_pred:0.018638646230101585, decouple_loss:0.0027033172082155943
The generated pressure mean: 0.4486373960971832
loss_pred:0.019766559824347496, decouple_loss:0.00250806356780231
2023-04-17 13:14:47 testing...
The generated pressure mean: 0.41315385699272156
The generated pressure mean: 0.4202752709388733
The generated pressure mean: 0.42433854937553406
loss_pred:0.033501699566841125, decouple_loss:0.0032312923576682806
loss_pred:0.03238648548722267, decouple_loss:0.0033240532502532005
loss_pred:0.03157950937747955, decouple_loss:0.0035334222484380007
WV_0_PC_0_EH_1_PS_40, loss: 0.032657381147146225, avg_mse: 0.049886975437402725
current test mse: 0.049887
Iteration: 6771, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45024701952934265
loss_pred:0.0189428199082613, decouple_loss:0.002816801192238927
The generated pressure mean: 0.4450991451740265
loss_pred:0.01860308088362217, decouple_loss:0.0027974452823400497
The generated pressure mean: 0.4494764804840088
loss_pred:0.01905795931816101, decouple_loss:0.0028341030701994896
Iteration: 6772, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45131880044937134
loss_pred:0.019858935847878456, decouple_loss:0.002650144975632429
The generated pressure mean: 0.4505854547023773
loss_pred:0.018861889839172363, decouple_loss:0.0026092883199453354
The generated pressure mean: 0.45463189482688904
loss_pred:0.017715608701109886, decouple_loss:0.0026022999081760645
Iteration: 6773, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4394391179084778
The generated pressure mean: 0.4426364302635193
loss_pred:0.017546912655234337, decouple_loss:0.002966861007735133
loss_pred:0.01871795766055584, decouple_loss:0.002957781543955207
The generated pressure mean: 0.44251126050949097
loss_pred:0.01941755972802639, decouple_loss:0.002889182884246111
Iteration: 6774, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452130198478699
The generated pressure mean: 0.4425605535507202
loss_pred:0.017628304660320282, decouple_loss:0.003102799179032445
loss_pred:0.01835106499493122, decouple_loss:0.0032700379379093647
The generated pressure mean: 0.44546353816986084
loss_pred:0.018029797822237015, decouple_loss:0.0031561553478240967
Iteration: 6775, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45216134190559387
The generated pressure mean: 0.4455193281173706
loss_pred:0.021503500640392303, decouple_loss:0.004096867050975561
loss_pred:0.019484831020236015, decouple_loss:0.003811721922829747
The generated pressure mean: 0.44713595509529114
loss_pred:0.018260519951581955, decouple_loss:0.0040727038867771626
Iteration: 6776, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44118213653564453
The generated pressure mean: 0.44718465209007263
loss_pred:0.017838452011346817, decouple_loss:0.0030321297235786915
loss_pred:0.018140481784939766, decouple_loss:0.0032485653646290302
The generated pressure mean: 0.4444161057472229
loss_pred:0.018982362002134323, decouple_loss:0.00316623505204916
Iteration: 6777, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4515998661518097
The generated pressure mean: 0.4505797028541565
loss_pred:0.019253671169281006, decouple_loss:0.003058135509490967
loss_pred:0.02064666338264942, decouple_loss:0.0031603907700628042
The generated pressure mean: 0.44459858536720276
loss_pred:0.019039969891309738, decouple_loss:0.0032012094743549824
Iteration: 6778, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44428348541259766
loss_pred:0.020024020224809647, decouple_loss:0.0036259612534195185
The generated pressure mean: 0.44828495383262634
loss_pred:0.018677884712815285, decouple_loss:0.00398598425090313
The generated pressure mean: 0.4453195631504059
loss_pred:0.018404413014650345, decouple_loss:0.003818955970928073
Iteration: 6779, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44838178157806396
loss_pred:0.018988847732543945, decouple_loss:0.002879566978663206
The generated pressure mean: 0.45237359404563904
loss_pred:0.018688810989260674, decouple_loss:0.002883664797991514
The generated pressure mean: 0.45227739214897156
loss_pred:0.019556745886802673, decouple_loss:0.002961499849334359
Iteration: 6780, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4389573633670807
The generated pressure mean: 0.4471692144870758
loss_pred:0.019668271765112877, decouple_loss:0.0026433339808136225
loss_pred:0.018288856372237206, decouple_loss:0.002545909956097603
The generated pressure mean: 0.4446623921394348
loss_pred:0.01912267878651619, decouple_loss:0.002541553694754839
2023-04-17 13:16:40 testing...
The generated pressure mean: 0.42406681180000305
The generated pressure mean: 0.41591429710388184
The generated pressure mean: 0.42739561200141907
loss_pred:0.030694222077727318, decouple_loss:0.0033531899098306894
loss_pred:0.032070040702819824, decouple_loss:0.0031338934786617756
loss_pred:0.030372342094779015, decouple_loss:0.0034911104012280703
WV_0_PC_0_EH_1_PS_40, loss: 0.031211838126182556, avg_mse: 0.04743475839495659
current test mse: 0.047435
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 6781, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4369206130504608
loss_pred:0.01792282797396183, decouple_loss:0.0027235529851168394
The generated pressure mean: 0.4406175911426544
loss_pred:0.018926283344626427, decouple_loss:0.002583438763394952
The generated pressure mean: 0.4372209310531616
loss_pred:0.017080217599868774, decouple_loss:0.002560642547905445
Iteration: 6782, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45046567916870117
The generated pressure mean: 0.45060211420059204
loss_pred:0.01799503155052662, decouple_loss:0.002599896863102913
loss_pred:0.018728014081716537, decouple_loss:0.0026355639565736055
The generated pressure mean: 0.4547267556190491
loss_pred:0.018086731433868408, decouple_loss:0.00272381491959095
Iteration: 6783, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45843562483787537
The generated pressure mean: 0.45821332931518555
loss_pred:0.01766282133758068, decouple_loss:0.0029388898983597755
loss_pred:0.017552722245454788, decouple_loss:0.002822906943038106
The generated pressure mean: 0.45656776428222656
loss_pred:0.017905335873365402, decouple_loss:0.002834661863744259
Iteration: 6784, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4409230649471283
The generated pressure mean: 0.44591987133026123
loss_pred:0.01897362805902958, decouple_loss:0.0031164814718067646
loss_pred:0.017828000709414482, decouple_loss:0.0030328899156302214
The generated pressure mean: 0.43920665979385376
loss_pred:0.017824724316596985, decouple_loss:0.0029610658530145884
Iteration: 6785, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4362507164478302
loss_pred:0.017152464017271996, decouple_loss:0.002908045193180442
The generated pressure mean: 0.4339461922645569
loss_pred:0.01778983697295189, decouple_loss:0.002875636098906398
The generated pressure mean: 0.4353259801864624
loss_pred:0.0181711558252573, decouple_loss:0.0029725884087383747
Iteration: 6786, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45424535870552063
loss_pred:0.01714208349585533, decouple_loss:0.0030469221528619528
The generated pressure mean: 0.45038023591041565
loss_pred:0.01682281494140625, decouple_loss:0.003174399957060814
The generated pressure mean: 0.45049214363098145
loss_pred:0.01893453299999237, decouple_loss:0.0030536565463989973
Iteration: 6787, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4557209312915802
The generated pressure mean: 0.45588457584381104
loss_pred:0.01826365292072296, decouple_loss:0.0024551854003220797
loss_pred:0.022866245359182358, decouple_loss:0.0025541239883750677
The generated pressure mean: 0.4583861231803894
loss_pred:0.01687205210328102, decouple_loss:0.0025198974180966616
Iteration: 6788, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42027631402015686
The generated pressure mean: 0.4159950613975525
loss_pred:0.017976995557546616, decouple_loss:0.0026960810646414757
loss_pred:0.01801888272166252, decouple_loss:0.002605457790195942
The generated pressure mean: 0.4157908260822296
loss_pred:0.018382903188467026, decouple_loss:0.0026961821131408215
Iteration: 6789, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45257651805877686
loss_pred:0.020009303465485573, decouple_loss:0.0033862057607620955
The generated pressure mean: 0.4568588435649872
loss_pred:0.01723461225628853, decouple_loss:0.0031888538505882025
The generated pressure mean: 0.4547422528266907
loss_pred:0.0176603514701128, decouple_loss:0.003450135700404644
Iteration: 6790, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46432602405548096
The generated pressure mean: 0.465082585811615
loss_pred:0.02009854093194008, decouple_loss:0.003403322072699666
loss_pred:0.018088648095726967, decouple_loss:0.0033267904072999954
The generated pressure mean: 0.46463409066200256
loss_pred:0.01688748225569725, decouple_loss:0.0034528090618550777
2023-04-17 13:19:13 testing...
The generated pressure mean: 0.4147471487522125
The generated pressure mean: 0.42080914974212646
The generated pressure mean: 0.423728883266449
loss_pred:0.03216298297047615, decouple_loss:0.0036739944480359554
loss_pred:0.03160253167152405, decouple_loss:0.0039061610586941242
loss_pred:0.03101683221757412, decouple_loss:0.004006370902061462
WV_0_PC_0_EH_1_PS_40, loss: 0.03178722783923149, avg_mse: 0.047747377306222916
current test mse: 0.047747
Iteration: 6791, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44034674763679504
loss_pred:0.01831287145614624, decouple_loss:0.0032721280585974455
The generated pressure mean: 0.4390723705291748
loss_pred:0.018006689846515656, decouple_loss:0.003206620691344142
The generated pressure mean: 0.4454726576805115
loss_pred:0.017840253189206123, decouple_loss:0.0032565752044320107
Iteration: 6792, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44518882036209106
loss_pred:0.020243898034095764, decouple_loss:0.002857189392670989
The generated pressure mean: 0.4435311257839203
loss_pred:0.01732364483177662, decouple_loss:0.0027309178840368986
The generated pressure mean: 0.4424877464771271
loss_pred:0.019042586907744408, decouple_loss:0.002803557086735964
Iteration: 6793, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442647695541382
loss_pred:0.017673246562480927, decouple_loss:0.002738204086199403
The generated pressure mean: 0.44421622157096863
loss_pred:0.017392978072166443, decouple_loss:0.0026372421998530626
The generated pressure mean: 0.4481927752494812
loss_pred:0.018794896081089973, decouple_loss:0.0026440874207764864
Iteration: 6794, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4432277977466583
loss_pred:0.01749798282980919, decouple_loss:0.003824645420536399
The generated pressure mean: 0.44542890787124634
loss_pred:0.018458405509591103, decouple_loss:0.0035968758165836334
The generated pressure mean: 0.440960168838501
loss_pred:0.01878983899950981, decouple_loss:0.0036934642121195793
Iteration: 6795, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44674399495124817
loss_pred:0.019216708838939667, decouple_loss:0.0031092828139662743
The generated pressure mean: 0.4407792389392853
loss_pred:0.01779399998486042, decouple_loss:0.0030978384893387556
The generated pressure mean: 0.441083699464798
loss_pred:0.018224453553557396, decouple_loss:0.0031280959956347942
Iteration: 6796, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45355162024497986
loss_pred:0.019290124997496605, decouple_loss:0.0028612648602575064
The generated pressure mean: 0.4549700617790222
loss_pred:0.01857360452413559, decouple_loss:0.002708184765651822
The generated pressure mean: 0.4536690413951874
loss_pred:0.017662478610873222, decouple_loss:0.002830674173310399
Iteration: 6797, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4489571154117584
loss_pred:0.01782464049756527, decouple_loss:0.0037030756939202547
The generated pressure mean: 0.45263171195983887
loss_pred:0.018920820206403732, decouple_loss:0.003762271488085389
The generated pressure mean: 0.4530170261859894
loss_pred:0.018296018242836, decouple_loss:0.00392505619674921
Iteration: 6798, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44072309136390686
The generated pressure mean: 0.44106432795524597
loss_pred:0.017786022275686264, decouple_loss:0.002966119209304452
loss_pred:0.018035687506198883, decouple_loss:0.002870740368962288
The generated pressure mean: 0.44286996126174927
loss_pred:0.017009813338518143, decouple_loss:0.0027252305299043655
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 6799, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43732142448425293
loss_pred:0.020161369815468788, decouple_loss:0.003095284104347229
The generated pressure mean: 0.4396386444568634
loss_pred:0.017420710995793343, decouple_loss:0.0030254689045250416
The generated pressure mean: 0.43548333644866943
loss_pred:0.018775979056954384, decouple_loss:0.003082084469497204
Iteration: 6800, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4439154267311096
loss_pred:0.01868559792637825, decouple_loss:0.0029390682466328144
The generated pressure mean: 0.45037055015563965
The generated pressure mean: 0.4476671516895294
loss_pred:0.018397077918052673, decouple_loss:0.002878271508961916
loss_pred:0.018917864188551903, decouple_loss:0.0029602458234876394
2023-04-17 13:21:08 testing...
The generated pressure mean: 0.41868576407432556
The generated pressure mean: 0.41182297468185425
The generated pressure mean: 0.4217686057090759
loss_pred:0.03127900883555412, decouple_loss:0.003486163215711713
loss_pred:0.032105300575494766, decouple_loss:0.0032995811197906733
loss_pred:0.030580943450331688, decouple_loss:0.003523458493873477
WV_0_PC_0_EH_1_PS_40, loss: 0.031493570655584335, avg_mse: 0.047293614596128464
current test mse: 0.047294
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 6801, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4537040591239929
loss_pred:0.018372923135757446, decouple_loss:0.0026409507263451815
The generated pressure mean: 0.45530587434768677
The generated pressure mean: 0.4527135491371155
loss_pred:0.01901260018348694, decouple_loss:0.002862116089090705
loss_pred:0.018508292734622955, decouple_loss:0.0027230374980717897
Iteration: 6802, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44697824120521545
loss_pred:0.020912151783704758, decouple_loss:0.0028361366130411625
The generated pressure mean: 0.4517998695373535
loss_pred:0.01871301233768463, decouple_loss:0.002715542446821928
The generated pressure mean: 0.44633838534355164
loss_pred:0.01812157779932022, decouple_loss:0.002667308086529374
Iteration: 6803, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461943209171295
loss_pred:0.018952686339616776, decouple_loss:0.0024486118927598
The generated pressure mean: 0.4426916837692261
loss_pred:0.018120940774679184, decouple_loss:0.002522906055673957
The generated pressure mean: 0.4439682066440582
loss_pred:0.018344992771744728, decouple_loss:0.0024467676412314177
Iteration: 6804, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4445565938949585
loss_pred:0.018214251846075058, decouple_loss:0.0032495209015905857
The generated pressure mean: 0.4462924599647522
loss_pred:0.018614068627357483, decouple_loss:0.0031613230239599943
The generated pressure mean: 0.4480056166648865
loss_pred:0.018312601372599602, decouple_loss:0.0029245067853480577
Iteration: 6805, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4512028098106384
loss_pred:0.017876747995615005, decouple_loss:0.0024826147127896547
The generated pressure mean: 0.4521055221557617
loss_pred:0.018420396372675896, decouple_loss:0.0026370373088866472
The generated pressure mean: 0.45025259256362915
loss_pred:0.01720387302339077, decouple_loss:0.002424882957711816
Iteration: 6806, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471582770347595
loss_pred:0.018525488674640656, decouple_loss:0.003250149777159095
The generated pressure mean: 0.4516913890838623
loss_pred:0.021965526044368744, decouple_loss:0.0032887461129575968
The generated pressure mean: 0.4495154619216919
loss_pred:0.018163977190852165, decouple_loss:0.003239481942728162
Iteration: 6807, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43564003705978394
loss_pred:0.01865544728934765, decouple_loss:0.002667018910869956
The generated pressure mean: 0.43449342250823975
loss_pred:0.01933945342898369, decouple_loss:0.0026845107786357403
The generated pressure mean: 0.43404462933540344
loss_pred:0.01790519990026951, decouple_loss:0.0027500358410179615
Iteration: 6808, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.453250527381897
The generated pressure mean: 0.44879966974258423
loss_pred:0.018056567758321762, decouple_loss:0.00272274948656559
loss_pred:0.018163105472922325, decouple_loss:0.002839725697413087
The generated pressure mean: 0.44622308015823364
loss_pred:0.01938236691057682, decouple_loss:0.0028899486642330885
Iteration: 6809, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46089544892311096
loss_pred:0.018525585532188416, decouple_loss:0.002984376857057214
The generated pressure mean: 0.46260926127433777
loss_pred:0.017096148803830147, decouple_loss:0.003112270962446928
The generated pressure mean: 0.4618704915046692
loss_pred:0.020209966227412224, decouple_loss:0.0030171540565788746
Iteration: 6810, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44373244047164917
The generated pressure mean: 0.4437391757965088
loss_pred:0.019304245710372925, decouple_loss:0.0027512679807841778
loss_pred:0.01818688213825226, decouple_loss:0.002809208584949374
The generated pressure mean: 0.444611132144928
loss_pred:0.01813400350511074, decouple_loss:0.002868357812985778
2023-04-17 13:23:42 testing...
The generated pressure mean: 0.41503486037254333
The generated pressure mean: 0.42296457290649414
The generated pressure mean: 0.4255825877189636
loss_pred:0.03225693479180336, decouple_loss:0.003010935615748167
loss_pred:0.0308960173279047, decouple_loss:0.0032768435776233673
loss_pred:0.03061952441930771, decouple_loss:0.0034103686921298504
WV_0_PC_0_EH_1_PS_40, loss: 0.03141912817955017, avg_mse: 0.04747737944126129
current test mse: 0.047477
Iteration: 6811, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4404231607913971
loss_pred:0.020556626841425896, decouple_loss:0.002485275035724044
The generated pressure mean: 0.44422921538352966
loss_pred:0.01919594779610634, decouple_loss:0.002788374898955226
The generated pressure mean: 0.4407077431678772
loss_pred:0.0188018549233675, decouple_loss:0.0025762240402400494
Iteration: 6812, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44035568833351135
loss_pred:0.01804587058722973, decouple_loss:0.0023390448186546564
The generated pressure mean: 0.44232115149497986
loss_pred:0.01858280971646309, decouple_loss:0.0024059645365923643
The generated pressure mean: 0.43738192319869995
loss_pred:0.01833716221153736, decouple_loss:0.0025588010903447866
Iteration: 6813, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45602673292160034
loss_pred:0.018175773322582245, decouple_loss:0.0027843881398439407
The generated pressure mean: 0.45483654737472534
loss_pred:0.0190721582621336, decouple_loss:0.0027129503432661295
The generated pressure mean: 0.4536381661891937
loss_pred:0.019670993089675903, decouple_loss:0.0026747724041342735
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 6814, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45079493522644043
loss_pred:0.01832135021686554, decouple_loss:0.003166274167597294
The generated pressure mean: 0.4512939155101776
loss_pred:0.018603453412652016, decouple_loss:0.003008668078109622
The generated pressure mean: 0.452817440032959
loss_pred:0.019056377932429314, decouple_loss:0.003160465508699417
Iteration: 6815, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4417681396007538
loss_pred:0.018199389800429344, decouple_loss:0.002769975457340479
The generated pressure mean: 0.44372090697288513
loss_pred:0.01879388652741909, decouple_loss:0.002735941903665662
The generated pressure mean: 0.4459466338157654
loss_pred:0.017453549429774284, decouple_loss:0.002667236141860485
Iteration: 6816, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498210549354553
loss_pred:0.018093911930918694, decouple_loss:0.0031614969484508038
The generated pressure mean: 0.45179712772369385
loss_pred:0.017699934542179108, decouple_loss:0.003021982964128256
The generated pressure mean: 0.45147648453712463
loss_pred:0.01967957243323326, decouple_loss:0.0030036414973437786
Iteration: 6817, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482964873313904
loss_pred:0.019228415563702583, decouple_loss:0.0026334787253290415
The generated pressure mean: 0.44836151599884033
loss_pred:0.019246267154812813, decouple_loss:0.0026361439377069473
The generated pressure mean: 0.4472160041332245
loss_pred:0.01701410487294197, decouple_loss:0.002573949284851551
Iteration: 6818, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464753270149231
loss_pred:0.018219683319330215, decouple_loss:0.002858533523976803
The generated pressure mean: 0.4493553936481476
loss_pred:0.021872427314519882, decouple_loss:0.0030356289353221655
The generated pressure mean: 0.4433741569519043
loss_pred:0.018741989508271217, decouple_loss:0.0029728582594543695
Iteration: 6819, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43902117013931274
loss_pred:0.01743399351835251, decouple_loss:0.0031216165516525507
The generated pressure mean: 0.43719905614852905
loss_pred:0.0179792158305645, decouple_loss:0.0030135023407638073
The generated pressure mean: 0.43870994448661804
loss_pred:0.01821294240653515, decouple_loss:0.0030771081801503897
Iteration: 6820, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.453314870595932
loss_pred:0.017941851168870926, decouple_loss:0.00257915654219687
The generated pressure mean: 0.4510015845298767
loss_pred:0.019857291132211685, decouple_loss:0.0025326779577881098
The generated pressure mean: 0.45025670528411865
loss_pred:0.018408188596367836, decouple_loss:0.0024301770608872175
2023-04-17 13:25:37 testing...
The generated pressure mean: 0.412850558757782
The generated pressure mean: 0.42039042711257935
loss_pred:0.032116178423166275, decouple_loss:0.0032977049704641104
The generated pressure mean: 0.4234081208705902
loss_pred:0.03119993768632412, decouple_loss:0.003514194628223777
loss_pred:0.030729619786143303, decouple_loss:0.0036132261157035828
WV_0_PC_0_EH_1_PS_40, loss: 0.03152233362197876, avg_mse: 0.047423332929611206
current test mse: 0.047423
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 6821, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45365405082702637
loss_pred:0.020205814391374588, decouple_loss:0.00273109320551157
The generated pressure mean: 0.45259374380111694
loss_pred:0.018375469371676445, decouple_loss:0.0026398617774248123
The generated pressure mean: 0.45232918858528137
loss_pred:0.018972445279359818, decouple_loss:0.0026983022689819336
Iteration: 6822, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4422747790813446
loss_pred:0.018226036801934242, decouple_loss:0.003051510313525796
The generated pressure mean: 0.44172635674476624
loss_pred:0.0186040960252285, decouple_loss:0.0031882363837212324
The generated pressure mean: 0.44400784373283386
loss_pred:0.018263090401887894, decouple_loss:0.003061155555769801
Iteration: 6823, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44314292073249817
loss_pred:0.01794949546456337, decouple_loss:0.0027118236757814884
The generated pressure mean: 0.43933799862861633
loss_pred:0.01844416745007038, decouple_loss:0.002701654564589262
The generated pressure mean: 0.4429464042186737
loss_pred:0.01815413497388363, decouple_loss:0.0027022783178836107
Iteration: 6824, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44547784328460693
loss_pred:0.018394628539681435, decouple_loss:0.003058916889131069
The generated pressure mean: 0.4491749703884125
loss_pred:0.0178350992500782, decouple_loss:0.0030537147540599108
The generated pressure mean: 0.44500279426574707
loss_pred:0.016445083543658257, decouple_loss:0.0029542327392846346
Iteration: 6825, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4518285393714905
The generated pressure mean: 0.45113566517829895
loss_pred:0.018551530316472054, decouple_loss:0.002927613677456975
loss_pred:0.019359169527888298, decouple_loss:0.0028694195207208395
The generated pressure mean: 0.44852641224861145
loss_pred:0.01755552552640438, decouple_loss:0.0028758281841874123
Iteration: 6826, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44018569588661194
loss_pred:0.019346458837389946, decouple_loss:0.0025044267531484365
The generated pressure mean: 0.4377862513065338
loss_pred:0.01809520274400711, decouple_loss:0.0025388402864336967
The generated pressure mean: 0.43877747654914856
loss_pred:0.018134046345949173, decouple_loss:0.0025865603238344193
Iteration: 6827, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44457653164863586
loss_pred:0.01947525329887867, decouple_loss:0.0034642808604985476
The generated pressure mean: 0.4459656774997711
loss_pred:0.019705967977643013, decouple_loss:0.0034894717391580343
The generated pressure mean: 0.449288010597229
loss_pred:0.018661979585886, decouple_loss:0.0034476984292268753
Iteration: 6828, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44778600335121155
The generated pressure mean: 0.44532516598701477loss_pred:0.01838310994207859, decouple_loss:0.00271865027025342
loss_pred:0.017624258995056152, decouple_loss:0.0026526188012212515
The generated pressure mean: 0.4441690742969513
loss_pred:0.01954774558544159, decouple_loss:0.002724101534113288
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 6829, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4515905976295471
loss_pred:0.01856233924627304, decouple_loss:0.002560697728767991
The generated pressure mean: 0.4548209011554718
loss_pred:0.01854812167584896, decouple_loss:0.002760205650702119
The generated pressure mean: 0.448825865983963
loss_pred:0.0165603905916214, decouple_loss:0.00267759314738214
Iteration: 6830, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478638172149658
loss_pred:0.016342932358384132, decouple_loss:0.0034277758095413446
The generated pressure mean: 0.4499485492706299
loss_pred:0.016453247517347336, decouple_loss:0.0033736431505531073
The generated pressure mean: 0.4466734230518341
loss_pred:0.017453636974096298, decouple_loss:0.0034012719988822937
2023-04-17 13:28:09 testing...
The generated pressure mean: 0.4161445200443268
loss_pred:0.03193758428096771, decouple_loss:0.003198884194716811
The generated pressure mean: 0.42447176575660706
The generated pressure mean: 0.428232878446579
loss_pred:0.031140366569161415, decouple_loss:0.003430848941206932
loss_pred:0.030667122453451157, decouple_loss:0.00356559781357646
WV_0_PC_0_EH_1_PS_40, loss: 0.03141827881336212, avg_mse: 0.047832950949668884
current test mse: 0.047833
Iteration: 6831, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442911148071289
loss_pred:0.01731196977198124, decouple_loss:0.0025809169746935368
The generated pressure mean: 0.4380577802658081
loss_pred:0.017028866335749626, decouple_loss:0.0024394297506660223
The generated pressure mean: 0.4423978626728058
loss_pred:0.018827982246875763, decouple_loss:0.0026108359452337027
Iteration: 6832, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44458556175231934
loss_pred:0.018699806183576584, decouple_loss:0.0029024328105151653
The generated pressure mean: 0.4407801926136017
loss_pred:0.01934204250574112, decouple_loss:0.002869616961106658
The generated pressure mean: 0.4464537501335144
loss_pred:0.018772346898913383, decouple_loss:0.0028968891128897667
Iteration: 6833, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43637531995773315
loss_pred:0.018626950681209564, decouple_loss:0.003008440602570772
The generated pressure mean: 0.43972212076187134
loss_pred:0.020509324967861176, decouple_loss:0.003053202060982585
The generated pressure mean: 0.44050130248069763
loss_pred:0.019750669598579407, decouple_loss:0.002967457054182887
Iteration: 6834, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45202234387397766
loss_pred:0.018041148781776428, decouple_loss:0.002751954598352313
The generated pressure mean: 0.44384104013442993
loss_pred:0.018193086609244347, decouple_loss:0.0027148635126650333
The generated pressure mean: 0.44575923681259155
loss_pred:0.017302649095654488, decouple_loss:0.0027706536930054426
Iteration: 6835, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4567113220691681
loss_pred:0.018294531852006912, decouple_loss:0.003156309248879552
The generated pressure mean: 0.4560106098651886
loss_pred:0.017654910683631897, decouple_loss:0.003356314031407237
The generated pressure mean: 0.4537545144557953
loss_pred:0.017599519342184067, decouple_loss:0.003337219590321183
Iteration: 6836, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45467615127563477
loss_pred:0.017580149695277214, decouple_loss:0.0029201030265539885
The generated pressure mean: 0.44921889901161194
loss_pred:0.02019551768898964, decouple_loss:0.0030292829032987356
The generated pressure mean: 0.44887036085128784
loss_pred:0.018056705594062805, decouple_loss:0.0031303546857088804
Iteration: 6837, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43149685859680176
loss_pred:0.018049603328108788, decouple_loss:0.0026270935777574778
The generated pressure mean: 0.435579776763916
loss_pred:0.017898468300700188, decouple_loss:0.002552342601120472
The generated pressure mean: 0.4334355890750885
loss_pred:0.01708570122718811, decouple_loss:0.0026201531291007996
Iteration: 6838, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4441450834274292
loss_pred:0.017171261832118034, decouple_loss:0.0030081337317824364
The generated pressure mean: 0.44320881366729736
loss_pred:0.017484841868281364, decouple_loss:0.003033433808013797
The generated pressure mean: 0.4466719329357147
loss_pred:0.019065510481595993, decouple_loss:0.0030925506725907326
Iteration: 6839, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4558515250682831
loss_pred:0.017704622820019722, decouple_loss:0.0026196918915957212
The generated pressure mean: 0.45727482438087463
loss_pred:0.018811345100402832, decouple_loss:0.0025194857735186815
The generated pressure mean: 0.4619165360927582
loss_pred:0.017971668392419815, decouple_loss:0.00267494423314929
Iteration: 6840, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44553008675575256
loss_pred:0.019006280228495598, decouple_loss:0.0026007320266216993
The generated pressure mean: 0.44521281123161316
loss_pred:0.017418930307030678, decouple_loss:0.002573268720880151
The generated pressure mean: 0.43921446800231934
loss_pred:0.01878730207681656, decouple_loss:0.0025545204989612103
2023-04-17 13:30:03 testing...
The generated pressure mean: 0.4227816164493561
The generated pressure mean: 0.4162919521331787
loss_pred:0.031262852251529694, decouple_loss:0.0037877599243074656
The generated pressure mean: 0.4256167411804199
loss_pred:0.032116420567035675, decouple_loss:0.003676758613437414
loss_pred:0.03087483160197735, decouple_loss:0.003927389159798622
WV_0_PC_0_EH_1_PS_40, loss: 0.03160790354013443, avg_mse: 0.04762324318289757
current test mse: 0.047623
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 6841, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43434977531433105
loss_pred:0.017752252519130707, decouple_loss:0.0031726169399917126
The generated pressure mean: 0.4354506731033325
loss_pred:0.01895367167890072, decouple_loss:0.0032704344484955072
The generated pressure mean: 0.4372608959674835
loss_pred:0.017241915687918663, decouple_loss:0.0032662267331033945
Iteration: 6842, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44846731424331665
loss_pred:0.017028192058205605, decouple_loss:0.0030675972811877728
The generated pressure mean: 0.44822511076927185
loss_pred:0.017893651500344276, decouple_loss:0.0029164038132876158
The generated pressure mean: 0.449398398399353
loss_pred:0.017497243359684944, decouple_loss:0.0028812477830797434
Iteration: 6843, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45874500274658203
loss_pred:0.018427392467856407, decouple_loss:0.002756643109023571
The generated pressure mean: 0.46340250968933105
loss_pred:0.01854490116238594, decouple_loss:0.0024781194515526295
The generated pressure mean: 0.4622093439102173
loss_pred:0.017254669219255447, decouple_loss:0.002656817901879549
Iteration: 6844, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45014506578445435
loss_pred:0.017382770776748657, decouple_loss:0.0033541987650096416
The generated pressure mean: 0.4482075870037079
loss_pred:0.018893711268901825, decouple_loss:0.0032190396450459957
The generated pressure mean: 0.44465723633766174
loss_pred:0.01813254877924919, decouple_loss:0.0033252828288823366
Iteration: 6845, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4346442222595215
The generated pressure mean: 0.42958754301071167loss_pred:0.01675606518983841, decouple_loss:0.0030268593691289425
loss_pred:0.019351761788129807, decouple_loss:0.003183168824762106
The generated pressure mean: 0.43082791566848755
loss_pred:0.018478533253073692, decouple_loss:0.0033048619516193867
Iteration: 6846, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.451144814491272
loss_pred:0.01956121250987053, decouple_loss:0.002776323352009058
The generated pressure mean: 0.4487950801849365
loss_pred:0.019381286576390266, decouple_loss:0.0026610661298036575
The generated pressure mean: 0.44879084825515747
loss_pred:0.018882855772972107, decouple_loss:0.0027992650866508484
Iteration: 6847, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507409632205963
loss_pred:0.019579024985432625, decouple_loss:0.0034299353137612343
The generated pressure mean: 0.4491848349571228
loss_pred:0.018618453294038773, decouple_loss:0.003560716286301613
The generated pressure mean: 0.44792062044143677
loss_pred:0.01784050092101097, decouple_loss:0.003582888748496771
Iteration: 6848, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470349848270416
loss_pred:0.01693110354244709, decouple_loss:0.0028132230509072542
The generated pressure mean: 0.4419713318347931
loss_pred:0.01740017719566822, decouple_loss:0.00275371759198606
The generated pressure mean: 0.4467673897743225
loss_pred:0.016996802762150764, decouple_loss:0.002829474862664938
Iteration: 6849, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452377259731293
The generated pressure mean: 0.44748929142951965
loss_pred:0.016983095556497574, decouple_loss:0.0026748718228191137
loss_pred:0.017661219462752342, decouple_loss:0.002686822786927223
The generated pressure mean: 0.44531628489494324
loss_pred:0.017039095982909203, decouple_loss:0.002515735337510705
Iteration: 6850, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4520702660083771
loss_pred:0.01806684024631977, decouple_loss:0.0032697138376533985
The generated pressure mean: 0.4479590058326721
loss_pred:0.018340835347771645, decouple_loss:0.0031208391301333904
The generated pressure mean: 0.4509226679801941
loss_pred:0.0195753313601017, decouple_loss:0.003203216241672635
2023-04-17 13:32:34 testing...
The generated pressure mean: 0.41306862235069275
The generated pressure mean: 0.4205707907676697
loss_pred:0.032466571778059006, decouple_loss:0.003493903437629342
The generated pressure mean: 0.42364054918289185
loss_pred:0.03124338388442993, decouple_loss:0.0036289335694164038
loss_pred:0.030791206285357475, decouple_loss:0.0035877618938684464
WV_0_PC_0_EH_1_PS_40, loss: 0.03167889639735222, avg_mse: 0.04768214374780655
current test mse: 0.047682
Iteration: 6851, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45680901408195496
loss_pred:0.01884835585951805, decouple_loss:0.002730226842686534
The generated pressure mean: 0.4531920254230499
loss_pred:0.018870744854211807, decouple_loss:0.002711164066568017
The generated pressure mean: 0.4600500464439392
loss_pred:0.019270306453108788, decouple_loss:0.0027187669184058905
Iteration: 6852, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470711946487427
loss_pred:0.019452515989542007, decouple_loss:0.002671338152140379
The generated pressure mean: 0.4459433853626251
loss_pred:0.019270051270723343, decouple_loss:0.0026256253477185965
The generated pressure mean: 0.445173054933548
loss_pred:0.017859410494565964, decouple_loss:0.0027391542680561543
Iteration: 6853, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.436197966337204
loss_pred:0.018056746572256088, decouple_loss:0.002415009308606386
The generated pressure mean: 0.4399241805076599
loss_pred:0.01918746531009674, decouple_loss:0.0024363119155168533
The generated pressure mean: 0.43700388073921204
loss_pred:0.018681230023503304, decouple_loss:0.002541606081649661
Iteration: 6854, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485313296318054
loss_pred:0.01719503663480282, decouple_loss:0.002703751204535365
The generated pressure mean: 0.4469923973083496
loss_pred:0.017803799360990524, decouple_loss:0.0025188769213855267
The generated pressure mean: 0.4403300881385803
loss_pred:0.017764119431376457, decouple_loss:0.0026329176034778357
Iteration: 6855, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485035836696625
loss_pred:0.019072331488132477, decouple_loss:0.0029765486251562834
The generated pressure mean: 0.4475231170654297
loss_pred:0.017817774787545204, decouple_loss:0.003002000506967306
The generated pressure mean: 0.44876667857170105
loss_pred:0.018184922635555267, decouple_loss:0.002961572725325823
Iteration: 6856, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45442330837249756
loss_pred:0.02007727324962616, decouple_loss:0.0028968211263418198
The generated pressure mean: 0.45686450600624084
loss_pred:0.01761750690639019, decouple_loss:0.0028973426669836044
The generated pressure mean: 0.4554280936717987
loss_pred:0.019718196243047714, decouple_loss:0.0029147728346288204
Iteration: 6857, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4444553256034851
loss_pred:0.018790079280734062, decouple_loss:0.0035776172298938036
The generated pressure mean: 0.4417073428630829
loss_pred:0.017566781491041183, decouple_loss:0.0035134553909301758
The generated pressure mean: 0.44229060411453247
loss_pred:0.019245695322752, decouple_loss:0.0036187400110065937
Iteration: 6858, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4429730772972107
loss_pred:0.01866667903959751, decouple_loss:0.002714375499635935
The generated pressure mean: 0.43832525610923767
loss_pred:0.019450461491942406, decouple_loss:0.0026263059116899967
The generated pressure mean: 0.44299793243408203
loss_pred:0.018733741715550423, decouple_loss:0.002744037890806794
Iteration: 6859, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45767998695373535
The generated pressure mean: 0.45777368545532227
loss_pred:0.017308084294199944, decouple_loss:0.003913940861821175
loss_pred:0.018337905406951904, decouple_loss:0.004086142405867577
The generated pressure mean: 0.4601152241230011
loss_pred:0.01890362799167633, decouple_loss:0.004041479434818029
Iteration: 6860, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45432591438293457
loss_pred:0.018303606659173965, decouple_loss:0.002806037198752165
The generated pressure mean: 0.462100625038147
loss_pred:0.017153369262814522, decouple_loss:0.0030119025614112616
The generated pressure mean: 0.46209192276000977
loss_pred:0.017777681350708008, decouple_loss:0.002924830187112093
2023-04-17 13:34:28 testing...
The generated pressure mean: 0.415574848651886
The generated pressure mean: 0.4227362275123596
loss_pred:0.03341861814260483, decouple_loss:0.0035646213218569756
The generated pressure mean: 0.4258861541748047
loss_pred:0.0321054570376873, decouple_loss:0.003806635970249772
loss_pred:0.03180922940373421, decouple_loss:0.003977509215474129
WV_0_PC_0_EH_1_PS_40, loss: 0.03263358399271965, avg_mse: 0.04991410672664642
current test mse: 0.049914
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
Iteration: 6861, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4375098645687103
loss_pred:0.018267888575792313, decouple_loss:0.00313786999322474
The generated pressure mean: 0.4367014765739441
The generated pressure mean: 0.4394277036190033
loss_pred:0.018385548144578934, decouple_loss:0.003119360189884901
loss_pred:0.018632810562849045, decouple_loss:0.003002114361152053
Iteration: 6862, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4285295009613037
The generated pressure mean: 0.4304410517215729
loss_pred:0.01896754465997219, decouple_loss:0.0029423502273857594
loss_pred:0.020860666409134865, decouple_loss:0.0029013087041676044
The generated pressure mean: 0.43389004468917847
loss_pred:0.01757078245282173, decouple_loss:0.0029376756865531206
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 6863, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45356738567352295
loss_pred:0.020002493634819984, decouple_loss:0.0028259416576474905
The generated pressure mean: 0.4475302994251251
loss_pred:0.019197668880224228, decouple_loss:0.0028426535427570343
The generated pressure mean: 0.4452924132347107
loss_pred:0.0179677102714777, decouple_loss:0.0027744038961827755
Iteration: 6864, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4544323980808258
loss_pred:0.019622696563601494, decouple_loss:0.002940985606983304
The generated pressure mean: 0.45756766200065613
loss_pred:0.01920369267463684, decouple_loss:0.003013621550053358
The generated pressure mean: 0.4524647891521454
loss_pred:0.018230590969324112, decouple_loss:0.0030890339985489845
Iteration: 6865, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4433881938457489
loss_pred:0.01765625737607479, decouple_loss:0.0025635818019509315
The generated pressure mean: 0.44839343428611755
loss_pred:0.019485726952552795, decouple_loss:0.0025933897122740746
The generated pressure mean: 0.4502648115158081
loss_pred:0.02004425786435604, decouple_loss:0.0025145341642200947
Iteration: 6866, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4376285970211029
loss_pred:0.01804351434111595, decouple_loss:0.0027463086880743504
The generated pressure mean: 0.4453505277633667
loss_pred:0.01870451495051384, decouple_loss:0.002762449439615011
The generated pressure mean: 0.4407579004764557
loss_pred:0.018758218735456467, decouple_loss:0.002744563389569521
Iteration: 6867, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43990427255630493
loss_pred:0.018154295161366463, decouple_loss:0.0025208136066794395
The generated pressure mean: 0.44533097743988037
loss_pred:0.018002422526478767, decouple_loss:0.0023519417736679316
The generated pressure mean: 0.44664427638053894
loss_pred:0.018985284492373466, decouple_loss:0.0024135380517691374
Iteration: 6868, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44240817427635193
The generated pressure mean: 0.44777712225914
loss_pred:0.01823570765554905, decouple_loss:0.0023923064582049847
loss_pred:0.019758233800530434, decouple_loss:0.0025229707825928926
The generated pressure mean: 0.4427923262119293
loss_pred:0.018706195056438446, decouple_loss:0.002519102767109871
Iteration: 6869, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44030407071113586
The generated pressure mean: 0.448147714138031
loss_pred:0.018924247473478317, decouple_loss:0.0026373250875622034
loss_pred:0.020871121436357498, decouple_loss:0.0026968771126121283
The generated pressure mean: 0.4431890547275543
loss_pred:0.018937092274427414, decouple_loss:0.0027453124057501554
Iteration: 6870, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4453577399253845
The generated pressure mean: 0.44717904925346375
loss_pred:0.01888221502304077, decouple_loss:0.0024193688295781612
loss_pred:0.018184123560786247, decouple_loss:0.002524461830034852
The generated pressure mean: 0.4421657621860504
loss_pred:0.018012331798672676, decouple_loss:0.002529898891225457
2023-04-17 13:37:00 testing...
The generated pressure mean: 0.41139769554138184
The generated pressure mean: 0.4185907244682312
The generated pressure mean: 0.42125335335731506
loss_pred:0.03346041589975357, decouple_loss:0.0029730815440416336
loss_pred:0.03202592954039574, decouple_loss:0.00319397309795022
loss_pred:0.03144800662994385, decouple_loss:0.003291703760623932
WV_0_PC_0_EH_1_PS_40, loss: 0.03246909752488136, avg_mse: 0.049404628574848175
current test mse: 0.049405
Iteration: 6871, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488343596458435
The generated pressure mean: 0.4485507905483246
loss_pred:0.017799869179725647, decouple_loss:0.002735169604420662
loss_pred:0.01794634759426117, decouple_loss:0.002698583761230111
The generated pressure mean: 0.456593781709671
loss_pred:0.019384941086173058, decouple_loss:0.0025098875630646944
Iteration: 6872, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449741542339325
loss_pred:0.01845856010913849, decouple_loss:0.002673656214028597
The generated pressure mean: 0.43984290957450867
loss_pred:0.01888209581375122, decouple_loss:0.002709975466132164
The generated pressure mean: 0.4460093080997467
loss_pred:0.018566548824310303, decouple_loss:0.0026051197201013565
Iteration: 6873, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43875667452812195
loss_pred:0.018736613914370537, decouple_loss:0.0025370183866471052
The generated pressure mean: 0.43990519642829895
loss_pred:0.01821943372488022, decouple_loss:0.0024613593704998493
The generated pressure mean: 0.4357079267501831
loss_pred:0.01812455803155899, decouple_loss:0.0025780831929296255
Iteration: 6874, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45000752806663513
The generated pressure mean: 0.44901129603385925
loss_pred:0.01867196150124073, decouple_loss:0.0024692262522876263
loss_pred:0.017971264198422432, decouple_loss:0.0024297351483255625
The generated pressure mean: 0.44684529304504395
loss_pred:0.020491618663072586, decouple_loss:0.0023819177877157927
Iteration: 6875, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4596449136734009
loss_pred:0.021602042019367218, decouple_loss:0.0025900688488036394
The generated pressure mean: 0.451980322599411
loss_pred:0.018391672521829605, decouple_loss:0.002534849103540182
The generated pressure mean: 0.4465513527393341
loss_pred:0.018127938732504845, decouple_loss:0.0025555386673659086
Iteration: 6876, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43724292516708374
The generated pressure mean: 0.4381202459335327
loss_pred:0.018534071743488312, decouple_loss:0.0023236190900206566
loss_pred:0.01821484975516796, decouple_loss:0.002277270657941699
The generated pressure mean: 0.4374256432056427
loss_pred:0.017971625551581383, decouple_loss:0.0023910056333988905
Iteration: 6877, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44081515073776245
loss_pred:0.01887544058263302, decouple_loss:0.0027702858205884695
The generated pressure mean: 0.43684592843055725
loss_pred:0.019526319578289986, decouple_loss:0.0026784278452396393
The generated pressure mean: 0.43602287769317627
loss_pred:0.01836293376982212, decouple_loss:0.002606463385745883
Iteration: 6878, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4530571699142456
loss_pred:0.0178326778113842, decouple_loss:0.0022510038688778877
The generated pressure mean: 0.45341575145721436
loss_pred:0.01870150677859783, decouple_loss:0.0023201003205031157
The generated pressure mean: 0.4536959230899811
loss_pred:0.0197293721139431, decouple_loss:0.002284687478095293
Iteration: 6879, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4513954818248749The generated pressure mean: 0.45156317949295044
loss_pred:0.01873980090022087, decouple_loss:0.002433521207422018
loss_pred:0.018669553101062775, decouple_loss:0.0023799999617040157
The generated pressure mean: 0.4523944556713104
loss_pred:0.019499842077493668, decouple_loss:0.00240820599719882
Iteration: 6880, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4367902874946594
loss_pred:0.01906130649149418, decouple_loss:0.0026100005488842726
The generated pressure mean: 0.4367862641811371
The generated pressure mean: 0.4364461898803711
loss_pred:0.019442802295088768, decouple_loss:0.00255769700743258
loss_pred:0.017901651561260223, decouple_loss:0.0025839931331574917
2023-04-17 13:38:53 testing...
The generated pressure mean: 0.4143916666507721
The generated pressure mean: 0.42133763432502747
loss_pred:0.03148096427321434, decouple_loss:0.003033845219761133
The generated pressure mean: 0.4241328835487366
loss_pred:0.030702000483870506, decouple_loss:0.0032388109248131514
loss_pred:0.030238788574934006, decouple_loss:0.003358716843649745
WV_0_PC_0_EH_1_PS_40, loss: 0.030967775732278824, avg_mse: 0.046404287219047546
current test mse: 0.046404
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 6881, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4415999948978424
loss_pred:0.018440859392285347, decouple_loss:0.002814406994730234
The generated pressure mean: 0.4436126947402954
loss_pred:0.01770625449717045, decouple_loss:0.0027958163991570473
The generated pressure mean: 0.43697237968444824
loss_pred:0.01805577240884304, decouple_loss:0.002731860149651766
Iteration: 6882, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4588279128074646
The generated pressure mean: 0.4586872160434723
loss_pred:0.018076026812195778, decouple_loss:0.002815046813338995
loss_pred:0.018765104934573174, decouple_loss:0.0027342773973941803
The generated pressure mean: 0.45890048146247864
loss_pred:0.01710815541446209, decouple_loss:0.0027481636498123407
Iteration: 6883, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45090582966804504
loss_pred:0.017253583297133446, decouple_loss:0.00252450630068779
The generated pressure mean: 0.4501952826976776
loss_pred:0.0191043708473444, decouple_loss:0.002630550879985094
The generated pressure mean: 0.44831734895706177
loss_pred:0.01697067730128765, decouple_loss:0.0025588315911591053
Iteration: 6884, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43837544322013855The generated pressure mean: 0.43807452917099
loss_pred:0.018138602375984192, decouple_loss:0.0028742756694555283
loss_pred:0.018911374732851982, decouple_loss:0.0029242970049381256
The generated pressure mean: 0.4379126727581024
loss_pred:0.017641901969909668, decouple_loss:0.002907470101490617
Iteration: 6885, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4415508508682251
loss_pred:0.020551128312945366, decouple_loss:0.00233484897762537
The generated pressure mean: 0.44338127970695496
loss_pred:0.01755714975297451, decouple_loss:0.0022640943061560392
The generated pressure mean: 0.4422440230846405
loss_pred:0.019362427294254303, decouple_loss:0.0023655244149267673
Iteration: 6886, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4365810751914978
The generated pressure mean: 0.4358690679073334
loss_pred:0.018091628327965736, decouple_loss:0.003467607544735074
loss_pred:0.01909523643553257, decouple_loss:0.0033982915338128805
The generated pressure mean: 0.43681302666664124
loss_pred:0.01833379827439785, decouple_loss:0.003514618147164583
Iteration: 6887, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4524262249469757
The generated pressure mean: 0.45421022176742554
loss_pred:0.01686113141477108, decouple_loss:0.0029249335639178753
loss_pred:0.018312035128474236, decouple_loss:0.0029804387595504522
The generated pressure mean: 0.46022066473960876
loss_pred:0.019343288615345955, decouple_loss:0.0029536611400544643
Iteration: 6888, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4573718011379242
loss_pred:0.016968276351690292, decouple_loss:0.0030241552740335464
The generated pressure mean: 0.46040838956832886
loss_pred:0.017324618995189667, decouple_loss:0.003078659065067768
The generated pressure mean: 0.46094223856925964
loss_pred:0.018440507352352142, decouple_loss:0.002996824448928237
Iteration: 6889, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44023025035858154
loss_pred:0.016289832070469856, decouple_loss:0.0028971508145332336
The generated pressure mean: 0.43815723061561584
loss_pred:0.018302511423826218, decouple_loss:0.003037463640794158
The generated pressure mean: 0.4441714286804199
loss_pred:0.01762237399816513, decouple_loss:0.0029220881406217813
Iteration: 6890, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4454399049282074
The generated pressure mean: 0.4432467520236969
loss_pred:0.018804913386702538, decouple_loss:0.0028036031872034073
loss_pred:0.01870700530707836, decouple_loss:0.00302132754586637
The generated pressure mean: 0.44123828411102295
loss_pred:0.01880352385342121, decouple_loss:0.002898780396208167
2023-04-17 13:41:25 testing...
The generated pressure mean: 0.41341668367385864
The generated pressure mean: 0.42060586810112
The generated pressure mean: 0.4229618012905121
loss_pred:0.032600514590740204, decouple_loss:0.0033945960458368063
loss_pred:0.03154270723462105, decouple_loss:0.00360067468136549
loss_pred:0.031405266374349594, decouple_loss:0.0037496837321668863
WV_0_PC_0_EH_1_PS_40, loss: 0.03202857822179794, avg_mse: 0.04854974150657654
current test mse: 0.04855
Iteration: 6891, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44672125577926636
loss_pred:0.01900145411491394, decouple_loss:0.0029265652410686016
The generated pressure mean: 0.44633471965789795
loss_pred:0.016539951786398888, decouple_loss:0.0029015361797064543
The generated pressure mean: 0.44739165902137756
loss_pred:0.017738914117217064, decouple_loss:0.002930363640189171
Iteration: 6892, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45233410596847534
loss_pred:0.01903243362903595, decouple_loss:0.002424453618004918
The generated pressure mean: 0.4485217332839966
loss_pred:0.01845705695450306, decouple_loss:0.0023729228414595127
The generated pressure mean: 0.4488082528114319
loss_pred:0.01757429912686348, decouple_loss:0.0023960506077855825
Iteration: 6893, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44584012031555176
loss_pred:0.0200087521225214, decouple_loss:0.0039014630019664764
The generated pressure mean: 0.4406728744506836
loss_pred:0.017587842419743538, decouple_loss:0.003661209484562278
The generated pressure mean: 0.4418342709541321
loss_pred:0.018233099952340126, decouple_loss:0.0037194439209997654
Iteration: 6894, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43725574016571045
loss_pred:0.017988109961152077, decouple_loss:0.0031089354306459427
The generated pressure mean: 0.4439312517642975
loss_pred:0.018641620874404907, decouple_loss:0.003052861662581563
The generated pressure mean: 0.4390123188495636
loss_pred:0.016947677358984947, decouple_loss:0.002916846191510558
Iteration: 6895, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45615166425704956
loss_pred:0.017652282491326332, decouple_loss:0.002954608527943492
The generated pressure mean: 0.4567893445491791
loss_pred:0.018774624913930893, decouple_loss:0.0028695114888250828
The generated pressure mean: 0.45083653926849365
loss_pred:0.019013676792383194, decouple_loss:0.002879665233194828
Iteration: 6896, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45263364911079407
loss_pred:0.018497496843338013, decouple_loss:0.0041049569845199585
The generated pressure mean: 0.4547029435634613
loss_pred:0.017167679965496063, decouple_loss:0.004208476282656193
The generated pressure mean: 0.44863033294677734
loss_pred:0.0190255269408226, decouple_loss:0.0039481520652771
Iteration: 6897, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44229254126548767
loss_pred:0.018346663564443588, decouple_loss:0.003552759764716029
The generated pressure mean: 0.44234704971313477
loss_pred:0.01866377517580986, decouple_loss:0.003629470942541957
The generated pressure mean: 0.44611942768096924
loss_pred:0.017468640580773354, decouple_loss:0.0036281098145991564
Iteration: 6898, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4356638491153717
The generated pressure mean: 0.4452663064002991
loss_pred:0.017929021269083023, decouple_loss:0.002695739734917879
loss_pred:0.01852905936539173, decouple_loss:0.0028452568221837282
The generated pressure mean: 0.4391492009162903
loss_pred:0.017521683126688004, decouple_loss:0.0027767764404416084
Iteration: 6899, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4453640580177307
The generated pressure mean: 0.4440491199493408
loss_pred:0.01840079575777054, decouple_loss:0.0029749940149486065
loss_pred:0.017639460042119026, decouple_loss:0.002965411404147744
The generated pressure mean: 0.44513973593711853
loss_pred:0.01790492609143257, decouple_loss:0.0029307424556463957
Iteration: 6900, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4516308605670929
The generated pressure mean: 0.4511326253414154
loss_pred:0.019033493474125862, decouple_loss:0.002652806928381324
loss_pred:0.01947995088994503, decouple_loss:0.0027042473666369915
The generated pressure mean: 0.4502449035644531
loss_pred:0.018096541985869408, decouple_loss:0.0026391567662358284
2023-04-17 13:43:19 testing...
The generated pressure mean: 0.41949984431266785
The generated pressure mean: 0.4132553040981293
The generated pressure mean: 0.4221670925617218
loss_pred:0.03129420429468155, decouple_loss:0.0034054690040647984
loss_pred:0.03230013698339462, decouple_loss:0.003127342090010643
loss_pred:0.030554596334695816, decouple_loss:0.00349250016734004
WV_0_PC_0_EH_1_PS_40, loss: 0.03155006468296051, avg_mse: 0.04735589772462845
current test mse: 0.047356
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 6901, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472081661224365
loss_pred:0.01823057234287262, decouple_loss:0.00275442935526371
The generated pressure mean: 0.44721469283103943
loss_pred:0.017943868413567543, decouple_loss:0.0027315213810652494
The generated pressure mean: 0.4483606517314911
loss_pred:0.01770589128136635, decouple_loss:0.002774761524051428
Iteration: 6902, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4412260353565216
The generated pressure mean: 0.4407835304737091
loss_pred:0.01853514462709427, decouple_loss:0.0023116518277674913
loss_pred:0.018358467146754265, decouple_loss:0.0023596163373440504
The generated pressure mean: 0.44232532382011414
loss_pred:0.016263656318187714, decouple_loss:0.0023504646960645914
Iteration: 6903, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44742992520332336
The generated pressure mean: 0.4480751156806946
loss_pred:0.017620304599404335, decouple_loss:0.0027663069777190685
loss_pred:0.01834523305296898, decouple_loss:0.0027115021366626024
The generated pressure mean: 0.4456770420074463
loss_pred:0.01925404742360115, decouple_loss:0.002733886241912842
Iteration: 6904, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493441581726074
The generated pressure mean: 0.4477410316467285
loss_pred:0.018163712695240974, decouple_loss:0.0029130668845027685
loss_pred:0.01720769703388214, decouple_loss:0.002968098735436797
The generated pressure mean: 0.4450158476829529
loss_pred:0.018301060423254967, decouple_loss:0.002816571854054928
Iteration: 6905, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44542789459228516
The generated pressure mean: 0.4461187720298767
loss_pred:0.01919849030673504, decouple_loss:0.0023455284535884857
loss_pred:0.01795273646712303, decouple_loss:0.002331347204744816
The generated pressure mean: 0.4413239657878876
loss_pred:0.01809193752706051, decouple_loss:0.002246109303086996
Iteration: 6906, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4544360935688019
The generated pressure mean: 0.4531719982624054
loss_pred:0.019242199137806892, decouple_loss:0.002770987106487155
loss_pred:0.01853792741894722, decouple_loss:0.002758766757324338
The generated pressure mean: 0.4558689594268799
loss_pred:0.01658422313630581, decouple_loss:0.002835826249793172
Iteration: 6907, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470749795436859
The generated pressure mean: 0.44675007462501526
loss_pred:0.01730431616306305, decouple_loss:0.002700686687603593
loss_pred:0.017476052045822144, decouple_loss:0.002750957850366831
The generated pressure mean: 0.44585591554641724
loss_pred:0.016947027295827866, decouple_loss:0.0027967875357717276
Iteration: 6908, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4451494812965393
loss_pred:0.017243865877389908, decouple_loss:0.002808094024658203
The generated pressure mean: 0.44394341111183167
loss_pred:0.01742146536707878, decouple_loss:0.0027913260273635387
The generated pressure mean: 0.44547751545906067
loss_pred:0.01847236603498459, decouple_loss:0.002676080446690321
Iteration: 6909, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44524794816970825
loss_pred:0.017612917348742485, decouple_loss:0.0026423707604408264
The generated pressure mean: 0.44536226987838745
loss_pred:0.018051140010356903, decouple_loss:0.002542037982493639
The generated pressure mean: 0.44910433888435364
loss_pred:0.017698388546705246, decouple_loss:0.002583736088126898
Iteration: 6910, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44795650243759155
loss_pred:0.01711888797581196, decouple_loss:0.0026129172183573246
The generated pressure mean: 0.45363208651542664
loss_pred:0.0171152725815773, decouple_loss:0.0025903538335114717
The generated pressure mean: 0.44669950008392334
loss_pred:0.01864379644393921, decouple_loss:0.002715475857257843
2023-04-17 13:45:51 testing...
The generated pressure mean: 0.41469675302505493
The generated pressure mean: 0.4233895242214203
The generated pressure mean: 0.4265058636665344
loss_pred:0.032079603523015976, decouple_loss:0.0032397115137428045
loss_pred:0.030712103471159935, decouple_loss:0.0035191376227885485
loss_pred:0.030171960592269897, decouple_loss:0.0035630196798592806
WV_0_PC_0_EH_1_PS_40, loss: 0.03115992061793804, avg_mse: 0.04735220596194267
current test mse: 0.047352
Iteration: 6911, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44674548506736755
loss_pred:0.01739448681473732, decouple_loss:0.0026925394777208567
The generated pressure mean: 0.44853347539901733
loss_pred:0.017020799219608307, decouple_loss:0.002739265561103821
The generated pressure mean: 0.44497939944267273
loss_pred:0.017687296494841576, decouple_loss:0.002808715682476759
Iteration: 6912, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44094187021255493
loss_pred:0.01701505482196808, decouple_loss:0.002386367879807949
The generated pressure mean: 0.4391193091869354
loss_pred:0.018752016127109528, decouple_loss:0.0024535944685339928
The generated pressure mean: 0.4391767382621765
loss_pred:0.01743341237306595, decouple_loss:0.0023289730306714773
Iteration: 6913, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44928795099258423
loss_pred:0.018575230613350868, decouple_loss:0.0024142474867403507
The generated pressure mean: 0.44550246000289917
loss_pred:0.016453232616186142, decouple_loss:0.002410351298749447
The generated pressure mean: 0.44983625411987305
loss_pred:0.016996219754219055, decouple_loss:0.0024800433311611414
Iteration: 6914, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44608771800994873
loss_pred:0.016679909080266953, decouple_loss:0.002435474656522274
The generated pressure mean: 0.4473848342895508
loss_pred:0.01836996152997017, decouple_loss:0.002437948016449809
The generated pressure mean: 0.44657278060913086
loss_pred:0.01867322437465191, decouple_loss:0.002343131462112069
Iteration: 6915, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45440348982810974
loss_pred:0.01711171120405197, decouple_loss:0.002756383502855897
The generated pressure mean: 0.4504425525665283
loss_pred:0.018555596470832825, decouple_loss:0.002783391624689102
The generated pressure mean: 0.45202502608299255
loss_pred:0.017533689737319946, decouple_loss:0.002695328090339899
Iteration: 6916, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44279050827026367
loss_pred:0.017174744978547096, decouple_loss:0.0025881498586386442
The generated pressure mean: 0.4397903382778168
loss_pred:0.016946597024798393, decouple_loss:0.0026249613147228956
The generated pressure mean: 0.44144585728645325
loss_pred:0.01797725073993206, decouple_loss:0.002532591810449958
Iteration: 6917, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4451928436756134
loss_pred:0.017276659607887268, decouple_loss:0.0021519188303500414
The generated pressure mean: 0.4484618902206421
loss_pred:0.0174725279211998, decouple_loss:0.0022212520707398653
The generated pressure mean: 0.44471535086631775
loss_pred:0.01728193275630474, decouple_loss:0.002322292188182473
Iteration: 6918, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4512248933315277
loss_pred:0.017813535407185555, decouple_loss:0.0023427680134773254
The generated pressure mean: 0.45410463213920593
loss_pred:0.018781518563628197, decouple_loss:0.0023070108145475388
The generated pressure mean: 0.4544393718242645
loss_pred:0.01672385446727276, decouple_loss:0.0023172989021986723
Iteration: 6919, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44317689538002014
The generated pressure mean: 0.44185662269592285
loss_pred:0.016285140067338943, decouple_loss:0.002534880768507719
loss_pred:0.017560239881277084, decouple_loss:0.002512573264539242
The generated pressure mean: 0.44499483704566956
loss_pred:0.016559449955821037, decouple_loss:0.002505348064005375
Iteration: 6920, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44668760895729065
loss_pred:0.017353424802422523, decouple_loss:0.002149940002709627
The generated pressure mean: 0.44812828302383423
loss_pred:0.017550181597471237, decouple_loss:0.0021677420008927584
The generated pressure mean: 0.4482612907886505
loss_pred:0.016362106427550316, decouple_loss:0.0021379441022872925
2023-04-17 13:47:45 testing...
The generated pressure mean: 0.42090150713920593
The generated pressure mean: 0.41400250792503357
The generated pressure mean: 0.4243779182434082
loss_pred:0.030494367703795433, decouple_loss:0.002771267667412758
loss_pred:0.03157712519168854, decouple_loss:0.002654463052749634
loss_pred:0.029848968610167503, decouple_loss:0.0028581535443663597
WV_0_PC_0_EH_1_PS_40, loss: 0.030778219923377037, avg_mse: 0.046490710228681564
current test mse: 0.046491
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 6921, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44559046626091003
loss_pred:0.01824997179210186, decouple_loss:0.0022263627033680677
The generated pressure mean: 0.43983444571495056
loss_pred:0.01747850514948368, decouple_loss:0.0022435057908296585
The generated pressure mean: 0.44376519322395325
loss_pred:0.01848478615283966, decouple_loss:0.002270383993163705
Iteration: 6922, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44476252794265747
The generated pressure mean: 0.44104889035224915
loss_pred:0.019481759518384933, decouple_loss:0.002541785594075918
loss_pred:0.01791750267148018, decouple_loss:0.002401535864919424
The generated pressure mean: 0.4460599720478058
loss_pred:0.01814826764166355, decouple_loss:0.002530606696382165
Iteration: 6923, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4521659314632416
loss_pred:0.017884396016597748, decouple_loss:0.0023184423334896564
The generated pressure mean: 0.4475000202655792
loss_pred:0.018212541937828064, decouple_loss:0.002247098833322525
The generated pressure mean: 0.44786208868026733
loss_pred:0.01947885937988758, decouple_loss:0.0023768828250467777
Iteration: 6924, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44139236211776733
loss_pred:0.018184516578912735, decouple_loss:0.0026041970122605562
The generated pressure mean: 0.4387972056865692
loss_pred:0.01750262640416622, decouple_loss:0.002560435328632593
The generated pressure mean: 0.45153748989105225
loss_pred:0.018287936225533485, decouple_loss:0.002515658736228943
Iteration: 6925, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45437711477279663
loss_pred:0.018456310033798218, decouple_loss:0.0029026747215539217
The generated pressure mean: 0.4430529475212097
loss_pred:0.01807183027267456, decouple_loss:0.002771214582026005
The generated pressure mean: 0.44743648171424866
loss_pred:0.0197471734136343, decouple_loss:0.0026631313376128674
Iteration: 6926, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44865718483924866
loss_pred:0.01738102175295353, decouple_loss:0.0025305997114628553
The generated pressure mean: 0.45366066694259644
loss_pred:0.018688775599002838, decouple_loss:0.0025720447301864624
The generated pressure mean: 0.4478946030139923
loss_pred:0.018855763599276543, decouple_loss:0.0024838894605636597
Iteration: 6927, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44500210881233215
loss_pred:0.017571503296494484, decouple_loss:0.0024482363369315863
The generated pressure mean: 0.4457568824291229
loss_pred:0.01828472502529621, decouple_loss:0.00238410453312099
The generated pressure mean: 0.43855515122413635
loss_pred:0.018258843570947647, decouple_loss:0.0024596666917204857
Iteration: 6928, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44158318638801575
The generated pressure mean: 0.4456733763217926
loss_pred:0.01845993474125862, decouple_loss:0.0033283759839832783
loss_pred:0.017820503562688828, decouple_loss:0.0033235561568289995
The generated pressure mean: 0.44476187229156494
loss_pred:0.016704102978110313, decouple_loss:0.003455063095316291
Iteration: 6929, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45212510228157043
loss_pred:0.017913764342665672, decouple_loss:0.003655562177300453
The generated pressure mean: 0.45178061723709106
loss_pred:0.018015362322330475, decouple_loss:0.003723123576492071
The generated pressure mean: 0.44996213912963867
loss_pred:0.017052479088306427, decouple_loss:0.003602243261411786
Iteration: 6930, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45103514194488525
loss_pred:0.01705263927578926, decouple_loss:0.0026868442073464394
The generated pressure mean: 0.4515823423862457
loss_pred:0.018790975213050842, decouple_loss:0.0027010636404156685
The generated pressure mean: 0.4459162652492523
loss_pred:0.01829651929438114, decouple_loss:0.0026795153971761465
2023-04-17 13:50:13 testing...
The generated pressure mean: 0.4150794446468353
The generated pressure mean: 0.42222025990486145
The generated pressure mean: 0.42529475688934326
loss_pred:0.03135405480861664, decouple_loss:0.004903728608042002
loss_pred:0.03028910793364048, decouple_loss:0.005047862883657217
loss_pred:0.029789282009005547, decouple_loss:0.005144063849002123
WV_0_PC_0_EH_1_PS_40, loss: 0.030729075893759727, avg_mse: 0.04627426341176033
current test mse: 0.046274
Iteration: 6931, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4378381669521332
loss_pred:0.018585344776511192, decouple_loss:0.004839626140892506
The generated pressure mean: 0.4420398473739624
loss_pred:0.018603436648845673, decouple_loss:0.004868858493864536
The generated pressure mean: 0.44092872738838196
loss_pred:0.018797365948557854, decouple_loss:0.004947314504534006
Iteration: 6932, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44602444767951965
loss_pred:0.01664082705974579, decouple_loss:0.0041501931846141815
The generated pressure mean: 0.4455263614654541
loss_pred:0.018429197371006012, decouple_loss:0.004210133571177721
The generated pressure mean: 0.44388872385025024
loss_pred:0.016881929710507393, decouple_loss:0.004067069385200739
Iteration: 6933, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44973769783973694
loss_pred:0.01855543442070484, decouple_loss:0.0036666758824139833
The generated pressure mean: 0.4521660804748535
loss_pred:0.01672731526196003, decouple_loss:0.0035960949026048183
The generated pressure mean: 0.4534165561199188
loss_pred:0.019626663997769356, decouple_loss:0.003768268274143338
Iteration: 6934, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476143717765808
loss_pred:0.020084839314222336, decouple_loss:0.002981943776831031
The generated pressure mean: 0.4474239945411682
loss_pred:0.016845570877194405, decouple_loss:0.0029071755707263947
The generated pressure mean: 0.44598689675331116
loss_pred:0.016741354018449783, decouple_loss:0.0028754035010933876
Iteration: 6935, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4417705237865448
loss_pred:0.017398249357938766, decouple_loss:0.0038700399454683065
The generated pressure mean: 0.43290001153945923
loss_pred:0.01994422636926174, decouple_loss:0.003827461041510105
The generated pressure mean: 0.4343472421169281
loss_pred:0.017506876960396767, decouple_loss:0.003976925276219845
Iteration: 6936, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44342759251594543
loss_pred:0.01846914179623127, decouple_loss:0.003225774737074971
The generated pressure mean: 0.4444465935230255
loss_pred:0.018446044996380806, decouple_loss:0.0031822994351387024
The generated pressure mean: 0.45351314544677734
loss_pred:0.019431650638580322, decouple_loss:0.003078124485909939
Iteration: 6937, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45201611518859863
loss_pred:0.017892807722091675, decouple_loss:0.002339626895263791
The generated pressure mean: 0.4541305899620056
loss_pred:0.01727401837706566, decouple_loss:0.0025083760265260935
The generated pressure mean: 0.4537651240825653
loss_pred:0.017787013202905655, decouple_loss:0.002370451809838414
Iteration: 6938, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4440855383872986
loss_pred:0.017529575154185295, decouple_loss:0.003914253786206245
The generated pressure mean: 0.4471459686756134
loss_pred:0.017638202756643295, decouple_loss:0.0038837306201457977
The generated pressure mean: 0.4412742257118225
loss_pred:0.01871166005730629, decouple_loss:0.0038847902324050665
Iteration: 6939, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4458589553833008
loss_pred:0.017394132912158966, decouple_loss:0.002911265706643462
The generated pressure mean: 0.44903483986854553
loss_pred:0.019041884690523148, decouple_loss:0.0025846485514193773
The generated pressure mean: 0.44757771492004395
loss_pred:0.018184226006269455, decouple_loss:0.0029511963948607445
Iteration: 6940, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467877447605133
loss_pred:0.01848756894469261, decouple_loss:0.004213591571897268
The generated pressure mean: 0.4488961398601532
loss_pred:0.01836227998137474, decouple_loss:0.004185250028967857
The generated pressure mean: 0.4486357867717743
loss_pred:0.01754763349890709, decouple_loss:0.0041806395165622234
2023-04-17 13:52:06 testing...
The generated pressure mean: 0.4148840010166168
The generated pressure mean: 0.4226204454898834
The generated pressure mean: 0.42620405554771423
loss_pred:0.03141028806567192, decouple_loss:0.00365850911475718
loss_pred:0.030066192150115967, decouple_loss:0.003856392577290535
loss_pred:0.029676824808120728, decouple_loss:0.0037862099707126617
WV_0_PC_0_EH_1_PS_40, loss: 0.030572786927223206, avg_mse: 0.046097151935100555
current test mse: 0.046097
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 6941, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446042001247406
loss_pred:0.017516260966658592, decouple_loss:0.0033924230374395847
The generated pressure mean: 0.44434529542922974
loss_pred:0.018163222819566727, decouple_loss:0.0030644021462649107
The generated pressure mean: 0.445436954498291
loss_pred:0.019183188676834106, decouple_loss:0.0033443456050008535
Iteration: 6942, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44798892736434937
The generated pressure mean: 0.4519452750682831
loss_pred:0.017563436180353165, decouple_loss:0.004145758226513863
loss_pred:0.018563084304332733, decouple_loss:0.004102934617549181
The generated pressure mean: 0.44281038641929626
loss_pred:0.01790103316307068, decouple_loss:0.0040339212864637375
Iteration: 6943, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44416606426239014
The generated pressure mean: 0.44246622920036316
loss_pred:0.017927417531609535, decouple_loss:0.002443467965349555
loss_pred:0.01685979776084423, decouple_loss:0.002456764690577984
The generated pressure mean: 0.4415324032306671
loss_pred:0.018062787130475044, decouple_loss:0.0024846927262842655
Iteration: 6944, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45055142045021057
The generated pressure mean: 0.4493200182914734
loss_pred:0.017264340072870255, decouple_loss:0.003866841783747077
loss_pred:0.01892179809510708, decouple_loss:0.0040699574165046215
The generated pressure mean: 0.44489800930023193
loss_pred:0.019051747396588326, decouple_loss:0.00411483459174633
Iteration: 6945, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503054916858673The generated pressure mean: 0.446370929479599
loss_pred:0.017740299925208092, decouple_loss:0.0033257082104682922
loss_pred:0.018785372376441956, decouple_loss:0.0036038989201188087
The generated pressure mean: 0.4495222866535187
loss_pred:0.016851888969540596, decouple_loss:0.0033874548971652985
Iteration: 6946, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467330873012543
The generated pressure mean: 0.4482266306877136
loss_pred:0.01793864369392395, decouple_loss:0.003942563664168119
loss_pred:0.018508300185203552, decouple_loss:0.00391058623790741
The generated pressure mean: 0.4453391432762146
loss_pred:0.01865055412054062, decouple_loss:0.0039046118035912514
Iteration: 6947, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4429151117801666
The generated pressure mean: 0.43813756108283997
loss_pred:0.017522048205137253, decouple_loss:0.0035748251248151064
loss_pred:0.017611095681786537, decouple_loss:0.0036531505174934864
The generated pressure mean: 0.4391699731349945
loss_pred:0.017437061294913292, decouple_loss:0.0036652495618909597
Iteration: 6948, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45183709263801575
The generated pressure mean: 0.45170196890830994
loss_pred:0.01741539128124714, decouple_loss:0.004270967096090317
loss_pred:0.01855526678264141, decouple_loss:0.004298425745218992
The generated pressure mean: 0.4516143202781677
loss_pred:0.016820190474390984, decouple_loss:0.004420690704137087
Iteration: 6949, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.452107310295105
loss_pred:0.01613296940922737, decouple_loss:0.0030944079626351595
The generated pressure mean: 0.45775988698005676
loss_pred:0.01904892362654209, decouple_loss:0.0031595914624631405
The generated pressure mean: 0.4512518644332886
loss_pred:0.017782947048544884, decouple_loss:0.0030988354701548815
Iteration: 6950, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4366544187068939
loss_pred:0.01661706529557705, decouple_loss:0.004930699709802866
The generated pressure mean: 0.43734991550445557
loss_pred:0.01814499869942665, decouple_loss:0.005156499333679676
The generated pressure mean: 0.43368226289749146
loss_pred:0.018723702058196068, decouple_loss:0.005156022030860186
2023-04-17 13:54:36 testing...
The generated pressure mean: 0.41512802243232727
The generated pressure mean: 0.42267081141471863
The generated pressure mean: 0.42585572600364685
loss_pred:0.031629834324121475, decouple_loss:0.004246386233717203
loss_pred:0.030395345762372017, decouple_loss:0.004442549776285887
loss_pred:0.030032210052013397, decouple_loss:0.004608764313161373
WV_0_PC_0_EH_1_PS_40, loss: 0.03090742602944374, avg_mse: 0.046752382069826126
current test mse: 0.046752
Iteration: 6951, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44567304849624634
The generated pressure mean: 0.44074252247810364
loss_pred:0.017937611788511276, decouple_loss:0.003954668994992971
loss_pred:0.017262913286685944, decouple_loss:0.003995832521468401
The generated pressure mean: 0.44118866324424744
loss_pred:0.01647910848259926, decouple_loss:0.004002771805971861
Iteration: 6952, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4531167149543762
loss_pred:0.01683778502047062, decouple_loss:0.004343528766185045
The generated pressure mean: 0.45335185527801514
loss_pred:0.016945403069257736, decouple_loss:0.004481340292841196
The generated pressure mean: 0.456413596868515
loss_pred:0.01933690346777439, decouple_loss:0.004605431575328112
Iteration: 6953, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44683244824409485
loss_pred:0.017528843134641647, decouple_loss:0.003412230173125863
The generated pressure mean: 0.45080575346946716
loss_pred:0.01748802699148655, decouple_loss:0.0032009929418563843
The generated pressure mean: 0.454921692609787
loss_pred:0.017597083002328873, decouple_loss:0.0035075191408395767
Iteration: 6954, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45093998312950134
loss_pred:0.020281577482819557, decouple_loss:0.0036367301363497972
The generated pressure mean: 0.45193666219711304
loss_pred:0.017897335812449455, decouple_loss:0.0035317474976181984
The generated pressure mean: 0.45352715253829956
loss_pred:0.018013715744018555, decouple_loss:0.0034632219467312098
Iteration: 6955, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4346863329410553
The generated pressure mean: 0.43508750200271606
loss_pred:0.016930142417550087, decouple_loss:0.0029992517083883286
loss_pred:0.019146155565977097, decouple_loss:0.0028408041689544916
The generated pressure mean: 0.43721145391464233
loss_pred:0.017847247421741486, decouple_loss:0.0027882899157702923
Iteration: 6956, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4433758556842804
loss_pred:0.018864307552576065, decouple_loss:0.0035708779469132423
The generated pressure mean: 0.44217732548713684
loss_pred:0.01741851679980755, decouple_loss:0.0036382125690579414
The generated pressure mean: 0.4458739757537842
loss_pred:0.01723853126168251, decouple_loss:0.0034909022506326437
Iteration: 6957, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.454610139131546
loss_pred:0.01816980354487896, decouple_loss:0.002944699488580227
The generated pressure mean: 0.4580014646053314
loss_pred:0.0197190772742033, decouple_loss:0.0028772479854524136
The generated pressure mean: 0.4553803503513336
loss_pred:0.017405297607183456, decouple_loss:0.0028122966177761555
Iteration: 6958, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44990554451942444
loss_pred:0.01799478940665722, decouple_loss:0.0032423606608062983
The generated pressure mean: 0.4498770534992218
loss_pred:0.019322838634252548, decouple_loss:0.0032892837189137936
The generated pressure mean: 0.44514742493629456
loss_pred:0.017139319330453873, decouple_loss:0.0031152721494436264
Iteration: 6959, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4379449188709259
loss_pred:0.01714198663830757, decouple_loss:0.0032462093513458967
The generated pressure mean: 0.44334763288497925
loss_pred:0.016965756192803383, decouple_loss:0.00297752907499671
The generated pressure mean: 0.44033730030059814
loss_pred:0.017677947878837585, decouple_loss:0.0031126318499445915
Iteration: 6960, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44466519355773926
loss_pred:0.01699056476354599, decouple_loss:0.00353974848985672
The generated pressure mean: 0.4498057961463928
loss_pred:0.018553471192717552, decouple_loss:0.0036301736254245043
The generated pressure mean: 0.4497302770614624
loss_pred:0.018457379192113876, decouple_loss:0.003748816205188632
2023-04-17 13:56:29 testing...
The generated pressure mean: 0.4145488739013672
The generated pressure mean: 0.42219290137290955
The generated pressure mean: 0.4251287877559662
loss_pred:0.03241574019193649, decouple_loss:0.0030495456885546446
loss_pred:0.030996346846222878, decouple_loss:0.0032116358634084463
loss_pred:0.03085828758776188, decouple_loss:0.003354893531650305
WV_0_PC_0_EH_1_PS_40, loss: 0.03158372640609741, avg_mse: 0.04774719104170799
current test mse: 0.047747
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 6961, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467472434043884
loss_pred:0.016609052196145058, decouple_loss:0.0027832521591335535
The generated pressure mean: 0.45012715458869934
loss_pred:0.018647903576493263, decouple_loss:0.002853624988347292
The generated pressure mean: 0.4489862620830536
loss_pred:0.01694093644618988, decouple_loss:0.0028040313627570868
Iteration: 6962, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4444006681442261
loss_pred:0.016241436824202538, decouple_loss:0.0035254608374089003
The generated pressure mean: 0.44766664505004883
loss_pred:0.018035579472780228, decouple_loss:0.0035911353770643473
The generated pressure mean: 0.44957348704338074
loss_pred:0.01800321601331234, decouple_loss:0.0035840203054249287
Iteration: 6963, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44873085618019104
loss_pred:0.017239179462194443, decouple_loss:0.002792198909446597
The generated pressure mean: 0.4491821229457855
loss_pred:0.017216624692082405, decouple_loss:0.0026865864638239145
The generated pressure mean: 0.44548484683036804
loss_pred:0.018581248819828033, decouple_loss:0.002764802658930421
Iteration: 6964, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494228661060333
loss_pred:0.018392318859696388, decouple_loss:0.0035990590695291758
The generated pressure mean: 0.4465988278388977
loss_pred:0.017426224425435066, decouple_loss:0.0034604899119585752
The generated pressure mean: 0.44046536087989807
loss_pred:0.018651559948921204, decouple_loss:0.003456578589975834
Iteration: 6965, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502803385257721
loss_pred:0.017622604966163635, decouple_loss:0.003509575966745615
The generated pressure mean: 0.4475409686565399
loss_pred:0.017526615411043167, decouple_loss:0.0034883918706327677
The generated pressure mean: 0.44803857803344727
loss_pred:0.0179868433624506, decouple_loss:0.0036806908901780844
Iteration: 6966, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44149965047836304
loss_pred:0.019182724878191948, decouple_loss:0.0030898223631083965
The generated pressure mean: 0.4411027431488037
loss_pred:0.015656419098377228, decouple_loss:0.0029900551307946444
The generated pressure mean: 0.44871920347213745
loss_pred:0.016979403793811798, decouple_loss:0.0030554640106856823
Iteration: 6967, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4553547203540802
loss_pred:0.01842358335852623, decouple_loss:0.003035725560039282
The generated pressure mean: 0.45315149426460266
loss_pred:0.019574766978621483, decouple_loss:0.0029597680550068617
The generated pressure mean: 0.4549463987350464
loss_pred:0.019393645226955414, decouple_loss:0.003077347995713353
Iteration: 6968, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4362151622772217
The generated pressure mean: 0.43196555972099304
loss_pred:0.01740085519850254, decouple_loss:0.0024944969918578863
loss_pred:0.017840417101979256, decouple_loss:0.0025390188675373793
The generated pressure mean: 0.43843209743499756
loss_pred:0.01792711205780506, decouple_loss:0.0025636469945311546
Iteration: 6969, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4437720477581024
loss_pred:0.016697106882929802, decouple_loss:0.0023697693832218647
The generated pressure mean: 0.4440108835697174
loss_pred:0.02062838152050972, decouple_loss:0.0025295321829617023
The generated pressure mean: 0.44110536575317383
loss_pred:0.01699589006602764, decouple_loss:0.0025494650471955538
Iteration: 6970, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4547750651836395
The generated pressure mean: 0.45739224553108215
loss_pred:0.018698737025260925, decouple_loss:0.0023691945243626833
loss_pred:0.017519451677799225, decouple_loss:0.002334221499040723
The generated pressure mean: 0.45283663272857666
loss_pred:0.018796348944306374, decouple_loss:0.002332393079996109
2023-04-17 13:58:59 testing...
The generated pressure mean: 0.41299307346343994
The generated pressure mean: 0.4198940098285675
The generated pressure mean: 0.4223612844944
loss_pred:0.0320192314684391, decouple_loss:0.003222087398171425
loss_pred:0.03068421594798565, decouple_loss:0.0033745714463293552
loss_pred:0.03054167330265045, decouple_loss:0.003449093783274293
WV_0_PC_0_EH_1_PS_40, loss: 0.031249135732650757, avg_mse: 0.04691779240965843
current test mse: 0.046918
Iteration: 6971, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459376633167267
loss_pred:0.016598785296082497, decouple_loss:0.002823823131620884
The generated pressure mean: 0.445430725812912
loss_pred:0.01942761428654194, decouple_loss:0.002880051266402006
The generated pressure mean: 0.4470614790916443
loss_pred:0.01778109185397625, decouple_loss:0.002817707136273384
Iteration: 6972, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442635476589203
loss_pred:0.017722193151712418, decouple_loss:0.0028063077479600906
The generated pressure mean: 0.438321977853775
loss_pred:0.016444098204374313, decouple_loss:0.002725585363805294
The generated pressure mean: 0.4422762989997864
loss_pred:0.020098790526390076, decouple_loss:0.0027134621050208807
Iteration: 6973, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4446023106575012
loss_pred:0.01755453459918499, decouple_loss:0.002819965360686183
The generated pressure mean: 0.4505331218242645
loss_pred:0.01724265329539776, decouple_loss:0.0028678891249001026
The generated pressure mean: 0.4492316246032715
loss_pred:0.01792272739112377, decouple_loss:0.0029445106629282236
Iteration: 6974, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45620203018188477
loss_pred:0.016804061830043793, decouple_loss:0.0025733555667102337
The generated pressure mean: 0.45015671849250793
loss_pred:0.0188954696059227, decouple_loss:0.0025214178021997213
The generated pressure mean: 0.4567081332206726
loss_pred:0.017304006963968277, decouple_loss:0.0026137197855859995
Iteration: 6975, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4419376850128174
loss_pred:0.01696445792913437, decouple_loss:0.0025974486488848925
The generated pressure mean: 0.4490855038166046
loss_pred:0.01724550500512123, decouple_loss:0.0024763718247413635
The generated pressure mean: 0.4461895227432251
loss_pred:0.017773622646927834, decouple_loss:0.0025096412282437086
Iteration: 6976, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4395025670528412
loss_pred:0.017075659707188606, decouple_loss:0.0025502066127955914
The generated pressure mean: 0.443310022354126
loss_pred:0.016411924734711647, decouple_loss:0.0025583384558558464
The generated pressure mean: 0.4384327530860901
loss_pred:0.017611704766750336, decouple_loss:0.00266161747276783
Iteration: 6977, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4412551522254944
loss_pred:0.017606275156140327, decouple_loss:0.002302585169672966
The generated pressure mean: 0.44035786390304565
loss_pred:0.0172839667648077, decouple_loss:0.0023137915413826704
The generated pressure mean: 0.4452952742576599
loss_pred:0.017116624861955643, decouple_loss:0.0022487244568765163
Iteration: 6978, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44818297028541565
loss_pred:0.01655961386859417, decouple_loss:0.002209798200055957
The generated pressure mean: 0.44846099615097046
loss_pred:0.017362413927912712, decouple_loss:0.0022036347072571516
The generated pressure mean: 0.4517594277858734
loss_pred:0.017571646720170975, decouple_loss:0.0021938870195299387
Iteration: 6979, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45032215118408203
loss_pred:0.018702412024140358, decouple_loss:0.0029965632129460573
The generated pressure mean: 0.4528657793998718
loss_pred:0.019337248057127, decouple_loss:0.0032582541462033987
The generated pressure mean: 0.4534945487976074
loss_pred:0.017083996906876564, decouple_loss:0.0030856598168611526
Iteration: 6980, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4390903413295746
loss_pred:0.01758739724755287, decouple_loss:0.00254789344035089
The generated pressure mean: 0.44178807735443115
loss_pred:0.01776546984910965, decouple_loss:0.002765791490674019
The generated pressure mean: 0.4349338412284851
loss_pred:0.017697105184197426, decouple_loss:0.002682483522221446
2023-04-17 14:00:51 testing...
The generated pressure mean: 0.4158100187778473
The generated pressure mean: 0.4230358600616455
loss_pred:0.031069008633494377, decouple_loss:0.003026575781404972
The generated pressure mean: 0.4253307580947876
loss_pred:0.030093692243099213, decouple_loss:0.0031459678430110216
loss_pred:0.029614446684718132, decouple_loss:0.003274965099990368
WV_0_PC_0_EH_1_PS_40, loss: 0.03041650913655758, avg_mse: 0.04526117816567421
current test mse: 0.045261
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 6981, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.440447598695755
loss_pred:0.017614301294088364, decouple_loss:0.0024170000106096268
The generated pressure mean: 0.4412532150745392
loss_pred:0.0187627412378788, decouple_loss:0.0024305160623043776
The generated pressure mean: 0.44392260909080505
loss_pred:0.018797611817717552, decouple_loss:0.0024672329891473055
Iteration: 6982, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4579409062862396
loss_pred:0.018707331269979477, decouple_loss:0.002630951115861535
The generated pressure mean: 0.45771852135658264
loss_pred:0.01724526472389698, decouple_loss:0.0026293357368558645
The generated pressure mean: 0.45830395817756653
loss_pred:0.01769133098423481, decouple_loss:0.0026913329493254423
Iteration: 6983, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4555991590023041
loss_pred:0.018736226484179497, decouple_loss:0.00254091527312994
The generated pressure mean: 0.45525825023651123
loss_pred:0.018133265897631645, decouple_loss:0.0025938174221664667
The generated pressure mean: 0.455412894487381
loss_pred:0.018972309306263924, decouple_loss:0.0024236817844212055
Iteration: 6984, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4428783357143402
The generated pressure mean: 0.44310662150382996
loss_pred:0.018773244693875313, decouple_loss:0.0025809158105403185
loss_pred:0.01839303784072399, decouple_loss:0.0025393476244062185
The generated pressure mean: 0.44442349672317505
loss_pred:0.018981587141752243, decouple_loss:0.002558378968387842
Iteration: 6985, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43910425901412964
The generated pressure mean: 0.43938788771629333
loss_pred:0.01806531473994255, decouple_loss:0.0021732081659138203
loss_pred:0.01807585544884205, decouple_loss:0.0021487961057573557
The generated pressure mean: 0.4361751973628998
loss_pred:0.01751469448208809, decouple_loss:0.0023334973957389593
Iteration: 6986, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45810481905937195
loss_pred:0.020417027175426483, decouple_loss:0.0022512422874569893
The generated pressure mean: 0.45323845744132996
loss_pred:0.018644345924258232, decouple_loss:0.0022291799541562796
The generated pressure mean: 0.45425647497177124
loss_pred:0.0208513755351305, decouple_loss:0.0022918363101780415
Iteration: 6987, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446063756942749
loss_pred:0.019084632396697998, decouple_loss:0.0023486854042857885
The generated pressure mean: 0.4434732496738434
loss_pred:0.018504051491618156, decouple_loss:0.0022707076277583838
The generated pressure mean: 0.4462643265724182
loss_pred:0.01882559433579445, decouple_loss:0.0022599732037633657
Iteration: 6988, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44739198684692383
loss_pred:0.017933808267116547, decouple_loss:0.002348289592191577
The generated pressure mean: 0.4468848705291748
loss_pred:0.017422975972294807, decouple_loss:0.002270589815452695
The generated pressure mean: 0.4508460760116577
loss_pred:0.018452851101756096, decouple_loss:0.002376231364905834
Iteration: 6989, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4434325098991394
loss_pred:0.017393963411450386, decouple_loss:0.0024684187956154346
The generated pressure mean: 0.4482383728027344
loss_pred:0.018854744732379913, decouple_loss:0.0024488100316375494
The generated pressure mean: 0.4460494816303253
loss_pred:0.021196439862251282, decouple_loss:0.0023846104741096497
Iteration: 6990, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44444411993026733
loss_pred:0.0193789079785347, decouple_loss:0.002507396275177598
The generated pressure mean: 0.4451774060726166
The generated pressure mean: 0.4417440891265869
loss_pred:0.017551159486174583, decouple_loss:0.002464581048116088
loss_pred:0.018694208934903145, decouple_loss:0.0023939956445246935
2023-04-17 14:03:19 testing...
The generated pressure mean: 0.41889718174934387
The generated pressure mean: 0.41229256987571716
loss_pred:0.030757708474993706, decouple_loss:0.003462271997705102
The generated pressure mean: 0.4211500585079193
loss_pred:0.03192465752363205, decouple_loss:0.0032681201118975878
loss_pred:0.029996704310178757, decouple_loss:0.0036497993860393763
WV_0_PC_0_EH_1_PS_40, loss: 0.031066028401255608, avg_mse: 0.04622083157300949
current test mse: 0.046221
Iteration: 6991, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45390188694000244
loss_pred:0.018160799518227577, decouple_loss:0.002656079363077879
The generated pressure mean: 0.4566154181957245
loss_pred:0.020916203036904335, decouple_loss:0.0026339704636484385
The generated pressure mean: 0.4514048397541046
loss_pred:0.01813761703670025, decouple_loss:0.002633763011544943
Iteration: 6992, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483494460582733
loss_pred:0.01801161840558052, decouple_loss:0.0028591628652065992
The generated pressure mean: 0.44966354966163635
loss_pred:0.018997393548488617, decouple_loss:0.0027603015769273043
The generated pressure mean: 0.4475446343421936
loss_pred:0.018928853794932365, decouple_loss:0.0027161724865436554
Iteration: 6993, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43542706966400146
loss_pred:0.018502850085496902, decouple_loss:0.00247217551805079
The generated pressure mean: 0.4360594153404236
loss_pred:0.018286114558577538, decouple_loss:0.0024916084948927164
The generated pressure mean: 0.4424639642238617
loss_pred:0.0200314000248909, decouple_loss:0.0025813637766987085
Iteration: 6994, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464118182659149
loss_pred:0.018736114725470543, decouple_loss:0.002649839734658599
The generated pressure mean: 0.44611310958862305
The generated pressure mean: 0.44746118783950806
loss_pred:0.019594425335526466, decouple_loss:0.0026535545475780964
loss_pred:0.018970930948853493, decouple_loss:0.0025527288671582937
Iteration: 6995, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45353248715400696
loss_pred:0.019196607172489166, decouple_loss:0.0031119699124246836
The generated pressure mean: 0.4596976041793823
loss_pred:0.017495712265372276, decouple_loss:0.0030235315207391977
The generated pressure mean: 0.45995163917541504
loss_pred:0.019993437454104424, decouple_loss:0.0029921524692326784
Iteration: 6996, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45229050517082214
loss_pred:0.019637566059827805, decouple_loss:0.002353510819375515
The generated pressure mean: 0.4518813490867615
loss_pred:0.019543586298823357, decouple_loss:0.002306365640833974
The generated pressure mean: 0.4474450945854187
loss_pred:0.017718998715281487, decouple_loss:0.002332520904019475
Iteration: 6997, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442513883113861
The generated pressure mean: 0.44115617871284485
loss_pred:0.019770679995417595, decouple_loss:0.002232659375295043
loss_pred:0.018209906294941902, decouple_loss:0.0021897493861615658
The generated pressure mean: 0.43838053941726685
loss_pred:0.018671009689569473, decouple_loss:0.002259716158732772
Iteration: 6998, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.441182941198349
loss_pred:0.0182399470359087, decouple_loss:0.002553482772782445
The generated pressure mean: 0.44389206171035767
loss_pred:0.017421968281269073, decouple_loss:0.002410604152828455
The generated pressure mean: 0.44110944867134094
loss_pred:0.018037021160125732, decouple_loss:0.0025035615544766188
Iteration: 6999, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45084720849990845
loss_pred:0.019611023366451263, decouple_loss:0.0026214790996164083
The generated pressure mean: 0.4489600658416748
loss_pred:0.018458720296621323, decouple_loss:0.0025818427093327045
The generated pressure mean: 0.4482433795928955
loss_pred:0.01821005716919899, decouple_loss:0.002614689990878105
Iteration: 7000, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45128917694091797
The generated pressure mean: 0.4532366096973419loss_pred:0.01794915646314621, decouple_loss:0.0023822446819394827
loss_pred:0.017931921407580376, decouple_loss:0.002348761772736907
The generated pressure mean: 0.45059120655059814
loss_pred:0.017983075231313705, decouple_loss:0.0023046955466270447
2023-04-17 14:05:13 itr: 7000
training loss: [0.01809831 0.01806827 0.01804936]
2023-04-17 14:05:13 testing...
The generated pressure mean: 0.4125351309776306
The generated pressure mean: 0.41935059428215027
The generated pressure mean: 0.4218646287918091
loss_pred:0.03192821890115738, decouple_loss:0.0028168335556983948
loss_pred:0.03059297427535057, decouple_loss:0.0030435919761657715
loss_pred:0.030106425285339355, decouple_loss:0.0031740712001919746
WV_0_PC_0_EH_1_PS_40, loss: 0.0310264490544796, avg_mse: 0.0463535413146019
current test mse: 0.046354
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 7001, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4542853832244873
loss_pred:0.019156072288751602, decouple_loss:0.0022070573177188635
The generated pressure mean: 0.45009902119636536
loss_pred:0.022204209119081497, decouple_loss:0.0023256042040884495
The generated pressure mean: 0.44982004165649414
loss_pred:0.017538489773869514, decouple_loss:0.0023112972266972065
Iteration: 7002, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.439990371465683
The generated pressure mean: 0.43802446126937866
loss_pred:0.018320787698030472, decouple_loss:0.00240096147172153
loss_pred:0.017197148874402046, decouple_loss:0.002297505736351013
The generated pressure mean: 0.44256097078323364
loss_pred:0.01847870647907257, decouple_loss:0.002296126913279295
Iteration: 7003, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44869494438171387
The generated pressure mean: 0.4450269937515259
loss_pred:0.018017638474702835, decouple_loss:0.0024307086132466793
loss_pred:0.017648132517933846, decouple_loss:0.0023761549964547157
The generated pressure mean: 0.4492402970790863
loss_pred:0.020135954022407532, decouple_loss:0.002432276261970401
Iteration: 7004, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4531281292438507
The generated pressure mean: 0.44706833362579346
loss_pred:0.01815485954284668, decouple_loss:0.0027170428074896336
loss_pred:0.018294211477041245, decouple_loss:0.0027376562356948853
The generated pressure mean: 0.451145201921463
loss_pred:0.019948257133364677, decouple_loss:0.002746117999777198
Iteration: 7005, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4437251091003418
The generated pressure mean: 0.4511057138442993
loss_pred:0.017449937760829926, decouple_loss:0.00260476628318429
loss_pred:0.018652182072401047, decouple_loss:0.002548624761402607
The generated pressure mean: 0.4543146789073944
loss_pred:0.018762363120913506, decouple_loss:0.0026452108286321163
Iteration: 7006, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4534503221511841
The generated pressure mean: 0.4482545554637909
loss_pred:0.0178212933242321, decouple_loss:0.0029299010057002306
loss_pred:0.01839573308825493, decouple_loss:0.0028435466811060905
The generated pressure mean: 0.45020243525505066
loss_pred:0.01794014684855938, decouple_loss:0.0029739325400441885
Iteration: 7007, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4458475410938263
The generated pressure mean: 0.4459933340549469
loss_pred:0.01749957725405693, decouple_loss:0.003011861350387335
loss_pred:0.01893702894449234, decouple_loss:0.0030385071877390146
The generated pressure mean: 0.4463869333267212
loss_pred:0.018338091671466827, decouple_loss:0.0031850654631853104
Iteration: 7008, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43754851818084717
The generated pressure mean: 0.43939322233200073
loss_pred:0.018512370064854622, decouple_loss:0.002833194797858596
loss_pred:0.018893778324127197, decouple_loss:0.0028866594657301903
The generated pressure mean: 0.43985098600387573
loss_pred:0.018380355089902878, decouple_loss:0.002692983951419592
Iteration: 7009, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.455770343542099
loss_pred:0.018424367532134056, decouple_loss:0.002580601954832673
The generated pressure mean: 0.446435809135437
loss_pred:0.017266053706407547, decouple_loss:0.0024366932921111584
The generated pressure mean: 0.4524082541465759
loss_pred:0.020327115431427956, decouple_loss:0.0024682055227458477
Iteration: 7010, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45338907837867737
The generated pressure mean: 0.45490700006484985
loss_pred:0.019177574664354324, decouple_loss:0.0032348574604839087
loss_pred:0.019291231408715248, decouple_loss:0.003157187020406127
The generated pressure mean: 0.45683377981185913
loss_pred:0.01847163774073124, decouple_loss:0.003036190988495946
2023-04-17 14:07:46 testing...
The generated pressure mean: 0.41435953974723816
The generated pressure mean: 0.42043372988700867
The generated pressure mean: 0.4227714240550995
loss_pred:0.03208925575017929, decouple_loss:0.0029288004152476788
loss_pred:0.03107159398496151, decouple_loss:0.0030788106378167868
loss_pred:0.03041064366698265, decouple_loss:0.00323472754098475
WV_0_PC_0_EH_1_PS_40, loss: 0.031344540417194366, avg_mse: 0.046716559678316116
current test mse: 0.046717
Iteration: 7011, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4434651732444763The generated pressure mean: 0.4452768862247467
loss_pred:0.01800362952053547, decouple_loss:0.0024791471660137177
loss_pred:0.01799899712204933, decouple_loss:0.0024297102354466915
The generated pressure mean: 0.44614216685295105
loss_pred:0.018603626638650894, decouple_loss:0.002377480734139681
Iteration: 7012, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4438081979751587
The generated pressure mean: 0.4434429407119751
loss_pred:0.018976809456944466, decouple_loss:0.0025890141259878874
loss_pred:0.017787961289286613, decouple_loss:0.0025140864308923483
The generated pressure mean: 0.4398464262485504
loss_pred:0.019258322194218636, decouple_loss:0.0024321868550032377
Iteration: 7013, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4572536051273346
The generated pressure mean: 0.4530293941497803
loss_pred:0.018239684402942657, decouple_loss:0.0031897341832518578
loss_pred:0.01818111725151539, decouple_loss:0.003126185853034258
The generated pressure mean: 0.45292866230010986
loss_pred:0.018110744655132294, decouple_loss:0.003025876823812723
Iteration: 7014, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504602551460266
The generated pressure mean: 0.4511944353580475
loss_pred:0.01919417642056942, decouple_loss:0.0030034000519663095
loss_pred:0.019828852266073227, decouple_loss:0.003007203806191683
The generated pressure mean: 0.4498324692249298
loss_pred:0.017536213621497154, decouple_loss:0.002890160074457526
Iteration: 7015, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43394091725349426
The generated pressure mean: 0.43730005621910095
loss_pred:0.017609532922506332, decouple_loss:0.0022911771666258574
loss_pred:0.01902691274881363, decouple_loss:0.002222559880465269
The generated pressure mean: 0.4389170706272125
loss_pred:0.017606277018785477, decouple_loss:0.002341256942600012
Iteration: 7016, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4546184837818146
The generated pressure mean: 0.4522098898887634
loss_pred:0.020235033705830574, decouple_loss:0.002661275677382946
loss_pred:0.018074369058012962, decouple_loss:0.0026025373954325914
The generated pressure mean: 0.4500702917575836
loss_pred:0.019106261432170868, decouple_loss:0.002629894530400634
Iteration: 7017, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43353691697120667
The generated pressure mean: 0.4360485076904297
loss_pred:0.019364889711141586, decouple_loss:0.0028459334280341864
loss_pred:0.018054218962788582, decouple_loss:0.0028433913830667734
The generated pressure mean: 0.4402526021003723
loss_pred:0.01736615225672722, decouple_loss:0.002774716354906559
Iteration: 7018, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4598166346549988
loss_pred:0.017162693664431572, decouple_loss:0.002572034252807498
The generated pressure mean: 0.45872586965560913
loss_pred:0.018082905560731888, decouple_loss:0.0025808829814195633
The generated pressure mean: 0.46094974875450134
loss_pred:0.016959253698587418, decouple_loss:0.002678758930414915
Iteration: 7019, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4618752598762512
loss_pred:0.020178642123937607, decouple_loss:0.0025416265707463026
The generated pressure mean: 0.4621652662754059
loss_pred:0.01832694001495838, decouple_loss:0.0024551257956773043
The generated pressure mean: 0.4593522846698761
loss_pred:0.018445713445544243, decouple_loss:0.00267151091247797
Iteration: 7020, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4248692989349365
loss_pred:0.01956288143992424, decouple_loss:0.0025206333957612514
The generated pressure mean: 0.4280503988265991
loss_pred:0.021185098215937614, decouple_loss:0.0025889237876981497
The generated pressure mean: 0.42515629529953003
loss_pred:0.018472323194146156, decouple_loss:0.0026538486126810312
2023-04-17 14:09:39 testing...
The generated pressure mean: 0.41220778226852417
The generated pressure mean: 0.41868844628334045
The generated pressure mean: 0.421195387840271
loss_pred:0.03532744571566582, decouple_loss:0.002901809522882104
loss_pred:0.033947017043828964, decouple_loss:0.0029790825210511684
loss_pred:0.03328194096684456, decouple_loss:0.0030843468848615885
WV_0_PC_0_EH_1_PS_40, loss: 0.03433489054441452, avg_mse: 0.05271608754992485
current test mse: 0.052716
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 7021, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45352599024772644
loss_pred:0.018136363476514816, decouple_loss:0.0024524391628801823
The generated pressure mean: 0.4522915184497833
The generated pressure mean: 0.4547182619571686loss_pred:0.01903529092669487, decouple_loss:0.002498827874660492
loss_pred:0.018357157707214355, decouple_loss:0.0027082308661192656
Iteration: 7022, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4567871689796448
The generated pressure mean: 0.46225613355636597
loss_pred:0.017966674640774727, decouple_loss:0.003703043796122074
loss_pred:0.017601704224944115, decouple_loss:0.0036975506227463484
The generated pressure mean: 0.4586932063102722
loss_pred:0.01777215115725994, decouple_loss:0.003793321317061782
Iteration: 7023, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.444911390542984
The generated pressure mean: 0.4410149157047272
loss_pred:0.019113687798380852, decouple_loss:0.0028612001333385706
loss_pred:0.020352814346551895, decouple_loss:0.0028801693115383387
The generated pressure mean: 0.4395792782306671
loss_pred:0.020758746191859245, decouple_loss:0.0028612136375159025
Iteration: 7024, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44961756467819214
loss_pred:0.01829405501484871, decouple_loss:0.004419312346726656
The generated pressure mean: 0.446562260389328
loss_pred:0.02043025568127632, decouple_loss:0.004418779630213976
The generated pressure mean: 0.4506412744522095
loss_pred:0.01948208175599575, decouple_loss:0.0044222185388207436
Iteration: 7025, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442248046398163
loss_pred:0.018618566915392876, decouple_loss:0.0034328289330005646
The generated pressure mean: 0.44288408756256104
loss_pred:0.0171106718480587, decouple_loss:0.003388123121112585
The generated pressure mean: 0.44283878803253174
loss_pred:0.017786558717489243, decouple_loss:0.0034431859385222197
Iteration: 7026, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4440677762031555
The generated pressure mean: 0.4433286786079407
loss_pred:0.01843053102493286, decouple_loss:0.004098695702850819
loss_pred:0.017441777512431145, decouple_loss:0.0038920154329389334
The generated pressure mean: 0.4418380856513977
loss_pred:0.018465621396899223, decouple_loss:0.003999142441898584
Iteration: 7027, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4530506432056427
loss_pred:0.018175309523940086, decouple_loss:0.003243036102503538
The generated pressure mean: 0.4523800015449524
loss_pred:0.017100028693675995, decouple_loss:0.003173282602801919
The generated pressure mean: 0.45645663142204285
loss_pred:0.01782333105802536, decouple_loss:0.0032589773181825876
Iteration: 7028, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4522008001804352
loss_pred:0.019571637734770775, decouple_loss:0.0036350612062960863
The generated pressure mean: 0.4526941478252411
loss_pred:0.019121604040265083, decouple_loss:0.003599913092330098
The generated pressure mean: 0.45380374789237976
loss_pred:0.01783118024468422, decouple_loss:0.003472915617749095
Iteration: 7029, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4377425014972687
The generated pressure mean: 0.4447368085384369
loss_pred:0.018463965505361557, decouple_loss:0.0027480567805469036
loss_pred:0.02010236121714115, decouple_loss:0.002824522089213133
The generated pressure mean: 0.44197186827659607
loss_pred:0.01972116343677044, decouple_loss:0.0028427254874259233
Iteration: 7030, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.431058794260025
loss_pred:0.019161934033036232, decouple_loss:0.00253674341365695
The generated pressure mean: 0.43611013889312744
The generated pressure mean: 0.43586865067481995
loss_pred:0.018512992188334465, decouple_loss:0.0025815118569880724
loss_pred:0.017490092664957047, decouple_loss:0.0025058616884052753
2023-04-17 14:12:12 testing...
The generated pressure mean: 0.4236808121204376
The generated pressure mean: 0.4152035415172577
The generated pressure mean: 0.42696985602378845
loss_pred:0.0309592392295599, decouple_loss:0.00331184733659029
loss_pred:0.03216655179858208, decouple_loss:0.0031276794616132975
loss_pred:0.030104801058769226, decouple_loss:0.0034655844792723656
WV_0_PC_0_EH_1_PS_40, loss: 0.031241949647665024, avg_mse: 0.04733416438102722
current test mse: 0.047334
Iteration: 7031, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467455744743347
loss_pred:0.018498748540878296, decouple_loss:0.0023428841959685087
The generated pressure mean: 0.4505382478237152
loss_pred:0.017511898651719093, decouple_loss:0.0023775307927280664
The generated pressure mean: 0.45137321949005127
loss_pred:0.018737345933914185, decouple_loss:0.002342409919947386
Iteration: 7032, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4551216959953308
loss_pred:0.017568079754710197, decouple_loss:0.0024708216078579426
The generated pressure mean: 0.4520089030265808
loss_pred:0.016805389896035194, decouple_loss:0.002460027113556862
The generated pressure mean: 0.4534713327884674
loss_pred:0.01930871605873108, decouple_loss:0.002449706895276904
Iteration: 7033, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.450126588344574
loss_pred:0.017389658838510513, decouple_loss:0.0025756622198969126
The generated pressure mean: 0.4516409933567047
loss_pred:0.018460286781191826, decouple_loss:0.0024515932891517878
The generated pressure mean: 0.4531577527523041
loss_pred:0.017836352810263634, decouple_loss:0.002532567596063018
Iteration: 7034, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44377657771110535
loss_pred:0.01696310192346573, decouple_loss:0.002309827134013176
The generated pressure mean: 0.4435350298881531
loss_pred:0.018437989056110382, decouple_loss:0.0023763692006468773
The generated pressure mean: 0.44031795859336853
loss_pred:0.017331931740045547, decouple_loss:0.002411838388070464
Iteration: 7035, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4435243606567383
loss_pred:0.01759195514023304, decouple_loss:0.002578211249783635
The generated pressure mean: 0.4439021646976471
loss_pred:0.018106801435351372, decouple_loss:0.00250264466740191
The generated pressure mean: 0.4481615424156189
loss_pred:0.018929211422801018, decouple_loss:0.0025132312439382076
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 7036, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4392543435096741
loss_pred:0.01943027414381504, decouple_loss:0.002802989911288023
The generated pressure mean: 0.4370206296443939
loss_pred:0.01812686212360859, decouple_loss:0.002909719478338957
The generated pressure mean: 0.4421120882034302
loss_pred:0.01772521436214447, decouple_loss:0.002724804449826479
Iteration: 7037, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.454090416431427
loss_pred:0.019241759553551674, decouple_loss:0.00256878393702209
The generated pressure mean: 0.45058295130729675
loss_pred:0.017759360373020172, decouple_loss:0.00256729731336236
The generated pressure mean: 0.4539988934993744
loss_pred:0.01822381466627121, decouple_loss:0.0024515509139746428
Iteration: 7038, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44908058643341064
loss_pred:0.017486169934272766, decouple_loss:0.0023284973576664925
The generated pressure mean: 0.4500495493412018
loss_pred:0.020473144948482513, decouple_loss:0.0022364275064319372
The generated pressure mean: 0.4505653381347656
loss_pred:0.017225826159119606, decouple_loss:0.0023563706781715155
Iteration: 7039, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4411245882511139
loss_pred:0.01835227943956852, decouple_loss:0.002048955764621496
The generated pressure mean: 0.439177930355072
loss_pred:0.01762421987950802, decouple_loss:0.00204766308888793
The generated pressure mean: 0.4390542209148407
loss_pred:0.01980919949710369, decouple_loss:0.00212514353916049
Iteration: 7040, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4534159302711487
loss_pred:0.017735855653882027, decouple_loss:0.002515448024496436
The generated pressure mean: 0.4508877694606781
loss_pred:0.017706483602523804, decouple_loss:0.0024624306242913008
The generated pressure mean: 0.4502125680446625
loss_pred:0.017781352624297142, decouple_loss:0.0023731396067887545
2023-04-17 14:14:05 testing...
The generated pressure mean: 0.4110308885574341
The generated pressure mean: 0.4187450408935547
The generated pressure mean: 0.4211466610431671
loss_pred:0.033514007925987244, decouple_loss:0.003406974021345377
loss_pred:0.03213896229863167, decouple_loss:0.003621892537921667
loss_pred:0.031472548842430115, decouple_loss:0.0037425216287374496
WV_0_PC_0_EH_1_PS_40, loss: 0.03255469724535942, avg_mse: 0.04999885708093643
current test mse: 0.049999
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 7041, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4546937942504883
loss_pred:0.01908009685575962, decouple_loss:0.002994730370119214
The generated pressure mean: 0.4525243937969208
loss_pred:0.019056286662817, decouple_loss:0.002993730129674077
The generated pressure mean: 0.448595255613327
loss_pred:0.018046801909804344, decouple_loss:0.0028825178742408752
Iteration: 7042, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44303736090660095
The generated pressure mean: 0.44197237491607666
loss_pred:0.0187629833817482, decouple_loss:0.002495137043297291
loss_pred:0.017668642103672028, decouple_loss:0.0023871774319559336
The generated pressure mean: 0.44200295209884644
loss_pred:0.016464289277791977, decouple_loss:0.0024894694797694683
Iteration: 7043, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4454375207424164
loss_pred:0.020275671035051346, decouple_loss:0.003403030801564455
The generated pressure mean: 0.440814346075058
loss_pred:0.017821207642555237, decouple_loss:0.0029900316148996353
The generated pressure mean: 0.44896963238716125
loss_pred:0.017867108806967735, decouple_loss:0.0032008527778089046
Iteration: 7044, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452742636203766
loss_pred:0.018638206645846367, decouple_loss:0.0025019426830112934
The generated pressure mean: 0.44591224193573
loss_pred:0.0187529344111681, decouple_loss:0.002442457713186741
The generated pressure mean: 0.4454149901866913
loss_pred:0.017941659316420555, decouple_loss:0.0024243767838925123
Iteration: 7045, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44145408272743225
loss_pred:0.017604202032089233, decouple_loss:0.0023583252914249897
The generated pressure mean: 0.44099563360214233
loss_pred:0.017982354387640953, decouple_loss:0.0025387764908373356
The generated pressure mean: 0.4431818127632141
loss_pred:0.01995890587568283, decouple_loss:0.0024120882153511047
Iteration: 7046, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45046868920326233
loss_pred:0.0183655247092247, decouple_loss:0.0027058625128120184
The generated pressure mean: 0.4482356309890747
loss_pred:0.018171735107898712, decouple_loss:0.00268069701269269
The generated pressure mean: 0.44994497299194336
loss_pred:0.018056560307741165, decouple_loss:0.002861437853425741
Iteration: 7047, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4535829722881317
loss_pred:0.018225455656647682, decouple_loss:0.0032273491378873587
The generated pressure mean: 0.4558607339859009
loss_pred:0.017170961946249008, decouple_loss:0.003161822212859988
The generated pressure mean: 0.45290592312812805
loss_pred:0.01849118061363697, decouple_loss:0.003339348128065467
Iteration: 7048, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44419220089912415
loss_pred:0.016588734462857246, decouple_loss:0.0022614283952862024
The generated pressure mean: 0.4498195946216583
loss_pred:0.017519058659672737, decouple_loss:0.0023296326398849487
The generated pressure mean: 0.44937509298324585
loss_pred:0.02139841392636299, decouple_loss:0.00229493691585958
Iteration: 7049, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43465927243232727
loss_pred:0.019095366820693016, decouple_loss:0.0023238633293658495
The generated pressure mean: 0.4336373209953308
The generated pressure mean: 0.4357469081878662
loss_pred:0.019178707152605057, decouple_loss:0.002293481957167387
loss_pred:0.0176361296325922, decouple_loss:0.002271469449624419
Iteration: 7050, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4515822231769562
loss_pred:0.018364040181040764, decouple_loss:0.002660093130543828
The generated pressure mean: 0.45043712854385376
The generated pressure mean: 0.45124614238739014
loss_pred:0.017946718260645866, decouple_loss:0.002571468474343419
loss_pred:0.018582290038466454, decouple_loss:0.0026205931790173054
2023-04-17 14:16:37 testing...
The generated pressure mean: 0.41356360912323
The generated pressure mean: 0.4204533100128174
The generated pressure mean: 0.42294514179229736
loss_pred:0.03245081380009651, decouple_loss:0.0036924320738762617
loss_pred:0.03146812692284584, decouple_loss:0.0038401621859520674
loss_pred:0.030943365767598152, decouple_loss:0.003945902921259403
WV_0_PC_0_EH_1_PS_40, loss: 0.03181207925081253, avg_mse: 0.04815500229597092
current test mse: 0.048155
Iteration: 7051, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4432453513145447
loss_pred:0.016838181763887405, decouple_loss:0.0033468613401055336
The generated pressure mean: 0.44327932596206665
loss_pred:0.01787477917969227, decouple_loss:0.0033509472850710154
The generated pressure mean: 0.4495255649089813
loss_pred:0.017468813806772232, decouple_loss:0.0031737524550408125
Iteration: 7052, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500489830970764
loss_pred:0.017672725021839142, decouple_loss:0.0029673725366592407
The generated pressure mean: 0.4552183747291565
loss_pred:0.02278093434870243, decouple_loss:0.0029613638762384653
The generated pressure mean: 0.45167750120162964
loss_pred:0.01825214922428131, decouple_loss:0.002895622979849577
Iteration: 7053, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452784061431885
loss_pred:0.017959464341402054, decouple_loss:0.0026197824627161026
The generated pressure mean: 0.4455430209636688
loss_pred:0.01809317246079445, decouple_loss:0.002526468364521861
The generated pressure mean: 0.44915571808815
loss_pred:0.019377289339900017, decouple_loss:0.0026415595784783363
Iteration: 7054, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4412156641483307
loss_pred:0.020736945793032646, decouple_loss:0.0024980371817946434
The generated pressure mean: 0.44629696011543274
loss_pred:0.018812144175171852, decouple_loss:0.002531996462494135
The generated pressure mean: 0.44185999035835266
loss_pred:0.016872499138116837, decouple_loss:0.0025586436968296766
Iteration: 7055, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44126662611961365
loss_pred:0.016886772587895393, decouple_loss:0.00229777698405087
The generated pressure mean: 0.44288861751556396
loss_pred:0.01772785745561123, decouple_loss:0.002376529620960355
The generated pressure mean: 0.4419211149215698
loss_pred:0.01692092977464199, decouple_loss:0.0023342042695730925
Iteration: 7056, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45619457960128784
loss_pred:0.019350916147232056, decouple_loss:0.002752003027126193
The generated pressure mean: 0.45180410146713257
loss_pred:0.01980678178369999, decouple_loss:0.0028333195950835943
The generated pressure mean: 0.4554464817047119
loss_pred:0.01683596521615982, decouple_loss:0.002729908563196659
Iteration: 7057, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44259628653526306
loss_pred:0.017712026834487915, decouple_loss:0.0025012458208948374
The generated pressure mean: 0.44349443912506104
loss_pred:0.01819923333823681, decouple_loss:0.0025579920038580894
The generated pressure mean: 0.4438808560371399
loss_pred:0.02056637406349182, decouple_loss:0.0026148271281272173
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 7058, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4395444691181183
loss_pred:0.019635437056422234, decouple_loss:0.0024031768552958965
The generated pressure mean: 0.44222772121429443
loss_pred:0.016977393999695778, decouple_loss:0.0023549352772533894
The generated pressure mean: 0.440624862909317
loss_pred:0.01965348981320858, decouple_loss:0.0024341903626918793
Iteration: 7059, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.451312392950058
loss_pred:0.018581079319119453, decouple_loss:0.0021992248948663473
The generated pressure mean: 0.4484754502773285
loss_pred:0.01662275567650795, decouple_loss:0.002237784443423152
The generated pressure mean: 0.45316556096076965
loss_pred:0.0187542624771595, decouple_loss:0.0022477165330201387
Iteration: 7060, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4563521146774292
loss_pred:0.016982141882181168, decouple_loss:0.002189530525356531
The generated pressure mean: 0.451910138130188
loss_pred:0.017814867198467255, decouple_loss:0.0021837882231920958
The generated pressure mean: 0.4554426074028015
loss_pred:0.01985272578895092, decouple_loss:0.002179322764277458
2023-04-17 14:18:30 testing...
The generated pressure mean: 0.41513586044311523
The generated pressure mean: 0.4226081371307373
The generated pressure mean: 0.4255026578903198
loss_pred:0.03201283514499664, decouple_loss:0.0029274877160787582
loss_pred:0.031135864555835724, decouple_loss:0.0032044528052210808
loss_pred:0.030432766303420067, decouple_loss:0.0032788501121103764
WV_0_PC_0_EH_1_PS_40, loss: 0.031350668519735336, avg_mse: 0.04774632677435875
current test mse: 0.047746
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 7061, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4426324665546417
loss_pred:0.018118103966116905, decouple_loss:0.0024252086877822876
The generated pressure mean: 0.4410021901130676
The generated pressure mean: 0.4479602575302124
loss_pred:0.01774175651371479, decouple_loss:0.0026390678249299526
loss_pred:0.018744368106126785, decouple_loss:0.0026931099127978086
Iteration: 7062, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42953306436538696
loss_pred:0.015986567363142967, decouple_loss:0.003018904710188508
The generated pressure mean: 0.42916712164878845
loss_pred:0.01725184917449951, decouple_loss:0.003005034988746047
The generated pressure mean: 0.42854043841362
loss_pred:0.016621027141809464, decouple_loss:0.002973726950585842
Iteration: 7063, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.456923246383667
loss_pred:0.017924247309565544, decouple_loss:0.0022083367221057415
The generated pressure mean: 0.45965853333473206
loss_pred:0.017893604934215546, decouple_loss:0.002346757100895047
The generated pressure mean: 0.45910224318504333
loss_pred:0.01637393981218338, decouple_loss:0.002285534283146262
Iteration: 7064, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4617753326892853
loss_pred:0.01843063347041607, decouple_loss:0.002865977119654417
The generated pressure mean: 0.45826074481010437
loss_pred:0.016892846673727036, decouple_loss:0.0027948792558163404
The generated pressure mean: 0.46100136637687683
loss_pred:0.01878116838634014, decouple_loss:0.0029013543389737606
Iteration: 7065, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4429878890514374
loss_pred:0.017688753083348274, decouple_loss:0.0025945529341697693
The generated pressure mean: 0.4485021233558655
loss_pred:0.017794955521821976, decouple_loss:0.0026842786464840174
The generated pressure mean: 0.4456992745399475
loss_pred:0.01808212697505951, decouple_loss:0.0028188186697661877
Iteration: 7066, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44363492727279663
loss_pred:0.01892804354429245, decouple_loss:0.003300673794001341
The generated pressure mean: 0.4408690631389618
loss_pred:0.017894456163048744, decouple_loss:0.0033812939655035734
The generated pressure mean: 0.4367547631263733
loss_pred:0.01705450378358364, decouple_loss:0.0032298793084919453
Iteration: 7067, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44602078199386597
loss_pred:0.018747737631201744, decouple_loss:0.003673817031085491
The generated pressure mean: 0.44488564133644104
loss_pred:0.019286219030618668, decouple_loss:0.0037978931795805693
The generated pressure mean: 0.44839227199554443
loss_pred:0.016431037336587906, decouple_loss:0.003826826112344861
Iteration: 7068, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4388856589794159
loss_pred:0.016730448231101036, decouple_loss:0.0029484808910638094
The generated pressure mean: 0.44526004791259766
The generated pressure mean: 0.4436517059803009
loss_pred:0.017988650128245354, decouple_loss:0.002798449480906129
loss_pred:0.01886611431837082, decouple_loss:0.0029064544942229986
Iteration: 7069, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45143184065818787
loss_pred:0.01843886263668537, decouple_loss:0.002547837793827057
The generated pressure mean: 0.4499194324016571
The generated pressure mean: 0.4536159634590149
loss_pred:0.01790907420217991, decouple_loss:0.002654825337231159
loss_pred:0.018208641558885574, decouple_loss:0.0026245557237416506
Iteration: 7070, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4515535533428192
loss_pred:0.017478203400969505, decouple_loss:0.0033210001420229673
The generated pressure mean: 0.45299097895622253
loss_pred:0.017872383818030357, decouple_loss:0.003417541040107608
The generated pressure mean: 0.4480985701084137
loss_pred:0.018116794526576996, decouple_loss:0.003369406796991825
2023-04-17 14:21:00 testing...
The generated pressure mean: 0.4149971902370453
The generated pressure mean: 0.4220334589481354
The generated pressure mean: 0.42521271109580994
loss_pred:0.032288894057273865, decouple_loss:0.004491266794502735
loss_pred:0.031147368252277374, decouple_loss:0.0045371283777058125
loss_pred:0.030337272211909294, decouple_loss:0.00468587689101696
WV_0_PC_0_EH_1_PS_40, loss: 0.03148641809821129, avg_mse: 0.04751720279455185
current test mse: 0.047517
Iteration: 7071, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4437235891819
loss_pred:0.017132233828306198, decouple_loss:0.0037054677959531546
The generated pressure mean: 0.44529232382774353
loss_pred:0.018081557005643845, decouple_loss:0.0037815982941538095
The generated pressure mean: 0.44576501846313477
loss_pred:0.016693931072950363, decouple_loss:0.003502231789752841
Iteration: 7072, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45604586601257324
loss_pred:0.017647448927164078, decouple_loss:0.003804475301876664
The generated pressure mean: 0.45253244042396545
loss_pred:0.019450969994068146, decouple_loss:0.003626579185947776
The generated pressure mean: 0.44913557171821594
loss_pred:0.019319001585245132, decouple_loss:0.0037267913576215506
Iteration: 7073, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442942440509796
loss_pred:0.018100274726748466, decouple_loss:0.003222957719117403
The generated pressure mean: 0.44215086102485657
loss_pred:0.016519449651241302, decouple_loss:0.0034228949807584286
The generated pressure mean: 0.44296741485595703
loss_pred:0.017312776297330856, decouple_loss:0.0033686261158436537
Iteration: 7074, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481125473976135
loss_pred:0.017884038388729095, decouple_loss:0.0042577781714499
The generated pressure mean: 0.4473239779472351
loss_pred:0.01817595586180687, decouple_loss:0.004206510726362467
The generated pressure mean: 0.4498370289802551
loss_pred:0.019574683159589767, decouple_loss:0.004061707761138678
Iteration: 7075, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44556090235710144
loss_pred:0.017770443111658096, decouple_loss:0.003590902080759406
The generated pressure mean: 0.4479829668998718
loss_pred:0.01717802695930004, decouple_loss:0.0034952748101204634
The generated pressure mean: 0.44588422775268555
loss_pred:0.018592702224850655, decouple_loss:0.003720997367054224
Iteration: 7076, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4414435625076294
loss_pred:0.01839333586394787, decouple_loss:0.004327261820435524
The generated pressure mean: 0.44527870416641235
loss_pred:0.01726841926574707, decouple_loss:0.004321356303989887
The generated pressure mean: 0.4408408999443054
loss_pred:0.01798095367848873, decouple_loss:0.004309256095439196
Iteration: 7077, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44907113909721375
loss_pred:0.01778758130967617, decouple_loss:0.0033430857583880424
The generated pressure mean: 0.4478442370891571
loss_pred:0.018331630155444145, decouple_loss:0.003461106913164258
The generated pressure mean: 0.45236891508102417
loss_pred:0.01815258525311947, decouple_loss:0.003422914771363139
Iteration: 7078, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45189300179481506
loss_pred:0.01823677122592926, decouple_loss:0.004116501659154892
The generated pressure mean: 0.45145463943481445
loss_pred:0.017184525728225708, decouple_loss:0.004160055425018072
The generated pressure mean: 0.4537983536720276
loss_pred:0.018357163295149803, decouple_loss:0.004081618972122669
Iteration: 7079, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4423433244228363
loss_pred:0.01601804792881012, decouple_loss:0.003419277723878622
The generated pressure mean: 0.4427662491798401
The generated pressure mean: 0.44360437989234924
loss_pred:0.017764873802661896, decouple_loss:0.0031795119866728783
loss_pred:0.017911776900291443, decouple_loss:0.003030923428013921
Iteration: 7080, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492056667804718
loss_pred:0.017975056543946266, decouple_loss:0.003916861489415169
The generated pressure mean: 0.4471128284931183
loss_pred:0.022916102781891823, decouple_loss:0.004118724726140499
The generated pressure mean: 0.4501817524433136
loss_pred:0.01773270219564438, decouple_loss:0.004052731674164534
2023-04-17 14:22:52 testing...
The generated pressure mean: 0.4237813651561737
The generated pressure mean: 0.41770827770233154
The generated pressure mean: 0.42624858021736145
loss_pred:0.03220300003886223, decouple_loss:0.0035199210979044437
loss_pred:0.032992810010910034, decouple_loss:0.003483792534098029
loss_pred:0.03155031055212021, decouple_loss:0.0036065634340047836
WV_0_PC_0_EH_1_PS_40, loss: 0.03242554888129234, avg_mse: 0.049004312604665756
current test mse: 0.049004
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 7081, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4350087642669678
loss_pred:0.017876826226711273, decouple_loss:0.0030796241480857134
The generated pressure mean: 0.43242502212524414
loss_pred:0.01849006675183773, decouple_loss:0.003209122456610203
The generated pressure mean: 0.4320482909679413
loss_pred:0.01721806265413761, decouple_loss:0.0030373549088835716
Iteration: 7082, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4517231583595276
The generated pressure mean: 0.45099276304244995
loss_pred:0.01985645294189453, decouple_loss:0.004242443013936281
loss_pred:0.01895565539598465, decouple_loss:0.004078440833836794
The generated pressure mean: 0.44981658458709717
loss_pred:0.018677296116948128, decouple_loss:0.004303700290620327
Iteration: 7083, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46738526225090027
loss_pred:0.017267446964979172, decouple_loss:0.0035825171507894993The generated pressure mean: 0.45789575576782227
loss_pred:0.01929343305528164, decouple_loss:0.0035876650363206863
The generated pressure mean: 0.46407046914100647
loss_pred:0.0180908665060997, decouple_loss:0.003641017246991396
Iteration: 7084, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4394136369228363
The generated pressure mean: 0.43829262256622314
loss_pred:0.018942834809422493, decouple_loss:0.004316313192248344
loss_pred:0.01832772046327591, decouple_loss:0.004560688976198435
The generated pressure mean: 0.4394974112510681
loss_pred:0.017415478825569153, decouple_loss:0.004437618888914585
Iteration: 7085, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43237102031707764
The generated pressure mean: 0.43479597568511963
loss_pred:0.016523316502571106, decouple_loss:0.003834119299426675
loss_pred:0.018369043245911598, decouple_loss:0.0036609137896448374
The generated pressure mean: 0.4339127838611603
loss_pred:0.019905034452676773, decouple_loss:0.0037093141581863165
Iteration: 7086, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4543723464012146
The generated pressure mean: 0.44941383600234985
loss_pred:0.018651630729436874, decouple_loss:0.004744232632219791
loss_pred:0.01861593686044216, decouple_loss:0.0048112948425114155
The generated pressure mean: 0.4489847719669342
loss_pred:0.018847713246941566, decouple_loss:0.004723873920738697
Iteration: 7087, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494992196559906
The generated pressure mean: 0.4507680833339691loss_pred:0.01791246607899666, decouple_loss:0.003862496232613921
loss_pred:0.018002482131123543, decouple_loss:0.003751190612092614
The generated pressure mean: 0.4528043866157532
loss_pred:0.01819748431444168, decouple_loss:0.004128207918256521
Iteration: 7088, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4451691210269928
loss_pred:0.022996971383690834, decouple_loss:0.0041655185632407665
The generated pressure mean: 0.4476982653141022
loss_pred:0.018306368961930275, decouple_loss:0.00418594665825367
The generated pressure mean: 0.4463796615600586
loss_pred:0.01857188530266285, decouple_loss:0.004149513319134712
Iteration: 7089, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43931928277015686
loss_pred:0.017983030527830124, decouple_loss:0.0037443344481289387
The generated pressure mean: 0.44046473503112793
The generated pressure mean: 0.4392327666282654
loss_pred:0.01958533562719822, decouple_loss:0.0037592712324112654
loss_pred:0.019002187997102737, decouple_loss:0.0037555925082415342
Iteration: 7090, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45146581530570984
loss_pred:0.019756052643060684, decouple_loss:0.0034316955134272575
The generated pressure mean: 0.4540446102619171
loss_pred:0.01965908147394657, decouple_loss:0.003174085868522525
The generated pressure mean: 0.45162251591682434
loss_pred:0.019460158422589302, decouple_loss:0.003305618418380618
2023-04-17 14:25:23 testing...
The generated pressure mean: 0.41536781191825867
The generated pressure mean: 0.42079639434814453
The generated pressure mean: 0.42407944798469543
loss_pred:0.032657690346241, decouple_loss:0.0037145751994103193
loss_pred:0.031633876264095306, decouple_loss:0.003927877638489008
loss_pred:0.031016413122415543, decouple_loss:0.0038864072412252426
WV_0_PC_0_EH_1_PS_40, loss: 0.03196147829294205, avg_mse: 0.04811154678463936
current test mse: 0.048112
Iteration: 7091, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.442234069108963
loss_pred:0.019387615844607353, decouple_loss:0.0032431373838335276
The generated pressure mean: 0.44246456027030945
loss_pred:0.017442379146814346, decouple_loss:0.0031705473084002733
The generated pressure mean: 0.4426404535770416
loss_pred:0.018452268093824387, decouple_loss:0.0033605173230171204
Iteration: 7092, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44442081451416016
loss_pred:0.018020376563072205, decouple_loss:0.0027103873435407877
The generated pressure mean: 0.4463728070259094
loss_pred:0.017445405945181847, decouple_loss:0.0028956623282283545
The generated pressure mean: 0.4473491311073303
loss_pred:0.01864040270447731, decouple_loss:0.0028639533556997776
Iteration: 7093, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45129454135894775
loss_pred:0.018073545768857002, decouple_loss:0.003437764709815383
The generated pressure mean: 0.4524308145046234
loss_pred:0.018836969509720802, decouple_loss:0.003621980082243681
The generated pressure mean: 0.4492495059967041
loss_pred:0.016897937282919884, decouple_loss:0.0037439740262925625
Iteration: 7094, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.445295512676239
loss_pred:0.017482301220297813, decouple_loss:0.0033339504152536392
The generated pressure mean: 0.444353848695755
loss_pred:0.01903327740728855, decouple_loss:0.0035788395907729864
The generated pressure mean: 0.4451477825641632
loss_pred:0.01826070435345173, decouple_loss:0.0033458243124186993
Iteration: 7095, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45023733377456665
loss_pred:0.017795316874980927, decouple_loss:0.003190058283507824
The generated pressure mean: 0.4434754252433777
loss_pred:0.018287960439920425, decouple_loss:0.003063795855268836
The generated pressure mean: 0.44472524523735046
loss_pred:0.01876169443130493, decouple_loss:0.003160519292578101
Iteration: 7096, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472671449184418
loss_pred:0.019114630296826363, decouple_loss:0.0034985700622200966
The generated pressure mean: 0.4484463930130005
loss_pred:0.017744775861501694, decouple_loss:0.00338379037566483
The generated pressure mean: 0.4471047818660736
loss_pred:0.018642572686076164, decouple_loss:0.0035020492505282164
Iteration: 7097, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485723078250885
loss_pred:0.01651928760111332, decouple_loss:0.00293076504021883
The generated pressure mean: 0.4494180977344513
loss_pred:0.01882689818739891, decouple_loss:0.0032216068357229233
The generated pressure mean: 0.45082005858421326
loss_pred:0.017991522327065468, decouple_loss:0.0027694343589246273
Iteration: 7098, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4424353241920471
loss_pred:0.018746498972177505, decouple_loss:0.00374615634791553
The generated pressure mean: 0.44225236773490906
loss_pred:0.01782015897333622, decouple_loss:0.0038463082164525986
The generated pressure mean: 0.44032448530197144
loss_pred:0.01712515950202942, decouple_loss:0.004096020478755236
Iteration: 7099, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.438424676656723
loss_pred:0.017501428723335266, decouple_loss:0.003740548389032483
The generated pressure mean: 0.444280207157135
loss_pred:0.018138224259018898, decouple_loss:0.0035847174003720284
The generated pressure mean: 0.4417879283428192
loss_pred:0.017848627641797066, decouple_loss:0.003754381323233247
Iteration: 7100, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44995635747909546
loss_pred:0.018953930586576462, decouple_loss:0.003620056202635169
The generated pressure mean: 0.4537114202976227
The generated pressure mean: 0.45226189494132996
loss_pred:0.018941499292850494, decouple_loss:0.0035283882170915604
loss_pred:0.01853330433368683, decouple_loss:0.0033538967836648226
2023-04-17 14:27:17 testing...
The generated pressure mean: 0.41339874267578125
The generated pressure mean: 0.42027658224105835
loss_pred:0.03262984752655029, decouple_loss:0.0036381836980581284
The generated pressure mean: 0.42337292432785034
loss_pred:0.03148263320326805, decouple_loss:0.0037085143849253654
loss_pred:0.030655883252620697, decouple_loss:0.003748472547158599
WV_0_PC_0_EH_1_PS_40, loss: 0.0317743755877018, avg_mse: 0.04821564629673958
current test mse: 0.048216
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 7101, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459744393825531
loss_pred:0.017955783754587173, decouple_loss:0.003437289735302329
The generated pressure mean: 0.4430179297924042
loss_pred:0.017749125137925148, decouple_loss:0.0034651707392185926
The generated pressure mean: 0.4433358907699585
loss_pred:0.01732339896261692, decouple_loss:0.003303268924355507
Iteration: 7102, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44648832082748413
loss_pred:0.01918216049671173, decouple_loss:0.0032040500082075596
The generated pressure mean: 0.4517343044281006
loss_pred:0.019344724714756012, decouple_loss:0.0030408548191189766
The generated pressure mean: 0.44620028138160706
loss_pred:0.017602398991584778, decouple_loss:0.00305522745475173
Iteration: 7103, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44858911633491516
loss_pred:0.017830312252044678, decouple_loss:0.0030267054680734873
The generated pressure mean: 0.44845351576805115
loss_pred:0.01754429005086422, decouple_loss:0.0030564547050744295
The generated pressure mean: 0.447295606136322
loss_pred:0.018252667039632797, decouple_loss:0.003017110051587224
Iteration: 7104, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44508570432662964
The generated pressure mean: 0.441879540681839loss_pred:0.018510188907384872, decouple_loss:0.0027968413196504116
loss_pred:0.018094917759299278, decouple_loss:0.0027249353006482124
The generated pressure mean: 0.4489845335483551
loss_pred:0.017361244186758995, decouple_loss:0.003009901847690344
Iteration: 7105, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44536110758781433
loss_pred:0.017255999147892, decouple_loss:0.0027355875354260206
The generated pressure mean: 0.44211545586586
loss_pred:0.018285559490323067, decouple_loss:0.00286565232090652
The generated pressure mean: 0.447895348072052
loss_pred:0.018614565953612328, decouple_loss:0.002881168620660901
Iteration: 7106, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4454056918621063
loss_pred:0.017138542607426643, decouple_loss:0.0032586166635155678
The generated pressure mean: 0.443825364112854
loss_pred:0.020144542679190636, decouple_loss:0.003199636237695813
The generated pressure mean: 0.444663941860199
loss_pred:0.020160695537924767, decouple_loss:0.0030742089729756117
Iteration: 7107, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4435083568096161
loss_pred:0.019832931458950043, decouple_loss:0.0030776679050177336
The generated pressure mean: 0.43677330017089844
loss_pred:0.019978418946266174, decouple_loss:0.0032358707394450903
The generated pressure mean: 0.4482022523880005
loss_pred:0.017748260870575905, decouple_loss:0.003064568853005767
Iteration: 7108, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4427300691604614
The generated pressure mean: 0.44142380356788635
loss_pred:0.017781808972358704, decouple_loss:0.003003458259627223
loss_pred:0.01847900077700615, decouple_loss:0.002927906345576048
The generated pressure mean: 0.44013142585754395
loss_pred:0.018499724566936493, decouple_loss:0.002947805216535926
Iteration: 7109, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45189720392227173
loss_pred:0.01737261191010475, decouple_loss:0.0037517461460083723
The generated pressure mean: 0.4475104510784149
loss_pred:0.017211105674505234, decouple_loss:0.003936748951673508
The generated pressure mean: 0.4514238238334656
loss_pred:0.01840447261929512, decouple_loss:0.00377991097047925
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 7110, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45299267768859863
loss_pred:0.01757730543613434, decouple_loss:0.003039474366232753
The generated pressure mean: 0.45122644305229187
loss_pred:0.017597753554582596, decouple_loss:0.0031532403081655502
The generated pressure mean: 0.45418810844421387
loss_pred:0.01892220415174961, decouple_loss:0.0029599987901747227
2023-04-17 14:29:49 testing...
The generated pressure mean: 0.41490551829338074
The generated pressure mean: 0.42215701937675476
loss_pred:0.032324787229299545, decouple_loss:0.003261585021391511
The generated pressure mean: 0.42540255188941956
loss_pred:0.03122936375439167, decouple_loss:0.0034037111327052116
loss_pred:0.030912835150957108, decouple_loss:0.003468157025054097
WV_0_PC_0_EH_1_PS_40, loss: 0.03165788576006889, avg_mse: 0.04788632690906525
current test mse: 0.047886
Iteration: 7111, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44068673253059387
loss_pred:0.01854747347533703, decouple_loss:0.0030585704371333122
The generated pressure mean: 0.4388708472251892
loss_pred:0.017904864624142647, decouple_loss:0.0027056545950472355
The generated pressure mean: 0.4419068992137909
loss_pred:0.018595173954963684, decouple_loss:0.0029301156755536795
Iteration: 7112, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44623973965644836
loss_pred:0.018248731270432472, decouple_loss:0.0036176524590700865
The generated pressure mean: 0.44218653440475464
loss_pred:0.019091114401817322, decouple_loss:0.003741971915587783
The generated pressure mean: 0.4474954903125763
loss_pred:0.02124265767633915, decouple_loss:0.0036575025878846645
Iteration: 7113, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43412983417510986
loss_pred:0.01790987141430378, decouple_loss:0.0029621405992656946
The generated pressure mean: 0.43364953994750977
loss_pred:0.020309587940573692, decouple_loss:0.003489704802632332
The generated pressure mean: 0.4350239336490631
loss_pred:0.018040327355265617, decouple_loss:0.0032295265700668097
Iteration: 7114, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45855093002319336
loss_pred:0.01823543570935726, decouple_loss:0.002811186481267214
The generated pressure mean: 0.46042442321777344
loss_pred:0.017866775393486023, decouple_loss:0.002799833891913295
The generated pressure mean: 0.45590105652809143
loss_pred:0.018348554149270058, decouple_loss:0.003020091913640499
Iteration: 7115, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4535614550113678
loss_pred:0.017055189236998558, decouple_loss:0.0027606182266026735
The generated pressure mean: 0.4512629806995392
loss_pred:0.017999814823269844, decouple_loss:0.0026775698643177748
The generated pressure mean: 0.45220261812210083
loss_pred:0.017414309084415436, decouple_loss:0.002582764020189643
Iteration: 7116, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44193235039711
loss_pred:0.01766086183488369, decouple_loss:0.003095986321568489
The generated pressure mean: 0.4407324492931366
loss_pred:0.018197888508439064, decouple_loss:0.002878574887290597
The generated pressure mean: 0.4408625662326813
loss_pred:0.01765579916536808, decouple_loss:0.0028866443317383528
Iteration: 7117, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470895826816559
loss_pred:0.017029235139489174, decouple_loss:0.0029334123246371746
The generated pressure mean: 0.4456406235694885
loss_pred:0.016830414533615112, decouple_loss:0.002798516070470214
The generated pressure mean: 0.4465344548225403
loss_pred:0.018228694796562195, decouple_loss:0.0028003384359180927
Iteration: 7118, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502534866333008
loss_pred:0.01864277757704258, decouple_loss:0.0024370562750846148
The generated pressure mean: 0.4478062689304352
loss_pred:0.017319267615675926, decouple_loss:0.002483607269823551
The generated pressure mean: 0.4493350386619568
loss_pred:0.01874285191297531, decouple_loss:0.0023640731815248728
Iteration: 7119, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44561246037483215
The generated pressure mean: 0.4450989365577698
loss_pred:0.018111001700162888, decouple_loss:0.0026637327391654253
loss_pred:0.01859230361878872, decouple_loss:0.0027037456165999174
The generated pressure mean: 0.44171613454818726
loss_pred:0.018474841490387917, decouple_loss:0.002593331504613161
Iteration: 7120, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4437482953071594
loss_pred:0.01845388673245907, decouple_loss:0.0022795896511524916
The generated pressure mean: 0.44028976559638977
loss_pred:0.016842534765601158, decouple_loss:0.0022561438381671906
The generated pressure mean: 0.439619779586792
loss_pred:0.017177224159240723, decouple_loss:0.002523032482713461
2023-04-17 14:31:43 testing...
The generated pressure mean: 0.4193772077560425
The generated pressure mean: 0.4119720458984375
The generated pressure mean: 0.42250630259513855
loss_pred:0.03188826143741608, decouple_loss:0.0035072541795670986
loss_pred:0.03311967849731445, decouple_loss:0.003360668197274208
loss_pred:0.03162553533911705, decouple_loss:0.0036169651430100203
WV_0_PC_0_EH_1_PS_40, loss: 0.03238590806722641, avg_mse: 0.04980035126209259
current test mse: 0.0498
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 7121, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491955041885376
loss_pred:0.018270786851644516, decouple_loss:0.00288348994217813
The generated pressure mean: 0.449583500623703
loss_pred:0.016746053472161293, decouple_loss:0.0029385497327893972
The generated pressure mean: 0.4521646201610565
loss_pred:0.019497979432344437, decouple_loss:0.0028776898980140686
Iteration: 7122, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464397430419922
The generated pressure mean: 0.4512486159801483
loss_pred:0.01874045841395855, decouple_loss:0.0028769124764949083
loss_pred:0.016999613493680954, decouple_loss:0.002820072928443551
The generated pressure mean: 0.44743746519088745
loss_pred:0.01744905859231949, decouple_loss:0.002755639376118779
Iteration: 7123, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44883427023887634
The generated pressure mean: 0.44734281301498413
loss_pred:0.01729951985180378, decouple_loss:0.0023503724951297045
loss_pred:0.017965037375688553, decouple_loss:0.0023830875288695097
The generated pressure mean: 0.4423384368419647
loss_pred:0.017757000401616096, decouple_loss:0.002374175703153014
Iteration: 7124, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472035765647888
loss_pred:0.01873728632926941, decouple_loss:0.0027455920353531837
The generated pressure mean: 0.44698628783226013
loss_pred:0.01879931427538395, decouple_loss:0.0029225603211671114
The generated pressure mean: 0.4488021433353424
loss_pred:0.020508669316768646, decouple_loss:0.0028343903832137585
Iteration: 7125, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44166621565818787
loss_pred:0.01899384707212448, decouple_loss:0.002204745076596737
The generated pressure mean: 0.4382660388946533
loss_pred:0.0183588657528162, decouple_loss:0.002091272035613656
The generated pressure mean: 0.4399632513523102
loss_pred:0.01817386969923973, decouple_loss:0.002258841646835208
Iteration: 7126, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501951336860657
loss_pred:0.01867365464568138, decouple_loss:0.0026976396329700947
The generated pressure mean: 0.44662752747535706
loss_pred:0.01682176999747753, decouple_loss:0.0025192881003022194
The generated pressure mean: 0.44750896096229553
loss_pred:0.01783760078251362, decouple_loss:0.0025662684347480536
Iteration: 7127, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4441196322441101
loss_pred:0.01873745210468769, decouple_loss:0.004011434502899647
The generated pressure mean: 0.4498628079891205
loss_pred:0.01839682273566723, decouple_loss:0.0038772134575992823
The generated pressure mean: 0.446719229221344
loss_pred:0.016897525638341904, decouple_loss:0.0038167256861925125
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 7128, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4537712037563324
loss_pred:0.017632311210036278, decouple_loss:0.002625515218824148
The generated pressure mean: 0.4527525007724762
loss_pred:0.01730315200984478, decouple_loss:0.0025526827666908503
The generated pressure mean: 0.45441532135009766
loss_pred:0.018266044557094574, decouple_loss:0.0026631418149918318
Iteration: 7129, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4525528848171234
loss_pred:0.018928447738289833, decouple_loss:0.003297544550150633
The generated pressure mean: 0.44747433066368103
loss_pred:0.01962042972445488, decouple_loss:0.0034324759617447853
The generated pressure mean: 0.4479140043258667
loss_pred:0.018612202256917953, decouple_loss:0.0033701544161885977
Iteration: 7130, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43097326159477234
loss_pred:0.017691612243652344, decouple_loss:0.0024486130569130182
The generated pressure mean: 0.4364453852176666
loss_pred:0.017715957015752792, decouple_loss:0.002424434060230851
The generated pressure mean: 0.4319978952407837
loss_pred:0.01812274381518364, decouple_loss:0.002437409246340394
2023-04-17 14:34:14 testing...
The generated pressure mean: 0.41456034779548645
The generated pressure mean: 0.42157530784606934
The generated pressure mean: 0.4246254861354828
loss_pred:0.03226267173886299, decouple_loss:0.0030395661015063524
loss_pred:0.0312384981662035, decouple_loss:0.0031771252397447824
loss_pred:0.0307309590280056, decouple_loss:0.00328535377047956
WV_0_PC_0_EH_1_PS_40, loss: 0.03156907856464386, avg_mse: 0.04825519025325775
current test mse: 0.048255
Iteration: 7131, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4397682845592499
loss_pred:0.019320601597428322, decouple_loss:0.002450458472594619
The generated pressure mean: 0.44432058930397034
loss_pred:0.018956298008561134, decouple_loss:0.002516912529245019
The generated pressure mean: 0.44488978385925293
loss_pred:0.019123034551739693, decouple_loss:0.0025491586420685053
Iteration: 7132, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45195242762565613
loss_pred:0.018200598657131195, decouple_loss:0.002612894866615534
The generated pressure mean: 0.4507906138896942
loss_pred:0.018612850457429886, decouple_loss:0.0025577968917787075
The generated pressure mean: 0.45564043521881104
loss_pred:0.017846032977104187, decouple_loss:0.0025648786686360836
Iteration: 7133, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4516783058643341
The generated pressure mean: 0.4490795135498047
loss_pred:0.01798621006309986, decouple_loss:0.00261779990978539
loss_pred:0.017371635884046555, decouple_loss:0.002570696175098419
The generated pressure mean: 0.45247143507003784
loss_pred:0.017592987045645714, decouple_loss:0.0026052971370518208
Iteration: 7134, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.451637327671051
loss_pred:0.018871907144784927, decouple_loss:0.0026431463193148375
The generated pressure mean: 0.44898125529289246
loss_pred:0.018226277083158493, decouple_loss:0.00270260963588953
The generated pressure mean: 0.4514353275299072
loss_pred:0.017329927533864975, decouple_loss:0.002669578418135643
Iteration: 7135, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44486314058303833
loss_pred:0.018093692138791084, decouple_loss:0.002141243312507868
The generated pressure mean: 0.4466777741909027
loss_pred:0.017809970304369926, decouple_loss:0.002183325355872512
The generated pressure mean: 0.444654643535614
loss_pred:0.019836803898215294, decouple_loss:0.002037429716438055
Iteration: 7136, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43368959426879883
The generated pressure mean: 0.42941680550575256
loss_pred:0.019953781738877296, decouple_loss:0.0024003307335078716
loss_pred:0.017925789579749107, decouple_loss:0.0026363821234554052
The generated pressure mean: 0.43559762835502625
loss_pred:0.018506444990634918, decouple_loss:0.0023209957871586084
Iteration: 7137, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4562526345252991
loss_pred:0.01876576617360115, decouple_loss:0.0027921712026000023
The generated pressure mean: 0.4527933895587921
loss_pred:0.018405089154839516, decouple_loss:0.0027018629480153322
The generated pressure mean: 0.453862726688385
loss_pred:0.017360759899020195, decouple_loss:0.002620245097205043
Iteration: 7138, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45697638392448425
loss_pred:0.01904076337814331, decouple_loss:0.0026970410253852606
The generated pressure mean: 0.4563864767551422
loss_pred:0.018722452223300934, decouple_loss:0.002582086715847254
The generated pressure mean: 0.4606630504131317
loss_pred:0.018508536741137505, decouple_loss:0.002543081296607852
Iteration: 7139, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44405004382133484
loss_pred:0.018082894384860992, decouple_loss:0.002616941463202238
The generated pressure mean: 0.44649073481559753
loss_pred:0.018549930304288864, decouple_loss:0.0025311007630079985
The generated pressure mean: 0.44805487990379333
loss_pred:0.01829787716269493, decouple_loss:0.0025696149095892906
Iteration: 7140, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4379613399505615
loss_pred:0.018725048750638962, decouple_loss:0.003043202217668295
The generated pressure mean: 0.4392331838607788
loss_pred:0.018679559230804443, decouple_loss:0.003009410807862878
The generated pressure mean: 0.4390639066696167
loss_pred:0.01838597096502781, decouple_loss:0.002967744367197156
2023-04-17 14:36:08 testing...
The generated pressure mean: 0.4151611626148224
The generated pressure mean: 0.4224233031272888
The generated pressure mean: 0.42550450563430786
loss_pred:0.03193410858511925, decouple_loss:0.002724373247474432
loss_pred:0.03078390471637249, decouple_loss:0.0028362032026052475
loss_pred:0.030124282464385033, decouple_loss:0.0030261422507464886
WV_0_PC_0_EH_1_PS_40, loss: 0.031090542674064636, avg_mse: 0.04742679372429848
current test mse: 0.047427
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 7141, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4417245388031006
loss_pred:0.018515722826123238, decouple_loss:0.0023536616936326027
The generated pressure mean: 0.4455883502960205
The generated pressure mean: 0.44649434089660645
loss_pred:0.017124319449067116, decouple_loss:0.0023307830560952425
loss_pred:0.018368182703852654, decouple_loss:0.0025050451513379812
Iteration: 7142, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44559258222579956
loss_pred:0.017351165413856506, decouple_loss:0.003115411614999175
The generated pressure mean: 0.4447120428085327
loss_pred:0.019021673128008842, decouple_loss:0.003074479755014181
The generated pressure mean: 0.4430462121963501
loss_pred:0.01804397627711296, decouple_loss:0.003142109140753746
Iteration: 7143, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4607580304145813
loss_pred:0.018345700576901436, decouple_loss:0.0024005055893212557
The generated pressure mean: 0.4592475891113281
loss_pred:0.018631260842084885, decouple_loss:0.002380714286118746
The generated pressure mean: 0.457995742559433
loss_pred:0.01791219972074032, decouple_loss:0.002368942368775606
Iteration: 7144, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43902334570884705
loss_pred:0.018178939819335938, decouple_loss:0.002388632856309414
The generated pressure mean: 0.44176000356674194
loss_pred:0.020417343825101852, decouple_loss:0.0022753397934138775
The generated pressure mean: 0.43730440735816956
loss_pred:0.017975570634007454, decouple_loss:0.002324170432984829
Iteration: 7145, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43166783452033997
The generated pressure mean: 0.43268170952796936
loss_pred:0.019857408478856087, decouple_loss:0.003070679260417819
loss_pred:0.017904238775372505, decouple_loss:0.0032369340769946575
The generated pressure mean: 0.4364268183708191
loss_pred:0.01978968270123005, decouple_loss:0.0030486900359392166
Iteration: 7146, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4619313180446625
loss_pred:0.017826300114393234, decouple_loss:0.0028827786445617676
The generated pressure mean: 0.4575344920158386
loss_pred:0.019439758732914925, decouple_loss:0.0028958655893802643
The generated pressure mean: 0.46320363879203796
loss_pred:0.019025836139917374, decouple_loss:0.002906691050156951
Iteration: 7147, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44283828139305115
loss_pred:0.018757153302431107, decouple_loss:0.002778860041871667
The generated pressure mean: 0.44643527269363403
loss_pred:0.018621791154146194, decouple_loss:0.0027752388268709183
The generated pressure mean: 0.44155430793762207
loss_pred:0.019150368869304657, decouple_loss:0.0027662140782922506
Iteration: 7148, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460812509059906
loss_pred:0.018718980252742767, decouple_loss:0.0032862701918929815
The generated pressure mean: 0.4453423023223877
loss_pred:0.017404921352863312, decouple_loss:0.0031788640189915895
The generated pressure mean: 0.4446442425251007
loss_pred:0.017464054748415947, decouple_loss:0.0032275021076202393
Iteration: 7149, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4446173310279846
loss_pred:0.019021684303879738, decouple_loss:0.0028769955970346928
The generated pressure mean: 0.44994041323661804
loss_pred:0.01788407191634178, decouple_loss:0.002927729394286871
The generated pressure mean: 0.44814127683639526
loss_pred:0.017166968435049057, decouple_loss:0.0028607032727450132
Iteration: 7150, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45087549090385437
loss_pred:0.020397167652845383, decouple_loss:0.0036586683709174395
The generated pressure mean: 0.45414361357688904
loss_pred:0.018007028847932816, decouple_loss:0.003525905078276992
The generated pressure mean: 0.45317918062210083
loss_pred:0.01755591109395027, decouple_loss:0.003547853557392955
2023-04-17 14:38:42 testing...
The generated pressure mean: 0.417189359664917
The generated pressure mean: 0.42491158843040466
The generated pressure mean: 0.42803218960762024
loss_pred:0.032293085008859634, decouple_loss:0.003144960617646575
loss_pred:0.031011493876576424, decouple_loss:0.003307964187115431
loss_pred:0.030699046328663826, decouple_loss:0.0035158509854227304
WV_0_PC_0_EH_1_PS_40, loss: 0.031500689685344696, avg_mse: 0.04838690906763077
current test mse: 0.048387
Iteration: 7151, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43821802735328674
loss_pred:0.017590411007404327, decouple_loss:0.0028010800015181303
The generated pressure mean: 0.434358686208725
loss_pred:0.017547566443681717, decouple_loss:0.002845833543688059
The generated pressure mean: 0.4370347857475281
loss_pred:0.017533699050545692, decouple_loss:0.002780614886432886
Iteration: 7152, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44444331526756287
loss_pred:0.016274549067020416, decouple_loss:0.0028401901945471764
The generated pressure mean: 0.4385770857334137
loss_pred:0.016631780192255974, decouple_loss:0.0027852277271449566
The generated pressure mean: 0.44732943177223206
loss_pred:0.016817227005958557, decouple_loss:0.002778126858174801
Iteration: 7153, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45279961824417114
loss_pred:0.017386293038725853, decouple_loss:0.003562740981578827
The generated pressure mean: 0.45480287075042725
loss_pred:0.017621425911784172, decouple_loss:0.0037035050336271524
The generated pressure mean: 0.4543757140636444
loss_pred:0.01790662109851837, decouple_loss:0.0034363376908004284
Iteration: 7154, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478510022163391
loss_pred:0.01768633723258972, decouple_loss:0.0029999904800206423
The generated pressure mean: 0.44715794920921326
loss_pred:0.02054464817047119, decouple_loss:0.00305173615925014
The generated pressure mean: 0.4496115744113922
loss_pred:0.0173362847417593, decouple_loss:0.0029303240589797497
Iteration: 7155, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4407028257846832
loss_pred:0.018105994910001755, decouple_loss:0.0025231745094060898
The generated pressure mean: 0.4410562217235565
loss_pred:0.016997532919049263, decouple_loss:0.002164042554795742
The generated pressure mean: 0.44021856784820557
loss_pred:0.017068609595298767, decouple_loss:0.00239180657081306
Iteration: 7156, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44944578409194946
loss_pred:0.01764267310500145, decouple_loss:0.002729803556576371
The generated pressure mean: 0.4389247000217438
loss_pred:0.01692129485309124, decouple_loss:0.002662363462150097
The generated pressure mean: 0.4414481818675995
loss_pred:0.017545226961374283, decouple_loss:0.002821518573909998
Iteration: 7157, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4537043869495392
loss_pred:0.017525896430015564, decouple_loss:0.002632003277540207
The generated pressure mean: 0.4551648497581482
loss_pred:0.017920399084687233, decouple_loss:0.002512899925932288
The generated pressure mean: 0.4560197591781616
loss_pred:0.01854698546230793, decouple_loss:0.002560998545959592
Iteration: 7158, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501819908618927
loss_pred:0.017461426556110382, decouple_loss:0.0025563547387719154
The generated pressure mean: 0.4443252682685852
The generated pressure mean: 0.4470183253288269
loss_pred:0.017896560952067375, decouple_loss:0.0025817202404141426
loss_pred:0.018601272255182266, decouple_loss:0.002587961032986641
Iteration: 7159, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4437251091003418
loss_pred:0.017991576343774796, decouple_loss:0.0024109676014631987
The generated pressure mean: 0.4461432993412018
loss_pred:0.01872238703072071, decouple_loss:0.0026139523833990097
The generated pressure mean: 0.44882214069366455
loss_pred:0.017145739868283272, decouple_loss:0.0024263900704681873
Iteration: 7160, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4417403042316437
loss_pred:0.018079405650496483, decouple_loss:0.0023358077742159367
The generated pressure mean: 0.4413336515426636
loss_pred:0.017366349697113037, decouple_loss:0.002311806892976165
The generated pressure mean: 0.4425419867038727
loss_pred:0.01767607219517231, decouple_loss:0.002216578461229801
2023-04-17 14:40:35 testing...
The generated pressure mean: 0.4155585765838623
The generated pressure mean: 0.4230717122554779
loss_pred:0.031949326395988464, decouple_loss:0.0032797714229673147
The generated pressure mean: 0.4254337549209595
loss_pred:0.030756687745451927, decouple_loss:0.0034659903030842543
loss_pred:0.030089978128671646, decouple_loss:0.0036014867946505547
WV_0_PC_0_EH_1_PS_40, loss: 0.031104451045393944, avg_mse: 0.04698948189616203
current test mse: 0.046989
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 7161, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43972456455230713
loss_pred:0.018650278449058533, decouple_loss:0.0028140151407569647
The generated pressure mean: 0.43711358308792114
The generated pressure mean: 0.44499558210372925
loss_pred:0.01926153153181076, decouple_loss:0.0028939968906342983
loss_pred:0.016952132806181908, decouple_loss:0.0028915484435856342
Iteration: 7162, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4450892508029938
loss_pred:0.01914992369711399, decouple_loss:0.0026104699354618788
The generated pressure mean: 0.447360634803772
loss_pred:0.018117865547537804, decouple_loss:0.0024643107317388058
The generated pressure mean: 0.4406987726688385
loss_pred:0.018264465034008026, decouple_loss:0.002469883766025305
Iteration: 7163, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4521186053752899
loss_pred:0.018468761816620827, decouple_loss:0.0022122140508145094
The generated pressure mean: 0.4485161602497101
loss_pred:0.017086124047636986, decouple_loss:0.0022421148605644703
The generated pressure mean: 0.45146051049232483
loss_pred:0.018346447497606277, decouple_loss:0.0022373171523213387
Iteration: 7164, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4547491669654846
loss_pred:0.018055805936455727, decouple_loss:0.0025435462594032288
The generated pressure mean: 0.45323944091796875
loss_pred:0.017481593415141106, decouple_loss:0.0025348439812660217
The generated pressure mean: 0.4543503522872925
loss_pred:0.01742415688931942, decouple_loss:0.002593457233160734
Iteration: 7165, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4391007125377655
loss_pred:0.018279854208230972, decouple_loss:0.0026876444462686777
The generated pressure mean: 0.434821218252182
loss_pred:0.01823507808148861, decouple_loss:0.0027624687645584345
The generated pressure mean: 0.4405626356601715
loss_pred:0.018312374129891396, decouple_loss:0.0027958620339632034
Iteration: 7166, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43862318992614746
loss_pred:0.017849022522568703, decouple_loss:0.0025881417095661163
The generated pressure mean: 0.44327133893966675
loss_pred:0.019779976457357407, decouple_loss:0.0025412628892809153
The generated pressure mean: 0.440377801656723
loss_pred:0.01727844774723053, decouple_loss:0.00279610394500196
Iteration: 7167, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4522254467010498
loss_pred:0.01871342398226261, decouple_loss:0.0023696899879723787
The generated pressure mean: 0.4486713707447052
loss_pred:0.01839507929980755, decouple_loss:0.0021963610779494047
The generated pressure mean: 0.4510759115219116
loss_pred:0.020203405991196632, decouple_loss:0.0023466015700250864
Iteration: 7168, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43340787291526794
loss_pred:0.019610952585935593, decouple_loss:0.002546208444982767
The generated pressure mean: 0.4309094548225403
loss_pred:0.0183209590613842, decouple_loss:0.002460022456943989
The generated pressure mean: 0.43556666374206543
loss_pred:0.018916001543402672, decouple_loss:0.002549683442339301
Iteration: 7169, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46081578731536865
loss_pred:0.018299341201782227, decouple_loss:0.0027417102828621864
The generated pressure mean: 0.4534750282764435
loss_pred:0.01642611250281334, decouple_loss:0.002720164367929101
The generated pressure mean: 0.45796313881874084
loss_pred:0.01736375130712986, decouple_loss:0.0028529090341180563
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 7170, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4528486728668213
loss_pred:0.018074417486786842, decouple_loss:0.002364568877965212
The generated pressure mean: 0.4557839632034302
loss_pred:0.017354682087898254, decouple_loss:0.002282237634062767
The generated pressure mean: 0.4495854079723358
loss_pred:0.017630144953727722, decouple_loss:0.0022538613993674517
2023-04-17 14:43:08 testing...
The generated pressure mean: 0.41598325967788696
The generated pressure mean: 0.4230484068393707
loss_pred:0.03154886141419411, decouple_loss:0.002690675901249051
The generated pressure mean: 0.42587733268737793
loss_pred:0.030632926151156425, decouple_loss:0.002889276947826147
loss_pred:0.029869060963392258, decouple_loss:0.0028927370440214872
WV_0_PC_0_EH_1_PS_40, loss: 0.030824828892946243, avg_mse: 0.046566255390644073
current test mse: 0.046566
Iteration: 7171, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4353003203868866
loss_pred:0.018051400780677795, decouple_loss:0.0021726053673774004
The generated pressure mean: 0.4408475458621979
loss_pred:0.017545239999890327, decouple_loss:0.002213399624451995
The generated pressure mean: 0.4356919229030609
loss_pred:0.017580008134245872, decouple_loss:0.002244958421215415
Iteration: 7172, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44559353590011597
loss_pred:0.01738302782177925, decouple_loss:0.0020400939974933863
The generated pressure mean: 0.4473300874233246
loss_pred:0.017424877732992172, decouple_loss:0.002250031102448702
The generated pressure mean: 0.44783565402030945
loss_pred:0.01729266718029976, decouple_loss:0.0021206114906817675
Iteration: 7173, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45294737815856934
loss_pred:0.018583498895168304, decouple_loss:0.0020920028910040855
The generated pressure mean: 0.4528433680534363
loss_pred:0.017919234931468964, decouple_loss:0.0021541225723922253
The generated pressure mean: 0.45328739285469055
loss_pred:0.01848169043660164, decouple_loss:0.0021037620026618242
Iteration: 7174, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4378804862499237
loss_pred:0.018867623060941696, decouple_loss:0.002168721053749323
The generated pressure mean: 0.4364345967769623
loss_pred:0.019092710688710213, decouple_loss:0.0023729950189590454
The generated pressure mean: 0.44025394320487976
loss_pred:0.017757538706064224, decouple_loss:0.002366685541346669
Iteration: 7175, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44433724880218506
loss_pred:0.017156176269054413, decouple_loss:0.002770064165815711
The generated pressure mean: 0.43730777502059937
loss_pred:0.01890277862548828, decouple_loss:0.0027517774142324924
The generated pressure mean: 0.4445546865463257
loss_pred:0.0168654415756464, decouple_loss:0.0026735744904726744
Iteration: 7176, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4551839828491211
loss_pred:0.018135465681552887, decouple_loss:0.002513415412977338
The generated pressure mean: 0.4506179690361023
loss_pred:0.018300510942935944, decouple_loss:0.0027048932388424873
The generated pressure mean: 0.4579041302204132
loss_pred:0.01691361330449581, decouple_loss:0.002466101199388504
Iteration: 7177, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44551998376846313
loss_pred:0.019411806017160416, decouple_loss:0.002490533981472254
The generated pressure mean: 0.4471225440502167
loss_pred:0.01706566847860813, decouple_loss:0.002567326184362173
The generated pressure mean: 0.44687509536743164
loss_pred:0.01669975370168686, decouple_loss:0.0025437762960791588
Iteration: 7178, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43867379426956177
loss_pred:0.01843080297112465, decouple_loss:0.0023272838443517685
The generated pressure mean: 0.4360869824886322
loss_pred:0.01776762865483761, decouple_loss:0.002283340785652399
The generated pressure mean: 0.4386754035949707
loss_pred:0.01668727397918701, decouple_loss:0.002287504728883505
Iteration: 7179, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44721147418022156
loss_pred:0.016992349177598953, decouple_loss:0.0023878414649516344
The generated pressure mean: 0.4464666247367859
loss_pred:0.017338121309876442, decouple_loss:0.0023616591934114695
The generated pressure mean: 0.450857549905777
loss_pred:0.018286654725670815, decouple_loss:0.0023942056577652693
Iteration: 7180, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446713387966156
The generated pressure mean: 0.4495152235031128
loss_pred:0.018215319141745567, decouple_loss:0.002971312962472439
loss_pred:0.017252586781978607, decouple_loss:0.0029340614564716816
The generated pressure mean: 0.45161405205726624
loss_pred:0.01854305900633335, decouple_loss:0.0031256889924407005
2023-04-17 14:45:01 testing...
The generated pressure mean: 0.4122437834739685
The generated pressure mean: 0.41925138235092163
loss_pred:0.03141415864229202, decouple_loss:0.003017326118424535
The generated pressure mean: 0.42261892557144165
loss_pred:0.030217258259654045, decouple_loss:0.003270532004535198
loss_pred:0.029659222811460495, decouple_loss:0.00329095171764493
WV_0_PC_0_EH_1_PS_40, loss: 0.030589861795306206, avg_mse: 0.04613016918301582
current test mse: 0.04613
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 7181, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45134472846984863
loss_pred:0.017733676359057426, decouple_loss:0.0029077392537146807
The generated pressure mean: 0.45139390230178833
loss_pred:0.01890616863965988, decouple_loss:0.0029366726521402597
The generated pressure mean: 0.45055022835731506
loss_pred:0.0166309904307127, decouple_loss:0.002900273771956563
Iteration: 7182, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44359150528907776
The generated pressure mean: 0.44138869643211365
loss_pred:0.018375132232904434, decouple_loss:0.0035207802429795265
loss_pred:0.01926153153181076, decouple_loss:0.0034517438616603613
The generated pressure mean: 0.44072413444519043
loss_pred:0.01989995874464512, decouple_loss:0.003542145946994424
Iteration: 7183, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43928980827331543
The generated pressure mean: 0.4343894124031067loss_pred:0.017797254025936127, decouple_loss:0.0031035877764225006
loss_pred:0.01986153982579708, decouple_loss:0.0032502361573278904
The generated pressure mean: 0.4377102255821228
loss_pred:0.02029055543243885, decouple_loss:0.0030880023259669542
Iteration: 7184, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.455369234085083
The generated pressure mean: 0.4561656713485718
loss_pred:0.018149374052882195, decouple_loss:0.0034206232521682978
loss_pred:0.018703116104006767, decouple_loss:0.003461644984781742
The generated pressure mean: 0.4532950222492218
loss_pred:0.01792502962052822, decouple_loss:0.003557948162779212
Iteration: 7185, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4520615041255951
loss_pred:0.018355809152126312, decouple_loss:0.002948039211332798
The generated pressure mean: 0.4541374444961548
loss_pred:0.021068070083856583, decouple_loss:0.003014427376911044
The generated pressure mean: 0.4526943564414978
loss_pred:0.01760164462029934, decouple_loss:0.0030113309621810913
Iteration: 7186, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44043242931365967
loss_pred:0.017815520986914635, decouple_loss:0.002582941437140107
The generated pressure mean: 0.43528181314468384
The generated pressure mean: 0.43619486689567566loss_pred:0.018004581332206726, decouple_loss:0.002408235799521208
loss_pred:0.01810051128268242, decouple_loss:0.0025637198705226183
Iteration: 7187, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44313228130340576
loss_pred:0.0178326778113842, decouple_loss:0.003037458984181285
The generated pressure mean: 0.44364097714424133
loss_pred:0.019704386591911316, decouple_loss:0.003120475448668003
The generated pressure mean: 0.4457728862762451
loss_pred:0.01886078156530857, decouple_loss:0.0031288303434848785
Iteration: 7188, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4567251205444336
loss_pred:0.017938904464244843, decouple_loss:0.0025956002064049244
The generated pressure mean: 0.4546535313129425
loss_pred:0.01878305897116661, decouple_loss:0.0027548610232770443
The generated pressure mean: 0.4545842409133911
loss_pred:0.019523117691278458, decouple_loss:0.0028205798007547855
Iteration: 7189, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44637879729270935
The generated pressure mean: 0.44607681035995483
loss_pred:0.02013099007308483, decouple_loss:0.002408864675089717
loss_pred:0.017048774287104607, decouple_loss:0.002453964902088046
The generated pressure mean: 0.44366857409477234
loss_pred:0.017428305000066757, decouple_loss:0.002435070462524891
Iteration: 7190, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4462739825248718
The generated pressure mean: 0.4465826153755188
loss_pred:0.016886411234736443, decouple_loss:0.00311459694057703
loss_pred:0.0176922045648098, decouple_loss:0.0029896963387727737
The generated pressure mean: 0.44643956422805786
loss_pred:0.017605412751436234, decouple_loss:0.0030105921905487776
2023-04-17 14:47:30 testing...
The generated pressure mean: 0.42188698053359985
The generated pressure mean: 0.41386085748672485
The generated pressure mean: 0.42542198300361633
loss_pred:0.031150754541158676, decouple_loss:0.0031805734615772963
loss_pred:0.032510463148355484, decouple_loss:0.003041893243789673
loss_pred:0.030863570049405098, decouple_loss:0.0032603759318590164
WV_0_PC_0_EH_1_PS_40, loss: 0.031666312366724014, avg_mse: 0.04843147099018097
current test mse: 0.048431
Iteration: 7191, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44689661264419556
loss_pred:0.017649227753281593, decouple_loss:0.0025058987084776163
The generated pressure mean: 0.446534126996994
loss_pred:0.018491871654987335, decouple_loss:0.002529956167563796
The generated pressure mean: 0.44748184084892273
loss_pred:0.01954474486410618, decouple_loss:0.0026377816684544086
Iteration: 7192, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44145482778549194
loss_pred:0.018339477479457855, decouple_loss:0.003036543959751725
The generated pressure mean: 0.440315306186676
loss_pred:0.017327245324850082, decouple_loss:0.002940234960988164
The generated pressure mean: 0.43945759534835815
loss_pred:0.017305472865700722, decouple_loss:0.0032281421590596437
Iteration: 7193, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465278685092926
loss_pred:0.02008790709078312, decouple_loss:0.0028691040351986885
The generated pressure mean: 0.44465115666389465
loss_pred:0.017640048637986183, decouple_loss:0.0029680950101464987
The generated pressure mean: 0.44692349433898926
loss_pred:0.017413245514035225, decouple_loss:0.002913383999839425
Iteration: 7194, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4533258080482483
loss_pred:0.018401721492409706, decouple_loss:0.002083827508613467
The generated pressure mean: 0.4507054090499878
loss_pred:0.01651458628475666, decouple_loss:0.0022381325252354145
The generated pressure mean: 0.4549201428890228
loss_pred:0.018147265538573265, decouple_loss:0.0020955384243279696
Iteration: 7195, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45406365394592285
loss_pred:0.01847916841506958, decouple_loss:0.0028606753330677748
The generated pressure mean: 0.45179498195648193
loss_pred:0.017882104963064194, decouple_loss:0.002934008138254285
The generated pressure mean: 0.4522363543510437
loss_pred:0.018770186230540276, decouple_loss:0.002878617960959673
Iteration: 7196, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.440794974565506
loss_pred:0.017991604283452034, decouple_loss:0.002181891119107604
The generated pressure mean: 0.4389636814594269
loss_pred:0.01794743724167347, decouple_loss:0.002245036419481039
The generated pressure mean: 0.44303739070892334
loss_pred:0.017199669033288956, decouple_loss:0.002268427051603794
Iteration: 7197, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4333385229110718
loss_pred:0.022022198885679245, decouple_loss:0.0025059329345822334
The generated pressure mean: 0.4368818402290344
loss_pred:0.01820158213376999, decouple_loss:0.0024804039858281612
The generated pressure mean: 0.43437647819519043
loss_pred:0.01834908500313759, decouple_loss:0.0024477289989590645
Iteration: 7198, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44829484820365906
loss_pred:0.018396764993667603, decouple_loss:0.002508851233869791
The generated pressure mean: 0.44450294971466064
loss_pred:0.019200004637241364, decouple_loss:0.0025261947885155678
The generated pressure mean: 0.44721075892448425
loss_pred:0.01771889440715313, decouple_loss:0.002379006240516901
Iteration: 7199, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504433572292328
loss_pred:0.017581723630428314, decouple_loss:0.0028997103217989206
The generated pressure mean: 0.45167678594589233
loss_pred:0.017202556133270264, decouple_loss:0.002785364631563425
The generated pressure mean: 0.4541324973106384
loss_pred:0.016987964510917664, decouple_loss:0.0029820522759109735
Iteration: 7200, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447030633687973
loss_pred:0.018412446603178978, decouple_loss:0.002371035050600767
The generated pressure mean: 0.4496811032295227
The generated pressure mean: 0.45483407378196716loss_pred:0.017207471653819084, decouple_loss:0.002381891943514347
loss_pred:0.019602356478571892, decouple_loss:0.002348874928429723
2023-04-17 14:49:23 testing...
The generated pressure mean: 0.41491803526878357
The generated pressure mean: 0.42268046736717224
The generated pressure mean: 0.42541542649269104
loss_pred:0.03150214999914169, decouple_loss:0.0028923507779836655
loss_pred:0.0301812756806612, decouple_loss:0.0030222784262150526
loss_pred:0.0297115296125412, decouple_loss:0.0030471167992800474
WV_0_PC_0_EH_1_PS_40, loss: 0.030614346265792847, avg_mse: 0.04615609720349312
current test mse: 0.046156
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 7201, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4435144364833832
loss_pred:0.0179777592420578, decouple_loss:0.0025425979401916265
The generated pressure mean: 0.4396754205226898
loss_pred:0.018428798764944077, decouple_loss:0.0024323798716068268
The generated pressure mean: 0.43984782695770264
loss_pred:0.017338482663035393, decouple_loss:0.0025124126113951206
Iteration: 7202, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4433183968067169
loss_pred:0.019135795533657074, decouple_loss:0.0029754783026874065
The generated pressure mean: 0.4462549388408661
loss_pred:0.01766941510140896, decouple_loss:0.0028724619187414646
The generated pressure mean: 0.44639062881469727
loss_pred:0.016847750172019005, decouple_loss:0.0030197573360055685
Iteration: 7203, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44950345158576965
loss_pred:0.017076121643185616, decouple_loss:0.0024884985759854317
The generated pressure mean: 0.44710230827331543
loss_pred:0.01669440232217312, decouple_loss:0.002568937838077545
The generated pressure mean: 0.44842326641082764
loss_pred:0.018177460879087448, decouple_loss:0.002621815772727132
Iteration: 7204, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44918736815452576
loss_pred:0.016874123364686966, decouple_loss:0.0032204347662627697
The generated pressure mean: 0.45159944891929626
loss_pred:0.018075479194521904, decouple_loss:0.0030102822929620743
The generated pressure mean: 0.44872891902923584
loss_pred:0.019157616421580315, decouple_loss:0.00296159740537405
Iteration: 7205, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43950918316841125
loss_pred:0.01885388419032097, decouple_loss:0.002308434573933482
The generated pressure mean: 0.439948171377182
loss_pred:0.01693630777299404, decouple_loss:0.0023410310968756676
The generated pressure mean: 0.4427509009838104
loss_pred:0.018214460462331772, decouple_loss:0.0022461905609816313
Iteration: 7206, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44495588541030884
loss_pred:0.0171346478164196, decouple_loss:0.0025226015131920576
The generated pressure mean: 0.44663435220718384
loss_pred:0.017803316935896873, decouple_loss:0.0025861288886517286
The generated pressure mean: 0.4468424320220947
loss_pred:0.019136914983391762, decouple_loss:0.0025937934406101704
Iteration: 7207, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4574352502822876
loss_pred:0.01709592342376709, decouple_loss:0.0027856077067553997
The generated pressure mean: 0.4555645287036896
loss_pred:0.019455475732684135, decouple_loss:0.0028799930587410927
The generated pressure mean: 0.45596253871917725
loss_pred:0.01969006098806858, decouple_loss:0.002795036183670163
Iteration: 7208, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4310300946235657
loss_pred:0.01702909544110298, decouple_loss:0.0023992047645151615
The generated pressure mean: 0.42654699087142944
loss_pred:0.016525141894817352, decouple_loss:0.0025146130938082933
The generated pressure mean: 0.4279634654521942
loss_pred:0.018016617745161057, decouple_loss:0.002406567335128784
Iteration: 7209, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44362902641296387The generated pressure mean: 0.44436827301979065
loss_pred:0.01859511435031891, decouple_loss:0.0025523349177092314loss_pred:0.018141034990549088, decouple_loss:0.0025249135214835405
The generated pressure mean: 0.44102635979652405
loss_pred:0.018215181306004524, decouple_loss:0.0025089760310947895
Iteration: 7210, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4593208432197571
The generated pressure mean: 0.4630791246891022
loss_pred:0.017732804641127586, decouple_loss:0.0023406052496284246
loss_pred:0.01862512342631817, decouple_loss:0.002474684501066804
The generated pressure mean: 0.4628216326236725
loss_pred:0.01744040660560131, decouple_loss:0.0024928743951022625
2023-04-17 14:51:53 testing...
The generated pressure mean: 0.41375046968460083
The generated pressure mean: 0.4219607412815094
The generated pressure mean: 0.4252735674381256
loss_pred:0.031197790056467056, decouple_loss:0.002922364277765155
loss_pred:0.0301875788718462, decouple_loss:0.0030436082743108273
loss_pred:0.02941468171775341, decouple_loss:0.0031889155507087708
WV_0_PC_0_EH_1_PS_40, loss: 0.03041926585137844, avg_mse: 0.04592273011803627
current test mse: 0.045923
Iteration: 7211, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4439082741737366
loss_pred:0.017718249931931496, decouple_loss:0.002377255354076624
The generated pressure mean: 0.4480910301208496
loss_pred:0.017234569415450096, decouple_loss:0.0023021947126835585
The generated pressure mean: 0.4435350298881531
loss_pred:0.01741189882159233, decouple_loss:0.0023616075050085783
Iteration: 7212, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4376503527164459
loss_pred:0.01709628663957119, decouple_loss:0.0023178025148808956
The generated pressure mean: 0.445423424243927
loss_pred:0.01730366237461567, decouple_loss:0.002391407499089837
The generated pressure mean: 0.4459312856197357
loss_pred:0.01919979229569435, decouple_loss:0.0024179532192647457
Iteration: 7213, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4518081247806549
loss_pred:0.0176188163459301, decouple_loss:0.002565657487139106
The generated pressure mean: 0.4499551057815552
loss_pred:0.01806754432618618, decouple_loss:0.00257912022061646
The generated pressure mean: 0.4485953152179718
loss_pred:0.018385224044322968, decouple_loss:0.00256217154674232
Iteration: 7214, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44058603048324585
loss_pred:0.017491836100816727, decouple_loss:0.002541957888752222
The generated pressure mean: 0.4456018805503845
loss_pred:0.018162887543439865, decouple_loss:0.002581132808700204
The generated pressure mean: 0.4462856352329254
loss_pred:0.017847537994384766, decouple_loss:0.002445568097755313
Iteration: 7215, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44129979610443115
The generated pressure mean: 0.4439944624900818
loss_pred:0.017028696835041046, decouple_loss:0.0022168343421071768
loss_pred:0.019371187314391136, decouple_loss:0.002235998632386327
The generated pressure mean: 0.4437815845012665
loss_pred:0.017735186964273453, decouple_loss:0.0022180364467203617
Iteration: 7216, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45148658752441406
The generated pressure mean: 0.4533095061779022
loss_pred:0.018219664692878723, decouple_loss:0.0028162668459117413
loss_pred:0.01884404756128788, decouple_loss:0.002845741342753172
The generated pressure mean: 0.45631101727485657
loss_pred:0.01882060430943966, decouple_loss:0.0028852636460214853
Iteration: 7217, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479162395000458
The generated pressure mean: 0.4468004107475281
loss_pred:0.017504828050732613, decouple_loss:0.002721977885812521
loss_pred:0.017366940155625343, decouple_loss:0.0026505948044359684
The generated pressure mean: 0.4442691504955292
loss_pred:0.017479311674833298, decouple_loss:0.002557407831773162
Iteration: 7218, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4391516447067261
loss_pred:0.016802500933408737, decouple_loss:0.003200954757630825
The generated pressure mean: 0.43788090348243713
loss_pred:0.018347103148698807, decouple_loss:0.003265596926212311
The generated pressure mean: 0.4346875250339508
loss_pred:0.017313294112682343, decouple_loss:0.0032418749760836363
Iteration: 7219, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484346807003021
loss_pred:0.018557554110884666, decouple_loss:0.002714123809710145
The generated pressure mean: 0.45039740204811096
loss_pred:0.018721429631114006, decouple_loss:0.0026701935566961765
The generated pressure mean: 0.4501437842845917
loss_pred:0.017977872863411903, decouple_loss:0.002716854214668274
Iteration: 7220, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449082612991333
loss_pred:0.017510002478957176, decouple_loss:0.002771757310256362
The generated pressure mean: 0.4494004249572754
loss_pred:0.018952546641230583, decouple_loss:0.0027392208576202393
The generated pressure mean: 0.4472009241580963
loss_pred:0.01777602732181549, decouple_loss:0.0028785073664039373
2023-04-17 14:53:46 testing...
The generated pressure mean: 0.4122081696987152
The generated pressure mean: 0.4196258783340454
The generated pressure mean: 0.42262235283851624
loss_pred:0.03182092308998108, decouple_loss:0.003151269629597664
loss_pred:0.030075373128056526, decouple_loss:0.003381898393854499
loss_pred:0.03066156804561615, decouple_loss:0.0032709618099033833
WV_0_PC_0_EH_1_PS_40, loss: 0.031016025692224503, avg_mse: 0.04689494147896767
current test mse: 0.046895
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 7221, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4590958058834076
loss_pred:0.0171806663274765, decouple_loss:0.002584023168310523
The generated pressure mean: 0.454951673746109
loss_pred:0.018591126427054405, decouple_loss:0.002447709674015641
The generated pressure mean: 0.44825121760368347
loss_pred:0.018639666959643364, decouple_loss:0.002575443359091878
Iteration: 7222, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44178834557533264
The generated pressure mean: 0.44166505336761475
loss_pred:0.01762164756655693, decouple_loss:0.002697152318432927
loss_pred:0.017254749312996864, decouple_loss:0.0026167170144617558
The generated pressure mean: 0.4408412575721741
loss_pred:0.018403904512524605, decouple_loss:0.002696156967431307
Iteration: 7223, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43986618518829346
The generated pressure mean: 0.43841150403022766
loss_pred:0.01838640496134758, decouple_loss:0.0025236380752176046
loss_pred:0.017528994008898735, decouple_loss:0.0025041585322469473
The generated pressure mean: 0.4366643726825714
loss_pred:0.018485963344573975, decouple_loss:0.0026808592956513166
Iteration: 7224, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45562127232551575
loss_pred:0.017304837703704834, decouple_loss:0.002204128773882985
The generated pressure mean: 0.4495484530925751
loss_pred:0.019531315192580223, decouple_loss:0.002224965486675501
The generated pressure mean: 0.4597134590148926
loss_pred:0.017451781779527664, decouple_loss:0.002230319892987609
Iteration: 7225, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4557479918003082
The generated pressure mean: 0.4539373815059662
loss_pred:0.016830651089549065, decouple_loss:0.002148067345842719
loss_pred:0.017921647056937218, decouple_loss:0.0021405622828751802
The generated pressure mean: 0.4516235888004303
loss_pred:0.018772805109620094, decouple_loss:0.0020234761759638786
Iteration: 7226, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.438713401556015
loss_pred:0.017862165346741676, decouple_loss:0.00231190281920135
The generated pressure mean: 0.4364936351776123
loss_pred:0.01734934374690056, decouple_loss:0.0025311678182333708
The generated pressure mean: 0.4343760907649994
loss_pred:0.01708647795021534, decouple_loss:0.002515304833650589
Iteration: 7227, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43404367566108704
loss_pred:0.017068054527044296, decouple_loss:0.0021227472461760044
The generated pressure mean: 0.44059988856315613
loss_pred:0.01774687133729458, decouple_loss:0.002117299707606435
The generated pressure mean: 0.4435652792453766
loss_pred:0.01763790100812912, decouple_loss:0.00216673593968153
Iteration: 7228, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46029478311538696
loss_pred:0.01725682243704796, decouple_loss:0.0021568220108747482
The generated pressure mean: 0.45931631326675415
loss_pred:0.017866047099232674, decouple_loss:0.00209908839315176
The generated pressure mean: 0.4592635929584503
loss_pred:0.017587965354323387, decouple_loss:0.002030153525993228
Iteration: 7229, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44809266924858093
loss_pred:0.01898447424173355, decouple_loss:0.002088015666231513
The generated pressure mean: 0.45302823185920715
The generated pressure mean: 0.44755205512046814
loss_pred:0.016378913074731827, decouple_loss:0.0018956416752189398
loss_pred:0.01737750507891178, decouple_loss:0.0019291088683530688
Iteration: 7230, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4358646273612976
loss_pred:0.017024045810103416, decouple_loss:0.0025825812481343746
The generated pressure mean: 0.43335819244384766
loss_pred:0.01823042333126068, decouple_loss:0.0025976684410125017
The generated pressure mean: 0.43117934465408325
loss_pred:0.01788429543375969, decouple_loss:0.0027785077691078186
2023-04-17 14:56:17 testing...
The generated pressure mean: 0.41460785269737244
The generated pressure mean: 0.421797513961792
The generated pressure mean: 0.42415282130241394
loss_pred:0.03144336864352226, decouple_loss:0.002891128184273839
loss_pred:0.03007562644779682, decouple_loss:0.003024585545063019
loss_pred:0.029719514772295952, decouple_loss:0.0030587438959628344
WV_0_PC_0_EH_1_PS_40, loss: 0.03056241199374199, avg_mse: 0.0460672453045845
current test mse: 0.046067
Iteration: 7231, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4385716915130615
loss_pred:0.017859255895018578, decouple_loss:0.002656861674040556
The generated pressure mean: 0.43980613350868225
loss_pred:0.018548691645264626, decouple_loss:0.002679134253412485
The generated pressure mean: 0.4399665594100952
loss_pred:0.01701529510319233, decouple_loss:0.0026446243282407522
Iteration: 7232, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4584796130657196
loss_pred:0.018179772421717644, decouple_loss:0.0019981316290795803
The generated pressure mean: 0.4554886817932129
loss_pred:0.01789492554962635, decouple_loss:0.002055216347798705
The generated pressure mean: 0.4571341574192047
loss_pred:0.017813071608543396, decouple_loss:0.002110636094585061
Iteration: 7233, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45234841108322144
loss_pred:0.018497707322239876, decouple_loss:0.0024330331943929195
The generated pressure mean: 0.4571133852005005
loss_pred:0.017395293340086937, decouple_loss:0.002377602504566312
The generated pressure mean: 0.45696714520454407
loss_pred:0.016478950157761574, decouple_loss:0.0023477638605982065
Iteration: 7234, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4402599036693573
loss_pred:0.018764471635222435, decouple_loss:0.002297367434948683
The generated pressure mean: 0.4407869577407837
loss_pred:0.017088426277041435, decouple_loss:0.0022963460069149733
The generated pressure mean: 0.4408906102180481
loss_pred:0.018775884062051773, decouple_loss:0.0023361395578831434
Iteration: 7235, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442096948623657
loss_pred:0.018087590113282204, decouple_loss:0.00264648231677711
The generated pressure mean: 0.4410746395587921
loss_pred:0.018565859645605087, decouple_loss:0.002562497276812792
The generated pressure mean: 0.43190431594848633
loss_pred:0.01683894358575344, decouple_loss:0.0027221706695854664
Iteration: 7236, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.452604740858078
loss_pred:0.019258849322795868, decouple_loss:0.002666504355147481
The generated pressure mean: 0.4373978078365326
loss_pred:0.017645321786403656, decouple_loss:0.0025804731994867325
The generated pressure mean: 0.444697767496109
loss_pred:0.016951750963926315, decouple_loss:0.0026573636569082737
Iteration: 7237, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4409923553466797
loss_pred:0.01763000339269638, decouple_loss:0.002141031203791499
The generated pressure mean: 0.44426229596138
loss_pred:0.017306189984083176, decouple_loss:0.0022500911727547646
The generated pressure mean: 0.4477231204509735
loss_pred:0.01901393011212349, decouple_loss:0.0021066037006676197
Iteration: 7238, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4563726484775543
loss_pred:0.01738649420440197, decouple_loss:0.0023097412195056677
The generated pressure mean: 0.45663172006607056
loss_pred:0.017859140411019325, decouple_loss:0.0025672048795968294
The generated pressure mean: 0.4621925354003906
loss_pred:0.01782926730811596, decouple_loss:0.0023668832145631313
Iteration: 7239, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44337883591651917
The generated pressure mean: 0.4476334750652313
loss_pred:0.01729179359972477, decouple_loss:0.002237329026684165
loss_pred:0.016594722867012024, decouple_loss:0.002265529939904809
The generated pressure mean: 0.4483864903450012
loss_pred:0.01856044866144657, decouple_loss:0.0021783988922834396
Iteration: 7240, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4413619637489319
loss_pred:0.016650445759296417, decouple_loss:0.00285782921127975
The generated pressure mean: 0.4426940083503723
loss_pred:0.018273433670401573, decouple_loss:0.0029683809261769056
The generated pressure mean: 0.43748071789741516
loss_pred:0.017295900732278824, decouple_loss:0.0029140273109078407
2023-04-17 14:58:10 testing...
The generated pressure mean: 0.41390496492385864
The generated pressure mean: 0.422004759311676
The generated pressure mean: 0.42506879568099976
loss_pred:0.03280719742178917, decouple_loss:0.0032702432945370674
loss_pred:0.03148287907242775, decouple_loss:0.0035151317715644836
loss_pred:0.031017685309052467, decouple_loss:0.003554943948984146
WV_0_PC_0_EH_1_PS_40, loss: 0.03194159269332886, avg_mse: 0.04901221767067909
current test mse: 0.049012
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 7241, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4435873329639435
loss_pred:0.01768537610769272, decouple_loss:0.0029486382845789194
The generated pressure mean: 0.4464886486530304
loss_pred:0.017262933775782585, decouple_loss:0.0027431051712483168
The generated pressure mean: 0.44367432594299316
loss_pred:0.017597781494259834, decouple_loss:0.0027864668518304825
Iteration: 7242, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44748416543006897
The generated pressure mean: 0.45149892568588257loss_pred:0.015611466951668262, decouple_loss:0.0023466339334845543
loss_pred:0.017147988080978394, decouple_loss:0.00223572482354939
The generated pressure mean: 0.4477977752685547
loss_pred:0.017728378996253014, decouple_loss:0.0023162250872701406
Iteration: 7243, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44920170307159424
The generated pressure mean: 0.4488173723220825
loss_pred:0.018377045169472694, decouple_loss:0.0023348527029156685
loss_pred:0.018847791478037834, decouple_loss:0.0023186313919723034
The generated pressure mean: 0.4477941393852234
loss_pred:0.017594357952475548, decouple_loss:0.0024712160229682922
Iteration: 7244, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44449132680892944
The generated pressure mean: 0.4442102611064911
loss_pred:0.016779080033302307, decouple_loss:0.002123034792020917
loss_pred:0.01846456341445446, decouple_loss:0.002147315302863717
The generated pressure mean: 0.44504523277282715
loss_pred:0.018699616193771362, decouple_loss:0.0021713445894420147
Iteration: 7245, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44508785009384155
The generated pressure mean: 0.44506871700286865
loss_pred:0.016366243362426758, decouple_loss:0.0023741996847093105
loss_pred:0.01653556153178215, decouple_loss:0.0022178443614393473
The generated pressure mean: 0.44253140687942505
loss_pred:0.021602321416139603, decouple_loss:0.0022482594940811396
Iteration: 7246, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45137596130371094
The generated pressure mean: 0.45312464237213135
loss_pred:0.01900017075240612, decouple_loss:0.002714912174269557
loss_pred:0.017969895154237747, decouple_loss:0.00262449705041945
The generated pressure mean: 0.4569835364818573
loss_pred:0.018150337040424347, decouple_loss:0.0026138974353671074
Iteration: 7247, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4372687339782715
The generated pressure mean: 0.44085177779197693
loss_pred:0.019683530554175377, decouple_loss:0.0026003161910921335
loss_pred:0.019410237669944763, decouple_loss:0.0024326269049197435
The generated pressure mean: 0.4372173845767975
loss_pred:0.017469480633735657, decouple_loss:0.0023450155276805162
Iteration: 7248, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4576479196548462
loss_pred:0.017114127054810524, decouple_loss:0.002361212158575654
The generated pressure mean: 0.45416757464408875
loss_pred:0.0164190586656332, decouple_loss:0.0021518671419471502
The generated pressure mean: 0.4528733491897583
loss_pred:0.01884073205292225, decouple_loss:0.0021030690986663103
Iteration: 7249, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44688594341278076
loss_pred:0.019775209948420525, decouple_loss:0.0023599674459546804
The generated pressure mean: 0.44290661811828613
loss_pred:0.018126050010323524, decouple_loss:0.002345985034480691
The generated pressure mean: 0.4429164230823517
loss_pred:0.01854482665657997, decouple_loss:0.002458282047882676
Iteration: 7250, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45021796226501465
loss_pred:0.016903193667531013, decouple_loss:0.0022989159915596247
The generated pressure mean: 0.4453689157962799
loss_pred:0.019775869324803352, decouple_loss:0.002334108343347907
The generated pressure mean: 0.4527430832386017
loss_pred:0.01800640858709812, decouple_loss:0.0023189724888652563
2023-04-17 15:00:39 testing...
The generated pressure mean: 0.4129120707511902
The generated pressure mean: 0.42090511322021484
loss_pred:0.032108865678310394, decouple_loss:0.0027581797912716866
The generated pressure mean: 0.4241665303707123
loss_pred:0.031029587611556053, decouple_loss:0.00300971488468349
loss_pred:0.030115600675344467, decouple_loss:0.003141340333968401
WV_0_PC_0_EH_1_PS_40, loss: 0.031233172863721848, avg_mse: 0.047733329236507416
current test mse: 0.047733
Iteration: 7251, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4540550410747528
loss_pred:0.016862541437149048, decouple_loss:0.002137278439477086
The generated pressure mean: 0.4471214711666107
loss_pred:0.018558841198682785, decouple_loss:0.002106025815010071
The generated pressure mean: 0.4513868987560272
loss_pred:0.017510920763015747, decouple_loss:0.0020985761657357216
Iteration: 7252, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44360587000846863
loss_pred:0.01861821860074997, decouple_loss:0.002023266861215234
The generated pressure mean: 0.44388824701309204
loss_pred:0.01742471009492874, decouple_loss:0.002073097974061966
The generated pressure mean: 0.4422028660774231
loss_pred:0.01815018802881241, decouple_loss:0.0020423608366400003
Iteration: 7253, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.443886935710907
loss_pred:0.01735592633485794, decouple_loss:0.0023395405150949955
The generated pressure mean: 0.44534459710121155
loss_pred:0.017241714522242546, decouple_loss:0.0024527956265956163
The generated pressure mean: 0.44332170486450195
loss_pred:0.01869386062026024, decouple_loss:0.0024898210540413857
Iteration: 7254, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484206438064575
loss_pred:0.018564023077487946, decouple_loss:0.0024441650602966547
The generated pressure mean: 0.4565373659133911
loss_pred:0.017567772418260574, decouple_loss:0.002586331916972995
The generated pressure mean: 0.45511141419410706
loss_pred:0.01725245825946331, decouple_loss:0.0026327522937208414
Iteration: 7255, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4513234496116638
loss_pred:0.01750240847468376, decouple_loss:0.0023291578982025385
The generated pressure mean: 0.44948670268058777
loss_pred:0.017824837937951088, decouple_loss:0.0022715870290994644
The generated pressure mean: 0.4515743851661682
loss_pred:0.019101999700069427, decouple_loss:0.0023679498117417097
Iteration: 7256, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44143208861351013
loss_pred:0.01723121851682663, decouple_loss:0.0025286402087658644
The generated pressure mean: 0.43814733624458313
The generated pressure mean: 0.44063764810562134loss_pred:0.01804831624031067, decouple_loss:0.002437588293105364
loss_pred:0.017065459862351418, decouple_loss:0.002450749045237899
Iteration: 7257, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463600218296051
loss_pred:0.016472019255161285, decouple_loss:0.0022043283097445965
The generated pressure mean: 0.45028308033943176
loss_pred:0.018031440675258636, decouple_loss:0.0021909037604928017
The generated pressure mean: 0.44975194334983826
loss_pred:0.019252128899097443, decouple_loss:0.0022852630354464054
Iteration: 7258, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472094178199768
loss_pred:0.017882123589515686, decouple_loss:0.0023014468606561422
The generated pressure mean: 0.4501197040081024
loss_pred:0.018718495965003967, decouple_loss:0.002289566909894347
The generated pressure mean: 0.44926917552948
loss_pred:0.01661260612308979, decouple_loss:0.0021794538479298353
Iteration: 7259, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44034579396247864
loss_pred:0.01831030286848545, decouple_loss:0.002039087237790227
The generated pressure mean: 0.4455733895301819
loss_pred:0.016907263547182083, decouple_loss:0.0020003519020974636
The generated pressure mean: 0.44515442848205566
loss_pred:0.017415586858987808, decouple_loss:0.0021184957586228848
Iteration: 7260, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44948816299438477
loss_pred:0.017051393166184425, decouple_loss:0.002209658268839121
The generated pressure mean: 0.4455534815788269
loss_pred:0.017017867416143417, decouple_loss:0.0020824605599045753
The generated pressure mean: 0.447537362575531
loss_pred:0.01768743246793747, decouple_loss:0.002163172233849764
2023-04-17 15:02:32 testing...
The generated pressure mean: 0.41438862681388855
The generated pressure mean: 0.42187124490737915
The generated pressure mean: 0.42545777559280396
loss_pred:0.032414983958005905, decouple_loss:0.0028225372079759836
loss_pred:0.03132065013051033, decouple_loss:0.002998359501361847
loss_pred:0.03065391816198826, decouple_loss:0.0031053905840963125
WV_0_PC_0_EH_1_PS_40, loss: 0.031611956655979156, avg_mse: 0.04830937832593918
current test mse: 0.048309
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 7261, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44499093294143677
loss_pred:0.018401773646473885, decouple_loss:0.002464434364810586
The generated pressure mean: 0.44818028807640076
loss_pred:0.019076401367783546, decouple_loss:0.0024288534186780453
The generated pressure mean: 0.44212645292282104
loss_pred:0.01726382039487362, decouple_loss:0.002487871330231428
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 7262, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476047456264496
loss_pred:0.017493702471256256, decouple_loss:0.00238054059445858
The generated pressure mean: 0.45286455750465393
loss_pred:0.021543581038713455, decouple_loss:0.0024209744296967983
The generated pressure mean: 0.4493103325366974
loss_pred:0.01869960129261017, decouple_loss:0.0024612974375486374
Iteration: 7263, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4612242877483368
loss_pred:0.019141381606459618, decouple_loss:0.0028692460618913174
The generated pressure mean: 0.45579788088798523
loss_pred:0.018015673384070396, decouple_loss:0.002878771396353841
The generated pressure mean: 0.4632948040962219
loss_pred:0.018047936260700226, decouple_loss:0.002750749234110117
Iteration: 7264, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44759902358055115
loss_pred:0.01782345585525036, decouple_loss:0.0021786820143461227
The generated pressure mean: 0.4519243836402893
loss_pred:0.017761779949069023, decouple_loss:0.0021582215558737516
The generated pressure mean: 0.44868266582489014
loss_pred:0.018323298543691635, decouple_loss:0.0021993923000991344
Iteration: 7265, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4357089102268219
loss_pred:0.01874263770878315, decouple_loss:0.002515154192224145
The generated pressure mean: 0.4270001947879791
loss_pred:0.01858740858733654, decouple_loss:0.0025738633703440428
The generated pressure mean: 0.4311022460460663
loss_pred:0.019927680492401123, decouple_loss:0.0025980244390666485
Iteration: 7266, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45028141140937805
loss_pred:0.018090441823005676, decouple_loss:0.0026406587567180395
The generated pressure mean: 0.451790988445282
loss_pred:0.018108263611793518, decouple_loss:0.002665943233296275
The generated pressure mean: 0.4526102840900421
loss_pred:0.01816895417869091, decouple_loss:0.002606144640594721
Iteration: 7267, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4639660120010376
loss_pred:0.016602346673607826, decouple_loss:0.0024304224643856287
The generated pressure mean: 0.46438702940940857
loss_pred:0.01946936920285225, decouple_loss:0.0024040103890001774
The generated pressure mean: 0.4572266638278961
loss_pred:0.017840303480625153, decouple_loss:0.0023736651055514812
Iteration: 7268, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4509545862674713
loss_pred:0.01812818832695484, decouple_loss:0.0022559668868780136
The generated pressure mean: 0.44940128922462463
loss_pred:0.017968125641345978, decouple_loss:0.0022195850033313036
The generated pressure mean: 0.4503662884235382
loss_pred:0.017423342913389206, decouple_loss:0.002220908412709832
Iteration: 7269, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4376944303512573
loss_pred:0.016945868730545044, decouple_loss:0.002292952034622431
The generated pressure mean: 0.44163820147514343
loss_pred:0.019102105870842934, decouple_loss:0.002287468872964382
The generated pressure mean: 0.44002997875213623
loss_pred:0.018404385074973106, decouple_loss:0.0023067037109285593
Iteration: 7270, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4447573721408844
The generated pressure mean: 0.44824162125587463
loss_pred:0.020890267565846443, decouple_loss:0.002370222005993128
loss_pred:0.018926845863461494, decouple_loss:0.0021819008979946375
The generated pressure mean: 0.4488844573497772
loss_pred:0.018676232546567917, decouple_loss:0.0021715695038437843
2023-04-17 15:05:03 testing...
The generated pressure mean: 0.4136057198047638
The generated pressure mean: 0.42040809988975525
loss_pred:0.031314875930547714, decouple_loss:0.002678281394764781
The generated pressure mean: 0.4234985411167145
loss_pred:0.030429527163505554, decouple_loss:0.002943420549854636
loss_pred:0.029690414667129517, decouple_loss:0.0028987335972487926
WV_0_PC_0_EH_1_PS_40, loss: 0.030620280653238297, avg_mse: 0.045767415314912796
current test mse: 0.045767
Iteration: 7271, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502068758010864
loss_pred:0.01857508346438408, decouple_loss:0.0021092987153679132
The generated pressure mean: 0.4495925009250641
loss_pred:0.01861150749027729, decouple_loss:0.002044951543211937
The generated pressure mean: 0.44946542382240295
loss_pred:0.017206257209181786, decouple_loss:0.002035709796473384
Iteration: 7272, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45703837275505066
loss_pred:0.01843256875872612, decouple_loss:0.002409696113318205
The generated pressure mean: 0.45798295736312866
loss_pred:0.017697734758257866, decouple_loss:0.0023268074728548527
The generated pressure mean: 0.45893803238868713
loss_pred:0.019830580800771713, decouple_loss:0.0023948554880917072
Iteration: 7273, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447680801153183
loss_pred:0.018004927784204483, decouple_loss:0.0022936274763196707
The generated pressure mean: 0.4522572159767151
loss_pred:0.01880001462996006, decouple_loss:0.002351915929466486
The generated pressure mean: 0.4479082524776459
loss_pred:0.018914632499217987, decouple_loss:0.002337029669433832
Iteration: 7274, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44103100895881653
loss_pred:0.01967480033636093, decouple_loss:0.0023241981398314238
The generated pressure mean: 0.43866679072380066
loss_pred:0.0181684922426939, decouple_loss:0.0023606729228049517
The generated pressure mean: 0.43830323219299316
loss_pred:0.019355449825525284, decouple_loss:0.002281143795698881
Iteration: 7275, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45190563797950745
loss_pred:0.01856224425137043, decouple_loss:0.0026632908266037703
The generated pressure mean: 0.4513171315193176
loss_pred:0.017536068335175514, decouple_loss:0.0026082962285727262
The generated pressure mean: 0.4479190707206726
loss_pred:0.018297167494893074, decouple_loss:0.002639083657413721
Iteration: 7276, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45243558287620544
loss_pred:0.018911128863692284, decouple_loss:0.00247189705260098
The generated pressure mean: 0.452262282371521
loss_pred:0.018017012625932693, decouple_loss:0.0023885159753262997
The generated pressure mean: 0.45061254501342773
loss_pred:0.017466284334659576, decouple_loss:0.0023287131916731596
Iteration: 7277, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494588375091553
loss_pred:0.0175879318267107, decouple_loss:0.002661654492840171
The generated pressure mean: 0.4489409029483795
The generated pressure mean: 0.44995248317718506
loss_pred:0.0191399734467268, decouple_loss:0.002693283138796687
loss_pred:0.018080731853842735, decouple_loss:0.0025856872089207172
Iteration: 7278, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.442495733499527
The generated pressure mean: 0.4443565309047699
loss_pred:0.017749231308698654, decouple_loss:0.002547545824199915
loss_pred:0.01850694604218006, decouple_loss:0.002465918194502592
The generated pressure mean: 0.4478404223918915
loss_pred:0.018410393968224525, decouple_loss:0.002511352766305208
Iteration: 7279, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4522300362586975
loss_pred:0.017972396686673164, decouple_loss:0.002375540789216757
The generated pressure mean: 0.4488857090473175
loss_pred:0.018386919051408768, decouple_loss:0.0023681565653532743
The generated pressure mean: 0.45224758982658386
loss_pred:0.01796494983136654, decouple_loss:0.0023384434171020985
Iteration: 7280, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44796469807624817
loss_pred:0.017483068630099297, decouple_loss:0.002420861041173339
The generated pressure mean: 0.44986432790756226
loss_pred:0.01858469657599926, decouple_loss:0.0024993070401251316
The generated pressure mean: 0.4456811249256134
loss_pred:0.017743103206157684, decouple_loss:0.002532681915909052
2023-04-17 15:06:55 testing...
The generated pressure mean: 0.4206130802631378
The generated pressure mean: 0.4132440984249115
loss_pred:0.03138423711061478, decouple_loss:0.003121286164969206
The generated pressure mean: 0.4238830506801605
loss_pred:0.03246685117483139, decouple_loss:0.002993230940774083
loss_pred:0.030841469764709473, decouple_loss:0.003234309609979391
WV_0_PC_0_EH_1_PS_40, loss: 0.03171999752521515, avg_mse: 0.04853371903300285
current test mse: 0.048534
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 7281, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44609954953193665
loss_pred:0.020173337310552597, decouple_loss:0.002778072841465473
The generated pressure mean: 0.44431132078170776
The generated pressure mean: 0.44693106412887573
loss_pred:0.018383042886853218, decouple_loss:0.002693816553801298
loss_pred:0.01779947616159916, decouple_loss:0.0027096548583358526
Iteration: 7282, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.439272403717041
loss_pred:0.017991939559578896, decouple_loss:0.0023191538639366627
The generated pressure mean: 0.43744394183158875
loss_pred:0.017829636111855507, decouple_loss:0.00220389268361032
The generated pressure mean: 0.43836602568626404
loss_pred:0.017963869497179985, decouple_loss:0.0021377638913691044
Iteration: 7283, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463079571723938
The generated pressure mean: 0.44858047366142273
loss_pred:0.017755970358848572, decouple_loss:0.0023152423091232777
loss_pred:0.01905936561524868, decouple_loss:0.002167804865166545
The generated pressure mean: 0.4533783793449402
loss_pred:0.01882220432162285, decouple_loss:0.0021274262107908726
Iteration: 7284, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45468899607658386
The generated pressure mean: 0.4503322243690491
loss_pred:0.017768578603863716, decouple_loss:0.002891828306019306
loss_pred:0.020302411168813705, decouple_loss:0.00288331788033247
The generated pressure mean: 0.4521288573741913
loss_pred:0.01904217153787613, decouple_loss:0.0028519337065517902
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 7285, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4385647773742676
loss_pred:0.016580497846007347, decouple_loss:0.002375278389081359
The generated pressure mean: 0.4405793845653534
loss_pred:0.01859041303396225, decouple_loss:0.002367887645959854
The generated pressure mean: 0.4395427107810974
loss_pred:0.018325572833418846, decouple_loss:0.002423580503091216
Iteration: 7286, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448650985956192
The generated pressure mean: 0.45005083084106445
loss_pred:0.01773282326757908, decouple_loss:0.00216118898242712
loss_pred:0.01745382882654667, decouple_loss:0.0022917285095900297
The generated pressure mean: 0.44609585404396057
loss_pred:0.01805521361529827, decouple_loss:0.0022945653181523085
Iteration: 7287, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44829845428466797
loss_pred:0.01772034540772438, decouple_loss:0.0020696227438747883
The generated pressure mean: 0.4481739401817322
loss_pred:0.01873909682035446, decouple_loss:0.002159747527912259
The generated pressure mean: 0.44752126932144165
loss_pred:0.020520109683275223, decouple_loss:0.0020403137896209955
Iteration: 7288, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4310712218284607
loss_pred:0.019098777323961258, decouple_loss:0.0020276333671063185
The generated pressure mean: 0.42883825302124023
loss_pred:0.01716146059334278, decouple_loss:0.002167018363252282
The generated pressure mean: 0.43364593386650085
loss_pred:0.01840249076485634, decouple_loss:0.0021363222040235996
Iteration: 7289, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4445890784263611
loss_pred:0.022720186039805412, decouple_loss:0.002407512627542019
The generated pressure mean: 0.4475058317184448
loss_pred:0.01818913407623768, decouple_loss:0.0024040949065238237
The generated pressure mean: 0.4447665512561798
loss_pred:0.019128669053316116, decouple_loss:0.0023418075870722532
Iteration: 7290, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44923168420791626
loss_pred:0.01731882058084011, decouple_loss:0.00220477138645947
The generated pressure mean: 0.45725834369659424
loss_pred:0.01862642727792263, decouple_loss:0.0021371974144130945
The generated pressure mean: 0.4554049074649811
loss_pred:0.018227562308311462, decouple_loss:0.0021443755831569433
2023-04-17 15:09:31 testing...
The generated pressure mean: 0.41275912523269653
The generated pressure mean: 0.41974201798439026
The generated pressure mean: 0.42192190885543823
loss_pred:0.03570684790611267, decouple_loss:0.002566549926996231
loss_pred:0.03436463698744774, decouple_loss:0.0028551334980875254
loss_pred:0.03436144068837166, decouple_loss:0.0027719582431018353
WV_0_PC_0_EH_1_PS_40, loss: 0.03494753688573837, avg_mse: 0.054300688207149506
current test mse: 0.054301
Iteration: 7291, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.445529043674469
loss_pred:0.01793503761291504, decouple_loss:0.0022010719403624535
The generated pressure mean: 0.4456090033054352
loss_pred:0.017666686326265335, decouple_loss:0.0021492273081094027
The generated pressure mean: 0.4472554922103882
loss_pred:0.01882292330265045, decouple_loss:0.0021080265287309885
Iteration: 7292, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44569921493530273
loss_pred:0.018855692818760872, decouple_loss:0.002245675539597869
The generated pressure mean: 0.4438939094543457
loss_pred:0.01750916615128517, decouple_loss:0.002342485822737217
The generated pressure mean: 0.4447513222694397
loss_pred:0.017865750938653946, decouple_loss:0.002319070277735591
Iteration: 7293, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4415561556816101
loss_pred:0.01958688162267208, decouple_loss:0.0024854959920048714
The generated pressure mean: 0.4426417052745819
loss_pred:0.017793497070670128, decouple_loss:0.002525601303204894
The generated pressure mean: 0.44150620698928833
loss_pred:0.017908653244376183, decouple_loss:0.002676366362720728
Iteration: 7294, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472252428531647
loss_pred:0.01716557703912258, decouple_loss:0.0023161505814641714
The generated pressure mean: 0.4455128014087677
loss_pred:0.01870218850672245, decouple_loss:0.0024142395704984665
The generated pressure mean: 0.44629597663879395
loss_pred:0.01950017921626568, decouple_loss:0.0024831390473991632
Iteration: 7295, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45021170377731323
loss_pred:0.018182285130023956, decouple_loss:0.0020730881951749325
The generated pressure mean: 0.44877487421035767
loss_pred:0.019386572763323784, decouple_loss:0.0020983456633985043
The generated pressure mean: 0.4453895092010498
loss_pred:0.017341086640954018, decouple_loss:0.0021808603778481483
Iteration: 7296, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43758702278137207
loss_pred:0.018148798495531082, decouple_loss:0.002290405798703432
The generated pressure mean: 0.444103479385376
loss_pred:0.017999082803726196, decouple_loss:0.0022585808765143156
The generated pressure mean: 0.44193345308303833
loss_pred:0.019902445375919342, decouple_loss:0.002282178495079279
Iteration: 7297, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492145776748657
loss_pred:0.01926032081246376, decouple_loss:0.0025467921514064074
The generated pressure mean: 0.44810473918914795
loss_pred:0.018822047859430313, decouple_loss:0.0025814706459641457
The generated pressure mean: 0.4489870071411133
loss_pred:0.018295051530003548, decouple_loss:0.0025076684542000294
Iteration: 7298, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502091407775879
loss_pred:0.021018074825406075, decouple_loss:0.0020129287149757147
The generated pressure mean: 0.4548119902610779
loss_pred:0.019796060398221016, decouple_loss:0.0019925415981560946
The generated pressure mean: 0.44453439116477966
loss_pred:0.01795033924281597, decouple_loss:0.0019998520147055387
Iteration: 7299, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43398749828338623
loss_pred:0.01871061697602272, decouple_loss:0.0023090927861630917
The generated pressure mean: 0.43100616335868835
The generated pressure mean: 0.42836207151412964
loss_pred:0.017869053408503532, decouple_loss:0.002177796559408307
loss_pred:0.01833445392549038, decouple_loss:0.002256999956443906
Iteration: 7300, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501054883003235
loss_pred:0.01902802102267742, decouple_loss:0.0022876744624227285
The generated pressure mean: 0.45159223675727844
loss_pred:0.01822522096335888, decouple_loss:0.002183712087571621
The generated pressure mean: 0.4516856372356415
loss_pred:0.01874440535902977, decouple_loss:0.0021826247684657574
2023-04-17 15:11:24 testing...
The generated pressure mean: 0.4100036323070526
The generated pressure mean: 0.4166157841682434
The generated pressure mean: 0.41919639706611633
loss_pred:0.03406607732176781, decouple_loss:0.002876247512176633
loss_pred:0.03300568833947182, decouple_loss:0.0030380841344594955
loss_pred:0.032139409333467484, decouple_loss:0.003112014615908265
WV_0_PC_0_EH_1_PS_40, loss: 0.03322082757949829, avg_mse: 0.051065780222415924
current test mse: 0.051066
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 7301, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4555981755256653
loss_pred:0.017461109906435013, decouple_loss:0.0025860846508294344
The generated pressure mean: 0.46354714035987854
loss_pred:0.01857105642557144, decouple_loss:0.002482468029484153
The generated pressure mean: 0.4574750065803528
loss_pred:0.01806015707552433, decouple_loss:0.0026737109292298555
Iteration: 7302, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470877945423126
loss_pred:0.017530500888824463, decouple_loss:0.0024305337574332952
The generated pressure mean: 0.4443851411342621
loss_pred:0.016761401668190956, decouple_loss:0.002295422600582242
The generated pressure mean: 0.4426708221435547
loss_pred:0.01939716376364231, decouple_loss:0.002359862672165036
Iteration: 7303, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44284912943840027
loss_pred:0.016456395387649536, decouple_loss:0.0021506869234144688
The generated pressure mean: 0.4454523026943207
loss_pred:0.019677558913826942, decouple_loss:0.002285637892782688
The generated pressure mean: 0.4386877417564392
loss_pred:0.01643562689423561, decouple_loss:0.002122937235981226
Iteration: 7304, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499036371707916
loss_pred:0.019007444381713867, decouple_loss:0.0028798531275242567
The generated pressure mean: 0.45147836208343506
loss_pred:0.015855329111218452, decouple_loss:0.00290290592238307
The generated pressure mean: 0.4466588795185089
loss_pred:0.0186830535531044, decouple_loss:0.003003892954438925
Iteration: 7305, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43815022706985474
loss_pred:0.01841435208916664, decouple_loss:0.0023223243188112974
The generated pressure mean: 0.44736751914024353
loss_pred:0.016458317637443542, decouple_loss:0.002285067457705736
The generated pressure mean: 0.44017329812049866
loss_pred:0.018405193462967873, decouple_loss:0.0023602559231221676
Iteration: 7306, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4523960053920746
loss_pred:0.01893886923789978, decouple_loss:0.0024125641211867332
The generated pressure mean: 0.44779783487319946
loss_pred:0.019884968176484108, decouple_loss:0.0023827373515814543
The generated pressure mean: 0.4478982985019684
loss_pred:0.016387760639190674, decouple_loss:0.0024405736476182938
Iteration: 7307, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484533667564392
loss_pred:0.019014688208699226, decouple_loss:0.0024746223352849483
The generated pressure mean: 0.44657260179519653
loss_pred:0.01871315762400627, decouple_loss:0.0025577431079000235
The generated pressure mean: 0.4500930905342102
loss_pred:0.018688015639781952, decouple_loss:0.0025405786000192165
Iteration: 7308, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44555336236953735
loss_pred:0.017464211210608482, decouple_loss:0.002337471581995487
The generated pressure mean: 0.44638922810554504
loss_pred:0.01751748099923134, decouple_loss:0.002273735823109746
The generated pressure mean: 0.44485965371131897
loss_pred:0.01901697739958763, decouple_loss:0.0023026387207210064
Iteration: 7309, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45769914984703064
loss_pred:0.015707632526755333, decouple_loss:0.002267397940158844
The generated pressure mean: 0.4504880905151367
loss_pred:0.017176827415823936, decouple_loss:0.002250125864520669
The generated pressure mean: 0.44730818271636963
loss_pred:0.018961556255817413, decouple_loss:0.002255544997751713
Iteration: 7310, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4432089924812317
loss_pred:0.01594790816307068, decouple_loss:0.0025962362997233868
The generated pressure mean: 0.44813328981399536
loss_pred:0.016217432916164398, decouple_loss:0.00247027981095016
The generated pressure mean: 0.44609707593917847
loss_pred:0.016940215602517128, decouple_loss:0.002462615491822362
2023-04-17 15:13:54 testing...
The generated pressure mean: 0.42126113176345825
The generated pressure mean: 0.4132455289363861
loss_pred:0.03161068260669708, decouple_loss:0.0028107587713748217
The generated pressure mean: 0.4240175485610962
loss_pred:0.032786592841148376, decouple_loss:0.0025918835308402777
loss_pred:0.03130978345870972, decouple_loss:0.002963526640087366
WV_0_PC_0_EH_1_PS_40, loss: 0.03204178810119629, avg_mse: 0.04957910254597664
current test mse: 0.049579
Iteration: 7311, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44815391302108765
loss_pred:0.016820324584841728, decouple_loss:0.0021787171717733145
The generated pressure mean: 0.4473665952682495
loss_pred:0.01710616610944271, decouple_loss:0.0021137665025889874
The generated pressure mean: 0.45259806513786316
loss_pred:0.018177445977926254, decouple_loss:0.0020802742801606655
Iteration: 7312, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44449347257614136
loss_pred:0.018868474289774895, decouple_loss:0.0023276114370673895
The generated pressure mean: 0.4444648027420044
loss_pred:0.016142701730132103, decouple_loss:0.0023266884963959455
The generated pressure mean: 0.44679513573646545
loss_pred:0.016175121068954468, decouple_loss:0.0023751631379127502
Iteration: 7313, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481651484966278
loss_pred:0.017926093190908432, decouple_loss:0.002640312071889639
The generated pressure mean: 0.4432751536369324
loss_pred:0.016156334429979324, decouple_loss:0.0025597745552659035
The generated pressure mean: 0.44919565320014954
loss_pred:0.01705922745168209, decouple_loss:0.002623574575409293
Iteration: 7314, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473891258239746
loss_pred:0.01709703542292118, decouple_loss:0.0022653546184301376
The generated pressure mean: 0.45404571294784546
loss_pred:0.016530266031622887, decouple_loss:0.0020549686159938574
The generated pressure mean: 0.45288559794425964
loss_pred:0.016807440668344498, decouple_loss:0.0020208300556987524
Iteration: 7315, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45335838198661804
loss_pred:0.017902398481965065, decouple_loss:0.0021685317624360323
The generated pressure mean: 0.45606014132499695
loss_pred:0.016917647793889046, decouple_loss:0.002036128891631961
The generated pressure mean: 0.45834827423095703
loss_pred:0.01637597195804119, decouple_loss:0.0021418652031570673
Iteration: 7316, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44065526127815247
loss_pred:0.016811810433864594, decouple_loss:0.0019805142655968666
The generated pressure mean: 0.4356676936149597
loss_pred:0.016235560178756714, decouple_loss:0.002137555507943034
The generated pressure mean: 0.4379221796989441
loss_pred:0.01797078177332878, decouple_loss:0.0020621183793991804
Iteration: 7317, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476722180843353
loss_pred:0.016694141551852226, decouple_loss:0.002071091905236244
The generated pressure mean: 0.4460195302963257
loss_pred:0.018170444294810295, decouple_loss:0.0019950056448578835
The generated pressure mean: 0.45116785168647766
loss_pred:0.01717456243932247, decouple_loss:0.002107755746692419
Iteration: 7318, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45693084597587585
loss_pred:0.018402207642793655, decouple_loss:0.0019373601535335183
The generated pressure mean: 0.4544196128845215
loss_pred:0.01776418834924698, decouple_loss:0.0018660458736121655
The generated pressure mean: 0.45435744524002075
loss_pred:0.01899952068924904, decouple_loss:0.002039938233792782
Iteration: 7319, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44176262617111206
loss_pred:0.017888473346829414, decouple_loss:0.0025039627216756344
The generated pressure mean: 0.4437004625797272
loss_pred:0.01697702892124653, decouple_loss:0.002490998711436987
The generated pressure mean: 0.4416489899158478
loss_pred:0.0187152698636055, decouple_loss:0.0024826303124427795
Iteration: 7320, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4447275400161743
loss_pred:0.017824331298470497, decouple_loss:0.0026409190613776445
The generated pressure mean: 0.4428994357585907
loss_pred:0.01670190319418907, decouple_loss:0.0026063015684485435
The generated pressure mean: 0.44463521242141724
loss_pred:0.016858933493494987, decouple_loss:0.0026786092203110456
2023-04-17 15:15:47 testing...
The generated pressure mean: 0.42045292258262634
The generated pressure mean: 0.41304653882980347
The generated pressure mean: 0.4228282570838928
loss_pred:0.03114018402993679, decouple_loss:0.002728664316236973
loss_pred:0.032400891184806824, decouple_loss:0.002512536244466901
loss_pred:0.030529208481311798, decouple_loss:0.002778292866423726
WV_0_PC_0_EH_1_PS_40, loss: 0.031490422785282135, avg_mse: 0.048009566962718964
current test mse: 0.04801
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 7321, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4534297287464142
loss_pred:0.017781319096684456, decouple_loss:0.0021046013571321964
The generated pressure mean: 0.4486082196235657
loss_pred:0.017661182209849358, decouple_loss:0.002148739993572235
The generated pressure mean: 0.44656112790107727
loss_pred:0.017747923731803894, decouple_loss:0.002243549795821309
Iteration: 7322, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495348036289215
The generated pressure mean: 0.45347848534584045
loss_pred:0.01765531301498413, decouple_loss:0.0022728333715349436
loss_pred:0.01719523034989834, decouple_loss:0.0021111874375492334
The generated pressure mean: 0.4514133632183075
loss_pred:0.017102671787142754, decouple_loss:0.0022261440753936768
Iteration: 7323, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45275813341140747
The generated pressure mean: 0.4497566223144531
loss_pred:0.017210163176059723, decouple_loss:0.0027402702253311872
loss_pred:0.017539069056510925, decouple_loss:0.002602098975330591
The generated pressure mean: 0.4502447545528412
loss_pred:0.0169881209731102, decouple_loss:0.002842498244717717
Iteration: 7324, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4539712369441986
loss_pred:0.01701953262090683, decouple_loss:0.0025700286496430635
The generated pressure mean: 0.45367711782455444
loss_pred:0.018259510397911072, decouple_loss:0.002714450005441904
The generated pressure mean: 0.44848963618278503
loss_pred:0.017146475613117218, decouple_loss:0.0026505431160330772
Iteration: 7325, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44366753101348877
loss_pred:0.01782873459160328, decouple_loss:0.002551622223109007
The generated pressure mean: 0.4418887197971344
loss_pred:0.018092572689056396, decouple_loss:0.002378864213824272
The generated pressure mean: 0.4353606104850769
loss_pred:0.018164534121751785, decouple_loss:0.002462916076183319
Iteration: 7326, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464219808578491
loss_pred:0.019965481013059616, decouple_loss:0.002308986149728298
The generated pressure mean: 0.43992432951927185
loss_pred:0.016894791275262833, decouple_loss:0.002269369550049305
The generated pressure mean: 0.4391203820705414
loss_pred:0.01861831173300743, decouple_loss:0.0022168566938489676
Iteration: 7327, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44162872433662415
loss_pred:0.01801622472703457, decouple_loss:0.002116249641403556
The generated pressure mean: 0.44108846783638
loss_pred:0.015995807945728302, decouple_loss:0.002080329228192568
The generated pressure mean: 0.444652795791626
loss_pred:0.017237408086657524, decouple_loss:0.002042807638645172
Iteration: 7328, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45524081587791443
loss_pred:0.018426228314638138, decouple_loss:0.0021617512684315443
The generated pressure mean: 0.4558694660663605
loss_pred:0.017197128385305405, decouple_loss:0.0021232939325273037
The generated pressure mean: 0.45982635021209717
loss_pred:0.018215028569102287, decouple_loss:0.002130089793354273
Iteration: 7329, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45534059405326843
loss_pred:0.01714097335934639, decouple_loss:0.002245641080662608
The generated pressure mean: 0.453215628862381
loss_pred:0.01782059110701084, decouple_loss:0.0022965457756072283
The generated pressure mean: 0.44940030574798584
loss_pred:0.017762145027518272, decouple_loss:0.002257531974464655
Iteration: 7330, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44483813643455505
The generated pressure mean: 0.44535109400749207loss_pred:0.017783282324671745, decouple_loss:0.002667004009708762
loss_pred:0.01703796535730362, decouple_loss:0.002672202419489622
The generated pressure mean: 0.4499281942844391
loss_pred:0.01816376857459545, decouple_loss:0.0027849674224853516
2023-04-17 15:18:19 testing...
The generated pressure mean: 0.42340022325515747
The generated pressure mean: 0.41587406396865845
The generated pressure mean: 0.42579543590545654
loss_pred:0.030750911682844162, decouple_loss:0.0031946864910423756
loss_pred:0.0319879986345768, decouple_loss:0.0029074193444103003
loss_pred:0.030444571748375893, decouple_loss:0.003243166720494628
WV_0_PC_0_EH_1_PS_40, loss: 0.03121691755950451, avg_mse: 0.047342076897621155
current test mse: 0.047342
Iteration: 7331, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4399564564228058
loss_pred:0.017249492928385735, decouple_loss:0.00236524292267859
The generated pressure mean: 0.43726423382759094
loss_pred:0.01737566478550434, decouple_loss:0.0025604679249227047
The generated pressure mean: 0.4357929229736328
loss_pred:0.018026987090706825, decouple_loss:0.0024779816158115864
Iteration: 7332, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472030699253082
loss_pred:0.019686594605445862, decouple_loss:0.0021464198362082243
The generated pressure mean: 0.45911094546318054
loss_pred:0.01918526366353035, decouple_loss:0.0023501242976635695
The generated pressure mean: 0.45439454913139343
loss_pred:0.016742881387472153, decouple_loss:0.0022515133023262024
Iteration: 7333, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44717398285865784
loss_pred:0.017409613355994225, decouple_loss:0.0025415122509002686
The generated pressure mean: 0.4498240351676941
loss_pred:0.017406782135367393, decouple_loss:0.0022892113775014877
The generated pressure mean: 0.44580352306365967
loss_pred:0.0183841772377491, decouple_loss:0.0025163039099425077
Iteration: 7334, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4573066234588623
loss_pred:0.018678858876228333, decouple_loss:0.0028737178072333336
The generated pressure mean: 0.4454624354839325
loss_pred:0.018190091475844383, decouple_loss:0.0027552449610084295
The generated pressure mean: 0.444390207529068
loss_pred:0.017555922269821167, decouple_loss:0.0027158334851264954
Iteration: 7335, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4528149664402008
loss_pred:0.017974592745304108, decouple_loss:0.0021755367051810026
The generated pressure mean: 0.44713646173477173
loss_pred:0.0189755167812109, decouple_loss:0.0021999808959662914
The generated pressure mean: 0.44654834270477295
loss_pred:0.01768552139401436, decouple_loss:0.002289827447384596
Iteration: 7336, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44369083642959595
loss_pred:0.017264531925320625, decouple_loss:0.003118551103398204
The generated pressure mean: 0.44298285245895386
loss_pred:0.016375146806240082, decouple_loss:0.003141536843031645
The generated pressure mean: 0.446759432554245
loss_pred:0.018561387434601784, decouple_loss:0.003039703704416752
Iteration: 7337, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44988152384757996
loss_pred:0.01773693971335888, decouple_loss:0.002841474022716284
The generated pressure mean: 0.44533488154411316
loss_pred:0.015821941196918488, decouple_loss:0.0028524145018309355
The generated pressure mean: 0.45197227597236633
loss_pred:0.017645545303821564, decouple_loss:0.002817932516336441
Iteration: 7338, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4517488479614258
The generated pressure mean: 0.448991596698761
loss_pred:0.01784692518413067, decouple_loss:0.0026438222266733646
loss_pred:0.017703019082546234, decouple_loss:0.002698741853237152
The generated pressure mean: 0.45449119806289673
loss_pred:0.018527504056692123, decouple_loss:0.0028723394498229027
Iteration: 7339, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4431300163269043
loss_pred:0.017247186973690987, decouple_loss:0.0030369777232408524
The generated pressure mean: 0.44071826338768005
loss_pred:0.017968986183404922, decouple_loss:0.002988265361636877
The generated pressure mean: 0.435707688331604
loss_pred:0.01670435070991516, decouple_loss:0.0032445210963487625
Iteration: 7340, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4409250319004059
loss_pred:0.01715441606938839, decouple_loss:0.002512226114049554
The generated pressure mean: 0.44178450107574463
loss_pred:0.018751539289951324, decouple_loss:0.002504397416487336
The generated pressure mean: 0.4474014341831207
loss_pred:0.016865544021129608, decouple_loss:0.0024695820175111294
2023-04-17 15:20:12 testing...
The generated pressure mean: 0.41683244705200195
The generated pressure mean: 0.4109622836112976
The generated pressure mean: 0.41917502880096436
loss_pred:0.031821057200431824, decouple_loss:0.003485723864287138
loss_pred:0.032788749784231186, decouple_loss:0.003285379381850362
loss_pred:0.031424619257450104, decouple_loss:0.0035381722263991833
WV_0_PC_0_EH_1_PS_40, loss: 0.03218330070376396, avg_mse: 0.0490248017013073
current test mse: 0.049025
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 7341, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45650210976600647
loss_pred:0.01716684363782406, decouple_loss:0.002955509815365076
The generated pressure mean: 0.4543611705303192
loss_pred:0.01693901978433132, decouple_loss:0.0029470513109117746
The generated pressure mean: 0.45378342270851135
loss_pred:0.019046854227781296, decouple_loss:0.003143847454339266
Iteration: 7342, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449000746011734
The generated pressure mean: 0.45031607151031494
loss_pred:0.017232952639460564, decouple_loss:0.0024256384931504726
loss_pred:0.01655331626534462, decouple_loss:0.0026169056072831154
The generated pressure mean: 0.4442761540412903
loss_pred:0.01786556839942932, decouple_loss:0.0025733746588230133
Iteration: 7343, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4496081471443176
The generated pressure mean: 0.4524185359477997
loss_pred:0.017890412360429764, decouple_loss:0.002065350767225027
loss_pred:0.01627063751220703, decouple_loss:0.0019862810149788857
The generated pressure mean: 0.45101451873779297
loss_pred:0.017559772357344627, decouple_loss:0.0022374074906110764
Iteration: 7344, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471956789493561
loss_pred:0.017927024513483047, decouple_loss:0.0025563756935298443
The generated pressure mean: 0.4473814070224762
loss_pred:0.019213862717151642, decouple_loss:0.002512354636564851
The generated pressure mean: 0.44996413588523865
loss_pred:0.017793767154216766, decouple_loss:0.0025463271886110306
Iteration: 7345, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4320387840270996
loss_pred:0.017618149518966675, decouple_loss:0.0025203421246260405
The generated pressure mean: 0.4284740388393402
loss_pred:0.01800766959786415, decouple_loss:0.0026206367183476686
The generated pressure mean: 0.4280085265636444
loss_pred:0.020411042496562004, decouple_loss:0.0026010836008936167
Iteration: 7346, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500730633735657
The generated pressure mean: 0.4497887194156647
loss_pred:0.017081424593925476, decouple_loss:0.0024296476040035486
loss_pred:0.015868937596678734, decouple_loss:0.0025355119723826647
The generated pressure mean: 0.4499927759170532
loss_pred:0.01940254122018814, decouple_loss:0.0024883251171559095
Iteration: 7347, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45176559686660767
loss_pred:0.018263882026076317, decouple_loss:0.0032109522726386786
The generated pressure mean: 0.4485913813114166
loss_pred:0.017351148650050163, decouple_loss:0.0029553950298577547
The generated pressure mean: 0.4568514823913574
loss_pred:0.016574932262301445, decouple_loss:0.0031989228446036577
Iteration: 7348, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44388458132743835
loss_pred:0.018467489629983902, decouple_loss:0.0024208149407058954
The generated pressure mean: 0.4453805983066559
loss_pred:0.016848884522914886, decouple_loss:0.0024609901010990143
The generated pressure mean: 0.44342076778411865
loss_pred:0.01847722940146923, decouple_loss:0.00242035579867661
Iteration: 7349, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45171934366226196The generated pressure mean: 0.44980400800704956
loss_pred:0.018128739669919014, decouple_loss:0.003461956512182951
loss_pred:0.019323961809277534, decouple_loss:0.0033156173303723335
The generated pressure mean: 0.4518985450267792
loss_pred:0.018221046775579453, decouple_loss:0.003517514793202281
Iteration: 7350, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44239214062690735
The generated pressure mean: 0.4443669617176056
loss_pred:0.018522216007113457, decouple_loss:0.002866764785721898
loss_pred:0.01802276261150837, decouple_loss:0.0027534824330359697
The generated pressure mean: 0.44273805618286133
loss_pred:0.016130870208144188, decouple_loss:0.0029428903944790363
2023-04-17 15:22:42 testing...
The generated pressure mean: 0.4148612916469574
The generated pressure mean: 0.42151811718940735
loss_pred:0.03312881290912628, decouple_loss:0.002858048304915428
The generated pressure mean: 0.42446765303611755
loss_pred:0.031682129949331284, decouple_loss:0.002976363757625222
loss_pred:0.031185535714030266, decouple_loss:0.0031131552532315254
WV_0_PC_0_EH_1_PS_40, loss: 0.032147955149412155, avg_mse: 0.04906583949923515
current test mse: 0.049066
Iteration: 7351, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4440295696258545
loss_pred:0.01701558195054531, decouple_loss:0.002391794230788946
The generated pressure mean: 0.4398340880870819
loss_pred:0.018050579354166985, decouple_loss:0.0027363020926713943
The generated pressure mean: 0.4389640986919403
loss_pred:0.017318351194262505, decouple_loss:0.002547028474509716
Iteration: 7352, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4511677920818329
loss_pred:0.01723211072385311, decouple_loss:0.003728860057890415
The generated pressure mean: 0.4521523714065552
loss_pred:0.01901545189321041, decouple_loss:0.003713025478646159
The generated pressure mean: 0.45092639327049255
loss_pred:0.01686881110072136, decouple_loss:0.0036866790615022182
Iteration: 7353, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478391408920288
loss_pred:0.01841140352189541, decouple_loss:0.0023167594335973263
The generated pressure mean: 0.4457191526889801
loss_pred:0.017452422529459, decouple_loss:0.0023141116835176945
The generated pressure mean: 0.44410237669944763
loss_pred:0.017326315864920616, decouple_loss:0.0022627422586083412
Iteration: 7354, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472375512123108
loss_pred:0.01628069393336773, decouple_loss:0.0033941268920898438
The generated pressure mean: 0.44848036766052246
loss_pred:0.019165901467204094, decouple_loss:0.0032967946026474237
The generated pressure mean: 0.4473941922187805
loss_pred:0.02048829011619091, decouple_loss:0.0032783178612589836
Iteration: 7355, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4433249831199646
loss_pred:0.016980621963739395, decouple_loss:0.002599995117634535
The generated pressure mean: 0.44010236859321594
loss_pred:0.020179547369480133, decouple_loss:0.002822440816089511
The generated pressure mean: 0.44573161005973816
loss_pred:0.015942176803946495, decouple_loss:0.00261215353384614
Iteration: 7356, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44978705048561096
loss_pred:0.01909598894417286, decouple_loss:0.0024932066444307566
The generated pressure mean: 0.4458458125591278
loss_pred:0.016534868627786636, decouple_loss:0.002455947222188115
The generated pressure mean: 0.4456931948661804
loss_pred:0.018499797210097313, decouple_loss:0.00251242658123374
Iteration: 7357, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44865840673446655
loss_pred:0.017162097617983818, decouple_loss:0.0030953807290643454
The generated pressure mean: 0.4468149244785309
loss_pred:0.017624903470277786, decouple_loss:0.002996755065396428
The generated pressure mean: 0.448438823223114
loss_pred:0.018118053674697876, decouple_loss:0.0030319455545395613
Iteration: 7358, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44069692492485046
The generated pressure mean: 0.43538811802864075
loss_pred:0.017901776358485222, decouple_loss:0.002882451983168721
loss_pred:0.016343040391802788, decouple_loss:0.002891004318371415
The generated pressure mean: 0.4409159719944
loss_pred:0.0185855720192194, decouple_loss:0.002801058115437627
Iteration: 7359, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44247445464134216
loss_pred:0.01844038814306259, decouple_loss:0.0026961551047861576
The generated pressure mean: 0.44728371500968933
loss_pred:0.017008831724524498, decouple_loss:0.0026136564556509256
The generated pressure mean: 0.4475969970226288
loss_pred:0.017385970801115036, decouple_loss:0.0025742549914866686
Iteration: 7360, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4520909786224365
The generated pressure mean: 0.4521099328994751
loss_pred:0.016951076686382294, decouple_loss:0.0030794411431998014
loss_pred:0.017769858241081238, decouple_loss:0.0031233003828674555
The generated pressure mean: 0.4484744966030121
loss_pred:0.015964193269610405, decouple_loss:0.0031674408819526434
2023-04-17 15:24:35 testing...
The generated pressure mean: 0.411579966545105
The generated pressure mean: 0.4184039831161499
The generated pressure mean: 0.4214489758014679
loss_pred:0.033282697200775146, decouple_loss:0.0028765827883034945
loss_pred:0.0320078581571579, decouple_loss:0.0031368709169328213
loss_pred:0.03130834177136421, decouple_loss:0.0031965349335223436
WV_0_PC_0_EH_1_PS_40, loss: 0.03235313296318054, avg_mse: 0.049915675073862076
current test mse: 0.049916
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 7361, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463541507720947
loss_pred:0.018170982599258423, decouple_loss:0.0024144051130861044
The generated pressure mean: 0.446086049079895
The generated pressure mean: 0.4471750259399414
loss_pred:0.017774956300854683, decouple_loss:0.0024798153899610043
loss_pred:0.01711408421397209, decouple_loss:0.0023606056347489357
Iteration: 7362, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4433978796005249
loss_pred:0.018143773078918457, decouple_loss:0.003342448268085718
The generated pressure mean: 0.44463858008384705
loss_pred:0.01646750420331955, decouple_loss:0.0034207100979983807
The generated pressure mean: 0.4430864453315735
loss_pred:0.018335998058319092, decouple_loss:0.0033655990846455097
Iteration: 7363, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477273225784302
loss_pred:0.018422052264213562, decouple_loss:0.00265625212341547
The generated pressure mean: 0.4455054998397827
loss_pred:0.016720330342650414, decouple_loss:0.0026786583475768566
The generated pressure mean: 0.44423580169677734
loss_pred:0.017636580392718315, decouple_loss:0.003028360428288579
Iteration: 7364, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4540737271308899
loss_pred:0.017081627622246742, decouple_loss:0.0034704639110714197
The generated pressure mean: 0.44581106305122375
loss_pred:0.016295175999403, decouple_loss:0.0034990981221199036
The generated pressure mean: 0.45397746562957764
loss_pred:0.018203986808657646, decouple_loss:0.0034877746365964413
Iteration: 7365, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4424636960029602
The generated pressure mean: 0.43856027722358704
loss_pred:0.017713092267513275, decouple_loss:0.002653362462297082
loss_pred:0.017221350222826004, decouple_loss:0.0026474830228835344
The generated pressure mean: 0.4403407871723175
loss_pred:0.01741921715438366, decouple_loss:0.002668230328708887
Iteration: 7366, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486590623855591
loss_pred:0.017464641481637955, decouple_loss:0.003080858150497079
The generated pressure mean: 0.4453459084033966
loss_pred:0.017949754372239113, decouple_loss:0.0031607882119715214
The generated pressure mean: 0.44672274589538574
loss_pred:0.016457458958029747, decouple_loss:0.0029990419279783964
Iteration: 7367, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44318443536758423
loss_pred:0.019274618476629257, decouple_loss:0.0037490203976631165
The generated pressure mean: 0.44493386149406433
loss_pred:0.017407234758138657, decouple_loss:0.003503517247736454
The generated pressure mean: 0.4477655589580536
loss_pred:0.016540562734007835, decouple_loss:0.003351125167682767
Iteration: 7368, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43571096658706665
loss_pred:0.017379505559802055, decouple_loss:0.0024901367723941803
The generated pressure mean: 0.43694183230400085
loss_pred:0.01770302653312683, decouple_loss:0.002554703736677766
The generated pressure mean: 0.4399994909763336
loss_pred:0.017930228263139725, decouple_loss:0.0024738521315157413
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 7369, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507923722267151
loss_pred:0.017709778621792793, decouple_loss:0.003707116236910224
The generated pressure mean: 0.45377209782600403
loss_pred:0.017600292339920998, decouple_loss:0.003277638927102089
The generated pressure mean: 0.4516463279724121
loss_pred:0.0194694846868515, decouple_loss:0.0032790815457701683
Iteration: 7370, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4435802698135376
loss_pred:0.01717565208673477, decouple_loss:0.002465582452714443
The generated pressure mean: 0.4439876079559326
loss_pred:0.01752946898341179, decouple_loss:0.0024796263314783573
The generated pressure mean: 0.4411529004573822
loss_pred:0.018911276012659073, decouple_loss:0.0024280173238366842
2023-04-17 15:27:06 testing...
The generated pressure mean: 0.4201066792011261
The generated pressure mean: 0.4128200113773346
The generated pressure mean: 0.42334988713264465
loss_pred:0.030339190736413002, decouple_loss:0.0029885286930948496
loss_pred:0.03155437484383583, decouple_loss:0.0028804198373109102
loss_pred:0.02964613400399685, decouple_loss:0.0030781093519181013
WV_0_PC_0_EH_1_PS_40, loss: 0.030662350356578827, avg_mse: 0.046752478927373886
current test mse: 0.046752
Iteration: 7371, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45097675919532776
loss_pred:0.016846440732479095, decouple_loss:0.0022294640075415373
The generated pressure mean: 0.4474737346172333
loss_pred:0.01753179542720318, decouple_loss:0.002162396674975753
The generated pressure mean: 0.44849562644958496
loss_pred:0.018750503659248352, decouple_loss:0.002204038668423891
Iteration: 7372, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44632068276405334
loss_pred:0.01730336807668209, decouple_loss:0.0029501651879400015
The generated pressure mean: 0.4559078514575958
loss_pred:0.018371032550930977, decouple_loss:0.002959705889225006
The generated pressure mean: 0.4533618688583374
loss_pred:0.019907671958208084, decouple_loss:0.002722169505432248
Iteration: 7373, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4269711375236511
loss_pred:0.016494877636432648, decouple_loss:0.002667837543413043
The generated pressure mean: 0.43076545000076294
loss_pred:0.017465855926275253, decouple_loss:0.002742421580478549
The generated pressure mean: 0.42634209990501404
loss_pred:0.017186958342790604, decouple_loss:0.002719507785513997
Iteration: 7374, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506101906299591
loss_pred:0.017107542604207993, decouple_loss:0.0032862331718206406
The generated pressure mean: 0.4486823081970215
loss_pred:0.017971664667129517, decouple_loss:0.003202268620952964
The generated pressure mean: 0.44902917742729187
loss_pred:0.017182398587465286, decouple_loss:0.0031269092578440905
Iteration: 7375, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45432791113853455
loss_pred:0.018130527809262276, decouple_loss:0.002608206355944276
The generated pressure mean: 0.4601714611053467
loss_pred:0.016316885128617287, decouple_loss:0.00261632795445621
The generated pressure mean: 0.460748553276062
loss_pred:0.01637687347829342, decouple_loss:0.002578319516032934
Iteration: 7376, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4407972991466522
loss_pred:0.017144137993454933, decouple_loss:0.002482459181919694
The generated pressure mean: 0.44822385907173157
loss_pred:0.01904756762087345, decouple_loss:0.0025345482863485813
The generated pressure mean: 0.4412950873374939
loss_pred:0.017290038987994194, decouple_loss:0.002344883047044277
Iteration: 7377, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.435624897480011
loss_pred:0.01692291535437107, decouple_loss:0.003114385763183236
The generated pressure mean: 0.4325345754623413
loss_pred:0.016710467636585236, decouple_loss:0.0029396864119917154
The generated pressure mean: 0.4372173249721527
loss_pred:0.01736263930797577, decouple_loss:0.003107337513938546
Iteration: 7378, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449898302555084
loss_pred:0.01823432743549347, decouple_loss:0.0023719952441751957
The generated pressure mean: 0.4469471275806427
loss_pred:0.01720878668129444, decouple_loss:0.0022218413650989532
The generated pressure mean: 0.44715842604637146
loss_pred:0.017360882833600044, decouple_loss:0.0022897638846188784
Iteration: 7379, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45184168219566345
loss_pred:0.01726856268942356, decouple_loss:0.002356939483433962
The generated pressure mean: 0.44901469349861145
loss_pred:0.01738470420241356, decouple_loss:0.002284236019477248
The generated pressure mean: 0.4431564509868622
loss_pred:0.017534544691443443, decouple_loss:0.0023590074852108955
Iteration: 7380, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45075976848602295
loss_pred:0.020084384828805923, decouple_loss:0.0032526864670217037
The generated pressure mean: 0.45699453353881836
loss_pred:0.016958732157945633, decouple_loss:0.003394576720893383
The generated pressure mean: 0.4539562165737152
loss_pred:0.016334952786564827, decouple_loss:0.0032109052408486605
2023-04-17 15:28:59 testing...
The generated pressure mean: 0.4202724099159241
The generated pressure mean: 0.41404569149017334
The generated pressure mean: 0.4231821596622467
loss_pred:0.030512342229485512, decouple_loss:0.002893101191148162
loss_pred:0.031228428706526756, decouple_loss:0.0027118052821606398
loss_pred:0.02977757714688778, decouple_loss:0.002985624363645911
WV_0_PC_0_EH_1_PS_40, loss: 0.030649293214082718, avg_mse: 0.04644389823079109
current test mse: 0.046444
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 7381, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44083014130592346
loss_pred:0.01887681521475315, decouple_loss:0.0024185313377529383
The generated pressure mean: 0.4392126798629761
loss_pred:0.017794137820601463, decouple_loss:0.0024499895516783
The generated pressure mean: 0.44034576416015625
loss_pred:0.019928310066461563, decouple_loss:0.002390036592260003
Iteration: 7382, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43980082869529724
loss_pred:0.017257776111364365, decouple_loss:0.002378877718001604
The generated pressure mean: 0.43702712655067444
loss_pred:0.01663328893482685, decouple_loss:0.0023762115743011236
The generated pressure mean: 0.43722009658813477
loss_pred:0.017941778525710106, decouple_loss:0.0024755734484642744
Iteration: 7383, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45036134123802185
loss_pred:0.01700093410909176, decouple_loss:0.0032512538600713015
The generated pressure mean: 0.4512512981891632
loss_pred:0.018852338194847107, decouple_loss:0.0032303547486662865
The generated pressure mean: 0.45222756266593933
loss_pred:0.01810789294540882, decouple_loss:0.0033186159562319517
Iteration: 7384, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45059362053871155
loss_pred:0.018695810809731483, decouple_loss:0.002149402629584074
The generated pressure mean: 0.45388856530189514
loss_pred:0.019016405567526817, decouple_loss:0.0021964507177472115
The generated pressure mean: 0.450357586145401
loss_pred:0.019492311403155327, decouple_loss:0.002111750887706876
Iteration: 7385, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4386385679244995
loss_pred:0.019286053255200386, decouple_loss:0.0033680566120892763
The generated pressure mean: 0.44029945135116577
loss_pred:0.01761155016720295, decouple_loss:0.003510862123221159
The generated pressure mean: 0.43776819109916687
loss_pred:0.01894945278763771, decouple_loss:0.003630434162914753
Iteration: 7386, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4363025426864624
loss_pred:0.01811583712697029, decouple_loss:0.0025076749734580517
The generated pressure mean: 0.4343603253364563
loss_pred:0.017147528007626534, decouple_loss:0.0026259811129420996
The generated pressure mean: 0.4362495243549347
loss_pred:0.017232712358236313, decouple_loss:0.0025420954916626215
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 7387, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4611935317516327
loss_pred:0.01949913427233696, decouple_loss:0.0033906791359186172
The generated pressure mean: 0.4564478397369385
loss_pred:0.017507443204522133, decouple_loss:0.0033787551801651716
The generated pressure mean: 0.4550445079803467
loss_pred:0.018183832988142967, decouple_loss:0.003265171078965068
Iteration: 7388, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4524052143096924
loss_pred:0.0182159673422575, decouple_loss:0.002641611732542515
The generated pressure mean: 0.45673513412475586
loss_pred:0.017713163048028946, decouple_loss:0.0026905802078545094
The generated pressure mean: 0.453856885433197
loss_pred:0.017261750996112823, decouple_loss:0.002628274727612734
Iteration: 7389, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4414941072463989
loss_pred:0.016430625692009926, decouple_loss:0.0031461422331631184
The generated pressure mean: 0.4415571093559265
loss_pred:0.01904742792248726, decouple_loss:0.0031167089473456144
The generated pressure mean: 0.43865877389907837
loss_pred:0.017789727076888084, decouple_loss:0.0031889700330793858
Iteration: 7390, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44758275151252747
loss_pred:0.017624370753765106, decouple_loss:0.00242515467107296
The generated pressure mean: 0.4456840455532074
loss_pred:0.01772298663854599, decouple_loss:0.0025165234692394733
The generated pressure mean: 0.4454783797264099
loss_pred:0.01739632710814476, decouple_loss:0.0023994436487555504
2023-04-17 15:31:29 testing...
The generated pressure mean: 0.41417208313941956
The generated pressure mean: 0.4209710359573364
The generated pressure mean: 0.42410361766815186
loss_pred:0.03182324022054672, decouple_loss:0.0038379004690796137
loss_pred:0.030724801123142242, decouple_loss:0.0038284468464553356
loss_pred:0.030347853899002075, decouple_loss:0.004006717819720507
WV_0_PC_0_EH_1_PS_40, loss: 0.03115984797477722, avg_mse: 0.04741819202899933
current test mse: 0.047418
Iteration: 7391, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471299350261688
loss_pred:0.0168453399091959, decouple_loss:0.003682398237287998
The generated pressure mean: 0.4460180699825287
loss_pred:0.01668473705649376, decouple_loss:0.0034220064990222454
The generated pressure mean: 0.4445600211620331
loss_pred:0.017575202509760857, decouple_loss:0.0035259646829217672
Iteration: 7392, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.442230761051178
loss_pred:0.01736890710890293, decouple_loss:0.0027688033878803253
The generated pressure mean: 0.44357046484947205
loss_pred:0.01734933629631996, decouple_loss:0.002640030812472105
The generated pressure mean: 0.441121906042099
loss_pred:0.01962900348007679, decouple_loss:0.00268991244956851
Iteration: 7393, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.445146381855011
loss_pred:0.02009131945669651, decouple_loss:0.002160992007702589
The generated pressure mean: 0.4437340199947357
loss_pred:0.01725764013826847, decouple_loss:0.0021110274828970432
The generated pressure mean: 0.4445425868034363
loss_pred:0.017804348841309547, decouple_loss:0.002212504157796502
Iteration: 7394, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45073434710502625
loss_pred:0.017053119838237762, decouple_loss:0.0024641419295221567
The generated pressure mean: 0.4504089951515198
loss_pred:0.016795523464679718, decouple_loss:0.0024689920246601105
The generated pressure mean: 0.4496728181838989
loss_pred:0.018284447491168976, decouple_loss:0.002517427783459425
Iteration: 7395, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4437563419342041
loss_pred:0.017529137432575226, decouple_loss:0.0031590545549988747
The generated pressure mean: 0.44514575600624084
loss_pred:0.018348833546042442, decouple_loss:0.003118024440482259
The generated pressure mean: 0.4418950378894806
loss_pred:0.01845727302134037, decouple_loss:0.0033610998652875423
Iteration: 7396, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44969892501831055
loss_pred:0.016713213175535202, decouple_loss:0.0030040813144296408
The generated pressure mean: 0.4492967128753662
loss_pred:0.017877060920000076, decouple_loss:0.00331015232950449
The generated pressure mean: 0.4496484100818634
loss_pred:0.01693321391940117, decouple_loss:0.003175517311319709
Iteration: 7397, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498501121997833
loss_pred:0.01678791455924511, decouple_loss:0.0027654673904180527
The generated pressure mean: 0.4511810541152954
loss_pred:0.017018673941493034, decouple_loss:0.002734909299761057
The generated pressure mean: 0.4505319595336914
loss_pred:0.017027588561177254, decouple_loss:0.0028372989036142826
Iteration: 7398, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4391583502292633
The generated pressure mean: 0.4389392137527466loss_pred:0.01865791343152523, decouple_loss:0.0023687302600592375
loss_pred:0.019095666706562042, decouple_loss:0.002297799801453948
The generated pressure mean: 0.43818217515945435
loss_pred:0.01750619150698185, decouple_loss:0.002429000101983547
Iteration: 7399, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477384686470032
loss_pred:0.01861334778368473, decouple_loss:0.0030507335904985666
The generated pressure mean: 0.44726434350013733
loss_pred:0.0178498774766922, decouple_loss:0.0031082734931260347
The generated pressure mean: 0.4474998414516449
loss_pred:0.01671070232987404, decouple_loss:0.0030195284634828568
Iteration: 7400, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485144317150116
loss_pred:0.01848752610385418, decouple_loss:0.0025151693262159824
The generated pressure mean: 0.4478425085544586
loss_pred:0.017863819375634193, decouple_loss:0.002463229466229677
The generated pressure mean: 0.4466331899166107
loss_pred:0.017335500568151474, decouple_loss:0.0025519460905343294
2023-04-17 15:33:22 testing...
The generated pressure mean: 0.4132927656173706
The generated pressure mean: 0.42024993896484375
loss_pred:0.032586682587862015, decouple_loss:0.002978062257170677
The generated pressure mean: 0.42316457629203796
loss_pred:0.031349677592515945, decouple_loss:0.0030524865724146366
loss_pred:0.03076285868883133, decouple_loss:0.003183134598657489
WV_0_PC_0_EH_1_PS_40, loss: 0.03171996772289276, avg_mse: 0.04844866320490837
current test mse: 0.048449
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 7401, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472253620624542
loss_pred:0.01769566349685192, decouple_loss:0.0025878071319311857
The generated pressure mean: 0.446767657995224
loss_pred:0.01641456037759781, decouple_loss:0.0028069012332707644
The generated pressure mean: 0.4439907670021057
loss_pred:0.019409412518143654, decouple_loss:0.0025600905064493418
Iteration: 7402, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467115104198456
loss_pred:0.01894860714673996, decouple_loss:0.0036019166000187397
The generated pressure mean: 0.4479270577430725
loss_pred:0.01767239160835743, decouple_loss:0.003651002421975136
The generated pressure mean: 0.44427725672721863
loss_pred:0.017179982736706734, decouple_loss:0.003570050001144409
Iteration: 7403, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4533193111419678
loss_pred:0.016951220110058784, decouple_loss:0.0023434231989085674
The generated pressure mean: 0.4476621448993683
loss_pred:0.01681605540215969, decouple_loss:0.002407125663012266
The generated pressure mean: 0.4488169252872467
loss_pred:0.017153242602944374, decouple_loss:0.0022891531698405743
Iteration: 7404, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43956857919692993
loss_pred:0.017006518319249153, decouple_loss:0.002987251617014408
The generated pressure mean: 0.4448978900909424
loss_pred:0.016698790714144707, decouple_loss:0.003057659137994051
The generated pressure mean: 0.4413258731365204
loss_pred:0.016804423183202744, decouple_loss:0.0031274824868887663
Iteration: 7405, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4388926029205322
loss_pred:0.016498342156410217, decouple_loss:0.0021811965852975845
The generated pressure mean: 0.439731627702713
loss_pred:0.01662062481045723, decouple_loss:0.002309112111106515
The generated pressure mean: 0.4420529901981354
loss_pred:0.016656149178743362, decouple_loss:0.0022986261174082756
Iteration: 7406, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4593870937824249
loss_pred:0.017864935100078583, decouple_loss:0.0026891734451055527
The generated pressure mean: 0.45820415019989014
The generated pressure mean: 0.4628584384918213
loss_pred:0.016714394092559814, decouple_loss:0.0027031085919588804
loss_pred:0.01875416561961174, decouple_loss:0.0027630736585706472
Iteration: 7407, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4348238706588745
loss_pred:0.01764703541994095, decouple_loss:0.003358385292813182
The generated pressure mean: 0.43605726957321167
loss_pred:0.01707233116030693, decouple_loss:0.0032719408627599478
The generated pressure mean: 0.4364721477031708
loss_pred:0.01810036040842533, decouple_loss:0.0033986105117946863
Iteration: 7408, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44224345684051514
The generated pressure mean: 0.44431549310684204
loss_pred:0.017830757424235344, decouple_loss:0.0022328742779791355
loss_pred:0.017987007275223732, decouple_loss:0.002195571316406131
The generated pressure mean: 0.445636510848999
loss_pred:0.018161457031965256, decouple_loss:0.002192613435909152
Iteration: 7409, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45226532220840454
loss_pred:0.018341805785894394, decouple_loss:0.0018522903556004167
The generated pressure mean: 0.4521022140979767
loss_pred:0.017387164756655693, decouple_loss:0.0018882665317505598
The generated pressure mean: 0.4502853453159332
loss_pred:0.016536196693778038, decouple_loss:0.0018679118948057294
Iteration: 7410, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44795387983322144
loss_pred:0.018385183066129684, decouple_loss:0.0020559937693178654
The generated pressure mean: 0.445141077041626
loss_pred:0.016358599066734314, decouple_loss:0.002110057044774294
The generated pressure mean: 0.4497944414615631
loss_pred:0.01835719682276249, decouple_loss:0.0020482991822063923
2023-04-17 15:35:55 testing...
The generated pressure mean: 0.41239795088768005
The generated pressure mean: 0.41890525817871094
The generated pressure mean: 0.4220583736896515
loss_pred:0.031084302812814713, decouple_loss:0.002798048546537757
loss_pred:0.03027358278632164, decouple_loss:0.0031332247890532017
loss_pred:0.029475132003426552, decouple_loss:0.0031838638242334127
WV_0_PC_0_EH_1_PS_40, loss: 0.030429592356085777, avg_mse: 0.04584517702460289
current test mse: 0.045845
Iteration: 7411, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45207974314689636
loss_pred:0.017403433099389076, decouple_loss:0.0024913533125072718
The generated pressure mean: 0.4512636959552765
loss_pred:0.017360372468829155, decouple_loss:0.002395635237917304
The generated pressure mean: 0.4530929625034332
loss_pred:0.01578623801469803, decouple_loss:0.0022770981304347515
Iteration: 7412, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4347516596317291
loss_pred:0.017648082226514816, decouple_loss:0.0022279273252934217
The generated pressure mean: 0.4405044615268707
loss_pred:0.021919960156083107, decouple_loss:0.0023378555197268724
The generated pressure mean: 0.43780234456062317
loss_pred:0.01819063350558281, decouple_loss:0.0023917038924992085
Iteration: 7413, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43328410387039185
loss_pred:0.01783442497253418, decouple_loss:0.002282593632116914
The generated pressure mean: 0.42855629324913025
loss_pred:0.018303466960787773, decouple_loss:0.0022585622500628233
The generated pressure mean: 0.429593026638031
loss_pred:0.020249083638191223, decouple_loss:0.0023974382784217596
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 7414, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46046754717826843
loss_pred:0.019506970420479774, decouple_loss:0.0025041585322469473
The generated pressure mean: 0.4517075717449188
loss_pred:0.01804226078093052, decouple_loss:0.0026063802652060986
The generated pressure mean: 0.46029964089393616
loss_pred:0.017153425142169, decouple_loss:0.0024025938473641872
Iteration: 7415, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45404052734375
loss_pred:0.015553563833236694, decouple_loss:0.002179350471124053
The generated pressure mean: 0.45330995321273804
loss_pred:0.016662608832120895, decouple_loss:0.00223611225374043
The generated pressure mean: 0.453117698431015
loss_pred:0.01814042031764984, decouple_loss:0.002237422624602914
Iteration: 7416, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4370121657848358
loss_pred:0.018193135038018227, decouple_loss:0.002048895228654146
The generated pressure mean: 0.4394093155860901
loss_pred:0.01749582774937153, decouple_loss:0.002243831753730774
The generated pressure mean: 0.4430626332759857
loss_pred:0.017499763518571854, decouple_loss:0.0020691538229584694
Iteration: 7417, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464695155620575
loss_pred:0.0166173093020916, decouple_loss:0.002752839121967554
The generated pressure mean: 0.44281572103500366
loss_pred:0.017129840329289436, decouple_loss:0.0028178642969578505
The generated pressure mean: 0.44361281394958496
loss_pred:0.016380926594138145, decouple_loss:0.0028226457070559263
Iteration: 7418, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500506520271301
loss_pred:0.017464181408286095, decouple_loss:0.002592365490272641
The generated pressure mean: 0.449868768453598
loss_pred:0.017563804984092712, decouple_loss:0.0024315938353538513
The generated pressure mean: 0.4511856734752655
loss_pred:0.017117219045758247, decouple_loss:0.002390563953667879
Iteration: 7419, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4443361759185791
loss_pred:0.018123839050531387, decouple_loss:0.0022120659705251455
The generated pressure mean: 0.4431881904602051
loss_pred:0.01773635670542717, decouple_loss:0.002234724583104253
The generated pressure mean: 0.44231292605400085
loss_pred:0.01805921457707882, decouple_loss:0.002079058438539505
Iteration: 7420, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507285952568054
loss_pred:0.016848474740982056, decouple_loss:0.0023297294974327087
The generated pressure mean: 0.4505178928375244
loss_pred:0.018207944929599762, decouple_loss:0.002343545900657773
The generated pressure mean: 0.4508117735385895
loss_pred:0.01770230010151863, decouple_loss:0.002298814244568348
2023-04-17 15:37:49 testing...
The generated pressure mean: 0.4129922389984131
The generated pressure mean: 0.4196380376815796
loss_pred:0.03194274380803108, decouple_loss:0.0027980783488601446
The generated pressure mean: 0.42278069257736206
loss_pred:0.031012510880827904, decouple_loss:0.0029700135346502066
loss_pred:0.03060106560587883, decouple_loss:0.003127793315798044
WV_0_PC_0_EH_1_PS_40, loss: 0.03133370727300644, avg_mse: 0.04776570945978165
current test mse: 0.047766
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 7421, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482662081718445
loss_pred:0.01767675206065178, decouple_loss:0.0024725175462663174
The generated pressure mean: 0.4478999674320221
loss_pred:0.016893884167075157, decouple_loss:0.0024175916332751513
The generated pressure mean: 0.4498067796230316
loss_pred:0.01715882681310177, decouple_loss:0.0024675470776855946
Iteration: 7422, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476211369037628
The generated pressure mean: 0.4468950033187866
loss_pred:0.01786346174776554, decouple_loss:0.002225225791335106
loss_pred:0.017619308084249496, decouple_loss:0.001982704969123006
The generated pressure mean: 0.4449687898159027
loss_pred:0.01680806092917919, decouple_loss:0.0020660057198256254
Iteration: 7423, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44626256823539734
The generated pressure mean: 0.44262978434562683
loss_pred:0.017968419939279556, decouple_loss:0.002291010459885001
loss_pred:0.01842501200735569, decouple_loss:0.0021107629872858524
The generated pressure mean: 0.4489242732524872
loss_pred:0.018219970166683197, decouple_loss:0.0023154031950980425
Iteration: 7424, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44181138277053833
The generated pressure mean: 0.4416148066520691
loss_pred:0.018503768369555473, decouple_loss:0.0019386709900572896
loss_pred:0.017754055559635162, decouple_loss:0.0019656529184430838
The generated pressure mean: 0.44324764609336853
loss_pred:0.01957939937710762, decouple_loss:0.001930425874888897
Iteration: 7425, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4443855583667755
loss_pred:0.01847093179821968, decouple_loss:0.0028215220663696527
The generated pressure mean: 0.4480516314506531
loss_pred:0.01758156344294548, decouple_loss:0.0028023896738886833
The generated pressure mean: 0.4445360600948334
loss_pred:0.01860826648771763, decouple_loss:0.0027260123752057552
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 7426, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45821383595466614
loss_pred:0.01672425866127014, decouple_loss:0.0035378215834498405
The generated pressure mean: 0.4612434208393097
loss_pred:0.016896437853574753, decouple_loss:0.003736036131158471
The generated pressure mean: 0.4575310945510864
loss_pred:0.017011567950248718, decouple_loss:0.003332361578941345
Iteration: 7427, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44412490725517273
loss_pred:0.018009629100561142, decouple_loss:0.002259037457406521
The generated pressure mean: 0.4413881301879883
loss_pred:0.020072098821401596, decouple_loss:0.002321766223758459
The generated pressure mean: 0.44253620505332947
loss_pred:0.01736048236489296, decouple_loss:0.002327677560970187
Iteration: 7428, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4447299540042877
loss_pred:0.01721997931599617, decouple_loss:0.004321877378970385
The generated pressure mean: 0.44187915325164795
loss_pred:0.016381138935685158, decouple_loss:0.004107672721147537
The generated pressure mean: 0.4459352195262909
loss_pred:0.01776702143251896, decouple_loss:0.004088880494236946
Iteration: 7429, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45119571685791016
loss_pred:0.01617542840540409, decouple_loss:0.0035393713042140007
The generated pressure mean: 0.4507431387901306
loss_pred:0.016772620379924774, decouple_loss:0.003266077721491456
The generated pressure mean: 0.45184898376464844
loss_pred:0.01878243498504162, decouple_loss:0.003352478612214327
Iteration: 7430, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44297778606414795
loss_pred:0.017423702403903008, decouple_loss:0.0034352808725088835
The generated pressure mean: 0.43792203068733215
loss_pred:0.0192647036164999, decouple_loss:0.0032468645367771387
The generated pressure mean: 0.4395030736923218
loss_pred:0.01938895881175995, decouple_loss:0.003492784220725298
2023-04-17 15:40:18 testing...
The generated pressure mean: 0.41154271364212036
The generated pressure mean: 0.41802895069122314
The generated pressure mean: 0.42162418365478516
loss_pred:0.03224330022931099, decouple_loss:0.0030532218515872955
loss_pred:0.031258225440979004, decouple_loss:0.003268901025876403
loss_pred:0.030486613512039185, decouple_loss:0.0033185158390551805
WV_0_PC_0_EH_1_PS_40, loss: 0.031490057706832886, avg_mse: 0.048277609050273895
current test mse: 0.048278
Iteration: 7431, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45176830887794495
loss_pred:0.016538117080926895, decouple_loss:0.002813619328662753
The generated pressure mean: 0.4553121030330658
loss_pred:0.016897447407245636, decouple_loss:0.0027704983949661255
The generated pressure mean: 0.4524987041950226
loss_pred:0.017389612272381783, decouple_loss:0.0029027587734162807
Iteration: 7432, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4547469913959503
loss_pred:0.019153108820319176, decouple_loss:0.0033932167571038008
The generated pressure mean: 0.45497021079063416
loss_pred:0.01858407072722912, decouple_loss:0.0034818698186427355
The generated pressure mean: 0.45128268003463745
loss_pred:0.01829809881746769, decouple_loss:0.0033935094252228737
Iteration: 7433, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43817123770713806
loss_pred:0.01851050555706024, decouple_loss:0.0034408194478601217
The generated pressure mean: 0.4343303442001343
loss_pred:0.018104277551174164, decouple_loss:0.003380234120413661
The generated pressure mean: 0.43507856130599976
loss_pred:0.017862970009446144, decouple_loss:0.0034495159052312374
Iteration: 7434, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493052363395691
loss_pred:0.016717171296477318, decouple_loss:0.002687480766326189
The generated pressure mean: 0.4506281018257141
loss_pred:0.016271965578198433, decouple_loss:0.002942553721368313
The generated pressure mean: 0.44717299938201904
loss_pred:0.017360534518957138, decouple_loss:0.00257243518717587
Iteration: 7435, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45123839378356934
loss_pred:0.018684087321162224, decouple_loss:0.002446995582431555
The generated pressure mean: 0.45430487394332886
loss_pred:0.01712166517972946, decouple_loss:0.0022510939743369818
The generated pressure mean: 0.4528926610946655
loss_pred:0.016357386484742165, decouple_loss:0.0022804520558565855
Iteration: 7436, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4411139488220215
loss_pred:0.018977118656039238, decouple_loss:0.00262435688637197
The generated pressure mean: 0.4410514831542969
loss_pred:0.015956105664372444, decouple_loss:0.002847356954589486
The generated pressure mean: 0.44380953907966614
loss_pred:0.018733186647295952, decouple_loss:0.0028167341370135546
Iteration: 7437, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4384748637676239
loss_pred:0.018748557195067406, decouple_loss:0.00228856410831213
The generated pressure mean: 0.4379614293575287
loss_pred:0.017953839153051376, decouple_loss:0.0022391346283257008
The generated pressure mean: 0.44501227140426636
loss_pred:0.01701844483613968, decouple_loss:0.0023123035207390785
Iteration: 7438, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4554519057273865
The generated pressure mean: 0.4538428485393524
loss_pred:0.020259486511349678, decouple_loss:0.002438807161524892
loss_pred:0.01737004518508911, decouple_loss:0.0024235467426478863
The generated pressure mean: 0.45480597019195557
loss_pred:0.01844158209860325, decouple_loss:0.0023388892877846956
Iteration: 7439, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4412473738193512
loss_pred:0.01730695180594921, decouple_loss:0.002707815496250987
The generated pressure mean: 0.4375368654727936
The generated pressure mean: 0.43986091017723083
loss_pred:0.016132419928908348, decouple_loss:0.0025597347412258387
loss_pred:0.017982516437768936, decouple_loss:0.0026601834688335657
Iteration: 7440, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44635486602783203
loss_pred:0.01917431503534317, decouple_loss:0.0022221675608307123
The generated pressure mean: 0.4483201205730438
loss_pred:0.0187697634100914, decouple_loss:0.002122746780514717
The generated pressure mean: 0.4453972280025482
loss_pred:0.01733514852821827, decouple_loss:0.0021309624426066875
2023-04-17 15:42:12 testing...
The generated pressure mean: 0.41188451647758484
The generated pressure mean: 0.418704092502594
The generated pressure mean: 0.4219352900981903
loss_pred:0.03441783785820007, decouple_loss:0.0026002589147537947
loss_pred:0.032233014702796936, decouple_loss:0.0028276972007006407
loss_pred:0.032829467207193375, decouple_loss:0.002738090930506587
WV_0_PC_0_EH_1_PS_40, loss: 0.03329620882868767, avg_mse: 0.05173642188310623
current test mse: 0.051736
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 7441, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46160703897476196
loss_pred:0.017424754798412323, decouple_loss:0.0021987161599099636
The generated pressure mean: 0.4601970911026001
The generated pressure mean: 0.45777979493141174
loss_pred:0.01797332428395748, decouple_loss:0.002242044545710087
loss_pred:0.017623817548155785, decouple_loss:0.0021355515345931053
Iteration: 7442, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44386255741119385
The generated pressure mean: 0.44386374950408936
loss_pred:0.018802696838974953, decouple_loss:0.0022855803836137056
loss_pred:0.017098652198910713, decouple_loss:0.002251163823530078
The generated pressure mean: 0.44286206364631653
loss_pred:0.01639636792242527, decouple_loss:0.002020667539909482
Iteration: 7443, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43217822909355164
loss_pred:0.01920952834188938, decouple_loss:0.0020604575984179974
The generated pressure mean: 0.4363429844379425
loss_pred:0.01694308966398239, decouple_loss:0.0018759605009108782
The generated pressure mean: 0.43671345710754395
loss_pred:0.01739298738539219, decouple_loss:0.0018346557626500726
Iteration: 7444, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490863084793091
loss_pred:0.018809307366609573, decouple_loss:0.001986419316381216
The generated pressure mean: 0.4452122747898102
loss_pred:0.019291430711746216, decouple_loss:0.002135228831321001
The generated pressure mean: 0.45019981265068054
loss_pred:0.015992816537618637, decouple_loss:0.0021059680730104446
Iteration: 7445, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4548448622226715
loss_pred:0.017183460295200348, decouple_loss:0.0027299027424305677
The generated pressure mean: 0.45643389225006104
loss_pred:0.018811922520399094, decouple_loss:0.0026732711121439934
The generated pressure mean: 0.458702951669693
loss_pred:0.016858844086527824, decouple_loss:0.002655202290043235
Iteration: 7446, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.441858172416687
loss_pred:0.018589377403259277, decouple_loss:0.0024095785338431597
The generated pressure mean: 0.45121684670448303
The generated pressure mean: 0.4468778967857361
loss_pred:0.018276510760188103, decouple_loss:0.0024343973491340876
loss_pred:0.01899169757962227, decouple_loss:0.002274010796099901
Iteration: 7447, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4406681954860687
loss_pred:0.01773648150265217, decouple_loss:0.0021261353977024555
The generated pressure mean: 0.43386611342430115
loss_pred:0.016480756923556328, decouple_loss:0.0021956993732601404
The generated pressure mean: 0.4379766881465912
loss_pred:0.017356140539050102, decouple_loss:0.002012821612879634
Iteration: 7448, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45629459619522095
loss_pred:0.017856083810329437, decouple_loss:0.0022387488279491663
The generated pressure mean: 0.45242762565612793
loss_pred:0.015887970104813576, decouple_loss:0.002147756516933441
The generated pressure mean: 0.4466615915298462
loss_pred:0.01632850244641304, decouple_loss:0.0021486205514520407
Iteration: 7449, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4618396759033203
loss_pred:0.017925413325428963, decouple_loss:0.001917271176353097
The generated pressure mean: 0.4569411873817444
loss_pred:0.017912356182932854, decouple_loss:0.0019173872424289584
The generated pressure mean: 0.4620824456214905
loss_pred:0.01716233789920807, decouple_loss:0.0018714874750003219
Iteration: 7450, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44439706206321716
The generated pressure mean: 0.4404699504375458
loss_pred:0.016634875908493996, decouple_loss:0.0018907840130850673
loss_pred:0.017818527296185493, decouple_loss:0.0021752198226749897
The generated pressure mean: 0.4402134418487549
loss_pred:0.01766141876578331, decouple_loss:0.0020151701755821705
2023-04-17 15:44:47 testing...
The generated pressure mean: 0.4158923923969269
The generated pressure mean: 0.4232867360115051
The generated pressure mean: 0.42610281705856323
loss_pred:0.03078385442495346, decouple_loss:0.002669030334800482
loss_pred:0.0297252144664526, decouple_loss:0.002931950381025672
loss_pred:0.029138509184122086, decouple_loss:0.0029910060111433268
WV_0_PC_0_EH_1_PS_40, loss: 0.030025726184248924, avg_mse: 0.04537055641412735
current test mse: 0.045371
Iteration: 7451, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4383447468280792
loss_pred:0.015961404889822006, decouple_loss:0.002236768137663603
The generated pressure mean: 0.4370803236961365
loss_pred:0.018320729956030846, decouple_loss:0.002421822864562273
The generated pressure mean: 0.43908482789993286
loss_pred:0.016106300055980682, decouple_loss:0.002392210066318512
Iteration: 7452, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483388364315033
loss_pred:0.01707083359360695, decouple_loss:0.0031080245971679688
The generated pressure mean: 0.4492258131504059
loss_pred:0.017053717747330666, decouple_loss:0.00321516883559525
The generated pressure mean: 0.44966158270835876
loss_pred:0.017219610512256622, decouple_loss:0.0029181367717683315
Iteration: 7453, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4594102203845978
loss_pred:0.01632782816886902, decouple_loss:0.0025508871767669916
The generated pressure mean: 0.4592503607273102
loss_pred:0.0170082189142704, decouple_loss:0.0025249598547816277
The generated pressure mean: 0.4606029689311981
loss_pred:0.01619449444115162, decouple_loss:0.00254847202450037
Iteration: 7454, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4431615471839905
loss_pred:0.017731359228491783, decouple_loss:0.0020404821261763573
The generated pressure mean: 0.4381142556667328
loss_pred:0.017858324572443962, decouple_loss:0.002080164384096861
The generated pressure mean: 0.438687264919281
loss_pred:0.018004922196269035, decouple_loss:0.001997137675061822
Iteration: 7455, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44075044989585876
loss_pred:0.017557237297296524, decouple_loss:0.0025455693248659372
The generated pressure mean: 0.44290944933891296
loss_pred:0.018040308728814125, decouple_loss:0.0022836229763925076
The generated pressure mean: 0.4383712708950043
loss_pred:0.017434485256671906, decouple_loss:0.0024411433842033148
Iteration: 7456, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4524790942668915
loss_pred:0.01751488819718361, decouple_loss:0.003343521384522319
The generated pressure mean: 0.4528018534183502
The generated pressure mean: 0.45249369740486145loss_pred:0.018640361726284027, decouple_loss:0.0032897971104830503
loss_pred:0.018202640116214752, decouple_loss:0.0032059410586953163
Iteration: 7457, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4426199495792389
loss_pred:0.017512567341327667, decouple_loss:0.0019374277908354998
The generated pressure mean: 0.4493350088596344
loss_pred:0.01689697988331318, decouple_loss:0.0020581765566021204
The generated pressure mean: 0.44199317693710327
loss_pred:0.017386773601174355, decouple_loss:0.001980892149731517
Iteration: 7458, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45105621218681335
loss_pred:0.016243474557995796, decouple_loss:0.0028552731964737177
The generated pressure mean: 0.45015740394592285
loss_pred:0.016928469762206078, decouple_loss:0.002965811872854829
The generated pressure mean: 0.448246568441391
loss_pred:0.01859310083091259, decouple_loss:0.0029319380410015583
Iteration: 7459, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446598619222641
loss_pred:0.01734895259141922, decouple_loss:0.002709649968892336
The generated pressure mean: 0.44515007734298706
The generated pressure mean: 0.4423713982105255
loss_pred:0.01811729557812214, decouple_loss:0.0026485768612474203
loss_pred:0.016707606613636017, decouple_loss:0.0027223126962780952
Iteration: 7460, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491111934185028
loss_pred:0.01838286593556404, decouple_loss:0.002520664595067501
The generated pressure mean: 0.45228976011276245
The generated pressure mean: 0.45160767436027527
loss_pred:0.016307884827256203, decouple_loss:0.002372889081016183
loss_pred:0.017038162797689438, decouple_loss:0.0023312398698180914
2023-04-17 15:46:40 testing...
The generated pressure mean: 0.41357535123825073
The generated pressure mean: 0.42075592279434204
The generated pressure mean: 0.42443257570266724
loss_pred:0.03196270763874054, decouple_loss:0.002841236302629113
loss_pred:0.030615022405982018, decouple_loss:0.0029779868200421333
loss_pred:0.030035827308893204, decouple_loss:0.0030674743466079235
WV_0_PC_0_EH_1_PS_40, loss: 0.0310192983597517, avg_mse: 0.04755518212914467
current test mse: 0.047555
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 7461, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44548383355140686
loss_pred:0.017508117482066154, decouple_loss:0.0024057889822870493
The generated pressure mean: 0.44659224152565
loss_pred:0.016966212540864944, decouple_loss:0.0024931798689067364
The generated pressure mean: 0.44572147727012634
loss_pred:0.017612259835004807, decouple_loss:0.0024816107470542192
Iteration: 7462, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4394387900829315
The generated pressure mean: 0.4458254277706146
loss_pred:0.017427662387490273, decouple_loss:0.0025713059585541487
loss_pred:0.018613936379551888, decouple_loss:0.002748247003182769
The generated pressure mean: 0.44576841592788696
loss_pred:0.01739930920302868, decouple_loss:0.002498835325241089
Iteration: 7463, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4444054961204529The generated pressure mean: 0.43954747915267944
loss_pred:0.017980827018618584, decouple_loss:0.0024225576780736446
loss_pred:0.016214296221733093, decouple_loss:0.002412507776170969
The generated pressure mean: 0.4393911361694336
loss_pred:0.016468916088342667, decouple_loss:0.0023222784511744976
Iteration: 7464, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44603559374809265
The generated pressure mean: 0.44892042875289917
loss_pred:0.01813824661076069, decouple_loss:0.002805465366691351
loss_pred:0.019885370507836342, decouple_loss:0.0027514828834682703
The generated pressure mean: 0.45384711027145386
loss_pred:0.01789608597755432, decouple_loss:0.0028177816420793533
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 7465, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43855538964271545
The generated pressure mean: 0.4383198022842407
loss_pred:0.018706297501921654, decouple_loss:0.0024126104544848204
loss_pred:0.01723412796854973, decouple_loss:0.0023429361172020435
The generated pressure mean: 0.44109469652175903
loss_pred:0.016447313129901886, decouple_loss:0.002322522923350334
Iteration: 7466, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45583105087280273
The generated pressure mean: 0.4586747884750366
loss_pred:0.018611816689372063, decouple_loss:0.0030196860898286104
loss_pred:0.0170015599578619, decouple_loss:0.002968080807477236
The generated pressure mean: 0.45565900206565857
loss_pred:0.019113358110189438, decouple_loss:0.0030850463081151247
Iteration: 7467, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44481992721557617
The generated pressure mean: 0.44043031334877014
loss_pred:0.016788635402917862, decouple_loss:0.002509078709408641
loss_pred:0.01854621060192585, decouple_loss:0.002688764128834009
The generated pressure mean: 0.44865256547927856
loss_pred:0.01978907361626625, decouple_loss:0.002662950661033392
Iteration: 7468, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4510926604270935
The generated pressure mean: 0.45214590430259705
loss_pred:0.01647772639989853, decouple_loss:0.002196898218244314
loss_pred:0.017010334879159927, decouple_loss:0.002287093549966812
The generated pressure mean: 0.45193353295326233
loss_pred:0.017131276428699493, decouple_loss:0.0022949869744479656
Iteration: 7469, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44688159227371216
loss_pred:0.016250932589173317, decouple_loss:0.0025355101097375154
The generated pressure mean: 0.4465804994106293
loss_pred:0.017819080501794815, decouple_loss:0.0026167109608650208
The generated pressure mean: 0.4442644715309143
loss_pred:0.01760704629123211, decouple_loss:0.0026447856798768044
Iteration: 7470, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43519413471221924
loss_pred:0.017357712611556053, decouple_loss:0.0027829136233776808
The generated pressure mean: 0.4328761696815491
loss_pred:0.016587337478995323, decouple_loss:0.002716571092605591
The generated pressure mean: 0.43629980087280273
loss_pred:0.017102140933275223, decouple_loss:0.002731973072513938
2023-04-17 15:49:10 testing...
The generated pressure mean: 0.41245728731155396
The generated pressure mean: 0.41866788268089294
loss_pred:0.032502640038728714, decouple_loss:0.002865126356482506
The generated pressure mean: 0.42176422476768494
loss_pred:0.03151420131325722, decouple_loss:0.003102534217759967
loss_pred:0.030957872048020363, decouple_loss:0.003161732340231538
WV_0_PC_0_EH_1_PS_40, loss: 0.031810395419597626, avg_mse: 0.048779480159282684
current test mse: 0.048779
Iteration: 7471, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475932717323303
loss_pred:0.018564103171229362, decouple_loss:0.002488898579031229
The generated pressure mean: 0.45286011695861816
loss_pred:0.016590461134910583, decouple_loss:0.0025900155305862427
The generated pressure mean: 0.4507407546043396
loss_pred:0.015854645520448685, decouple_loss:0.0023640368599444628
Iteration: 7472, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4531535804271698
loss_pred:0.017627831548452377, decouple_loss:0.003042773576453328
The generated pressure mean: 0.4520792067050934
loss_pred:0.020973412320017815, decouple_loss:0.0032372144050896168
The generated pressure mean: 0.44652342796325684
loss_pred:0.016643956303596497, decouple_loss:0.0031464225612580776
Iteration: 7473, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43517550826072693
loss_pred:0.01689830608665943, decouple_loss:0.002299001906067133
The generated pressure mean: 0.43677908182144165
loss_pred:0.01842137798666954, decouple_loss:0.002212299033999443
The generated pressure mean: 0.43386533856391907
loss_pred:0.016745055094361305, decouple_loss:0.0023036361671984196
Iteration: 7474, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4443235397338867
loss_pred:0.01648268848657608, decouple_loss:0.0026049658190459013
The generated pressure mean: 0.45189300179481506
loss_pred:0.016427258029580116, decouple_loss:0.002761340467259288
The generated pressure mean: 0.44568127393722534
loss_pred:0.01714998483657837, decouple_loss:0.0027323246467858553
Iteration: 7475, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4574011564254761
loss_pred:0.01606343314051628, decouple_loss:0.002611809177324176
The generated pressure mean: 0.45450469851493835
loss_pred:0.018586458638310432, decouple_loss:0.0025955282617360353
The generated pressure mean: 0.45867466926574707
loss_pred:0.017677923664450645, decouple_loss:0.0027390674222260714
Iteration: 7476, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43459105491638184
loss_pred:0.017042266204953194, decouple_loss:0.002655281685292721
The generated pressure mean: 0.4368733763694763
loss_pred:0.01609591208398342, decouple_loss:0.0026191184297204018
The generated pressure mean: 0.43901219964027405
loss_pred:0.017374973744153976, decouple_loss:0.0026824185624718666
Iteration: 7477, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4458804726600647
loss_pred:0.01734503172338009, decouple_loss:0.002154697896912694
The generated pressure mean: 0.43584731221199036
loss_pred:0.01618695631623268, decouple_loss:0.0023292982950806618
The generated pressure mean: 0.4434869587421417
loss_pred:0.0190243162214756, decouple_loss:0.002151178428903222
Iteration: 7478, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4588472843170166
loss_pred:0.01790355145931244, decouple_loss:0.0024001742713153362
The generated pressure mean: 0.45887547731399536
The generated pressure mean: 0.4568934738636017
loss_pred:0.016712214797735214, decouple_loss:0.0023815457243472338
loss_pred:0.016928846016526222, decouple_loss:0.002297784434631467
Iteration: 7479, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44252443313598633
loss_pred:0.017739925533533096, decouple_loss:0.0023622161243110895
The generated pressure mean: 0.43870413303375244
loss_pred:0.016105687245726585, decouple_loss:0.002407829975709319
The generated pressure mean: 0.4374817907810211
loss_pred:0.01622009091079235, decouple_loss:0.0024752116296440363
Iteration: 7480, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44412851333618164
loss_pred:0.016120124608278275, decouple_loss:0.0024678651243448257
The generated pressure mean: 0.44370633363723755
loss_pred:0.016024084761738777, decouple_loss:0.002520289272069931
The generated pressure mean: 0.4435773193836212
loss_pred:0.01671198382973671, decouple_loss:0.0025353520177304745
2023-04-17 15:51:03 testing...
The generated pressure mean: 0.41370463371276855
The generated pressure mean: 0.42052555084228516
loss_pred:0.03284614160656929, decouple_loss:0.00270110578276217
The generated pressure mean: 0.4238339066505432
loss_pred:0.03171287849545479, decouple_loss:0.0028513409197330475
loss_pred:0.03137782961130142, decouple_loss:0.00300285080447793
WV_0_PC_0_EH_1_PS_40, loss: 0.03212153911590576, avg_mse: 0.04956479370594025
current test mse: 0.049565
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 7481, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44822096824645996
loss_pred:0.016883501783013344, decouple_loss:0.002175490139052272
The generated pressure mean: 0.4487689435482025
loss_pred:0.020214514806866646, decouple_loss:0.0022580092772841454
The generated pressure mean: 0.44951513409614563
loss_pred:0.015488858334720135, decouple_loss:0.0022149095311760902
Iteration: 7482, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43763792514801025
loss_pred:0.016463154926896095, decouple_loss:0.0026069674640893936
The generated pressure mean: 0.4369525909423828
loss_pred:0.01852557621896267, decouple_loss:0.0024642273783683777
The generated pressure mean: 0.44110623002052307
loss_pred:0.01768202893435955, decouple_loss:0.002562267240136862
Iteration: 7483, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44964927434921265
loss_pred:0.017993956804275513, decouple_loss:0.0023406953550875187
The generated pressure mean: 0.4497948884963989
loss_pred:0.017618760466575623, decouple_loss:0.002363783773034811
The generated pressure mean: 0.44666123390197754
loss_pred:0.01978182978928089, decouple_loss:0.0023387460969388485
Iteration: 7484, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492042064666748
loss_pred:0.017723634839057922, decouple_loss:0.0023462751414626837
The generated pressure mean: 0.45189446210861206
loss_pred:0.016344446688890457, decouple_loss:0.002432772424072027
The generated pressure mean: 0.455615371465683
loss_pred:0.016692088916897774, decouple_loss:0.0022290099877864122
Iteration: 7485, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44842469692230225
loss_pred:0.01784166321158409, decouple_loss:0.0028716798406094313
The generated pressure mean: 0.44807153940200806
loss_pred:0.01676720567047596, decouple_loss:0.002940316451713443
The generated pressure mean: 0.44815829396247864
loss_pred:0.019214624539017677, decouple_loss:0.0028409443330019712
Iteration: 7486, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43075019121170044
loss_pred:0.017068373039364815, decouple_loss:0.0026701500173658133
The generated pressure mean: 0.4308198392391205
The generated pressure mean: 0.43019193410873413loss_pred:0.016408206894993782, decouple_loss:0.002460743533447385
loss_pred:0.017783302813768387, decouple_loss:0.002366491127759218
Iteration: 7487, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4513700306415558
loss_pred:0.01844736747443676, decouple_loss:0.002792647108435631
The generated pressure mean: 0.4441128373146057
loss_pred:0.01668313331902027, decouple_loss:0.002718911971896887
The generated pressure mean: 0.4476548731327057
loss_pred:0.01620769128203392, decouple_loss:0.0027495170943439007
Iteration: 7488, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46272581815719604
loss_pred:0.017628591507673264, decouple_loss:0.00254295626655221
The generated pressure mean: 0.4664384722709656
The generated pressure mean: 0.46723672747612
loss_pred:0.018055466935038567, decouple_loss:0.002741747535765171
loss_pred:0.01723216474056244, decouple_loss:0.002655502874404192
Iteration: 7489, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44115933775901794
loss_pred:0.019009385257959366, decouple_loss:0.0022843831684440374
The generated pressure mean: 0.43785741925239563
loss_pred:0.017164824530482292, decouple_loss:0.0023356094025075436
The generated pressure mean: 0.4429244101047516
loss_pred:0.01660943031311035, decouple_loss:0.0021835295483469963
Iteration: 7490, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4347221553325653
loss_pred:0.018594782799482346, decouple_loss:0.002176574431359768
The generated pressure mean: 0.43637996912002563
The generated pressure mean: 0.4385209083557129loss_pred:0.01595158874988556, decouple_loss:0.0021980293095111847
loss_pred:0.017889225855469704, decouple_loss:0.002161353826522827
2023-04-17 15:53:35 testing...
The generated pressure mean: 0.4185766279697418
The generated pressure mean: 0.41172486543655396
The generated pressure mean: 0.4216218888759613
loss_pred:0.03143031895160675, decouple_loss:0.003302532248198986
loss_pred:0.03245251625776291, decouple_loss:0.0031129433773458004
loss_pred:0.030312711372971535, decouple_loss:0.0034468546509742737
WV_0_PC_0_EH_1_PS_40, loss: 0.031562887132167816, avg_mse: 0.04814235866069794
current test mse: 0.048142
Iteration: 7491, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45515161752700806
loss_pred:0.016257859766483307, decouple_loss:0.00255868979729712
The generated pressure mean: 0.45766887068748474
loss_pred:0.01576770469546318, decouple_loss:0.0025217244401574135
The generated pressure mean: 0.45036405324935913
loss_pred:0.0180638637393713, decouple_loss:0.002434534253552556
Iteration: 7492, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4522876441478729
loss_pred:0.01725652813911438, decouple_loss:0.0020924247801303864
The generated pressure mean: 0.4528442323207855
loss_pred:0.020688513293862343, decouple_loss:0.0022982514929026365
The generated pressure mean: 0.4566341042518616
loss_pred:0.016663935035467148, decouple_loss:0.002157070441171527
Iteration: 7493, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43410593271255493
loss_pred:0.016561688855290413, decouple_loss:0.002353742253035307
The generated pressure mean: 0.4362950921058655
loss_pred:0.0165892094373703, decouple_loss:0.002424989826977253
The generated pressure mean: 0.43653202056884766
loss_pred:0.017588023096323013, decouple_loss:0.002273265039548278
Iteration: 7494, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4422919750213623
loss_pred:0.01785907708108425, decouple_loss:0.0021634772419929504
The generated pressure mean: 0.44547006487846375
loss_pred:0.017374789342284203, decouple_loss:0.0022417588625103235
The generated pressure mean: 0.4427643418312073
loss_pred:0.017889786511659622, decouple_loss:0.002253439975902438
Iteration: 7495, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45741915702819824
loss_pred:0.017420409247279167, decouple_loss:0.0021944029722362757
The generated pressure mean: 0.4582052230834961
loss_pred:0.016964832320809364, decouple_loss:0.002253448124974966
The generated pressure mean: 0.4601356089115143
loss_pred:0.016803104430437088, decouple_loss:0.002266571158543229
Iteration: 7496, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499025046825409
loss_pred:0.017271235585212708, decouple_loss:0.002174359280616045
The generated pressure mean: 0.4532095491886139
loss_pred:0.01863468438386917, decouple_loss:0.0021972660906612873
The generated pressure mean: 0.45027729868888855
loss_pred:0.01621248386800289, decouple_loss:0.0022853417322039604
Iteration: 7497, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.437349796295166
loss_pred:0.016738785430788994, decouple_loss:0.002432413399219513
The generated pressure mean: 0.43686580657958984
loss_pred:0.015614604577422142, decouple_loss:0.0025465062353760004
The generated pressure mean: 0.43752992153167725
loss_pred:0.016898121684789658, decouple_loss:0.0023815862368792295
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 7498, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475233256816864
The generated pressure mean: 0.45104116201400757
loss_pred:0.01720716990530491, decouple_loss:0.0022140208166092634
loss_pred:0.017844827845692635, decouple_loss:0.0023121205158531666
The generated pressure mean: 0.44707998633384705
loss_pred:0.01650954782962799, decouple_loss:0.0022858302108943462
Iteration: 7499, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4527030885219574
The generated pressure mean: 0.4556722939014435
loss_pred:0.018934892490506172, decouple_loss:0.0023682331666350365
loss_pred:0.016225039958953857, decouple_loss:0.0025406847707927227
The generated pressure mean: 0.4497656524181366
loss_pred:0.01624157838523388, decouple_loss:0.0024993864353746176
Iteration: 7500, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4368492066860199
loss_pred:0.01731804572045803, decouple_loss:0.0023209378123283386
The generated pressure mean: 0.4414448142051697
loss_pred:0.016378328204154968, decouple_loss:0.0022650740575045347
The generated pressure mean: 0.4384074807167053
loss_pred:0.018299661576747894, decouple_loss:0.0023978378158062696
2023-04-17 15:55:28 testing...
The generated pressure mean: 0.4128934144973755
The generated pressure mean: 0.41935837268829346
The generated pressure mean: 0.4222419559955597
loss_pred:0.031407106667757034, decouple_loss:0.0024278464261442423
loss_pred:0.030347924679517746, decouple_loss:0.0026420920621603727
loss_pred:0.029780521988868713, decouple_loss:0.002784629352390766
WV_0_PC_0_EH_1_PS_40, loss: 0.030642760917544365, avg_mse: 0.04655851051211357
current test mse: 0.046559
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 7501, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4426746964454651
loss_pred:0.017121342942118645, decouple_loss:0.002302127657458186
The generated pressure mean: 0.44557124376296997
loss_pred:0.018888598307967186, decouple_loss:0.001994440797716379
The generated pressure mean: 0.4469637870788574
loss_pred:0.020610321313142776, decouple_loss:0.002113582333549857
Iteration: 7502, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499036967754364
loss_pred:0.016429968178272247, decouple_loss:0.00238172453828156
The generated pressure mean: 0.44886937737464905
loss_pred:0.016918638721108437, decouple_loss:0.002328569069504738
The generated pressure mean: 0.4521455764770508
loss_pred:0.017650866881012917, decouple_loss:0.00236711697652936
Iteration: 7503, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4414645731449127
loss_pred:0.018721725791692734, decouple_loss:0.002187828067690134
The generated pressure mean: 0.44896310567855835
loss_pred:0.017381815239787102, decouple_loss:0.0021998854354023933
The generated pressure mean: 0.4465905725955963
loss_pred:0.017658280208706856, decouple_loss:0.0020437214989215136
Iteration: 7504, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4402907192707062
loss_pred:0.017178621143102646, decouple_loss:0.001953225117176771
The generated pressure mean: 0.43429476022720337
loss_pred:0.018277976661920547, decouple_loss:0.0019205119460821152
The generated pressure mean: 0.4380045235157013
loss_pred:0.01714782416820526, decouple_loss:0.00195646146312356
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 7505, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447504460811615
The generated pressure mean: 0.4503518342971802
loss_pred:0.017733735963702202, decouple_loss:0.0022078787442296743
loss_pred:0.017289821058511734, decouple_loss:0.0025270457845181227
The generated pressure mean: 0.4478030204772949
loss_pred:0.017615733668208122, decouple_loss:0.002165484009310603
Iteration: 7506, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45760273933410645
loss_pred:0.017818961292505264, decouple_loss:0.0020482619293034077
The generated pressure mean: 0.4508974254131317
loss_pred:0.016920847818255424, decouple_loss:0.002004736801609397
The generated pressure mean: 0.4547070562839508
loss_pred:0.017169123515486717, decouple_loss:0.0020593467634171247
Iteration: 7507, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44071224331855774
The generated pressure mean: 0.44253355264663696
loss_pred:0.020118221640586853, decouple_loss:0.0021251800935715437
loss_pred:0.01753387786448002, decouple_loss:0.0021111706737428904
The generated pressure mean: 0.4442445933818817
loss_pred:0.017578868195414543, decouple_loss:0.00224522827193141
Iteration: 7508, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44133391976356506
loss_pred:0.017175259068608284, decouple_loss:0.0027675649616867304
The generated pressure mean: 0.44256001710891724
The generated pressure mean: 0.4344366192817688loss_pred:0.017684193328022957, decouple_loss:0.0026542546693235636
loss_pred:0.017594624310731888, decouple_loss:0.0026515056379139423
Iteration: 7509, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503798186779022
loss_pred:0.017885612323880196, decouple_loss:0.0027176891453564167
The generated pressure mean: 0.45571473240852356
loss_pred:0.019527297466993332, decouple_loss:0.0026767924427986145
The generated pressure mean: 0.4546535611152649
loss_pred:0.018199622631072998, decouple_loss:0.0026800616178661585
Iteration: 7510, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42672425508499146
loss_pred:0.020187875255942345, decouple_loss:0.0026632111985236406
The generated pressure mean: 0.42687493562698364
loss_pred:0.01823127456009388, decouple_loss:0.002752972999587655
The generated pressure mean: 0.4300518035888672
loss_pred:0.017910445109009743, decouple_loss:0.0026675695553421974
2023-04-17 15:58:02 testing...
The generated pressure mean: 0.4106804132461548
The generated pressure mean: 0.41727569699287415
The generated pressure mean: 0.42081087827682495
loss_pred:0.033421486616134644, decouple_loss:0.0026274824049323797
loss_pred:0.03255964070558548, decouple_loss:0.0027920501306653023
loss_pred:0.03202374652028084, decouple_loss:0.0029768403619527817
WV_0_PC_0_EH_1_PS_40, loss: 0.03280822932720184, avg_mse: 0.05075659602880478
current test mse: 0.050757
Iteration: 7511, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46193987131118774
loss_pred:0.017504364252090454, decouple_loss:0.0023110578767955303
The generated pressure mean: 0.4614885449409485
loss_pred:0.0183689184486866, decouple_loss:0.002332223579287529
The generated pressure mean: 0.46329155564308167
loss_pred:0.01728834956884384, decouple_loss:0.002232865197584033
Iteration: 7512, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45993533730506897
loss_pred:0.0171901173889637, decouple_loss:0.0021469122730195522
The generated pressure mean: 0.46067485213279724
loss_pred:0.01856013387441635, decouple_loss:0.00222602766007185
The generated pressure mean: 0.45715948939323425
loss_pred:0.018960360437631607, decouple_loss:0.00204933388158679
Iteration: 7513, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42477935552597046
loss_pred:0.0166309867054224, decouple_loss:0.0029303892515599728
The generated pressure mean: 0.4322091042995453
loss_pred:0.01772555150091648, decouple_loss:0.0028989536222070456
The generated pressure mean: 0.4318681061267853
loss_pred:0.01683660037815571, decouple_loss:0.002872597659006715
Iteration: 7514, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4316248893737793
loss_pred:0.01871473714709282, decouple_loss:0.002501767361536622
The generated pressure mean: 0.4337863326072693
loss_pred:0.018587607890367508, decouple_loss:0.0024711599107831717
The generated pressure mean: 0.4265477657318115
loss_pred:0.017409449443221092, decouple_loss:0.0023883096873760223
Iteration: 7515, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4628259837627411
loss_pred:0.018313048407435417, decouple_loss:0.0023977109231054783
The generated pressure mean: 0.46162551641464233
loss_pred:0.017888851463794708, decouple_loss:0.0024159725289791822
The generated pressure mean: 0.4643024504184723
loss_pred:0.018057597801089287, decouple_loss:0.0022870488464832306
Iteration: 7516, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45450618863105774
loss_pred:0.01759352721273899, decouple_loss:0.002493481617420912
The generated pressure mean: 0.45739084482192993
loss_pred:0.018272092565894127, decouple_loss:0.0024985908530652523
The generated pressure mean: 0.45541954040527344
loss_pred:0.017977586016058922, decouple_loss:0.0024905656464397907
Iteration: 7517, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4396061599254608
loss_pred:0.016653671860694885, decouple_loss:0.002042306587100029
The generated pressure mean: 0.43438076972961426
loss_pred:0.020010972395539284, decouple_loss:0.002137209987267852
The generated pressure mean: 0.43400686979293823
loss_pred:0.017816409468650818, decouple_loss:0.002140856347978115
Iteration: 7518, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44717279076576233
loss_pred:0.019406966865062714, decouple_loss:0.001985750626772642
The generated pressure mean: 0.44464030861854553
loss_pred:0.018584467470645905, decouple_loss:0.0020012171007692814
The generated pressure mean: 0.4398665130138397
loss_pred:0.01907443441450596, decouple_loss:0.001977250212803483
Iteration: 7519, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4456956088542938
loss_pred:0.01808248646557331, decouple_loss:0.0022930835839360952
The generated pressure mean: 0.4411955773830414
loss_pred:0.01763170212507248, decouple_loss:0.0023114492651075125
The generated pressure mean: 0.4416550099849701
loss_pred:0.019085898995399475, decouple_loss:0.002320461440831423
Iteration: 7520, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464184045791626
loss_pred:0.017211372032761574, decouple_loss:0.0019475312437862158
The generated pressure mean: 0.4457893967628479
loss_pred:0.017666082829236984, decouple_loss:0.0019136174814775586
The generated pressure mean: 0.4424597918987274
loss_pred:0.016752196475863457, decouple_loss:0.0019076120806857944
2023-04-17 15:59:56 testing...
The generated pressure mean: 0.4102019667625427
The generated pressure mean: 0.4155489206314087
The generated pressure mean: 0.418563574552536
loss_pred:0.033617544919252396, decouple_loss:0.0026718939188867807
loss_pred:0.03271672502160072, decouple_loss:0.00283033843152225
loss_pred:0.032511934638023376, decouple_loss:0.002912556752562523
WV_0_PC_0_EH_1_PS_40, loss: 0.03308898210525513, avg_mse: 0.050874605774879456
current test mse: 0.050875
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 7521, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4582156240940094
loss_pred:0.01837075501680374, decouple_loss:0.002268731826916337
The generated pressure mean: 0.45407629013061523
loss_pred:0.01729675568640232, decouple_loss:0.002231400925666094
The generated pressure mean: 0.45718899369239807
loss_pred:0.018806954845786095, decouple_loss:0.002254968509078026
Iteration: 7522, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4458611011505127
The generated pressure mean: 0.4420091509819031
loss_pred:0.019066156819462776, decouple_loss:0.0021627473179250956
loss_pred:0.01963818445801735, decouple_loss:0.002011106349527836
The generated pressure mean: 0.44738590717315674
loss_pred:0.01966550201177597, decouple_loss:0.0021760256495326757
Iteration: 7523, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43591782450675964
The generated pressure mean: 0.431071013212204
loss_pred:0.017497656866908073, decouple_loss:0.002425787504762411
loss_pred:0.01711713895201683, decouple_loss:0.00230408669449389
The generated pressure mean: 0.4334322512149811
loss_pred:0.01727668195962906, decouple_loss:0.002309876261278987
Iteration: 7524, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465242624282837
The generated pressure mean: 0.44748783111572266
loss_pred:0.018274249508976936, decouple_loss:0.002165151061490178
loss_pred:0.016933979466557503, decouple_loss:0.0020415810868144035
The generated pressure mean: 0.4455002546310425
loss_pred:0.01721455156803131, decouple_loss:0.002075939206406474
Iteration: 7525, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4547690153121948
The generated pressure mean: 0.454068660736084
loss_pred:0.018891287967562675, decouple_loss:0.0020597660914063454
loss_pred:0.018836049363017082, decouple_loss:0.002043076790869236
The generated pressure mean: 0.45128515362739563
loss_pred:0.017482571303844452, decouple_loss:0.0020524899009615183
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 7526, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4521595239639282
The generated pressure mean: 0.4515690803527832
loss_pred:0.019006183370947838, decouple_loss:0.0020119622349739075
loss_pred:0.018072575330734253, decouple_loss:0.001996859209612012
The generated pressure mean: 0.45060959458351135
loss_pred:0.016874773427844048, decouple_loss:0.0020681696478277445
Iteration: 7527, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44317394495010376
The generated pressure mean: 0.44547513127326965
loss_pred:0.017832579091191292, decouple_loss:0.0020083789713680744
loss_pred:0.01927175000309944, decouple_loss:0.0018807766027748585
The generated pressure mean: 0.4433489143848419
loss_pred:0.01704256795346737, decouple_loss:0.0019923001527786255
Iteration: 7528, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43887218832969666
The generated pressure mean: 0.43884211778640747
loss_pred:0.01927807182073593, decouple_loss:0.002380362479016185
loss_pred:0.01952444016933441, decouple_loss:0.0023200293071568012
The generated pressure mean: 0.4421248435974121
loss_pred:0.01630401983857155, decouple_loss:0.002258554333820939
Iteration: 7529, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466385245323181
The generated pressure mean: 0.4459071159362793
loss_pred:0.018249958753585815, decouple_loss:0.0026113579515367746
loss_pred:0.017024902626872063, decouple_loss:0.0026890754234045744
The generated pressure mean: 0.4430987536907196
loss_pred:0.017492489889264107, decouple_loss:0.0026373439468443394
Iteration: 7530, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4560493528842926
The generated pressure mean: 0.4524918794631958
loss_pred:0.017877543345093727, decouple_loss:0.0020612964872270823
loss_pred:0.01781657338142395, decouple_loss:0.002041113330051303
The generated pressure mean: 0.45623844861984253
loss_pred:0.017702875658869743, decouple_loss:0.001987757859751582
2023-04-17 16:02:31 testing...
The generated pressure mean: 0.4152543246746063
The generated pressure mean: 0.4224376976490021
loss_pred:0.03224572166800499, decouple_loss:0.0028783252928406
The generated pressure mean: 0.42596375942230225
loss_pred:0.031183667480945587, decouple_loss:0.003012883709743619
loss_pred:0.030854033306241035, decouple_loss:0.0032284383196383715
WV_0_PC_0_EH_1_PS_40, loss: 0.03157980367541313, avg_mse: 0.04852621257305145
current test mse: 0.048526
Iteration: 7531, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4423498809337616
loss_pred:0.016869349405169487, decouple_loss:0.002371632494032383
The generated pressure mean: 0.44366559386253357
loss_pred:0.017063423991203308, decouple_loss:0.002354318741708994
The generated pressure mean: 0.4389879107475281
loss_pred:0.018034016713500023, decouple_loss:0.0024342022370547056
Iteration: 7532, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4446589946746826
loss_pred:0.018918950110673904, decouple_loss:0.0028006131760776043
The generated pressure mean: 0.44406139850616455
loss_pred:0.018746303394436836, decouple_loss:0.0027538365684449673
The generated pressure mean: 0.4420427083969116
loss_pred:0.017890600487589836, decouple_loss:0.002745499135926366
Iteration: 7533, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504198133945465
loss_pred:0.016832076013088226, decouple_loss:0.0021333913318812847
The generated pressure mean: 0.44757163524627686
loss_pred:0.016884498298168182, decouple_loss:0.0020559881813824177
The generated pressure mean: 0.45116642117500305
loss_pred:0.01750420406460762, decouple_loss:0.0020753471180796623
Iteration: 7534, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44634199142456055
The generated pressure mean: 0.4504036605358124loss_pred:0.017870374023914337, decouple_loss:0.00246523879468441
loss_pred:0.017330288887023926, decouple_loss:0.002421322977170348
The generated pressure mean: 0.44299188256263733
loss_pred:0.017281649634242058, decouple_loss:0.0023728657979518175
Iteration: 7535, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44921717047691345
loss_pred:0.016689887270331383, decouple_loss:0.002720979740843177The generated pressure mean: 0.44832465052604675
loss_pred:0.017264066264033318, decouple_loss:0.002624141750857234
The generated pressure mean: 0.4425966143608093
loss_pred:0.017481202259659767, decouple_loss:0.0025631252210587263
Iteration: 7536, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.445629745721817
The generated pressure mean: 0.4458979368209839
loss_pred:0.017133383080363274, decouple_loss:0.0022585459519177675
loss_pred:0.017996743321418762, decouple_loss:0.0021837428212165833
The generated pressure mean: 0.44942188262939453
loss_pred:0.017397873103618622, decouple_loss:0.0020227651111781597
Iteration: 7537, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483996629714966
loss_pred:0.018226202577352524, decouple_loss:0.001882627489976585
The generated pressure mean: 0.4420619308948517
loss_pred:0.016294240951538086, decouple_loss:0.001860791933722794
The generated pressure mean: 0.4505484402179718
loss_pred:0.019556168466806412, decouple_loss:0.0018654295708984137
Iteration: 7538, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449233114719391
loss_pred:0.016603611409664154, decouple_loss:0.0017543304711580276
The generated pressure mean: 0.4415522813796997
loss_pred:0.01643856056034565, decouple_loss:0.0017009061994031072
The generated pressure mean: 0.4426141083240509
loss_pred:0.017204785719513893, decouple_loss:0.001751288422383368
Iteration: 7539, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4498712122440338
loss_pred:0.016551101580262184, decouple_loss:0.0020114011131227016
The generated pressure mean: 0.45158663392066956
loss_pred:0.017726756632328033, decouple_loss:0.0018382529960945249
The generated pressure mean: 0.45401790738105774
loss_pred:0.01697472296655178, decouple_loss:0.001935893320478499
Iteration: 7540, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44955387711524963
The generated pressure mean: 0.4457210600376129loss_pred:0.016417790204286575, decouple_loss:0.001944371615536511
loss_pred:0.016477813944220543, decouple_loss:0.002069656038656831
The generated pressure mean: 0.44953441619873047
loss_pred:0.017665453255176544, decouple_loss:0.001977929612621665
2023-04-17 16:04:25 testing...
The generated pressure mean: 0.42019766569137573
The generated pressure mean: 0.4138283133506775
The generated pressure mean: 0.42295926809310913
loss_pred:0.030351724475622177, decouple_loss:0.0027716243639588356
loss_pred:0.031265705823898315, decouple_loss:0.002642954234033823
loss_pred:0.029783667996525764, decouple_loss:0.0029246527701616287
WV_0_PC_0_EH_1_PS_40, loss: 0.030606022104620934, avg_mse: 0.04643884301185608
current test mse: 0.046439
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 7541, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463745355606079
loss_pred:0.017127489671111107, decouple_loss:0.0021899589337408543
The generated pressure mean: 0.4429417848587036
loss_pred:0.016793133690953255, decouple_loss:0.002218494890257716
The generated pressure mean: 0.44628041982650757
loss_pred:0.017279893159866333, decouple_loss:0.0020798691548407078
Iteration: 7542, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449225664138794
The generated pressure mean: 0.4398544430732727
loss_pred:0.017008109018206596, decouple_loss:0.0022294814698398113
loss_pred:0.015523809008300304, decouple_loss:0.0022006346844136715
The generated pressure mean: 0.4424479305744171
loss_pred:0.01681639440357685, decouple_loss:0.002232289407402277
Iteration: 7543, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44788625836372375
The generated pressure mean: 0.44782859086990356
loss_pred:0.01942683942615986, decouple_loss:0.0018484534230083227
loss_pred:0.01722925901412964, decouple_loss:0.0018868582556024194
The generated pressure mean: 0.4487907290458679
loss_pred:0.01874438114464283, decouple_loss:0.0019284558948129416
Iteration: 7544, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4454760253429413
The generated pressure mean: 0.4420752227306366
loss_pred:0.018137656152248383, decouple_loss:0.001967073418200016
loss_pred:0.0169557873159647, decouple_loss:0.0019095571478828788
The generated pressure mean: 0.4402365982532501
loss_pred:0.01689036563038826, decouple_loss:0.00183793343603611
Iteration: 7545, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45096731185913086
The generated pressure mean: 0.44597578048706055
loss_pred:0.018632782623171806, decouple_loss:0.0024208873510360718
loss_pred:0.017276868224143982, decouple_loss:0.002396297873929143
The generated pressure mean: 0.45617184042930603
loss_pred:0.017656825482845306, decouple_loss:0.002366796135902405
Iteration: 7546, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44480660557746887
loss_pred:0.01760459877550602, decouple_loss:0.0028397857677191496
The generated pressure mean: 0.44679945707321167
loss_pred:0.017181945964694023, decouple_loss:0.0030302361119538546
The generated pressure mean: 0.4508395791053772
loss_pred:0.017636122182011604, decouple_loss:0.0026958598755300045
Iteration: 7547, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479663372039795
The generated pressure mean: 0.448422372341156
loss_pred:0.01666875369846821, decouple_loss:0.0019988995045423508
loss_pred:0.016773497685790062, decouple_loss:0.0020799310877919197
The generated pressure mean: 0.4439927339553833
loss_pred:0.018390225246548653, decouple_loss:0.0020090232137590647
Iteration: 7548, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45452558994293213
loss_pred:0.01723557896912098, decouple_loss:0.00217483495362103
The generated pressure mean: 0.45608437061309814
loss_pred:0.01669892482459545, decouple_loss:0.0021686533000320196
The generated pressure mean: 0.4581225514411926
loss_pred:0.017702920362353325, decouple_loss:0.0021529211662709713
Iteration: 7549, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44586217403411865
loss_pred:0.016385676339268684, decouple_loss:0.002198778325691819
The generated pressure mean: 0.4461934566497803
loss_pred:0.016239866614341736, decouple_loss:0.0020930119790136814
The generated pressure mean: 0.4467448592185974
loss_pred:0.017969710752367973, decouple_loss:0.002154075540602207
Iteration: 7550, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4413014054298401
The generated pressure mean: 0.4290061295032501
loss_pred:0.017958559095859528, decouple_loss:0.0021584434434771538
loss_pred:0.01690077967941761, decouple_loss:0.002095185685902834
The generated pressure mean: 0.4367225766181946
loss_pred:0.018173590302467346, decouple_loss:0.0023190095089375973
2023-04-17 16:06:58 testing...
The generated pressure mean: 0.4124292731285095
The generated pressure mean: 0.4185987114906311
The generated pressure mean: 0.4216255247592926
loss_pred:0.03166329488158226, decouple_loss:0.002319303574040532
loss_pred:0.030920902267098427, decouple_loss:0.002445245161652565
loss_pred:0.030073627829551697, decouple_loss:0.002498421585187316
WV_0_PC_0_EH_1_PS_40, loss: 0.031006991863250732, avg_mse: 0.04717471823096275
current test mse: 0.047175
Iteration: 7551, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4522485136985779
loss_pred:0.01676054671406746, decouple_loss:0.002084586536511779
The generated pressure mean: 0.45371800661087036
loss_pred:0.018202828243374825, decouple_loss:0.001839580130763352
The generated pressure mean: 0.45252570509910583
loss_pred:0.0166021641343832, decouple_loss:0.0018648229306563735
Iteration: 7552, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.453049898147583
loss_pred:0.01794547215104103, decouple_loss:0.001874175388365984
The generated pressure mean: 0.44864755868911743
loss_pred:0.017177773639559746, decouple_loss:0.0019945900421589613
The generated pressure mean: 0.44763678312301636
loss_pred:0.020474690943956375, decouple_loss:0.0019565443508327007
Iteration: 7553, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44358330965042114
The generated pressure mean: 0.4431972801685333
loss_pred:0.01716136373579502, decouple_loss:0.0023816621396690607
loss_pred:0.01855316013097763, decouple_loss:0.0024370993487536907
The generated pressure mean: 0.4439299404621124
loss_pred:0.01847226358950138, decouple_loss:0.002426828956231475
Iteration: 7554, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473552107810974
loss_pred:0.01653493009507656, decouple_loss:0.002545172581449151
The generated pressure mean: 0.4477423429489136
loss_pred:0.017549656331539154, decouple_loss:0.0026698200963437557
The generated pressure mean: 0.4460103511810303
loss_pred:0.01735195890069008, decouple_loss:0.0027234810404479504
Iteration: 7555, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471832513809204
loss_pred:0.015946978703141212, decouple_loss:0.002112302230671048
The generated pressure mean: 0.4509938657283783
loss_pred:0.018402982503175735, decouple_loss:0.002102221129462123
The generated pressure mean: 0.45054495334625244
loss_pred:0.017599331215023994, decouple_loss:0.00202598562464118
Iteration: 7556, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45280349254608154
The generated pressure mean: 0.4456161558628082
loss_pred:0.017733832821249962, decouple_loss:0.0022255186922848225
loss_pred:0.018174350261688232, decouple_loss:0.0022527649998664856
The generated pressure mean: 0.44517216086387634
loss_pred:0.01694200560450554, decouple_loss:0.0022194371558725834
Iteration: 7557, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45348191261291504
loss_pred:0.016232995316386223, decouple_loss:0.002625899389386177
The generated pressure mean: 0.45387715101242065
loss_pred:0.01756463013589382, decouple_loss:0.0026121572591364384
The generated pressure mean: 0.4516752064228058
loss_pred:0.017114628106355667, decouple_loss:0.002299410291016102
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 7558, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4410124719142914
The generated pressure mean: 0.44048964977264404
loss_pred:0.0187004953622818, decouple_loss:0.002583525376394391
loss_pred:0.017425378784537315, decouple_loss:0.0026796211022883654
The generated pressure mean: 0.44516438245773315
loss_pred:0.01807764358818531, decouple_loss:0.002470841398462653
Iteration: 7559, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43686601519584656
The generated pressure mean: 0.4391672909259796
loss_pred:0.01756829023361206, decouple_loss:0.002159101190045476
loss_pred:0.01741701550781727, decouple_loss:0.0022429993841797113
The generated pressure mean: 0.4372270703315735
loss_pred:0.01827150024473667, decouple_loss:0.002211546991020441
Iteration: 7560, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45735546946525574
The generated pressure mean: 0.45313364267349243
loss_pred:0.0181047935038805, decouple_loss:0.002055945573374629
loss_pred:0.017081551253795624, decouple_loss:0.0021122365724295378
The generated pressure mean: 0.4586980640888214
loss_pred:0.01859436184167862, decouple_loss:0.002087820554152131
2023-04-17 16:08:51 testing...
The generated pressure mean: 0.41939952969551086
The generated pressure mean: 0.4132464826107025
The generated pressure mean: 0.42225947976112366
loss_pred:0.03042823262512684, decouple_loss:0.002976651070639491
loss_pred:0.031459879130125046, decouple_loss:0.002869959222152829
loss_pred:0.030107587575912476, decouple_loss:0.003094824030995369
WV_0_PC_0_EH_1_PS_40, loss: 0.030814258381724358, avg_mse: 0.046856578439474106
current test mse: 0.046857
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 7561, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4414648413658142
loss_pred:0.016810577362775803, decouple_loss:0.0027002831920981407
The generated pressure mean: 0.44567155838012695
loss_pred:0.017670122906565666, decouple_loss:0.0024936795234680176
The generated pressure mean: 0.44416606426239014
loss_pred:0.016949279233813286, decouple_loss:0.0026565720327198505
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 7562, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44508108496665955
loss_pred:0.016476446762681007, decouple_loss:0.002257549436762929
The generated pressure mean: 0.448100209236145
loss_pred:0.01695999689400196, decouple_loss:0.0021772056352347136
The generated pressure mean: 0.44402724504470825
loss_pred:0.01681307516992092, decouple_loss:0.002171360654756427
Iteration: 7563, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45310646295547485
The generated pressure mean: 0.44566935300827026
loss_pred:0.017523150891065598, decouple_loss:0.0023299907334148884
loss_pred:0.01768755167722702, decouple_loss:0.0022936721798032522
The generated pressure mean: 0.44501596689224243
loss_pred:0.01697838306427002, decouple_loss:0.0023553799837827682
Iteration: 7564, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44757381081581116
The generated pressure mean: 0.44053947925567627
loss_pred:0.01700124889612198, decouple_loss:0.0021383999846875668
loss_pred:0.016799326986074448, decouple_loss:0.0022162615787237883
The generated pressure mean: 0.4431069493293762
loss_pred:0.018861133605241776, decouple_loss:0.0021965275518596172
Iteration: 7565, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44804835319519043
The generated pressure mean: 0.44920721650123596
loss_pred:0.01869092881679535, decouple_loss:0.0024007221218198538
loss_pred:0.01714327745139599, decouple_loss:0.002332583535462618
The generated pressure mean: 0.4527980387210846
loss_pred:0.016713257879018784, decouple_loss:0.0023096264339983463
Iteration: 7566, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461010992527008
The generated pressure mean: 0.44408878684043884
loss_pred:0.016120517626404762, decouple_loss:0.002688145963475108
loss_pred:0.016396453604102135, decouple_loss:0.002439746167510748
The generated pressure mean: 0.4395608603954315
loss_pred:0.016102543100714684, decouple_loss:0.0025244439020752907
Iteration: 7567, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4372718632221222
The generated pressure mean: 0.44195127487182617
loss_pred:0.017422836273908615, decouple_loss:0.0021207930985838175
loss_pred:0.019005492329597473, decouple_loss:0.0021606897935271263
The generated pressure mean: 0.4420202970504761
loss_pred:0.01634795591235161, decouple_loss:0.0021031536161899567
Iteration: 7568, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503615200519562
The generated pressure mean: 0.4578454792499542
loss_pred:0.016643451526761055, decouple_loss:0.0023169906344264746
loss_pred:0.01964990608394146, decouple_loss:0.0023213038221001625
The generated pressure mean: 0.45273739099502563
loss_pred:0.017063215374946594, decouple_loss:0.002350413706153631
Iteration: 7569, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44098544120788574
The generated pressure mean: 0.4474472403526306
loss_pred:0.01739714853465557, decouple_loss:0.0023228817153722048
loss_pred:0.015754099935293198, decouple_loss:0.002414883580058813
The generated pressure mean: 0.4415406286716461
loss_pred:0.016878848895430565, decouple_loss:0.0025048344396054745
Iteration: 7570, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44400522112846375
The generated pressure mean: 0.44735702872276306
loss_pred:0.017328986898064613, decouple_loss:0.0019815980922430754
loss_pred:0.01650000922381878, decouple_loss:0.0020042762625962496
The generated pressure mean: 0.4391714334487915
loss_pred:0.017045684158802032, decouple_loss:0.002134277019649744
2023-04-17 16:11:25 testing...
The generated pressure mean: 0.4144403636455536
The generated pressure mean: 0.42186403274536133
The generated pressure mean: 0.42493921518325806
loss_pred:0.03183978423476219, decouple_loss:0.002511050319299102
loss_pred:0.030884865671396255, decouple_loss:0.0027108206413686275
loss_pred:0.030087577179074287, decouple_loss:0.0026763107161968946
WV_0_PC_0_EH_1_PS_40, loss: 0.031069045886397362, avg_mse: 0.0473848395049572
current test mse: 0.047385
Iteration: 7571, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44206979870796204
The generated pressure mean: 0.44873467087745667
loss_pred:0.01847473718225956, decouple_loss:0.0020613721571862698
loss_pred:0.01780196838080883, decouple_loss:0.0019995879847556353
The generated pressure mean: 0.44595739245414734
loss_pred:0.017786266282200813, decouple_loss:0.0020002201199531555
Iteration: 7572, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44336798787117004
The generated pressure mean: 0.44470882415771484
loss_pred:0.016829228028655052, decouple_loss:0.002203728072345257
loss_pred:0.017899682745337486, decouple_loss:0.0020986017771065235
The generated pressure mean: 0.44010865688323975
loss_pred:0.01646796613931656, decouple_loss:0.002178672468289733
Iteration: 7573, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44810721278190613
The generated pressure mean: 0.44915637373924255
loss_pred:0.015498831868171692, decouple_loss:0.0020275593269616365
loss_pred:0.017878932878375053, decouple_loss:0.0020250293891876936
The generated pressure mean: 0.4534452259540558
loss_pred:0.016938798129558563, decouple_loss:0.0019502724753692746
Iteration: 7574, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464930593967438
The generated pressure mean: 0.45503124594688416
loss_pred:0.016623329371213913, decouple_loss:0.002376784570515156
loss_pred:0.017535453662276268, decouple_loss:0.0025174119509756565
The generated pressure mean: 0.44952982664108276
loss_pred:0.018247123807668686, decouple_loss:0.0025392549578100443
Iteration: 7575, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44193047285079956The generated pressure mean: 0.4415096640586853
loss_pred:0.018281137570738792, decouple_loss:0.0022759493440389633
loss_pred:0.01705290749669075, decouple_loss:0.0022509191185235977
The generated pressure mean: 0.4446522891521454
loss_pred:0.01749727688729763, decouple_loss:0.002218229230493307
Iteration: 7576, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44269290566444397
The generated pressure mean: 0.445100337266922
loss_pred:0.015667695552110672, decouple_loss:0.0018997597508132458
loss_pred:0.01761159673333168, decouple_loss:0.002057978417724371
The generated pressure mean: 0.44247978925704956
loss_pred:0.016557984054088593, decouple_loss:0.0021150168031454086
Iteration: 7577, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45288631319999695
The generated pressure mean: 0.45404428243637085
loss_pred:0.01621350087225437, decouple_loss:0.002576255239546299
loss_pred:0.01632990688085556, decouple_loss:0.002513736952096224
The generated pressure mean: 0.4528253674507141
loss_pred:0.016780663281679153, decouple_loss:0.0024456768296658993
Iteration: 7578, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4524201452732086
The generated pressure mean: 0.4492756128311157
loss_pred:0.016158096492290497, decouple_loss:0.002263908041641116
loss_pred:0.017899740487337112, decouple_loss:0.002305554458871484
The generated pressure mean: 0.44698360562324524
loss_pred:0.01849210448563099, decouple_loss:0.0022873671259731054
Iteration: 7579, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44160401821136475
loss_pred:0.016282930970191956, decouple_loss:0.0018984145717695355
The generated pressure mean: 0.44050532579421997
loss_pred:0.019027473405003548, decouple_loss:0.0019023315981030464
The generated pressure mean: 0.4423135221004486
loss_pred:0.01751236617565155, decouple_loss:0.0019641786348074675
Iteration: 7580, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4441591203212738
The generated pressure mean: 0.44396311044692993
loss_pred:0.01672017015516758, decouple_loss:0.002766815247014165
loss_pred:0.01725964993238449, decouple_loss:0.002729214495047927
The generated pressure mean: 0.4379262924194336
loss_pred:0.017079178243875504, decouple_loss:0.0027814710047096014
2023-04-17 16:13:19 testing...
The generated pressure mean: 0.4122947156429291
The generated pressure mean: 0.41875144839286804
The generated pressure mean: 0.4218910336494446
loss_pred:0.03169970214366913, decouple_loss:0.0028736095409840345
loss_pred:0.030796648934483528, decouple_loss:0.002964105224236846
loss_pred:0.030223406851291656, decouple_loss:0.003079975489526987
WV_0_PC_0_EH_1_PS_40, loss: 0.031055215746164322, avg_mse: 0.04742875322699547
current test mse: 0.047429
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 7581, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45220455527305603
loss_pred:0.017475970089435577, decouple_loss:0.0025543083902448416
The generated pressure mean: 0.44688042998313904
loss_pred:0.01849362999200821, decouple_loss:0.0024508172646164894
The generated pressure mean: 0.44719287753105164
loss_pred:0.01793631911277771, decouple_loss:0.0024297493509948254
Iteration: 7582, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44927945733070374
The generated pressure mean: 0.4458014965057373
loss_pred:0.01757834292948246, decouple_loss:0.0019521464128047228
loss_pred:0.018208105117082596, decouple_loss:0.0020751706324517727
The generated pressure mean: 0.45187854766845703
loss_pred:0.018999900668859482, decouple_loss:0.0019906009547412395
Iteration: 7583, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44315022230148315
The generated pressure mean: 0.44723397493362427
loss_pred:0.01683361642062664, decouple_loss:0.002419845899567008
loss_pred:0.018007665872573853, decouple_loss:0.0023708997759968042
The generated pressure mean: 0.44655275344848633
loss_pred:0.017518380656838417, decouple_loss:0.0023966634180396795
Iteration: 7584, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44411879777908325The generated pressure mean: 0.45145851373672485
loss_pred:0.017187949270009995, decouple_loss:0.0026934421621263027loss_pred:0.017544642090797424, decouple_loss:0.002455497859045863
The generated pressure mean: 0.4521506130695343
loss_pred:0.01822160743176937, decouple_loss:0.002576329978182912
Iteration: 7585, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484347999095917
The generated pressure mean: 0.4510090947151184
loss_pred:0.019614888355135918, decouple_loss:0.0021382539998739958
loss_pred:0.018382277339696884, decouple_loss:0.0022001799661666155
The generated pressure mean: 0.44554638862609863
loss_pred:0.018735341727733612, decouple_loss:0.002076158532872796
Iteration: 7586, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45039495825767517
The generated pressure mean: 0.4458554983139038
loss_pred:0.018819013610482216, decouple_loss:0.002315767342224717
loss_pred:0.019762659445405006, decouple_loss:0.0022557592019438744
The generated pressure mean: 0.44591304659843445
loss_pred:0.017084116116166115, decouple_loss:0.0021196657326072454
Iteration: 7587, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43948861956596375The generated pressure mean: 0.43945857882499695
loss_pred:0.016877328976988792, decouple_loss:0.002135833026841283
loss_pred:0.019142605364322662, decouple_loss:0.0021602718625217676
The generated pressure mean: 0.43548235297203064
loss_pred:0.01733475551009178, decouple_loss:0.0021707951091229916
Iteration: 7588, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447618305683136
loss_pred:0.019304927438497543, decouple_loss:0.0023905548732727766
The generated pressure mean: 0.44149425625801086
loss_pred:0.017413455992937088, decouple_loss:0.002344011329114437
The generated pressure mean: 0.44731730222702026
loss_pred:0.017908597365021706, decouple_loss:0.0024063612800091505
Iteration: 7589, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495668411254883
loss_pred:0.019118284806609154, decouple_loss:0.0021156722214072943
The generated pressure mean: 0.4461073577404022
loss_pred:0.017175450921058655, decouple_loss:0.0022263152059167624
The generated pressure mean: 0.4481942057609558
loss_pred:0.01743757165968418, decouple_loss:0.0021268134005367756
Iteration: 7590, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45781004428863525
loss_pred:0.018861083313822746, decouple_loss:0.002282456960529089
The generated pressure mean: 0.44706642627716064
loss_pred:0.017609653994441032, decouple_loss:0.002267670352011919
The generated pressure mean: 0.45251092314720154
loss_pred:0.019019871950149536, decouple_loss:0.0022641688119620085
2023-04-17 16:15:49 testing...
The generated pressure mean: 0.4117991030216217
The generated pressure mean: 0.41863852739334106
loss_pred:0.032545216381549835, decouple_loss:0.0028811318334192038
The generated pressure mean: 0.42221522331237793
loss_pred:0.031500715762376785, decouple_loss:0.0030096331611275673
loss_pred:0.03073914162814617, decouple_loss:0.0030962619930505753
WV_0_PC_0_EH_1_PS_40, loss: 0.031744807958602905, avg_mse: 0.04891723394393921
current test mse: 0.048917
Iteration: 7591, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4515880048274994
The generated pressure mean: 0.45166730880737305
loss_pred:0.020383251830935478, decouple_loss:0.002506774151697755
loss_pred:0.017974674701690674, decouple_loss:0.0023935975041240454
The generated pressure mean: 0.451925665140152
loss_pred:0.017870696261525154, decouple_loss:0.0022346973419189453
Iteration: 7592, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469101130962372
The generated pressure mean: 0.435067743062973
loss_pred:0.019389133900403976, decouple_loss:0.0024916285183280706
loss_pred:0.018402157351374626, decouple_loss:0.002303735353052616
The generated pressure mean: 0.4412580132484436
loss_pred:0.018759556114673615, decouple_loss:0.0021085948683321476
Iteration: 7593, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4398479461669922
loss_pred:0.019146131351590157, decouple_loss:0.0021195027511566877
The generated pressure mean: 0.4400676488876343
loss_pred:0.01820370927453041, decouple_loss:0.0020667321514338255
The generated pressure mean: 0.4401476979255676
loss_pred:0.01769799366593361, decouple_loss:0.0022140226792544127
Iteration: 7594, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4502295255661011
The generated pressure mean: 0.45233312249183655
loss_pred:0.018433619290590286, decouple_loss:0.0021124316845089197
loss_pred:0.020410483703017235, decouple_loss:0.0023307560477405787
The generated pressure mean: 0.45736396312713623
loss_pred:0.018394170328974724, decouple_loss:0.00219716876745224
Iteration: 7595, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4405409097671509
The generated pressure mean: 0.4384201169013977
loss_pred:0.020886309444904327, decouple_loss:0.002298385836184025
loss_pred:0.01843440905213356, decouple_loss:0.002323749242350459
The generated pressure mean: 0.44325950741767883
loss_pred:0.01825266145169735, decouple_loss:0.002261352026835084
Iteration: 7596, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45445355772972107
The generated pressure mean: 0.45126721262931824
loss_pred:0.018220309168100357, decouple_loss:0.0023428660351783037
loss_pred:0.0189225897192955, decouple_loss:0.002258840948343277
The generated pressure mean: 0.45365336537361145
loss_pred:0.018120240420103073, decouple_loss:0.002285926602780819
Iteration: 7597, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484817087650299
The generated pressure mean: 0.44708284735679626
loss_pred:0.018010705709457397, decouple_loss:0.002398134209215641
loss_pred:0.016922032460570335, decouple_loss:0.0022809477522969246
The generated pressure mean: 0.4517482817173004
loss_pred:0.018622374162077904, decouple_loss:0.002287164330482483
Iteration: 7598, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43636295199394226
loss_pred:0.01897754892706871, decouple_loss:0.0022964393720030785
The generated pressure mean: 0.44501757621765137
loss_pred:0.018225552514195442, decouple_loss:0.0023055037017911673
The generated pressure mean: 0.44627514481544495
loss_pred:0.01825718767940998, decouple_loss:0.002305616857483983
Iteration: 7599, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44181668758392334
The generated pressure mean: 0.4453144967556
loss_pred:0.016269143670797348, decouple_loss:0.0022113339509814978
loss_pred:0.017480194568634033, decouple_loss:0.0022437970619648695
The generated pressure mean: 0.4401300251483917
loss_pred:0.018201952800154686, decouple_loss:0.0022937923204153776
Iteration: 7600, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4533788561820984
loss_pred:0.017592275515198708, decouple_loss:0.0021816305816173553
The generated pressure mean: 0.4567989110946655
loss_pred:0.01789233088493347, decouple_loss:0.002288258634507656
The generated pressure mean: 0.4540143609046936
loss_pred:0.015869397670030594, decouple_loss:0.0021814554929733276
2023-04-17 16:17:42 testing...
The generated pressure mean: 0.413483589887619
The generated pressure mean: 0.4201173782348633
loss_pred:0.03257724270224571, decouple_loss:0.0025316248647868633
The generated pressure mean: 0.42334818840026855
loss_pred:0.031071623787283897, decouple_loss:0.0027206926606595516
loss_pred:0.030311767011880875, decouple_loss:0.0027700522914528847
WV_0_PC_0_EH_1_PS_40, loss: 0.03145391866564751, avg_mse: 0.04813634231686592
current test mse: 0.048136
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 7601, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4454064965248108
loss_pred:0.018309760838747025, decouple_loss:0.002019373467192054
The generated pressure mean: 0.4469141960144043
loss_pred:0.018219908699393272, decouple_loss:0.0020229793153703213
The generated pressure mean: 0.44761940836906433
loss_pred:0.01795729622244835, decouple_loss:0.0021284909453243017
Iteration: 7602, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4394080936908722
The generated pressure mean: 0.44141772389411926
loss_pred:0.017672328278422356, decouple_loss:0.002140453550964594
loss_pred:0.016778284683823586, decouple_loss:0.0021004625596106052
The generated pressure mean: 0.4452782869338989
loss_pred:0.01809348724782467, decouple_loss:0.002121269004419446
Iteration: 7603, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494915306568146
loss_pred:0.01893947646021843, decouple_loss:0.0024792326148599386
The generated pressure mean: 0.4519634246826172
loss_pred:0.017436321824789047, decouple_loss:0.0023873928003013134
The generated pressure mean: 0.45119041204452515
loss_pred:0.017920318990945816, decouple_loss:0.0023247008211910725
Iteration: 7604, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4429965913295746
The generated pressure mean: 0.44523462653160095
loss_pred:0.016845250502228737, decouple_loss:0.0023793731816112995
loss_pred:0.016032179817557335, decouple_loss:0.0023252354003489017
The generated pressure mean: 0.44495847821235657
loss_pred:0.017440248280763626, decouple_loss:0.002279451582580805
Iteration: 7605, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4434545934200287
The generated pressure mean: 0.4449298679828644
loss_pred:0.018583806231617928, decouple_loss:0.0025089927949011326
loss_pred:0.018064359202980995, decouple_loss:0.002532681217417121
The generated pressure mean: 0.43938136100769043
loss_pred:0.016764691099524498, decouple_loss:0.002494139363989234
Iteration: 7606, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44915780425071716
The generated pressure mean: 0.4485571086406708
loss_pred:0.018013082444667816, decouple_loss:0.0023592710494995117
loss_pred:0.01724052242934704, decouple_loss:0.0023839676287025213
The generated pressure mean: 0.4475204646587372
loss_pred:0.019887084141373634, decouple_loss:0.0023996804375201464
Iteration: 7607, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45030537247657776
The generated pressure mean: 0.4509488344192505
loss_pred:0.017392471432685852, decouple_loss:0.0023486868012696505
loss_pred:0.01843928173184395, decouple_loss:0.002338286954909563
The generated pressure mean: 0.4529235064983368
loss_pred:0.01683013327419758, decouple_loss:0.0025274273939430714
Iteration: 7608, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44668513536453247
The generated pressure mean: 0.4449755549430847
loss_pred:0.017932111397385597, decouple_loss:0.002711829962208867
loss_pred:0.01828049123287201, decouple_loss:0.002522527240216732
The generated pressure mean: 0.4428275227546692
loss_pred:0.018482888117432594, decouple_loss:0.002615136792883277
Iteration: 7609, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4417804777622223
The generated pressure mean: 0.44056469202041626
loss_pred:0.017543306574225426, decouple_loss:0.0026908433064818382
loss_pred:0.01827809028327465, decouple_loss:0.002642486710101366
The generated pressure mean: 0.4380687177181244
loss_pred:0.017254559323191643, decouple_loss:0.002554868347942829
Iteration: 7610, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467582106590271
The generated pressure mean: 0.4490654170513153
loss_pred:0.018466826528310776, decouple_loss:0.0023585159797221422
loss_pred:0.020006081089377403, decouple_loss:0.002483868505805731
The generated pressure mean: 0.4451697766780853
loss_pred:0.017805524170398712, decouple_loss:0.002461386611685157
2023-04-17 16:20:13 testing...
The generated pressure mean: 0.4133027493953705
The generated pressure mean: 0.4200471043586731
The generated pressure mean: 0.42329323291778564
loss_pred:0.03176486864686012, decouple_loss:0.0028945847880095243
loss_pred:0.030791183933615685, decouple_loss:0.0030623446218669415
loss_pred:0.03036276064813137, decouple_loss:0.0031320531852543354
WV_0_PC_0_EH_1_PS_40, loss: 0.03112442046403885, avg_mse: 0.04758831113576889
current test mse: 0.047588
Iteration: 7611, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44713154435157776
The generated pressure mean: 0.44448772072792053
loss_pred:0.016626369208097458, decouple_loss:0.002631364157423377
loss_pred:0.015916993841528893, decouple_loss:0.0024936432018876076
The generated pressure mean: 0.4493843615055084
loss_pred:0.01819172315299511, decouple_loss:0.0024193311110138893
Iteration: 7612, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45420247316360474
The generated pressure mean: 0.4485361874103546
loss_pred:0.016542132943868637, decouple_loss:0.0021870548371225595
loss_pred:0.01660321094095707, decouple_loss:0.0022063590586185455
The generated pressure mean: 0.45100635290145874
loss_pred:0.018150055781006813, decouple_loss:0.0023425694089382887
Iteration: 7613, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461182951927185
The generated pressure mean: 0.4478212296962738
loss_pred:0.017747556790709496, decouple_loss:0.0022515172604471445
loss_pred:0.016709959134459496, decouple_loss:0.002402384066954255
The generated pressure mean: 0.44717302918434143
loss_pred:0.016690243035554886, decouple_loss:0.0022834232077002525
Iteration: 7614, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43666449189186096
The generated pressure mean: 0.4358292520046234
loss_pred:0.017650548368692398, decouple_loss:0.0022469961550086737
loss_pred:0.016954662278294563, decouple_loss:0.00224879989400506
The generated pressure mean: 0.4390013515949249
loss_pred:0.01601272262632847, decouple_loss:0.0022523885127156973
Iteration: 7615, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508303105831146
loss_pred:0.01769760064780712, decouple_loss:0.002076747128739953
The generated pressure mean: 0.44774529337882996
loss_pred:0.017344307154417038, decouple_loss:0.002172239823266864
The generated pressure mean: 0.44323065876960754
loss_pred:0.018116461113095284, decouple_loss:0.002062591491267085
Iteration: 7616, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45413345098495483
loss_pred:0.01881726086139679, decouple_loss:0.0021331594325602055
The generated pressure mean: 0.45000195503234863
loss_pred:0.016933796927332878, decouple_loss:0.0022531815338879824
The generated pressure mean: 0.45640161633491516
loss_pred:0.01784716732800007, decouple_loss:0.002218844834715128
Iteration: 7617, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4430294632911682
The generated pressure mean: 0.4392174780368805
loss_pred:0.01782008446753025, decouple_loss:0.002280401298776269
loss_pred:0.01696394756436348, decouple_loss:0.002292633056640625
The generated pressure mean: 0.4401882290840149
loss_pred:0.018238071352243423, decouple_loss:0.0022724997252225876
Iteration: 7618, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4409976899623871
loss_pred:0.017245104536414146, decouple_loss:0.0022633729968219995
The generated pressure mean: 0.4471079707145691
loss_pred:0.016286412253975868, decouple_loss:0.0022057986352592707
The generated pressure mean: 0.4419056177139282
loss_pred:0.017455510795116425, decouple_loss:0.002323207212612033
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 7619, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.451407790184021
loss_pred:0.01781296357512474, decouple_loss:0.0026490662712603807
The generated pressure mean: 0.45161011815071106
loss_pred:0.017007561400532722, decouple_loss:0.002716867718845606
The generated pressure mean: 0.45200732350349426
loss_pred:0.016714386641979218, decouple_loss:0.002570795128121972
Iteration: 7620, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44666096568107605
The generated pressure mean: 0.4435688555240631
loss_pred:0.01777058281004429, decouple_loss:0.0020732430275529623
loss_pred:0.016444912180304527, decouple_loss:0.0020822007209062576
The generated pressure mean: 0.44650694727897644
loss_pred:0.019786009564995766, decouple_loss:0.0021193483844399452
2023-04-17 16:22:06 testing...
The generated pressure mean: 0.4145520329475403
The generated pressure mean: 0.4211622476577759
The generated pressure mean: 0.42420658469200134
loss_pred:0.030923085287213326, decouple_loss:0.002630649134516716
loss_pred:0.03039403446018696, decouple_loss:0.0028659298550337553
loss_pred:0.02926785871386528, decouple_loss:0.0028875861316919327
WV_0_PC_0_EH_1_PS_40, loss: 0.030334729701280594, avg_mse: 0.046400729566812515
current test mse: 0.046401
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 7621, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4387800693511963
loss_pred:0.018150117248296738, decouple_loss:0.002189453924074769
The generated pressure mean: 0.44168412685394287
loss_pred:0.01729532703757286, decouple_loss:0.0022577173076570034
The generated pressure mean: 0.4396009147167206
loss_pred:0.0172316562384367, decouple_loss:0.0021622951608151197
Iteration: 7622, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4519316554069519
The generated pressure mean: 0.4516925513744354
loss_pred:0.020067248493433, decouple_loss:0.0019863927736878395
loss_pred:0.018224267289042473, decouple_loss:0.0020198747515678406
The generated pressure mean: 0.44970405101776123
loss_pred:0.01790844090282917, decouple_loss:0.0019693756476044655
Iteration: 7623, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44456934928894043
The generated pressure mean: 0.43988174200057983
loss_pred:0.017216302454471588, decouple_loss:0.002067807363346219
loss_pred:0.01690489985048771, decouple_loss:0.002224091673269868
The generated pressure mean: 0.4415111243724823
loss_pred:0.017671668902039528, decouple_loss:0.0020033572800457478
Iteration: 7624, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447299599647522
The generated pressure mean: 0.448612779378891
loss_pred:0.018673794344067574, decouple_loss:0.00220588780939579
loss_pred:0.018090808764100075, decouple_loss:0.002155511872842908
The generated pressure mean: 0.4497421681880951
loss_pred:0.016967061907052994, decouple_loss:0.002139980671927333
Iteration: 7625, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480004906654358The generated pressure mean: 0.4548764228820801
loss_pred:0.017555858939886093, decouple_loss:0.0019826204515993595
loss_pred:0.016682807356119156, decouple_loss:0.0021019140258431435
The generated pressure mean: 0.4544433057308197
loss_pred:0.019118383526802063, decouple_loss:0.002060356317088008
Iteration: 7626, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44239625334739685
The generated pressure mean: 0.4446919858455658
loss_pred:0.016745341941714287, decouple_loss:0.0019840174354612827
loss_pred:0.018187329173088074, decouple_loss:0.00206482014618814
The generated pressure mean: 0.44093015789985657
loss_pred:0.016850847750902176, decouple_loss:0.0021102214232087135
Iteration: 7627, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4395952522754669
The generated pressure mean: 0.4397459626197815
loss_pred:0.020688943564891815, decouple_loss:0.0025009603705257177
loss_pred:0.01842440664768219, decouple_loss:0.0025334262754768133
The generated pressure mean: 0.4420372247695923
loss_pred:0.01672547683119774, decouple_loss:0.002583791734650731
Iteration: 7628, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45144179463386536
The generated pressure mean: 0.45116689801216125
loss_pred:0.016283852979540825, decouple_loss:0.0023967300076037645
loss_pred:0.017317146062850952, decouple_loss:0.0023239776492118835
The generated pressure mean: 0.4552849233150482
loss_pred:0.01846429891884327, decouple_loss:0.002328319940716028
Iteration: 7629, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45799776911735535
loss_pred:0.017525536939501762, decouple_loss:0.0022813105024397373
The generated pressure mean: 0.4536714255809784
loss_pred:0.017935294657945633, decouple_loss:0.002186140511184931
The generated pressure mean: 0.4516346752643585
loss_pred:0.01785796880722046, decouple_loss:0.0023028587456792593
Iteration: 7630, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44658857583999634
loss_pred:0.018378829583525658, decouple_loss:0.0024376779329031706
The generated pressure mean: 0.44591039419174194
loss_pred:0.017746640369296074, decouple_loss:0.0024118071887642145
The generated pressure mean: 0.4416011869907379
loss_pred:0.017119403928518295, decouple_loss:0.0025168166030198336
2023-04-17 16:24:36 testing...
The generated pressure mean: 0.4143581688404083
The generated pressure mean: 0.42071226239204407
The generated pressure mean: 0.42319273948669434
loss_pred:0.03299317881464958, decouple_loss:0.0027909097261726856
loss_pred:0.03188193216919899, decouple_loss:0.0029573661740869284
loss_pred:0.03134560585021973, decouple_loss:0.003060850314795971
WV_0_PC_0_EH_1_PS_40, loss: 0.03222039341926575, avg_mse: 0.04923921450972557
current test mse: 0.049239
Iteration: 7631, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.442257285118103
The generated pressure mean: 0.4399430453777313
loss_pred:0.0167374350130558, decouple_loss:0.002223382471129298
loss_pred:0.019502975046634674, decouple_loss:0.0022157449275255203
The generated pressure mean: 0.4420730173587799
loss_pred:0.017086023464798927, decouple_loss:0.002183326054364443
Iteration: 7632, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45231154561042786
The generated pressure mean: 0.4523056447505951
loss_pred:0.018601713702082634, decouple_loss:0.002072172472253442
loss_pred:0.01684381440281868, decouple_loss:0.0020315642468631268
The generated pressure mean: 0.45030078291893005
loss_pred:0.01873013563454151, decouple_loss:0.0020049114245921373
Iteration: 7633, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4582674205303192
The generated pressure mean: 0.45432206988334656
loss_pred:0.017090126872062683, decouple_loss:0.002060167957097292
loss_pred:0.01730298437178135, decouple_loss:0.0021642602514475584
The generated pressure mean: 0.4548443853855133
loss_pred:0.017344044521450996, decouple_loss:0.0022202380932867527
Iteration: 7634, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43939611315727234
loss_pred:0.018096650019288063, decouple_loss:0.0022091795690357685
The generated pressure mean: 0.4407157897949219
loss_pred:0.017275681719183922, decouple_loss:0.0022513368166983128
The generated pressure mean: 0.4388183057308197
loss_pred:0.018182557076215744, decouple_loss:0.0021308695431798697
Iteration: 7635, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44460529088974
loss_pred:0.017830662429332733, decouple_loss:0.0021098728757351637
The generated pressure mean: 0.4412546157836914
loss_pred:0.018870456144213676, decouple_loss:0.0021403690334409475
The generated pressure mean: 0.44416359066963196
loss_pred:0.01711484231054783, decouple_loss:0.0021020355634391308
Iteration: 7636, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45439717173576355
loss_pred:0.017168166115880013, decouple_loss:0.0020986180752515793
The generated pressure mean: 0.45508381724357605
loss_pred:0.016826946288347244, decouple_loss:0.002090511843562126
The generated pressure mean: 0.4533933401107788
loss_pred:0.018849927932024002, decouple_loss:0.002117541152983904
Iteration: 7637, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4458398222923279
The generated pressure mean: 0.4447830617427826
loss_pred:0.016456900164484978, decouple_loss:0.0025124826934188604
loss_pred:0.018596790730953217, decouple_loss:0.0025547475088387728
The generated pressure mean: 0.4489152431488037
loss_pred:0.0177448783069849, decouple_loss:0.002595566911622882
Iteration: 7638, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484681189060211
loss_pred:0.017599135637283325, decouple_loss:0.0026091376785188913
The generated pressure mean: 0.4470217823982239
loss_pred:0.0178822111338377, decouple_loss:0.0026546716690063477
The generated pressure mean: 0.45085519552230835
loss_pred:0.016981536522507668, decouple_loss:0.002519587753340602
Iteration: 7639, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44932684302330017
loss_pred:0.020489206537604332, decouple_loss:0.00205851998180151
The generated pressure mean: 0.44709694385528564
loss_pred:0.01882142573595047, decouple_loss:0.001974285813048482
The generated pressure mean: 0.4467197358608246
loss_pred:0.0168030746281147, decouple_loss:0.0019628615118563175
Iteration: 7640, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43577858805656433
The generated pressure mean: 0.43970632553100586
loss_pred:0.017006637528538704, decouple_loss:0.0022044843062758446
loss_pred:0.017876144498586655, decouple_loss:0.002107920590788126
The generated pressure mean: 0.44154083728790283
loss_pred:0.016811486333608627, decouple_loss:0.002140976721420884
2023-04-17 16:26:30 testing...
The generated pressure mean: 0.41853588819503784
The generated pressure mean: 0.4118865728378296
The generated pressure mean: 0.4215482175350189
loss_pred:0.0323244072496891, decouple_loss:0.0030575203709304333
loss_pred:0.03297659009695053, decouple_loss:0.002878723433241248
loss_pred:0.03159429877996445, decouple_loss:0.003208103124052286
WV_0_PC_0_EH_1_PS_40, loss: 0.0324508398771286, avg_mse: 0.05010625347495079
current test mse: 0.050106
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 7641, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4534284174442291
loss_pred:0.017307136207818985, decouple_loss:0.0023393139708787203
The generated pressure mean: 0.4569353461265564
loss_pred:0.017547501251101494, decouple_loss:0.00219817110337317
The generated pressure mean: 0.45470306277275085
loss_pred:0.01728459820151329, decouple_loss:0.0022884374484419823
Iteration: 7642, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45108526945114136
The generated pressure mean: 0.4467596113681793
loss_pred:0.016176430508494377, decouple_loss:0.0022195279598236084
loss_pred:0.017135564237833023, decouple_loss:0.0022795742843300104
The generated pressure mean: 0.44877952337265015
loss_pred:0.01869978755712509, decouple_loss:0.0021936718840152025
Iteration: 7643, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4358547329902649
loss_pred:0.01618247479200363, decouple_loss:0.002143512712791562
The generated pressure mean: 0.43787193298339844
loss_pred:0.01764925941824913, decouple_loss:0.0020902666728943586
The generated pressure mean: 0.4393119812011719
loss_pred:0.017533911392092705, decouple_loss:0.002022284083068371
Iteration: 7644, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45074889063835144
The generated pressure mean: 0.44598832726478577
loss_pred:0.017601946368813515, decouple_loss:0.002184546086937189
loss_pred:0.01576523669064045, decouple_loss:0.002137779723852873
The generated pressure mean: 0.4447324275970459
loss_pred:0.017078358680009842, decouple_loss:0.0022997288033366203
Iteration: 7645, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485132694244385
loss_pred:0.017349254339933395, decouple_loss:0.002026887144893408
The generated pressure mean: 0.45091986656188965
loss_pred:0.01762947253882885, decouple_loss:0.001964709023013711
The generated pressure mean: 0.45337119698524475
loss_pred:0.016277838498353958, decouple_loss:0.0020079996902495623
Iteration: 7646, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483362138271332
loss_pred:0.018095454201102257, decouple_loss:0.0022244013380259275
The generated pressure mean: 0.44906187057495117
loss_pred:0.017523394897580147, decouple_loss:0.002289986005052924
The generated pressure mean: 0.45269161462783813
loss_pred:0.017287984490394592, decouple_loss:0.002201274037361145
Iteration: 7647, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4397469758987427
The generated pressure mean: 0.44105851650238037
loss_pred:0.017626993358135223, decouple_loss:0.0022667404264211655
loss_pred:0.01517445594072342, decouple_loss:0.002373265800997615
The generated pressure mean: 0.44074124097824097
loss_pred:0.01926833763718605, decouple_loss:0.0024876848328858614
Iteration: 7648, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43808257579803467
loss_pred:0.01720592938363552, decouple_loss:0.0026022179517894983
The generated pressure mean: 0.4391454756259918
loss_pred:0.017166893929243088, decouple_loss:0.002606017515063286
The generated pressure mean: 0.43723729252815247
loss_pred:0.016840735450387, decouple_loss:0.002586516784504056
Iteration: 7649, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4529648721218109
loss_pred:0.01662161946296692, decouple_loss:0.0019391457317396998
The generated pressure mean: 0.4490877091884613
loss_pred:0.01606754958629608, decouple_loss:0.002025615656748414
The generated pressure mean: 0.45594826340675354
loss_pred:0.015971152111887932, decouple_loss:0.0019538942724466324
Iteration: 7650, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45179295539855957
loss_pred:0.018255403265357018, decouple_loss:0.002641242230311036
The generated pressure mean: 0.45436960458755493
loss_pred:0.01681559346616268, decouple_loss:0.0026490557938814163
The generated pressure mean: 0.4539724588394165
loss_pred:0.01638464815914631, decouple_loss:0.0026545303408056498
2023-04-17 16:29:01 testing...
The generated pressure mean: 0.4144086539745331
The generated pressure mean: 0.42131146788597107
loss_pred:0.030369210988283157, decouple_loss:0.002735819900408387
The generated pressure mean: 0.4242527186870575
loss_pred:0.02930683270096779, decouple_loss:0.0028705312870442867
loss_pred:0.028925979509949684, decouple_loss:0.0029303873889148235
WV_0_PC_0_EH_1_PS_40, loss: 0.0296762865036726, avg_mse: 0.04483948275446892
current test mse: 0.044839
Iteration: 7651, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4443947672843933
The generated pressure mean: 0.439909964799881
loss_pred:0.01801164448261261, decouple_loss:0.0022552907466888428
loss_pred:0.01741381362080574, decouple_loss:0.0022964836098253727
The generated pressure mean: 0.44050508737564087
loss_pred:0.017210887745022774, decouple_loss:0.0021929743234068155
Iteration: 7652, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44306108355522156
loss_pred:0.017727866768836975, decouple_loss:0.0021832790225744247
The generated pressure mean: 0.44043731689453125
loss_pred:0.016033247113227844, decouple_loss:0.00224930583499372
The generated pressure mean: 0.4423602521419525
loss_pred:0.016925496980547905, decouple_loss:0.002295698970556259
Iteration: 7653, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4454028904438019
loss_pred:0.01753508485853672, decouple_loss:0.002594012301415205
The generated pressure mean: 0.44466403126716614
loss_pred:0.017464112490415573, decouple_loss:0.0026732112746685743
The generated pressure mean: 0.4496491849422455
loss_pred:0.01691831834614277, decouple_loss:0.002572079887613654
Iteration: 7654, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44852763414382935
loss_pred:0.019855588674545288, decouple_loss:0.0023675139527767897
The generated pressure mean: 0.4531513750553131
loss_pred:0.016640888527035713, decouple_loss:0.0023491340689361095
The generated pressure mean: 0.4465082883834839
loss_pred:0.018762361258268356, decouple_loss:0.0023514321073889732
Iteration: 7655, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43991607427597046
loss_pred:0.017429804429411888, decouple_loss:0.002300514141097665
The generated pressure mean: 0.4432789981365204
loss_pred:0.017258603125810623, decouple_loss:0.002277993131428957
The generated pressure mean: 0.4382728040218353
loss_pred:0.016582297161221504, decouple_loss:0.002324772533029318
Iteration: 7656, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4495912194252014
loss_pred:0.01637870818376541, decouple_loss:0.0026153726503252983
The generated pressure mean: 0.4430128335952759
loss_pred:0.018072091042995453, decouple_loss:0.0025317687541246414
The generated pressure mean: 0.4451151490211487
loss_pred:0.01745903491973877, decouple_loss:0.002472699386999011
Iteration: 7657, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44813859462738037
loss_pred:0.016966087743639946, decouple_loss:0.002303746761754155
The generated pressure mean: 0.45121216773986816
loss_pred:0.01876620203256607, decouple_loss:0.0023763044737279415
The generated pressure mean: 0.4438232481479645
loss_pred:0.017430059611797333, decouple_loss:0.002229409758001566
Iteration: 7658, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44049564003944397
loss_pred:0.01939980685710907, decouple_loss:0.0026140117552131414
The generated pressure mean: 0.44114556908607483
loss_pred:0.0166777390986681, decouple_loss:0.002548410091549158
The generated pressure mean: 0.4461531937122345
loss_pred:0.017208756878972054, decouple_loss:0.0026974270585924387
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 7659, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44557663798332214
loss_pred:0.01854979805648327, decouple_loss:0.0025776729453355074
The generated pressure mean: 0.44671592116355896
loss_pred:0.016085295006632805, decouple_loss:0.0024220296181738377
The generated pressure mean: 0.4530199468135834
loss_pred:0.01841174252331257, decouple_loss:0.002546571660786867
Iteration: 7660, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480774402618408
loss_pred:0.01716642454266548, decouple_loss:0.0029318223241716623
The generated pressure mean: 0.448959618806839
loss_pred:0.017816968262195587, decouple_loss:0.0028613328468054533
The generated pressure mean: 0.44587811827659607
loss_pred:0.017894523218274117, decouple_loss:0.0027373277116566896
2023-04-17 16:30:54 testing...
The generated pressure mean: 0.4130062162876129
The generated pressure mean: 0.42004019021987915
The generated pressure mean: 0.42336535453796387
loss_pred:0.03188474103808403, decouple_loss:0.002788631711155176
loss_pred:0.030776504427194595, decouple_loss:0.002853566315025091
loss_pred:0.030152292922139168, decouple_loss:0.0030013376381248236
WV_0_PC_0_EH_1_PS_40, loss: 0.031081905588507652, avg_mse: 0.04795069620013237
current test mse: 0.047951
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 7661, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469420313835144
loss_pred:0.016682790592312813, decouple_loss:0.002434313064441085
The generated pressure mean: 0.44638505578041077
loss_pred:0.017996208742260933, decouple_loss:0.0023698140867054462
The generated pressure mean: 0.44620904326438904
loss_pred:0.01748231053352356, decouple_loss:0.0023704259656369686
Iteration: 7662, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44825080037117004
loss_pred:0.017557252198457718, decouple_loss:0.002727129962295294
The generated pressure mean: 0.44752487540245056
loss_pred:0.018204042688012123, decouple_loss:0.00265588634647429
The generated pressure mean: 0.44764846563339233
loss_pred:0.01700391247868538, decouple_loss:0.0028168237768113613
Iteration: 7663, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44058242440223694
loss_pred:0.017277931794524193, decouple_loss:0.002657848410308361
The generated pressure mean: 0.44520846009254456
loss_pred:0.018245231360197067, decouple_loss:0.0026064689736813307
The generated pressure mean: 0.4457125961780548
loss_pred:0.017983896657824516, decouple_loss:0.0027762199752032757
Iteration: 7664, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45212414860725403
loss_pred:0.01728959195315838, decouple_loss:0.002447831677272916
The generated pressure mean: 0.4493201673030853
loss_pred:0.01801895536482334, decouple_loss:0.0024685985408723354
The generated pressure mean: 0.4487155079841614
loss_pred:0.017121408134698868, decouple_loss:0.0024222538340836763
Iteration: 7665, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44915616512298584
loss_pred:0.01766190677881241, decouple_loss:0.002666747197508812
The generated pressure mean: 0.4512580931186676
loss_pred:0.0180123969912529, decouple_loss:0.0026354293804615736
The generated pressure mean: 0.4504660665988922
loss_pred:0.01655004546046257, decouple_loss:0.0026052629109472036
Iteration: 7666, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44134464859962463
loss_pred:0.017542576417326927, decouple_loss:0.002795437118038535
The generated pressure mean: 0.4515405297279358
loss_pred:0.017701856791973114, decouple_loss:0.0025601699016988277
The generated pressure mean: 0.44016891717910767
loss_pred:0.01629732921719551, decouple_loss:0.0027299874927848577
Iteration: 7667, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485640823841095
loss_pred:0.016842439770698547, decouple_loss:0.002114892238751054
The generated pressure mean: 0.452836811542511
loss_pred:0.017570417374372482, decouple_loss:0.0021651028655469418
The generated pressure mean: 0.45002931356430054
loss_pred:0.01904318854212761, decouple_loss:0.0022941750939935446
Iteration: 7668, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44054949283599854
loss_pred:0.017432773485779762, decouple_loss:0.0022957981564104557
The generated pressure mean: 0.4416438639163971
The generated pressure mean: 0.4453003704547882
loss_pred:0.01788393221795559, decouple_loss:0.0023890386801213026
loss_pred:0.017438741400837898, decouple_loss:0.0023932093754410744
Iteration: 7669, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45095959305763245
loss_pred:0.017519373446702957, decouple_loss:0.0023446327541023493
The generated pressure mean: 0.45156681537628174
loss_pred:0.017664358019828796, decouple_loss:0.0022835745476186275
The generated pressure mean: 0.4495798945426941
loss_pred:0.016800403594970703, decouple_loss:0.0024412251077592373
Iteration: 7670, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44409236311912537
loss_pred:0.017577631399035454, decouple_loss:0.0022372868843376637
The generated pressure mean: 0.4428216516971588
loss_pred:0.019695840775966644, decouple_loss:0.0021685645915567875
The generated pressure mean: 0.4481344521045685
loss_pred:0.018441980704665184, decouple_loss:0.0022338677663356066
2023-04-17 16:33:27 testing...
The generated pressure mean: 0.41550931334495544
The generated pressure mean: 0.4217603802680969
loss_pred:0.031192481517791748, decouple_loss:0.0025172303430736065
The generated pressure mean: 0.4249435365200043
loss_pred:0.03033873811364174, decouple_loss:0.002623538952320814
loss_pred:0.029722820967435837, decouple_loss:0.0026824616361409426
WV_0_PC_0_EH_1_PS_40, loss: 0.030548401176929474, avg_mse: 0.046429380774497986
current test mse: 0.046429
Iteration: 7671, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43379923701286316
loss_pred:0.016679858788847923, decouple_loss:0.0021115101408213377
The generated pressure mean: 0.43452441692352295
loss_pred:0.017049381509423256, decouple_loss:0.002045805798843503
The generated pressure mean: 0.43081167340278625
loss_pred:0.018206464126706123, decouple_loss:0.00225464696995914
Iteration: 7672, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45600512623786926
loss_pred:0.01845134235918522, decouple_loss:0.0022085527889430523
The generated pressure mean: 0.4616047143936157
loss_pred:0.018322186544537544, decouple_loss:0.0023271257523447275
The generated pressure mean: 0.4634741246700287
loss_pred:0.017507057636976242, decouple_loss:0.0021800717804580927
Iteration: 7673, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4566384553909302
loss_pred:0.01673738658428192, decouple_loss:0.002367477398365736
The generated pressure mean: 0.45811203122138977
loss_pred:0.019025472924113274, decouple_loss:0.002368298126384616
The generated pressure mean: 0.45422399044036865
loss_pred:0.0167388953268528, decouple_loss:0.0023709239903837442
Iteration: 7674, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44151392579078674
loss_pred:0.01794554479420185, decouple_loss:0.002388991881161928
The generated pressure mean: 0.4399842619895935
loss_pred:0.017836909741163254, decouple_loss:0.0023807240650057793
The generated pressure mean: 0.44233936071395874
loss_pred:0.01714635081589222, decouple_loss:0.002423649886623025
Iteration: 7675, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4441671669483185
loss_pred:0.016176091507077217, decouple_loss:0.0019285628804937005
The generated pressure mean: 0.44683972001075745
loss_pred:0.01752474345266819, decouple_loss:0.001965929986909032
The generated pressure mean: 0.4466526508331299
loss_pred:0.017433809116482735, decouple_loss:0.0019221942638978362
Iteration: 7676, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464476406574249
loss_pred:0.017243195325136185, decouple_loss:0.002068839268758893
The generated pressure mean: 0.4474189877510071
loss_pred:0.01821443997323513, decouple_loss:0.0021276124753057957
The generated pressure mean: 0.446667343378067
loss_pred:0.016438081860542297, decouple_loss:0.0021138882730156183
Iteration: 7677, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44523146748542786
loss_pred:0.01885477639734745, decouple_loss:0.0021276711486279964
The generated pressure mean: 0.44740840792655945
loss_pred:0.016558418050408363, decouple_loss:0.002073852811008692
The generated pressure mean: 0.45090681314468384
loss_pred:0.017137425020337105, decouple_loss:0.002200394170358777
Iteration: 7678, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493391811847687
loss_pred:0.01795748993754387, decouple_loss:0.001990071265026927
The generated pressure mean: 0.4478256404399872
loss_pred:0.017175808548927307, decouple_loss:0.0019441480981186032
The generated pressure mean: 0.4517830014228821
loss_pred:0.017017316073179245, decouple_loss:0.002003837376832962
Iteration: 7679, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4432847499847412
loss_pred:0.01659698598086834, decouple_loss:0.0026333231944590807
The generated pressure mean: 0.4450802803039551
loss_pred:0.017213456332683563, decouple_loss:0.002468300284817815
The generated pressure mean: 0.44259965419769287
loss_pred:0.017141712829470634, decouple_loss:0.0025996824260801077
Iteration: 7680, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448825865983963
loss_pred:0.017068982124328613, decouple_loss:0.002429588232189417
The generated pressure mean: 0.44545698165893555
loss_pred:0.016805922612547874, decouple_loss:0.002512877807021141
The generated pressure mean: 0.4478297531604767
loss_pred:0.01762845367193222, decouple_loss:0.002375199692323804
2023-04-17 16:35:20 testing...
The generated pressure mean: 0.41147831082344055
The generated pressure mean: 0.41847777366638184
The generated pressure mean: 0.42162415385246277
loss_pred:0.03284086287021637, decouple_loss:0.0027186700608581305
loss_pred:0.03179171681404114, decouple_loss:0.002882484346628189
loss_pred:0.031107651069760323, decouple_loss:0.002983918646350503
WV_0_PC_0_EH_1_PS_40, loss: 0.03205649554729462, avg_mse: 0.049229975789785385
current test mse: 0.04923
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
Iteration: 7681, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480634033679962
loss_pred:0.01862676627933979, decouple_loss:0.0021584765054285526
The generated pressure mean: 0.44768035411834717
loss_pred:0.0170430950820446, decouple_loss:0.002246974501758814
The generated pressure mean: 0.4462243318557739
loss_pred:0.018114004284143448, decouple_loss:0.002338148420676589
Iteration: 7682, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45592963695526123
loss_pred:0.016857590526342392, decouple_loss:0.0024348220322281122
The generated pressure mean: 0.4520116150379181
loss_pred:0.02089688740670681, decouple_loss:0.0026544244028627872
The generated pressure mean: 0.4514424502849579
loss_pred:0.01769311912357807, decouple_loss:0.0025554299354553223
Iteration: 7683, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44150665402412415
loss_pred:0.01770283840596676, decouple_loss:0.002338311169296503
The generated pressure mean: 0.441180557012558
loss_pred:0.019217267632484436, decouple_loss:0.0022749663330614567
The generated pressure mean: 0.44262272119522095
loss_pred:0.021168682724237442, decouple_loss:0.00227563688531518
Iteration: 7684, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4312592148780823
loss_pred:0.0179228987544775, decouple_loss:0.0021395510993897915
The generated pressure mean: 0.43146705627441406
loss_pred:0.017338993027806282, decouple_loss:0.0021001070272177458
The generated pressure mean: 0.42968013882637024
loss_pred:0.01729363016784191, decouple_loss:0.0021469390485435724
Iteration: 7685, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45417702198028564
loss_pred:0.01782631129026413, decouple_loss:0.003188410308212042
The generated pressure mean: 0.4518512189388275
loss_pred:0.017495572566986084, decouple_loss:0.0030520823784172535
The generated pressure mean: 0.45473265647888184
loss_pred:0.016630418598651886, decouple_loss:0.0031550938729196787
Iteration: 7686, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45732009410858154
loss_pred:0.01768479496240616, decouple_loss:0.0024542268365621567
The generated pressure mean: 0.4536474049091339
loss_pred:0.017977574840188026, decouple_loss:0.0023948049638420343
The generated pressure mean: 0.4542824327945709
loss_pred:0.01655399799346924, decouple_loss:0.002443878445774317
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 7687, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4419020712375641
The generated pressure mean: 0.4442236125469208loss_pred:0.01787443831562996, decouple_loss:0.0034381283912807703
loss_pred:0.01799202524125576, decouple_loss:0.0033697637263685465
The generated pressure mean: 0.4366169273853302
loss_pred:0.017357749864459038, decouple_loss:0.0031632829923182726
Iteration: 7688, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44067999720573425
The generated pressure mean: 0.43322622776031494
loss_pred:0.017356442287564278, decouple_loss:0.0023813939187675714
loss_pred:0.01842368207871914, decouple_loss:0.002440809737890959
The generated pressure mean: 0.434965044260025
loss_pred:0.01965189538896084, decouple_loss:0.0024754395708441734
Iteration: 7689, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4424366354942322
loss_pred:0.01914033107459545, decouple_loss:0.0025587305426597595
The generated pressure mean: 0.4405727982521057
loss_pred:0.019079485908150673, decouple_loss:0.002667925786226988
The generated pressure mean: 0.44245344400405884
loss_pred:0.018250638619065285, decouple_loss:0.002499556401744485
Iteration: 7690, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4507787525653839
loss_pred:0.01842809095978737, decouple_loss:0.003362699644640088
The generated pressure mean: 0.45208433270454407
The generated pressure mean: 0.4513987600803375
loss_pred:0.017626900225877762, decouple_loss:0.00351247051730752
loss_pred:0.01998652145266533, decouple_loss:0.003347591497004032
2023-04-17 16:37:55 testing...
The generated pressure mean: 0.41328319907188416
The generated pressure mean: 0.41961008310317993
The generated pressure mean: 0.42271628975868225
loss_pred:0.03274247422814369, decouple_loss:0.0028719643596559763
loss_pred:0.03136831521987915, decouple_loss:0.0030940764117985964
loss_pred:0.031236689537763596, decouple_loss:0.0030943972524255514
WV_0_PC_0_EH_1_PS_40, loss: 0.0319335013628006, avg_mse: 0.04877372458577156
current test mse: 0.048774
Iteration: 7691, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43902459740638733
loss_pred:0.016673536971211433, decouple_loss:0.0024294520262628794
The generated pressure mean: 0.4430995285511017
loss_pred:0.017613163217902184, decouple_loss:0.0024174025747925043
The generated pressure mean: 0.4424062669277191
loss_pred:0.018430938944220543, decouple_loss:0.0024381778202950954
Iteration: 7692, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44637954235076904
loss_pred:0.017602263018488884, decouple_loss:0.0021947738714516163
The generated pressure mean: 0.4475399851799011
loss_pred:0.019047588109970093, decouple_loss:0.0022859792225062847
The generated pressure mean: 0.449771910905838
loss_pred:0.018681198358535767, decouple_loss:0.0021630472037941217
Iteration: 7693, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45110052824020386
The generated pressure mean: 0.4540048837661743
loss_pred:0.01708017662167549, decouple_loss:0.002889761235564947
loss_pred:0.017701605334877968, decouple_loss:0.0029119530227035284
The generated pressure mean: 0.4470122754573822
loss_pred:0.01871160790324211, decouple_loss:0.0028504563961178064
Iteration: 7694, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459931552410126
The generated pressure mean: 0.442338228225708
loss_pred:0.017348110675811768, decouple_loss:0.00218322966247797
loss_pred:0.01788555271923542, decouple_loss:0.0022749779745936394
The generated pressure mean: 0.441156804561615
loss_pred:0.017986252903938293, decouple_loss:0.0024630557745695114
Iteration: 7695, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4439937174320221
The generated pressure mean: 0.4397551417350769
loss_pred:0.01812160387635231, decouple_loss:0.0024861469864845276
loss_pred:0.017276545986533165, decouple_loss:0.0024417205713689327
The generated pressure mean: 0.4416135251522064
loss_pred:0.01769527606666088, decouple_loss:0.002454943722113967
Iteration: 7696, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44474005699157715
The generated pressure mean: 0.4477764666080475
loss_pred:0.017502062022686005, decouple_loss:0.0027785548008978367
loss_pred:0.017679667100310326, decouple_loss:0.0028564240783452988
The generated pressure mean: 0.4514566957950592
loss_pred:0.018758563324809074, decouple_loss:0.0027784162666648626
Iteration: 7697, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468728005886078
The generated pressure mean: 0.4438783824443817
loss_pred:0.01810510829091072, decouple_loss:0.002104572020471096
loss_pred:0.01866333745419979, decouple_loss:0.002086196094751358
The generated pressure mean: 0.4511125683784485
loss_pred:0.017576394602656364, decouple_loss:0.0021392658818513155
Iteration: 7698, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43038350343704224
loss_pred:0.018599562346935272, decouple_loss:0.0025491605047136545
The generated pressure mean: 0.43175607919692993
loss_pred:0.017359774559736252, decouple_loss:0.002592068398371339The generated pressure mean: 0.4265241324901581
loss_pred:0.017515767365694046, decouple_loss:0.0026432445738464594
Iteration: 7699, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45985251665115356
loss_pred:0.018101803958415985, decouple_loss:0.002773617161437869
The generated pressure mean: 0.4563690423965454
The generated pressure mean: 0.4538721442222595loss_pred:0.022888535633683205, decouple_loss:0.002892887918278575
loss_pred:0.01743393950164318, decouple_loss:0.002903497777879238
Iteration: 7700, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43477410078048706
loss_pred:0.01934613101184368, decouple_loss:0.0023936713114380836
The generated pressure mean: 0.43082523345947266
loss_pred:0.021655837073922157, decouple_loss:0.00238218205049634
The generated pressure mean: 0.4321470558643341
loss_pred:0.018422657623887062, decouple_loss:0.002330959774553776
2023-04-17 16:39:49 testing...
The generated pressure mean: 0.4118691682815552
The generated pressure mean: 0.4186111390590668
The generated pressure mean: 0.4212908148765564
loss_pred:0.03587649390101433, decouple_loss:0.004358283709734678
loss_pred:0.03476836159825325, decouple_loss:0.004618123639374971
loss_pred:0.03418978676199913, decouple_loss:0.004652316682040691
WV_0_PC_0_EH_1_PS_40, loss: 0.035172026604413986, avg_mse: 0.054822687059640884
current test mse: 0.054823
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 7701, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.459729939699173
loss_pred:0.0192614383995533, decouple_loss:0.0039758821949362755
The generated pressure mean: 0.4579758644104004
loss_pred:0.018568269908428192, decouple_loss:0.004008796531707048
The generated pressure mean: 0.45764219760894775
loss_pred:0.017023801803588867, decouple_loss:0.0038227178156375885
Iteration: 7702, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44715747237205505
loss_pred:0.017436938360333443, decouple_loss:0.002984194317832589
The generated pressure mean: 0.4465371370315552
loss_pred:0.019243527203798294, decouple_loss:0.0031165587715804577
The generated pressure mean: 0.44553035497665405
loss_pred:0.017032334581017494, decouple_loss:0.0030241163913160563
Iteration: 7703, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4351084530353546
loss_pred:0.017523715272545815, decouple_loss:0.0027606491930782795
The generated pressure mean: 0.43625566363334656
loss_pred:0.019685056060552597, decouple_loss:0.0027906920295208693
The generated pressure mean: 0.4351139962673187
loss_pred:0.015504040755331516, decouple_loss:0.0027388061862438917
Iteration: 7704, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484761655330658
loss_pred:0.01870720274746418, decouple_loss:0.0023799992632120848
The generated pressure mean: 0.45136937499046326
loss_pred:0.016647951677441597, decouple_loss:0.0024736328050494194
The generated pressure mean: 0.4492046535015106
loss_pred:0.017196588218212128, decouple_loss:0.0023986652959138155
Iteration: 7705, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4556240439414978
The generated pressure mean: 0.45429086685180664loss_pred:0.019379861652851105, decouple_loss:0.0024948918726295233
loss_pred:0.016406984999775887, decouple_loss:0.002460130024701357
The generated pressure mean: 0.457945853471756
loss_pred:0.01602512039244175, decouple_loss:0.0025203367695212364
Iteration: 7706, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4392440915107727
loss_pred:0.017688719555735588, decouple_loss:0.002202380681410432
The generated pressure mean: 0.44200417399406433The generated pressure mean: 0.44251585006713867
loss_pred:0.01820278726518154, decouple_loss:0.002266970230266452
loss_pred:0.020133724436163902, decouple_loss:0.002248113974928856
Iteration: 7707, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43677204847335815
loss_pred:0.01686287671327591, decouple_loss:0.0027328392025083303
The generated pressure mean: 0.43591123819351196
loss_pred:0.018330663442611694, decouple_loss:0.002860194770619273
The generated pressure mean: 0.44004249572753906
loss_pred:0.017388001084327698, decouple_loss:0.002870765049010515
Iteration: 7708, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4558350741863251
loss_pred:0.020849088206887245, decouple_loss:0.002803195035085082
The generated pressure mean: 0.4544837772846222
loss_pred:0.016416946426033974, decouple_loss:0.002834433689713478
The generated pressure mean: 0.45756182074546814
loss_pred:0.01741361990571022, decouple_loss:0.002808905206620693
Iteration: 7709, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4436590075492859
loss_pred:0.017191730439662933, decouple_loss:0.0029594360385090113
The generated pressure mean: 0.44386017322540283
The generated pressure mean: 0.44617319107055664loss_pred:0.016278546303510666, decouple_loss:0.0030332710593938828
loss_pred:0.01945268176496029, decouple_loss:0.002894179429858923
Iteration: 7710, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43931201100349426
loss_pred:0.017621813341975212, decouple_loss:0.0025611931923776865
The generated pressure mean: 0.43981510400772095
loss_pred:0.018154524266719818, decouple_loss:0.0026611241046339273
The generated pressure mean: 0.44136521220207214
loss_pred:0.01797410286962986, decouple_loss:0.002668991219252348
2023-04-17 16:42:19 testing...
The generated pressure mean: 0.41258805990219116
The generated pressure mean: 0.41950076818466187
The generated pressure mean: 0.4219862222671509
loss_pred:0.033327650278806686, decouple_loss:0.00316251115873456
loss_pred:0.032364003360271454, decouple_loss:0.00324459420517087
loss_pred:0.031691305339336395, decouple_loss:0.0033968330826610327
WV_0_PC_0_EH_1_PS_40, loss: 0.03262438625097275, avg_mse: 0.05034910514950752
current test mse: 0.050349
Iteration: 7711, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503105878829956
loss_pred:0.01619689166545868, decouple_loss:0.002785375574603677
The generated pressure mean: 0.45062899589538574
loss_pred:0.0181440282613039, decouple_loss:0.0028729704208672047
The generated pressure mean: 0.45430803298950195
loss_pred:0.018422123044729233, decouple_loss:0.002772156847640872
Iteration: 7712, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4387608766555786
loss_pred:0.01795426942408085, decouple_loss:0.003313809633255005
The generated pressure mean: 0.44878342747688293
loss_pred:0.017333125695586205, decouple_loss:0.0030067323241382837
The generated pressure mean: 0.4446408748626709
loss_pred:0.01715102605521679, decouple_loss:0.0031394169200211763
Iteration: 7713, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44456174969673157
loss_pred:0.017392946407198906, decouple_loss:0.0022923131473362446
The generated pressure mean: 0.4451982378959656
loss_pred:0.018698500469326973, decouple_loss:0.0022621448151767254
The generated pressure mean: 0.45409202575683594
loss_pred:0.017394794151186943, decouple_loss:0.0021976628340780735
Iteration: 7714, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4398825466632843
The generated pressure mean: 0.4384141266345978
loss_pred:0.016216713935136795, decouple_loss:0.002845032373443246
loss_pred:0.018034888431429863, decouple_loss:0.0028389045037329197
The generated pressure mean: 0.4364680349826813
loss_pred:0.017413536086678505, decouple_loss:0.0029524145647883415
Iteration: 7715, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44299811124801636
The generated pressure mean: 0.4508807063102722
loss_pred:0.019911060109734535, decouple_loss:0.0024263306986540556
loss_pred:0.01811772584915161, decouple_loss:0.0023853725288063288
The generated pressure mean: 0.4457545578479767
loss_pred:0.018359152600169182, decouple_loss:0.0022432596888393164
Iteration: 7716, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45108330249786377
The generated pressure mean: 0.44947564601898193
loss_pred:0.017218593508005142, decouple_loss:0.0022302563302218914
loss_pred:0.01969132386147976, decouple_loss:0.0022505205124616623
The generated pressure mean: 0.4490157961845398
loss_pred:0.016834726557135582, decouple_loss:0.002291708718985319
Iteration: 7717, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45253464579582214
The generated pressure mean: 0.4480465352535248
loss_pred:0.018045499920845032, decouple_loss:0.0021118149161338806
loss_pred:0.01787564530968666, decouple_loss:0.0022159370128065348
The generated pressure mean: 0.4501610994338989
loss_pred:0.017378389835357666, decouple_loss:0.0021643333602696657
Iteration: 7718, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4457176923751831
loss_pred:0.01931608095765114, decouple_loss:0.0022297215182334185
The generated pressure mean: 0.44110268354415894
loss_pred:0.017471041530370712, decouple_loss:0.002223119605332613
The generated pressure mean: 0.4400342106819153
loss_pred:0.016818953678011894, decouple_loss:0.0023007849231362343
Iteration: 7719, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44698894023895264
The generated pressure mean: 0.4472576975822449
loss_pred:0.0166478231549263, decouple_loss:0.002479521557688713
loss_pred:0.017171312123537064, decouple_loss:0.002443581586703658
The generated pressure mean: 0.44729846715927124
loss_pred:0.016962897032499313, decouple_loss:0.0024949475191533566
Iteration: 7720, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4500010013580322
loss_pred:0.017674200236797333, decouple_loss:0.002284925663843751
The generated pressure mean: 0.44810613989830017
loss_pred:0.01856478489935398, decouple_loss:0.0022913976572453976
The generated pressure mean: 0.4523620307445526
loss_pred:0.017295977100729942, decouple_loss:0.0024892943911254406
2023-04-17 16:44:12 testing...
The generated pressure mean: 0.4152228534221649
The generated pressure mean: 0.42246392369270325
The generated pressure mean: 0.42536675930023193
loss_pred:0.03157702088356018, decouple_loss:0.002500154310837388
loss_pred:0.03031167946755886, decouple_loss:0.002733688335865736
loss_pred:0.029654216021299362, decouple_loss:0.0027019670233130455
WV_0_PC_0_EH_1_PS_40, loss: 0.030646570026874542, avg_mse: 0.04696625471115112
current test mse: 0.046966
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 7721, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43999841809272766
loss_pred:0.016629844903945923, decouple_loss:0.002053953008726239
The generated pressure mean: 0.4457121789455414
loss_pred:0.0171470046043396, decouple_loss:0.0021539859008044004
The generated pressure mean: 0.4398670494556427
loss_pred:0.017124168574810028, decouple_loss:0.0022047962993383408
Iteration: 7722, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4416987895965576The generated pressure mean: 0.44426000118255615
loss_pred:0.015487048774957657, decouple_loss:0.0026078191585838795
loss_pred:0.0167344082146883, decouple_loss:0.002489598235115409
The generated pressure mean: 0.442656010389328
loss_pred:0.01599114015698433, decouple_loss:0.002557354746386409
Iteration: 7723, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4547727108001709
The generated pressure mean: 0.4523780345916748
loss_pred:0.016909342259168625, decouple_loss:0.0025844599585980177
loss_pred:0.01723715290427208, decouple_loss:0.002691814210265875
The generated pressure mean: 0.4497087597846985
loss_pred:0.016253551468253136, decouple_loss:0.002713698660954833
Iteration: 7724, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449853777885437
The generated pressure mean: 0.4517049193382263
loss_pred:0.016534803435206413, decouple_loss:0.0027667309623211622
loss_pred:0.016705306246876717, decouple_loss:0.0026031271554529667
The generated pressure mean: 0.45257076621055603
loss_pred:0.018597884103655815, decouple_loss:0.0026355935260653496
Iteration: 7725, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471747875213623
The generated pressure mean: 0.44542792439460754
loss_pred:0.01612250693142414, decouple_loss:0.0021810156758874655
loss_pred:0.018018323928117752, decouple_loss:0.002227062825113535
The generated pressure mean: 0.44904354214668274
loss_pred:0.016107184812426567, decouple_loss:0.0022059446200728416
Iteration: 7726, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44363805651664734
The generated pressure mean: 0.44486042857170105
loss_pred:0.016595417633652687, decouple_loss:0.0020096818916499615
loss_pred:0.017357923090457916, decouple_loss:0.002174132503569126
The generated pressure mean: 0.44345980882644653
loss_pred:0.016076628118753433, decouple_loss:0.0021128307562321424
Iteration: 7727, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4432837665081024
The generated pressure mean: 0.44160619378089905
loss_pred:0.017286209389567375, decouple_loss:0.0019747859332710505
loss_pred:0.017577223479747772, decouple_loss:0.001950653619132936
The generated pressure mean: 0.4427110552787781
loss_pred:0.015627119690179825, decouple_loss:0.001926249940879643
Iteration: 7728, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44751906394958496
loss_pred:0.01692494936287403, decouple_loss:0.002306153532117605
The generated pressure mean: 0.44728031754493713
loss_pred:0.016337765380740166, decouple_loss:0.0022857612930238247
The generated pressure mean: 0.44533050060272217
loss_pred:0.015353669412434101, decouple_loss:0.002249446464702487
Iteration: 7729, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4555448293685913
loss_pred:0.018015941604971886, decouple_loss:0.003025277517735958
The generated pressure mean: 0.45504483580589294
loss_pred:0.015904080122709274, decouple_loss:0.0032250692602247
The generated pressure mean: 0.45605915784835815
loss_pred:0.017081983387470245, decouple_loss:0.003044333541765809
Iteration: 7730, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4413536489009857
The generated pressure mean: 0.442958801984787
loss_pred:0.016311554238200188, decouple_loss:0.0023888449650257826
loss_pred:0.01773684471845627, decouple_loss:0.0023926449939608574
The generated pressure mean: 0.4408462345600128
loss_pred:0.015334954485297203, decouple_loss:0.0024061123840510845
2023-04-17 16:46:49 testing...
The generated pressure mean: 0.4141314923763275
The generated pressure mean: 0.4216732680797577
The generated pressure mean: 0.4247092008590698
loss_pred:0.030989347025752068, decouple_loss:0.0024926874320954084
loss_pred:0.02918924205005169, decouple_loss:0.002778510330244899
loss_pred:0.029531586915254593, decouple_loss:0.002737614559009671
WV_0_PC_0_EH_1_PS_40, loss: 0.030036872252821922, avg_mse: 0.045784711837768555
current test mse: 0.045785
Iteration: 7731, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4460911750793457
loss_pred:0.017913518473505974, decouple_loss:0.001943692797794938
The generated pressure mean: 0.44392579793930054
loss_pred:0.016523096710443497, decouple_loss:0.001991184428334236
The generated pressure mean: 0.4451494812965393
loss_pred:0.017993547022342682, decouple_loss:0.001963490154594183
Iteration: 7732, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501933753490448
loss_pred:0.015255512669682503, decouple_loss:0.002476115943863988
The generated pressure mean: 0.44623005390167236
loss_pred:0.01701977849006653, decouple_loss:0.0026082098484039307
The generated pressure mean: 0.4477100670337677
loss_pred:0.01723358780145645, decouple_loss:0.002665766980499029
Iteration: 7733, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471931755542755
loss_pred:0.016249068081378937, decouple_loss:0.0026604069862514734
The generated pressure mean: 0.446236789226532
loss_pred:0.01839507557451725, decouple_loss:0.0026951252948492765
The generated pressure mean: 0.445441335439682
loss_pred:0.017197079956531525, decouple_loss:0.0027740418445318937
Iteration: 7734, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44539377093315125
loss_pred:0.015429865568876266, decouple_loss:0.0023212230298668146
The generated pressure mean: 0.45007938146591187
loss_pred:0.01685020700097084, decouple_loss:0.0023717363364994526
The generated pressure mean: 0.4469574987888336
loss_pred:0.018672334030270576, decouple_loss:0.0024217646569013596
Iteration: 7735, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4384302794933319
loss_pred:0.016452355310320854, decouple_loss:0.002140772296115756
The generated pressure mean: 0.4397154152393341
loss_pred:0.016147566959261894, decouple_loss:0.0020420141518115997
The generated pressure mean: 0.4429360628128052
loss_pred:0.01717229001224041, decouple_loss:0.0019711239729076624
Iteration: 7736, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4525519609451294
loss_pred:0.01745678298175335, decouple_loss:0.0022329839412122965
The generated pressure mean: 0.45127981901168823
loss_pred:0.016422444954514503, decouple_loss:0.00217579142190516
The generated pressure mean: 0.4509715735912323
loss_pred:0.016582803800702095, decouple_loss:0.002115127630531788
Iteration: 7737, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493686258792877
loss_pred:0.016830410808324814, decouple_loss:0.0022627715952694416
The generated pressure mean: 0.4483852982521057
loss_pred:0.018025396391749382, decouple_loss:0.002131903311237693
The generated pressure mean: 0.4489934742450714
loss_pred:0.016206642612814903, decouple_loss:0.0022535412572324276
Iteration: 7738, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4388577938079834
loss_pred:0.016551343724131584, decouple_loss:0.002200874499976635
The generated pressure mean: 0.44380295276641846
loss_pred:0.01569237932562828, decouple_loss:0.002220411552116275
The generated pressure mean: 0.44219210743904114
loss_pred:0.0167229101061821, decouple_loss:0.0023500879760831594
Iteration: 7739, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449843466281891
loss_pred:0.017373783513903618, decouple_loss:0.0017549077747389674
The generated pressure mean: 0.4506551921367645
loss_pred:0.01637081615626812, decouple_loss:0.0018509809160605073
The generated pressure mean: 0.44661185145378113
loss_pred:0.015266611240804195, decouple_loss:0.001686957897618413
Iteration: 7740, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497855305671692
loss_pred:0.016678666695952415, decouple_loss:0.0017925139982253313
The generated pressure mean: 0.45078492164611816
loss_pred:0.01582104153931141, decouple_loss:0.0018509578658267856
The generated pressure mean: 0.4541794955730438
loss_pred:0.016905125230550766, decouple_loss:0.0018463096348568797
2023-04-17 16:48:42 testing...
The generated pressure mean: 0.42022979259490967
The generated pressure mean: 0.41305720806121826
The generated pressure mean: 0.42324358224868774
loss_pred:0.030217204242944717, decouple_loss:0.002674367744475603
loss_pred:0.03155190125107765, decouple_loss:0.0024454761296510696
loss_pred:0.029733365401625633, decouple_loss:0.002690310822799802
WV_0_PC_0_EH_1_PS_40, loss: 0.030630994588136673, avg_mse: 0.04686819016933441
current test mse: 0.046868
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 7741, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4454473853111267
loss_pred:0.016718288883566856, decouple_loss:0.0020935863722115755
The generated pressure mean: 0.44985857605934143
loss_pred:0.016295483335852623, decouple_loss:0.00215222779661417
The generated pressure mean: 0.44312238693237305
loss_pred:0.016796737909317017, decouple_loss:0.0020711852703243494
Iteration: 7742, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487578868865967
The generated pressure mean: 0.44602519273757935
loss_pred:0.016772784292697906, decouple_loss:0.0023193403612822294
loss_pred:0.016350306570529938, decouple_loss:0.0024330331943929195
The generated pressure mean: 0.4513895511627197
loss_pred:0.018740639090538025, decouple_loss:0.0024369852617383003
Iteration: 7743, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43267086148262024
The generated pressure mean: 0.43512487411499023
loss_pred:0.01624440774321556, decouple_loss:0.0022378077264875174
loss_pred:0.016223706305027008, decouple_loss:0.002128335414454341
The generated pressure mean: 0.43764302134513855
loss_pred:0.017180602997541428, decouple_loss:0.002224511932581663
Iteration: 7744, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45533499121665955
The generated pressure mean: 0.44890615344047546
loss_pred:0.018846284598112106, decouple_loss:0.0019585404079407454
loss_pred:0.017756931483745575, decouple_loss:0.0019426265498623252
The generated pressure mean: 0.452171266078949
loss_pred:0.018479203805327415, decouple_loss:0.002012056764215231
Iteration: 7745, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44938912987709045The generated pressure mean: 0.45049363374710083
loss_pred:0.016926057636737823, decouple_loss:0.002338611287996173
loss_pred:0.018498878926038742, decouple_loss:0.002462067874148488
The generated pressure mean: 0.45279642939567566
loss_pred:0.01740412414073944, decouple_loss:0.002372981980443001
Iteration: 7746, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44944077730178833
The generated pressure mean: 0.4436812996864319
loss_pred:0.01628118008375168, decouple_loss:0.0019564623944461346
loss_pred:0.016031445935368538, decouple_loss:0.0019021229818463326
The generated pressure mean: 0.4379745423793793
loss_pred:0.016480684280395508, decouple_loss:0.0018950195517390966
Iteration: 7747, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44444477558135986
The generated pressure mean: 0.44357168674468994
loss_pred:0.018937768414616585, decouple_loss:0.0020787527319043875
loss_pred:0.015509492717683315, decouple_loss:0.002147258725017309
The generated pressure mean: 0.44446030259132385
loss_pred:0.01787770725786686, decouple_loss:0.0021355110220611095
Iteration: 7748, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44176456332206726
loss_pred:0.018246736377477646, decouple_loss:0.0022678207606077194
The generated pressure mean: 0.4459036588668823
loss_pred:0.017442211508750916, decouple_loss:0.002394076669588685
The generated pressure mean: 0.4463646113872528
loss_pred:0.017686400562524796, decouple_loss:0.0024187040980905294
Iteration: 7749, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.450303316116333
The generated pressure mean: 0.4570896625518799
loss_pred:0.019134944304823875, decouple_loss:0.002414839807897806
loss_pred:0.019119353964924812, decouple_loss:0.002279460895806551
The generated pressure mean: 0.4584360718727112
loss_pred:0.017219027504324913, decouple_loss:0.0022974228486418724
Iteration: 7750, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4430657625198364
loss_pred:0.017657877877354622, decouple_loss:0.0022507705725729465
The generated pressure mean: 0.4376945495605469
loss_pred:0.015919838100671768, decouple_loss:0.0022391353268176317
The generated pressure mean: 0.44214072823524475
loss_pred:0.016441818326711655, decouple_loss:0.0022247270680963993
2023-04-17 16:51:23 testing...
The generated pressure mean: 0.41463345289230347
The generated pressure mean: 0.4217139482498169
loss_pred:0.031115705147385597, decouple_loss:0.0025331093929708004
The generated pressure mean: 0.42444461584091187
loss_pred:0.030055982992053032, decouple_loss:0.0026480755768716335
loss_pred:0.029331203550100327, decouple_loss:0.002809677505865693
WV_0_PC_0_EH_1_PS_40, loss: 0.030300814658403397, avg_mse: 0.04616802558302879
current test mse: 0.046168
Iteration: 7751, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4406375586986542
The generated pressure mean: 0.4336428940296173
loss_pred:0.017297247424721718, decouple_loss:0.0021352272015064955
loss_pred:0.01705443672835827, decouple_loss:0.0022002854384481907
The generated pressure mean: 0.440957248210907
loss_pred:0.017801053822040558, decouple_loss:0.002140709897503257
Iteration: 7752, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45563805103302
The generated pressure mean: 0.4556722640991211
loss_pred:0.01903584413230419, decouple_loss:0.0020110011100769043
loss_pred:0.016786538064479828, decouple_loss:0.0019752560183405876
The generated pressure mean: 0.4584645628929138
loss_pred:0.017067551612854004, decouple_loss:0.00193807075265795
Iteration: 7753, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43771564960479736
The generated pressure mean: 0.44758662581443787
loss_pred:0.019842201843857765, decouple_loss:0.0018035046523436904
loss_pred:0.017883190885186195, decouple_loss:0.0017349792178720236
The generated pressure mean: 0.4470965266227722
loss_pred:0.016867510974407196, decouple_loss:0.001686608768068254
Iteration: 7754, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449774920940399
The generated pressure mean: 0.4504438042640686
loss_pred:0.0169418565928936, decouple_loss:0.0018731598975136876
loss_pred:0.01727481186389923, decouple_loss:0.0017990899505093694
The generated pressure mean: 0.45195579528808594
loss_pred:0.017904913052916527, decouple_loss:0.0019154592882841825
Iteration: 7755, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.443760484457016
The generated pressure mean: 0.4389825761318207loss_pred:0.016767345368862152, decouple_loss:0.001615752698853612
loss_pred:0.019306978210806847, decouple_loss:0.0018095177365466952
The generated pressure mean: 0.4365726113319397
loss_pred:0.018973229452967644, decouple_loss:0.0017248534131795168
Iteration: 7756, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4340309202671051
The generated pressure mean: 0.439011812210083
loss_pred:0.01796679012477398, decouple_loss:0.001817416399717331
loss_pred:0.01892435923218727, decouple_loss:0.0019205095013603568
The generated pressure mean: 0.4358126223087311
loss_pred:0.01735811121761799, decouple_loss:0.0019546442199498415
Iteration: 7757, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45822590589523315
The generated pressure mean: 0.4626837968826294
loss_pred:0.017527466639876366, decouple_loss:0.0017358178738504648
loss_pred:0.016050195321440697, decouple_loss:0.0016083521768450737
The generated pressure mean: 0.4665343463420868
loss_pred:0.01701284945011139, decouple_loss:0.0015836763195693493
Iteration: 7758, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45450618863105774
The generated pressure mean: 0.4570775330066681loss_pred:0.016657305881381035, decouple_loss:0.002120372373610735
loss_pred:0.016731642186641693, decouple_loss:0.0021103585604578257
The generated pressure mean: 0.4527309238910675
loss_pred:0.01687001995742321, decouple_loss:0.002039626007899642
Iteration: 7759, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43515801429748535
loss_pred:0.017328860238194466, decouple_loss:0.001868163701146841
The generated pressure mean: 0.432819128036499
loss_pred:0.01794344000518322, decouple_loss:0.0018659206107258797
The generated pressure mean: 0.4305291473865509
loss_pred:0.01718703843653202, decouple_loss:0.001879778690636158
Iteration: 7760, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471512734889984
The generated pressure mean: 0.4504658579826355
loss_pred:0.01732761785387993, decouple_loss:0.0022095819003880024
loss_pred:0.0171822477132082, decouple_loss:0.0021368388552218676
The generated pressure mean: 0.4454350769519806
loss_pred:0.017299236729741096, decouple_loss:0.002028742805123329
2023-04-17 16:53:17 testing...
The generated pressure mean: 0.4114992022514343
The generated pressure mean: 0.4179079830646515
The generated pressure mean: 0.42062869668006897
loss_pred:0.03194322809576988, decouple_loss:0.0026066487189382315
loss_pred:0.030942238867282867, decouple_loss:0.0027376716025173664
loss_pred:0.030292965471744537, decouple_loss:0.002894712146371603
WV_0_PC_0_EH_1_PS_40, loss: 0.031196795403957367, avg_mse: 0.04769224300980568
current test mse: 0.047692
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 7761, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4539223611354828
loss_pred:0.016640013083815575, decouple_loss:0.0022028242237865925
The generated pressure mean: 0.4514091908931732
The generated pressure mean: 0.44890207052230835
loss_pred:0.01627398282289505, decouple_loss:0.0021723152603954077
loss_pred:0.01739124022424221, decouple_loss:0.0021916599944233894
Iteration: 7762, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45416438579559326
The generated pressure mean: 0.44740989804267883
loss_pred:0.01734827645123005, decouple_loss:0.002361616585403681
loss_pred:0.017699507996439934, decouple_loss:0.002466050209477544
The generated pressure mean: 0.45075929164886475
loss_pred:0.016371164470911026, decouple_loss:0.0023279045708477497
Iteration: 7763, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472676217556
loss_pred:0.018053945153951645, decouple_loss:0.0025270343758165836
The generated pressure mean: 0.4464051425457001
loss_pred:0.01683320477604866, decouple_loss:0.0025360723957419395
The generated pressure mean: 0.44525882601737976
loss_pred:0.01760142110288143, decouple_loss:0.0025582164525985718
Iteration: 7764, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4375191330909729
The generated pressure mean: 0.43253958225250244
loss_pred:0.017813272774219513, decouple_loss:0.002133667701855302
loss_pred:0.016750572249293327, decouple_loss:0.002109918976202607
The generated pressure mean: 0.44005894660949707
loss_pred:0.01861995831131935, decouple_loss:0.0020994411315768957
Iteration: 7765, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44516488909721375
The generated pressure mean: 0.448019415140152
loss_pred:0.016207927837967873, decouple_loss:0.0018580391770228744
loss_pred:0.016211366280913353, decouple_loss:0.0018151808762922883
The generated pressure mean: 0.4506083130836487
loss_pred:0.017143793404102325, decouple_loss:0.0017893131589516997
Iteration: 7766, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4546925723552704
loss_pred:0.017313692718744278, decouple_loss:0.0023581702262163162
The generated pressure mean: 0.45968711376190186
loss_pred:0.017802931368350983, decouple_loss:0.0025324090383946896
The generated pressure mean: 0.45602962374687195
loss_pred:0.019887689501047134, decouple_loss:0.0024403429124504328
Iteration: 7767, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43268299102783203
loss_pred:0.01772352121770382, decouple_loss:0.002285346854478121
The generated pressure mean: 0.4317786395549774
loss_pred:0.016298698261380196, decouple_loss:0.0020865590777248144
The generated pressure mean: 0.4331015348434448
loss_pred:0.016837021335959435, decouple_loss:0.0021457173861563206
Iteration: 7768, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4480477571487427
loss_pred:0.01937754452228546, decouple_loss:0.0025744186714291573
The generated pressure mean: 0.45203885436058044
loss_pred:0.0193872582167387, decouple_loss:0.0025450100656598806
The generated pressure mean: 0.448915958404541
loss_pred:0.01743350364267826, decouple_loss:0.002597134094685316
Iteration: 7769, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4574972093105316
The generated pressure mean: 0.46294862031936646
loss_pred:0.0164349228143692, decouple_loss:0.0025499965995550156
loss_pred:0.016922587528824806, decouple_loss:0.0026143891736865044
The generated pressure mean: 0.4598645865917206
loss_pred:0.01952819898724556, decouple_loss:0.0026737197767943144
Iteration: 7770, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43943846225738525
The generated pressure mean: 0.4379902780056
loss_pred:0.01738629676401615, decouple_loss:0.0028328027110546827
loss_pred:0.01702325977385044, decouple_loss:0.002834339626133442
The generated pressure mean: 0.44211843609809875
loss_pred:0.0170273557305336, decouple_loss:0.0027768760919570923
2023-04-17 16:55:49 testing...
The generated pressure mean: 0.415446937084198
The generated pressure mean: 0.421966552734375
The generated pressure mean: 0.4244341254234314
loss_pred:0.032990843057632446, decouple_loss:0.0036496506072580814
loss_pred:0.03192085400223732, decouple_loss:0.003625653451308608
loss_pred:0.03124053403735161, decouple_loss:0.003711522091180086
WV_0_PC_0_EH_1_PS_40, loss: 0.03223386034369469, avg_mse: 0.049718014895915985
current test mse: 0.049718
Iteration: 7771, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4376366138458252
loss_pred:0.020084938034415245, decouple_loss:0.003428652184084058
The generated pressure mean: 0.4380776584148407
loss_pred:0.01715044490993023, decouple_loss:0.0035330988466739655
The generated pressure mean: 0.4398531913757324
loss_pred:0.01701662875711918, decouple_loss:0.003399056615307927
Iteration: 7772, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43706077337265015
loss_pred:0.017466681078076363, decouple_loss:0.002857672283425927
The generated pressure mean: 0.436933696269989
loss_pred:0.017068805173039436, decouple_loss:0.0028231595642864704
The generated pressure mean: 0.4318521022796631
loss_pred:0.016614355146884918, decouple_loss:0.0027761647943407297
Iteration: 7773, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4632030725479126
loss_pred:0.016947276890277863, decouple_loss:0.0025179998483508825
The generated pressure mean: 0.4619148373603821
loss_pred:0.01740560308098793, decouple_loss:0.0027553976979106665
The generated pressure mean: 0.4620688259601593
loss_pred:0.01727399230003357, decouple_loss:0.002698376076295972
Iteration: 7774, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46505460143089294
loss_pred:0.017779789865016937, decouple_loss:0.0030793228652328253
The generated pressure mean: 0.4671292304992676
loss_pred:0.016106348484754562, decouple_loss:0.0029713858384639025
The generated pressure mean: 0.4620029032230377
loss_pred:0.02029314637184143, decouple_loss:0.0030926591716706753
Iteration: 7775, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43061739206314087
The generated pressure mean: 0.42661070823669434
loss_pred:0.016778916120529175, decouple_loss:0.0022774641402065754
loss_pred:0.017628604546189308, decouple_loss:0.0024206817615777254
The generated pressure mean: 0.43062034249305725
loss_pred:0.017827073112130165, decouple_loss:0.0024294033646583557
Iteration: 7776, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4367234706878662
loss_pred:0.01986280083656311, decouple_loss:0.002495251828804612
The generated pressure mean: 0.44140323996543884
loss_pred:0.016646292060613632, decouple_loss:0.0025937710888683796
The generated pressure mean: 0.4391366243362427
loss_pred:0.01761692762374878, decouple_loss:0.002582587068900466
Iteration: 7777, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44633615016937256
loss_pred:0.016630234196782112, decouple_loss:0.0029687245842069387
The generated pressure mean: 0.4492989182472229
loss_pred:0.016942285001277924, decouple_loss:0.0030099235009402037
The generated pressure mean: 0.4459690451622009
loss_pred:0.017971843481063843, decouple_loss:0.002912994707003236
Iteration: 7778, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4526715874671936
loss_pred:0.017832107841968536, decouple_loss:0.002524397801607847
The generated pressure mean: 0.45255976915359497
loss_pred:0.016099879518151283, decouple_loss:0.002455221489071846
The generated pressure mean: 0.45588016510009766
loss_pred:0.01609354093670845, decouple_loss:0.002525131683796644
Iteration: 7779, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504352807998657
loss_pred:0.015595323406159878, decouple_loss:0.002994261449202895
The generated pressure mean: 0.45018860697746277
loss_pred:0.017330747097730637, decouple_loss:0.0028511472046375275
The generated pressure mean: 0.446983277797699
loss_pred:0.01754295453429222, decouple_loss:0.0028931936249136925
Iteration: 7780, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4433601200580597
loss_pred:0.01628260314464569, decouple_loss:0.0026999907568097115
The generated pressure mean: 0.4433518946170807
loss_pred:0.016376128420233727, decouple_loss:0.0029318679589778185
The generated pressure mean: 0.4456746280193329
loss_pred:0.017399106174707413, decouple_loss:0.0026514714118093252
2023-04-17 16:57:42 testing...
The generated pressure mean: 0.4134812653064728
The generated pressure mean: 0.42131903767585754
The generated pressure mean: 0.42357146739959717
loss_pred:0.03346647694706917, decouple_loss:0.0030690012499690056
loss_pred:0.03191631659865379, decouple_loss:0.0031932261772453785
loss_pred:0.03124745562672615, decouple_loss:0.003294798079878092
WV_0_PC_0_EH_1_PS_40, loss: 0.03236936777830124, avg_mse: 0.05023374408483505
current test mse: 0.050234
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 7781, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447837233543396
loss_pred:0.018206370994448662, decouple_loss:0.0027297791093587875
The generated pressure mean: 0.4469738304615021
loss_pred:0.01724029704928398, decouple_loss:0.002677375450730324
The generated pressure mean: 0.44680675864219666
loss_pred:0.017892325296998024, decouple_loss:0.0027967398054897785
Iteration: 7782, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44688713550567627
The generated pressure mean: 0.4442315995693207
loss_pred:0.017254509031772614, decouple_loss:0.0028940807096660137
loss_pred:0.016223788261413574, decouple_loss:0.002778572728857398
The generated pressure mean: 0.4467353820800781
loss_pred:0.017184920608997345, decouple_loss:0.0029102321714162827
Iteration: 7783, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449457824230194The generated pressure mean: 0.4470283091068268
loss_pred:0.016702940687537193, decouple_loss:0.0023211201187223196
loss_pred:0.01644529215991497, decouple_loss:0.002385552506893873
The generated pressure mean: 0.44116103649139404
loss_pred:0.016178708523511887, decouple_loss:0.002615299541503191
Iteration: 7784, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45718511939048767
The generated pressure mean: 0.45458531379699707
loss_pred:0.016753913834691048, decouple_loss:0.0025001114699989557
loss_pred:0.01648549735546112, decouple_loss:0.002333930926397443
The generated pressure mean: 0.44773560762405396
loss_pred:0.017862848937511444, decouple_loss:0.0023236609995365143
Iteration: 7785, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4429062604904175
The generated pressure mean: 0.44127315282821655
loss_pred:0.016483161598443985, decouple_loss:0.0024801241233944893
loss_pred:0.01713285595178604, decouple_loss:0.002768500242382288
The generated pressure mean: 0.44222232699394226
loss_pred:0.01573365367949009, decouple_loss:0.0025947182439267635
Iteration: 7786, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4399212896823883
The generated pressure mean: 0.4423772990703583
loss_pred:0.016570189967751503, decouple_loss:0.0024043445009738207
loss_pred:0.016565363854169846, decouple_loss:0.002374063478782773
The generated pressure mean: 0.44350293278694153
loss_pred:0.017496176064014435, decouple_loss:0.002375680720433593
Iteration: 7787, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45414090156555176
loss_pred:0.016557596623897552, decouple_loss:0.002456426154822111
The generated pressure mean: 0.4502829611301422
loss_pred:0.01763680949807167, decouple_loss:0.0023418280761688948
The generated pressure mean: 0.4483959376811981
loss_pred:0.015840036794543266, decouple_loss:0.002495879540219903
Iteration: 7788, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44518622756004333
loss_pred:0.016931015998125076, decouple_loss:0.002533430466428399
The generated pressure mean: 0.45070046186447144
loss_pred:0.017589086666703224, decouple_loss:0.002607236383482814
The generated pressure mean: 0.44181373715400696
loss_pred:0.016860734671354294, decouple_loss:0.0025582239031791687
Iteration: 7789, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4519478380680084
loss_pred:0.01601012609899044, decouple_loss:0.002366097178310156
The generated pressure mean: 0.452858030796051
loss_pred:0.01656944863498211, decouple_loss:0.002481216797605157
The generated pressure mean: 0.4522445499897003
loss_pred:0.01598871685564518, decouple_loss:0.002496198285371065
Iteration: 7790, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4400174021720886
loss_pred:0.016787277534604073, decouple_loss:0.002285578055307269
The generated pressure mean: 0.4434676468372345
loss_pred:0.01832892931997776, decouple_loss:0.0023764113429933786
The generated pressure mean: 0.4463995695114136
loss_pred:0.015637343749403954, decouple_loss:0.0023903781548142433
2023-04-17 17:00:20 testing...
The generated pressure mean: 0.41434165835380554
The generated pressure mean: 0.42141833901405334
loss_pred:0.031239908188581467, decouple_loss:0.0025721793062984943
The generated pressure mean: 0.42435505986213684
loss_pred:0.029972363263368607, decouple_loss:0.002640486927703023
loss_pred:0.02926354669034481, decouple_loss:0.002735865069553256
WV_0_PC_0_EH_1_PS_40, loss: 0.030291080474853516, avg_mse: 0.046037353575229645
current test mse: 0.046037
Iteration: 7791, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4397631287574768
The generated pressure mean: 0.4467772841453552loss_pred:0.017381787300109863, decouple_loss:0.002301992615684867
loss_pred:0.016074499115347862, decouple_loss:0.0021167979575693607
The generated pressure mean: 0.442534863948822
loss_pred:0.01626596972346306, decouple_loss:0.0021614667493849993
Iteration: 7792, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44566065073013306
loss_pred:0.018558956682682037, decouple_loss:0.0020913626067340374
The generated pressure mean: 0.4502425789833069
loss_pred:0.01902550272643566, decouple_loss:0.002029670402407646
The generated pressure mean: 0.4470842778682709
loss_pred:0.01700335182249546, decouple_loss:0.002139282412827015
Iteration: 7793, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.438341349363327
loss_pred:0.01708262227475643, decouple_loss:0.002158168936148286
The generated pressure mean: 0.4387442171573639
loss_pred:0.017651908099651337, decouple_loss:0.0022473137360066175
The generated pressure mean: 0.4406735599040985
loss_pred:0.015996551141142845, decouple_loss:0.002148255007341504
Iteration: 7794, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45228832960128784
loss_pred:0.01570408046245575, decouple_loss:0.0027458895929157734
The generated pressure mean: 0.45813825726509094
loss_pred:0.015767281875014305, decouple_loss:0.00291429809294641
The generated pressure mean: 0.455952525138855
loss_pred:0.016260897740721703, decouple_loss:0.0027503673918545246
Iteration: 7795, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46121951937675476
loss_pred:0.01725168526172638, decouple_loss:0.0023637781850993633
The generated pressure mean: 0.45859184861183167
loss_pred:0.015605401247739792, decouple_loss:0.0026145719457417727
The generated pressure mean: 0.4624698758125305
loss_pred:0.016330670565366745, decouple_loss:0.0025498648174107075
Iteration: 7796, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4402103126049042
loss_pred:0.0169810988008976, decouple_loss:0.0022463456261903048
The generated pressure mean: 0.4408201575279236
loss_pred:0.01825815625488758, decouple_loss:0.0023151044733822346
The generated pressure mean: 0.43748196959495544
loss_pred:0.017046276479959488, decouple_loss:0.002412961795926094
Iteration: 7797, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4331066310405731
loss_pred:0.01762120984494686, decouple_loss:0.0024239590857177973
The generated pressure mean: 0.42946940660476685
loss_pred:0.01740095391869545, decouple_loss:0.0024899705313146114
The generated pressure mean: 0.4297068119049072
loss_pred:0.0180344358086586, decouple_loss:0.0025328416377305984
Iteration: 7798, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45014944672584534
loss_pred:0.016968054696917534, decouple_loss:0.002277584047988057
The generated pressure mean: 0.4498814046382904
loss_pred:0.01803189143538475, decouple_loss:0.0023314792197197676
The generated pressure mean: 0.45485517382621765
loss_pred:0.01619795896112919, decouple_loss:0.002376620890572667
Iteration: 7799, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46163636445999146
loss_pred:0.017200065776705742, decouple_loss:0.002742221811786294
The generated pressure mean: 0.45732179284095764
loss_pred:0.01893436163663864, decouple_loss:0.0026662375312298536
The generated pressure mean: 0.4594767987728119
loss_pred:0.016866488382220268, decouple_loss:0.002428998239338398
Iteration: 7800, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4423363208770752
loss_pred:0.017033377662301064, decouple_loss:0.002764682751148939
The generated pressure mean: 0.44303715229034424
loss_pred:0.016056515276432037, decouple_loss:0.002788101090118289
The generated pressure mean: 0.44365495443344116
loss_pred:0.016673093661665916, decouple_loss:0.002650144975632429
2023-04-17 17:02:12 testing...
The generated pressure mean: 0.4229375422000885
The generated pressure mean: 0.4150380492210388
loss_pred:0.03015434928238392, decouple_loss:0.0024798766244202852
The generated pressure mean: 0.42571911215782166
loss_pred:0.031284790486097336, decouple_loss:0.0022564143873751163
loss_pred:0.029714122414588928, decouple_loss:0.0026046966668218374
WV_0_PC_0_EH_1_PS_40, loss: 0.030506771057844162, avg_mse: 0.04655037447810173
current test mse: 0.04655
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 7801, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475948214530945
loss_pred:0.018797772005200386, decouple_loss:0.0019257623935118318
The generated pressure mean: 0.44000157713890076
loss_pred:0.019093172624707222, decouple_loss:0.001924254116602242
The generated pressure mean: 0.44113877415657043
loss_pred:0.018943974748253822, decouple_loss:0.0018774900818243623
Iteration: 7802, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4467522203922272The generated pressure mean: 0.452749103307724
loss_pred:0.02025071159005165, decouple_loss:0.0023466998245567083
loss_pred:0.01778491400182247, decouple_loss:0.002272135578095913
The generated pressure mean: 0.448639452457428
loss_pred:0.019711941480636597, decouple_loss:0.002317770617082715
Iteration: 7803, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44864848256111145
The generated pressure mean: 0.446920245885849
loss_pred:0.018059896305203438, decouple_loss:0.0024659931659698486
loss_pred:0.017511507496237755, decouple_loss:0.0024422197602689266
The generated pressure mean: 0.4479539096355438
loss_pred:0.017535202205181122, decouple_loss:0.002553865546360612
Iteration: 7804, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44955724477767944
The generated pressure mean: 0.44937559962272644
loss_pred:0.018207401037216187, decouple_loss:0.002089858055114746
loss_pred:0.018473820760846138, decouple_loss:0.0020113284699618816
The generated pressure mean: 0.44900718331336975
loss_pred:0.018177002668380737, decouple_loss:0.0020320212934166193
Iteration: 7805, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466460049152374
The generated pressure mean: 0.44465771317481995
loss_pred:0.017057057470083237, decouple_loss:0.001958850072696805
loss_pred:0.0174748245626688, decouple_loss:0.0020873257890343666
The generated pressure mean: 0.44330066442489624
loss_pred:0.021003996953368187, decouple_loss:0.0021244718227535486
Iteration: 7806, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4418981671333313
The generated pressure mean: 0.4426921308040619
loss_pred:0.017944278195500374, decouple_loss:0.0022365953773260117
loss_pred:0.017768805846571922, decouple_loss:0.0023005162365734577
The generated pressure mean: 0.44336506724357605
loss_pred:0.016817964613437653, decouple_loss:0.0022018891759216785
Iteration: 7807, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506056308746338
The generated pressure mean: 0.4529656171798706
loss_pred:0.018072018399834633, decouple_loss:0.0025765420868992805
loss_pred:0.01732964999973774, decouple_loss:0.0023901585955172777
The generated pressure mean: 0.448916494846344
loss_pred:0.018854016438126564, decouple_loss:0.0024864585138857365
Iteration: 7808, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45892781019210815
The generated pressure mean: 0.457201212644577
loss_pred:0.01818271540105343, decouple_loss:0.0023701388854533434
loss_pred:0.017400505021214485, decouple_loss:0.0021881673019379377
The generated pressure mean: 0.4594070315361023
loss_pred:0.017453840002417564, decouple_loss:0.0022456124424934387
Iteration: 7809, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44146957993507385
The generated pressure mean: 0.44340065121650696
loss_pred:0.01793532818555832, decouple_loss:0.002549172379076481
loss_pred:0.01788829267024994, decouple_loss:0.0025137620978057384
The generated pressure mean: 0.4426359534263611
loss_pred:0.01830204203724861, decouple_loss:0.002500725444406271
Iteration: 7810, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4440668523311615
loss_pred:0.018271969631314278, decouple_loss:0.0020978779066354036
The generated pressure mean: 0.4439012110233307
loss_pred:0.01752501353621483, decouple_loss:0.0019665418658405542
The generated pressure mean: 0.44452351331710815
loss_pred:0.016622290015220642, decouple_loss:0.0019955651368945837
2023-04-17 17:04:41 testing...
The generated pressure mean: 0.42068198323249817
The generated pressure mean: 0.4132314622402191
loss_pred:0.030510440468788147, decouple_loss:0.0033205277286469936
The generated pressure mean: 0.42412710189819336
loss_pred:0.03204430639743805, decouple_loss:0.0031362995505332947
loss_pred:0.02972828410565853, decouple_loss:0.003450940130278468
WV_0_PC_0_EH_1_PS_40, loss: 0.030926141887903214, avg_mse: 0.04762648418545723
current test mse: 0.047626
Iteration: 7811, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44880738854408264
loss_pred:0.016864236444234848, decouple_loss:0.0028249500319361687
The generated pressure mean: 0.4506514370441437
loss_pred:0.017058489844202995, decouple_loss:0.0028212335892021656
The generated pressure mean: 0.44847142696380615
loss_pred:0.01752428710460663, decouple_loss:0.0029039049986749887
Iteration: 7812, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45182254910469055The generated pressure mean: 0.4485952854156494
loss_pred:0.018375813961029053, decouple_loss:0.0023262922186404467
loss_pred:0.01758400909602642, decouple_loss:0.0025158023927360773
The generated pressure mean: 0.4479985237121582
loss_pred:0.015957564115524292, decouple_loss:0.002357828663662076
Iteration: 7813, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44764095544815063
The generated pressure mean: 0.4502801299095154
loss_pred:0.017781682312488556, decouple_loss:0.0027964299079030752
loss_pred:0.01563454605638981, decouple_loss:0.002802884206175804
The generated pressure mean: 0.4478796720504761
loss_pred:0.017526855692267418, decouple_loss:0.0028623081743717194
Iteration: 7814, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465436041355133
loss_pred:0.016750702634453773, decouple_loss:0.002879614010453224
The generated pressure mean: 0.4485662281513214
loss_pred:0.016339952126145363, decouple_loss:0.0029013638850301504
The generated pressure mean: 0.44656869769096375
loss_pred:0.01813291199505329, decouple_loss:0.0029610327910631895
Iteration: 7815, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44649234414100647
The generated pressure mean: 0.4433983564376831
loss_pred:0.017978252843022346, decouple_loss:0.0031784321181476116
loss_pred:0.017856277525424957, decouple_loss:0.0031235981732606888
The generated pressure mean: 0.4469428062438965
loss_pred:0.017054008319973946, decouple_loss:0.0032189595513045788
Iteration: 7816, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461686611175537
The generated pressure mean: 0.44919300079345703
loss_pred:0.01747034303843975, decouple_loss:0.0025287161115556955
loss_pred:0.019282348453998566, decouple_loss:0.0024360481183975935
The generated pressure mean: 0.44769322872161865
loss_pred:0.01584681123495102, decouple_loss:0.002395366318523884
Iteration: 7817, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4408157765865326
loss_pred:0.017685089260339737, decouple_loss:0.0032490738667547703
The generated pressure mean: 0.4420546293258667
loss_pred:0.018957050517201424, decouple_loss:0.0030894416850060225
The generated pressure mean: 0.439943790435791
loss_pred:0.01793706975877285, decouple_loss:0.0032030767761170864
Iteration: 7818, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4591771066188812
loss_pred:0.017401644960045815, decouple_loss:0.0026177477557212114
The generated pressure mean: 0.4534938931465149
loss_pred:0.016743775457143784, decouple_loss:0.0025805404875427485
The generated pressure mean: 0.4561222493648529
loss_pred:0.01838340237736702, decouple_loss:0.0025202513206750154
Iteration: 7819, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44918498396873474
loss_pred:0.017000749707221985, decouple_loss:0.003096451051533222
The generated pressure mean: 0.45298781991004944
loss_pred:0.019085528329014778, decouple_loss:0.0029359059408307076
The generated pressure mean: 0.4547712802886963
loss_pred:0.016832664608955383, decouple_loss:0.0030490730423480272
Iteration: 7820, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44124284386634827
loss_pred:0.01738051511347294, decouple_loss:0.0025373022072017193
The generated pressure mean: 0.4410821497440338
loss_pred:0.016932273283600807, decouple_loss:0.002354654483497143
The generated pressure mean: 0.44087710976600647
loss_pred:0.017494210973381996, decouple_loss:0.0024989861994981766
2023-04-17 17:06:34 testing...
The generated pressure mean: 0.413769394159317
The generated pressure mean: 0.4201832413673401
The generated pressure mean: 0.4240013062953949
loss_pred:0.03224099799990654, decouple_loss:0.002583242952823639
loss_pred:0.031060848385095596, decouple_loss:0.00278639979660511
loss_pred:0.030196413397789, decouple_loss:0.002883549313992262
WV_0_PC_0_EH_1_PS_40, loss: 0.03130364418029785, avg_mse: 0.04826285317540169
current test mse: 0.048263
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 7821, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44687986373901367
loss_pred:0.017229929566383362, decouple_loss:0.0022831596434116364
The generated pressure mean: 0.4434340298175812
loss_pred:0.0167526938021183, decouple_loss:0.0021992663387209177
The generated pressure mean: 0.44810301065444946
loss_pred:0.017224417999386787, decouple_loss:0.00217806757427752
Iteration: 7822, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4538760185241699
The generated pressure mean: 0.45222756266593933
loss_pred:0.016762617975473404, decouple_loss:0.00267453258857131
loss_pred:0.017214875668287277, decouple_loss:0.0027499005664139986
The generated pressure mean: 0.4509320855140686
loss_pred:0.0176239013671875, decouple_loss:0.0027350110467523336
Iteration: 7823, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4454060196876526The generated pressure mean: 0.4472295343875885
loss_pred:0.017129993066191673, decouple_loss:0.0022777935955673456
loss_pred:0.016801750287413597, decouple_loss:0.002265379298478365
The generated pressure mean: 0.4476589262485504
loss_pred:0.017697403207421303, decouple_loss:0.002213495085015893
Iteration: 7824, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44731947779655457
The generated pressure mean: 0.44919708371162415
loss_pred:0.016866469755768776, decouple_loss:0.0026306251529604197
loss_pred:0.018103284761309624, decouple_loss:0.002333610551431775
The generated pressure mean: 0.45170924067497253
loss_pred:0.018281470984220505, decouple_loss:0.0025472126435488462
Iteration: 7825, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44908976554870605
The generated pressure mean: 0.44986751675605774
loss_pred:0.016974642872810364, decouple_loss:0.0029296050779521465
loss_pred:0.01850021444261074, decouple_loss:0.003013388253748417
The generated pressure mean: 0.4462229311466217
loss_pred:0.018158163875341415, decouple_loss:0.0028021391481161118
Iteration: 7826, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473612904548645
The generated pressure mean: 0.4404752850532532
loss_pred:0.01723415032029152, decouple_loss:0.002371425274759531
loss_pred:0.019010407850146294, decouple_loss:0.0023634566459804773
The generated pressure mean: 0.44787317514419556
loss_pred:0.01708080619573593, decouple_loss:0.002439122414216399
Iteration: 7827, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44366252422332764
The generated pressure mean: 0.44339442253112793
loss_pred:0.01848682016134262, decouple_loss:0.002019447972998023
loss_pred:0.015657279640436172, decouple_loss:0.0019625755958259106
The generated pressure mean: 0.44729042053222656
loss_pred:0.017787376418709755, decouple_loss:0.002026117406785488
Iteration: 7828, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4549502432346344
The generated pressure mean: 0.4502032995223999
loss_pred:0.017509091645479202, decouple_loss:0.0023719763848930597
loss_pred:0.01793687790632248, decouple_loss:0.002473733853548765
The generated pressure mean: 0.45605039596557617
loss_pred:0.018197767436504364, decouple_loss:0.0023016755003482103
Iteration: 7829, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44568008184432983
The generated pressure mean: 0.4425802528858185
loss_pred:0.01906532607972622, decouple_loss:0.0021100607700645924
loss_pred:0.019571051001548767, decouple_loss:0.0021691578440368176
The generated pressure mean: 0.44776326417922974
loss_pred:0.01786937564611435, decouple_loss:0.0020696900319308043
Iteration: 7830, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4392429292201996
The generated pressure mean: 0.43986907601356506
loss_pred:0.01683330163359642, decouple_loss:0.001961632864549756
loss_pred:0.01697966642677784, decouple_loss:0.0019361870363354683
The generated pressure mean: 0.4433344602584839
loss_pred:0.0175019521266222, decouple_loss:0.0019602980464696884
2023-04-17 17:09:09 testing...
The generated pressure mean: 0.4142344295978546
The generated pressure mean: 0.4216398298740387
The generated pressure mean: 0.42459821701049805
loss_pred:0.031402215361595154, decouple_loss:0.0026536709628999233
loss_pred:0.030404798686504364, decouple_loss:0.002843061462044716
loss_pred:0.029578015208244324, decouple_loss:0.0028839255683124065
WV_0_PC_0_EH_1_PS_40, loss: 0.03060135245323181, avg_mse: 0.04670535400509834
current test mse: 0.046705
Iteration: 7831, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492323100566864
loss_pred:0.01833355240523815, decouple_loss:0.002051400952041149
The generated pressure mean: 0.44911861419677734
loss_pred:0.01760120317339897, decouple_loss:0.002101385733112693
The generated pressure mean: 0.4522917568683624
loss_pred:0.018561242148280144, decouple_loss:0.0021590471733361483
Iteration: 7832, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44919466972351074
loss_pred:0.01826365664601326, decouple_loss:0.0022143672686070204
The generated pressure mean: 0.4531294107437134
loss_pred:0.01653389446437359, decouple_loss:0.0021194780711084604
The generated pressure mean: 0.4535790681838989
loss_pred:0.01699434593319893, decouple_loss:0.002337382175028324
Iteration: 7833, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44231656193733215
The generated pressure mean: 0.44917380809783936
loss_pred:0.016858957707881927, decouple_loss:0.0025491451378911734
loss_pred:0.017848454415798187, decouple_loss:0.0027042271103709936
The generated pressure mean: 0.44715920090675354
loss_pred:0.017080245539546013, decouple_loss:0.0025376782286912203
Iteration: 7834, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479363262653351
The generated pressure mean: 0.4494929313659668
loss_pred:0.016893431544303894, decouple_loss:0.0025885452050715685
loss_pred:0.017471419647336006, decouple_loss:0.00254439958371222
The generated pressure mean: 0.4438493251800537
loss_pred:0.017147887498140335, decouple_loss:0.00268438458442688
Iteration: 7835, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45042744278907776
loss_pred:0.01772911101579666, decouple_loss:0.002330249175429344
The generated pressure mean: 0.44945767521858215
loss_pred:0.018935801461338997, decouple_loss:0.0022908204700797796
The generated pressure mean: 0.4504445791244507
loss_pred:0.017054537311196327, decouple_loss:0.0021917999256402254
Iteration: 7836, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4519634246826172
loss_pred:0.016464626416563988, decouple_loss:0.0027472148649394512
The generated pressure mean: 0.4501946270465851
loss_pred:0.017935892567038536, decouple_loss:0.0026997795794159174
The generated pressure mean: 0.4477193355560303
loss_pred:0.017314506694674492, decouple_loss:0.0026317029260098934
Iteration: 7837, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44762104749679565
loss_pred:0.01640745997428894, decouple_loss:0.0030931304208934307
The generated pressure mean: 0.44937944412231445
loss_pred:0.01860523596405983, decouple_loss:0.00297965994104743
The generated pressure mean: 0.4404633939266205
loss_pred:0.017492907121777534, decouple_loss:0.003101889742538333
Iteration: 7838, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44171199202537537
The generated pressure mean: 0.44515326619148254
loss_pred:0.018741006031632423, decouple_loss:0.0019897555466741323
loss_pred:0.017109310254454613, decouple_loss:0.0019107647240161896
The generated pressure mean: 0.4421958923339844
loss_pred:0.019107872620224953, decouple_loss:0.0020264822524040937
Iteration: 7839, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4554423391819
loss_pred:0.016796447336673737, decouple_loss:0.0029129707254469395
The generated pressure mean: 0.4566783308982849
loss_pred:0.017389267683029175, decouple_loss:0.003077253233641386
The generated pressure mean: 0.4510393738746643
loss_pred:0.018972201272845268, decouple_loss:0.0030771722085773945
Iteration: 7840, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484034478664398
loss_pred:0.017494842410087585, decouple_loss:0.0025320788845419884
The generated pressure mean: 0.4460182785987854
loss_pred:0.017265310510993004, decouple_loss:0.002490916522219777
The generated pressure mean: 0.4503301680088043
loss_pred:0.017605716362595558, decouple_loss:0.0023920321837067604
2023-04-17 17:11:02 testing...
The generated pressure mean: 0.42069384455680847
The generated pressure mean: 0.41447368264198303
loss_pred:0.02991633303463459, decouple_loss:0.0028228990267962217
The generated pressure mean: 0.42362841963768005
loss_pred:0.03098989464342594, decouple_loss:0.0026080503594130278
loss_pred:0.0295217614620924, decouple_loss:0.002980377059429884
WV_0_PC_0_EH_1_PS_40, loss: 0.030282851308584213, avg_mse: 0.04577356576919556
current test mse: 0.045774
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 7841, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4434320032596588
loss_pred:0.018285268917679787, decouple_loss:0.002149202860891819The generated pressure mean: 0.4412538707256317
loss_pred:0.016414403915405273, decouple_loss:0.0021745197009295225
The generated pressure mean: 0.4404398202896118
loss_pred:0.019203951582312584, decouple_loss:0.0021934667602181435
Iteration: 7842, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44634589552879333
loss_pred:0.016177833080291748, decouple_loss:0.0033134822733700275
The generated pressure mean: 0.44275200366973877
loss_pred:0.01740824244916439, decouple_loss:0.0031956953462213278
The generated pressure mean: 0.4430045187473297
loss_pred:0.017766235396265984, decouple_loss:0.003249079454690218
Iteration: 7843, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45858848094940186The generated pressure mean: 0.45974329113960266
loss_pred:0.017270782962441444, decouple_loss:0.002398920012637973
loss_pred:0.01735541969537735, decouple_loss:0.0023940971586853266
The generated pressure mean: 0.4590700566768646
loss_pred:0.017358331009745598, decouple_loss:0.002341565443202853
Iteration: 7844, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44802552461624146
The generated pressure mean: 0.4457537531852722
loss_pred:0.017312215641140938, decouple_loss:0.003431699238717556
loss_pred:0.017735138535499573, decouple_loss:0.0033351026941090822
The generated pressure mean: 0.4473091661930084
loss_pred:0.01721044071018696, decouple_loss:0.003459702245891094
Iteration: 7845, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4388938248157501
The generated pressure mean: 0.4391758441925049
loss_pred:0.020450398325920105, decouple_loss:0.002526873257011175
loss_pred:0.016524584963917732, decouple_loss:0.002452289452776313
The generated pressure mean: 0.4378401041030884
loss_pred:0.016362439841032028, decouple_loss:0.0024956802371889353
Iteration: 7846, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4422968626022339
loss_pred:0.016027599573135376, decouple_loss:0.0028020490426570177
The generated pressure mean: 0.44026294350624084
loss_pred:0.016342056915163994, decouple_loss:0.0027817690279334784
The generated pressure mean: 0.4420141577720642
loss_pred:0.017391962930560112, decouple_loss:0.002816179534420371
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 7847, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45518937706947327
The generated pressure mean: 0.4489000141620636
loss_pred:0.01716657541692257, decouple_loss:0.0024348015431314707
loss_pred:0.01954744942486286, decouple_loss:0.002403995720669627
The generated pressure mean: 0.45520156621932983
loss_pred:0.0167145524173975, decouple_loss:0.0024455462116748095
Iteration: 7848, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45334598422050476
loss_pred:0.01783686690032482, decouple_loss:0.0021276837214827538
The generated pressure mean: 0.44497567415237427
loss_pred:0.01711740903556347, decouple_loss:0.0021830324549227953
The generated pressure mean: 0.4463679790496826
loss_pred:0.017726833000779152, decouple_loss:0.002127233427017927
Iteration: 7849, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499529004096985
The generated pressure mean: 0.4454883337020874
loss_pred:0.01796218752861023, decouple_loss:0.002409811830148101
loss_pred:0.01656479947268963, decouple_loss:0.002208064077422023
The generated pressure mean: 0.448564738035202
loss_pred:0.017810940742492676, decouple_loss:0.0024483988527208567
Iteration: 7850, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4440467655658722
loss_pred:0.01705458015203476, decouple_loss:0.0025898378808051348
The generated pressure mean: 0.444175124168396
loss_pred:0.01778583601117134, decouple_loss:0.0026295760180801153
The generated pressure mean: 0.4416586458683014
loss_pred:0.015995144844055176, decouple_loss:0.002517314860597253
2023-04-17 17:13:33 testing...
The generated pressure mean: 0.41457146406173706
The generated pressure mean: 0.42174220085144043
The generated pressure mean: 0.42517924308776855
loss_pred:0.030903030186891556, decouple_loss:0.0025013312697410583
loss_pred:0.02976011484861374, decouple_loss:0.0027046671602874994
loss_pred:0.028861025348305702, decouple_loss:0.002763081109151244
WV_0_PC_0_EH_1_PS_40, loss: 0.029974211007356644, avg_mse: 0.045829035341739655
current test mse: 0.045829
Iteration: 7851, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.443150132894516
The generated pressure mean: 0.4434773325920105
loss_pred:0.017045386135578156, decouple_loss:0.002057043369859457
loss_pred:0.017446178942918777, decouple_loss:0.0021648744586855173
The generated pressure mean: 0.44213932752609253
loss_pred:0.017587943002581596, decouple_loss:0.0021266371477395296
Iteration: 7852, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4509766399860382
The generated pressure mean: 0.44866812229156494
loss_pred:0.01871815137565136, decouple_loss:0.002560662804171443
loss_pred:0.018286308273673058, decouple_loss:0.0024402132257819176
The generated pressure mean: 0.45173612236976624
loss_pred:0.018467172980308533, decouple_loss:0.0025156810879707336
Iteration: 7853, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493101239204407
The generated pressure mean: 0.44940313696861267
loss_pred:0.01892644725739956, decouple_loss:0.0028030872344970703
loss_pred:0.016973158344626427, decouple_loss:0.0027904766611754894
The generated pressure mean: 0.4483506679534912
loss_pred:0.016680296510457993, decouple_loss:0.0027712532319128513
Iteration: 7854, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44067689776420593
The generated pressure mean: 0.44398146867752075
loss_pred:0.016276277601718903, decouple_loss:0.0022138049826025963
loss_pred:0.01687706634402275, decouple_loss:0.0021405622828751802
The generated pressure mean: 0.4420837163925171
loss_pred:0.016863251104950905, decouple_loss:0.002315141726285219
Iteration: 7855, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4440107047557831
loss_pred:0.01597513258457184, decouple_loss:0.001971706748008728
The generated pressure mean: 0.4460276961326599
loss_pred:0.019902797415852547, decouple_loss:0.001963541842997074
The generated pressure mean: 0.4429705739021301
loss_pred:0.01797470450401306, decouple_loss:0.002031495328992605
Iteration: 7856, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44533953070640564
The generated pressure mean: 0.444600909948349
loss_pred:0.01747468113899231, decouple_loss:0.002192053245380521
loss_pred:0.018620500341057777, decouple_loss:0.0022029613610357046
The generated pressure mean: 0.4461498558521271
loss_pred:0.01825028471648693, decouple_loss:0.0023133226204663515
Iteration: 7857, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45174360275268555
loss_pred:0.017783869057893753, decouple_loss:0.002440835116431117
The generated pressure mean: 0.45108720660209656
loss_pred:0.0161530002951622, decouple_loss:0.0023775137960910797
The generated pressure mean: 0.45968395471572876
loss_pred:0.017214838415384293, decouple_loss:0.002649200614541769
Iteration: 7858, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44753867387771606
loss_pred:0.01717107743024826, decouple_loss:0.0029740643221884966
The generated pressure mean: 0.4492039382457733
loss_pred:0.017706504091620445, decouple_loss:0.0029755050782114267
The generated pressure mean: 0.4466952085494995
loss_pred:0.017091190442442894, decouple_loss:0.0030628845561295748
Iteration: 7859, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43888214230537415
The generated pressure mean: 0.4408057630062103
loss_pred:0.018342992290854454, decouple_loss:0.002577462000772357
loss_pred:0.016507748514413834, decouple_loss:0.002515773056074977
The generated pressure mean: 0.43696722388267517
loss_pred:0.016899703070521355, decouple_loss:0.002521862043067813
Iteration: 7860, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.445854127407074
loss_pred:0.021548068150877953, decouple_loss:0.0023497275542467833
The generated pressure mean: 0.44709211587905884
loss_pred:0.017024975270032883, decouple_loss:0.0022736298851668835
The generated pressure mean: 0.44726788997650146
loss_pred:0.017224032431840897, decouple_loss:0.002355736680328846
2023-04-17 17:15:26 testing...
The generated pressure mean: 0.41296347975730896
The generated pressure mean: 0.4206990599632263
loss_pred:0.03134523704648018, decouple_loss:0.0028902976773679256
The generated pressure mean: 0.42386898398399353
loss_pred:0.03013419732451439, decouple_loss:0.0030438913963735104
loss_pred:0.02918221428990364, decouple_loss:0.0031284529250115156
WV_0_PC_0_EH_1_PS_40, loss: 0.030371595174074173, avg_mse: 0.04684250429272652
current test mse: 0.046843
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 7861, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44175708293914795
loss_pred:0.017376208677887917, decouple_loss:0.002612863900139928
The generated pressure mean: 0.4443637728691101
loss_pred:0.018887264654040337, decouple_loss:0.002606389345601201
The generated pressure mean: 0.4431360065937042
loss_pred:0.017199059948325157, decouple_loss:0.0025009741075336933
Iteration: 7862, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45816096663475037
The generated pressure mean: 0.45765531063079834
loss_pred:0.017526274546980858, decouple_loss:0.002360450802370906
loss_pred:0.017055779695510864, decouple_loss:0.002292195800691843
The generated pressure mean: 0.4546750485897064
loss_pred:0.01602230593562126, decouple_loss:0.0023304626811295748
Iteration: 7863, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44782310724258423
The generated pressure mean: 0.45336559414863586
loss_pred:0.017118852585554123, decouple_loss:0.0026101351249963045
loss_pred:0.017338456586003304, decouple_loss:0.0026174932718276978
The generated pressure mean: 0.44751280546188354
loss_pred:0.01585901714861393, decouple_loss:0.0026287853252142668
Iteration: 7864, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4367293119430542
loss_pred:0.018490666523575783, decouple_loss:0.0023936969228088856
The generated pressure mean: 0.4346541166305542
loss_pred:0.018130099400877953, decouple_loss:0.002378028118982911
The generated pressure mean: 0.43100613355636597
loss_pred:0.016697272658348083, decouple_loss:0.0022361997980624437
Iteration: 7865, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45144709944725037
The generated pressure mean: 0.44637331366539loss_pred:0.019131721928715706, decouple_loss:0.002111703623086214
loss_pred:0.016532497480511665, decouple_loss:0.002014141296967864
The generated pressure mean: 0.452193021774292
loss_pred:0.017834855243563652, decouple_loss:0.0022041385527700186
Iteration: 7866, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44922730326652527
The generated pressure mean: 0.449348509311676loss_pred:0.016396543011069298, decouple_loss:0.0026396841276437044
loss_pred:0.018982628360390663, decouple_loss:0.002546496456488967
The generated pressure mean: 0.45279982686042786
loss_pred:0.01695500686764717, decouple_loss:0.0026373511645942926
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 7867, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44059479236602783
loss_pred:0.017010541632771492, decouple_loss:0.0023412525188177824
The generated pressure mean: 0.4432591497898102
loss_pred:0.016913635656237602, decouple_loss:0.0021912117954343557
The generated pressure mean: 0.4406716823577881
loss_pred:0.01757814548909664, decouple_loss:0.002194712869822979
Iteration: 7868, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4506835341453552
The generated pressure mean: 0.44785043597221375
loss_pred:0.016625620424747467, decouple_loss:0.0021350712049752474
loss_pred:0.01796942949295044, decouple_loss:0.0020801424980163574
The generated pressure mean: 0.4494245648384094
loss_pred:0.017053501680493355, decouple_loss:0.0021768994629383087
Iteration: 7869, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45718783140182495
The generated pressure mean: 0.45607811212539673
loss_pred:0.017840107902884483, decouple_loss:0.00256532384082675
loss_pred:0.017631813883781433, decouple_loss:0.0023065339773893356
The generated pressure mean: 0.4534275531768799
loss_pred:0.01605163887143135, decouple_loss:0.0023664121981710196
Iteration: 7870, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43941983580589294
loss_pred:0.01713760569691658, decouple_loss:0.0022441940382122993
The generated pressure mean: 0.44740283489227295
loss_pred:0.01860802248120308, decouple_loss:0.00221831351518631
The generated pressure mean: 0.4410005509853363
loss_pred:0.01714896969497204, decouple_loss:0.002210145816206932
2023-04-17 17:17:57 testing...
The generated pressure mean: 0.4234905242919922
The generated pressure mean: 0.41646113991737366
loss_pred:0.029631199315190315, decouple_loss:0.0024823143612593412
The generated pressure mean: 0.42649224400520325
loss_pred:0.03043142519891262, decouple_loss:0.0023540868423879147
loss_pred:0.02870311588048935, decouple_loss:0.0026038531213998795
WV_0_PC_0_EH_1_PS_40, loss: 0.029712585732340813, avg_mse: 0.045028574764728546
current test mse: 0.045029
Iteration: 7871, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43439343571662903
loss_pred:0.018380364403128624, decouple_loss:0.0019710382912307978
The generated pressure mean: 0.4322364330291748
loss_pred:0.0164790078997612, decouple_loss:0.0019758662674576044
The generated pressure mean: 0.4339258372783661
loss_pred:0.016071254387497902, decouple_loss:0.0018578593153506517
Iteration: 7872, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4602867364883423
loss_pred:0.016547363251447678, decouple_loss:0.002082014689221978
The generated pressure mean: 0.4599563479423523
loss_pred:0.017475590109825134, decouple_loss:0.0021773376502096653
The generated pressure mean: 0.4625002145767212
loss_pred:0.016598451882600784, decouple_loss:0.002102217637002468
Iteration: 7873, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4542892277240753
loss_pred:0.018829692155122757, decouple_loss:0.002240033820271492
The generated pressure mean: 0.45064979791641235
loss_pred:0.017138095572590828, decouple_loss:0.002227507531642914
The generated pressure mean: 0.450162798166275
loss_pred:0.016667939722537994, decouple_loss:0.0022444159258157015
Iteration: 7874, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4351179599761963
loss_pred:0.016323916614055634, decouple_loss:0.0021711280569434166
The generated pressure mean: 0.4366176724433899
loss_pred:0.017084985971450806, decouple_loss:0.002256685635074973
The generated pressure mean: 0.433312326669693
loss_pred:0.0171031653881073, decouple_loss:0.002186946105211973
Iteration: 7875, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44862160086631775
loss_pred:0.018049830570816994, decouple_loss:0.0023221303708851337
The generated pressure mean: 0.448184609413147
loss_pred:0.01688516139984131, decouple_loss:0.0022323415614664555
The generated pressure mean: 0.450948566198349
loss_pred:0.01845177263021469, decouple_loss:0.002268092939630151
Iteration: 7876, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44861093163490295
loss_pred:0.018704507499933243, decouple_loss:0.0024368728045374155
The generated pressure mean: 0.4478265047073364
loss_pred:0.017450161278247833, decouple_loss:0.002360397484153509
The generated pressure mean: 0.45054835081100464
loss_pred:0.017092127352952957, decouple_loss:0.002273584483191371
Iteration: 7877, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44235238432884216
loss_pred:0.018149765208363533, decouple_loss:0.002448506187647581
The generated pressure mean: 0.4445631504058838
loss_pred:0.016930121928453445, decouple_loss:0.0025673178024590015
The generated pressure mean: 0.4432487487792969
loss_pred:0.018466366454958916, decouple_loss:0.0024804603308439255
Iteration: 7878, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464159905910492
loss_pred:0.017161734402179718, decouple_loss:0.002025595400482416
The generated pressure mean: 0.4476470351219177
loss_pred:0.016510577872395515, decouple_loss:0.002087980043143034
The generated pressure mean: 0.44347721338272095
loss_pred:0.015996640548110008, decouple_loss:0.002102523110806942
Iteration: 7879, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45410290360450745
loss_pred:0.016012277454137802, decouple_loss:0.002039336133748293
The generated pressure mean: 0.4541688859462738
loss_pred:0.018874550238251686, decouple_loss:0.0020259455777704716
The generated pressure mean: 0.4505069851875305
loss_pred:0.015639547258615494, decouple_loss:0.00194063363596797
Iteration: 7880, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4445400834083557
loss_pred:0.01683077961206436, decouple_loss:0.0017091094050556421
The generated pressure mean: 0.44309571385383606
loss_pred:0.018391963094472885, decouple_loss:0.0017469539307057858
The generated pressure mean: 0.4446714520454407
loss_pred:0.018401481211185455, decouple_loss:0.001816531759686768
2023-04-17 17:19:51 testing...
The generated pressure mean: 0.4136163592338562
The generated pressure mean: 0.4197465777397156
The generated pressure mean: 0.42230424284935
loss_pred:0.031373728066682816, decouple_loss:0.0023505904246121645
loss_pred:0.030353717505931854, decouple_loss:0.002472401363775134
loss_pred:0.029972374439239502, decouple_loss:0.00266365148127079
WV_0_PC_0_EH_1_PS_40, loss: 0.03069138526916504, avg_mse: 0.04682833328843117
current test mse: 0.046828
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 7881, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44249600172042847
loss_pred:0.017667151987552643, decouple_loss:0.0018789019668474793
The generated pressure mean: 0.4436725974082947
loss_pred:0.01763051748275757, decouple_loss:0.0020122521091252565
The generated pressure mean: 0.4428708255290985
loss_pred:0.01670084521174431, decouple_loss:0.0018892069347202778
Iteration: 7882, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44803640246391296
The generated pressure mean: 0.449980229139328loss_pred:0.0174193624407053, decouple_loss:0.0023922258988022804
loss_pred:0.016088640317320824, decouple_loss:0.0025709783658385277
The generated pressure mean: 0.4445047974586487
loss_pred:0.017423557117581367, decouple_loss:0.0024804521817713976
Iteration: 7883, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45554500818252563
The generated pressure mean: 0.4534619450569153
loss_pred:0.016797196120023727, decouple_loss:0.0027295753825455904
loss_pred:0.017478497698903084, decouple_loss:0.0027168842498213053
The generated pressure mean: 0.4527426064014435
loss_pred:0.018340490758419037, decouple_loss:0.0026459337677806616
Iteration: 7884, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44738730788230896
loss_pred:0.017761290073394775, decouple_loss:0.001965318573638797
The generated pressure mean: 0.43997514247894287
loss_pred:0.015831513330340385, decouple_loss:0.001774792792275548
The generated pressure mean: 0.4470946192741394
loss_pred:0.01753944717347622, decouple_loss:0.0018767507281154394
Iteration: 7885, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44877147674560547
loss_pred:0.017368637025356293, decouple_loss:0.001865788479335606
The generated pressure mean: 0.4511127769947052
loss_pred:0.01836380735039711, decouple_loss:0.0019957758486270905
The generated pressure mean: 0.44513997435569763
loss_pred:0.01672719419002533, decouple_loss:0.0020549152977764606
Iteration: 7886, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471786618232727
loss_pred:0.01659354194998741, decouple_loss:0.0025892199482768774
The generated pressure mean: 0.4495111107826233
loss_pred:0.016197850927710533, decouple_loss:0.002576639410108328
The generated pressure mean: 0.442587673664093
loss_pred:0.01735863648355007, decouple_loss:0.002536481013521552
Iteration: 7887, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4475290775299072
loss_pred:0.014900208450853825, decouple_loss:0.0023119125980883837
The generated pressure mean: 0.44430679082870483
loss_pred:0.018702952191233635, decouple_loss:0.00234480039216578
The generated pressure mean: 0.4439777135848999
loss_pred:0.015279734507203102, decouple_loss:0.002347212750464678
Iteration: 7888, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44614604115486145
loss_pred:0.016543244943022728, decouple_loss:0.002274276688694954
The generated pressure mean: 0.45103782415390015
loss_pred:0.01726722903549671, decouple_loss:0.0022233333438634872
The generated pressure mean: 0.447933167219162
loss_pred:0.016564305871725082, decouple_loss:0.002190215513110161
Iteration: 7889, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44998541474342346
loss_pred:0.01615283451974392, decouple_loss:0.002343355678021908
The generated pressure mean: 0.45006421208381653
loss_pred:0.016855834051966667, decouple_loss:0.0024342441465705633
The generated pressure mean: 0.44910797476768494
loss_pred:0.01630566455423832, decouple_loss:0.002247678814455867
Iteration: 7890, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4535866677761078
loss_pred:0.015976613387465477, decouple_loss:0.0019816854037344456
The generated pressure mean: 0.44927358627319336
The generated pressure mean: 0.45228543877601624
loss_pred:0.01666027493774891, decouple_loss:0.0019170226296409965
loss_pred:0.018065454438328743, decouple_loss:0.0019204218406230211
2023-04-17 17:22:21 testing...
The generated pressure mean: 0.41557374596595764
The generated pressure mean: 0.4239158034324646
The generated pressure mean: 0.4275914430618286
loss_pred:0.03138995170593262, decouple_loss:0.002681517042219639
loss_pred:0.030220797285437584, decouple_loss:0.002762972377240658
loss_pred:0.02957255207002163, decouple_loss:0.002975963754579425
WV_0_PC_0_EH_1_PS_40, loss: 0.0305347740650177, avg_mse: 0.04724685847759247
current test mse: 0.047247
Iteration: 7891, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4405083656311035
loss_pred:0.018262101337313652, decouple_loss:0.0020965009462088346
The generated pressure mean: 0.4424535930156708
loss_pred:0.018509380519390106, decouple_loss:0.0020520715042948723
The generated pressure mean: 0.44787275791168213
loss_pred:0.017944613471627235, decouple_loss:0.0021812082268297672
Iteration: 7892, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4434843063354492
loss_pred:0.016927145421504974, decouple_loss:0.002649165689945221
The generated pressure mean: 0.4372420310974121
loss_pred:0.015488545410335064, decouple_loss:0.0024884312879294157
The generated pressure mean: 0.43770450353622437
loss_pred:0.016393329948186874, decouple_loss:0.0024564394261687994
Iteration: 7893, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4465559124946594
loss_pred:0.01757889613509178, decouple_loss:0.0019017924787476659
The generated pressure mean: 0.45030057430267334
loss_pred:0.017082134261727333, decouple_loss:0.0019479745533317327
The generated pressure mean: 0.44927355647087097
loss_pred:0.01758263260126114, decouple_loss:0.001997224520891905
Iteration: 7894, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491455852985382
loss_pred:0.018552977591753006, decouple_loss:0.0026970496401190758
The generated pressure mean: 0.45070701837539673
The generated pressure mean: 0.449159175157547loss_pred:0.017868030816316605, decouple_loss:0.002824465511366725
loss_pred:0.016259944066405296, decouple_loss:0.002861062763258815
Iteration: 7895, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4443398118019104
loss_pred:0.017915595322847366, decouple_loss:0.002204020507633686
The generated pressure mean: 0.441957950592041
loss_pred:0.015713082626461983, decouple_loss:0.0023856833577156067
The generated pressure mean: 0.44402065873146057
loss_pred:0.017324477434158325, decouple_loss:0.002323676599189639
Iteration: 7896, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4509738087654114
loss_pred:0.01570616289973259, decouple_loss:0.0026119903195649385
The generated pressure mean: 0.4522612988948822
loss_pred:0.01631634309887886, decouple_loss:0.0025629685260355473
The generated pressure mean: 0.45718613266944885
loss_pred:0.015547809191048145, decouple_loss:0.002778842579573393
Iteration: 7897, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44880107045173645
loss_pred:0.015857931226491928, decouple_loss:0.002053932286798954
The generated pressure mean: 0.4465898871421814
loss_pred:0.01715093106031418, decouple_loss:0.002129519358277321
The generated pressure mean: 0.454041987657547
loss_pred:0.017386408522725105, decouple_loss:0.002137917559593916
Iteration: 7898, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4438854455947876
loss_pred:0.015614256262779236, decouple_loss:0.0019065086962655187
The generated pressure mean: 0.44069042801856995
The generated pressure mean: 0.4415922164916992
loss_pred:0.01695367507636547, decouple_loss:0.0018081995658576488
loss_pred:0.016982460394501686, decouple_loss:0.0017577288672327995
Iteration: 7899, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447492390871048
loss_pred:0.015991441905498505, decouple_loss:0.0018481535371392965
The generated pressure mean: 0.4480932354927063
The generated pressure mean: 0.447208046913147
loss_pred:0.01701616868376732, decouple_loss:0.001836269861087203
loss_pred:0.016559462994337082, decouple_loss:0.0019531010184437037
Iteration: 7900, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44965845346450806
The generated pressure mean: 0.450594425201416
loss_pred:0.01811959408223629, decouple_loss:0.0019167775753885508
loss_pred:0.01735355705022812, decouple_loss:0.002136651426553726
The generated pressure mean: 0.4488927721977234
loss_pred:0.01676325313746929, decouple_loss:0.0021041755098849535
2023-04-17 17:24:14 testing...
The generated pressure mean: 0.41520583629608154
The generated pressure mean: 0.4213623106479645
loss_pred:0.03140359744429588, decouple_loss:0.0026333569549024105
The generated pressure mean: 0.4244960844516754
loss_pred:0.030359957367181778, decouple_loss:0.002884906018152833
loss_pred:0.02956000342965126, decouple_loss:0.002957922173663974
WV_0_PC_0_EH_1_PS_40, loss: 0.030582455918192863, avg_mse: 0.04644249752163887
current test mse: 0.046442
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 7901, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43706759810447693
loss_pred:0.016911258921027184, decouple_loss:0.0022794653195887804
The generated pressure mean: 0.43745553493499756
loss_pred:0.01798115484416485, decouple_loss:0.00215430511161685
The generated pressure mean: 0.4386500418186188
loss_pred:0.01657765917479992, decouple_loss:0.002224705880507827
Iteration: 7902, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44912925362586975
The generated pressure mean: 0.44925180077552795
loss_pred:0.0166027694940567, decouple_loss:0.002250466262921691
loss_pred:0.01896176114678383, decouple_loss:0.0022238290403038263
The generated pressure mean: 0.45103350281715393
loss_pred:0.01752357929944992, decouple_loss:0.002116672694683075
Iteration: 7903, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4577101469039917
The generated pressure mean: 0.4563444256782532
loss_pred:0.015988100320100784, decouple_loss:0.0018374373903498054
loss_pred:0.018765544518828392, decouple_loss:0.0019592063035815954
The generated pressure mean: 0.4574281871318817
loss_pred:0.01714974455535412, decouple_loss:0.0020186430774629116
Iteration: 7904, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44238701462745667
The generated pressure mean: 0.4434569180011749
loss_pred:0.01569190062582493, decouple_loss:0.002146343467757106
loss_pred:0.01653464324772358, decouple_loss:0.002292906865477562
The generated pressure mean: 0.4413556158542633
loss_pred:0.015516248531639576, decouple_loss:0.0021559009328484535
Iteration: 7905, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44263872504234314
The generated pressure mean: 0.44310325384140015
loss_pred:0.016476741060614586, decouple_loss:0.0018832447240129113
loss_pred:0.01801685057580471, decouple_loss:0.0020450365263968706
The generated pressure mean: 0.4452489912509918
loss_pred:0.017362313345074654, decouple_loss:0.0019237860105931759
Iteration: 7906, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44646427035331726
loss_pred:0.018644824624061584, decouple_loss:0.0021092304959893227
The generated pressure mean: 0.4503237307071686
loss_pred:0.020742030814290047, decouple_loss:0.0022176294587552547
The generated pressure mean: 0.44441384077072144
loss_pred:0.01738775707781315, decouple_loss:0.0021521763410419226
Iteration: 7907, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42622673511505127
The generated pressure mean: 0.42821192741394043
loss_pred:0.017528658732771873, decouple_loss:0.001761221094056964
loss_pred:0.017819099128246307, decouple_loss:0.001758443540893495
The generated pressure mean: 0.42666810750961304
loss_pred:0.017058053985238075, decouple_loss:0.001785143045708537
Iteration: 7908, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.457691490650177
loss_pred:0.021155428141355515, decouple_loss:0.0023062429390847683
The generated pressure mean: 0.45526859164237976
loss_pred:0.0163116455078125, decouple_loss:0.0021874706726521254
The generated pressure mean: 0.45919105410575867
loss_pred:0.017197642475366592, decouple_loss:0.0022873671259731054
Iteration: 7909, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4543420970439911
loss_pred:0.01831987127661705, decouple_loss:0.0020880650263279676
The generated pressure mean: 0.4489670991897583The generated pressure mean: 0.4501487910747528
loss_pred:0.017601482570171356, decouple_loss:0.0019481104100123048
loss_pred:0.01691305823624134, decouple_loss:0.0019187785219401121
Iteration: 7910, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45337173342704773
loss_pred:0.017313573509454727, decouple_loss:0.0027453447692096233
The generated pressure mean: 0.4492744207382202
The generated pressure mean: 0.44968754053115845
loss_pred:0.019348928704857826, decouple_loss:0.0027687656693160534
loss_pred:0.019226238131523132, decouple_loss:0.002879149280488491
2023-04-17 17:26:43 testing...
The generated pressure mean: 0.41591691970825195
The generated pressure mean: 0.42395079135894775
The generated pressure mean: 0.4271976351737976
loss_pred:0.03204261139035225, decouple_loss:0.002848193980753422
loss_pred:0.030902469530701637, decouple_loss:0.002932250499725342
loss_pred:0.03063579834997654, decouple_loss:0.002971605397760868
WV_0_PC_0_EH_1_PS_40, loss: 0.03133949637413025, avg_mse: 0.048379939049482346
current test mse: 0.04838
Iteration: 7911, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44318386912345886
loss_pred:0.017712164670228958, decouple_loss:0.0024437932297587395
The generated pressure mean: 0.44062870740890503
loss_pred:0.017942380160093307, decouple_loss:0.002360460115596652
The generated pressure mean: 0.44013503193855286
loss_pred:0.017074991017580032, decouple_loss:0.0022756627295166254
Iteration: 7912, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.441742867231369
loss_pred:0.01567297987639904, decouple_loss:0.0022071024868637323
The generated pressure mean: 0.43766239285469055
loss_pred:0.017686251550912857, decouple_loss:0.002340997802093625
The generated pressure mean: 0.4392779767513275
loss_pred:0.017163442447781563, decouple_loss:0.002197585767135024
Iteration: 7913, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44945618510246277
loss_pred:0.017850466072559357, decouple_loss:0.002452107146382332
The generated pressure mean: 0.4474326968193054
loss_pred:0.01689024828374386, decouple_loss:0.0023648948408663273
The generated pressure mean: 0.4467129707336426
loss_pred:0.016847757622599602, decouple_loss:0.0025195609778165817
Iteration: 7914, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508568346500397
loss_pred:0.01804620772600174, decouple_loss:0.0019732085056602955
The generated pressure mean: 0.45332080125808716
loss_pred:0.016336189582943916, decouple_loss:0.0020437813363969326
The generated pressure mean: 0.45314183831214905
loss_pred:0.016998717561364174, decouple_loss:0.0020168356131762266
Iteration: 7915, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4427931010723114
loss_pred:0.016650063917040825, decouple_loss:0.0019112821901217103
The generated pressure mean: 0.44451937079429626
loss_pred:0.01596945710480213, decouple_loss:0.0020401845686137676
The generated pressure mean: 0.4469431936740875
loss_pred:0.01991993375122547, decouple_loss:0.002065743785351515
Iteration: 7916, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44059455394744873
loss_pred:0.015589307062327862, decouple_loss:0.0019653933122754097
The generated pressure mean: 0.4441092312335968
loss_pred:0.01857898384332657, decouple_loss:0.001891516731120646
The generated pressure mean: 0.43908581137657166
loss_pred:0.016271289438009262, decouple_loss:0.0019047210225835443
Iteration: 7917, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45168301463127136
loss_pred:0.01699511893093586, decouple_loss:0.002287467010319233
The generated pressure mean: 0.4567224085330963
loss_pred:0.015370302833616734, decouple_loss:0.0023127745371311903
The generated pressure mean: 0.452591210603714
loss_pred:0.016463570296764374, decouple_loss:0.0023116127122193575
Iteration: 7918, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45101407170295715
loss_pred:0.01676175743341446, decouple_loss:0.0021994044072926044
The generated pressure mean: 0.4510246515274048
The generated pressure mean: 0.4513712227344513
loss_pred:0.016912326216697693, decouple_loss:0.0020510030444711447
loss_pred:0.0163570623844862, decouple_loss:0.002117551863193512
Iteration: 7919, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44346264004707336
The generated pressure mean: 0.4397304356098175
loss_pred:0.017576439306139946, decouple_loss:0.002345508662983775
loss_pred:0.016591938212513924, decouple_loss:0.002341615501791239
The generated pressure mean: 0.4450725018978119
loss_pred:0.01792987249791622, decouple_loss:0.002420396776869893
Iteration: 7920, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4398447871208191
loss_pred:0.017333492636680603, decouple_loss:0.0029435574542731047
The generated pressure mean: 0.4360922574996948
The generated pressure mean: 0.43745657801628113
loss_pred:0.01704995334148407, decouple_loss:0.0026855873875319958
loss_pred:0.017350949347019196, decouple_loss:0.002928988542407751
2023-04-17 17:28:36 testing...
The generated pressure mean: 0.41788822412490845
The generated pressure mean: 0.41127508878707886
The generated pressure mean: 0.42101001739501953
loss_pred:0.031206844374537468, decouple_loss:0.003011660184711218
loss_pred:0.032443612813949585, decouple_loss:0.0027817401569336653
loss_pred:0.030723314732313156, decouple_loss:0.003047296777367592
WV_0_PC_0_EH_1_PS_40, loss: 0.03160526975989342, avg_mse: 0.04870961233973503
current test mse: 0.04871
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 7921, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45440909266471863
The generated pressure mean: 0.45313259959220886
loss_pred:0.016847815364599228, decouple_loss:0.0024271709844470024
loss_pred:0.018261853605508804, decouple_loss:0.0025144319515675306
The generated pressure mean: 0.451096773147583
loss_pred:0.01647290401160717, decouple_loss:0.002538914093747735
Iteration: 7922, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503534734249115
The generated pressure mean: 0.4526319205760956
loss_pred:0.017971588298678398, decouple_loss:0.0019276951206848025
loss_pred:0.017540428787469864, decouple_loss:0.0019182160031050444
The generated pressure mean: 0.4498017728328705
loss_pred:0.017385460436344147, decouple_loss:0.0020939840469509363
Iteration: 7923, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4425508379936218
The generated pressure mean: 0.44303098320961
loss_pred:0.016493404284119606, decouple_loss:0.0026967618614435196
loss_pred:0.01830240897834301, decouple_loss:0.002647216198965907
The generated pressure mean: 0.4433062672615051
loss_pred:0.019328389316797256, decouple_loss:0.002664580475538969
Iteration: 7924, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43614551424980164
The generated pressure mean: 0.43760836124420166
loss_pred:0.015979161486029625, decouple_loss:0.00193726213183254
loss_pred:0.017461126670241356, decouple_loss:0.0020352094434201717
The generated pressure mean: 0.43807846307754517
loss_pred:0.016517337411642075, decouple_loss:0.0019405274651944637
Iteration: 7925, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4577929675579071
The generated pressure mean: 0.45410147309303284
loss_pred:0.017726603895425797, decouple_loss:0.0021513726096600294
loss_pred:0.016634169965982437, decouple_loss:0.0022196874488145113
The generated pressure mean: 0.4554615020751953
loss_pred:0.015986597165465355, decouple_loss:0.002027953276410699
Iteration: 7926, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504287540912628
The generated pressure mean: 0.4493825137615204
loss_pred:0.016837643459439278, decouple_loss:0.002189834136515856
loss_pred:0.01643352024257183, decouple_loss:0.0023029898293316364
The generated pressure mean: 0.4506476819515228
loss_pred:0.016518037766218185, decouple_loss:0.0022748701740056276
Iteration: 7927, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4403216242790222
The generated pressure mean: 0.44312024116516113
loss_pred:0.01871713623404503, decouple_loss:0.0018146533984690905
loss_pred:0.016010401770472527, decouple_loss:0.0018492386443540454
The generated pressure mean: 0.4420039653778076
loss_pred:0.01847092993557453, decouple_loss:0.0018832188798114657
Iteration: 7928, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4332629144191742
The generated pressure mean: 0.4357496500015259
loss_pred:0.016303174197673798, decouple_loss:0.0021549335215240717
loss_pred:0.016881119459867477, decouple_loss:0.0020921388640999794
The generated pressure mean: 0.4439231753349304
loss_pred:0.01796681061387062, decouple_loss:0.002024892484769225
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 7929, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45619073510169983
loss_pred:0.018299220129847527, decouple_loss:0.002155349589884281
The generated pressure mean: 0.45371028780937195
loss_pred:0.01843518763780594, decouple_loss:0.002119115088135004
The generated pressure mean: 0.4543340504169464
loss_pred:0.018218984827399254, decouple_loss:0.0021157755982130766
Iteration: 7930, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45052528381347656
loss_pred:0.018953612074255943, decouple_loss:0.0020351384300738573
The generated pressure mean: 0.4530017077922821
loss_pred:0.017298052087426186, decouple_loss:0.0020979936234652996
The generated pressure mean: 0.45522740483283997
loss_pred:0.018411271274089813, decouple_loss:0.0020067940931767225
2023-04-17 17:31:09 testing...
The generated pressure mean: 0.41682249307632446
The generated pressure mean: 0.42374569177627563
The generated pressure mean: 0.4268108308315277
loss_pred:0.03067339025437832, decouple_loss:0.002716206479817629
loss_pred:0.029935214668512344, decouple_loss:0.002972001675516367
loss_pred:0.029431652277708054, decouple_loss:0.0030875096563249826
WV_0_PC_0_EH_1_PS_40, loss: 0.030159682035446167, avg_mse: 0.045969001948833466
current test mse: 0.045969
Iteration: 7931, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42866143584251404
loss_pred:0.017316197976469994, decouple_loss:0.002496642293408513
The generated pressure mean: 0.4260246753692627
loss_pred:0.01821315288543701, decouple_loss:0.002483478980138898
The generated pressure mean: 0.4315531253814697
loss_pred:0.01655183918774128, decouple_loss:0.0024841853883117437
Iteration: 7932, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4491754174232483
loss_pred:0.01822950504720211, decouple_loss:0.0022687865421175957
The generated pressure mean: 0.4495653808116913
loss_pred:0.0171097032725811, decouple_loss:0.0023691242095083
The generated pressure mean: 0.4505021274089813
loss_pred:0.016706347465515137, decouple_loss:0.0023362680803984404
Iteration: 7933, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4535425901412964
loss_pred:0.01647111400961876, decouple_loss:0.002800618065521121
The generated pressure mean: 0.45850589871406555
loss_pred:0.016846859827637672, decouple_loss:0.0027231513522565365
The generated pressure mean: 0.4561202824115753
loss_pred:0.019070273265242577, decouple_loss:0.002843637950718403
Iteration: 7934, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442199468612671
loss_pred:0.018050596117973328, decouple_loss:0.0023165990132838488
The generated pressure mean: 0.44672322273254395
loss_pred:0.016451479867100716, decouple_loss:0.0023987204767763615
The generated pressure mean: 0.44085457921028137
loss_pred:0.017561431974172592, decouple_loss:0.0022583636455237865
Iteration: 7935, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4386852979660034
loss_pred:0.016525374725461006, decouple_loss:0.003196944249793887
The generated pressure mean: 0.4393330216407776
loss_pred:0.01729586347937584, decouple_loss:0.003099587047472596
The generated pressure mean: 0.4391360580921173
loss_pred:0.018084833398461342, decouple_loss:0.00276413862593472
Iteration: 7936, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44953134655952454
loss_pred:0.016070859506726265, decouple_loss:0.0020816626492887735
The generated pressure mean: 0.45047232508659363
loss_pred:0.016490790992975235, decouple_loss:0.0020580575801432133
The generated pressure mean: 0.4501921832561493
loss_pred:0.018121840432286263, decouple_loss:0.0020533313509076834
Iteration: 7937, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474504292011261
loss_pred:0.016849810257554054, decouple_loss:0.00229684473015368
The generated pressure mean: 0.4480581283569336
loss_pred:0.017107468098402023, decouple_loss:0.0022700538393110037
The generated pressure mean: 0.4440959692001343
loss_pred:0.016483234241604805, decouple_loss:0.002361916471272707
Iteration: 7938, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4432404637336731
loss_pred:0.01618031971156597, decouple_loss:0.0022449076641350985
The generated pressure mean: 0.44364404678344727
loss_pred:0.017095498740673065, decouple_loss:0.0023273590486496687
The generated pressure mean: 0.4432595670223236
loss_pred:0.018038220703601837, decouple_loss:0.0022149370051920414
Iteration: 7939, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44999992847442627
loss_pred:0.017923181876540184, decouple_loss:0.002447377657517791
The generated pressure mean: 0.4475502371788025
loss_pred:0.01633652113378048, decouple_loss:0.0025281994603574276
The generated pressure mean: 0.4488149583339691
loss_pred:0.018427519127726555, decouple_loss:0.002484255703166127
Iteration: 7940, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44185516238212585
loss_pred:0.01645243912935257, decouple_loss:0.0026259426958858967
The generated pressure mean: 0.44186311960220337
loss_pred:0.017163224518299103, decouple_loss:0.002714822068810463
The generated pressure mean: 0.44125404953956604
loss_pred:0.016862161457538605, decouple_loss:0.002589407144114375
2023-04-17 17:33:02 testing...
The generated pressure mean: 0.4126976430416107
The generated pressure mean: 0.41867297887802124
The generated pressure mean: 0.4227466285228729
loss_pred:0.03252903372049332, decouple_loss:0.0026808769907802343
loss_pred:0.03157098591327667, decouple_loss:0.0029413197189569473
loss_pred:0.03119952790439129, decouple_loss:0.0029557307716459036
WV_0_PC_0_EH_1_PS_40, loss: 0.031909484416246414, avg_mse: 0.04913865029811859
current test mse: 0.049139
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 7941, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476756751537323
loss_pred:0.016666803508996964, decouple_loss:0.002180390991270542
The generated pressure mean: 0.44738492369651794
The generated pressure mean: 0.45323336124420166
loss_pred:0.01816648058593273, decouple_loss:0.0021981860045343637
loss_pred:0.017204269766807556, decouple_loss:0.0022151132579892874
Iteration: 7942, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45429450273513794The generated pressure mean: 0.45330485701560974
loss_pred:0.01751410774886608, decouple_loss:0.002002493478357792loss_pred:0.01813868060708046, decouple_loss:0.0020871488377451897
The generated pressure mean: 0.45900866389274597
loss_pred:0.01782405748963356, decouple_loss:0.002170777879655361
Iteration: 7943, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4440377950668335
The generated pressure mean: 0.4443705677986145
loss_pred:0.016073789447546005, decouple_loss:0.0027589118108153343
loss_pred:0.018667222931981087, decouple_loss:0.0027033393271267414
The generated pressure mean: 0.44385188817977905
loss_pred:0.018827877938747406, decouple_loss:0.002722256351262331
Iteration: 7944, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43722859025001526The generated pressure mean: 0.4358838200569153
loss_pred:0.018530093133449554, decouple_loss:0.00231969659216702
loss_pred:0.01842167228460312, decouple_loss:0.0022923194337636232
The generated pressure mean: 0.4351615607738495
loss_pred:0.0168017465621233, decouple_loss:0.002267651492729783
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 7945, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44939127564430237
The generated pressure mean: 0.44867777824401855
loss_pred:0.018012940883636475, decouple_loss:0.0024205187801271677
loss_pred:0.018892426043748856, decouple_loss:0.002488335594534874
The generated pressure mean: 0.4473320543766022
loss_pred:0.016954559832811356, decouple_loss:0.0023584964219480753
Iteration: 7946, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4469135105609894
The generated pressure mean: 0.44169488549232483
loss_pred:0.015594912692904472, decouple_loss:0.002807478653267026
loss_pred:0.017784377560019493, decouple_loss:0.003151990007609129
The generated pressure mean: 0.44873058795928955
loss_pred:0.01705959625542164, decouple_loss:0.003028636798262596
Iteration: 7947, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490571916103363
The generated pressure mean: 0.45232588052749634
loss_pred:0.017099039629101753, decouple_loss:0.0030586824286729097
loss_pred:0.017757609486579895, decouple_loss:0.0032273782417178154
The generated pressure mean: 0.45395198464393616
loss_pred:0.017237363383173943, decouple_loss:0.0030130951199680567
Iteration: 7948, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44616013765335083
loss_pred:0.017528610303997993, decouple_loss:0.0021317964419722557
The generated pressure mean: 0.4517802894115448
loss_pred:0.018248597159981728, decouple_loss:0.002136290306225419
The generated pressure mean: 0.44701212644577026
loss_pred:0.019119201228022575, decouple_loss:0.0021426528692245483
Iteration: 7949, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.439899206161499
loss_pred:0.018065789714455605, decouple_loss:0.0023580496199429035
The generated pressure mean: 0.44094470143318176
loss_pred:0.01712154410779476, decouple_loss:0.0023358033504337072
The generated pressure mean: 0.4412394165992737
loss_pred:0.019573090597987175, decouple_loss:0.0022598651703447104
Iteration: 7950, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44108033180236816
loss_pred:0.018025314435362816, decouple_loss:0.0036656418815255165
The generated pressure mean: 0.4401906132698059
loss_pred:0.018432065844535828, decouple_loss:0.00371781038120389
The generated pressure mean: 0.44242939352989197
loss_pred:0.01639840193092823, decouple_loss:0.003699359018355608
2023-04-17 17:35:37 testing...
The generated pressure mean: 0.4171817898750305
The generated pressure mean: 0.4108116924762726
The generated pressure mean: 0.4197520315647125
loss_pred:0.030768051743507385, decouple_loss:0.0028928439132869244
loss_pred:0.032226718962192535, decouple_loss:0.00274694268591702
loss_pred:0.030380403622984886, decouple_loss:0.00288620637729764
WV_0_PC_0_EH_1_PS_40, loss: 0.031267158687114716, avg_mse: 0.048095960170030594
current test mse: 0.048096
Iteration: 7951, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4543863534927368
loss_pred:0.018673373386263847, decouple_loss:0.0024681135546416044
The generated pressure mean: 0.4530150294303894
loss_pred:0.016766328364610672, decouple_loss:0.0024806014262139797
The generated pressure mean: 0.4510232210159302
loss_pred:0.017444944009184837, decouple_loss:0.0023432141169905663
Iteration: 7952, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45535212755203247
loss_pred:0.017253493890166283, decouple_loss:0.003290059044957161
The generated pressure mean: 0.45118623971939087
loss_pred:0.017770662903785706, decouple_loss:0.0032072472386062145
The generated pressure mean: 0.4516372084617615
loss_pred:0.01682106964290142, decouple_loss:0.003182030050083995
Iteration: 7953, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44382357597351074
The generated pressure mean: 0.44484636187553406
loss_pred:0.016960719600319862, decouple_loss:0.0029241705778986216
loss_pred:0.016574202105402946, decouple_loss:0.002888505579903722
The generated pressure mean: 0.44498178362846375
loss_pred:0.018940409645438194, decouple_loss:0.0027732516173273325
Iteration: 7954, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44054004549980164
The generated pressure mean: 0.4357723593711853
loss_pred:0.01663217321038246, decouple_loss:0.0027033488731831312
loss_pred:0.018386416137218475, decouple_loss:0.0027864654548466206
The generated pressure mean: 0.4326125383377075
loss_pred:0.017084702849388123, decouple_loss:0.002828901633620262
Iteration: 7955, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4516024589538574
loss_pred:0.016189362853765488, decouple_loss:0.0022726692259311676
The generated pressure mean: 0.45191943645477295
loss_pred:0.017332056537270546, decouple_loss:0.0022915720473974943
The generated pressure mean: 0.4519858658313751
loss_pred:0.01870320551097393, decouple_loss:0.002345520071685314
Iteration: 7956, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.451169490814209
The generated pressure mean: 0.4501379132270813
loss_pred:0.017152467742562294, decouple_loss:0.0030187799129635096
loss_pred:0.01736311800777912, decouple_loss:0.003013488370925188
The generated pressure mean: 0.4526800215244293
loss_pred:0.01711149886250496, decouple_loss:0.0030385961290448904
Iteration: 7957, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44541192054748535
loss_pred:0.017078174278140068, decouple_loss:0.002067562425509095
The generated pressure mean: 0.4437829256057739
loss_pred:0.016370419412851334, decouple_loss:0.0020910808816552162
The generated pressure mean: 0.4428885281085968
loss_pred:0.017551345750689507, decouple_loss:0.002066217130050063
Iteration: 7958, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44255051016807556
The generated pressure mean: 0.4434984624385834
loss_pred:0.01688077114522457, decouple_loss:0.0027434825897216797
loss_pred:0.017577948048710823, decouple_loss:0.002688707783818245
The generated pressure mean: 0.4418826997280121
loss_pred:0.018711712211370468, decouple_loss:0.0028049317188560963
Iteration: 7959, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44588127732276917
loss_pred:0.016262587159872055, decouple_loss:0.0022037047892808914
The generated pressure mean: 0.44605550169944763
loss_pred:0.017003009095788002, decouple_loss:0.002246079733595252
The generated pressure mean: 0.44847002625465393
loss_pred:0.019828112795948982, decouple_loss:0.002379106590524316
Iteration: 7960, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44989609718322754
The generated pressure mean: 0.44647735357284546
loss_pred:0.01709970273077488, decouple_loss:0.002321781124919653
loss_pred:0.016455084085464478, decouple_loss:0.002311224350705743
The generated pressure mean: 0.4472876191139221
loss_pred:0.016961505636572838, decouple_loss:0.0022721949499100447
2023-04-17 17:37:30 testing...
The generated pressure mean: 0.4203336536884308
The generated pressure mean: 0.4136424660682678
loss_pred:0.03013252280652523, decouple_loss:0.0029240434523671865
The generated pressure mean: 0.4242795407772064
loss_pred:0.03137962520122528, decouple_loss:0.002852439181879163
loss_pred:0.029327448457479477, decouple_loss:0.003041426418349147
WV_0_PC_0_EH_1_PS_40, loss: 0.030426833778619766, avg_mse: 0.04664895683526993
current test mse: 0.046649
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 7961, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4543136954307556
loss_pred:0.016612153500318527, decouple_loss:0.0027770190499722958
The generated pressure mean: 0.45429250597953796
loss_pred:0.017925970256328583, decouple_loss:0.0025891116820275784
The generated pressure mean: 0.4523053765296936
loss_pred:0.015959132462739944, decouple_loss:0.00264587695710361
Iteration: 7962, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4318084716796875
The generated pressure mean: 0.43623465299606323
loss_pred:0.018699482083320618, decouple_loss:0.0024198314640671015
loss_pred:0.01809547282755375, decouple_loss:0.0024328012950718403
The generated pressure mean: 0.4326477348804474
loss_pred:0.016797076910734177, decouple_loss:0.002447701059281826
Iteration: 7963, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4558418095111847
The generated pressure mean: 0.4544451832771301
loss_pred:0.016943320631980896, decouple_loss:0.0026684205513447523
loss_pred:0.019211899489164352, decouple_loss:0.002833867445588112
The generated pressure mean: 0.45559754967689514
loss_pred:0.018250251188874245, decouple_loss:0.0028258669190108776
Iteration: 7964, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4441970884799957
The generated pressure mean: 0.4454112648963928
loss_pred:0.0163450688123703, decouple_loss:0.0024274953175336123
loss_pred:0.016493022441864014, decouple_loss:0.002285149646922946
The generated pressure mean: 0.4389342963695526
loss_pred:0.01645577698945999, decouple_loss:0.0023153056390583515
Iteration: 7965, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503021836280823
The generated pressure mean: 0.44353994727134705
loss_pred:0.017506912350654602, decouple_loss:0.0018381431000307202
loss_pred:0.01781417615711689, decouple_loss:0.0017392225563526154
The generated pressure mean: 0.45086565613746643
loss_pred:0.016886228695511818, decouple_loss:0.0018087727949023247
Iteration: 7966, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.440100759267807
The generated pressure mean: 0.44918325543403625
loss_pred:0.016333727166056633, decouple_loss:0.0023074205964803696
loss_pred:0.017918024212121964, decouple_loss:0.0023172611836344004
The generated pressure mean: 0.4491835832595825
loss_pred:0.017866453155875206, decouple_loss:0.002303371438756585
Iteration: 7967, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44629499316215515
The generated pressure mean: 0.44296371936798096
loss_pred:0.015874721109867096, decouple_loss:0.0021645999513566494
loss_pred:0.017178554087877274, decouple_loss:0.0021005836315453053
The generated pressure mean: 0.44278961420059204
loss_pred:0.016647951677441597, decouple_loss:0.002213996136561036
Iteration: 7968, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44662708044052124
The generated pressure mean: 0.44758015871047974
loss_pred:0.016352705657482147, decouple_loss:0.0022930498234927654
loss_pred:0.017646685242652893, decouple_loss:0.0022881401237100363
The generated pressure mean: 0.4518079459667206
loss_pred:0.018642019480466843, decouple_loss:0.0023473664186894894
Iteration: 7969, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45503202080726624
The generated pressure mean: 0.454829603433609
loss_pred:0.015289041213691235, decouple_loss:0.0023922298569232225
loss_pred:0.017282504588365555, decouple_loss:0.0023285893257707357
The generated pressure mean: 0.45053181052207947
loss_pred:0.01787383481860161, decouple_loss:0.002380246762186289
Iteration: 7970, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43689653277397156
loss_pred:0.016930503770709038, decouple_loss:0.0022382757160812616
The generated pressure mean: 0.4409281611442566
loss_pred:0.0160050131380558, decouple_loss:0.002103114267811179
The generated pressure mean: 0.4393444061279297
loss_pred:0.017759287729859352, decouple_loss:0.0021888145711272955
2023-04-17 17:40:47 testing...
The generated pressure mean: 0.4148746430873871
The generated pressure mean: 0.42289167642593384
loss_pred:0.03166738152503967, decouple_loss:0.0024734761100262403
The generated pressure mean: 0.4261583387851715
loss_pred:0.03028925321996212, decouple_loss:0.002583900699391961
loss_pred:0.02991015836596489, decouple_loss:0.0027062727604061365
WV_0_PC_0_EH_1_PS_40, loss: 0.030751658603549004, avg_mse: 0.04787750542163849
current test mse: 0.047878
Iteration: 7971, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4387430250644684
loss_pred:0.0179274994879961, decouple_loss:0.002095383359119296
The generated pressure mean: 0.44373831152915955
loss_pred:0.016108468174934387, decouple_loss:0.002122262492775917
The generated pressure mean: 0.4442279040813446
loss_pred:0.01738508976995945, decouple_loss:0.0020971912890672684
Iteration: 7972, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4517005383968353
The generated pressure mean: 0.45518654584884644
loss_pred:0.017525367438793182, decouple_loss:0.0019029708346351981
loss_pred:0.017356539145112038, decouple_loss:0.0019619714003056288
The generated pressure mean: 0.4522053301334381
loss_pred:0.016465963795781136, decouple_loss:0.001960994442924857
Iteration: 7973, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4455806016921997
loss_pred:0.016725270077586174, decouple_loss:0.0017961767734959722
The generated pressure mean: 0.4405980110168457
loss_pred:0.016991516575217247, decouple_loss:0.0018381202826276422
The generated pressure mean: 0.4400366246700287
loss_pred:0.01643056608736515, decouple_loss:0.001866920036263764
Iteration: 7974, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44647201895713806
loss_pred:0.01685514859855175, decouple_loss:0.0020532384514808655
The generated pressure mean: 0.4480399787425995
loss_pred:0.017330126836895943, decouple_loss:0.002099965699017048
The generated pressure mean: 0.44466012716293335
loss_pred:0.016457144170999527, decouple_loss:0.002060465980321169
Iteration: 7975, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4486100673675537
loss_pred:0.01703338883817196, decouple_loss:0.0021919487044215202
The generated pressure mean: 0.45054391026496887
loss_pred:0.01652512326836586, decouple_loss:0.002091859234496951
The generated pressure mean: 0.4504823386669159
loss_pred:0.016465051099658012, decouple_loss:0.002092951675876975
Iteration: 7976, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4512636363506317
loss_pred:0.017698360607028008, decouple_loss:0.0017430721782147884
The generated pressure mean: 0.4500090479850769
loss_pred:0.01659630611538887, decouple_loss:0.0017819416243582964
The generated pressure mean: 0.45172491669654846
loss_pred:0.016400005668401718, decouple_loss:0.0017530894838273525
Iteration: 7977, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4359394907951355
loss_pred:0.01672150380909443, decouple_loss:0.0017396853072568774
The generated pressure mean: 0.43730178475379944
loss_pred:0.0165636595338583, decouple_loss:0.0018213987350463867
The generated pressure mean: 0.4416041374206543
loss_pred:0.01555058266967535, decouple_loss:0.0017396591138094664
Iteration: 7978, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466124176979065
The generated pressure mean: 0.44528424739837646
loss_pred:0.017039239406585693, decouple_loss:0.0020804142113775015
loss_pred:0.017437241971492767, decouple_loss:0.002043338492512703
The generated pressure mean: 0.44474413990974426
loss_pred:0.018291275948286057, decouple_loss:0.0021344246342778206
Iteration: 7979, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45760175585746765
The generated pressure mean: 0.4524582326412201
loss_pred:0.016831768676638603, decouple_loss:0.0019901662599295378
loss_pred:0.01680428721010685, decouple_loss:0.0019942785147577524
The generated pressure mean: 0.4569236636161804
loss_pred:0.016473643481731415, decouple_loss:0.001934267464093864
Iteration: 7980, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44653648138046265
loss_pred:0.016660481691360474, decouple_loss:0.001972244121134281
The generated pressure mean: 0.4455036520957947
loss_pred:0.016950717195868492, decouple_loss:0.0020679831504821777
The generated pressure mean: 0.4468560516834259
loss_pred:0.017862316220998764, decouple_loss:0.002013050951063633
2023-04-17 17:42:40 testing...
The generated pressure mean: 0.415442556142807
The generated pressure mean: 0.4210779666900635
The generated pressure mean: 0.4240697920322418
loss_pred:0.0308859720826149, decouple_loss:0.0021661417558789253
loss_pred:0.0298534594476223, decouple_loss:0.0022980908397585154
loss_pred:0.029458677396178246, decouple_loss:0.002363980282098055
WV_0_PC_0_EH_1_PS_40, loss: 0.030179841443896294, avg_mse: 0.0461229644715786
current test mse: 0.046123
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 7981, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4401022791862488
loss_pred:0.015393109992146492, decouple_loss:0.0019368804059922695
The generated pressure mean: 0.4378742277622223
loss_pred:0.016605135053396225, decouple_loss:0.0018215518211945891
The generated pressure mean: 0.43578240275382996
loss_pred:0.01662958785891533, decouple_loss:0.0019268635660409927
Iteration: 7982, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44812604784965515
The generated pressure mean: 0.44801896810531616
loss_pred:0.018251419067382812, decouple_loss:0.0024088211357593536
loss_pred:0.015536847524344921, decouple_loss:0.002424448262900114
The generated pressure mean: 0.4471883773803711
loss_pred:0.01660485379397869, decouple_loss:0.0023904750123620033
Iteration: 7983, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484131336212158
The generated pressure mean: 0.4465286433696747
loss_pred:0.016680946573615074, decouple_loss:0.0027358841616660357
loss_pred:0.018330013379454613, decouple_loss:0.002697403309866786
The generated pressure mean: 0.44848811626434326
loss_pred:0.018901780247688293, decouple_loss:0.0027020506095141172
Iteration: 7984, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43673381209373474
The generated pressure mean: 0.43876913189888
loss_pred:0.01658797822892666, decouple_loss:0.002016961807385087
loss_pred:0.017570173367857933, decouple_loss:0.002049058908596635
The generated pressure mean: 0.4401206076145172
loss_pred:0.01593625172972679, decouple_loss:0.002006994094699621
Iteration: 7985, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45397475361824036
The generated pressure mean: 0.4516091048717499
loss_pred:0.01571822352707386, decouple_loss:0.002147160703316331
loss_pred:0.017597001045942307, decouple_loss:0.002190816216170788
The generated pressure mean: 0.4494602084159851
loss_pred:0.017101656645536423, decouple_loss:0.0021566608920693398
Iteration: 7986, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.445537269115448
The generated pressure mean: 0.449951708316803
loss_pred:0.017018893733620644, decouple_loss:0.002425416372716427
loss_pred:0.01807151921093464, decouple_loss:0.0024637836031615734
The generated pressure mean: 0.44182297587394714
loss_pred:0.016862325370311737, decouple_loss:0.0024967174977064133
Iteration: 7987, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44332727789878845
The generated pressure mean: 0.437745600938797loss_pred:0.015794161707162857, decouple_loss:0.002196281449869275
loss_pred:0.017480086535215378, decouple_loss:0.00218200939707458
The generated pressure mean: 0.44207078218460083
loss_pred:0.017477435991168022, decouple_loss:0.0022734475787729025
Iteration: 7988, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4482419788837433The generated pressure mean: 0.45028164982795715
loss_pred:0.017522567883133888, decouple_loss:0.0023928205482661724loss_pred:0.016304723918437958, decouple_loss:0.0024392257910221815
The generated pressure mean: 0.449603408575058
loss_pred:0.0177522674202919, decouple_loss:0.0023480411618947983
Iteration: 7989, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4514009356498718
loss_pred:0.017841611057519913, decouple_loss:0.00241488148458302
The generated pressure mean: 0.4457155466079712
loss_pred:0.0171994436532259, decouple_loss:0.002236931584775448
The generated pressure mean: 0.44823139905929565
loss_pred:0.016881775110960007, decouple_loss:0.0022274344228208065
Iteration: 7990, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4414895474910736
The generated pressure mean: 0.4445676803588867
loss_pred:0.017575154080986977, decouple_loss:0.0019686471205204725
loss_pred:0.017082029953598976, decouple_loss:0.0019121215445920825
The generated pressure mean: 0.437630295753479
loss_pred:0.017388995736837387, decouple_loss:0.001972578000277281
2023-04-17 17:45:56 testing...
The generated pressure mean: 0.413572758436203
The generated pressure mean: 0.42020997405052185
The generated pressure mean: 0.4230864346027374
loss_pred:0.0316714383661747, decouple_loss:0.002240383066236973
loss_pred:0.030292470008134842, decouple_loss:0.0024718258064240217
loss_pred:0.029862625524401665, decouple_loss:0.002435856033116579
WV_0_PC_0_EH_1_PS_40, loss: 0.03072798065841198, avg_mse: 0.047270335257053375
current test mse: 0.04727
Iteration: 7991, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44579845666885376
loss_pred:0.015882311388850212, decouple_loss:0.0018202062929049134
The generated pressure mean: 0.4407314658164978
loss_pred:0.01746819168329239, decouple_loss:0.0018495963886380196
The generated pressure mean: 0.4443225562572479
loss_pred:0.017256256192922592, decouple_loss:0.0018469128990545869
Iteration: 7992, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470508098602295
The generated pressure mean: 0.4475388526916504
loss_pred:0.017028430476784706, decouple_loss:0.0023190544452518225
loss_pred:0.016723215579986572, decouple_loss:0.0023505601566284895
The generated pressure mean: 0.4480955898761749
loss_pred:0.019074464216828346, decouple_loss:0.002343476749956608
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 7993, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4435509443283081
loss_pred:0.016147295013070107, decouple_loss:0.0021048185881227255
The generated pressure mean: 0.44011977314949036
loss_pred:0.017389988526701927, decouple_loss:0.0020205324981361628
The generated pressure mean: 0.43962201476097107
loss_pred:0.015837684273719788, decouple_loss:0.0019857967272400856
Iteration: 7994, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494195878505707
loss_pred:0.016015684232115746, decouple_loss:0.0018625130178406835
The generated pressure mean: 0.4487689435482025
loss_pred:0.01857542246580124, decouple_loss:0.001932320068590343
The generated pressure mean: 0.44985076785087585
loss_pred:0.018648788332939148, decouple_loss:0.0018441544380038977
Iteration: 7995, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472205638885498
loss_pred:0.01661824993789196, decouple_loss:0.002037967322394252
The generated pressure mean: 0.4487776756286621
loss_pred:0.018118305131793022, decouple_loss:0.002246714662760496
The generated pressure mean: 0.448719322681427
loss_pred:0.017692089080810547, decouple_loss:0.002083808183670044
Iteration: 7996, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45142969489097595
loss_pred:0.017312821000814438, decouple_loss:0.002394044306129217
The generated pressure mean: 0.4478946924209595
loss_pred:0.0163736529648304, decouple_loss:0.002391283167526126
The generated pressure mean: 0.45121923089027405
loss_pred:0.016359340399503708, decouple_loss:0.002313884673640132
Iteration: 7997, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4350188374519348
loss_pred:0.01659930683672428, decouple_loss:0.002298501553013921
The generated pressure mean: 0.44138824939727783
loss_pred:0.01805722527205944, decouple_loss:0.0022391488309949636
The generated pressure mean: 0.44154253602027893
loss_pred:0.01809549517929554, decouple_loss:0.0023230742663145065
Iteration: 7998, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44218218326568604
loss_pred:0.017642885446548462, decouple_loss:0.0022882986813783646
The generated pressure mean: 0.438810259103775
loss_pred:0.01704995147883892, decouple_loss:0.0021332199685275555
The generated pressure mean: 0.443312406539917
loss_pred:0.01624712347984314, decouple_loss:0.0022448727395385504
Iteration: 7999, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44738173484802246
The generated pressure mean: 0.44693484902381897
loss_pred:0.01692592166364193, decouple_loss:0.0022031511180102825
loss_pred:0.017563046887516975, decouple_loss:0.002369652036577463
The generated pressure mean: 0.4511992335319519
loss_pred:0.016340455040335655, decouple_loss:0.0023105479776859283
Iteration: 8000, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45211488008499146
The generated pressure mean: 0.4512621760368347
loss_pred:0.017151668667793274, decouple_loss:0.0021406703162938356
loss_pred:0.016895996406674385, decouple_loss:0.0020536857191473246
The generated pressure mean: 0.4545246660709381
loss_pred:0.019330503419041634, decouple_loss:0.002120073651894927
2023-04-17 17:47:47 itr: 8000
training loss: [0.01943651 0.01699868 0.0172587 ]
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_0_EH_1_PS_40/model_8000.ckpt
2023-04-17 17:47:51 testing...
The generated pressure mean: 0.4194696843624115
The generated pressure mean: 0.4137379229068756
The generated pressure mean: 0.42220786213874817
loss_pred:0.030079903081059456, decouple_loss:0.0027332971803843975
loss_pred:0.031027493998408318, decouple_loss:0.0025230352766811848
loss_pred:0.0295613631606102, decouple_loss:0.002815204905346036
WV_0_PC_0_EH_1_PS_40, loss: 0.030357446521520615, avg_mse: 0.0462169274687767
current test mse: 0.046217
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 8001, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44415178894996643
loss_pred:0.020429817959666252, decouple_loss:0.002250237390398979
The generated pressure mean: 0.44456174969673157
The generated pressure mean: 0.44493648409843445
loss_pred:0.01618797704577446, decouple_loss:0.0022570230066776276
loss_pred:0.019198782742023468, decouple_loss:0.002213201252743602
Iteration: 8002, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4413858652114868
loss_pred:0.019053762778639793, decouple_loss:0.0020235448610037565
The generated pressure mean: 0.43555328249931335
loss_pred:0.017025422304868698, decouple_loss:0.002251808298751712
The generated pressure mean: 0.43746402859687805
loss_pred:0.016016125679016113, decouple_loss:0.0022491172421723604
Iteration: 8003, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4517133831977844
loss_pred:0.01686667650938034, decouple_loss:0.001954681007191539
The generated pressure mean: 0.4538075625896454
loss_pred:0.021491240710020065, decouple_loss:0.0020295947324484587
The generated pressure mean: 0.4504046142101288
loss_pred:0.018520290032029152, decouple_loss:0.0019949665293097496
Iteration: 8004, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4432162940502167
loss_pred:0.01905812695622444, decouple_loss:0.002194456523284316
The generated pressure mean: 0.44248875975608826
loss_pred:0.018676627427339554, decouple_loss:0.0021652858704328537
The generated pressure mean: 0.44424253702163696
loss_pred:0.017422150820493698, decouple_loss:0.002092228503897786
Iteration: 8005, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44777968525886536
loss_pred:0.01751924678683281, decouple_loss:0.0023657833226025105
The generated pressure mean: 0.4439072608947754
loss_pred:0.01744833029806614, decouple_loss:0.0023454437032341957
The generated pressure mean: 0.44812434911727905
loss_pred:0.017702143639326096, decouple_loss:0.002267227042466402
Iteration: 8006, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43993139266967773
loss_pred:0.01684783399105072, decouple_loss:0.002044258639216423
The generated pressure mean: 0.44300180673599243
loss_pred:0.0175772774964571, decouple_loss:0.0020574061200022697
The generated pressure mean: 0.4470863342285156
loss_pred:0.017170973122119904, decouple_loss:0.0021716926712542772
Iteration: 8007, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464302062988281
loss_pred:0.018828745931386948, decouple_loss:0.001988960662856698
The generated pressure mean: 0.4448296129703522
loss_pred:0.01899738982319832, decouple_loss:0.0020211387891322374
The generated pressure mean: 0.44901910424232483
loss_pred:0.01874568499624729, decouple_loss:0.001996392849832773
Iteration: 8008, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45078665018081665
The generated pressure mean: 0.44858822226524353
loss_pred:0.018775001168251038, decouple_loss:0.0020124732982367277
loss_pred:0.0172002874314785, decouple_loss:0.0019751209765672684
The generated pressure mean: 0.451811820268631
loss_pred:0.017493300139904022, decouple_loss:0.0021101448219269514
Iteration: 8009, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4457995295524597
loss_pred:0.017017412930727005, decouple_loss:0.002069645095616579
The generated pressure mean: 0.4488292336463928
loss_pred:0.017669493332505226, decouple_loss:0.0021336411591619253
The generated pressure mean: 0.4429404139518738
loss_pred:0.01625455915927887, decouple_loss:0.0021205737721174955
Iteration: 8010, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4424642324447632
loss_pred:0.017436396330595016, decouple_loss:0.001948484918102622
The generated pressure mean: 0.44428351521492004
loss_pred:0.01726563461124897, decouple_loss:0.0019241139525547624
The generated pressure mean: 0.44460350275039673
loss_pred:0.017183881253004074, decouple_loss:0.0019128854619339108
2023-04-17 17:50:49 testing...
The generated pressure mean: 0.41565871238708496
The generated pressure mean: 0.42329874634742737
The generated pressure mean: 0.4275929033756256
loss_pred:0.03234171122312546, decouple_loss:0.0024429860059171915
loss_pred:0.03081042319536209, decouple_loss:0.002691812813282013
loss_pred:0.029978148639202118, decouple_loss:0.0027443815488368273
WV_0_PC_0_EH_1_PS_40, loss: 0.03117474913597107, avg_mse: 0.04832359030842781
current test mse: 0.048324
Iteration: 8011, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44523510336875916The generated pressure mean: 0.4425007402896881
loss_pred:0.01734362356364727, decouple_loss:0.002055174671113491
loss_pred:0.016629308462142944, decouple_loss:0.0021499369759112597
The generated pressure mean: 0.44783082604408264
loss_pred:0.018106801435351372, decouple_loss:0.0021114645060151815
Iteration: 8012, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492224454879761
loss_pred:0.01786140166223049, decouple_loss:0.002531385514885187
The generated pressure mean: 0.4472945034503937
loss_pred:0.01610870286822319, decouple_loss:0.0025925347581505775
The generated pressure mean: 0.44775184988975525
loss_pred:0.017870917916297913, decouple_loss:0.0025541933719068766
Iteration: 8013, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44477590918540955
The generated pressure mean: 0.44603025913238525
loss_pred:0.016496993601322174, decouple_loss:0.00238442444242537
loss_pred:0.016793042421340942, decouple_loss:0.002369505586102605
The generated pressure mean: 0.44438329339027405
loss_pred:0.01648622378706932, decouple_loss:0.0024457192048430443
Iteration: 8014, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.445107638835907
The generated pressure mean: 0.44672200083732605
loss_pred:0.016551664099097252, decouple_loss:0.0016973480815067887
loss_pred:0.016016963869333267, decouple_loss:0.0017184322932735085
The generated pressure mean: 0.44237980246543884
loss_pred:0.01707412302494049, decouple_loss:0.0017395175527781248
Iteration: 8015, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4474503993988037
loss_pred:0.017577555030584335, decouple_loss:0.0023856426123529673
The generated pressure mean: 0.4500792622566223
loss_pred:0.017653323709964752, decouple_loss:0.0024071549996733665
The generated pressure mean: 0.45140957832336426
loss_pred:0.016713373363018036, decouple_loss:0.0024031116627156734
Iteration: 8016, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44910213351249695
The generated pressure mean: 0.45056185126304626
loss_pred:0.016223445534706116, decouple_loss:0.002359559293836355
loss_pred:0.017704779282212257, decouple_loss:0.002439947100356221
The generated pressure mean: 0.44997531175613403
loss_pred:0.017796257510781288, decouple_loss:0.0023642941378057003
Iteration: 8017, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4399581551551819
The generated pressure mean: 0.44156625866889954
loss_pred:0.018336858600378036, decouple_loss:0.0017221986781805754
loss_pred:0.017537161707878113, decouple_loss:0.0018618520116433501
The generated pressure mean: 0.44345322251319885
loss_pred:0.017446395009756088, decouple_loss:0.001731637748889625
Iteration: 8018, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490247070789337
loss_pred:0.017758987843990326, decouple_loss:0.0019117745105177164
The generated pressure mean: 0.4526421129703522
loss_pred:0.017085837200284004, decouple_loss:0.0020125110168009996
The generated pressure mean: 0.449518084526062
loss_pred:0.016846636310219765, decouple_loss:0.0019848758820444345
Iteration: 8019, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44741374254226685
loss_pred:0.016892531886696815, decouple_loss:0.0021061510778963566
The generated pressure mean: 0.44598978757858276
loss_pred:0.01732991263270378, decouple_loss:0.002188638783991337
The generated pressure mean: 0.44930607080459595
loss_pred:0.017172690480947495, decouple_loss:0.0021607805974781513
Iteration: 8020, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4392980933189392
loss_pred:0.01744910702109337, decouple_loss:0.001888341037556529
The generated pressure mean: 0.44177567958831787
loss_pred:0.017074519768357277, decouple_loss:0.002002961467951536
The generated pressure mean: 0.44026121497154236
loss_pred:0.017368817701935768, decouple_loss:0.0019659651443362236
2023-04-17 17:52:40 testing...
The generated pressure mean: 0.4135741889476776
The generated pressure mean: 0.4203655421733856
loss_pred:0.031105639412999153, decouple_loss:0.0020619130227714777
The generated pressure mean: 0.4241131544113159
loss_pred:0.030056903138756752, decouple_loss:0.00225236127153039
loss_pred:0.029172023758292198, decouple_loss:0.0023504304699599743
WV_0_PC_0_EH_1_PS_40, loss: 0.03022260032594204, avg_mse: 0.04627517610788345
current test mse: 0.046275
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 8021, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44596371054649353
loss_pred:0.016630252823233604, decouple_loss:0.0017210460500791669
The generated pressure mean: 0.45195111632347107
loss_pred:0.016777582466602325, decouple_loss:0.0018443483859300613
The generated pressure mean: 0.45086470246315
loss_pred:0.017344558611512184, decouple_loss:0.0017564771696925163
Iteration: 8022, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.454313188791275
loss_pred:0.017341872677206993, decouple_loss:0.00185678293928504
The generated pressure mean: 0.45421305298805237
loss_pred:0.018028240650892258, decouple_loss:0.0017087041633203626
The generated pressure mean: 0.45162340998649597
loss_pred:0.0175499077886343, decouple_loss:0.0018370861653238535
Iteration: 8023, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44026872515678406
loss_pred:0.01646195538341999, decouple_loss:0.0020736707374453545
The generated pressure mean: 0.4387833774089813
loss_pred:0.017488088458776474, decouple_loss:0.0020170570351183414
The generated pressure mean: 0.44127050042152405
loss_pred:0.016385123133659363, decouple_loss:0.0020662019960582256
Iteration: 8024, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4440450370311737
loss_pred:0.018147775903344154, decouple_loss:0.0021618299651890993
The generated pressure mean: 0.4408078193664551
loss_pred:0.01690407283604145, decouple_loss:0.002073976444080472
The generated pressure mean: 0.4469631016254425
loss_pred:0.01748122274875641, decouple_loss:0.0020369705744087696
Iteration: 8025, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45262354612350464
loss_pred:0.017681870609521866, decouple_loss:0.0018314075423404574
The generated pressure mean: 0.45188650488853455
loss_pred:0.017569640651345253, decouple_loss:0.0019435752183198929
The generated pressure mean: 0.4518033564090729
loss_pred:0.015740884467959404, decouple_loss:0.0019155556801706553
Iteration: 8026, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44458913803100586
loss_pred:0.017712879925966263, decouple_loss:0.001993571175262332
The generated pressure mean: 0.4423414170742035
loss_pred:0.01733231730759144, decouple_loss:0.002008858136832714
The generated pressure mean: 0.4412854015827179
loss_pred:0.016718313097953796, decouple_loss:0.0019743756856769323
Iteration: 8027, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461149275302887
loss_pred:0.01869184896349907, decouple_loss:0.0020037642680108547
The generated pressure mean: 0.4448793828487396
loss_pred:0.017367199063301086, decouple_loss:0.0019017403246834874
The generated pressure mean: 0.4503740668296814
loss_pred:0.016821959987282753, decouple_loss:0.0020130702760070562
Iteration: 8028, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4458206295967102
loss_pred:0.01659563183784485, decouple_loss:0.0017842635279521346
The generated pressure mean: 0.4442897140979767
loss_pred:0.017596105113625526, decouple_loss:0.0018029819475486875
The generated pressure mean: 0.45072609186172485
loss_pred:0.016563594341278076, decouple_loss:0.001713063451461494
Iteration: 8029, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44315800070762634
loss_pred:0.016763459891080856, decouple_loss:0.0022163724061101675
The generated pressure mean: 0.44472622871398926
loss_pred:0.01781781204044819, decouple_loss:0.002138819545507431
The generated pressure mean: 0.4435756206512451
loss_pred:0.017819080501794815, decouple_loss:0.0021550182718783617
Iteration: 8030, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45189204812049866
loss_pred:0.017834220081567764, decouple_loss:0.0019032410345971584
The generated pressure mean: 0.45524612069129944
loss_pred:0.016591880470514297, decouple_loss:0.001815973548218608
The generated pressure mean: 0.4561055898666382
loss_pred:0.016279438510537148, decouple_loss:0.0019848356023430824
2023-04-17 17:55:48 testing...
The generated pressure mean: 0.41446688771247864
The generated pressure mean: 0.42179200053215027
The generated pressure mean: 0.4249812960624695
loss_pred:0.030708640813827515, decouple_loss:0.0022645823191851377
loss_pred:0.029659055173397064, decouple_loss:0.0024917195551097393
loss_pred:0.029030954465270042, decouple_loss:0.0025560001377016306
WV_0_PC_0_EH_1_PS_40, loss: 0.02992142364382744, avg_mse: 0.04609750956296921
current test mse: 0.046098
Iteration: 8031, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4457467496395111
loss_pred:0.017492113634943962, decouple_loss:0.0019426705548539758
The generated pressure mean: 0.44365251064300537
loss_pred:0.018195422366261482, decouple_loss:0.0017589183989912271
The generated pressure mean: 0.4443129301071167
loss_pred:0.017135469242930412, decouple_loss:0.0019152325112372637
Iteration: 8032, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4344896078109741
loss_pred:0.017071383073925972, decouple_loss:0.0019440064206719398
The generated pressure mean: 0.4384770095348358
loss_pred:0.018818922340869904, decouple_loss:0.0020053491462022066
The generated pressure mean: 0.43756741285324097
loss_pred:0.015705082565546036, decouple_loss:0.001945803756825626
Iteration: 8033, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4513397216796875
loss_pred:0.016953393816947937, decouple_loss:0.0020947859156876802
The generated pressure mean: 0.4536273777484894
loss_pred:0.017914963886141777, decouple_loss:0.002197653753682971
The generated pressure mean: 0.4530821740627289
loss_pred:0.018065497279167175, decouple_loss:0.0021876858081668615
Iteration: 8034, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45228174328804016
loss_pred:0.016040600836277008, decouple_loss:0.0021446351893246174
The generated pressure mean: 0.45393192768096924
loss_pred:0.0172865092754364, decouple_loss:0.0021072060335427523
The generated pressure mean: 0.4487757384777069
loss_pred:0.01687628962099552, decouple_loss:0.0021403091959655285
Iteration: 8035, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45215415954589844
loss_pred:0.01860722340643406, decouple_loss:0.0020395577885210514
The generated pressure mean: 0.44861647486686707
loss_pred:0.016606256365776062, decouple_loss:0.0019380346639081836
The generated pressure mean: 0.44550180435180664
loss_pred:0.015732530504465103, decouple_loss:0.0020276319701224566
Iteration: 8036, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.439839243888855
loss_pred:0.018725546076893806, decouple_loss:0.0018631636630743742
The generated pressure mean: 0.442754328250885
loss_pred:0.01840919628739357, decouple_loss:0.0019017679151147604
The generated pressure mean: 0.4396381080150604
loss_pred:0.01684916950762272, decouple_loss:0.0018119625747203827
Iteration: 8037, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4364316761493683
loss_pred:0.01699691079556942, decouple_loss:0.0021416039671748877
The generated pressure mean: 0.4439024031162262
loss_pred:0.018166832625865936, decouple_loss:0.0021868026815354824The generated pressure mean: 0.44101470708847046
loss_pred:0.01915249414741993, decouple_loss:0.0021691052243113518
Iteration: 8038, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4483267366886139
loss_pred:0.017397351562976837, decouple_loss:0.0021200180053710938
The generated pressure mean: 0.44919553399086
loss_pred:0.016140824183821678, decouple_loss:0.0021622516214847565
The generated pressure mean: 0.45167291164398193
loss_pred:0.016353920102119446, decouple_loss:0.0019851496908813715
Iteration: 8039, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4550451636314392
loss_pred:0.017380645498633385, decouple_loss:0.0019023003987967968
The generated pressure mean: 0.45116126537323
loss_pred:0.01743360422551632, decouple_loss:0.0020044888369739056
The generated pressure mean: 0.45351260900497437
loss_pred:0.016584645956754684, decouple_loss:0.0020361016504466534
Iteration: 8040, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44175639748573303
loss_pred:0.01716654561460018, decouple_loss:0.0017365217208862305
The generated pressure mean: 0.44349703192710876
loss_pred:0.01672271452844143, decouple_loss:0.0017717297887429595
The generated pressure mean: 0.44498053193092346
loss_pred:0.017398100346326828, decouple_loss:0.0018538511358201504
2023-04-17 17:57:39 testing...
The generated pressure mean: 0.4144068658351898
The generated pressure mean: 0.42127880454063416
The generated pressure mean: 0.42480307817459106
loss_pred:0.03121344931423664, decouple_loss:0.0023781026247888803
loss_pred:0.030233589932322502, decouple_loss:0.002491139341145754
loss_pred:0.02940693497657776, decouple_loss:0.002600516425445676
WV_0_PC_0_EH_1_PS_40, loss: 0.030409153550863266, avg_mse: 0.04653898999094963
current test mse: 0.046539
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 8041, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44326791167259216
loss_pred:0.016749223694205284, decouple_loss:0.0020184237509965897
The generated pressure mean: 0.44556254148483276
loss_pred:0.016928328201174736, decouple_loss:0.0020003472454845905
The generated pressure mean: 0.445026695728302
loss_pred:0.018302742391824722, decouple_loss:0.002064056694507599
Iteration: 8042, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.448167622089386
The generated pressure mean: 0.4466148912906647
loss_pred:0.01731029897928238, decouple_loss:0.001893620821647346
loss_pred:0.016022540628910065, decouple_loss:0.001838065916672349
The generated pressure mean: 0.446737676858902
loss_pred:0.018463730812072754, decouple_loss:0.0019213984487578273
Iteration: 8043, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492575526237488
loss_pred:0.017773350700736046, decouple_loss:0.00212728139013052
The generated pressure mean: 0.44948604702949524
loss_pred:0.015670171007514, decouple_loss:0.0020569185726344585
The generated pressure mean: 0.44635263085365295
loss_pred:0.01643100194633007, decouple_loss:0.0020133620128035545
Iteration: 8044, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463970363140106
The generated pressure mean: 0.4417226314544678
loss_pred:0.017980162054300308, decouple_loss:0.0022997239138931036
loss_pred:0.017474837601184845, decouple_loss:0.002149338601157069
The generated pressure mean: 0.4485663175582886
loss_pred:0.017733965069055557, decouple_loss:0.002089900430291891
Iteration: 8045, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44632744789123535
loss_pred:0.017428578808903694, decouple_loss:0.0020837923511862755
The generated pressure mean: 0.44627028703689575
loss_pred:0.01637534610927105, decouple_loss:0.0023522910196334124
The generated pressure mean: 0.44353872537612915
loss_pred:0.0164005346596241, decouple_loss:0.0022653306368738413
Iteration: 8046, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45146745443344116
loss_pred:0.016013655811548233, decouple_loss:0.002998558571562171
The generated pressure mean: 0.4492455720901489
loss_pred:0.01787927933037281, decouple_loss:0.00298968143761158
The generated pressure mean: 0.44275233149528503
loss_pred:0.01687309332191944, decouple_loss:0.0032426565885543823
Iteration: 8047, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44579342007637024
loss_pred:0.018243353813886642, decouple_loss:0.0023467927239835262
The generated pressure mean: 0.44749319553375244
loss_pred:0.017142580822110176, decouple_loss:0.0022424969356507063
The generated pressure mean: 0.4463697671890259
loss_pred:0.015458426438272, decouple_loss:0.002315680030733347
Iteration: 8048, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43878045678138733
loss_pred:0.01615872047841549, decouple_loss:0.00245498726144433
The generated pressure mean: 0.44465959072113037
loss_pred:0.017225034534931183, decouple_loss:0.0024235923774540424
The generated pressure mean: 0.448641836643219
loss_pred:0.016846902668476105, decouple_loss:0.0025657452642917633
Iteration: 8049, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44957858324050903
The generated pressure mean: 0.447756290435791
loss_pred:0.016652924939990044, decouple_loss:0.002654635813087225
loss_pred:0.017986789345741272, decouple_loss:0.002554859733209014
The generated pressure mean: 0.44607797265052795
loss_pred:0.016531428322196007, decouple_loss:0.0025964006781578064
Iteration: 8050, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44243282079696655
loss_pred:0.016702035441994667, decouple_loss:0.002282719360664487
The generated pressure mean: 0.4398823380470276
loss_pred:0.017793206498026848, decouple_loss:0.0023541883565485477
The generated pressure mean: 0.4437870383262634
loss_pred:0.016300108283758163, decouple_loss:0.002346249995753169
2023-04-17 18:00:47 testing...
The generated pressure mean: 0.41273465752601624
The generated pressure mean: 0.4189892113208771
The generated pressure mean: 0.42194607853889465
loss_pred:0.031202249228954315, decouple_loss:0.002884679939597845
loss_pred:0.029917415231466293, decouple_loss:0.0029893864411860704
loss_pred:0.029372861608862877, decouple_loss:0.0030506104230880737
WV_0_PC_0_EH_1_PS_40, loss: 0.030312921851873398, avg_mse: 0.04623536020517349
current test mse: 0.046235
Iteration: 8051, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44906559586524963
loss_pred:0.01672641560435295, decouple_loss:0.002778071677312255
The generated pressure mean: 0.44670814275741577
loss_pred:0.01611640676856041, decouple_loss:0.0027523210737854242
The generated pressure mean: 0.44941580295562744
loss_pred:0.01832101121544838, decouple_loss:0.0028805420733988285
Iteration: 8052, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447729229927063
loss_pred:0.016776178032159805, decouple_loss:0.0021792238112539053
The generated pressure mean: 0.43998056650161743
loss_pred:0.016246885061264038, decouple_loss:0.002115784678608179
The generated pressure mean: 0.4512234926223755
loss_pred:0.01759369857609272, decouple_loss:0.002071596682071686
Iteration: 8053, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4443739354610443
loss_pred:0.016548320651054382, decouple_loss:0.002833101898431778
The generated pressure mean: 0.44690677523612976
loss_pred:0.0165800042450428, decouple_loss:0.002700432203710079
The generated pressure mean: 0.44671839475631714
loss_pred:0.017459897324442863, decouple_loss:0.002729071071371436
Iteration: 8054, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481281042098999
loss_pred:0.01786121353507042, decouple_loss:0.0020494756754487753
The generated pressure mean: 0.4389718770980835
loss_pred:0.016917260363698006, decouple_loss:0.001915077562443912
The generated pressure mean: 0.4482140839099884
loss_pred:0.015859540551900864, decouple_loss:0.0019947888795286417
Iteration: 8055, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4432508647441864
loss_pred:0.017366211861371994, decouple_loss:0.00230987137183547
The generated pressure mean: 0.44313427805900574
loss_pred:0.015643520280718803, decouple_loss:0.0023422976955771446
The generated pressure mean: 0.44622400403022766
loss_pred:0.01781686209142208, decouple_loss:0.002336605917662382
Iteration: 8056, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44496312737464905
loss_pred:0.016669021919369698, decouple_loss:0.0019932077266275883
The generated pressure mean: 0.4399218261241913
loss_pred:0.016445782035589218, decouple_loss:0.001961179543286562
The generated pressure mean: 0.4373643398284912
loss_pred:0.017535705119371414, decouple_loss:0.0018849058542400599
Iteration: 8057, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4571981728076935
loss_pred:0.015468588098883629, decouple_loss:0.0019866223447024822
The generated pressure mean: 0.4539547860622406
loss_pred:0.016561586409807205, decouple_loss:0.002183250617235899
The generated pressure mean: 0.45375096797943115
loss_pred:0.017228471115231514, decouple_loss:0.002208407735452056
Iteration: 8058, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44945845007896423
loss_pred:0.016912147402763367, decouple_loss:0.0020803147926926613
The generated pressure mean: 0.446916788816452
loss_pred:0.018094150349497795, decouple_loss:0.002103242790326476
The generated pressure mean: 0.4391626715660095
loss_pred:0.017241524532437325, decouple_loss:0.0021021447610110044
Iteration: 8059, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4487704932689667
loss_pred:0.016401445493102074, decouple_loss:0.002457078080624342
The generated pressure mean: 0.4467357099056244
loss_pred:0.016904622316360474, decouple_loss:0.002721367636695504
The generated pressure mean: 0.43895357847213745
loss_pred:0.017294980585575104, decouple_loss:0.002792111597955227
Iteration: 8060, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4532332122325897
loss_pred:0.017264528200030327, decouple_loss:0.0024795779027044773
The generated pressure mean: 0.451212078332901
loss_pred:0.017708132043480873, decouple_loss:0.00257228990085423
The generated pressure mean: 0.4499235451221466
loss_pred:0.01653718203306198, decouple_loss:0.002584085101261735
2023-04-17 18:02:40 testing...
The generated pressure mean: 0.4166986644268036
The generated pressure mean: 0.42337411642074585
The generated pressure mean: 0.42685168981552124
loss_pred:0.030033711344003677, decouple_loss:0.002713299822062254
loss_pred:0.02894003689289093, decouple_loss:0.0028521595522761345
loss_pred:0.02844368852674961, decouple_loss:0.0027804849669337273
WV_0_PC_0_EH_1_PS_40, loss: 0.029278244823217392, avg_mse: 0.04456609860062599
current test mse: 0.044566
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 8061, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4332496225833893
loss_pred:0.016595875844359398, decouple_loss:0.0025801239535212517
The generated pressure mean: 0.4351387023925781
loss_pred:0.01833387464284897, decouple_loss:0.00224556727334857
The generated pressure mean: 0.43530651926994324
loss_pred:0.017354823648929596, decouple_loss:0.002538958564400673
Iteration: 8062, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4542774260044098
The generated pressure mean: 0.4526119828224182
loss_pred:0.016987375915050507, decouple_loss:0.0027305001858621836
loss_pred:0.01719089411199093, decouple_loss:0.0029877438209950924
The generated pressure mean: 0.456956684589386
loss_pred:0.017435744404792786, decouple_loss:0.0026945238932967186
Iteration: 8063, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44237852096557617
loss_pred:0.017418254166841507, decouple_loss:0.0020186291076242924
The generated pressure mean: 0.4439992606639862
The generated pressure mean: 0.43844687938690186
loss_pred:0.019448084756731987, decouple_loss:0.0020709361415356398
loss_pred:0.017206581309437752, decouple_loss:0.0021460431162267923
Iteration: 8064, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4494101405143738
loss_pred:0.016571450978517532, decouple_loss:0.0017210720106959343
The generated pressure mean: 0.44786155223846436
The generated pressure mean: 0.4427069127559662
loss_pred:0.016351545229554176, decouple_loss:0.0018435268430039287
loss_pred:0.016827646642923355, decouple_loss:0.0017990624764934182
Iteration: 8065, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4564670920372009
loss_pred:0.017461514100432396, decouple_loss:0.0019884926732629538
The generated pressure mean: 0.4541139304637909
loss_pred:0.016841532662510872, decouple_loss:0.001990653108805418
The generated pressure mean: 0.45986300706863403
loss_pred:0.016134338453412056, decouple_loss:0.0020752872806042433
Iteration: 8066, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4411180317401886
The generated pressure mean: 0.44247862696647644
loss_pred:0.017498286440968513, decouple_loss:0.001958227716386318
loss_pred:0.01647946797311306, decouple_loss:0.0019377924036234617
The generated pressure mean: 0.44415873289108276
loss_pred:0.015931710600852966, decouple_loss:0.001931097824126482
Iteration: 8067, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44225674867630005
loss_pred:0.0171237550675869, decouple_loss:0.0025196208152920008
The generated pressure mean: 0.4402448236942291
loss_pred:0.01704205572605133, decouple_loss:0.002618413185700774
The generated pressure mean: 0.43883687257766724
loss_pred:0.0174641665071249, decouple_loss:0.002966704312711954
Iteration: 8068, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4543883204460144
loss_pred:0.018139608204364777, decouple_loss:0.002612933749333024
The generated pressure mean: 0.45458346605300903
The generated pressure mean: 0.4529555141925812
loss_pred:0.018773037940263748, decouple_loss:0.002583347959443927
loss_pred:0.01842566393315792, decouple_loss:0.002613935386762023
Iteration: 8069, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43670278787612915
The generated pressure mean: 0.4371055066585541loss_pred:0.017556646838784218, decouple_loss:0.0020725317299365997
loss_pred:0.017445096746087074, decouple_loss:0.0020266512874513865
The generated pressure mean: 0.43262600898742676
loss_pred:0.015916211530566216, decouple_loss:0.0021125765051692724
Iteration: 8070, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45349833369255066
loss_pred:0.017032919451594353, decouple_loss:0.0026367311365902424
The generated pressure mean: 0.4538481831550598
loss_pred:0.018333224579691887, decouple_loss:0.002708688611164689
The generated pressure mean: 0.45198994874954224
loss_pred:0.017002945765852928, decouple_loss:0.002626315224915743
2023-04-17 18:05:46 testing...
The generated pressure mean: 0.4126489758491516
The generated pressure mean: 0.41932210326194763
The generated pressure mean: 0.42263415455818176
loss_pred:0.03144783154129982, decouple_loss:0.0025661035906523466
loss_pred:0.029546260833740234, decouple_loss:0.0028793062083423138
loss_pred:0.030445732176303864, decouple_loss:0.0027569099329411983
WV_0_PC_0_EH_1_PS_40, loss: 0.030616646632552147, avg_mse: 0.04670792073011398
current test mse: 0.046708
Iteration: 8071, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4595993459224701
loss_pred:0.01827399618923664, decouple_loss:0.0020691778045147657
The generated pressure mean: 0.4556722939014435
loss_pred:0.015464863739907742, decouple_loss:0.0021114519331604242
The generated pressure mean: 0.4565922021865845
loss_pred:0.018155042082071304, decouple_loss:0.002024416346102953
Iteration: 8072, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44301295280456543
loss_pred:0.01664520613849163, decouple_loss:0.0023468518629670143
The generated pressure mean: 0.4379631280899048
loss_pred:0.017378637567162514, decouple_loss:0.0023254593834280968
The generated pressure mean: 0.43634986877441406
loss_pred:0.01765553094446659, decouple_loss:0.0023285348434001207
Iteration: 8073, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447624534368515
loss_pred:0.01694962941110134, decouple_loss:0.002308113034814596
The generated pressure mean: 0.44722995162010193
loss_pred:0.01705073192715645, decouple_loss:0.0024022264406085014
The generated pressure mean: 0.44844868779182434
loss_pred:0.01727573573589325, decouple_loss:0.0022008533123880625
Iteration: 8074, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4503808617591858
loss_pred:0.0181187242269516, decouple_loss:0.0023030778393149376
The generated pressure mean: 0.441858172416687
loss_pred:0.018805548548698425, decouple_loss:0.002266300143674016
The generated pressure mean: 0.44363418221473694
loss_pred:0.019244076684117317, decouple_loss:0.0023332233540713787
Iteration: 8075, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4407588243484497
loss_pred:0.017487945035099983, decouple_loss:0.0026766606606543064
The generated pressure mean: 0.4398806095123291
loss_pred:0.017287805676460266, decouple_loss:0.002720775082707405
The generated pressure mean: 0.4439019560813904
loss_pred:0.018640372902154922, decouple_loss:0.002782871015369892
Iteration: 8076, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44920381903648376
loss_pred:0.015932410955429077, decouple_loss:0.0020008981227874756
The generated pressure mean: 0.4523853063583374
loss_pred:0.01762343943119049, decouple_loss:0.0018738701473921537
The generated pressure mean: 0.45184481143951416
loss_pred:0.016875438392162323, decouple_loss:0.0019942214712500572
Iteration: 8077, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45218488574028015
loss_pred:0.017626624554395676, decouple_loss:0.002190526109188795
The generated pressure mean: 0.456217497587204
loss_pred:0.01818585954606533, decouple_loss:0.0020656094420701265
The generated pressure mean: 0.45199477672576904
loss_pred:0.01720658503472805, decouple_loss:0.0021414633374661207
Iteration: 8078, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4398522973060608
loss_pred:0.018190309405326843, decouple_loss:0.0021458473056554794
The generated pressure mean: 0.43543729186058044
The generated pressure mean: 0.43558716773986816
loss_pred:0.018656758591532707, decouple_loss:0.0022117604967206717
loss_pred:0.017911618575453758, decouple_loss:0.0021697627380490303
Iteration: 8079, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4551635682582855
loss_pred:0.01691453903913498, decouple_loss:0.002259457018226385
The generated pressure mean: 0.453745573759079
loss_pred:0.016607029363512993, decouple_loss:0.002353265881538391
The generated pressure mean: 0.4577995538711548
loss_pred:0.016598714515566826, decouple_loss:0.0023337218444794416
Iteration: 8080, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44962677359580994
loss_pred:0.016420584172010422, decouple_loss:0.0023398378398269415
The generated pressure mean: 0.4525785744190216
loss_pred:0.017409635707736015, decouple_loss:0.002321136649698019
The generated pressure mean: 0.4480438232421875
loss_pred:0.017502985894680023, decouple_loss:0.0023338899482041597
2023-04-17 18:07:40 testing...
The generated pressure mean: 0.4214412271976471
The generated pressure mean: 0.4143349528312683
loss_pred:0.031036997213959694, decouple_loss:0.003166329814121127
The generated pressure mean: 0.42392024397850037
loss_pred:0.032144945114851, decouple_loss:0.002963182982057333
loss_pred:0.03033432364463806, decouple_loss:0.003278581192716956
WV_0_PC_0_EH_1_PS_40, loss: 0.03132889047265053, avg_mse: 0.048124440014362335
current test mse: 0.048124
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 8081, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44414475560188293
loss_pred:0.01761339046061039, decouple_loss:0.002599712461233139
The generated pressure mean: 0.44502973556518555
loss_pred:0.01734696514904499, decouple_loss:0.0025585819967091084
The generated pressure mean: 0.44471362233161926
loss_pred:0.017113691195845604, decouple_loss:0.002534726867452264
Iteration: 8082, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.449710488319397
The generated pressure mean: 0.4499130845069885
loss_pred:0.018287206068634987, decouple_loss:0.0025650907773524523
loss_pred:0.017212167382240295, decouple_loss:0.002651217393577099
The generated pressure mean: 0.44726312160491943
loss_pred:0.017341487109661102, decouple_loss:0.0027942003216594458
Iteration: 8083, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4464154839515686
loss_pred:0.020149894058704376, decouple_loss:0.0020108427852392197
The generated pressure mean: 0.4447150230407715
loss_pred:0.018025841563940048, decouple_loss:0.0018094771075993776
The generated pressure mean: 0.4489019513130188
loss_pred:0.01799798011779785, decouple_loss:0.002046321053057909
Iteration: 8084, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4449174404144287
loss_pred:0.017604047432541847, decouple_loss:0.0019798469729721546
The generated pressure mean: 0.4418046772480011
loss_pred:0.01705113984644413, decouple_loss:0.0020339516922831535
The generated pressure mean: 0.447240948677063
loss_pred:0.01647011563181877, decouple_loss:0.0018923880998045206
Iteration: 8085, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4508431851863861
loss_pred:0.016357123851776123, decouple_loss:0.0018371770856902003
The generated pressure mean: 0.4597924053668976
loss_pred:0.018229924142360687, decouple_loss:0.0020212559029459953
The generated pressure mean: 0.45321226119995117
loss_pred:0.018045106902718544, decouple_loss:0.0018992400728166103
Iteration: 8086, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4555869698524475
loss_pred:0.018019801005721092, decouple_loss:0.0019515764433890581
The generated pressure mean: 0.45410293340682983
loss_pred:0.01817997917532921, decouple_loss:0.0020329321268945932
The generated pressure mean: 0.45569708943367004
loss_pred:0.01753040961921215, decouple_loss:0.0020584140438586473
Iteration: 8087, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43806785345077515
loss_pred:0.018506472930312157, decouple_loss:0.0024009281769394875
The generated pressure mean: 0.4383203685283661
loss_pred:0.01751277595758438, decouple_loss:0.0024328187573701143
The generated pressure mean: 0.4437694549560547
loss_pred:0.016689922660589218, decouple_loss:0.002493283711373806
Iteration: 8088, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4471544325351715
loss_pred:0.016779223456978798, decouple_loss:0.002279859036207199
The generated pressure mean: 0.4425177574157715
loss_pred:0.016875773668289185, decouple_loss:0.002292607445269823
The generated pressure mean: 0.4467371106147766
loss_pred:0.017215050756931305, decouple_loss:0.002406799467280507
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 8089, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.459088534116745
loss_pred:0.01696072891354561, decouple_loss:0.0018523276085034013
The generated pressure mean: 0.45480236411094666
The generated pressure mean: 0.4510806202888489
loss_pred:0.018945926800370216, decouple_loss:0.001799655961804092
loss_pred:0.017985954880714417, decouple_loss:0.0017414804315194488
Iteration: 8090, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481276869773865
loss_pred:0.01722083054482937, decouple_loss:0.00198086304590106
The generated pressure mean: 0.44519180059432983
loss_pred:0.0167477335780859, decouple_loss:0.0018993604462593794
The generated pressure mean: 0.45004788041114807
loss_pred:0.017734333872795105, decouple_loss:0.0019602745305746794
2023-04-17 18:10:34 testing...
The generated pressure mean: 0.4139605760574341
The generated pressure mean: 0.4211183488368988
The generated pressure mean: 0.42420828342437744
loss_pred:0.031039515510201454, decouple_loss:0.0023659560829401016
loss_pred:0.03007744811475277, decouple_loss:0.002511247992515564
loss_pred:0.029369063675403595, decouple_loss:0.0026388075202703476
WV_0_PC_0_EH_1_PS_40, loss: 0.030287276953458786, avg_mse: 0.046227358281612396
current test mse: 0.046227
Iteration: 8091, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463820457458496
loss_pred:0.01719978265464306, decouple_loss:0.00193107221275568
The generated pressure mean: 0.44913336634635925
loss_pred:0.016793737187981606, decouple_loss:0.0019180052913725376
The generated pressure mean: 0.44822821021080017
loss_pred:0.017445949837565422, decouple_loss:0.001979431137442589
Iteration: 8092, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44498512148857117
loss_pred:0.01848248951137066, decouple_loss:0.002043925691395998
The generated pressure mean: 0.4473678171634674
loss_pred:0.018517598509788513, decouple_loss:0.001882824581116438
The generated pressure mean: 0.4477418065071106
loss_pred:0.017756804823875427, decouple_loss:0.0019343224121257663
Iteration: 8093, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44116342067718506
loss_pred:0.01773878000676632, decouple_loss:0.001851421664468944
The generated pressure mean: 0.4455532729625702
loss_pred:0.018228275701403618, decouple_loss:0.0019385238410905004
The generated pressure mean: 0.4416697919368744
loss_pred:0.017046881839632988, decouple_loss:0.001904026372358203
Iteration: 8094, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46072179079055786
loss_pred:0.01644567959010601, decouple_loss:0.0018177293241024017
The generated pressure mean: 0.45552051067352295
loss_pred:0.016577458009123802, decouple_loss:0.001778916921466589
The generated pressure mean: 0.45663902163505554
loss_pred:0.016313252970576286, decouple_loss:0.0017890030285343528
Iteration: 8095, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45569470524787903
loss_pred:0.01714738830924034, decouple_loss:0.0022926528472453356
The generated pressure mean: 0.4565233588218689
loss_pred:0.017676211893558502, decouple_loss:0.002275989158079028
The generated pressure mean: 0.4531528353691101
loss_pred:0.018012378364801407, decouple_loss:0.0022163628600537777
Iteration: 8096, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4370058476924896
loss_pred:0.017632264643907547, decouple_loss:0.0020580380223691463
The generated pressure mean: 0.43187764286994934
loss_pred:0.01758446916937828, decouple_loss:0.0020533748902380466
The generated pressure mean: 0.4352585971355438
loss_pred:0.01848083920776844, decouple_loss:0.0020626119803637266
Iteration: 8097, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45241209864616394
loss_pred:0.01870308443903923, decouple_loss:0.0018336462089791894
The generated pressure mean: 0.45115241408348083
loss_pred:0.01712711714208126, decouple_loss:0.0018656819593161345
The generated pressure mean: 0.44910499453544617
loss_pred:0.01962948404252529, decouple_loss:0.0018191750859841704
Iteration: 8098, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45648109912872314
loss_pred:0.017592979595065117, decouple_loss:0.00292942370288074
The generated pressure mean: 0.4537660479545593
loss_pred:0.01919165812432766, decouple_loss:0.0030744823161512613
The generated pressure mean: 0.45355817675590515
loss_pred:0.016071675345301628, decouple_loss:0.0028837351128458977
Iteration: 8099, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4382023513317108
loss_pred:0.01752673275768757, decouple_loss:0.002305958652868867
The generated pressure mean: 0.4414263367652893
loss_pred:0.018220188096165657, decouple_loss:0.002315810415893793
The generated pressure mean: 0.44499441981315613
loss_pred:0.017652563750743866, decouple_loss:0.00243195379152894
Iteration: 8100, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.454138845205307
loss_pred:0.01704987697303295, decouple_loss:0.002027775626629591
The generated pressure mean: 0.4515576660633087
loss_pred:0.016526255756616592, decouple_loss:0.0020249898079782724
The generated pressure mean: 0.4488847851753235
loss_pred:0.016352398321032524, decouple_loss:0.002051230287179351
2023-04-17 18:12:28 testing...
The generated pressure mean: 0.41203057765960693
The generated pressure mean: 0.41896751523017883
loss_pred:0.032153356820344925, decouple_loss:0.0032584532164037228
The generated pressure mean: 0.42217156291007996
loss_pred:0.031134942546486855, decouple_loss:0.003462547902017832
loss_pred:0.030125517398118973, decouple_loss:0.0035696218255907297
WV_0_PC_0_EH_1_PS_40, loss: 0.031309448182582855, avg_mse: 0.048207078129053116
current test mse: 0.048207
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 8101, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4551592469215393
loss_pred:0.01775522157549858, decouple_loss:0.0029188566841185093
The generated pressure mean: 0.4506571888923645
The generated pressure mean: 0.45727667212486267
loss_pred:0.01651212014257908, decouple_loss:0.003053588094189763
loss_pred:0.017316976562142372, decouple_loss:0.002822133945301175
Iteration: 8102, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4358970820903778
loss_pred:0.018045371398329735, decouple_loss:0.0021741981618106365
The generated pressure mean: 0.4364258348941803
loss_pred:0.018622860312461853, decouple_loss:0.002314044628292322
The generated pressure mean: 0.44225436449050903
loss_pred:0.01855090819299221, decouple_loss:0.00221833772957325
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 8103, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43773770332336426
loss_pred:0.016867032274603844, decouple_loss:0.002565499395132065The generated pressure mean: 0.4370521605014801
loss_pred:0.01891942322254181, decouple_loss:0.0027450791094452143
The generated pressure mean: 0.43621593713760376
loss_pred:0.017588205635547638, decouple_loss:0.0025777097325772047
Iteration: 8104, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45199060440063477
loss_pred:0.017405308783054352, decouple_loss:0.002422477351501584
The generated pressure mean: 0.45471328496932983
loss_pred:0.019081948325037956, decouple_loss:0.0023017791099846363
The generated pressure mean: 0.44982972741127014
loss_pred:0.01612314023077488, decouple_loss:0.002385468687862158
Iteration: 8105, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4527152478694916
The generated pressure mean: 0.45203113555908203
loss_pred:0.016947628930211067, decouple_loss:0.0028082281351089478
loss_pred:0.017181063070893288, decouple_loss:0.002857472514733672
The generated pressure mean: 0.4519454538822174
loss_pred:0.019679823890328407, decouple_loss:0.002843954600393772
Iteration: 8106, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43434956669807434
The generated pressure mean: 0.43836286664009094
loss_pred:0.017464175820350647, decouple_loss:0.001979255583137274
loss_pred:0.017149468883872032, decouple_loss:0.002013890538364649
The generated pressure mean: 0.43502989411354065
loss_pred:0.016429664567112923, decouple_loss:0.0020144886802881956
Iteration: 8107, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4476247727870941
loss_pred:0.019462687894701958, decouple_loss:0.0029557242523878813
The generated pressure mean: 0.4486595690250397
loss_pred:0.017024612054228783, decouple_loss:0.002863515866920352
The generated pressure mean: 0.4475017488002777
loss_pred:0.017689377069473267, decouple_loss:0.0029054847545921803
Iteration: 8108, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44748568534851074
The generated pressure mean: 0.44650575518608093
loss_pred:0.016464753076434135, decouple_loss:0.0020596955437213182
loss_pred:0.016576096415519714, decouple_loss:0.00200042431242764
The generated pressure mean: 0.44854438304901123
loss_pred:0.019014256075024605, decouple_loss:0.0019466027151793242
Iteration: 8109, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459210932254791
loss_pred:0.01660268008708954, decouple_loss:0.0028517460450530052
The generated pressure mean: 0.4483812749385834
The generated pressure mean: 0.4480956196784973
loss_pred:0.017017114907503128, decouple_loss:0.0027097011916339397
loss_pred:0.017511051148176193, decouple_loss:0.002771899104118347
Iteration: 8110, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4421960413455963
The generated pressure mean: 0.441928893327713
loss_pred:0.017309587448835373, decouple_loss:0.0021489718928933144
loss_pred:0.016465790569782257, decouple_loss:0.002214033855125308
The generated pressure mean: 0.4465242922306061
loss_pred:0.01729084551334381, decouple_loss:0.002175475237891078
2023-04-17 18:15:26 testing...
The generated pressure mean: 0.41248422861099243
The generated pressure mean: 0.41960424184799194
The generated pressure mean: 0.42223474383354187
loss_pred:0.031515225768089294, decouple_loss:0.0022584053222090006
loss_pred:0.03028109483420849, decouple_loss:0.0023913758341223
loss_pred:0.029846874997019768, decouple_loss:0.0024242736399173737
WV_0_PC_0_EH_1_PS_40, loss: 0.03066563419997692, avg_mse: 0.04725019261240959
current test mse: 0.04725
Iteration: 8111, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479007124900818
loss_pred:0.0170784592628479, decouple_loss:0.0018020127899944782
The generated pressure mean: 0.44628727436065674
loss_pred:0.017447613179683685, decouple_loss:0.0017838954227045178
The generated pressure mean: 0.446677565574646
loss_pred:0.017696678638458252, decouple_loss:0.0018767038127407432
Iteration: 8112, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44019633531570435
loss_pred:0.018259627744555473, decouple_loss:0.001677657593972981
The generated pressure mean: 0.44107964634895325
loss_pred:0.017615586519241333, decouple_loss:0.0018117049476131797
The generated pressure mean: 0.44183552265167236
loss_pred:0.018598852679133415, decouple_loss:0.001736308098770678
Iteration: 8113, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4515048563480377
loss_pred:0.017011160030961037, decouple_loss:0.0021507986821234226
The generated pressure mean: 0.4536345601081848
loss_pred:0.017503704875707626, decouple_loss:0.0023298209998756647
The generated pressure mean: 0.4534904956817627
loss_pred:0.01851203851401806, decouple_loss:0.002164560602977872
Iteration: 8114, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4423176646232605
loss_pred:0.01745145581662655, decouple_loss:0.0021780608221888542
The generated pressure mean: 0.4403318762779236
loss_pred:0.01634637452661991, decouple_loss:0.0022131463047116995
The generated pressure mean: 0.4437500834465027
loss_pred:0.017832757905125618, decouple_loss:0.0022411153186112642
Iteration: 8115, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4333343207836151
loss_pred:0.015705564990639687, decouple_loss:0.0020851108711212873
The generated pressure mean: 0.4375896453857422
loss_pred:0.016454191878437996, decouple_loss:0.0020844023674726486
The generated pressure mean: 0.4342777729034424
loss_pred:0.01879183016717434, decouple_loss:0.002125147031620145
Iteration: 8116, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4554578959941864
loss_pred:0.017296964302659035, decouple_loss:0.001714671845547855
The generated pressure mean: 0.4562181234359741
loss_pred:0.01829032599925995, decouple_loss:0.0017842131201177835
The generated pressure mean: 0.4541718661785126
loss_pred:0.016945023089647293, decouple_loss:0.001847997889854014
Iteration: 8117, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45287609100341797
loss_pred:0.016552409157156944, decouple_loss:0.0019340971484780312
The generated pressure mean: 0.4552258849143982
loss_pred:0.01771128550171852, decouple_loss:0.0017112132627516985
The generated pressure mean: 0.45018476247787476
loss_pred:0.01806398294866085, decouple_loss:0.001773609546944499
Iteration: 8118, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44293639063835144
loss_pred:0.01770193688571453, decouple_loss:0.0018482513260096312
The generated pressure mean: 0.44186311960220337
loss_pred:0.01677766442298889, decouple_loss:0.0018093170365318656
The generated pressure mean: 0.4411320686340332
loss_pred:0.016127027571201324, decouple_loss:0.0018840266857296228
Iteration: 8119, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4370034635066986
loss_pred:0.016456859186291695, decouple_loss:0.0025859286542981863
The generated pressure mean: 0.4371454119682312
loss_pred:0.01794314943253994, decouple_loss:0.0025210033636540174
The generated pressure mean: 0.43612703680992126
loss_pred:0.016140155494213104, decouple_loss:0.002598460065200925
Iteration: 8120, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4520861506462097
loss_pred:0.017901407554745674, decouple_loss:0.0025376128032803535
The generated pressure mean: 0.45567694306373596
loss_pred:0.016671346500515938, decouple_loss:0.0025240799877792597
The generated pressure mean: 0.4505968689918518
loss_pred:0.01679706759750843, decouple_loss:0.0025226145517081022
2023-04-17 18:17:19 testing...
The generated pressure mean: 0.412440687417984
The generated pressure mean: 0.42022833228111267
The generated pressure mean: 0.4228827953338623
loss_pred:0.03181985765695572, decouple_loss:0.0025060405023396015
loss_pred:0.030612017959356308, decouple_loss:0.002713620662689209
loss_pred:0.029852716252207756, decouple_loss:0.00286874664016068
WV_0_PC_0_EH_1_PS_40, loss: 0.030896339565515518, avg_mse: 0.04759453609585762
current test mse: 0.047595
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 8121, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4539123773574829
loss_pred:0.01702473685145378, decouple_loss:0.0019798744469881058
The generated pressure mean: 0.45304349064826965
The generated pressure mean: 0.45653969049453735
loss_pred:0.01695612072944641, decouple_loss:0.00204764143563807
loss_pred:0.017537588253617287, decouple_loss:0.0020173992961645126
Iteration: 8122, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.434958815574646
The generated pressure mean: 0.4389610290527344loss_pred:0.016398439183831215, decouple_loss:0.0017764316871762276
loss_pred:0.016396479681134224, decouple_loss:0.001748179318383336
The generated pressure mean: 0.4336702227592468
loss_pred:0.015918536111712456, decouple_loss:0.0017914111958816648
Iteration: 8123, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44574275612831116
The generated pressure mean: 0.44599515199661255
loss_pred:0.015604338608682156, decouple_loss:0.001988333184272051
loss_pred:0.016345711424946785, decouple_loss:0.0019077555043622851
The generated pressure mean: 0.44872283935546875
loss_pred:0.016620056703686714, decouple_loss:0.0020550063345581293
Iteration: 8124, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45909225940704346
The generated pressure mean: 0.4581308960914612
loss_pred:0.017730800434947014, decouple_loss:0.0018124813213944435
loss_pred:0.018036000430583954, decouple_loss:0.0019682978745549917
The generated pressure mean: 0.4586951732635498
loss_pred:0.01573273353278637, decouple_loss:0.0018274486064910889
Iteration: 8125, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477037191390991The generated pressure mean: 0.4456120431423187
loss_pred:0.019769595935940742, decouple_loss:0.0023970550391823053
loss_pred:0.01655377820134163, decouple_loss:0.0023684257175773382
The generated pressure mean: 0.4474954605102539
loss_pred:0.016003651544451714, decouple_loss:0.0025991315487772226
Iteration: 8126, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44806620478630066
The generated pressure mean: 0.45320752263069153
loss_pred:0.01714581809937954, decouple_loss:0.0025193234905600548
loss_pred:0.015489846467971802, decouple_loss:0.0027827322483062744
The generated pressure mean: 0.44374796748161316
loss_pred:0.015704620629549026, decouple_loss:0.0025260925758630037
Iteration: 8127, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45326825976371765
The generated pressure mean: 0.445107102394104
loss_pred:0.01582355797290802, decouple_loss:0.002134963870048523
loss_pred:0.016105320304632187, decouple_loss:0.0021870636846870184
The generated pressure mean: 0.44626322388648987
loss_pred:0.018050584942102432, decouple_loss:0.002161423210054636
Iteration: 8128, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4364453852176666
loss_pred:0.016240403056144714, decouple_loss:0.002209770493209362
The generated pressure mean: 0.4397262632846832
loss_pred:0.016814099624753, decouple_loss:0.002311788033694029
The generated pressure mean: 0.4382045865058899
loss_pred:0.017302224412560463, decouple_loss:0.002294799080118537
Iteration: 8129, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44727203249931335
loss_pred:0.015613870695233345, decouple_loss:0.00281689059920609
The generated pressure mean: 0.45203492045402527
loss_pred:0.017136424779891968, decouple_loss:0.002834402024745941
The generated pressure mean: 0.4555836021900177
loss_pred:0.01700371503829956, decouple_loss:0.002842767396941781
Iteration: 8130, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4530976414680481
loss_pred:0.016719818115234375, decouple_loss:0.0023228987120091915
The generated pressure mean: 0.4560016989707947
loss_pred:0.01647341437637806, decouple_loss:0.0023030529264360666
The generated pressure mean: 0.45623087882995605
loss_pred:0.016373543068766594, decouple_loss:0.002383927581831813
2023-04-17 18:20:37 testing...
The generated pressure mean: 0.41252535581588745
The generated pressure mean: 0.4190124571323395
The generated pressure mean: 0.42106470465660095
loss_pred:0.0316556952893734, decouple_loss:0.003266345476731658
loss_pred:0.030109278857707977, decouple_loss:0.0033602691255509853
loss_pred:0.029842443764209747, decouple_loss:0.0034135370515286922
WV_0_PC_0_EH_1_PS_40, loss: 0.030703142285346985, avg_mse: 0.046992115676403046
current test mse: 0.046992
Iteration: 8131, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44859758019447327
loss_pred:0.016361543908715248, decouple_loss:0.0033354326151311398
The generated pressure mean: 0.44596943259239197
loss_pred:0.015632743015885353, decouple_loss:0.0032251907978206873
The generated pressure mean: 0.45032352209091187
loss_pred:0.016402587294578552, decouple_loss:0.0031982786022126675
Iteration: 8132, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4412030577659607
loss_pred:0.016398537904024124, decouple_loss:0.0030833862256258726
The generated pressure mean: 0.4425981342792511
loss_pred:0.016457099467515945, decouple_loss:0.0030421181581914425
The generated pressure mean: 0.4429040849208832
loss_pred:0.016668815165758133, decouple_loss:0.003094153478741646
Iteration: 8133, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4454173445701599
loss_pred:0.017952267080545425, decouple_loss:0.002793951192870736
The generated pressure mean: 0.4457462430000305
loss_pred:0.018072959035634995, decouple_loss:0.002572565572336316
The generated pressure mean: 0.445430725812912
loss_pred:0.01659374311566353, decouple_loss:0.0026419779751449823
Iteration: 8134, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45517900586128235
loss_pred:0.017508987337350845, decouple_loss:0.002588039031252265
The generated pressure mean: 0.4571128487586975
loss_pred:0.017789632081985474, decouple_loss:0.002434713300317526
The generated pressure mean: 0.45462849736213684
loss_pred:0.016409408301115036, decouple_loss:0.0023889357689768076
Iteration: 8135, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.437114953994751
loss_pred:0.017750665545463562, decouple_loss:0.003574044443666935
The generated pressure mean: 0.4432756304740906
loss_pred:0.017187312245368958, decouple_loss:0.0038687491323798895
The generated pressure mean: 0.44228026270866394
loss_pred:0.01720607653260231, decouple_loss:0.0036656269803643227
Iteration: 8136, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44926953315734863
loss_pred:0.01640176586806774, decouple_loss:0.002528067212551832
The generated pressure mean: 0.4480208456516266
loss_pred:0.017115764319896698, decouple_loss:0.0025193372275680304
The generated pressure mean: 0.4454028904438019
loss_pred:0.01746184751391411, decouple_loss:0.0025627342984080315
Iteration: 8137, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4428485929965973
loss_pred:0.015331094153225422, decouple_loss:0.0032005379907786846
The generated pressure mean: 0.44787636399269104
The generated pressure mean: 0.4473683834075928
loss_pred:0.014399291016161442, decouple_loss:0.0032221477013081312
loss_pred:0.018812255933880806, decouple_loss:0.0034004885237663984
Iteration: 8138, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4590575098991394
loss_pred:0.015951454639434814, decouple_loss:0.0022405730560421944
The generated pressure mean: 0.44932428002357483
loss_pred:0.01768694631755352, decouple_loss:0.0025374440010637045
The generated pressure mean: 0.45735645294189453
loss_pred:0.01562660187482834, decouple_loss:0.0022797381971031427
Iteration: 8139, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44824308156967163
loss_pred:0.016868870705366135, decouple_loss:0.003423250513151288
The generated pressure mean: 0.44694191217422485
loss_pred:0.01516643725335598, decouple_loss:0.003243832616135478
The generated pressure mean: 0.45365673303604126
loss_pred:0.01610426791012287, decouple_loss:0.003478250466287136
Iteration: 8140, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4458218216896057
loss_pred:0.01704314351081848, decouple_loss:0.002414502203464508
The generated pressure mean: 0.44178009033203125
loss_pred:0.017119595780968666, decouple_loss:0.002459039678797126
The generated pressure mean: 0.44351011514663696
loss_pred:0.01672038622200489, decouple_loss:0.002395730698481202
2023-04-17 18:22:31 testing...
The generated pressure mean: 0.4205833077430725
The generated pressure mean: 0.41364631056785583
The generated pressure mean: 0.42252954840660095
loss_pred:0.029270490631461143, decouple_loss:0.003660053014755249
loss_pred:0.03094468079507351, decouple_loss:0.0036080454010516405
loss_pred:0.029095184057950974, decouple_loss:0.0037120459601283073
WV_0_PC_0_EH_1_PS_40, loss: 0.02995312213897705, avg_mse: 0.04567093402147293
current test mse: 0.045671
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 8141, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44642174243927
loss_pred:0.018008124083280563, decouple_loss:0.0030676505994051695
The generated pressure mean: 0.43985286355018616
loss_pred:0.016996759921312332, decouple_loss:0.0033784888219088316
The generated pressure mean: 0.43965262174606323
loss_pred:0.01656957156956196, decouple_loss:0.003281557699665427
Iteration: 8142, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45399847626686096
The generated pressure mean: 0.46134740114212036
loss_pred:0.017400361597537994, decouple_loss:0.0025255675427615643
loss_pred:0.017594875767827034, decouple_loss:0.0021982344333082438
The generated pressure mean: 0.4528045952320099
loss_pred:0.017466558143496513, decouple_loss:0.002285654190927744
Iteration: 8143, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44898009300231934
loss_pred:0.017953108996152878, decouple_loss:0.0030648731626570225
The generated pressure mean: 0.4553070664405823
loss_pred:0.016631610691547394, decouple_loss:0.0031007651705294847
The generated pressure mean: 0.44958528876304626
loss_pred:0.01828835718333721, decouple_loss:0.002981966594234109
Iteration: 8144, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4412710964679718
The generated pressure mean: 0.43908771872520447
loss_pred:0.016816982999444008, decouple_loss:0.0021665990352630615
loss_pred:0.016547298058867455, decouple_loss:0.0020801438950002193
The generated pressure mean: 0.4375026524066925
loss_pred:0.016997765749692917, decouple_loss:0.0021237130276858807
Iteration: 8145, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44899648427963257
The generated pressure mean: 0.45580774545669556
loss_pred:0.017165707424283028, decouple_loss:0.002372897230088711
loss_pred:0.01732572168111801, decouple_loss:0.002403013641014695
The generated pressure mean: 0.4489430785179138
loss_pred:0.017089808359742165, decouple_loss:0.0025974970776587725
Iteration: 8146, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4544543921947479
The generated pressure mean: 0.45311442017555237
loss_pred:0.016210777685046196, decouple_loss:0.0024447389878332615
loss_pred:0.017183776944875717, decouple_loss:0.0022677357774227858
The generated pressure mean: 0.4489816725254059
loss_pred:0.017055509611964226, decouple_loss:0.0023435153998434544
Iteration: 8147, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4430605471134186
loss_pred:0.016856404021382332, decouple_loss:0.001987029332667589
The generated pressure mean: 0.43919602036476135
loss_pred:0.017282947897911072, decouple_loss:0.0020042562391608953
The generated pressure mean: 0.43857377767562866
loss_pred:0.01678002066910267, decouple_loss:0.0019207519944757223
Iteration: 8148, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4497421085834503
The generated pressure mean: 0.44876930117607117
loss_pred:0.017357589676976204, decouple_loss:0.0017899745143949986
loss_pred:0.01765342243015766, decouple_loss:0.0018793906783685088
The generated pressure mean: 0.4421752691268921
loss_pred:0.01613183505833149, decouple_loss:0.001959230052307248
Iteration: 8149, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46408945322036743
The generated pressure mean: 0.46017494797706604
loss_pred:0.016685176640748978, decouple_loss:0.00203515961766243
loss_pred:0.0169933270663023, decouple_loss:0.0021620120387524366
The generated pressure mean: 0.46256154775619507
loss_pred:0.01740953139960766, decouple_loss:0.0020596471149474382
Iteration: 8150, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44404101371765137
loss_pred:0.018038978800177574, decouple_loss:0.002282501198351383
The generated pressure mean: 0.4391644597053528
loss_pred:0.01601853221654892, decouple_loss:0.0020251579117029905
The generated pressure mean: 0.4476778507232666
loss_pred:0.01724214479327202, decouple_loss:0.0020196468103677034
2023-04-17 18:25:32 testing...
The generated pressure mean: 0.41617411375045776
The generated pressure mean: 0.42368823289871216
loss_pred:0.03054363839328289, decouple_loss:0.0025306646712124348
The generated pressure mean: 0.4262479841709137
loss_pred:0.029526636004447937, decouple_loss:0.002573950681835413
loss_pred:0.029065091162919998, decouple_loss:0.0025605931878089905
WV_0_PC_0_EH_1_PS_40, loss: 0.029839541763067245, avg_mse: 0.04579687491059303
current test mse: 0.045797
Iteration: 8151, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4372731149196625
loss_pred:0.019736595451831818, decouple_loss:0.001967531396076083
The generated pressure mean: 0.4378337860107422
loss_pred:0.017762664705514908, decouple_loss:0.0020446907728910446
The generated pressure mean: 0.43720191717147827
loss_pred:0.017494982108473778, decouple_loss:0.0018807839369401336
Iteration: 8152, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45397841930389404
loss_pred:0.016492357477545738, decouple_loss:0.0018685011891648173
The generated pressure mean: 0.4538789391517639
loss_pred:0.01620488055050373, decouple_loss:0.0019422245677560568
The generated pressure mean: 0.45282498002052307
loss_pred:0.01675775647163391, decouple_loss:0.0018372362246736884
Iteration: 8153, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44831037521362305
loss_pred:0.017915651202201843, decouple_loss:0.001910333288833499
The generated pressure mean: 0.4515228569507599
loss_pred:0.01650707982480526, decouple_loss:0.0019392224494367838
The generated pressure mean: 0.4497263729572296
loss_pred:0.016469594091176987, decouple_loss:0.0018971639219671488
Iteration: 8154, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4521128535270691
loss_pred:0.016864759847521782, decouple_loss:0.002123966347426176
The generated pressure mean: 0.4435065984725952
loss_pred:0.015290084294974804, decouple_loss:0.0018176828743889928
The generated pressure mean: 0.44434982538223267
loss_pred:0.01945590227842331, decouple_loss:0.001964711118489504
Iteration: 8155, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44126173853874207
loss_pred:0.016387026757001877, decouple_loss:0.002238356973975897
The generated pressure mean: 0.4504030644893646
loss_pred:0.017373228445649147, decouple_loss:0.0022682121489197016
The generated pressure mean: 0.4413851201534271
loss_pred:0.017468051984906197, decouple_loss:0.0021921941079199314
Iteration: 8156, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4547920227050781
loss_pred:0.017855502665042877, decouple_loss:0.0018071073573082685
The generated pressure mean: 0.45821326971054077
loss_pred:0.01684553176164627, decouple_loss:0.0018286074046045542
The generated pressure mean: 0.4527343213558197
loss_pred:0.01813955418765545, decouple_loss:0.0019205630524083972
Iteration: 8157, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43813222646713257
loss_pred:0.018510926514863968, decouple_loss:0.0019054628210142255
The generated pressure mean: 0.43993285298347473
loss_pred:0.016722436994314194, decouple_loss:0.0018539219163358212
The generated pressure mean: 0.439172625541687
loss_pred:0.015719089657068253, decouple_loss:0.0018770865863189101
Iteration: 8158, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44906964898109436
loss_pred:0.017710978165268898, decouple_loss:0.002301469212397933
The generated pressure mean: 0.4466436207294464
loss_pred:0.017351150512695312, decouple_loss:0.002278932835906744
The generated pressure mean: 0.4458172917366028
loss_pred:0.01691867969930172, decouple_loss:0.0023554484359920025
Iteration: 8159, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4625357687473297
loss_pred:0.01817547157406807, decouple_loss:0.0028251498006284237
The generated pressure mean: 0.458682656288147
The generated pressure mean: 0.458417147397995
loss_pred:0.017898140475153923, decouple_loss:0.0025261545088142157
loss_pred:0.017890222370624542, decouple_loss:0.002683015540242195
Iteration: 8160, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4381040930747986
loss_pred:0.01731906272470951, decouple_loss:0.0020589311607182026
The generated pressure mean: 0.4346540570259094
loss_pred:0.01602942869067192, decouple_loss:0.0021149616222828627
The generated pressure mean: 0.4302104413509369
loss_pred:0.016929207369685173, decouple_loss:0.002030800562351942
2023-04-17 18:27:25 testing...
The generated pressure mean: 0.4134151339530945
The generated pressure mean: 0.42117515206336975
The generated pressure mean: 0.42318257689476013
loss_pred:0.031860969960689545, decouple_loss:0.002721558092162013
loss_pred:0.030733691528439522, decouple_loss:0.002868825336918235
loss_pred:0.03031551092863083, decouple_loss:0.0029788922984153032
WV_0_PC_0_EH_1_PS_40, loss: 0.031112879514694214, avg_mse: 0.04838917776942253
current test mse: 0.048389
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 8161, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44403910636901855
loss_pred:0.016493678092956543, decouple_loss:0.0021571333054453135
The generated pressure mean: 0.446045458316803
loss_pred:0.016496676951646805, decouple_loss:0.002115952782332897
The generated pressure mean: 0.448221355676651
loss_pred:0.016984136775135994, decouple_loss:0.002401362406089902
Iteration: 8162, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4554935097694397
The generated pressure mean: 0.454335480928421loss_pred:0.01622472144663334, decouple_loss:0.0026854078751057386
loss_pred:0.017809422686696053, decouple_loss:0.002761626150459051
The generated pressure mean: 0.4509218633174896
loss_pred:0.016246894374489784, decouple_loss:0.002745647681877017
Iteration: 8163, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4436015188694
loss_pred:0.017419425770640373, decouple_loss:0.0021730682346969843
The generated pressure mean: 0.4397285282611847
loss_pred:0.016781235113739967, decouple_loss:0.0021417317911982536
The generated pressure mean: 0.44286081194877625
loss_pred:0.01660219579935074, decouple_loss:0.002080336445942521
Iteration: 8164, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447049617767334
The generated pressure mean: 0.4482332170009613
loss_pred:0.018927499651908875, decouple_loss:0.0021253430750221014
loss_pred:0.017021136358380318, decouple_loss:0.002226852346211672
The generated pressure mean: 0.44916200637817383
loss_pred:0.017234334722161293, decouple_loss:0.0020306436344981194
Iteration: 8165, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492393136024475
loss_pred:0.016141997650265694, decouple_loss:0.002611938863992691
The generated pressure mean: 0.4511571228504181
loss_pred:0.01692768558859825, decouple_loss:0.002677028300240636
The generated pressure mean: 0.45330846309661865
loss_pred:0.016820695251226425, decouple_loss:0.0026032053865492344
Iteration: 8166, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4418897032737732
loss_pred:0.016281871125102043, decouple_loss:0.002116256393492222
The generated pressure mean: 0.4440532326698303
loss_pred:0.016393274068832397, decouple_loss:0.0020463804248720407
The generated pressure mean: 0.44306251406669617
loss_pred:0.01676804944872856, decouple_loss:0.0020288790110498667
Iteration: 8167, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466313123703003
loss_pred:0.018558818846940994, decouple_loss:0.0022237689699977636
The generated pressure mean: 0.4490267336368561
loss_pred:0.01709597557783127, decouple_loss:0.0020989885088056326
The generated pressure mean: 0.4490269720554352
loss_pred:0.016212740913033485, decouple_loss:0.0022671979386359453
Iteration: 8168, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44070273637771606
loss_pred:0.017405834048986435, decouple_loss:0.0021554504055529833
The generated pressure mean: 0.43815016746520996
loss_pred:0.019638491794466972, decouple_loss:0.002361953491345048
The generated pressure mean: 0.44209808111190796
loss_pred:0.015752341598272324, decouple_loss:0.0022953380830585957
Iteration: 8169, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44978857040405273
loss_pred:0.016617555171251297, decouple_loss:0.002129858825355768
The generated pressure mean: 0.44849804043769836
loss_pred:0.01630372181534767, decouple_loss:0.0020280492026358843
The generated pressure mean: 0.4472149610519409
loss_pred:0.01577412709593773, decouple_loss:0.00221633561886847
Iteration: 8170, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45210567116737366
loss_pred:0.01611900143325329, decouple_loss:0.002002980327233672
The generated pressure mean: 0.45709314942359924
loss_pred:0.016631243750452995, decouple_loss:0.0019743761513382196
The generated pressure mean: 0.4536714255809784
loss_pred:0.01696609891951084, decouple_loss:0.0019290839554741979
2023-04-17 18:30:33 testing...
The generated pressure mean: 0.4134058952331543
The generated pressure mean: 0.42019879817962646
loss_pred:0.030812246724963188, decouple_loss:0.002522190799936652
The generated pressure mean: 0.421945720911026
loss_pred:0.029450487345457077, decouple_loss:0.0027476747054606676
loss_pred:0.02907833456993103, decouple_loss:0.002791949547827244
WV_0_PC_0_EH_1_PS_40, loss: 0.029914719983935356, avg_mse: 0.04538610577583313
current test mse: 0.045386
Iteration: 8171, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4420105814933777
loss_pred:0.01752982847392559, decouple_loss:0.0022154306061565876
The generated pressure mean: 0.4434022903442383
loss_pred:0.01706162467598915, decouple_loss:0.002254352904856205
The generated pressure mean: 0.446023166179657
loss_pred:0.016310593113303185, decouple_loss:0.002248801989480853
Iteration: 8172, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4509241282939911
loss_pred:0.01665273681282997, decouple_loss:0.001867891289293766
The generated pressure mean: 0.44690847396850586
loss_pred:0.016308121383190155, decouple_loss:0.001942079747095704
The generated pressure mean: 0.44497013092041016
loss_pred:0.015651727095246315, decouple_loss:0.0016569795552641153
Iteration: 8173, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4423413872718811
loss_pred:0.01789139211177826, decouple_loss:0.0019689598120748997
The generated pressure mean: 0.4453513026237488
loss_pred:0.018247483298182487, decouple_loss:0.0019936938770115376
The generated pressure mean: 0.44763070344924927
loss_pred:0.01563107594847679, decouple_loss:0.002003346337005496
Iteration: 8174, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.445049911737442
loss_pred:0.01625046133995056, decouple_loss:0.002002116059884429
The generated pressure mean: 0.4469583034515381
loss_pred:0.01598248817026615, decouple_loss:0.002072035800665617
The generated pressure mean: 0.4454610049724579
loss_pred:0.01693800464272499, decouple_loss:0.0020354785956442356
Iteration: 8175, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44643789529800415
loss_pred:0.015647994354367256, decouple_loss:0.0018882371950894594
The generated pressure mean: 0.4480755031108856
loss_pred:0.01691208966076374, decouple_loss:0.0020144712179899216
The generated pressure mean: 0.4424366354942322
loss_pred:0.016997909173369408, decouple_loss:0.0019848260562866926
Iteration: 8176, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44952473044395447
loss_pred:0.01625918224453926, decouple_loss:0.0020300140604376793
The generated pressure mean: 0.4507804811000824
loss_pred:0.01761486940085888, decouple_loss:0.0021420002449303865
The generated pressure mean: 0.45674803853034973
loss_pred:0.0173899345099926, decouple_loss:0.002143729478120804
Iteration: 8177, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4451698958873749
The generated pressure mean: 0.4469674527645111
loss_pred:0.016071392223238945, decouple_loss:0.0018033039523288608
loss_pred:0.015316389501094818, decouple_loss:0.002146171173080802
The generated pressure mean: 0.4493500590324402
loss_pred:0.016117949038743973, decouple_loss:0.0018630626145750284
Iteration: 8178, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44068312644958496
loss_pred:0.01638047769665718, decouple_loss:0.0021907181944698095
The generated pressure mean: 0.44142866134643555
loss_pred:0.016053855419158936, decouple_loss:0.0020002955570816994
The generated pressure mean: 0.44377702474594116
loss_pred:0.015595776028931141, decouple_loss:0.001989665674045682
Iteration: 8179, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4473724961280823
loss_pred:0.017595959827303886, decouple_loss:0.0022402596659958363
The generated pressure mean: 0.4425981938838959
loss_pred:0.016955915838479996, decouple_loss:0.002178128343075514
The generated pressure mean: 0.44923135638237
loss_pred:0.018230464309453964, decouple_loss:0.0022254902869462967
Iteration: 8180, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4414254426956177
loss_pred:0.01794113963842392, decouple_loss:0.0023068920709192753
The generated pressure mean: 0.441057026386261
The generated pressure mean: 0.4400548040866852
loss_pred:0.019392283633351326, decouple_loss:0.002418535528704524
loss_pred:0.01847800426185131, decouple_loss:0.0023579418193548918
2023-04-17 18:32:26 testing...
The generated pressure mean: 0.4140084981918335
The generated pressure mean: 0.4207669496536255
The generated pressure mean: 0.4231332242488861
loss_pred:0.030700406059622765, decouple_loss:0.002659315476194024
loss_pred:0.029693040996789932, decouple_loss:0.002716641640290618
loss_pred:0.028971148654818535, decouple_loss:0.002805036259815097
WV_0_PC_0_EH_1_PS_40, loss: 0.0299245472997427, avg_mse: 0.04581980034708977
current test mse: 0.04582
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 8181, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44485118985176086
loss_pred:0.017617499455809593, decouple_loss:0.002413348760455847
The generated pressure mean: 0.4404802918434143
The generated pressure mean: 0.4433530569076538
loss_pred:0.01662246137857437, decouple_loss:0.0022917096503078938
loss_pred:0.016297440975904465, decouple_loss:0.002257340354844928
Iteration: 8182, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.46278271079063416
loss_pred:0.018491331487894058, decouple_loss:0.0021394880022853613
The generated pressure mean: 0.4561830461025238
loss_pred:0.01709095761179924, decouple_loss:0.0020835117902606726
The generated pressure mean: 0.46067357063293457
loss_pred:0.018178869038820267, decouple_loss:0.0021316753700375557
Iteration: 8183, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43821337819099426
loss_pred:0.016646666452288628, decouple_loss:0.001884919824078679
The generated pressure mean: 0.4371234178543091
loss_pred:0.016522129997611046, decouple_loss:0.0018596487352624536
The generated pressure mean: 0.4360671639442444
loss_pred:0.017890464514493942, decouple_loss:0.001822359045036137
Iteration: 8184, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4390377700328827
loss_pred:0.016614649444818497, decouple_loss:0.002015856094658375
The generated pressure mean: 0.44206053018569946
loss_pred:0.01559167355298996, decouple_loss:0.0019266826566308737
The generated pressure mean: 0.43626129627227783
loss_pred:0.017104340717196465, decouple_loss:0.0021326697897166014
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 8185, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4556100070476532
loss_pred:0.01701555773615837, decouple_loss:0.0018601765623316169
The generated pressure mean: 0.4581420421600342
loss_pred:0.017121417447924614, decouple_loss:0.0020014585461467505
The generated pressure mean: 0.45720672607421875
loss_pred:0.015536751598119736, decouple_loss:0.0020056976936757565
Iteration: 8186, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470888078212738
loss_pred:0.017216652631759644, decouple_loss:0.0018293653847649693
The generated pressure mean: 0.4436852037906647
loss_pred:0.016369318589568138, decouple_loss:0.0019797482527792454
The generated pressure mean: 0.44248178601264954
loss_pred:0.017270464450120926, decouple_loss:0.0018761686515063047
Iteration: 8187, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44416946172714233
loss_pred:0.016213808208703995, decouple_loss:0.0020635337568819523
The generated pressure mean: 0.4341951310634613
loss_pred:0.016573524102568626, decouple_loss:0.001994886202737689
The generated pressure mean: 0.4411855638027191
loss_pred:0.017917145043611526, decouple_loss:0.0021544108167290688
Iteration: 8188, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44749680161476135
loss_pred:0.01620684377849102, decouple_loss:0.002623423468321562
The generated pressure mean: 0.4424338638782501
loss_pred:0.016373543068766594, decouple_loss:0.0023798018228262663
The generated pressure mean: 0.44666266441345215
loss_pred:0.017881987616419792, decouple_loss:0.0024508177302777767
Iteration: 8189, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.440347820520401
loss_pred:0.016511723399162292, decouple_loss:0.002113871742039919
The generated pressure mean: 0.44539692997932434
loss_pred:0.017242431640625, decouple_loss:0.0020801618229597807
The generated pressure mean: 0.43838390707969666
loss_pred:0.016619043424725533, decouple_loss:0.002097368473187089
Iteration: 8190, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45195233821868896
The generated pressure mean: 0.4547773599624634
loss_pred:0.01884305104613304, decouple_loss:0.0019366415217518806
loss_pred:0.015952851623296738, decouple_loss:0.0019216682994738221
The generated pressure mean: 0.4504135549068451
loss_pred:0.01679096184670925, decouple_loss:0.001900534494780004
2023-04-17 18:35:43 testing...
The generated pressure mean: 0.41138097643852234
The generated pressure mean: 0.41842129826545715
loss_pred:0.03266346454620361, decouple_loss:0.0028060826007276773
The generated pressure mean: 0.421444296836853
loss_pred:0.03131776303052902, decouple_loss:0.003008167026564479
loss_pred:0.030667798593640327, decouple_loss:0.0030960626900196075
WV_0_PC_0_EH_1_PS_40, loss: 0.031698182225227356, avg_mse: 0.04958369582891464
current test mse: 0.049584
Iteration: 8191, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44909337162971497
loss_pred:0.017398005351424217, decouple_loss:0.002378769451752305The generated pressure mean: 0.45380735397338867
loss_pred:0.016812775284051895, decouple_loss:0.0022969467099756002
The generated pressure mean: 0.4560655355453491
loss_pred:0.017459874972701073, decouple_loss:0.002215409418568015
Iteration: 8192, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44455084204673767
loss_pred:0.01717568188905716, decouple_loss:0.0020261467434465885
The generated pressure mean: 0.43416792154312134
loss_pred:0.01648460142314434, decouple_loss:0.001960218418389559
The generated pressure mean: 0.4377317726612091
loss_pred:0.016390254721045494, decouple_loss:0.0019351134542375803
Iteration: 8193, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43788325786590576
loss_pred:0.016002697870135307, decouple_loss:0.0020741575863212347
The generated pressure mean: 0.43902745842933655
loss_pred:0.017495207488536835, decouple_loss:0.002117960248142481
The generated pressure mean: 0.4306299686431885
loss_pred:0.01802409626543522, decouple_loss:0.0021435613743960857
Iteration: 8194, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44830912351608276
loss_pred:0.0160073172301054, decouple_loss:0.0020998779218643904
The generated pressure mean: 0.4473322033882141
loss_pred:0.016868960112333298, decouple_loss:0.0021755194757133722
The generated pressure mean: 0.45203158259391785
loss_pred:0.016581542789936066, decouple_loss:0.0021050432696938515
Iteration: 8195, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45191532373428345
loss_pred:0.016694970428943634, decouple_loss:0.001755960751324892
The generated pressure mean: 0.4479333758354187
loss_pred:0.01659991778433323, decouple_loss:0.001793130417354405
The generated pressure mean: 0.44767120480537415
loss_pred:0.016624532639980316, decouple_loss:0.0017823785310611129
Iteration: 8196, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44610533118247986
loss_pred:0.015576665289700031, decouple_loss:0.0017211544327437878
The generated pressure mean: 0.44258633255958557
loss_pred:0.01613721251487732, decouple_loss:0.0016420665197074413
The generated pressure mean: 0.44284021854400635
loss_pred:0.0172573272138834, decouple_loss:0.0016960352659225464
Iteration: 8197, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44384604692459106
loss_pred:0.018952762708067894, decouple_loss:0.0018466883338987827
The generated pressure mean: 0.4469999372959137
loss_pred:0.015490327030420303, decouple_loss:0.001752770273014903
The generated pressure mean: 0.44363221526145935
loss_pred:0.016383850947022438, decouple_loss:0.0017077927477657795
Iteration: 8198, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4499194920063019
loss_pred:0.016721904277801514, decouple_loss:0.002343782689422369The generated pressure mean: 0.44807690382003784
loss_pred:0.016463706269860268, decouple_loss:0.0023437729105353355
The generated pressure mean: 0.45321187376976013
loss_pred:0.01714426465332508, decouple_loss:0.0023708115331828594
Iteration: 8199, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43900832533836365
loss_pred:0.017962785437703133, decouple_loss:0.0021560729946941137
The generated pressure mean: 0.44463029503822327
loss_pred:0.015765322372317314, decouple_loss:0.002214561915025115
The generated pressure mean: 0.4386325180530548
loss_pred:0.017270755022764206, decouple_loss:0.0021949245128780603
Iteration: 8200, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43968915939331055
loss_pred:0.01667853631079197, decouple_loss:0.0019970741122961044
The generated pressure mean: 0.4422319233417511
loss_pred:0.017345214262604713, decouple_loss:0.002009972697123885
The generated pressure mean: 0.44168803095817566
loss_pred:0.01660638302564621, decouple_loss:0.0020834815222769976
2023-04-17 18:37:37 testing...
The generated pressure mean: 0.41184118390083313
The generated pressure mean: 0.4186041057109833
loss_pred:0.0312904454767704, decouple_loss:0.00228220596909523
The generated pressure mean: 0.42179712653160095
loss_pred:0.03028007037937641, decouple_loss:0.002420466858893633
loss_pred:0.029288236051797867, decouple_loss:0.00254138489253819
WV_0_PC_0_EH_1_PS_40, loss: 0.03040698543190956, avg_mse: 0.046816352754831314
current test mse: 0.046816
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 8201, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45515358448028564
loss_pred:0.017284289002418518, decouple_loss:0.001964193768799305
The generated pressure mean: 0.4537108242511749
loss_pred:0.016673753038048744, decouple_loss:0.001912904204800725
The generated pressure mean: 0.4511841833591461
loss_pred:0.016297534108161926, decouple_loss:0.0018808833556249738
Iteration: 8202, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4448314905166626
The generated pressure mean: 0.4478206932544708
loss_pred:0.016693618148565292, decouple_loss:0.0020532398484647274
loss_pred:0.019080422818660736, decouple_loss:0.0019933076109737158
The generated pressure mean: 0.45058614015579224
loss_pred:0.017367960885167122, decouple_loss:0.001979701453819871
Iteration: 8203, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44002020359039307
loss_pred:0.016368430107831955, decouple_loss:0.0022180990781635046
The generated pressure mean: 0.4386666417121887
loss_pred:0.019131917506456375, decouple_loss:0.002309150528162718
The generated pressure mean: 0.43460363149642944
loss_pred:0.016949882730841637, decouple_loss:0.00223720446228981
Iteration: 8204, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4617835283279419
loss_pred:0.016709281131625175, decouple_loss:0.0024393259081989527
The generated pressure mean: 0.46175065636634827
loss_pred:0.01790611259639263, decouple_loss:0.0025411939714103937
The generated pressure mean: 0.462655246257782
loss_pred:0.017228204756975174, decouple_loss:0.0024660518392920494
Iteration: 8205, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.437349796295166
The generated pressure mean: 0.43411070108413696
loss_pred:0.017109857872128487, decouple_loss:0.0023651907686144114
loss_pred:0.01719326712191105, decouple_loss:0.0023231764789670706
The generated pressure mean: 0.43528783321380615
loss_pred:0.01731436885893345, decouple_loss:0.002293323166668415
Iteration: 8206, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43634358048439026
loss_pred:0.017399098724126816, decouple_loss:0.0022568926215171814
The generated pressure mean: 0.43895554542541504
loss_pred:0.01625385880470276, decouple_loss:0.0022088661789894104
The generated pressure mean: 0.4405720829963684
loss_pred:0.016191381961107254, decouple_loss:0.002222879324108362
Iteration: 8207, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4577261507511139
The generated pressure mean: 0.4592210352420807loss_pred:0.017707787454128265, decouple_loss:0.0025456836447119713
loss_pred:0.01689593307673931, decouple_loss:0.0025890334509313107
The generated pressure mean: 0.45906776189804077
loss_pred:0.016532287001609802, decouple_loss:0.0024760079104453325
Iteration: 8208, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4526144862174988
The generated pressure mean: 0.4536571204662323
loss_pred:0.017048869282007217, decouple_loss:0.002135424641892314
loss_pred:0.016239101067185402, decouple_loss:0.0022005788050591946
The generated pressure mean: 0.4536500871181488
loss_pred:0.01729368232190609, decouple_loss:0.0021855225786566734
Iteration: 8209, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43781349062919617
loss_pred:0.017080528661608696, decouple_loss:0.0025405073538422585
The generated pressure mean: 0.44022631645202637
loss_pred:0.017526328563690186, decouple_loss:0.0024876839015632868
The generated pressure mean: 0.4392267167568207
loss_pred:0.016342978924512863, decouple_loss:0.0024878601543605328
Iteration: 8210, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4361989200115204
The generated pressure mean: 0.4359116852283478
loss_pred:0.01756761409342289, decouple_loss:0.002842301269993186
loss_pred:0.016226952895522118, decouple_loss:0.0028953496366739273
The generated pressure mean: 0.4381227493286133
loss_pred:0.01568634621798992, decouple_loss:0.0028179362416267395
2023-04-17 18:40:29 testing...
The generated pressure mean: 0.41219040751457214
The generated pressure mean: 0.4191528856754303
The generated pressure mean: 0.4223870635032654
loss_pred:0.03193133324384689, decouple_loss:0.002608703449368477
loss_pred:0.030377836897969246, decouple_loss:0.0028646765276789665
loss_pred:0.031102173030376434, decouple_loss:0.0027901523280888796
WV_0_PC_0_EH_1_PS_40, loss: 0.031274840235710144, avg_mse: 0.048306655138731
current test mse: 0.048307
Iteration: 8211, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4547709822654724
loss_pred:0.017660021781921387, decouple_loss:0.0021862767171114683
The generated pressure mean: 0.45058321952819824
loss_pred:0.017159629613161087, decouple_loss:0.00210725050419569
The generated pressure mean: 0.4534018039703369
loss_pred:0.0181948971003294, decouple_loss:0.002098117023706436
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 8212, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44856733083724976
The generated pressure mean: 0.4482153058052063loss_pred:0.01738392375409603, decouple_loss:0.0028460018802434206
loss_pred:0.015750382095575333, decouple_loss:0.0027838617097586393
The generated pressure mean: 0.4460970461368561
loss_pred:0.016668466851115227, decouple_loss:0.0026984289288520813
Iteration: 8213, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44502225518226624
The generated pressure mean: 0.44543007016181946
loss_pred:0.01637616567313671, decouple_loss:0.002203618874773383
loss_pred:0.016219405457377434, decouple_loss:0.0021602546330541372
The generated pressure mean: 0.4461178183555603
loss_pred:0.01637783646583557, decouple_loss:0.002238861285150051
Iteration: 8214, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44947952032089233The generated pressure mean: 0.4455587565898895
loss_pred:0.016979027539491653, decouple_loss:0.002005283022299409
loss_pred:0.015621176920831203, decouple_loss:0.001997137675061822
The generated pressure mean: 0.44536930322647095
loss_pred:0.016379527747631073, decouple_loss:0.0019881094340234995
Iteration: 8215, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4557786285877228
loss_pred:0.016688497737050056, decouple_loss:0.0023914563935250044
The generated pressure mean: 0.4551883041858673
loss_pred:0.016924796625971794, decouple_loss:0.002321260515600443
The generated pressure mean: 0.4521515667438507
loss_pred:0.01943880505859852, decouple_loss:0.00230592442676425
Iteration: 8216, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4342215061187744
The generated pressure mean: 0.4338380992412567
loss_pred:0.019380783662199974, decouple_loss:0.002151674125343561
loss_pred:0.01653742417693138, decouple_loss:0.0021172112319618464
The generated pressure mean: 0.4330678880214691
loss_pred:0.017253434285521507, decouple_loss:0.0020518144592642784
Iteration: 8217, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44659748673439026
The generated pressure mean: 0.4462486505508423
loss_pred:0.018243961036205292, decouple_loss:0.002402698853984475
loss_pred:0.017171647399663925, decouple_loss:0.0023945807479321957
The generated pressure mean: 0.4496385157108307
loss_pred:0.017448827624320984, decouple_loss:0.002510865218937397
Iteration: 8218, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45282629132270813
loss_pred:0.01631852239370346, decouple_loss:0.0016878223977982998
The generated pressure mean: 0.44734856486320496
The generated pressure mean: 0.44731605052948
loss_pred:0.016742605715990067, decouple_loss:0.001789335859939456
loss_pred:0.017698075622320175, decouple_loss:0.00181299215182662
Iteration: 8219, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4417385756969452
loss_pred:0.017653219401836395, decouple_loss:0.0025215446949005127
The generated pressure mean: 0.43880197405815125
The generated pressure mean: 0.44441646337509155
loss_pred:0.01697368174791336, decouple_loss:0.002564262365922332
loss_pred:0.017241068184375763, decouple_loss:0.002579712076112628
Iteration: 8220, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4478713274002075
loss_pred:0.01671568863093853, decouple_loss:0.0020937102381139994
The generated pressure mean: 0.44794920086860657The generated pressure mean: 0.4481847584247589
loss_pred:0.017649564892053604, decouple_loss:0.0020262952893972397
loss_pred:0.015939366072416306, decouple_loss:0.0021203653886914253
2023-04-17 18:42:23 testing...
The generated pressure mean: 0.4117148816585541
The generated pressure mean: 0.4178689122200012
The generated pressure mean: 0.42040175199508667
loss_pred:0.032360490411520004, decouple_loss:0.0027276549953967333
loss_pred:0.03127102181315422, decouple_loss:0.0028222317341715097
loss_pred:0.03067225217819214, decouple_loss:0.0028350830543786287
WV_0_PC_0_EH_1_PS_40, loss: 0.03157433867454529, avg_mse: 0.04850326478481293
current test mse: 0.048503
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 8221, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4490344524383545
loss_pred:0.018968084827065468, decouple_loss:0.002495328662917018
The generated pressure mean: 0.4524865448474884
loss_pred:0.016698505729436874, decouple_loss:0.002602112013846636
The generated pressure mean: 0.45187658071517944
loss_pred:0.01717342622578144, decouple_loss:0.002612716518342495
Iteration: 8222, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446657657623291
The generated pressure mean: 0.445142924785614
loss_pred:0.017508981749415398, decouple_loss:0.0022609345614910126
loss_pred:0.016658291220664978, decouple_loss:0.0021289282012730837
The generated pressure mean: 0.44588974118232727
loss_pred:0.02000780589878559, decouple_loss:0.002227881457656622
Iteration: 8223, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44500306248664856
The generated pressure mean: 0.4488309621810913
loss_pred:0.018064338713884354, decouple_loss:0.0019618431106209755
loss_pred:0.015254228375852108, decouple_loss:0.001991152996197343
The generated pressure mean: 0.4440312683582306
loss_pred:0.01781400665640831, decouple_loss:0.002023761859163642
Iteration: 8224, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4415688216686249
The generated pressure mean: 0.4399910569190979
loss_pred:0.016365965828299522, decouple_loss:0.0021111490204930305
loss_pred:0.016718309372663498, decouple_loss:0.0020644133910536766
The generated pressure mean: 0.43934571743011475
loss_pred:0.016971388831734657, decouple_loss:0.0019453078275546432
Iteration: 8225, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4416682720184326The generated pressure mean: 0.4425407648086548
loss_pred:0.014878089539706707, decouple_loss:0.001961266156286001
loss_pred:0.01735313981771469, decouple_loss:0.001943256938830018
The generated pressure mean: 0.4444945752620697
loss_pred:0.017114762216806412, decouple_loss:0.001883302116766572
Iteration: 8226, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4572159945964813
The generated pressure mean: 0.4511197507381439
loss_pred:0.01665124110877514, decouple_loss:0.0020677847787737846
loss_pred:0.01792948693037033, decouple_loss:0.0021706249099224806
The generated pressure mean: 0.45630136132240295
loss_pred:0.016339976340532303, decouple_loss:0.0020567388273775578
Iteration: 8227, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4504922032356262
The generated pressure mean: 0.44462454319000244
loss_pred:0.016734939068555832, decouple_loss:0.0020700569730252028
loss_pred:0.015783051028847694, decouple_loss:0.0017984147416427732
The generated pressure mean: 0.443726122379303
loss_pred:0.01631467044353485, decouple_loss:0.0018994647543877363
Iteration: 8228, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4355637729167938
loss_pred:0.016404228284955025, decouple_loss:0.002107640029862523
The generated pressure mean: 0.4421890377998352
loss_pred:0.01682397723197937, decouple_loss:0.001999674830585718
The generated pressure mean: 0.4359331727027893
loss_pred:0.01692233979701996, decouple_loss:0.0020598392002284527
Iteration: 8229, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45205700397491455
The generated pressure mean: 0.44924646615982056
loss_pred:0.01590435951948166, decouple_loss:0.0018278042552992702
loss_pred:0.016455605626106262, decouple_loss:0.0017850107979029417
The generated pressure mean: 0.45109930634498596
loss_pred:0.016903579235076904, decouple_loss:0.001833814661949873
Iteration: 8230, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44818875193595886
The generated pressure mean: 0.45048654079437256
loss_pred:0.016211576759815216, decouple_loss:0.0016882073832675815
loss_pred:0.01696733944118023, decouple_loss:0.0017558387480676174
The generated pressure mean: 0.45001310110092163
loss_pred:0.016822759062051773, decouple_loss:0.0016485268715769053
2023-04-17 18:45:37 testing...
The generated pressure mean: 0.4142754077911377
The generated pressure mean: 0.4206037223339081
The generated pressure mean: 0.42333024740219116
loss_pred:0.030978301540017128, decouple_loss:0.002188031794503331
loss_pred:0.03019341453909874, decouple_loss:0.002371370792388916
loss_pred:0.02955690585076809, decouple_loss:0.0023749303072690964
WV_0_PC_0_EH_1_PS_40, loss: 0.0303584486246109, avg_mse: 0.04674864932894707
current test mse: 0.046749
Iteration: 8231, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.443889319896698
The generated pressure mean: 0.43695101141929626loss_pred:0.0171528123319149, decouple_loss:0.0020967598538845778
loss_pred:0.01613207347691059, decouple_loss:0.002039628801867366
The generated pressure mean: 0.44073614478111267
loss_pred:0.01648002862930298, decouple_loss:0.002000202424824238
Iteration: 8232, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44652679562568665
loss_pred:0.01599518023431301, decouple_loss:0.0018335893983021379
The generated pressure mean: 0.44539469480514526
loss_pred:0.017516858875751495, decouple_loss:0.0018786031287163496
The generated pressure mean: 0.44545015692710876
loss_pred:0.01573769934475422, decouple_loss:0.001872468157671392
Iteration: 8233, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4520876109600067
loss_pred:0.016460256651043892, decouple_loss:0.001837278134189546
The generated pressure mean: 0.4541570842266083
loss_pred:0.01611356809735298, decouple_loss:0.001755189965479076
The generated pressure mean: 0.4546451270580292
loss_pred:0.017739150673151016, decouple_loss:0.0017899314407259226
Iteration: 8234, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4452430307865143
loss_pred:0.017278876155614853, decouple_loss:0.0022441463079303503
The generated pressure mean: 0.44251585006713867
loss_pred:0.019039403647184372, decouple_loss:0.0021629217080771923
The generated pressure mean: 0.4453047513961792
loss_pred:0.017397399991750717, decouple_loss:0.002274180296808481
Iteration: 8235, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4369440972805023
loss_pred:0.018100149929523468, decouple_loss:0.001938944449648261
The generated pressure mean: 0.4337892532348633
loss_pred:0.017971321940422058, decouple_loss:0.002040681429207325
The generated pressure mean: 0.4328404366970062
loss_pred:0.016685741022229195, decouple_loss:0.002013161778450012
Iteration: 8236, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45684707164764404
loss_pred:0.017373787239193916, decouple_loss:0.0023136534728109837
The generated pressure mean: 0.4520871639251709
loss_pred:0.017520081251859665, decouple_loss:0.0023470111191272736
The generated pressure mean: 0.45042040944099426
loss_pred:0.018243497237563133, decouple_loss:0.0023346112575381994
Iteration: 8237, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44975563883781433
loss_pred:0.01829708367586136, decouple_loss:0.0019055462907999754
The generated pressure mean: 0.4465392529964447
loss_pred:0.01659364439547062, decouple_loss:0.0018844431033357978
The generated pressure mean: 0.44328445196151733
loss_pred:0.017117440700531006, decouple_loss:0.0018975718412548304
Iteration: 8238, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.443252295255661
loss_pred:0.016555780544877052, decouple_loss:0.002109155058860779
The generated pressure mean: 0.4454324543476105
loss_pred:0.017504891380667686, decouple_loss:0.002126813866198063
The generated pressure mean: 0.4432718753814697
loss_pred:0.016186198219656944, decouple_loss:0.0021771665196865797
Iteration: 8239, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44170108437538147
The generated pressure mean: 0.4429548382759094
loss_pred:0.016974983736872673, decouple_loss:0.001792420633137226
loss_pred:0.017059851437807083, decouple_loss:0.001838415628299117
The generated pressure mean: 0.4425228238105774
loss_pred:0.01724989525973797, decouple_loss:0.0017969200853258371
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 8240, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45140278339385986
loss_pred:0.017452692613005638, decouple_loss:0.001612205058336258
The generated pressure mean: 0.4468475580215454
loss_pred:0.016135580837726593, decouple_loss:0.0017120917327702045
The generated pressure mean: 0.4542345702648163
loss_pred:0.01657680794596672, decouple_loss:0.0016834328416734934
2023-04-17 18:47:30 testing...
The generated pressure mean: 0.41405731439590454
The generated pressure mean: 0.4210817515850067
loss_pred:0.03039882704615593, decouple_loss:0.0024720001965761185
The generated pressure mean: 0.4242175817489624
loss_pred:0.029409421607851982, decouple_loss:0.0026414801832288504
loss_pred:0.02888443134725094, decouple_loss:0.002695081289857626
WV_0_PC_0_EH_1_PS_40, loss: 0.029694369062781334, avg_mse: 0.04539037123322487
current test mse: 0.04539
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 8241, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.446064293384552
loss_pred:0.016282444819808006, decouple_loss:0.0022039180621504784
The generated pressure mean: 0.4453575015068054
The generated pressure mean: 0.4493744671344757
loss_pred:0.01706228032708168, decouple_loss:0.002231043530628085
loss_pred:0.016367562115192413, decouple_loss:0.0021581482142210007
Iteration: 8242, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4417774975299835
The generated pressure mean: 0.4402114748954773
loss_pred:0.017175113782286644, decouple_loss:0.0020486176945269108
loss_pred:0.01681038923561573, decouple_loss:0.0021815099753439426
The generated pressure mean: 0.4463595449924469
loss_pred:0.016953883692622185, decouple_loss:0.0021559784654527903
Iteration: 8243, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4492333233356476
The generated pressure mean: 0.4496690034866333
loss_pred:0.0198324304074049, decouple_loss:0.0019739926792681217
loss_pred:0.016179919242858887, decouple_loss:0.0018542705802246928
The generated pressure mean: 0.4473051428794861
loss_pred:0.01708044297993183, decouple_loss:0.001963019371032715
Iteration: 8244, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4428345561027527
The generated pressure mean: 0.4387320280075073
loss_pred:0.01716124266386032, decouple_loss:0.0018206802196800709
loss_pred:0.018346186727285385, decouple_loss:0.0018338265363126993
The generated pressure mean: 0.43978044390678406
loss_pred:0.016049565747380257, decouple_loss:0.0018137847073376179
Iteration: 8245, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45155689120292664
The generated pressure mean: 0.4514959156513214
loss_pred:0.016108103096485138, decouple_loss:0.0018790817121043801
loss_pred:0.0173101257532835, decouple_loss:0.0019313993398100138
The generated pressure mean: 0.4506460428237915
loss_pred:0.01736391708254814, decouple_loss:0.0018026421312242746
Iteration: 8246, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4539923369884491
The generated pressure mean: 0.45201873779296875
loss_pred:0.01550209242850542, decouple_loss:0.0016501182690262794
loss_pred:0.01771400310099125, decouple_loss:0.0017809318378567696
The generated pressure mean: 0.4545515775680542
loss_pred:0.01635509729385376, decouple_loss:0.0018029964994639158
Iteration: 8247, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4453202188014984
The generated pressure mean: 0.44638413190841675
loss_pred:0.016684675589203835, decouple_loss:0.0021583749912679195
loss_pred:0.01592966541647911, decouple_loss:0.0022019254975020885
The generated pressure mean: 0.44552159309387207
loss_pred:0.015833904966711998, decouple_loss:0.0022185894194990396
Iteration: 8248, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4423908293247223
loss_pred:0.01833389140665531, decouple_loss:0.001598612405359745
The generated pressure mean: 0.44074445962905884
loss_pred:0.01714644767343998, decouple_loss:0.001610000617802143
The generated pressure mean: 0.4427119493484497
loss_pred:0.015889864414930344, decouple_loss:0.0016316284891217947
Iteration: 8249, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44896453619003296The generated pressure mean: 0.4488922655582428
loss_pred:0.019107220694422722, decouple_loss:0.0020162241999059916
loss_pred:0.01652740314602852, decouple_loss:0.002071520546451211
The generated pressure mean: 0.45442622900009155
loss_pred:0.01792725920677185, decouple_loss:0.0020475343335419893
Iteration: 8250, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4468103349208832
loss_pred:0.01727413199841976, decouple_loss:0.0026992971543222666
The generated pressure mean: 0.44522345066070557
loss_pred:0.016445906832814217, decouple_loss:0.0025711688213050365
The generated pressure mean: 0.44416019320487976
loss_pred:0.01581139676272869, decouple_loss:0.0026153649669140577
2023-04-17 18:50:39 testing...
The generated pressure mean: 0.41440466046333313
The generated pressure mean: 0.42071235179901123
The generated pressure mean: 0.42374104261398315
loss_pred:0.030579233542084694, decouple_loss:0.0025919124018400908
loss_pred:0.029490992426872253, decouple_loss:0.002758251503109932
loss_pred:0.028870297595858574, decouple_loss:0.0028150873258709908
WV_0_PC_0_EH_1_PS_40, loss: 0.02978292852640152, avg_mse: 0.04552825167775154
current test mse: 0.045528
Iteration: 8251, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4426412284374237
loss_pred:0.0172426737844944, decouple_loss:0.0020760628394782543
The generated pressure mean: 0.4427885115146637
loss_pred:0.016997260972857475, decouple_loss:0.0021536224521696568
The generated pressure mean: 0.4425831139087677
loss_pred:0.015149636194109917, decouple_loss:0.0020975072402507067
Iteration: 8252, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44796109199523926
loss_pred:0.017015088349580765, decouple_loss:0.002521955408155918
The generated pressure mean: 0.4504816234111786
loss_pred:0.01713963970541954, decouple_loss:0.002547818934544921
The generated pressure mean: 0.4484151005744934
loss_pred:0.0167390163987875, decouple_loss:0.00246776407584548
Iteration: 8253, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4512823224067688
loss_pred:0.017198456451296806, decouple_loss:0.0021787097211927176
The generated pressure mean: 0.45274093747138977
loss_pred:0.017226234078407288, decouple_loss:0.0022001101169735193
The generated pressure mean: 0.4533265233039856
loss_pred:0.01652868092060089, decouple_loss:0.0023493266198784113
Iteration: 8254, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4458704888820648
The generated pressure mean: 0.44527414441108704
loss_pred:0.016025030985474586, decouple_loss:0.0018271657172590494
loss_pred:0.016091981902718544, decouple_loss:0.0018232400761917233
The generated pressure mean: 0.4425317049026489
loss_pred:0.01723143272101879, decouple_loss:0.001953716157004237
Iteration: 8255, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44164007902145386
The generated pressure mean: 0.4431571066379547
loss_pred:0.018032696098089218, decouple_loss:0.00286254589445889
loss_pred:0.016980238258838654, decouple_loss:0.0027206228114664555
The generated pressure mean: 0.4418967664241791
loss_pred:0.01713702455163002, decouple_loss:0.0027949532959610224
Iteration: 8256, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4589843153953552
The generated pressure mean: 0.45155733823776245
loss_pred:0.017658866941928864, decouple_loss:0.0020190090872347355
loss_pred:0.01632128842175007, decouple_loss:0.0019821650348603725
The generated pressure mean: 0.4545959532260895
loss_pred:0.01568669080734253, decouple_loss:0.0020412986632436514
Iteration: 8257, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485710561275482
The generated pressure mean: 0.44540515542030334
loss_pred:0.016283642500638962, decouple_loss:0.0017658609431236982
loss_pred:0.017178649082779884, decouple_loss:0.001847442938014865
The generated pressure mean: 0.443418949842453
loss_pred:0.017252106219530106, decouple_loss:0.0017509220633655787
Iteration: 8258, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459463059902191
loss_pred:0.018222905695438385, decouple_loss:0.002034194301813841
The generated pressure mean: 0.4410616159439087
loss_pred:0.017558075487613678, decouple_loss:0.0019161009695380926
The generated pressure mean: 0.4416736662387848
loss_pred:0.01755703054368496, decouple_loss:0.001953819300979376
Iteration: 8259, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4437307119369507
The generated pressure mean: 0.4407743215560913
loss_pred:0.017735421657562256, decouple_loss:0.002449620747938752
loss_pred:0.016791997477412224, decouple_loss:0.0024828449822962284
The generated pressure mean: 0.4411128759384155
loss_pred:0.015744827687740326, decouple_loss:0.002313912846148014
Iteration: 8260, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4568391442298889
loss_pred:0.01625463180243969, decouple_loss:0.0020821711514145136
The generated pressure mean: 0.4570149779319763
loss_pred:0.018804339691996574, decouple_loss:0.00206884928047657
The generated pressure mean: 0.4549872875213623
loss_pred:0.015443440526723862, decouple_loss:0.002013577613979578
2023-04-17 18:52:32 testing...
The generated pressure mean: 0.4137516915798187
The generated pressure mean: 0.4200640618801117
The generated pressure mean: 0.42328470945358276
loss_pred:0.030488725751638412, decouple_loss:0.00223434716463089
loss_pred:0.029485264793038368, decouple_loss:0.002396739087998867
loss_pred:0.029027212411165237, decouple_loss:0.0024590168613940477
WV_0_PC_0_EH_1_PS_40, loss: 0.029785236343741417, avg_mse: 0.04568035900592804
current test mse: 0.04568
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 8261, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4466317892074585
loss_pred:0.016665419563651085, decouple_loss:0.0020087440498173237
The generated pressure mean: 0.4477086663246155
The generated pressure mean: 0.44095319509506226
loss_pred:0.016936108469963074, decouple_loss:0.001910183927975595
loss_pred:0.016789322718977928, decouple_loss:0.002007734030485153
Iteration: 8262, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44657179713249207
The generated pressure mean: 0.44944143295288086
loss_pred:0.016364779323339462, decouple_loss:0.0025071962736546993
loss_pred:0.016162065789103508, decouple_loss:0.0022197444923222065
The generated pressure mean: 0.4468821585178375
loss_pred:0.01640871725976467, decouple_loss:0.0024699782952666283
Iteration: 8263, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4522545039653778
The generated pressure mean: 0.4514237940311432
loss_pred:0.016706662252545357, decouple_loss:0.0018434523371979594
loss_pred:0.016793085262179375, decouple_loss:0.001794666051864624
The generated pressure mean: 0.4521934986114502
loss_pred:0.016964970156550407, decouple_loss:0.0019405309576541185
Iteration: 8264, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44283434748649597
The generated pressure mean: 0.440542608499527
loss_pred:0.016698505729436874, decouple_loss:0.0020215094555169344
loss_pred:0.017891203984618187, decouple_loss:0.002046052599325776
The generated pressure mean: 0.4410024881362915
loss_pred:0.016461290419101715, decouple_loss:0.0018760761013254523
Iteration: 8265, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44479021430015564
loss_pred:0.015334918163716793, decouple_loss:0.0021766028366982937
The generated pressure mean: 0.4368736147880554
loss_pred:0.01690138690173626, decouple_loss:0.002318035112693906
The generated pressure mean: 0.4437467157840729
loss_pred:0.017358096316456795, decouple_loss:0.0022350321523845196
Iteration: 8266, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.451270192861557
The generated pressure mean: 0.4565809965133667
loss_pred:0.01686318963766098, decouple_loss:0.001770417089574039
loss_pred:0.01680709607899189, decouple_loss:0.0018120515160262585
The generated pressure mean: 0.45312467217445374
loss_pred:0.016976332291960716, decouple_loss:0.0017507205484434962
Iteration: 8267, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45797693729400635
The generated pressure mean: 0.4557112753391266
loss_pred:0.015839993953704834, decouple_loss:0.0016706249443814158
loss_pred:0.015028605237603188, decouple_loss:0.0017028842121362686
The generated pressure mean: 0.4515283703804016
loss_pred:0.017376724630594254, decouple_loss:0.001768695656210184
Iteration: 8268, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44127824902534485
loss_pred:0.015925392508506775, decouple_loss:0.0021592904813587666
The generated pressure mean: 0.437051922082901
loss_pred:0.016046414151787758, decouple_loss:0.0022301196586340666
The generated pressure mean: 0.44002676010131836
loss_pred:0.018046369776129723, decouple_loss:0.0021460854914039373
Iteration: 8269, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442775845527649
loss_pred:0.01680580899119377, decouple_loss:0.0018198236357420683
The generated pressure mean: 0.4453180134296417
loss_pred:0.01841106079518795, decouple_loss:0.0018217850010842085
The generated pressure mean: 0.44424572587013245
loss_pred:0.01615680195391178, decouple_loss:0.0018118928419426084
Iteration: 8270, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4454556703567505
loss_pred:0.01622558943927288, decouple_loss:0.0017395494505763054
The generated pressure mean: 0.44447746872901917
loss_pred:0.015932589769363403, decouple_loss:0.0016842081677168608
The generated pressure mean: 0.44269856810569763
loss_pred:0.015936968848109245, decouple_loss:0.0017554749501869082
2023-04-17 18:55:27 testing...
The generated pressure mean: 0.4106124937534332
The generated pressure mean: 0.4202834963798523
The generated pressure mean: 0.4168526232242584
loss_pred:0.033493608236312866, decouple_loss:0.0022500043269246817
loss_pred:0.0316954031586647, decouple_loss:0.002398486714810133
loss_pred:0.032453253865242004, decouple_loss:0.0023453920148313046
WV_0_PC_0_EH_1_PS_40, loss: 0.0326639860868454, avg_mse: 0.051424313336610794
current test mse: 0.051424
Iteration: 8271, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45672285556793213
loss_pred:0.017652425915002823, decouple_loss:0.002119940472766757
The generated pressure mean: 0.4617367684841156
loss_pred:0.015950655564665794, decouple_loss:0.0020890668965876102
The generated pressure mean: 0.45812106132507324
loss_pred:0.016350243240594864, decouple_loss:0.0021646751556545496
Iteration: 8272, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44730234146118164
loss_pred:0.01815989799797535, decouple_loss:0.0020834999158978462
The generated pressure mean: 0.4487439692020416
loss_pred:0.016579335555434227, decouple_loss:0.0021419539116322994
The generated pressure mean: 0.4441666007041931
loss_pred:0.016472674906253815, decouple_loss:0.0020715270657092333
Iteration: 8273, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43080854415893555
loss_pred:0.016996044665575027, decouple_loss:0.001861919998191297
The generated pressure mean: 0.4249607026576996
loss_pred:0.015486421063542366, decouple_loss:0.0019333910895511508
The generated pressure mean: 0.43364420533180237
loss_pred:0.016894232481718063, decouple_loss:0.001848198240622878
Iteration: 8274, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45668429136276245
loss_pred:0.01619751751422882, decouple_loss:0.0021151492837816477
The generated pressure mean: 0.4585840404033661
loss_pred:0.018539661541581154, decouple_loss:0.0021355196367949247
The generated pressure mean: 0.4627837836742401
loss_pred:0.019005047157406807, decouple_loss:0.0022341127041727304
Iteration: 8275, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4525299072265625
loss_pred:0.017265019938349724, decouple_loss:0.0019148128340020776
The generated pressure mean: 0.45042210817337036
loss_pred:0.01534141506999731, decouple_loss:0.0018160910112783313
The generated pressure mean: 0.4526379108428955
loss_pred:0.016946328803896904, decouple_loss:0.001920926384627819
Iteration: 8276, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4352433681488037
loss_pred:0.018008463084697723, decouple_loss:0.0018380610272288322
The generated pressure mean: 0.435701847076416
loss_pred:0.016586653888225555, decouple_loss:0.0019304583547636867
The generated pressure mean: 0.43834948539733887
loss_pred:0.01631426066160202, decouple_loss:0.0019680080004036427
Iteration: 8277, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45203903317451477
loss_pred:0.01602320745587349, decouple_loss:0.001830176915973425
The generated pressure mean: 0.45181524753570557
loss_pred:0.015622558072209358, decouple_loss:0.001921532559208572
The generated pressure mean: 0.45183610916137695
loss_pred:0.017635077238082886, decouple_loss:0.0019025627989321947
Iteration: 8278, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4501034915447235
loss_pred:0.020073017105460167, decouple_loss:0.001968354918062687
The generated pressure mean: 0.45133882761001587
loss_pred:0.016424264758825302, decouple_loss:0.0019510521087795496
The generated pressure mean: 0.4491155445575714
loss_pred:0.017962224781513214, decouple_loss:0.0019665048457682133
Iteration: 8279, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43045878410339355
loss_pred:0.016044137999415398, decouple_loss:0.0020436157938092947
The generated pressure mean: 0.4328283965587616
loss_pred:0.018137793987989426, decouple_loss:0.0021899621933698654
The generated pressure mean: 0.4285387396812439
loss_pred:0.01719033345580101, decouple_loss:0.002226209733635187
Iteration: 8280, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4607919752597809
loss_pred:0.01581035740673542, decouple_loss:0.0025604942347854376
The generated pressure mean: 0.4617491364479065
loss_pred:0.0160435251891613, decouple_loss:0.002548907184973359
The generated pressure mean: 0.460299015045166
loss_pred:0.017338726669549942, decouple_loss:0.002476828871294856
2023-04-17 18:57:21 testing...
The generated pressure mean: 0.41123533248901367
The generated pressure mean: 0.41728049516677856
The generated pressure mean: 0.4207110106945038
loss_pred:0.033088766038417816, decouple_loss:0.002981015248224139
loss_pred:0.03196345269680023, decouple_loss:0.003161107422783971
loss_pred:0.03126886487007141, decouple_loss:0.0032629654742777348
WV_0_PC_0_EH_1_PS_40, loss: 0.03226378187537193, avg_mse: 0.05040526017546654
current test mse: 0.050405
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 8281, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45281583070755005
loss_pred:0.015713678672909737, decouple_loss:0.002505785785615444
The generated pressure mean: 0.4481711983680725
loss_pred:0.016155775636434555, decouple_loss:0.0026649439241737127
The generated pressure mean: 0.454946905374527
loss_pred:0.016395624727010727, decouple_loss:0.0027029707562178373
Iteration: 8282, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4481942057609558
loss_pred:0.017799701541662216, decouple_loss:0.0026968095917254686
The generated pressure mean: 0.44684886932373047
loss_pred:0.016055554151535034, decouple_loss:0.002694525523111224
The generated pressure mean: 0.44610998034477234
loss_pred:0.015920115634799004, decouple_loss:0.0027357598301023245
Iteration: 8283, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43156731128692627
The generated pressure mean: 0.4364248514175415
loss_pred:0.015601352788507938, decouple_loss:0.0022540222853422165
loss_pred:0.016839047893881798, decouple_loss:0.0022175603080540895
The generated pressure mean: 0.43678057193756104
loss_pred:0.015837570652365685, decouple_loss:0.002140565775334835
Iteration: 8284, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44950610399246216
The generated pressure mean: 0.4409867525100708
loss_pred:0.01709125190973282, decouple_loss:0.002312568249180913
loss_pred:0.01588449813425541, decouple_loss:0.002445066813379526
The generated pressure mean: 0.4474877119064331
loss_pred:0.015999676659703255, decouple_loss:0.002298536943271756
Iteration: 8285, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45068246126174927
loss_pred:0.014866385608911514, decouple_loss:0.002196407411247492
The generated pressure mean: 0.45560982823371887
loss_pred:0.01593022421002388, decouple_loss:0.002249492332339287
The generated pressure mean: 0.4559575021266937
loss_pred:0.01673251949250698, decouple_loss:0.002257351530715823
Iteration: 8286, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44522517919540405
loss_pred:0.017243249341845512, decouple_loss:0.001788351684808731
The generated pressure mean: 0.4450742304325104
loss_pred:0.017650650814175606, decouple_loss:0.0018086670897901058
The generated pressure mean: 0.44079387187957764
loss_pred:0.017159216105937958, decouple_loss:0.0018624888034537435
Iteration: 8287, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4459705054759979
The generated pressure mean: 0.44321027398109436
loss_pred:0.016759971156716347, decouple_loss:0.0019456837326288223
loss_pred:0.016212549060583115, decouple_loss:0.0019357847049832344
The generated pressure mean: 0.4445064067840576
loss_pred:0.015395752154290676, decouple_loss:0.0019097676267847419
Iteration: 8288, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4488881528377533
loss_pred:0.016270801424980164, decouple_loss:0.0017943050479516387
The generated pressure mean: 0.44831979274749756
loss_pred:0.017042040824890137, decouple_loss:0.0017230311641469598
The generated pressure mean: 0.44787654280662537
loss_pred:0.01604391075670719, decouple_loss:0.001693826518021524
Iteration: 8289, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4484376907348633
The generated pressure mean: 0.442615270614624
loss_pred:0.017016282305121422, decouple_loss:0.001985936425626278
loss_pred:0.016686322167515755, decouple_loss:0.0020054099150002003
The generated pressure mean: 0.4475246071815491
loss_pred:0.016869664192199707, decouple_loss:0.00211055064573884
Iteration: 8290, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4453505575656891
The generated pressure mean: 0.44794759154319763
loss_pred:0.017257235944271088, decouple_loss:0.001886693062260747
loss_pred:0.015585486777126789, decouple_loss:0.002072545001283288
The generated pressure mean: 0.4476373493671417
loss_pred:0.016815174371004105, decouple_loss:0.0019525423413142562
2023-04-17 19:00:20 testing...
The generated pressure mean: 0.41401243209838867
The generated pressure mean: 0.4202241599559784
loss_pred:0.031289808452129364, decouple_loss:0.002122997771948576
The generated pressure mean: 0.4243285357952118
loss_pred:0.030385848134756088, decouple_loss:0.002315326128154993
loss_pred:0.029540998861193657, decouple_loss:0.0023419763892889023
WV_0_PC_0_EH_1_PS_40, loss: 0.030518557876348495, avg_mse: 0.04755767062306404
current test mse: 0.047558
Iteration: 8291, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45110514760017395
loss_pred:0.016627229750156403, decouple_loss:0.0018850999185815454
The generated pressure mean: 0.44722288846969604
loss_pred:0.017160873860120773, decouple_loss:0.0018866185564547777
The generated pressure mean: 0.44850975275039673
loss_pred:0.01683659292757511, decouple_loss:0.0018936308333650231
Iteration: 8292, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4417610764503479
loss_pred:0.016975633800029755, decouple_loss:0.0023170984350144863
The generated pressure mean: 0.4404282569885254
loss_pred:0.016049979254603386, decouple_loss:0.0023284798953682184
The generated pressure mean: 0.43727076053619385
loss_pred:0.016297979280352592, decouple_loss:0.002148857107385993
Iteration: 8293, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43611884117126465
loss_pred:0.016691599041223526, decouple_loss:0.0019295808160677552
The generated pressure mean: 0.4401736259460449
loss_pred:0.016248643398284912, decouple_loss:0.0019976540934294462
The generated pressure mean: 0.43770983815193176
loss_pred:0.01599002070724964, decouple_loss:0.002050213050097227
Iteration: 8294, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4543483853340149
loss_pred:0.015652529895305634, decouple_loss:0.0019525050884112716
The generated pressure mean: 0.4471663236618042
loss_pred:0.016263259574770927, decouple_loss:0.0020871565211564302
The generated pressure mean: 0.4534827768802643
loss_pred:0.016055399551987648, decouple_loss:0.0019008360104635358
Iteration: 8295, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4518967568874359
loss_pred:0.016495423391461372, decouple_loss:0.0017645427724346519
The generated pressure mean: 0.4545735716819763
loss_pred:0.0154194887727499, decouple_loss:0.0018518762663006783
The generated pressure mean: 0.4557481110095978
loss_pred:0.017390411347150803, decouple_loss:0.0017840266227722168
Iteration: 8296, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4472388029098511
loss_pred:0.015498756431043148, decouple_loss:0.0017788581317290664
The generated pressure mean: 0.44758349657058716
loss_pred:0.016215821728110313, decouple_loss:0.0017497010994702578
The generated pressure mean: 0.44645291566848755
loss_pred:0.015451129525899887, decouple_loss:0.0018797364318743348
Iteration: 8297, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4385529160499573
loss_pred:0.01709822565317154, decouple_loss:0.0018989227246493101
The generated pressure mean: 0.43972888588905334
loss_pred:0.016685377806425095, decouple_loss:0.0020079975947737694
The generated pressure mean: 0.43835824728012085
loss_pred:0.01739608682692051, decouple_loss:0.002066298620775342
Iteration: 8298, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44338417053222656
loss_pred:0.017829064279794693, decouple_loss:0.002053211908787489
The generated pressure mean: 0.4495289623737335
loss_pred:0.01672516204416752, decouple_loss:0.002109816763550043
The generated pressure mean: 0.4413783848285675
loss_pred:0.015713373199105263, decouple_loss:0.0021615747828036547
Iteration: 8299, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44913774728775024
loss_pred:0.015797043219208717, decouple_loss:0.0018224542727693915
The generated pressure mean: 0.4530538320541382
loss_pred:0.017449814826250076, decouple_loss:0.0017764827935025096
The generated pressure mean: 0.4482714533805847
loss_pred:0.016407426446676254, decouple_loss:0.0017642343882471323
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 8300, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442153573036194
loss_pred:0.016028981655836105, decouple_loss:0.0020375887397676706
The generated pressure mean: 0.4423222243785858The generated pressure mean: 0.43754416704177856
loss_pred:0.01683921180665493, decouple_loss:0.0021020348649472
loss_pred:0.01563231274485588, decouple_loss:0.002058563753962517
2023-04-17 19:02:14 testing...
The generated pressure mean: 0.41356536746025085
The generated pressure mean: 0.4192390739917755
The generated pressure mean: 0.42288678884506226
loss_pred:0.03146812692284584, decouple_loss:0.0019595802295953035
loss_pred:0.03078606352210045, decouple_loss:0.0021634246222674847
loss_pred:0.029963750392198563, decouple_loss:0.002254106104373932
WV_0_PC_0_EH_1_PS_40, loss: 0.03084559738636017, avg_mse: 0.047912951558828354
current test mse: 0.047913
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 8301, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.447396457195282
loss_pred:0.016465486958622932, decouple_loss:0.0015885642496868968
The generated pressure mean: 0.45078974962234497
loss_pred:0.015326336957514286, decouple_loss:0.0015504404436796904
The generated pressure mean: 0.4443134069442749
loss_pred:0.016398422420024872, decouple_loss:0.0015974979614838958
Iteration: 8302, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4566800594329834
loss_pred:0.01764482632279396, decouple_loss:0.0021061846055090427
The generated pressure mean: 0.456341952085495
loss_pred:0.016443459317088127, decouple_loss:0.00221019028685987
The generated pressure mean: 0.4531841278076172
loss_pred:0.01831541582942009, decouple_loss:0.0021026402246207
Iteration: 8303, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4383777678012848
loss_pred:0.015782427042722702, decouple_loss:0.001782138366252184
The generated pressure mean: 0.446200430393219
The generated pressure mean: 0.44442737102508545loss_pred:0.01868431828916073, decouple_loss:0.0018360234098508954
loss_pred:0.017061855643987656, decouple_loss:0.0017496898071840405
Iteration: 8304, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4445156753063202
loss_pred:0.017809590324759483, decouple_loss:0.0016846044454723597
The generated pressure mean: 0.44333237409591675
loss_pred:0.01563272252678871, decouple_loss:0.0016976686893031001
The generated pressure mean: 0.4432256817817688
loss_pred:0.017859384417533875, decouple_loss:0.0017851541051641107
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 8305, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44171953201293945
loss_pred:0.017094392329454422, decouple_loss:0.0015844821464270353
The generated pressure mean: 0.4446789026260376
loss_pred:0.017607221379876137, decouple_loss:0.0016175127821043134
The generated pressure mean: 0.44299572706222534
loss_pred:0.01712697371840477, decouple_loss:0.001622444367967546
Iteration: 8306, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45098134875297546
loss_pred:0.01786142773926258, decouple_loss:0.0016632238402962685
The generated pressure mean: 0.44754889607429504
The generated pressure mean: 0.44850680232048035
loss_pred:0.015249142423272133, decouple_loss:0.001728317467495799
loss_pred:0.016242673620581627, decouple_loss:0.0015698877396062016
Iteration: 8307, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4514293372631073
loss_pred:0.016911128535866737, decouple_loss:0.0017065497813746333
The generated pressure mean: 0.4528220295906067
The generated pressure mean: 0.4482472538948059
loss_pred:0.01569066196680069, decouple_loss:0.0017351789865642786
loss_pred:0.015784969553351402, decouple_loss:0.0017148122424259782
Iteration: 8308, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4493786692619324
loss_pred:0.01643069088459015, decouple_loss:0.0015278351493179798
The generated pressure mean: 0.45300233364105225
loss_pred:0.01541947852820158, decouple_loss:0.001563870464451611
The generated pressure mean: 0.45604202151298523
loss_pred:0.015800841152668, decouple_loss:0.0015082306927070022
Iteration: 8309, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44090452790260315
loss_pred:0.016109004616737366, decouple_loss:0.002137335715815425
The generated pressure mean: 0.4409426152706146
loss_pred:0.01605796068906784, decouple_loss:0.0021150712855160236
The generated pressure mean: 0.43877074122428894
loss_pred:0.017461970448493958, decouple_loss:0.0020638706628233194
Iteration: 8310, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4418260157108307
loss_pred:0.018202850595116615, decouple_loss:0.0018796398071572185
The generated pressure mean: 0.4372393786907196
loss_pred:0.017007576301693916, decouple_loss:0.0018459218554198742
The generated pressure mean: 0.44013455510139465
loss_pred:0.016533585265278816, decouple_loss:0.0019228687742725015
2023-04-17 19:05:13 testing...
The generated pressure mean: 0.41393837332725525
The generated pressure mean: 0.42083439230918884
The generated pressure mean: 0.4242868423461914
loss_pred:0.032636210322380066, decouple_loss:0.002235268009826541
loss_pred:0.031379252672195435, decouple_loss:0.0025323324371129274
loss_pred:0.03085074946284294, decouple_loss:0.0025843626353889704
WV_0_PC_0_EH_1_PS_40, loss: 0.03174460306763649, avg_mse: 0.04956110194325447
current test mse: 0.049561
Iteration: 8311, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4479762017726898
loss_pred:0.01548770722001791, decouple_loss:0.0017741331830620766
The generated pressure mean: 0.447554349899292
loss_pred:0.015939626842737198, decouple_loss:0.0017962816637009382
The generated pressure mean: 0.44781607389450073
loss_pred:0.016342032700777054, decouple_loss:0.0018864849116653204
Iteration: 8312, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4528731405735016
loss_pred:0.016354752704501152, decouple_loss:0.002045458648353815
The generated pressure mean: 0.4548042416572571
loss_pred:0.015813475474715233, decouple_loss:0.0020152388606220484
The generated pressure mean: 0.453442245721817
loss_pred:0.018622402101755142, decouple_loss:0.0018912559607997537
Iteration: 8313, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4470936954021454
The generated pressure mean: 0.4452653229236603
loss_pred:0.01649709790945053, decouple_loss:0.0021078225690871477
loss_pred:0.015647662803530693, decouple_loss:0.0020742779597640038
The generated pressure mean: 0.44758135080337524
loss_pred:0.016881879419088364, decouple_loss:0.0020507886074483395
Iteration: 8314, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45274147391319275
The generated pressure mean: 0.44994789361953735
loss_pred:0.015140213072299957, decouple_loss:0.0019248542375862598
loss_pred:0.016002772375941277, decouple_loss:0.0019405116327106953
The generated pressure mean: 0.4489392936229706
loss_pred:0.01686052232980728, decouple_loss:0.0019366093911230564
Iteration: 8315, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44430744647979736
The generated pressure mean: 0.44434356689453125
loss_pred:0.015194529667496681, decouple_loss:0.0019026203081011772
loss_pred:0.015852538868784904, decouple_loss:0.0018467868212610483
The generated pressure mean: 0.44668498635292053
loss_pred:0.016595909371972084, decouple_loss:0.0018795131472870708
Iteration: 8316, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44363275170326233
The generated pressure mean: 0.4395952522754669
loss_pred:0.01609928347170353, decouple_loss:0.0018196431919932365
loss_pred:0.016598613932728767, decouple_loss:0.0017858787905424833
The generated pressure mean: 0.4422878324985504
loss_pred:0.016416247934103012, decouple_loss:0.0018287126440554857
Iteration: 8317, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4442724883556366
The generated pressure mean: 0.44205665588378906
loss_pred:0.018098166212439537, decouple_loss:0.0016493985895067453
loss_pred:0.015214769169688225, decouple_loss:0.0016736718825995922
The generated pressure mean: 0.44712212681770325
loss_pred:0.016668694093823433, decouple_loss:0.0017190197249874473
Iteration: 8318, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4572558104991913
loss_pred:0.01698996312916279, decouple_loss:0.0017321482300758362
The generated pressure mean: 0.45514488220214844
loss_pred:0.01607395149767399, decouple_loss:0.0016949708806350827
The generated pressure mean: 0.45532113313674927
loss_pred:0.016205590218305588, decouple_loss:0.0017420341027900577
Iteration: 8319, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44164082407951355
loss_pred:0.01602790132164955, decouple_loss:0.0020442975219339132
The generated pressure mean: 0.44300803542137146
loss_pred:0.016362164169549942, decouple_loss:0.002087463391944766
The generated pressure mean: 0.4424407482147217
loss_pred:0.016533490270376205, decouple_loss:0.002011963864788413
Iteration: 8320, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4408157765865326
The generated pressure mean: 0.4356744587421417
loss_pred:0.017073821276426315, decouple_loss:0.0020505243446677923
loss_pred:0.01605720818042755, decouple_loss:0.002014743397012353
The generated pressure mean: 0.4410775601863861
loss_pred:0.019158070906996727, decouple_loss:0.002040026243776083
2023-04-17 19:07:06 testing...
The generated pressure mean: 0.41922080516815186
The generated pressure mean: 0.41239169239997864
The generated pressure mean: 0.4224167764186859
loss_pred:0.030212650075554848, decouple_loss:0.002678321208804846
loss_pred:0.03125830367207527, decouple_loss:0.0024029011838138103
loss_pred:0.029533594846725464, decouple_loss:0.002657918957993388
WV_0_PC_0_EH_1_PS_40, loss: 0.03046383522450924, avg_mse: 0.04694027081131935
current test mse: 0.04694
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 8321, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45341846346855164
loss_pred:0.016824545338749886, decouple_loss:0.0019436703296378255
The generated pressure mean: 0.45798197388648987
loss_pred:0.015947572886943817, decouple_loss:0.001951674115844071
The generated pressure mean: 0.4489489793777466
loss_pred:0.01615668646991253, decouple_loss:0.0019406165229156613
Iteration: 8322, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45274659991264343
The generated pressure mean: 0.4526171088218689
loss_pred:0.018398210406303406, decouple_loss:0.0024867390748113394
loss_pred:0.01703731156885624, decouple_loss:0.002402079524472356
The generated pressure mean: 0.4550419747829437
loss_pred:0.018457401543855667, decouple_loss:0.0024188454262912273
Iteration: 8323, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4374048411846161
The generated pressure mean: 0.4411061704158783
loss_pred:0.01641211286187172, decouple_loss:0.0021575898863375187
loss_pred:0.016704697161912918, decouple_loss:0.002363735344260931
The generated pressure mean: 0.43925008177757263
loss_pred:0.017557350918650627, decouple_loss:0.002185206860303879
Iteration: 8324, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43572425842285156
The generated pressure mean: 0.43632742762565613
loss_pred:0.01617584377527237, decouple_loss:0.002239979337900877
loss_pred:0.01733829267323017, decouple_loss:0.0021683485247194767
The generated pressure mean: 0.43431201577186584
loss_pred:0.01712818630039692, decouple_loss:0.0021495467517524958
Iteration: 8325, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45681729912757874
The generated pressure mean: 0.454241544008255loss_pred:0.016110507771372795, decouple_loss:0.002172915730625391
loss_pred:0.016219742596149445, decouple_loss:0.002067812252789736
The generated pressure mean: 0.4531317353248596
loss_pred:0.016099903732538223, decouple_loss:0.0021673073060810566
Iteration: 8326, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45143306255340576
The generated pressure mean: 0.45116931200027466loss_pred:0.016069339588284492, decouple_loss:0.0019018505699932575
loss_pred:0.01573602855205536, decouple_loss:0.0018603724893182516
The generated pressure mean: 0.4480803906917572
loss_pred:0.01919245533645153, decouple_loss:0.0019503837684169412
Iteration: 8327, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4370793104171753
The generated pressure mean: 0.43548908829689026
loss_pred:0.016473438590765, decouple_loss:0.0028573134914040565
The generated pressure mean: 0.44076237082481384
loss_pred:0.016938630491495132, decouple_loss:0.002750595798715949
loss_pred:0.01807759329676628, decouple_loss:0.0027686634566634893
Iteration: 8328, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44386836886405945
The generated pressure mean: 0.44669389724731445loss_pred:0.016581635922193527, decouple_loss:0.0026760746259242296
loss_pred:0.01685669831931591, decouple_loss:0.002599807223305106
The generated pressure mean: 0.4440392851829529
loss_pred:0.017634794116020203, decouple_loss:0.0026211568620055914
Iteration: 8329, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4463268518447876
loss_pred:0.016320310533046722, decouple_loss:0.002576198661699891
The generated pressure mean: 0.4482610821723938
loss_pred:0.01629139482975006, decouple_loss:0.002521712565794587
The generated pressure mean: 0.4503265917301178
loss_pred:0.01696096546947956, decouple_loss:0.002616140991449356
Iteration: 8330, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44947549700737
loss_pred:0.01588328182697296, decouple_loss:0.002073182724416256
The generated pressure mean: 0.4542672336101532
loss_pred:0.01702284812927246, decouple_loss:0.002070583403110504
The generated pressure mean: 0.4506931006908417
loss_pred:0.018292445689439774, decouple_loss:0.0019709859043359756
2023-04-17 19:10:11 testing...
The generated pressure mean: 0.41796791553497314
The generated pressure mean: 0.41270560026168823
loss_pred:0.030193625018000603, decouple_loss:0.002835990162566304
loss_pred:0.0312232356518507, decouple_loss:0.0027094469405710697
The generated pressure mean: 0.4208677411079407
loss_pred:0.02962912619113922, decouple_loss:0.002879001200199127
WV_0_PC_0_EH_1_PS_40, loss: 0.03048907034099102, avg_mse: 0.04652660712599754
current test mse: 0.046527
Iteration: 8331, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4485321044921875
loss_pred:0.01815909706056118, decouple_loss:0.0024742495734244585
The generated pressure mean: 0.45180848240852356
loss_pred:0.015999075025320053, decouple_loss:0.002452264307066798
The generated pressure mean: 0.4475614130496979
loss_pred:0.01634298823773861, decouple_loss:0.0025366388726979494
Iteration: 8332, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4437042772769928
loss_pred:0.017098907381296158, decouple_loss:0.002433021320030093
The generated pressure mean: 0.44151198863983154
loss_pred:0.01629597134888172, decouple_loss:0.002432015025988221
The generated pressure mean: 0.4503546357154846
loss_pred:0.015993978828191757, decouple_loss:0.0020979882683604956
Iteration: 8333, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4421876072883606
loss_pred:0.01705871894955635, decouple_loss:0.0020778358448296785
The generated pressure mean: 0.4457762837409973
loss_pred:0.01888892985880375, decouple_loss:0.002072287956252694
The generated pressure mean: 0.4484109878540039
loss_pred:0.016741666942834854, decouple_loss:0.0021051145158708096
Iteration: 8334, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43299829959869385
loss_pred:0.017360374331474304, decouple_loss:0.002193050691857934
The generated pressure mean: 0.43372899293899536
loss_pred:0.016543086618185043, decouple_loss:0.0022033259738236666
The generated pressure mean: 0.4341847002506256
loss_pred:0.01649182103574276, decouple_loss:0.0021974039264023304
Iteration: 8335, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45399734377861023
loss_pred:0.016947362571954727, decouple_loss:0.0025206459686160088
The generated pressure mean: 0.4500602185726166
loss_pred:0.01742526888847351, decouple_loss:0.0025279426481574774
The generated pressure mean: 0.4458330273628235
loss_pred:0.017191514372825623, decouple_loss:0.0025121127255260944
Iteration: 8336, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4627736508846283
loss_pred:0.01727382093667984, decouple_loss:0.0018901489675045013
The generated pressure mean: 0.4568997919559479
loss_pred:0.016435233876109123, decouple_loss:0.0018470316426828504
The generated pressure mean: 0.45873475074768066
loss_pred:0.01652357541024685, decouple_loss:0.0018701549852266908
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 8337, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43860727548599243
loss_pred:0.016158659011125565, decouple_loss:0.0024243409279733896
The generated pressure mean: 0.43584585189819336The generated pressure mean: 0.4400528073310852
loss_pred:0.016618451103568077, decouple_loss:0.002364917192608118loss_pred:0.015949560329318047, decouple_loss:0.002341932151466608
Iteration: 8338, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4323920011520386
loss_pred:0.015958551317453384, decouple_loss:0.0020507443696260452
The generated pressure mean: 0.4359881281852722
loss_pred:0.018189553171396255, decouple_loss:0.0020428821444511414
The generated pressure mean: 0.43802741169929504
loss_pred:0.019015928730368614, decouple_loss:0.001966226613149047
Iteration: 8339, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4616301953792572
loss_pred:0.016787590458989143, decouple_loss:0.0018213834846392274
The generated pressure mean: 0.458626389503479
loss_pred:0.015833863988518715, decouple_loss:0.0017221445450559258
The generated pressure mean: 0.4571661353111267
loss_pred:0.01549470704048872, decouple_loss:0.0019043522188439965
Iteration: 8340, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45581817626953125
loss_pred:0.01671510748565197, decouple_loss:0.001840898534283042
The generated pressure mean: 0.4554530382156372
loss_pred:0.017162661999464035, decouple_loss:0.001828925684094429
The generated pressure mean: 0.4558427929878235
loss_pred:0.016703957691788673, decouple_loss:0.0019045411609113216
2023-04-17 19:12:04 testing...
The generated pressure mean: 0.4176768362522125
The generated pressure mean: 0.42381036281585693
The generated pressure mean: 0.42642098665237427
loss_pred:0.03078491799533367, decouple_loss:0.0023733393754810095
loss_pred:0.029820529744029045, decouple_loss:0.0025559093337506056
loss_pred:0.02957429178059101, decouple_loss:0.0026516164653003216
WV_0_PC_0_EH_1_PS_40, loss: 0.030186261981725693, avg_mse: 0.0462571382522583
current test mse: 0.046257
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 8341, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.42851895093917847
loss_pred:0.017659349367022514, decouple_loss:0.0020409859716892242
The generated pressure mean: 0.4265069365501404
loss_pred:0.01754954271018505, decouple_loss:0.00212515308521688
The generated pressure mean: 0.4289228022098541
loss_pred:0.017273539677262306, decouple_loss:0.002117159543558955
Iteration: 8342, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44872620701789856
loss_pred:0.017056388780474663, decouple_loss:0.002533967373892665
The generated pressure mean: 0.44602638483047485
loss_pred:0.01658170484006405, decouple_loss:0.0026239063590765
The generated pressure mean: 0.4448241889476776
loss_pred:0.016125142574310303, decouple_loss:0.0026923834811896086
Iteration: 8343, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4576404094696045
loss_pred:0.017775263637304306, decouple_loss:0.0023338880855590105
The generated pressure mean: 0.4611299932003021
loss_pred:0.01856302283704281, decouple_loss:0.0024419587571173906
The generated pressure mean: 0.4574430584907532
loss_pred:0.017608491703867912, decouple_loss:0.0024007128085941076
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 8344, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44694775342941284
loss_pred:0.01751328818500042, decouple_loss:0.0021744838450104
The generated pressure mean: 0.44595104455947876
loss_pred:0.017836613580584526, decouple_loss:0.002130377572029829
The generated pressure mean: 0.44423139095306396
loss_pred:0.018571292981505394, decouple_loss:0.0022519163321703672
Iteration: 8345, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44605588912963867
loss_pred:0.019451050087809563, decouple_loss:0.00207397248595953
The generated pressure mean: 0.4450184106826782
loss_pred:0.017550230026245117, decouple_loss:0.002098420634865761
The generated pressure mean: 0.45028913021087646
loss_pred:0.017471719533205032, decouple_loss:0.0019627870060503483
Iteration: 8346, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44037386775016785
loss_pred:0.01754876971244812, decouple_loss:0.002474156441166997
The generated pressure mean: 0.44065091013908386
The generated pressure mean: 0.4414516091346741
loss_pred:0.017272762954235077, decouple_loss:0.0025040116161108017
loss_pred:0.0175649281591177, decouple_loss:0.002448912477120757
Iteration: 8347, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4361388683319092
loss_pred:0.01780059188604355, decouple_loss:0.0026477365754544735
The generated pressure mean: 0.44140076637268066
loss_pred:0.017144721001386642, decouple_loss:0.0023295243736356497
The generated pressure mean: 0.43789559602737427
loss_pred:0.016393503174185753, decouple_loss:0.0024742409586906433
Iteration: 8348, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45473602414131165
loss_pred:0.016994822770357132, decouple_loss:0.0021542091853916645
The generated pressure mean: 0.4530755281448364
loss_pred:0.01724795438349247, decouple_loss:0.0022245794534683228
The generated pressure mean: 0.4540840983390808
loss_pred:0.017783014103770256, decouple_loss:0.002276607556268573
Iteration: 8349, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45235151052474976
loss_pred:0.01757613942027092, decouple_loss:0.0025625904090702534
The generated pressure mean: 0.4522939920425415
loss_pred:0.016467059031128883, decouple_loss:0.0026365211233496666
The generated pressure mean: 0.4563925862312317
loss_pred:0.01579403690993786, decouple_loss:0.002721061697229743
Iteration: 8350, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44904831051826477
loss_pred:0.016434907913208008, decouple_loss:0.0020722090266644955
The generated pressure mean: 0.4460318684577942
loss_pred:0.01691458187997341, decouple_loss:0.0021155094727873802
The generated pressure mean: 0.4428933262825012
loss_pred:0.018693938851356506, decouple_loss:0.002067691646516323
2023-04-17 19:15:22 testing...
The generated pressure mean: 0.41404956579208374
The generated pressure mean: 0.42066332697868347
loss_pred:0.03138771280646324, decouple_loss:0.0028354553505778313
The generated pressure mean: 0.42336392402648926
loss_pred:0.030474884435534477, decouple_loss:0.002938786055892706
loss_pred:0.029813745990395546, decouple_loss:0.0030649991240352392
WV_0_PC_0_EH_1_PS_40, loss: 0.030706103891134262, avg_mse: 0.047244634479284286
current test mse: 0.047245
Iteration: 8351, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44192567467689514
loss_pred:0.015886077657341957, decouple_loss:0.0022326759062707424
The generated pressure mean: 0.4395677447319031
loss_pred:0.0179143063724041, decouple_loss:0.0023123810533434153
The generated pressure mean: 0.43856924772262573
loss_pred:0.016172220930457115, decouple_loss:0.002324708504602313
Iteration: 8352, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44310423731803894
loss_pred:0.016811363399028778, decouple_loss:0.002315287943929434
The generated pressure mean: 0.4450705945491791
loss_pred:0.017679931595921516, decouple_loss:0.0022904707584530115
The generated pressure mean: 0.44351840019226074
loss_pred:0.016034765169024467, decouple_loss:0.0022353981621563435
Iteration: 8353, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44690701365470886
loss_pred:0.017224151641130447, decouple_loss:0.001971673686057329
The generated pressure mean: 0.4503466486930847
loss_pred:0.01704595983028412, decouple_loss:0.002021200954914093
The generated pressure mean: 0.4460797607898712
loss_pred:0.01702805981040001, decouple_loss:0.002015557372942567
Iteration: 8354, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4477209150791168
loss_pred:0.017068708315491676, decouple_loss:0.0019889783579856157
The generated pressure mean: 0.4508330225944519
loss_pred:0.01692604459822178, decouple_loss:0.0020426237024366856
The generated pressure mean: 0.4520275294780731
loss_pred:0.01676766946911812, decouple_loss:0.002053228672593832
Iteration: 8355, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44428619742393494
loss_pred:0.016025643795728683, decouple_loss:0.0022506078239530325
The generated pressure mean: 0.4493216574192047
loss_pred:0.017211906611919403, decouple_loss:0.002087376546114683
The generated pressure mean: 0.4489559531211853
loss_pred:0.015791356563568115, decouple_loss:0.0022143058013170958
Iteration: 8356, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44451022148132324
loss_pred:0.01694033294916153, decouple_loss:0.0019253039499744773
The generated pressure mean: 0.4439220726490021
loss_pred:0.01595601998269558, decouple_loss:0.0019612363539636135
The generated pressure mean: 0.4479431211948395
loss_pred:0.01661675237119198, decouple_loss:0.0019082981161773205
Iteration: 8357, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45010754466056824
loss_pred:0.0166192464530468, decouple_loss:0.0019883192144334316
The generated pressure mean: 0.4489007294178009
loss_pred:0.016725189983844757, decouple_loss:0.002021294552832842
The generated pressure mean: 0.44131600856781006
loss_pred:0.016195036470890045, decouple_loss:0.002039991319179535
Iteration: 8358, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4523567855358124
loss_pred:0.01581144519150257, decouple_loss:0.0018327109282836318
The generated pressure mean: 0.45127561688423157
loss_pred:0.01760859042406082, decouple_loss:0.001945224474184215
The generated pressure mean: 0.4503938555717468
loss_pred:0.016812361776828766, decouple_loss:0.0019047068199142814
Iteration: 8359, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.44029977917671204
loss_pred:0.017543261870741844, decouple_loss:0.001756909303367138
The generated pressure mean: 0.44234034419059753
loss_pred:0.016450796276330948, decouple_loss:0.0018188293324783444
The generated pressure mean: 0.4391094744205475
loss_pred:0.018014365807175636, decouple_loss:0.0018109680386260152
Iteration: 8360, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.43792906403541565
The generated pressure mean: 0.439985990524292
loss_pred:0.01718037761747837, decouple_loss:0.002159010386094451
loss_pred:0.016665367409586906, decouple_loss:0.0021741611417382956
The generated pressure mean: 0.44226697087287903
loss_pred:0.017064355313777924, decouple_loss:0.0020406744442880154
2023-04-17 19:17:16 testing...
The generated pressure mean: 0.4177006781101227
The generated pressure mean: 0.4116007387638092
The generated pressure mean: 0.4210502803325653
loss_pred:0.030721629038453102, decouple_loss:0.0024278906639665365
loss_pred:0.03163810819387436, decouple_loss:0.002293436322361231
loss_pred:0.029928958043456078, decouple_loss:0.0024315447080880404
WV_0_PC_0_EH_1_PS_40, loss: 0.030882112681865692, avg_mse: 0.047520801424980164
current test mse: 0.047521
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 8361, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45000067353248596
loss_pred:0.016400322318077087, decouple_loss:0.002056590747088194
The generated pressure mean: 0.45049065351486206
loss_pred:0.017580775544047356, decouple_loss:0.0020410565193742514
The generated pressure mean: 0.45504048466682434
loss_pred:0.016357392072677612, decouple_loss:0.00202205590903759
Iteration: 8362, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4538014829158783
loss_pred:0.01626943051815033, decouple_loss:0.0018191277049481869
The generated pressure mean: 0.44434884190559387
loss_pred:0.01667885296046734, decouple_loss:0.001870391657575965
The generated pressure mean: 0.4524489939212799
loss_pred:0.01775469444692135, decouple_loss:0.0018167401431128383
Iteration: 8363, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.45052996277809143
loss_pred:0.01544263493269682, decouple_loss:0.0019154362380504608
The generated pressure mean: 0.4524930417537689
loss_pred:0.017902743071317673, decouple_loss:0.0018900035647675395
The generated pressure mean: 0.4452458620071411
loss_pred:0.01661159284412861, decouple_loss:0.0019094576127827168
Iteration: 8364, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4427284896373749
loss_pred:0.016581738367676735, decouple_loss:0.0016457273159176111
The generated pressure mean: 0.43996891379356384
loss_pred:0.018440794199705124, decouple_loss:0.0016439339378848672
The generated pressure mean: 0.44002529978752136
loss_pred:0.01595241017639637, decouple_loss:0.0016812293324619532
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 8365, ims.shape: (3, 48, 3, 720, 1440)
The generated pressure mean: 0.4461658000946045
The generated pressure mean: 0.4475432336330414
loss_pred:0.016778742894530296, decouple_loss:0.0017226256895810366
loss_pred:0.016888804733753204, decouple_loss:0.0017976986709982157
The generated pressure mean: 0.4433527886867523
loss_pred:0.01587832160294056, decouple_loss:0.0017239187145605683
