/scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
train_data_files nums: 124
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_09012020_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45205265283584595, gen p mean: -0.0002319040650036186, mean p set: 0.45253291726112366
loss_pred:0.15723738074302673, decouple_loss:0.06672875583171844
The modified gen p mean: 0.450987309217453, gen p mean: 0.00017578645201865584, mean p set: 0.4514676034450531
loss_pred:0.15841983258724213, decouple_loss:0.06562690436840057
The modified gen p mean: 0.44924795627593994, gen p mean: -0.0001228506152983755, mean p set: 0.4497282803058624
loss_pred:0.16331546008586884, decouple_loss:0.0650911033153534
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485670328140259, gen p mean: -0.0028209686279296875, mean p set: 0.44904735684394836
The modified gen p mean: 0.45046067237854004, gen p mean: -0.0030986079946160316, mean p set: 0.45094096660614014
The modified gen p mean: 0.4500294327735901, gen p mean: -0.003124302253127098, mean p set: 0.4505097270011902
loss_pred:0.16450685262680054, decouple_loss:0.2002713829278946
loss_pred:0.16826218366622925, decouple_loss:0.20238307118415833
loss_pred:0.17052626609802246, decouple_loss:0.20167586207389832
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452693909406662, gen p mean: 0.0012544577475637197, mean p set: 0.4531742036342621
The modified gen p mean: 0.4510420858860016, gen p mean: 0.0013815824640914798, mean p set: 0.4515224099159241
The modified gen p mean: 0.44960305094718933, gen p mean: 0.001001359079964459, mean p set: 0.45008331537246704
loss_pred:0.1662065088748932, decouple_loss:0.3443322479724884
loss_pred:0.1580333113670349, decouple_loss:0.3428517282009125
loss_pred:0.1616654396057129, decouple_loss:0.34301596879959106
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505070447921753, gen p mean: -0.0034891352988779545, mean p set: 0.4509873688220978
The modified gen p mean: 0.44886985421180725, gen p mean: -0.0033802692778408527, mean p set: 0.44935014843940735
The modified gen p mean: 0.4504108428955078, gen p mean: -0.0033331343438476324, mean p set: 0.4508911669254303
loss_pred:0.15058620274066925, decouple_loss:0.4150729775428772
loss_pred:0.14825035631656647, decouple_loss:0.41412270069122314
loss_pred:0.15211431682109833, decouple_loss:0.4113466441631317
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45180878043174744, gen p mean: 0.003372885985299945, mean p set: 0.45228907465934753
The modified gen p mean: 0.4495670199394226, gen p mean: 0.0034621546510607004, mean p set: 0.4500472843647003
The modified gen p mean: 0.44940727949142456, gen p mean: 0.003495788434520364, mean p set: 0.44988757371902466
loss_pred:0.14769983291625977, decouple_loss:0.3771071135997772
loss_pred:0.14288504421710968, decouple_loss:0.37205183506011963
loss_pred:0.14895212650299072, decouple_loss:0.37004029750823975
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45147714018821716, gen p mean: -0.002497590845450759, mean p set: 0.4519574046134949
The modified gen p mean: 0.44979166984558105, gen p mean: -0.002515195170417428, mean p set: 0.45027193427085876
The modified gen p mean: 0.44939979910850525, gen p mean: -0.0025277365930378437, mean p set: 0.44988009333610535
loss_pred:0.1367647349834442, decouple_loss:0.4862866699695587
loss_pred:0.13642191886901855, decouple_loss:0.48524442315101624
loss_pred:0.13966582715511322, decouple_loss:0.48551300168037415
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489685595035553, gen p mean: -0.0008445175481028855, mean p set: 0.4494488537311554
The modified gen p mean: 0.4495231807231903, gen p mean: -0.0008286047377623618, mean p set: 0.4500034749507904
The modified gen p mean: 0.4493679106235504, gen p mean: -0.0008514916407875717, mean p set: 0.4498482048511505
loss_pred:0.13253897428512573, decouple_loss:0.3793668746948242
loss_pred:0.1377798169851303, decouple_loss:0.37501075863838196
loss_pred:0.13670603930950165, decouple_loss:0.3759574592113495
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521111249923706, gen p mean: -0.000681445118971169, mean p set: 0.4525914490222931
The modified gen p mean: 0.44975170493125916, gen p mean: -0.0006532393745146692, mean p set: 0.45023199915885925
The modified gen p mean: 0.4496085047721863, gen p mean: -0.0006357218371704221, mean p set: 0.4500887989997864
loss_pred:0.12957903742790222, decouple_loss:0.3421894609928131
loss_pred:0.12938179075717926, decouple_loss:0.3372851014137268
loss_pred:0.12869492173194885, decouple_loss:0.3409133553504944
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862332940101624, gen p mean: 1.006931961455848e-05, mean p set: 0.44910362362861633
The modified gen p mean: 0.45152488350868225, gen p mean: 3.3343356335535645e-05, mean p set: 0.45200514793395996
The modified gen p mean: 0.44958770275115967, gen p mean: 3.244564595661359e-06, mean p set: 0.45006799697875977
loss_pred:0.13059929013252258, decouple_loss:0.2926618456840515
loss_pred:0.12782533466815948, decouple_loss:0.29424548149108887
loss_pred:0.1291007548570633, decouple_loss:0.29415255784988403
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44990274310112, gen p mean: 0.001238269149325788, mean p set: 0.4503830373287201
The modified gen p mean: 0.44922390580177307, gen p mean: 0.001263239304535091, mean p set: 0.4497041702270508
The modified gen p mean: 0.45041003823280334, gen p mean: 0.0012476352276280522, mean p set: 0.45089030265808105
loss_pred:0.13125380873680115, decouple_loss:0.26949331164360046
loss_pred:0.12860649824142456, decouple_loss:0.27004334330558777
loss_pred:0.12352921813726425, decouple_loss:0.26759469509124756
2023-05-02 14:10:02 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: 0.0006473102839663625, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: 0.0006610676646232605, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: 0.0006403346196748316, mean p set: 0.45035696029663086
loss_pred:0.126573845744133, decouple_loss:0.29064425826072693
loss_pred:0.12788031995296478, decouple_loss:0.29175180196762085
loss_pred:0.12749773263931274, decouple_loss:0.28907790780067444
WV_0_PC_1_EH_0_PS_40_6, loss: 0.14184187352657318, avg_mse: 0.1270817369222641
current test mse: 0.127082
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503987729549408, gen p mean: 0.0006379664991982281, mean p set: 0.4508790671825409
The modified gen p mean: 0.44859978556632996, gen p mean: 0.0006438325508497655, mean p set: 0.44908010959625244
loss_pred:0.12373927980661392, decouple_loss:0.2902708947658539
loss_pred:0.1255454421043396, decouple_loss:0.28935861587524414
The modified gen p mean: 0.44940486550331116, gen p mean: 0.0006442755693569779, mean p set: 0.44988515973091125
loss_pred:0.12310078740119934, decouple_loss:0.29343461990356445
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45234429836273193, gen p mean: 0.00016803061589598656, mean p set: 0.45282456278800964
The modified gen p mean: 0.4496549963951111, gen p mean: 0.00016064182273112237, mean p set: 0.45013532042503357
The modified gen p mean: 0.45300352573394775, gen p mean: 0.00019782681192737073, mean p set: 0.45348381996154785
loss_pred:0.12203317135572433, decouple_loss:0.2773599326610565
loss_pred:0.12327037751674652, decouple_loss:0.27272602915763855
loss_pred:0.12570907175540924, decouple_loss:0.2764180898666382
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45238858461380005, gen p mean: 0.0006379308761097491, mean p set: 0.45286887884140015
The modified gen p mean: 0.45146384835243225, gen p mean: 0.000624440552201122, mean p set: 0.45194414258003235
The modified gen p mean: 0.4499431252479553, gen p mean: 0.0006263040704652667, mean p set: 0.4504234194755554
loss_pred:0.11731978505849838, decouple_loss:0.23194517195224762
loss_pred:0.12083514034748077, decouple_loss:0.2304689586162567
loss_pred:0.12103240936994553, decouple_loss:0.23183467984199524
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519023895263672, gen p mean: 8.569877536501735e-05, mean p set: 0.4523826837539673
The modified gen p mean: 0.4490223824977875, gen p mean: 0.0001387264928780496, mean p set: 0.4495026767253876
The modified gen p mean: 0.44874706864356995, gen p mean: 0.00013675392256118357, mean p set: 0.44922736287117004
loss_pred:0.1258843094110489, decouple_loss:0.2263718545436859
loss_pred:0.12137192487716675, decouple_loss:0.22053147852420807
loss_pred:0.12253478169441223, decouple_loss:0.2227509766817093
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522383213043213, gen p mean: -0.0004803053743671626, mean p set: 0.4527186155319214
The modified gen p mean: 0.44902458786964417, gen p mean: -0.0004900228232145309, mean p set: 0.4495048522949219
The modified gen p mean: 0.4499739408493042, gen p mean: -0.0004924244713038206, mean p set: 0.4504542350769043
loss_pred:0.11695051193237305, decouple_loss:0.23718339204788208
loss_pred:0.1190810427069664, decouple_loss:0.23795902729034424
loss_pred:0.12263328582048416, decouple_loss:0.2320348173379898
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45036736130714417, gen p mean: -0.0010761120356619358, mean p set: 0.45084765553474426
The modified gen p mean: 0.4517990052700043, gen p mean: -0.001063668285496533, mean p set: 0.45227932929992676
The modified gen p mean: 0.45059144496917725, gen p mean: -0.0010708833578974009, mean p set: 0.45107173919677734
loss_pred:0.11763470619916916, decouple_loss:0.20897875726222992
loss_pred:0.12169436365365982, decouple_loss:0.2115359604358673
loss_pred:0.11754361540079117, decouple_loss:0.20991533994674683
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906169176101685, gen p mean: -0.0024304951075464487, mean p set: 0.44954198598861694
The modified gen p mean: 0.45184165239334106, gen p mean: -0.002398270182311535, mean p set: 0.45232194662094116
The modified gen p mean: 0.448866069316864, gen p mean: -0.0024195523001253605, mean p set: 0.4493463933467865
loss_pred:0.11592360585927963, decouple_loss:0.19020302593708038
loss_pred:0.11774467676877975, decouple_loss:0.19057998061180115
loss_pred:0.11669305711984634, decouple_loss:0.1889820694923401
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452014684677124, gen p mean: -0.002289816038683057, mean p set: 0.4524949789047241
The modified gen p mean: 0.45179152488708496, gen p mean: -0.002293667057529092, mean p set: 0.45227181911468506
The modified gen p mean: 0.45016688108444214, gen p mean: -0.0022659441456198692, mean p set: 0.450647234916687
loss_pred:0.11609666794538498, decouple_loss:0.18177421391010284
loss_pred:0.11689174920320511, decouple_loss:0.18403351306915283
loss_pred:0.1166657954454422, decouple_loss:0.18555600941181183
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45123106241226196, gen p mean: -0.003207453526556492, mean p set: 0.45171138644218445
The modified gen p mean: 0.45020562410354614, gen p mean: -0.003186508547514677, mean p set: 0.45068594813346863
The modified gen p mean: 0.45141661167144775, gen p mean: -0.0032270585652440786, mean p set: 0.45189690589904785
loss_pred:0.10950805991888046, decouple_loss:0.18235984444618225
loss_pred:0.11189176142215729, decouple_loss:0.18245209753513336
loss_pred:0.11163246631622314, decouple_loss:0.1814814656972885
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45108312368392944, gen p mean: -0.003817626042291522, mean p set: 0.45156344771385193
The modified gen p mean: 0.4505055844783783, gen p mean: -0.003803911153227091, mean p set: 0.450985848903656
The modified gen p mean: 0.4496305584907532, gen p mean: -0.0038346184883266687, mean p set: 0.45011085271835327
loss_pred:0.11278963088989258, decouple_loss:0.16636723279953003
loss_pred:0.10851234197616577, decouple_loss:0.1680126041173935
loss_pred:0.11058667302131653, decouple_loss:0.16747459769248962
2023-05-02 14:13:48 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.005032495129853487, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.005080527160316706, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.00510306004434824, mean p set: 0.45035696029663086
loss_pred:0.11134254932403564, decouple_loss:0.16825352609157562
loss_pred:0.11082006990909576, decouple_loss:0.1678345799446106
loss_pred:0.11133141070604324, decouple_loss:0.1703396737575531
WV_0_PC_1_EH_0_PS_40_6, loss: 0.11960513889789581, avg_mse: 0.11049675941467285
current test mse: 0.110497
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
NaN value num: 0
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45023706555366516, gen p mean: -0.00486907409504056, mean p set: 0.45071735978126526
The modified gen p mean: 0.4498962461948395, gen p mean: -0.004998757503926754, mean p set: 0.4503765404224396
loss_pred:0.10869088768959045, decouple_loss:0.16129806637763977
loss_pred:0.10684474557638168, decouple_loss:0.16011092066764832
The modified gen p mean: 0.45003461837768555, gen p mean: -0.004964352119714022, mean p set: 0.45051491260528564
loss_pred:0.1070464700460434, decouple_loss:0.16129198670387268
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44988110661506653, gen p mean: -0.006730352528393269, mean p set: 0.4503614008426666
The modified gen p mean: 0.44913122057914734, gen p mean: -0.00671096658334136, mean p set: 0.44961148500442505
The modified gen p mean: 0.45121854543685913, gen p mean: -0.006550042424350977, mean p set: 0.45169880986213684
loss_pred:0.10479530692100525, decouple_loss:0.18075984716415405
loss_pred:0.10861127823591232, decouple_loss:0.18038901686668396
loss_pred:0.10700259357690811, decouple_loss:0.18226204812526703
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495282769203186, gen p mean: -0.007310100365430117, mean p set: 0.4500085711479187
The modified gen p mean: 0.452597975730896, gen p mean: -0.00728589715436101, mean p set: 0.4530782699584961
The modified gen p mean: 0.4498801827430725, gen p mean: -0.00722429808229208, mean p set: 0.4503604471683502
loss_pred:0.10421647876501083, decouple_loss:0.16157861053943634
loss_pred:0.1091313585639, decouple_loss:0.16138742864131927
loss_pred:0.10753324627876282, decouple_loss:0.1614682674407959
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44930359721183777, gen p mean: -0.012092022225260735, mean p set: 0.44978389143943787
The modified gen p mean: 0.4511229395866394, gen p mean: -0.011760305613279343, mean p set: 0.4516032636165619
The modified gen p mean: 0.45217129588127136, gen p mean: -0.011350416578352451, mean p set: 0.45265159010887146
loss_pred:0.10356783121824265, decouple_loss:0.15645381808280945
loss_pred:0.10234714299440384, decouple_loss:0.15562240779399872
loss_pred:0.10647104680538177, decouple_loss:0.1511807143688202
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514003098011017, gen p mean: -0.0075411428697407246, mean p set: 0.4518806040287018
The modified gen p mean: 0.44933202862739563, gen p mean: -0.007771323900669813, mean p set: 0.4498123526573181
The modified gen p mean: 0.4511968493461609, gen p mean: -0.007857762277126312, mean p set: 0.451677143573761
loss_pred:0.09842091053724289, decouple_loss:0.17171263694763184
loss_pred:0.10330064594745636, decouple_loss:0.1660372018814087
loss_pred:0.10560712963342667, decouple_loss:0.16627821326255798
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44943132996559143, gen p mean: -0.00915519893169403, mean p set: 0.44991159439086914
The modified gen p mean: 0.4490774869918823, gen p mean: -0.009283861145377159, mean p set: 0.4495577812194824
The modified gen p mean: 0.4497954249382019, gen p mean: -0.00920713972300291, mean p set: 0.450275719165802
loss_pred:0.09867546707391739, decouple_loss:0.15252220630645752
loss_pred:0.10186173021793365, decouple_loss:0.15228605270385742
loss_pred:0.10209231078624725, decouple_loss:0.1518358737230301
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506269693374634, gen p mean: -0.011386836878955364, mean p set: 0.4511072635650635
The modified gen p mean: 0.44934189319610596, gen p mean: -0.01137515902519226, mean p set: 0.44982221722602844
The modified gen p mean: 0.4493030309677124, gen p mean: -0.011371063068509102, mean p set: 0.4497832953929901
loss_pred:0.09705713391304016, decouple_loss:0.15682227909564972
loss_pred:0.09834848344326019, decouple_loss:0.15376687049865723
loss_pred:0.09995736181735992, decouple_loss:0.1527252495288849
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44909465312957764, gen p mean: -0.016273133456707, mean p set: 0.44957494735717773
The modified gen p mean: 0.4511413872241974, gen p mean: -0.016070786863565445, mean p set: 0.4516216814517975
loss_pred:0.09289788454771042, decouple_loss:0.1472969353199005
The modified gen p mean: 0.44948163628578186, gen p mean: -0.015619047917425632, mean p set: 0.44996196031570435
loss_pred:0.09457850456237793, decouple_loss:0.14731629192829132
loss_pred:0.09675940126180649, decouple_loss:0.14581778645515442
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900307059288025, gen p mean: -0.013319277204573154, mean p set: 0.44948339462280273
The modified gen p mean: 0.4518599212169647, gen p mean: -0.013270210474729538, mean p set: 0.4523402154445648
The modified gen p mean: 0.4499051570892334, gen p mean: -0.013356476090848446, mean p set: 0.4503854513168335
loss_pred:0.09371928870677948, decouple_loss:0.1557973176240921
loss_pred:0.09183818846940994, decouple_loss:0.16010238230228424
loss_pred:0.09155412018299103, decouple_loss:0.15483590960502625
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518515467643738, gen p mean: -0.015355413779616356, mean p set: 0.45233187079429626
The modified gen p mean: 0.4495278596878052, gen p mean: -0.015516495332121849, mean p set: 0.4500081539154053
The modified gen p mean: 0.45126527547836304, gen p mean: -0.015369907952845097, mean p set: 0.45174553990364075
loss_pred:0.09362632781267166, decouple_loss:0.15052616596221924
loss_pred:0.0914144441485405, decouple_loss:0.15021076798439026
loss_pred:0.09491971135139465, decouple_loss:0.1488930732011795
2023-05-02 14:18:10 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.017720002681016922, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.01767989620566368, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.017683686688542366, mean p set: 0.45035696029663086
loss_pred:0.09273695945739746, decouple_loss:0.15164072811603546
loss_pred:0.09258726239204407, decouple_loss:0.15186485648155212
loss_pred:0.09305896610021591, decouple_loss:0.15337473154067993
WV_0_PC_1_EH_0_PS_40_6, loss: 0.10040907561779022, avg_mse: 0.09188853204250336
current test mse: 0.091889
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45159292221069336, gen p mean: -0.017872203141450882, mean p set: 0.45207321643829346
The modified gen p mean: 0.4493807256221771, gen p mean: -0.01791391707956791, mean p set: 0.4498610198497772
loss_pred:0.08705715090036392, decouple_loss:0.15498822927474976
loss_pred:0.09205701947212219, decouple_loss:0.14771616458892822
The modified gen p mean: 0.44958746433258057, gen p mean: -0.01783151365816593, mean p set: 0.45006775856018066
loss_pred:0.08868177235126495, decouple_loss:0.15010394155979156
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972214102745056, gen p mean: -0.021303566172719002, mean p set: 0.45020246505737305
The modified gen p mean: 0.45139554142951965, gen p mean: -0.02135484665632248, mean p set: 0.45187583565711975
The modified gen p mean: 0.450796902179718, gen p mean: -0.020944101735949516, mean p set: 0.4512771964073181
loss_pred:0.09026158601045609, decouple_loss:0.13657313585281372
loss_pred:0.0911111980676651, decouple_loss:0.135636106133461
loss_pred:0.08828022330999374, decouple_loss:0.13874907791614532
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504595994949341, gen p mean: -0.025311484932899475, mean p set: 0.45093992352485657
The modified gen p mean: 0.4492533504962921, gen p mean: -0.02527264505624771, mean p set: 0.4497336745262146
The modified gen p mean: 0.45152056217193604, gen p mean: -0.025433193892240524, mean p set: 0.45200085639953613
loss_pred:0.08736878633499146, decouple_loss:0.13118159770965576
loss_pred:0.08788865059614182, decouple_loss:0.13054747879505157
loss_pred:0.08727828413248062, decouple_loss:0.12954124808311462
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44946160912513733, gen p mean: -0.026047667488455772, mean p set: 0.44994187355041504
The modified gen p mean: 0.44902923703193665, gen p mean: -0.02614075504243374, mean p set: 0.44950950145721436
The modified gen p mean: 0.4497816562652588, gen p mean: -0.026209162548184395, mean p set: 0.4502619802951813
loss_pred:0.08480354398488998, decouple_loss:0.12225700914859772
loss_pred:0.08667247742414474, decouple_loss:0.12104764580726624
loss_pred:0.08521658927202225, decouple_loss:0.12128601968288422
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489581882953644, gen p mean: -0.028432535007596016, mean p set: 0.4494384825229645
The modified gen p mean: 0.4500953257083893, gen p mean: -0.02853386290371418, mean p set: 0.4505756199359894
The modified gen p mean: 0.4504971206188202, gen p mean: -0.02848847769200802, mean p set: 0.4509774148464203
loss_pred:0.08172282576560974, decouple_loss:0.11408104747533798
loss_pred:0.08617633581161499, decouple_loss:0.11581999808549881
loss_pred:0.08383558690547943, decouple_loss:0.1164444163441658
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45032092928886414, gen p mean: -0.03217275068163872, mean p set: 0.45080122351646423
The modified gen p mean: 0.44922783970832825, gen p mean: -0.03276289999485016, mean p set: 0.44970813393592834
The modified gen p mean: 0.4491126239299774, gen p mean: -0.032438717782497406, mean p set: 0.4495929181575775
loss_pred:0.08299292623996735, decouple_loss:0.1111113652586937
loss_pred:0.0819433182477951, decouple_loss:0.11218931525945663
loss_pred:0.08155818283557892, decouple_loss:0.1109343022108078
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496801793575287, gen p mean: -0.032499078661203384, mean p set: 0.4501604735851288
The modified gen p mean: 0.4491424560546875, gen p mean: -0.03249344229698181, mean p set: 0.4496227502822876
The modified gen p mean: 0.44990983605384827, gen p mean: -0.03252183273434639, mean p set: 0.45039013028144836
loss_pred:0.08436879515647888, decouple_loss:0.10636916011571884
loss_pred:0.08155480027198792, decouple_loss:0.10609953850507736
loss_pred:0.08318422734737396, decouple_loss:0.10645470023155212
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490998685359955, gen p mean: -0.03557753190398216, mean p set: 0.44958019256591797
The modified gen p mean: 0.449188768863678, gen p mean: -0.03567194566130638, mean p set: 0.4496690630912781
The modified gen p mean: 0.44964835047721863, gen p mean: -0.03551878035068512, mean p set: 0.4501286447048187
loss_pred:0.07960548996925354, decouple_loss:0.10706590116024017
loss_pred:0.07906169444322586, decouple_loss:0.109105683863163
loss_pred:0.08325004577636719, decouple_loss:0.10345708578824997
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512721002101898, gen p mean: -0.03862273320555687, mean p set: 0.45175236463546753
The modified gen p mean: 0.4497600495815277, gen p mean: -0.03890926018357277, mean p set: 0.4502403438091278
The modified gen p mean: 0.45158401131629944, gen p mean: -0.0389421209692955, mean p set: 0.45206427574157715
loss_pred:0.0827135220170021, decouple_loss:0.10082889348268509
loss_pred:0.07896605134010315, decouple_loss:0.10164620727300644
loss_pred:0.08044305443763733, decouple_loss:0.10162816196680069
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019733905792236, gen p mean: -0.04013735428452492, mean p set: 0.45067763328552246
The modified gen p mean: 0.450175404548645, gen p mean: -0.04044830799102783, mean p set: 0.45065566897392273
The modified gen p mean: 0.44972312450408936, gen p mean: -0.040723394602537155, mean p set: 0.45020341873168945
loss_pred:0.07824302464723587, decouple_loss:0.09878372400999069
loss_pred:0.0819496139883995, decouple_loss:0.09900056570768356
loss_pred:0.08129475265741348, decouple_loss:0.09951288253068924
2023-05-02 14:21:54 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.043309662491083145, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04276483133435249, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04307600483298302, mean p set: 0.45035696029663086
loss_pred:0.08012973517179489, decouple_loss:0.09705279767513275
loss_pred:0.07968785613775253, decouple_loss:0.09745518863201141
loss_pred:0.0798766165971756, decouple_loss:0.10010743141174316
WV_0_PC_1_EH_0_PS_40_6, loss: 0.0848083347082138, avg_mse: 0.07929936796426773
current test mse: 0.079299
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
NaN value num: 0
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44726434350013733, gen p mean: -0.04233267158269882, mean p set: 0.4477446675300598
The modified gen p mean: 0.45007792115211487, gen p mean: -0.04222369194030762, mean p set: 0.4505581855773926
loss_pred:0.07831939309835434, decouple_loss:0.09877719730138779
loss_pred:0.077071912586689, decouple_loss:0.0968228429555893
The modified gen p mean: 0.4501267969608307, gen p mean: -0.04277438670396805, mean p set: 0.4506070911884308
loss_pred:0.0845334380865097, decouple_loss:0.09579474478960037
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846266508102417, gen p mean: -0.04626218229532242, mean p set: 0.44894298911094666
The modified gen p mean: 0.4526509642601013, gen p mean: -0.046342797577381134, mean p set: 0.4531312584877014
The modified gen p mean: 0.4502222239971161, gen p mean: -0.04588479548692703, mean p set: 0.4507025480270386
loss_pred:0.07712946087121964, decouple_loss:0.09621245414018631
loss_pred:0.07910923659801483, decouple_loss:0.09496772289276123
loss_pred:0.08074934780597687, decouple_loss:0.09672609716653824
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45271623134613037, gen p mean: -0.04729541763663292, mean p set: 0.4531964957714081
The modified gen p mean: 0.44918400049209595, gen p mean: -0.0468423031270504, mean p set: 0.44966429471969604
The modified gen p mean: 0.4502153992652893, gen p mean: -0.04728459194302559, mean p set: 0.450695663690567
loss_pred:0.078860804438591, decouple_loss:0.09289922565221786
loss_pred:0.0770583525300026, decouple_loss:0.0922684594988823
loss_pred:0.07962174713611603, decouple_loss:0.09300459176301956
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45316675305366516, gen p mean: -0.048640523105859756, mean p set: 0.45364704728126526
The modified gen p mean: 0.45256519317626953, gen p mean: -0.04790471866726875, mean p set: 0.45304545760154724
The modified gen p mean: 0.44983574748039246, gen p mean: -0.04814697802066803, mean p set: 0.45031604170799255
loss_pred:0.07613774389028549, decouple_loss:0.09006251394748688
loss_pred:0.07615676522254944, decouple_loss:0.09019040316343307
loss_pred:0.0759371891617775, decouple_loss:0.08897443115711212
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45217224955558777, gen p mean: -0.05274307355284691, mean p set: 0.45265257358551025
The modified gen p mean: 0.4492345154285431, gen p mean: -0.0521051362156868, mean p set: 0.4497148096561432
The modified gen p mean: 0.45304596424102783, gen p mean: -0.052699096500873566, mean p set: 0.45352625846862793
loss_pred:0.07418525964021683, decouple_loss:0.09158852696418762
loss_pred:0.07899466156959534, decouple_loss:0.08990619331598282
loss_pred:0.07619159668684006, decouple_loss:0.08897826075553894
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44970133900642395, gen p mean: -0.0558139868080616, mean p set: 0.45018163323402405
The modified gen p mean: 0.45048776268959045, gen p mean: -0.055867549031972885, mean p set: 0.45096808671951294
The modified gen p mean: 0.44949871301651, gen p mean: -0.0557410903275013, mean p set: 0.4499790072441101
loss_pred:0.07372979819774628, decouple_loss:0.08560565114021301
loss_pred:0.0742349773645401, decouple_loss:0.08949968963861465
loss_pred:0.07648520171642303, decouple_loss:0.08677617460489273
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489035904407501, gen p mean: -0.06050997972488403, mean p set: 0.4493838846683502
The modified gen p mean: 0.45126333832740784, gen p mean: -0.06006419658660889, mean p set: 0.4517436623573303
The modified gen p mean: 0.4500858783721924, gen p mean: -0.06014834716916084, mean p set: 0.4505661725997925
loss_pred:0.07867296785116196, decouple_loss:0.08593831211328506
loss_pred:0.07491189986467361, decouple_loss:0.08432124555110931
loss_pred:0.0726313516497612, decouple_loss:0.08265376091003418
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511922299861908, gen p mean: -0.060786325484514236, mean p set: 0.4516725242137909
The modified gen p mean: 0.4515535533428192, gen p mean: -0.06155247241258621, mean p set: 0.4520338773727417
The modified gen p mean: 0.4506075978279114, gen p mean: -0.060423266142606735, mean p set: 0.4510878920555115
loss_pred:0.07590387016534805, decouple_loss:0.08013543486595154
loss_pred:0.073021799325943, decouple_loss:0.08425096422433853
loss_pred:0.07733882963657379, decouple_loss:0.08068018406629562
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505919814109802, gen p mean: -0.06324394047260284, mean p set: 0.4510722756385803
The modified gen p mean: 0.4491724371910095, gen p mean: -0.06282544136047363, mean p set: 0.4496527314186096
The modified gen p mean: 0.45282161235809326, gen p mean: -0.06347571313381195, mean p set: 0.45330190658569336
loss_pred:0.07166702300310135, decouple_loss:0.0813506469130516
loss_pred:0.07432922720909119, decouple_loss:0.07956048846244812
loss_pred:0.07201389223337173, decouple_loss:0.08053302019834518
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876691699028015, gen p mean: -0.06534922122955322, mean p set: 0.44924721121788025
The modified gen p mean: 0.44873303174972534, gen p mean: -0.06529207527637482, mean p set: 0.44921332597732544
The modified gen p mean: 0.44984570145606995, gen p mean: -0.06552036851644516, mean p set: 0.45032599568367004
loss_pred:0.07594531774520874, decouple_loss:0.07949375361204147
loss_pred:0.07567179203033447, decouple_loss:0.07906753569841385
loss_pred:0.07154104113578796, decouple_loss:0.07833417505025864
2023-05-02 14:26:20 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.06831463426351547, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0682702511548996, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0684339851140976, mean p set: 0.45035696029663086
loss_pred:0.07473158091306686, decouple_loss:0.07805796712636948
loss_pred:0.07424281537532806, decouple_loss:0.07851045578718185
loss_pred:0.07413067668676376, decouple_loss:0.07984108477830887
WV_0_PC_1_EH_0_PS_40_6, loss: 0.07830851525068283, avg_mse: 0.07411891222000122
current test mse: 0.074119
Iteration: 51, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514254331588745, gen p mean: -0.06833600252866745, mean p set: 0.451905757188797
loss_pred:0.0729975625872612, decouple_loss:0.07679945230484009
The modified gen p mean: 0.4498523473739624, gen p mean: -0.06754876673221588, mean p set: 0.4503326416015625
loss_pred:0.07518346607685089, decouple_loss:0.07801777869462967
The modified gen p mean: 0.4495389461517334, gen p mean: -0.06727967411279678, mean p set: 0.4500192403793335
loss_pred:0.07391130179166794, decouple_loss:0.07621848583221436
Iteration: 52, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449763685464859, gen p mean: -0.07111670076847076, mean p set: 0.4502440094947815
The modified gen p mean: 0.4523540735244751, gen p mean: -0.07097550481557846, mean p set: 0.4528343677520752
The modified gen p mean: 0.44934508204460144, gen p mean: -0.07028380781412125, mean p set: 0.44982537627220154
loss_pred:0.07599759101867676, decouple_loss:0.07693017274141312
loss_pred:0.07211624085903168, decouple_loss:0.07779873162508011
loss_pred:0.07579483836889267, decouple_loss:0.0768144279718399
Iteration: 53, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44855958223342896, gen p mean: -0.07175830006599426, mean p set: 0.44903984665870667
The modified gen p mean: 0.451625794172287, gen p mean: -0.07060223817825317, mean p set: 0.4521060883998871
The modified gen p mean: 0.4503084421157837, gen p mean: -0.07231312990188599, mean p set: 0.4507887363433838
loss_pred:0.0726293995976448, decouple_loss:0.07532323896884918
loss_pred:0.0720563530921936, decouple_loss:0.07459615916013718
loss_pred:0.07097412645816803, decouple_loss:0.07363498955965042
Iteration: 54, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488403797149658, gen p mean: -0.07446526736021042, mean p set: 0.4493206739425659
The modified gen p mean: 0.44997432827949524, gen p mean: -0.07413732260465622, mean p set: 0.45045459270477295
The modified gen p mean: 0.4497223496437073, gen p mean: -0.07448357343673706, mean p set: 0.45020267367362976
loss_pred:0.07221440225839615, decouple_loss:0.07276694476604462
loss_pred:0.07139400392770767, decouple_loss:0.07194264233112335
loss_pred:0.07475819438695908, decouple_loss:0.0729379951953888
Iteration: 55, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44933873414993286, gen p mean: -0.07776307314634323, mean p set: 0.44981902837753296
The modified gen p mean: 0.45171695947647095, gen p mean: -0.0773945301771164, mean p set: 0.45219725370407104
The modified gen p mean: 0.44980499148368835, gen p mean: -0.07672452181577682, mean p set: 0.45028528571128845
loss_pred:0.07101087272167206, decouple_loss:0.07404230535030365
loss_pred:0.07004114985466003, decouple_loss:0.07349011301994324
loss_pred:0.07304549962282181, decouple_loss:0.07066473364830017
Iteration: 56, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501339793205261, gen p mean: -0.07775915414094925, mean p set: 0.45061424374580383
The modified gen p mean: 0.44869184494018555, gen p mean: -0.07819189131259918, mean p set: 0.44917213916778564
The modified gen p mean: 0.45039212703704834, gen p mean: -0.07739193737506866, mean p set: 0.45087239146232605
loss_pred:0.06965765357017517, decouple_loss:0.06907911598682404
loss_pred:0.07237027585506439, decouple_loss:0.07030448317527771
loss_pred:0.07029208540916443, decouple_loss:0.06932809948921204
Iteration: 57, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496883749961853, gen p mean: -0.08093671500682831, mean p set: 0.4501686692237854
The modified gen p mean: 0.4497276544570923, gen p mean: -0.08169416338205338, mean p set: 0.45020797848701477
The modified gen p mean: 0.45273956656455994, gen p mean: -0.08128787577152252, mean p set: 0.4532198905944824
loss_pred:0.07112861424684525, decouple_loss:0.0686168298125267
loss_pred:0.07684338092803955, decouple_loss:0.06973366439342499
loss_pred:0.07301835715770721, decouple_loss:0.07039530575275421
Iteration: 58, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44968754053115845, gen p mean: -0.08414115011692047, mean p set: 0.45016786456108093
The modified gen p mean: 0.45358121395111084, gen p mean: -0.08462604880332947, mean p set: 0.45406150817871094
The modified gen p mean: 0.44953402876853943, gen p mean: -0.08352164924144745, mean p set: 0.4500143229961395
loss_pred:0.07257784903049469, decouple_loss:0.06854695826768875
loss_pred:0.07209315896034241, decouple_loss:0.06933300197124481
loss_pred:0.07340284436941147, decouple_loss:0.06763558089733124
Iteration: 59, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45297864079475403, gen p mean: -0.08609747886657715, mean p set: 0.4534589648246765
The modified gen p mean: 0.4530010223388672, gen p mean: -0.08642096817493439, mean p set: 0.4534813165664673
The modified gen p mean: 0.4498113691806793, gen p mean: -0.08652971684932709, mean p set: 0.4502916932106018
loss_pred:0.07011337578296661, decouple_loss:0.06770607829093933
loss_pred:0.07391829043626785, decouple_loss:0.068155437707901
loss_pred:0.07318850606679916, decouple_loss:0.06646829843521118
Iteration: 60, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44892454147338867, gen p mean: -0.08652313798666, mean p set: 0.4494048058986664
The modified gen p mean: 0.44992244243621826, gen p mean: -0.08493336290121078, mean p set: 0.45040273666381836
The modified gen p mean: 0.45070335268974304, gen p mean: -0.0856667160987854, mean p set: 0.4511836767196655
loss_pred:0.07102265954017639, decouple_loss:0.06543781608343124
loss_pred:0.07172121107578278, decouple_loss:0.06502194702625275
loss_pred:0.07324401289224625, decouple_loss:0.06669231504201889
2023-05-02 14:30:01 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.08838022500276566, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.08810018002986908, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0883735865354538, mean p set: 0.45035696029663086
loss_pred:0.07229111343622208, decouple_loss:0.06842485070228577
loss_pred:0.07268691807985306, decouple_loss:0.06839000433683395
loss_pred:0.07191479206085205, decouple_loss:0.07016194611787796
WV_0_PC_1_EH_0_PS_40_6, loss: 0.07574722170829773, avg_mse: 0.07219769805669785
current test mse: 0.072198
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
NaN value num: 0
Iteration: 61, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44848689436912537, gen p mean: -0.08757290989160538, mean p set: 0.44896718859672546
loss_pred:0.07270825654268265, decouple_loss:0.07118488103151321
The modified gen p mean: 0.4474177360534668, gen p mean: -0.08793854713439941, mean p set: 0.4478980302810669
loss_pred:0.07176356762647629, decouple_loss:0.0689706951379776
The modified gen p mean: 0.44729548692703247, gen p mean: -0.0882311761379242, mean p set: 0.44777578115463257
loss_pred:0.0704614445567131, decouple_loss:0.07212669402360916
Iteration: 62, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723573327064514, gen p mean: -0.0949377492070198, mean p set: 0.4477160573005676
The modified gen p mean: 0.44694972038269043, gen p mean: -0.09182972460985184, mean p set: 0.44742998480796814
The modified gen p mean: 0.4471362829208374, gen p mean: -0.09274648874998093, mean p set: 0.4476166069507599
loss_pred:0.07204992324113846, decouple_loss:0.0723857581615448
loss_pred:0.07120881974697113, decouple_loss:0.07090092450380325
loss_pred:0.07266929745674133, decouple_loss:0.07086213678121567
Iteration: 63, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470658302307129, gen p mean: -0.09472236782312393, mean p set: 0.447546124458313
The modified gen p mean: 0.4484701454639435, gen p mean: -0.09503823518753052, mean p set: 0.4489504396915436
The modified gen p mean: 0.4463949501514435, gen p mean: -0.0964428260922432, mean p set: 0.4468752145767212
loss_pred:0.07072500884532928, decouple_loss:0.06705249100923538
loss_pred:0.07011471688747406, decouple_loss:0.06780782341957092
loss_pred:0.06952042877674103, decouple_loss:0.06950313597917557
Iteration: 64, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471486806869507, gen p mean: -0.08956755697727203, mean p set: 0.44762900471687317
The modified gen p mean: 0.44651955366134644, gen p mean: -0.08895213156938553, mean p set: 0.44699984788894653
The modified gen p mean: 0.4471409320831299, gen p mean: -0.08974859118461609, mean p set: 0.44762122631073
loss_pred:0.0698045864701271, decouple_loss:0.06606464833021164
loss_pred:0.0688696950674057, decouple_loss:0.06878641247749329
loss_pred:0.07070375233888626, decouple_loss:0.06687863171100616
Iteration: 65, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474044740200043, gen p mean: -0.09161736071109772, mean p set: 0.44788476824760437
The modified gen p mean: 0.44731464982032776, gen p mean: -0.09154825657606125, mean p set: 0.44779494404792786
The modified gen p mean: 0.44732069969177246, gen p mean: -0.0913752093911171, mean p set: 0.44780099391937256
loss_pred:0.06864103674888611, decouple_loss:0.06826548278331757
loss_pred:0.07018325477838516, decouple_loss:0.06741462647914886
loss_pred:0.06793547421693802, decouple_loss:0.06882528960704803
Iteration: 66, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475298523902893, gen p mean: -0.09587956219911575, mean p set: 0.4480101466178894
The modified gen p mean: 0.4472377598285675, gen p mean: -0.09610070288181305, mean p set: 0.4477180242538452
The modified gen p mean: 0.44772693514823914, gen p mean: -0.09537706524133682, mean p set: 0.44820722937583923
loss_pred:0.06765872985124588, decouple_loss:0.06630521267652512
loss_pred:0.0700422152876854, decouple_loss:0.06681985408067703
loss_pred:0.07169823348522186, decouple_loss:0.06670153886079788
Iteration: 67, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44615963101387024, gen p mean: -0.09817075729370117, mean p set: 0.4466399550437927
The modified gen p mean: 0.44754984974861145, gen p mean: -0.09725043922662735, mean p set: 0.44803011417388916
The modified gen p mean: 0.44698771834373474, gen p mean: -0.09812549501657486, mean p set: 0.44746798276901245
loss_pred:0.06699278205633163, decouple_loss:0.06828011572360992
loss_pred:0.07020635157823563, decouple_loss:0.06658473610877991
loss_pred:0.06818610429763794, decouple_loss:0.06767559796571732
Iteration: 68, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44653427600860596, gen p mean: -0.09939146786928177, mean p set: 0.44701457023620605
The modified gen p mean: 0.4472602307796478, gen p mean: -0.10005662590265274, mean p set: 0.4477405250072479
The modified gen p mean: 0.4459533095359802, gen p mean: -0.09781577438116074, mean p set: 0.4464336037635803
loss_pred:0.06921247392892838, decouple_loss:0.06809613853693008
loss_pred:0.07152680307626724, decouple_loss:0.0654839351773262
loss_pred:0.06684622913599014, decouple_loss:0.0683281272649765
Iteration: 69, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44622308015823364, gen p mean: -0.09762489795684814, mean p set: 0.44670340418815613
The modified gen p mean: 0.44681090116500854, gen p mean: -0.09533568471670151, mean p set: 0.44729119539260864
loss_pred:0.0691213384270668, decouple_loss:0.06492739915847778
The modified gen p mean: 0.4464568793773651, gen p mean: -0.09569446742534637, mean p set: 0.4469371736049652
loss_pred:0.06965877115726471, decouple_loss:0.06552652269601822
loss_pred:0.0669439285993576, decouple_loss:0.06378688663244247
Iteration: 70, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476718306541443, gen p mean: -0.09948964416980743, mean p set: 0.448152095079422
The modified gen p mean: 0.4484092891216278, gen p mean: -0.09855306893587112, mean p set: 0.4488895833492279
The modified gen p mean: 0.4469406008720398, gen p mean: -0.09843757748603821, mean p set: 0.4474208950996399
loss_pred:0.06997650861740112, decouple_loss:0.0647609531879425
loss_pred:0.0708533450961113, decouple_loss:0.06520936638116837
loss_pred:0.0685080960392952, decouple_loss:0.0636456236243248
2023-05-02 14:34:27 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.10227300226688385, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.10254397988319397, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.10315568000078201, mean p set: 0.45035696029663086
loss_pred:0.0707547590136528, decouple_loss:0.06274008750915527
loss_pred:0.07016721367835999, decouple_loss:0.06393148005008698loss_pred:0.0695890486240387, decouple_loss:0.06375454366207123
WV_0_PC_1_EH_0_PS_40_6, loss: 0.07334411144256592, avg_mse: 0.07021740078926086
current test mse: 0.070217
Iteration: 71, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772329926490784, gen p mean: -0.10171681642532349, mean p set: 0.44820359349250793
The modified gen p mean: 0.44786348938941956, gen p mean: -0.10076519101858139, mean p set: 0.44834375381469727
loss_pred:0.07187612354755402, decouple_loss:0.064326211810112
loss_pred:0.07081563025712967, decouple_loss:0.06366442888975143
The modified gen p mean: 0.4473946690559387, gen p mean: -0.10356472432613373, mean p set: 0.4478749632835388
loss_pred:0.06864810734987259, decouple_loss:0.06318897008895874
Iteration: 72, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476805627346039, gen p mean: -0.10169828683137894, mean p set: 0.448160856962204
The modified gen p mean: 0.446189284324646, gen p mean: -0.10221724212169647, mean p set: 0.4466695487499237
The modified gen p mean: 0.4480492174625397, gen p mean: -0.10153970867395401, mean p set: 0.4485294818878174
loss_pred:0.07025720924139023, decouple_loss:0.06353184580802917
loss_pred:0.06799764931201935, decouple_loss:0.06370510160923004
loss_pred:0.06958022713661194, decouple_loss:0.06490151584148407
Iteration: 73, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44675564765930176, gen p mean: -0.09744288772344589, mean p set: 0.44723597168922424
The modified gen p mean: 0.4463563859462738, gen p mean: -0.09822748601436615, mean p set: 0.4468367099761963
The modified gen p mean: 0.4470345973968506, gen p mean: -0.09923539310693741, mean p set: 0.4475148916244507
loss_pred:0.06739716976881027, decouple_loss:0.062187559902668
loss_pred:0.06708581000566483, decouple_loss:0.06207190081477165
loss_pred:0.07070465385913849, decouple_loss:0.06236768886446953
Iteration: 74, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470891058444977, gen p mean: -0.09586554765701294, mean p set: 0.447569340467453
The modified gen p mean: 0.44671186804771423, gen p mean: -0.09965940564870834, mean p set: 0.44719216227531433
The modified gen p mean: 0.44739392399787903, gen p mean: -0.09363404661417007, mean p set: 0.4478742182254791
loss_pred:0.06846252828836441, decouple_loss:0.0621628575026989
loss_pred:0.0674171894788742, decouple_loss:0.06243610754609108
loss_pred:0.06998421251773834, decouple_loss:0.06266921758651733
Iteration: 75, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447578489780426, gen p mean: -0.09993898868560791, mean p set: 0.44805875420570374
The modified gen p mean: 0.44717586040496826, gen p mean: -0.10161862522363663, mean p set: 0.44765612483024597
The modified gen p mean: 0.446994811296463, gen p mean: -0.10295673459768295, mean p set: 0.4474751055240631
loss_pred:0.06821984052658081, decouple_loss:0.06016716733574867
loss_pred:0.06777013838291168, decouple_loss:0.059935562312603
loss_pred:0.0667772963643074, decouple_loss:0.0606808066368103
Iteration: 76, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477144181728363, gen p mean: -0.10211507230997086, mean p set: 0.4481947124004364
The modified gen p mean: 0.4469488859176636, gen p mean: -0.10068394988775253, mean p set: 0.44742920994758606
The modified gen p mean: 0.4473946988582611, gen p mean: -0.10179442167282104, mean p set: 0.4478749930858612
loss_pred:0.0682828426361084, decouple_loss:0.05920660123229027
loss_pred:0.06869598478078842, decouple_loss:0.059226568788290024
loss_pred:0.06842418760061264, decouple_loss:0.0595301017165184
Iteration: 77, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44558027386665344, gen p mean: -0.09949463605880737, mean p set: 0.44606053829193115
The modified gen p mean: 0.44721198081970215, gen p mean: -0.097556933760643, mean p set: 0.44769227504730225
The modified gen p mean: 0.44758981466293335, gen p mean: -0.09751354157924652, mean p set: 0.44807007908821106
loss_pred:0.06625381857156754, decouple_loss:0.059403613209724426
loss_pred:0.06741660088300705, decouple_loss:0.05972949415445328
loss_pred:0.06567682325839996, decouple_loss:0.05805171653628349
Iteration: 78, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456823468208313, gen p mean: -0.09840495139360428, mean p set: 0.4461626410484314
The modified gen p mean: 0.44735077023506165, gen p mean: -0.09557555615901947, mean p set: 0.44783106446266174
The modified gen p mean: 0.4478931128978729, gen p mean: -0.09699149429798126, mean p set: 0.448373407125473
loss_pred:0.06534051895141602, decouple_loss:0.058837469667196274
loss_pred:0.0673745721578598, decouple_loss:0.05847955122590065
loss_pred:0.06960327923297882, decouple_loss:0.0581083670258522
Iteration: 79, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461573660373688, gen p mean: -0.09793809056282043, mean p set: 0.44663766026496887
The modified gen p mean: 0.44760647416114807, gen p mean: -0.0995187759399414, mean p set: 0.44808676838874817
The modified gen p mean: 0.44942793250083923, gen p mean: -0.09563570469617844, mean p set: 0.44990822672843933
loss_pred:0.06628447026014328, decouple_loss:0.05689699947834015
loss_pred:0.06561826169490814, decouple_loss:0.05793255940079689
loss_pred:0.06951200217008591, decouple_loss:0.06164480373263359
Iteration: 80, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44905388355255127, gen p mean: -0.09840495884418488, mean p set: 0.44953420758247375
The modified gen p mean: 0.44661176204681396, gen p mean: -0.09894682466983795, mean p set: 0.44709208607673645
The modified gen p mean: 0.4472832679748535, gen p mean: -0.10161024332046509, mean p set: 0.4477635622024536
loss_pred:0.06902046501636505, decouple_loss:0.06062496453523636
loss_pred:0.06838016211986542, decouple_loss:0.05707120522856712
loss_pred:0.06645700335502625, decouple_loss:0.05692751705646515
2023-05-02 14:38:12 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.10010137408971786, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.10054749250411987, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.10138285905122757, mean p set: 0.45035696029663086
loss_pred:0.06863496452569962, decouple_loss:0.05667266622185707
loss_pred:0.06823740154504776, decouple_loss:0.05729203671216965
loss_pred:0.06737406551837921, decouple_loss:0.05733514949679375
WV_0_PC_1_EH_0_PS_40_6, loss: 0.0709371417760849, avg_mse: 0.06815464794635773
current test mse: 0.068155
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
NaN value num: 0
Iteration: 81, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471080005168915, gen p mean: -0.09895888715982437, mean p set: 0.44758832454681396
loss_pred:0.06955648958683014, decouple_loss:0.05765338987112045
The modified gen p mean: 0.4468432068824768, gen p mean: -0.0995386466383934, mean p set: 0.4473235011100769
loss_pred:0.06815819442272186, decouple_loss:0.058072853833436966
The modified gen p mean: 0.4478825628757477, gen p mean: -0.09900061041116714, mean p set: 0.4483628571033478
loss_pred:0.06789501011371613, decouple_loss:0.05761018395423889
Iteration: 82, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44700631499290466, gen p mean: -0.0961468443274498, mean p set: 0.44748660922050476
The modified gen p mean: 0.44763243198394775, gen p mean: -0.09549447894096375, mean p set: 0.44811269640922546
The modified gen p mean: 0.4468826949596405, gen p mean: -0.09520575404167175, mean p set: 0.4473629891872406
loss_pred:0.06592688709497452, decouple_loss:0.056946177035570145
loss_pred:0.06822577863931656, decouple_loss:0.056184932589530945
loss_pred:0.06646699458360672, decouple_loss:0.056063804775476456
Iteration: 83, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960349798202515, gen p mean: -0.09754591435194016, mean p set: 0.45008379220962524
The modified gen p mean: 0.44786781072616577, gen p mean: -0.09756402671337128, mean p set: 0.44834810495376587
The modified gen p mean: 0.4475606679916382, gen p mean: -0.0970669686794281, mean p set: 0.44804099202156067
loss_pred:0.06548839807510376, decouple_loss:0.05660325288772583
loss_pred:0.06638167798519135, decouple_loss:0.055805448442697525
loss_pred:0.06659218668937683, decouple_loss:0.056611161679029465
Iteration: 84, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44696488976478577, gen p mean: -0.0962570458650589, mean p set: 0.44744521379470825
The modified gen p mean: 0.4490186870098114, gen p mean: -0.09661153703927994, mean p set: 0.4494989514350891
The modified gen p mean: 0.4455285668373108, gen p mean: -0.09803543239831924, mean p set: 0.4460088610649109
loss_pred:0.06529279798269272, decouple_loss:0.05605437234044075
loss_pred:0.06544725596904755, decouple_loss:0.057677011936903
loss_pred:0.06822274625301361, decouple_loss:0.05851249024271965
Iteration: 85, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481637179851532, gen p mean: -0.09788522869348526, mean p set: 0.4486440122127533
The modified gen p mean: 0.4488181471824646, gen p mean: -0.09687405824661255, mean p set: 0.4492984712123871
The modified gen p mean: 0.4474712014198303, gen p mean: -0.09556664526462555, mean p set: 0.44795146584510803
loss_pred:0.06644517183303833, decouple_loss:0.054875921458005905
loss_pred:0.06399819254875183, decouple_loss:0.05510454997420311
loss_pred:0.06835661083459854, decouple_loss:0.055568862706422806
Iteration: 86, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786715507507324, gen p mean: -0.09111727029085159, mean p set: 0.44834744930267334
The modified gen p mean: 0.4484109878540039, gen p mean: -0.09682953357696533, mean p set: 0.4488913118839264
The modified gen p mean: 0.4482695758342743, gen p mean: -0.09534241259098053, mean p set: 0.4487498700618744
loss_pred:0.06730938702821732, decouple_loss:0.05572061985731125
loss_pred:0.06585392355918884, decouple_loss:0.05480952188372612
loss_pred:0.06593732535839081, decouple_loss:0.0547124482691288
Iteration: 87, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839930534362793, gen p mean: -0.09295838326215744, mean p set: 0.448879599571228
The modified gen p mean: 0.4472469389438629, gen p mean: -0.09164727479219437, mean p set: 0.4477272629737854
The modified gen p mean: 0.4474649131298065, gen p mean: -0.09026060253381729, mean p set: 0.4479452073574066
loss_pred:0.06564801931381226, decouple_loss:0.054701805114746094
loss_pred:0.0654144212603569, decouple_loss:0.05483796074986458
loss_pred:0.06485000997781754, decouple_loss:0.056489501148462296
Iteration: 88, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728726148605347, gen p mean: -0.09040271490812302, mean p set: 0.44776758551597595
The modified gen p mean: 0.44775673747062683, gen p mean: -0.09045227617025375, mean p set: 0.44823703169822693
The modified gen p mean: 0.44835206866264343, gen p mean: -0.09320493042469025, mean p set: 0.44883236289024353
loss_pred:0.0665074959397316, decouple_loss:0.05564074590802193
loss_pred:0.06694050878286362, decouple_loss:0.05301900953054428
loss_pred:0.06414917856454849, decouple_loss:0.05392707139253616
Iteration: 89, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470180869102478, gen p mean: -0.09048684686422348, mean p set: 0.4474983811378479
The modified gen p mean: 0.4477536678314209, gen p mean: -0.09181302040815353, mean p set: 0.4482339918613434
The modified gen p mean: 0.4475497901439667, gen p mean: -0.08869171142578125, mean p set: 0.4480300843715668
loss_pred:0.06725413352251053, decouple_loss:0.05409723520278931
loss_pred:0.06466566771268845, decouple_loss:0.05502168834209442
loss_pred:0.06334801018238068, decouple_loss:0.05564836785197258
Iteration: 90, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478951394557953, gen p mean: -0.0915885791182518, mean p set: 0.4483754336833954
The modified gen p mean: 0.44752398133277893, gen p mean: -0.09069839119911194, mean p set: 0.44800424575805664
The modified gen p mean: 0.44687744975090027, gen p mean: -0.0888151079416275, mean p set: 0.44735774397850037
loss_pred:0.06554785370826721, decouple_loss:0.053716205060482025
loss_pred:0.06361860781908035, decouple_loss:0.05417627468705177
loss_pred:0.0664922222495079, decouple_loss:0.05402381345629692
2023-05-02 14:42:42 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.09091437608003616, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0902285948395729, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.09255942702293396, mean p set: 0.45035696029663086
loss_pred:0.06645508110523224, decouple_loss:0.054632823914289474
loss_pred:0.0665002167224884, decouple_loss:0.0539463572204113
loss_pred:0.06516025960445404, decouple_loss:0.05555812641978264
WV_0_PC_1_EH_0_PS_40_6, loss: 0.06877414882183075, avg_mse: 0.06605779379606247
current test mse: 0.066058
Iteration: 91, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760170578956604, gen p mean: -0.08968573808670044, mean p set: 0.4480820298194885
The modified gen p mean: 0.44843438267707825, gen p mean: -0.09233459085226059, mean p set: 0.44891470670700073
loss_pred:0.06729000061750412, decouple_loss:0.05250440165400505
loss_pred:0.06377378851175308, decouple_loss:0.05221312493085861
The modified gen p mean: 0.44651171565055847, gen p mean: -0.08995649218559265, mean p set: 0.4469919800758362
loss_pred:0.06638072431087494, decouple_loss:0.05295543745160103
Iteration: 92, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478885233402252, gen p mean: -0.09100448340177536, mean p set: 0.44836878776550293
The modified gen p mean: 0.4479265809059143, gen p mean: -0.08820880204439163, mean p set: 0.4484068751335144
The modified gen p mean: 0.4475826621055603, gen p mean: -0.08762534707784653, mean p set: 0.4480629861354828
loss_pred:0.06311103701591492, decouple_loss:0.05116528272628784
loss_pred:0.0652511864900589, decouple_loss:0.05300338193774223
loss_pred:0.06564103811979294, decouple_loss:0.05213760957121849
Iteration: 93, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458010792732239, gen p mean: -0.08682285994291306, mean p set: 0.44628140330314636
The modified gen p mean: 0.4475783705711365, gen p mean: -0.08928367495536804, mean p set: 0.4480586349964142
The modified gen p mean: 0.44796356558799744, gen p mean: -0.09127316623926163, mean p set: 0.44844383001327515
loss_pred:0.06593992561101913, decouple_loss:0.053212203085422516
loss_pred:0.06487784534692764, decouple_loss:0.05216272175312042
loss_pred:0.06240984424948692, decouple_loss:0.04967515543103218
Iteration: 94, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44699928164482117, gen p mean: -0.08466780930757523, mean p set: 0.44747960567474365
The modified gen p mean: 0.44798776507377625, gen p mean: -0.08737124502658844, mean p set: 0.44846805930137634
The modified gen p mean: 0.44828546047210693, gen p mean: -0.08721984177827835, mean p set: 0.44876575469970703
loss_pred:0.06314827501773834, decouple_loss:0.05181458592414856
loss_pred:0.06586923450231552, decouple_loss:0.05085619166493416
loss_pred:0.06304013729095459, decouple_loss:0.05054206773638725
Iteration: 95, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749292731285095, gen p mean: -0.08762161433696747, mean p set: 0.44797322154045105
The modified gen p mean: 0.44791364669799805, gen p mean: -0.08113057166337967, mean p set: 0.44839391112327576
The modified gen p mean: 0.4484841525554657, gen p mean: -0.08944479376077652, mean p set: 0.4489644169807434
loss_pred:0.06531956791877747, decouple_loss:0.05095824971795082
loss_pred:0.06286900490522385, decouple_loss:0.05355143919587135
loss_pred:0.06379636377096176, decouple_loss:0.05073170363903046
Iteration: 96, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476946294307709, gen p mean: -0.08553015440702438, mean p set: 0.44817492365837097
The modified gen p mean: 0.446107417345047, gen p mean: -0.08526333421468735, mean p set: 0.4465877413749695
The modified gen p mean: 0.4475327730178833, gen p mean: -0.08958635479211807, mean p set: 0.4480130672454834
loss_pred:0.06355573982000351, decouple_loss:0.05214666202664375
loss_pred:0.06487242132425308, decouple_loss:0.05042509362101555
loss_pred:0.06391755491495132, decouple_loss:0.05050326883792877
Iteration: 97, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449051171541214, gen p mean: -0.08459002524614334, mean p set: 0.4495314955711365
The modified gen p mean: 0.44710037112236023, gen p mean: -0.08634842187166214, mean p set: 0.4475806653499603
The modified gen p mean: 0.44846656918525696, gen p mean: -0.08611110597848892, mean p set: 0.44894686341285706
loss_pred:0.064290352165699, decouple_loss:0.04981578141450882
loss_pred:0.06417666375637054, decouple_loss:0.05057281255722046
loss_pred:0.06377530843019485, decouple_loss:0.0507049486041069
Iteration: 98, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480271637439728, gen p mean: -0.08459844440221786, mean p set: 0.4485074579715729
The modified gen p mean: 0.4475351572036743, gen p mean: -0.07735137641429901, mean p set: 0.448015421628952
The modified gen p mean: 0.44946858286857605, gen p mean: -0.08193578571081161, mean p set: 0.44994887709617615
loss_pred:0.06347839534282684, decouple_loss:0.050911419093608856
loss_pred:0.06313943862915039, decouple_loss:0.0521126389503479
loss_pred:0.06301812827587128, decouple_loss:0.05080665275454521
Iteration: 99, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464336037635803, gen p mean: -0.09224534034729004, mean p set: 0.4469138979911804
The modified gen p mean: 0.447560578584671, gen p mean: -0.09043191373348236, mean p set: 0.4480408728122711
The modified gen p mean: 0.44816645979881287, gen p mean: -0.09144425392150879, mean p set: 0.4486467242240906
loss_pred:0.06598468869924545, decouple_loss:0.04998055845499039
loss_pred:0.06373538076877594, decouple_loss:0.05085171386599541
loss_pred:0.06405439972877502, decouple_loss:0.051144078373909
Iteration: 100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469090700149536, gen p mean: -0.08659146726131439, mean p set: 0.4473893940448761
The modified gen p mean: 0.44840705394744873, gen p mean: -0.08633319288492203, mean p set: 0.4488873779773712
The modified gen p mean: 0.44762560725212097, gen p mean: -0.08834631741046906, mean p set: 0.4481058716773987
loss_pred:0.06302379071712494, decouple_loss:0.0490410141646862
loss_pred:0.06393719464540482, decouple_loss:0.0474834106862545
loss_pred:0.06133217737078667, decouple_loss:0.04827055707573891
2023-05-02 14:46:24 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.077295683324337, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.07858108729124069, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.07888157665729523, mean p set: 0.45035696029663086
loss_pred:0.06465746462345123, decouple_loss:0.051849376410245895
loss_pred:0.06457196176052094, decouple_loss:0.051732175052165985
loss_pred:0.06329982727766037, decouple_loss:0.052665647119283676
WV_0_PC_1_EH_0_PS_40_6, loss: 0.06678053736686707, avg_mse: 0.06433703750371933
current test mse: 0.064337
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44882193207740784, gen p mean: -0.08109571039676666, mean p set: 0.44930222630500793
The modified gen p mean: 0.44761672616004944, gen p mean: -0.07524330914020538, mean p set: 0.4480970501899719
loss_pred:0.0645337849855423, decouple_loss:0.05451416224241257
loss_pred:0.06158924102783203, decouple_loss:0.051483403891325
The modified gen p mean: 0.44792136549949646, gen p mean: -0.08080488443374634, mean p set: 0.44840162992477417
loss_pred:0.06534967571496964, decouple_loss:0.05335892364382744
Iteration: 102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487597942352295, gen p mean: -0.07838929444551468, mean p set: 0.4492400586605072
The modified gen p mean: 0.4484231173992157, gen p mean: -0.07956243306398392, mean p set: 0.4489034116268158
The modified gen p mean: 0.44858604669570923, gen p mean: -0.08076077699661255, mean p set: 0.4490663409233093
loss_pred:0.06468082219362259, decouple_loss:0.05133434757590294
loss_pred:0.06397908926010132, decouple_loss:0.05234173685312271
loss_pred:0.06687957048416138, decouple_loss:0.05173654854297638
Iteration: 103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44895660877227783, gen p mean: -0.09277762472629547, mean p set: 0.44943690299987793
The modified gen p mean: 0.44817501306533813, gen p mean: -0.094534732401371, mean p set: 0.4486553370952606
The modified gen p mean: 0.44917911291122437, gen p mean: -0.09356801956892014, mean p set: 0.44965940713882446
loss_pred:0.06303521990776062, decouple_loss:0.05150109529495239
loss_pred:0.06473422050476074, decouple_loss:0.052585989236831665
loss_pred:0.06356609612703323, decouple_loss:0.052522413432598114
Iteration: 104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474776089191437, gen p mean: -0.09795358777046204, mean p set: 0.4479579031467438
The modified gen p mean: 0.4489496946334839, gen p mean: -0.09103141725063324, mean p set: 0.449429988861084
The modified gen p mean: 0.44897907972335815, gen p mean: -0.09532085061073303, mean p set: 0.44945937395095825
loss_pred:0.06596047431230545, decouple_loss:0.05342193692922592
loss_pred:0.06273754686117172, decouple_loss:0.052056215703487396
loss_pred:0.06198573485016823, decouple_loss:0.05142175406217575
Iteration: 105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479890465736389, gen p mean: -0.09851101040840149, mean p set: 0.448469340801239
The modified gen p mean: 0.4488055109977722, gen p mean: -0.09348845481872559, mean p set: 0.4492858350276947
The modified gen p mean: 0.44868406653404236, gen p mean: -0.08963930606842041, mean p set: 0.44916436076164246
loss_pred:0.06745652109384537, decouple_loss:0.05124881863594055
loss_pred:0.06101958081126213, decouple_loss:0.04988206923007965
loss_pred:0.06300270557403564, decouple_loss:0.0490165539085865
Iteration: 106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499695599079132, gen p mean: -0.09663207083940506, mean p set: 0.4504498541355133
The modified gen p mean: 0.4487152099609375, gen p mean: -0.09128723293542862, mean p set: 0.44919553399086
The modified gen p mean: 0.44914141297340393, gen p mean: -0.0909423977136612, mean p set: 0.4496217370033264
loss_pred:0.06523600965738297, decouple_loss:0.05101200193166733
loss_pred:0.062340155243873596, decouple_loss:0.051500819623470306
loss_pred:0.061226390302181244, decouple_loss:0.05106489732861519
Iteration: 107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476096034049988, gen p mean: -0.08905258029699326, mean p set: 0.4480898678302765
The modified gen p mean: 0.4480079710483551, gen p mean: -0.0886838287115097, mean p set: 0.4484882652759552
The modified gen p mean: 0.4484126567840576, gen p mean: -0.08884242922067642, mean p set: 0.4488929510116577
loss_pred:0.06342471390962601, decouple_loss:0.05100017413496971
loss_pred:0.059285152703523636, decouple_loss:0.051698654890060425
loss_pred:0.06226996332406998, decouple_loss:0.05134176090359688
Iteration: 108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497270882129669, gen p mean: -0.0919143483042717, mean p set: 0.450207382440567
The modified gen p mean: 0.44884926080703735, gen p mean: -0.08769726008176804, mean p set: 0.44932955503463745
The modified gen p mean: 0.44744542241096497, gen p mean: -0.09327351301908493, mean p set: 0.4479256868362427
loss_pred:0.062307074666023254, decouple_loss:0.05078890919685364
loss_pred:0.061162956058979034, decouple_loss:0.05190727859735489
loss_pred:0.06532835215330124, decouple_loss:0.0510457418859005
Iteration: 109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491707384586334, gen p mean: -0.0972713902592659, mean p set: 0.4496510326862335
The modified gen p mean: 0.4479455053806305, gen p mean: -0.099863201379776, mean p set: 0.4484257698059082
The modified gen p mean: 0.4485883116722107, gen p mean: -0.09743906557559967, mean p set: 0.4490686058998108
loss_pred:0.0651494637131691, decouple_loss:0.05040412396192551
loss_pred:0.06196180731058121, decouple_loss:0.04969049617648125
loss_pred:0.06208604574203491, decouple_loss:0.05087638646364212
Iteration: 110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840681552886963, gen p mean: -0.10237658768892288, mean p set: 0.4488871097564697
The modified gen p mean: 0.44786936044692993, gen p mean: -0.09597775340080261, mean p set: 0.44834965467453003
The modified gen p mean: 0.4485422968864441, gen p mean: -0.09440319985151291, mean p set: 0.4490225911140442
loss_pred:0.06211291253566742, decouple_loss:0.049902576953172684
loss_pred:0.062441352754831314, decouple_loss:0.05262729153037071
loss_pred:0.060229890048503876, decouple_loss:0.05087955296039581
2023-05-02 14:50:48 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.09072462469339371, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.09220671653747559, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.09372325241565704, mean p set: 0.45035696029663086
loss_pred:0.06231089308857918, decouple_loss:0.05216427519917488
loss_pred:0.061755359172821045, decouple_loss:0.05089980363845825
loss_pred:0.06036961451172829, decouple_loss:0.051542818546295166
WV_0_PC_1_EH_0_PS_40_6, loss: 0.06405540555715561, avg_mse: 0.06178741529583931
current test mse: 0.061787
Iteration: 111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485749304294586, gen p mean: -0.08913338929414749, mean p set: 0.44905519485473633
The modified gen p mean: 0.4478321671485901, gen p mean: -0.09707827866077423, mean p set: 0.4483124613761902
loss_pred:0.06307700276374817, decouple_loss:0.05403977259993553
loss_pred:0.056285008788108826, decouple_loss:0.05056121200323105
The modified gen p mean: 0.44944050908088684, gen p mean: -0.08972416073083878, mean p set: 0.44992080330848694
loss_pred:0.061103589832782745, decouple_loss:0.05127602815628052
Iteration: 112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849705696105957, gen p mean: -0.08956734091043472, mean p set: 0.44897738099098206
The modified gen p mean: 0.4481826424598694, gen p mean: -0.08406375348567963, mean p set: 0.44866296648979187
The modified gen p mean: 0.44881996512413025, gen p mean: -0.08503082394599915, mean p set: 0.44930025935173035
loss_pred:0.06169819086790085, decouple_loss:0.05139579251408577
loss_pred:0.06301258504390717, decouple_loss:0.05339832603931427
loss_pred:0.06240842863917351, decouple_loss:0.05015715956687927
Iteration: 113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793662428855896, gen p mean: -0.09285567700862885, mean p set: 0.44841691851615906
The modified gen p mean: 0.44808340072631836, gen p mean: -0.09383991360664368, mean p set: 0.44856372475624084
The modified gen p mean: 0.4494444727897644, gen p mean: -0.0962240993976593, mean p set: 0.4499247372150421
loss_pred:0.05525524541735649, decouple_loss:0.04973112791776657
loss_pred:0.05888659134507179, decouple_loss:0.05377637967467308
loss_pred:0.05973724648356438, decouple_loss:0.05015118792653084
Iteration: 114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487764537334442, gen p mean: -0.09194525331258774, mean p set: 0.4492567181587219
The modified gen p mean: 0.44784510135650635, gen p mean: -0.09422006458044052, mean p set: 0.44832542538642883
The modified gen p mean: 0.4473377764225006, gen p mean: -0.09403576701879501, mean p set: 0.4478180706501007
loss_pred:0.05896679684519768, decouple_loss:0.05107501521706581
loss_pred:0.06017578765749931, decouple_loss:0.05284283682703972
loss_pred:0.06132575497031212, decouple_loss:0.05065317824482918
Iteration: 115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484025537967682, gen p mean: -0.09836240112781525, mean p set: 0.4488828480243683
The modified gen p mean: 0.4476868510246277, gen p mean: -0.10777553170919418, mean p set: 0.4481671154499054
The modified gen p mean: 0.4483506977558136, gen p mean: -0.09992241114377975, mean p set: 0.4488309919834137
loss_pred:0.06100717931985855, decouple_loss:0.051778316497802734
loss_pred:0.06082644686102867, decouple_loss:0.04848495125770569
loss_pred:0.061152320355176926, decouple_loss:0.0501040481030941
Iteration: 116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486697316169739, gen p mean: -0.1005568876862526, mean p set: 0.449150025844574
The modified gen p mean: 0.44782355427742004, gen p mean: -0.10383312404155731, mean p set: 0.44830384850502014
The modified gen p mean: 0.4477083086967468, gen p mean: -0.09952222555875778, mean p set: 0.4481886029243469
loss_pred:0.06197873130440712, decouple_loss:0.049566544592380524
loss_pred:0.05513367801904678, decouple_loss:0.04800980165600777
loss_pred:0.05549116060137749, decouple_loss:0.04897968843579292
Iteration: 117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492274522781372, gen p mean: -0.1047198623418808, mean p set: 0.4497077465057373
The modified gen p mean: 0.44923079013824463, gen p mean: -0.09987121820449829, mean p set: 0.44971105456352234
The modified gen p mean: 0.44971179962158203, gen p mean: -0.09868479520082474, mean p set: 0.45019209384918213
loss_pred:0.05956120789051056, decouple_loss:0.0498984269797802
loss_pred:0.05940435454249382, decouple_loss:0.05010285973548889
loss_pred:0.06000871583819389, decouple_loss:0.0494026280939579
Iteration: 118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835829734802246, gen p mean: -0.09497169405221939, mean p set: 0.44883859157562256
The modified gen p mean: 0.4471559226512909, gen p mean: -0.09278614819049835, mean p set: 0.4476362466812134
The modified gen p mean: 0.448161780834198, gen p mean: -0.09366274625062943, mean p set: 0.4486420452594757
loss_pred:0.06177439168095589, decouple_loss:0.04802626743912697
loss_pred:0.06113588809967041, decouple_loss:0.04879468306899071
loss_pred:0.059170473366975784, decouple_loss:0.04777860268950462
Iteration: 119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448650598526001, gen p mean: -0.09835801273584366, mean p set: 0.44913092255592346
The modified gen p mean: 0.44877612590789795, gen p mean: -0.10238984227180481, mean p set: 0.44925642013549805
The modified gen p mean: 0.4501950442790985, gen p mean: -0.10726077109575272, mean p set: 0.4506753385066986
loss_pred:0.05882291495800018, decouple_loss:0.04956243932247162
loss_pred:0.05773143470287323, decouple_loss:0.048240914940834045
loss_pred:0.06102745980024338, decouple_loss:0.04963085427880287
Iteration: 120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480856657028198, gen p mean: -0.09928824752569199, mean p set: 0.4485659599304199
The modified gen p mean: 0.44945159554481506, gen p mean: -0.10168828070163727, mean p set: 0.44993188977241516
The modified gen p mean: 0.44852012395858765, gen p mean: -0.10761378705501556, mean p set: 0.44900044798851013
loss_pred:0.05808509513735771, decouple_loss:0.048101481050252914
loss_pred:0.05832313001155853, decouple_loss:0.04904742166399956
loss_pred:0.05944102630019188, decouple_loss:0.04948704317212105
2023-05-02 14:54:32 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.09529390186071396, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.09757508337497711, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.09762457013130188, mean p set: 0.45035696029663086
loss_pred:0.059967245906591415, decouple_loss:0.04779912158846855
loss_pred:0.05806920677423477, decouple_loss:0.04793105274438858loss_pred:0.05912959948182106, decouple_loss:0.047298889607191086
WV_0_PC_1_EH_0_PS_40_6, loss: 0.06143916770815849, avg_mse: 0.059639301151037216
current test mse: 0.059639
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
NaN value num: 0
Iteration: 121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464642107486725, gen p mean: -0.09854752570390701, mean p set: 0.4469445049762726
The modified gen p mean: 0.44699329137802124, gen p mean: -0.0965774804353714, mean p set: 0.44747358560562134
loss_pred:0.06225765869021416, decouple_loss:0.050075821578502655
loss_pred:0.06328893452882767, decouple_loss:0.050661444664001465
The modified gen p mean: 0.44698628783226013, gen p mean: -0.0913415253162384, mean p set: 0.44746658205986023
loss_pred:0.06359004229307175, decouple_loss:0.05286850035190582
Iteration: 122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460988938808441, gen p mean: -0.08625292032957077, mean p set: 0.4465792179107666
The modified gen p mean: 0.4465689957141876, gen p mean: -0.0837816521525383, mean p set: 0.44704926013946533
The modified gen p mean: 0.44867148995399475, gen p mean: -0.08986614644527435, mean p set: 0.44915181398391724
loss_pred:0.05904477834701538, decouple_loss:0.052121032029390335
loss_pred:0.06067097559571266, decouple_loss:0.05140375345945358
loss_pred:0.06218884140253067, decouple_loss:0.048912715166807175
Iteration: 123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470379650592804, gen p mean: -0.09089011698961258, mean p set: 0.4475182592868805
The modified gen p mean: 0.4469752311706543, gen p mean: -0.09280241280794144, mean p set: 0.4474555552005768
The modified gen p mean: 0.447870135307312, gen p mean: -0.08980030566453934, mean p set: 0.4483503997325897
loss_pred:0.06024758517742157, decouple_loss:0.05188177153468132
loss_pred:0.05949799343943596, decouple_loss:0.05170725658535957
loss_pred:0.05851035192608833, decouple_loss:0.04910234361886978
Iteration: 124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473395347595215, gen p mean: -0.09736758470535278, mean p set: 0.4478198289871216
The modified gen p mean: 0.4478020966053009, gen p mean: -0.09863674640655518, mean p set: 0.4482823610305786
The modified gen p mean: 0.44741547107696533, gen p mean: -0.09824717044830322, mean p set: 0.44789573550224304
loss_pred:0.057682499289512634, decouple_loss:0.05037086457014084
loss_pred:0.05910298228263855, decouple_loss:0.05039924383163452
loss_pred:0.06153964251279831, decouple_loss:0.050601039081811905
Iteration: 125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686761498451233, gen p mean: -0.09069965779781342, mean p set: 0.4473479390144348
The modified gen p mean: 0.44770678877830505, gen p mean: -0.09787216037511826, mean p set: 0.44818708300590515
The modified gen p mean: 0.44780200719833374, gen p mean: -0.09554515033960342, mean p set: 0.44828227162361145
loss_pred:0.06236370652914047, decouple_loss:0.05359113588929176
loss_pred:0.058789417147636414, decouple_loss:0.052974894642829895
loss_pred:0.06003890931606293, decouple_loss:0.05532652884721756
Iteration: 126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476068615913391, gen p mean: -0.09531964361667633, mean p set: 0.4480871260166168
The modified gen p mean: 0.4456179440021515, gen p mean: -0.0945877879858017, mean p set: 0.446098268032074
The modified gen p mean: 0.4473837912082672, gen p mean: -0.09233994781970978, mean p set: 0.4478640854358673
loss_pred:0.059982988983392715, decouple_loss:0.05270349979400635
loss_pred:0.0579005666077137, decouple_loss:0.05119607597589493
loss_pred:0.059365253895521164, decouple_loss:0.05044380947947502
Iteration: 127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794201850891113, gen p mean: -0.08708544820547104, mean p set: 0.44842231273651123
The modified gen p mean: 0.4459565281867981, gen p mean: -0.08605226129293442, mean p set: 0.4464368224143982
The modified gen p mean: 0.4456440508365631, gen p mean: -0.08502811938524246, mean p set: 0.4461243748664856
loss_pred:0.061083026230335236, decouple_loss:0.052092403173446655
loss_pred:0.059370897710323334, decouple_loss:0.05113201588392258
loss_pred:0.057404592633247375, decouple_loss:0.05073923245072365
Iteration: 128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469386339187622, gen p mean: -0.09016095846891403, mean p set: 0.4474189281463623
The modified gen p mean: 0.44791150093078613, gen p mean: -0.08435437083244324, mean p set: 0.44839179515838623
The modified gen p mean: 0.44781431555747986, gen p mean: -0.08149807900190353, mean p set: 0.44829463958740234
loss_pred:0.05683945491909981, decouple_loss:0.05173191800713539
loss_pred:0.060017019510269165, decouple_loss:0.05129893869161606
loss_pred:0.05865834653377533, decouple_loss:0.052557848393917084
Iteration: 129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471263587474823, gen p mean: -0.08609271049499512, mean p set: 0.4476066827774048
The modified gen p mean: 0.4470158815383911, gen p mean: -0.0875696986913681, mean p set: 0.4474962055683136
The modified gen p mean: 0.44674113392829895, gen p mean: -0.0839906632900238, mean p set: 0.44722142815589905
loss_pred:0.05885467305779457, decouple_loss:0.05000084266066551
loss_pred:0.05794430524110794, decouple_loss:0.04967062920331955
loss_pred:0.06107171252369881, decouple_loss:0.04939432069659233
Iteration: 130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728416204452515, gen p mean: -0.09275837987661362, mean p set: 0.44776445627212524
The modified gen p mean: 0.4476120173931122, gen p mean: -0.09779780358076096, mean p set: 0.4480923116207123
The modified gen p mean: 0.44800689816474915, gen p mean: -0.09625635296106339, mean p set: 0.44848719239234924
loss_pred:0.059173256158828735, decouple_loss:0.050299130380153656
loss_pred:0.05945107340812683, decouple_loss:0.05069945752620697
loss_pred:0.058489490300416946, decouple_loss:0.04971114546060562
2023-05-02 14:58:52 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.10010714828968048, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.09897639602422714, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.10252843797206879, mean p set: 0.45035696029663086
loss_pred:0.05863487347960472, decouple_loss:0.048482827842235565
loss_pred:0.05927249789237976, decouple_loss:0.049440983682870865
loss_pred:0.057056866586208344, decouple_loss:0.04955627769231796
WV_0_PC_1_EH_0_PS_40_6, loss: 0.06077941507101059, avg_mse: 0.059226199984550476
current test mse: 0.059226
Iteration: 131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472595155239105, gen p mean: -0.10131987929344177, mean p set: 0.4477398097515106
loss_pred:0.05936422199010849, decouple_loss:0.04896116629242897
The modified gen p mean: 0.44687533378601074, gen p mean: -0.09879342466592789, mean p set: 0.44735562801361084
loss_pred:0.056908369064331055, decouple_loss:0.04787518084049225
The modified gen p mean: 0.44737508893013, gen p mean: -0.09820427745580673, mean p set: 0.4478553533554077
loss_pred:0.0618930384516716, decouple_loss:0.05302021652460098
Iteration: 132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464389681816101, gen p mean: -0.09355158358812332, mean p set: 0.4469192922115326
The modified gen p mean: 0.44611313939094543, gen p mean: -0.09513053297996521, mean p set: 0.4465934634208679
The modified gen p mean: 0.4479556679725647, gen p mean: -0.09464618563652039, mean p set: 0.4484359920024872
loss_pred:0.059530943632125854, decouple_loss:0.04943674057722092
loss_pred:0.05561848357319832, decouple_loss:0.04855950176715851
loss_pred:0.05818283185362816, decouple_loss:0.05052110552787781
Iteration: 133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454882740974426, gen p mean: -0.08528637886047363, mean p set: 0.4459685981273651
The modified gen p mean: 0.44801342487335205, gen p mean: -0.08531972765922546, mean p set: 0.44849371910095215
The modified gen p mean: 0.4461911618709564, gen p mean: -0.08903293311595917, mean p set: 0.4466714859008789
loss_pred:0.05651341378688812, decouple_loss:0.05019305273890495
loss_pred:0.05882520601153374, decouple_loss:0.048770029097795486
loss_pred:0.05962745472788811, decouple_loss:0.04912690073251724
Iteration: 134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815319776535034, gen p mean: -0.08275987207889557, mean p set: 0.44863349199295044
The modified gen p mean: 0.44664090871810913, gen p mean: -0.0855448842048645, mean p set: 0.44712120294570923
The modified gen p mean: 0.4473097324371338, gen p mean: -0.08430029451847076, mean p set: 0.4477900266647339
loss_pred:0.05613773688673973, decouple_loss:0.048677992075681686
loss_pred:0.05798825994133949, decouple_loss:0.05004451051354408
loss_pred:0.05774541199207306, decouple_loss:0.04940590262413025
Iteration: 135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464631974697113, gen p mean: -0.08508853614330292, mean p set: 0.4469434916973114
The modified gen p mean: 0.44826653599739075, gen p mean: -0.0889715701341629, mean p set: 0.44874683022499084
The modified gen p mean: 0.4471037983894348, gen p mean: -0.0863836258649826, mean p set: 0.4475840926170349
loss_pred:0.05697264522314072, decouple_loss:0.048053305596113205
loss_pred:0.056925978511571884, decouple_loss:0.0488206222653389
loss_pred:0.057598765939474106, decouple_loss:0.04833085462450981
Iteration: 136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44809529185295105, gen p mean: -0.09582167863845825, mean p set: 0.44857561588287354
The modified gen p mean: 0.4467330873012543, gen p mean: -0.09768201410770416, mean p set: 0.44721341133117676
The modified gen p mean: 0.446698933839798, gen p mean: -0.09452225267887115, mean p set: 0.44717922806739807
loss_pred:0.05838899686932564, decouple_loss:0.04768051952123642
loss_pred:0.05819164961576462, decouple_loss:0.046843111515045166
loss_pred:0.056918445974588394, decouple_loss:0.046713151037693024
Iteration: 137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460814893245697, gen p mean: -0.09482182562351227, mean p set: 0.4465617835521698
The modified gen p mean: 0.4477015435695648, gen p mean: -0.0945659652352333, mean p set: 0.4481818377971649
The modified gen p mean: 0.4477238059043884, gen p mean: -0.09264394640922546, mean p set: 0.4482041299343109
loss_pred:0.0545516274869442, decouple_loss:0.04591233283281326
loss_pred:0.05722201243042946, decouple_loss:0.04729544743895531
loss_pred:0.05643767863512039, decouple_loss:0.048034634441137314
Iteration: 138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462970495223999, gen p mean: -0.0901094302535057, mean p set: 0.44677734375
The modified gen p mean: 0.4463730454444885, gen p mean: -0.09186771512031555, mean p set: 0.446853369474411
The modified gen p mean: 0.4478500783443451, gen p mean: -0.09157245606184006, mean p set: 0.4483303725719452
loss_pred:0.05625166371464729, decouple_loss:0.04947774112224579
loss_pred:0.05758119747042656, decouple_loss:0.049148011952638626
loss_pred:0.05777272954583168, decouple_loss:0.04693126678466797
Iteration: 139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44726109504699707, gen p mean: -0.08838409930467606, mean p set: 0.44774138927459717
The modified gen p mean: 0.44642043113708496, gen p mean: -0.0948622077703476, mean p set: 0.44690072536468506
The modified gen p mean: 0.4484342336654663, gen p mean: -0.09373398870229721, mean p set: 0.448914498090744
loss_pred:0.056333594024181366, decouple_loss:0.04905663803219795
loss_pred:0.05750825256109238, decouple_loss:0.04806874319911003
loss_pred:0.058201491832733154, decouple_loss:0.047914519906044006
Iteration: 140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44679510593414307, gen p mean: -0.10264234244823456, mean p set: 0.44727540016174316
The modified gen p mean: 0.4464874863624573, gen p mean: -0.09645701199769974, mean p set: 0.4469677805900574
The modified gen p mean: 0.44695407152175903, gen p mean: -0.1011832058429718, mean p set: 0.44743436574935913
loss_pred:0.05679326504468918, decouple_loss:0.04693761467933655
loss_pred:0.054967716336250305, decouple_loss:0.0470566488802433
loss_pred:0.05566134676337242, decouple_loss:0.04670058563351631
2023-05-02 15:02:36 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.10415543615818024, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.10210330784320831, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.10746265947818756, mean p set: 0.45035696029663086
loss_pred:0.05679650604724884, decouple_loss:0.048091452568769455
loss_pred:0.05802042409777641, decouple_loss:0.047814346849918365
loss_pred:0.055455587804317474, decouple_loss:0.048286762088537216
WV_0_PC_1_EH_0_PS_40_6, loss: 0.05916071683168411, avg_mse: 0.05773360654711723
current test mse: 0.057734
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977760314941406, gen p mean: -0.10644415020942688, mean p set: 0.45025789737701416
The modified gen p mean: 0.4477500021457672, gen p mean: -0.10558824241161346, mean p set: 0.4482302665710449
loss_pred:0.06109854206442833, decouple_loss:0.05062658339738846
loss_pred:0.05469632148742676, decouple_loss:0.04837922751903534
The modified gen p mean: 0.44713103771209717, gen p mean: -0.10123421251773834, mean p set: 0.44761136174201965
loss_pred:0.054619040340185165, decouple_loss:0.04754788801074028
Iteration: 142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467870593070984, gen p mean: -0.10467184334993362, mean p set: 0.4472673535346985
The modified gen p mean: 0.44851401448249817, gen p mean: -0.10886695981025696, mean p set: 0.4489942789077759
The modified gen p mean: 0.4479721784591675, gen p mean: -0.10347681492567062, mean p set: 0.4484524726867676
loss_pred:0.0561755932867527, decouple_loss:0.0495598129928112
loss_pred:0.05833018198609352, decouple_loss:0.051470592617988586
loss_pred:0.056330788880586624, decouple_loss:0.04910841956734657
Iteration: 143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751372933387756, gen p mean: -0.10285326093435287, mean p set: 0.4479939937591553
The modified gen p mean: 0.4472024440765381, gen p mean: -0.10123242437839508, mean p set: 0.4476827085018158
The modified gen p mean: 0.4469769597053528, gen p mean: -0.09927096217870712, mean p set: 0.4474572539329529
loss_pred:0.05647153779864311, decouple_loss:0.0488654226064682
loss_pred:0.054810021072626114, decouple_loss:0.04834343120455742
loss_pred:0.05619257688522339, decouple_loss:0.048653412610292435
Iteration: 144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762831926345825, gen p mean: -0.09588222205638885, mean p set: 0.44810861349105835
The modified gen p mean: 0.447916179895401, gen p mean: -0.10245609283447266, mean p set: 0.4483965039253235
The modified gen p mean: 0.4472668468952179, gen p mean: -0.09681183099746704, mean p set: 0.447747141122818
loss_pred:0.056471534073352814, decouple_loss:0.047902822494506836
loss_pred:0.05564248561859131, decouple_loss:0.04847569018602371
loss_pred:0.05367877706885338, decouple_loss:0.04718441888689995
Iteration: 145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486221969127655, gen p mean: -0.09632956236600876, mean p set: 0.4491024613380432
The modified gen p mean: 0.4469151496887207, gen p mean: -0.09578020870685577, mean p set: 0.4473954439163208
The modified gen p mean: 0.44811391830444336, gen p mean: -0.09823659807443619, mean p set: 0.44859424233436584
loss_pred:0.05633189156651497, decouple_loss:0.046564556658267975
loss_pred:0.058433979749679565, decouple_loss:0.04619565233588219
loss_pred:0.05612904950976372, decouple_loss:0.04725635051727295
Iteration: 146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793081283569336, gen p mean: -0.09141119569540024, mean p set: 0.44841110706329346
The modified gen p mean: 0.4471588730812073, gen p mean: -0.09976132214069366, mean p set: 0.4476391673088074
The modified gen p mean: 0.44781965017318726, gen p mean: -0.09497702121734619, mean p set: 0.44829997420310974
loss_pred:0.05749361962080002, decouple_loss:0.04704460874199867
loss_pred:0.055784761905670166, decouple_loss:0.04632669687271118
loss_pred:0.056765347719192505, decouple_loss:0.04698951914906502
Iteration: 147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44687357544898987, gen p mean: -0.10552948713302612, mean p set: 0.44735386967658997
The modified gen p mean: 0.4466054141521454, gen p mean: -0.10501682013273239, mean p set: 0.4470857083797455
The modified gen p mean: 0.4484352171421051, gen p mean: -0.10789541155099869, mean p set: 0.4489155113697052
loss_pred:0.05690405145287514, decouple_loss:0.04786880686879158
loss_pred:0.056311823427677155, decouple_loss:0.047227319329977036
loss_pred:0.05652216821908951, decouple_loss:0.04797062650322914
Iteration: 148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475749433040619, gen p mean: -0.10528051108121872, mean p set: 0.4480552673339844
The modified gen p mean: 0.4480445683002472, gen p mean: -0.10820568352937698, mean p set: 0.4485248327255249
The modified gen p mean: 0.4473857879638672, gen p mean: -0.10544861108064651, mean p set: 0.4478660821914673
loss_pred:0.05563967302441597, decouple_loss:0.046694524586200714
loss_pred:0.05253978446125984, decouple_loss:0.046203214675188065
loss_pred:0.055860329419374466, decouple_loss:0.04630079120397568
Iteration: 149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743579626083374, gen p mean: -0.10382076352834702, mean p set: 0.44791606068611145
The modified gen p mean: 0.44778189063072205, gen p mean: -0.10508834570646286, mean p set: 0.44826218485832214
The modified gen p mean: 0.44767674803733826, gen p mean: -0.10246328264474869, mean p set: 0.44815701246261597
loss_pred:0.05500822514295578, decouple_loss:0.04585694894194603
loss_pred:0.0556877963244915, decouple_loss:0.046401362866163254
loss_pred:0.05606573820114136, decouple_loss:0.04642210900783539
Iteration: 150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477563798427582, gen p mean: -0.10398616641759872, mean p set: 0.4482366442680359
The modified gen p mean: 0.4476199746131897, gen p mean: -0.09940759092569351, mean p set: 0.4481002688407898
The modified gen p mean: 0.4473644196987152, gen p mean: -0.09924360364675522, mean p set: 0.4478446841239929
loss_pred:0.05343274399638176, decouple_loss:0.04503925144672394
loss_pred:0.05672367662191391, decouple_loss:0.047341927886009216
loss_pred:0.053865209221839905, decouple_loss:0.04566478729248047
2023-05-02 15:07:03 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0965195894241333, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.09591899067163467, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.09849411994218826, mean p set: 0.45035696029663086
loss_pred:0.055243149399757385, decouple_loss:0.04579916223883629
loss_pred:0.0567869134247303, decouple_loss:0.04718567803502083
loss_pred:0.053915247321128845, decouple_loss:0.04584560915827751
WV_0_PC_1_EH_0_PS_40_6, loss: 0.05762894079089165, avg_mse: 0.05628512427210808
current test mse: 0.056285
Iteration: 151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44692471623420715, gen p mean: -0.09538915008306503, mean p set: 0.44740498065948486
loss_pred:0.05305637791752815, decouple_loss:0.045240551233291626
The modified gen p mean: 0.44617441296577454, gen p mean: -0.09354668110609055, mean p set: 0.44665467739105225
loss_pred:0.053975239396095276, decouple_loss:0.04536375030875206
The modified gen p mean: 0.44948098063468933, gen p mean: -0.099901482462883, mean p set: 0.4499613046646118
loss_pred:0.05875948444008827, decouple_loss:0.0477471649646759
Iteration: 152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449179083108902, gen p mean: -0.09656360745429993, mean p set: 0.4496593773365021
The modified gen p mean: 0.44828876852989197, gen p mean: -0.1015985980629921, mean p set: 0.44876906275749207
The modified gen p mean: 0.44668376445770264, gen p mean: -0.09412171691656113, mean p set: 0.44716405868530273
loss_pred:0.056599803268909454, decouple_loss:0.04690324515104294
loss_pred:0.052943892776966095, decouple_loss:0.046462588012218475
loss_pred:0.051917482167482376, decouple_loss:0.044541019946336746
Iteration: 153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44826120138168335, gen p mean: -0.10281018912792206, mean p set: 0.44874149560928345
The modified gen p mean: 0.44797995686531067, gen p mean: -0.10503295809030533, mean p set: 0.44846025109291077
The modified gen p mean: 0.44798722863197327, gen p mean: -0.10829954594373703, mean p set: 0.44846752285957336
loss_pred:0.05195557698607445, decouple_loss:0.044332683086395264
loss_pred:0.051047127693891525, decouple_loss:0.04477684572339058
loss_pred:0.052047550678253174, decouple_loss:0.045331865549087524
Iteration: 154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448159396648407, gen p mean: -0.11020521819591522, mean p set: 0.4486396908760071
The modified gen p mean: 0.44645360112190247, gen p mean: -0.10401193797588348, mean p set: 0.44693389534950256
The modified gen p mean: 0.44643887877464294, gen p mean: -0.1095428466796875, mean p set: 0.44691917300224304
loss_pred:0.054845310747623444, decouple_loss:0.04638573154807091
loss_pred:0.052154865115880966, decouple_loss:0.04469405487179756
loss_pred:0.054278142750263214, decouple_loss:0.04533654451370239
Iteration: 155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44934898614883423, gen p mean: -0.10784837603569031, mean p set: 0.4498293101787567
The modified gen p mean: 0.44847428798675537, gen p mean: -0.10942260921001434, mean p set: 0.44895458221435547
The modified gen p mean: 0.4479027986526489, gen p mean: -0.10408974438905716, mean p set: 0.4483831226825714
loss_pred:0.05535285919904709, decouple_loss:0.04608568921685219
loss_pred:0.05324237048625946, decouple_loss:0.043485384434461594
loss_pred:0.054742131382226944, decouple_loss:0.04373800382018089
Iteration: 156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483543634414673, gen p mean: -0.10953851044178009, mean p set: 0.4488346576690674
The modified gen p mean: 0.44765833020210266, gen p mean: -0.10748570412397385, mean p set: 0.44813862442970276
The modified gen p mean: 0.44690242409706116, gen p mean: -0.1035478413105011, mean p set: 0.44738268852233887
loss_pred:0.055194929242134094, decouple_loss:0.045105308294296265
loss_pred:0.05432399734854698, decouple_loss:0.04488065838813782
loss_pred:0.054106827825307846, decouple_loss:0.04472605884075165
Iteration: 157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482094943523407, gen p mean: -0.11001905798912048, mean p set: 0.4486897885799408
The modified gen p mean: 0.4483236074447632, gen p mean: -0.1095566600561142, mean p set: 0.4488039016723633
The modified gen p mean: 0.4472697973251343, gen p mean: -0.1066969558596611, mean p set: 0.4477500915527344
loss_pred:0.05481705069541931, decouple_loss:0.043340496718883514
loss_pred:0.05095445737242699, decouple_loss:0.042171064764261246
loss_pred:0.05447706952691078, decouple_loss:0.04369566589593887
Iteration: 158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44857507944107056, gen p mean: -0.10961396247148514, mean p set: 0.44905540347099304
The modified gen p mean: 0.44810476899147034, gen p mean: -0.11469151079654694, mean p set: 0.4485850930213928
The modified gen p mean: 0.4479478597640991, gen p mean: -0.10875578969717026, mean p set: 0.4484281837940216
loss_pred:0.05031168460845947, decouple_loss:0.0437544621527195
loss_pred:0.055999476462602615, decouple_loss:0.04508579894900322
loss_pred:0.055078212171792984, decouple_loss:0.044259075075387955
Iteration: 159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900399446487427, gen p mean: -0.10981956124305725, mean p set: 0.449484258890152
The modified gen p mean: 0.44802576303482056, gen p mean: -0.10763543099164963, mean p set: 0.44850608706474304
The modified gen p mean: 0.44779497385025024, gen p mean: -0.10667690634727478, mean p set: 0.44827526807785034
loss_pred:0.053239185363054276, decouple_loss:0.04587775096297264
loss_pred:0.051328323781490326, decouple_loss:0.043539006263017654
loss_pred:0.05287675932049751, decouple_loss:0.04420512914657593
Iteration: 160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489873945713043, gen p mean: -0.10866338014602661, mean p set: 0.4494676887989044
The modified gen p mean: 0.4483950734138489, gen p mean: -0.11087542772293091, mean p set: 0.448875367641449
The modified gen p mean: 0.4468684494495392, gen p mean: -0.10917490720748901, mean p set: 0.4473487436771393
loss_pred:0.056764326989650726, decouple_loss:0.04465243220329285
loss_pred:0.05597268044948578, decouple_loss:0.04508158192038536
loss_pred:0.053735487163066864, decouple_loss:0.043816111981868744
2023-05-02 15:10:45 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.11317335069179535, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.11182859539985657, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.11373510211706161, mean p set: 0.45035696029663086
loss_pred:0.05444946885108948, decouple_loss:0.04389002174139023
loss_pred:0.05610238388180733, decouple_loss:0.04512332007288933
loss_pred:0.05309802293777466, decouple_loss:0.04398752748966217
WV_0_PC_1_EH_0_PS_40_6, loss: 0.05676664039492607, avg_mse: 0.055841151624917984
current test mse: 0.055841
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497874081134796, gen p mean: -0.11441806703805923, mean p set: 0.4502677023410797
loss_pred:0.05552468076348305, decouple_loss:0.04432995244860649
The modified gen p mean: 0.44803234934806824, gen p mean: -0.11067146807909012, mean p set: 0.44851261377334595
loss_pred:0.05504731088876724, decouple_loss:0.04512343555688858
The modified gen p mean: 0.4490286111831665, gen p mean: -0.11236711591482162, mean p set: 0.4495089054107666
loss_pred:0.05773012712597847, decouple_loss:0.045130468904972076
Iteration: 162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860759377479553, gen p mean: -0.1197633296251297, mean p set: 0.44908788800239563
The modified gen p mean: 0.4494338631629944, gen p mean: -0.12034661322832108, mean p set: 0.44991418719291687
The modified gen p mean: 0.4488588571548462, gen p mean: -0.12121330946683884, mean p set: 0.4493391215801239
loss_pred:0.057226214557886124, decouple_loss:0.0474512055516243
loss_pred:0.057178497314453125, decouple_loss:0.046097397804260254
loss_pred:0.054087262600660324, decouple_loss:0.045961398631334305
Iteration: 163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498368203639984, gen p mean: -0.12030050158500671, mean p set: 0.4503171145915985
The modified gen p mean: 0.4489181935787201, gen p mean: -0.11777029186487198, mean p set: 0.4493984878063202
The modified gen p mean: 0.449203222990036, gen p mean: -0.12091194093227386, mean p set: 0.4496835172176361
loss_pred:0.05459281802177429, decouple_loss:0.04674249142408371
loss_pred:0.056067533791065216, decouple_loss:0.04528531804680824
loss_pred:0.05534677952528, decouple_loss:0.04559745267033577
Iteration: 164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496731460094452, gen p mean: -0.11255017668008804, mean p set: 0.4501534700393677
The modified gen p mean: 0.4501102566719055, gen p mean: -0.1099667027592659, mean p set: 0.4505905210971832
The modified gen p mean: 0.4485131502151489, gen p mean: -0.11516933143138885, mean p set: 0.448993444442749
loss_pred:0.05499944090843201, decouple_loss:0.04719742015004158
loss_pred:0.0549798384308815, decouple_loss:0.04686147719621658
loss_pred:0.055502574890851974, decouple_loss:0.04591287672519684
Iteration: 165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44903796911239624, gen p mean: -0.11803540587425232, mean p set: 0.4495182931423187
The modified gen p mean: 0.4492861032485962, gen p mean: -0.11383478343486786, mean p set: 0.4497663974761963
The modified gen p mean: 0.44948604702949524, gen p mean: -0.11692751199007034, mean p set: 0.44996631145477295
loss_pred:0.057545553892850876, decouple_loss:0.04561544954776764
loss_pred:0.05318720266222954, decouple_loss:0.04651958495378494
loss_pred:0.05546741187572479, decouple_loss:0.045130036771297455
Iteration: 166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836920499801636, gen p mean: -0.12468596547842026, mean p set: 0.44884949922561646
The modified gen p mean: 0.4497798681259155, gen p mean: -0.12240985035896301, mean p set: 0.45026013255119324
The modified gen p mean: 0.45018741488456726, gen p mean: -0.1224682629108429, mean p set: 0.45066767930984497
loss_pred:0.05420461297035217, decouple_loss:0.04510867968201637
loss_pred:0.05436241999268532, decouple_loss:0.046216439455747604
loss_pred:0.0555422380566597, decouple_loss:0.04651528596878052
Iteration: 167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45090633630752563, gen p mean: -0.11481796950101852, mean p set: 0.45138660073280334
The modified gen p mean: 0.4502295255661011, gen p mean: -0.11180580407381058, mean p set: 0.45070981979370117
The modified gen p mean: 0.4488268494606018, gen p mean: -0.11175162345170975, mean p set: 0.4493071436882019
loss_pred:0.0532526895403862, decouple_loss:0.04606354609131813
loss_pred:0.055722903460264206, decouple_loss:0.0471876785159111
loss_pred:0.055300645530223846, decouple_loss:0.04721054807305336
Iteration: 168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44874081015586853, gen p mean: -0.11596763879060745, mean p set: 0.449221134185791
The modified gen p mean: 0.4500034749507904, gen p mean: -0.10837052017450333, mean p set: 0.4504837691783905
The modified gen p mean: 0.44797298312187195, gen p mean: -0.10861700773239136, mean p set: 0.44845327734947205
loss_pred:0.05792776495218277, decouple_loss:0.04697902128100395
loss_pred:0.05455474182963371, decouple_loss:0.04624958336353302
loss_pred:0.05490715056657791, decouple_loss:0.046888452023267746
Iteration: 169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969242811203003, gen p mean: -0.1101372167468071, mean p set: 0.45017269253730774
The modified gen p mean: 0.44919705390930176, gen p mean: -0.1155470684170723, mean p set: 0.44967731833457947
The modified gen p mean: 0.4506630599498749, gen p mean: -0.11311639100313187, mean p set: 0.451143354177475
loss_pred:0.053675517439842224, decouple_loss:0.04600087180733681loss_pred:0.054229769855737686, decouple_loss:0.04473710060119629
loss_pred:0.05415920540690422, decouple_loss:0.04464847594499588
Iteration: 170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44965627789497375, gen p mean: -0.12057054787874222, mean p set: 0.45013657212257385
The modified gen p mean: 0.4491843283176422, gen p mean: -0.12036523967981339, mean p set: 0.4496645927429199
The modified gen p mean: 0.4483937621116638, gen p mean: -0.12274359166622162, mean p set: 0.4488740861415863
loss_pred:0.054541025310754776, decouple_loss:0.045231737196445465
loss_pred:0.05561045929789543, decouple_loss:0.04506777971982956
loss_pred:0.05255834758281708, decouple_loss:0.044680122286081314
2023-05-02 15:15:06 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.12424613535404205, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.12354359030723572, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.12313361465930939, mean p set: 0.45035696029663086
loss_pred:0.05406063050031662, decouple_loss:0.044910918921232224
loss_pred:0.05559556186199188, decouple_loss:0.045484837144613266
loss_pred:0.05273532122373581, decouple_loss:0.04553341865539551
WV_0_PC_1_EH_0_PS_40_6, loss: 0.056395988911390305, avg_mse: 0.055624209344387054
current test mse: 0.055624
Iteration: 171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480578601360321, gen p mean: -0.12307456135749817, mean p set: 0.4485381245613098
The modified gen p mean: 0.44926688075065613, gen p mean: -0.12431187182664871, mean p set: 0.4497471749782562
loss_pred:0.0552237331867218, decouple_loss:0.045043304562568665
loss_pred:0.05221382528543472, decouple_loss:0.045243002474308014
The modified gen p mean: 0.4501243233680725, gen p mean: -0.12316489219665527, mean p set: 0.4506046175956726
loss_pred:0.054024361073970795, decouple_loss:0.04579690098762512
Iteration: 172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493621289730072, gen p mean: -0.1276291459798813, mean p set: 0.4498424530029297
The modified gen p mean: 0.45082464814186096, gen p mean: -0.12207771837711334, mean p set: 0.45130491256713867
The modified gen p mean: 0.450296014547348, gen p mean: -0.12065068632364273, mean p set: 0.4507763385772705
loss_pred:0.053736526519060135, decouple_loss:0.04542795941233635
loss_pred:0.055232398211956024, decouple_loss:0.04529539868235588
loss_pred:0.055345188826322556, decouple_loss:0.04638676717877388
Iteration: 173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44947436451911926, gen p mean: -0.11561482399702072, mean p set: 0.44995465874671936
The modified gen p mean: 0.4503858983516693, gen p mean: -0.11370214074850082, mean p set: 0.4508661925792694
The modified gen p mean: 0.44893956184387207, gen p mean: -0.11473578959703445, mean p set: 0.4494198262691498
loss_pred:0.054998572915792465, decouple_loss:0.046103060245513916
loss_pred:0.05446230620145798, decouple_loss:0.04502004757523537
loss_pred:0.05358225107192993, decouple_loss:0.045015834271907806
Iteration: 174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501386880874634, gen p mean: -0.11628253757953644, mean p set: 0.4506189823150635
The modified gen p mean: 0.4492749869823456, gen p mean: -0.1149686723947525, mean p set: 0.4497552812099457
The modified gen p mean: 0.44765859842300415, gen p mean: -0.1167646050453186, mean p set: 0.44813892245292664
loss_pred:0.053414180874824524, decouple_loss:0.0453348308801651
loss_pred:0.05395704135298729, decouple_loss:0.04555482417345047
loss_pred:0.05571882054209709, decouple_loss:0.04593423753976822
Iteration: 175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492380917072296, gen p mean: -0.12646125257015228, mean p set: 0.4497183561325073
The modified gen p mean: 0.44886115193367004, gen p mean: -0.12411558628082275, mean p set: 0.44934147596359253
The modified gen p mean: 0.4496931731700897, gen p mean: -0.12544409930706024, mean p set: 0.4501734673976898
loss_pred:0.05469799414277077, decouple_loss:0.04586256295442581
loss_pred:0.05463665351271629, decouple_loss:0.04431772232055664
loss_pred:0.054161231964826584, decouple_loss:0.04488404095172882
Iteration: 176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44965094327926636, gen p mean: -0.12024606019258499, mean p set: 0.45013123750686646
The modified gen p mean: 0.44901031255722046, gen p mean: -0.12121735513210297, mean p set: 0.44949063658714294
The modified gen p mean: 0.44822654128074646, gen p mean: -0.1199541762471199, mean p set: 0.44870686531066895
loss_pred:0.05319595709443092, decouple_loss:0.04551076143980026
loss_pred:0.0515885055065155, decouple_loss:0.044383931905031204
loss_pred:0.05548429861664772, decouple_loss:0.04520479962229729
Iteration: 177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45080986618995667, gen p mean: -0.12804727256298065, mean p set: 0.45129016041755676
The modified gen p mean: 0.4492870569229126, gen p mean: -0.12485446035861969, mean p set: 0.4497673809528351
The modified gen p mean: 0.4491962790489197, gen p mean: -0.12491639703512192, mean p set: 0.4496765732765198
loss_pred:0.05382079631090164, decouple_loss:0.044090982526540756
loss_pred:0.05384400859475136, decouple_loss:0.045197196304798126
loss_pred:0.05351099371910095, decouple_loss:0.04401916265487671
Iteration: 178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44837287068367004, gen p mean: -0.12563909590244293, mean p set: 0.44885316491127014
The modified gen p mean: 0.4480297267436981, gen p mean: -0.12301921099424362, mean p set: 0.44850999116897583
The modified gen p mean: 0.44911807775497437, gen p mean: -0.12351147085428238, mean p set: 0.44959837198257446
loss_pred:0.05237387865781784, decouple_loss:0.045300133526325226
loss_pred:0.05544394254684448, decouple_loss:0.046379454433918
loss_pred:0.05348317697644234, decouple_loss:0.04406338557600975
Iteration: 179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45058590173721313, gen p mean: -0.117896169424057, mean p set: 0.45106619596481323
The modified gen p mean: 0.44858768582344055, gen p mean: -0.11632487922906876, mean p set: 0.44906798005104065
The modified gen p mean: 0.4484655559062958, gen p mean: -0.1181720644235611, mean p set: 0.4489458501338959
loss_pred:0.05186821147799492, decouple_loss:0.04461754858493805
loss_pred:0.05443660914897919, decouple_loss:0.04506172984838486
loss_pred:0.055162396281957626, decouple_loss:0.04681526869535446
Iteration: 180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492708444595337, gen p mean: -0.11707626283168793, mean p set: 0.4497511684894562
The modified gen p mean: 0.4500710964202881, gen p mean: -0.11849859356880188, mean p set: 0.4505513906478882
The modified gen p mean: 0.44863173365592957, gen p mean: -0.11753228306770325, mean p set: 0.4491119980812073
loss_pred:0.054363030940294266, decouple_loss:0.04798349365592003
loss_pred:0.05429463088512421, decouple_loss:0.04628367722034454
loss_pred:0.05557920038700104, decouple_loss:0.04765542596578598
2023-05-02 15:18:51 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.12407718598842621, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.12492568045854568, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.1258895993232727, mean p set: 0.45035696029663086
loss_pred:0.05308886989951134, decouple_loss:0.04461756721138954
loss_pred:0.05466990917921066, decouple_loss:0.04614438861608505
loss_pred:0.05195630341768265, decouple_loss:0.04550779610872269
WV_0_PC_1_EH_0_PS_40_6, loss: 0.0555095300078392, avg_mse: 0.054778166115283966
current test mse: 0.054778
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
NaN value num: 0
Iteration: 181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502740204334259, gen p mean: -0.11979479342699051, mean p set: 0.450754314661026
The modified gen p mean: 0.45142218470573425, gen p mean: -0.12311307340860367, mean p set: 0.45190247893333435
loss_pred:0.05910803750157356, decouple_loss:0.05100492760539055
loss_pred:0.059964556246995926, decouple_loss:0.05149972438812256
The modified gen p mean: 0.44963276386260986, gen p mean: -0.1196870431303978, mean p set: 0.4501130282878876
loss_pred:0.05677277222275734, decouple_loss:0.04920133203268051
Iteration: 182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492155909538269, gen p mean: -0.1311240941286087, mean p set: 0.4496959447860718
The modified gen p mean: 0.4496156871318817, gen p mean: -0.12745116651058197, mean p set: 0.4500959813594818
The modified gen p mean: 0.44968053698539734, gen p mean: -0.13274246454238892, mean p set: 0.45016080141067505
loss_pred:0.057888925075531006, decouple_loss:0.04800231382250786
loss_pred:0.05620335787534714, decouple_loss:0.04978964850306511
loss_pred:0.056124843657016754, decouple_loss:0.04847072809934616
Iteration: 183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481066167354584, gen p mean: -0.12770909070968628, mean p set: 0.44858694076538086
The modified gen p mean: 0.44803759455680847, gen p mean: -0.13025566935539246, mean p set: 0.4485178589820862
The modified gen p mean: 0.45207497477531433, gen p mean: -0.12989367544651031, mean p set: 0.45255526900291443
loss_pred:0.05682668089866638, decouple_loss:0.04902419447898865
loss_pred:0.055557847023010254, decouple_loss:0.047414448112249374
loss_pred:0.058588236570358276, decouple_loss:0.05021531879901886
Iteration: 184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44903576374053955, gen p mean: -0.12470728158950806, mean p set: 0.4495159983634949
The modified gen p mean: 0.4489773213863373, gen p mean: -0.12621690332889557, mean p set: 0.449457585811615
The modified gen p mean: 0.4505566358566284, gen p mean: -0.12225659191608429, mean p set: 0.4510369300842285
loss_pred:0.056237153708934784, decouple_loss:0.048307329416275024
loss_pred:0.05585314333438873, decouple_loss:0.048659440129995346
loss_pred:0.05593567714095116, decouple_loss:0.049558766186237335
Iteration: 185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45172709226608276, gen p mean: -0.11999625712633133, mean p set: 0.45220738649368286
The modified gen p mean: 0.4486214816570282, gen p mean: -0.12260334193706512, mean p set: 0.4491018056869507
The modified gen p mean: 0.4495059549808502, gen p mean: -0.11969514936208725, mean p set: 0.4499862790107727
loss_pred:0.05756901577115059, decouple_loss:0.04874185100197792
loss_pred:0.05587846040725708, decouple_loss:0.04785580933094025
loss_pred:0.056101735681295395, decouple_loss:0.0491095632314682
Iteration: 186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44998836517333984, gen p mean: -0.11301634460687637, mean p set: 0.45046865940093994
The modified gen p mean: 0.44862550497055054, gen p mean: -0.10890669375658035, mean p set: 0.44910579919815063
The modified gen p mean: 0.4492329955101013, gen p mean: -0.11614295840263367, mean p set: 0.4497132897377014
loss_pred:0.05475549399852753, decouple_loss:0.0483379065990448
loss_pred:0.0548676997423172, decouple_loss:0.04789409413933754
loss_pred:0.056562863290309906, decouple_loss:0.04835567623376846
Iteration: 187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495774805545807, gen p mean: -0.12016165256500244, mean p set: 0.4500577449798584
The modified gen p mean: 0.4497734308242798, gen p mean: -0.12257366627454758, mean p set: 0.4502537250518799
The modified gen p mean: 0.4502841830253601, gen p mean: -0.12116958200931549, mean p set: 0.4507644772529602
loss_pred:0.05487888306379318, decouple_loss:0.04794364050030708
loss_pred:0.055058062076568604, decouple_loss:0.047948870807886124
loss_pred:0.05760494992136955, decouple_loss:0.047870147973299026
Iteration: 188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489953815937042, gen p mean: -0.13370594382286072, mean p set: 0.4494756758213043The modified gen p mean: 0.44944414496421814, gen p mean: -0.13358768820762634, mean p set: 0.44992440938949585
The modified gen p mean: 0.4498112201690674, gen p mean: -0.1325392723083496, mean p set: 0.4502915143966675
loss_pred:0.05545197054743767, decouple_loss:0.047981906682252884
loss_pred:0.05491572991013527, decouple_loss:0.04828467592597008
loss_pred:0.053900159895420074, decouple_loss:0.04801445081830025
Iteration: 189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44978153705596924, gen p mean: -0.13685692846775055, mean p set: 0.45026183128356934
The modified gen p mean: 0.4504542648792267, gen p mean: -0.14065492153167725, mean p set: 0.45093461871147156
The modified gen p mean: 0.44956380128860474, gen p mean: -0.13997000455856323, mean p set: 0.4500441253185272
loss_pred:0.05457498878240585, decouple_loss:0.04743577912449837
loss_pred:0.05446590110659599, decouple_loss:0.04698183387517929
loss_pred:0.05606105178594589, decouple_loss:0.0473187081515789
Iteration: 190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977566599845886, gen p mean: -0.1247759535908699, mean p set: 0.45025599002838135
The modified gen p mean: 0.45060786604881287, gen p mean: -0.1285029798746109, mean p set: 0.45108816027641296
The modified gen p mean: 0.4487699568271637, gen p mean: -0.12793871760368347, mean p set: 0.4492502808570862
loss_pred:0.05435978248715401, decouple_loss:0.04660968855023384
loss_pred:0.055145200341939926, decouple_loss:0.047064922749996185
loss_pred:0.05456813797354698, decouple_loss:0.047665782272815704
2023-05-02 15:23:15 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.1242615357041359, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.12402621656656265, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.12467442452907562, mean p set: 0.45035696029663086
loss_pred:0.05447057634592056, decouple_loss:0.04729899764060974
loss_pred:0.05612541362643242, decouple_loss:0.04791630432009697
loss_pred:0.05328093096613884, decouple_loss:0.04787152633070946
WV_0_PC_1_EH_0_PS_40_6, loss: 0.05701042339205742, avg_mse: 0.05669582262635231
current test mse: 0.056696
Iteration: 191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502299427986145, gen p mean: -0.1208014115691185, mean p set: 0.4507102370262146
loss_pred:0.05564918741583824, decouple_loss:0.04655381292104721
The modified gen p mean: 0.44984233379364014, gen p mean: -0.11947636306285858, mean p set: 0.45032259821891785
loss_pred:0.05420273169875145, decouple_loss:0.047230225056409836
The modified gen p mean: 0.45022648572921753, gen p mean: -0.12111294269561768, mean p set: 0.45070680975914
loss_pred:0.05655600503087044, decouple_loss:0.04735355079174042
Iteration: 192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449023574590683, gen p mean: -0.14012400805950165, mean p set: 0.4495038390159607
The modified gen p mean: 0.4493388235569, gen p mean: -0.13180924952030182, mean p set: 0.44981908798217773
The modified gen p mean: 0.4495851397514343, gen p mean: -0.14235307276248932, mean p set: 0.4500654339790344
loss_pred:0.05526091903448105, decouple_loss:0.04573633894324303
loss_pred:0.05517840012907982, decouple_loss:0.04606940969824791
loss_pred:0.05302489176392555, decouple_loss:0.04609361290931702
Iteration: 193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44919729232788086, gen p mean: -0.15186750888824463, mean p set: 0.44967761635780334
The modified gen p mean: 0.4490238130092621, gen p mean: -0.148668110370636, mean p set: 0.44950413703918457
The modified gen p mean: 0.44940537214279175, gen p mean: -0.147197887301445, mean p set: 0.44988563656806946
loss_pred:0.05387607216835022, decouple_loss:0.046618107706308365
loss_pred:0.05579462647438049, decouple_loss:0.047373224049806595
loss_pred:0.05562394857406616, decouple_loss:0.046518776565790176
Iteration: 194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44938400387763977, gen p mean: -0.13823731243610382, mean p set: 0.44986429810523987
The modified gen p mean: 0.4487402141094208, gen p mean: -0.14036822319030762, mean p set: 0.4492204785346985
The modified gen p mean: 0.4498051106929779, gen p mean: -0.14621639251708984, mean p set: 0.450285404920578
loss_pred:0.05285228043794632, decouple_loss:0.045596636831760406
loss_pred:0.05445362627506256, decouple_loss:0.0454198457300663
loss_pred:0.05448390170931816, decouple_loss:0.04640796408057213
Iteration: 195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44959181547164917, gen p mean: -0.12029913067817688, mean p set: 0.45007210969924927
The modified gen p mean: 0.4497458040714264, gen p mean: -0.12009218335151672, mean p set: 0.4502260982990265
The modified gen p mean: 0.44964757561683655, gen p mean: -0.12010323256254196, mean p set: 0.45012786984443665
loss_pred:0.053551897406578064, decouple_loss:0.045685652643442154
loss_pred:0.05560087040066719, decouple_loss:0.04634357988834381
loss_pred:0.05340713635087013, decouple_loss:0.04595652222633362
Iteration: 196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45063337683677673, gen p mean: -0.12309044599533081, mean p set: 0.4511137008666992
The modified gen p mean: 0.45003125071525574, gen p mean: -0.126135915517807, mean p set: 0.45051151514053345
The modified gen p mean: 0.44985246658325195, gen p mean: -0.13083872199058533, mean p set: 0.45033276081085205
loss_pred:0.0544574037194252, decouple_loss:0.04583773389458656
loss_pred:0.05259374901652336, decouple_loss:0.04521114006638527
loss_pred:0.05309677869081497, decouple_loss:0.045299872756004333
Iteration: 197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450320839881897, gen p mean: -0.14309754967689514, mean p set: 0.4508011043071747
The modified gen p mean: 0.44942376017570496, gen p mean: -0.14315174520015717, mean p set: 0.44990405440330505
The modified gen p mean: 0.4492623209953308, gen p mean: -0.14207814633846283, mean p set: 0.4497425854206085
loss_pred:0.05325588211417198, decouple_loss:0.04381603002548218
loss_pred:0.05392295494675636, decouple_loss:0.04374998062849045
loss_pred:0.05428158864378929, decouple_loss:0.04328332096338272
Iteration: 198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450111985206604, gen p mean: -0.14438317716121674, mean p set: 0.4505922794342041
The modified gen p mean: 0.44864264130592346, gen p mean: -0.14274033904075623, mean p set: 0.44912293553352356
The modified gen p mean: 0.45044082403182983, gen p mean: -0.14582380652427673, mean p set: 0.45092108845710754
loss_pred:0.052536290138959885, decouple_loss:0.04540611803531647
loss_pred:0.05489035323262215, decouple_loss:0.045617636293172836
loss_pred:0.054860495030879974, decouple_loss:0.04634639620780945
Iteration: 199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960206747055054, gen p mean: -0.13897205889225006, mean p set: 0.45008236169815063
The modified gen p mean: 0.4501861035823822, gen p mean: -0.13950717449188232, mean p set: 0.4506663978099823
The modified gen p mean: 0.4503733515739441, gen p mean: -0.14213936030864716, mean p set: 0.4508536458015442
loss_pred:0.05515981838107109, decouple_loss:0.04656844958662987
loss_pred:0.05490187555551529, decouple_loss:0.046297624707221985
loss_pred:0.054498668760061264, decouple_loss:0.04539922997355461
Iteration: 200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44992658495903015, gen p mean: -0.13416938483715057, mean p set: 0.45040687918663025
The modified gen p mean: 0.4489370882511139, gen p mean: -0.13381680846214294, mean p set: 0.4494173526763916
The modified gen p mean: 0.44938376545906067, gen p mean: -0.13155260682106018, mean p set: 0.44986405968666077
loss_pred:0.05484199523925781, decouple_loss:0.04443197697401047
loss_pred:0.052813753485679626, decouple_loss:0.04381231591105461
loss_pred:0.05397430434823036, decouple_loss:0.04375971108675003
2023-05-02 15:27:00 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.13511043787002563, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.13591459393501282, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.13554589450359344, mean p set: 0.45035696029663086
loss_pred:0.05408831313252449, decouple_loss:0.04719003662467003
loss_pred:0.05552682653069496, decouple_loss:0.047488562762737274
loss_pred:0.05315361171960831, decouple_loss:0.04712314531207085
WV_0_PC_1_EH_0_PS_40_6, loss: 0.056619614362716675, avg_mse: 0.05650379881262779
current test mse: 0.056504
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492180645465851, gen p mean: -0.12715581059455872, mean p set: 0.4496983587741852
The modified gen p mean: 0.4490033686161041, gen p mean: -0.13652388751506805, mean p set: 0.4494836926460266
loss_pred:0.05776176601648331, decouple_loss:0.04686254635453224
loss_pred:0.053614772856235504, decouple_loss:0.04660167172551155
The modified gen p mean: 0.4494500756263733, gen p mean: -0.13747161626815796, mean p set: 0.4499303698539734
loss_pred:0.05659975856542587, decouple_loss:0.04670622944831848
Iteration: 202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475609362125397, gen p mean: -0.12205689400434494, mean p set: 0.4480412006378174
The modified gen p mean: 0.4493091106414795, gen p mean: -0.12414011359214783, mean p set: 0.4497894048690796
The modified gen p mean: 0.4483445882797241, gen p mean: -0.12106475979089737, mean p set: 0.4488248825073242
loss_pred:0.05356414616107941, decouple_loss:0.046888768672943115
loss_pred:0.052603501826524734, decouple_loss:0.04629893973469734
loss_pred:0.05573715642094612, decouple_loss:0.04670649394392967
Iteration: 203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478103518486023, gen p mean: -0.13103553652763367, mean p set: 0.44829061627388
The modified gen p mean: 0.4490126073360443, gen p mean: -0.123196080327034, mean p set: 0.4494929015636444
The modified gen p mean: 0.4492394030094147, gen p mean: -0.1226196363568306, mean p set: 0.44971972703933716
loss_pred:0.05294826999306679, decouple_loss:0.046648815274238586
loss_pred:0.0518135130405426, decouple_loss:0.04687386378645897
loss_pred:0.05213861167430878, decouple_loss:0.04693806543946266
Iteration: 204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862130284309387, gen p mean: -0.1461361199617386, mean p set: 0.44910159707069397
The modified gen p mean: 0.449035108089447, gen p mean: -0.14160922169685364, mean p set: 0.4495154023170471
The modified gen p mean: 0.44794365763664246, gen p mean: -0.148003488779068, mean p set: 0.44842392206192017
loss_pred:0.05594538524746895, decouple_loss:0.04667877033352852
loss_pred:0.052919793874025345, decouple_loss:0.04760197550058365
loss_pred:0.051358554512262344, decouple_loss:0.04677143692970276
Iteration: 205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491003453731537, gen p mean: -0.14925791323184967, mean p set: 0.4495806396007538
The modified gen p mean: 0.4506921172142029, gen p mean: -0.1445455253124237, mean p set: 0.451172411441803
The modified gen p mean: 0.44827431440353394, gen p mean: -0.1454632431268692, mean p set: 0.4487546384334564
loss_pred:0.051644306629896164, decouple_loss:0.04531046375632286
loss_pred:0.054729461669921875, decouple_loss:0.046616896986961365
loss_pred:0.057142771780490875, decouple_loss:0.04641949012875557
Iteration: 206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448874831199646, gen p mean: -0.14134718477725983, mean p set: 0.4493550956249237
The modified gen p mean: 0.44851556420326233, gen p mean: -0.135824516415596, mean p set: 0.4489958584308624
The modified gen p mean: 0.44861987233161926, gen p mean: -0.13843241333961487, mean p set: 0.44910016655921936
loss_pred:0.053102269768714905, decouple_loss:0.04499119520187378
loss_pred:0.05379725247621536, decouple_loss:0.0454661101102829
loss_pred:0.05225557088851929, decouple_loss:0.04576632007956505
Iteration: 207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44937968254089355, gen p mean: -0.13613440096378326, mean p set: 0.44986000657081604
The modified gen p mean: 0.448900431394577, gen p mean: -0.13409608602523804, mean p set: 0.4493807256221771
The modified gen p mean: 0.4483950436115265, gen p mean: -0.1363992989063263, mean p set: 0.4488753378391266
loss_pred:0.05461277812719345, decouple_loss:0.04455629363656044
loss_pred:0.053776685148477554, decouple_loss:0.045396074652671814
loss_pred:0.05371861904859543, decouple_loss:0.04706390202045441
Iteration: 208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490712583065033, gen p mean: -0.15177790820598602, mean p set: 0.4495515525341034
The modified gen p mean: 0.4499236047267914, gen p mean: -0.14831817150115967, mean p set: 0.4504038989543915
The modified gen p mean: 0.4486909806728363, gen p mean: -0.14568689465522766, mean p set: 0.4491713047027588
loss_pred:0.051122475415468216, decouple_loss:0.044787708669900894
loss_pred:0.05221821367740631, decouple_loss:0.044671930372714996
loss_pred:0.053761690855026245, decouple_loss:0.04522038251161575
Iteration: 209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786709547042847, gen p mean: -0.15285873413085938, mean p set: 0.44834738969802856
The modified gen p mean: 0.4478776156902313, gen p mean: -0.15308620035648346, mean p set: 0.4483579099178314
The modified gen p mean: 0.44851458072662354, gen p mean: -0.1529618203639984, mean p set: 0.44899484515190125
loss_pred:0.052015598863363266, decouple_loss:0.04427080601453781
loss_pred:0.05137937515974045, decouple_loss:0.04394449666142464
loss_pred:0.054258715361356735, decouple_loss:0.0450250469148159
Iteration: 210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492962062358856, gen p mean: -0.14445343613624573, mean p set: 0.44977647066116333
The modified gen p mean: 0.4500401020050049, gen p mean: -0.14571182429790497, mean p set: 0.450520396232605
The modified gen p mean: 0.44955405592918396, gen p mean: -0.15114490687847137, mean p set: 0.45003435015678406
loss_pred:0.05325149744749069, decouple_loss:0.04471037909388542
loss_pred:0.0545848123729229, decouple_loss:0.045848995447158813
loss_pred:0.05084458366036415, decouple_loss:0.04480961710214615
2023-05-02 15:31:28 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.14689762890338898, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.14628830552101135, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.1485443115234375, mean p set: 0.45035696029663086
loss_pred:0.05305124446749687, decouple_loss:0.04653371497988701
loss_pred:0.05156152695417404, decouple_loss:0.04536816477775574
loss_pred:0.05047019571065903, decouple_loss:0.04608997702598572
WV_0_PC_1_EH_0_PS_40_6, loss: 0.05399418994784355, avg_mse: 0.053583212196826935
current test mse: 0.053583
Iteration: 211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784530997276306, gen p mean: -0.14583051204681396, mean p set: 0.44832560420036316
The modified gen p mean: 0.4510590732097626, gen p mean: -0.1404879093170166, mean p set: 0.4515393376350403
loss_pred:0.05222243070602417, decouple_loss:0.04769267141819
loss_pred:0.053702227771282196, decouple_loss:0.04531411826610565
The modified gen p mean: 0.4490082561969757, gen p mean: -0.14975261688232422, mean p set: 0.4494885504245758
loss_pred:0.05261574313044548, decouple_loss:0.046095188707113266
Iteration: 212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496171176433563, gen p mean: -0.14070859551429749, mean p set: 0.4500974118709564
The modified gen p mean: 0.44849181175231934, gen p mean: -0.14099568128585815, mean p set: 0.44897210597991943
The modified gen p mean: 0.4498286545276642, gen p mean: -0.1445101797580719, mean p set: 0.4503089487552643
loss_pred:0.05388324707746506, decouple_loss:0.044804491102695465
loss_pred:0.05525553598999977, decouple_loss:0.045268941670656204
loss_pred:0.05002737417817116, decouple_loss:0.044601377099752426
Iteration: 213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879257678985596, gen p mean: -0.1378479301929474, mean p set: 0.44927287101745605
The modified gen p mean: 0.44823336601257324, gen p mean: -0.13913366198539734, mean p set: 0.4487136900424957
The modified gen p mean: 0.45011135935783386, gen p mean: -0.14342960715293884, mean p set: 0.45059165358543396
loss_pred:0.05497416853904724, decouple_loss:0.044185467064380646
loss_pred:0.05622854083776474, decouple_loss:0.04483264312148094
loss_pred:0.052432890981435776, decouple_loss:0.04383912682533264
Iteration: 214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44916248321533203, gen p mean: -0.15001781284809113, mean p set: 0.44964277744293213
The modified gen p mean: 0.4485279321670532, gen p mean: -0.14995527267456055, mean p set: 0.4490082263946533
The modified gen p mean: 0.4487936794757843, gen p mean: -0.14832431077957153, mean p set: 0.4492739737033844
loss_pred:0.05426895618438721, decouple_loss:0.04546605795621872
loss_pred:0.05104496702551842, decouple_loss:0.045168958604335785
loss_pred:0.05224989354610443, decouple_loss:0.04458555951714516
Iteration: 215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44885823130607605, gen p mean: -0.15559373795986176, mean p set: 0.44933852553367615
The modified gen p mean: 0.44875580072402954, gen p mean: -0.16005875170230865, mean p set: 0.449236124753952
The modified gen p mean: 0.44943416118621826, gen p mean: -0.15940527617931366, mean p set: 0.44991445541381836
loss_pred:0.05043041333556175, decouple_loss:0.044294025748968124
loss_pred:0.05056548863649368, decouple_loss:0.04392605647444725
loss_pred:0.05173683539032936, decouple_loss:0.04354716092348099
Iteration: 216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853314757347107, gen p mean: -0.1493852734565735, mean p set: 0.44901344180107117
The modified gen p mean: 0.44893208146095276, gen p mean: -0.14334779977798462, mean p set: 0.44941237568855286
The modified gen p mean: 0.44982975721359253, gen p mean: -0.15417075157165527, mean p set: 0.450310081243515
loss_pred:0.05327562987804413, decouple_loss:0.04395909979939461
loss_pred:0.05290145426988602, decouple_loss:0.044842399656772614
loss_pred:0.053016405552625656, decouple_loss:0.04441382363438606
Iteration: 217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479248821735382, gen p mean: -0.1475849747657776, mean p set: 0.4484051764011383
The modified gen p mean: 0.4480951428413391, gen p mean: -0.14531023800373077, mean p set: 0.4485754370689392
The modified gen p mean: 0.44802823662757874, gen p mean: -0.1516970843076706, mean p set: 0.44850850105285645
loss_pred:0.05317525193095207, decouple_loss:0.04324289411306381
loss_pred:0.05461878329515457, decouple_loss:0.042963072657585144
loss_pred:0.050570957362651825, decouple_loss:0.043212030082941055
Iteration: 218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449282169342041, gen p mean: -0.1396980881690979, mean p set: 0.4497624933719635
The modified gen p mean: 0.4479655921459198, gen p mean: -0.14489047229290009, mean p set: 0.4484458863735199
The modified gen p mean: 0.44945028424263, gen p mean: -0.15087349712848663, mean p set: 0.4499305486679077
loss_pred:0.05239337310194969, decouple_loss:0.04379229620099068
loss_pred:0.05128234624862671, decouple_loss:0.04362897574901581
loss_pred:0.048837170004844666, decouple_loss:0.042595501989126205
Iteration: 219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948524236679077, gen p mean: -0.14803975820541382, mean p set: 0.44996556639671326
The modified gen p mean: 0.44956347346305847, gen p mean: -0.15135861933231354, mean p set: 0.45004376769065857
The modified gen p mean: 0.449535071849823, gen p mean: -0.14943912625312805, mean p set: 0.4500153958797455
loss_pred:0.053145408630371094, decouple_loss:0.04408644512295723
loss_pred:0.04904118925333023, decouple_loss:0.043494515120983124
loss_pred:0.0503678135573864, decouple_loss:0.04323834925889969
Iteration: 220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800862669944763, gen p mean: -0.14749015867710114, mean p set: 0.44848892092704773
The modified gen p mean: 0.44823217391967773, gen p mean: -0.15072079002857208, mean p set: 0.44871246814727783
The modified gen p mean: 0.45006638765335083, gen p mean: -0.14512641727924347, mean p set: 0.45054665207862854
loss_pred:0.05335753783583641, decouple_loss:0.04367366060614586
loss_pred:0.05077483877539635, decouple_loss:0.042670052498579025
loss_pred:0.05242685601115227, decouple_loss:0.04245047643780708
2023-05-02 15:35:11 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.14977146685123444, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.1483839452266693, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.14883942902088165, mean p set: 0.45035696029663086
loss_pred:0.05214589834213257, decouple_loss:0.045015111565589905
loss_pred:0.05105479434132576, decouple_loss:0.0437534898519516
loss_pred:0.04965376481413841, decouple_loss:0.04308571293950081
WV_0_PC_1_EH_0_PS_40_6, loss: 0.05314905568957329, avg_mse: 0.05297287181019783
current test mse: 0.052973
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
NaN value num: 0
Iteration: 221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44804269075393677, gen p mean: -0.14635047316551208, mean p set: 0.44852298498153687
loss_pred:0.05339216813445091, decouple_loss:0.04369832202792168
The modified gen p mean: 0.45035213232040405, gen p mean: -0.14941871166229248, mean p set: 0.45083242654800415
loss_pred:0.052906960248947144, decouple_loss:0.04529546946287155
The modified gen p mean: 0.44956615567207336, gen p mean: -0.15239004790782928, mean p set: 0.4500464200973511
loss_pred:0.052491869777441025, decouple_loss:0.04503931850194931
Iteration: 222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517655074596405, gen p mean: -0.13959760963916779, mean p set: 0.4522458016872406
The modified gen p mean: 0.4518306851387024, gen p mean: -0.14854063093662262, mean p set: 0.4523109793663025
The modified gen p mean: 0.45149004459381104, gen p mean: -0.1466970443725586, mean p set: 0.45197030901908875
loss_pred:0.055620331317186356, decouple_loss:0.046478383243083954
loss_pred:0.05447309464216232, decouple_loss:0.04548688977956772
loss_pred:0.05430902913212776, decouple_loss:0.04487232491374016
Iteration: 223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487243890762329, gen p mean: -0.14114810526371002, mean p set: 0.4492046535015106
The modified gen p mean: 0.4524685740470886, gen p mean: -0.14835211634635925, mean p set: 0.4529488980770111
The modified gen p mean: 0.4486974775791168, gen p mean: -0.1468290388584137, mean p set: 0.4491777718067169
loss_pred:0.051884036511182785, decouple_loss:0.04470323398709297
loss_pred:0.05172465369105339, decouple_loss:0.04585670679807663
loss_pred:0.05070890858769417, decouple_loss:0.044270679354667664
Iteration: 224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45070233941078186, gen p mean: -0.15177536010742188, mean p set: 0.45118266344070435
The modified gen p mean: 0.4496780037879944, gen p mean: -0.14991241693496704, mean p set: 0.4501582682132721
The modified gen p mean: 0.4509352445602417, gen p mean: -0.15194466710090637, mean p set: 0.4514155387878418
loss_pred:0.05230490490794182, decouple_loss:0.04678402096033096
loss_pred:0.04906180873513222, decouple_loss:0.04529788717627525
loss_pred:0.05176909267902374, decouple_loss:0.04632458835840225
Iteration: 225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45244041085243225, gen p mean: -0.15122701227664948, mean p set: 0.45292070508003235
The modified gen p mean: 0.4490574598312378, gen p mean: -0.15920206904411316, mean p set: 0.4495377540588379
The modified gen p mean: 0.4499867856502533, gen p mean: -0.15251243114471436, mean p set: 0.4504671096801758
loss_pred:0.05408830940723419, decouple_loss:0.046704914420843124
loss_pred:0.05028007924556732, decouple_loss:0.04509973153471947
loss_pred:0.05217033252120018, decouple_loss:0.047294627875089645
Iteration: 226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513772428035736, gen p mean: -0.1487850695848465, mean p set: 0.4518575668334961
The modified gen p mean: 0.4508698880672455, gen p mean: -0.14948861300945282, mean p set: 0.4513501822948456
The modified gen p mean: 0.45324620604515076, gen p mean: -0.15003857016563416, mean p set: 0.45372650027275085
loss_pred:0.05126213654875755, decouple_loss:0.04655248299241066
loss_pred:0.05199040099978447, decouple_loss:0.047575291246175766
loss_pred:0.049747955054044724, decouple_loss:0.046137478202581406
Iteration: 227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515189230442047, gen p mean: -0.14678220450878143, mean p set: 0.4519991874694824
The modified gen p mean: 0.44927510619163513, gen p mean: -0.14723697304725647, mean p set: 0.4497554302215576
The modified gen p mean: 0.45035824179649353, gen p mean: -0.1451859176158905, mean p set: 0.450838565826416
loss_pred:0.05159110948443413, decouple_loss:0.04571966454386711
loss_pred:0.049037426710128784, decouple_loss:0.043527159839868546
loss_pred:0.05476238578557968, decouple_loss:0.04523703455924988
Iteration: 228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45195165276527405, gen p mean: -0.15372511744499207, mean p set: 0.45243194699287415
The modified gen p mean: 0.4508528709411621, gen p mean: -0.15752184391021729, mean p set: 0.451333224773407
The modified gen p mean: 0.45089441537857056, gen p mean: -0.15234367549419403, mean p set: 0.45137470960617065
loss_pred:0.051894139498472214, decouple_loss:0.04505597800016403
loss_pred:0.05103059113025665, decouple_loss:0.044205136597156525
loss_pred:0.053530845791101456, decouple_loss:0.044227492064237595
Iteration: 229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494902193546295, gen p mean: -0.15387587249279022, mean p set: 0.4499705135822296
The modified gen p mean: 0.45077523589134216, gen p mean: -0.15477672219276428, mean p set: 0.4512555003166199
The modified gen p mean: 0.4514182209968567, gen p mean: -0.16127020120620728, mean p set: 0.4518985152244568
loss_pred:0.04742811992764473, decouple_loss:0.044083185493946075
loss_pred:0.05371468514204025, decouple_loss:0.045260027050971985
loss_pred:0.05097467452287674, decouple_loss:0.04500487074255943
Iteration: 230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496941566467285, gen p mean: -0.15701207518577576, mean p set: 0.4501744508743286
The modified gen p mean: 0.45008784532546997, gen p mean: -0.15510116517543793, mean p set: 0.45056816935539246
The modified gen p mean: 0.4526841342449188, gen p mean: -0.15946125984191895, mean p set: 0.4531644284725189
loss_pred:0.049931541085243225, decouple_loss:0.04532759264111519
loss_pred:0.0501612052321434, decouple_loss:0.04558226466178894
loss_pred:0.04871927574276924, decouple_loss:0.04560011997818947
2023-05-02 15:39:30 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.15553513169288635, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.1541280448436737, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.1549394279718399, mean p set: 0.45035696029663086
loss_pred:0.05310533940792084, decouple_loss:0.04749804362654686
loss_pred:0.05175136402249336, decouple_loss:0.04586081579327583
loss_pred:0.050761036574840546, decouple_loss:0.04710797592997551
WV_0_PC_1_EH_0_PS_40_6, loss: 0.05421369522809982, avg_mse: 0.054280515760183334
current test mse: 0.054281
Iteration: 231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512171745300293, gen p mean: -0.15375357866287231, mean p set: 0.451697438955307
loss_pred:0.05208205804228783, decouple_loss:0.04651997983455658
The modified gen p mean: 0.45122775435447693, gen p mean: -0.16120260953903198, mean p set: 0.4517081081867218
loss_pred:0.05195176601409912, decouple_loss:0.04466241970658302
The modified gen p mean: 0.4498998820781708, gen p mean: -0.15683063864707947, mean p set: 0.4503801465034485
loss_pred:0.05029863491654396, decouple_loss:0.044424865394830704
Iteration: 232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840550422668457, gen p mean: -0.15519584715366364, mean p set: 0.4488857686519623
The modified gen p mean: 0.4511845111846924, gen p mean: -0.16490115225315094, mean p set: 0.4516648054122925
The modified gen p mean: 0.4501711130142212, gen p mean: -0.16249941289424896, mean p set: 0.4506514370441437
loss_pred:0.05220724269747734, decouple_loss:0.0445035845041275
loss_pred:0.04953646659851074, decouple_loss:0.043758489191532135
loss_pred:0.05044727772474289, decouple_loss:0.04427093639969826
Iteration: 233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507392644882202, gen p mean: -0.16280964016914368, mean p set: 0.4512195587158203
The modified gen p mean: 0.45135435461997986, gen p mean: -0.1684882491827011, mean p set: 0.4518345892429352
The modified gen p mean: 0.45285531878471375, gen p mean: -0.16699841618537903, mean p set: 0.45333564281463623
loss_pred:0.052004698663949966, decouple_loss:0.04375772923231125
loss_pred:0.0506359338760376, decouple_loss:0.04427183419466019
loss_pred:0.04848963022232056, decouple_loss:0.04393298923969269
Iteration: 234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44935178756713867, gen p mean: -0.16812509298324585, mean p set: 0.44983211159706116
The modified gen p mean: 0.45074793696403503, gen p mean: -0.167487233877182, mean p set: 0.45122823119163513
The modified gen p mean: 0.4507633149623871, gen p mean: -0.16880828142166138, mean p set: 0.4512436091899872
loss_pred:0.049376487731933594, decouple_loss:0.04336334019899368
loss_pred:0.053648367524147034, decouple_loss:0.04364568740129471
loss_pred:0.051142286509275436, decouple_loss:0.04380965232849121
Iteration: 235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45090603828430176, gen p mean: -0.17971819639205933, mean p set: 0.45138633251190186
The modified gen p mean: 0.44968530535697937, gen p mean: -0.17060299217700958, mean p set: 0.45016559958457947
The modified gen p mean: 0.4503033757209778, gen p mean: -0.1723792999982834, mean p set: 0.4507836401462555
loss_pred:0.049471672624349594, decouple_loss:0.04298243671655655
loss_pred:0.04672523960471153, decouple_loss:0.043047938495874405
loss_pred:0.051995567977428436, decouple_loss:0.044240497052669525
Iteration: 236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44978848099708557, gen p mean: -0.1707749366760254, mean p set: 0.45026880502700806
The modified gen p mean: 0.45143282413482666, gen p mean: -0.17433421313762665, mean p set: 0.45191308856010437
The modified gen p mean: 0.44866201281547546, gen p mean: -0.1683063507080078, mean p set: 0.44914230704307556
loss_pred:0.05124036222696304, decouple_loss:0.04359368607401848
loss_pred:0.04937952384352684, decouple_loss:0.04249291867017746
loss_pred:0.05007515102624893, decouple_loss:0.043789610266685486
Iteration: 237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483364522457123, gen p mean: -0.16560161113739014, mean p set: 0.44881677627563477
The modified gen p mean: 0.4501718282699585, gen p mean: -0.17058604955673218, mean p set: 0.4506521224975586
The modified gen p mean: 0.45249879360198975, gen p mean: -0.1706261932849884, mean p set: 0.45297905802726746
loss_pred:0.05031626299023628, decouple_loss:0.04369235783815384
loss_pred:0.04901149868965149, decouple_loss:0.04278375580906868
loss_pred:0.052184682339429855, decouple_loss:0.04357730597257614
Iteration: 238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45174968242645264, gen p mean: -0.16672880947589874, mean p set: 0.45222997665405273
The modified gen p mean: 0.45093390345573425, gen p mean: -0.16102604568004608, mean p set: 0.45141419768333435
The modified gen p mean: 0.4500799775123596, gen p mean: -0.1626783013343811, mean p set: 0.45056024193763733
loss_pred:0.05030510574579239, decouple_loss:0.044716428965330124
loss_pred:0.051639627665281296, decouple_loss:0.044506944715976715
loss_pred:0.05109895393252373, decouple_loss:0.04366394132375717
Iteration: 239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448230504989624, gen p mean: -0.15613599121570587, mean p set: 0.4487107992172241
The modified gen p mean: 0.4497639238834381, gen p mean: -0.1603163629770279, mean p set: 0.4502442479133606
The modified gen p mean: 0.4502318501472473, gen p mean: -0.16055980324745178, mean p set: 0.4507121443748474
loss_pred:0.04910224676132202, decouple_loss:0.04298005253076553
loss_pred:0.04975533485412598, decouple_loss:0.04309118539094925
loss_pred:0.04822755977511406, decouple_loss:0.04247990995645523
Iteration: 240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506523013114929, gen p mean: -0.1596343070268631, mean p set: 0.4511326253414154
The modified gen p mean: 0.45277729630470276, gen p mean: -0.16061356663703918, mean p set: 0.45325756072998047
The modified gen p mean: 0.4501558840274811, gen p mean: -0.15549513697624207, mean p set: 0.4506361782550812
loss_pred:0.050342001020908356, decouple_loss:0.043540459126234055
loss_pred:0.04832611232995987, decouple_loss:0.04510794207453728
loss_pred:0.04979243874549866, decouple_loss:0.04380844905972481
2023-05-02 15:43:14 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.16203121840953827, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.1640620231628418, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.16219893097877502, mean p set: 0.45035696029663086
loss_pred:0.050744179636240005, decouple_loss:0.04354526847600937
loss_pred:0.052323225885629654, decouple_loss:0.04485953226685524
loss_pred:0.0497245229780674, decouple_loss:0.04527062177658081
WV_0_PC_1_EH_0_PS_40_6, loss: 0.05315856635570526, avg_mse: 0.05336920544505119
current test mse: 0.053369
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471185505390167, gen p mean: -0.1590108871459961, mean p set: 0.4475988745689392
loss_pred:0.05210607126355171, decouple_loss:0.047986723482608795
The modified gen p mean: 0.44720011949539185, gen p mean: -0.16036754846572876, mean p set: 0.44768041372299194
loss_pred:0.05068175494670868, decouple_loss:0.044882193207740784
The modified gen p mean: 0.4474899470806122, gen p mean: -0.16264548897743225, mean p set: 0.4479702413082123
loss_pred:0.05149277672171593, decouple_loss:0.047105543315410614
Iteration: 242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478148818016052, gen p mean: -0.16455551981925964, mean p set: 0.4482952058315277
The modified gen p mean: 0.4477905035018921, gen p mean: -0.15818215906620026, mean p set: 0.4482708275318146
The modified gen p mean: 0.4476644992828369, gen p mean: -0.15575076639652252, mean p set: 0.4481448233127594
loss_pred:0.052361782640218735, decouple_loss:0.04566005617380142
loss_pred:0.05414636433124542, decouple_loss:0.04556993767619133
loss_pred:0.053300801664590836, decouple_loss:0.046422965824604034
Iteration: 243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744566082954407, gen p mean: -0.1662311851978302, mean p set: 0.44792598485946655
The modified gen p mean: 0.44776326417922974, gen p mean: -0.16343852877616882, mean p set: 0.44824355840682983
The modified gen p mean: 0.4481312930583954, gen p mean: -0.16264136135578156, mean p set: 0.4486115872859955
loss_pred:0.05089957267045975, decouple_loss:0.046387672424316406
loss_pred:0.050602372735738754, decouple_loss:0.046116940677165985
loss_pred:0.051683440804481506, decouple_loss:0.04550845921039581
Iteration: 244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44748654961586, gen p mean: -0.16818498075008392, mean p set: 0.4479668438434601
The modified gen p mean: 0.4469161927700043, gen p mean: -0.1637343168258667, mean p set: 0.44739648699760437
The modified gen p mean: 0.4463063180446625, gen p mean: -0.16792500019073486, mean p set: 0.44678664207458496
loss_pred:0.0530749186873436, decouple_loss:0.04649931937456131
loss_pred:0.05323607102036476, decouple_loss:0.045818064361810684
loss_pred:0.04975654184818268, decouple_loss:0.04566628858447075
Iteration: 245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476197063922882, gen p mean: -0.17858123779296875, mean p set: 0.4481000304222107
The modified gen p mean: 0.4476095139980316, gen p mean: -0.17790143191814423, mean p set: 0.4480897784233093
The modified gen p mean: 0.44735562801361084, gen p mean: -0.18111920356750488, mean p set: 0.44783589243888855
loss_pred:0.050737686455249786, decouple_loss:0.04696586728096008
loss_pred:0.049961887300014496, decouple_loss:0.046043042093515396
loss_pred:0.04860949143767357, decouple_loss:0.045905064791440964
Iteration: 246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475240707397461, gen p mean: -0.18822795152664185, mean p set: 0.4480043649673462
The modified gen p mean: 0.44719043374061584, gen p mean: -0.1880849152803421, mean p set: 0.44767072796821594
The modified gen p mean: 0.4471803605556488, gen p mean: -0.18029597401618958, mean p set: 0.4476606547832489
loss_pred:0.051726166158914566, decouple_loss:0.04659542813897133
loss_pred:0.05206931382417679, decouple_loss:0.04577573388814926
loss_pred:0.051560208201408386, decouple_loss:0.04631118103861809
Iteration: 247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677072763442993, gen p mean: -0.17105132341384888, mean p set: 0.44725102186203003
The modified gen p mean: 0.4469631314277649, gen p mean: -0.1708778738975525, mean p set: 0.447443425655365
The modified gen p mean: 0.44772136211395264, gen p mean: -0.1724824607372284, mean p set: 0.44820162653923035
loss_pred:0.04766657575964928, decouple_loss:0.04460841789841652
loss_pred:0.04846838489174843, decouple_loss:0.044503938406705856
loss_pred:0.05105457454919815, decouple_loss:0.045176275074481964
Iteration: 248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471528232097626, gen p mean: -0.16059242188930511, mean p set: 0.44763314723968506
The modified gen p mean: 0.446276992559433, gen p mean: -0.16031233966350555, mean p set: 0.4467572569847107
The modified gen p mean: 0.44698387384414673, gen p mean: -0.15732364356517792, mean p set: 0.4474641680717468
loss_pred:0.05001270771026611, decouple_loss:0.044236134737730026
loss_pred:0.04690654203295708, decouple_loss:0.04356307163834572
loss_pred:0.051969435065984726, decouple_loss:0.04504522308707237
Iteration: 249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447537362575531, gen p mean: -0.16639985144138336, mean p set: 0.4480176270008087
The modified gen p mean: 0.44745904207229614, gen p mean: -0.1653888076543808, mean p set: 0.44793930649757385
The modified gen p mean: 0.4483296573162079, gen p mean: -0.16754406690597534, mean p set: 0.4488099217414856
loss_pred:0.04960893094539642, decouple_loss:0.04488838091492653
loss_pred:0.05066097155213356, decouple_loss:0.04414405673742294
loss_pred:0.051530200988054276, decouple_loss:0.043953441083431244
Iteration: 250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44654354453086853, gen p mean: -0.1716146469116211, mean p set: 0.44702383875846863
The modified gen p mean: 0.4475264847278595, gen p mean: -0.17128603160381317, mean p set: 0.4480067491531372
The modified gen p mean: 0.4471842646598816, gen p mean: -0.17171715199947357, mean p set: 0.4476645588874817
loss_pred:0.04823873192071915, decouple_loss:0.04287298396229744
loss_pred:0.05089973658323288, decouple_loss:0.04391366243362427
loss_pred:0.05071316286921501, decouple_loss:0.04339966922998428
2023-05-02 15:47:35 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.17851459980010986, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.17593902349472046, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.1748662292957306, mean p set: 0.45035696029663086
loss_pred:0.05005395784974098, decouple_loss:0.04381618648767471
loss_pred:0.04890897497534752, decouple_loss:0.042118851095438004
loss_pred:0.048051100224256516, decouple_loss:0.04283365607261658
WV_0_PC_1_EH_0_PS_40_6, loss: 0.05115082487463951, avg_mse: 0.05111448094248772
current test mse: 0.051114
Iteration: 251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729742407798767, gen p mean: -0.17110347747802734, mean p set: 0.44777771830558777The modified gen p mean: 0.44752684235572815, gen p mean: -0.17767959833145142, mean p set: 0.44800713658332825
loss_pred:0.04937710985541344, decouple_loss:0.04418685659766197loss_pred:0.049928631633520126, decouple_loss:0.04277028143405914
The modified gen p mean: 0.44665274024009705, gen p mean: -0.17472463846206665, mean p set: 0.44713303446769714
loss_pred:0.04749277979135513, decouple_loss:0.04276513680815697
Iteration: 252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471006393432617, gen p mean: -0.17579104006290436, mean p set: 0.44758090376853943
The modified gen p mean: 0.44785478711128235, gen p mean: -0.17241738736629486, mean p set: 0.44833505153656006
The modified gen p mean: 0.4477626085281372, gen p mean: -0.169163778424263, mean p set: 0.4482428729534149
loss_pred:0.05002261698246002, decouple_loss:0.04392838850617409
loss_pred:0.05002674087882042, decouple_loss:0.04666173458099365
loss_pred:0.051752205938100815, decouple_loss:0.04451395198702812
Iteration: 253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448141485452652, gen p mean: -0.16683988273143768, mean p set: 0.4486217796802521
The modified gen p mean: 0.44733744859695435, gen p mean: -0.16305191814899445, mean p set: 0.44781771302223206
The modified gen p mean: 0.4476320445537567, gen p mean: -0.1667809635400772, mean p set: 0.4481123387813568
loss_pred:0.049373991787433624, decouple_loss:0.043470509350299835
loss_pred:0.0511397086083889, decouple_loss:0.044502660632133484
loss_pred:0.04748957231640816, decouple_loss:0.041940584778785706
Iteration: 254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480352997779846, gen p mean: -0.1674506664276123, mean p set: 0.4485156238079071
The modified gen p mean: 0.44759687781333923, gen p mean: -0.16527187824249268, mean p set: 0.44807714223861694
The modified gen p mean: 0.4485894441604614, gen p mean: -0.16591694951057434, mean p set: 0.4490697383880615
loss_pred:0.047349996864795685, decouple_loss:0.042616646736860275
loss_pred:0.048889320343732834, decouple_loss:0.04350438341498375
loss_pred:0.04758713021874428, decouple_loss:0.043121300637722015
Iteration: 255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472975432872772, gen p mean: -0.16429586708545685, mean p set: 0.4477778375148773
The modified gen p mean: 0.4477926790714264, gen p mean: -0.16325151920318604, mean p set: 0.4482730031013489
The modified gen p mean: 0.4476642608642578, gen p mean: -0.16310004889965057, mean p set: 0.4481445848941803
loss_pred:0.04868534579873085, decouple_loss:0.043708596378564835
loss_pred:0.04751427099108696, decouple_loss:0.04324667900800705
loss_pred:0.04761606454849243, decouple_loss:0.04284362867474556
Iteration: 256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479086399078369, gen p mean: -0.16654841601848602, mean p set: 0.4483889639377594
The modified gen p mean: 0.44701892137527466, gen p mean: -0.16164296865463257, mean p set: 0.44749921560287476
The modified gen p mean: 0.44858667254447937, gen p mean: -0.1689123660326004, mean p set: 0.4490669369697571
loss_pred:0.04818745702505112, decouple_loss:0.04230654984712601
loss_pred:0.04966069385409355, decouple_loss:0.043142180889844894
loss_pred:0.04699759557843208, decouple_loss:0.04249442741274834
Iteration: 257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44707900285720825, gen p mean: -0.15728649497032166, mean p set: 0.44755926728248596
The modified gen p mean: 0.4472311735153198, gen p mean: -0.15979982912540436, mean p set: 0.44771143794059753
The modified gen p mean: 0.44601359963417053, gen p mean: -0.16305966675281525, mean p set: 0.44649389386177063
loss_pred:0.05096856504678726, decouple_loss:0.04275084286928177
loss_pred:0.05054973438382149, decouple_loss:0.04366359859704971
loss_pred:0.046057503670454025, decouple_loss:0.04275953024625778
Iteration: 258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473235309123993, gen p mean: -0.16918177902698517, mean p set: 0.4478038251399994
The modified gen p mean: 0.44800665974617004, gen p mean: -0.1669444590806961, mean p set: 0.44848695397377014
The modified gen p mean: 0.44758734107017517, gen p mean: -0.1614692062139511, mean p set: 0.44806763529777527
loss_pred:0.04828691482543945, decouple_loss:0.0426815040409565
loss_pred:0.049932871013879776, decouple_loss:0.041530877351760864
loss_pred:0.05108204856514931, decouple_loss:0.04309650510549545
Iteration: 259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477413594722748, gen p mean: -0.17083220183849335, mean p set: 0.4482216238975525
The modified gen p mean: 0.4473910927772522, gen p mean: -0.1683812290430069, mean p set: 0.4478713572025299
The modified gen p mean: 0.4472668766975403, gen p mean: -0.1712624728679657, mean p set: 0.44774720072746277
loss_pred:0.049800340086221695, decouple_loss:0.04143616557121277
loss_pred:0.05111701041460037, decouple_loss:0.042145632207393646
loss_pred:0.047376539558172226, decouple_loss:0.04045451432466507
Iteration: 260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468156695365906, gen p mean: -0.17679545283317566, mean p set: 0.44729599356651306
The modified gen p mean: 0.4475558400154114, gen p mean: -0.17186540365219116, mean p set: 0.4480361342430115
The modified gen p mean: 0.44719046354293823, gen p mean: -0.17373821139335632, mean p set: 0.44767072796821594
loss_pred:0.04736587777733803, decouple_loss:0.04188947007060051
loss_pred:0.04969501867890358, decouple_loss:0.04230097308754921
loss_pred:0.05035082995891571, decouple_loss:0.04064173623919487
2023-05-02 15:51:18 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.1794934719800949, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.18170948326587677, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.17728561162948608, mean p set: 0.45035696029663086
loss_pred:0.04853354021906853, decouple_loss:0.04021170362830162
loss_pred:0.049340467900037766, decouple_loss:0.04174698889255524
loss_pred:0.04727812483906746, decouple_loss:0.04156401380896568
WV_0_PC_1_EH_0_PS_40_6, loss: 0.05044275522232056, avg_mse: 0.05051885172724724
current test mse: 0.050519
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446971595287323, gen p mean: -0.1753588318824768, mean p set: 0.4474518895149231
The modified gen p mean: 0.44724732637405396, gen p mean: -0.17959310114383698, mean p set: 0.44772762060165405
loss_pred:0.047970809042453766, decouple_loss:0.042513273656368256
loss_pred:0.046979647129774094, decouple_loss:0.041189901530742645
The modified gen p mean: 0.44719478487968445, gen p mean: -0.17893359065055847, mean p set: 0.44767507910728455
loss_pred:0.04633598029613495, decouple_loss:0.04322262108325958
Iteration: 262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468706548213959, gen p mean: -0.16556136310100555, mean p set: 0.44735097885131836
The modified gen p mean: 0.44781091809272766, gen p mean: -0.16773100197315216, mean p set: 0.44829118251800537
The modified gen p mean: 0.4469614624977112, gen p mean: -0.16532419621944427, mean p set: 0.4474417567253113
loss_pred:0.048813413828611374, decouple_loss:0.04267874360084534
loss_pred:0.04830020293593407, decouple_loss:0.04112691059708595
loss_pred:0.04746311902999878, decouple_loss:0.04119786247611046
Iteration: 263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733887910842896, gen p mean: -0.1676197052001953, mean p set: 0.44781920313835144
The modified gen p mean: 0.44798222184181213, gen p mean: -0.17089621722698212, mean p set: 0.44846251606941223
The modified gen p mean: 0.4469868242740631, gen p mean: -0.1678248792886734, mean p set: 0.4474670886993408
loss_pred:0.046920545399188995, decouple_loss:0.04233400151133537
loss_pred:0.04560742527246475, decouple_loss:0.0424063503742218
loss_pred:0.047246433794498444, decouple_loss:0.04159053415060043
Iteration: 264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461709260940552, gen p mean: -0.1691693514585495, mean p set: 0.4466512203216553
The modified gen p mean: 0.44771745800971985, gen p mean: -0.16872233152389526, mean p set: 0.44819772243499756
The modified gen p mean: 0.44802191853523254, gen p mean: -0.17839990556240082, mean p set: 0.44850221276283264
loss_pred:0.04880791902542114, decouple_loss:0.0409940667450428
loss_pred:0.047627002000808716, decouple_loss:0.04032228887081146
loss_pred:0.047839947044849396, decouple_loss:0.04142788052558899
Iteration: 265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484224021434784, gen p mean: -0.17803479731082916, mean p set: 0.4489026963710785
The modified gen p mean: 0.4468631148338318, gen p mean: -0.17142800986766815, mean p set: 0.4473433792591095
The modified gen p mean: 0.44670695066452026, gen p mean: -0.1719215214252472, mean p set: 0.44718724489212036
loss_pred:0.04703705757856369, decouple_loss:0.0411878265440464
loss_pred:0.047008924186229706, decouple_loss:0.04086434096097946
loss_pred:0.047569677233695984, decouple_loss:0.04152054712176323
Iteration: 266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467621445655823, gen p mean: -0.1671084612607956, mean p set: 0.44724246859550476
The modified gen p mean: 0.44676193594932556, gen p mean: -0.16869138181209564, mean p set: 0.44724223017692566
The modified gen p mean: 0.4470536708831787, gen p mean: -0.17202214896678925, mean p set: 0.4475339949131012
loss_pred:0.048059143126010895, decouple_loss:0.041128575801849365
loss_pred:0.045728523284196854, decouple_loss:0.04063321277499199
loss_pred:0.048018526285886765, decouple_loss:0.04079234227538109
Iteration: 267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44603610038757324, gen p mean: -0.17069588601589203, mean p set: 0.44651639461517334
The modified gen p mean: 0.44808536767959595, gen p mean: -0.17516835033893585, mean p set: 0.44856566190719604
The modified gen p mean: 0.4468885660171509, gen p mean: -0.17030172049999237, mean p set: 0.447368860244751
loss_pred:0.04812268167734146, decouple_loss:0.04261749982833862
loss_pred:0.0459684282541275, decouple_loss:0.04214072227478027
loss_pred:0.04801087826490402, decouple_loss:0.04018034785985947
Iteration: 268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462994635105133, gen p mean: -0.16644687950611115, mean p set: 0.4467797577381134
The modified gen p mean: 0.4470162093639374, gen p mean: -0.16765552759170532, mean p set: 0.4474965035915375
The modified gen p mean: 0.447511225938797, gen p mean: -0.17807720601558685, mean p set: 0.4479915201663971
loss_pred:0.04654316231608391, decouple_loss:0.04339839145541191
loss_pred:0.0458831824362278, decouple_loss:0.042007382959127426
loss_pred:0.04624936729669571, decouple_loss:0.042924914509058
Iteration: 269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469093978404999, gen p mean: -0.17669029533863068, mean p set: 0.44738972187042236
The modified gen p mean: 0.44654276967048645, gen p mean: -0.17530986666679382, mean p set: 0.44702303409576416
The modified gen p mean: 0.4470779299736023, gen p mean: -0.1753454953432083, mean p set: 0.4475582242012024
loss_pred:0.046528950333595276, decouple_loss:0.041906725615262985
loss_pred:0.0460837259888649, decouple_loss:0.041365332901477814
loss_pred:0.04560807719826698, decouple_loss:0.04257252439856529
Iteration: 270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469147026538849, gen p mean: -0.17994266748428345, mean p set: 0.447394996881485
The modified gen p mean: 0.4469561278820038, gen p mean: -0.18433763086795807, mean p set: 0.4474363923072815
The modified gen p mean: 0.4460639953613281, gen p mean: -0.17675702273845673, mean p set: 0.4465442895889282
loss_pred:0.04601847752928734, decouple_loss:0.040032655000686646loss_pred:0.046245746314525604, decouple_loss:0.04204442724585533
loss_pred:0.04729766398668289, decouple_loss:0.040234219282865524
2023-05-02 15:55:39 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.17769920825958252, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.1820165067911148, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.17612138390541077, mean p set: 0.45035696029663086
loss_pred:0.04796827584505081, decouple_loss:0.04048899933695793
loss_pred:0.04901045933365822, decouple_loss:0.04137970507144928
loss_pred:0.046908073127269745, decouple_loss:0.04121137037873268
WV_0_PC_1_EH_0_PS_40_6, loss: 0.050013601779937744, avg_mse: 0.05008488893508911
current test mse: 0.050085
Iteration: 271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472261667251587, gen p mean: -0.17508435249328613, mean p set: 0.4477064609527588
The modified gen p mean: 0.44785261154174805, gen p mean: -0.1822330504655838, mean p set: 0.44833290576934814
loss_pred:0.045061156153678894, decouple_loss:0.04048459604382515
loss_pred:0.046666234731674194, decouple_loss:0.04099966213107109
The modified gen p mean: 0.44653886556625366, gen p mean: -0.1771760880947113, mean p set: 0.44701918959617615
loss_pred:0.04614561051130295, decouple_loss:0.04011220484972
Iteration: 272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470824897289276, gen p mean: -0.1795796900987625, mean p set: 0.4475627839565277
The modified gen p mean: 0.44652092456817627, gen p mean: -0.17669852077960968, mean p set: 0.44700121879577637
The modified gen p mean: 0.44683948159217834, gen p mean: -0.1791830062866211, mean p set: 0.44731974601745605
loss_pred:0.04450243338942528, decouple_loss:0.04048145189881325
loss_pred:0.045533791184425354, decouple_loss:0.04090749844908714
loss_pred:0.04732632264494896, decouple_loss:0.0408320315182209
Iteration: 273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460422694683075, gen p mean: -0.17913608253002167, mean p set: 0.4465225338935852
The modified gen p mean: 0.4473232924938202, gen p mean: -0.1842779517173767, mean p set: 0.4478035867214203
The modified gen p mean: 0.4461408257484436, gen p mean: -0.1817265748977661, mean p set: 0.4466211497783661
loss_pred:0.04567374661564827, decouple_loss:0.03919501602649689
loss_pred:0.046453654766082764, decouple_loss:0.04009474813938141
loss_pred:0.046276647597551346, decouple_loss:0.03961379826068878
Iteration: 274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758936762809753, gen p mean: -0.18155249953269958, mean p set: 0.44806966185569763
The modified gen p mean: 0.4478233754634857, gen p mean: -0.18588529527187347, mean p set: 0.4483036994934082
The modified gen p mean: 0.44735151529312134, gen p mean: -0.17975085973739624, mean p set: 0.44783177971839905
loss_pred:0.045451801270246506, decouple_loss:0.03964107111096382
loss_pred:0.04444526508450508, decouple_loss:0.04138539358973503
loss_pred:0.04659287631511688, decouple_loss:0.040462926030159
Iteration: 275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44670340418815613, gen p mean: -0.17020685970783234, mean p set: 0.4471836984157562
The modified gen p mean: 0.44882553815841675, gen p mean: -0.18008136749267578, mean p set: 0.44930580258369446
The modified gen p mean: 0.44709211587905884, gen p mean: -0.17758546769618988, mean p set: 0.4475724399089813
loss_pred:0.04630858823657036, decouple_loss:0.040742840617895126
loss_pred:0.04599382355809212, decouple_loss:0.04072396084666252
loss_pred:0.04379080981016159, decouple_loss:0.04034649208188057
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465855360031128, gen p mean: -0.16818782687187195, mean p set: 0.4470658302307129
The modified gen p mean: 0.4471958875656128, gen p mean: -0.17400988936424255, mean p set: 0.4476762115955353
The modified gen p mean: 0.44686564803123474, gen p mean: -0.17637141048908234, mean p set: 0.4473459720611572
loss_pred:0.04833776503801346, decouple_loss:0.03926163166761398
loss_pred:0.04552705958485603, decouple_loss:0.04068319499492645
loss_pred:0.04495011642575264, decouple_loss:0.042887162417173386
Iteration: 277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468006491661072, gen p mean: -0.17801757156848907, mean p set: 0.4472809433937073
The modified gen p mean: 0.4460998475551605, gen p mean: -0.17511919140815735, mean p set: 0.44658011198043823
The modified gen p mean: 0.4473579227924347, gen p mean: -0.18035905063152313, mean p set: 0.4478381872177124
loss_pred:0.04677305743098259, decouple_loss:0.03907078504562378
loss_pred:0.0465068519115448, decouple_loss:0.03949074074625969
loss_pred:0.0459928885102272, decouple_loss:0.03998936712741852
Iteration: 278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446443647146225, gen p mean: -0.18799450993537903, mean p set: 0.44692397117614746
The modified gen p mean: 0.4480898678302765, gen p mean: -0.19069896638393402, mean p set: 0.448570191860199
The modified gen p mean: 0.4471054673194885, gen p mean: -0.1865200698375702, mean p set: 0.447585791349411
loss_pred:0.04562937840819359, decouple_loss:0.03827328979969025
loss_pred:0.046523433178663254, decouple_loss:0.03920413553714752
loss_pred:0.04571651667356491, decouple_loss:0.03822535648941994
Iteration: 279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471133053302765, gen p mean: -0.18150416016578674, mean p set: 0.447593629360199
The modified gen p mean: 0.4459840655326843, gen p mean: -0.1801675707101822, mean p set: 0.4464643895626068
The modified gen p mean: 0.4471782445907593, gen p mean: -0.1829497516155243, mean p set: 0.4476585388183594
loss_pred:0.0445965975522995, decouple_loss:0.037644993513822556
loss_pred:0.04752755165100098, decouple_loss:0.03869239240884781
loss_pred:0.04506382346153259, decouple_loss:0.038078684359788895
Iteration: 280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44625115394592285, gen p mean: -0.1652502566576004, mean p set: 0.44673141837120056
The modified gen p mean: 0.4460238814353943, gen p mean: -0.16852626204490662, mean p set: 0.446504145860672
The modified gen p mean: 0.4458525478839874, gen p mean: -0.1681048423051834, mean p set: 0.4463328719139099
loss_pred:0.046886228024959564, decouple_loss:0.038738809525966644
loss_pred:0.046545907855033875, decouple_loss:0.03981291130185127
loss_pred:0.046655263751745224, decouple_loss:0.03917093202471733
2023-05-02 15:59:22 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.16572949290275574, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.16237594187259674, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.16062910854816437, mean p set: 0.45035696029663086
loss_pred:0.04819054529070854, decouple_loss:0.0390678234398365
loss_pred:0.04719413071870804, decouple_loss:0.03830047324299812
loss_pred:0.04625339433550835, decouple_loss:0.03917603939771652
WV_0_PC_1_EH_0_PS_40_6, loss: 0.0491550974547863, avg_mse: 0.0492757149040699
current test mse: 0.049276
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44619259238243103, gen p mean: -0.1648024171590805, mean p set: 0.44667288661003113
The modified gen p mean: 0.44732123613357544, gen p mean: -0.16653786599636078, mean p set: 0.44780153036117554
loss_pred:0.0464128702878952, decouple_loss:0.03787154331803322
loss_pred:0.0488693006336689, decouple_loss:0.038615625351667404
The modified gen p mean: 0.44772395491600037, gen p mean: -0.15751443803310394, mean p set: 0.44820424914360046
loss_pred:0.04773003235459328, decouple_loss:0.03854566067457199
Iteration: 282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763290882110596, gen p mean: -0.17953790724277496, mean p set: 0.44811320304870605
The modified gen p mean: 0.4468432366847992, gen p mean: -0.17400144040584564, mean p set: 0.4473235309123993
The modified gen p mean: 0.44716641306877136, gen p mean: -0.1714053750038147, mean p set: 0.44764673709869385
loss_pred:0.04568794369697571, decouple_loss:0.038169022649526596
loss_pred:0.04759281873703003, decouple_loss:0.03839126601815224
loss_pred:0.046994421631097794, decouple_loss:0.0390358529984951
Iteration: 283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466818571090698, gen p mean: -0.18318624794483185, mean p set: 0.4471621811389923
The modified gen p mean: 0.44804468750953674, gen p mean: -0.1812577098608017, mean p set: 0.44852498173713684
The modified gen p mean: 0.4476127028465271, gen p mean: -0.17947886884212494, mean p set: 0.4480930268764496
loss_pred:0.04781346023082733, decouple_loss:0.03979114443063736
loss_pred:0.046470366418361664, decouple_loss:0.0393163301050663
loss_pred:0.0479702427983284, decouple_loss:0.03833254426717758
Iteration: 284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784584641456604, gen p mean: -0.1855868250131607, mean p set: 0.44832614064216614
The modified gen p mean: 0.4473423361778259, gen p mean: -0.18280676007270813, mean p set: 0.447822630405426
The modified gen p mean: 0.44626644253730774, gen p mean: -0.1830863505601883, mean p set: 0.4467467665672302
loss_pred:0.04569767415523529, decouple_loss:0.038893118500709534
loss_pred:0.04647207260131836, decouple_loss:0.038732681423425674
loss_pred:0.04656941816210747, decouple_loss:0.03951898217201233
Iteration: 285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464249908924103, gen p mean: -0.183226078748703, mean p set: 0.4469052851200104
The modified gen p mean: 0.44786536693573, gen p mean: -0.18391691148281097, mean p set: 0.4483456313610077
The modified gen p mean: 0.44786500930786133, gen p mean: -0.18450669944286346, mean p set: 0.44834527373313904
loss_pred:0.04638632386922836, decouple_loss:0.04006708413362503
loss_pred:0.046618033200502396, decouple_loss:0.040119610726833344
loss_pred:0.046620920300483704, decouple_loss:0.0407874658703804
Iteration: 286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466300308704376, gen p mean: -0.1793910413980484, mean p set: 0.4471103250980377
The modified gen p mean: 0.44782301783561707, gen p mean: -0.18526563048362732, mean p set: 0.44830334186553955
The modified gen p mean: 0.44827932119369507, gen p mean: -0.18323370814323425, mean p set: 0.44875964522361755
loss_pred:0.0475098118185997, decouple_loss:0.038313496857881546
loss_pred:0.04627242311835289, decouple_loss:0.03798680379986763
loss_pred:0.043898679316043854, decouple_loss:0.03848295658826828
Iteration: 287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473123550415039, gen p mean: -0.17465424537658691, mean p set: 0.4477926790714264
The modified gen p mean: 0.44727715849876404, gen p mean: -0.17885230481624603, mean p set: 0.44775745272636414
The modified gen p mean: 0.448651522397995, gen p mean: -0.17025023698806763, mean p set: 0.4491317868232727
loss_pred:0.045579541474580765, decouple_loss:0.03733736276626587loss_pred:0.04581978917121887, decouple_loss:0.03710195794701576
loss_pred:0.045084550976753235, decouple_loss:0.03826337307691574
Iteration: 288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44665247201919556, gen p mean: -0.1697552353143692, mean p set: 0.44713273644447327
The modified gen p mean: 0.4460647404193878, gen p mean: -0.17359669506549835, mean p set: 0.4465450048446655
The modified gen p mean: 0.447773814201355, gen p mean: -0.17229397594928741, mean p set: 0.4482541084289551
loss_pred:0.04664195328950882, decouple_loss:0.03803160414099693
loss_pred:0.046316102147102356, decouple_loss:0.038400691002607346
loss_pred:0.045759640634059906, decouple_loss:0.03700661659240723
Iteration: 289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733962416648865, gen p mean: -0.1789686530828476, mean p set: 0.44781988859176636
The modified gen p mean: 0.4472848176956177, gen p mean: -0.17693740129470825, mean p set: 0.4477651119232178
The modified gen p mean: 0.4467615783214569, gen p mean: -0.17738735675811768, mean p set: 0.447241872549057
loss_pred:0.04792805761098862, decouple_loss:0.03720706328749657
loss_pred:0.04635630175471306, decouple_loss:0.03845927119255066
loss_pred:0.04618736356496811, decouple_loss:0.03725140541791916
Iteration: 290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483192265033722, gen p mean: -0.17291568219661713, mean p set: 0.4487995207309723
The modified gen p mean: 0.44667744636535645, gen p mean: -0.17981792986392975, mean p set: 0.44715774059295654
The modified gen p mean: 0.44795337319374084, gen p mean: -0.16943858563899994, mean p set: 0.44843369722366333
loss_pred:0.04679568111896515, decouple_loss:0.03744548559188843
loss_pred:0.04649067670106888, decouple_loss:0.03677023947238922
loss_pred:0.044496260583400726, decouple_loss:0.03799145296216011
2023-05-02 16:03:43 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.1792607605457306, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.18202127516269684, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.1766454130411148, mean p set: 0.45035696029663086
loss_pred:0.04720981791615486, decouple_loss:0.038604140281677246
loss_pred:0.04816906154155731, decouple_loss:0.039942409843206406
loss_pred:0.046028222888708115, decouple_loss:0.03964020311832428
WV_0_PC_1_EH_0_PS_40_6, loss: 0.049105480313301086, avg_mse: 0.04926478862762451
current test mse: 0.049265
Iteration: 291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475368559360504, gen p mean: -0.17438821494579315, mean p set: 0.4480171501636505
loss_pred:0.04546234756708145, decouple_loss:0.03917273133993149
The modified gen p mean: 0.4466976225376129, gen p mean: -0.17571881413459778, mean p set: 0.447177916765213
loss_pred:0.045301806181669235, decouple_loss:0.03985730558633804
The modified gen p mean: 0.44812795519828796, gen p mean: -0.1838250607252121, mean p set: 0.44860827922821045
loss_pred:0.04559750109910965, decouple_loss:0.04008207842707634
Iteration: 292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811680912971497, gen p mean: -0.17765939235687256, mean p set: 0.4485970735549927
The modified gen p mean: 0.44725462794303894, gen p mean: -0.17797507345676422, mean p set: 0.44773492217063904
The modified gen p mean: 0.4486333727836609, gen p mean: -0.1839015632867813, mean p set: 0.449113667011261
loss_pred:0.04516018554568291, decouple_loss:0.03835856914520264
loss_pred:0.04555673897266388, decouple_loss:0.038351960480213165
loss_pred:0.04697897285223007, decouple_loss:0.03949799761176109
Iteration: 293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466927945613861, gen p mean: -0.18459226191043854, mean p set: 0.4471730887889862
The modified gen p mean: 0.4481970965862274, gen p mean: -0.1796816885471344, mean p set: 0.4486773908138275
The modified gen p mean: 0.4480939507484436, gen p mean: -0.17777152359485626, mean p set: 0.4485742151737213
loss_pred:0.04671451449394226, decouple_loss:0.038009967654943466
loss_pred:0.04432787001132965, decouple_loss:0.03690946102142334
loss_pred:0.04403988644480705, decouple_loss:0.03844205290079117
Iteration: 294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44809916615486145, gen p mean: -0.18239067494869232, mean p set: 0.44857946038246155
The modified gen p mean: 0.4460369944572449, gen p mean: -0.17886202037334442, mean p set: 0.44651728868484497
The modified gen p mean: 0.4483368694782257, gen p mean: -0.18102091550827026, mean p set: 0.4488171935081482
loss_pred:0.04502762854099274, decouple_loss:0.037303172051906586
loss_pred:0.044964950531721115, decouple_loss:0.038852568715810776
loss_pred:0.04463675618171692, decouple_loss:0.03736679255962372
Iteration: 295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481574296951294, gen p mean: -0.1901632398366928, mean p set: 0.4486377537250519
The modified gen p mean: 0.44784215092658997, gen p mean: -0.18355949223041534, mean p set: 0.44832247495651245
The modified gen p mean: 0.4473298490047455, gen p mean: -0.18559721112251282, mean p set: 0.4478101134300232
loss_pred:0.04576918110251427, decouple_loss:0.037802956998348236
loss_pred:0.04621640220284462, decouple_loss:0.0382629930973053
loss_pred:0.04471525549888611, decouple_loss:0.037276409566402435
Iteration: 296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471943974494934, gen p mean: -0.18012744188308716, mean p set: 0.4476746618747711
The modified gen p mean: 0.4481734037399292, gen p mean: -0.1802099645137787, mean p set: 0.4486536979675293
The modified gen p mean: 0.44762372970581055, gen p mean: -0.18766836822032928, mean p set: 0.44810402393341064
loss_pred:0.044509660452604294, decouple_loss:0.038796566426754
loss_pred:0.044680457562208176, decouple_loss:0.03687852993607521
loss_pred:0.04403470456600189, decouple_loss:0.03747881203889847
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455784261226654, gen p mean: -0.18248116970062256, mean p set: 0.4460587203502655
The modified gen p mean: 0.4463234841823578, gen p mean: -0.18355964124202728, mean p set: 0.4468037486076355
The modified gen p mean: 0.44744789600372314, gen p mean: -0.18337967991828918, mean p set: 0.44792816042900085
loss_pred:0.04498332738876343, decouple_loss:0.03869999200105667
loss_pred:0.04573211818933487, decouple_loss:0.03593917563557625
loss_pred:0.04383689537644386, decouple_loss:0.03703255206346512
Iteration: 298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751396775245667, gen p mean: -0.18539829552173615, mean p set: 0.44799429178237915
The modified gen p mean: 0.4470152258872986, gen p mean: -0.1943816840648651, mean p set: 0.4474954903125763
The modified gen p mean: 0.44792696833610535, gen p mean: -0.18828366696834564, mean p set: 0.44840726256370544
loss_pred:0.04350386559963226, decouple_loss:0.03621523827314377
loss_pred:0.046214401721954346, decouple_loss:0.03596891462802887
loss_pred:0.04448689892888069, decouple_loss:0.03637141361832619
Iteration: 299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479922950267792, gen p mean: -0.19076977670192719, mean p set: 0.4484725892543793
The modified gen p mean: 0.4480590224266052, gen p mean: -0.20024436712265015, mean p set: 0.4485393166542053
The modified gen p mean: 0.4476580023765564, gen p mean: -0.1917504370212555, mean p set: 0.4481382668018341
loss_pred:0.043237678706645966, decouple_loss:0.03627069666981697
loss_pred:0.04506887495517731, decouple_loss:0.03837011754512787
loss_pred:0.04470144584774971, decouple_loss:0.03706860914826393
Iteration: 300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474705159664154, gen p mean: -0.1947183758020401, mean p set: 0.4479508101940155
The modified gen p mean: 0.44733601808547974, gen p mean: -0.19830144941806793, mean p set: 0.44781628251075745
The modified gen p mean: 0.4458562433719635, gen p mean: -0.1965804547071457, mean p set: 0.446336567401886
loss_pred:0.04450568929314613, decouple_loss:0.03673475608229637
loss_pred:0.04522858187556267, decouple_loss:0.037846773862838745
loss_pred:0.04497908055782318, decouple_loss:0.03626871854066849
2023-05-02 16:07:27 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.1911095529794693, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.1891603171825409, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.18565483391284943, mean p set: 0.45035696029663086
loss_pred:0.047463566064834595, decouple_loss:0.03861761465668678
loss_pred:0.046381086111068726, decouple_loss:0.03760019317269325
loss_pred:0.0451279915869236, decouple_loss:0.03868803009390831
WV_0_PC_1_EH_0_PS_40_6, loss: 0.04823931306600571, avg_mse: 0.04840034991502762
current test mse: 0.0484
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
NaN value num: 0
Iteration: 301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451646089553833, gen p mean: -0.1935790628194809, mean p set: 0.45212632417678833
The modified gen p mean: 0.45112499594688416, gen p mean: -0.19269300997257233, mean p set: 0.45160529017448425
loss_pred:0.0478929728269577, decouple_loss:0.04439214989542961
loss_pred:0.04827262833714485, decouple_loss:0.04674527794122696
The modified gen p mean: 0.45086491107940674, gen p mean: -0.19349844753742218, mean p set: 0.45134520530700684
loss_pred:0.04910396784543991, decouple_loss:0.0478803813457489
Iteration: 302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45079854130744934, gen p mean: -0.19516286253929138, mean p set: 0.4512788653373718
The modified gen p mean: 0.4533771276473999, gen p mean: -0.19939552247524261, mean p set: 0.453857421875
The modified gen p mean: 0.45076414942741394, gen p mean: -0.19990211725234985, mean p set: 0.45124444365501404
loss_pred:0.048942163586616516, decouple_loss:0.046878427267074585
loss_pred:0.046633534133434296, decouple_loss:0.04811426252126694
loss_pred:0.04895411431789398, decouple_loss:0.048445265740156174
Iteration: 303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45168137550354004, gen p mean: -0.22039175033569336, mean p set: 0.4521616995334625
The modified gen p mean: 0.45083943009376526, gen p mean: -0.2179296910762787, mean p set: 0.45131972432136536
The modified gen p mean: 0.4514845609664917, gen p mean: -0.2257484346628189, mean p set: 0.4519648849964142
loss_pred:0.04665550962090492, decouple_loss:0.047301653772592545
loss_pred:0.04745488986372948, decouple_loss:0.046187419444322586
loss_pred:0.048527058213949203, decouple_loss:0.04904019087553024
Iteration: 304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528735876083374, gen p mean: -0.2037830352783203, mean p set: 0.4533538818359375
The modified gen p mean: 0.4534478485584259, gen p mean: -0.2065151035785675, mean p set: 0.4539281725883484
The modified gen p mean: 0.45364895462989807, gen p mean: -0.21111395955085754, mean p set: 0.45412924885749817
loss_pred:0.04616405814886093, decouple_loss:0.0468645840883255
loss_pred:0.04696701839566231, decouple_loss:0.04664391279220581
loss_pred:0.046076998114585876, decouple_loss:0.04502461850643158
Iteration: 305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45091116428375244, gen p mean: -0.19012139737606049, mean p set: 0.4513914883136749
The modified gen p mean: 0.45398658514022827, gen p mean: -0.18861232697963715, mean p set: 0.45446687936782837
The modified gen p mean: 0.4521265923976898, gen p mean: -0.19399307668209076, mean p set: 0.4526068866252899
loss_pred:0.04608948528766632, decouple_loss:0.04384136199951172
loss_pred:0.047105688601732254, decouple_loss:0.043951306492090225
loss_pred:0.04763190448284149, decouple_loss:0.04522203281521797
Iteration: 306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452980101108551, gen p mean: -0.2030564695596695, mean p set: 0.4534603953361511
The modified gen p mean: 0.45352527499198914, gen p mean: -0.19934764504432678, mean p set: 0.45400553941726685
The modified gen p mean: 0.45133912563323975, gen p mean: -0.2043410688638687, mean p set: 0.45181941986083984
loss_pred:0.044440362602472305, decouple_loss:0.04257311671972275
loss_pred:0.04654959216713905, decouple_loss:0.04245132952928543
loss_pred:0.04621202498674393, decouple_loss:0.04341274872422218
Iteration: 307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518086910247803, gen p mean: -0.22225773334503174, mean p set: 0.452288955450058
The modified gen p mean: 0.45145851373672485, gen p mean: -0.21230199933052063, mean p set: 0.45193883776664734
The modified gen p mean: 0.45120957493782043, gen p mean: -0.21768818795681, mean p set: 0.45168986916542053
loss_pred:0.04748678579926491, decouple_loss:0.04240725189447403
loss_pred:0.046512357890605927, decouple_loss:0.04215192422270775
loss_pred:0.045777950435876846, decouple_loss:0.042746782302856445
Iteration: 308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503172039985657, gen p mean: -0.23050065338611603, mean p set: 0.45079749822616577
The modified gen p mean: 0.4508376121520996, gen p mean: -0.2314203679561615, mean p set: 0.4513179063796997
The modified gen p mean: 0.45068320631980896, gen p mean: -0.2259238213300705, mean p set: 0.45116350054740906
loss_pred:0.04734518751502037, decouple_loss:0.043298929929733276loss_pred:0.04682709649205208, decouple_loss:0.043294407427310944
loss_pred:0.04553781449794769, decouple_loss:0.04274974763393402
Iteration: 309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45144495368003845, gen p mean: -0.2528958320617676, mean p set: 0.45192527770996094
The modified gen p mean: 0.45036497712135315, gen p mean: -0.24515116214752197, mean p set: 0.45084527134895325
The modified gen p mean: 0.45081257820129395, gen p mean: -0.24574822187423706, mean p set: 0.45129284262657166
loss_pred:0.0465514250099659, decouple_loss:0.047711264342069626
loss_pred:0.0471627451479435, decouple_loss:0.043075088411569595
loss_pred:0.045256901532411575, decouple_loss:0.043265871703624725
Iteration: 310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45115646719932556, gen p mean: -0.24292415380477905, mean p set: 0.45163676142692566
The modified gen p mean: 0.4513283371925354, gen p mean: -0.24725928902626038, mean p set: 0.4518086314201355
The modified gen p mean: 0.45130497217178345, gen p mean: -0.24728675186634064, mean p set: 0.45178526639938354
loss_pred:0.04611658677458763, decouple_loss:0.04241734370589256
loss_pred:0.04716096073389053, decouple_loss:0.04591375216841698
loss_pred:0.0468313992023468, decouple_loss:0.04542693495750427
2023-05-02 16:11:46 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.23086488246917725, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.2356170415878296, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.2279670089483261, mean p set: 0.45035696029663086
loss_pred:0.04771582782268524, decouple_loss:0.044118400663137436
loss_pred:0.04900667071342468, decouple_loss:0.04625576734542847
loss_pred:0.04627341032028198, decouple_loss:0.04639694467186928
WV_0_PC_1_EH_0_PS_40_6, loss: 0.04994482547044754, avg_mse: 0.049994826316833496
current test mse: 0.049995
Iteration: 311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523485600948334, gen p mean: -0.23190197348594666, mean p set: 0.45282885432243347
loss_pred:0.04464958980679512, decouple_loss:0.04417106881737709
The modified gen p mean: 0.45159712433815, gen p mean: -0.24193492531776428, mean p set: 0.4520774185657501
loss_pred:0.045972373336553574, decouple_loss:0.04687332361936569
The modified gen p mean: 0.45175886154174805, gen p mean: -0.23469164967536926, mean p set: 0.45223915576934814
loss_pred:0.045911360532045364, decouple_loss:0.043164294213056564
Iteration: 312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526425898075104, gen p mean: -0.23643551766872406, mean p set: 0.4531228840351105
The modified gen p mean: 0.45123812556266785, gen p mean: -0.22718334197998047, mean p set: 0.45171838998794556
The modified gen p mean: 0.45009103417396545, gen p mean: -0.23528531193733215, mean p set: 0.4505713880062103
loss_pred:0.046144671738147736, decouple_loss:0.044215813279151917
loss_pred:0.044989023357629776, decouple_loss:0.043101966381073
loss_pred:0.04540998488664627, decouple_loss:0.04274798929691315
Iteration: 313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45068272948265076, gen p mean: -0.22863183915615082, mean p set: 0.45116302371025085
The modified gen p mean: 0.45059406757354736, gen p mean: -0.22735276818275452, mean p set: 0.45107436180114746
The modified gen p mean: 0.45261451601982117, gen p mean: -0.23008236289024353, mean p set: 0.45309484004974365
loss_pred:0.046312250196933746, decouple_loss:0.04225277155637741
loss_pred:0.04488359019160271, decouple_loss:0.04199737682938576
loss_pred:0.04337373003363609, decouple_loss:0.0426846407353878
Iteration: 314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516487717628479, gen p mean: -0.2265603244304657, mean p set: 0.4521290957927704
The modified gen p mean: 0.4512366056442261, gen p mean: -0.22584377229213715, mean p set: 0.45171689987182617
The modified gen p mean: 0.4519747793674469, gen p mean: -0.22939607501029968, mean p set: 0.4524551033973694
loss_pred:0.0442376546561718, decouple_loss:0.042112722992897034
loss_pred:0.04630874842405319, decouple_loss:0.04154334217309952
loss_pred:0.04652499780058861, decouple_loss:0.04183286800980568
Iteration: 315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511992931365967, gen p mean: -0.23147258162498474, mean p set: 0.4516795575618744
The modified gen p mean: 0.45202162861824036, gen p mean: -0.23396119475364685, mean p set: 0.45250189304351807
loss_pred:0.04432950168848038, decouple_loss:0.04105456545948982
The modified gen p mean: 0.4513355493545532, gen p mean: -0.23282520473003387, mean p set: 0.4518158733844757
loss_pred:0.044935617595911026, decouple_loss:0.041366513818502426
loss_pred:0.04542943090200424, decouple_loss:0.04166316241025925
Iteration: 316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527490735054016, gen p mean: -0.24268843233585358, mean p set: 0.4532293677330017
The modified gen p mean: 0.4515432119369507, gen p mean: -0.23282746970653534, mean p set: 0.4520235061645508
The modified gen p mean: 0.45204201340675354, gen p mean: -0.25142261385917664, mean p set: 0.45252230763435364
loss_pred:0.04354815185070038, decouple_loss:0.04278252273797989
loss_pred:0.04413728788495064, decouple_loss:0.04184584692120552
loss_pred:0.04571796953678131, decouple_loss:0.043278180062770844
Iteration: 317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45107680559158325, gen p mean: -0.24491924047470093, mean p set: 0.45155712962150574
The modified gen p mean: 0.4532676935195923, gen p mean: -0.23955340683460236, mean p set: 0.45374795794487
The modified gen p mean: 0.4521545469760895, gen p mean: -0.24579741060733795, mean p set: 0.4526348412036896
loss_pred:0.04510428383946419, decouple_loss:0.04138529673218727
loss_pred:0.044319212436676025, decouple_loss:0.04220476746559143
loss_pred:0.0450141467154026, decouple_loss:0.04233120381832123
Iteration: 318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505007266998291, gen p mean: -0.23679809272289276, mean p set: 0.4509810209274292
The modified gen p mean: 0.45170262455940247, gen p mean: -0.23218511044979095, mean p set: 0.45218291878700256
The modified gen p mean: 0.45152655243873596, gen p mean: -0.22588598728179932, mean p set: 0.45200681686401367
loss_pred:0.046639204025268555, decouple_loss:0.04135054722428322
loss_pred:0.04523048177361488, decouple_loss:0.04074447229504585
loss_pred:0.043894220143556595, decouple_loss:0.041026823222637177
Iteration: 319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516104459762573, gen p mean: -0.22910596430301666, mean p set: 0.4520907402038574
The modified gen p mean: 0.45128321647644043, gen p mean: -0.23399421572685242, mean p set: 0.4517635107040405
The modified gen p mean: 0.45055311918258667, gen p mean: -0.24430815875530243, mean p set: 0.45103341341018677
loss_pred:0.044123902916908264, decouple_loss:0.039092253893613815
loss_pred:0.043834786862134933, decouple_loss:0.040428321808576584
loss_pred:0.045039866119623184, decouple_loss:0.04170208051800728
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44886159896850586, gen p mean: -0.24340935051441193, mean p set: 0.44934189319610596
The modified gen p mean: 0.44813084602355957, gen p mean: -0.24153336882591248, mean p set: 0.44861117005348206
The modified gen p mean: 0.44797804951667786, gen p mean: -0.24163079261779785, mean p set: 0.44845834374427795
loss_pred:0.04588750749826431, decouple_loss:0.04404640570282936
loss_pred:0.04770383983850479, decouple_loss:0.044175051152706146
loss_pred:0.04777994006872177, decouple_loss:0.04389522969722748
2023-05-02 16:16:05 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.22320085763931274, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.2268955409526825, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.22035904228687286, mean p set: 0.45035696029663086
loss_pred:0.04654470831155777, decouple_loss:0.043261561542749405
loss_pred:0.04780459776520729, decouple_loss:0.04561331495642662
loss_pred:0.04503574222326279, decouple_loss:0.0454278402030468
WV_0_PC_1_EH_0_PS_40_6, loss: 0.048700060695409775, avg_mse: 0.04873514547944069
current test mse: 0.048735
Iteration: 321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489286243915558, gen p mean: -0.22672222554683685, mean p set: 0.4494089186191559
loss_pred:0.04522467032074928, decouple_loss:0.04510142654180527
The modified gen p mean: 0.4489569664001465, gen p mean: -0.2229718267917633, mean p set: 0.4494372606277466
loss_pred:0.04544154182076454, decouple_loss:0.046616412699222565
The modified gen p mean: 0.4490557909011841, gen p mean: -0.22889532148838043, mean p set: 0.4495360851287842
loss_pred:0.04747920483350754, decouple_loss:0.04602073132991791
Iteration: 322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482795000076294, gen p mean: -0.20816685259342194, mean p set: 0.4487597644329071
The modified gen p mean: 0.449379563331604, gen p mean: -0.21589551866054535, mean p set: 0.4498598277568817
The modified gen p mean: 0.4483850598335266, gen p mean: -0.21414758265018463, mean p set: 0.4488653242588043
loss_pred:0.04654427245259285, decouple_loss:0.04468883201479912
loss_pred:0.04468994960188866, decouple_loss:0.045669108629226685
loss_pred:0.04456949606537819, decouple_loss:0.045662038028240204
Iteration: 323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491598308086395, gen p mean: -0.21404412388801575, mean p set: 0.4496401250362396
The modified gen p mean: 0.4489496052265167, gen p mean: -0.2241361439228058, mean p set: 0.44942986965179443
The modified gen p mean: 0.4473295211791992, gen p mean: -0.2170190066099167, mean p set: 0.4478098452091217
loss_pred:0.046597544103860855, decouple_loss:0.04317401349544525
loss_pred:0.045827895402908325, decouple_loss:0.04407680407166481
loss_pred:0.04715333506464958, decouple_loss:0.04201838746666908
Iteration: 324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475438892841339, gen p mean: -0.22392091155052185, mean p set: 0.4480241537094116
The modified gen p mean: 0.4487845003604889, gen p mean: -0.22039392590522766, mean p set: 0.4492647647857666
The modified gen p mean: 0.4480119049549103, gen p mean: -0.21968494355678558, mean p set: 0.448492169380188
loss_pred:0.04664988070726395, decouple_loss:0.04122454673051834
loss_pred:0.04318268597126007, decouple_loss:0.04226455092430115
loss_pred:0.045752450823783875, decouple_loss:0.04442204162478447
Iteration: 325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492949843406677, gen p mean: -0.22766414284706116, mean p set: 0.4497752785682678
The modified gen p mean: 0.44813117384910583, gen p mean: -0.22281424701213837, mean p set: 0.4486114978790283
The modified gen p mean: 0.4486387372016907, gen p mean: -0.22796615958213806, mean p set: 0.44911903142929077
loss_pred:0.0442749448120594, decouple_loss:0.04254240170121193
loss_pred:0.04484843090176582, decouple_loss:0.041972119361162186
loss_pred:0.045650407671928406, decouple_loss:0.042891308665275574
Iteration: 326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484134316444397, gen p mean: -0.23457522690296173, mean p set: 0.4488937258720398
The modified gen p mean: 0.4491133987903595, gen p mean: -0.2356710284948349, mean p set: 0.4495936930179596
The modified gen p mean: 0.44877126812934875, gen p mean: -0.23407471179962158, mean p set: 0.44925159215927124
loss_pred:0.045863643288612366, decouple_loss:0.04186776280403137
loss_pred:0.04502328485250473, decouple_loss:0.04048418998718262
loss_pred:0.04483270272612572, decouple_loss:0.04069041088223457
Iteration: 327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494182765483856, gen p mean: -0.2298842966556549, mean p set: 0.4498986005783081
The modified gen p mean: 0.4490394592285156, gen p mean: -0.2289784550666809, mean p set: 0.44951972365379333
The modified gen p mean: 0.449386328458786, gen p mean: -0.23846495151519775, mean p set: 0.4498666524887085
loss_pred:0.04619783163070679, decouple_loss:0.041689302772283554
loss_pred:0.04364942014217377, decouple_loss:0.03983604907989502
loss_pred:0.04615538567304611, decouple_loss:0.03979130834341049
Iteration: 328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480970501899719, gen p mean: -0.22817614674568176, mean p set: 0.448577344417572
The modified gen p mean: 0.4481603503227234, gen p mean: -0.22462309896945953, mean p set: 0.4486406445503235
The modified gen p mean: 0.4489581286907196, gen p mean: -0.2219843715429306, mean p set: 0.4494384229183197
loss_pred:0.044129472225904465, decouple_loss:0.03957653418183327
loss_pred:0.04544578492641449, decouple_loss:0.0404914952814579
loss_pred:0.04388659819960594, decouple_loss:0.04046810045838356
Iteration: 329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481983482837677, gen p mean: -0.2180565744638443, mean p set: 0.4486786425113678
The modified gen p mean: 0.4478198289871216, gen p mean: -0.21797390282154083, mean p set: 0.4483001232147217
The modified gen p mean: 0.44908520579338074, gen p mean: -0.2183171510696411, mean p set: 0.44956550002098083
loss_pred:0.04505770653486252, decouple_loss:0.04024196043610573
loss_pred:0.04565994814038277, decouple_loss:0.03921665623784065
loss_pred:0.04481211304664612, decouple_loss:0.03954875096678734
Iteration: 330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488207697868347, gen p mean: -0.2122764140367508, mean p set: 0.4493010640144348
The modified gen p mean: 0.4491555690765381, gen p mean: -0.21482239663600922, mean p set: 0.4496358335018158
The modified gen p mean: 0.44899260997772217, gen p mean: -0.21388258039951324, mean p set: 0.44947290420532227
loss_pred:0.04387650266289711, decouple_loss:0.038564521819353104
loss_pred:0.04415687173604965, decouple_loss:0.040134549140930176
loss_pred:0.04322516918182373, decouple_loss:0.039720576256513596
2023-05-02 16:19:49 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.20994175970554352, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.20585651695728302, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.20511385798454285, mean p set: 0.45035696029663086
loss_pred:0.04643647372722626, decouple_loss:0.0396694615483284
loss_pred:0.045482225716114044, decouple_loss:0.03926187381148338
loss_pred:0.04401860386133194, decouple_loss:0.04045393690466881
WV_0_PC_1_EH_0_PS_40_6, loss: 0.047302186489105225, avg_mse: 0.04749083146452904
current test mse: 0.047491
Iteration: 331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819584488868713, gen p mean: -0.21194814145565033, mean p set: 0.4486761689186096
loss_pred:0.04452626407146454, decouple_loss:0.03740214928984642
The modified gen p mean: 0.4494486153125763, gen p mean: -0.21031460165977478, mean p set: 0.449928879737854
loss_pred:0.04424028843641281, decouple_loss:0.03788326308131218
The modified gen p mean: 0.44856327772140503, gen p mean: -0.2125869244337082, mean p set: 0.4490435719490051
loss_pred:0.04352528974413872, decouple_loss:0.0382176898419857
Iteration: 332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788864254951477, gen p mean: -0.20218989253044128, mean p set: 0.44836896657943726
The modified gen p mean: 0.4483930766582489, gen p mean: -0.2066573202610016, mean p set: 0.4488733410835266
The modified gen p mean: 0.44853857159614563, gen p mean: -0.20011301338672638, mean p set: 0.44901883602142334
loss_pred:0.04597357660531998, decouple_loss:0.03882967680692673
loss_pred:0.04511553794145584, decouple_loss:0.03786906972527504
loss_pred:0.043090518563985825, decouple_loss:0.039213355630636215
Iteration: 333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493986666202545, gen p mean: -0.215034618973732, mean p set: 0.4498789310455322
The modified gen p mean: 0.44924524426460266, gen p mean: -0.21201321482658386, mean p set: 0.44972550868988037
The modified gen p mean: 0.4488867223262787, gen p mean: -0.21323558688163757, mean p set: 0.4493670165538788
loss_pred:0.04471733048558235, decouple_loss:0.03889409080147743
loss_pred:0.04426458105444908, decouple_loss:0.03761214017868042
loss_pred:0.0421714186668396, decouple_loss:0.037362370640039444
Iteration: 334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495750963687897, gen p mean: -0.22404919564723969, mean p set: 0.45005539059638977
The modified gen p mean: 0.4489731192588806, gen p mean: -0.21855416893959045, mean p set: 0.4494534134864807
The modified gen p mean: 0.4489932358264923, gen p mean: -0.21900729835033417, mean p set: 0.4494735598564148
loss_pred:0.04314704239368439, decouple_loss:0.038120195269584656
loss_pred:0.04275638610124588, decouple_loss:0.03638627380132675
loss_pred:0.04372705891728401, decouple_loss:0.036862049251794815
Iteration: 335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485247731208801, gen p mean: -0.21800807118415833, mean p set: 0.4490050673484802
The modified gen p mean: 0.4479416608810425, gen p mean: -0.21411511301994324, mean p set: 0.4484219551086426
The modified gen p mean: 0.44948339462280273, gen p mean: -0.22361509501934052, mean p set: 0.4499637186527252
loss_pred:0.044460903853178024, decouple_loss:0.040057674050331116
loss_pred:0.04538627341389656, decouple_loss:0.03836556151509285
loss_pred:0.04266618937253952, decouple_loss:0.03757605329155922
Iteration: 336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44903847575187683, gen p mean: -0.22630661725997925, mean p set: 0.44951876997947693
The modified gen p mean: 0.4486227035522461, gen p mean: -0.23002979159355164, mean p set: 0.4491029977798462
The modified gen p mean: 0.44751986861228943, gen p mean: -0.22847768664360046, mean p set: 0.4480001628398895
loss_pred:0.044157836586236954, decouple_loss:0.03803436830639839
loss_pred:0.042928822338581085, decouple_loss:0.03777157887816429
loss_pred:0.04510430246591568, decouple_loss:0.03673992305994034
Iteration: 337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486974775791168, gen p mean: -0.23105691373348236, mean p set: 0.44917774200439453
The modified gen p mean: 0.4479732811450958, gen p mean: -0.22669655084609985, mean p set: 0.4484536051750183
The modified gen p mean: 0.44952592253685, gen p mean: -0.23892591893672943, mean p set: 0.4500062167644501
loss_pred:0.04367193207144737, decouple_loss:0.03647535666823387
loss_pred:0.04464411735534668, decouple_loss:0.03738676756620407
loss_pred:0.04415883496403694, decouple_loss:0.03625359758734703
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491564631462097, gen p mean: -0.22917969524860382, mean p set: 0.4496367573738098
The modified gen p mean: 0.4486866891384125, gen p mean: -0.22270585596561432, mean p set: 0.4491669833660126
The modified gen p mean: 0.4494735300540924, gen p mean: -0.22648471593856812, mean p set: 0.4499538242816925
loss_pred:0.04293982684612274, decouple_loss:0.03652260825037956
loss_pred:0.04268641769886017, decouple_loss:0.036455973982810974
loss_pred:0.043481189757585526, decouple_loss:0.03609234839677811
Iteration: 339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779306650161743, gen p mean: -0.22118620574474335, mean p set: 0.4482733905315399
The modified gen p mean: 0.4484595060348511, gen p mean: -0.22142758965492249, mean p set: 0.4489397704601288
The modified gen p mean: 0.44782623648643494, gen p mean: -0.2242451012134552, mean p set: 0.44830653071403503
loss_pred:0.04555019736289978, decouple_loss:0.035748161375522614
loss_pred:0.04321027547121048, decouple_loss:0.03641411289572716
loss_pred:0.04372434318065643, decouple_loss:0.0361231230199337
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44775041937828064, gen p mean: -0.22399501502513885, mean p set: 0.44823071360588074
The modified gen p mean: 0.44815656542778015, gen p mean: -0.22359822690486908, mean p set: 0.44863688945770264
The modified gen p mean: 0.4497413635253906, gen p mean: -0.2175876945257187, mean p set: 0.4502216577529907
loss_pred:0.04477551952004433, decouple_loss:0.03838110342621803
loss_pred:0.046213164925575256, decouple_loss:0.03872934356331825
loss_pred:0.04663969576358795, decouple_loss:0.041512757539749146
2023-05-02 16:24:12 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.22710908949375153, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.22159801423549652, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.21959610283374786, mean p set: 0.45035696029663086
loss_pred:0.04596170410513878, decouple_loss:0.03707526996731758
loss_pred:0.045053932815790176, decouple_loss:0.03678314387798309
loss_pred:0.04389398545026779, decouple_loss:0.03782099112868309
WV_0_PC_1_EH_0_PS_40_6, loss: 0.04683120176196098, avg_mse: 0.04721169173717499
current test mse: 0.047212
Iteration: 341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44682058691978455, gen p mean: -0.2222716063261032, mean p set: 0.44730088114738464
The modified gen p mean: 0.4472561478614807, gen p mean: -0.22428864240646362, mean p set: 0.4477364122867584
loss_pred:0.043759893625974655, decouple_loss:0.03700488060712814
loss_pred:0.04674921929836273, decouple_loss:0.04032152518630028
The modified gen p mean: 0.4481599032878876, gen p mean: -0.2164638787508011, mean p set: 0.44864022731781006
loss_pred:0.04624820873141289, decouple_loss:0.03948483616113663
Iteration: 342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44861477613449097, gen p mean: -0.21410785615444183, mean p set: 0.44909510016441345
The modified gen p mean: 0.44889312982559204, gen p mean: -0.2220708727836609, mean p set: 0.44937342405319214
The modified gen p mean: 0.447870135307312, gen p mean: -0.2170572280883789, mean p set: 0.4483504593372345
loss_pred:0.04557151719927788, decouple_loss:0.0386296808719635
loss_pred:0.04536706954240799, decouple_loss:0.037913281470537186
loss_pred:0.04641118273139, decouple_loss:0.04006189852952957
Iteration: 343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44844579696655273, gen p mean: -0.22253623604774475, mean p set: 0.44892609119415283
The modified gen p mean: 0.44841331243515015, gen p mean: -0.22368614375591278, mean p set: 0.44889357686042786
The modified gen p mean: 0.4493597447872162, gen p mean: -0.2177550494670868, mean p set: 0.44984006881713867
loss_pred:0.04415548965334892, decouple_loss:0.03805078566074371
loss_pred:0.043476033955812454, decouple_loss:0.03685714676976204
loss_pred:0.04576323926448822, decouple_loss:0.03921307995915413
Iteration: 344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44872400164604187, gen p mean: -0.23257122933864594, mean p set: 0.4492042660713196
The modified gen p mean: 0.44833943247795105, gen p mean: -0.22666512429714203, mean p set: 0.44881969690322876
The modified gen p mean: 0.45050033926963806, gen p mean: -0.2353273630142212, mean p set: 0.45098060369491577
loss_pred:0.04345627874135971, decouple_loss:0.0410030297935009
loss_pred:0.046415407210588455, decouple_loss:0.03757142648100853
loss_pred:0.04488331452012062, decouple_loss:0.04057539999485016
Iteration: 345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490513205528259, gen p mean: -0.22890698909759521, mean p set: 0.449531614780426
The modified gen p mean: 0.44795912504196167, gen p mean: -0.22773709893226624, mean p set: 0.44843941926956177
The modified gen p mean: 0.4489436149597168, gen p mean: -0.22537760436534882, mean p set: 0.4494239091873169
loss_pred:0.04563567042350769, decouple_loss:0.039055682718753815
loss_pred:0.04600236564874649, decouple_loss:0.04022873938083649
loss_pred:0.046476900577545166, decouple_loss:0.03964180499315262
Iteration: 346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480161666870117, gen p mean: -0.22683897614479065, mean p set: 0.4484964609146118
The modified gen p mean: 0.4469038248062134, gen p mean: -0.2205696851015091, mean p set: 0.44738414883613586
The modified gen p mean: 0.4490232765674591, gen p mean: -0.22659540176391602, mean p set: 0.4495035707950592
loss_pred:0.04396631196141243, decouple_loss:0.037056196480989456
loss_pred:0.04474664852023125, decouple_loss:0.037472277879714966
loss_pred:0.0455428883433342, decouple_loss:0.039110731333494186
Iteration: 347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482167959213257, gen p mean: -0.22409288585186005, mean p set: 0.4486970603466034
The modified gen p mean: 0.4505738615989685, gen p mean: -0.2238939106464386, mean p set: 0.4510541558265686
The modified gen p mean: 0.4481697380542755, gen p mean: -0.21648354828357697, mean p set: 0.448650062084198
loss_pred:0.04464022070169449, decouple_loss:0.039495985954999924
loss_pred:0.04435760900378227, decouple_loss:0.03876378759741783
loss_pred:0.045475155115127563, decouple_loss:0.03948796167969704
Iteration: 348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474274516105652, gen p mean: -0.22326907515525818, mean p set: 0.4479077458381653
The modified gen p mean: 0.44854143261909485, gen p mean: -0.22507892549037933, mean p set: 0.44902175664901733
The modified gen p mean: 0.4481416642665863, gen p mean: -0.22074589133262634, mean p set: 0.448621928691864
loss_pred:0.04441683366894722, decouple_loss:0.0390709787607193
loss_pred:0.04621005058288574, decouple_loss:0.03852346912026405
loss_pred:0.04532109200954437, decouple_loss:0.039717212319374084
Iteration: 349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44821345806121826, gen p mean: -0.22891120612621307, mean p set: 0.44869375228881836
The modified gen p mean: 0.448375940322876, gen p mean: -0.2254209667444229, mean p set: 0.4488562345504761
The modified gen p mean: 0.4480617344379425, gen p mean: -0.22561921179294586, mean p set: 0.4485420286655426
loss_pred:0.043421968817710876, decouple_loss:0.039459746330976486
loss_pred:0.0435735359787941, decouple_loss:0.039282552897930145
loss_pred:0.044553179293870926, decouple_loss:0.038962822407484055
Iteration: 350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846776127815247, gen p mean: -0.22573353350162506, mean p set: 0.44894805550575256
The modified gen p mean: 0.4476643204689026, gen p mean: -0.22317799925804138, mean p set: 0.4481446146965027
The modified gen p mean: 0.4480254352092743, gen p mean: -0.22451457381248474, mean p set: 0.448505699634552
loss_pred:0.0443405881524086, decouple_loss:0.038240138441324234
loss_pred:0.045088525861501694, decouple_loss:0.03817704692482948
loss_pred:0.04365618899464607, decouple_loss:0.037286918610334396
2023-05-02 16:27:57 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.2295282781124115, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.22382698953151703, mean p set: 0.4500633478164673
The modified gen p mean: 0.4498766362667084, gen p mean: -0.2218352109193802, mean p set: 0.45035696029663086
loss_pred:0.04546887427568436, decouple_loss:0.038319654762744904
loss_pred:0.04323970153927803, decouple_loss:0.03830239921808243
loss_pred:0.04445149749517441, decouple_loss:0.03733799606561661
WV_0_PC_1_EH_0_PS_40_6, loss: 0.04628602787852287, avg_mse: 0.04667375981807709
current test mse: 0.046674
Iteration: 351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477349519729614, gen p mean: -0.2205214947462082, mean p set: 0.4482152760028839
loss_pred:0.045943379402160645, decouple_loss:0.03828616067767143
The modified gen p mean: 0.4493885636329651, gen p mean: -0.23183633387088776, mean p set: 0.4498688280582428
loss_pred:0.044648051261901855, decouple_loss:0.037987127900123596
The modified gen p mean: 0.44884786009788513, gen p mean: -0.2291218638420105, mean p set: 0.44932815432548523
loss_pred:0.04328235983848572, decouple_loss:0.03710321709513664
Iteration: 352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44679588079452515, gen p mean: -0.223656564950943, mean p set: 0.44727620482444763
The modified gen p mean: 0.44745132327079773, gen p mean: -0.2247321903705597, mean p set: 0.4479316174983978
The modified gen p mean: 0.4477507472038269, gen p mean: -0.22182859480381012, mean p set: 0.448231041431427
loss_pred:0.042899470776319504, decouple_loss:0.03820938616991043
loss_pred:0.04362524300813675, decouple_loss:0.0380607470870018
loss_pred:0.04490029811859131, decouple_loss:0.03797520324587822
Iteration: 353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486349821090698, gen p mean: -0.2221948504447937, mean p set: 0.4491152763366699
The modified gen p mean: 0.44893309473991394, gen p mean: -0.2278669774532318, mean p set: 0.4494134187698364
The modified gen p mean: 0.4489864110946655, gen p mean: -0.22433730959892273, mean p set: 0.4494667053222656
loss_pred:0.04319317266345024, decouple_loss:0.03859959542751312
loss_pred:0.0422833226621151, decouple_loss:0.039266470819711685
loss_pred:0.04523434117436409, decouple_loss:0.03783225268125534
Iteration: 354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832903146743774, gen p mean: -0.2295689433813095, mean p set: 0.44880932569503784
The modified gen p mean: 0.4476427733898163, gen p mean: -0.2353881448507309, mean p set: 0.4481230676174164
The modified gen p mean: 0.4484662413597107, gen p mean: -0.2296133190393448, mean p set: 0.4489465653896332
loss_pred:0.043772172182798386, decouple_loss:0.03742178902029991
loss_pred:0.04514400660991669, decouple_loss:0.04013039916753769
loss_pred:0.043478138744831085, decouple_loss:0.03710417076945305
Iteration: 355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488053023815155, gen p mean: -0.23597541451454163, mean p set: 0.4492855668067932
The modified gen p mean: 0.44853872060775757, gen p mean: -0.23066595196723938, mean p set: 0.44901901483535767
The modified gen p mean: 0.4474150538444519, gen p mean: -0.2325311154127121, mean p set: 0.4478953182697296
loss_pred:0.04281028360128403, decouple_loss:0.03919634595513344
loss_pred:0.04499118775129318, decouple_loss:0.03773624822497368
loss_pred:0.04346049949526787, decouple_loss:0.03856959939002991
Iteration: 356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44761526584625244, gen p mean: -0.2332305908203125, mean p set: 0.4480955898761749
The modified gen p mean: 0.4476039409637451, gen p mean: -0.23812060058116913, mean p set: 0.4480842351913452
The modified gen p mean: 0.44843608140945435, gen p mean: -0.2387571930885315, mean p set: 0.44891637563705444
loss_pred:0.044865984469652176, decouple_loss:0.0370815172791481
loss_pred:0.043376509100198746, decouple_loss:0.037086375057697296
loss_pred:0.04210413619875908, decouple_loss:0.038847483694553375
Iteration: 357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44824087619781494, gen p mean: -0.22939758002758026, mean p set: 0.44872117042541504
The modified gen p mean: 0.4472508132457733, gen p mean: -0.23050041496753693, mean p set: 0.4477311074733734
The modified gen p mean: 0.44936537742614746, gen p mean: -0.23636509478092194, mean p set: 0.44984567165374756
loss_pred:0.04477495700120926, decouple_loss:0.036063484847545624
loss_pred:0.04245833680033684, decouple_loss:0.035921428352594376
loss_pred:0.04415654391050339, decouple_loss:0.03710596635937691
Iteration: 358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823935627937317, gen p mean: -0.2324313074350357, mean p set: 0.44871968030929565
The modified gen p mean: 0.44887322187423706, gen p mean: -0.2261122614145279, mean p set: 0.44935348629951477
The modified gen p mean: 0.4481634199619293, gen p mean: -0.2327234297990799, mean p set: 0.4486437141895294
loss_pred:0.04330271854996681, decouple_loss:0.03689882531762123
loss_pred:0.04423784092068672, decouple_loss:0.03636905923485756
loss_pred:0.04262814670801163, decouple_loss:0.03770693764090538
Iteration: 359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44916537404060364, gen p mean: -0.23563970625400543, mean p set: 0.4496456980705261
The modified gen p mean: 0.4470297396183014, gen p mean: -0.23403964936733246, mean p set: 0.4475100636482239
The modified gen p mean: 0.4484531581401825, gen p mean: -0.23354962468147278, mean p set: 0.4489334523677826
loss_pred:0.0431215800344944, decouple_loss:0.03560478612780571loss_pred:0.044366832822561264, decouple_loss:0.03786906599998474
loss_pred:0.042930733412504196, decouple_loss:0.03758789226412773
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
NaN value num: 0
Iteration: 360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45246726274490356, gen p mean: -0.23717187345027924, mean p set: 0.45294755697250366
The modified gen p mean: 0.4543343782424927, gen p mean: -0.24062882363796234, mean p set: 0.4548146724700928
The modified gen p mean: 0.4513101279735565, gen p mean: -0.23312170803546906, mean p set: 0.4517904222011566
loss_pred:0.04467710480093956, decouple_loss:0.04190735146403313
loss_pred:0.047996941953897476, decouple_loss:0.041746076196432114
loss_pred:0.043849825859069824, decouple_loss:0.039706822484731674
2023-05-02 16:32:23 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.2338935136795044, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.23907046020030975, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.23028472065925598, mean p set: 0.45035696029663086
loss_pred:0.04399510845541954, decouple_loss:0.036770518869161606
loss_pred:0.04508383199572563, decouple_loss:0.03760750964283943
loss_pred:0.042634572833776474, decouple_loss:0.03784916177392006
WV_0_PC_1_EH_0_PS_40_6, loss: 0.04577495902776718, avg_mse: 0.0462157167494297
current test mse: 0.046216
Iteration: 361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45096471905708313, gen p mean: -0.23384612798690796, mean p set: 0.4514450132846832
The modified gen p mean: 0.4530586898326874, gen p mean: -0.24066360294818878, mean p set: 0.4535389542579651
loss_pred:0.04560723900794983, decouple_loss:0.04079608619213104
loss_pred:0.044668927788734436, decouple_loss:0.04163310304284096
The modified gen p mean: 0.4514199197292328, gen p mean: -0.23204614222049713, mean p set: 0.4519002437591553
loss_pred:0.04355926811695099, decouple_loss:0.04285665974020958
Iteration: 362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507489502429962, gen p mean: -0.24124746024608612, mean p set: 0.4512292742729187
The modified gen p mean: 0.4498565196990967, gen p mean: -0.24912472069263458, mean p set: 0.4503368139266968
The modified gen p mean: 0.45221826434135437, gen p mean: -0.24896655976772308, mean p set: 0.45269855856895447
loss_pred:0.04757465422153473, decouple_loss:0.041027627885341644
loss_pred:0.04544433206319809, decouple_loss:0.040208976715803146
loss_pred:0.04468543082475662, decouple_loss:0.04023699834942818
Iteration: 363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45169728994369507, gen p mean: -0.25883540511131287, mean p set: 0.4521775543689728
The modified gen p mean: 0.4521137475967407, gen p mean: -0.2610239088535309, mean p set: 0.4525940418243408
The modified gen p mean: 0.4509720802307129, gen p mean: -0.2607177495956421, mean p set: 0.451452374458313
loss_pred:0.04457657039165497, decouple_loss:0.04041341319680214
loss_pred:0.04440661892294884, decouple_loss:0.04006271809339523
loss_pred:0.04458831623196602, decouple_loss:0.04065591096878052
Iteration: 364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508700370788574, gen p mean: -0.26319679617881775, mean p set: 0.4513503611087799
The modified gen p mean: 0.45270636677742004, gen p mean: -0.266217440366745, mean p set: 0.45318663120269775
The modified gen p mean: 0.45134875178337097, gen p mean: -0.2583271861076355, mean p set: 0.45182904601097107
loss_pred:0.04500356689095497, decouple_loss:0.04115081578493118
loss_pred:0.04312553256750107, decouple_loss:0.04244024306535721
loss_pred:0.04644220322370529, decouple_loss:0.04139115288853645
Iteration: 365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45249706506729126, gen p mean: -0.2700953781604767, mean p set: 0.45297735929489136
The modified gen p mean: 0.4527190923690796, gen p mean: -0.2705762982368469, mean p set: 0.4531993865966797
The modified gen p mean: 0.4522453546524048, gen p mean: -0.27154040336608887, mean p set: 0.4527256488800049
loss_pred:0.04262412339448929, decouple_loss:0.04101632535457611
loss_pred:0.04344842582941055, decouple_loss:0.04082588478922844
loss_pred:0.04453165829181671, decouple_loss:0.041367243975400925
Iteration: 366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4539802670478821, gen p mean: -0.24717819690704346, mean p set: 0.45446059107780457
The modified gen p mean: 0.4515138268470764, gen p mean: -0.245884507894516, mean p set: 0.4519941210746765
The modified gen p mean: 0.4510241150856018, gen p mean: -0.25142431259155273, mean p set: 0.4515043795108795
loss_pred:0.04163830727338791, decouple_loss:0.04281754046678543
loss_pred:0.044649407267570496, decouple_loss:0.040322545915842056
loss_pred:0.04545735567808151, decouple_loss:0.0418957956135273
Iteration: 367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45220547914505005, gen p mean: -0.23378312587738037, mean p set: 0.45268580317497253
The modified gen p mean: 0.45180991291999817, gen p mean: -0.23264405131340027, mean p set: 0.45229020714759827
The modified gen p mean: 0.4513745903968811, gen p mean: -0.237937793135643, mean p set: 0.4518548846244812
loss_pred:0.046211373060941696, decouple_loss:0.04025761038064957
loss_pred:0.044879503548145294, decouple_loss:0.03975042328238487
loss_pred:0.045276667922735214, decouple_loss:0.040474869310855865
Iteration: 368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510827362537384, gen p mean: -0.2434871643781662, mean p set: 0.4515630006790161
The modified gen p mean: 0.4522090256214142, gen p mean: -0.2384878695011139, mean p set: 0.4526892900466919
The modified gen p mean: 0.45222821831703186, gen p mean: -0.2383825182914734, mean p set: 0.45270848274230957
loss_pred:0.04608963057398796, decouple_loss:0.04087337478995323
loss_pred:0.043404463678598404, decouple_loss:0.041313234716653824
loss_pred:0.045119695365428925, decouple_loss:0.041435036808252335
Iteration: 369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45276230573654175, gen p mean: -0.2424221634864807, mean p set: 0.45324259996414185
The modified gen p mean: 0.45272040367126465, gen p mean: -0.2423316389322281, mean p set: 0.45320072770118713
The modified gen p mean: 0.4508156180381775, gen p mean: -0.23774489760398865, mean p set: 0.4512959122657776
loss_pred:0.040902312844991684, decouple_loss:0.039994604885578156
loss_pred:0.042705290019512177, decouple_loss:0.04096127673983574
loss_pred:0.04298148304224014, decouple_loss:0.04174015671014786
Iteration: 370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513258635997772, gen p mean: -0.2525360882282257, mean p set: 0.45180612802505493
The modified gen p mean: 0.45097970962524414, gen p mean: -0.24243716895580292, mean p set: 0.45146000385284424
The modified gen p mean: 0.4529423713684082, gen p mean: -0.24965155124664307, mean p set: 0.4534226953983307
loss_pred:0.04544597864151001, decouple_loss:0.04060284420847893
loss_pred:0.04303305968642235, decouple_loss:0.04253470525145531
loss_pred:0.04246964305639267, decouple_loss:0.040187135338783264
2023-05-02 16:36:07 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.2582148015499115, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.26431676745414734, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.2528424561023712, mean p set: 0.45035696029663086
loss_pred:0.044516634196043015, decouple_loss:0.04138695076107979
loss_pred:0.04579644277691841, decouple_loss:0.042663805186748505
loss_pred:0.04333389177918434, decouple_loss:0.04290057718753815
WV_0_PC_1_EH_0_PS_40_6, loss: 0.04666484519839287, avg_mse: 0.047205083072185516
current test mse: 0.047205
Iteration: 371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536548852920532, gen p mean: -0.2623390257358551, mean p set: 0.4541351795196533
loss_pred:0.041857317090034485, decouple_loss:0.04034420847892761
The modified gen p mean: 0.4528367221355438, gen p mean: -0.26476600766181946, mean p set: 0.4533170461654663
loss_pred:0.04236700385808945, decouple_loss:0.03976701200008392
The modified gen p mean: 0.4539129436016083, gen p mean: -0.2586009204387665, mean p set: 0.45439326763153076
loss_pred:0.042599134147167206, decouple_loss:0.04027794674038887
Iteration: 372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511546194553375, gen p mean: -0.26333028078079224, mean p set: 0.4516349136829376
The modified gen p mean: 0.45347917079925537, gen p mean: -0.261284202337265, mean p set: 0.45395946502685547
The modified gen p mean: 0.4522641897201538, gen p mean: -0.258772611618042, mean p set: 0.4527444541454315
loss_pred:0.04422124847769737, decouple_loss:0.03933284431695938
loss_pred:0.04257337376475334, decouple_loss:0.03842480853199959
loss_pred:0.0439157597720623, decouple_loss:0.03986186534166336
Iteration: 373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45048317313194275, gen p mean: -0.2696176767349243, mean p set: 0.45096346735954285
The modified gen p mean: 0.45056912302970886, gen p mean: -0.25583815574645996, mean p set: 0.4510493874549866
The modified gen p mean: 0.45169582962989807, gen p mean: -0.2635174095630646, mean p set: 0.4521760940551758
loss_pred:0.04439939931035042, decouple_loss:0.038821157068014145
loss_pred:0.04643024876713753, decouple_loss:0.03898649662733078
loss_pred:0.043249379843473434, decouple_loss:0.03977910056710243
Iteration: 374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45201176404953003, gen p mean: -0.27603840827941895, mean p set: 0.4524921178817749
The modified gen p mean: 0.4521506130695343, gen p mean: -0.2788669466972351, mean p set: 0.4526309072971344
The modified gen p mean: 0.45233041048049927, gen p mean: -0.2756972312927246, mean p set: 0.45281070470809937
loss_pred:0.042650237679481506, decouple_loss:0.04090997576713562
loss_pred:0.04338184744119644, decouple_loss:0.0390377901494503
loss_pred:0.04528511315584183, decouple_loss:0.039186809211969376
Iteration: 375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528239965438843, gen p mean: -0.2594010829925537, mean p set: 0.4533042907714844
The modified gen p mean: 0.4527140259742737, gen p mean: -0.26556625962257385, mean p set: 0.4531942903995514
The modified gen p mean: 0.4506838619709015, gen p mean: -0.25981733202934265, mean p set: 0.4511641561985016
loss_pred:0.04141039773821831, decouple_loss:0.03855287656188011
loss_pred:0.04279106855392456, decouple_loss:0.03903060033917427
loss_pred:0.04206838086247444, decouple_loss:0.0400414764881134
Iteration: 376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45271340012550354, gen p mean: -0.24722428619861603, mean p set: 0.45319366455078125
The modified gen p mean: 0.4513583779335022, gen p mean: -0.25358226895332336, mean p set: 0.4518386423587799
The modified gen p mean: 0.4511820077896118, gen p mean: -0.2490810751914978, mean p set: 0.4516623318195343
loss_pred:0.040935978293418884, decouple_loss:0.03869064524769783
loss_pred:0.044935036450624466, decouple_loss:0.03836729750037193
loss_pred:0.04461926594376564, decouple_loss:0.038583043962717056
Iteration: 377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508441388607025, gen p mean: -0.2583560645580292, mean p set: 0.4513244330883026
The modified gen p mean: 0.4505383372306824, gen p mean: -0.25807419419288635, mean p set: 0.4510186016559601
The modified gen p mean: 0.45104166865348816, gen p mean: -0.25985410809516907, mean p set: 0.45152196288108826
loss_pred:0.04388966038823128, decouple_loss:0.03915737196803093
loss_pred:0.04435976594686508, decouple_loss:0.03838873282074928
loss_pred:0.044258132576942444, decouple_loss:0.03867444768548012
Iteration: 378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45227065682411194, gen p mean: -0.26324617862701416, mean p set: 0.45275095105171204
The modified gen p mean: 0.4524080753326416, gen p mean: -0.27042272686958313, mean p set: 0.4528883397579193
The modified gen p mean: 0.45082202553749084, gen p mean: -0.2605607509613037, mean p set: 0.45130228996276855
loss_pred:0.041682060807943344, decouple_loss:0.03884366899728775
loss_pred:0.04328213259577751, decouple_loss:0.03822530806064606
loss_pred:0.041343674063682556, decouple_loss:0.03925681859254837
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
NaN value num: 0
Iteration: 379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478066861629486, gen p mean: -0.2721695005893707, mean p set: 0.4482869803905487
The modified gen p mean: 0.4467078745365143, gen p mean: -0.26810380816459656, mean p set: 0.4471881687641144
The modified gen p mean: 0.44760578870773315, gen p mean: -0.2706623673439026, mean p set: 0.44808605313301086
loss_pred:0.04642084985971451, decouple_loss:0.04401950538158417
loss_pred:0.04797106608748436, decouple_loss:0.04399695247411728
loss_pred:0.04577912017703056, decouple_loss:0.04318530857563019
Iteration: 380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44696423411369324, gen p mean: -0.26829054951667786, mean p set: 0.44744452834129333
The modified gen p mean: 0.4474543035030365, gen p mean: -0.2678421139717102, mean p set: 0.4479345977306366
The modified gen p mean: 0.4487350881099701, gen p mean: -0.26836034655570984, mean p set: 0.4492153227329254
loss_pred:0.046356458216905594, decouple_loss:0.04318663105368614loss_pred:0.0464150533080101, decouple_loss:0.04353857785463333
loss_pred:0.048852864652872086, decouple_loss:0.041621506214141846
2023-05-02 16:40:32 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.26773589849472046, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.26207295060157776, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.2570721209049225, mean p set: 0.45035696029663086
loss_pred:0.04556644335389137, decouple_loss:0.04199395328760147
loss_pred:0.044219423085451126, decouple_loss:0.04024001955986023
loss_pred:0.043024685233831406, decouple_loss:0.04191204160451889
WV_0_PC_1_EH_0_PS_40_6, loss: 0.046339284628629684, avg_mse: 0.04694727435708046
current test mse: 0.046947
Iteration: 381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470826983451843, gen p mean: -0.2642989456653595, mean p set: 0.4475629925727844
The modified gen p mean: 0.44743454456329346, gen p mean: -0.2649252116680145, mean p set: 0.44791483879089355
loss_pred:0.04493875801563263, decouple_loss:0.04200439900159836
loss_pred:0.04856296256184578, decouple_loss:0.0415109321475029
The modified gen p mean: 0.44829297065734863, gen p mean: -0.2629075050354004, mean p set: 0.44877323508262634
loss_pred:0.04580451175570488, decouple_loss:0.040659982711076736
Iteration: 382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447444349527359, gen p mean: -0.2540123462677002, mean p set: 0.4479246735572815
The modified gen p mean: 0.4473735988140106, gen p mean: -0.24974258244037628, mean p set: 0.4478538930416107
The modified gen p mean: 0.4469808340072632, gen p mean: -0.2485412210226059, mean p set: 0.4474611282348633
loss_pred:0.047737572342157364, decouple_loss:0.04001886397600174
loss_pred:0.04503389447927475, decouple_loss:0.04145045951008797
loss_pred:0.04498353600502014, decouple_loss:0.041017189621925354
Iteration: 383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44831234216690063, gen p mean: -0.23984631896018982, mean p set: 0.44879260659217834
The modified gen p mean: 0.4476653039455414, gen p mean: -0.24215850234031677, mean p set: 0.4481455683708191
The modified gen p mean: 0.44815242290496826, gen p mean: -0.24315795302391052, mean p set: 0.44863274693489075
loss_pred:0.04645576328039169, decouple_loss:0.04025822505354881
loss_pred:0.04656370356678963, decouple_loss:0.04033205285668373
loss_pred:0.045971233397722244, decouple_loss:0.04110286012291908
Iteration: 384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488820433616638, gen p mean: -0.24732105433940887, mean p set: 0.4493623375892639
The modified gen p mean: 0.44718053936958313, gen p mean: -0.24644197523593903, mean p set: 0.4476608335971832
The modified gen p mean: 0.4468609094619751, gen p mean: -0.24639716744422913, mean p set: 0.4473411440849304
loss_pred:0.04551504924893379, decouple_loss:0.041362445801496506
loss_pred:0.042402926832437515, decouple_loss:0.04149949550628662
loss_pred:0.04457036405801773, decouple_loss:0.04157472029328346
Iteration: 385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475539028644562, gen p mean: -0.2541300356388092, mean p set: 0.4480341970920563
The modified gen p mean: 0.44618886709213257, gen p mean: -0.25162065029144287, mean p set: 0.4466691315174103
The modified gen p mean: 0.4461660385131836, gen p mean: -0.2486233115196228, mean p set: 0.4466463625431061
loss_pred:0.04751163721084595, decouple_loss:0.04050140082836151
loss_pred:0.04620738700032234, decouple_loss:0.03959059715270996
loss_pred:0.04615747928619385, decouple_loss:0.03938506916165352
Iteration: 386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669750332832336, gen p mean: -0.23916864395141602, mean p set: 0.44717782735824585
The modified gen p mean: 0.44771137833595276, gen p mean: -0.2429988831281662, mean p set: 0.44819167256355286
The modified gen p mean: 0.4466773569583893, gen p mean: -0.2379094511270523, mean p set: 0.4471576511859894
loss_pred:0.044288426637649536, decouple_loss:0.03864641115069389
loss_pred:0.046277329325675964, decouple_loss:0.040089525282382965
loss_pred:0.04498358070850372, decouple_loss:0.03882179409265518
Iteration: 387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44564107060432434, gen p mean: -0.22712714970111847, mean p set: 0.44612136483192444
The modified gen p mean: 0.44758620858192444, gen p mean: -0.22497667372226715, mean p set: 0.4480665326118469
The modified gen p mean: 0.44587671756744385, gen p mean: -0.22679415345191956, mean p set: 0.44635701179504395
loss_pred:0.046600379049777985, decouple_loss:0.03907908499240875
loss_pred:0.04216896370053291, decouple_loss:0.039450548589229584
loss_pred:0.045691851526498795, decouple_loss:0.039956774562597275
Iteration: 388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44613581895828247, gen p mean: -0.23417896032333374, mean p set: 0.44661614298820496
The modified gen p mean: 0.4483150541782379, gen p mean: -0.23402242362499237, mean p set: 0.448795348405838
The modified gen p mean: 0.4470103681087494, gen p mean: -0.23496311902999878, mean p set: 0.4474906623363495
loss_pred:0.04606719687581062, decouple_loss:0.038956403732299805
loss_pred:0.04404517263174057, decouple_loss:0.03988165780901909
loss_pred:0.04246167466044426, decouple_loss:0.040625765919685364
Iteration: 389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484826624393463, gen p mean: -0.2445024996995926, mean p set: 0.448962926864624
The modified gen p mean: 0.4472391903400421, gen p mean: -0.24554821848869324, mean p set: 0.4477194845676422
The modified gen p mean: 0.44814082980155945, gen p mean: -0.2423420548439026, mean p set: 0.44862115383148193
loss_pred:0.04573783650994301, decouple_loss:0.038701724261045456
loss_pred:0.04357409104704857, decouple_loss:0.04000882804393768
loss_pred:0.0438549742102623, decouple_loss:0.03874063491821289
Iteration: 390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474298655986786, gen p mean: -0.23929280042648315, mean p set: 0.4479101598262787
The modified gen p mean: 0.4470619559288025, gen p mean: -0.24186967313289642, mean p set: 0.4475422501564026
The modified gen p mean: 0.44809791445732117, gen p mean: -0.24003343284130096, mean p set: 0.44857820868492126
loss_pred:0.04723111540079117, decouple_loss:0.03814099356532097
loss_pred:0.04457170516252518, decouple_loss:0.03863624483346939
loss_pred:0.04481370747089386, decouple_loss:0.03885730355978012
2023-05-02 16:44:17 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.23712772130966187, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.2432175576686859, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.2345890998840332, mean p set: 0.45035696029663086
loss_pred:0.04312249645590782, decouple_loss:0.03866194933652878
loss_pred:0.04466801881790161, decouple_loss:0.04063348472118378
loss_pred:0.04228946939110756, decouple_loss:0.03974599391222
WV_0_PC_1_EH_0_PS_40_6, loss: 0.045344021171331406, avg_mse: 0.04585447162389755
current test mse: 0.045854
Iteration: 391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474761188030243, gen p mean: -0.23726974427700043, mean p set: 0.4479564428329468
The modified gen p mean: 0.4481871426105499, gen p mean: -0.24421846866607666, mean p set: 0.44866740703582764
loss_pred:0.045588646084070206, decouple_loss:0.03796860948204994
loss_pred:0.04404161497950554, decouple_loss:0.03896772488951683
The modified gen p mean: 0.44806674122810364, gen p mean: -0.24031126499176025, mean p set: 0.44854697585105896
loss_pred:0.045133043080568314, decouple_loss:0.03959439694881439
Iteration: 392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465455710887909, gen p mean: -0.24794501066207886, mean p set: 0.447025865316391
The modified gen p mean: 0.44712480902671814, gen p mean: -0.24907243251800537, mean p set: 0.44760507345199585
The modified gen p mean: 0.44908756017684937, gen p mean: -0.24942393600940704, mean p set: 0.44956785440444946
loss_pred:0.04254596307873726, decouple_loss:0.038596585392951965
loss_pred:0.04312463104724884, decouple_loss:0.038725994527339935
loss_pred:0.04439155012369156, decouple_loss:0.03784094378352165
Iteration: 393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745978713035583, gen p mean: -0.2535742223262787, mean p set: 0.4479401111602783
The modified gen p mean: 0.4455741345882416, gen p mean: -0.24933286011219025, mean p set: 0.4460543990135193
The modified gen p mean: 0.4464946985244751, gen p mean: -0.2475268840789795, mean p set: 0.4469749927520752
loss_pred:0.04649847000837326, decouple_loss:0.03936907276511192
loss_pred:0.04474357143044472, decouple_loss:0.03667265176773071
loss_pred:0.0455419197678566, decouple_loss:0.03808431327342987
Iteration: 394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723373651504517, gen p mean: -0.25621023774147034, mean p set: 0.44771403074264526
The modified gen p mean: 0.448380708694458, gen p mean: -0.2511025667190552, mean p set: 0.4488610029220581
The modified gen p mean: 0.44720691442489624, gen p mean: -0.2568918466567993, mean p set: 0.4476872384548187
loss_pred:0.04496866464614868, decouple_loss:0.037691034376621246
loss_pred:0.04703131318092346, decouple_loss:0.03664335981011391
loss_pred:0.0456581749022007, decouple_loss:0.03799743205308914
Iteration: 395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44649913907051086, gen p mean: -0.24838781356811523, mean p set: 0.44697946310043335
The modified gen p mean: 0.44833508133888245, gen p mean: -0.2492368519306183, mean p set: 0.44881540536880493
The modified gen p mean: 0.44838374853134155, gen p mean: -0.24944375455379486, mean p set: 0.44886404275894165
loss_pred:0.045021723955869675, decouple_loss:0.03704742714762688
loss_pred:0.04316642880439758, decouple_loss:0.03639441728591919
loss_pred:0.04528997465968132, decouple_loss:0.039500582963228226
Iteration: 396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470864534378052, gen p mean: -0.2428721934556961, mean p set: 0.44756677746772766
The modified gen p mean: 0.44716793298721313, gen p mean: -0.2432127594947815, mean p set: 0.44764822721481323
The modified gen p mean: 0.44929271936416626, gen p mean: -0.24398469924926758, mean p set: 0.44977301359176636
loss_pred:0.04468318074941635, decouple_loss:0.03740199655294418
loss_pred:0.04395165294408798, decouple_loss:0.03682383894920349
loss_pred:0.044337138533592224, decouple_loss:0.038142699748277664
Iteration: 397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470779597759247, gen p mean: -0.2576875388622284, mean p set: 0.4475582540035248
The modified gen p mean: 0.4467546045780182, gen p mean: -0.25820574164390564, mean p set: 0.4472349286079407
The modified gen p mean: 0.4472741186618805, gen p mean: -0.25850915908813477, mean p set: 0.4477544128894806
loss_pred:0.044872626662254333, decouple_loss:0.03584209084510803
loss_pred:0.044512420892715454, decouple_loss:0.03593837097287178
loss_pred:0.04458710551261902, decouple_loss:0.03716769069433212
Iteration: 398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731447100639343, gen p mean: -0.2726166248321533, mean p set: 0.44779476523399353
The modified gen p mean: 0.4465150833129883, gen p mean: -0.274688720703125, mean p set: 0.4469953775405884
The modified gen p mean: 0.4475901424884796, gen p mean: -0.2765592634677887, mean p set: 0.4480704367160797
loss_pred:0.04075561836361885, decouple_loss:0.03651911020278931
loss_pred:0.044964566826820374, decouple_loss:0.03666497766971588
loss_pred:0.04342464730143547, decouple_loss:0.0367596372961998
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
NaN value num: 0
Iteration: 399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45046862959861755, gen p mean: -0.27129045128822327, mean p set: 0.45094895362854004
The modified gen p mean: 0.4504152536392212, gen p mean: -0.2719821035861969, mean p set: 0.4508955478668213
The modified gen p mean: 0.4506170451641083, gen p mean: -0.27477315068244934, mean p set: 0.45109736919403076
loss_pred:0.042091306298971176, decouple_loss:0.04048389568924904
loss_pred:0.04264787957072258, decouple_loss:0.040906693786382675
loss_pred:0.043711625039577484, decouple_loss:0.04020039364695549
Iteration: 400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451941579580307, gen p mean: -0.26461341977119446, mean p set: 0.4524218738079071
The modified gen p mean: 0.45121800899505615, gen p mean: -0.25994592905044556, mean p set: 0.45169830322265625
The modified gen p mean: 0.4510365128517151, gen p mean: -0.25793150067329407, mean p set: 0.4515168070793152
loss_pred:0.0425386019051075, decouple_loss:0.04311405122280121
loss_pred:0.04270030930638313, decouple_loss:0.0417596660554409
loss_pred:0.042532145977020264, decouple_loss:0.04100070521235466

2023-05-02 16:48:37 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.2563759684562683, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.2617116868495941, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.2523423433303833, mean p set: 0.45035696029663086
loss_pred:0.04293763265013695, decouple_loss:0.0380275584757328
loss_pred:0.0441150926053524, decouple_loss:0.03897664695978165
loss_pred:0.04212682321667671, decouple_loss:0.03939461335539818
WV_0_PC_1_EH_0_PS_40_6, loss: 0.044999830424785614, avg_mse: 0.04567478597164154
current test mse: 0.045675
Iteration: 401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45056816935539246, gen p mean: -0.25471213459968567, mean p set: 0.45104846358299255
The modified gen p mean: 0.45255526900291443, gen p mean: -0.2567732036113739, mean p set: 0.45303553342819214
loss_pred:0.041986651718616486, decouple_loss:0.04009556025266647
loss_pred:0.04242478311061859, decouple_loss:0.039476677775382996
The modified gen p mean: 0.45068731904029846, gen p mean: -0.25107279419898987, mean p set: 0.45116758346557617
loss_pred:0.04196528345346451, decouple_loss:0.03948212042450905
Iteration: 402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533810317516327, gen p mean: -0.2609542906284332, mean p set: 0.4538613259792328
The modified gen p mean: 0.4514724612236023, gen p mean: -0.2682969570159912, mean p set: 0.4519527554512024
The modified gen p mean: 0.44994911551475525, gen p mean: -0.2591562867164612, mean p set: 0.45042940974235535
loss_pred:0.042966652661561966, decouple_loss:0.039848461747169495
loss_pred:0.04214165732264519, decouple_loss:0.04180382564663887
loss_pred:0.04402872174978256, decouple_loss:0.03769685700535774
Iteration: 403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511013925075531, gen p mean: -0.26190096139907837, mean p set: 0.4515817165374756
The modified gen p mean: 0.44996029138565063, gen p mean: -0.2675953507423401, mean p set: 0.45044055581092834
The modified gen p mean: 0.4520318806171417, gen p mean: -0.26535195112228394, mean p set: 0.45251214504241943
loss_pred:0.044279247522354126, decouple_loss:0.03959900513291359
loss_pred:0.04301835224032402, decouple_loss:0.03722582384943962
loss_pred:0.043359849601984024, decouple_loss:0.03978979215025902
Iteration: 404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522443115711212, gen p mean: -0.27378660440444946, mean p set: 0.4527246057987213
The modified gen p mean: 0.4496269226074219, gen p mean: -0.26939907670021057, mean p set: 0.45010724663734436
The modified gen p mean: 0.44986605644226074, gen p mean: -0.26617902517318726, mean p set: 0.45034632086753845
loss_pred:0.042218465358018875, decouple_loss:0.038535088300704956
loss_pred:0.041682783514261246, decouple_loss:0.03762010484933853
loss_pred:0.04141463711857796, decouple_loss:0.03905436024069786
Iteration: 405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45107415318489075, gen p mean: -0.274189829826355, mean p set: 0.45155444741249084
The modified gen p mean: 0.45082539319992065, gen p mean: -0.27105584740638733, mean p set: 0.45130568742752075
The modified gen p mean: 0.45287275314331055, gen p mean: -0.2728492021560669, mean p set: 0.45335304737091064
loss_pred:0.04170149937272072, decouple_loss:0.03797803074121475
loss_pred:0.04166264832019806, decouple_loss:0.038090236485004425
loss_pred:0.04383576661348343, decouple_loss:0.04088399186730385
Iteration: 406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45181411504745483, gen p mean: -0.2710990011692047, mean p set: 0.45229440927505493
The modified gen p mean: 0.44978272914886475, gen p mean: -0.2715977430343628, mean p set: 0.45026299357414246
The modified gen p mean: 0.4515930414199829, gen p mean: -0.2731718420982361, mean p set: 0.4520733654499054
loss_pred:0.04434632509946823, decouple_loss:0.03924579918384552
loss_pred:0.042395588010549545, decouple_loss:0.03852449730038643
loss_pred:0.04277350381016731, decouple_loss:0.038986556231975555
Iteration: 407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45220863819122314, gen p mean: -0.27720028162002563, mean p set: 0.45268896222114563
The modified gen p mean: 0.4512656629085541, gen p mean: -0.274743914604187, mean p set: 0.4517459571361542
The modified gen p mean: 0.4518243372440338, gen p mean: -0.27740055322647095, mean p set: 0.4523046314716339
loss_pred:0.041591525077819824, decouple_loss:0.04431084915995598
loss_pred:0.04174905642867088, decouple_loss:0.0391300693154335
loss_pred:0.0425134040415287, decouple_loss:0.03983508422970772
Iteration: 408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45262864232063293, gen p mean: -0.28114956617355347, mean p set: 0.45310890674591064
The modified gen p mean: 0.45319584012031555, gen p mean: -0.27743732929229736, mean p set: 0.45367616415023804
The modified gen p mean: 0.4518912732601166, gen p mean: -0.2848597466945648, mean p set: 0.4523715376853943
loss_pred:0.04142388328909874, decouple_loss:0.038512762635946274
loss_pred:0.04273346811532974, decouple_loss:0.03879418596625328
loss_pred:0.04137977212667465, decouple_loss:0.0425209105014801
Iteration: 409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511999487876892, gen p mean: -0.2854643166065216, mean p set: 0.4516802132129669
The modified gen p mean: 0.4492797553539276, gen p mean: -0.2832554578781128, mean p set: 0.4497600495815277
The modified gen p mean: 0.45116060972213745, gen p mean: -0.2818387448787689, mean p set: 0.45164093375205994
loss_pred:0.042512573301792145, decouple_loss:0.03834260255098343loss_pred:0.040717437863349915, decouple_loss:0.03819677233695984
loss_pred:0.0411759577691555, decouple_loss:0.03809249773621559
Iteration: 410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503079950809479, gen p mean: -0.2971172332763672, mean p set: 0.450788289308548
The modified gen p mean: 0.4512845575809479, gen p mean: -0.2914920747280121, mean p set: 0.45176488161087036
The modified gen p mean: 0.4518422484397888, gen p mean: -0.2996496260166168, mean p set: 0.4523225724697113
loss_pred:0.041854918003082275, decouple_loss:0.04079865291714668
loss_pred:0.041594769805669785, decouple_loss:0.03707471862435341
loss_pred:0.0400092676281929, decouple_loss:0.039420682936906815
2023-05-02 16:52:18 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.2995874285697937, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.3055000901222229, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.29463616013526917, mean p set: 0.45035696029663086
loss_pred:0.04315156117081642, decouple_loss:0.03989125415682793
loss_pred:0.04419638216495514, decouple_loss:0.04181807488203049
loss_pred:0.04223795607686043, decouple_loss:0.041542619466781616
WV_0_PC_1_EH_0_PS_40_6, loss: 0.04524950310587883, avg_mse: 0.046182770282030106
current test mse: 0.046183
Iteration: 411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514588415622711, gen p mean: -0.3001105785369873, mean p set: 0.4519391357898712
The modified gen p mean: 0.4525086283683777, gen p mean: -0.3009255826473236, mean p set: 0.4529889225959778
loss_pred:0.0401163175702095, decouple_loss:0.038853734731674194
loss_pred:0.040724702179431915, decouple_loss:0.03943350538611412
The modified gen p mean: 0.45187821984291077, gen p mean: -0.2929513454437256, mean p set: 0.45235851407051086
loss_pred:0.042725950479507446, decouple_loss:0.03779910132288933
Iteration: 412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45076966285705566, gen p mean: -0.29016971588134766, mean p set: 0.45124995708465576
The modified gen p mean: 0.4521043598651886, gen p mean: -0.2948465645313263, mean p set: 0.4525846242904663
The modified gen p mean: 0.4497283101081848, gen p mean: -0.2910970151424408, mean p set: 0.4502086043357849
loss_pred:0.042039964348077774, decouple_loss:0.03885217756032944
loss_pred:0.04156382754445076, decouple_loss:0.037524234503507614
loss_pred:0.04052882269024849, decouple_loss:0.040512192994356155
Iteration: 413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45129308104515076, gen p mean: -0.28719669580459595, mean p set: 0.45177337527275085
The modified gen p mean: 0.45170214772224426, gen p mean: -0.28882208466529846, mean p set: 0.45218244194984436
The modified gen p mean: 0.451322078704834, gen p mean: -0.2912799119949341, mean p set: 0.4518023431301117
loss_pred:0.04259743168950081, decouple_loss:0.038223747164011
loss_pred:0.042386576533317566, decouple_loss:0.038760956376791
loss_pred:0.04014963656663895, decouple_loss:0.037263453006744385
Iteration: 414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500848352909088, gen p mean: -0.2923736572265625, mean p set: 0.4505651295185089
The modified gen p mean: 0.452824205160141, gen p mean: -0.29548147320747375, mean p set: 0.4533045291900635
The modified gen p mean: 0.45191967487335205, gen p mean: -0.29178789258003235, mean p set: 0.45239993929862976
loss_pred:0.041355688124895096, decouple_loss:0.03759518638253212
loss_pred:0.040819134563207626, decouple_loss:0.038122694939374924
loss_pred:0.04202956333756447, decouple_loss:0.037622760981321335
Iteration: 415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45102256536483765, gen p mean: -0.2892170548439026, mean p set: 0.45150282979011536
The modified gen p mean: 0.4502285420894623, gen p mean: -0.2906154990196228, mean p set: 0.4507088363170624
The modified gen p mean: 0.4518289268016815, gen p mean: -0.2928154468536377, mean p set: 0.4523092210292816
loss_pred:0.041076868772506714, decouple_loss:0.037837326526641846
loss_pred:0.040787968784570694, decouple_loss:0.03941933438181877
loss_pred:0.04083818569779396, decouple_loss:0.03756825253367424
Iteration: 416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45045846700668335, gen p mean: -0.299075186252594, mean p set: 0.45093876123428345
The modified gen p mean: 0.4520137310028076, gen p mean: -0.2962341606616974, mean p set: 0.4524940252304077
The modified gen p mean: 0.45086032152175903, gen p mean: -0.29676151275634766, mean p set: 0.45134058594703674
loss_pred:0.04168286174535751, decouple_loss:0.038717109709978104
loss_pred:0.03898157924413681, decouple_loss:0.039520490914583206
loss_pred:0.040775083005428314, decouple_loss:0.0385349802672863
Iteration: 417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504478871822357, gen p mean: -0.30297333002090454, mean p set: 0.4509281814098358
The modified gen p mean: 0.45080623030662537, gen p mean: -0.3046802282333374, mean p set: 0.45128652453422546
The modified gen p mean: 0.45172634720802307, gen p mean: -0.29882845282554626, mean p set: 0.45220664143562317
loss_pred:0.042292218655347824, decouple_loss:0.03927461430430412
loss_pred:0.04127541929483414, decouple_loss:0.03784647583961487
loss_pred:0.04055648297071457, decouple_loss:0.037680745124816895
Iteration: 418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45068755745887756, gen p mean: -0.29594850540161133, mean p set: 0.45116788148880005
The modified gen p mean: 0.4518909454345703, gen p mean: -0.2882556915283203, mean p set: 0.4523712396621704
The modified gen p mean: 0.4505796730518341, gen p mean: -0.28742870688438416, mean p set: 0.4510599374771118
loss_pred:0.041550058871507645, decouple_loss:0.03679383546113968
loss_pred:0.04231290519237518, decouple_loss:0.037049345672130585
loss_pred:0.040712181478738785, decouple_loss:0.03701392561197281
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778740406036377, gen p mean: -0.28697046637535095, mean p set: 0.4482676684856415
The modified gen p mean: 0.44780397415161133, gen p mean: -0.288071870803833, mean p set: 0.4482842683792114
The modified gen p mean: 0.44668814539909363, gen p mean: -0.28605395555496216, mean p set: 0.4471684396266937
loss_pred:0.04408622533082962, decouple_loss:0.03818538412451744
loss_pred:0.044316500425338745, decouple_loss:0.03830317035317421
loss_pred:0.04376458376646042, decouple_loss:0.03986269608139992
Iteration: 420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473133385181427, gen p mean: -0.2948250472545624, mean p set: 0.4477936327457428
The modified gen p mean: 0.4494800865650177, gen p mean: -0.2867840528488159, mean p set: 0.4499603509902954
The modified gen p mean: 0.4468989074230194, gen p mean: -0.29097291827201843, mean p set: 0.4473792016506195
loss_pred:0.04115518555045128, decouple_loss:0.038993217051029205
loss_pred:0.04201468452811241, decouple_loss:0.03670457750558853
loss_pred:0.042561598122119904, decouple_loss:0.038925204426050186
2023-05-02 16:56:49 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.2930678427219391, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.28936874866485596, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.2847563326358795, mean p set: 0.45035696029663086
loss_pred:0.04357491806149483, decouple_loss:0.03927384316921234
loss_pred:0.04255421832203865, decouple_loss:0.0377957746386528
loss_pred:0.04139833524823189, decouple_loss:0.0395083986222744
WV_0_PC_1_EH_0_PS_40_6, loss: 0.04445212706923485, avg_mse: 0.045435208827257156
current test mse: 0.045435
Iteration: 421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44705930352211, gen p mean: -0.2924211323261261, mean p set: 0.44753962755203247
The modified gen p mean: 0.4475812315940857, gen p mean: -0.28503721952438354, mean p set: 0.4480615258216858
loss_pred:0.042225275188684464, decouple_loss:0.03961707651615143
loss_pred:0.041940320283174515, decouple_loss:0.0375753715634346
The modified gen p mean: 0.44962751865386963, gen p mean: -0.2890855073928833, mean p set: 0.45010778307914734
loss_pred:0.041280679404735565, decouple_loss:0.03749771788716316
Iteration: 422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812625646591187, gen p mean: -0.26935625076293945, mean p set: 0.44860655069351196
The modified gen p mean: 0.44815149903297424, gen p mean: -0.2736530005931854, mean p set: 0.44863179326057434
The modified gen p mean: 0.4471355676651001, gen p mean: -0.2725881338119507, mean p set: 0.4476158618927002
loss_pred:0.04154414311051369, decouple_loss:0.03669979050755501
loss_pred:0.03990530967712402, decouple_loss:0.0384637750685215
loss_pred:0.043351154774427414, decouple_loss:0.0385734923183918
Iteration: 423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490791857242584, gen p mean: -0.25951188802719116, mean p set: 0.4495594799518585
The modified gen p mean: 0.44808363914489746, gen p mean: -0.25438231229782104, mean p set: 0.44856393337249756
The modified gen p mean: 0.4488285779953003, gen p mean: -0.26523974537849426, mean p set: 0.449308842420578
loss_pred:0.04119783639907837, decouple_loss:0.037721071392297745
loss_pred:0.04266589134931564, decouple_loss:0.03852095454931259
loss_pred:0.04002980887889862, decouple_loss:0.03885870426893234
Iteration: 424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773584604263306, gen p mean: -0.2666632831096649, mean p set: 0.44821614027023315
The modified gen p mean: 0.4475351870059967, gen p mean: -0.2681557536125183, mean p set: 0.4480154812335968
The modified gen p mean: 0.4481147825717926, gen p mean: -0.26951706409454346, mean p set: 0.4485950767993927
loss_pred:0.043243326246738434, decouple_loss:0.03817533701658249
loss_pred:0.040370117872953415, decouple_loss:0.03739788383245468
loss_pred:0.041499774903059006, decouple_loss:0.037437546998262405
Iteration: 425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797784090042114, gen p mean: -0.2772643566131592, mean p set: 0.44845813512802124
The modified gen p mean: 0.4478897452354431, gen p mean: -0.27727851271629333, mean p set: 0.4483700692653656
The modified gen p mean: 0.44757816195487976, gen p mean: -0.27761128544807434, mean p set: 0.44805845618247986
loss_pred:0.040348272770643234, decouple_loss:0.037656500935554504
loss_pred:0.039170484989881516, decouple_loss:0.03753985837101936
loss_pred:0.04098257049918175, decouple_loss:0.03624817728996277
Iteration: 426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788751006126404, gen p mean: -0.27950021624565125, mean p set: 0.44836780428886414
The modified gen p mean: 0.4471130669116974, gen p mean: -0.278156042098999, mean p set: 0.4475933611392975
The modified gen p mean: 0.4473905861377716, gen p mean: -0.2758502960205078, mean p set: 0.4478708505630493
loss_pred:0.04400555044412613, decouple_loss:0.03711805120110512
loss_pred:0.04328691214323044, decouple_loss:0.03570805490016937
loss_pred:0.04164697602391243, decouple_loss:0.036607228219509125
Iteration: 427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765567779541016, gen p mean: -0.28498440980911255, mean p set: 0.44813597202301025
The modified gen p mean: 0.44774553179740906, gen p mean: -0.2782936096191406, mean p set: 0.44822585582733154
The modified gen p mean: 0.4480414092540741, gen p mean: -0.2830207347869873, mean p set: 0.4485217034816742
loss_pred:0.04274997487664223, decouple_loss:0.03613380715250969
loss_pred:0.04377732053399086, decouple_loss:0.03661433979868889
loss_pred:0.03970662131905556, decouple_loss:0.03688383474946022
Iteration: 428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486345052719116, gen p mean: -0.27242541313171387, mean p set: 0.4491148293018341
The modified gen p mean: 0.44797438383102417, gen p mean: -0.274192750453949, mean p set: 0.44845467805862427
The modified gen p mean: 0.44870510697364807, gen p mean: -0.27844443917274475, mean p set: 0.44918543100357056
loss_pred:0.04105767235159874, decouple_loss:0.0368797667324543
loss_pred:0.04039497673511505, decouple_loss:0.03612504154443741
loss_pred:0.040100060403347015, decouple_loss:0.036286696791648865
Iteration: 429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485374093055725, gen p mean: -0.2660973072052002, mean p set: 0.4490176737308502
The modified gen p mean: 0.44766753911972046, gen p mean: -0.2694808542728424, mean p set: 0.44814783334732056
The modified gen p mean: 0.44715616106987, gen p mean: -0.27879300713539124, mean p set: 0.4476364552974701
loss_pred:0.04103385657072067, decouple_loss:0.037435632199048996
loss_pred:0.0424220897257328, decouple_loss:0.037416182458400726
loss_pred:0.042146388441324234, decouple_loss:0.035881999880075455
Iteration: 430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482946991920471, gen p mean: -0.2703402638435364, mean p set: 0.4487749934196472
The modified gen p mean: 0.4481607675552368, gen p mean: -0.2749885022640228, mean p set: 0.4486410617828369
The modified gen p mean: 0.4470285177230835, gen p mean: -0.2681252956390381, mean p set: 0.4475088119506836
loss_pred:0.04178237542510033, decouple_loss:0.03578641638159752
loss_pred:0.04018571227788925, decouple_loss:0.03684766963124275
loss_pred:0.04244149476289749, decouple_loss:0.036303114145994186
2023-05-02 17:00:31 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.2710099518299103, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.27671685814857483, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.26667699217796326, mean p set: 0.45035696029663086
loss_pred:0.041991736739873886, decouple_loss:0.03648906201124191
loss_pred:0.04310522601008415, decouple_loss:0.03783527389168739
loss_pred:0.04083197936415672, decouple_loss:0.03715016692876816
WV_0_PC_1_EH_0_PS_40_6, loss: 0.043834224343299866, avg_mse: 0.04464889317750931
current test mse: 0.044649
Iteration: 431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768840074539185, gen p mean: -0.2727118730545044, mean p set: 0.44816869497299194
The modified gen p mean: 0.4481104910373688, gen p mean: -0.27369970083236694, mean p set: 0.44859078526496887
loss_pred:0.04137466847896576, decouple_loss:0.037067994475364685
loss_pred:0.039765145629644394, decouple_loss:0.03608373552560806
The modified gen p mean: 0.44735175371170044, gen p mean: -0.27164408564567566, mean p set: 0.44783204793930054
loss_pred:0.04241030290722847, decouple_loss:0.03602822870016098
Iteration: 432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44720330834388733, gen p mean: -0.26650139689445496, mean p set: 0.4476836025714874
The modified gen p mean: 0.44794023036956787, gen p mean: -0.2729429006576538, mean p set: 0.44842052459716797
The modified gen p mean: 0.4478502869606018, gen p mean: -0.2730131149291992, mean p set: 0.4483305513858795
loss_pred:0.041015591472387314, decouple_loss:0.03546811267733574
loss_pred:0.04146486148238182, decouple_loss:0.03573935478925705
loss_pred:0.042541153728961945, decouple_loss:0.03659906983375549
Iteration: 433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769522547721863, gen p mean: -0.28853514790534973, mean p set: 0.4481755197048187
The modified gen p mean: 0.44857919216156006, gen p mean: -0.27728110551834106, mean p set: 0.44905948638916016
The modified gen p mean: 0.44764888286590576, gen p mean: -0.2830267548561096, mean p set: 0.44812917709350586
loss_pred:0.03995366394519806, decouple_loss:0.035783056169748306
loss_pred:0.042746834456920624, decouple_loss:0.036288484930992126
loss_pred:0.04099150002002716, decouple_loss:0.03520047292113304
Iteration: 434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474719762802124, gen p mean: -0.28232434391975403, mean p set: 0.4479523003101349
The modified gen p mean: 0.4473233222961426, gen p mean: -0.288269579410553, mean p set: 0.44780364632606506
The modified gen p mean: 0.449092298746109, gen p mean: -0.2833181917667389, mean p set: 0.4495725929737091
loss_pred:0.04329507425427437, decouple_loss:0.035456277430057526
loss_pred:0.04065973684191704, decouple_loss:0.035411443561315536
loss_pred:0.04143337905406952, decouple_loss:0.0359622947871685
Iteration: 435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750165939331055, gen p mean: -0.27242767810821533, mean p set: 0.44798195362091064
The modified gen p mean: 0.44776225090026855, gen p mean: -0.26860129833221436, mean p set: 0.44824254512786865
The modified gen p mean: 0.44653695821762085, gen p mean: -0.2782205045223236, mean p set: 0.44701725244522095
loss_pred:0.040773000568151474, decouple_loss:0.035074930638074875
loss_pred:0.04297482594847679, decouple_loss:0.03662266209721565
loss_pred:0.04132329672574997, decouple_loss:0.03596680611371994
Iteration: 436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446834534406662, gen p mean: -0.2711864411830902, mean p set: 0.4473148286342621
The modified gen p mean: 0.4486341178417206, gen p mean: -0.2657107710838318, mean p set: 0.4491144120693207
The modified gen p mean: 0.4474109411239624, gen p mean: -0.2646408975124359, mean p set: 0.4478912055492401
loss_pred:0.0411934033036232, decouple_loss:0.03484255075454712
loss_pred:0.041293200105428696, decouple_loss:0.03581300750374794
loss_pred:0.042026299983263016, decouple_loss:0.03429064899682999
Iteration: 437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447274774312973, gen p mean: -0.27288925647735596, mean p set: 0.44775503873825073
The modified gen p mean: 0.4467989206314087, gen p mean: -0.27473556995391846, mean p set: 0.4472792148590088
The modified gen p mean: 0.447043240070343, gen p mean: -0.27125704288482666, mean p set: 0.4475235044956207
loss_pred:0.04114267975091934, decouple_loss:0.03352746739983559
loss_pred:0.04217345267534256, decouple_loss:0.03392888233065605
loss_pred:0.0402817465364933, decouple_loss:0.03421911597251892
Iteration: 438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44720175862312317, gen p mean: -0.28149667382240295, mean p set: 0.44768205285072327
The modified gen p mean: 0.4471810758113861, gen p mean: -0.28000608086586, mean p set: 0.4476613700389862
The modified gen p mean: 0.4476890563964844, gen p mean: -0.2819877564907074, mean p set: 0.4481693506240845
loss_pred:0.04306768625974655, decouple_loss:0.03437335789203644
loss_pred:0.04261644557118416, decouple_loss:0.03488115966320038
loss_pred:0.03933759033679962, decouple_loss:0.03336052969098091
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466698467731476, gen p mean: -0.27658283710479736, mean p set: 0.4471501410007477
The modified gen p mean: 0.44805118441581726, gen p mean: -0.2824908494949341, mean p set: 0.44853144884109497
The modified gen p mean: 0.4480394423007965, gen p mean: -0.278118371963501, mean p set: 0.4485197067260742
loss_pred:0.04239339008927345, decouple_loss:0.035522691905498505
loss_pred:0.03956135734915733, decouple_loss:0.03496711701154709
loss_pred:0.041328296065330505, decouple_loss:0.03654702007770538
Iteration: 440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482623338699341, gen p mean: -0.27506840229034424, mean p set: 0.4487426280975342
The modified gen p mean: 0.4476369321346283, gen p mean: -0.27578961849212646, mean p set: 0.4481172263622284
The modified gen p mean: 0.4472044110298157, gen p mean: -0.27053141593933105, mean p set: 0.44768473505973816
loss_pred:0.04246316850185394, decouple_loss:0.03494098037481308
loss_pred:0.041574131697416306, decouple_loss:0.03414927050471306
loss_pred:0.04229198768734932, decouple_loss:0.03568783402442932
2023-05-02 17:04:51 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.26575490832328796, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.27060991525650024, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.2613352835178375, mean p set: 0.45035696029663086
loss_pred:0.041414566338062286, decouple_loss:0.034448202699422836
loss_pred:0.042435936629772186, decouple_loss:0.03479839116334915
loss_pred:0.04034660384058952, decouple_loss:0.03506690636277199
WV_0_PC_1_EH_0_PS_40_6, loss: 0.04313759133219719, avg_mse: 0.04413409158587456
current test mse: 0.044134
Iteration: 441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472768306732178, gen p mean: -0.2644868791103363, mean p set: 0.4477570950984955
The modified gen p mean: 0.44715961813926697, gen p mean: -0.26619431376457214, mean p set: 0.4476398825645447
loss_pred:0.04255582019686699, decouple_loss:0.03509429469704628
loss_pred:0.041440874338150024, decouple_loss:0.034037575125694275
The modified gen p mean: 0.4472235441207886, gen p mean: -0.26316753029823303, mean p set: 0.44770386815071106
loss_pred:0.04129152372479439, decouple_loss:0.033487968146800995
Iteration: 442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44711413979530334, gen p mean: -0.2674742341041565, mean p set: 0.44759440422058105
The modified gen p mean: 0.447221040725708, gen p mean: -0.2698672413825989, mean p set: 0.4477013349533081
The modified gen p mean: 0.44752150774002075, gen p mean: -0.2619723081588745, mean p set: 0.44800183176994324
loss_pred:0.04099617153406143, decouple_loss:0.03345859423279762
loss_pred:0.04069514200091362, decouple_loss:0.03359883651137352
loss_pred:0.04167023301124573, decouple_loss:0.03344409912824631
Iteration: 443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488455653190613, gen p mean: -0.26700952649116516, mean p set: 0.449325829744339
The modified gen p mean: 0.44746914505958557, gen p mean: -0.2723258137702942, mean p set: 0.44794946908950806
The modified gen p mean: 0.4485773742198944, gen p mean: -0.2667602002620697, mean p set: 0.4490576982498169
loss_pred:0.04020271077752113, decouple_loss:0.034892488270998
loss_pred:0.04138493537902832, decouple_loss:0.03796368092298508
loss_pred:0.04053619131445885, decouple_loss:0.034455396234989166
Iteration: 444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44917985796928406, gen p mean: -0.2785565257072449, mean p set: 0.44966015219688416
The modified gen p mean: 0.44893425703048706, gen p mean: -0.280241459608078, mean p set: 0.44941452145576477
The modified gen p mean: 0.4472237229347229, gen p mean: -0.27887964248657227, mean p set: 0.4477039873600006
loss_pred:0.04017919674515724, decouple_loss:0.036178190261125565
loss_pred:0.04072832688689232, decouple_loss:0.035259269177913666
loss_pred:0.039119549095630646, decouple_loss:0.03455086052417755
Iteration: 445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481261670589447, gen p mean: -0.2866753339767456, mean p set: 0.4486064314842224
The modified gen p mean: 0.44741079211235046, gen p mean: -0.28521132469177246, mean p set: 0.44789108633995056
The modified gen p mean: 0.44760164618492126, gen p mean: -0.28821229934692383, mean p set: 0.448081910610199
loss_pred:0.03882623836398125, decouple_loss:0.03548410162329674
loss_pred:0.043925691395998, decouple_loss:0.036201778799295425
loss_pred:0.04299577698111534, decouple_loss:0.03471918776631355
Iteration: 446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478238523006439, gen p mean: -0.28475311398506165, mean p set: 0.448304146528244
The modified gen p mean: 0.44689857959747314, gen p mean: -0.27736321091651917, mean p set: 0.44737890362739563
The modified gen p mean: 0.447144091129303, gen p mean: -0.28496256470680237, mean p set: 0.44762441515922546
loss_pred:0.04163769260048866, decouple_loss:0.03514103218913078
loss_pred:0.041357800364494324, decouple_loss:0.03374055027961731
loss_pred:0.041212428361177444, decouple_loss:0.03543305769562721
Iteration: 447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471721351146698, gen p mean: -0.2839091122150421, mean p set: 0.4476523995399475
The modified gen p mean: 0.4477587342262268, gen p mean: -0.2827725410461426, mean p set: 0.4482389986515045
The modified gen p mean: 0.44782301783561707, gen p mean: -0.2798083424568176, mean p set: 0.44830334186553955
loss_pred:0.04212382063269615, decouple_loss:0.03515804186463356
loss_pred:0.04072760045528412, decouple_loss:0.03467993438243866
loss_pred:0.04184409976005554, decouple_loss:0.035959213972091675
Iteration: 448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710662961006165, gen p mean: -0.2874554395675659, mean p set: 0.44758692383766174
The modified gen p mean: 0.4477773904800415, gen p mean: -0.28136903047561646, mean p set: 0.4482576549053192
The modified gen p mean: 0.448211133480072, gen p mean: -0.2807875871658325, mean p set: 0.44869139790534973
loss_pred:0.04213886708021164, decouple_loss:0.03472699224948883
loss_pred:0.0412939228117466, decouple_loss:0.03420276567339897
loss_pred:0.039209622889757156, decouple_loss:0.0335979126393795
Iteration: 449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473575949668884, gen p mean: -0.27542412281036377, mean p set: 0.4478378891944885
The modified gen p mean: 0.44782400131225586, gen p mean: -0.2757158577442169, mean p set: 0.44830429553985596
The modified gen p mean: 0.44840559363365173, gen p mean: -0.2739601731300354, mean p set: 0.44888588786125183
loss_pred:0.04029221832752228, decouple_loss:0.03292987123131752
loss_pred:0.03957606479525566, decouple_loss:0.03589169681072235
loss_pred:0.03990837559103966, decouple_loss:0.036144375801086426
Iteration: 450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812920689582825, gen p mean: -0.27788689732551575, mean p set: 0.44860947132110596
The modified gen p mean: 0.4467315375804901, gen p mean: -0.27189090847969055, mean p set: 0.4472118318080902
The modified gen p mean: 0.4481803774833679, gen p mean: -0.2779752016067505, mean p set: 0.44866064190864563
loss_pred:0.04016944766044617, decouple_loss:0.034667689353227615
loss_pred:0.04144240915775299, decouple_loss:0.034329164773225784
loss_pred:0.040119949728250504, decouple_loss:0.035726118832826614
2023-05-02 17:08:35 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.28419798612594604, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.28924939036369324, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.28047558665275574, mean p set: 0.45035696029663086
loss_pred:0.04087274521589279, decouple_loss:0.03444580361247063
loss_pred:0.04189704731106758, decouple_loss:0.03596468269824982
loss_pred:0.03987390920519829, decouple_loss:0.03509465605020523
WV_0_PC_1_EH_0_PS_40_6, loss: 0.042639654129743576, avg_mse: 0.04358195886015892
current test mse: 0.043582
Iteration: 451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484303593635559, gen p mean: -0.2814856171607971, mean p set: 0.448910653591156
loss_pred:0.039473291486501694, decouple_loss:0.03476313129067421
The modified gen p mean: 0.4477115571498871, gen p mean: -0.28461527824401855, mean p set: 0.4481918513774872
loss_pred:0.040608152747154236, decouple_loss:0.033439960330724716
The modified gen p mean: 0.44848939776420593, gen p mean: -0.2825169563293457, mean p set: 0.44896969199180603
loss_pred:0.040448836982250214, decouple_loss:0.03493649140000343
Iteration: 452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479084014892578, gen p mean: -0.2950209975242615, mean p set: 0.4483886957168579
The modified gen p mean: 0.446647047996521, gen p mean: -0.2934967577457428, mean p set: 0.4471273422241211
The modified gen p mean: 0.447181761264801, gen p mean: -0.2856258153915405, mean p set: 0.4476620554924011
loss_pred:0.04066593572497368, decouple_loss:0.034258678555488586
loss_pred:0.04162827879190445, decouple_loss:0.03471605107188225
loss_pred:0.042012277990579605, decouple_loss:0.0340399295091629
Iteration: 453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849151372909546, gen p mean: -0.2860743999481201, mean p set: 0.44897186756134033
The modified gen p mean: 0.4479628801345825, gen p mean: -0.2884639501571655, mean p set: 0.448443204164505
The modified gen p mean: 0.4481221139431, gen p mean: -0.28772056102752686, mean p set: 0.4486024081707001
loss_pred:0.04213055968284607, decouple_loss:0.03384553641080856
loss_pred:0.039512213319540024, decouple_loss:0.033877450972795486
loss_pred:0.040718961507081985, decouple_loss:0.03397319093346596
Iteration: 454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480065703392029, gen p mean: -0.2844352126121521, mean p set: 0.448486864566803
The modified gen p mean: 0.4465716779232025, gen p mean: -0.28721725940704346, mean p set: 0.4470519721508026
The modified gen p mean: 0.4480859935283661, gen p mean: -0.28661513328552246, mean p set: 0.4485662877559662
loss_pred:0.039364490658044815, decouple_loss:0.034133490175008774
loss_pred:0.040899962186813354, decouple_loss:0.03344034031033516
loss_pred:0.03943830356001854, decouple_loss:0.03336375951766968
Iteration: 455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468585252761841, gen p mean: -0.28893139958381653, mean p set: 0.4473388195037842
The modified gen p mean: 0.44832539558410645, gen p mean: -0.29123756289482117, mean p set: 0.44880568981170654
The modified gen p mean: 0.4464516043663025, gen p mean: -0.28588709235191345, mean p set: 0.4469318985939026
loss_pred:0.04058320075273514, decouple_loss:0.033401213586330414
loss_pred:0.039999376982450485, decouple_loss:0.033508334308862686
loss_pred:0.042703475803136826, decouple_loss:0.03445396572351456
Iteration: 456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469423294067383, gen p mean: -0.2779828608036041, mean p set: 0.447422593832016
The modified gen p mean: 0.4469960927963257, gen p mean: -0.2768270671367645, mean p set: 0.4474763870239258
The modified gen p mean: 0.44735005497932434, gen p mean: -0.27632051706314087, mean p set: 0.44783034920692444
loss_pred:0.03946609050035477, decouple_loss:0.033777978271245956
loss_pred:0.041409932076931, decouple_loss:0.033535897731781006
loss_pred:0.04089730978012085, decouple_loss:0.0338468998670578
Iteration: 457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446898490190506, gen p mean: -0.28433793783187866, mean p set: 0.4473787844181061
The modified gen p mean: 0.4486684203147888, gen p mean: -0.28291448950767517, mean p set: 0.4491487443447113
The modified gen p mean: 0.44752365350723267, gen p mean: -0.28292009234428406, mean p set: 0.44800394773483276
loss_pred:0.040663547813892365, decouple_loss:0.03381138667464256
loss_pred:0.039857856929302216, decouple_loss:0.03430488333106041
loss_pred:0.04105309024453163, decouple_loss:0.03327209874987602
Iteration: 458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722872972488403, gen p mean: -0.2903718948364258, mean p set: 0.4477090537548065
The modified gen p mean: 0.4487683176994324, gen p mean: -0.28766292333602905, mean p set: 0.44924864172935486
The modified gen p mean: 0.447517991065979, gen p mean: -0.28782883286476135, mean p set: 0.4479982852935791
loss_pred:0.04021111875772476, decouple_loss:0.032294515520334244
loss_pred:0.040036510676145554, decouple_loss:0.03321519121527672
loss_pred:0.03869402036070824, decouple_loss:0.03300488367676735
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
NaN value num: 0
Iteration: 459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45338529348373413, gen p mean: -0.2868538796901703, mean p set: 0.45386558771133423
The modified gen p mean: 0.4534513056278229, gen p mean: -0.2927333116531372, mean p set: 0.45393162965774536
The modified gen p mean: 0.45261839032173157, gen p mean: -0.29511934518814087, mean p set: 0.4530986547470093
loss_pred:0.042552005499601364, decouple_loss:0.04244144260883331
loss_pred:0.04190681129693985, decouple_loss:0.04250709339976311
loss_pred:0.040362127125263214, decouple_loss:0.040463823825120926
Iteration: 460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45191672444343567, gen p mean: -0.29867497086524963, mean p set: 0.4523969888687134
The modified gen p mean: 0.4521476924419403, gen p mean: -0.2977270781993866, mean p set: 0.4526279866695404
The modified gen p mean: 0.45086798071861267, gen p mean: -0.29973188042640686, mean p set: 0.4513482451438904
loss_pred:0.04171852767467499, decouple_loss:0.03811144828796387
loss_pred:0.043128833174705505, decouple_loss:0.03911997750401497
loss_pred:0.041367679834365845, decouple_loss:0.03653767704963684
2023-05-02 17:12:52 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.30514442920684814, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.2997271716594696, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.2957219183444977, mean p set: 0.45035696029663086
loss_pred:0.04093519225716591, decouple_loss:0.03545432910323143
loss_pred:0.041982825845479965, decouple_loss:0.036903880536556244
loss_pred:0.04014177992939949, decouple_loss:0.03660348057746887
WV_0_PC_1_EH_0_PS_40_6, loss: 0.042835962027311325, avg_mse: 0.04397759959101677
current test mse: 0.043978
Iteration: 461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515520930290222, gen p mean: -0.29627475142478943, mean p set: 0.45203232765197754
loss_pred:0.04296690225601196, decouple_loss:0.03884948417544365
The modified gen p mean: 0.4518061578273773, gen p mean: -0.2996200621128082, mean p set: 0.45228642225265503
loss_pred:0.04118594527244568, decouple_loss:0.039546363055706024
The modified gen p mean: 0.4522055685520172, gen p mean: -0.30157649517059326, mean p set: 0.4526858329772949
loss_pred:0.041569486260414124, decouple_loss:0.039613377302885056
Iteration: 462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526793360710144, gen p mean: -0.30690839886665344, mean p set: 0.4531596302986145
The modified gen p mean: 0.4520944654941559, gen p mean: -0.2972795367240906, mean p set: 0.452574759721756
The modified gen p mean: 0.4523658752441406, gen p mean: -0.2970758378505707, mean p set: 0.4528461992740631
loss_pred:0.04102142155170441, decouple_loss:0.0390685498714447
loss_pred:0.041269879788160324, decouple_loss:0.03757629543542862
loss_pred:0.04162073880434036, decouple_loss:0.03717178851366043
Iteration: 463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514908194541931, gen p mean: -0.3009933531284332, mean p set: 0.4519711136817932
The modified gen p mean: 0.45310261845588684, gen p mean: -0.30247610807418823, mean p set: 0.45358291268348694
The modified gen p mean: 0.45124924182891846, gen p mean: -0.29733696579933167, mean p set: 0.45172953605651855
loss_pred:0.04368206858634949, decouple_loss:0.03769034519791603
loss_pred:0.039494019001722336, decouple_loss:0.04005881026387215
loss_pred:0.04085486754775047, decouple_loss:0.03716696426272392
Iteration: 464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527018666267395, gen p mean: -0.3221728503704071, mean p set: 0.4531821608543396
The modified gen p mean: 0.4521663784980774, gen p mean: -0.3055490553379059, mean p set: 0.4526466727256775
The modified gen p mean: 0.45241695642471313, gen p mean: -0.3051517605781555, mean p set: 0.45289722084999084
loss_pred:0.040286678820848465, decouple_loss:0.03890411555767059
loss_pred:0.041809484362602234, decouple_loss:0.03628005087375641
loss_pred:0.04048047587275505, decouple_loss:0.03708463907241821
Iteration: 465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532967507839203, gen p mean: -0.33371302485466003, mean p set: 0.453777015209198
The modified gen p mean: 0.452045738697052, gen p mean: -0.32272860407829285, mean p set: 0.4525260329246521
The modified gen p mean: 0.45173466205596924, gen p mean: -0.3217809796333313, mean p set: 0.45221495628356934
loss_pred:0.04050290212035179, decouple_loss:0.03824269026517868
loss_pred:0.041765984147787094, decouple_loss:0.03650493919849396
loss_pred:0.04145520552992821, decouple_loss:0.03634164109826088
Iteration: 466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515134394168854, gen p mean: -0.32573333382606506, mean p set: 0.4519937038421631
The modified gen p mean: 0.45066335797309875, gen p mean: -0.32207775115966797, mean p set: 0.45114362239837646
The modified gen p mean: 0.4524117708206177, gen p mean: -0.32806307077407837, mean p set: 0.4528920352458954
loss_pred:0.04027123376727104, decouple_loss:0.03651612997055054
loss_pred:0.04029541090130806, decouple_loss:0.038211699575185776
loss_pred:0.040864381939172745, decouple_loss:0.03670636937022209
Iteration: 467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45355185866355896, gen p mean: -0.3312038481235504, mean p set: 0.45403215289115906
The modified gen p mean: 0.4506920874118805, gen p mean: -0.3240238130092621, mean p set: 0.4511723518371582
The modified gen p mean: 0.452165812253952, gen p mean: -0.3309154510498047, mean p set: 0.4526461064815521
loss_pred:0.03944679722189903, decouple_loss:0.03686002269387245
loss_pred:0.042310040444135666, decouple_loss:0.03631855919957161
loss_pred:0.04104381054639816, decouple_loss:0.03543997183442116
Iteration: 468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45258286595344543, gen p mean: -0.3312952220439911, mean p set: 0.45306316018104553
The modified gen p mean: 0.4524240493774414, gen p mean: -0.33119022846221924, mean p set: 0.4529043138027191
The modified gen p mean: 0.4518676698207855, gen p mean: -0.33596858382225037, mean p set: 0.4523479640483856
loss_pred:0.040566541254520416, decouple_loss:0.03578781709074974
loss_pred:0.03981655091047287, decouple_loss:0.036226484924554825
loss_pred:0.03962292894721031, decouple_loss:0.03572247549891472
Iteration: 469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518750011920929, gen p mean: -0.3282015025615692, mean p set: 0.452355295419693
The modified gen p mean: 0.45091700553894043, gen p mean: -0.33354124426841736, mean p set: 0.4513972997665405
The modified gen p mean: 0.4507414400577545, gen p mean: -0.3279438614845276, mean p set: 0.4512217342853546
loss_pred:0.03995823860168457, decouple_loss:0.03693847730755806
loss_pred:0.04097510874271393, decouple_loss:0.037035323679447174
loss_pred:0.03993827849626541, decouple_loss:0.03659956902265549
Iteration: 470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520377218723297, gen p mean: -0.32617393136024475, mean p set: 0.4525179862976074
The modified gen p mean: 0.4535418450832367, gen p mean: -0.3266010880470276, mean p set: 0.4540221691131592
The modified gen p mean: 0.4512045681476593, gen p mean: -0.323521226644516, mean p set: 0.4516848623752594
loss_pred:0.0401129387319088, decouple_loss:0.03502904996275902
loss_pred:0.039401788264513016, decouple_loss:0.03671533614397049
loss_pred:0.04194370657205582, decouple_loss:0.038344427943229675
2023-05-02 17:16:37 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.31536516547203064, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.320700079202652, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.31175169348716736, mean p set: 0.45035696029663086
loss_pred:0.04121291637420654, decouple_loss:0.03829517588019371
loss_pred:0.0424070730805397, decouple_loss:0.04019846022129059
loss_pred:0.040231045335531235, decouple_loss:0.03904230520129204
WV_0_PC_1_EH_0_PS_40_6, loss: 0.04324261099100113, avg_mse: 0.04448338970541954
current test mse: 0.044483
Iteration: 471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45192664861679077, gen p mean: -0.3157437741756439, mean p set: 0.45240697264671326
loss_pred:0.0398169569671154, decouple_loss:0.03522595390677452
The modified gen p mean: 0.4515027701854706, gen p mean: -0.3183804750442505, mean p set: 0.45198309421539307
loss_pred:0.04092371091246605, decouple_loss:0.03552911430597305
The modified gen p mean: 0.4532409906387329, gen p mean: -0.33027195930480957, mean p set: 0.4537212550640106
loss_pred:0.04057375341653824, decouple_loss:0.036395929753780365
Iteration: 472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45133957266807556, gen p mean: -0.31683552265167236, mean p set: 0.45181983709335327
The modified gen p mean: 0.45147213339805603, gen p mean: -0.32334378361701965, mean p set: 0.45195239782333374
The modified gen p mean: 0.45063403248786926, gen p mean: -0.3174091577529907, mean p set: 0.451114296913147
loss_pred:0.04309993237257004, decouple_loss:0.03758610039949417
loss_pred:0.0414537712931633, decouple_loss:0.03535161167383194
loss_pred:0.042009077966213226, decouple_loss:0.035143617540597916
Iteration: 473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512758255004883, gen p mean: -0.31438004970550537, mean p set: 0.4517561197280884
The modified gen p mean: 0.45193371176719666, gen p mean: -0.3176790773868561, mean p set: 0.45241400599479675
The modified gen p mean: 0.45180773735046387, gen p mean: -0.3220627009868622, mean p set: 0.45228806138038635
loss_pred:0.041296396404504776, decouple_loss:0.03655374050140381
loss_pred:0.04035905748605728, decouple_loss:0.035881321877241135
loss_pred:0.039664462208747864, decouple_loss:0.035679567605257034
Iteration: 474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512392580509186, gen p mean: -0.316721647977829, mean p set: 0.45171958208084106
The modified gen p mean: 0.4526510536670685, gen p mean: -0.32082974910736084, mean p set: 0.4531313478946686
The modified gen p mean: 0.45314139127731323, gen p mean: -0.32138365507125854, mean p set: 0.45362168550491333
loss_pred:0.040347620844841, decouple_loss:0.03489161282777786
loss_pred:0.0408623181283474, decouple_loss:0.03566731885075569
loss_pred:0.03883643448352814, decouple_loss:0.03892548754811287
Iteration: 475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527105987071991, gen p mean: -0.3306235074996948, mean p set: 0.4531908929347992
The modified gen p mean: 0.4533820152282715, gen p mean: -0.3404322862625122, mean p set: 0.4538623094558716
The modified gen p mean: 0.4532608985900879, gen p mean: -0.3366008698940277, mean p set: 0.453741192817688
loss_pred:0.03890746086835861, decouple_loss:0.035730648785829544
loss_pred:0.041216980665922165, decouple_loss:0.0375659205019474
loss_pred:0.040456850081682205, decouple_loss:0.03757363557815552
Iteration: 476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510209262371063, gen p mean: -0.33198776841163635, mean p set: 0.45150119066238403
The modified gen p mean: 0.4517366290092468, gen p mean: -0.33789363503456116, mean p set: 0.4522169232368469
The modified gen p mean: 0.45208412408828735, gen p mean: -0.3375825583934784, mean p set: 0.45256444811820984
loss_pred:0.041915297508239746, decouple_loss:0.036417387425899506
loss_pred:0.04040292650461197, decouple_loss:0.033938609063625336
loss_pred:0.03941233083605766, decouple_loss:0.03490534797310829
Iteration: 477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513983428478241, gen p mean: -0.3245462477207184, mean p set: 0.4518786072731018
The modified gen p mean: 0.45239338278770447, gen p mean: -0.3347092866897583, mean p set: 0.45287367701530457
The modified gen p mean: 0.45035693049430847, gen p mean: -0.32618334889411926, mean p set: 0.4508371949195862
loss_pred:0.041607633233070374, decouple_loss:0.03735625371336937
loss_pred:0.03926748409867287, decouple_loss:0.03673671558499336
loss_pred:0.041794877499341965, decouple_loss:0.03538244217634201
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471014738082886, gen p mean: -0.3275642395019531, mean p set: 0.4475817382335663
The modified gen p mean: 0.44778892397880554, gen p mean: -0.32810381054878235, mean p set: 0.44826918840408325
The modified gen p mean: 0.4480283856391907, gen p mean: -0.3285657465457916, mean p set: 0.44850867986679077
loss_pred:0.041861992329359055, decouple_loss:0.03672143816947937
loss_pred:0.042000800371170044, decouple_loss:0.03939216956496239
loss_pred:0.0438712015748024, decouple_loss:0.0390273816883564
Iteration: 479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472449719905853, gen p mean: -0.3519064486026764, mean p set: 0.4477252662181854
The modified gen p mean: 0.44882652163505554, gen p mean: -0.3437926471233368, mean p set: 0.44930681586265564
The modified gen p mean: 0.4471522867679596, gen p mean: -0.34772977232933044, mean p set: 0.4476326107978821
loss_pred:0.04310106113553047, decouple_loss:0.03911244124174118
loss_pred:0.043234921991825104, decouple_loss:0.03777846693992615
loss_pred:0.04090224578976631, decouple_loss:0.03807879239320755
Iteration: 480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835665822029114, gen p mean: -0.34775951504707336, mean p set: 0.4488369822502136
The modified gen p mean: 0.44716429710388184, gen p mean: -0.3430213928222656, mean p set: 0.44764459133148193
The modified gen p mean: 0.4474680721759796, gen p mean: -0.343022882938385, mean p set: 0.4479483664035797
loss_pred:0.040965110063552856, decouple_loss:0.03842927888035774loss_pred:0.04194081574678421, decouple_loss:0.037854909896850586
loss_pred:0.04090351611375809, decouple_loss:0.036546818912029266
2023-05-02 17:21:06 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.3298105001449585, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.33467531204223633, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.3253406286239624, mean p set: 0.45035696029663086
loss_pred:0.04068911448121071, decouple_loss:0.03653139993548393
loss_pred:0.04188268631696701, decouple_loss:0.03893794119358063
loss_pred:0.03970682621002197, decouple_loss:0.03727690875530243
WV_0_PC_1_EH_0_PS_40_6, loss: 0.04263864457607269, avg_mse: 0.04375794902443886
current test mse: 0.043758
Iteration: 481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44597384333610535, gen p mean: -0.32380804419517517, mean p set: 0.44645413756370544
The modified gen p mean: 0.4477037787437439, gen p mean: -0.3286108374595642, mean p set: 0.448184072971344
loss_pred:0.04152616485953331, decouple_loss:0.039554987102746964
loss_pred:0.04276095703244209, decouple_loss:0.03783855214715004
The modified gen p mean: 0.4472908675670624, gen p mean: -0.3249582052230835, mean p set: 0.44777119159698486
loss_pred:0.042747173458337784, decouple_loss:0.037650976330041885
Iteration: 482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475595951080322, gen p mean: -0.3186696469783783, mean p set: 0.4480399191379547
The modified gen p mean: 0.44746750593185425, gen p mean: -0.3242291212081909, mean p set: 0.44794782996177673
The modified gen p mean: 0.44919610023498535, gen p mean: -0.3178626298904419, mean p set: 0.44967639446258545
loss_pred:0.03998255729675293, decouple_loss:0.03615836426615715
loss_pred:0.04339722916483879, decouple_loss:0.037131503224372864
loss_pred:0.041986335068941116, decouple_loss:0.03608899191021919
Iteration: 483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798973202705383, gen p mean: -0.32144567370414734, mean p set: 0.44847002625465393
The modified gen p mean: 0.44903576374053955, gen p mean: -0.33041417598724365, mean p set: 0.44951605796813965
The modified gen p mean: 0.4483889639377594, gen p mean: -0.3215489983558655, mean p set: 0.4488692581653595
loss_pred:0.042356472462415695, decouple_loss:0.03613043576478958
loss_pred:0.040047917515039444, decouple_loss:0.03637164458632469
loss_pred:0.041719675064086914, decouple_loss:0.036124810576438904
Iteration: 484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764211773872375, gen p mean: -0.34459948539733887, mean p set: 0.44812238216400146
The modified gen p mean: 0.4463062286376953, gen p mean: -0.33687806129455566, mean p set: 0.4467865526676178
The modified gen p mean: 0.4475211799144745, gen p mean: -0.3434419333934784, mean p set: 0.4480014741420746
loss_pred:0.041738275438547134, decouple_loss:0.03587356209754944
loss_pred:0.043644994497299194, decouple_loss:0.037153635174036026
loss_pred:0.04026758670806885, decouple_loss:0.03692258894443512
Iteration: 485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479629695415497, gen p mean: -0.34275245666503906, mean p set: 0.44844329357147217
The modified gen p mean: 0.44732344150543213, gen p mean: -0.3395182192325592, mean p set: 0.44780370593070984
The modified gen p mean: 0.4482065737247467, gen p mean: -0.34138286113739014, mean p set: 0.4486868679523468
loss_pred:0.04343745484948158, decouple_loss:0.03692357614636421
loss_pred:0.04205198958516121, decouple_loss:0.036917299032211304
loss_pred:0.04045414179563522, decouple_loss:0.035789091140031815
Iteration: 486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719794392585754, gen p mean: -0.3350205719470978, mean p set: 0.44767823815345764
The modified gen p mean: 0.44597190618515015, gen p mean: -0.3280990421772003, mean p set: 0.44645223021507263
The modified gen p mean: 0.44818437099456787, gen p mean: -0.3310846984386444, mean p set: 0.4486646354198456
loss_pred:0.040315449237823486, decouple_loss:0.0360197015106678
loss_pred:0.041782066226005554, decouple_loss:0.036472488194704056
loss_pred:0.040507543832063675, decouple_loss:0.03469312936067581
Iteration: 487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448258638381958, gen p mean: -0.31438374519348145, mean p set: 0.4487389624118805
The modified gen p mean: 0.4474125802516937, gen p mean: -0.3222109079360962, mean p set: 0.4478928744792938
The modified gen p mean: 0.4487364590167999, gen p mean: -0.3153872489929199, mean p set: 0.4492167532444
loss_pred:0.04301448538899422, decouple_loss:0.036674708127975464
loss_pred:0.0406758077442646, decouple_loss:0.03581390529870987
loss_pred:0.042909860610961914, decouple_loss:0.036826618015766144
Iteration: 488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445667028427124, gen p mean: -0.30806320905685425, mean p set: 0.4461473524570465
The modified gen p mean: 0.44793835282325745, gen p mean: -0.3129357099533081, mean p set: 0.44841864705085754
The modified gen p mean: 0.4480310380458832, gen p mean: -0.31338247656822205, mean p set: 0.4485113322734833
loss_pred:0.04257186874747276, decouple_loss:0.03671955317258835
loss_pred:0.0412052720785141, decouple_loss:0.03674005717039108
loss_pred:0.03959261626005173, decouple_loss:0.03614538162946701
Iteration: 489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447185218334198, gen p mean: -0.3124965727329254, mean p set: 0.4476655125617981
The modified gen p mean: 0.4471624791622162, gen p mean: -0.31221142411231995, mean p set: 0.44764280319213867
The modified gen p mean: 0.44895514845848083, gen p mean: -0.31099534034729004, mean p set: 0.4494354724884033
loss_pred:0.039264023303985596, decouple_loss:0.03680330514907837
loss_pred:0.04175916314125061, decouple_loss:0.03715619072318077
loss_pred:0.04089203104376793, decouple_loss:0.035607289522886276
Iteration: 490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490233063697815, gen p mean: -0.3133990168571472, mean p set: 0.4495036005973816
The modified gen p mean: 0.4476211369037628, gen p mean: -0.32215580344200134, mean p set: 0.4481014013290405
The modified gen p mean: 0.4486062824726105, gen p mean: -0.31527775526046753, mean p set: 0.44908660650253296
loss_pred:0.04315854609012604, decouple_loss:0.03646562993526459
loss_pred:0.04095211252570152, decouple_loss:0.03478359803557396
loss_pred:0.04311046004295349, decouple_loss:0.03729875013232231

2023-05-02 17:24:54 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.32118794322013855, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.3151974678039551, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.3112552762031555, mean p set: 0.45035696029663086
loss_pred:0.04141717404127121, decouple_loss:0.0374772772192955
loss_pred:0.04016288369894028, decouple_loss:0.03572767600417137
loss_pred:0.039224740117788315, decouple_loss:0.03658636286854744
WV_0_PC_1_EH_0_PS_40_6, loss: 0.04209812730550766, avg_mse: 0.043286025524139404
current test mse: 0.043286
Iteration: 491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779133796691895, gen p mean: -0.31346166133880615, mean p set: 0.44827160239219666
The modified gen p mean: 0.4485549032688141, gen p mean: -0.30931735038757324, mean p set: 0.4490351974964142
loss_pred:0.04289383441209793, decouple_loss:0.036479003727436066
loss_pred:0.039175573736429214, decouple_loss:0.0345064178109169
The modified gen p mean: 0.4484618008136749, gen p mean: -0.3121587336063385, mean p set: 0.4489421248435974
loss_pred:0.04060809314250946, decouple_loss:0.03543253615498543
Iteration: 492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481883943080902, gen p mean: -0.3032210171222687, mean p set: 0.4486686885356903
The modified gen p mean: 0.4474603533744812, gen p mean: -0.3064908981323242, mean p set: 0.4479406476020813
The modified gen p mean: 0.44821876287460327, gen p mean: -0.30611494183540344, mean p set: 0.44869908690452576
loss_pred:0.04211723431944847, decouple_loss:0.03482959792017937
loss_pred:0.040332503616809845, decouple_loss:0.033810682594776154
loss_pred:0.042641542851924896, decouple_loss:0.03553064167499542
Iteration: 493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44641435146331787, gen p mean: -0.30433255434036255, mean p set: 0.44689464569091797
The modified gen p mean: 0.447562575340271, gen p mean: -0.3066282272338867, mean p set: 0.4480428397655487
The modified gen p mean: 0.4484391510486603, gen p mean: -0.3021244406700134, mean p set: 0.448919415473938
loss_pred:0.04257170855998993, decouple_loss:0.034683819860219955
loss_pred:0.03990327939391136, decouple_loss:0.0338149257004261
loss_pred:0.03980438411235809, decouple_loss:0.03390968218445778
Iteration: 494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4453616142272949, gen p mean: -0.31136295199394226, mean p set: 0.44584187865257263
The modified gen p mean: 0.4479886591434479, gen p mean: -0.30701744556427, mean p set: 0.448468953371048
The modified gen p mean: 0.44896137714385986, gen p mean: -0.30255642533302307, mean p set: 0.44944167137145996
loss_pred:0.0415375791490078, decouple_loss:0.035791292786598206
loss_pred:0.04088543727993965, decouple_loss:0.03361927717924118
loss_pred:0.041603222489356995, decouple_loss:0.034857816994190216
Iteration: 495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477511942386627, gen p mean: -0.315542608499527, mean p set: 0.4482314884662628
The modified gen p mean: 0.44841551780700684, gen p mean: -0.3091810345649719, mean p set: 0.44889581203460693
The modified gen p mean: 0.4493710398674011, gen p mean: -0.3078063428401947, mean p set: 0.44985130429267883
loss_pred:0.03970954567193985, decouple_loss:0.035137102007865906
loss_pred:0.042917538434267044, decouple_loss:0.03468064218759537
loss_pred:0.041120413690805435, decouple_loss:0.03650880977511406
Iteration: 496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468974173069, gen p mean: -0.3177391290664673, mean p set: 0.4473777115345001
The modified gen p mean: 0.4459593892097473, gen p mean: -0.3225879371166229, mean p set: 0.4464397132396698
The modified gen p mean: 0.4482795000076294, gen p mean: -0.31596285104751587, mean p set: 0.4487598240375519
loss_pred:0.04207692667841911, decouple_loss:0.034395989030599594
loss_pred:0.040768835693597794, decouple_loss:0.035219963639974594
loss_pred:0.040586668998003006, decouple_loss:0.034701209515333176
Iteration: 497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485762417316437, gen p mean: -0.3202725946903229, mean p set: 0.4490565061569214
The modified gen p mean: 0.4463588297367096, gen p mean: -0.32065436244010925, mean p set: 0.4468391239643097
The modified gen p mean: 0.4484703838825226, gen p mean: -0.3185570538043976, mean p set: 0.4489506781101227
loss_pred:0.04005388915538788, decouple_loss:0.034039754420518875
loss_pred:0.041331157088279724, decouple_loss:0.034545835107564926
loss_pred:0.04142054542899132, decouple_loss:0.03296026960015297
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
NaN value num: 0
Iteration: 498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013412833213806, gen p mean: -0.3197360336780548, mean p set: 0.45061448216438293
The modified gen p mean: 0.4498851001262665, gen p mean: -0.31781595945358276, mean p set: 0.4503653943538666
The modified gen p mean: 0.4525958001613617, gen p mean: -0.3170934319496155, mean p set: 0.4530760943889618
loss_pred:0.04094114154577255, decouple_loss:0.03690528869628906
loss_pred:0.038385163992643356, decouple_loss:0.038414228707551956
loss_pred:0.039080649614334106, decouple_loss:0.03624063357710838
Iteration: 499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485224783420563, gen p mean: -0.31497493386268616, mean p set: 0.44900277256965637
The modified gen p mean: 0.4503566026687622, gen p mean: -0.3111787438392639, mean p set: 0.4508368670940399
The modified gen p mean: 0.45103442668914795, gen p mean: -0.3156019151210785, mean p set: 0.45151469111442566
loss_pred:0.04208412766456604, decouple_loss:0.036325182765722275
loss_pred:0.039754755795001984, decouple_loss:0.03772681951522827
loss_pred:0.04105720296502113, decouple_loss:0.03735751286149025
Iteration: 500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45025256276130676, gen p mean: -0.30931830406188965, mean p set: 0.4507328271865845
The modified gen p mean: 0.4495698809623718, gen p mean: -0.30709922313690186, mean p set: 0.4500502049922943
The modified gen p mean: 0.4485822021961212, gen p mean: -0.3106335401535034, mean p set: 0.4490624964237213
loss_pred:0.03956546634435654, decouple_loss:0.03599787503480911
loss_pred:0.039712414145469666, decouple_loss:0.035576168447732925
loss_pred:0.041298508644104004, decouple_loss:0.03599294647574425
2023-05-02 17:29:17 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.3105245530605316, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.31550469994544983, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.3064548969268799, mean p set: 0.45035696029663086
loss_pred:0.040138471871614456, decouple_loss:0.035529106855392456
loss_pred:0.041109804064035416, decouple_loss:0.0366312712430954
loss_pred:0.03911350294947624, decouple_loss:0.03571847081184387
WV_0_PC_1_EH_0_PS_40_6, loss: 0.04191857576370239, avg_mse: 0.04330500587821007
current test mse: 0.043305
Iteration: 501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449357271194458, gen p mean: -0.3140181601047516, mean p set: 0.4498375654220581
loss_pred:0.03986329957842827, decouple_loss:0.036027856171131134
The modified gen p mean: 0.44972753524780273, gen p mean: -0.3137477934360504, mean p set: 0.45020779967308044
loss_pred:0.04052053391933441, decouple_loss:0.03674362972378731
The modified gen p mean: 0.4524904787540436, gen p mean: -0.3086104094982147, mean p set: 0.4529707729816437
loss_pred:0.03878919780254364, decouple_loss:0.03642960637807846
Iteration: 502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45101550221443176, gen p mean: -0.3282661437988281, mean p set: 0.45149579644203186
The modified gen p mean: 0.45188701152801514, gen p mean: -0.32529667019844055, mean p set: 0.45236724615097046
The modified gen p mean: 0.44985833764076233, gen p mean: -0.3254850208759308, mean p set: 0.4503386318683624
loss_pred:0.03986359015107155, decouple_loss:0.03574327751994133
loss_pred:0.03903184458613396, decouple_loss:0.03596826642751694
loss_pred:0.04008947312831879, decouple_loss:0.036733318120241165
Iteration: 503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498934745788574, gen p mean: -0.33511289954185486, mean p set: 0.45037373900413513
The modified gen p mean: 0.45197778940200806, gen p mean: -0.33149999380111694, mean p set: 0.45245808362960815
The modified gen p mean: 0.45086923241615295, gen p mean: -0.33510011434555054, mean p set: 0.45134952664375305
loss_pred:0.038583721965551376, decouple_loss:0.034404266625642776
loss_pred:0.038195837289094925, decouple_loss:0.03608692064881325
loss_pred:0.04180610924959183, decouple_loss:0.03673972934484482
Iteration: 504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45041948556900024, gen p mean: -0.32111644744873047, mean p set: 0.45089974999427795
The modified gen p mean: 0.4506535530090332, gen p mean: -0.32082852721214294, mean p set: 0.4511338472366333
The modified gen p mean: 0.45289772748947144, gen p mean: -0.31980666518211365, mean p set: 0.45337799191474915
loss_pred:0.038461510092020035, decouple_loss:0.034318238496780396
loss_pred:0.03849482536315918, decouple_loss:0.034658368676900864
loss_pred:0.03749240189790726, decouple_loss:0.03498675674200058
Iteration: 505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493951201438904, gen p mean: -0.3095585107803345, mean p set: 0.4498754143714905
The modified gen p mean: 0.449384868144989, gen p mean: -0.31323012709617615, mean p set: 0.4498651623725891
The modified gen p mean: 0.45044654607772827, gen p mean: -0.31218311190605164, mean p set: 0.45092687010765076
loss_pred:0.041697971522808075, decouple_loss:0.034619417041540146
loss_pred:0.041426319628953934, decouple_loss:0.034868448972702026
loss_pred:0.03861135244369507, decouple_loss:0.03531450033187866
Iteration: 506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488624632358551, gen p mean: -0.32248106598854065, mean p set: 0.4493427276611328
The modified gen p mean: 0.4495577812194824, gen p mean: -0.3263702988624573, mean p set: 0.45003804564476013
The modified gen p mean: 0.45205241441726685, gen p mean: -0.3295517861843109, mean p set: 0.45253270864486694
loss_pred:0.04091479256749153, decouple_loss:0.03444526717066765
loss_pred:0.03936105966567993, decouple_loss:0.03505295515060425
loss_pred:0.03977528214454651, decouple_loss:0.034841910004615784
Iteration: 507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529532790184021, gen p mean: -0.3313041925430298, mean p set: 0.4534335732460022
The modified gen p mean: 0.45071595907211304, gen p mean: -0.32638657093048096, mean p set: 0.45119625329971313
The modified gen p mean: 0.4483598470687866, gen p mean: -0.3259502351284027, mean p set: 0.4488401710987091
loss_pred:0.03757937252521515, decouple_loss:0.03608301654458046
loss_pred:0.04021856188774109, decouple_loss:0.03425319865345955
loss_pred:0.04009297862648964, decouple_loss:0.03559969365596771
Iteration: 508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499675929546356, gen p mean: -0.31528332829475403, mean p set: 0.4504478871822357
The modified gen p mean: 0.4500754475593567, gen p mean: -0.31132322549819946, mean p set: 0.4505557417869568
The modified gen p mean: 0.44967761635780334, gen p mean: -0.31570667028427124, mean p set: 0.45015794038772583
loss_pred:0.04115450754761696, decouple_loss:0.03536095470190048
loss_pred:0.04005169868469238, decouple_loss:0.03374283388257027
loss_pred:0.03950311616063118, decouple_loss:0.033541541546583176
Iteration: 509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45049503445625305, gen p mean: -0.30739402770996094, mean p set: 0.45097532868385315
The modified gen p mean: 0.4494932293891907, gen p mean: -0.3055276870727539, mean p set: 0.4499734938144684
The modified gen p mean: 0.4495936930179596, gen p mean: -0.3020933270454407, mean p set: 0.4500739574432373
loss_pred:0.039594847708940506, decouple_loss:0.033707574009895325
loss_pred:0.04042388126254082, decouple_loss:0.0339292474091053
loss_pred:0.039394672960042953, decouple_loss:0.03456473350524902
Iteration: 510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856005907058716, gen p mean: -0.3181082010269165, mean p set: 0.44904032349586487
The modified gen p mean: 0.4509352147579193, gen p mean: -0.3163658082485199, mean p set: 0.4514155089855194
The modified gen p mean: 0.45251452922821045, gen p mean: -0.3166406750679016, mean p set: 0.45299485325813293
loss_pred:0.04035130888223648, decouple_loss:0.03389094024896622
loss_pred:0.03793177008628845, decouple_loss:0.03368411958217621
loss_pred:0.0392134003341198, decouple_loss:0.034206558018922806
2023-05-02 17:32:59 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.32593002915382385, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.3317778706550598, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.3222282826900482, mean p set: 0.45035696029663086
loss_pred:0.04001529514789581, decouple_loss:0.03567233309149742
loss_pred:0.04098726436495781, decouple_loss:0.036845315247774124
loss_pred:0.039205994457006454, decouple_loss:0.0368347242474556
WV_0_PC_1_EH_0_PS_40_6, loss: 0.04189205914735794, avg_mse: 0.04334717243909836
current test mse: 0.043347
Iteration: 511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45275619626045227, gen p mean: -0.33155497908592224, mean p set: 0.45323646068573
The modified gen p mean: 0.4500582218170166, gen p mean: -0.3288056552410126, mean p set: 0.4505384862422943
loss_pred:0.03793744370341301, decouple_loss:0.034476056694984436
loss_pred:0.038769856095314026, decouple_loss:0.03443509712815285
The modified gen p mean: 0.45110011100769043, gen p mean: -0.3233986794948578, mean p set: 0.4515804052352905
loss_pred:0.0387953482568264, decouple_loss:0.03430147469043732
Iteration: 512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500119090080261, gen p mean: -0.3252772390842438, mean p set: 0.4504922032356262
The modified gen p mean: 0.44808024168014526, gen p mean: -0.32460665702819824, mean p set: 0.44856053590774536
The modified gen p mean: 0.45096853375434875, gen p mean: -0.32777270674705505, mean p set: 0.45144885778427124
loss_pred:0.038717109709978104, decouple_loss:0.03331482782959938
loss_pred:0.04042196646332741, decouple_loss:0.03364493325352669
loss_pred:0.04075782373547554, decouple_loss:0.03400718793272972
Iteration: 513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45028501749038696, gen p mean: -0.32605138421058655, mean p set: 0.4507652819156647
The modified gen p mean: 0.45196977257728577, gen p mean: -0.32646477222442627, mean p set: 0.45245006680488586
The modified gen p mean: 0.4504432678222656, gen p mean: -0.32786425948143005, mean p set: 0.4509235620498657
loss_pred:0.03933366388082504, decouple_loss:0.03353053331375122
loss_pred:0.03809308260679245, decouple_loss:0.03604497015476227
loss_pred:0.03955327719449997, decouple_loss:0.03396601602435112
Iteration: 514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44934824109077454, gen p mean: -0.3348466157913208, mean p set: 0.449828565120697
The modified gen p mean: 0.45096173882484436, gen p mean: -0.3373487591743469, mean p set: 0.45144200325012207
The modified gen p mean: 0.4487227201461792, gen p mean: -0.3391076326370239, mean p set: 0.4492030143737793
loss_pred:0.03983815386891365, decouple_loss:0.033114150166511536
loss_pred:0.03930666670203209, decouple_loss:0.03259994834661484
loss_pred:0.041013989597558975, decouple_loss:0.035550232976675034
Iteration: 515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018482208251953, gen p mean: -0.34029802680015564, mean p set: 0.450665146112442
The modified gen p mean: 0.4505613446235657, gen p mean: -0.3398648500442505, mean p set: 0.45104163885116577
The modified gen p mean: 0.4533085525035858, gen p mean: -0.341328501701355, mean p set: 0.4537888467311859
loss_pred:0.039240628480911255, decouple_loss:0.0325951874256134
loss_pred:0.0396762415766716, decouple_loss:0.03374319523572922
loss_pred:0.038014836609363556, decouple_loss:0.03343174606561661
Iteration: 516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45283302664756775, gen p mean: -0.3262377381324768, mean p set: 0.45331335067749023
The modified gen p mean: 0.4490398168563843, gen p mean: -0.3326176404953003, mean p set: 0.4495201110839844
The modified gen p mean: 0.4481806755065918, gen p mean: -0.329000860452652, mean p set: 0.4486609697341919
loss_pred:0.0367407463490963, decouple_loss:0.03474366292357445
loss_pred:0.03868970274925232, decouple_loss:0.03402246534824371
loss_pred:0.039866961538791656, decouple_loss:0.0336727499961853
Iteration: 517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44932544231414795, gen p mean: -0.3287560045719147, mean p set: 0.44980570673942566
The modified gen p mean: 0.44982415437698364, gen p mean: -0.3227189779281616, mean p set: 0.45030441880226135
The modified gen p mean: 0.4490213990211487, gen p mean: -0.3247746229171753, mean p set: 0.4495016634464264
loss_pred:0.03861327841877937, decouple_loss:0.03411238268017769
loss_pred:0.03861600160598755, decouple_loss:0.03228931128978729
loss_pred:0.04096165671944618, decouple_loss:0.03349076211452484
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
NaN value num: 0
Iteration: 518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446970671415329, gen p mean: -0.318033367395401, mean p set: 0.44745099544525146
The modified gen p mean: 0.4478738307952881, gen p mean: -0.3274603486061096, mean p set: 0.4483541250228882
The modified gen p mean: 0.445504754781723, gen p mean: -0.3272917568683624, mean p set: 0.4459850490093231
loss_pred:0.0404617078602314, decouple_loss:0.03507083281874657
loss_pred:0.04065191000699997, decouple_loss:0.03595259040594101
loss_pred:0.043276529759168625, decouple_loss:0.033466946333646774
Iteration: 519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463479816913605, gen p mean: -0.3341887891292572, mean p set: 0.44682827591896057
The modified gen p mean: 0.44541826844215393, gen p mean: -0.332537978887558, mean p set: 0.44589856266975403
The modified gen p mean: 0.4461263120174408, gen p mean: -0.33327779173851013, mean p set: 0.4466065764427185
loss_pred:0.04111878573894501, decouple_loss:0.035477980971336365
loss_pred:0.04157180339097977, decouple_loss:0.03559195250272751
loss_pred:0.04109058529138565, decouple_loss:0.034096598625183105
Iteration: 520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44539394974708557, gen p mean: -0.3297751247882843, mean p set: 0.44587424397468567
The modified gen p mean: 0.44684791564941406, gen p mean: -0.3302197754383087, mean p set: 0.44732820987701416
The modified gen p mean: 0.4479116201400757, gen p mean: -0.34151020646095276, mean p set: 0.4483919143676758
loss_pred:0.04158449172973633, decouple_loss:0.03550465404987335
loss_pred:0.042680367827415466, decouple_loss:0.03372882679104805
loss_pred:0.04010916128754616, decouple_loss:0.03705260157585144
2023-05-02 17:37:16 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.3262482285499573, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.3318801820278168, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.32171759009361267, mean p set: 0.45035696029663086
loss_pred:0.03948727250099182, decouple_loss:0.034101784229278564
loss_pred:0.04069073870778084, decouple_loss:0.03623335435986519
loss_pred:0.038561441004276276, decouple_loss:0.035102423280477524
WV_0_PC_1_EH_0_PS_40_6, loss: 0.041337110102176666, avg_mse: 0.04274735972285271
current test mse: 0.042747
Iteration: 521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474209249019623, gen p mean: -0.3303283154964447, mean p set: 0.4479012191295624
The modified gen p mean: 0.44873663783073425, gen p mean: -0.33070263266563416, mean p set: 0.44921690225601196
loss_pred:0.04059581458568573, decouple_loss:0.03405039757490158
loss_pred:0.04031480476260185, decouple_loss:0.03629172593355179
The modified gen p mean: 0.44816336035728455, gen p mean: -0.32686954736709595, mean p set: 0.44864365458488464
loss_pred:0.04023066908121109, decouple_loss:0.03413339704275131
Iteration: 522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745323061943054, gen p mean: -0.3275490999221802, mean p set: 0.44793352484703064
The modified gen p mean: 0.44685637950897217, gen p mean: -0.31988221406936646, mean p set: 0.44733667373657227
The modified gen p mean: 0.4452609717845917, gen p mean: -0.32763469219207764, mean p set: 0.4457412362098694
loss_pred:0.039469122886657715, decouple_loss:0.03420775756239891
loss_pred:0.042891182005405426, decouple_loss:0.03253817930817604
loss_pred:0.04036739841103554, decouple_loss:0.03476785495877266
Iteration: 523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44757890701293945, gen p mean: -0.33157220482826233, mean p set: 0.44805923104286194
The modified gen p mean: 0.44656720757484436, gen p mean: -0.32380279898643494, mean p set: 0.44704747200012207
The modified gen p mean: 0.44740989804267883, gen p mean: -0.32666072249412537, mean p set: 0.44789019227027893
loss_pred:0.040658511221408844, decouple_loss:0.03397481516003609
loss_pred:0.039927903562784195, decouple_loss:0.03284898027777672
loss_pred:0.04027589410543442, decouple_loss:0.03322311490774155
Iteration: 524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478360414505005, gen p mean: -0.3397376239299774, mean p set: 0.4483163356781006
The modified gen p mean: 0.44811344146728516, gen p mean: -0.3342036008834839, mean p set: 0.44859373569488525
The modified gen p mean: 0.4464341998100281, gen p mean: -0.32933351397514343, mean p set: 0.44691455364227295
loss_pred:0.039787981659173965, decouple_loss:0.035046834498643875
loss_pred:0.040584005415439606, decouple_loss:0.03346366807818413
loss_pred:0.03938910737633705, decouple_loss:0.03290705382823944
Iteration: 525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44663065671920776, gen p mean: -0.3333921432495117, mean p set: 0.4471109211444855
The modified gen p mean: 0.44537967443466187, gen p mean: -0.33483365178108215, mean p set: 0.4458599388599396
The modified gen p mean: 0.4478876292705536, gen p mean: -0.34009602665901184, mean p set: 0.4483678936958313
loss_pred:0.04197271913290024, decouple_loss:0.03391684591770172
loss_pred:0.0393560491502285, decouple_loss:0.03475321829319
loss_pred:0.03968492150306702, decouple_loss:0.03391747176647186
Iteration: 526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44770190119743347, gen p mean: -0.33749741315841675, mean p set: 0.44818219542503357
The modified gen p mean: 0.4474359154701233, gen p mean: -0.3457641899585724, mean p set: 0.4479162395000458
The modified gen p mean: 0.4462960958480835, gen p mean: -0.33594179153442383, mean p set: 0.4467763900756836
loss_pred:0.04053541272878647, decouple_loss:0.034115761518478394
loss_pred:0.04062386229634285, decouple_loss:0.03394285589456558
loss_pred:0.041471585631370544, decouple_loss:0.03503004461526871
Iteration: 527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471026360988617, gen p mean: -0.3278924822807312, mean p set: 0.4475829601287842
The modified gen p mean: 0.4458296597003937, gen p mean: -0.3287960886955261, mean p set: 0.4463099241256714
The modified gen p mean: 0.446939617395401, gen p mean: -0.3274933397769928, mean p set: 0.4474199414253235
loss_pred:0.0387769378721714, decouple_loss:0.03448201343417168
loss_pred:0.0419648140668869, decouple_loss:0.03375435248017311
loss_pred:0.04220006242394447, decouple_loss:0.03319229558110237
Iteration: 528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464193284511566, gen p mean: -0.34059447050094604, mean p set: 0.4468995928764343
The modified gen p mean: 0.4461621940135956, gen p mean: -0.3319151997566223, mean p set: 0.4466424882411957
The modified gen p mean: 0.4479663372039795, gen p mean: -0.33466288447380066, mean p set: 0.4484466016292572
loss_pred:0.04040294513106346, decouple_loss:0.03395865112543106
loss_pred:0.04058423265814781, decouple_loss:0.03239813446998596
loss_pred:0.04136030003428459, decouple_loss:0.032854266464710236
Iteration: 529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471900165081024, gen p mean: -0.3361532986164093, mean p set: 0.4476702809333801
The modified gen p mean: 0.44625091552734375, gen p mean: -0.3386083245277405, mean p set: 0.44673120975494385
The modified gen p mean: 0.4477715492248535, gen p mean: -0.3377436101436615, mean p set: 0.4482518434524536
loss_pred:0.03978735953569412, decouple_loss:0.032362282276153564
loss_pred:0.04065379872918129, decouple_loss:0.03297629952430725
loss_pred:0.041020579636096954, decouple_loss:0.03245018422603607
Iteration: 530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470862150192261, gen p mean: -0.33254411816596985, mean p set: 0.44756653904914856
The modified gen p mean: 0.446615993976593, gen p mean: -0.32789885997772217, mean p set: 0.4470962882041931
The modified gen p mean: 0.447578489780426, gen p mean: -0.3374570310115814, mean p set: 0.4480588138103485
loss_pred:0.038980964571237564, decouple_loss:0.031491968780756
loss_pred:0.04270658269524574, decouple_loss:0.0319303534924984
loss_pred:0.040438245981931686, decouple_loss:0.03269093856215477
2023-05-02 17:40:57 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.3326241075992584, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.32636740803718567, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.32161539793014526, mean p set: 0.45035696029663086
loss_pred:0.04034644737839699, decouple_loss:0.0350508987903595
loss_pred:0.039499927312135696, decouple_loss:0.03364625200629234
loss_pred:0.03839770704507828, decouple_loss:0.034233130514621735
WV_0_PC_1_EH_0_PS_40_6, loss: 0.041130196303129196, avg_mse: 0.04259886220097542
current test mse: 0.042599
Iteration: 531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463558495044708, gen p mean: -0.3286534547805786, mean p set: 0.4468361735343933
The modified gen p mean: 0.4466838240623474, gen p mean: -0.3241864740848541, mean p set: 0.4471641182899475
loss_pred:0.03985730931162834, decouple_loss:0.033278435468673706
loss_pred:0.04153910651803017, decouple_loss:0.03143386170268059
The modified gen p mean: 0.44676896929740906, gen p mean: -0.32596778869628906, mean p set: 0.44724923372268677
loss_pred:0.040743388235569, decouple_loss:0.032086871564388275
Iteration: 532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473522901535034, gen p mean: -0.3235776424407959, mean p set: 0.4478325843811035
The modified gen p mean: 0.44784945249557495, gen p mean: -0.3271244764328003, mean p set: 0.44832971692085266
The modified gen p mean: 0.4481044113636017, gen p mean: -0.3254328668117523, mean p set: 0.4485847055912018
loss_pred:0.041306544095277786, decouple_loss:0.03243119642138481
loss_pred:0.040218185633420944, decouple_loss:0.033485013991594315
loss_pred:0.039981961250305176, decouple_loss:0.03316513076424599
Iteration: 533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489671587944031, gen p mean: -0.3308510482311249, mean p set: 0.4494474530220032
The modified gen p mean: 0.4458533823490143, gen p mean: -0.3218430280685425, mean p set: 0.4463336765766144
The modified gen p mean: 0.445453941822052, gen p mean: -0.32671356201171875, mean p set: 0.4459342360496521
loss_pred:0.03977363556623459, decouple_loss:0.033479392528533936
loss_pred:0.04042472690343857, decouple_loss:0.033245984464883804
loss_pred:0.039951030164957047, decouple_loss:0.032799068838357925
Iteration: 534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44572141766548157, gen p mean: -0.3255152404308319, mean p set: 0.44620171189308167
The modified gen p mean: 0.4456147253513336, gen p mean: -0.3287092447280884, mean p set: 0.44609498977661133
The modified gen p mean: 0.4460795521736145, gen p mean: -0.32566314935684204, mean p set: 0.4465598464012146
loss_pred:0.0421205535531044, decouple_loss:0.031995367258787155
loss_pred:0.039789676666259766, decouple_loss:0.03265444561839104
loss_pred:0.04042276367545128, decouple_loss:0.03226005658507347
Iteration: 535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461279511451721, gen p mean: -0.33580321073532104, mean p set: 0.4466082453727722
The modified gen p mean: 0.4471697509288788, gen p mean: -0.32874369621276855, mean p set: 0.4476500451564789
The modified gen p mean: 0.4479689598083496, gen p mean: -0.3354949951171875, mean p set: 0.4484492540359497
loss_pred:0.03974606469273567, decouple_loss:0.031171970069408417
loss_pred:0.0419432669878006, decouple_loss:0.032342586666345596
loss_pred:0.03883979097008705, decouple_loss:0.03250313550233841
Iteration: 536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470093846321106, gen p mean: -0.3360153138637543, mean p set: 0.4474896788597107
The modified gen p mean: 0.4480862617492676, gen p mean: -0.33901911973953247, mean p set: 0.4485665559768677
The modified gen p mean: 0.44713306427001953, gen p mean: -0.3312909007072449, mean p set: 0.44761335849761963
loss_pred:0.039265114814043045, decouple_loss:0.032601408660411835
loss_pred:0.0397312305867672, decouple_loss:0.03220929577946663
loss_pred:0.04242447018623352, decouple_loss:0.031553614884614944
Iteration: 537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44683387875556946, gen p mean: -0.32740452885627747, mean p set: 0.44731420278549194
The modified gen p mean: 0.44587939977645874, gen p mean: -0.32650431990623474, mean p set: 0.44635969400405884
The modified gen p mean: 0.44766369462013245, gen p mean: -0.3349822163581848, mean p set: 0.44814398884773254
loss_pred:0.03956492245197296, decouple_loss:0.03287709504365921
loss_pred:0.040189553052186966, decouple_loss:0.03206432983279228
loss_pred:0.03934227675199509, decouple_loss:0.03375868499279022
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
NaN value num: 0
Iteration: 538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508225619792938, gen p mean: -0.3312140107154846, mean p set: 0.4513028562068939
The modified gen p mean: 0.4498710632324219, gen p mean: -0.3264141082763672, mean p set: 0.450351357460022
The modified gen p mean: 0.45042797923088074, gen p mean: -0.3241179883480072, mean p set: 0.45090827345848083
loss_pred:0.040444109588861465, decouple_loss:0.03796890750527382
loss_pred:0.04018581658601761, decouple_loss:0.03522711247205734
loss_pred:0.039582509547472, decouple_loss:0.03646262735128403
Iteration: 539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505538046360016, gen p mean: -0.32798248529434204, mean p set: 0.4510340988636017
The modified gen p mean: 0.4507042169570923, gen p mean: -0.32951289415359497, mean p set: 0.4511845111846924
The modified gen p mean: 0.45079562067985535, gen p mean: -0.3321557939052582, mean p set: 0.45127591490745544
loss_pred:0.040341198444366455, decouple_loss:0.03799419850111008
loss_pred:0.03894535079598427, decouple_loss:0.036136701703071594
loss_pred:0.04033047333359718, decouple_loss:0.03522201254963875
Iteration: 540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507591426372528, gen p mean: -0.3372310400009155, mean p set: 0.4512394070625305
The modified gen p mean: 0.4509621262550354, gen p mean: -0.33420029282569885, mean p set: 0.4514424204826355
The modified gen p mean: 0.4497520625591278, gen p mean: -0.343170166015625, mean p set: 0.4502323865890503
loss_pred:0.04013267904520035, decouple_loss:0.03480717912316322
loss_pred:0.03818686679005623, decouple_loss:0.0354817733168602
loss_pred:0.03974400460720062, decouple_loss:0.037065934389829636
2023-05-02 17:45:14 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.3566702902317047, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.3494032025337219, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.3435750901699066, mean p set: 0.45035696029663086
loss_pred:0.04048215225338936, decouple_loss:0.03526104986667633
loss_pred:0.039293572306632996, decouple_loss:0.03366852551698685
loss_pred:0.038343679159879684, decouple_loss:0.03461071476340294
WV_0_PC_1_EH_0_PS_40_6, loss: 0.041098810732364655, avg_mse: 0.04279542341828346
current test mse: 0.042795
Iteration: 541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44932761788368225, gen p mean: -0.33873289823532104, mean p set: 0.44980788230895996
loss_pred:0.04092460498213768, decouple_loss:0.03469083085656166
The modified gen p mean: 0.4505142271518707, gen p mean: -0.3508625328540802, mean p set: 0.4509945213794708
loss_pred:0.03826421499252319, decouple_loss:0.03592756763100624
The modified gen p mean: 0.45042118430137634, gen p mean: -0.34734079241752625, mean p set: 0.45090147852897644
loss_pred:0.03987163305282593, decouple_loss:0.033803511410951614
Iteration: 542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44982007145881653, gen p mean: -0.34961870312690735, mean p set: 0.4503003656864166
The modified gen p mean: 0.450862318277359, gen p mean: -0.34611478447914124, mean p set: 0.4513426423072815
The modified gen p mean: 0.4505400061607361, gen p mean: -0.3548996150493622, mean p set: 0.45102033019065857
loss_pred:0.04037729278206825, decouple_loss:0.03493325412273407
loss_pred:0.04056930914521217, decouple_loss:0.03492036089301109
loss_pred:0.04021589085459709, decouple_loss:0.034840114414691925
Iteration: 543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44912439584732056, gen p mean: -0.3439997732639313, mean p set: 0.44960469007492065
The modified gen p mean: 0.45124098658561707, gen p mean: -0.35261449217796326, mean p set: 0.4517212510108948
The modified gen p mean: 0.4506491422653198, gen p mean: -0.34566670656204224, mean p set: 0.4511294364929199
loss_pred:0.03961138054728508, decouple_loss:0.03430197387933731
loss_pred:0.040166161954402924, decouple_loss:0.03431588038802147
loss_pred:0.04061930999159813, decouple_loss:0.0344226099550724
Iteration: 544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45182010531425476, gen p mean: -0.3507310450077057, mean p set: 0.45230039954185486
The modified gen p mean: 0.4497908055782318, gen p mean: -0.3515104353427887, mean p set: 0.4502711296081543
The modified gen p mean: 0.450418084859848, gen p mean: -0.3566431403160095, mean p set: 0.4508983790874481
loss_pred:0.04014554247260094, decouple_loss:0.03357264772057533
loss_pred:0.03828488290309906, decouple_loss:0.03537460044026375
loss_pred:0.03823249787092209, decouple_loss:0.03458958491683006
Iteration: 545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508325159549713, gen p mean: -0.3542695939540863, mean p set: 0.4513128101825714
The modified gen p mean: 0.4498754143714905, gen p mean: -0.35162538290023804, mean p set: 0.4503557085990906
The modified gen p mean: 0.45007753372192383, gen p mean: -0.3556569218635559, mean p set: 0.4505578577518463
loss_pred:0.03912936523556709, decouple_loss:0.03540787845849991
loss_pred:0.039166051894426346, decouple_loss:0.035816095769405365
loss_pred:0.039343297481536865, decouple_loss:0.0343046598136425
Iteration: 546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491346776485443, gen p mean: -0.34332314133644104, mean p set: 0.4496149718761444
The modified gen p mean: 0.44989699125289917, gen p mean: -0.34598052501678467, mean p set: 0.45037728548049927
The modified gen p mean: 0.45081645250320435, gen p mean: -0.35648319125175476, mean p set: 0.45129671692848206
loss_pred:0.039183683693408966, decouple_loss:0.0344574898481369
loss_pred:0.039987653493881226, decouple_loss:0.03371551260352135
loss_pred:0.03894392028450966, decouple_loss:0.03507693111896515
Iteration: 547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45057016611099243, gen p mean: -0.34850507974624634, mean p set: 0.45105046033859253
The modified gen p mean: 0.4493100941181183, gen p mean: -0.34293392300605774, mean p set: 0.4497903883457184
The modified gen p mean: 0.44938963651657104, gen p mean: -0.3417631685733795, mean p set: 0.44986993074417114
loss_pred:0.03920982405543327, decouple_loss:0.03519473969936371
loss_pred:0.040002334862947464, decouple_loss:0.03400833159685135
loss_pred:0.03996919095516205, decouple_loss:0.035230349749326706
Iteration: 548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44957202672958374, gen p mean: -0.34773507714271545, mean p set: 0.45005232095718384
The modified gen p mean: 0.45072463154792786, gen p mean: -0.34889519214630127, mean p set: 0.45120492577552795
The modified gen p mean: 0.4488238990306854, gen p mean: -0.34561029076576233, mean p set: 0.44930416345596313
loss_pred:0.03987305611371994, decouple_loss:0.03420712798833847
loss_pred:0.03947500139474869, decouple_loss:0.034090567380189896
loss_pred:0.038689929991960526, decouple_loss:0.033333878964185715
Iteration: 549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500060975551605, gen p mean: -0.3439130485057831, mean p set: 0.4504863917827606
The modified gen p mean: 0.45097872614860535, gen p mean: -0.34368351101875305, mean p set: 0.45145899057388306
The modified gen p mean: 0.4506174921989441, gen p mean: -0.3523155152797699, mean p set: 0.4510977864265442
loss_pred:0.03967634215950966, decouple_loss:0.033793456852436066
loss_pred:0.0390036515891552, decouple_loss:0.03423203527927399
loss_pred:0.03863431513309479, decouple_loss:0.03450073301792145
Iteration: 550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503765106201172, gen p mean: -0.34114816784858704, mean p set: 0.4508568048477173
The modified gen p mean: 0.44991549849510193, gen p mean: -0.34219542145729065, mean p set: 0.450395792722702
The modified gen p mean: 0.4482329487800598, gen p mean: -0.33589476346969604, mean p set: 0.4487132728099823
loss_pred:0.038955044001340866, decouple_loss:0.03483932837843895
loss_pred:0.03914390876889229, decouple_loss:0.03459637612104416
loss_pred:0.03926880285143852, decouple_loss:0.033461276441812515
2023-05-02 17:48:57 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.3630460798740387, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.3559417128562927, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.35128054022789, mean p set: 0.45035696029663086
loss_pred:0.040709417313337326, decouple_loss:0.038510214537382126
loss_pred:0.039437878876924515, decouple_loss:0.0361669696867466
loss_pred:0.03854569420218468, decouple_loss:0.03638302534818649
WV_0_PC_1_EH_0_PS_40_6, loss: 0.04141533374786377, avg_mse: 0.0431457944214344
current test mse: 0.043146
Iteration: 551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488142728805542, gen p mean: -0.3495471477508545, mean p set: 0.4492945969104767
loss_pred:0.03879792243242264, decouple_loss:0.03278089314699173
The modified gen p mean: 0.45033180713653564, gen p mean: -0.3488388657569885, mean p set: 0.45081210136413574
loss_pred:0.03837573900818825, decouple_loss:0.03367431461811066
The modified gen p mean: 0.4507622718811035, gen p mean: -0.3498073220252991, mean p set: 0.4512425363063812
loss_pred:0.03818379342556, decouple_loss:0.03505045175552368
Iteration: 552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500710070133209, gen p mean: -0.3510897159576416, mean p set: 0.4505513310432434
The modified gen p mean: 0.4499472379684448, gen p mean: -0.3552493453025818, mean p set: 0.45042750239372253
The modified gen p mean: 0.4505615532398224, gen p mean: -0.35275620222091675, mean p set: 0.4510418474674225
loss_pred:0.03754748776555061, decouple_loss:0.03306577354669571
loss_pred:0.038576170802116394, decouple_loss:0.03375078737735748
loss_pred:0.03823089599609375, decouple_loss:0.03289921209216118
Iteration: 553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45032623410224915, gen p mean: -0.35120952129364014, mean p set: 0.45080649852752686
The modified gen p mean: 0.44986680150032043, gen p mean: -0.34511101245880127, mean p set: 0.45034709572792053
The modified gen p mean: 0.4498096704483032, gen p mean: -0.3458552062511444, mean p set: 0.45028993487358093
loss_pred:0.039209119975566864, decouple_loss:0.03275670111179352
loss_pred:0.03979645296931267, decouple_loss:0.03483159467577934
loss_pred:0.03851822391152382, decouple_loss:0.03302659094333649
Iteration: 554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45001959800720215, gen p mean: -0.34312787652015686, mean p set: 0.45049992203712463
The modified gen p mean: 0.4491664469242096, gen p mean: -0.33839505910873413, mean p set: 0.4496467411518097
The modified gen p mean: 0.45088908076286316, gen p mean: -0.3459813892841339, mean p set: 0.45136934518814087
loss_pred:0.038481567054986954, decouple_loss:0.03332684561610222
loss_pred:0.039639610797166824, decouple_loss:0.032275568693876266
loss_pred:0.03963613510131836, decouple_loss:0.03226099908351898
Iteration: 555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013561844825745, gen p mean: -0.34573879837989807, mean p set: 0.45061591267585754
The modified gen p mean: 0.4490688443183899, gen p mean: -0.343489408493042, mean p set: 0.4495491087436676
The modified gen p mean: 0.4490700662136078, gen p mean: -0.3468720018863678, mean p set: 0.4495503306388855
loss_pred:0.03793364763259888, decouple_loss:0.03283458203077316
loss_pred:0.038438279181718826, decouple_loss:0.031542714685201645
loss_pred:0.03905833512544632, decouple_loss:0.03344142064452171
Iteration: 556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45065775513648987, gen p mean: -0.36326682567596436, mean p set: 0.45113804936408997
The modified gen p mean: 0.45020169019699097, gen p mean: -0.35813191533088684, mean p set: 0.4506819546222687
The modified gen p mean: 0.44932088255882263, gen p mean: -0.35844454169273376, mean p set: 0.44980117678642273
loss_pred:0.03879266604781151, decouple_loss:0.033076826483011246
loss_pred:0.03745003789663315, decouple_loss:0.03247365728020668
loss_pred:0.039923276752233505, decouple_loss:0.032686877995729446
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
NaN value num: 0
Iteration: 557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45032647252082825, gen p mean: -0.3773825466632843, mean p set: 0.45080679655075073
The modified gen p mean: 0.4510071277618408, gen p mean: -0.3694453835487366, mean p set: 0.45148739218711853
The modified gen p mean: 0.4475097954273224, gen p mean: -0.3705456852912903, mean p set: 0.4479900598526001
loss_pred:0.03994246944785118, decouple_loss:0.03582415729761124
loss_pred:0.04007376357913017, decouple_loss:0.03437009081244469
loss_pred:0.0392482727766037, decouple_loss:0.03553428500890732
Iteration: 558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480181336402893, gen p mean: -0.36015528440475464, mean p set: 0.4484984576702118
The modified gen p mean: 0.44963374733924866, gen p mean: -0.36542749404907227, mean p set: 0.45011407136917114
The modified gen p mean: 0.44751742482185364, gen p mean: -0.36640486121177673, mean p set: 0.44799768924713135
loss_pred:0.0390482097864151, decouple_loss:0.03413743898272514
loss_pred:0.04051956906914711, decouple_loss:0.0352470837533474
loss_pred:0.03853785991668701, decouple_loss:0.03405509516596794
Iteration: 559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779157638549805, gen p mean: -0.360825777053833, mean p set: 0.44827190041542053
The modified gen p mean: 0.44820454716682434, gen p mean: -0.3599068224430084, mean p set: 0.44868484139442444
The modified gen p mean: 0.4500649571418762, gen p mean: -0.35919731855392456, mean p set: 0.45054522156715393
loss_pred:0.038044143468141556, decouple_loss:0.03302716463804245
loss_pred:0.03802147135138512, decouple_loss:0.03392462804913521
loss_pred:0.039717745035886765, decouple_loss:0.03417240083217621
Iteration: 560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493815004825592, gen p mean: -0.36367103457450867, mean p set: 0.4498618245124817
The modified gen p mean: 0.447966068983078, gen p mean: -0.35807177424430847, mean p set: 0.4484463632106781
The modified gen p mean: 0.4480643570423126, gen p mean: -0.356343150138855, mean p set: 0.4485446512699127
loss_pred:0.038288332521915436, decouple_loss:0.03542986512184143
loss_pred:0.037927743047475815, decouple_loss:0.03295450285077095
loss_pred:0.03848332539200783, decouple_loss:0.033700063824653625
2023-05-02 17:53:19 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.376005083322525, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.368161141872406, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.3631158173084259, mean p set: 0.45035696029663086
loss_pred:0.04009856656193733, decouple_loss:0.03773617744445801
loss_pred:0.038958288729190826, decouple_loss:0.0353253111243248
loss_pred:0.037922315299510956, decouple_loss:0.03600211814045906
WV_0_PC_1_EH_0_PS_40_6, loss: 0.040810782462358475, avg_mse: 0.04250811040401459
current test mse: 0.042508
Iteration: 561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44882693886756897, gen p mean: -0.3660871088504791, mean p set: 0.44930723309516907
The modified gen p mean: 0.4502882659435272, gen p mean: -0.37750351428985596, mean p set: 0.4507685601711273
loss_pred:0.03872321918606758, decouple_loss:0.03372911363840103
loss_pred:0.0373200960457325, decouple_loss:0.03625485301017761
The modified gen p mean: 0.4502338469028473, gen p mean: -0.3596496880054474, mean p set: 0.450714111328125
loss_pred:0.03668517619371414, decouple_loss:0.034057121723890305
Iteration: 562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500120282173157, gen p mean: -0.37653523683547974, mean p set: 0.45049232244491577
The modified gen p mean: 0.4474199712276459, gen p mean: -0.3571591377258301, mean p set: 0.44790026545524597
The modified gen p mean: 0.45021921396255493, gen p mean: -0.3620133399963379, mean p set: 0.45069950819015503
loss_pred:0.036896612495183945, decouple_loss:0.035851769149303436
loss_pred:0.03833990916609764, decouple_loss:0.03395523503422737
loss_pred:0.03730974718928337, decouple_loss:0.034663427621126175
Iteration: 563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499267637729645, gen p mean: -0.35768723487854004, mean p set: 0.4504070580005646
The modified gen p mean: 0.44733551144599915, gen p mean: -0.3533256947994232, mean p set: 0.44781580567359924
The modified gen p mean: 0.4505366384983063, gen p mean: -0.3561067283153534, mean p set: 0.45101693272590637
loss_pred:0.0392165370285511, decouple_loss:0.03515356034040451
loss_pred:0.03911520168185234, decouple_loss:0.03430419787764549
loss_pred:0.03716544061899185, decouple_loss:0.03399534523487091
Iteration: 564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495708644390106, gen p mean: -0.35650908946990967, mean p set: 0.4500511884689331
The modified gen p mean: 0.4475920796394348, gen p mean: -0.35752806067466736, mean p set: 0.4480723738670349
The modified gen p mean: 0.45018166303634644, gen p mean: -0.3662797808647156, mean p set: 0.4506619870662689
loss_pred:0.03811836615204811, decouple_loss:0.03465476632118225
loss_pred:0.03812631592154503, decouple_loss:0.032372526824474335
loss_pred:0.03768555447459221, decouple_loss:0.03579587861895561
Iteration: 565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768667221069336, gen p mean: -0.356106698513031, mean p set: 0.44816699624061584
The modified gen p mean: 0.44732335209846497, gen p mean: -0.35657447576522827, mean p set: 0.44780364632606506
The modified gen p mean: 0.45052456855773926, gen p mean: -0.3643903136253357, mean p set: 0.45100489258766174
loss_pred:0.03808729350566864, decouple_loss:0.03251294791698456
loss_pred:0.04000593349337578, decouple_loss:0.03430406376719475
loss_pred:0.03823793679475784, decouple_loss:0.034304115921258926
Iteration: 566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505389928817749, gen p mean: -0.36380818486213684, mean p set: 0.451019287109375
The modified gen p mean: 0.44823697209358215, gen p mean: -0.35920366644859314, mean p set: 0.44871723651885986
The modified gen p mean: 0.44922035932540894, gen p mean: -0.36367061734199524, mean p set: 0.4497006833553314
loss_pred:0.03682756423950195, decouple_loss:0.0331968255341053
loss_pred:0.03850006312131882, decouple_loss:0.033961448818445206
loss_pred:0.03933478519320488, decouple_loss:0.032924480736255646
Iteration: 567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45034468173980713, gen p mean: -0.3622359037399292, mean p set: 0.4508250057697296
The modified gen p mean: 0.449078768491745, gen p mean: -0.36133265495300293, mean p set: 0.4495590925216675
The modified gen p mean: 0.44767817854881287, gen p mean: -0.3588235676288605, mean p set: 0.44815847277641296
loss_pred:0.039431266486644745, decouple_loss:0.03424534946680069
loss_pred:0.03801243379712105, decouple_loss:0.03472521901130676
loss_pred:0.038011908531188965, decouple_loss:0.033873435109853745
Iteration: 568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960716366767883, gen p mean: -0.37394097447395325, mean p set: 0.45008742809295654
The modified gen p mean: 0.44973331689834595, gen p mean: -0.378092497587204, mean p set: 0.45021358132362366
The modified gen p mean: 0.447935551404953, gen p mean: -0.3713301420211792, mean p set: 0.4484158456325531
loss_pred:0.03890785574913025, decouple_loss:0.0335066094994545
loss_pred:0.036647871136665344, decouple_loss:0.03395417705178261
loss_pred:0.038151007145643234, decouple_loss:0.03276935964822769
Iteration: 569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45038384199142456, gen p mean: -0.3754246234893799, mean p set: 0.45086413621902466
The modified gen p mean: 0.4478349983692169, gen p mean: -0.36743637919425964, mean p set: 0.44831526279449463
The modified gen p mean: 0.4479019045829773, gen p mean: -0.37008213996887207, mean p set: 0.448382169008255
loss_pred:0.03743746131658554, decouple_loss:0.0334068164229393
loss_pred:0.03945373743772507, decouple_loss:0.03243624046444893
loss_pred:0.03874897584319115, decouple_loss:0.03303079307079315
Iteration: 570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44863617420196533, gen p mean: -0.37107908725738525, mean p set: 0.44911646842956543
The modified gen p mean: 0.44880279898643494, gen p mean: -0.37150949239730835, mean p set: 0.4492831230163574
The modified gen p mean: 0.4491611123085022, gen p mean: -0.37150320410728455, mean p set: 0.4496413767337799
loss_pred:0.038048963993787766, decouple_loss:0.03410273790359497
loss_pred:0.038257159292697906, decouple_loss:0.034132760018110275
loss_pred:0.03891770914196968, decouple_loss:0.03378142789006233
2023-05-02 17:57:04 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.37415698170661926, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.3805496096611023, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.36855199933052063, mean p set: 0.45035696029663086
loss_pred:0.03892345726490021, decouple_loss:0.03523813560605049
loss_pred:0.0400678813457489, decouple_loss:0.03777926042675972
loss_pred:0.037919528782367706, decouple_loss:0.036083295941352844
WV_0_PC_1_EH_0_PS_40_6, loss: 0.04078863561153412, avg_mse: 0.042600907385349274
current test mse: 0.042601
Iteration: 571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501236379146576, gen p mean: -0.37554922699928284, mean p set: 0.4506039321422577
The modified gen p mean: 0.4480859339237213, gen p mean: -0.3664312958717346, mean p set: 0.4485662281513214
loss_pred:0.038169730454683304, decouple_loss:0.0355241559445858
loss_pred:0.03855878859758377, decouple_loss:0.03310486674308777
The modified gen p mean: 0.4492908716201782, gen p mean: -0.3653063476085663, mean p set: 0.4497711658477783
loss_pred:0.039562974125146866, decouple_loss:0.03324674442410469
Iteration: 572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836822152137756, gen p mean: -0.36471593379974365, mean p set: 0.44884851574897766
The modified gen p mean: 0.45021116733551025, gen p mean: -0.36710891127586365, mean p set: 0.45069149136543274
The modified gen p mean: 0.4497472047805786, gen p mean: -0.3771269917488098, mean p set: 0.4502274990081787
loss_pred:0.0383407287299633, decouple_loss:0.03272304683923721
loss_pred:0.03944183886051178, decouple_loss:0.032482028007507324
loss_pred:0.03584715723991394, decouple_loss:0.03301399201154709
Iteration: 573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482101798057556, gen p mean: -0.37350767850875854, mean p set: 0.4486904740333557
The modified gen p mean: 0.4476509690284729, gen p mean: -0.37061864137649536, mean p set: 0.4481312930583954
The modified gen p mean: 0.4496905505657196, gen p mean: -0.37606802582740784, mean p set: 0.4501708745956421
loss_pred:0.03732948750257492, decouple_loss:0.03302702680230141
loss_pred:0.03879999741911888, decouple_loss:0.03229206055402756
loss_pred:0.0376967117190361, decouple_loss:0.03169934079051018
Iteration: 574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969460368156433, gen p mean: -0.3865842819213867, mean p set: 0.45017489790916443
The modified gen p mean: 0.4497394263744354, gen p mean: -0.38023841381073, mean p set: 0.4502197206020355
The modified gen p mean: 0.4502366781234741, gen p mean: -0.38502955436706543, mean p set: 0.4507170021533966
loss_pred:0.03799745813012123, decouple_loss:0.032581403851509094
loss_pred:0.0389736145734787, decouple_loss:0.032499514520168304
loss_pred:0.038441769778728485, decouple_loss:0.03327307477593422
Iteration: 575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018360018730164, gen p mean: -0.38323256373405457, mean p set: 0.45066389441490173
The modified gen p mean: 0.4512284994125366, gen p mean: -0.38108694553375244, mean p set: 0.4517087936401367
The modified gen p mean: 0.4509034752845764, gen p mean: -0.3866143226623535, mean p set: 0.4513837993144989
loss_pred:0.03814628720283508, decouple_loss:0.032064348459243774
loss_pred:0.0392279252409935, decouple_loss:0.03379121050238609
loss_pred:0.037627629935741425, decouple_loss:0.03183116018772125
Iteration: 576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751399755477905, gen p mean: -0.3738524615764618, mean p set: 0.44799432158470154
The modified gen p mean: 0.45033854246139526, gen p mean: -0.37959980964660645, mean p set: 0.450818806886673
The modified gen p mean: 0.44756880402565, gen p mean: -0.37249699234962463, mean p set: 0.4480490982532501
loss_pred:0.03722986578941345, decouple_loss:0.03224484995007515
loss_pred:0.03856803849339485, decouple_loss:0.0320475809276104
loss_pred:0.03745967894792557, decouple_loss:0.03294745087623596
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476727247238159, gen p mean: -0.38424742221832275, mean p set: 0.4481530487537384
The modified gen p mean: 0.4493889808654785, gen p mean: -0.38085871934890747, mean p set: 0.449869304895401
The modified gen p mean: 0.4469814896583557, gen p mean: -0.38578179478645325, mean p set: 0.4474617540836334
loss_pred:0.04018932580947876, decouple_loss:0.036920566111803055
loss_pred:0.038300562649965286, decouple_loss:0.037881672382354736
loss_pred:0.03810396045446396, decouple_loss:0.03886417672038078
Iteration: 578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44982996582984924, gen p mean: -0.37877950072288513, mean p set: 0.45031026005744934
The modified gen p mean: 0.44749554991722107, gen p mean: -0.37612438201904297, mean p set: 0.4479758143424988
The modified gen p mean: 0.44623613357543945, gen p mean: -0.37443313002586365, mean p set: 0.44671642780303955
loss_pred:0.03930171951651573, decouple_loss:0.038834504783153534
loss_pred:0.03863191232085228, decouple_loss:0.03527084365487099
loss_pred:0.039414484053850174, decouple_loss:0.03593342751264572
Iteration: 579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44713956117630005, gen p mean: -0.36117592453956604, mean p set: 0.44761988520622253
The modified gen p mean: 0.4483940899372101, gen p mean: -0.36438778042793274, mean p set: 0.44887441396713257
The modified gen p mean: 0.4478420615196228, gen p mean: -0.36401042342185974, mean p set: 0.4483223557472229
loss_pred:0.038574617356061935, decouple_loss:0.034855086356401443
loss_pred:0.03949892893433571, decouple_loss:0.03585094213485718
loss_pred:0.03760425001382828, decouple_loss:0.03613256290555
Iteration: 580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448018342256546, gen p mean: -0.3715478777885437, mean p set: 0.4484986364841461
The modified gen p mean: 0.44773584604263306, gen p mean: -0.3745957016944885, mean p set: 0.44821611046791077
The modified gen p mean: 0.4472886025905609, gen p mean: -0.36572030186653137, mean p set: 0.4477689266204834
loss_pred:0.038137711584568024, decouple_loss:0.03629586473107338
loss_pred:0.03823859617114067, decouple_loss:0.03706987574696541
loss_pred:0.03850500285625458, decouple_loss:0.03460138663649559
2023-05-02 18:01:30 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.39294344186782837, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.3862612247467041, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.3800092041492462, mean p set: 0.45035696029663086
loss_pred:0.03933466225862503, decouple_loss:0.03570560738444328
loss_pred:0.03839809447526932, decouple_loss:0.033709630370140076
loss_pred:0.03727366030216217, decouple_loss:0.03539173677563667
WV_0_PC_1_EH_0_PS_40_6, loss: 0.040082257241010666, avg_mse: 0.04168449714779854
current test mse: 0.041684
Iteration: 581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44608765840530396, gen p mean: -0.393014132976532, mean p set: 0.44656795263290405
The modified gen p mean: 0.44778165221214294, gen p mean: -0.38696524500846863, mean p set: 0.44826194643974304
loss_pred:0.03866413235664368, decouple_loss:0.035352110862731934
loss_pred:0.03920460864901543, decouple_loss:0.03509773686528206
The modified gen p mean: 0.44852012395858765, gen p mean: -0.38966915011405945, mean p set: 0.44900041818618774
loss_pred:0.03721649572253227, decouple_loss:0.034761447459459305
Iteration: 582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493076503276825, gen p mean: -0.39430350065231323, mean p set: 0.449787974357605
The modified gen p mean: 0.4468347430229187, gen p mean: -0.39763209223747253, mean p set: 0.4473150670528412
The modified gen p mean: 0.44784674048423767, gen p mean: -0.3944316506385803, mean p set: 0.44832706451416016
loss_pred:0.03824383392930031, decouple_loss:0.03584746643900871
loss_pred:0.03862471878528595, decouple_loss:0.03598355874419212
loss_pred:0.036804504692554474, decouple_loss:0.034168489277362823
Iteration: 583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661805033683777, gen p mean: -0.3892766833305359, mean p set: 0.44709834456443787
The modified gen p mean: 0.44679686427116394, gen p mean: -0.38942843675613403, mean p set: 0.44727712869644165
The modified gen p mean: 0.4473932087421417, gen p mean: -0.3870367407798767, mean p set: 0.4478735327720642
loss_pred:0.03818533197045326, decouple_loss:0.03376450017094612
loss_pred:0.0381404384970665, decouple_loss:0.03427504003047943
loss_pred:0.03800949826836586, decouple_loss:0.03360048681497574
Iteration: 584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44558775424957275, gen p mean: -0.3764292299747467, mean p set: 0.44606801867485046
The modified gen p mean: 0.4487951695919037, gen p mean: -0.3705800473690033, mean p set: 0.4492754638195038
The modified gen p mean: 0.4478175938129425, gen p mean: -0.38286685943603516, mean p set: 0.4482978880405426
loss_pred:0.03858795389533043, decouple_loss:0.03385212644934654
loss_pred:0.03874105215072632, decouple_loss:0.0337141789495945
loss_pred:0.03828532248735428, decouple_loss:0.034677255898714066
Iteration: 585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468082785606384, gen p mean: -0.37554240226745605, mean p set: 0.4472885727882385
The modified gen p mean: 0.4476069211959839, gen p mean: -0.37482020258903503, mean p set: 0.448087215423584
The modified gen p mean: 0.4476143717765808, gen p mean: -0.37318938970565796, mean p set: 0.4480946362018585
loss_pred:0.03845478221774101, decouple_loss:0.03475668653845787loss_pred:0.03809149190783501, decouple_loss:0.034166883677244186
loss_pred:0.03760391101241112, decouple_loss:0.034100811928510666
Iteration: 586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487041234970093, gen p mean: -0.3644081652164459, mean p set: 0.449184387922287
The modified gen p mean: 0.4494333267211914, gen p mean: -0.3593345582485199, mean p set: 0.4499136209487915
The modified gen p mean: 0.446424663066864, gen p mean: -0.36269983649253845, mean p set: 0.4469049572944641
loss_pred:0.037751611322164536, decouple_loss:0.03467009589076042
loss_pred:0.038363631814718246, decouple_loss:0.03393926844000816
loss_pred:0.03807687759399414, decouple_loss:0.03398538753390312
Iteration: 587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736161828041077, gen p mean: -0.3696596026420593, mean p set: 0.44784191250801086
The modified gen p mean: 0.4474327862262726, gen p mean: -0.36104026436805725, mean p set: 0.4479130506515503
The modified gen p mean: 0.4461551308631897, gen p mean: -0.3693692982196808, mean p set: 0.4466353952884674
loss_pred:0.038299206644296646, decouple_loss:0.03243759274482727
loss_pred:0.03854360803961754, decouple_loss:0.03166523948311806
loss_pred:0.038471005856990814, decouple_loss:0.03403787314891815
Iteration: 588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471665322780609, gen p mean: -0.3707076907157898, mean p set: 0.447646826505661
The modified gen p mean: 0.4473239481449127, gen p mean: -0.36316660046577454, mean p set: 0.44780421257019043
The modified gen p mean: 0.44719722867012024, gen p mean: -0.36587706208229065, mean p set: 0.44767752289772034
loss_pred:0.037796951830387115, decouple_loss:0.033780183643102646
loss_pred:0.037656236439943314, decouple_loss:0.03339175134897232
loss_pred:0.037240706384181976, decouple_loss:0.03231260925531387
Iteration: 589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44909849762916565, gen p mean: -0.37346914410591125, mean p set: 0.44957879185676575
The modified gen p mean: 0.44854751229286194, gen p mean: -0.3656984269618988, mean p set: 0.44902777671813965
The modified gen p mean: 0.44692885875701904, gen p mean: -0.37672415375709534, mean p set: 0.44740915298461914
loss_pred:0.036842480301856995, decouple_loss:0.03407222777605057
loss_pred:0.03886660933494568, decouple_loss:0.033992230892181396
loss_pred:0.03777275234460831, decouple_loss:0.03281542658805847
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480317533016205, gen p mean: -0.36643338203430176, mean p set: 0.4485120475292206
The modified gen p mean: 0.44861432909965515, gen p mean: -0.3659262955188751, mean p set: 0.44909462332725525
The modified gen p mean: 0.4483109414577484, gen p mean: -0.36740365624427795, mean p set: 0.4487912356853485
loss_pred:0.03920145332813263, decouple_loss:0.033005084842443466
loss_pred:0.037732549011707306, decouple_loss:0.034240540117025375
loss_pred:0.039304058998823166, decouple_loss:0.03304225578904152
2023-05-02 18:05:11 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.36793452501296997, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.3755750358104706, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.36331120133399963, mean p set: 0.45035696029663086
loss_pred:0.038053128868341446, decouple_loss:0.032801367342472076
loss_pred:0.038984958082437515, decouple_loss:0.03383483365178108
loss_pred:0.037145134061574936, decouple_loss:0.03431951627135277
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03974366933107376, avg_mse: 0.04144780710339546
current test mse: 0.041448
Iteration: 591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44803327322006226, gen p mean: -0.3685082197189331, mean p set: 0.44851356744766235
The modified gen p mean: 0.4471273422241211, gen p mean: -0.3751782178878784, mean p set: 0.4476076066493988
loss_pred:0.03870251402258873, decouple_loss:0.03243497014045715
loss_pred:0.03697234019637108, decouple_loss:0.033148691058158875
The modified gen p mean: 0.44821038842201233, gen p mean: -0.3752032220363617, mean p set: 0.44869065284729004
loss_pred:0.03678198903799057, decouple_loss:0.03215672820806503
Iteration: 592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470822811126709, gen p mean: -0.3736191987991333, mean p set: 0.447562575340271
The modified gen p mean: 0.4474140405654907, gen p mean: -0.36778396368026733, mean p set: 0.44789430499076843
The modified gen p mean: 0.44697925448417664, gen p mean: -0.3740832507610321, mean p set: 0.44745954871177673
loss_pred:0.037652138620615005, decouple_loss:0.030638471245765686
loss_pred:0.036679089069366455, decouple_loss:0.0311769787222147
loss_pred:0.037006717175245285, decouple_loss:0.030605213716626167
Iteration: 593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483204483985901, gen p mean: -0.3665531575679779, mean p set: 0.4488007128238678The modified gen p mean: 0.44727861881256104, gen p mean: -0.37869447469711304, mean p set: 0.44775891304016113
The modified gen p mean: 0.4454862177371979, gen p mean: -0.370484858751297, mean p set: 0.445966511964798
loss_pred:0.0384661890566349, decouple_loss:0.031604886054992676
loss_pred:0.03787168115377426, decouple_loss:0.0337560810148716
loss_pred:0.03832921013236046, decouple_loss:0.03265504539012909
Iteration: 594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483659267425537, gen p mean: -0.3750605285167694, mean p set: 0.4488462209701538
The modified gen p mean: 0.4461553692817688, gen p mean: -0.37630724906921387, mean p set: 0.4466356933116913
The modified gen p mean: 0.4475298225879669, gen p mean: -0.3762754499912262, mean p set: 0.44801008701324463
loss_pred:0.036800529807806015, decouple_loss:0.03142203390598297loss_pred:0.037453681230545044, decouple_loss:0.031119825318455696
loss_pred:0.036665864288806915, decouple_loss:0.03143123537302017
Iteration: 595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753408432006836, gen p mean: -0.3686830401420593, mean p set: 0.44801437854766846
The modified gen p mean: 0.44727686047554016, gen p mean: -0.38238027691841125, mean p set: 0.44775715470314026
The modified gen p mean: 0.4461471736431122, gen p mean: -0.37761497497558594, mean p set: 0.4466274678707123
loss_pred:0.03655019402503967, decouple_loss:0.03233765438199043
loss_pred:0.0375402607023716, decouple_loss:0.03310409560799599
loss_pred:0.0375702939927578, decouple_loss:0.03202806040644646
Iteration: 596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447794646024704, gen p mean: -0.37915390729904175, mean p set: 0.44827497005462646
The modified gen p mean: 0.44760459661483765, gen p mean: -0.3881511688232422, mean p set: 0.44808489084243774
The modified gen p mean: 0.44688740372657776, gen p mean: -0.3767865300178528, mean p set: 0.44736772775650024
loss_pred:0.03712228313088417, decouple_loss:0.032589882612228394
loss_pred:0.036495793610811234, decouple_loss:0.03171985223889351
loss_pred:0.03768663480877876, decouple_loss:0.03254913166165352
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727280735969543, gen p mean: -0.38713595271110535, mean p set: 0.44775307178497314
The modified gen p mean: 0.4466817378997803, gen p mean: -0.3915084898471832, mean p set: 0.44716206192970276
The modified gen p mean: 0.44587817788124084, gen p mean: -0.3859286606311798, mean p set: 0.44635844230651855
loss_pred:0.037923019379377365, decouple_loss:0.03199481964111328
loss_pred:0.03814765065908432, decouple_loss:0.03353211656212807
loss_pred:0.03527150675654411, decouple_loss:0.031756967306137085
Iteration: 598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44550079107284546, gen p mean: -0.37747645378112793, mean p set: 0.44598105549812317
The modified gen p mean: 0.4464872479438782, gen p mean: -0.3757854998111725, mean p set: 0.44696754217147827
The modified gen p mean: 0.44786348938941956, gen p mean: -0.3767494857311249, mean p set: 0.44834378361701965
loss_pred:0.0380471907556057, decouple_loss:0.03197570517659187
loss_pred:0.036444440484046936, decouple_loss:0.03314411640167236
loss_pred:0.03654646873474121, decouple_loss:0.03289414942264557
Iteration: 599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477178752422333, gen p mean: -0.37312307953834534, mean p set: 0.4481981694698334
The modified gen p mean: 0.44644805788993835, gen p mean: -0.3644873797893524, mean p set: 0.44692835211753845
The modified gen p mean: 0.4472739100456238, gen p mean: -0.3618302643299103, mean p set: 0.4477542042732239
loss_pred:0.03924408555030823, decouple_loss:0.03408990055322647
loss_pred:0.03726787120103836, decouple_loss:0.031239191070199013
loss_pred:0.03896034508943558, decouple_loss:0.031017063185572624
Iteration: 600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475288987159729, gen p mean: -0.36380666494369507, mean p set: 0.448009192943573
The modified gen p mean: 0.4478619396686554, gen p mean: -0.37021520733833313, mean p set: 0.4483422338962555
The modified gen p mean: 0.4474528133869171, gen p mean: -0.3703208863735199, mean p set: 0.4479331374168396
loss_pred:0.03835278004407883, decouple_loss:0.031358879059553146
loss_pred:0.03790471330285072, decouple_loss:0.031595561653375626
loss_pred:0.03824882209300995, decouple_loss:0.03192976117134094
2023-05-02 18:09:43 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.37658366560935974, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.3697815537452698, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.3645320236682892, mean p set: 0.45035696029663086
loss_pred:0.038847506046295166, decouple_loss:0.033432815223932266
loss_pred:0.03779969364404678, decouple_loss:0.03225197643041611
loss_pred:0.03675934299826622, decouple_loss:0.032949600368738174
WV_0_PC_1_EH_0_PS_40_6, loss: 0.039446085691452026, avg_mse: 0.04123513400554657
current test mse: 0.041235
Iteration: 601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447200208902359, gen p mean: -0.3760683536529541, mean p set: 0.4476804733276367
The modified gen p mean: 0.445803701877594, gen p mean: -0.3692000210285187, mean p set: 0.4462839961051941
loss_pred:0.03952917829155922, decouple_loss:0.03366350010037422
loss_pred:0.0370849072933197, decouple_loss:0.033383872359991074
The modified gen p mean: 0.4474099576473236, gen p mean: -0.37457045912742615, mean p set: 0.4478902518749237
loss_pred:0.03863753750920296, decouple_loss:0.033214375376701355
Iteration: 602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481351971626282, gen p mean: -0.3747619390487671, mean p set: 0.44861549139022827
The modified gen p mean: 0.4478778541088104, gen p mean: -0.3760196566581726, mean p set: 0.4483581483364105
The modified gen p mean: 0.44713258743286133, gen p mean: -0.3816252648830414, mean p set: 0.4476129114627838
loss_pred:0.037289299070835114, decouple_loss:0.031185055151581764
loss_pred:0.03571517392992973, decouple_loss:0.030908407643437386
loss_pred:0.03820056840777397, decouple_loss:0.033488862216472626
Iteration: 603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44632357358932495, gen p mean: -0.3823234438896179, mean p set: 0.44680383801460266
The modified gen p mean: 0.44760170578956604, gen p mean: -0.38234230875968933, mean p set: 0.44808200001716614
The modified gen p mean: 0.4485968351364136, gen p mean: -0.38340407609939575, mean p set: 0.44907715916633606
loss_pred:0.03698165342211723, decouple_loss:0.03183731436729431
loss_pred:0.03507855534553528, decouple_loss:0.031307708472013474
loss_pred:0.03643447905778885, decouple_loss:0.03169399872422218
Iteration: 604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710928201675415, gen p mean: -0.3727739453315735, mean p set: 0.44758957624435425
The modified gen p mean: 0.44501030445098877, gen p mean: -0.374024361371994, mean p set: 0.44549062848091125
The modified gen p mean: 0.44681262969970703, gen p mean: -0.3695148229598999, mean p set: 0.44729292392730713
loss_pred:0.037918414920568466, decouple_loss:0.031796425580978394
loss_pred:0.037477072328329086, decouple_loss:0.03292401134967804
loss_pred:0.038351964205503464, decouple_loss:0.031206103041768074
Iteration: 605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44610586762428284, gen p mean: -0.3594953119754791, mean p set: 0.4465861916542053
The modified gen p mean: 0.44642341136932373, gen p mean: -0.3575957715511322, mean p set: 0.44690370559692383
The modified gen p mean: 0.44660380482673645, gen p mean: -0.3627595901489258, mean p set: 0.44708412885665894
loss_pred:0.03727501630783081, decouple_loss:0.032761234790086746
loss_pred:0.037516038864851, decouple_loss:0.03131239861249924
loss_pred:0.03668137639760971, decouple_loss:0.03237726166844368
Iteration: 606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44646069407463074, gen p mean: -0.35293999314308167, mean p set: 0.44694095849990845
The modified gen p mean: 0.44790756702423096, gen p mean: -0.36037448048591614, mean p set: 0.44838783144950867
The modified gen p mean: 0.4455787241458893, gen p mean: -0.3588826358318329, mean p set: 0.4460590183734894
loss_pred:0.03857612982392311, decouple_loss:0.031224027276039124
loss_pred:0.036767683923244476, decouple_loss:0.03201550245285034
loss_pred:0.036869678646326065, decouple_loss:0.031861260533332825
Iteration: 607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44673675298690796, gen p mean: -0.362949401140213, mean p set: 0.44721704721450806
The modified gen p mean: 0.4465464949607849, gen p mean: -0.37041613459587097, mean p set: 0.4470267593860626
The modified gen p mean: 0.4485483765602112, gen p mean: -0.36733996868133545, mean p set: 0.4490286707878113
loss_pred:0.03650490567088127, decouple_loss:0.03125094622373581
loss_pred:0.03820343315601349, decouple_loss:0.03240237757563591
loss_pred:0.03786280006170273, decouple_loss:0.03252806514501572
Iteration: 608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484007954597473, gen p mean: -0.37305948138237, mean p set: 0.448881059885025
The modified gen p mean: 0.4469771385192871, gen p mean: -0.3742367923259735, mean p set: 0.4474574029445648
The modified gen p mean: 0.4466102421283722, gen p mean: -0.3731967806816101, mean p set: 0.4470905363559723
loss_pred:0.03723232075572014, decouple_loss:0.03196045383810997
loss_pred:0.03746257722377777, decouple_loss:0.032362598925828934
loss_pred:0.03630442917346954, decouple_loss:0.03129361942410469
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796085357666016, gen p mean: -0.3736347258090973, mean p set: 0.44844114780426025
The modified gen p mean: 0.4490334689617157, gen p mean: -0.36930516362190247, mean p set: 0.4495137631893158
The modified gen p mean: 0.44691750407218933, gen p mean: -0.3728686571121216, mean p set: 0.44739776849746704
loss_pred:0.03741182014346123, decouple_loss:0.03116045519709587
loss_pred:0.03777172043919563, decouple_loss:0.031933873891830444
loss_pred:0.03717304766178131, decouple_loss:0.030680013820528984
Iteration: 610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44693711400032043, gen p mean: -0.3564479649066925, mean p set: 0.44741740822792053
The modified gen p mean: 0.44669926166534424, gen p mean: -0.35769253969192505, mean p set: 0.44717955589294434
The modified gen p mean: 0.4462679922580719, gen p mean: -0.360864520072937, mean p set: 0.446748286485672
loss_pred:0.038403019309043884, decouple_loss:0.029590632766485214
loss_pred:0.03642317280173302, decouple_loss:0.03060172311961651
loss_pred:0.03666787967085838, decouple_loss:0.031127823516726494
2023-05-02 18:13:29 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.35770073533058167, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.3641495406627655, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.3532794713973999, mean p set: 0.45035696029663086
loss_pred:0.037642620503902435, decouple_loss:0.031060853973031044
loss_pred:0.038497112691402435, decouple_loss:0.032970380038022995
loss_pred:0.036687545478343964, decouple_loss:0.03208838775753975
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03921108692884445, avg_mse: 0.04107312113046646
current test mse: 0.041073
Iteration: 611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477289915084839, gen p mean: -0.36088114976882935, mean p set: 0.448209285736084
loss_pred:0.036404628306627274, decouple_loss:0.03091103956103325
The modified gen p mean: 0.44722050428390503, gen p mean: -0.3641341030597687, mean p set: 0.4477007985115051
loss_pred:0.037931740283966064, decouple_loss:0.031889673322439194
The modified gen p mean: 0.44696521759033203, gen p mean: -0.3549391031265259, mean p set: 0.44744551181793213
loss_pred:0.036943867802619934, decouple_loss:0.030468203127384186
Iteration: 612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721493124961853, gen p mean: -0.3840319812297821, mean p set: 0.44769522547721863
The modified gen p mean: 0.4458503723144531, gen p mean: -0.3812354803085327, mean p set: 0.4463306665420532
The modified gen p mean: 0.4466274380683899, gen p mean: -0.38052278757095337, mean p set: 0.44710773229599
loss_pred:0.03696669638156891, decouple_loss:0.030147511512041092
loss_pred:0.03567514568567276, decouple_loss:0.03069690428674221
loss_pred:0.03716901317238808, decouple_loss:0.03002401441335678
Iteration: 613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44497737288475037, gen p mean: -0.39385420083999634, mean p set: 0.4454576373100281
The modified gen p mean: 0.44622603058815, gen p mean: -0.39429351687431335, mean p set: 0.4467063546180725
The modified gen p mean: 0.4459763467311859, gen p mean: -0.3948259949684143, mean p set: 0.446456640958786
loss_pred:0.03742903843522072, decouple_loss:0.03198166936635971
loss_pred:0.03722027316689491, decouple_loss:0.0297317523509264
loss_pred:0.0359344556927681, decouple_loss:0.03074279986321926
Iteration: 614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723257422447205, gen p mean: -0.3770444989204407, mean p set: 0.44771286845207214
The modified gen p mean: 0.44828417897224426, gen p mean: -0.3757745027542114, mean p set: 0.44876447319984436
The modified gen p mean: 0.44668105244636536, gen p mean: -0.3770601749420166, mean p set: 0.44716131687164307
loss_pred:0.03642016649246216, decouple_loss:0.03059426322579384
loss_pred:0.03548181802034378, decouple_loss:0.03138784319162369
loss_pred:0.0382995530962944, decouple_loss:0.03150516748428345
Iteration: 615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745752215385437, gen p mean: -0.37108108401298523, mean p set: 0.44793781638145447
The modified gen p mean: 0.44810187816619873, gen p mean: -0.36531588435173035, mean p set: 0.44858217239379883
loss_pred:0.038933321833610535, decouple_loss:0.03255877643823624
The modified gen p mean: 0.44754672050476074, gen p mean: -0.36307093501091003, mean p set: 0.44802701473236084
loss_pred:0.03514964506030083, decouple_loss:0.030283821746706963
loss_pred:0.03454571217298508, decouple_loss:0.0311854500323534
Iteration: 616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470151662826538, gen p mean: -0.3657541275024414, mean p set: 0.4474954903125763
The modified gen p mean: 0.4478340148925781, gen p mean: -0.3634512424468994, mean p set: 0.44831427931785583
The modified gen p mean: 0.4464516043663025, gen p mean: -0.36266857385635376, mean p set: 0.4469318985939026
loss_pred:0.03711290657520294, decouple_loss:0.030498294159770012
loss_pred:0.03681093826889992, decouple_loss:0.02933271788060665
loss_pred:0.03745514899492264, decouple_loss:0.03028799220919609
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
NaN value num: 0
Iteration: 617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44634732604026794, gen p mean: -0.37443846464157104, mean p set: 0.44682762026786804
The modified gen p mean: 0.4468744099140167, gen p mean: -0.36783117055892944, mean p set: 0.4473547041416168
The modified gen p mean: 0.4468745291233063, gen p mean: -0.37429308891296387, mean p set: 0.447354793548584
loss_pred:0.03870704397559166, decouple_loss:0.031156478449702263
loss_pred:0.03924334794282913, decouple_loss:0.03218036890029907
loss_pred:0.036376457661390305, decouple_loss:0.03231844678521156
Iteration: 618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680461287498474, gen p mean: -0.38133710622787476, mean p set: 0.44728490710258484
The modified gen p mean: 0.44572290778160095, gen p mean: -0.37900510430336, mean p set: 0.44620317220687866
The modified gen p mean: 0.4482361078262329, gen p mean: -0.37925174832344055, mean p set: 0.448716402053833
loss_pred:0.03634674474596977, decouple_loss:0.03162652254104614
loss_pred:0.037055615335702896, decouple_loss:0.03182709217071533
loss_pred:0.03625312075018883, decouple_loss:0.03441968932747841
Iteration: 619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797948002815247, gen p mean: -0.3756357431411743, mean p set: 0.4484597444534302
The modified gen p mean: 0.44891101121902466, gen p mean: -0.38825732469558716, mean p set: 0.44939130544662476
The modified gen p mean: 0.4475628435611725, gen p mean: -0.39028218388557434, mean p set: 0.4480431377887726
loss_pred:0.038256797939538956, decouple_loss:0.031084978953003883
loss_pred:0.03830021247267723, decouple_loss:0.03549814969301224
loss_pred:0.03834662586450577, decouple_loss:0.032883670181035995
Iteration: 620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815143942832947, gen p mean: -0.37258508801460266, mean p set: 0.44863173365592957
The modified gen p mean: 0.4462895691394806, gen p mean: -0.37606555223464966, mean p set: 0.4467698633670807
The modified gen p mean: 0.44811147451400757, gen p mean: -0.374983549118042, mean p set: 0.44859179854393005
loss_pred:0.03720123693346977, decouple_loss:0.033139418810606
loss_pred:0.03874969109892845, decouple_loss:0.03302633389830589
loss_pred:0.03661392256617546, decouple_loss:0.03363801911473274
2023-05-02 18:17:55 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.37349700927734375, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.3803607225418091, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.3692392408847809, mean p set: 0.45035696029663086
loss_pred:0.03761220723390579, decouple_loss:0.03168661147356033
loss_pred:0.038541629910469055, decouple_loss:0.03205832466483116
loss_pred:0.03671964630484581, decouple_loss:0.032931916415691376
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03923577815294266, avg_mse: 0.04121490195393562
current test mse: 0.041215
Iteration: 621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468402862548828, gen p mean: -0.37848106026649475, mean p set: 0.4473206102848053
loss_pred:0.039882272481918335, decouple_loss:0.032682932913303375
The modified gen p mean: 0.4470949172973633, gen p mean: -0.3856356143951416, mean p set: 0.4475752115249634
loss_pred:0.0367092490196228, decouple_loss:0.031663522124290466
The modified gen p mean: 0.4463687837123871, gen p mean: -0.37829872965812683, mean p set: 0.44684910774230957
loss_pred:0.03828220069408417, decouple_loss:0.03193587437272072
Iteration: 622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471132159233093, gen p mean: -0.3868923783302307, mean p set: 0.4475935399532318
The modified gen p mean: 0.4478079080581665, gen p mean: -0.3844153881072998, mean p set: 0.448288232088089
The modified gen p mean: 0.44892945885658264, gen p mean: -0.38858744502067566, mean p set: 0.44940972328186035
loss_pred:0.036850687116384506, decouple_loss:0.03207414224743843
loss_pred:0.037774015218019485, decouple_loss:0.031909726560115814
loss_pred:0.03663327172398567, decouple_loss:0.032707180827856064
Iteration: 623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486711323261261, gen p mean: -0.3813650906085968, mean p set: 0.4491514265537262
The modified gen p mean: 0.44728296995162964, gen p mean: -0.3788948059082031, mean p set: 0.4477632939815521
The modified gen p mean: 0.4471752941608429, gen p mean: -0.37768393754959106, mean p set: 0.447655588388443
loss_pred:0.0359453447163105, decouple_loss:0.03244449943304062
loss_pred:0.037943966686725616, decouple_loss:0.03278515115380287
loss_pred:0.03809881582856178, decouple_loss:0.03139663115143776
Iteration: 624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44705930352211, gen p mean: -0.36540278792381287, mean p set: 0.44753962755203247
The modified gen p mean: 0.4477410912513733, gen p mean: -0.3685443103313446, mean p set: 0.4482213854789734
The modified gen p mean: 0.44723790884017944, gen p mean: -0.36826956272125244, mean p set: 0.44771823287010193
loss_pred:0.03832555189728737, decouple_loss:0.03130895644426346
loss_pred:0.03623683750629425, decouple_loss:0.03250085934996605
loss_pred:0.03883078694343567, decouple_loss:0.0307576023042202
Iteration: 625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44645819067955017, gen p mean: -0.37181058526039124, mean p set: 0.44693848490715027
The modified gen p mean: 0.44702014327049255, gen p mean: -0.373929888010025, mean p set: 0.44750040769577026
The modified gen p mean: 0.4477769434452057, gen p mean: -0.3707506060600281, mean p set: 0.4482572078704834
loss_pred:0.037953395396471024, decouple_loss:0.03042159415781498
loss_pred:0.0381215400993824, decouple_loss:0.030958695337176323
loss_pred:0.039161764085292816, decouple_loss:0.03234483674168587
Iteration: 626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447847843170166, gen p mean: -0.3907633423805237, mean p set: 0.4483281373977661
The modified gen p mean: 0.44612568616867065, gen p mean: -0.38643479347229004, mean p set: 0.44660601019859314
The modified gen p mean: 0.4468744695186615, gen p mean: -0.38747531175613403, mean p set: 0.4473547637462616
loss_pred:0.03794247657060623, decouple_loss:0.03307477757334709
loss_pred:0.03616822510957718, decouple_loss:0.03241478651762009
loss_pred:0.035973671823740005, decouple_loss:0.03268386423587799
Iteration: 627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468475878238678, gen p mean: -0.38526400923728943, mean p set: 0.4473278820514679
The modified gen p mean: 0.44762206077575684, gen p mean: -0.3862702250480652, mean p set: 0.4481023848056793
The modified gen p mean: 0.44669944047927856, gen p mean: -0.3872267007827759, mean p set: 0.44717973470687866
loss_pred:0.03831041231751442, decouple_loss:0.03236820548772812
loss_pred:0.03819867968559265, decouple_loss:0.030539382249116898
loss_pred:0.038569021970033646, decouple_loss:0.030602481216192245
Iteration: 628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484494626522064, gen p mean: -0.38514578342437744, mean p set: 0.4489297568798065
The modified gen p mean: 0.4473426640033722, gen p mean: -0.3867357075214386, mean p set: 0.4478229880332947
The modified gen p mean: 0.4465724527835846, gen p mean: -0.3814842402935028, mean p set: 0.4470527172088623
loss_pred:0.0368470773100853, decouple_loss:0.03154869005084038
loss_pred:0.03644721210002899, decouple_loss:0.030649792402982712
loss_pred:0.039730723947286606, decouple_loss:0.031118253245949745
Iteration: 629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772493839263916, gen p mean: -0.36073601245880127, mean p set: 0.44820523262023926
The modified gen p mean: 0.4484260678291321, gen p mean: -0.3682204484939575, mean p set: 0.4489063620567322
The modified gen p mean: 0.44786643981933594, gen p mean: -0.3614559769630432, mean p set: 0.44834673404693604
loss_pred:0.039561983197927475, decouple_loss:0.0320671945810318
loss_pred:0.037790581583976746, decouple_loss:0.03207579627633095
loss_pred:0.03767288103699684, decouple_loss:0.030964553356170654
Iteration: 630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44653043150901794, gen p mean: -0.36963316798210144, mean p set: 0.44701069593429565
The modified gen p mean: 0.447552889585495, gen p mean: -0.3664625883102417, mean p set: 0.4480331242084503
The modified gen p mean: 0.44741570949554443, gen p mean: -0.36562690138816833, mean p set: 0.44789600372314453
loss_pred:0.036059699952602386, decouple_loss:0.03163330256938934
loss_pred:0.036531101912260056, decouple_loss:0.03073890320956707
loss_pred:0.03791145235300064, decouple_loss:0.031095990911126137
2023-05-02 18:21:41 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.37740007042884827, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.3710101246833801, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.3668343722820282, mean p set: 0.45035696029663086
loss_pred:0.03817517310380936, decouple_loss:0.03233305364847183
loss_pred:0.037365905940532684, decouple_loss:0.032230645418167114
loss_pred:0.03643333539366722, decouple_loss:0.03349122032523155
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03895905613899231, avg_mse: 0.04095782712101936
current test mse: 0.040958
Iteration: 631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702789187431335, gen p mean: -0.38344985246658325, mean p set: 0.44750818610191345
The modified gen p mean: 0.4479723274707794, gen p mean: -0.3779356777667999, mean p set: 0.4484526515007019
loss_pred:0.036799319088459015, decouple_loss:0.03172647953033447
loss_pred:0.037538252770900726, decouple_loss:0.030518218874931335
The modified gen p mean: 0.44801634550094604, gen p mean: -0.3780762851238251, mean p set: 0.44849663972854614
loss_pred:0.03765449300408363, decouple_loss:0.0306207574903965
Iteration: 632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458576738834381, gen p mean: -0.38568803668022156, mean p set: 0.4463379681110382
The modified gen p mean: 0.44663500785827637, gen p mean: -0.38390204310417175, mean p set: 0.4471152722835541
The modified gen p mean: 0.44788864254951477, gen p mean: -0.38459739089012146, mean p set: 0.44836893677711487
loss_pred:0.037077341228723526, decouple_loss:0.03175423666834831
loss_pred:0.03727744519710541, decouple_loss:0.03006725385785103
loss_pred:0.037218619138002396, decouple_loss:0.030375026166439056
Iteration: 633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776391983032227, gen p mean: -0.3876349627971649, mean p set: 0.44824421405792236
The modified gen p mean: 0.44810450077056885, gen p mean: -0.39090684056282043, mean p set: 0.44858479499816895
The modified gen p mean: 0.4469485282897949, gen p mean: -0.3925655782222748, mean p set: 0.44742879271507263
loss_pred:0.03901699557900429, decouple_loss:0.03041420876979828
loss_pred:0.03706621378660202, decouple_loss:0.02944038435816765
loss_pred:0.03882816806435585, decouple_loss:0.030895305797457695
Iteration: 634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490271210670471, gen p mean: -0.3896558880805969, mean p set: 0.4495074450969696
The modified gen p mean: 0.4478556215763092, gen p mean: -0.38286975026130676, mean p set: 0.4483358860015869
The modified gen p mean: 0.4471675753593445, gen p mean: -0.38058486580848694, mean p set: 0.4476478397846222
loss_pred:0.037289854139089584, decouple_loss:0.03220050036907196
loss_pred:0.03761296346783638, decouple_loss:0.029957648366689682
loss_pred:0.0378241203725338, decouple_loss:0.030089566484093666
Iteration: 635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466511309146881, gen p mean: -0.3802286684513092, mean p set: 0.4471314251422882
The modified gen p mean: 0.448213666677475, gen p mean: -0.37420737743377686, mean p set: 0.4486939311027527
The modified gen p mean: 0.4477159082889557, gen p mean: -0.3809988498687744, mean p set: 0.4481962025165558
loss_pred:0.03677598387002945, decouple_loss:0.031932979822158813
loss_pred:0.03794488310813904, decouple_loss:0.029075121507048607
loss_pred:0.037764959037303925, decouple_loss:0.030011480674147606
Iteration: 636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470505118370056, gen p mean: -0.3840072453022003, mean p set: 0.4475308060646057
The modified gen p mean: 0.44781047105789185, gen p mean: -0.38632863759994507, mean p set: 0.44829070568084717
The modified gen p mean: 0.44716039299964905, gen p mean: -0.3841022253036499, mean p set: 0.44764068722724915
loss_pred:0.03638574108481407, decouple_loss:0.03278784453868866
loss_pred:0.03692801296710968, decouple_loss:0.03196385130286217
loss_pred:0.03655832260847092, decouple_loss:0.03167303279042244
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
NaN value num: 0
Iteration: 637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462824761867523, gen p mean: -0.3836454749107361, mean p set: 0.4467627704143524
The modified gen p mean: 0.44636473059654236, gen p mean: -0.3843142092227936, mean p set: 0.44684502482414246
The modified gen p mean: 0.44614872336387634, gen p mean: -0.3837416470050812, mean p set: 0.44662904739379883
loss_pred:0.0372840017080307, decouple_loss:0.02954634465277195
loss_pred:0.037942592054605484, decouple_loss:0.030499372631311417
loss_pred:0.03729045018553734, decouple_loss:0.029917431995272636
Iteration: 638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473405182361603, gen p mean: -0.38949838280677795, mean p set: 0.4478208124637604
The modified gen p mean: 0.44828104972839355, gen p mean: -0.38373062014579773, mean p set: 0.44876134395599365
The modified gen p mean: 0.44780921936035156, gen p mean: -0.3810358941555023, mean p set: 0.44828951358795166
loss_pred:0.039970267564058304, decouple_loss:0.031700823456048965
loss_pred:0.04041295498609543, decouple_loss:0.031346529722213745
loss_pred:0.037649139761924744, decouple_loss:0.03315068408846855
Iteration: 639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469979405403137, gen p mean: -0.3899722695350647, mean p set: 0.4474782347679138
The modified gen p mean: 0.44708576798439026, gen p mean: -0.38928666710853577, mean p set: 0.44756606221199036
The modified gen p mean: 0.44659125804901123, gen p mean: -0.3882380425930023, mean p set: 0.44707152247428894
loss_pred:0.037559498101472855, decouple_loss:0.031255558133125305
loss_pred:0.036585964262485504, decouple_loss:0.03061731345951557
loss_pred:0.03661414608359337, decouple_loss:0.03037092834711075
Iteration: 640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463682174682617, gen p mean: -0.38644447922706604, mean p set: 0.4468485414981842
The modified gen p mean: 0.4487220346927643, gen p mean: -0.3835844397544861, mean p set: 0.4492022693157196
The modified gen p mean: 0.4477706849575043, gen p mean: -0.38588348031044006, mean p set: 0.448250949382782
loss_pred:0.03919916972517967, decouple_loss:0.032800156623125076
loss_pred:0.036624740809202194, decouple_loss:0.0292714461684227
loss_pred:0.039544351398944855, decouple_loss:0.030385425314307213
2023-05-02 18:26:09 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.38276055455207825, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.38975435495376587, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.3788227140903473, mean p set: 0.45035696029663086
loss_pred:0.03705235943198204, decouple_loss:0.03164786100387573
loss_pred:0.038113079965114594, decouple_loss:0.031870611011981964
loss_pred:0.036284491419792175, decouple_loss:0.03238712251186371
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03874840587377548, avg_mse: 0.04071803390979767
current test mse: 0.040718
Iteration: 641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445794939994812, gen p mean: -0.389480859041214, mean p set: 0.4462752044200897
loss_pred:0.03778056427836418, decouple_loss:0.029163241386413574
The modified gen p mean: 0.44753193855285645, gen p mean: -0.38904911279678345, mean p set: 0.44801223278045654
loss_pred:0.03883424773812294, decouple_loss:0.02993178181350231
The modified gen p mean: 0.4480167031288147, gen p mean: -0.38504758477211, mean p set: 0.4484969973564148
loss_pred:0.04054950922727585, decouple_loss:0.03110293112695217
Iteration: 642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469447135925293, gen p mean: -0.3803658187389374, mean p set: 0.4474250078201294
The modified gen p mean: 0.44618138670921326, gen p mean: -0.38754767179489136, mean p set: 0.44666171073913574
The modified gen p mean: 0.4475215971469879, gen p mean: -0.3867146670818329, mean p set: 0.448001891374588
loss_pred:0.0390530489385128, decouple_loss:0.03228805959224701
loss_pred:0.036754049360752106, decouple_loss:0.030062394216656685
loss_pred:0.039354849606752396, decouple_loss:0.030136557295918465
Iteration: 643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44689828157424927, gen p mean: -0.38456159830093384, mean p set: 0.44737857580184937
The modified gen p mean: 0.44763386249542236, gen p mean: -0.39111021161079407, mean p set: 0.44811415672302246
The modified gen p mean: 0.44751158356666565, gen p mean: -0.3883064091205597, mean p set: 0.44799190759658813
loss_pred:0.03943471238017082, decouple_loss:0.031411830335855484
loss_pred:0.038746654987335205, decouple_loss:0.029843654483556747
loss_pred:0.03679521381855011, decouple_loss:0.030664918944239616
Iteration: 644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473279118537903, gen p mean: -0.3869219720363617, mean p set: 0.4478082060813904
The modified gen p mean: 0.4469245672225952, gen p mean: -0.3960508704185486, mean p set: 0.4474048614501953
The modified gen p mean: 0.44634953141212463, gen p mean: -0.3951016068458557, mean p set: 0.44682982563972473
loss_pred:0.03780938684940338, decouple_loss:0.03096778504550457
loss_pred:0.03761740401387215, decouple_loss:0.02933872677385807
loss_pred:0.03797103092074394, decouple_loss:0.03051583841443062
Iteration: 645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708535075187683, gen p mean: -0.3994496464729309, mean p set: 0.44756564497947693
The modified gen p mean: 0.44776710867881775, gen p mean: -0.39654210209846497, mean p set: 0.44824743270874023
The modified gen p mean: 0.44678714871406555, gen p mean: -0.39720603823661804, mean p set: 0.44726744294166565
loss_pred:0.036482568830251694, decouple_loss:0.029832588508725166
loss_pred:0.03953090310096741, decouple_loss:0.02945857308804989
loss_pred:0.03697102889418602, decouple_loss:0.030983801931142807
Iteration: 646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487491250038147, gen p mean: -0.3841884136199951, mean p set: 0.4492294192314148
The modified gen p mean: 0.44600510597229004, gen p mean: -0.3869122266769409, mean p set: 0.44648540019989014
The modified gen p mean: 0.44622454047203064, gen p mean: -0.39025139808654785, mean p set: 0.44670480489730835
loss_pred:0.039360009133815765, decouple_loss:0.03080972284078598
loss_pred:0.038254354149103165, decouple_loss:0.03079177252948284
loss_pred:0.03643517196178436, decouple_loss:0.029904769733548164
Iteration: 647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468585252761841, gen p mean: -0.3919900357723236, mean p set: 0.4473387897014618
The modified gen p mean: 0.44673365354537964, gen p mean: -0.3865357041358948, mean p set: 0.4472139775753021
The modified gen p mean: 0.44688180088996887, gen p mean: -0.38981565833091736, mean p set: 0.4473620653152466
loss_pred:0.03679293766617775, decouple_loss:0.03030996397137642
loss_pred:0.03631244972348213, decouple_loss:0.0301246028393507
loss_pred:0.03824082389473915, decouple_loss:0.02892487309873104
Iteration: 648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731980562210083, gen p mean: -0.39471369981765747, mean p set: 0.44780007004737854
The modified gen p mean: 0.44848915934562683, gen p mean: -0.39243051409721375, mean p set: 0.4489694833755493
The modified gen p mean: 0.4481840431690216, gen p mean: -0.3868999481201172, mean p set: 0.4486643373966217
loss_pred:0.037668827921152115, decouple_loss:0.029292521998286247loss_pred:0.039216648787260056, decouple_loss:0.030926115810871124
loss_pred:0.03980415686964989, decouple_loss:0.03085816092789173
Iteration: 649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461558759212494, gen p mean: -0.3934099078178406, mean p set: 0.4466361403465271
The modified gen p mean: 0.44829297065734863, gen p mean: -0.38718196749687195, mean p set: 0.44877323508262634
The modified gen p mean: 0.44858789443969727, gen p mean: -0.3836030960083008, mean p set: 0.44906821846961975
loss_pred:0.03707968816161156, decouple_loss:0.0296479482203722
loss_pred:0.039198558777570724, decouple_loss:0.03009183518588543
loss_pred:0.03789607062935829, decouple_loss:0.030855976045131683
Iteration: 650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44886305928230286, gen p mean: -0.3936927616596222, mean p set: 0.44934335350990295
The modified gen p mean: 0.4460732042789459, gen p mean: -0.3965412974357605, mean p set: 0.446553498506546
The modified gen p mean: 0.4477754533290863, gen p mean: -0.397258460521698, mean p set: 0.4482557475566864
loss_pred:0.0396379679441452, decouple_loss:0.03266243636608124
loss_pred:0.037381112575531006, decouple_loss:0.030766120180487633
loss_pred:0.03872845694422722, decouple_loss:0.030699416995048523
2023-05-02 18:29:56 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.39407333731651306, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.4021604657173157, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.3899241089820862, mean p set: 0.45035696029663086
loss_pred:0.03687417134642601, decouple_loss:0.030453626066446304
loss_pred:0.03779511898756027, decouple_loss:0.031855832785367966
loss_pred:0.0360567681491375, decouple_loss:0.031312327831983566
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03846905380487442, avg_mse: 0.040608033537864685
current test mse: 0.040608
Iteration: 651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44592970609664917, gen p mean: -0.39759862422943115, mean p set: 0.44641000032424927
loss_pred:0.037263527512550354, decouple_loss:0.029690153896808624
The modified gen p mean: 0.4467674791812897, gen p mean: -0.3977883458137512, mean p set: 0.44724777340888977
loss_pred:0.036049291491508484, decouple_loss:0.02865983359515667
The modified gen p mean: 0.4466865062713623, gen p mean: -0.38817188143730164, mean p set: 0.4471668004989624
loss_pred:0.038192249834537506, decouple_loss:0.03072168305516243
Iteration: 652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469219148159027, gen p mean: -0.38528701663017273, mean p set: 0.4474022090435028
The modified gen p mean: 0.4477894604206085, gen p mean: -0.39160364866256714, mean p set: 0.44826972484588623
The modified gen p mean: 0.4462904930114746, gen p mean: -0.391628623008728, mean p set: 0.4467707574367523
loss_pred:0.03811297565698624, decouple_loss:0.03023998998105526
loss_pred:0.03639964014291763, decouple_loss:0.029840245842933655
loss_pred:0.03736027702689171, decouple_loss:0.030030040070414543
Iteration: 653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468212425708771, gen p mean: -0.39324650168418884, mean p set: 0.44730156660079956
The modified gen p mean: 0.4462626576423645, gen p mean: -0.390841543674469, mean p set: 0.446742981672287
The modified gen p mean: 0.4482387900352478, gen p mean: -0.38829994201660156, mean p set: 0.4487190544605255
loss_pred:0.03792890906333923, decouple_loss:0.029727622866630554
loss_pred:0.037167198956012726, decouple_loss:0.030194200575351715
loss_pred:0.03876277804374695, decouple_loss:0.03027050383388996
Iteration: 654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462827146053314, gen p mean: -0.3934016823768616, mean p set: 0.4467630088329315
The modified gen p mean: 0.4489080309867859, gen p mean: -0.3881978988647461, mean p set: 0.449388325214386
The modified gen p mean: 0.4483528137207031, gen p mean: -0.38627082109451294, mean p set: 0.44883307814598083
loss_pred:0.037096016108989716, decouple_loss:0.029066385701298714
loss_pred:0.03887391462922096, decouple_loss:0.029171854257583618
loss_pred:0.039351969957351685, decouple_loss:0.03033210150897503
Iteration: 655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463445842266083, gen p mean: -0.3931270241737366, mean p set: 0.4468248784542084
The modified gen p mean: 0.4461723566055298, gen p mean: -0.38895124197006226, mean p set: 0.4466526508331299
The modified gen p mean: 0.4462166130542755, gen p mean: -0.3831450939178467, mean p set: 0.4466968774795532
loss_pred:0.036274995654821396, decouple_loss:0.029893971979618073
loss_pred:0.03657734394073486, decouple_loss:0.029500817880034447
loss_pred:0.0371607281267643, decouple_loss:0.03034866787493229
Iteration: 656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470100998878479, gen p mean: -0.38684144616127014, mean p set: 0.4474903643131256
The modified gen p mean: 0.44834721088409424, gen p mean: -0.3817884922027588, mean p set: 0.44882747530937195
The modified gen p mean: 0.44714465737342834, gen p mean: -0.3860168755054474, mean p set: 0.44762495160102844
loss_pred:0.03654954582452774, decouple_loss:0.029754968360066414
loss_pred:0.03906692564487457, decouple_loss:0.030619630590081215
loss_pred:0.03659216687083244, decouple_loss:0.030423887073993683
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
NaN value num: 0
Iteration: 657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446050226688385, gen p mean: -0.390700101852417, mean p set: 0.4465305209159851
The modified gen p mean: 0.4475783109664917, gen p mean: -0.39242202043533325, mean p set: 0.4480586051940918
The modified gen p mean: 0.4465714693069458, gen p mean: -0.3874053359031677, mean p set: 0.4470517337322235
loss_pred:0.03792562335729599, decouple_loss:0.03031131625175476
loss_pred:0.03682905435562134, decouple_loss:0.02860311232507229
loss_pred:0.03755608946084976, decouple_loss:0.02890300378203392
Iteration: 658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44538143277168274, gen p mean: -0.39555492997169495, mean p set: 0.44586169719696045
The modified gen p mean: 0.44666028022766113, gen p mean: -0.40269574522972107, mean p set: 0.44714057445526123
The modified gen p mean: 0.4479353427886963, gen p mean: -0.40087759494781494, mean p set: 0.4484156668186188
loss_pred:0.03637775406241417, decouple_loss:0.030423417687416077
loss_pred:0.036997247487306595, decouple_loss:0.03068779781460762
loss_pred:0.03567942976951599, decouple_loss:0.03139418736100197
Iteration: 659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904494285583496, gen p mean: -0.38222408294677734, mean p set: 0.44952526688575745
The modified gen p mean: 0.4488806128501892, gen p mean: -0.38098257780075073, mean p set: 0.4493609070777893
The modified gen p mean: 0.4464987814426422, gen p mean: -0.3810760974884033, mean p set: 0.4469790756702423
loss_pred:0.036428697407245636, decouple_loss:0.029865486547350883
loss_pred:0.03713586926460266, decouple_loss:0.031259890645742416
loss_pred:0.03630990907549858, decouple_loss:0.028952591121196747
Iteration: 660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44588378071784973, gen p mean: -0.39033767580986023, mean p set: 0.44636404514312744
The modified gen p mean: 0.4458862543106079, gen p mean: -0.39205390214920044, mean p set: 0.446366548538208
The modified gen p mean: 0.44609618186950684, gen p mean: -0.39252880215644836, mean p set: 0.44657647609710693
loss_pred:0.0356820784509182, decouple_loss:0.028260115534067154
loss_pred:0.035800300538539886, decouple_loss:0.028609417378902435
loss_pred:0.03536558151245117, decouple_loss:0.03001887910068035
2023-05-02 18:34:18 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.3955472409725189, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.3872566521167755, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.38288968801498413, mean p set: 0.45035696029663086
loss_pred:0.03740297257900238, decouple_loss:0.031150417402386665
loss_pred:0.03647258132696152, decouple_loss:0.03019975684583187
loss_pred:0.035745084285736084, decouple_loss:0.03076321631669998
WV_0_PC_1_EH_0_PS_40_6, loss: 0.038075439631938934, avg_mse: 0.04011478275060654
current test mse: 0.040115
Iteration: 661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680696725845337, gen p mean: -0.3929145634174347, mean p set: 0.44728726148605347
The modified gen p mean: 0.4453831911087036, gen p mean: -0.3919726014137268, mean p set: 0.4458634853363037
loss_pred:0.03545583039522171, decouple_loss:0.028645798563957214
loss_pred:0.03594660013914108, decouple_loss:0.02835559844970703
The modified gen p mean: 0.44939735531806946, gen p mean: -0.39305412769317627, mean p set: 0.44987761974334717
loss_pred:0.03546168655157089, decouple_loss:0.029307296499609947
Iteration: 662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471195936203003, gen p mean: -0.3914262652397156, mean p set: 0.4475998878479004
The modified gen p mean: 0.44878455996513367, gen p mean: -0.39356860518455505, mean p set: 0.44926485419273376
The modified gen p mean: 0.44712579250335693, gen p mean: -0.39947038888931274, mean p set: 0.44760608673095703
loss_pred:0.03816257417201996, decouple_loss:0.03042609803378582
loss_pred:0.037140581756830215, decouple_loss:0.031203769147396088
loss_pred:0.036971013993024826, decouple_loss:0.029997769743204117
Iteration: 663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446638286113739, gen p mean: -0.4030505120754242, mean p set: 0.4471185803413391
The modified gen p mean: 0.4462382197380066, gen p mean: -0.3944323658943176, mean p set: 0.4467185139656067
The modified gen p mean: 0.44633185863494873, gen p mean: -0.3982558846473694, mean p set: 0.44681212306022644
loss_pred:0.03575163707137108, decouple_loss:0.029598025605082512
loss_pred:0.037305887788534164, decouple_loss:0.028983034193515778
loss_pred:0.03729269281029701, decouple_loss:0.029614632949233055
Iteration: 664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44568878412246704, gen p mean: -0.4121609032154083, mean p set: 0.4461691081523895
The modified gen p mean: 0.44616612792015076, gen p mean: -0.40947267413139343, mean p set: 0.44664642214775085
The modified gen p mean: 0.4470728039741516, gen p mean: -0.416098028421402, mean p set: 0.4475530982017517
loss_pred:0.03610208258032799, decouple_loss:0.030233653262257576
loss_pred:0.036271508783102036, decouple_loss:0.02921476401388645
loss_pred:0.03759061545133591, decouple_loss:0.030128654092550278
Iteration: 665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44636714458465576, gen p mean: -0.4072932302951813, mean p set: 0.44684743881225586
The modified gen p mean: 0.4459202289581299, gen p mean: -0.4060533344745636, mean p set: 0.44640052318573
The modified gen p mean: 0.44561290740966797, gen p mean: -0.4060070514678955, mean p set: 0.44609320163726807
loss_pred:0.03699256479740143, decouple_loss:0.030291782692074776
loss_pred:0.036067016422748566, decouple_loss:0.029347337782382965
loss_pred:0.03456643968820572, decouple_loss:0.029200762510299683
Iteration: 666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456835389137268, gen p mean: -0.39796537160873413, mean p set: 0.4461638331413269
The modified gen p mean: 0.4482899308204651, gen p mean: -0.40248197317123413, mean p set: 0.4487701654434204
The modified gen p mean: 0.44679054617881775, gen p mean: -0.4012826085090637, mean p set: 0.44727084040641785
loss_pred:0.036247581243515015, decouple_loss:0.02847154624760151
loss_pred:0.03596000745892525, decouple_loss:0.030893737450242043
loss_pred:0.03649066016077995, decouple_loss:0.03025624342262745
Iteration: 667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714638590812683, gen p mean: -0.39458411931991577, mean p set: 0.4476267099380493
The modified gen p mean: 0.44680359959602356, gen p mean: -0.39766940474510193, mean p set: 0.44728389382362366
The modified gen p mean: 0.44823578000068665, gen p mean: -0.38989922404289246, mean p set: 0.44871607422828674
loss_pred:0.03720540180802345, decouple_loss:0.029918961226940155
loss_pred:0.036568112671375275, decouple_loss:0.030221255496144295
loss_pred:0.036526765674352646, decouple_loss:0.02957390621304512
Iteration: 668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464147090911865, gen p mean: -0.3950343728065491, mean p set: 0.4468950033187866
The modified gen p mean: 0.4464940130710602, gen p mean: -0.3952733874320984, mean p set: 0.4469743072986603
The modified gen p mean: 0.44632381200790405, gen p mean: -0.3882591724395752, mean p set: 0.44680410623550415
loss_pred:0.03513018786907196, decouple_loss:0.029538894072175026
loss_pred:0.0367664210498333, decouple_loss:0.02968534454703331
loss_pred:0.0358017161488533, decouple_loss:0.029208548367023468
Iteration: 669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473308324813843, gen p mean: -0.3965206742286682, mean p set: 0.447811096906662
The modified gen p mean: 0.44593241810798645, gen p mean: -0.3937802016735077, mean p set: 0.44641271233558655
The modified gen p mean: 0.4472513496875763, gen p mean: -0.3951883316040039, mean p set: 0.4477316439151764
loss_pred:0.03570881113409996, decouple_loss:0.02983991988003254
loss_pred:0.035888366401195526, decouple_loss:0.030038299039006233
loss_pred:0.03694411739706993, decouple_loss:0.030587799847126007
Iteration: 670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460093379020691, gen p mean: -0.4063912034034729, mean p set: 0.4464896619319916
The modified gen p mean: 0.44707542657852173, gen p mean: -0.4081514775753021, mean p set: 0.4475557208061218
The modified gen p mean: 0.44733691215515137, gen p mean: -0.41004934906959534, mean p set: 0.44781720638275146
loss_pred:0.0355556346476078, decouple_loss:0.029445849359035492
loss_pred:0.037414468824863434, decouple_loss:0.029123501852154732
loss_pred:0.0363445021212101, decouple_loss:0.02937954291701317
2023-05-02 18:38:00 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.41209831833839417, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830237865448, gen p mean: -0.40528494119644165, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.4004718065261841, mean p set: 0.45035696029663086
loss_pred:0.03739277273416519, decouple_loss:0.03146287053823471
loss_pred:0.036383043974637985, decouple_loss:0.030841128900647163
loss_pred:0.035701483488082886, decouple_loss:0.03176788240671158
WV_0_PC_1_EH_0_PS_40_6, loss: 0.038060300052165985, avg_mse: 0.040263209491968155
current test mse: 0.040263
Iteration: 671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44870543479919434, gen p mean: -0.40491724014282227, mean p set: 0.44918572902679443
The modified gen p mean: 0.44758152961730957, gen p mean: -0.41349077224731445, mean p set: 0.4480617940425873
loss_pred:0.03660254925489426, decouple_loss:0.03064674884080887
loss_pred:0.03726843744516373, decouple_loss:0.028857041150331497
The modified gen p mean: 0.44722530245780945, gen p mean: -0.4126201570034027, mean p set: 0.44770559668540955
loss_pred:0.03591682389378548, decouple_loss:0.029058711603283882
Iteration: 672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456712305545807, gen p mean: -0.39545178413391113, mean p set: 0.4461515247821808
The modified gen p mean: 0.4463096559047699, gen p mean: -0.3993832767009735, mean p set: 0.44678995013237
The modified gen p mean: 0.44648781418800354, gen p mean: -0.39952582120895386, mean p set: 0.446968138217926
loss_pred:0.03584188595414162, decouple_loss:0.029498353600502014
loss_pred:0.03737542778253555, decouple_loss:0.028011394664645195
loss_pred:0.03757724165916443, decouple_loss:0.02842518873512745
Iteration: 673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491589665412903, gen p mean: -0.40053504705429077, mean p set: 0.44963929057121277
The modified gen p mean: 0.44729194045066833, gen p mean: -0.4000453054904938, mean p set: 0.44777223467826843
The modified gen p mean: 0.4471910297870636, gen p mean: -0.40275612473487854, mean p set: 0.4476713538169861
loss_pred:0.03618524223566055, decouple_loss:0.029384849593043327
loss_pred:0.03752746433019638, decouple_loss:0.030789263546466827
loss_pred:0.035535816103219986, decouple_loss:0.030208323150873184
Iteration: 674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44540107250213623, gen p mean: -0.40552836656570435, mean p set: 0.44588136672973633
The modified gen p mean: 0.4475260376930237, gen p mean: -0.4102526903152466, mean p set: 0.4480063021183014
The modified gen p mean: 0.4482974410057068, gen p mean: -0.40397825837135315, mean p set: 0.4487777352333069
loss_pred:0.03723975643515587, decouple_loss:0.028989750891923904
loss_pred:0.03555699437856674, decouple_loss:0.029625562950968742
loss_pred:0.03679444268345833, decouple_loss:0.030030101537704468
Iteration: 675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477458596229553, gen p mean: -0.40858107805252075, mean p set: 0.4482261538505554
The modified gen p mean: 0.4481053948402405, gen p mean: -0.4049224257469177, mean p set: 0.44858571887016296
The modified gen p mean: 0.44807305932044983, gen p mean: -0.40482157468795776, mean p set: 0.4485533535480499
loss_pred:0.03501416742801666, decouple_loss:0.029163021594285965
loss_pred:0.03779255226254463, decouple_loss:0.02956402115523815
loss_pred:0.037456247955560684, decouple_loss:0.029541095718741417
Iteration: 676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483083486557007, gen p mean: -0.39836227893829346, mean p set: 0.4487886130809784
The modified gen p mean: 0.4473434090614319, gen p mean: -0.40269163250923157, mean p set: 0.4478236734867096
The modified gen p mean: 0.4459381401538849, gen p mean: -0.3981189727783203, mean p set: 0.446418434381485
loss_pred:0.036288488656282425, decouple_loss:0.028867950662970543
loss_pred:0.03638774901628494, decouple_loss:0.02964157983660698
loss_pred:0.03701697289943695, decouple_loss:0.02845972776412964
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476301968097687, gen p mean: -0.4103472828865051, mean p set: 0.4481104910373688
The modified gen p mean: 0.4469279646873474, gen p mean: -0.40351131558418274, mean p set: 0.4474082589149475
The modified gen p mean: 0.4463586211204529, gen p mean: -0.40332797169685364, mean p set: 0.4468388855457306
loss_pred:0.03825260326266289, decouple_loss:0.032716378569602966
loss_pred:0.03690902143716812, decouple_loss:0.034117501229047775
loss_pred:0.036683131009340286, decouple_loss:0.03188463672995567
Iteration: 678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469186067581177, gen p mean: -0.3978503346443176, mean p set: 0.4473989009857178
The modified gen p mean: 0.4477772116661072, gen p mean: -0.4028043746948242, mean p set: 0.4482575058937073
The modified gen p mean: 0.4480094909667969, gen p mean: -0.40209075808525085, mean p set: 0.4484897553920746
loss_pred:0.03713489696383476, decouple_loss:0.03315209969878197
loss_pred:0.03817072510719299, decouple_loss:0.033149830996990204
loss_pred:0.0376613549888134, decouple_loss:0.03454771637916565
Iteration: 679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483056962490082, gen p mean: -0.3811894953250885, mean p set: 0.4487859904766083
The modified gen p mean: 0.4476337432861328, gen p mean: -0.38323774933815, mean p set: 0.4481140077114105
The modified gen p mean: 0.4468691945075989, gen p mean: -0.3735326826572418, mean p set: 0.4473494589328766
loss_pred:0.03673812747001648, decouple_loss:0.030435161665081978
loss_pred:0.03649568557739258, decouple_loss:0.03230700641870499
loss_pred:0.03903961926698685, decouple_loss:0.0344785712659359
Iteration: 680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472801983356476, gen p mean: -0.3686749339103699, mean p set: 0.4477604627609253
The modified gen p mean: 0.4477654695510864, gen p mean: -0.3763059079647064, mean p set: 0.4482457637786865
The modified gen p mean: 0.4466789960861206, gen p mean: -0.3696530759334564, mean p set: 0.4471592903137207
loss_pred:0.036664534360170364, decouple_loss:0.03273317962884903loss_pred:0.03699162229895592, decouple_loss:0.03179305046796799
loss_pred:0.036259960383176804, decouple_loss:0.031513188034296036
2023-05-02 18:42:24 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.3810754716396332, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.38766786456108093, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.3771057724952698, mean p set: 0.45035696029663086
loss_pred:0.03647740185260773, decouple_loss:0.030869124457240105
loss_pred:0.037318166345357895, decouple_loss:0.03212937340140343
loss_pred:0.03543274104595184, decouple_loss:0.031046196818351746
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03797684982419014, avg_mse: 0.040173038840293884
current test mse: 0.040173
Iteration: 681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960805773735046, gen p mean: -0.3811609745025635, mean p set: 0.4500883221626282
The modified gen p mean: 0.44666460156440735, gen p mean: -0.37901610136032104, mean p set: 0.44714486598968506
loss_pred:0.03662332519888878, decouple_loss:0.032507434487342834
loss_pred:0.03638594597578049, decouple_loss:0.03200637176632881
The modified gen p mean: 0.4475826025009155, gen p mean: -0.3811017870903015, mean p set: 0.4480628967285156
loss_pred:0.037259314209222794, decouple_loss:0.030222952365875244
Iteration: 682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475051462650299, gen p mean: -0.3817717730998993, mean p set: 0.44798544049263
The modified gen p mean: 0.446621298789978, gen p mean: -0.37878307700157166, mean p set: 0.4471015930175781
The modified gen p mean: 0.4469491243362427, gen p mean: -0.3834478259086609, mean p set: 0.4474294185638428
loss_pred:0.03681882098317146, decouple_loss:0.030799701809883118
loss_pred:0.038546402007341385, decouple_loss:0.03264739736914635
loss_pred:0.03571668267250061, decouple_loss:0.032261379063129425
Iteration: 683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481349587440491, gen p mean: -0.3917872905731201, mean p set: 0.44861525297164917
The modified gen p mean: 0.44680145382881165, gen p mean: -0.3883865177631378, mean p set: 0.44728177785873413
The modified gen p mean: 0.44772204756736755, gen p mean: -0.3866996169090271, mean p set: 0.44820234179496765
loss_pred:0.037768829613924026, decouple_loss:0.03270068019628525
loss_pred:0.037323009222745895, decouple_loss:0.033052388578653336
loss_pred:0.03658177703619003, decouple_loss:0.031553011387586594
Iteration: 684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44824644923210144, gen p mean: -0.40124809741973877, mean p set: 0.4487267732620239
The modified gen p mean: 0.44755110144615173, gen p mean: -0.3921121060848236, mean p set: 0.44803139567375183
The modified gen p mean: 0.44798144698143005, gen p mean: -0.3987851142883301, mean p set: 0.44846174120903015
loss_pred:0.03716345876455307, decouple_loss:0.030964776873588562
loss_pred:0.03659345582127571, decouple_loss:0.029943661764264107
loss_pred:0.035867974162101746, decouple_loss:0.030035551637411118
Iteration: 685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44688501954078674, gen p mean: -0.39226430654525757, mean p set: 0.44736534357070923
The modified gen p mean: 0.44759413599967957, gen p mean: -0.3995056748390198, mean p set: 0.44807443022727966
The modified gen p mean: 0.4484237730503082, gen p mean: -0.39713993668556213, mean p set: 0.44890403747558594
loss_pred:0.03752867504954338, decouple_loss:0.03171412646770477
loss_pred:0.03572813794016838, decouple_loss:0.030280375853180885
loss_pred:0.03608660027384758, decouple_loss:0.03057079389691353
Iteration: 686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44685888290405273, gen p mean: -0.3811495900154114, mean p set: 0.44733917713165283
The modified gen p mean: 0.44651758670806885, gen p mean: -0.38322001695632935, mean p set: 0.44699788093566895
The modified gen p mean: 0.44687673449516296, gen p mean: -0.3884856402873993, mean p set: 0.4473569989204407
loss_pred:0.03626887872815132, decouple_loss:0.03113405406475067
loss_pred:0.03608548268675804, decouple_loss:0.0325627401471138
loss_pred:0.03599848970770836, decouple_loss:0.031329892575740814
Iteration: 687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473802447319031, gen p mean: -0.38773027062416077, mean p set: 0.4478605389595032
The modified gen p mean: 0.4484936594963074, gen p mean: -0.3970789611339569, mean p set: 0.44897395372390747
The modified gen p mean: 0.44696342945098877, gen p mean: -0.3875676691532135, mean p set: 0.44744372367858887
loss_pred:0.03733515739440918, decouple_loss:0.028877047821879387
loss_pred:0.036818355321884155, decouple_loss:0.03006576932966709
loss_pred:0.03635226935148239, decouple_loss:0.03069239668548107
Iteration: 688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44690874218940735, gen p mean: -0.40224581956863403, mean p set: 0.44738900661468506
The modified gen p mean: 0.44634178280830383, gen p mean: -0.39684659242630005, mean p set: 0.4468221068382263
The modified gen p mean: 0.4476257264614105, gen p mean: -0.4033592641353607, mean p set: 0.4481060206890106
loss_pred:0.03540440648794174, decouple_loss:0.031245088204741478
loss_pred:0.035725682973861694, decouple_loss:0.03209478408098221
loss_pred:0.037472352385520935, decouple_loss:0.030830727890133858
Iteration: 689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466017484664917, gen p mean: -0.39822933077812195, mean p set: 0.4470820426940918
The modified gen p mean: 0.4470483064651489, gen p mean: -0.4015524983406067, mean p set: 0.44752857089042664
The modified gen p mean: 0.4490155577659607, gen p mean: -0.4053897261619568, mean p set: 0.4494958221912384
loss_pred:0.035020433366298676, decouple_loss:0.031167780980467796
loss_pred:0.036946654319763184, decouple_loss:0.03187397122383118
loss_pred:0.03684954717755318, decouple_loss:0.03272703289985657
Iteration: 690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476531147956848, gen p mean: -0.39745038747787476, mean p set: 0.44813334941864014
The modified gen p mean: 0.44629180431365967, gen p mean: -0.39031311869621277, mean p set: 0.44677209854125977
The modified gen p mean: 0.44716107845306396, gen p mean: -0.38974058628082275, mean p set: 0.4476413428783417
loss_pred:0.036646898835897446, decouple_loss:0.0314951166510582
loss_pred:0.036093343049287796, decouple_loss:0.031240422278642654
loss_pred:0.03650662302970886, decouple_loss:0.030482731759548187
2023-05-02 18:46:08 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.3884497284889221, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.3943367004394531, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.38476455211639404, mean p set: 0.45035696029663086
loss_pred:0.03605177626013756, decouple_loss:0.030975699424743652
loss_pred:0.03707551211118698, decouple_loss:0.033045172691345215
loss_pred:0.035071998834609985, decouple_loss:0.03149699419736862
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03765839338302612, avg_mse: 0.039764486253261566
current test mse: 0.039764
Iteration: 691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480169117450714, gen p mean: -0.3899572491645813, mean p set: 0.4484971761703491
The modified gen p mean: 0.4483170509338379, gen p mean: -0.3891616761684418, mean p set: 0.448797345161438
loss_pred:0.035285305231809616, decouple_loss:0.03052741102874279
loss_pred:0.037387847900390625, decouple_loss:0.0315546952188015
The modified gen p mean: 0.4473516047000885, gen p mean: -0.387617290019989, mean p set: 0.4478318989276886
loss_pred:0.037826064974069595, decouple_loss:0.03035677783191204
Iteration: 692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484513998031616, gen p mean: -0.3892701268196106, mean p set: 0.4489316940307617
The modified gen p mean: 0.4464806616306305, gen p mean: -0.3909373879432678, mean p set: 0.4469609558582306
The modified gen p mean: 0.44705286622047424, gen p mean: -0.38574010133743286, mean p set: 0.44753316044807434
loss_pred:0.03674158453941345, decouple_loss:0.03123844601213932
loss_pred:0.035890355706214905, decouple_loss:0.02945278212428093
loss_pred:0.036460693925619125, decouple_loss:0.030465051531791687
Iteration: 693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44754254817962646, gen p mean: -0.3985232710838318, mean p set: 0.44802284240722656
The modified gen p mean: 0.4465595483779907, gen p mean: -0.399271160364151, mean p set: 0.44703981280326843
The modified gen p mean: 0.4486178457736969, gen p mean: -0.4059269428253174, mean p set: 0.449098140001297
loss_pred:0.03633264824748039, decouple_loss:0.030283115804195404
loss_pred:0.03714541345834732, decouple_loss:0.03046438843011856
loss_pred:0.037179674953222275, decouple_loss:0.030331052839756012
Iteration: 694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464671015739441, gen p mean: -0.4042496681213379, mean p set: 0.4469473958015442
The modified gen p mean: 0.44723808765411377, gen p mean: -0.40313759446144104, mean p set: 0.4477183520793915
The modified gen p mean: 0.44851794838905334, gen p mean: -0.4055793285369873, mean p set: 0.44899824261665344
loss_pred:0.03664827346801758, decouple_loss:0.030097555369138718
loss_pred:0.03738012909889221, decouple_loss:0.02978322096168995
loss_pred:0.03588489815592766, decouple_loss:0.029671654105186462
Iteration: 695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44689786434173584, gen p mean: -0.39461734890937805, mean p set: 0.44737815856933594
The modified gen p mean: 0.44748455286026, gen p mean: -0.3962830901145935, mean p set: 0.4479648470878601
The modified gen p mean: 0.44941359758377075, gen p mean: -0.403176486492157, mean p set: 0.44989389181137085
loss_pred:0.03600979968905449, decouple_loss:0.02925843559205532
loss_pred:0.036066751927137375, decouple_loss:0.02944020926952362
loss_pred:0.035909879952669144, decouple_loss:0.031122473999857903
Iteration: 696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44703513383865356, gen p mean: -0.4061906039714813, mean p set: 0.44751542806625366
The modified gen p mean: 0.4466681480407715, gen p mean: -0.40827977657318115, mean p set: 0.4471484422683716
The modified gen p mean: 0.4492480754852295, gen p mean: -0.4096241593360901, mean p set: 0.4497283697128296
loss_pred:0.035531338304281235, decouple_loss:0.03022955358028412
loss_pred:0.036217257380485535, decouple_loss:0.031127644702792168
loss_pred:0.03609739616513252, decouple_loss:0.0298134908080101
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
NaN value num: 0
Iteration: 697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450580358505249, gen p mean: -0.42856329679489136, mean p set: 0.4510606527328491
The modified gen p mean: 0.4496537744998932, gen p mean: -0.4321547746658325, mean p set: 0.4501340985298157
The modified gen p mean: 0.45062196254730225, gen p mean: -0.42635205388069153, mean p set: 0.45110225677490234
loss_pred:0.03732258826494217, decouple_loss:0.03552825003862381
loss_pred:0.03550916537642479, decouple_loss:0.035911280661821365
loss_pred:0.03636085242033005, decouple_loss:0.035335101187229156
Iteration: 698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520682990550995, gen p mean: -0.42359986901283264, mean p set: 0.4525485932826996
The modified gen p mean: 0.4503708779811859, gen p mean: -0.41861215233802795, mean p set: 0.4508511424064636
The modified gen p mean: 0.44920673966407776, gen p mean: -0.42305806279182434, mean p set: 0.44968703389167786
loss_pred:0.03699158504605293, decouple_loss:0.033430151641368866
loss_pred:0.03588581457734108, decouple_loss:0.03321516513824463
loss_pred:0.036799173802137375, decouple_loss:0.03467824310064316
Iteration: 699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45108312368392944, gen p mean: -0.41226133704185486, mean p set: 0.45156341791152954
The modified gen p mean: 0.4504571557044983, gen p mean: -0.4047327935695648, mean p set: 0.450937420129776
The modified gen p mean: 0.45049917697906494, gen p mean: -0.4100568890571594, mean p set: 0.45097947120666504
loss_pred:0.03642987832427025, decouple_loss:0.03226485103368759
loss_pred:0.03621134161949158, decouple_loss:0.033018600195646286
loss_pred:0.036194249987602234, decouple_loss:0.03244517743587494
Iteration: 700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519236385822296, gen p mean: -0.4142768681049347, mean p set: 0.4524039626121521
The modified gen p mean: 0.44935160875320435, gen p mean: -0.41110119223594666, mean p set: 0.44983193278312683
The modified gen p mean: 0.4532533288002014, gen p mean: -0.41536495089530945, mean p set: 0.4537335932254791
loss_pred:0.035291194915771484, decouple_loss:0.03280575945973396
loss_pred:0.03725818544626236, decouple_loss:0.032526664435863495
loss_pred:0.03642425313591957, decouple_loss:0.03363455459475517
2023-05-02 18:50:28 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.4266771972179413, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830237865448, gen p mean: -0.4210464656352997, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.4163287878036499, mean p set: 0.45035696029663086
loss_pred:0.03719659894704819, decouple_loss:0.03404504805803299
loss_pred:0.03609345108270645, decouple_loss:0.03218962997198105
loss_pred:0.03503187745809555, decouple_loss:0.03315969184041023
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03776388615369797, avg_mse: 0.03995021432638168
current test mse: 0.03995
Iteration: 701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517694413661957, gen p mean: -0.42185178399086, mean p set: 0.4522497057914734
The modified gen p mean: 0.44915416836738586, gen p mean: -0.42530471086502075, mean p set: 0.44963446259498596
loss_pred:0.03689049556851387, decouple_loss:0.0326089970767498
loss_pred:0.035519808530807495, decouple_loss:0.03261881321668625
The modified gen p mean: 0.45261842012405396, gen p mean: -0.4227714538574219, mean p set: 0.45309871435165405
loss_pred:0.03658308461308479, decouple_loss:0.03291437774896622
Iteration: 702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525906443595886, gen p mean: -0.43339377641677856, mean p set: 0.4530709385871887
The modified gen p mean: 0.44951656460762024, gen p mean: -0.4235798418521881, mean p set: 0.44999685883522034
The modified gen p mean: 0.4494049847126007, gen p mean: -0.4266167879104614, mean p set: 0.4498852789402008
loss_pred:0.03645306080579758, decouple_loss:0.03283218666911125
loss_pred:0.035497311502695084, decouple_loss:0.03257844224572182
loss_pred:0.03747281804680824, decouple_loss:0.032053884118795395
Iteration: 703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500267803668976, gen p mean: -0.4268265962600708, mean p set: 0.4505070447921753
The modified gen p mean: 0.4532553255558014, gen p mean: -0.4304730296134949, mean p set: 0.4537356197834015
The modified gen p mean: 0.4515954256057739, gen p mean: -0.42598050832748413, mean p set: 0.45207569003105164
loss_pred:0.037375081330537796, decouple_loss:0.03109769895672798
loss_pred:0.036080144345760345, decouple_loss:0.03313635289669037
loss_pred:0.035637009888887405, decouple_loss:0.03236682340502739
Iteration: 704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500761032104492, gen p mean: -0.42945751547813416, mean p set: 0.4505563974380493
The modified gen p mean: 0.45054343342781067, gen p mean: -0.422560453414917, mean p set: 0.4510236978530884
The modified gen p mean: 0.4526252746582031, gen p mean: -0.4280872344970703, mean p set: 0.4531055688858032
loss_pred:0.03768688812851906, decouple_loss:0.03169095888733864
loss_pred:0.03523675724864006, decouple_loss:0.031842540949583054
loss_pred:0.03634803369641304, decouple_loss:0.031467270106077194
Iteration: 705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529212415218353, gen p mean: -0.4282926321029663, mean p set: 0.45340150594711304
The modified gen p mean: 0.4521403908729553, gen p mean: -0.43160003423690796, mean p set: 0.45262065529823303
The modified gen p mean: 0.4518849551677704, gen p mean: -0.4245731234550476, mean p set: 0.4523652195930481
loss_pred:0.03576778247952461, decouple_loss:0.03293388709425926
loss_pred:0.03547566756606102, decouple_loss:0.03184160962700844
loss_pred:0.03721170127391815, decouple_loss:0.031931422650814056
Iteration: 706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45299434661865234, gen p mean: -0.428053617477417, mean p set: 0.45347464084625244
The modified gen p mean: 0.45139604806900024, gen p mean: -0.4289436340332031, mean p set: 0.45187634229660034
The modified gen p mean: 0.45263898372650146, gen p mean: -0.42497360706329346, mean p set: 0.45311927795410156
loss_pred:0.03581947460770607, decouple_loss:0.03155709058046341
loss_pred:0.03532881289720535, decouple_loss:0.032306522130966187
loss_pred:0.03583015128970146, decouple_loss:0.030992280691862106
Iteration: 707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019471645355225, gen p mean: -0.42835044860839844, mean p set: 0.45067504048347473
The modified gen p mean: 0.4492180347442627, gen p mean: -0.43060463666915894, mean p set: 0.4496982991695404
The modified gen p mean: 0.4502231180667877, gen p mean: -0.4294392764568329, mean p set: 0.4507034122943878
loss_pred:0.035229168832302094, decouple_loss:0.03198825195431709
loss_pred:0.03516380861401558, decouple_loss:0.03302605077624321
loss_pred:0.03548877313733101, decouple_loss:0.031246261671185493
Iteration: 708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502429962158203, gen p mean: -0.43359094858169556, mean p set: 0.45072323083877563
The modified gen p mean: 0.4507702589035034, gen p mean: -0.4317609369754791, mean p set: 0.4512505531311035
The modified gen p mean: 0.4514337182044983, gen p mean: -0.43163636326789856, mean p set: 0.4519140422344208
loss_pred:0.03470415621995926, decouple_loss:0.03371492773294449
loss_pred:0.03695644810795784, decouple_loss:0.030858315527439117
loss_pred:0.03675764426589012, decouple_loss:0.031197674572467804
Iteration: 709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504302144050598, gen p mean: -0.43401047587394714, mean p set: 0.4509105384349823
The modified gen p mean: 0.45138290524482727, gen p mean: -0.4286966323852539, mean p set: 0.45186319947242737
The modified gen p mean: 0.4500598609447479, gen p mean: -0.4320904612541199, mean p set: 0.45054012537002563
loss_pred:0.03579465299844742, decouple_loss:0.03219865262508392
loss_pred:0.03598687797784805, decouple_loss:0.03224578872323036
loss_pred:0.03601662442088127, decouple_loss:0.03261891379952431
Iteration: 710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45007872581481934, gen p mean: -0.436706006526947, mean p set: 0.45055902004241943
The modified gen p mean: 0.45090559124946594, gen p mean: -0.43228384852409363, mean p set: 0.4513859152793884
The modified gen p mean: 0.4502005875110626, gen p mean: -0.4329385459423065, mean p set: 0.45068085193634033
loss_pred:0.03657478094100952, decouple_loss:0.03114522248506546
loss_pred:0.03651326894760132, decouple_loss:0.032017286866903305
loss_pred:0.03413551673293114, decouple_loss:0.03323565796017647
2023-05-02 18:54:10 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.4228038787841797, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.42942917346954346, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.41844442486763, mean p set: 0.45035696029663086
loss_pred:0.036127153784036636, decouple_loss:0.033510658890008926
loss_pred:0.03720169886946678, decouple_loss:0.03527478128671646
loss_pred:0.035081978887319565, decouple_loss:0.034578461199998856
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03785967454314232, avg_mse: 0.0401906855404377
current test mse: 0.040191
Iteration: 711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45077091455459595, gen p mean: -0.4287429451942444, mean p set: 0.45125120878219604
loss_pred:0.035911839455366135, decouple_loss:0.03170524165034294
The modified gen p mean: 0.449970006942749, gen p mean: -0.42578887939453125, mean p set: 0.4504503011703491
loss_pred:0.036311112344264984, decouple_loss:0.030741017311811447
The modified gen p mean: 0.4513232707977295, gen p mean: -0.43111419677734375, mean p set: 0.4518035352230072
loss_pred:0.03637855127453804, decouple_loss:0.03124641440808773
Iteration: 712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44996151328086853, gen p mean: -0.42107918858528137, mean p set: 0.450441837310791
The modified gen p mean: 0.44960248470306396, gen p mean: -0.41637346148490906, mean p set: 0.45008277893066406
The modified gen p mean: 0.45068982243537903, gen p mean: -0.4181574881076813, mean p set: 0.4511701166629791
loss_pred:0.03581280633807182, decouple_loss:0.031223174184560776
loss_pred:0.03582236170768738, decouple_loss:0.030876141041517258
loss_pred:0.03511501103639603, decouple_loss:0.031194821000099182
Iteration: 713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494568109512329, gen p mean: -0.42379000782966614, mean p set: 0.449937105178833
The modified gen p mean: 0.45142993330955505, gen p mean: -0.4309619069099426, mean p set: 0.45191025733947754
The modified gen p mean: 0.4504399001598358, gen p mean: -0.43298476934432983, mean p set: 0.4509201943874359
loss_pred:0.03456345945596695, decouple_loss:0.0316888801753521
loss_pred:0.03491654619574547, decouple_loss:0.030834779143333435
loss_pred:0.035449493676424026, decouple_loss:0.030345752835273743
Iteration: 714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504378139972687, gen p mean: -0.4355078339576721, mean p set: 0.4509181082248688
The modified gen p mean: 0.4501752555370331, gen p mean: -0.4383602440357208, mean p set: 0.4506555497646332
The modified gen p mean: 0.4497902989387512, gen p mean: -0.4330187737941742, mean p set: 0.4502705931663513
loss_pred:0.03535345569252968, decouple_loss:0.030401114374399185
loss_pred:0.035353679209947586, decouple_loss:0.031329572200775146
loss_pred:0.034387342631816864, decouple_loss:0.02970740757882595
Iteration: 715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500027298927307, gen p mean: -0.43391814827919006, mean p set: 0.4504829943180084
The modified gen p mean: 0.450313001871109, gen p mean: -0.43231070041656494, mean p set: 0.4507932960987091
The modified gen p mean: 0.4504168927669525, gen p mean: -0.4382019639015198, mean p set: 0.4508971571922302
loss_pred:0.03383020684123039, decouple_loss:0.03038695827126503
loss_pred:0.03429803252220154, decouple_loss:0.03006679378449917
loss_pred:0.03451938182115555, decouple_loss:0.030535388737916946
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483235776424408, gen p mean: -0.44137948751449585, mean p set: 0.4488038718700409
The modified gen p mean: 0.4486527442932129, gen p mean: -0.4386872947216034, mean p set: 0.449133038520813
The modified gen p mean: 0.44808006286621094, gen p mean: -0.4348081052303314, mean p set: 0.44856035709381104
loss_pred:0.0354803167283535, decouple_loss:0.03307538107037544
loss_pred:0.03645579144358635, decouple_loss:0.0326104462146759
loss_pred:0.03488611429929733, decouple_loss:0.03321632742881775
Iteration: 717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729694724082947, gen p mean: -0.42774128913879395, mean p set: 0.44777724146842957
The modified gen p mean: 0.446613073348999, gen p mean: -0.4288919270038605, mean p set: 0.4470933675765991
The modified gen p mean: 0.44849923253059387, gen p mean: -0.4289524555206299, mean p set: 0.4489794969558716
loss_pred:0.036759525537490845, decouple_loss:0.03272854536771774
loss_pred:0.035661011934280396, decouple_loss:0.033063605427742004
loss_pred:0.03570368513464928, decouple_loss:0.032731592655181885
Iteration: 718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725486636161804, gen p mean: -0.4234824776649475, mean p set: 0.44773516058921814
The modified gen p mean: 0.449061781167984, gen p mean: -0.4303194284439087, mean p set: 0.4495420455932617
The modified gen p mean: 0.44846057891845703, gen p mean: -0.4367581009864807, mean p set: 0.44894084334373474
loss_pred:0.036625757813453674, decouple_loss:0.03292010724544525
loss_pred:0.03460775315761566, decouple_loss:0.03251068666577339
loss_pred:0.034967873245477676, decouple_loss:0.03195682168006897
Iteration: 719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481548070907593, gen p mean: -0.42923325300216675, mean p set: 0.4486351013183594
The modified gen p mean: 0.4484996795654297, gen p mean: -0.43697676062583923, mean p set: 0.4489799737930298
The modified gen p mean: 0.44872990250587463, gen p mean: -0.4324147403240204, mean p set: 0.44921019673347473
loss_pred:0.0350760817527771, decouple_loss:0.031071634963154793
loss_pred:0.034694407135248184, decouple_loss:0.03149770572781563
loss_pred:0.03399766609072685, decouple_loss:0.03161304444074631
Iteration: 720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768163561820984, gen p mean: -0.42529359459877014, mean p set: 0.44816192984580994
The modified gen p mean: 0.4490264058113098, gen p mean: -0.4266391694545746, mean p set: 0.4495067000389099
The modified gen p mean: 0.448378324508667, gen p mean: -0.4285847544670105, mean p set: 0.4488586187362671
loss_pred:0.03537299111485481, decouple_loss:0.031465742737054825
loss_pred:0.034443143755197525, decouple_loss:0.031108273193240166
loss_pred:0.03536943346261978, decouple_loss:0.030636051669716835
2023-05-02 18:58:39 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.4338863790035248, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.44110843539237976, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.429509699344635, mean p set: 0.45035696029663086
loss_pred:0.035555656999349594, decouple_loss:0.030860811471939087
loss_pred:0.03668166697025299, decouple_loss:0.03192665055394173
loss_pred:0.03467515483498573, decouple_loss:0.031436726450920105
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03720789775252342, avg_mse: 0.039436180144548416
current test mse: 0.039436
Iteration: 721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476211667060852, gen p mean: -0.42958104610443115, mean p set: 0.4481014907360077
loss_pred:0.03568055108189583, decouple_loss:0.03079431876540184
The modified gen p mean: 0.44857344031333923, gen p mean: -0.4355495870113373, mean p set: 0.44905373454093933
loss_pred:0.036273203790187836, decouple_loss:0.03098064288496971
The modified gen p mean: 0.4481242001056671, gen p mean: -0.4314385950565338, mean p set: 0.4486044645309448
loss_pred:0.0345449335873127, decouple_loss:0.03088141791522503
Iteration: 722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493151009082794, gen p mean: -0.43589359521865845, mean p set: 0.4497953951358795
The modified gen p mean: 0.44745561480522156, gen p mean: -0.4287894368171692, mean p set: 0.44793590903282166
The modified gen p mean: 0.4484296441078186, gen p mean: -0.43590450286865234, mean p set: 0.4489099383354187
loss_pred:0.03499172255396843, decouple_loss:0.030543630942702293
loss_pred:0.035690028220415115, decouple_loss:0.03143719583749771
loss_pred:0.03426523879170418, decouple_loss:0.030580006539821625
Iteration: 723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750353693962097, gen p mean: -0.43153810501098633, mean p set: 0.44798383116722107
The modified gen p mean: 0.4474526643753052, gen p mean: -0.4330373704433441, mean p set: 0.4479329288005829
The modified gen p mean: 0.44834771752357483, gen p mean: -0.4375966787338257, mean p set: 0.4488280117511749
loss_pred:0.03667622059583664, decouple_loss:0.031051255762577057
loss_pred:0.0347028449177742, decouple_loss:0.030065437778830528
loss_pred:0.0345153734087944, decouple_loss:0.030017521232366562
Iteration: 724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475187361240387, gen p mean: -0.4388154447078705, mean p set: 0.4479990005493164
The modified gen p mean: 0.44796130061149597, gen p mean: -0.43684259057044983, mean p set: 0.44844159483909607
The modified gen p mean: 0.4483779966831207, gen p mean: -0.43623363971710205, mean p set: 0.4488582909107208
loss_pred:0.033901527523994446, decouple_loss:0.029769957065582275
loss_pred:0.03468655049800873, decouple_loss:0.03049105778336525
loss_pred:0.034678131341934204, decouple_loss:0.030258942395448685
Iteration: 725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822418689727783, gen p mean: -0.43483951687812805, mean p set: 0.4487045109272003
The modified gen p mean: 0.4483889937400818, gen p mean: -0.4422985911369324, mean p set: 0.4488692879676819
The modified gen p mean: 0.44723644852638245, gen p mean: -0.430616557598114, mean p set: 0.44771671295166016
loss_pred:0.035124991089105606, decouple_loss:0.030377604067325592
loss_pred:0.03458027541637421, decouple_loss:0.030002251267433167
loss_pred:0.03631216660141945, decouple_loss:0.030217578634619713
Iteration: 726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474695920944214, gen p mean: -0.4323312044143677, mean p set: 0.4479498863220215
The modified gen p mean: 0.44817668199539185, gen p mean: -0.43253904581069946, mean p set: 0.44865697622299194
The modified gen p mean: 0.44736239314079285, gen p mean: -0.43336188793182373, mean p set: 0.44784268736839294
loss_pred:0.03429855406284332, decouple_loss:0.030106989666819572
loss_pred:0.03494253754615784, decouple_loss:0.029791956767439842
loss_pred:0.03654318302869797, decouple_loss:0.02992183156311512
Iteration: 727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44777804613113403, gen p mean: -0.43359991908073425, mean p set: 0.44825834035873413
The modified gen p mean: 0.4472895562648773, gen p mean: -0.4330470860004425, mean p set: 0.44776979088783264
The modified gen p mean: 0.44812268018722534, gen p mean: -0.4345444440841675, mean p set: 0.44860297441482544
loss_pred:0.03531781956553459, decouple_loss:0.030149830505251884
loss_pred:0.03409656509757042, decouple_loss:0.029020234942436218
loss_pred:0.033583324402570724, decouple_loss:0.02948368526995182
Iteration: 728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473142623901367, gen p mean: -0.4321163594722748, mean p set: 0.4477945566177368
The modified gen p mean: 0.44795188307762146, gen p mean: -0.44602540135383606, mean p set: 0.44843214750289917
The modified gen p mean: 0.44727110862731934, gen p mean: -0.4384986162185669, mean p set: 0.4477514326572418
loss_pred:0.03612188249826431, decouple_loss:0.029566993936896324
loss_pred:0.03390394151210785, decouple_loss:0.030437462031841278
loss_pred:0.035225238651037216, decouple_loss:0.02940724976360798
Iteration: 729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715479016304016, gen p mean: -0.43629583716392517, mean p set: 0.44763508439064026
The modified gen p mean: 0.44764864444732666, gen p mean: -0.4311290681362152, mean p set: 0.44812890887260437
The modified gen p mean: 0.4485163986682892, gen p mean: -0.4369179904460907, mean p set: 0.4489966928958893
loss_pred:0.03536279499530792, decouple_loss:0.029155317693948746
loss_pred:0.0356605090200901, decouple_loss:0.03000706434249878
loss_pred:0.0357026532292366, decouple_loss:0.029088294133543968
Iteration: 730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447090744972229, gen p mean: -0.4308154881000519, mean p set: 0.4475710391998291
The modified gen p mean: 0.44763848185539246, gen p mean: -0.4312187731266022, mean p set: 0.44811877608299255
The modified gen p mean: 0.44711461663246155, gen p mean: -0.42985063791275024, mean p set: 0.44759488105773926
loss_pred:0.034367866814136505, decouple_loss:0.029017988592386246
loss_pred:0.03421206772327423, decouple_loss:0.02874762937426567
loss_pred:0.03572581335902214, decouple_loss:0.028720617294311523
2023-05-02 19:02:21 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.4229431748390198, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.4289833903312683, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.418952614068985, mean p set: 0.45035696029663086
loss_pred:0.035488054156303406, decouple_loss:0.029771117493510246
loss_pred:0.03649038076400757, decouple_loss:0.03128886967897415
loss_pred:0.03458894044160843, decouple_loss:0.030328502878546715
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03704559803009033, avg_mse: 0.03929559513926506
current test mse: 0.039296
Iteration: 731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481067359447479, gen p mean: -0.4275139272212982, mean p set: 0.4485870599746704
The modified gen p mean: 0.4480278193950653, gen p mean: -0.4199829399585724, mean p set: 0.4485081434249878
loss_pred:0.033806927502155304, decouple_loss:0.02891739271581173
loss_pred:0.03528289496898651, decouple_loss:0.028950223699212074
The modified gen p mean: 0.4480270743370056, gen p mean: -0.4288085699081421, mean p set: 0.4485073983669281
loss_pred:0.034317027777433395, decouple_loss:0.029804890975356102
Iteration: 732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877690076828003, gen p mean: -0.4286114573478699, mean p set: 0.4492571949958801
The modified gen p mean: 0.44736185669898987, gen p mean: -0.4241570830345154, mean p set: 0.44784215092658997
The modified gen p mean: 0.4483753740787506, gen p mean: -0.42391231656074524, mean p set: 0.4488556683063507
loss_pred:0.03528972342610359, decouple_loss:0.03013518825173378
loss_pred:0.03506799414753914, decouple_loss:0.030558673664927483
loss_pred:0.035346969962120056, decouple_loss:0.028087733313441277
Iteration: 733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493856132030487, gen p mean: -0.43583065271377563, mean p set: 0.4498658776283264
The modified gen p mean: 0.4485977590084076, gen p mean: -0.4378841817378998, mean p set: 0.4490780532360077
The modified gen p mean: 0.44814610481262207, gen p mean: -0.43682125210762024, mean p set: 0.4486263692378998
loss_pred:0.035533588379621506, decouple_loss:0.02971201390028
loss_pred:0.03508660942316055, decouple_loss:0.028988763689994812
loss_pred:0.035254526883363724, decouple_loss:0.028759941458702087
Iteration: 734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477725327014923, gen p mean: -0.435017466545105, mean p set: 0.4482528567314148
The modified gen p mean: 0.4473004639148712, gen p mean: -0.4365933835506439, mean p set: 0.4477807283401489
The modified gen p mean: 0.44755682349205017, gen p mean: -0.4361433684825897, mean p set: 0.44803711771965027
loss_pred:0.034461840987205505, decouple_loss:0.029248801991343498
loss_pred:0.03573284670710564, decouple_loss:0.029457733035087585
loss_pred:0.035797253251075745, decouple_loss:0.029475847259163857
Iteration: 735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446932315826416, gen p mean: -0.4316076636314392, mean p set: 0.4474125802516937
The modified gen p mean: 0.4479582905769348, gen p mean: -0.430955708026886, mean p set: 0.4484385848045349
The modified gen p mean: 0.4477311670780182, gen p mean: -0.4342750310897827, mean p set: 0.4482114315032959
loss_pred:0.03439844027161598, decouple_loss:0.027556395158171654
loss_pred:0.03419369459152222, decouple_loss:0.028842180967330933
loss_pred:0.03447289392352104, decouple_loss:0.027868786826729774
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
NaN value num: 0
Iteration: 736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473387897014618, gen p mean: -0.4257398843765259, mean p set: 0.4478190541267395
The modified gen p mean: 0.4474272131919861, gen p mean: -0.43079110980033875, mean p set: 0.4479075074195862
The modified gen p mean: 0.44838833808898926, gen p mean: -0.4252956211566925, mean p set: 0.44886863231658936
loss_pred:0.03694771230220795, decouple_loss:0.030409419909119606
loss_pred:0.03572041168808937, decouple_loss:0.03131113573908806
loss_pred:0.036464352160692215, decouple_loss:0.03100772574543953
Iteration: 737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448513001203537, gen p mean: -0.4328318238258362, mean p set: 0.4489932656288147
The modified gen p mean: 0.4482339322566986, gen p mean: -0.43159711360931396, mean p set: 0.4487142562866211
The modified gen p mean: 0.4483610987663269, gen p mean: -0.42554590106010437, mean p set: 0.4488413631916046
loss_pred:0.03551347926259041, decouple_loss:0.030639242380857468
loss_pred:0.03767681494355202, decouple_loss:0.030326582491397858
loss_pred:0.036766499280929565, decouple_loss:0.030544793233275414
Iteration: 738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469981789588928, gen p mean: -0.4403904974460602, mean p set: 0.4474784731864929
The modified gen p mean: 0.44835129380226135, gen p mean: -0.43798312544822693, mean p set: 0.44883155822753906
The modified gen p mean: 0.4478350579738617, gen p mean: -0.440004825592041, mean p set: 0.4483153223991394
loss_pred:0.03638414666056633, decouple_loss:0.02894909493625164
loss_pred:0.03817713260650635, decouple_loss:0.030594412237405777
loss_pred:0.036315757781267166, decouple_loss:0.030526382848620415
Iteration: 739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476087689399719, gen p mean: -0.45420771837234497, mean p set: 0.44808903336524963
The modified gen p mean: 0.44805872440338135, gen p mean: -0.45081982016563416, mean p set: 0.44853898882865906
The modified gen p mean: 0.44765704870224, gen p mean: -0.4517578184604645, mean p set: 0.4481373429298401
loss_pred:0.03623569384217262, decouple_loss:0.03038994036614895
loss_pred:0.036798588931560516, decouple_loss:0.032143957912921906
loss_pred:0.03533682972192764, decouple_loss:0.03146521374583244
Iteration: 740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476569592952728, gen p mean: -0.44342541694641113, mean p set: 0.4481372833251953
The modified gen p mean: 0.4474430978298187, gen p mean: -0.4402413070201874, mean p set: 0.44792336225509644
The modified gen p mean: 0.44793784618377686, gen p mean: -0.44604578614234924, mean p set: 0.44841820001602173
loss_pred:0.038248274475336075, decouple_loss:0.030566129833459854
loss_pred:0.036366913467645645, decouple_loss:0.030268438160419464
loss_pred:0.034655824303627014, decouple_loss:0.03052370436489582
2023-05-02 19:06:44 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.4376600384712219, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.4314988851547241, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.4272167384624481, mean p set: 0.45035696029663086
loss_pred:0.03637661039829254, decouple_loss:0.0311629269272089
loss_pred:0.03550359606742859, decouple_loss:0.030191021040081978
loss_pred:0.03465326502919197, decouple_loss:0.030394820496439934
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03704030439257622, avg_mse: 0.03942936286330223
current test mse: 0.039429
Iteration: 741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479680359363556, gen p mean: -0.43598905205726624, mean p set: 0.4484483003616333
The modified gen p mean: 0.4488667845726013, gen p mean: -0.43744125962257385, mean p set: 0.4493470788002014
loss_pred:0.036370761692523956, decouple_loss:0.02914454974234104
loss_pred:0.03685261309146881, decouple_loss:0.03066321462392807
The modified gen p mean: 0.4476771950721741, gen p mean: -0.4393826723098755, mean p set: 0.44815748929977417
loss_pred:0.036894239485263824, decouple_loss:0.030587736517190933
Iteration: 742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44774752855300903, gen p mean: -0.42896005511283875, mean p set: 0.4482278525829315
The modified gen p mean: 0.44795748591423035, gen p mean: -0.42814216017723083, mean p set: 0.44843775033950806
The modified gen p mean: 0.4489613473415375, gen p mean: -0.42767268419265747, mean p set: 0.4494416415691376
loss_pred:0.03657159581780434, decouple_loss:0.029939284548163414
loss_pred:0.036617450416088104, decouple_loss:0.03049618750810623
loss_pred:0.03775075823068619, decouple_loss:0.030913718044757843
Iteration: 743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44850581884384155, gen p mean: -0.42874616384506226, mean p set: 0.44898611307144165
The modified gen p mean: 0.4481923580169678, gen p mean: -0.4215279221534729, mean p set: 0.44867268204689026
The modified gen p mean: 0.44839388132095337, gen p mean: -0.42281031608581543, mean p set: 0.44887417554855347
loss_pred:0.03669432923197746, decouple_loss:0.029705533757805824
loss_pred:0.03586933761835098, decouple_loss:0.0301523394882679
loss_pred:0.03510630130767822, decouple_loss:0.0297913309186697
Iteration: 744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475019574165344, gen p mean: -0.426608145236969, mean p set: 0.4479822516441345
The modified gen p mean: 0.4474293887615204, gen p mean: -0.4266441762447357, mean p set: 0.4479096829891205
The modified gen p mean: 0.4475322663784027, gen p mean: -0.4287366569042206, mean p set: 0.4480125904083252
loss_pred:0.037514038383960724, decouple_loss:0.029684793204069138
loss_pred:0.03678768128156662, decouple_loss:0.029634805396199226
loss_pred:0.03612978756427765, decouple_loss:0.029115473851561546
Iteration: 745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756460189819336, gen p mean: -0.42783620953559875, mean p set: 0.44804492592811584
The modified gen p mean: 0.44793975353240967, gen p mean: -0.43261486291885376, mean p set: 0.44842007756233215
The modified gen p mean: 0.44846221804618835, gen p mean: -0.4360310733318329, mean p set: 0.44894248247146606
loss_pred:0.03631964698433876, decouple_loss:0.029637085273861885
loss_pred:0.03605541214346886, decouple_loss:0.02813883312046528
loss_pred:0.03722463548183441, decouple_loss:0.02999419905245304
Iteration: 746, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846972823143005, gen p mean: -0.4335305988788605, mean p set: 0.44895002245903015
The modified gen p mean: 0.4480227828025818, gen p mean: -0.4294664263725281, mean p set: 0.4485030770301819
The modified gen p mean: 0.44836854934692383, gen p mean: -0.4280302822589874, mean p set: 0.4488488733768463
loss_pred:0.037306640297174454, decouple_loss:0.029274074360728264
loss_pred:0.035842958837747574, decouple_loss:0.030685532838106155
loss_pred:0.03757866844534874, decouple_loss:0.030734097585082054
Iteration: 747, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44891196489334106, gen p mean: -0.42811015248298645, mean p set: 0.4493922293186188
The modified gen p mean: 0.4472630023956299, gen p mean: -0.4188607633113861, mean p set: 0.44774329662323
The modified gen p mean: 0.44797036051750183, gen p mean: -0.4228420853614807, mean p set: 0.44845062494277954
loss_pred:0.03626147657632828, decouple_loss:0.030727872624993324
loss_pred:0.03577728942036629, decouple_loss:0.030258983373641968
loss_pred:0.03519769385457039, decouple_loss:0.028581198304891586
Iteration: 748, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701382517814636, gen p mean: -0.40664926171302795, mean p set: 0.4474940896034241
The modified gen p mean: 0.4486573338508606, gen p mean: -0.41381293535232544, mean p set: 0.4491376578807831
The modified gen p mean: 0.44729772210121155, gen p mean: -0.4151493012905121, mean p set: 0.44777801632881165
loss_pred:0.03617320954799652, decouple_loss:0.029298145323991776
loss_pred:0.03693731874227524, decouple_loss:0.028781410306692123
loss_pred:0.03555549308657646, decouple_loss:0.02806922420859337
Iteration: 749, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849759340286255, gen p mean: -0.41730135679244995, mean p set: 0.44897785782814026
The modified gen p mean: 0.44737720489501953, gen p mean: -0.4176042675971985, mean p set: 0.44785749912261963
The modified gen p mean: 0.4475162625312805, gen p mean: -0.417647123336792, mean p set: 0.447996586561203
loss_pred:0.035882461816072464, decouple_loss:0.0283947866410017
loss_pred:0.03629735857248306, decouple_loss:0.028304889798164368
loss_pred:0.03584573417901993, decouple_loss:0.028484582901000977
Iteration: 750, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476719796657562, gen p mean: -0.42946770787239075, mean p set: 0.4481523036956787
The modified gen p mean: 0.44901150465011597, gen p mean: -0.42946597933769226, mean p set: 0.44949179887771606
The modified gen p mean: 0.4482515752315521, gen p mean: -0.4232911467552185, mean p set: 0.4487318992614746
loss_pred:0.035540513694286346, decouple_loss:0.028422867879271507
loss_pred:0.03538113087415695, decouple_loss:0.030391309410333633
loss_pred:0.03644184395670891, decouple_loss:0.027407370507717133
2023-05-02 19:10:27 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.4313390851020813, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.4376787841320038, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.4279190003871918, mean p set: 0.45035696029663086
loss_pred:0.035242728888988495, decouple_loss:0.029860593378543854
loss_pred:0.03619442135095596, decouple_loss:0.030482107773423195
loss_pred:0.034545350819826126, decouple_loss:0.03049471601843834
WV_0_PC_1_EH_0_PS_40_6, loss: 0.036841459572315216, avg_mse: 0.03930940106511116
current test mse: 0.039309
Iteration: 751, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815874099731445, gen p mean: -0.4366905689239502, mean p set: 0.44863903522491455
The modified gen p mean: 0.44800901412963867, gen p mean: -0.4370817542076111, mean p set: 0.44848933815956116
loss_pred:0.035479482263326645, decouple_loss:0.02881786972284317
loss_pred:0.036234300583601, decouple_loss:0.02952009066939354
The modified gen p mean: 0.4477936625480652, gen p mean: -0.4356250762939453, mean p set: 0.4482739567756653
loss_pred:0.036001645028591156, decouple_loss:0.02813669852912426
Iteration: 752, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846266508102417, gen p mean: -0.43055999279022217, mean p set: 0.44894295930862427
The modified gen p mean: 0.4472518265247345, gen p mean: -0.43184319138526917, mean p set: 0.4477321207523346
The modified gen p mean: 0.44846928119659424, gen p mean: -0.4266722798347473, mean p set: 0.44894954562187195
loss_pred:0.03462836518883705, decouple_loss:0.028740793466567993
loss_pred:0.03720895200967789, decouple_loss:0.027790341526269913
loss_pred:0.03591600060462952, decouple_loss:0.02874986082315445
Iteration: 753, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478950798511505, gen p mean: -0.42962193489074707, mean p set: 0.4483753740787506
The modified gen p mean: 0.4488697052001953, gen p mean: -0.4290912449359894, mean p set: 0.449349969625473
The modified gen p mean: 0.4480712413787842, gen p mean: -0.42466795444488525, mean p set: 0.44855156540870667
loss_pred:0.033777981996536255, decouple_loss:0.03038792498409748
loss_pred:0.033960215747356415, decouple_loss:0.029483551159501076
loss_pred:0.03499119356274605, decouple_loss:0.029272984713315964
Iteration: 754, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447792649269104, gen p mean: -0.42813339829444885, mean p set: 0.4482729434967041
The modified gen p mean: 0.4473279118537903, gen p mean: -0.4318431615829468, mean p set: 0.4478082060813904
The modified gen p mean: 0.4477674961090088, gen p mean: -0.4293293058872223, mean p set: 0.4482477605342865
loss_pred:0.03574955090880394, decouple_loss:0.029373526573181152
loss_pred:0.03577176108956337, decouple_loss:0.027650486677885056
loss_pred:0.03589516878128052, decouple_loss:0.029453130438923836
Iteration: 755, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755542278289795, gen p mean: -0.4369495213031769, mean p set: 0.44803571701049805
The modified gen p mean: 0.44767841696739197, gen p mean: -0.4359252154827118, mean p set: 0.44815871119499207
The modified gen p mean: 0.44823214411735535, gen p mean: -0.43198758363723755, mean p set: 0.44871240854263306
loss_pred:0.03458290174603462, decouple_loss:0.02870327979326248
loss_pred:0.035788558423519135, decouple_loss:0.02839258871972561
loss_pred:0.036561038345098495, decouple_loss:0.028538813814520836
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 756, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44692403078079224, gen p mean: -0.4318123459815979, mean p set: 0.44740432500839233
The modified gen p mean: 0.44738298654556274, gen p mean: -0.4317071735858917, mean p set: 0.44786328077316284
The modified gen p mean: 0.44786643981933594, gen p mean: -0.4296781122684479, mean p set: 0.44834670424461365
loss_pred:0.034058429300785065, decouple_loss:0.029372870922088623
loss_pred:0.03519996255636215, decouple_loss:0.030119983479380608
loss_pred:0.034117940813302994, decouple_loss:0.029313726350665092
Iteration: 757, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44633227586746216, gen p mean: -0.4420550465583801, mean p set: 0.44681257009506226
The modified gen p mean: 0.44876816868782043, gen p mean: -0.44261541962623596, mean p set: 0.44924843311309814
The modified gen p mean: 0.4466509521007538, gen p mean: -0.44360509514808655, mean p set: 0.4471312463283539
loss_pred:0.034085143357515335, decouple_loss:0.02938856929540634loss_pred:0.03395698592066765, decouple_loss:0.030583031475543976
loss_pred:0.03391777724027634, decouple_loss:0.02988428622484207
Iteration: 758, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768601655960083, gen p mean: -0.44363921880722046, mean p set: 0.4481663107872009
The modified gen p mean: 0.44630932807922363, gen p mean: -0.4477991461753845, mean p set: 0.44678959250450134
The modified gen p mean: 0.44701990485191345, gen p mean: -0.44200602173805237, mean p set: 0.44750016927719116
loss_pred:0.035002436488866806, decouple_loss:0.02904750593006611
loss_pred:0.03421483933925629, decouple_loss:0.030339963734149933
loss_pred:0.03590478375554085, decouple_loss:0.030035559087991714
Iteration: 759, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470362365245819, gen p mean: -0.4378303289413452, mean p set: 0.447516530752182
The modified gen p mean: 0.4476753771305084, gen p mean: -0.4437887966632843, mean p set: 0.4481556713581085
The modified gen p mean: 0.4474863111972809, gen p mean: -0.44298848509788513, mean p set: 0.447966605424881
loss_pred:0.035584669560194016, decouple_loss:0.028839880600571632
loss_pred:0.034079890698194504, decouple_loss:0.0295216366648674
loss_pred:0.033148691058158875, decouple_loss:0.029129119589924812
Iteration: 760, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44613558053970337, gen p mean: -0.44062715768814087, mean p set: 0.4466158449649811
The modified gen p mean: 0.44737598299980164, gen p mean: -0.4446559250354767, mean p set: 0.44785624742507935
The modified gen p mean: 0.44670215249061584, gen p mean: -0.44558605551719666, mean p set: 0.44718244671821594
loss_pred:0.03382626548409462, decouple_loss:0.029302597045898438
loss_pred:0.03347941115498543, decouple_loss:0.02876274287700653
loss_pred:0.034049421548843384, decouple_loss:0.027394093573093414
2023-05-02 19:14:58 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.43865641951560974, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.4452584683895111, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.4355032742023468, mean p set: 0.45035696029663086
loss_pred:0.03484952822327614, decouple_loss:0.028948819264769554
loss_pred:0.035791438072919846, decouple_loss:0.029776960611343384
loss_pred:0.03409213945269585, decouple_loss:0.02970576100051403
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03638489544391632, avg_mse: 0.03874202445149422
current test mse: 0.038742
Iteration: 761, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466387629508972, gen p mean: -0.4455662965774536, mean p set: 0.4471190571784973
loss_pred:0.033574428409338, decouple_loss:0.02787235751748085
The modified gen p mean: 0.44645529985427856, gen p mean: -0.44595181941986084, mean p set: 0.44693562388420105
loss_pred:0.03369702771306038, decouple_loss:0.029273655265569687
The modified gen p mean: 0.4472388029098511, gen p mean: -0.4427125155925751, mean p set: 0.44771912693977356
loss_pred:0.034681618213653564, decouple_loss:0.02803812362253666
Iteration: 762, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44697317481040955, gen p mean: -0.43771862983703613, mean p set: 0.44745346903800964
The modified gen p mean: 0.4454604387283325, gen p mean: -0.44094473123550415, mean p set: 0.44594070315361023
The modified gen p mean: 0.44916799664497375, gen p mean: -0.4448728561401367, mean p set: 0.44964826107025146
loss_pred:0.0336148738861084, decouple_loss:0.028269680216908455
loss_pred:0.03534461185336113, decouple_loss:0.027876755222678185
loss_pred:0.03360029682517052, decouple_loss:0.02887899987399578
Iteration: 763, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478181302547455, gen p mean: -0.44357216358184814, mean p set: 0.44829845428466797
The modified gen p mean: 0.4461483955383301, gen p mean: -0.4416065216064453, mean p set: 0.4466286599636078
The modified gen p mean: 0.4468916654586792, gen p mean: -0.44056424498558044, mean p set: 0.4473719894886017
loss_pred:0.03341886028647423, decouple_loss:0.02974800206720829loss_pred:0.034207794815301895, decouple_loss:0.027924848720431328
loss_pred:0.034867849200963974, decouple_loss:0.028757628053426743
Iteration: 764, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473676085472107, gen p mean: -0.43559178709983826, mean p set: 0.4478478729724884
The modified gen p mean: 0.4466874897480011, gen p mean: -0.4305928349494934, mean p set: 0.4471677839756012
The modified gen p mean: 0.44655048847198486, gen p mean: -0.4333481788635254, mean p set: 0.44703078269958496
loss_pred:0.03346271812915802, decouple_loss:0.02829129248857498
loss_pred:0.03402428701519966, decouple_loss:0.02824198268353939
loss_pred:0.03469919040799141, decouple_loss:0.029467687010765076
Iteration: 765, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468054175376892, gen p mean: -0.4379575848579407, mean p set: 0.4472857117652893
The modified gen p mean: 0.44691750407218933, gen p mean: -0.4398747980594635, mean p set: 0.44739779829978943
The modified gen p mean: 0.44729194045066833, gen p mean: -0.43734022974967957, mean p set: 0.44777220487594604
loss_pred:0.03354004770517349, decouple_loss:0.02772155962884426
loss_pred:0.034435875713825226, decouple_loss:0.029698556289076805
loss_pred:0.034295301884412766, decouple_loss:0.028794392943382263
Iteration: 766, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717806577682495, gen p mean: -0.43237659335136414, mean p set: 0.44765836000442505
The modified gen p mean: 0.44827088713645935, gen p mean: -0.4352579116821289, mean p set: 0.44875115156173706
The modified gen p mean: 0.4467405080795288, gen p mean: -0.43265649676322937, mean p set: 0.4472208023071289
loss_pred:0.03395793214440346, decouple_loss:0.02900410257279873
loss_pred:0.03510427102446556, decouple_loss:0.02964111603796482
loss_pred:0.03361235558986664, decouple_loss:0.027989136055111885
Iteration: 767, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471035897731781, gen p mean: -0.4296695590019226, mean p set: 0.4475838840007782
The modified gen p mean: 0.446512371301651, gen p mean: -0.4260881543159485, mean p set: 0.4469926357269287
The modified gen p mean: 0.44844359159469604, gen p mean: -0.4259197413921356, mean p set: 0.44892388582229614
loss_pred:0.035416122525930405, decouple_loss:0.028234971687197685loss_pred:0.03408470377326012, decouple_loss:0.027965402230620384
loss_pred:0.035805944353342056, decouple_loss:0.02869270369410515
Iteration: 768, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480457603931427, gen p mean: -0.4281754791736603, mean p set: 0.4485260546207428
The modified gen p mean: 0.4475334584712982, gen p mean: -0.4285624027252197, mean p set: 0.4480137526988983
The modified gen p mean: 0.44827795028686523, gen p mean: -0.42884400486946106, mean p set: 0.44875821471214294
loss_pred:0.03526276722550392, decouple_loss:0.02836024947464466
loss_pred:0.03441368788480759, decouple_loss:0.027440203353762627
loss_pred:0.03550010174512863, decouple_loss:0.028033874928951263
Iteration: 769, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797664880752563, gen p mean: -0.44058892130851746, mean p set: 0.44845691323280334
The modified gen p mean: 0.4478625953197479, gen p mean: -0.4457573890686035, mean p set: 0.44834285974502563
The modified gen p mean: 0.4470798075199127, gen p mean: -0.4416743218898773, mean p set: 0.4475601017475128
loss_pred:0.03464963287115097, decouple_loss:0.028169943019747734
loss_pred:0.034122876822948456, decouple_loss:0.028208767995238304
loss_pred:0.03447113186120987, decouple_loss:0.02783706597983837
Iteration: 770, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469894468784332, gen p mean: -0.4488860070705414, mean p set: 0.4474697411060333
The modified gen p mean: 0.4455258548259735, gen p mean: -0.44936421513557434, mean p set: 0.4460061490535736
The modified gen p mean: 0.4455268383026123, gen p mean: -0.4448903799057007, mean p set: 0.44600710272789
loss_pred:0.03434114158153534, decouple_loss:0.028981080278754234loss_pred:0.03349946439266205, decouple_loss:0.027287380769848824
loss_pred:0.035032156854867935, decouple_loss:0.027712924405932426
2023-05-02 19:18:38 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.42924538254737854, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.43548348546028137, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.42580196261405945, mean p set: 0.45035696029663086
loss_pred:0.03468267619609833, decouple_loss:0.029074309393763542
loss_pred:0.035671863704919815, decouple_loss:0.030206868425011635
loss_pred:0.034080393612384796, decouple_loss:0.030259668827056885
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03630399331450462, avg_mse: 0.038730036467313766
current test mse: 0.03873
Iteration: 771, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714266061782837, gen p mean: -0.43667924404144287, mean p set: 0.44762295484542847
The modified gen p mean: 0.447671502828598, gen p mean: -0.4338899552822113, mean p set: 0.44815176725387573
loss_pred:0.034878622740507126, decouple_loss:0.028179718181490898
loss_pred:0.03387034311890602, decouple_loss:0.028364021331071854
The modified gen p mean: 0.4464106261730194, gen p mean: -0.4367222785949707, mean p set: 0.4468908905982971
loss_pred:0.03351135179400444, decouple_loss:0.028069349005818367
Iteration: 772, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661250710487366, gen p mean: -0.42496538162231445, mean p set: 0.44709280133247375
The modified gen p mean: 0.4475764334201813, gen p mean: -0.4274914264678955, mean p set: 0.448056697845459
The modified gen p mean: 0.44739699363708496, gen p mean: -0.42144203186035156, mean p set: 0.44787725806236267
loss_pred:0.03441285714507103, decouple_loss:0.02719739079475403
loss_pred:0.03391443192958832, decouple_loss:0.028417937457561493
loss_pred:0.03533535450696945, decouple_loss:0.02777457982301712
Iteration: 773, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458523094654083, gen p mean: -0.42889800667762756, mean p set: 0.4463326036930084
The modified gen p mean: 0.4487743079662323, gen p mean: -0.42893123626708984, mean p set: 0.4492546021938324
The modified gen p mean: 0.4465515613555908, gen p mean: -0.4270491898059845, mean p set: 0.4470318555831909
loss_pred:0.032630037516355515, decouple_loss:0.02719089947640896
loss_pred:0.033628370612859726, decouple_loss:0.02789497748017311
loss_pred:0.03331600874662399, decouple_loss:0.028418729081749916
Iteration: 774, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44925034046173096, gen p mean: -0.43714287877082825, mean p set: 0.44973060488700867
The modified gen p mean: 0.44839709997177124, gen p mean: -0.4343145191669464, mean p set: 0.44887736439704895
The modified gen p mean: 0.44735249876976013, gen p mean: -0.43299400806427, mean p set: 0.44783279299736023
loss_pred:0.03356202319264412, decouple_loss:0.028873497620224953
loss_pred:0.034254785627126694, decouple_loss:0.02810029685497284
loss_pred:0.03348162770271301, decouple_loss:0.028646863996982574
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 775, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448159784078598, gen p mean: -0.44346529245376587, mean p set: 0.44864004850387573
The modified gen p mean: 0.447029709815979, gen p mean: -0.44690731167793274, mean p set: 0.4475100040435791
The modified gen p mean: 0.44644027948379517, gen p mean: -0.4484789967536926, mean p set: 0.44692057371139526
loss_pred:0.03435484319925308, decouple_loss:0.027486560866236687
loss_pred:0.033246319741010666, decouple_loss:0.027271417900919914
loss_pred:0.03427920863032341, decouple_loss:0.027997063472867012
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
NaN value num: 0
Iteration: 776, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513065814971924, gen p mean: -0.43985676765441895, mean p set: 0.4517868459224701
The modified gen p mean: 0.45320364832878113, gen p mean: -0.44776642322540283, mean p set: 0.4536839425563812
The modified gen p mean: 0.45410701632499695, gen p mean: -0.44093284010887146, mean p set: 0.45458728075027466
loss_pred:0.03453277796506882, decouple_loss:0.03414952754974365
loss_pred:0.03733063489198685, decouple_loss:0.03374836966395378
loss_pred:0.03538357466459274, decouple_loss:0.0344521664083004
Iteration: 777, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45272377133369446, gen p mean: -0.446158766746521, mean p set: 0.45320409536361694
The modified gen p mean: 0.4515909254550934, gen p mean: -0.4417780041694641, mean p set: 0.4520712196826935
The modified gen p mean: 0.4542931020259857, gen p mean: -0.44423598051071167, mean p set: 0.4547733962535858
loss_pred:0.03484567999839783, decouple_loss:0.03250127285718918
loss_pred:0.03450997546315193, decouple_loss:0.032631609588861465
loss_pred:0.03619399294257164, decouple_loss:0.033592257648706436
Iteration: 778, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45199093222618103, gen p mean: -0.44861117005348206, mean p set: 0.45247119665145874
The modified gen p mean: 0.4516843557357788, gen p mean: -0.4452632665634155, mean p set: 0.4521646797657013
The modified gen p mean: 0.452714741230011, gen p mean: -0.44825705885887146, mean p set: 0.4531950354576111
loss_pred:0.03599902242422104, decouple_loss:0.034792959690093994
loss_pred:0.03421640023589134, decouple_loss:0.03333954140543938
loss_pred:0.03588582202792168, decouple_loss:0.0339176170527935
Iteration: 779, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525854289531708, gen p mean: -0.44907552003860474, mean p set: 0.4530657231807709
The modified gen p mean: 0.45416387915611267, gen p mean: -0.4460639953613281, mean p set: 0.45464417338371277
The modified gen p mean: 0.4533917009830475, gen p mean: -0.4474206864833832, mean p set: 0.4538719952106476
loss_pred:0.03336288779973984, decouple_loss:0.032829202711582184
loss_pred:0.0363469161093235, decouple_loss:0.032120443880558014
loss_pred:0.035699259489774704, decouple_loss:0.03226269781589508
Iteration: 780, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524298310279846, gen p mean: -0.45155125856399536, mean p set: 0.4529101252555847
The modified gen p mean: 0.452451229095459, gen p mean: -0.4511606693267822, mean p set: 0.4529314935207367
The modified gen p mean: 0.4525229036808014, gen p mean: -0.4539216458797455, mean p set: 0.4530031979084015
loss_pred:0.0336996465921402, decouple_loss:0.033081237226724625
loss_pred:0.03334865719079971, decouple_loss:0.032452408224344254
loss_pred:0.035608720034360886, decouple_loss:0.033826570957899094
2023-05-02 19:23:17 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.4640996754169464, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.457907110452652, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.4542383551597595, mean p set: 0.45035696029663086
loss_pred:0.03635106608271599, decouple_loss:0.033853475004434586
loss_pred:0.03520449995994568, decouple_loss:0.03185263276100159
loss_pred:0.03443722799420357, decouple_loss:0.03268277272582054
WV_0_PC_1_EH_0_PS_40_6, loss: 0.036970749497413635, avg_mse: 0.0396336130797863
current test mse: 0.039634
Iteration: 781, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45134809613227844, gen p mean: -0.45818015933036804, mean p set: 0.4518284201622009
The modified gen p mean: 0.453250527381897, gen p mean: -0.46482160687446594, mean p set: 0.45373082160949707
loss_pred:0.03473079949617386, decouple_loss:0.03180665895342827
loss_pred:0.03287205472588539, decouple_loss:0.032468389719724655
The modified gen p mean: 0.4527265727519989, gen p mean: -0.46038585901260376, mean p set: 0.453206866979599
loss_pred:0.03232446685433388, decouple_loss:0.03136082738637924
Iteration: 782, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520866572856903, gen p mean: -0.44986361265182495, mean p set: 0.4525669813156128
The modified gen p mean: 0.4535498023033142, gen p mean: -0.45074376463890076, mean p set: 0.4540300667285919
The modified gen p mean: 0.45311427116394043, gen p mean: -0.4544517993927002, mean p set: 0.4535945653915405
loss_pred:0.03570439666509628, decouple_loss:0.033111002296209335
loss_pred:0.03375118970870972, decouple_loss:0.031102310866117477
loss_pred:0.03225554898381233, decouple_loss:0.031662337481975555
Iteration: 783, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45274269580841064, gen p mean: -0.43910881876945496, mean p set: 0.45322301983833313
The modified gen p mean: 0.452231764793396, gen p mean: -0.4342294931411743, mean p set: 0.4527120590209961
The modified gen p mean: 0.4513419568538666, gen p mean: -0.43158525228500366, mean p set: 0.4518222510814667
loss_pred:0.033013299107551575, decouple_loss:0.03156553581357002
loss_pred:0.03557092696428299, decouple_loss:0.03227388113737106
loss_pred:0.03523699566721916, decouple_loss:0.03138608857989311
Iteration: 784, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526849389076233, gen p mean: -0.4431963860988617, mean p set: 0.4531652331352234
The modified gen p mean: 0.45301079750061035, gen p mean: -0.446845144033432, mean p set: 0.45349109172821045
The modified gen p mean: 0.4525592029094696, gen p mean: -0.44405826926231384, mean p set: 0.4530394971370697
loss_pred:0.03502029553055763, decouple_loss:0.031006354838609695
loss_pred:0.034737423062324524, decouple_loss:0.031926628202199936
loss_pred:0.034078896045684814, decouple_loss:0.030864272266626358
Iteration: 785, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533199667930603, gen p mean: -0.4712768495082855, mean p set: 0.4538002610206604
The modified gen p mean: 0.452146053314209, gen p mean: -0.4659803807735443, mean p set: 0.45262637734413147
The modified gen p mean: 0.45484495162963867, gen p mean: -0.4600183963775635, mean p set: 0.4553252160549164
loss_pred:0.0357041098177433, decouple_loss:0.0319974422454834
loss_pred:0.035517118871212006, decouple_loss:0.03274426981806755
loss_pred:0.03586553782224655, decouple_loss:0.03224958851933479
Iteration: 786, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45179280638694763, gen p mean: -0.4683113694190979, mean p set: 0.45227310061454773
The modified gen p mean: 0.4527721405029297, gen p mean: -0.4708620607852936, mean p set: 0.4532524347305298
The modified gen p mean: 0.45320218801498413, gen p mean: -0.4694981575012207, mean p set: 0.45368245244026184
loss_pred:0.036799781024456024, decouple_loss:0.03318614885210991
loss_pred:0.03331821784377098, decouple_loss:0.032622940838336945
loss_pred:0.034215427935123444, decouple_loss:0.031961001455783844
Iteration: 787, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45210444927215576, gen p mean: -0.44951915740966797, mean p set: 0.45258474349975586
The modified gen p mean: 0.4531158208847046, gen p mean: -0.45845940709114075, mean p set: 0.4535960853099823
The modified gen p mean: 0.4520016610622406, gen p mean: -0.4530830383300781, mean p set: 0.4524819552898407
loss_pred:0.03605840355157852, decouple_loss:0.031957536935806274
loss_pred:0.03651122748851776, decouple_loss:0.033086612820625305
loss_pred:0.03556261211633682, decouple_loss:0.03198978677392006
Iteration: 788, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45377805829048157, gen p mean: -0.4329964816570282, mean p set: 0.45425835251808167
The modified gen p mean: 0.45305269956588745, gen p mean: -0.44397950172424316, mean p set: 0.45353299379348755
The modified gen p mean: 0.4527815580368042, gen p mean: -0.4455662965774536, mean p set: 0.4532618522644043
loss_pred:0.03551439940929413, decouple_loss:0.030512459576129913
loss_pred:0.035760827362537384, decouple_loss:0.03151091933250427
loss_pred:0.03614116832613945, decouple_loss:0.03211493045091629
Iteration: 789, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518902897834778, gen p mean: -0.4464932978153229, mean p set: 0.4523705840110779
The modified gen p mean: 0.45313456654548645, gen p mean: -0.45755651593208313, mean p set: 0.45361486077308655
The modified gen p mean: 0.4524059295654297, gen p mean: -0.4526350796222687, mean p set: 0.4528862237930298
loss_pred:0.03384332358837128, decouple_loss:0.031137721613049507
loss_pred:0.03303439915180206, decouple_loss:0.03140805661678314
loss_pred:0.03365776315331459, decouple_loss:0.03075406141579151
Iteration: 790, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529091417789459, gen p mean: -0.47694331407546997, mean p set: 0.45338940620422363
The modified gen p mean: 0.45231375098228455, gen p mean: -0.4720613956451416, mean p set: 0.45279404520988464
The modified gen p mean: 0.4519041180610657, gen p mean: -0.46662187576293945, mean p set: 0.45238441228866577
loss_pred:0.035186219960451126, decouple_loss:0.030576011165976524
loss_pred:0.03545507788658142, decouple_loss:0.03147096559405327
loss_pred:0.03293049335479736, decouple_loss:0.03153413161635399
2023-05-02 19:27:01 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.4688016176223755, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.47596824169158936, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.4647933840751648, mean p set: 0.45035696029663086
loss_pred:0.03511824831366539, decouple_loss:0.032336220145225525
loss_pred:0.03616970404982567, decouple_loss:0.03450284153223038
loss_pred:0.03434564918279648, decouple_loss:0.03334084525704384
WV_0_PC_1_EH_0_PS_40_6, loss: 0.036880865693092346, avg_mse: 0.0396231971681118
current test mse: 0.039623
Iteration: 791, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536376893520355, gen p mean: -0.4762548804283142, mean p set: 0.45411795377731323
loss_pred:0.032228562980890274, decouple_loss:0.03156106173992157
The modified gen p mean: 0.4516180157661438, gen p mean: -0.46935492753982544, mean p set: 0.4520983099937439
loss_pred:0.03628522530198097, decouple_loss:0.031087590381503105
The modified gen p mean: 0.4529833197593689, gen p mean: -0.47487878799438477, mean p set: 0.4534636437892914
loss_pred:0.03636615723371506, decouple_loss:0.03144679591059685
Iteration: 792, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45237550139427185, gen p mean: -0.4465023875236511, mean p set: 0.45285579562187195
The modified gen p mean: 0.45121005177497864, gen p mean: -0.45227593183517456, mean p set: 0.45169031620025635
The modified gen p mean: 0.4519331455230713, gen p mean: -0.4572564959526062, mean p set: 0.4524134397506714
loss_pred:0.03530984744429588, decouple_loss:0.030599188059568405
loss_pred:0.034485600888729095, decouple_loss:0.031200936064124107
loss_pred:0.03335953876376152, decouple_loss:0.030613316223025322
Iteration: 793, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519527554512024, gen p mean: -0.4491206109523773, mean p set: 0.4524330198764801
The modified gen p mean: 0.452241986989975, gen p mean: -0.4550122916698456, mean p set: 0.4527222514152527
The modified gen p mean: 0.4518020749092102, gen p mean: -0.44638243317604065, mean p set: 0.4522823691368103
loss_pred:0.03443392366170883, decouple_loss:0.03076201118528843
loss_pred:0.03426152467727661, decouple_loss:0.028935685753822327
loss_pred:0.03361690789461136, decouple_loss:0.030951907858252525
Iteration: 794, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45258504152297974, gen p mean: -0.47009357810020447, mean p set: 0.45306530594825745
The modified gen p mean: 0.4525388479232788, gen p mean: -0.4689956605434418, mean p set: 0.4530191123485565
The modified gen p mean: 0.4525115191936493, gen p mean: -0.46744272112846375, mean p set: 0.4529918134212494
loss_pred:0.0319272056221962, decouple_loss:0.02943228930234909
loss_pred:0.03536238521337509, decouple_loss:0.030606362968683243
loss_pred:0.03570782020688057, decouple_loss:0.03139391168951988
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
NaN value num: 0
Iteration: 795, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492076337337494, gen p mean: -0.48803094029426575, mean p set: 0.4496879279613495
The modified gen p mean: 0.45119035243988037, gen p mean: -0.4965200126171112, mean p set: 0.45167064666748047
The modified gen p mean: 0.4483369290828705, gen p mean: -0.48749175667762756, mean p set: 0.4488172233104706
loss_pred:0.03352690488100052, decouple_loss:0.03204804286360741
loss_pred:0.03538327291607857, decouple_loss:0.03295920044183731
loss_pred:0.037155792117118835, decouple_loss:0.032721858471632004
Iteration: 796, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45087891817092896, gen p mean: -0.5011045932769775, mean p set: 0.45135921239852905
The modified gen p mean: 0.45056188106536865, gen p mean: -0.5016960501670837, mean p set: 0.45104217529296875
The modified gen p mean: 0.4506039321422577, gen p mean: -0.4976154863834381, mean p set: 0.4510842561721802
loss_pred:0.03406965732574463, decouple_loss:0.03181904926896095
loss_pred:0.03461175784468651, decouple_loss:0.03171936795115471
loss_pred:0.0335250161588192, decouple_loss:0.03114943765103817
Iteration: 797, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494740962982178, gen p mean: -0.48183727264404297, mean p set: 0.4499543607234955
The modified gen p mean: 0.4517207741737366, gen p mean: -0.49238818883895874, mean p set: 0.45220106840133667
The modified gen p mean: 0.45081281661987305, gen p mean: -0.48732244968414307, mean p set: 0.45129311084747314
loss_pred:0.033458441495895386, decouple_loss:0.029879244044423103
loss_pred:0.03465977683663368, decouple_loss:0.03185347467660904
loss_pred:0.0333528108894825, decouple_loss:0.030815819278359413
Iteration: 798, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45095589756965637, gen p mean: -0.4755396246910095, mean p set: 0.4514361619949341
The modified gen p mean: 0.4504566490650177, gen p mean: -0.47024768590927124, mean p set: 0.4509369432926178
The modified gen p mean: 0.4518822729587555, gen p mean: -0.4750159978866577, mean p set: 0.4523625671863556
loss_pred:0.033105745911598206, decouple_loss:0.031179549172520638
loss_pred:0.033979613333940506, decouple_loss:0.03223362937569618
loss_pred:0.03606555610895157, decouple_loss:0.031669583171606064
Iteration: 799, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45096805691719055, gen p mean: -0.4740818738937378, mean p set: 0.45144835114479065
The modified gen p mean: 0.45176172256469727, gen p mean: -0.47557568550109863, mean p set: 0.45224204659461975
The modified gen p mean: 0.4494269788265228, gen p mean: -0.47157400846481323, mean p set: 0.4499072730541229
loss_pred:0.03374069184064865, decouple_loss:0.029902471229434013
loss_pred:0.034154050052165985, decouple_loss:0.03027164377272129
loss_pred:0.03227746859192848, decouple_loss:0.029170610010623932
Iteration: 800, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514085352420807, gen p mean: -0.47792771458625793, mean p set: 0.4518887996673584
The modified gen p mean: 0.45200175046920776, gen p mean: -0.4796432852745056, mean p set: 0.45248204469680786
The modified gen p mean: 0.44941446185112, gen p mean: -0.4746983051300049, mean p set: 0.4498947560787201
loss_pred:0.03302766755223274, decouple_loss:0.02967771142721176
loss_pred:0.03309352695941925, decouple_loss:0.030880987644195557
loss_pred:0.03533999249339104, decouple_loss:0.031128842383623123
2023-05-02 19:31:23 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.4726846516132355, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.4799692928791046, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987669587135315, gen p mean: -0.46895840764045715, mean p set: 0.45035696029663086
loss_pred:0.03501131385564804, decouple_loss:0.03201952576637268
loss_pred:0.03606070578098297, decouple_loss:0.033417753875255585
loss_pred:0.034257322549819946, decouple_loss:0.0332014262676239
WV_0_PC_1_EH_0_PS_40_6, loss: 0.036753758788108826, avg_mse: 0.03946680203080177
current test mse: 0.039467
Iteration: 801, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45204994082450867, gen p mean: -0.4824501872062683, mean p set: 0.45253023505210876
The modified gen p mean: 0.44994574785232544, gen p mean: -0.47392985224723816, mean p set: 0.4504260718822479
loss_pred:0.034279897809028625, decouple_loss:0.03061055764555931
loss_pred:0.035514216870069504, decouple_loss:0.031140783801674843
The modified gen p mean: 0.45009326934814453, gen p mean: -0.47424083948135376, mean p set: 0.45057356357574463
loss_pred:0.036449603736400604, decouple_loss:0.030325932428240776
Iteration: 802, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509980082511902, gen p mean: -0.47188395261764526, mean p set: 0.4514783024787903
The modified gen p mean: 0.45236870646476746, gen p mean: -0.4787512719631195, mean p set: 0.45284903049468994
The modified gen p mean: 0.45180249214172363, gen p mean: -0.47288957238197327, mean p set: 0.45228278636932373
loss_pred:0.03588814660906792, decouple_loss:0.03233806788921356
loss_pred:0.03556080535054207, decouple_loss:0.031655970960855484
loss_pred:0.03256625682115555, decouple_loss:0.030394256114959717
Iteration: 803, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45169538259506226, gen p mean: -0.4730953276157379, mean p set: 0.45217567682266235
The modified gen p mean: 0.452678382396698, gen p mean: -0.47713375091552734, mean p set: 0.4531586468219757
The modified gen p mean: 0.4518599510192871, gen p mean: -0.4836643934249878, mean p set: 0.4523402452468872
loss_pred:0.03406274691224098, decouple_loss:0.02989800088107586
loss_pred:0.03379596769809723, decouple_loss:0.029831796884536743
loss_pred:0.03428187593817711, decouple_loss:0.03150384500622749
Iteration: 804, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45196449756622314, gen p mean: -0.4783937931060791, mean p set: 0.45244479179382324
The modified gen p mean: 0.4514044225215912, gen p mean: -0.46928173303604126, mean p set: 0.4518847167491913
The modified gen p mean: 0.4509517252445221, gen p mean: -0.4688478410243988, mean p set: 0.4514320194721222
loss_pred:0.03394725173711777, decouple_loss:0.030078649520874023
loss_pred:0.033241089433431625, decouple_loss:0.02937997132539749
loss_pred:0.03478506579995155, decouple_loss:0.030979635193943977
Iteration: 805, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45157966017723083, gen p mean: -0.46298858523368835, mean p set: 0.45205995440483093
The modified gen p mean: 0.4505166709423065, gen p mean: -0.46863752603530884, mean p set: 0.45099693536758423
The modified gen p mean: 0.4513819217681885, gen p mean: -0.4665703773498535, mean p set: 0.4518622159957886
loss_pred:0.03397779539227486, decouple_loss:0.030791079625487328
loss_pred:0.033551175147295, decouple_loss:0.02946779876947403
loss_pred:0.035031288862228394, decouple_loss:0.02958044409751892
Iteration: 806, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45097026228904724, gen p mean: -0.47349482774734497, mean p set: 0.4514505863189697
The modified gen p mean: 0.4497229754924774, gen p mean: -0.46773451566696167, mean p set: 0.4502032399177551
The modified gen p mean: 0.44912153482437134, gen p mean: -0.4680328667163849, mean p set: 0.44960182905197144
loss_pred:0.03379194810986519, decouple_loss:0.029949674382805824
loss_pred:0.035795748233795166, decouple_loss:0.031739410012960434
loss_pred:0.036195721477270126, decouple_loss:0.03221498057246208
Iteration: 807, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45087841153144836, gen p mean: -0.48620152473449707, mean p set: 0.4513586759567261
The modified gen p mean: 0.4503439962863922, gen p mean: -0.4723629951477051, mean p set: 0.4508242905139923
The modified gen p mean: 0.45126044750213623, gen p mean: -0.47933661937713623, mean p set: 0.45174074172973633
loss_pred:0.03331797569990158, decouple_loss:0.029485002160072327
loss_pred:0.03361067175865173, decouple_loss:0.029843522235751152
loss_pred:0.033199407160282135, decouple_loss:0.028789082542061806
Iteration: 808, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45077645778656006, gen p mean: -0.47980326414108276, mean p set: 0.45125675201416016
The modified gen p mean: 0.4504815340042114, gen p mean: -0.4787234365940094, mean p set: 0.45096179842948914
The modified gen p mean: 0.45023053884506226, gen p mean: -0.4834621846675873, mean p set: 0.45071083307266235
loss_pred:0.03346303105354309, decouple_loss:0.03034338355064392
loss_pred:0.03447951003909111, decouple_loss:0.030908942222595215
loss_pred:0.03322746604681015, decouple_loss:0.028420481830835342
Iteration: 809, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45139259099960327, gen p mean: -0.49469107389450073, mean p set: 0.45187288522720337
The modified gen p mean: 0.45099037885665894, gen p mean: -0.4892817437648773, mean p set: 0.45147067308425903
The modified gen p mean: 0.4508303999900818, gen p mean: -0.4865924119949341, mean p set: 0.4513106644153595
loss_pred:0.03441164642572403, decouple_loss:0.029888246208429337
loss_pred:0.03454868122935295, decouple_loss:0.030396806076169014
loss_pred:0.03281225636601448, decouple_loss:0.02768913470208645
Iteration: 810, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505453109741211, gen p mean: -0.4783609211444855, mean p set: 0.4510255753993988
The modified gen p mean: 0.4500580132007599, gen p mean: -0.4784088730812073, mean p set: 0.45053830742836
The modified gen p mean: 0.4521511495113373, gen p mean: -0.48653414845466614, mean p set: 0.4526314437389374
loss_pred:0.03391913324594498, decouple_loss:0.03039051592350006
loss_pred:0.03347582742571831, decouple_loss:0.02828283980488777
loss_pred:0.03409067541360855, decouple_loss:0.029832087457180023
2023-05-02 19:35:06 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.4748428165912628, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.46832603216171265, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.4645071029663086, mean p set: 0.45035696029663086
loss_pred:0.03565918281674385, decouple_loss:0.03316201642155647
loss_pred:0.03395150229334831, decouple_loss:0.033006493002176285loss_pred:0.03470975533127785, decouple_loss:0.03137451037764549
WV_0_PC_1_EH_0_PS_40_6, loss: 0.036399200558662415, avg_mse: 0.039027485996484756
current test mse: 0.039027
Iteration: 811, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512881934642792, gen p mean: -0.4785638153553009, mean p set: 0.4517684876918793
The modified gen p mean: 0.4505424499511719, gen p mean: -0.47346800565719604, mean p set: 0.4510226845741272
loss_pred:0.03317475691437721, decouple_loss:0.029570169746875763
loss_pred:0.03331468626856804, decouple_loss:0.028999652713537216
The modified gen p mean: 0.45067211985588074, gen p mean: -0.4734218418598175, mean p set: 0.4511524438858032
loss_pred:0.03518388047814369, decouple_loss:0.029923655092716217
Iteration: 812, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501146972179413, gen p mean: -0.4639778435230255, mean p set: 0.4505949914455414
The modified gen p mean: 0.45327427983283997, gen p mean: -0.4737878739833832, mean p set: 0.45375457406044006
The modified gen p mean: 0.4490741789340973, gen p mean: -0.46583670377731323, mean p set: 0.449554443359375
loss_pred:0.03459130600094795, decouple_loss:0.029355982318520546
loss_pred:0.035438768565654755, decouple_loss:0.028718318790197372
loss_pred:0.03637230023741722, decouple_loss:0.028826631605625153
Iteration: 813, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45314085483551025, gen p mean: -0.4777742922306061, mean p set: 0.45362117886543274
The modified gen p mean: 0.4510155916213989, gen p mean: -0.4640999436378479, mean p set: 0.45149585604667664
The modified gen p mean: 0.45169195532798767, gen p mean: -0.47675225138664246, mean p set: 0.45217224955558777
loss_pred:0.03512607142329216, decouple_loss:0.02901778556406498
loss_pred:0.033419106155633926, decouple_loss:0.02760205790400505
loss_pred:0.03378574177622795, decouple_loss:0.029487473890185356
Iteration: 814, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503093957901001, gen p mean: -0.48484691977500916, mean p set: 0.4507897198200226
The modified gen p mean: 0.4503181278705597, gen p mean: -0.48194587230682373, mean p set: 0.4507984220981598
The modified gen p mean: 0.44968998432159424, gen p mean: -0.48427677154541016, mean p set: 0.4501703083515167
loss_pred:0.03282690793275833, decouple_loss:0.028323816135525703
loss_pred:0.0353776253759861, decouple_loss:0.029528316110372543
loss_pred:0.031995564699172974, decouple_loss:0.028629112988710403
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
NaN value num: 0
Iteration: 815, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499530494213104, gen p mean: -0.49949368834495544, mean p set: 0.4504333436489105
The modified gen p mean: 0.44956454634666443, gen p mean: -0.511039674282074, mean p set: 0.4500448405742645
The modified gen p mean: 0.45009303092956543, gen p mean: -0.5035006999969482, mean p set: 0.45057329535484314
loss_pred:0.03419926390051842, decouple_loss:0.03135963901877403
loss_pred:0.035939764231443405, decouple_loss:0.030480489134788513
loss_pred:0.033099740743637085, decouple_loss:0.030869904905557632
Iteration: 816, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755303859710693, gen p mean: -0.49391236901283264, mean p set: 0.44803333282470703
The modified gen p mean: 0.4486565887928009, gen p mean: -0.49641478061676025, mean p set: 0.449136883020401
The modified gen p mean: 0.45162808895111084, gen p mean: -0.5129789113998413, mean p set: 0.4521084129810333
loss_pred:0.03286150470376015, decouple_loss:0.03118661604821682
loss_pred:0.034962717443704605, decouple_loss:0.030033783987164497
loss_pred:0.03438344597816467, decouple_loss:0.031363993883132935
Iteration: 817, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45136386156082153, gen p mean: -0.4874018728733063, mean p set: 0.45184415578842163
The modified gen p mean: 0.44778576493263245, gen p mean: -0.4718966782093048, mean p set: 0.44826605916023254
The modified gen p mean: 0.4491461515426636, gen p mean: -0.473486989736557, mean p set: 0.44962644577026367
loss_pred:0.03279687836766243, decouple_loss:0.030536102131009102
loss_pred:0.03540203347802162, decouple_loss:0.03120134398341179
loss_pred:0.034532513469457626, decouple_loss:0.03118572011590004
Iteration: 818, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45025694370269775, gen p mean: -0.4675801396369934, mean p set: 0.45073726773262024
The modified gen p mean: 0.4501053988933563, gen p mean: -0.46930909156799316, mean p set: 0.4505856931209564
The modified gen p mean: 0.44999948143959045, gen p mean: -0.4661368429660797, mean p set: 0.45047977566719055
loss_pred:0.03411248326301575, decouple_loss:0.030293311923742294
loss_pred:0.03355538845062256, decouple_loss:0.02998054027557373
loss_pred:0.03245322406291962, decouple_loss:0.02925179712474346
Iteration: 819, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491357207298279, gen p mean: -0.4693978428840637, mean p set: 0.44961604475975037
The modified gen p mean: 0.44916102290153503, gen p mean: -0.4700675308704376, mean p set: 0.4496413469314575
The modified gen p mean: 0.4499646723270416, gen p mean: -0.4751844108104706, mean p set: 0.4504449665546417
loss_pred:0.03351235017180443, decouple_loss:0.029193859547376633
loss_pred:0.03545421361923218, decouple_loss:0.029345210641622543
loss_pred:0.03449668362736702, decouple_loss:0.02922552451491356
Iteration: 820, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481247663497925, gen p mean: -0.47041186690330505, mean p set: 0.4486050307750702
The modified gen p mean: 0.4522785544395447, gen p mean: -0.48432815074920654, mean p set: 0.4527588486671448
The modified gen p mean: 0.4508529603481293, gen p mean: -0.47827523946762085, mean p set: 0.45133325457572937
loss_pred:0.03506036102771759, decouple_loss:0.029224645346403122
loss_pred:0.03383469581604004, decouple_loss:0.030147889629006386
loss_pred:0.034738119691610336, decouple_loss:0.029955293983221054
2023-05-02 19:39:31 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.4885154664516449, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.4964748024940491, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.4836020767688751, mean p set: 0.45035696029663086
loss_pred:0.03461601957678795, decouple_loss:0.03165590018033981
loss_pred:0.035807229578495026, decouple_loss:0.03270113468170166
loss_pred:0.03383450210094452, decouple_loss:0.032403815537691116
WV_0_PC_1_EH_0_PS_40_6, loss: 0.036365266889333725, avg_mse: 0.03902687877416611
current test mse: 0.039027
Iteration: 821, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498324692249298, gen p mean: -0.49125808477401733, mean p set: 0.4503127932548523
The modified gen p mean: 0.44807860255241394, gen p mean: -0.4784960150718689, mean p set: 0.44855889678001404
loss_pred:0.03185354918241501, decouple_loss:0.028387701138854027
loss_pred:0.03457339480519295, decouple_loss:0.032335106283426285
The modified gen p mean: 0.450407475233078, gen p mean: -0.5038700103759766, mean p set: 0.4508877694606781
loss_pred:0.0343952551484108, decouple_loss:0.031082937493920326
Iteration: 822, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448701411485672, gen p mean: -0.4802198112010956, mean p set: 0.4491817057132721
The modified gen p mean: 0.44821226596832275, gen p mean: -0.47887516021728516, mean p set: 0.44869256019592285
The modified gen p mean: 0.44841107726097107, gen p mean: -0.48146262764930725, mean p set: 0.44889137148857117
loss_pred:0.03327430784702301, decouple_loss:0.0326974131166935
loss_pred:0.033488769084215164, decouple_loss:0.0317457914352417
loss_pred:0.03448489308357239, decouple_loss:0.02866334654390812
Iteration: 823, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45137134194374084, gen p mean: -0.48020872473716736, mean p set: 0.45185160636901855
The modified gen p mean: 0.4492734670639038, gen p mean: -0.48738428950309753, mean p set: 0.4497537314891815
The modified gen p mean: 0.45008373260498047, gen p mean: -0.48920512199401855, mean p set: 0.45056405663490295
loss_pred:0.034553512930870056, decouple_loss:0.02970477007329464
loss_pred:0.033601000905036926, decouple_loss:0.02997974492609501
loss_pred:0.0345955565571785, decouple_loss:0.03134138509631157
Iteration: 824, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835230708122253, gen p mean: -0.4685410261154175, mean p set: 0.44883257150650024
The modified gen p mean: 0.4515320658683777, gen p mean: -0.4796718657016754, mean p set: 0.4520123302936554
The modified gen p mean: 0.44928550720214844, gen p mean: -0.4739862382411957, mean p set: 0.44976580142974854
loss_pred:0.03304007649421692, decouple_loss:0.030552754178643227
loss_pred:0.03270498663187027, decouple_loss:0.028397979214787483
loss_pred:0.03409161418676376, decouple_loss:0.029146559536457062
Iteration: 825, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44730284810066223, gen p mean: -0.47601500153541565, mean p set: 0.44778314232826233
The modified gen p mean: 0.45168885588645935, gen p mean: -0.4929105341434479, mean p set: 0.45216912031173706
The modified gen p mean: 0.450541615486145, gen p mean: -0.49089816212654114, mean p set: 0.45102187991142273
loss_pred:0.03536631166934967, decouple_loss:0.031126588582992554
loss_pred:0.03411377593874931, decouple_loss:0.029457567259669304
loss_pred:0.03297870606184006, decouple_loss:0.029093027114868164
Iteration: 826, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44971993565559387, gen p mean: -0.4810825288295746, mean p set: 0.4502002000808716
The modified gen p mean: 0.4471801221370697, gen p mean: -0.46777787804603577, mean p set: 0.4476604163646698
The modified gen p mean: 0.4500812888145447, gen p mean: -0.47500184178352356, mean p set: 0.4505615830421448
loss_pred:0.033541202545166016, decouple_loss:0.028549673035740852
loss_pred:0.035030193626880646, decouple_loss:0.03001742623746395
loss_pred:0.03289778530597687, decouple_loss:0.029272660613059998
Iteration: 827, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45021939277648926, gen p mean: -0.4765481948852539, mean p set: 0.45069968700408936
The modified gen p mean: 0.4497770667076111, gen p mean: -0.4846951365470886, mean p set: 0.45025739073753357
The modified gen p mean: 0.4521802067756653, gen p mean: -0.48088422417640686, mean p set: 0.4526605010032654
loss_pred:0.03279116377234459, decouple_loss:0.030271677300333977
loss_pred:0.03520733118057251, decouple_loss:0.03027399815618992
loss_pred:0.03302488476037979, decouple_loss:0.03088008239865303
Iteration: 828, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45128291845321655, gen p mean: -0.476909339427948, mean p set: 0.45176324248313904
The modified gen p mean: 0.4510563015937805, gen p mean: -0.47016987204551697, mean p set: 0.451536625623703
The modified gen p mean: 0.4502079486846924, gen p mean: -0.46977272629737854, mean p set: 0.4506881833076477
loss_pred:0.032228242605924606, decouple_loss:0.029957029968500137
loss_pred:0.03416753560304642, decouple_loss:0.029210248962044716
loss_pred:0.0343187116086483, decouple_loss:0.0277977604418993
Iteration: 829, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486111104488373, gen p mean: -0.47351643443107605, mean p set: 0.44909143447875977
The modified gen p mean: 0.4475676417350769, gen p mean: -0.4631701409816742, mean p set: 0.4480479061603546
The modified gen p mean: 0.4472504258155823, gen p mean: -0.4655154347419739, mean p set: 0.44773074984550476
loss_pred:0.03376515954732895, decouple_loss:0.027972210198640823
loss_pred:0.034167978912591934, decouple_loss:0.02988945133984089
loss_pred:0.03389405459165573, decouple_loss:0.0288704764097929
Iteration: 830, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496040344238281, gen p mean: -0.46774977445602417, mean p set: 0.4500843286514282
The modified gen p mean: 0.45136773586273193, gen p mean: -0.4731334447860718, mean p set: 0.4518480598926544
The modified gen p mean: 0.449433296918869, gen p mean: -0.4642488956451416, mean p set: 0.44991356134414673
loss_pred:0.03468223288655281, decouple_loss:0.028963947668671608
loss_pred:0.03206249698996544, decouple_loss:0.028202537447214127
loss_pred:0.034025248140096664, decouple_loss:0.027950339019298553
2023-05-02 19:43:14 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.4722423255443573, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.46577808260917664, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.46160250902175903, mean p set: 0.45035696029663086
loss_pred:0.03575538471341133, decouple_loss:0.03280247002840042
loss_pred:0.034576695412397385, decouple_loss:0.03128504380583763
loss_pred:0.03378485143184662, decouple_loss:0.03196067363023758
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03630644828081131, avg_mse: 0.03913633152842522
current test mse: 0.039136
Iteration: 831, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447336345911026, gen p mean: -0.4623754620552063, mean p set: 0.4478166699409485
loss_pred:0.03482142090797424, decouple_loss:0.029760487377643585
The modified gen p mean: 0.44929367303848267, gen p mean: -0.4672212302684784, mean p set: 0.44977399706840515
loss_pred:0.033596981316804886, decouple_loss:0.028313983231782913
The modified gen p mean: 0.44727781414985657, gen p mean: -0.4624422490596771, mean p set: 0.44775813817977905
loss_pred:0.032501764595508575, decouple_loss:0.02921704202890396
Iteration: 832, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44873663783073425, gen p mean: -0.4763640761375427, mean p set: 0.44921693205833435
The modified gen p mean: 0.44969043135643005, gen p mean: -0.47561490535736084, mean p set: 0.45017069578170776
The modified gen p mean: 0.4515502452850342, gen p mean: -0.4900565445423126, mean p set: 0.4520305097103119
loss_pred:0.033992696553468704, decouple_loss:0.028376450762152672
loss_pred:0.03406980261206627, decouple_loss:0.028635572642087936
loss_pred:0.032271645963191986, decouple_loss:0.028635768219828606
Iteration: 833, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478659927845001, gen p mean: -0.46738681197166443, mean p set: 0.4483462870121002
The modified gen p mean: 0.44757893681526184, gen p mean: -0.4638705849647522, mean p set: 0.44805923104286194
The modified gen p mean: 0.44837355613708496, gen p mean: -0.4665766656398773, mean p set: 0.44885390996932983
loss_pred:0.03302248194813728, decouple_loss:0.028353895992040634
loss_pred:0.03375319391489029, decouple_loss:0.030463088303804398
loss_pred:0.03294318914413452, decouple_loss:0.031147219240665436
Iteration: 834, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448749303817749, gen p mean: -0.46103808283805847, mean p set: 0.4492295980453491
The modified gen p mean: 0.4506557881832123, gen p mean: -0.4662321209907532, mean p set: 0.45113611221313477
The modified gen p mean: 0.44747841358184814, gen p mean: -0.46045804023742676, mean p set: 0.44795873761177063
loss_pred:0.034060534089803696, decouple_loss:0.026948213577270508
loss_pred:0.03509429842233658, decouple_loss:0.02931787818670273
loss_pred:0.03471224009990692, decouple_loss:0.027534237131476402
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 835, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677478075027466, gen p mean: -0.45951923727989197, mean p set: 0.44725507497787476
The modified gen p mean: 0.44749799370765686, gen p mean: -0.4633159935474396, mean p set: 0.44797828793525696
The modified gen p mean: 0.44840723276138306, gen p mean: -0.4591014087200165, mean p set: 0.44888749718666077
loss_pred:0.03541060537099838, decouple_loss:0.03235899284482002
loss_pred:0.033942900598049164, decouple_loss:0.0323047898709774
loss_pred:0.0344441719353199, decouple_loss:0.03210367262363434
Iteration: 836, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460480511188507, gen p mean: -0.4644455015659332, mean p set: 0.4465283155441284
The modified gen p mean: 0.4474668502807617, gen p mean: -0.46859070658683777, mean p set: 0.4479471743106842
The modified gen p mean: 0.44731026887893677, gen p mean: -0.47436845302581787, mean p set: 0.44779056310653687
loss_pred:0.03520776331424713, decouple_loss:0.030924027785658836
loss_pred:0.034941837191581726, decouple_loss:0.0316142700612545
loss_pred:0.03343120589852333, decouple_loss:0.030819851905107498
Iteration: 837, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760996103286743, gen p mean: -0.47132328152656555, mean p set: 0.44809025526046753
The modified gen p mean: 0.44708606600761414, gen p mean: -0.46752819418907166, mean p set: 0.44756636023521423
The modified gen p mean: 0.4473015367984772, gen p mean: -0.4678815007209778, mean p set: 0.4477818012237549
loss_pred:0.03428642824292183, decouple_loss:0.03041909821331501
loss_pred:0.03424815088510513, decouple_loss:0.03138751909136772
loss_pred:0.033873550593853, decouple_loss:0.029537193477153778
Iteration: 838, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788992404937744, gen p mean: -0.46002650260925293, mean p set: 0.44837021827697754
The modified gen p mean: 0.44819462299346924, gen p mean: -0.4623751938343048, mean p set: 0.4486749470233917
The modified gen p mean: 0.4461391866207123, gen p mean: -0.45652806758880615, mean p set: 0.44661951065063477
loss_pred:0.034446727484464645, decouple_loss:0.029119206592440605
loss_pred:0.035819269716739655, decouple_loss:0.030253464356064796
loss_pred:0.03425700217485428, decouple_loss:0.02956765703856945
Iteration: 839, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479029178619385, gen p mean: -0.46498945355415344, mean p set: 0.44838324189186096
The modified gen p mean: 0.44660109281539917, gen p mean: -0.46853107213974, mean p set: 0.4470813572406769
The modified gen p mean: 0.4481610357761383, gen p mean: -0.4594101905822754, mean p set: 0.4486413896083832
loss_pred:0.03432130068540573, decouple_loss:0.03080921620130539
loss_pred:0.0334937758743763, decouple_loss:0.030106110498309135
loss_pred:0.032879676669836044, decouple_loss:0.029616577550768852
Iteration: 840, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468335509300232, gen p mean: -0.4696616530418396, mean p set: 0.4473138451576233
The modified gen p mean: 0.4475243091583252, gen p mean: -0.47361689805984497, mean p set: 0.4480046033859253
The modified gen p mean: 0.4463503658771515, gen p mean: -0.47200602293014526, mean p set: 0.4468306601047516
loss_pred:0.03376045450568199, decouple_loss:0.030116604641079903
loss_pred:0.03337041661143303, decouple_loss:0.028560325503349304
loss_pred:0.032154496759176254, decouple_loss:0.029826568439602852
2023-05-02 19:47:41 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.4805733561515808, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.47309598326683044, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.46946224570274353, mean p set: 0.45035696029663086
loss_pred:0.03526293486356735, decouple_loss:0.03010762482881546
loss_pred:0.03413217514753342, decouple_loss:0.02941250614821911
loss_pred:0.03342248499393463, decouple_loss:0.029558543115854263
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03575717657804489, avg_mse: 0.03833425045013428
current test mse: 0.038334
Iteration: 841, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44676148891448975, gen p mean: -0.47650477290153503, mean p set: 0.44724181294441223
loss_pred:0.032834235578775406, decouple_loss:0.0292898528277874
The modified gen p mean: 0.44671371579170227, gen p mean: -0.47383254766464233, mean p set: 0.44719401001930237
loss_pred:0.03465427830815315, decouple_loss:0.028139252215623856
The modified gen p mean: 0.4465268850326538, gen p mean: -0.474553644657135, mean p set: 0.4470071494579315
loss_pred:0.03344247117638588, decouple_loss:0.028639333322644234
Iteration: 842, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44754186272621155, gen p mean: -0.4686601758003235, mean p set: 0.44802215695381165
The modified gen p mean: 0.44711536169052124, gen p mean: -0.47220826148986816, mean p set: 0.44759562611579895
The modified gen p mean: 0.447247713804245, gen p mean: -0.46593400835990906, mean p set: 0.4477280378341675
loss_pred:0.03320307657122612, decouple_loss:0.028449423611164093
loss_pred:0.03297051787376404, decouple_loss:0.029102960601449013
loss_pred:0.0340547151863575, decouple_loss:0.02842327393591404
Iteration: 843, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836685061454773, gen p mean: -0.4668605327606201, mean p set: 0.44884711503982544
The modified gen p mean: 0.44761785864830017, gen p mean: -0.4660399556159973, mean p set: 0.44809815287590027
The modified gen p mean: 0.4479389190673828, gen p mean: -0.46701347827911377, mean p set: 0.4484192430973053
loss_pred:0.03401200473308563, decouple_loss:0.028092036023736
loss_pred:0.03341091051697731, decouple_loss:0.028953449800610542
loss_pred:0.03525824844837189, decouple_loss:0.02787115052342415
Iteration: 844, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484720230102539, gen p mean: -0.4615560472011566, mean p set: 0.448952317237854
The modified gen p mean: 0.44772443175315857, gen p mean: -0.45952755212783813, mean p set: 0.44820475578308105
The modified gen p mean: 0.44768717885017395, gen p mean: -0.4649544358253479, mean p set: 0.44816744327545166
loss_pred:0.03430461883544922, decouple_loss:0.029157917946577072loss_pred:0.033515188843011856, decouple_loss:0.02889803797006607
loss_pred:0.03454592823982239, decouple_loss:0.02985670417547226
Iteration: 845, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477154016494751, gen p mean: -0.46137183904647827, mean p set: 0.4481956660747528
The modified gen p mean: 0.4483828544616699, gen p mean: -0.45936185121536255, mean p set: 0.4488631784915924
The modified gen p mean: 0.4479878842830658, gen p mean: -0.45550695061683655, mean p set: 0.4484681785106659
loss_pred:0.03319177031517029, decouple_loss:0.02866915427148342
loss_pred:0.03454461693763733, decouple_loss:0.028431272134184837
loss_pred:0.03412029519677162, decouple_loss:0.028929222375154495
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 846, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793903827667236, gen p mean: -0.4594629406929016, mean p set: 0.44841933250427246
The modified gen p mean: 0.44717884063720703, gen p mean: -0.4566324055194855, mean p set: 0.44765913486480713
The modified gen p mean: 0.44736284017562866, gen p mean: -0.45977652072906494, mean p set: 0.44784313440322876
loss_pred:0.03540845215320587, decouple_loss:0.02748126909136772
loss_pred:0.03400137275457382, decouple_loss:0.02752147801220417
loss_pred:0.03514457494020462, decouple_loss:0.027848735451698303
Iteration: 847, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485854208469391, gen p mean: -0.4595157504081726, mean p set: 0.4490656852722168
The modified gen p mean: 0.4461376368999481, gen p mean: -0.4581528306007385, mean p set: 0.4466179311275482
The modified gen p mean: 0.4480937123298645, gen p mean: -0.45888108015060425, mean p set: 0.4485739767551422
loss_pred:0.03305520489811897, decouple_loss:0.027661286294460297
loss_pred:0.033786263316869736, decouple_loss:0.028075551614165306
loss_pred:0.03286163508892059, decouple_loss:0.027165165171027184
Iteration: 848, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755229353904724, gen p mean: -0.4620450437068939, mean p set: 0.44803258776664734
The modified gen p mean: 0.44764435291290283, gen p mean: -0.46618691086769104, mean p set: 0.44812464714050293
The modified gen p mean: 0.4472489058971405, gen p mean: -0.46098992228507996, mean p set: 0.447729229927063
loss_pred:0.03349814936518669, decouple_loss:0.027842368930578232
loss_pred:0.033563826233148575, decouple_loss:0.02781306765973568
loss_pred:0.034032389521598816, decouple_loss:0.027214139699935913
Iteration: 849, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44594743847846985, gen p mean: -0.4642496705055237, mean p set: 0.44642776250839233
The modified gen p mean: 0.4476853609085083, gen p mean: -0.46670016646385193, mean p set: 0.4481656849384308
The modified gen p mean: 0.4477333128452301, gen p mean: -0.4683305025100708, mean p set: 0.4482135772705078
loss_pred:0.03402034193277359, decouple_loss:0.028904132544994354
loss_pred:0.034168656915426254, decouple_loss:0.02674819901585579
loss_pred:0.03370733559131622, decouple_loss:0.027895376086235046
Iteration: 850, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478013515472412, gen p mean: -0.4601987302303314, mean p set: 0.4482816159725189
The modified gen p mean: 0.447325736284256, gen p mean: -0.4590212106704712, mean p set: 0.4478060305118561
The modified gen p mean: 0.4474934935569763, gen p mean: -0.461528480052948, mean p set: 0.44797375798225403
loss_pred:0.03326359763741493, decouple_loss:0.026822896674275398
loss_pred:0.033679474145174026, decouple_loss:0.027219269424676895
loss_pred:0.03507847338914871, decouple_loss:0.026917366310954094
2023-05-02 19:51:23 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.46234267950057983, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.4690629839897156, mean p set: 0.4502691626548767
The modified gen p mean: 0.4498766362667084, gen p mean: -0.45883867144584656, mean p set: 0.45035696029663086
loss_pred:0.0338013656437397, decouple_loss:0.028189003467559814
loss_pred:0.03485128656029701, decouple_loss:0.02871326543390751
loss_pred:0.033091600984334946, decouple_loss:0.028238777071237564
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03533376753330231, avg_mse: 0.03794366121292114
current test mse: 0.037944
Iteration: 851, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473837912082672, gen p mean: -0.4616647958755493, mean p set: 0.4478640854358673
loss_pred:0.03275825455784798, decouple_loss:0.026878122240304947
The modified gen p mean: 0.44590359926223755, gen p mean: -0.4633394181728363, mean p set: 0.44638389348983765
loss_pred:0.03267801180481911, decouple_loss:0.027265967801213264
The modified gen p mean: 0.44779470562934875, gen p mean: -0.4600459337234497, mean p set: 0.44827502965927124
loss_pred:0.03330649062991142, decouple_loss:0.026391372084617615
Iteration: 852, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482315480709076, gen p mean: -0.4734613001346588, mean p set: 0.4487118422985077
The modified gen p mean: 0.44661808013916016, gen p mean: -0.4709946811199188, mean p set: 0.44709837436676025
The modified gen p mean: 0.4472237527370453, gen p mean: -0.4807620644569397, mean p set: 0.4477040469646454
loss_pred:0.03286626189947128, decouple_loss:0.026264673098921776
loss_pred:0.033439453691244125, decouple_loss:0.026816170662641525
loss_pred:0.03273969516158104, decouple_loss:0.026695335283875465
Iteration: 853, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462707042694092, gen p mean: -0.4746101200580597, mean p set: 0.4467509686946869
The modified gen p mean: 0.4473322331905365, gen p mean: -0.47978195548057556, mean p set: 0.4478125274181366
The modified gen p mean: 0.446433961391449, gen p mean: -0.4760516285896301, mean p set: 0.44691428542137146
loss_pred:0.034056007862091064, decouple_loss:0.027200451120734215
loss_pred:0.03253452107310295, decouple_loss:0.026978272944688797
loss_pred:0.033705949783325195, decouple_loss:0.027348367497324944
Iteration: 854, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448092520236969, gen p mean: -0.46389490365982056, mean p set: 0.4485728442668915
The modified gen p mean: 0.44698426127433777, gen p mean: -0.46661534905433655, mean p set: 0.44746458530426025
The modified gen p mean: 0.4472549557685852, gen p mean: -0.4643864929676056, mean p set: 0.4477352201938629
loss_pred:0.03257833793759346, decouple_loss:0.026950383558869362
loss_pred:0.03319421783089638, decouple_loss:0.026476293802261353
loss_pred:0.03419794887304306, decouple_loss:0.026657670736312866
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
NaN value num: 0
Iteration: 855, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4547361135482788, gen p mean: -0.46107685565948486, mean p set: 0.4552163779735565
The modified gen p mean: 0.45283243060112, gen p mean: -0.4608358144760132, mean p set: 0.4533127248287201
The modified gen p mean: 0.45077621936798096, gen p mean: -0.4591980278491974, mean p set: 0.45125651359558105
loss_pred:0.03461918234825134, decouple_loss:0.03250646963715553
loss_pred:0.03362394496798515, decouple_loss:0.0316925048828125
loss_pred:0.034939955919981, decouple_loss:0.03244008868932724
Iteration: 856, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45221641659736633, gen p mean: -0.4759000539779663, mean p set: 0.45269668102264404
The modified gen p mean: 0.4524969458580017, gen p mean: -0.47423961758613586, mean p set: 0.4529772400856018
The modified gen p mean: 0.4524695873260498, gen p mean: -0.4825637638568878, mean p set: 0.4529498815536499
loss_pred:0.033953744918107986, decouple_loss:0.03040478006005287
loss_pred:0.034268029034137726, decouple_loss:0.03064875863492489
loss_pred:0.03376196324825287, decouple_loss:0.03298976644873619
Iteration: 857, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45154979825019836, gen p mean: -0.4940454959869385, mean p set: 0.45203009247779846
The modified gen p mean: 0.45280522108078003, gen p mean: -0.4938110411167145, mean p set: 0.45328548550605774
The modified gen p mean: 0.45142704248428345, gen p mean: -0.4874995946884155, mean p set: 0.45190730690956116
loss_pred:0.03340864181518555, decouple_loss:0.02970953844487667
loss_pred:0.033429551869630814, decouple_loss:0.03198900818824768
loss_pred:0.03416585549712181, decouple_loss:0.03130241855978966
Iteration: 858, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520688056945801, gen p mean: -0.49039730429649353, mean p set: 0.45254912972450256
The modified gen p mean: 0.45218992233276367, gen p mean: -0.48723116517066956, mean p set: 0.45267021656036377
The modified gen p mean: 0.4527682662010193, gen p mean: -0.49274682998657227, mean p set: 0.4532485604286194
loss_pred:0.0342494435608387, decouple_loss:0.029853498563170433
loss_pred:0.03409481793642044, decouple_loss:0.03115292452275753
loss_pred:0.03502979874610901, decouple_loss:0.030777430161833763
Iteration: 859, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509826600551605, gen p mean: -0.4877069592475891, mean p set: 0.4514629542827606
The modified gen p mean: 0.4523903429508209, gen p mean: -0.48708248138427734, mean p set: 0.452870637178421
The modified gen p mean: 0.4538275897502899, gen p mean: -0.4853913486003876, mean p set: 0.4543078541755676
loss_pred:0.033708199858665466, decouple_loss:0.030485615134239197
loss_pred:0.03472727909684181, decouple_loss:0.029991554096341133
loss_pred:0.034084416925907135, decouple_loss:0.029614649713039398
Iteration: 860, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44957488775253296, gen p mean: -0.47765788435935974, mean p set: 0.45005518198013306
The modified gen p mean: 0.45258423686027527, gen p mean: -0.48646706342697144, mean p set: 0.45306456089019775
The modified gen p mean: 0.45025011897087097, gen p mean: -0.4812110960483551, mean p set: 0.45073044300079346
loss_pred:0.034522708505392075, decouple_loss:0.030580613762140274
loss_pred:0.03472441807389259, decouple_loss:0.029839251190423965
loss_pred:0.03477955982089043, decouple_loss:0.03005770407617092
2023-05-02 19:55:48 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.4725668430328369, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.48024556040763855, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.46892374753952026, mean p set: 0.45035696029663086
loss_pred:0.0340636745095253, decouple_loss:0.03101051226258278
loss_pred:0.03511650487780571, decouple_loss:0.03158368170261383
loss_pred:0.033370379358530045, decouple_loss:0.03140132501721382
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03575011342763901, avg_mse: 0.03848757967352867
current test mse: 0.038488
Iteration: 861, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44968923926353455, gen p mean: -0.47708502411842346, mean p set: 0.45016953349113464
The modified gen p mean: 0.4507061541080475, gen p mean: -0.48366212844848633, mean p set: 0.4511864483356476
loss_pred:0.033733632415533066, decouple_loss:0.029558734968304634
loss_pred:0.03441408649086952, decouple_loss:0.02927674539387226
The modified gen p mean: 0.451323926448822, gen p mean: -0.4790150821208954, mean p set: 0.4518042206764221
loss_pred:0.03324253484606743, decouple_loss:0.029578296467661858
Iteration: 862, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524965286254883, gen p mean: -0.47598177194595337, mean p set: 0.452976793050766
The modified gen p mean: 0.45246604084968567, gen p mean: -0.4724354147911072, mean p set: 0.45294633507728577
The modified gen p mean: 0.45109182596206665, gen p mean: -0.47908565402030945, mean p set: 0.45157214999198914
loss_pred:0.03416149690747261, decouple_loss:0.02945493347942829
loss_pred:0.03360455855727196, decouple_loss:0.029108313843607903
loss_pred:0.03425436094403267, decouple_loss:0.02844485081732273
Iteration: 863, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513205289840698, gen p mean: -0.48616838455200195, mean p set: 0.4518008232116699
The modified gen p mean: 0.4500975012779236, gen p mean: -0.48288944363594055, mean p set: 0.4505777657032013
The modified gen p mean: 0.4523267447948456, gen p mean: -0.4844495356082916, mean p set: 0.4528070092201233
loss_pred:0.03291688486933708, decouple_loss:0.028415622189641
loss_pred:0.03412972390651703, decouple_loss:0.027701418846845627
loss_pred:0.03355073928833008, decouple_loss:0.029069731011986732
Iteration: 864, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45300841331481934, gen p mean: -0.4901684820652008, mean p set: 0.45348870754241943
The modified gen p mean: 0.45141032338142395, gen p mean: -0.49019548296928406, mean p set: 0.45189061760902405
The modified gen p mean: 0.4508713483810425, gen p mean: -0.4880008399486542, mean p set: 0.4513516426086426
loss_pred:0.03331760689616203, decouple_loss:0.02816418744623661
loss_pred:0.03329730033874512, decouple_loss:0.028966719284653664
loss_pred:0.033314790576696396, decouple_loss:0.028136299923062325
Iteration: 865, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45037293434143066, gen p mean: -0.4877761900424957, mean p set: 0.45085322856903076
The modified gen p mean: 0.4521520435810089, gen p mean: -0.48722362518310547, mean p set: 0.4526323080062866
The modified gen p mean: 0.4530589282512665, gen p mean: -0.49104729294776917, mean p set: 0.45353925228118896
loss_pred:0.03494211658835411, decouple_loss:0.027963200584053993
loss_pred:0.033641163259744644, decouple_loss:0.02948107197880745
loss_pred:0.03350811451673508, decouple_loss:0.02908298373222351
Iteration: 866, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527053236961365, gen p mean: -0.49016138911247253, mean p set: 0.4531856179237366
The modified gen p mean: 0.45203450322151184, gen p mean: -0.4885863661766052, mean p set: 0.45251479744911194
The modified gen p mean: 0.4529622793197632, gen p mean: -0.48186999559402466, mean p set: 0.4534425735473633
loss_pred:0.03244027867913246, decouple_loss:0.029141854494810104
loss_pred:0.03433200344443321, decouple_loss:0.028666414320468903
loss_pred:0.03401116281747818, decouple_loss:0.02820238471031189
Iteration: 867, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45179104804992676, gen p mean: -0.47848618030548096, mean p set: 0.45227131247520447
The modified gen p mean: 0.45303037762641907, gen p mean: -0.4797804355621338, mean p set: 0.45351067185401917
The modified gen p mean: 0.4548882842063904, gen p mean: -0.4812622666358948, mean p set: 0.45536860823631287
loss_pred:0.0334596186876297, decouple_loss:0.02824573963880539
loss_pred:0.03365851193666458, decouple_loss:0.02902909368276596
loss_pred:0.03271396830677986, decouple_loss:0.02857815846800804
Iteration: 868, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45566442608833313, gen p mean: -0.4851229190826416, mean p set: 0.45614469051361084
The modified gen p mean: 0.45286643505096436, gen p mean: -0.49218347668647766, mean p set: 0.45334672927856445
The modified gen p mean: 0.45167726278305054, gen p mean: -0.48943042755126953, mean p set: 0.45215752720832825
loss_pred:0.03325096145272255, decouple_loss:0.02840549312531948
loss_pred:0.03443437069654465, decouple_loss:0.027543628588318825
loss_pred:0.03436483442783356, decouple_loss:0.027594689279794693
Iteration: 869, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45163533091545105, gen p mean: -0.4952102601528168, mean p set: 0.45211559534072876
The modified gen p mean: 0.4525904655456543, gen p mean: -0.50135737657547, mean p set: 0.453070729970932
The modified gen p mean: 0.45346465706825256, gen p mean: -0.494573712348938, mean p set: 0.4539449214935303
loss_pred:0.033616457134485245, decouple_loss:0.027174951508641243
loss_pred:0.03274305537343025, decouple_loss:0.028802411630749702
loss_pred:0.033159203827381134, decouple_loss:0.028107423335313797
Iteration: 870, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45100733637809753, gen p mean: -0.5042166113853455, mean p set: 0.45148760080337524
The modified gen p mean: 0.4508593678474426, gen p mean: -0.5021438598632812, mean p set: 0.45133963227272034
The modified gen p mean: 0.45311006903648376, gen p mean: -0.5040259957313538, mean p set: 0.45359036326408386
loss_pred:0.03397378325462341, decouple_loss:0.028313567861914635
loss_pred:0.03340531140565872, decouple_loss:0.027313997969031334
loss_pred:0.03419758006930351, decouple_loss:0.02800450287759304
2023-05-02 19:59:29 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.49865594506263733, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.49080172181129456, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.48696184158325195, mean p set: 0.45035696029663086
loss_pred:0.035247553139925, decouple_loss:0.030637510120868683
loss_pred:0.034133706241846085, decouple_loss:0.029970772564411163
loss_pred:0.03331111744046211, decouple_loss:0.030458543449640274
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03574857488274574, avg_mse: 0.0387195348739624
current test mse: 0.03872
Iteration: 871, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493550658226013, gen p mean: -0.4925343692302704, mean p set: 0.4498353600502014
loss_pred:0.03454090282320976, decouple_loss:0.028594212606549263
The modified gen p mean: 0.4509139657020569, gen p mean: -0.49759018421173096, mean p set: 0.451394259929657
loss_pred:0.033176932483911514, decouple_loss:0.027951542288064957
The modified gen p mean: 0.45132339000701904, gen p mean: -0.49280571937561035, mean p set: 0.45180368423461914
loss_pred:0.03267453610897064, decouple_loss:0.026601282879710197
Iteration: 872, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45129314064979553, gen p mean: -0.498905211687088, mean p set: 0.451773464679718
The modified gen p mean: 0.451680064201355, gen p mean: -0.49521034955978394, mean p set: 0.4521603584289551
The modified gen p mean: 0.4523853361606598, gen p mean: -0.4909711182117462, mean p set: 0.4528656601905823
loss_pred:0.03356994688510895, decouple_loss:0.02741648070514202
loss_pred:0.033707454800605774, decouple_loss:0.026532180607318878
loss_pred:0.033277932554483414, decouple_loss:0.027886811643838882
Iteration: 873, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452595055103302, gen p mean: -0.48785269260406494, mean p set: 0.4530753493309021
The modified gen p mean: 0.45029470324516296, gen p mean: -0.49057716131210327, mean p set: 0.45077502727508545
The modified gen p mean: 0.4525321424007416, gen p mean: -0.4939057230949402, mean p set: 0.4530124366283417
loss_pred:0.033160608261823654, decouple_loss:0.02668028511106968
loss_pred:0.03408144786953926, decouple_loss:0.027064062654972076
loss_pred:0.03308491408824921, decouple_loss:0.02924484759569168
Iteration: 874, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518226385116577, gen p mean: -0.4919983446598053, mean p set: 0.4523029327392578
The modified gen p mean: 0.45203670859336853, gen p mean: -0.4883604943752289, mean p set: 0.452517032623291
The modified gen p mean: 0.4539056420326233, gen p mean: -0.48927465081214905, mean p set: 0.4543859660625458
loss_pred:0.03299490734934807, decouple_loss:0.027201352640986443
loss_pred:0.03290948644280434, decouple_loss:0.027696896344423294
loss_pred:0.03275896608829498, decouple_loss:0.02626815438270569
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
NaN value num: 0
Iteration: 875, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4537600576877594, gen p mean: -0.49314939975738525, mean p set: 0.4542403817176819
The modified gen p mean: 0.4518463611602783, gen p mean: -0.49394768476486206, mean p set: 0.4523266553878784
The modified gen p mean: 0.44999122619628906, gen p mean: -0.4876629412174225, mean p set: 0.45047152042388916
loss_pred:0.034982986748218536, decouple_loss:0.030634192749857903
loss_pred:0.03348840773105621, decouple_loss:0.0305042527616024
loss_pred:0.03451312333345413, decouple_loss:0.02973218262195587
Iteration: 876, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45203670859336853, gen p mean: -0.49439409375190735, mean p set: 0.4525170624256134
The modified gen p mean: 0.4525426924228668, gen p mean: -0.48438745737075806, mean p set: 0.4530230164527893
The modified gen p mean: 0.45302072167396545, gen p mean: -0.4951232671737671, mean p set: 0.45350101590156555
loss_pred:0.03389183059334755, decouple_loss:0.030927211046218872
loss_pred:0.033989738672971725, decouple_loss:0.030025487765669823
loss_pred:0.03407492861151695, decouple_loss:0.028193840757012367
Iteration: 877, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512402415275574, gen p mean: -0.5009258389472961, mean p set: 0.4517205059528351
The modified gen p mean: 0.45095574855804443, gen p mean: -0.4964595437049866, mean p set: 0.45143604278564453
The modified gen p mean: 0.4501783549785614, gen p mean: -0.4875747859477997, mean p set: 0.4506586492061615
loss_pred:0.035399820655584335, decouple_loss:0.030493931844830513
loss_pred:0.033688854426145554, decouple_loss:0.029288753867149353
loss_pred:0.03371763229370117, decouple_loss:0.030009647831320763
Iteration: 878, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452846497297287, gen p mean: -0.510237991809845, mean p set: 0.4533267617225647
The modified gen p mean: 0.450575590133667, gen p mean: -0.507439374923706, mean p set: 0.4510558545589447
The modified gen p mean: 0.4525480270385742, gen p mean: -0.4975147843360901, mean p set: 0.4530283212661743
loss_pred:0.03363271430134773, decouple_loss:0.028014253824949265
loss_pred:0.03490166366100311, decouple_loss:0.02894410863518715
loss_pred:0.03417811542749405, decouple_loss:0.02949458174407482
Iteration: 879, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505375027656555, gen p mean: -0.494880348443985, mean p set: 0.451017826795578
The modified gen p mean: 0.4539630711078644, gen p mean: -0.5016171336174011, mean p set: 0.4544433653354645
The modified gen p mean: 0.4511350989341736, gen p mean: -0.5102863311767578, mean p set: 0.4516153931617737
loss_pred:0.03310009092092514, decouple_loss:0.03133828565478325
loss_pred:0.03497741371393204, decouple_loss:0.029443074017763138
loss_pred:0.03427262604236603, decouple_loss:0.03045296110212803
Iteration: 880, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520858824253082, gen p mean: -0.4987654685974121, mean p set: 0.4525661766529083
The modified gen p mean: 0.4508105218410492, gen p mean: -0.49682316184043884, mean p set: 0.4512908160686493
The modified gen p mean: 0.45179256796836853, gen p mean: -0.5081601738929749, mean p set: 0.45227286219596863
loss_pred:0.033783867955207825, decouple_loss:0.02918866276741028
loss_pred:0.03333606198430061, decouple_loss:0.02919720858335495
loss_pred:0.03379933163523674, decouple_loss:0.0302567295730114
2023-05-02 20:03:46 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.503751277923584, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.496150940656662, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.49242180585861206, mean p set: 0.45035696029663086
loss_pred:0.03510234132409096, decouple_loss:0.03222184255719185
loss_pred:0.0340692400932312, decouple_loss:0.031143907457590103
loss_pred:0.0333317294716835, decouple_loss:0.03229259327054024
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03576207533478737, avg_mse: 0.03863115236163139
current test mse: 0.038631
Iteration: 881, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45253291726112366, gen p mean: -0.5048112273216248, mean p set: 0.45301321148872375
loss_pred:0.03434669226408005, decouple_loss:0.028375398367643356
The modified gen p mean: 0.4527859091758728, gen p mean: -0.5089883208274841, mean p set: 0.4532662332057953
loss_pred:0.033275306224823, decouple_loss:0.027489332482218742
The modified gen p mean: 0.45270365476608276, gen p mean: -0.5077326893806458, mean p set: 0.45318397879600525
loss_pred:0.03378843516111374, decouple_loss:0.02857166901230812
Iteration: 882, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518325626850128, gen p mean: -0.5171277523040771, mean p set: 0.4523128271102905
The modified gen p mean: 0.45015931129455566, gen p mean: -0.5109418630599976, mean p set: 0.4506395757198334
The modified gen p mean: 0.4513090252876282, gen p mean: -0.5071985125541687, mean p set: 0.4517892897129059
loss_pred:0.034490618854761124, decouple_loss:0.02826722152531147
loss_pred:0.034324467182159424, decouple_loss:0.02903037890791893
loss_pred:0.033502545207738876, decouple_loss:0.029186183586716652
Iteration: 883, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513707756996155, gen p mean: -0.5324509739875793, mean p set: 0.4518510699272156
The modified gen p mean: 0.4517442584037781, gen p mean: -0.530373215675354, mean p set: 0.4522245526313782
The modified gen p mean: 0.4517357647418976, gen p mean: -0.5267969965934753, mean p set: 0.4522160291671753
loss_pred:0.03392134979367256, decouple_loss:0.029668526723980904
loss_pred:0.032584745436906815, decouple_loss:0.02909877710044384
loss_pred:0.032690756022930145, decouple_loss:0.028638433665037155
Iteration: 884, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45169636607170105, gen p mean: -0.5330188870429993, mean p set: 0.45217666029930115
The modified gen p mean: 0.451686829328537, gen p mean: -0.5307235717773438, mean p set: 0.4521671235561371
The modified gen p mean: 0.45143216848373413, gen p mean: -0.5307325124740601, mean p set: 0.4519124925136566
loss_pred:0.03305104374885559, decouple_loss:0.030316466465592384
loss_pred:0.033317796885967255, decouple_loss:0.028361769393086433
loss_pred:0.03534669801592827, decouple_loss:0.02929629199206829
Iteration: 885, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496181011199951, gen p mean: -0.5032285451889038, mean p set: 0.4500984251499176
The modified gen p mean: 0.44998785853385925, gen p mean: -0.5086574554443359, mean p set: 0.45046815276145935
The modified gen p mean: 0.4510897696018219, gen p mean: -0.5204111337661743, mean p set: 0.4515700936317444
loss_pred:0.03336940333247185, decouple_loss:0.029930956661701202
loss_pred:0.03310149163007736, decouple_loss:0.029591329395771027
loss_pred:0.03321937099099159, decouple_loss:0.028779765591025352
Iteration: 886, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45124655961990356, gen p mean: -0.5192703604698181, mean p set: 0.45172688364982605
The modified gen p mean: 0.45134004950523376, gen p mean: -0.5190826654434204, mean p set: 0.4518203139305115
The modified gen p mean: 0.4514986574649811, gen p mean: -0.5189993381500244, mean p set: 0.4519789516925812
loss_pred:0.035435035824775696, decouple_loss:0.02912258915603161
loss_pred:0.03498510271310806, decouple_loss:0.02961968258023262
loss_pred:0.03422730043530464, decouple_loss:0.02922464907169342
Iteration: 887, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518813490867615, gen p mean: -0.5246685147285461, mean p set: 0.4523616135120392
The modified gen p mean: 0.4519600570201874, gen p mean: -0.5205816626548767, mean p set: 0.4524403214454651
The modified gen p mean: 0.4516639709472656, gen p mean: -0.5120230317115784, mean p set: 0.4521442651748657
loss_pred:0.034337129443883896, decouple_loss:0.029375633224844933
loss_pred:0.03311705216765404, decouple_loss:0.027788423001766205
loss_pred:0.03369776904582977, decouple_loss:0.029357869178056717
Iteration: 888, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519064426422119, gen p mean: -0.5271123647689819, mean p set: 0.452386736869812
The modified gen p mean: 0.44897571206092834, gen p mean: -0.5152577757835388, mean p set: 0.44945603609085083
The modified gen p mean: 0.45082801580429077, gen p mean: -0.536158561706543, mean p set: 0.45130833983421326
loss_pred:0.034758370369672775, decouple_loss:0.02783200703561306
loss_pred:0.032164134085178375, decouple_loss:0.02872655726969242
loss_pred:0.033549871295690536, decouple_loss:0.028710179030895233
Iteration: 889, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506036043167114, gen p mean: -0.5152343511581421, mean p set: 0.4510838985443115
The modified gen p mean: 0.45147356390953064, gen p mean: -0.5259866118431091, mean p set: 0.45195385813713074
The modified gen p mean: 0.45122531056404114, gen p mean: -0.5283106565475464, mean p set: 0.45170560479164124
loss_pred:0.034404393285512924, decouple_loss:0.029363002628087997
loss_pred:0.03501766547560692, decouple_loss:0.027440588921308517
loss_pred:0.03309402987360954, decouple_loss:0.02734268270432949
Iteration: 890, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511801600456238, gen p mean: -0.5165209174156189, mean p set: 0.4516604542732239
The modified gen p mean: 0.4533981680870056, gen p mean: -0.5272828936576843, mean p set: 0.4538784623146057
The modified gen p mean: 0.452029287815094, gen p mean: -0.530428409576416, mean p set: 0.4525096118450165
loss_pred:0.03340274095535278, decouple_loss:0.02813652716577053
loss_pred:0.03275319188833237, decouple_loss:0.027393287047743797
loss_pred:0.033225055783987045, decouple_loss:0.028209911659359932
2023-05-02 20:07:27 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5179681181907654, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.5255101919174194, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5135990977287292, mean p set: 0.45035696029663086
loss_pred:0.03402387723326683, decouple_loss:0.030417678877711296
loss_pred:0.034995801746845245, decouple_loss:0.03135346621274948
loss_pred:0.03336941823363304, decouple_loss:0.031117718666791916
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03567785024642944, avg_mse: 0.03867194056510925
current test mse: 0.038672
Iteration: 891, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516017436981201, gen p mean: -0.5291163325309753, mean p set: 0.4520820379257202
loss_pred:0.03377791866660118, decouple_loss:0.027172060683369637
The modified gen p mean: 0.4489378333091736, gen p mean: -0.5102058053016663, mean p set: 0.4494180977344513
loss_pred:0.03213627263903618, decouple_loss:0.027882667258381844
The modified gen p mean: 0.45077207684516907, gen p mean: -0.5124570727348328, mean p set: 0.4512523412704468
loss_pred:0.034388817846775055, decouple_loss:0.02786303497850895
Iteration: 892, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450985848903656, gen p mean: -0.525174617767334, mean p set: 0.4514661431312561
The modified gen p mean: 0.4518691301345825, gen p mean: -0.5376070737838745, mean p set: 0.452349454164505
The modified gen p mean: 0.45160138607025146, gen p mean: -0.5353981256484985, mean p set: 0.4520816504955292
loss_pred:0.033061638474464417, decouple_loss:0.02786061353981495
loss_pred:0.03290528804063797, decouple_loss:0.02814377285540104
loss_pred:0.034093327820301056, decouple_loss:0.027521466836333275
Iteration: 893, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515172839164734, gen p mean: -0.5283413529396057, mean p set: 0.4519975483417511
The modified gen p mean: 0.45040854811668396, gen p mean: -0.5323836207389832, mean p set: 0.45088884234428406
The modified gen p mean: 0.45329049229621887, gen p mean: -0.5366113185882568, mean p set: 0.45377078652381897
loss_pred:0.0326726995408535, decouple_loss:0.027284059673547745
loss_pred:0.0347294844686985, decouple_loss:0.02916388027369976
loss_pred:0.03292819485068321, decouple_loss:0.02668903023004532
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 894, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480159282684326, gen p mean: -0.5147385597229004, mean p set: 0.4484962224960327
The modified gen p mean: 0.4478236734867096, gen p mean: -0.5184437036514282, mean p set: 0.4483039677143097
The modified gen p mean: 0.44869041442871094, gen p mean: -0.5181085467338562, mean p set: 0.44917070865631104
loss_pred:0.032509926706552505, decouple_loss:0.03075166419148445
loss_pred:0.034874532371759415, decouple_loss:0.02990587241947651
loss_pred:0.03482915461063385, decouple_loss:0.029581237584352493
Iteration: 895, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478985369205475, gen p mean: -0.5201362371444702, mean p set: 0.4483788311481476
The modified gen p mean: 0.44743579626083374, gen p mean: -0.5216028690338135, mean p set: 0.44791606068611145
The modified gen p mean: 0.4484599530696869, gen p mean: -0.5306215286254883, mean p set: 0.448940247297287
loss_pred:0.03448396921157837, decouple_loss:0.028980322182178497
loss_pred:0.03492404520511627, decouple_loss:0.02943938411772251
loss_pred:0.03529266268014908, decouple_loss:0.02866317518055439
Iteration: 896, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732311367988586, gen p mean: -0.513984203338623, mean p set: 0.44780340790748596
The modified gen p mean: 0.44752028584480286, gen p mean: -0.5098143815994263, mean p set: 0.44800058007240295
The modified gen p mean: 0.44769424200057983, gen p mean: -0.5087476968765259, mean p set: 0.44817450642585754
loss_pred:0.03385303169488907, decouple_loss:0.02996528148651123
loss_pred:0.032435618340969086, decouple_loss:0.029758214950561523
loss_pred:0.03435739502310753, decouple_loss:0.030289381742477417
Iteration: 897, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44747447967529297, gen p mean: -0.5011184215545654, mean p set: 0.4479547441005707
The modified gen p mean: 0.44849735498428345, gen p mean: -0.5049735903739929, mean p set: 0.44897761940956116
The modified gen p mean: 0.4469078481197357, gen p mean: -0.5031220316886902, mean p set: 0.4473881721496582
loss_pred:0.03302087262272835, decouple_loss:0.029252363368868828
loss_pred:0.033575184643268585, decouple_loss:0.02879280224442482
loss_pred:0.0345601849257946, decouple_loss:0.030096933245658875
Iteration: 898, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478203058242798, gen p mean: -0.49867182970046997, mean p set: 0.4483005702495575
The modified gen p mean: 0.44742700457572937, gen p mean: -0.5042779445648193, mean p set: 0.4479072690010071
The modified gen p mean: 0.445629358291626, gen p mean: -0.4960545301437378, mean p set: 0.4461096227169037
loss_pred:0.034270063042640686, decouple_loss:0.02807033434510231
loss_pred:0.03471749648451805, decouple_loss:0.02862664684653282
loss_pred:0.034387554973363876, decouple_loss:0.028959151357412338
Iteration: 899, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477022588253021, gen p mean: -0.5066542625427246, mean p set: 0.4481825828552246
The modified gen p mean: 0.4470200538635254, gen p mean: -0.5090494751930237, mean p set: 0.4475003480911255
The modified gen p mean: 0.44812050461769104, gen p mean: -0.5099542140960693, mean p set: 0.44860079884529114
loss_pred:0.033448342233896255, decouple_loss:0.028061917051672935
loss_pred:0.03327114135026932, decouple_loss:0.026999972760677338
loss_pred:0.03442692011594772, decouple_loss:0.029371552169322968
Iteration: 900, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486526548862457, gen p mean: -0.518010675907135, mean p set: 0.44913291931152344
The modified gen p mean: 0.44730570912361145, gen p mean: -0.5092827081680298, mean p set: 0.44778600335121155
The modified gen p mean: 0.4477179944515228, gen p mean: -0.5105486512184143, mean p set: 0.4481982886791229
loss_pred:0.03474118560552597, decouple_loss:0.029110237956047058
loss_pred:0.03433925285935402, decouple_loss:0.02784787118434906
loss_pred:0.032638661563396454, decouple_loss:0.027423569932579994
2023-05-02 20:11:46 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.5051600933074951, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.5123723745346069, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5011971592903137, mean p set: 0.45035696029663086
loss_pred:0.033562980592250824, decouple_loss:0.02799464762210846
loss_pred:0.03450717404484749, decouple_loss:0.029300296679139137
loss_pred:0.03263688459992409, decouple_loss:0.028442561626434326
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03499797359108925, avg_mse: 0.03776251897215843
current test mse: 0.037763
Iteration: 901, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44814231991767883, gen p mean: -0.5061196684837341, mean p set: 0.44862261414527893
The modified gen p mean: 0.4476092755794525, gen p mean: -0.49968838691711426, mean p set: 0.4480895698070526
loss_pred:0.032245561480522156, decouple_loss:0.027468176558613777
loss_pred:0.03338896110653877, decouple_loss:0.02753296308219433
The modified gen p mean: 0.44628408551216125, gen p mean: -0.49643877148628235, mean p set: 0.44676437973976135
loss_pred:0.03388971835374832, decouple_loss:0.028422683477401733
Iteration: 902, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812092185020447, gen p mean: -0.504071831703186, mean p set: 0.44860121607780457
The modified gen p mean: 0.4477331042289734, gen p mean: -0.5039029717445374, mean p set: 0.4482133686542511
The modified gen p mean: 0.44889020919799805, gen p mean: -0.5061070322990417, mean p set: 0.44937047362327576
loss_pred:0.03209969773888588, decouple_loss:0.02714100107550621
loss_pred:0.03337584063410759, decouple_loss:0.028170373290777206
loss_pred:0.03520211577415466, decouple_loss:0.029283488169312477
Iteration: 903, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741907715797424, gen p mean: -0.49818503856658936, mean p set: 0.44789940118789673
The modified gen p mean: 0.4472869336605072, gen p mean: -0.49966174364089966, mean p set: 0.4477671980857849
The modified gen p mean: 0.4477849304676056, gen p mean: -0.5017374753952026, mean p set: 0.4482652246952057
loss_pred:0.03459368273615837, decouple_loss:0.028076276183128357
loss_pred:0.03349746763706207, decouple_loss:0.026649339124560356
loss_pred:0.034290287643671036, decouple_loss:0.02761084958910942
Iteration: 904, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472866654396057, gen p mean: -0.5015228986740112, mean p set: 0.4477669298648834
The modified gen p mean: 0.446853905916214, gen p mean: -0.5056295394897461, mean p set: 0.4473342299461365
The modified gen p mean: 0.447234183549881, gen p mean: -0.5039066076278687, mean p set: 0.4477144777774811
loss_pred:0.03303711488842964, decouple_loss:0.026527928188443184
loss_pred:0.03354422748088837, decouple_loss:0.027698742225766182
loss_pred:0.03338097035884857, decouple_loss:0.027067093178629875
Iteration: 905, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487679898738861, gen p mean: -0.4992077052593231, mean p set: 0.44924822449684143
The modified gen p mean: 0.44695988297462463, gen p mean: -0.49782252311706543, mean p set: 0.4474402070045471
The modified gen p mean: 0.4477033019065857, gen p mean: -0.49709582328796387, mean p set: 0.4481835961341858
loss_pred:0.03386400267481804, decouple_loss:0.028615621849894524
loss_pred:0.03324825316667557, decouple_loss:0.027177218347787857
loss_pred:0.03398098424077034, decouple_loss:0.02677687630057335
Iteration: 906, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765475392341614, gen p mean: -0.4886828660964966, mean p set: 0.44813501834869385
The modified gen p mean: 0.448669970035553, gen p mean: -0.5022298693656921, mean p set: 0.4491502642631531
The modified gen p mean: 0.44597822427749634, gen p mean: -0.49223223328590393, mean p set: 0.44645851850509644
loss_pred:0.03403133526444435, decouple_loss:0.02817700430750847
loss_pred:0.03487274795770645, decouple_loss:0.0277119018137455
loss_pred:0.03407890722155571, decouple_loss:0.026900289580225945
Iteration: 907, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44647809863090515, gen p mean: -0.49088358879089355, mean p set: 0.44695839285850525
The modified gen p mean: 0.4478982090950012, gen p mean: -0.491915225982666, mean p set: 0.44837847352027893
The modified gen p mean: 0.4476260244846344, gen p mean: -0.49021756649017334, mean p set: 0.4481063485145569
loss_pred:0.03351153805851936, decouple_loss:0.02633911930024624
loss_pred:0.03264199569821358, decouple_loss:0.02598683163523674
loss_pred:0.03434205427765846, decouple_loss:0.027224136516451836
Iteration: 908, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474409818649292, gen p mean: -0.4917425811290741, mean p set: 0.4479212760925293
The modified gen p mean: 0.446382999420166, gen p mean: -0.48623931407928467, mean p set: 0.4468632936477661
The modified gen p mean: 0.44803979992866516, gen p mean: -0.4948131740093231, mean p set: 0.44852009415626526
loss_pred:0.03291347622871399, decouple_loss:0.0288471020758152
loss_pred:0.03285543993115425, decouple_loss:0.02677905559539795
loss_pred:0.03410952538251877, decouple_loss:0.027892878279089928
Iteration: 909, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475524127483368, gen p mean: -0.4883233606815338, mean p set: 0.4480327069759369
The modified gen p mean: 0.4474908709526062, gen p mean: -0.4924831688404083, mean p set: 0.4479711353778839
The modified gen p mean: 0.4472026228904724, gen p mean: -0.496559202671051, mean p set: 0.4476828873157501
loss_pred:0.03318781778216362, decouple_loss:0.026434877887368202
loss_pred:0.03376849740743637, decouple_loss:0.02697630599141121
loss_pred:0.03312181681394577, decouple_loss:0.026737507432699203
Iteration: 910, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481739103794098, gen p mean: -0.5094462633132935, mean p set: 0.4486541748046875
The modified gen p mean: 0.4467921853065491, gen p mean: -0.49915632605552673, mean p set: 0.44727250933647156
The modified gen p mean: 0.4471847116947174, gen p mean: -0.5016573667526245, mean p set: 0.4476650059223175
loss_pred:0.035103149712085724, decouple_loss:0.02901027724146843
loss_pred:0.03349637612700462, decouple_loss:0.02543485164642334
loss_pred:0.03348466753959656, decouple_loss:0.026488857343792915
2023-05-02 20:15:30 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5081343650817871, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.5149045586585999, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5036004781723022, mean p set: 0.45035696029663086
loss_pred:0.033453818410634995, decouple_loss:0.026744261384010315
loss_pred:0.03450595960021019, decouple_loss:0.02759454771876335
loss_pred:0.032616980373859406, decouple_loss:0.0271015465259552
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03488292545080185, avg_mse: 0.03780857473611832
current test mse: 0.037809
Iteration: 911, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467793107032776, gen p mean: -0.5036652088165283, mean p set: 0.4472596049308777
The modified gen p mean: 0.44838908314704895, gen p mean: -0.5103671550750732, mean p set: 0.44886934757232666
loss_pred:0.03365307301282883, decouple_loss:0.026281386613845825
loss_pred:0.03394521400332451, decouple_loss:0.02703044004738331
The modified gen p mean: 0.44864141941070557, gen p mean: -0.5068987607955933, mean p set: 0.4491216838359833
loss_pred:0.03418296203017235, decouple_loss:0.02756890095770359
Iteration: 912, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790807366371155, gen p mean: -0.5086575746536255, mean p set: 0.44838836789131165
The modified gen p mean: 0.4469403624534607, gen p mean: -0.5027120113372803, mean p set: 0.4474206268787384
The modified gen p mean: 0.44773608446121216, gen p mean: -0.506180465221405, mean p set: 0.44821637868881226
loss_pred:0.03210490942001343, decouple_loss:0.026029745116829872
loss_pred:0.03347913920879364, decouple_loss:0.026593200862407684
loss_pred:0.03308074176311493, decouple_loss:0.026939114555716515
Iteration: 913, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470370411872864, gen p mean: -0.4948730766773224, mean p set: 0.4475173056125641
The modified gen p mean: 0.4468739926815033, gen p mean: -0.49718177318573, mean p set: 0.4473542869091034
The modified gen p mean: 0.44654789566993713, gen p mean: -0.5039553642272949, mean p set: 0.4470282196998596
loss_pred:0.03355163708329201, decouple_loss:0.027000995352864265
loss_pred:0.03324998542666435, decouple_loss:0.025192677974700928
loss_pred:0.032858967781066895, decouple_loss:0.02619902975857258
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
NaN value num: 0
Iteration: 914, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522134065628052, gen p mean: -0.49351486563682556, mean p set: 0.45269373059272766
The modified gen p mean: 0.4506393373012543, gen p mean: -0.5046671628952026, mean p set: 0.45111966133117676
The modified gen p mean: 0.4522389769554138, gen p mean: -0.49665600061416626, mean p set: 0.45271924138069153
loss_pred:0.035283539444208145, decouple_loss:0.02937488630414009
loss_pred:0.035410184413194656, decouple_loss:0.02950366958975792
loss_pred:0.03526943549513817, decouple_loss:0.028736472129821777
Iteration: 915, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45123717188835144, gen p mean: -0.49835318326950073, mean p set: 0.45171743631362915
The modified gen p mean: 0.45109426975250244, gen p mean: -0.504325270652771, mean p set: 0.45157456398010254
The modified gen p mean: 0.4524232745170593, gen p mean: -0.49614477157592773, mean p set: 0.4529035687446594
loss_pred:0.03554866090416908, decouple_loss:0.0301351435482502
loss_pred:0.035295456647872925, decouple_loss:0.029406435787677765
loss_pred:0.03633976727724075, decouple_loss:0.02918953448534012
Iteration: 916, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45154717564582825, gen p mean: -0.49492254853248596, mean p set: 0.45202744007110596
The modified gen p mean: 0.4516293406486511, gen p mean: -0.5057445764541626, mean p set: 0.45210960507392883
The modified gen p mean: 0.45236605405807495, gen p mean: -0.5040076971054077, mean p set: 0.45284631848335266
loss_pred:0.036357332020998, decouple_loss:0.030226510018110275
loss_pred:0.03328850120306015, decouple_loss:0.028820665553212166
loss_pred:0.03433616831898689, decouple_loss:0.030142009258270264
Iteration: 917, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44991931319236755, gen p mean: -0.507379412651062, mean p set: 0.45039960741996765
The modified gen p mean: 0.45204871892929077, gen p mean: -0.5008993744850159, mean p set: 0.4525289833545685
The modified gen p mean: 0.4511075019836426, gen p mean: -0.5064229369163513, mean p set: 0.45158782601356506
loss_pred:0.03580484539270401, decouple_loss:0.029442522674798965
loss_pred:0.03584905341267586, decouple_loss:0.02988499402999878
loss_pred:0.03477509319782257, decouple_loss:0.028270510956645012
Iteration: 918, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525023102760315, gen p mean: -0.5130437612533569, mean p set: 0.4529826045036316
The modified gen p mean: 0.45179077982902527, gen p mean: -0.5195550918579102, mean p set: 0.45227110385894775
The modified gen p mean: 0.4519554674625397, gen p mean: -0.5097334980964661, mean p set: 0.45243576169013977
loss_pred:0.03529363498091698, decouple_loss:0.02796216495335102
loss_pred:0.03542757406830788, decouple_loss:0.029112812131643295
loss_pred:0.03585318475961685, decouple_loss:0.028671953827142715
Iteration: 919, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45225995779037476, gen p mean: -0.5130041241645813, mean p set: 0.45274025201797485
The modified gen p mean: 0.4531138837337494, gen p mean: -0.5063098669052124, mean p set: 0.4535941779613495
The modified gen p mean: 0.45016443729400635, gen p mean: -0.5131655335426331, mean p set: 0.45064473152160645
loss_pred:0.03557482734322548, decouple_loss:0.02856125310063362
loss_pred:0.03536677733063698, decouple_loss:0.026819437742233276
loss_pred:0.036021310836076736, decouple_loss:0.02833746373653412
Iteration: 920, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527318775653839, gen p mean: -0.5069363117218018, mean p set: 0.453212171792984
The modified gen p mean: 0.4503428339958191, gen p mean: -0.5086359977722168, mean p set: 0.4508230984210968
The modified gen p mean: 0.4497220814228058, gen p mean: -0.5159796476364136, mean p set: 0.4502023756504059
loss_pred:0.03566429018974304, decouple_loss:0.02770914137363434
loss_pred:0.0360751673579216, decouple_loss:0.028192615136504173
loss_pred:0.03413039818406105, decouple_loss:0.02848796918988228
2023-05-02 20:19:53 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5136834383010864, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.5206772089004517, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5091555118560791, mean p set: 0.45035696029663086
loss_pred:0.03328341990709305, decouple_loss:0.030303020030260086
loss_pred:0.03434855490922928, decouple_loss:0.03156507760286331
loss_pred:0.032626673579216, decouple_loss:0.030151037499308586
WV_0_PC_1_EH_0_PS_40_6, loss: 0.034953199326992035, avg_mse: 0.03771243616938591
current test mse: 0.037712
Iteration: 921, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507010281085968, gen p mean: -0.5152272582054138, mean p set: 0.4511813521385193
loss_pred:0.033976517617702484, decouple_loss:0.028386568650603294
The modified gen p mean: 0.45212918519973755, gen p mean: -0.5062479972839355, mean p set: 0.45260950922966003
loss_pred:0.036210279911756516, decouple_loss:0.028239931911230087
The modified gen p mean: 0.4526446461677551, gen p mean: -0.5105730891227722, mean p set: 0.4531249403953552
loss_pred:0.035470228642225266, decouple_loss:0.029521718621253967
Iteration: 922, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45240482687950134, gen p mean: -0.5099228024482727, mean p set: 0.45288509130477905
The modified gen p mean: 0.4491223990917206, gen p mean: -0.5057054758071899, mean p set: 0.4496026933193207
The modified gen p mean: 0.45259809494018555, gen p mean: -0.5218798518180847, mean p set: 0.45307838916778564
loss_pred:0.033789414912462234, decouple_loss:0.028757652267813683
loss_pred:0.035763710737228394, decouple_loss:0.028581878170371056
loss_pred:0.0346822589635849, decouple_loss:0.028888437896966934
Iteration: 923, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45107221603393555, gen p mean: -0.5092946290969849, mean p set: 0.45155251026153564
The modified gen p mean: 0.45230579376220703, gen p mean: -0.5046452283859253, mean p set: 0.45278608798980713
The modified gen p mean: 0.44984734058380127, gen p mean: -0.5073804259300232, mean p set: 0.45032763481140137
loss_pred:0.03484078869223595, decouple_loss:0.027917655184864998
loss_pred:0.03690756857395172, decouple_loss:0.028065333142876625
loss_pred:0.0355442650616169, decouple_loss:0.02812543325126171
Iteration: 924, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451688677072525, gen p mean: -0.5079340934753418, mean p set: 0.4521689713001251
The modified gen p mean: 0.45236918330192566, gen p mean: -0.5159788727760315, mean p set: 0.45284944772720337
The modified gen p mean: 0.453066885471344, gen p mean: -0.5231399536132812, mean p set: 0.4535471498966217
loss_pred:0.03490903601050377, decouple_loss:0.028717385604977608
loss_pred:0.03516031801700592, decouple_loss:0.027946842834353447
loss_pred:0.03444894775748253, decouple_loss:0.027739249169826508
Iteration: 925, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515971541404724, gen p mean: -0.5101642608642578, mean p set: 0.4520774781703949
The modified gen p mean: 0.45180806517601013, gen p mean: -0.5132184028625488, mean p set: 0.4522883892059326
The modified gen p mean: 0.45134252309799194, gen p mean: -0.5078341960906982, mean p set: 0.45182281732559204
loss_pred:0.03494016081094742, decouple_loss:0.027935821563005447
loss_pred:0.03458186984062195, decouple_loss:0.027461854740977287
loss_pred:0.03529256209731102, decouple_loss:0.028186239302158356
Iteration: 926, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498312771320343, gen p mean: -0.508996844291687, mean p set: 0.4503115713596344
The modified gen p mean: 0.45213136076927185, gen p mean: -0.5094428658485413, mean p set: 0.45261165499687195
The modified gen p mean: 0.45018839836120605, gen p mean: -0.5046573877334595, mean p set: 0.45066869258880615
loss_pred:0.0342896543443203, decouple_loss:0.02788165770471096
loss_pred:0.03315725550055504, decouple_loss:0.02882487326860428
loss_pred:0.03620386868715286, decouple_loss:0.027750015258789062
Iteration: 927, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519454538822174, gen p mean: -0.4989892542362213, mean p set: 0.4524257183074951
The modified gen p mean: 0.4511301815509796, gen p mean: -0.5071459412574768, mean p set: 0.4516104459762573
The modified gen p mean: 0.4509761333465576, gen p mean: -0.506084680557251, mean p set: 0.4514564573764801
loss_pred:0.03676995262503624, decouple_loss:0.027360495179891586
loss_pred:0.03511471673846245, decouple_loss:0.02717779204249382
loss_pred:0.03494416922330856, decouple_loss:0.02704458124935627
Iteration: 928, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516649544239044, gen p mean: -0.5067151784896851, mean p set: 0.4521452486515045
The modified gen p mean: 0.4520719349384308, gen p mean: -0.5148584842681885, mean p set: 0.45255225896835327
The modified gen p mean: 0.4530324935913086, gen p mean: -0.507212221622467, mean p set: 0.4535127878189087
loss_pred:0.03485104441642761, decouple_loss:0.02684943564236164
loss_pred:0.03270436450839043, decouple_loss:0.027871103957295418
loss_pred:0.03560417890548706, decouple_loss:0.02804945409297943
Iteration: 929, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502890110015869, gen p mean: -0.5222957730293274, mean p set: 0.450769305229187
The modified gen p mean: 0.45337700843811035, gen p mean: -0.5157859325408936, mean p set: 0.45385733246803284
The modified gen p mean: 0.4515398144721985, gen p mean: -0.5164218544960022, mean p set: 0.4520201086997986
loss_pred:0.03468227759003639, decouple_loss:0.027364550158381462
loss_pred:0.03572811558842659, decouple_loss:0.02788476273417473
loss_pred:0.034088168293237686, decouple_loss:0.02643253281712532
Iteration: 930, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45062482357025146, gen p mean: -0.5189141035079956, mean p set: 0.4511050879955292
The modified gen p mean: 0.45305564999580383, gen p mean: -0.512428879737854, mean p set: 0.4535359740257263
The modified gen p mean: 0.44985443353652954, gen p mean: -0.5139952301979065, mean p set: 0.450334757566452
loss_pred:0.035468339920043945, decouple_loss:0.027536120265722275
loss_pred:0.035786986351013184, decouple_loss:0.027582349255681038
loss_pred:0.03566755726933479, decouple_loss:0.027729766443371773
2023-05-02 20:23:37 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.5174092054367065, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.5107390880584717, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5071142911911011, mean p set: 0.45035696029663086
loss_pred:0.034318216145038605, decouple_loss:0.03031294234097004
loss_pred:0.03321541100740433, decouple_loss:0.028891434893012047
loss_pred:0.03250949829816818, decouple_loss:0.028962086886167526
WV_0_PC_1_EH_0_PS_40_6, loss: 0.034817151725292206, avg_mse: 0.037663355469703674
current test mse: 0.037663
Iteration: 931, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513130486011505, gen p mean: -0.5069379210472107, mean p set: 0.4517933130264282
loss_pred:0.034948691725730896, decouple_loss:0.02696661837399006
The modified gen p mean: 0.4513815939426422, gen p mean: -0.49812862277030945, mean p set: 0.4518618583679199
loss_pred:0.034657400101423264, decouple_loss:0.02714712917804718
The modified gen p mean: 0.4525221884250641, gen p mean: -0.5066971778869629, mean p set: 0.4530024528503418
loss_pred:0.034863945096731186, decouple_loss:0.02646525949239731
Iteration: 932, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45186764001846313, gen p mean: -0.5066033005714417, mean p set: 0.45234790444374084
The modified gen p mean: 0.45281991362571716, gen p mean: -0.5039399862289429, mean p set: 0.4533001780509949
The modified gen p mean: 0.4503718912601471, gen p mean: -0.5080206394195557, mean p set: 0.4508522152900696
loss_pred:0.034965790808200836, decouple_loss:0.026976212859153748
loss_pred:0.03575965017080307, decouple_loss:0.028038889169692993
loss_pred:0.03524664416909218, decouple_loss:0.02622063457965851
Iteration: 933, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498354196548462, gen p mean: -0.5148378610610962, mean p set: 0.4503157436847687
The modified gen p mean: 0.4519249200820923, gen p mean: -0.5219765305519104, mean p set: 0.45240524411201477
The modified gen p mean: 0.4527330696582794, gen p mean: -0.5110193490982056, mean p set: 0.45321333408355713
loss_pred:0.03424063324928284, decouple_loss:0.027060862630605698
loss_pred:0.034933291375637054, decouple_loss:0.027969274669885635
loss_pred:0.035451438277959824, decouple_loss:0.028129586949944496
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
NaN value num: 0
Iteration: 934, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494636654853821, gen p mean: -0.5210839509963989, mean p set: 0.4499439597129822
The modified gen p mean: 0.45310527086257935, gen p mean: -0.539198100566864, mean p set: 0.45358556509017944
The modified gen p mean: 0.4510310888290405, gen p mean: -0.5200661420822144, mean p set: 0.4515113830566406
loss_pred:0.03295537084341049, decouple_loss:0.03126607835292816
loss_pred:0.033019617199897766, decouple_loss:0.02956346981227398
loss_pred:0.033142052590847015, decouple_loss:0.02898777835071087
Iteration: 935, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4548640251159668, gen p mean: -0.5422247648239136, mean p set: 0.4553443193435669
The modified gen p mean: 0.45161470770835876, gen p mean: -0.5349961519241333, mean p set: 0.45209503173828125
The modified gen p mean: 0.4531160593032837, gen p mean: -0.5488334894180298, mean p set: 0.4535963535308838
loss_pred:0.03267817571759224, decouple_loss:0.03163228556513786
loss_pred:0.03239481523633003, decouple_loss:0.031120704486966133
loss_pred:0.03271983563899994, decouple_loss:0.030371837317943573
Iteration: 936, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527290463447571, gen p mean: -0.539715588092804, mean p set: 0.4532093107700348
The modified gen p mean: 0.4530911147594452, gen p mean: -0.5433833599090576, mean p set: 0.4535713791847229
The modified gen p mean: 0.45228126645088196, gen p mean: -0.5460807085037231, mean p set: 0.45276156067848206
loss_pred:0.03254076465964317, decouple_loss:0.030628206208348274
loss_pred:0.03234947845339775, decouple_loss:0.030871516093611717
loss_pred:0.032762981951236725, decouple_loss:0.029922228306531906
Iteration: 937, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45174407958984375, gen p mean: -0.5462570190429688, mean p set: 0.45222437381744385
The modified gen p mean: 0.4505912661552429, gen p mean: -0.5344863533973694, mean p set: 0.451071560382843
The modified gen p mean: 0.45042431354522705, gen p mean: -0.5302492380142212, mean p set: 0.45090457797050476
loss_pred:0.03279581293463707, decouple_loss:0.030652254819869995
loss_pred:0.03314656391739845, decouple_loss:0.029729964211583138
loss_pred:0.03238113597035408, decouple_loss:0.029529333114624023
Iteration: 938, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45024573802948, gen p mean: -0.5242008566856384, mean p set: 0.4507260322570801
The modified gen p mean: 0.4497024118900299, gen p mean: -0.5178830027580261, mean p set: 0.45018270611763
The modified gen p mean: 0.4504230320453644, gen p mean: -0.5192486643791199, mean p set: 0.4509033262729645
loss_pred:0.032954853028059006, decouple_loss:0.03089827299118042
loss_pred:0.031393032521009445, decouple_loss:0.029924824833869934
loss_pred:0.032515961676836014, decouple_loss:0.029074154794216156
Iteration: 939, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45198854804039, gen p mean: -0.5261291861534119, mean p set: 0.4524688422679901
The modified gen p mean: 0.4511702358722687, gen p mean: -0.5184948444366455, mean p set: 0.4516505002975464
The modified gen p mean: 0.4506039619445801, gen p mean: -0.5084676742553711, mean p set: 0.45108428597450256
loss_pred:0.03250071778893471, decouple_loss:0.02869676984846592
loss_pred:0.03206528350710869, decouple_loss:0.029415512457489967
loss_pred:0.03371095284819603, decouple_loss:0.028909999877214432
Iteration: 940, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45258834958076477, gen p mean: -0.5138267278671265, mean p set: 0.45306864380836487
The modified gen p mean: 0.45404502749443054, gen p mean: -0.5285261273384094, mean p set: 0.45452532172203064
The modified gen p mean: 0.4519380033016205, gen p mean: -0.5211086273193359, mean p set: 0.4524182975292206
loss_pred:0.03331534564495087, decouple_loss:0.029231565073132515
loss_pred:0.03324396535754204, decouple_loss:0.02885568141937256
loss_pred:0.03264308348298073, decouple_loss:0.028254657983779907
2023-05-02 20:28:00 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5152571201324463, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.5227727890014648, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5117960572242737, mean p set: 0.45035696029663086
loss_pred:0.03324349969625473, decouple_loss:0.02940732054412365
loss_pred:0.03427128121256828, decouple_loss:0.030499622225761414
loss_pred:0.03258224204182625, decouple_loss:0.030298706144094467
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03486910089850426, avg_mse: 0.03777385503053665
current test mse: 0.037774
Iteration: 941, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45117464661598206, gen p mean: -0.5159660577774048, mean p set: 0.45165497064590454
loss_pred:0.033929530531167984, decouple_loss:0.028546731919050217
The modified gen p mean: 0.4515925645828247, gen p mean: -0.5174861550331116, mean p set: 0.4520728290081024
loss_pred:0.031288377940654755, decouple_loss:0.02943873405456543
The modified gen p mean: 0.4505560100078583, gen p mean: -0.5128786563873291, mean p set: 0.4510363042354584
loss_pred:0.03222973644733429, decouple_loss:0.027638617902994156
Iteration: 942, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493984580039978, gen p mean: -0.5202480554580688, mean p set: 0.4498787522315979
The modified gen p mean: 0.45038139820098877, gen p mean: -0.5179665684700012, mean p set: 0.45086169242858887
The modified gen p mean: 0.45183470845222473, gen p mean: -0.5260629653930664, mean p set: 0.45231500267982483
loss_pred:0.030542507767677307, decouple_loss:0.02893688529729843
loss_pred:0.033740125596523285, decouple_loss:0.02865266054868698
loss_pred:0.031473614275455475, decouple_loss:0.02914775162935257
Iteration: 943, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505847990512848, gen p mean: -0.526663601398468, mean p set: 0.4510650634765625
The modified gen p mean: 0.4519652724266052, gen p mean: -0.5406813621520996, mean p set: 0.4524455666542053
The modified gen p mean: 0.4523387849330902, gen p mean: -0.5367109179496765, mean p set: 0.4528190791606903
loss_pred:0.032398972660303116, decouple_loss:0.027826711535453796
loss_pred:0.03230706602334976, decouple_loss:0.02780529111623764
loss_pred:0.032180942595005035, decouple_loss:0.02806216850876808
Iteration: 944, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451201468706131, gen p mean: -0.5294098854064941, mean p set: 0.4516817331314087
The modified gen p mean: 0.45240914821624756, gen p mean: -0.5303037762641907, mean p set: 0.45288947224617004
The modified gen p mean: 0.4507555365562439, gen p mean: -0.5243145227432251, mean p set: 0.451235830783844
loss_pred:0.03201104328036308, decouple_loss:0.02849116176366806
loss_pred:0.03246849775314331, decouple_loss:0.027383143082261086
loss_pred:0.03124297969043255, decouple_loss:0.026737596839666367
Iteration: 945, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977107644081116, gen p mean: -0.5123482942581177, mean p set: 0.45025137066841125
The modified gen p mean: 0.45290035009384155, gen p mean: -0.516257107257843, mean p set: 0.45338064432144165
The modified gen p mean: 0.4518640637397766, gen p mean: -0.5175814628601074, mean p set: 0.4523443579673767
loss_pred:0.031616292893886566, decouple_loss:0.02793063037097454
loss_pred:0.033565014600753784, decouple_loss:0.028669485822319984
loss_pred:0.03217369690537453, decouple_loss:0.028066309168934822
Iteration: 946, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4540459215641022, gen p mean: -0.5211774706840515, mean p set: 0.45452621579170227
The modified gen p mean: 0.4501189887523651, gen p mean: -0.5102151036262512, mean p set: 0.4505993127822876
The modified gen p mean: 0.4503896236419678, gen p mean: -0.5149499773979187, mean p set: 0.45086991786956787
loss_pred:0.03124927543103695, decouple_loss:0.02913333848118782
loss_pred:0.032703008502721786, decouple_loss:0.0277955774217844
loss_pred:0.03223134204745293, decouple_loss:0.028330162167549133
Iteration: 947, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45273318886756897, gen p mean: -0.5257611870765686, mean p set: 0.45321348309516907
The modified gen p mean: 0.45334434509277344, gen p mean: -0.515816867351532, mean p set: 0.45382463932037354
The modified gen p mean: 0.4534416198730469, gen p mean: -0.5136789083480835, mean p set: 0.453921914100647
loss_pred:0.03193189203739166, decouple_loss:0.027325445786118507
loss_pred:0.03329164534807205, decouple_loss:0.026886632665991783
loss_pred:0.03277060389518738, decouple_loss:0.027640515938401222
Iteration: 948, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450573205947876, gen p mean: -0.5231457352638245, mean p set: 0.45105352997779846
The modified gen p mean: 0.4507405161857605, gen p mean: -0.5317268371582031, mean p set: 0.4512208104133606
The modified gen p mean: 0.45217084884643555, gen p mean: -0.5277037620544434, mean p set: 0.45265111327171326
loss_pred:0.03351910784840584, decouple_loss:0.026835886761546135
loss_pred:0.032023053616285324, decouple_loss:0.02793320268392563
loss_pred:0.03255561366677284, decouple_loss:0.027249954640865326
Iteration: 949, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532493054866791, gen p mean: -0.5369776487350464, mean p set: 0.4537295699119568
The modified gen p mean: 0.4528244435787201, gen p mean: -0.5369583964347839, mean p set: 0.4533047676086426
The modified gen p mean: 0.452301561832428, gen p mean: -0.5424187183380127, mean p set: 0.4527818560600281
loss_pred:0.031693655997514725, decouple_loss:0.02718127891421318
loss_pred:0.03260333836078644, decouple_loss:0.026329709216952324
loss_pred:0.031909164041280746, decouple_loss:0.026763971894979477
Iteration: 950, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45194631814956665, gen p mean: -0.5405411720275879, mean p set: 0.45242658257484436
The modified gen p mean: 0.4525851309299469, gen p mean: -0.5371766686439514, mean p set: 0.453065425157547
The modified gen p mean: 0.44958359003067017, gen p mean: -0.5333712100982666, mean p set: 0.45006391406059265
loss_pred:0.03258641064167023, decouple_loss:0.02731054276227951
loss_pred:0.03258751332759857, decouple_loss:0.026020606979727745
loss_pred:0.03047914244234562, decouple_loss:0.027059169486165047
2023-05-02 20:31:44 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5261444449424744, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.5342811346054077, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5225886702537537, mean p set: 0.45035696029663086
loss_pred:0.033070020377635956, decouple_loss:0.029041606932878494
loss_pred:0.03422946855425835, decouple_loss:0.03082546591758728
loss_pred:0.032303586602211, decouple_loss:0.029858332127332687
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03469645231962204, avg_mse: 0.037543199956417084
current test mse: 0.037543
Iteration: 951, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512365162372589, gen p mean: -0.52720046043396, mean p set: 0.451716810464859
loss_pred:0.03217901289463043, decouple_loss:0.027232209220528603
The modified gen p mean: 0.45204100012779236, gen p mean: -0.5303800106048584, mean p set: 0.45252126455307007
loss_pred:0.03152428939938545, decouple_loss:0.02745763771235943
The modified gen p mean: 0.45383355021476746, gen p mean: -0.5301162600517273, mean p set: 0.45431381464004517
loss_pred:0.03205658495426178, decouple_loss:0.026933666318655014
Iteration: 952, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.454100102186203, gen p mean: -0.5339674353599548, mean p set: 0.4545804262161255
The modified gen p mean: 0.45040595531463623, gen p mean: -0.5278449058532715, mean p set: 0.45088624954223633
The modified gen p mean: 0.4514361321926117, gen p mean: -0.524031937122345, mean p set: 0.4519164264202118
loss_pred:0.03313722461462021, decouple_loss:0.027789540588855743
loss_pred:0.03269621357321739, decouple_loss:0.02738301269710064
loss_pred:0.03288848325610161, decouple_loss:0.02670692279934883
Iteration: 953, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513079524040222, gen p mean: -0.5239368677139282, mean p set: 0.4517882466316223
The modified gen p mean: 0.4499375522136688, gen p mean: -0.51205974817276, mean p set: 0.4504178762435913
The modified gen p mean: 0.45201167464256287, gen p mean: -0.5199099779129028, mean p set: 0.45249199867248535
loss_pred:0.032130781561136246, decouple_loss:0.026383358985185623
loss_pred:0.032513752579689026, decouple_loss:0.026560721918940544
loss_pred:0.032748714089393616, decouple_loss:0.026033125817775726
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
NaN value num: 0
Iteration: 954, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45080551505088806, gen p mean: -0.5266730189323425, mean p set: 0.45128580927848816
The modified gen p mean: 0.45059874653816223, gen p mean: -0.5262536406517029, mean p set: 0.45107904076576233
The modified gen p mean: 0.4512452185153961, gen p mean: -0.5260368585586548, mean p set: 0.4517255127429962
loss_pred:0.032386668026447296, decouple_loss:0.02809424139559269
loss_pred:0.031946394592523575, decouple_loss:0.027249963954091072
loss_pred:0.03218105062842369, decouple_loss:0.026643551886081696
Iteration: 955, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44925418496131897, gen p mean: -0.5403997898101807, mean p set: 0.4497344493865967
The modified gen p mean: 0.45221543312072754, gen p mean: -0.5461084842681885, mean p set: 0.45269572734832764
The modified gen p mean: 0.4512547254562378, gen p mean: -0.546789824962616, mean p set: 0.4517350196838379
loss_pred:0.03228889778256416, decouple_loss:0.027581268921494484
loss_pred:0.031053587794303894, decouple_loss:0.027049647644162178
loss_pred:0.032615069299936295, decouple_loss:0.026820560917258263
Iteration: 956, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488845467567444, gen p mean: -0.5368689298629761, mean p set: 0.4493648409843445
The modified gen p mean: 0.45266130566596985, gen p mean: -0.5462055206298828, mean p set: 0.45314162969589233
The modified gen p mean: 0.4520755112171173, gen p mean: -0.5447595715522766, mean p set: 0.4525558054447174
loss_pred:0.032632872462272644, decouple_loss:0.02803266979753971
loss_pred:0.03327939286828041, decouple_loss:0.027595683932304382
loss_pred:0.03190366551280022, decouple_loss:0.026971930637955666
Iteration: 957, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504566192626953, gen p mean: -0.5243473052978516, mean p set: 0.4509369134902954
The modified gen p mean: 0.45084866881370544, gen p mean: -0.5234725475311279, mean p set: 0.45132896304130554
The modified gen p mean: 0.45225515961647034, gen p mean: -0.5293399691581726, mean p set: 0.45273545384407043
loss_pred:0.03408973291516304, decouple_loss:0.026958828791975975
loss_pred:0.03327510133385658, decouple_loss:0.027014676481485367
loss_pred:0.03250555694103241, decouple_loss:0.027242183685302734
Iteration: 958, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45236364006996155, gen p mean: -0.5171163082122803, mean p set: 0.45284390449523926
The modified gen p mean: 0.4493904411792755, gen p mean: -0.5174782276153564, mean p set: 0.4498707354068756
The modified gen p mean: 0.45213818550109863, gen p mean: -0.5181283354759216, mean p set: 0.45261847972869873
loss_pred:0.03328508138656616, decouple_loss:0.027161557227373123
loss_pred:0.03266511112451553, decouple_loss:0.02722831815481186
loss_pred:0.03308666869997978, decouple_loss:0.027361145243048668
Iteration: 959, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496880769729614, gen p mean: -0.5192608833312988, mean p set: 0.4501683712005615
The modified gen p mean: 0.44923752546310425, gen p mean: -0.519150972366333, mean p set: 0.44971778988838196
The modified gen p mean: 0.4497973322868347, gen p mean: -0.5220193862915039, mean p set: 0.4502776563167572
loss_pred:0.03361993655562401, decouple_loss:0.02598516084253788
loss_pred:0.03226865455508232, decouple_loss:0.02660476043820381
loss_pred:0.032338738441467285, decouple_loss:0.027764778584241867
Iteration: 960, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45158591866493225, gen p mean: -0.5371620059013367, mean p set: 0.45206621289253235
The modified gen p mean: 0.4514947533607483, gen p mean: -0.5434830188751221, mean p set: 0.451975017786026
The modified gen p mean: 0.4513476490974426, gen p mean: -0.5405671000480652, mean p set: 0.45182791352272034
loss_pred:0.03272469714283943, decouple_loss:0.02676871046423912
loss_pred:0.03213402256369591, decouple_loss:0.02698713168501854
loss_pred:0.03275724872946739, decouple_loss:0.02729084901511669
2023-05-02 20:36:03 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.5494394302368164, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5412704944610596, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.537876307964325, mean p set: 0.45035696029663086
loss_pred:0.03435904532670975, decouple_loss:0.03024146892130375
loss_pred:0.03317880257964134, decouple_loss:0.029073458164930344
loss_pred:0.032527223229408264, decouple_loss:0.029941456392407417
WV_0_PC_1_EH_0_PS_40_6, loss: 0.034842632710933685, avg_mse: 0.03784876689314842
current test mse: 0.037849
Iteration: 961, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45053964853286743, gen p mean: -0.5393602848052979, mean p set: 0.4510199725627899
The modified gen p mean: 0.4514922797679901, gen p mean: -0.5405703186988831, mean p set: 0.4519725739955902
loss_pred:0.03298778831958771, decouple_loss:0.025543654337525368
loss_pred:0.03313237428665161, decouple_loss:0.025623803958296776
The modified gen p mean: 0.4485553801059723, gen p mean: -0.535081684589386, mean p set: 0.4490357041358948
loss_pred:0.03220333158969879, decouple_loss:0.027909275144338608
Iteration: 962, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514225125312805, gen p mean: -0.5405666828155518, mean p set: 0.4519027769565582
The modified gen p mean: 0.45076581835746765, gen p mean: -0.5402684807777405, mean p set: 0.45124614238739014
The modified gen p mean: 0.4499387741088867, gen p mean: -0.5337684750556946, mean p set: 0.4504190683364868
loss_pred:0.030976256355643272, decouple_loss:0.026118243113160133
loss_pred:0.03273259103298187, decouple_loss:0.026459984481334686
loss_pred:0.03371329605579376, decouple_loss:0.02753308042883873
Iteration: 963, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45052701234817505, gen p mean: -0.5291695594787598, mean p set: 0.45100730657577515
The modified gen p mean: 0.45272067189216614, gen p mean: -0.5281971096992493, mean p set: 0.45320096611976624
The modified gen p mean: 0.4491153657436371, gen p mean: -0.5263206958770752, mean p set: 0.44959568977355957
loss_pred:0.033751606941223145, decouple_loss:0.027216020971536636
loss_pred:0.0331011638045311, decouple_loss:0.027352795004844666
loss_pred:0.03261275216937065, decouple_loss:0.025196827948093414
Iteration: 964, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497767388820648, gen p mean: -0.5269970893859863, mean p set: 0.4502570331096649
The modified gen p mean: 0.4515460431575775, gen p mean: -0.537972629070282, mean p set: 0.4520263373851776
The modified gen p mean: 0.4491099715232849, gen p mean: -0.5265008807182312, mean p set: 0.4495902955532074
loss_pred:0.033968064934015274, decouple_loss:0.026652000844478607
loss_pred:0.03186254948377609, decouple_loss:0.025770027190446854
loss_pred:0.03168484568595886, decouple_loss:0.025621619075536728
Iteration: 965, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532161355018616, gen p mean: -0.5281473398208618, mean p set: 0.4536963999271393
The modified gen p mean: 0.4512578845024109, gen p mean: -0.535269558429718, mean p set: 0.451738178730011
The modified gen p mean: 0.45051443576812744, gen p mean: -0.5256185531616211, mean p set: 0.45099470019340515
loss_pred:0.032443247735500336, decouple_loss:0.027615103870630264
loss_pred:0.03242100775241852, decouple_loss:0.025131814181804657
loss_pred:0.03357849642634392, decouple_loss:0.026188991963863373
Iteration: 966, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45051953196525574, gen p mean: -0.5207984447479248, mean p set: 0.45099982619285583
The modified gen p mean: 0.4508567154407501, gen p mean: -0.5191117525100708, mean p set: 0.45133697986602783
The modified gen p mean: 0.4496833384037018, gen p mean: -0.5159347653388977, mean p set: 0.4501636028289795
loss_pred:0.03308712691068649, decouple_loss:0.025816788896918297
loss_pred:0.032997582107782364, decouple_loss:0.026137737557291985
loss_pred:0.033079661428928375, decouple_loss:0.027680139988660812
Iteration: 967, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45077332854270935, gen p mean: -0.5273846387863159, mean p set: 0.45125362277030945
The modified gen p mean: 0.4494071900844574, gen p mean: -0.5161679983139038, mean p set: 0.4498874545097351
The modified gen p mean: 0.45173248648643494, gen p mean: -0.5229381918907166, mean p set: 0.45221275091171265
loss_pred:0.03178389370441437, decouple_loss:0.026622872799634933
loss_pred:0.031897369772195816, decouple_loss:0.02705618366599083
loss_pred:0.03274925425648689, decouple_loss:0.025730501860380173
Iteration: 968, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45004647970199585, gen p mean: -0.5225434899330139, mean p set: 0.45052674412727356
The modified gen p mean: 0.4487006366252899, gen p mean: -0.516949474811554, mean p set: 0.44918093085289
The modified gen p mean: 0.4509755074977875, gen p mean: -0.52081298828125, mean p set: 0.4514558017253876
loss_pred:0.032541923224925995, decouple_loss:0.026604942977428436
loss_pred:0.03262853994965553, decouple_loss:0.02703290805220604
loss_pred:0.03320731595158577, decouple_loss:0.025570638477802277
Iteration: 969, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45043182373046875, gen p mean: -0.5201129913330078, mean p set: 0.45091211795806885
The modified gen p mean: 0.4496020972728729, gen p mean: -0.5148449540138245, mean p set: 0.450082391500473
The modified gen p mean: 0.44974735379219055, gen p mean: -0.5173423886299133, mean p set: 0.45022767782211304
loss_pred:0.03312771022319794, decouple_loss:0.024850178509950638
loss_pred:0.032300595194101334, decouple_loss:0.02607041224837303
loss_pred:0.033473774790763855, decouple_loss:0.02512548863887787
Iteration: 970, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531627595424652, gen p mean: -0.5221646428108215, mean p set: 0.4536430835723877
The modified gen p mean: 0.45182403922080994, gen p mean: -0.518484890460968, mean p set: 0.4523043632507324
The modified gen p mean: 0.451339989900589, gen p mean: -0.5155527591705322, mean p set: 0.4518203139305115
loss_pred:0.03384479507803917, decouple_loss:0.026579122990369797
loss_pred:0.03173891827464104, decouple_loss:0.02690589427947998
loss_pred:0.03261730819940567, decouple_loss:0.026038886979222298
2023-05-02 20:39:45 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.5357260704040527, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5275806784629822, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987669587135315, gen p mean: -0.5242401361465454, mean p set: 0.45035696029663086
loss_pred:0.034117069095373154, decouple_loss:0.028730666264891624
loss_pred:0.03303724154829979, decouple_loss:0.027856843546032906
loss_pred:0.03227197751402855, decouple_loss:0.028260178864002228
WV_0_PC_1_EH_0_PS_40_6, loss: 0.034556224942207336, avg_mse: 0.03763669356703758
current test mse: 0.037637
Iteration: 971, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45129385590553284, gen p mean: -0.5328004956245422, mean p set: 0.45177412033081055
The modified gen p mean: 0.4489477574825287, gen p mean: -0.5224042534828186, mean p set: 0.4494280517101288
loss_pred:0.03143840283155441, decouple_loss:0.02642364613711834
loss_pred:0.031531281769275665, decouple_loss:0.02558748982846737
The modified gen p mean: 0.44854339957237244, gen p mean: -0.5224596858024597, mean p set: 0.44902369379997253
loss_pred:0.03245339170098305, decouple_loss:0.02551121823489666
Iteration: 972, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45371267199516296, gen p mean: -0.5366179943084717, mean p set: 0.4541929364204407
The modified gen p mean: 0.4515613913536072, gen p mean: -0.5367578864097595, mean p set: 0.4520416855812073
The modified gen p mean: 0.4521658420562744, gen p mean: -0.5380461812019348, mean p set: 0.4526461362838745
loss_pred:0.03246133029460907, decouple_loss:0.0261100921779871
loss_pred:0.032152675092220306, decouple_loss:0.02578587271273136
loss_pred:0.03144953027367592, decouple_loss:0.025657929480075836
Iteration: 973, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45270466804504395, gen p mean: -0.5277117490768433, mean p set: 0.45318490266799927
The modified gen p mean: 0.45160946249961853, gen p mean: -0.5341976284980774, mean p set: 0.452089786529541
The modified gen p mean: 0.45130518078804016, gen p mean: -0.5368899703025818, mean p set: 0.45178547501564026
loss_pred:0.03323020040988922, decouple_loss:0.026984121650457382
loss_pred:0.03070222958922386, decouple_loss:0.025984346866607666
loss_pred:0.03184689208865166, decouple_loss:0.025399724021553993
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 974, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44941654801368713, gen p mean: -0.5249292254447937, mean p set: 0.4498968720436096
The modified gen p mean: 0.44969743490219116, gen p mean: -0.5286112427711487, mean p set: 0.45017769932746887
The modified gen p mean: 0.44905537366867065, gen p mean: -0.5325545072555542, mean p set: 0.44953563809394836
loss_pred:0.03130432218313217, decouple_loss:0.028461752459406853
loss_pred:0.03256682679057121, decouple_loss:0.027370726689696312
loss_pred:0.03167140111327171, decouple_loss:0.02912323735654354
Iteration: 975, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44956204295158386, gen p mean: -0.5295660495758057, mean p set: 0.4500423073768616
The modified gen p mean: 0.4490041434764862, gen p mean: -0.5323149561882019, mean p set: 0.4494844079017639
The modified gen p mean: 0.4504186511039734, gen p mean: -0.5329750180244446, mean p set: 0.4508989155292511
loss_pred:0.03264591097831726, decouple_loss:0.028548551723361015
loss_pred:0.03302965313196182, decouple_loss:0.028020333498716354
loss_pred:0.03131682053208351, decouple_loss:0.02642936073243618
Iteration: 976, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500689208507538, gen p mean: -0.5236465930938721, mean p set: 0.4505492150783539
The modified gen p mean: 0.4491523504257202, gen p mean: -0.5291709899902344, mean p set: 0.4496326744556427
The modified gen p mean: 0.44825124740600586, gen p mean: -0.5212559103965759, mean p set: 0.44873154163360596
loss_pred:0.03108382225036621, decouple_loss:0.026474643498659134
loss_pred:0.03288966044783592, decouple_loss:0.026333872228860855
loss_pred:0.032264482229948044, decouple_loss:0.02637585997581482
Iteration: 977, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472036063671112, gen p mean: -0.5182215571403503, mean p set: 0.4476839303970337
The modified gen p mean: 0.4499109387397766, gen p mean: -0.5222452282905579, mean p set: 0.4503912329673767
The modified gen p mean: 0.4498547613620758, gen p mean: -0.5232998132705688, mean p set: 0.4503350555896759
loss_pred:0.03211929649114609, decouple_loss:0.026524880900979042
loss_pred:0.030288169160485268, decouple_loss:0.025646306574344635
loss_pred:0.031144965440034866, decouple_loss:0.027086682617664337
Iteration: 978, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502430558204651, gen p mean: -0.525436282157898, mean p set: 0.4507233798503876
The modified gen p mean: 0.44931894540786743, gen p mean: -0.5215521454811096, mean p set: 0.4497992694377899
The modified gen p mean: 0.4487708508968353, gen p mean: -0.5280582308769226, mean p set: 0.4492511451244354
loss_pred:0.03211374953389168, decouple_loss:0.027185585349798203
loss_pred:0.031770624220371246, decouple_loss:0.026786642149090767
loss_pred:0.033526770770549774, decouple_loss:0.025675293058156967
Iteration: 979, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501170217990875, gen p mean: -0.5318170189857483, mean p set: 0.4505973160266876
The modified gen p mean: 0.4494454860687256, gen p mean: -0.5287365913391113, mean p set: 0.4499257802963257
The modified gen p mean: 0.4507712423801422, gen p mean: -0.5285215973854065, mean p set: 0.4512515664100647
loss_pred:0.033272746950387955, decouple_loss:0.026061780750751495
loss_pred:0.03326656296849251, decouple_loss:0.02576358988881111
loss_pred:0.031902942806482315, decouple_loss:0.0269070602953434
Iteration: 980, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494057893753052, gen p mean: -0.5352174639701843, mean p set: 0.4498860538005829
The modified gen p mean: 0.4492276608943939, gen p mean: -0.5279570817947388, mean p set: 0.449707955121994
The modified gen p mean: 0.4478796720504761, gen p mean: -0.528398334980011, mean p set: 0.44835996627807617
loss_pred:0.03335209935903549, decouple_loss:0.025505395606160164
loss_pred:0.03228823468089104, decouple_loss:0.02674797922372818
loss_pred:0.033226922154426575, decouple_loss:0.02562347613275051
2023-05-02 20:44:08 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.5386019945144653, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5302032828330994, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5265804529190063, mean p set: 0.45035696029663086
loss_pred:0.03366180136799812, decouple_loss:0.02728222869336605
loss_pred:0.0326429158449173, decouple_loss:0.026021424680948257
loss_pred:0.03194541856646538, decouple_loss:0.026449672877788544
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03407926857471466, avg_mse: 0.037004344165325165
current test mse: 0.037004
Iteration: 981, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724041223526, gen p mean: -0.5267753601074219, mean p set: 0.4477207064628601
The modified gen p mean: 0.44910547137260437, gen p mean: -0.529308021068573, mean p set: 0.44958579540252686
loss_pred:0.03178871423006058, decouple_loss:0.025866413488984108
loss_pred:0.032812464982271194, decouple_loss:0.026055900380015373
The modified gen p mean: 0.4502202570438385, gen p mean: -0.5363612174987793, mean p set: 0.4507005214691162
loss_pred:0.03180534020066261, decouple_loss:0.025841498747467995
Iteration: 982, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487534165382385, gen p mean: -0.5231385231018066, mean p set: 0.4492337107658386
The modified gen p mean: 0.4495910704135895, gen p mean: -0.5326197147369385, mean p set: 0.45007139444351196
The modified gen p mean: 0.4502055048942566, gen p mean: -0.5242893099784851, mean p set: 0.4506858289241791
loss_pred:0.031660061329603195, decouple_loss:0.025509323924779892
loss_pred:0.0314231775701046, decouple_loss:0.02610696293413639
loss_pred:0.03146730735898018, decouple_loss:0.026586271822452545
Iteration: 983, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494202435016632, gen p mean: -0.5331300497055054, mean p set: 0.4499005675315857
The modified gen p mean: 0.4486224949359894, gen p mean: -0.5317238569259644, mean p set: 0.4491027593612671
The modified gen p mean: 0.45044639706611633, gen p mean: -0.5378444790840149, mean p set: 0.45092666149139404
loss_pred:0.03063313476741314, decouple_loss:0.025918979197740555
loss_pred:0.0322004035115242, decouple_loss:0.025835702195763588
loss_pred:0.03158211335539818, decouple_loss:0.02583961933851242
Iteration: 984, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475174844264984, gen p mean: -0.5283544063568115, mean p set: 0.4479977786540985
The modified gen p mean: 0.4505947530269623, gen p mean: -0.5290895104408264, mean p set: 0.4510750472545624
The modified gen p mean: 0.450539231300354, gen p mean: -0.5276185870170593, mean p set: 0.4510194957256317
loss_pred:0.03146873787045479, decouple_loss:0.025317072868347168
loss_pred:0.0319189578294754, decouple_loss:0.02601688727736473
loss_pred:0.03131289407610893, decouple_loss:0.02605992741882801
Iteration: 985, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496532380580902, gen p mean: -0.5196833610534668, mean p set: 0.4501335322856903
The modified gen p mean: 0.4502854347229004, gen p mean: -0.5260064601898193, mean p set: 0.4507656991481781
The modified gen p mean: 0.4496975243091583, gen p mean: -0.5262651443481445, mean p set: 0.4501778185367584
loss_pred:0.03137734532356262, decouple_loss:0.02578151971101761
loss_pred:0.03148771449923515, decouple_loss:0.024760855361819267
loss_pred:0.030872570350766182, decouple_loss:0.025181615725159645
Iteration: 986, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490104019641876, gen p mean: -0.5225324034690857, mean p set: 0.44949066638946533
The modified gen p mean: 0.4489338994026184, gen p mean: -0.5180295705795288, mean p set: 0.4494141638278961
The modified gen p mean: 0.4493323266506195, gen p mean: -0.5205647349357605, mean p set: 0.4498126208782196
loss_pred:0.03320913389325142, decouple_loss:0.025170117616653442
loss_pred:0.03341740369796753, decouple_loss:0.025010325014591217
loss_pred:0.03226565569639206, decouple_loss:0.025373173877596855
Iteration: 987, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447736918926239, gen p mean: -0.5203370451927185, mean p set: 0.4482172131538391
The modified gen p mean: 0.45034259557724, gen p mean: -0.5225086212158203, mean p set: 0.4508228898048401
The modified gen p mean: 0.44951102137565613, gen p mean: -0.5261965394020081, mean p set: 0.4499913156032562
loss_pred:0.031971607357263565, decouple_loss:0.024840958416461945
loss_pred:0.03092910163104534, decouple_loss:0.02487095259130001
loss_pred:0.03142951428890228, decouple_loss:0.02489101141691208
Iteration: 988, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484518766403198, gen p mean: -0.5240740776062012, mean p set: 0.4489321708679199
The modified gen p mean: 0.4490760862827301, gen p mean: -0.5336372256278992, mean p set: 0.4495563805103302
The modified gen p mean: 0.44795697927474976, gen p mean: -0.5295374393463135, mean p set: 0.44843724370002747
loss_pred:0.03165558725595474, decouple_loss:0.02523837424814701
loss_pred:0.03258391097187996, decouple_loss:0.02478189952671528
loss_pred:0.03194965794682503, decouple_loss:0.02492675743997097
Iteration: 989, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494415521621704, gen p mean: -0.5350269675254822, mean p set: 0.4499218463897705
The modified gen p mean: 0.44836828112602234, gen p mean: -0.5335050225257874, mean p set: 0.44884857535362244
The modified gen p mean: 0.4475288987159729, gen p mean: -0.531002938747406, mean p set: 0.448009192943573
loss_pred:0.03214703127741814, decouple_loss:0.024994859471917152
loss_pred:0.03214797005057335, decouple_loss:0.02484922483563423
loss_pred:0.031003758311271667, decouple_loss:0.02430036850273609
Iteration: 990, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500133991241455, gen p mean: -0.5223681330680847, mean p set: 0.4504936933517456
The modified gen p mean: 0.4499286413192749, gen p mean: -0.5140535831451416, mean p set: 0.450408935546875
The modified gen p mean: 0.4502823054790497, gen p mean: -0.5160704851150513, mean p set: 0.45076262950897217
loss_pred:0.03040030226111412, decouple_loss:0.025055499747395515
loss_pred:0.03139999136328697, decouple_loss:0.024662785232067108
loss_pred:0.030975336208939552, decouple_loss:0.025553889572620392
2023-05-02 20:47:51 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.5188719630241394, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.5263832211494446, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5155006051063538, mean p set: 0.45035696029663086
loss_pred:0.032565828412771225, decouple_loss:0.02548634260892868
loss_pred:0.03361893445253372, decouple_loss:0.02670121192932129
loss_pred:0.03182990849018097, decouple_loss:0.025942618027329445
WV_0_PC_1_EH_0_PS_40_6, loss: 0.033973731100559235, avg_mse: 0.03693879395723343
current test mse: 0.036939
Iteration: 991, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449002742767334, gen p mean: -0.5163688659667969, mean p set: 0.4494830369949341
The modified gen p mean: 0.44841182231903076, gen p mean: -0.5173438787460327, mean p set: 0.44889214634895325
loss_pred:0.03208622708916664, decouple_loss:0.024851184338331223
loss_pred:0.032469723373651505, decouple_loss:0.025632701814174652
The modified gen p mean: 0.44891074299812317, gen p mean: -0.5104056000709534, mean p set: 0.44939103722572327
loss_pred:0.032050833106040955, decouple_loss:0.02598588727414608
Iteration: 992, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45058077573776245, gen p mean: -0.5204869508743286, mean p set: 0.45106109976768494
The modified gen p mean: 0.4483104348182678, gen p mean: -0.523553729057312, mean p set: 0.4487907588481903
The modified gen p mean: 0.45016369223594666, gen p mean: -0.5212872624397278, mean p set: 0.45064398646354675
loss_pred:0.030339952558279037, decouple_loss:0.024779928848147392
loss_pred:0.032329268753528595, decouple_loss:0.02439245395362377
loss_pred:0.029900167137384415, decouple_loss:0.02509046159684658
Iteration: 993, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44892197847366333, gen p mean: -0.52519291639328, mean p set: 0.4494022727012634
The modified gen p mean: 0.448871374130249, gen p mean: -0.5292178392410278, mean p set: 0.4493516683578491
The modified gen p mean: 0.4504387676715851, gen p mean: -0.5271065831184387, mean p set: 0.4509190618991852
loss_pred:0.034010425209999084, decouple_loss:0.023879602551460266
loss_pred:0.03316771984100342, decouple_loss:0.025128258392214775
loss_pred:0.03254333510994911, decouple_loss:0.025153230875730515
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
NaN value num: 0
Iteration: 994, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44930654764175415, gen p mean: -0.5309528708457947, mean p set: 0.44978684186935425
The modified gen p mean: 0.45000436902046204, gen p mean: -0.5247272849082947, mean p set: 0.45048466324806213
The modified gen p mean: 0.44839194416999817, gen p mean: -0.5269308686256409, mean p set: 0.4488722085952759
loss_pred:0.032219864428043365, decouple_loss:0.0271054208278656
loss_pred:0.032028600573539734, decouple_loss:0.028053447604179382
loss_pred:0.03178844973444939, decouple_loss:0.02667529135942459
Iteration: 995, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812920689582825, gen p mean: -0.5261918902397156, mean p set: 0.44860953092575073
The modified gen p mean: 0.4488302171230316, gen p mean: -0.5267261862754822, mean p set: 0.4493105113506317
The modified gen p mean: 0.45088982582092285, gen p mean: -0.5360698103904724, mean p set: 0.45137009024620056
loss_pred:0.031654126942157745, decouple_loss:0.02731258235871792
loss_pred:0.032323844730854034, decouple_loss:0.02632717788219452
loss_pred:0.029667126014828682, decouple_loss:0.02772981859743595
Iteration: 996, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502352178096771, gen p mean: -0.5305112600326538, mean p set: 0.4507155418395996
The modified gen p mean: 0.4501960873603821, gen p mean: -0.5283600687980652, mean p set: 0.4506763517856598
The modified gen p mean: 0.4497455358505249, gen p mean: -0.5346508026123047, mean p set: 0.450225830078125
loss_pred:0.03043322078883648, decouple_loss:0.027158312499523163
loss_pred:0.031934384256601334, decouple_loss:0.02592577412724495
loss_pred:0.03382131829857826, decouple_loss:0.027182983234524727
Iteration: 997, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448742538690567, gen p mean: -0.5255126953125, mean p set: 0.4492228329181671
The modified gen p mean: 0.44841963052749634, gen p mean: -0.5310665369033813, mean p set: 0.44889989495277405
The modified gen p mean: 0.44888585805892944, gen p mean: -0.530062735080719, mean p set: 0.44936615228652954
loss_pred:0.03230273723602295, decouple_loss:0.02612239494919777
loss_pred:0.03164636343717575, decouple_loss:0.027033859863877296
loss_pred:0.031183261424303055, decouple_loss:0.025832297280430794
Iteration: 998, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45119166374206543, gen p mean: -0.5321338772773743, mean p set: 0.45167189836502075
The modified gen p mean: 0.448365181684494, gen p mean: -0.5294114351272583, mean p set: 0.4488454759120941
The modified gen p mean: 0.448661208152771, gen p mean: -0.5290923714637756, mean p set: 0.4491414725780487
loss_pred:0.029982611536979675, decouple_loss:0.025978609919548035
loss_pred:0.031998518854379654, decouple_loss:0.02614632621407509
loss_pred:0.03187438100576401, decouple_loss:0.0267699733376503
Iteration: 999, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482846260070801, gen p mean: -0.5301188230514526, mean p set: 0.44876495003700256
The modified gen p mean: 0.45045509934425354, gen p mean: -0.5291339159011841, mean p set: 0.45093539357185364
The modified gen p mean: 0.44907498359680176, gen p mean: -0.5261338949203491, mean p set: 0.44955530762672424
loss_pred:0.031122907996177673, decouple_loss:0.02604890801012516
loss_pred:0.033226318657398224, decouple_loss:0.02653716318309307
loss_pred:0.03130378574132919, decouple_loss:0.024866005405783653
Iteration: 1000, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45016512274742126, gen p mean: -0.5260007381439209, mean p set: 0.45064541697502136
The modified gen p mean: 0.4489796757698059, gen p mean: -0.5272358655929565, mean p set: 0.4494599997997284
The modified gen p mean: 0.447963684797287, gen p mean: -0.5351517796516418, mean p set: 0.4484439492225647
loss_pred:0.03176625818014145, decouple_loss:0.024698171764612198
loss_pred:0.03171440586447716, decouple_loss:0.024718966335058212
loss_pred:0.03179435804486275, decouple_loss:0.02568342164158821
2023-05-02 20:52:25 itr: 1000
training loss: [0.03307853 0.03300117 0.03295035]
2023-05-02 20:52:25 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5350000858306885, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.542752742767334, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5313534140586853, mean p set: 0.45035696029663086
loss_pred:0.032524753361940384, decouple_loss:0.02710040658712387
loss_pred:0.03368845209479332, decouple_loss:0.028782539069652557
loss_pred:0.031775038689374924, decouple_loss:0.028116175904870033
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03406273573637009, avg_mse: 0.03709106147289276
current test mse: 0.037091
Iteration: 1001, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45038244128227234, gen p mean: -0.534470796585083, mean p set: 0.45086273550987244
The modified gen p mean: 0.44839420914649963, gen p mean: -0.5383674502372742, mean p set: 0.44887450337409973
loss_pred:0.03184373676776886, decouple_loss:0.026185370981693268
loss_pred:0.030481798574328423, decouple_loss:0.024741021916270256
The modified gen p mean: 0.45030295848846436, gen p mean: -0.5350548028945923, mean p set: 0.45078325271606445
loss_pred:0.0318109430372715, decouple_loss:0.025481101125478745
Iteration: 1002, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44813019037246704, gen p mean: -0.5309365391731262, mean p set: 0.44861045479774475
The modified gen p mean: 0.4500219225883484, gen p mean: -0.5282396078109741, mean p set: 0.4505022168159485
The modified gen p mean: 0.4491819441318512, gen p mean: -0.5302485227584839, mean p set: 0.4496622681617737
loss_pred:0.031900323927402496, decouple_loss:0.025341860949993134
loss_pred:0.032049570232629776, decouple_loss:0.026721928268671036
loss_pred:0.03143545240163803, decouple_loss:0.02549799717962742
Iteration: 1003, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44951069355010986, gen p mean: -0.5258976817131042, mean p set: 0.44999101758003235
The modified gen p mean: 0.44951292872428894, gen p mean: -0.5227686166763306, mean p set: 0.44999319314956665
The modified gen p mean: 0.4487535059452057, gen p mean: -0.5286084413528442, mean p set: 0.4492338001728058
loss_pred:0.0321185439825058, decouple_loss:0.025285879150032997
loss_pred:0.031770266592502594, decouple_loss:0.024381082504987717
loss_pred:0.03169618919491768, decouple_loss:0.024802017956972122
Iteration: 1004, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492523670196533, gen p mean: -0.5353022217750549, mean p set: 0.4497326612472534
The modified gen p mean: 0.44873547554016113, gen p mean: -0.5314615964889526, mean p set: 0.44921573996543884
The modified gen p mean: 0.4501855969429016, gen p mean: -0.529766857624054, mean p set: 0.4506658911705017
loss_pred:0.0331760048866272, decouple_loss:0.02609935961663723
loss_pred:0.031377241015434265, decouple_loss:0.02551385760307312
loss_pred:0.03170013055205345, decouple_loss:0.02544408105313778
Iteration: 1005, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44851192831993103, gen p mean: -0.538550853729248, mean p set: 0.44899222254753113
The modified gen p mean: 0.4485502243041992, gen p mean: -0.5360988974571228, mean p set: 0.44903048872947693
The modified gen p mean: 0.44936704635620117, gen p mean: -0.5412501692771912, mean p set: 0.44984734058380127
loss_pred:0.030369440093636513, decouple_loss:0.024610327556729317
loss_pred:0.032111894339323044, decouple_loss:0.024076636880636215
loss_pred:0.032137833535671234, decouple_loss:0.024899296462535858
Iteration: 1006, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505018889904022, gen p mean: -0.5424013137817383, mean p set: 0.45098215341567993
The modified gen p mean: 0.4501005709171295, gen p mean: -0.5427501201629639, mean p set: 0.4505808651447296
The modified gen p mean: 0.4492669999599457, gen p mean: -0.541637122631073, mean p set: 0.4497472941875458
loss_pred:0.032446037977933884, decouple_loss:0.025841157883405685
loss_pred:0.0315072163939476, decouple_loss:0.026648404076695442
loss_pred:0.03129810467362404, decouple_loss:0.025026537477970123
Iteration: 1007, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449098140001297, gen p mean: -0.5325772762298584, mean p set: 0.4495784640312195
The modified gen p mean: 0.44946932792663574, gen p mean: -0.5313068628311157, mean p set: 0.44994959235191345
The modified gen p mean: 0.449989914894104, gen p mean: -0.5280651450157166, mean p set: 0.4504702091217041
loss_pred:0.03183518722653389, decouple_loss:0.02527626045048237
loss_pred:0.03187961131334305, decouple_loss:0.02605460211634636
loss_pred:0.03180054947733879, decouple_loss:0.026532091200351715
Iteration: 1008, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494553208351135, gen p mean: -0.5243629217147827, mean p set: 0.4499356150627136
The modified gen p mean: 0.4504282474517822, gen p mean: -0.5287124514579773, mean p set: 0.4509085714817047
The modified gen p mean: 0.4500592350959778, gen p mean: -0.5271655917167664, mean p set: 0.4505395293235779
loss_pred:0.03105599246919155, decouple_loss:0.026458648964762688
loss_pred:0.03148729354143143, decouple_loss:0.025467872619628906
loss_pred:0.032772496342659, decouple_loss:0.0259433351457119
Iteration: 1009, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856712222099304, gen p mean: -0.5343430042266846, mean p set: 0.44904738664627075
The modified gen p mean: 0.4486050605773926, gen p mean: -0.5370131731033325, mean p set: 0.4490853548049927
The modified gen p mean: 0.4494897425174713, gen p mean: -0.5291305780410767, mean p set: 0.4499700367450714
loss_pred:0.03137083724141121, decouple_loss:0.025120139122009277
loss_pred:0.03146935626864433, decouple_loss:0.025485703721642494
loss_pred:0.03191997483372688, decouple_loss:0.024887405335903168
Iteration: 1010, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779276847839355, gen p mean: -0.532357394695282, mean p set: 0.44827306270599365
The modified gen p mean: 0.4500578045845032, gen p mean: -0.5338800549507141, mean p set: 0.4505380690097809
The modified gen p mean: 0.4476589858531952, gen p mean: -0.5362359881401062, mean p set: 0.4481392800807953
loss_pred:0.03209887072443962, decouple_loss:0.025713633745908737
loss_pred:0.03097815066576004, decouple_loss:0.024829424917697906
loss_pred:0.03157714754343033, decouple_loss:0.02539733797311783
2023-05-02 20:56:05 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.5386324524879456, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.5306920409202576, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5278816223144531, mean p set: 0.45035696029663086
loss_pred:0.032868869602680206, decouple_loss:0.027314428240060806
loss_pred:0.033871449530124664, decouple_loss:0.028593644499778748
loss_pred:0.031997449696063995, decouple_loss:0.028026456013321877
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03431149944663048, avg_mse: 0.0376104898750782
current test mse: 0.03761
Iteration: 1011, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493372440338135, gen p mean: -0.5329059958457947, mean p set: 0.4498175084590912
The modified gen p mean: 0.4483434557914734, gen p mean: -0.533072292804718, mean p set: 0.4488237500190735
loss_pred:0.031719308346509933, decouple_loss:0.025354918092489243
loss_pred:0.03194129094481468, decouple_loss:0.02549991011619568
The modified gen p mean: 0.44935426115989685, gen p mean: -0.5325931310653687, mean p set: 0.44983452558517456
loss_pred:0.031475730240345, decouple_loss:0.025593193247914314
Iteration: 1012, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450958251953125, gen p mean: -0.5301947593688965, mean p set: 0.4514385461807251
The modified gen p mean: 0.45073336362838745, gen p mean: -0.536049485206604, mean p set: 0.45121368765830994
The modified gen p mean: 0.4504678249359131, gen p mean: -0.525399923324585, mean p set: 0.4509481191635132
loss_pred:0.03279215842485428, decouple_loss:0.025046516209840775
loss_pred:0.029594162479043007, decouple_loss:0.02512608841061592
loss_pred:0.03186272829771042, decouple_loss:0.024806153029203415
Iteration: 1013, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44986724853515625, gen p mean: -0.526262640953064, mean p set: 0.45034751296043396
The modified gen p mean: 0.448784202337265, gen p mean: -0.5282727479934692, mean p set: 0.4492644667625427
The modified gen p mean: 0.44732367992401123, gen p mean: -0.5267928838729858, mean p set: 0.44780394434928894
loss_pred:0.032630808651447296, decouple_loss:0.025378568097949028
loss_pred:0.031053481623530388, decouple_loss:0.025346722453832626
loss_pred:0.03176388517022133, decouple_loss:0.02516273595392704
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 1014, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4453771114349365, gen p mean: -0.5262457728385925, mean p set: 0.445857435464859
The modified gen p mean: 0.4452042877674103, gen p mean: -0.5254595279693604, mean p set: 0.4456845819950104
The modified gen p mean: 0.44680145382881165, gen p mean: -0.5389658808708191, mean p set: 0.44728177785873413
loss_pred:0.033432841300964355, decouple_loss:0.029346806928515434
loss_pred:0.03212587535381317, decouple_loss:0.028961634263396263
loss_pred:0.03373885527253151, decouple_loss:0.028669491410255432
Iteration: 1015, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44632676243782043, gen p mean: -0.5248180031776428, mean p set: 0.44680705666542053
The modified gen p mean: 0.44759318232536316, gen p mean: -0.521350085735321, mean p set: 0.44807347655296326
The modified gen p mean: 0.44756370782852173, gen p mean: -0.529258131980896, mean p set: 0.4480440020561218
loss_pred:0.03192118927836418, decouple_loss:0.0277177095413208
loss_pred:0.03302588313817978, decouple_loss:0.02820274978876114
loss_pred:0.03131112828850746, decouple_loss:0.026796644553542137
Iteration: 1016, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477007985115051, gen p mean: -0.5227375626564026, mean p set: 0.44818106293678284
The modified gen p mean: 0.4459965229034424, gen p mean: -0.5228996276855469, mean p set: 0.44647684693336487
The modified gen p mean: 0.4456709921360016, gen p mean: -0.5233740210533142, mean p set: 0.4461512565612793
loss_pred:0.032117877155542374, decouple_loss:0.02782246842980385loss_pred:0.034695133566856384, decouple_loss:0.027246547862887383
loss_pred:0.032722022384405136, decouple_loss:0.02735750563442707
Iteration: 1017, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44643452763557434, gen p mean: -0.5411876440048218, mean p set: 0.44691479206085205
The modified gen p mean: 0.44517549872398376, gen p mean: -0.5295940637588501, mean p set: 0.44565579295158386
The modified gen p mean: 0.4467034637928009, gen p mean: -0.5377036929130554, mean p set: 0.447183758020401
loss_pred:0.03277045488357544, decouple_loss:0.02740568108856678
loss_pred:0.031851984560489655, decouple_loss:0.02774164453148842
loss_pred:0.03291253745555878, decouple_loss:0.02712317556142807
Iteration: 1018, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44698435068130493, gen p mean: -0.5436252355575562, mean p set: 0.44746461510658264
The modified gen p mean: 0.44674137234687805, gen p mean: -0.5368098616600037, mean p set: 0.44722166657447815
The modified gen p mean: 0.44671717286109924, gen p mean: -0.5474767088890076, mean p set: 0.44719746708869934
loss_pred:0.03146672248840332, decouple_loss:0.025793666020035744
loss_pred:0.03283194825053215, decouple_loss:0.026611635461449623
loss_pred:0.033597465604543686, decouple_loss:0.02707427553832531
Iteration: 1019, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715139269828796, gen p mean: -0.531789243221283, mean p set: 0.4476316571235657
The modified gen p mean: 0.4461234509944916, gen p mean: -0.532739520072937, mean p set: 0.4466037154197693
The modified gen p mean: 0.4460991322994232, gen p mean: -0.5343075394630432, mean p set: 0.4465794563293457
loss_pred:0.03288083150982857, decouple_loss:0.025547534227371216
loss_pred:0.03244804963469505, decouple_loss:0.025810107588768005
loss_pred:0.03261343017220497, decouple_loss:0.02548738196492195
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1020, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470561742782593, gen p mean: -0.5364355444908142, mean p set: 0.4475364685058594
The modified gen p mean: 0.4479460120201111, gen p mean: -0.5369665026664734, mean p set: 0.44842633605003357
The modified gen p mean: 0.44694986939430237, gen p mean: -0.5375332236289978, mean p set: 0.4474301338195801
loss_pred:0.031053699553012848, decouple_loss:0.025689905509352684
loss_pred:0.032148655503988266, decouple_loss:0.02642519772052765
loss_pred:0.03321420028805733, decouple_loss:0.0264042466878891
2023-05-02 21:00:29 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5334078669548035, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.5412139296531677, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5300306081771851, mean p set: 0.45035696029663086
loss_pred:0.032194558531045914, decouple_loss:0.026054533198475838
loss_pred:0.03331531211733818, decouple_loss:0.02654888853430748
loss_pred:0.03161827474832535, decouple_loss:0.026498448103666306
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03369441255927086, avg_mse: 0.03677431121468544
current test mse: 0.036774
Iteration: 1021, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678202271461487, gen p mean: -0.5384256839752197, mean p set: 0.44726231694221497
The modified gen p mean: 0.4465217888355255, gen p mean: -0.5400493741035461, mean p set: 0.4470020830631256
loss_pred:0.03180016577243805, decouple_loss:0.02553715370595455
loss_pred:0.031093789264559746, decouple_loss:0.025068730115890503
The modified gen p mean: 0.44681304693222046, gen p mean: -0.5388824343681335, mean p set: 0.44729331135749817
loss_pred:0.033101651817560196, decouple_loss:0.025516755878925323
Iteration: 1022, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446666419506073, gen p mean: -0.5315461158752441, mean p set: 0.4471467435359955
The modified gen p mean: 0.44705235958099365, gen p mean: -0.5247108340263367, mean p set: 0.44753265380859375
The modified gen p mean: 0.4468703269958496, gen p mean: -0.5251631140708923, mean p set: 0.4473506212234497
loss_pred:0.03129732236266136, decouple_loss:0.025371545925736427
loss_pred:0.031167566776275635, decouple_loss:0.025224637240171432
loss_pred:0.03240188956260681, decouple_loss:0.025234846398234367
Iteration: 1023, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44634103775024414, gen p mean: -0.5252770781517029, mean p set: 0.44682133197784424
The modified gen p mean: 0.44530779123306274, gen p mean: -0.5148432850837708, mean p set: 0.44578808546066284
The modified gen p mean: 0.44688060879707336, gen p mean: -0.5223948359489441, mean p set: 0.4473608434200287
loss_pred:0.03187284246087074, decouple_loss:0.025418391451239586
loss_pred:0.032095517963171005, decouple_loss:0.0263411533087492
loss_pred:0.03238772973418236, decouple_loss:0.025695951655507088
Iteration: 1024, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44712939858436584, gen p mean: -0.5131521224975586, mean p set: 0.44760966300964355
The modified gen p mean: 0.446519672870636, gen p mean: -0.5115296840667725, mean p set: 0.4469999372959137
The modified gen p mean: 0.4463663399219513, gen p mean: -0.5202139019966125, mean p set: 0.446846604347229
loss_pred:0.033042311668395996, decouple_loss:0.024934425950050354
loss_pred:0.0318056121468544, decouple_loss:0.0252895075827837
loss_pred:0.03309519961476326, decouple_loss:0.02544533461332321
Iteration: 1025, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44605761766433716, gen p mean: -0.5200831294059753, mean p set: 0.44653791189193726
The modified gen p mean: 0.4477647840976715, gen p mean: -0.5207567811012268, mean p set: 0.4482450783252716
The modified gen p mean: 0.446067214012146, gen p mean: -0.5137325525283813, mean p set: 0.4465474784374237
loss_pred:0.032147116959095, decouple_loss:0.02494235709309578
loss_pred:0.03114652819931507, decouple_loss:0.024527359753847122
loss_pred:0.03171674907207489, decouple_loss:0.024852540343999863
Iteration: 1026, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44734692573547363, gen p mean: -0.5335805416107178, mean p set: 0.44782721996307373
The modified gen p mean: 0.44610631465911865, gen p mean: -0.5275276899337769, mean p set: 0.44658660888671875
The modified gen p mean: 0.44700536131858826, gen p mean: -0.5307072401046753, mean p set: 0.44748565554618835
loss_pred:0.031182684004306793, decouple_loss:0.02466687373816967
loss_pred:0.03239000588655472, decouple_loss:0.02472272701561451
loss_pred:0.03207758441567421, decouple_loss:0.024779928848147392
Iteration: 1027, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44666972756385803, gen p mean: -0.5257858633995056, mean p set: 0.4471500515937805
The modified gen p mean: 0.4467865228652954, gen p mean: -0.5296094417572021, mean p set: 0.4472668468952179
The modified gen p mean: 0.4461154639720917, gen p mean: -0.5208090543746948, mean p set: 0.44659578800201416
loss_pred:0.03196904435753822, decouple_loss:0.02522815391421318
loss_pred:0.030810439959168434, decouple_loss:0.025042761117219925
loss_pred:0.03175192326307297, decouple_loss:0.025303427129983902
Iteration: 1028, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44651535153388977, gen p mean: -0.5196933150291443, mean p set: 0.44699564576148987
The modified gen p mean: 0.44680383801460266, gen p mean: -0.5223916172981262, mean p set: 0.44728413224220276
The modified gen p mean: 0.44758808612823486, gen p mean: -0.5229062438011169, mean p set: 0.44806838035583496
loss_pred:0.0319363959133625, decouple_loss:0.024901118129491806
loss_pred:0.03139372542500496, decouple_loss:0.02398868277668953
loss_pred:0.030749760568141937, decouple_loss:0.02389734983444214
Iteration: 1029, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44657978415489197, gen p mean: -0.5154671669006348, mean p set: 0.44706007838249207
The modified gen p mean: 0.44656574726104736, gen p mean: -0.5187586545944214, mean p set: 0.44704607129096985
The modified gen p mean: 0.4466235041618347, gen p mean: -0.5189418792724609, mean p set: 0.4471038281917572
loss_pred:0.03106807917356491, decouple_loss:0.02453666552901268
loss_pred:0.03160328045487404, decouple_loss:0.025108080357313156
loss_pred:0.03177106752991676, decouple_loss:0.024216709658503532
Iteration: 1030, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468212425708771, gen p mean: -0.5233199596405029, mean p set: 0.44730156660079956
The modified gen p mean: 0.4484494924545288, gen p mean: -0.5307212471961975, mean p set: 0.4489297568798065
The modified gen p mean: 0.44725301861763, gen p mean: -0.5280781984329224, mean p set: 0.4477333426475525
loss_pred:0.03161760792136192, decouple_loss:0.023761888965964317
loss_pred:0.0316542387008667, decouple_loss:0.02484961785376072
loss_pred:0.03309156373143196, decouple_loss:0.024577150121331215
2023-05-02 21:04:10 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5283686518669128, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.5357463955879211, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.524647057056427, mean p set: 0.45035696029663086
loss_pred:0.03201693296432495, decouple_loss:0.025245310738682747
loss_pred:0.033120665699243546, decouple_loss:0.02567102573812008
loss_pred:0.03147830069065094, decouple_loss:0.025992991402745247
WV_0_PC_1_EH_0_PS_40_6, loss: 0.033487122505903244, avg_mse: 0.03652348741889
current test mse: 0.036523
Iteration: 1031, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661515951156616, gen p mean: -0.5358998775482178, mean p set: 0.44709545373916626
loss_pred:0.03099018707871437, decouple_loss:0.024340763688087463
The modified gen p mean: 0.44740474224090576, gen p mean: -0.5246360898017883, mean p set: 0.44788506627082825
loss_pred:0.03195104002952576, decouple_loss:0.02446032129228115
The modified gen p mean: 0.4472448229789734, gen p mean: -0.5305980443954468, mean p set: 0.4477251172065735
loss_pred:0.032615624368190765, decouple_loss:0.023601558059453964
Iteration: 1032, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44643330574035645, gen p mean: -0.5327615141868591, mean p set: 0.44691362977027893
The modified gen p mean: 0.4466868042945862, gen p mean: -0.5270439386367798, mean p set: 0.4471670687198639
The modified gen p mean: 0.4463392496109009, gen p mean: -0.526761531829834, mean p set: 0.446819543838501
loss_pred:0.03164022043347359, decouple_loss:0.02371983416378498
loss_pred:0.03144190087914467, decouple_loss:0.02420041523873806
loss_pred:0.033097829669713974, decouple_loss:0.02427082136273384
Iteration: 1033, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701674580574036, gen p mean: -0.5319166779518127, mean p set: 0.44749704003334045
The modified gen p mean: 0.4469769299030304, gen p mean: -0.5244430303573608, mean p set: 0.4474572241306305
The modified gen p mean: 0.44679540395736694, gen p mean: -0.5239793062210083, mean p set: 0.44727569818496704
loss_pred:0.032733362168073654, decouple_loss:0.02359798550605774
loss_pred:0.03128703683614731, decouple_loss:0.02362949587404728
loss_pred:0.031777121126651764, decouple_loss:0.023464661091566086
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
NaN value num: 0
Iteration: 1034, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812729954719543, gen p mean: -0.5358710885047913, mean p set: 0.44860756397247314
The modified gen p mean: 0.44722896814346313, gen p mean: -0.5326367616653442, mean p set: 0.44770923256874084
The modified gen p mean: 0.4474814534187317, gen p mean: -0.5371822714805603, mean p set: 0.4479617476463318
loss_pred:0.03392695635557175, decouple_loss:0.025019079446792603
loss_pred:0.03161080181598663, decouple_loss:0.02445552684366703
loss_pred:0.031550049781799316, decouple_loss:0.024479202926158905
Iteration: 1035, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485817849636078, gen p mean: -0.5403789281845093, mean p set: 0.4490620791912079
The modified gen p mean: 0.4470476806163788, gen p mean: -0.543323278427124, mean p set: 0.4475279748439789
The modified gen p mean: 0.44801101088523865, gen p mean: -0.5415838360786438, mean p set: 0.44849130511283875
loss_pred:0.03384291008114815, decouple_loss:0.024740124121308327
loss_pred:0.033962562680244446, decouple_loss:0.025868073105812073
loss_pred:0.031944066286087036, decouple_loss:0.02514294534921646
Iteration: 1036, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465082287788391, gen p mean: -0.5406575798988342, mean p set: 0.4469884932041168
The modified gen p mean: 0.4473099708557129, gen p mean: -0.5429933667182922, mean p set: 0.447790265083313
The modified gen p mean: 0.44710928201675415, gen p mean: -0.5432113409042358, mean p set: 0.44758954644203186
loss_pred:0.03381850942969322, decouple_loss:0.025918327271938324
loss_pred:0.0332922488451004, decouple_loss:0.025529060512781143
loss_pred:0.033934902399778366, decouple_loss:0.025223271921277046
Iteration: 1037, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44777607917785645, gen p mean: -0.5348696708679199, mean p set: 0.44825637340545654
The modified gen p mean: 0.448026180267334, gen p mean: -0.5281011462211609, mean p set: 0.4485064744949341
The modified gen p mean: 0.44760388135910034, gen p mean: -0.5266136527061462, mean p set: 0.44808417558670044
loss_pred:0.03330632671713829, decouple_loss:0.0241001658141613
loss_pred:0.033732131123542786, decouple_loss:0.025878753513097763
loss_pred:0.03468126431107521, decouple_loss:0.025929024443030357
Iteration: 1038, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476211667060852, gen p mean: -0.5245504975318909, mean p set: 0.4481014907360077
The modified gen p mean: 0.4480680525302887, gen p mean: -0.5381950736045837, mean p set: 0.4485483467578888
The modified gen p mean: 0.44797590374946594, gen p mean: -0.5340161323547363, mean p set: 0.44845619797706604
loss_pred:0.03458167240023613, decouple_loss:0.024988150224089622
loss_pred:0.03377840295433998, decouple_loss:0.026162927970290184
loss_pred:0.03131111338734627, decouple_loss:0.025100426748394966
Iteration: 1039, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753506779670715, gen p mean: -0.5366714596748352, mean p set: 0.44801533222198486
The modified gen p mean: 0.44796857237815857, gen p mean: -0.5388190150260925, mean p set: 0.4484488368034363
The modified gen p mean: 0.44652047753334045, gen p mean: -0.5333234071731567, mean p set: 0.44700080156326294
loss_pred:0.03236968442797661, decouple_loss:0.02494223229587078
loss_pred:0.0324796587228775, decouple_loss:0.02443154901266098
loss_pred:0.0340907983481884, decouple_loss:0.024619894102215767
Iteration: 1040, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476563334465027, gen p mean: -0.5460062026977539, mean p set: 0.4481366276741028
The modified gen p mean: 0.4473567605018616, gen p mean: -0.5417681336402893, mean p set: 0.4478370249271393
The modified gen p mean: 0.44721993803977966, gen p mean: -0.5426342487335205, mean p set: 0.44770026206970215
loss_pred:0.03247598558664322, decouple_loss:0.02438957989215851
loss_pred:0.03289581090211868, decouple_loss:0.024050211533904076
loss_pred:0.0339205339550972, decouple_loss:0.02431662753224373
2023-05-02 21:08:26 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.5464997887611389, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.5537325739860535, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5427356958389282, mean p set: 0.45035696029663086
loss_pred:0.03219546005129814, decouple_loss:0.025642836466431618
loss_pred:0.03317621722817421, decouple_loss:0.02598390355706215
loss_pred:0.03165050968527794, decouple_loss:0.02607155032455921
WV_0_PC_1_EH_0_PS_40_6, loss: 0.0336357019841671, avg_mse: 0.03689882159233093
current test mse: 0.036899
Iteration: 1041, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482826292514801, gen p mean: -0.5550035834312439, mean p set: 0.4487628936767578
The modified gen p mean: 0.44757699966430664, gen p mean: -0.5530218482017517, mean p set: 0.44805729389190674
loss_pred:0.034205153584480286, decouple_loss:0.025064734742045403
loss_pred:0.03406119346618652, decouple_loss:0.024566031992435455
The modified gen p mean: 0.4461364150047302, gen p mean: -0.5425156950950623, mean p set: 0.4466167390346527
loss_pred:0.03459680825471878, decouple_loss:0.02484309673309326
Iteration: 1042, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810646772384644, gen p mean: -0.5393859148025513, mean p set: 0.4485867917537689
The modified gen p mean: 0.4490950107574463, gen p mean: -0.5375046133995056, mean p set: 0.449575275182724
The modified gen p mean: 0.4488906264305115, gen p mean: -0.5344729423522949, mean p set: 0.44937095046043396
loss_pred:0.033732421696186066, decouple_loss:0.024326428771018982
loss_pred:0.03324132412672043, decouple_loss:0.02545282244682312
loss_pred:0.03305596113204956, decouple_loss:0.025717277079820633
Iteration: 1043, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906744360923767, gen p mean: -0.5358757376670837, mean p set: 0.4495477080345154
The modified gen p mean: 0.4495514929294586, gen p mean: -0.5335284471511841, mean p set: 0.4500318169593811
The modified gen p mean: 0.44887346029281616, gen p mean: -0.525235116481781, mean p set: 0.44935378432273865
loss_pred:0.03261309117078781, decouple_loss:0.024838685989379883
loss_pred:0.03243416175246239, decouple_loss:0.024586690589785576
loss_pred:0.033796995878219604, decouple_loss:0.024007800966501236
Iteration: 1044, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45025894045829773, gen p mean: -0.526983380317688, mean p set: 0.4507392346858978
The modified gen p mean: 0.44899240136146545, gen p mean: -0.5194777846336365, mean p set: 0.44947269558906555
The modified gen p mean: 0.44806066155433655, gen p mean: -0.5348224639892578, mean p set: 0.44854092597961426
loss_pred:0.03199315816164017, decouple_loss:0.023834582418203354
loss_pred:0.033247850835323334, decouple_loss:0.024801399558782578
loss_pred:0.03282276168465614, decouple_loss:0.024261027574539185
Iteration: 1045, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488983452320099, gen p mean: -0.5286024212837219, mean p set: 0.4493786096572876
The modified gen p mean: 0.4477001428604126, gen p mean: -0.5347886085510254, mean p set: 0.4481804668903351
The modified gen p mean: 0.44938087463378906, gen p mean: -0.5309730768203735, mean p set: 0.44986119866371155
loss_pred:0.03223432973027229, decouple_loss:0.02328934147953987
loss_pred:0.03277705982327461, decouple_loss:0.02510286681354046
loss_pred:0.03347121551632881, decouple_loss:0.02427689917385578
Iteration: 1046, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467003345489502, gen p mean: -0.5397582054138184, mean p set: 0.4471806287765503
The modified gen p mean: 0.4478619396686554, gen p mean: -0.5332614183425903, mean p set: 0.4483422338962555
The modified gen p mean: 0.4483500123023987, gen p mean: -0.5437060594558716, mean p set: 0.4488303065299988
loss_pred:0.033162303268909454, decouple_loss:0.024670178070664406
loss_pred:0.0331476666033268, decouple_loss:0.024148017168045044
loss_pred:0.03192361071705818, decouple_loss:0.023702194914221764
Iteration: 1047, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481285512447357, gen p mean: -0.5422636866569519, mean p set: 0.4486088454723358
The modified gen p mean: 0.4467930793762207, gen p mean: -0.5392873883247375, mean p set: 0.4472734034061432
The modified gen p mean: 0.44830670952796936, gen p mean: -0.537876307964325, mean p set: 0.44878700375556946
loss_pred:0.03293900936841965, decouple_loss:0.023429924622178078
loss_pred:0.03415939584374428, decouple_loss:0.024733679369091988
loss_pred:0.03364473208785057, decouple_loss:0.023756016045808792
Iteration: 1048, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480954706668854, gen p mean: -0.5537440180778503, mean p set: 0.4485757648944855
The modified gen p mean: 0.44825199246406555, gen p mean: -0.5478551983833313, mean p set: 0.44873231649398804
The modified gen p mean: 0.4472379982471466, gen p mean: -0.5441818237304688, mean p set: 0.4477182924747467
loss_pred:0.03197352588176727, decouple_loss:0.0241931714117527
loss_pred:0.032517094165086746, decouple_loss:0.023548249155282974
loss_pred:0.033703047782182693, decouple_loss:0.023574328050017357
Iteration: 1049, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44850054383277893, gen p mean: -0.5487018823623657, mean p set: 0.44898083806037903
The modified gen p mean: 0.4467270076274872, gen p mean: -0.5523451566696167, mean p set: 0.44720733165740967
The modified gen p mean: 0.44772711396217346, gen p mean: -0.5467180609703064, mean p set: 0.44820740818977356
loss_pred:0.03247371315956116, decouple_loss:0.02288682758808136
loss_pred:0.03297049552202225, decouple_loss:0.02383074350655079
loss_pred:0.03373631462454796, decouple_loss:0.023628514260053635
Iteration: 1050, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475128650665283, gen p mean: -0.5514604449272156, mean p set: 0.4479931592941284
The modified gen p mean: 0.4461628496646881, gen p mean: -0.5494058132171631, mean p set: 0.4466431736946106
The modified gen p mean: 0.4503830373287201, gen p mean: -0.5495073795318604, mean p set: 0.4508633017539978
loss_pred:0.03237307816743851, decouple_loss:0.02475021220743656
loss_pred:0.033458124846220016, decouple_loss:0.023340001702308655
loss_pred:0.03207924962043762, decouple_loss:0.02322964183986187
2023-05-02 21:12:06 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.5564125180244446, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.5484492182731628, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5448410511016846, mean p set: 0.45035696029663086
loss_pred:0.032862938940525055, decouple_loss:0.0254304688423872
loss_pred:0.031912922859191895, decouple_loss:0.024697320535779
loss_pred:0.03137992322444916, decouple_loss:0.025193963199853897
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03330729156732559, avg_mse: 0.036584094166755676
current test mse: 0.036584
Iteration: 1051, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44624578952789307, gen p mean: -0.548638641834259, mean p set: 0.44672608375549316
loss_pred:0.03365015983581543, decouple_loss:0.02543218620121479
The modified gen p mean: 0.4483039677143097, gen p mean: -0.5496237277984619, mean p set: 0.4487842321395874
loss_pred:0.03215103968977928, decouple_loss:0.022631388157606125
The modified gen p mean: 0.44583308696746826, gen p mean: -0.5465561747550964, mean p set: 0.44631341099739075
loss_pred:0.03371584042906761, decouple_loss:0.02484416961669922
Iteration: 1052, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797283411026, gen p mean: -0.5500611662864685, mean p set: 0.4484530985355377
The modified gen p mean: 0.44826897978782654, gen p mean: -0.5520126223564148, mean p set: 0.44874924421310425
The modified gen p mean: 0.4491898715496063, gen p mean: -0.5508756041526794, mean p set: 0.44967013597488403
loss_pred:0.031986773014068604, decouple_loss:0.022985676303505898
loss_pred:0.03210332989692688, decouple_loss:0.02308110147714615
loss_pred:0.03251918777823448, decouple_loss:0.023062216117978096
Iteration: 1053, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492214322090149, gen p mean: -0.536190927028656, mean p set: 0.4497016966342926
The modified gen p mean: 0.44676050543785095, gen p mean: -0.5380380749702454, mean p set: 0.44724079966545105
The modified gen p mean: 0.44820618629455566, gen p mean: -0.5460498332977295, mean p set: 0.44868648052215576
loss_pred:0.03301697224378586, decouple_loss:0.02379380539059639
loss_pred:0.03376070782542229, decouple_loss:0.023787375539541245
loss_pred:0.03162886202335358, decouple_loss:0.023687615990638733
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
NaN value num: 0
Iteration: 1054, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45250585675239563, gen p mean: -0.5389503836631775, mean p set: 0.4529861509799957
The modified gen p mean: 0.4490162134170532, gen p mean: -0.5316904783248901, mean p set: 0.4494965374469757
The modified gen p mean: 0.4497382342815399, gen p mean: -0.5323484539985657, mean p set: 0.4502184987068176
loss_pred:0.03289617970585823, decouple_loss:0.026419544592499733
loss_pred:0.03281152993440628, decouple_loss:0.025931408628821373
loss_pred:0.03174568712711334, decouple_loss:0.028894715011119843
Iteration: 1055, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45389440655708313, gen p mean: -0.541165828704834, mean p set: 0.45437467098236084
The modified gen p mean: 0.4500679075717926, gen p mean: -0.5384805202484131, mean p set: 0.4505482017993927
The modified gen p mean: 0.45066073536872864, gen p mean: -0.5447227954864502, mean p set: 0.45114099979400635
loss_pred:0.03099767677485943, decouple_loss:0.02825981006026268
loss_pred:0.031915031373500824, decouple_loss:0.02718771994113922
loss_pred:0.03199976310133934, decouple_loss:0.026441454887390137
Iteration: 1056, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45147356390953064, gen p mean: -0.5435353517532349, mean p set: 0.45195385813713074
The modified gen p mean: 0.45068255066871643, gen p mean: -0.5440347194671631, mean p set: 0.45116284489631653
The modified gen p mean: 0.4502720534801483, gen p mean: -0.5436856746673584, mean p set: 0.450752317905426
loss_pred:0.030591722577810287, decouple_loss:0.026746829971671104
loss_pred:0.032378923147916794, decouple_loss:0.0259732473641634
loss_pred:0.031212659552693367, decouple_loss:0.0271631870418787
Iteration: 1057, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45075225830078125, gen p mean: -0.5504235029220581, mean p set: 0.45123252272605896
The modified gen p mean: 0.45219239592552185, gen p mean: -0.5464176535606384, mean p set: 0.45267269015312195
The modified gen p mean: 0.44996291399002075, gen p mean: -0.5485004782676697, mean p set: 0.45044317841529846
loss_pred:0.0323498509824276, decouple_loss:0.02656802348792553
loss_pred:0.03035985678434372, decouple_loss:0.026657123118638992
loss_pred:0.03188244253396988, decouple_loss:0.026134761050343513
Iteration: 1058, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45059192180633545, gen p mean: -0.5380797982215881, mean p set: 0.4510722756385803
The modified gen p mean: 0.45031094551086426, gen p mean: -0.5420204401016235, mean p set: 0.45079126954078674
The modified gen p mean: 0.450928270816803, gen p mean: -0.5402730107307434, mean p set: 0.45140859484672546
loss_pred:0.03219243511557579, decouple_loss:0.026464015245437622
loss_pred:0.03238062188029289, decouple_loss:0.024531962350010872
loss_pred:0.03358285501599312, decouple_loss:0.026164118200540543
Iteration: 1059, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504055976867676, gen p mean: -0.5372114777565002, mean p set: 0.4508858919143677
The modified gen p mean: 0.45253220200538635, gen p mean: -0.5355626344680786, mean p set: 0.45301249623298645
The modified gen p mean: 0.4523758292198181, gen p mean: -0.5311793088912964, mean p set: 0.4528560936450958
loss_pred:0.03170634061098099, decouple_loss:0.025635572150349617
loss_pred:0.03111678920686245, decouple_loss:0.02633555606007576
loss_pred:0.03169800341129303, decouple_loss:0.02532270736992359
Iteration: 1060, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45030418038368225, gen p mean: -0.539472222328186, mean p set: 0.45078444480895996
The modified gen p mean: 0.45093464851379395, gen p mean: -0.5348513126373291, mean p set: 0.45141491293907166
The modified gen p mean: 0.4501606822013855, gen p mean: -0.5434104800224304, mean p set: 0.4506409764289856
loss_pred:0.03190743923187256, decouple_loss:0.026011427864432335
loss_pred:0.031209180131554604, decouple_loss:0.026148851960897446
loss_pred:0.03160686045885086, decouple_loss:0.027146531268954277
2023-05-02 21:16:24 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.556390643119812, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5491693615913391, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5447703003883362, mean p set: 0.45035696029663086
loss_pred:0.033104848116636276, decouple_loss:0.028643032535910606
loss_pred:0.0322013683617115, decouple_loss:0.02751159854233265
loss_pred:0.03142193704843521, decouple_loss:0.027809297665953636
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03364212065935135, avg_mse: 0.03700223192572594
current test mse: 0.037002
Iteration: 1061, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510863423347473, gen p mean: -0.5451175570487976, mean p set: 0.451566606760025
The modified gen p mean: 0.4499695599079132, gen p mean: -0.5527896285057068, mean p set: 0.4504498541355133
loss_pred:0.033304568380117416, decouple_loss:0.02572559379041195
loss_pred:0.03254406899213791, decouple_loss:0.026417965069413185
The modified gen p mean: 0.4505867063999176, gen p mean: -0.5523316860198975, mean p set: 0.4510670304298401
loss_pred:0.031402651220560074, decouple_loss:0.02533245086669922
Iteration: 1062, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519071877002716, gen p mean: -0.5539858341217041, mean p set: 0.4523874819278717
The modified gen p mean: 0.4522205889225006, gen p mean: -0.5555756688117981, mean p set: 0.4527009129524231
The modified gen p mean: 0.4510114789009094, gen p mean: -0.5578763484954834, mean p set: 0.45149174332618713
loss_pred:0.030806943774223328, decouple_loss:0.025601495057344437
loss_pred:0.030247529968619347, decouple_loss:0.02440016157925129
loss_pred:0.031755778938531876, decouple_loss:0.025412222370505333
Iteration: 1063, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526808559894562, gen p mean: -0.5474156141281128, mean p set: 0.4531611502170563
The modified gen p mean: 0.4522593915462494, gen p mean: -0.5486970543861389, mean p set: 0.4527396559715271
The modified gen p mean: 0.45096904039382935, gen p mean: -0.5468299984931946, mean p set: 0.45144933462142944
loss_pred:0.032105639576911926, decouple_loss:0.02439410425722599
loss_pred:0.03094533272087574, decouple_loss:0.02494620345532894
loss_pred:0.030070550739765167, decouple_loss:0.02520551159977913
Iteration: 1064, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508111774921417, gen p mean: -0.5509295463562012, mean p set: 0.4512914717197418
The modified gen p mean: 0.4506598711013794, gen p mean: -0.5452411770820618, mean p set: 0.4511401653289795
The modified gen p mean: 0.45187684893608093, gen p mean: -0.5431743264198303, mean p set: 0.4523571729660034
loss_pred:0.031060533598065376, decouple_loss:0.026308264583349228
loss_pred:0.031854692846536636, decouple_loss:0.024857163429260254
loss_pred:0.030384883284568787, decouple_loss:0.024796897545456886
Iteration: 1065, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501114785671234, gen p mean: -0.550689697265625, mean p set: 0.4505917727947235
The modified gen p mean: 0.4499717652797699, gen p mean: -0.5494048595428467, mean p set: 0.45045205950737
The modified gen p mean: 0.45085054636001587, gen p mean: -0.552063524723053, mean p set: 0.45133084058761597
loss_pred:0.031035928055644035, decouple_loss:0.025616096332669258
loss_pred:0.03135981038212776, decouple_loss:0.02513023279607296
loss_pred:0.03178154304623604, decouple_loss:0.025467466562986374
Iteration: 1066, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522046744823456, gen p mean: -0.5469052791595459, mean p set: 0.4526849389076233
The modified gen p mean: 0.45233258605003357, gen p mean: -0.5402249693870544, mean p set: 0.45281288027763367
The modified gen p mean: 0.45007601380348206, gen p mean: -0.5486398339271545, mean p set: 0.45055627822875977
loss_pred:0.031947460025548935, decouple_loss:0.02507379837334156
loss_pred:0.03404378518462181, decouple_loss:0.025198031216859818
loss_pred:0.03152930736541748, decouple_loss:0.025594966486096382
Iteration: 1067, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45059317350387573, gen p mean: -0.5408449172973633, mean p set: 0.45107343792915344
The modified gen p mean: 0.4511641561985016, gen p mean: -0.5380156636238098, mean p set: 0.4516444504261017
The modified gen p mean: 0.4515414535999298, gen p mean: -0.5410289764404297, mean p set: 0.4520217776298523
loss_pred:0.03155038505792618, decouple_loss:0.024615276604890823
loss_pred:0.03312785178422928, decouple_loss:0.0250648595392704
loss_pred:0.030683264136314392, decouple_loss:0.023951096460223198
Iteration: 1068, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45089730620384216, gen p mean: -0.5571095943450928, mean p set: 0.4513775408267975
The modified gen p mean: 0.4521578848361969, gen p mean: -0.5496174693107605, mean p set: 0.452638179063797
The modified gen p mean: 0.4499722421169281, gen p mean: -0.5538563132286072, mean p set: 0.4504525363445282
loss_pred:0.03110315650701523, decouple_loss:0.02485901489853859
loss_pred:0.03202581778168678, decouple_loss:0.024091342464089394
loss_pred:0.03182251378893852, decouple_loss:0.02458769828081131
Iteration: 1069, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535161554813385, gen p mean: -0.5624485611915588, mean p set: 0.453996479511261
The modified gen p mean: 0.45123782753944397, gen p mean: -0.5546950101852417, mean p set: 0.45171812176704407
The modified gen p mean: 0.45046618580818176, gen p mean: -0.5623946189880371, mean p set: 0.4509464502334595
loss_pred:0.030475769191980362, decouple_loss:0.025774382054805756
loss_pred:0.03287746012210846, decouple_loss:0.024792281910777092
loss_pred:0.03098423220217228, decouple_loss:0.025167426094412804
Iteration: 1070, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45085394382476807, gen p mean: -0.5558581352233887, mean p set: 0.45133426785469055
The modified gen p mean: 0.4495902359485626, gen p mean: -0.5593981742858887, mean p set: 0.4500705301761627
The modified gen p mean: 0.4521706998348236, gen p mean: -0.5536118745803833, mean p set: 0.4526509940624237
loss_pred:0.032311949878931046, decouple_loss:0.023972127586603165
loss_pred:0.030998723581433296, decouple_loss:0.025045959278941154
loss_pred:0.03330196067690849, decouple_loss:0.024056993424892426
2023-05-02 21:20:07 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5484958291053772, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.5564272999763489, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5445687770843506, mean p set: 0.45035696029663086
loss_pred:0.03223179280757904, decouple_loss:0.026633888483047485
loss_pred:0.03311282396316528, decouple_loss:0.027853097766637802
loss_pred:0.03166486322879791, decouple_loss:0.026857253164052963
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03369223326444626, avg_mse: 0.03705667331814766
current test mse: 0.037057
Iteration: 1071, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44997653365135193, gen p mean: -0.5521970987319946, mean p set: 0.450456827878952
loss_pred:0.03256269171833992, decouple_loss:0.025196785107254982
The modified gen p mean: 0.45017921924591064, gen p mean: -0.5502955317497253, mean p set: 0.45065951347351074
loss_pred:0.030358988791704178, decouple_loss:0.02537374757230282
The modified gen p mean: 0.4520878493785858, gen p mean: -0.5434185266494751, mean p set: 0.4525681734085083
loss_pred:0.031066570430994034, decouple_loss:0.02486332692205906
Iteration: 1072, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45037972927093506, gen p mean: -0.5480954647064209, mean p set: 0.45086002349853516
The modified gen p mean: 0.4500938355922699, gen p mean: -0.5480148792266846, mean p set: 0.4505741000175476
The modified gen p mean: 0.4502878487110138, gen p mean: -0.5433279871940613, mean p set: 0.4507681429386139
loss_pred:0.03195376321673393, decouple_loss:0.024575600400567055
loss_pred:0.03197072073817253, decouple_loss:0.02471376582980156
loss_pred:0.030996544286608696, decouple_loss:0.024058014154434204
Iteration: 1073, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502183496952057, gen p mean: -0.5546811819076538, mean p set: 0.4506986141204834
The modified gen p mean: 0.45372727513313293, gen p mean: -0.5488800406455994, mean p set: 0.45420756936073303
The modified gen p mean: 0.45057153701782227, gen p mean: -0.5543645024299622, mean p set: 0.45105183124542236
loss_pred:0.032095544040203094, decouple_loss:0.02488929219543934
loss_pred:0.030849235132336617, decouple_loss:0.026420213282108307
loss_pred:0.032503318041563034, decouple_loss:0.024210866540670395
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
NaN value num: 0
Iteration: 1074, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45089951157569885, gen p mean: -0.564102053642273, mean p set: 0.45137983560562134
The modified gen p mean: 0.4509420394897461, gen p mean: -0.5624323487281799, mean p set: 0.4514223337173462
The modified gen p mean: 0.4504612982273102, gen p mean: -0.5598215460777283, mean p set: 0.4509415924549103
loss_pred:0.03146221861243248, decouple_loss:0.026922881603240967
loss_pred:0.03127191960811615, decouple_loss:0.026998000219464302
loss_pred:0.03115089237689972, decouple_loss:0.028219055384397507
Iteration: 1075, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449003666639328, gen p mean: -0.5525849461555481, mean p set: 0.4494839310646057
The modified gen p mean: 0.44978296756744385, gen p mean: -0.549264669418335, mean p set: 0.45026326179504395
The modified gen p mean: 0.4507247507572174, gen p mean: -0.5645791292190552, mean p set: 0.4512050449848175
loss_pred:0.03153208643198013, decouple_loss:0.027918891981244087
loss_pred:0.03308423236012459, decouple_loss:0.027353407815098763
loss_pred:0.03195194900035858, decouple_loss:0.029359981417655945
Iteration: 1076, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476472735404968, gen p mean: -0.5434553623199463, mean p set: 0.44812753796577454
The modified gen p mean: 0.45109593868255615, gen p mean: -0.5528844594955444, mean p set: 0.45157620310783386
The modified gen p mean: 0.4515479505062103, gen p mean: -0.5470680594444275, mean p set: 0.4520282447338104
loss_pred:0.032098568975925446, decouple_loss:0.027105404064059258
loss_pred:0.03229095786809921, decouple_loss:0.02723151072859764
loss_pred:0.03167576715350151, decouple_loss:0.026838485151529312
Iteration: 1077, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44859692454338074, gen p mean: -0.549371063709259, mean p set: 0.44907721877098083
The modified gen p mean: 0.4494893252849579, gen p mean: -0.5432083606719971, mean p set: 0.449969619512558
The modified gen p mean: 0.447933554649353, gen p mean: -0.5471257567405701, mean p set: 0.44841381907463074
loss_pred:0.0319032296538353, decouple_loss:0.0264144130051136
loss_pred:0.032680269330739975, decouple_loss:0.026698950678110123
loss_pred:0.03057212382555008, decouple_loss:0.02717977575957775
Iteration: 1078, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482850730419159, gen p mean: -0.5445152521133423, mean p set: 0.4487653374671936
The modified gen p mean: 0.45037874579429626, gen p mean: -0.5458600521087646, mean p set: 0.45085906982421875
The modified gen p mean: 0.45011764764785767, gen p mean: -0.5459305047988892, mean p set: 0.45059797167778015
loss_pred:0.03183547034859657, decouple_loss:0.02618906833231449
loss_pred:0.03180403634905815, decouple_loss:0.0269662793725729
loss_pred:0.031751882284879684, decouple_loss:0.026044411584734917
Iteration: 1079, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45060259103775024, gen p mean: -0.5607559084892273, mean p set: 0.45108291506767273
The modified gen p mean: 0.45020046830177307, gen p mean: -0.5530820488929749, mean p set: 0.4506807327270508
The modified gen p mean: 0.45045655965805054, gen p mean: -0.5583380460739136, mean p set: 0.45093685388565063
loss_pred:0.03174604848027229, decouple_loss:0.025475366041064262
loss_pred:0.03185710683465004, decouple_loss:0.027049683034420013
loss_pred:0.031703196465969086, decouple_loss:0.025385458022356033
Iteration: 1080, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44852709770202637, gen p mean: -0.5607397556304932, mean p set: 0.44900739192962646
The modified gen p mean: 0.44996246695518494, gen p mean: -0.5591373443603516, mean p set: 0.45044276118278503
The modified gen p mean: 0.4516427516937256, gen p mean: -0.5690982937812805, mean p set: 0.4521230459213257
loss_pred:0.03139953315258026, decouple_loss:0.025880711153149605
loss_pred:0.030922047793865204, decouple_loss:0.025191884487867355
loss_pred:0.03152555599808693, decouple_loss:0.02658872678875923
2023-05-02 21:24:43 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5531869530677795, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.5611783862113953, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5494162440299988, mean p set: 0.45035696029663086
loss_pred:0.032043445855379105, decouple_loss:0.02796134538948536
loss_pred:0.033053454011678696, decouple_loss:0.028100498020648956
loss_pred:0.03127473592758179, decouple_loss:0.028141437098383904
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03352726995944977, avg_mse: 0.036815643310546875
current test mse: 0.036816
Iteration: 1081, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480831027030945, gen p mean: -0.5523836612701416, mean p set: 0.44856342673301697
loss_pred:0.03147647902369499, decouple_loss:0.025412367656826973
The modified gen p mean: 0.450859397649765, gen p mean: -0.5564727783203125, mean p set: 0.4513396918773651
loss_pred:0.03107338398694992, decouple_loss:0.02524734102189541
The modified gen p mean: 0.4483596086502075, gen p mean: -0.5539380311965942, mean p set: 0.44883993268013
loss_pred:0.03068520314991474, decouple_loss:0.025024330243468285
Iteration: 1082, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45187345147132874, gen p mean: -0.5512056946754456, mean p set: 0.45235374569892883
The modified gen p mean: 0.4480988383293152, gen p mean: -0.5414689183235168, mean p set: 0.4485791027545929
The modified gen p mean: 0.44953253865242004, gen p mean: -0.5398704409599304, mean p set: 0.45001283288002014
loss_pred:0.03067835606634617, decouple_loss:0.026223989203572273
loss_pred:0.031532369554042816, decouple_loss:0.024576669558882713
loss_pred:0.031017784029245377, decouple_loss:0.02635352686047554
Iteration: 1083, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512201249599457, gen p mean: -0.5292288661003113, mean p set: 0.4517004191875458
The modified gen p mean: 0.4497833847999573, gen p mean: -0.5266807675361633, mean p set: 0.4502636790275574
The modified gen p mean: 0.44839081168174744, gen p mean: -0.5298159718513489, mean p set: 0.44887110590934753
loss_pred:0.03181476145982742, decouple_loss:0.025949550792574883loss_pred:0.0305333249270916, decouple_loss:0.02511640265583992
loss_pred:0.03144950047135353, decouple_loss:0.026221495121717453
Iteration: 1084, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451168417930603, gen p mean: -0.5379133820533752, mean p set: 0.4516487121582031
The modified gen p mean: 0.4506893754005432, gen p mean: -0.5501476526260376, mean p set: 0.4511696398258209
The modified gen p mean: 0.4487482011318207, gen p mean: -0.5364054441452026, mean p set: 0.44922852516174316
loss_pred:0.031554676592350006, decouple_loss:0.024663619697093964
loss_pred:0.031151926144957542, decouple_loss:0.027101358398795128
loss_pred:0.03099500946700573, decouple_loss:0.024494674056768417
Iteration: 1085, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45139288902282715, gen p mean: -0.5560137629508972, mean p set: 0.45187318325042725
The modified gen p mean: 0.45107895135879517, gen p mean: -0.5592538118362427, mean p set: 0.45155924558639526
The modified gen p mean: 0.4488142132759094, gen p mean: -0.5501391887664795, mean p set: 0.44929447770118713
loss_pred:0.031372588127851486, decouple_loss:0.02662135474383831
loss_pred:0.03181840479373932, decouple_loss:0.02608339488506317
loss_pred:0.031655143946409225, decouple_loss:0.025371739640831947
Iteration: 1086, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45025599002838135, gen p mean: -0.5600528120994568, mean p set: 0.45073628425598145
The modified gen p mean: 0.4497433304786682, gen p mean: -0.5640752911567688, mean p set: 0.4502235949039459
The modified gen p mean: 0.44834089279174805, gen p mean: -0.5599381923675537, mean p set: 0.44882118701934814
loss_pred:0.031134657561779022, decouple_loss:0.025214117020368576
loss_pred:0.03133554011583328, decouple_loss:0.02519674226641655
loss_pred:0.03096340224146843, decouple_loss:0.025784755125641823
Iteration: 1087, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44979265332221985, gen p mean: -0.559483528137207, mean p set: 0.45027294754981995
The modified gen p mean: 0.4506099224090576, gen p mean: -0.5604913234710693, mean p set: 0.4510902166366577
The modified gen p mean: 0.450158029794693, gen p mean: -0.5573453903198242, mean p set: 0.4506383240222931
loss_pred:0.031319618225097656, decouple_loss:0.02535148896276951
loss_pred:0.031227221712470055, decouple_loss:0.02607377991080284
loss_pred:0.0314374677836895, decouple_loss:0.02614201046526432
Iteration: 1088, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486803114414215, gen p mean: -0.5547273755073547, mean p set: 0.4491605758666992
The modified gen p mean: 0.4499184191226959, gen p mean: -0.5571677684783936, mean p set: 0.450398713350296
The modified gen p mean: 0.4517090916633606, gen p mean: -0.5663281083106995, mean p set: 0.4521893560886383
loss_pred:0.030944019556045532, decouple_loss:0.024923695251345634
loss_pred:0.030892014503479004, decouple_loss:0.025009412318468094
loss_pred:0.03114086389541626, decouple_loss:0.026377787813544273
Iteration: 1089, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507182240486145, gen p mean: -0.5629944205284119, mean p set: 0.4511985182762146
The modified gen p mean: 0.44832876324653625, gen p mean: -0.5438729524612427, mean p set: 0.44880905747413635
The modified gen p mean: 0.4500531256198883, gen p mean: -0.5476875901222229, mean p set: 0.4505334198474884
loss_pred:0.030623720958828926, decouple_loss:0.026295814663171768
loss_pred:0.031373657286167145, decouple_loss:0.025142783299088478
loss_pred:0.031786780804395676, decouple_loss:0.02494826726615429
Iteration: 1090, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800230860710144, gen p mean: -0.535727322101593, mean p set: 0.44848257303237915
The modified gen p mean: 0.4477993845939636, gen p mean: -0.5368359088897705, mean p set: 0.4482796788215637
The modified gen p mean: 0.4516885280609131, gen p mean: -0.5493845343589783, mean p set: 0.4521687626838684
loss_pred:0.030852291733026505, decouple_loss:0.024896161630749702
loss_pred:0.031188881024718285, decouple_loss:0.024851415306329727
loss_pred:0.03188369795680046, decouple_loss:0.02535661682486534
2023-05-02 21:28:23 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.5384189486503601, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5307820439338684, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5265204906463623, mean p set: 0.45035696029663086
loss_pred:0.0330849215388298, decouple_loss:0.027030078694224358
loss_pred:0.03208756074309349, decouple_loss:0.0266718752682209
loss_pred:0.031300392001867294, decouple_loss:0.026827996596693993
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03349979221820831, avg_mse: 0.03703009709715843
current test mse: 0.03703
Iteration: 1091, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45214930176734924, gen p mean: -0.5405544638633728, mean p set: 0.45262959599494934
loss_pred:0.030059438198804855, decouple_loss:0.024784428998827934
The modified gen p mean: 0.4490911662578583, gen p mean: -0.5312809348106384, mean p set: 0.44957149028778076
loss_pred:0.03203709423542023, decouple_loss:0.024334244430065155
The modified gen p mean: 0.45140671730041504, gen p mean: -0.5386065244674683, mean p set: 0.45188701152801514
loss_pred:0.03033035434782505, decouple_loss:0.024449745193123817
Iteration: 1092, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45202070474624634, gen p mean: -0.5598264336585999, mean p set: 0.45250096917152405
The modified gen p mean: 0.45157793164253235, gen p mean: -0.5515808463096619, mean p set: 0.45205825567245483
The modified gen p mean: 0.4510978162288666, gen p mean: -0.5508368015289307, mean p set: 0.4515781104564667
loss_pred:0.03157540410757065, decouple_loss:0.025597449392080307
loss_pred:0.031210709363222122, decouple_loss:0.024665283039212227
loss_pred:0.031294189393520355, decouple_loss:0.0247885100543499
Iteration: 1093, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45210736989974976, gen p mean: -0.5740627646446228, mean p set: 0.45258763432502747
The modified gen p mean: 0.4486495554447174, gen p mean: -0.5532001256942749, mean p set: 0.4491298198699951
The modified gen p mean: 0.4492226541042328, gen p mean: -0.556492269039154, mean p set: 0.4497029781341553
loss_pred:0.03130538761615753, decouple_loss:0.025440197438001633
loss_pred:0.031084416434168816, decouple_loss:0.023789415135979652
loss_pred:0.030499380081892014, decouple_loss:0.024055128917098045
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
NaN value num: 0
Iteration: 1094, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45062190294265747, gen p mean: -0.5609991550445557, mean p set: 0.4511021673679352
The modified gen p mean: 0.4524848163127899, gen p mean: -0.5602808594703674, mean p set: 0.4529651403427124
The modified gen p mean: 0.45308828353881836, gen p mean: -0.552593469619751, mean p set: 0.45356857776641846
loss_pred:0.030955590307712555, decouple_loss:0.02663978561758995
loss_pred:0.030205782502889633, decouple_loss:0.026364896446466446
loss_pred:0.03177226334810257, decouple_loss:0.026081489399075508
Iteration: 1095, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44988682866096497, gen p mean: -0.5627037286758423, mean p set: 0.4503670632839203
The modified gen p mean: 0.45215561985969543, gen p mean: -0.5569913983345032, mean p set: 0.45263591408729553
The modified gen p mean: 0.45352116227149963, gen p mean: -0.5549792051315308, mean p set: 0.45400142669677734
loss_pred:0.030267415568232536, decouple_loss:0.027366995811462402
loss_pred:0.030289707705378532, decouple_loss:0.02783181332051754
loss_pred:0.03095437027513981, decouple_loss:0.02638278156518936
Iteration: 1096, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45269882678985596, gen p mean: -0.5586906671524048, mean p set: 0.45317909121513367
The modified gen p mean: 0.45069363713264465, gen p mean: -0.5612147450447083, mean p set: 0.45117396116256714
The modified gen p mean: 0.4504817724227905, gen p mean: -0.5627281665802002, mean p set: 0.450962096452713
loss_pred:0.030648091807961464, decouple_loss:0.02676578424870968
loss_pred:0.03100750595331192, decouple_loss:0.02551971562206745
loss_pred:0.030701367184519768, decouple_loss:0.025522325187921524
Iteration: 1097, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45323196053504944, gen p mean: -0.5648701190948486, mean p set: 0.45371225476264954
The modified gen p mean: 0.4535704255104065, gen p mean: -0.5618379712104797, mean p set: 0.4540506899356842
The modified gen p mean: 0.45226365327835083, gen p mean: -0.5639889240264893, mean p set: 0.4527439475059509
loss_pred:0.03107411228120327, decouple_loss:0.026122966781258583
loss_pred:0.03126106038689613, decouple_loss:0.025913691148161888
loss_pred:0.030615944415330887, decouple_loss:0.026222623884677887
Iteration: 1098, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523571729660034, gen p mean: -0.5543070435523987, mean p set: 0.4528374671936035
The modified gen p mean: 0.45276474952697754, gen p mean: -0.5599270462989807, mean p set: 0.45324504375457764
The modified gen p mean: 0.45126619935035706, gen p mean: -0.5571229457855225, mean p set: 0.45174646377563477
loss_pred:0.030859362334012985, decouple_loss:0.02469128742814064
loss_pred:0.031153587624430656, decouple_loss:0.025213612243533134
loss_pred:0.03209107369184494, decouple_loss:0.025320565328001976
Iteration: 1099, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451273113489151, gen p mean: -0.5466300845146179, mean p set: 0.4517534077167511
The modified gen p mean: 0.45358794927597046, gen p mean: -0.5430519580841064, mean p set: 0.45406821370124817
The modified gen p mean: 0.45190176367759705, gen p mean: -0.5401270389556885, mean p set: 0.45238205790519714
loss_pred:0.030509069561958313, decouple_loss:0.027282075956463814
loss_pred:0.030772099271416664, decouple_loss:0.026177091524004936
loss_pred:0.031242791563272476, decouple_loss:0.02644515223801136
Iteration: 1100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45349135994911194, gen p mean: -0.5421079397201538, mean p set: 0.45397165417671204
The modified gen p mean: 0.453026682138443, gen p mean: -0.5415751338005066, mean p set: 0.4535069465637207
The modified gen p mean: 0.4527757465839386, gen p mean: -0.5487985014915466, mean p set: 0.4532560408115387
loss_pred:0.03024209477007389, decouple_loss:0.024963095784187317
loss_pred:0.03047669306397438, decouple_loss:0.025240955874323845
loss_pred:0.030245399102568626, decouple_loss:0.025286581367254257
2023-05-02 21:32:44 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.5596393942832947, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5522012114524841, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5468021631240845, mean p set: 0.45035696029663086
loss_pred:0.03309920057654381, decouple_loss:0.028484802693128586
loss_pred:0.032078273594379425, decouple_loss:0.027556300163269043
loss_pred:0.03133034333586693, decouple_loss:0.027894537895917892
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03356819972395897, avg_mse: 0.037129469215869904
current test mse: 0.037129
Iteration: 1101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511004686355591, gen p mean: -0.5562936067581177, mean p set: 0.4515807330608368
The modified gen p mean: 0.4527287781238556, gen p mean: -0.554791271686554, mean p set: 0.4532091021537781
loss_pred:0.03181103616952896, decouple_loss:0.02661910094320774
loss_pred:0.03220202773809433, decouple_loss:0.024690184742212296
The modified gen p mean: 0.45249542593955994, gen p mean: -0.5534112453460693, mean p set: 0.45297572016716003
loss_pred:0.03181958571076393, decouple_loss:0.024939533323049545
Iteration: 1102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535066783428192, gen p mean: -0.556049108505249, mean p set: 0.4539869725704193
The modified gen p mean: 0.45416635274887085, gen p mean: -0.5568162202835083, mean p set: 0.45464667677879333
The modified gen p mean: 0.4529445171356201, gen p mean: -0.5595546960830688, mean p set: 0.4534248113632202
loss_pred:0.031489115208387375, decouple_loss:0.02484825998544693
loss_pred:0.03110431879758835, decouple_loss:0.025146355852484703
loss_pred:0.030850011855363846, decouple_loss:0.02525031566619873
Iteration: 1103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4537309408187866, gen p mean: -0.5649778842926025, mean p set: 0.4542112350463867
The modified gen p mean: 0.45251134037971497, gen p mean: -0.5567404627799988, mean p set: 0.45299163460731506
The modified gen p mean: 0.45227381587028503, gen p mean: -0.5584983825683594, mean p set: 0.4527541399002075
loss_pred:0.03121386282145977, decouple_loss:0.0255411509424448
loss_pred:0.029824618250131607, decouple_loss:0.024012789130210876
loss_pred:0.03200777620077133, decouple_loss:0.024675460532307625
Iteration: 1104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4538218379020691, gen p mean: -0.5625731348991394, mean p set: 0.4543021321296692
The modified gen p mean: 0.452810138463974, gen p mean: -0.566875696182251, mean p set: 0.4532904326915741
The modified gen p mean: 0.4500243663787842, gen p mean: -0.57464599609375, mean p set: 0.4505046308040619
loss_pred:0.03025601990520954, decouple_loss:0.024466294795274734
loss_pred:0.03077707067131996, decouple_loss:0.024005737155675888
loss_pred:0.029906081035733223, decouple_loss:0.025529731065034866
Iteration: 1105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507077634334564, gen p mean: -0.5725146532058716, mean p set: 0.4511880576610565
The modified gen p mean: 0.4520490765571594, gen p mean: -0.5756876468658447, mean p set: 0.4525293707847595
The modified gen p mean: 0.4502796530723572, gen p mean: -0.5790111422538757, mean p set: 0.4507599174976349
loss_pred:0.031570661813020706, decouple_loss:0.024415897205471992
loss_pred:0.031064795330166817, decouple_loss:0.024749405682086945
loss_pred:0.029814908280968666, decouple_loss:0.024816645309329033
Iteration: 1106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536525011062622, gen p mean: -0.5760741829872131, mean p set: 0.4541327655315399
The modified gen p mean: 0.4503451883792877, gen p mean: -0.5744777917861938, mean p set: 0.4508254826068878
The modified gen p mean: 0.45330971479415894, gen p mean: -0.571747362613678, mean p set: 0.45378997921943665
loss_pred:0.03154353052377701, decouple_loss:0.023787664249539375
loss_pred:0.0313708670437336, decouple_loss:0.024446316063404083
loss_pred:0.030016206204891205, decouple_loss:0.023904994130134583
Iteration: 1107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452887624502182, gen p mean: -0.5647559762001038, mean p set: 0.4533679187297821
The modified gen p mean: 0.45151814818382263, gen p mean: -0.556383490562439, mean p set: 0.45199844241142273
The modified gen p mean: 0.45166248083114624, gen p mean: -0.5676186680793762, mean p set: 0.4521428048610687
loss_pred:0.0304335355758667, decouple_loss:0.024587661027908325
loss_pred:0.03073045052587986, decouple_loss:0.024754824116826057
loss_pred:0.029236529022455215, decouple_loss:0.02475936897099018
Iteration: 1108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45210379362106323, gen p mean: -0.5467182397842407, mean p set: 0.45258408784866333
The modified gen p mean: 0.45130711793899536, gen p mean: -0.5515537261962891, mean p set: 0.45178741216659546
The modified gen p mean: 0.45364370942115784, gen p mean: -0.5522585511207581, mean p set: 0.4541240334510803
loss_pred:0.03199382126331329, decouple_loss:0.023577924817800522
loss_pred:0.029876941815018654, decouple_loss:0.025298917666077614
loss_pred:0.03066699206829071, decouple_loss:0.024065814912319183
Iteration: 1109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525628387928009, gen p mean: -0.555982232093811, mean p set: 0.453043133020401
The modified gen p mean: 0.4518187940120697, gen p mean: -0.5565107464790344, mean p set: 0.4522990584373474
The modified gen p mean: 0.4525458514690399, gen p mean: -0.5561265349388123, mean p set: 0.45302614569664
loss_pred:0.03042265959084034, decouple_loss:0.02464919164776802
loss_pred:0.03119784966111183, decouple_loss:0.024105923250317574
loss_pred:0.030426155775785446, decouple_loss:0.02377212606370449
Iteration: 1110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521459639072418, gen p mean: -0.5654716491699219, mean p set: 0.4526262879371643
The modified gen p mean: 0.4519471526145935, gen p mean: -0.5586712956428528, mean p set: 0.452427476644516
The modified gen p mean: 0.45072656869888306, gen p mean: -0.5676137208938599, mean p set: 0.45120686292648315
loss_pred:0.029842471703886986, decouple_loss:0.0246643777936697
loss_pred:0.03071635589003563, decouple_loss:0.02329866774380207
loss_pred:0.029697908088564873, decouple_loss:0.024578513577580452
2023-05-02 21:36:23 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.5709073543548584, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.5785691738128662, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5664990544319153, mean p set: 0.45035696029663086
loss_pred:0.031910490244627, decouple_loss:0.02652886137366295
loss_pred:0.0328497551381588, decouple_loss:0.027551641687750816
loss_pred:0.03114173747599125, decouple_loss:0.02689947932958603
WV_0_PC_1_EH_0_PS_40_6, loss: 0.033316995948553085, avg_mse: 0.03683800250291824
current test mse: 0.036838
Iteration: 1111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512979984283447, gen p mean: -0.5715034604072571, mean p set: 0.4517782926559448
The modified gen p mean: 0.4529880881309509, gen p mean: -0.5678651332855225, mean p set: 0.4534684121608734
loss_pred:0.031359925866127014, decouple_loss:0.024101177230477333
loss_pred:0.03002830408513546, decouple_loss:0.023982686921954155
The modified gen p mean: 0.4529775083065033, gen p mean: -0.5721774697303772, mean p set: 0.4534578025341034
loss_pred:0.030294356867671013, decouple_loss:0.023023834452033043
Iteration: 1112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534977972507477, gen p mean: -0.5704189538955688, mean p set: 0.4539780914783478
The modified gen p mean: 0.4511784315109253, gen p mean: -0.5744683146476746, mean p set: 0.4516587555408478
The modified gen p mean: 0.4519036114215851, gen p mean: -0.567629337310791, mean p set: 0.4523839056491852
loss_pred:0.030981943011283875, decouple_loss:0.023984774947166443
loss_pred:0.030116630718111992, decouple_loss:0.02420736849308014
loss_pred:0.030111199244856834, decouple_loss:0.024170678108930588
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
NaN value num: 0
Iteration: 1113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45174404978752136, gen p mean: -0.5645360350608826, mean p set: 0.45222434401512146
The modified gen p mean: 0.4486335217952728, gen p mean: -0.5630863308906555, mean p set: 0.4491138160228729
The modified gen p mean: 0.45079007744789124, gen p mean: -0.5632572174072266, mean p set: 0.45127037167549133
loss_pred:0.031940121203660965, decouple_loss:0.025709304958581924
loss_pred:0.03137149289250374, decouple_loss:0.02438191883265972
loss_pred:0.031014131382107735, decouple_loss:0.024182412773370743
Iteration: 1114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482405185699463, gen p mean: -0.5669758915901184, mean p set: 0.4487208127975464
The modified gen p mean: 0.4495053291320801, gen p mean: -0.5728355646133423, mean p set: 0.4499855935573578
The modified gen p mean: 0.45027220249176025, gen p mean: -0.5693007707595825, mean p set: 0.45075252652168274
loss_pred:0.031199997290968895, decouple_loss:0.02465788647532463
loss_pred:0.0305032841861248, decouple_loss:0.024167532101273537
loss_pred:0.03148205578327179, decouple_loss:0.024950223043560982
Iteration: 1115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45154479146003723, gen p mean: -0.5850204229354858, mean p set: 0.45202508568763733
The modified gen p mean: 0.4489624798297882, gen p mean: -0.5855871438980103, mean p set: 0.4494428038597107
The modified gen p mean: 0.4499434530735016, gen p mean: -0.5870864987373352, mean p set: 0.4504237771034241
loss_pred:0.03395304083824158, decouple_loss:0.024324936792254448
loss_pred:0.031197985634207726, decouple_loss:0.02490190602838993
loss_pred:0.030474267899990082, decouple_loss:0.024257585406303406
Iteration: 1116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45023971796035767, gen p mean: -0.5844205617904663, mean p set: 0.45072001218795776
The modified gen p mean: 0.4504573941230774, gen p mean: -0.5859550833702087, mean p set: 0.4509376883506775
The modified gen p mean: 0.45031604170799255, gen p mean: -0.5862479209899902, mean p set: 0.45079630613327026
loss_pred:0.031412672251462936, decouple_loss:0.02449447102844715
loss_pred:0.03176801651716232, decouple_loss:0.02378654293715954
loss_pred:0.030061865225434303, decouple_loss:0.02302892692387104
Iteration: 1117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494793713092804, gen p mean: -0.5828679203987122, mean p set: 0.4499596655368805
The modified gen p mean: 0.44919106364250183, gen p mean: -0.5772477984428406, mean p set: 0.44967135787010193
The modified gen p mean: 0.44781234860420227, gen p mean: -0.5739141702651978, mean p set: 0.44829264283180237
loss_pred:0.0301340501755476, decouple_loss:0.024043740704655647
loss_pred:0.030920181423425674, decouple_loss:0.023924846202135086
loss_pred:0.031961970031261444, decouple_loss:0.02536982297897339
Iteration: 1118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492426812648773, gen p mean: -0.5690140128135681, mean p set: 0.4497230052947998
The modified gen p mean: 0.44993776082992554, gen p mean: -0.5718498229980469, mean p set: 0.45041805505752563
The modified gen p mean: 0.45043060183525085, gen p mean: -0.5727241635322571, mean p set: 0.45091089606285095
loss_pred:0.030890218913555145, decouple_loss:0.023269904777407646
loss_pred:0.030352873727679253, decouple_loss:0.023725204169750214
loss_pred:0.03042563796043396, decouple_loss:0.023763632401823997
Iteration: 1119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487953186035156, gen p mean: -0.5621038675308228, mean p set: 0.4492756426334381
The modified gen p mean: 0.4521694481372833, gen p mean: -0.5663090944290161, mean p set: 0.4526497423648834
The modified gen p mean: 0.4506310820579529, gen p mean: -0.564236044883728, mean p set: 0.451111376285553
loss_pred:0.03298671543598175, decouple_loss:0.023440225049853325
loss_pred:0.02975827269256115, decouple_loss:0.02328653074800968
loss_pred:0.03016415797173977, decouple_loss:0.023310460150241852
Iteration: 1120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44963958859443665, gen p mean: -0.5680528283119202, mean p set: 0.45011985301971436
The modified gen p mean: 0.45083239674568176, gen p mean: -0.5714371800422668, mean p set: 0.45131269097328186
The modified gen p mean: 0.4473547339439392, gen p mean: -0.5670444369316101, mean p set: 0.4478350281715393
loss_pred:0.03001837059855461, decouple_loss:0.023262543603777885
loss_pred:0.02934160642325878, decouple_loss:0.023119715973734856
loss_pred:0.031382761895656586, decouple_loss:0.023377621546387672
2023-05-02 21:40:44 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.5778002738952637, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5701666474342346, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5659055113792419, mean p set: 0.45035696029663086
loss_pred:0.03250450640916824, decouple_loss:0.027655411511659622
loss_pred:0.031614966690540314, decouple_loss:0.026117054745554924
loss_pred:0.03086240030825138, decouple_loss:0.026816580444574356
WV_0_PC_1_EH_0_PS_40_6, loss: 0.033003777265548706, avg_mse: 0.036428216844797134
current test mse: 0.036428
Iteration: 1121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781580567359924, gen p mean: -0.5650081634521484, mean p set: 0.44829609990119934
loss_pred:0.03180352970957756, decouple_loss:0.02419484592974186
The modified gen p mean: 0.4489538371562958, gen p mean: -0.569176197052002, mean p set: 0.44943416118621826
loss_pred:0.030497241765260696, decouple_loss:0.022664746269583702
The modified gen p mean: 0.4502425789833069, gen p mean: -0.5716437101364136, mean p set: 0.4507228434085846
loss_pred:0.03145968168973923, decouple_loss:0.024674678221344948
Iteration: 1122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900259375572205, gen p mean: -0.5751810073852539, mean p set: 0.44948288798332214
The modified gen p mean: 0.4511122703552246, gen p mean: -0.5717637538909912, mean p set: 0.4515925347805023
The modified gen p mean: 0.4497719705104828, gen p mean: -0.5716402530670166, mean p set: 0.4502522349357605
loss_pred:0.029436178505420685, decouple_loss:0.02364383079111576
loss_pred:0.030208706855773926, decouple_loss:0.022440874949097633
loss_pred:0.02992209792137146, decouple_loss:0.02347629889845848
Iteration: 1123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890737533569336, gen p mean: -0.5665498971939087, mean p set: 0.44938766956329346
The modified gen p mean: 0.45106568932533264, gen p mean: -0.5653988122940063, mean p set: 0.45154598355293274
The modified gen p mean: 0.44889235496520996, gen p mean: -0.5658072233200073, mean p set: 0.44937264919281006
loss_pred:0.030187001451849937, decouple_loss:0.02298389934003353
loss_pred:0.03068666160106659, decouple_loss:0.022146666422486305
loss_pred:0.03200376778841019, decouple_loss:0.02367446944117546
Iteration: 1124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508521556854248, gen p mean: -0.5675762295722961, mean p set: 0.4513324499130249
The modified gen p mean: 0.44972679018974304, gen p mean: -0.5657095909118652, mean p set: 0.45020708441734314
The modified gen p mean: 0.44784224033355713, gen p mean: -0.5602903366088867, mean p set: 0.4483225345611572
loss_pred:0.03139467164874077, decouple_loss:0.02359657734632492
loss_pred:0.032077278941869736, decouple_loss:0.022934777662158012
loss_pred:0.0321461521089077, decouple_loss:0.02352602779865265
Iteration: 1125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45048201084136963, gen p mean: -0.5692804455757141, mean p set: 0.4509623348712921
The modified gen p mean: 0.4503285884857178, gen p mean: -0.567182183265686, mean p set: 0.45080891251564026
The modified gen p mean: 0.4473794400691986, gen p mean: -0.5613360404968262, mean p set: 0.4478597342967987
loss_pred:0.03190223127603531, decouple_loss:0.023725120350718498
loss_pred:0.03269975632429123, decouple_loss:0.0248660147190094
loss_pred:0.03206081688404083, decouple_loss:0.02391684800386429
Iteration: 1126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45113056898117065, gen p mean: -0.5642989277839661, mean p set: 0.45161086320877075
The modified gen p mean: 0.44764044880867004, gen p mean: -0.5543218851089478, mean p set: 0.44812071323394775
The modified gen p mean: 0.4504087269306183, gen p mean: -0.5592892169952393, mean p set: 0.450888991355896
loss_pred:0.030831385403871536, decouple_loss:0.022942762821912766
loss_pred:0.03203452005982399, decouple_loss:0.022632338106632233
loss_pred:0.030663082376122475, decouple_loss:0.022666653618216515
Iteration: 1127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44923341274261475, gen p mean: -0.5583263635635376, mean p set: 0.44971367716789246
The modified gen p mean: 0.44853904843330383, gen p mean: -0.5587335228919983, mean p set: 0.44901934266090393
The modified gen p mean: 0.4503253102302551, gen p mean: -0.5603541731834412, mean p set: 0.4508056342601776
loss_pred:0.03224825859069824, decouple_loss:0.02288975566625595
loss_pred:0.030826350674033165, decouple_loss:0.023089006543159485
loss_pred:0.02936752513051033, decouple_loss:0.02279704250395298
Iteration: 1128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477939307689667, gen p mean: -0.5573796033859253, mean p set: 0.4482741951942444
The modified gen p mean: 0.44816330075263977, gen p mean: -0.5626093745231628, mean p set: 0.4486435651779175
The modified gen p mean: 0.44892337918281555, gen p mean: -0.5601794123649597, mean p set: 0.44940370321273804
loss_pred:0.031639475375413895, decouple_loss:0.022942904382944107
loss_pred:0.030495619401335716, decouple_loss:0.022682903334498405
loss_pred:0.031714025884866714, decouple_loss:0.02320958487689495
Iteration: 1129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495418667793274, gen p mean: -0.5713207125663757, mean p set: 0.4500221312046051
The modified gen p mean: 0.4491342604160309, gen p mean: -0.5655719637870789, mean p set: 0.4496145248413086
The modified gen p mean: 0.44983917474746704, gen p mean: -0.5729069709777832, mean p set: 0.45031946897506714
loss_pred:0.029027307406067848, decouple_loss:0.022735595703125
loss_pred:0.03220003470778465, decouple_loss:0.02230069786310196
loss_pred:0.03138803318142891, decouple_loss:0.02360682561993599
Iteration: 1130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514254629611969, gen p mean: -0.5678413510322571, mean p set: 0.4519057869911194
The modified gen p mean: 0.44736045598983765, gen p mean: -0.5631720423698425, mean p set: 0.44784078001976013
The modified gen p mean: 0.4510965049266815, gen p mean: -0.5697584748268127, mean p set: 0.4515767991542816
loss_pred:0.03413236141204834, decouple_loss:0.022848496213555336
loss_pred:0.031200194731354713, decouple_loss:0.022973809391260147
loss_pred:0.029713863506913185, decouple_loss:0.02251816913485527
2023-05-02 21:44:28 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.559975802898407, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.5676474571228027, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.55552738904953, mean p set: 0.45035696029663086
loss_pred:0.03168565779924393, decouple_loss:0.025531960651278496
loss_pred:0.03252912685275078, decouple_loss:0.026656318455934525
loss_pred:0.030988022685050964, decouple_loss:0.026149146258831024
WV_0_PC_1_EH_0_PS_40_6, loss: 0.033039893954992294, avg_mse: 0.03666286915540695
current test mse: 0.036663
Iteration: 1131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44945549964904785, gen p mean: -0.5607370138168335, mean p set: 0.44993579387664795
The modified gen p mean: 0.4494791328907013, gen p mean: -0.5588335394859314, mean p set: 0.4499594569206238
loss_pred:0.030570533126592636, decouple_loss:0.02292904630303383
loss_pred:0.030411578714847565, decouple_loss:0.022917436435818672
The modified gen p mean: 0.44856590032577515, gen p mean: -0.5616138577461243, mean p set: 0.44904619455337524
loss_pred:0.03177972510457039, decouple_loss:0.022637607529759407
Iteration: 1132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846534729003906, gen p mean: -0.561099648475647, mean p set: 0.4489456117153168
The modified gen p mean: 0.4495643079280853, gen p mean: -0.5622910261154175, mean p set: 0.4500446021556854
The modified gen p mean: 0.4478864371776581, gen p mean: -0.5543421506881714, mean p set: 0.4483667314052582
loss_pred:0.030614402145147324, decouple_loss:0.022776132449507713
loss_pred:0.030845317989587784, decouple_loss:0.022214019671082497
loss_pred:0.031731173396110535, decouple_loss:0.0229717418551445
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
NaN value num: 0
Iteration: 1133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513704478740692, gen p mean: -0.5579937696456909, mean p set: 0.4518507122993469
The modified gen p mean: 0.4535072147846222, gen p mean: -0.571770966053009, mean p set: 0.4539874494075775
The modified gen p mean: 0.4517292380332947, gen p mean: -0.5712352991104126, mean p set: 0.4522095024585724
loss_pred:0.029186826199293137, decouple_loss:0.0240174513310194
loss_pred:0.031361863017082214, decouple_loss:0.023663243278861046
loss_pred:0.03155375272035599, decouple_loss:0.023992236703634262
Iteration: 1134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521905779838562, gen p mean: -0.549386739730835, mean p set: 0.4526708722114563
The modified gen p mean: 0.4520209729671478, gen p mean: -0.5590487122535706, mean p set: 0.45250123739242554
The modified gen p mean: 0.4521346986293793, gen p mean: -0.5498083233833313, mean p set: 0.452614963054657
loss_pred:0.030215570703148842, decouple_loss:0.023579662665724754loss_pred:0.030613470822572708, decouple_loss:0.023385122418403625
loss_pred:0.030940530821681023, decouple_loss:0.02351379580795765
Iteration: 1135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45054686069488525, gen p mean: -0.5505569577217102, mean p set: 0.45102712512016296
The modified gen p mean: 0.45040634274482727, gen p mean: -0.5457939505577087, mean p set: 0.450886607170105
The modified gen p mean: 0.45066696405410767, gen p mean: -0.5498040318489075, mean p set: 0.45114725828170776
loss_pred:0.030956624075770378, decouple_loss:0.02520282194018364
loss_pred:0.03210943192243576, decouple_loss:0.024102890864014626
loss_pred:0.03068574145436287, decouple_loss:0.024263184517621994
Iteration: 1136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506949186325073, gen p mean: -0.5607427358627319, mean p set: 0.45117518305778503
The modified gen p mean: 0.45038336515426636, gen p mean: -0.5588425993919373, mean p set: 0.4508635997772217
The modified gen p mean: 0.45292168855667114, gen p mean: -0.5712440609931946, mean p set: 0.45340198278427124
loss_pred:0.029700452461838722, decouple_loss:0.022698307409882545
loss_pred:0.03086933307349682, decouple_loss:0.02392660453915596
loss_pred:0.028832189738750458, decouple_loss:0.02369043603539467
Iteration: 1137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45328277349472046, gen p mean: -0.5724551677703857, mean p set: 0.45376312732696533
The modified gen p mean: 0.4515725374221802, gen p mean: -0.5691157579421997, mean p set: 0.4520528018474579
The modified gen p mean: 0.45291367173194885, gen p mean: -0.5737932920455933, mean p set: 0.45339396595954895
loss_pred:0.03007528744637966, decouple_loss:0.02397914230823517
loss_pred:0.030249452218413353, decouple_loss:0.02267163060605526
loss_pred:0.029897136613726616, decouple_loss:0.023630401119589806
Iteration: 1138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517481029033661, gen p mean: -0.5721144676208496, mean p set: 0.4522283971309662
The modified gen p mean: 0.45337003469467163, gen p mean: -0.575031042098999, mean p set: 0.4538503587245941
The modified gen p mean: 0.4532754719257355, gen p mean: -0.5762313008308411, mean p set: 0.45375579595565796
loss_pred:0.030136045068502426, decouple_loss:0.022425780072808266
loss_pred:0.02822449803352356, decouple_loss:0.022504661232233047
loss_pred:0.029963726177811623, decouple_loss:0.023537728935480118
Iteration: 1139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534585177898407, gen p mean: -0.5643112063407898, mean p set: 0.4539388418197632
The modified gen p mean: 0.45275965332984924, gen p mean: -0.5606046915054321, mean p set: 0.45323994755744934
The modified gen p mean: 0.4522361159324646, gen p mean: -0.5661524534225464, mean p set: 0.4527163803577423
loss_pred:0.03064241074025631, decouple_loss:0.024105723947286606
loss_pred:0.030989717692136765, decouple_loss:0.02313450537621975
loss_pred:0.031147250905632973, decouple_loss:0.023444248363375664
Iteration: 1140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44965657591819763, gen p mean: -0.5500457882881165, mean p set: 0.45013684034347534
The modified gen p mean: 0.4495322108268738, gen p mean: -0.5514212846755981, mean p set: 0.4500125050544739
The modified gen p mean: 0.45024070143699646, gen p mean: -0.5491778254508972, mean p set: 0.45072096586227417
loss_pred:0.031489357352256775, decouple_loss:0.023981675505638123
loss_pred:0.031406816095113754, decouple_loss:0.023750633001327515
loss_pred:0.031784653663635254, decouple_loss:0.024293238297104836
2023-05-02 21:48:51 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.5757945775985718, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5680603384971619, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5634007453918457, mean p set: 0.45035696029663086
loss_pred:0.03244787082076073, decouple_loss:0.027625655755400658
loss_pred:0.031586211174726486, decouple_loss:0.02656666561961174
loss_pred:0.030847325921058655, decouple_loss:0.026880163699388504
WV_0_PC_1_EH_0_PS_40_6, loss: 0.032978348433971405, avg_mse: 0.03645198792219162
current test mse: 0.036452
Iteration: 1141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508916139602661, gen p mean: -0.5610160827636719, mean p set: 0.4513719379901886
The modified gen p mean: 0.45002231001853943, gen p mean: -0.5603289604187012, mean p set: 0.4505026042461395
loss_pred:0.030806276947259903, decouple_loss:0.024730335921049118
loss_pred:0.03095688670873642, decouple_loss:0.02325010485947132
The modified gen p mean: 0.4500981867313385, gen p mean: -0.5624523162841797, mean p set: 0.4505784809589386
loss_pred:0.029948752373456955, decouple_loss:0.024926185607910156
Iteration: 1142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505334794521332, gen p mean: -0.5645948648452759, mean p set: 0.45101380348205566
The modified gen p mean: 0.4515621066093445, gen p mean: -0.5663260817527771, mean p set: 0.4520423710346222
The modified gen p mean: 0.4506235420703888, gen p mean: -0.5635857582092285, mean p set: 0.4511038064956665
loss_pred:0.030313126742839813, decouple_loss:0.02443108521401882
loss_pred:0.02998523600399494, decouple_loss:0.02313993312418461
loss_pred:0.03060176782310009, decouple_loss:0.0253293514251709
Iteration: 1143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529750347137451, gen p mean: -0.5811311602592468, mean p set: 0.4534553289413452
The modified gen p mean: 0.4523312449455261, gen p mean: -0.5713592171669006, mean p set: 0.4528115391731262
The modified gen p mean: 0.4505973160266876, gen p mean: -0.5683773159980774, mean p set: 0.45107758045196533
loss_pred:0.03001253865659237, decouple_loss:0.023807764053344727
loss_pred:0.03117726929485798, decouple_loss:0.023802079260349274
loss_pred:0.03040064126253128, decouple_loss:0.024742700159549713
Iteration: 1144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45068544149398804, gen p mean: -0.5659245848655701, mean p set: 0.45116573572158813
The modified gen p mean: 0.4494536221027374, gen p mean: -0.5601596832275391, mean p set: 0.4499339163303375
The modified gen p mean: 0.452411949634552, gen p mean: -0.5683066844940186, mean p set: 0.4528922438621521
loss_pred:0.031014004722237587, decouple_loss:0.02407086081802845
loss_pred:0.03141013905405998, decouple_loss:0.023758478462696075
loss_pred:0.030430328100919724, decouple_loss:0.023130444809794426
Iteration: 1145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516531229019165, gen p mean: -0.561366856098175, mean p set: 0.4521334171295166
The modified gen p mean: 0.4520135819911957, gen p mean: -0.5600549578666687, mean p set: 0.4524938464164734
The modified gen p mean: 0.4491192400455475, gen p mean: -0.5566027164459229, mean p set: 0.4495995044708252
loss_pred:0.030769187957048416, decouple_loss:0.023637821897864342
loss_pred:0.030685676261782646, decouple_loss:0.023618845269083977
loss_pred:0.0311448834836483, decouple_loss:0.02414889447391033
Iteration: 1146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518355429172516, gen p mean: -0.5695984959602356, mean p set: 0.4523157775402069
The modified gen p mean: 0.45031094551086426, gen p mean: -0.5638126730918884, mean p set: 0.45079126954078674
The modified gen p mean: 0.45178914070129395, gen p mean: -0.5653690099716187, mean p set: 0.45226943492889404
loss_pred:0.030817300081253052, decouple_loss:0.023042036220431328
loss_pred:0.030161380767822266, decouple_loss:0.022590160369873047
loss_pred:0.030653977766633034, decouple_loss:0.022756371647119522
Iteration: 1147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45199593901634216, gen p mean: -0.5733211636543274, mean p set: 0.45247623324394226
The modified gen p mean: 0.4527318775653839, gen p mean: -0.5806994438171387, mean p set: 0.453212171792984
The modified gen p mean: 0.44847601652145386, gen p mean: -0.5617280006408691, mean p set: 0.44895628094673157
loss_pred:0.030794616788625717, decouple_loss:0.022933343425393105
loss_pred:0.030573537573218346, decouple_loss:0.024297237396240234
loss_pred:0.031294308602809906, decouple_loss:0.023562951013445854
Iteration: 1148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513097405433655, gen p mean: -0.563323974609375, mean p set: 0.4517900347709656
The modified gen p mean: 0.45025834441185, gen p mean: -0.5664329528808594, mean p set: 0.4507386088371277
The modified gen p mean: 0.45171672105789185, gen p mean: -0.5757167935371399, mean p set: 0.45219701528549194
loss_pred:0.030188104137778282, decouple_loss:0.022275079041719437
loss_pred:0.03076965920627117, decouple_loss:0.022587819024920464
loss_pred:0.029199030250310898, decouple_loss:0.02477801777422428
Iteration: 1149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45081716775894165, gen p mean: -0.5599744915962219, mean p set: 0.45129746198654175
The modified gen p mean: 0.45033156871795654, gen p mean: -0.5589839816093445, mean p set: 0.45081186294555664
loss_pred:0.03174109756946564, decouple_loss:0.022369680926203728
The modified gen p mean: 0.45126330852508545, gen p mean: -0.5716605186462402, mean p set: 0.45174357295036316
loss_pred:0.031054407358169556, decouple_loss:0.023720912635326385
loss_pred:0.031188519671559334, decouple_loss:0.023336410522460938
Iteration: 1150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44940948486328125, gen p mean: -0.5589417219161987, mean p set: 0.44988977909088135
The modified gen p mean: 0.4521675705909729, gen p mean: -0.5751947164535522, mean p set: 0.452647864818573
The modified gen p mean: 0.4508422911167145, gen p mean: -0.56770259141922, mean p set: 0.4513225853443146
loss_pred:0.03136416897177696, decouple_loss:0.023032020777463913
loss_pred:0.02923189103603363, decouple_loss:0.02376333437860012
loss_pred:0.02968229539692402, decouple_loss:0.022793900221586227
2023-05-02 21:52:32 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.5780600309371948, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.5853703618049622, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5738194584846497, mean p set: 0.45035696029663086
loss_pred:0.031513139605522156, decouple_loss:0.02573770098388195
loss_pred:0.032479334622621536, decouple_loss:0.027163686230778694
loss_pred:0.03072964958846569, decouple_loss:0.026318518444895744
WV_0_PC_1_EH_0_PS_40_6, loss: 0.032894376665353775, avg_mse: 0.03660428896546364
current test mse: 0.036604
Iteration: 1151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520556330680847, gen p mean: -0.5802509784698486, mean p set: 0.4525359272956848
The modified gen p mean: 0.45062869787216187, gen p mean: -0.5780346393585205, mean p set: 0.45110899209976196
loss_pred:0.029833674430847168, decouple_loss:0.02330510877072811
loss_pred:0.031165268272161484, decouple_loss:0.022393686696887016
The modified gen p mean: 0.4503253102302551, gen p mean: -0.5745392441749573, mean p set: 0.4508056044578552
loss_pred:0.03120977245271206, decouple_loss:0.021551676094532013
Iteration: 1152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536181092262268, gen p mean: -0.5861993432044983, mean p set: 0.45409834384918213
The modified gen p mean: 0.45201101899147034, gen p mean: -0.5796452760696411, mean p set: 0.4524913430213928
The modified gen p mean: 0.45201683044433594, gen p mean: -0.5733172297477722, mean p set: 0.45249712467193604
loss_pred:0.02947372943162918, decouple_loss:0.022441470995545387
loss_pred:0.030444186180830002, decouple_loss:0.02222418785095215
loss_pred:0.030573522672057152, decouple_loss:0.02200724557042122
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 1153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482875466346741, gen p mean: -0.572628915309906, mean p set: 0.4487678110599518
The modified gen p mean: 0.44798049330711365, gen p mean: -0.574883222579956, mean p set: 0.44846081733703613
The modified gen p mean: 0.44612351059913635, gen p mean: -0.5733727216720581, mean p set: 0.44660380482673645
loss_pred:0.03130949288606644, decouple_loss:0.02512134052813053
loss_pred:0.03260643035173416, decouple_loss:0.026606528088450432
loss_pred:0.030934832990169525, decouple_loss:0.02570519410073757
Iteration: 1154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758838415145874, gen p mean: -0.5719192028045654, mean p set: 0.44806867837905884
The modified gen p mean: 0.447736531496048, gen p mean: -0.5675503015518188, mean p set: 0.44821682572364807
The modified gen p mean: 0.44775062799453735, gen p mean: -0.5679588913917542, mean p set: 0.4482308626174927
loss_pred:0.03139136731624603, decouple_loss:0.026293693110346794
loss_pred:0.03252538666129112, decouple_loss:0.024800356477499008
loss_pred:0.0320889838039875, decouple_loss:0.024281278252601624
Iteration: 1155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471328556537628, gen p mean: -0.5713147521018982, mean p set: 0.4476131498813629
The modified gen p mean: 0.44694724678993225, gen p mean: -0.5745921730995178, mean p set: 0.44742754101753235
The modified gen p mean: 0.44838187098503113, gen p mean: -0.5672406554222107, mean p set: 0.4488621652126312
loss_pred:0.031017109751701355, decouple_loss:0.02342471294105053
loss_pred:0.03102579154074192, decouple_loss:0.025332991033792496
loss_pred:0.032005880028009415, decouple_loss:0.022938381880521774
Iteration: 1156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473842680454254, gen p mean: -0.5818630456924438, mean p set: 0.4478645324707031
The modified gen p mean: 0.44754457473754883, gen p mean: -0.5770411491394043, mean p set: 0.4480248689651489
The modified gen p mean: 0.44696974754333496, gen p mean: -0.579812228679657, mean p set: 0.44745007157325745
loss_pred:0.030863545835018158, decouple_loss:0.024641823023557663
loss_pred:0.030908651649951935, decouple_loss:0.02409942075610161
loss_pred:0.030998559668660164, decouple_loss:0.023181438446044922
Iteration: 1157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44873055815696716, gen p mean: -0.5728352069854736, mean p set: 0.4492107927799225
The modified gen p mean: 0.4471362233161926, gen p mean: -0.5779903531074524, mean p set: 0.44761648774147034
The modified gen p mean: 0.44831040501594543, gen p mean: -0.5772905945777893, mean p set: 0.44879069924354553
loss_pred:0.03190707042813301, decouple_loss:0.023930607363581657
loss_pred:0.031055307015776634, decouple_loss:0.023273997008800507
loss_pred:0.03081800416111946, decouple_loss:0.02274998463690281
Iteration: 1158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44775915145874023, gen p mean: -0.5733542442321777, mean p set: 0.44823944568634033
The modified gen p mean: 0.447527676820755, gen p mean: -0.5724393129348755, mean p set: 0.4480080008506775
The modified gen p mean: 0.44766926765441895, gen p mean: -0.5719338059425354, mean p set: 0.44814959168434143
loss_pred:0.03177397698163986, decouple_loss:0.023176880553364754
loss_pred:0.031383369117975235, decouple_loss:0.024689892306923866
loss_pred:0.03085220791399479, decouple_loss:0.024420766159892082
Iteration: 1159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744864106178284, gen p mean: -0.570990264415741, mean p set: 0.44792893528938293
The modified gen p mean: 0.4482972323894501, gen p mean: -0.5734291076660156, mean p set: 0.44877755641937256
The modified gen p mean: 0.4473407566547394, gen p mean: -0.5695213675498962, mean p set: 0.4478210508823395
loss_pred:0.03212032839655876, decouple_loss:0.02398534119129181
loss_pred:0.032191552221775055, decouple_loss:0.023610638454556465
loss_pred:0.03185988590121269, decouple_loss:0.023620236665010452
Iteration: 1160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742661714553833, gen p mean: -0.5726629495620728, mean p set: 0.4479069411754608
The modified gen p mean: 0.44712865352630615, gen p mean: -0.5717044472694397, mean p set: 0.44760891795158386
The modified gen p mean: 0.4482654631137848, gen p mean: -0.5713266730308533, mean p set: 0.4487457573413849
loss_pred:0.032141827046871185, decouple_loss:0.02362029440701008
loss_pred:0.03217265382409096, decouple_loss:0.024366803467273712
loss_pred:0.03223158419132233, decouple_loss:0.0232451893389225
2023-05-02 21:56:59 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5733049511909485, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.5806633234024048, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5691153407096863, mean p set: 0.45035696029663086
loss_pred:0.031063003465533257, decouple_loss:0.023397689685225487
loss_pred:0.03198526054620743, decouple_loss:0.023933058604598045
loss_pred:0.030337514355778694, decouple_loss:0.023722346872091293
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03231281042098999, avg_mse: 0.03583592176437378
current test mse: 0.035836
Iteration: 1161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480758309364319, gen p mean: -0.5688482522964478, mean p set: 0.44855615496635437
The modified gen p mean: 0.44723832607269287, gen p mean: -0.5720468163490295, mean p set: 0.44771865010261536
loss_pred:0.031353894621133804, decouple_loss:0.02282451093196869
loss_pred:0.03065524622797966, decouple_loss:0.023766260594129562
The modified gen p mean: 0.4474486708641052, gen p mean: -0.5751453638076782, mean p set: 0.4479289650917053
loss_pred:0.03172113001346588, decouple_loss:0.02288161963224411
Iteration: 1162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44734418392181396, gen p mean: -0.5708491206169128, mean p set: 0.4478244483470917
The modified gen p mean: 0.44856178760528564, gen p mean: -0.5682317018508911, mean p set: 0.44904205203056335
The modified gen p mean: 0.4468141496181488, gen p mean: -0.5736733675003052, mean p set: 0.4472944438457489
loss_pred:0.0313512347638607, decouple_loss:0.023393085226416588
loss_pred:0.030712757259607315, decouple_loss:0.023271065205335617
loss_pred:0.03142407909035683, decouple_loss:0.023925194516777992
Iteration: 1163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780266284942627, gen p mean: -0.5777702331542969, mean p set: 0.44828295707702637
The modified gen p mean: 0.4481663703918457, gen p mean: -0.5731807947158813, mean p set: 0.4486466944217682
The modified gen p mean: 0.44706377387046814, gen p mean: -0.5730772018432617, mean p set: 0.44754406809806824
loss_pred:0.031996071338653564, decouple_loss:0.02225567027926445
loss_pred:0.03142295032739639, decouple_loss:0.02405259758234024
loss_pred:0.03138049691915512, decouple_loss:0.022594332695007324
Iteration: 1164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822150468826294, gen p mean: -0.5707843899726868, mean p set: 0.44870179891586304
The modified gen p mean: 0.4472610652446747, gen p mean: -0.5681610107421875, mean p set: 0.4477413594722748
The modified gen p mean: 0.4488472044467926, gen p mean: -0.5645593404769897, mean p set: 0.4493274986743927
loss_pred:0.030848871916532516, decouple_loss:0.023387344554066658
loss_pred:0.03155602887272835, decouple_loss:0.02278527058660984
loss_pred:0.03109234943985939, decouple_loss:0.022172272205352783
Iteration: 1165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466997981071472, gen p mean: -0.573120653629303, mean p set: 0.4471800923347473
The modified gen p mean: 0.44783878326416016, gen p mean: -0.5757165551185608, mean p set: 0.44831904768943787
The modified gen p mean: 0.4473603069782257, gen p mean: -0.5706360936164856, mean p set: 0.4478406012058258
loss_pred:0.03211131691932678, decouple_loss:0.022438857704401016
loss_pred:0.031575459986925125, decouple_loss:0.023628829047083855
loss_pred:0.03173753619194031, decouple_loss:0.022914104163646698
Iteration: 1166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472653865814209, gen p mean: -0.5801273584365845, mean p set: 0.4477456510066986
The modified gen p mean: 0.4477286636829376, gen p mean: -0.579172670841217, mean p set: 0.4482089579105377
The modified gen p mean: 0.447806179523468, gen p mean: -0.574402928352356, mean p set: 0.4482864737510681
loss_pred:0.03171852231025696, decouple_loss:0.0229871217161417
loss_pred:0.03145836666226387, decouple_loss:0.022654807195067406
loss_pred:0.030839473009109497, decouple_loss:0.02244531363248825
Iteration: 1167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44658082723617554, gen p mean: -0.5828706622123718, mean p set: 0.44706112146377563
The modified gen p mean: 0.4472672641277313, gen p mean: -0.5795333981513977, mean p set: 0.4477475583553314
The modified gen p mean: 0.4477596580982208, gen p mean: -0.5833728313446045, mean p set: 0.4482399523258209
loss_pred:0.031681761145591736, decouple_loss:0.022446922957897186
loss_pred:0.030533256009221077, decouple_loss:0.022505776956677437
loss_pred:0.0318218432366848, decouple_loss:0.022954186424613
Iteration: 1168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44617268443107605, gen p mean: -0.5791447758674622, mean p set: 0.44665300846099854
The modified gen p mean: 0.44900867342948914, gen p mean: -0.5805952548980713, mean p set: 0.4494889974594116
The modified gen p mean: 0.4476584792137146, gen p mean: -0.581192672252655, mean p set: 0.4481387734413147
loss_pred:0.03132744878530502, decouple_loss:0.02233637124300003
loss_pred:0.031078636646270752, decouple_loss:0.02258269675076008
loss_pred:0.031127583235502243, decouple_loss:0.02306470461189747
Iteration: 1169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737327098846436, gen p mean: -0.5722611546516418, mean p set: 0.44785353541374207
The modified gen p mean: 0.4478708803653717, gen p mean: -0.5675720572471619, mean p set: 0.4483511745929718
The modified gen p mean: 0.4475630521774292, gen p mean: -0.5730891227722168, mean p set: 0.4480433166027069
loss_pred:0.03095582313835621, decouple_loss:0.021813932806253433
loss_pred:0.030915778130292892, decouple_loss:0.022465119138360023
loss_pred:0.03066577948629856, decouple_loss:0.022471316158771515
Iteration: 1170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771137833595276, gen p mean: -0.5672960877418518, mean p set: 0.44819164276123047
The modified gen p mean: 0.4475401043891907, gen p mean: -0.5676804780960083, mean p set: 0.44802039861679077
The modified gen p mean: 0.44683799147605896, gen p mean: -0.5693287253379822, mean p set: 0.44731831550598145
loss_pred:0.030680915340781212, decouple_loss:0.022691184654831886
loss_pred:0.03019939735531807, decouple_loss:0.022470470517873764
loss_pred:0.03171069175004959, decouple_loss:0.022632218897342682
2023-05-02 22:00:40 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.5804656744003296, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.5727219581604004, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5690386295318604, mean p set: 0.45035696029663086
loss_pred:0.03187078237533569, decouple_loss:0.02327086590230465
loss_pred:0.03094821237027645, decouple_loss:0.02273447811603546
loss_pred:0.03016119822859764, decouple_loss:0.023122204467654228
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03214552253484726, avg_mse: 0.035706527531147
current test mse: 0.035707
Iteration: 1171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44761139154434204, gen p mean: -0.5728832483291626, mean p set: 0.4480917155742645
loss_pred:0.031759001314640045, decouple_loss:0.022327100858092308
The modified gen p mean: 0.4477446675300598, gen p mean: -0.5734823942184448, mean p set: 0.4482249617576599
loss_pred:0.03068684972822666, decouple_loss:0.022985287010669708
The modified gen p mean: 0.44722220301628113, gen p mean: -0.5738593935966492, mean p set: 0.44770246744155884
loss_pred:0.030887305736541748, decouple_loss:0.022975556552410126
Iteration: 1172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483383893966675, gen p mean: -0.5729255676269531, mean p set: 0.4488186836242676
The modified gen p mean: 0.4489087760448456, gen p mean: -0.5789623856544495, mean p set: 0.4493890404701233
The modified gen p mean: 0.4478815495967865, gen p mean: -0.5782351493835449, mean p set: 0.4483618438243866
loss_pred:0.03126942738890648, decouple_loss:0.021831149235367775
loss_pred:0.031084857881069183, decouple_loss:0.021631039679050446
loss_pred:0.030584556981921196, decouple_loss:0.022651363164186478
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
NaN value num: 0
Iteration: 1173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513561427593231, gen p mean: -0.5818653106689453, mean p set: 0.4518364667892456
The modified gen p mean: 0.44930869340896606, gen p mean: -0.5921077728271484, mean p set: 0.44978898763656616
The modified gen p mean: 0.4518994688987732, gen p mean: -0.5852035880088806, mean p set: 0.4523797929286957
loss_pred:0.030611425638198853, decouple_loss:0.024389678612351418
loss_pred:0.030854670330882072, decouple_loss:0.02591388113796711
loss_pred:0.030907252803444862, decouple_loss:0.025687001645565033
Iteration: 1174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519050717353821, gen p mean: -0.5950304865837097, mean p set: 0.4523853361606598
The modified gen p mean: 0.4499926269054413, gen p mean: -0.5970327854156494, mean p set: 0.4504729211330414
The modified gen p mean: 0.45132607221603394, gen p mean: -0.5971745848655701, mean p set: 0.45180633664131165
loss_pred:0.031409937888383865, decouple_loss:0.02480764500796795
loss_pred:0.031643345952034, decouple_loss:0.024797644466161728
loss_pred:0.03242173418402672, decouple_loss:0.02445160783827305
Iteration: 1175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493047595024109, gen p mean: -0.5822013020515442, mean p set: 0.449785053730011
The modified gen p mean: 0.45046737790107727, gen p mean: -0.5786768794059753, mean p set: 0.45094767212867737
The modified gen p mean: 0.44880664348602295, gen p mean: -0.574802577495575, mean p set: 0.44928696751594543
loss_pred:0.031488947570323944, decouple_loss:0.0238823089748621
loss_pred:0.03404606506228447, decouple_loss:0.026784978806972504
loss_pred:0.02979738637804985, decouple_loss:0.02422584965825081
Iteration: 1176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856712222099304, gen p mean: -0.5700861215591431, mean p set: 0.44904741644859314
The modified gen p mean: 0.45013299584388733, gen p mean: -0.5717238187789917, mean p set: 0.4506132900714874
The modified gen p mean: 0.45012643933296204, gen p mean: -0.574857234954834, mean p set: 0.45060670375823975
loss_pred:0.0334022119641304, decouple_loss:0.02455795183777809
loss_pred:0.03216024860739708, decouple_loss:0.023634618148207664
loss_pred:0.03159696236252785, decouple_loss:0.02372782863676548
Iteration: 1177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497565031051636, gen p mean: -0.5809516906738281, mean p set: 0.45023679733276367
The modified gen p mean: 0.45169180631637573, gen p mean: -0.5823670625686646, mean p set: 0.45217210054397583
The modified gen p mean: 0.45001593232154846, gen p mean: -0.579453706741333, mean p set: 0.45049622654914856
loss_pred:0.031185947358608246, decouple_loss:0.023340746760368347
loss_pred:0.031018156558275223, decouple_loss:0.024187304079532623
loss_pred:0.03201217204332352, decouple_loss:0.02321060560643673
Iteration: 1178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510287046432495, gen p mean: -0.589443564414978, mean p set: 0.4515089690685272
The modified gen p mean: 0.4512999951839447, gen p mean: -0.5881509184837341, mean p set: 0.4517803192138672
The modified gen p mean: 0.4502875506877899, gen p mean: -0.5829915404319763, mean p set: 0.4507678747177124
loss_pred:0.031155917793512344, decouple_loss:0.02299460954964161
loss_pred:0.03249746188521385, decouple_loss:0.023694520816206932
loss_pred:0.03012654185295105, decouple_loss:0.023700544610619545
Iteration: 1179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449628621339798, gen p mean: -0.5873557925224304, mean p set: 0.45010891556739807
The modified gen p mean: 0.44915157556533813, gen p mean: -0.5886824131011963, mean p set: 0.44963186979293823
The modified gen p mean: 0.45014598965644836, gen p mean: -0.5756452083587646, mean p set: 0.4506262540817261
loss_pred:0.03096970170736313, decouple_loss:0.023853188380599022
loss_pred:0.03302251547574997, decouple_loss:0.024198219180107117
loss_pred:0.029317116364836693, decouple_loss:0.02419612742960453
Iteration: 1180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495391845703125, gen p mean: -0.5810408592224121, mean p set: 0.4500194787979126
The modified gen p mean: 0.4499218165874481, gen p mean: -0.580672562122345, mean p set: 0.4504021108150482
The modified gen p mean: 0.44841817021369934, gen p mean: -0.5827023983001709, mean p set: 0.44889846444129944
loss_pred:0.0327497199177742, decouple_loss:0.02275094948709011loss_pred:0.03065827302634716, decouple_loss:0.022974560037255287
loss_pred:0.03290936350822449, decouple_loss:0.023400312289595604
2023-05-02 22:05:16 testing...
The modified gen p mean: 0.4495830237865448, gen p mean: -0.5795320272445679, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.5869969129562378, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5746977925300598, mean p set: 0.45035696029663086
loss_pred:0.03117888793349266, decouple_loss:0.02587769739329815
loss_pred:0.03212675452232361, decouple_loss:0.02619621530175209
loss_pred:0.03050747513771057, decouple_loss:0.02576529048383236
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03256836161017418, avg_mse: 0.036239564418792725
current test mse: 0.03624
Iteration: 1181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499150216579437, gen p mean: -0.5912433862686157, mean p set: 0.4503953158855438
The modified gen p mean: 0.4512999653816223, gen p mean: -0.5898305177688599, mean p set: 0.4517802298069
loss_pred:0.031169064342975616, decouple_loss:0.023487605154514313
loss_pred:0.030470987781882286, decouple_loss:0.024634147062897682
The modified gen p mean: 0.451698362827301, gen p mean: -0.5787487030029297, mean p set: 0.4521786570549011
loss_pred:0.02896100841462612, decouple_loss:0.025036662817001343
Iteration: 1182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523484706878662, gen p mean: -0.578486979007721, mean p set: 0.4528287649154663
The modified gen p mean: 0.4504013657569885, gen p mean: -0.5661857724189758, mean p set: 0.4508816599845886
The modified gen p mean: 0.4498480260372162, gen p mean: -0.5692764520645142, mean p set: 0.4503283202648163
loss_pred:0.030296696349978447, decouple_loss:0.023463111370801926
loss_pred:0.029310984537005424, decouple_loss:0.025760270655155182
loss_pred:0.02997891791164875, decouple_loss:0.025351542979478836
Iteration: 1183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515685737133026, gen p mean: -0.5767853260040283, mean p set: 0.4520488977432251
The modified gen p mean: 0.44958290457725525, gen p mean: -0.5819976925849915, mean p set: 0.45006316900253296
The modified gen p mean: 0.4519163966178894, gen p mean: -0.5746006369590759, mean p set: 0.4523966908454895
loss_pred:0.030097994953393936, decouple_loss:0.023521415889263153
loss_pred:0.03100431151688099, decouple_loss:0.022666795179247856
loss_pred:0.02993718534708023, decouple_loss:0.023509839549660683
Iteration: 1184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501568078994751, gen p mean: -0.5922175645828247, mean p set: 0.4506370425224304
The modified gen p mean: 0.4489753246307373, gen p mean: -0.5859134793281555, mean p set: 0.4494556486606598
The modified gen p mean: 0.4514380991458893, gen p mean: -0.5819209814071655, mean p set: 0.4519183933734894
loss_pred:0.033301517367362976, decouple_loss:0.02367337793111801
loss_pred:0.03054947964847088, decouple_loss:0.023697393015027046
loss_pred:0.029227085411548615, decouple_loss:0.02250276692211628
Iteration: 1185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519311189651489, gen p mean: -0.6036133766174316, mean p set: 0.452411413192749
The modified gen p mean: 0.4512156546115875, gen p mean: -0.586945116519928, mean p set: 0.4516959488391876
The modified gen p mean: 0.44884514808654785, gen p mean: -0.5997778177261353, mean p set: 0.44932547211647034
loss_pred:0.0312979593873024, decouple_loss:0.023695724084973335
loss_pred:0.030237309634685516, decouple_loss:0.0228961743414402
loss_pred:0.03131486475467682, decouple_loss:0.023148244246840477
Iteration: 1186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487839937210083, gen p mean: -0.600223183631897, mean p set: 0.4492642879486084
The modified gen p mean: 0.44988998770713806, gen p mean: -0.6011117100715637, mean p set: 0.45037025213241577
The modified gen p mean: 0.4510978162288666, gen p mean: -0.5901603698730469, mean p set: 0.4515781104564667
loss_pred:0.030692551285028458, decouple_loss:0.02364184521138668
loss_pred:0.03139317035675049, decouple_loss:0.024390531703829765
loss_pred:0.02912336029112339, decouple_loss:0.02397698536515236
Iteration: 1187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44933953881263733, gen p mean: -0.6045318245887756, mean p set: 0.4498198330402374
The modified gen p mean: 0.4504057765007019, gen p mean: -0.595868706703186, mean p set: 0.4508860111236572
The modified gen p mean: 0.4504311978816986, gen p mean: -0.5878927111625671, mean p set: 0.4509114921092987
loss_pred:0.031012052670121193, decouple_loss:0.02273542247712612
loss_pred:0.03071756288409233, decouple_loss:0.02353517897427082
loss_pred:0.029390091076493263, decouple_loss:0.022541314363479614
Iteration: 1188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513068199157715, gen p mean: -0.5946784019470215, mean p set: 0.4517871141433716
The modified gen p mean: 0.4502316117286682, gen p mean: -0.5922494530677795, mean p set: 0.4507118761539459
The modified gen p mean: 0.4523080885410309, gen p mean: -0.5936829447746277, mean p set: 0.452788382768631
loss_pred:0.03053327649831772, decouple_loss:0.022596940398216248
loss_pred:0.030794648453593254, decouple_loss:0.02299468033015728
loss_pred:0.030755579471588135, decouple_loss:0.023187655955553055
Iteration: 1189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500828683376312, gen p mean: -0.5785133242607117, mean p set: 0.4505631625652313
The modified gen p mean: 0.4511455297470093, gen p mean: -0.5816969871520996, mean p set: 0.451625794172287
The modified gen p mean: 0.4505697786808014, gen p mean: -0.586519718170166, mean p set: 0.4510500431060791
loss_pred:0.02949347160756588, decouple_loss:0.022427862510085106
loss_pred:0.02913639135658741, decouple_loss:0.022678755223751068
loss_pred:0.031089741736650467, decouple_loss:0.022840647026896477
Iteration: 1190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513264298439026, gen p mean: -0.5746735334396362, mean p set: 0.4518067240715027
The modified gen p mean: 0.4501520097255707, gen p mean: -0.5829921364784241, mean p set: 0.4506323039531708
The modified gen p mean: 0.45228272676467896, gen p mean: -0.5851697325706482, mean p set: 0.45276302099227905
loss_pred:0.02851133421063423, decouple_loss:0.02307654358446598
loss_pred:0.031053327023983, decouple_loss:0.022536952048540115
loss_pred:0.03130496293306351, decouple_loss:0.022733207792043686
2023-05-02 22:09:01 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5803560018539429, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.5882148146629333, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.576156497001648, mean p set: 0.45035696029663086
loss_pred:0.03113594837486744, decouple_loss:0.02498561702668667
loss_pred:0.032234203070402145, decouple_loss:0.02558431215584278
loss_pred:0.030487900599837303, decouple_loss:0.025119900703430176
WV_0_PC_1_EH_0_PS_40_6, loss: 0.032547514885663986, avg_mse: 0.03640153631567955
current test mse: 0.036402
Iteration: 1191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44896626472473145, gen p mean: -0.5823220014572144, mean p set: 0.44944655895233154
loss_pred:0.029954152181744576, decouple_loss:0.02247723378241062
The modified gen p mean: 0.450753778219223, gen p mean: -0.5876356959342957, mean p set: 0.4512340724468231
loss_pred:0.03170474246144295, decouple_loss:0.023497749119997025
The modified gen p mean: 0.45094335079193115, gen p mean: -0.5876977443695068, mean p set: 0.45142364501953125
loss_pred:0.030687913298606873, decouple_loss:0.023425297811627388
Iteration: 1192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44989413022994995, gen p mean: -0.5895700454711914, mean p set: 0.45037439465522766
The modified gen p mean: 0.4497143626213074, gen p mean: -0.5855843424797058, mean p set: 0.4501945972442627
The modified gen p mean: 0.45160409808158875, gen p mean: -0.5932781100273132, mean p set: 0.45208439230918884
loss_pred:0.030294496566057205, decouple_loss:0.02277006208896637
loss_pred:0.0314907468855381, decouple_loss:0.022156579419970512
loss_pred:0.0303350742906332, decouple_loss:0.02356991544365883
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 1193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498880207538605, gen p mean: -0.5852225422859192, mean p set: 0.45036831498146057
The modified gen p mean: 0.44958531856536865, gen p mean: -0.5807629823684692, mean p set: 0.45006564259529114
The modified gen p mean: 0.4498020112514496, gen p mean: -0.5907180905342102, mean p set: 0.4502823054790497
loss_pred:0.031480420380830765, decouple_loss:0.026354296132922173
loss_pred:0.031123226508498192, decouple_loss:0.02552916668355465
loss_pred:0.03089008294045925, decouple_loss:0.025510599836707115
Iteration: 1194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502818286418915, gen p mean: -0.5842085480690002, mean p set: 0.4507621228694916
The modified gen p mean: 0.4493504762649536, gen p mean: -0.5891218781471252, mean p set: 0.4498307406902313
The modified gen p mean: 0.450380802154541, gen p mean: -0.5900301933288574, mean p set: 0.4508611261844635
loss_pred:0.03234732151031494, decouple_loss:0.024936659261584282
loss_pred:0.03056812658905983, decouple_loss:0.02502712979912758
loss_pred:0.03236144036054611, decouple_loss:0.02488919161260128
Iteration: 1195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019662380218506, gen p mean: -0.5890976190567017, mean p set: 0.45067691802978516
The modified gen p mean: 0.44821521639823914, gen p mean: -0.6007891893386841, mean p set: 0.4486955404281616
The modified gen p mean: 0.4501695930957794, gen p mean: -0.6001547574996948, mean p set: 0.4506498873233795
loss_pred:0.031684424728155136, decouple_loss:0.024493474513292313
loss_pred:0.03201070800423622, decouple_loss:0.0236191563308239
loss_pred:0.03193795308470726, decouple_loss:0.024266505613923073
Iteration: 1196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499345123767853, gen p mean: -0.5982913374900818, mean p set: 0.4504148066043854
The modified gen p mean: 0.450135201215744, gen p mean: -0.6062844395637512, mean p set: 0.4506154954433441
The modified gen p mean: 0.449557900428772, gen p mean: -0.5997095108032227, mean p set: 0.4500381648540497
loss_pred:0.031655579805374146, decouple_loss:0.023335197940468788
loss_pred:0.03159583732485771, decouple_loss:0.023172201588749886
loss_pred:0.030764389783143997, decouple_loss:0.02326630987226963
Iteration: 1197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44966641068458557, gen p mean: -0.5986996293067932, mean p set: 0.45014673471450806
The modified gen p mean: 0.4493340849876404, gen p mean: -0.5887593030929565, mean p set: 0.4498143792152405
The modified gen p mean: 0.44940632581710815, gen p mean: -0.596612811088562, mean p set: 0.44988662004470825
loss_pred:0.030829312279820442, decouple_loss:0.023056453093886375
loss_pred:0.03159660845994949, decouple_loss:0.023587267845869064
loss_pred:0.030381442978978157, decouple_loss:0.023396950215101242
Iteration: 1198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449324369430542, gen p mean: -0.5862705111503601, mean p set: 0.4498046338558197
The modified gen p mean: 0.44896915555000305, gen p mean: -0.5783124566078186, mean p set: 0.44944941997528076
The modified gen p mean: 0.44990208745002747, gen p mean: -0.5745159387588501, mean p set: 0.45038241147994995
loss_pred:0.0313149020075798, decouple_loss:0.02408806048333645
loss_pred:0.030842503532767296, decouple_loss:0.023017216473817825
loss_pred:0.03145362809300423, decouple_loss:0.023651521652936935
Iteration: 1199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491356611251831, gen p mean: -0.5714309811592102, mean p set: 0.4496159553527832
The modified gen p mean: 0.4501456022262573, gen p mean: -0.5782026648521423, mean p set: 0.45062586665153503
The modified gen p mean: 0.4497753381729126, gen p mean: -0.5808203220367432, mean p set: 0.4502556622028351
loss_pred:0.031525999307632446, decouple_loss:0.023096663877367973
loss_pred:0.030841412022709846, decouple_loss:0.023498788475990295
loss_pred:0.031834814697504044, decouple_loss:0.023765554651618004
Iteration: 1200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45025718212127686, gen p mean: -0.5970644950866699, mean p set: 0.45073747634887695
The modified gen p mean: 0.4487245976924896, gen p mean: -0.5846331119537354, mean p set: 0.4492048919200897
The modified gen p mean: 0.4496549367904663, gen p mean: -0.5859397053718567, mean p set: 0.450135201215744
loss_pred:0.032000429928302765, decouple_loss:0.024808958172798157
loss_pred:0.030620399862527847, decouple_loss:0.02346361242234707
loss_pred:0.03127586469054222, decouple_loss:0.02342800982296467
2023-05-02 22:13:23 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.5808931589126587, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.5890311002731323, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5767291784286499, mean p set: 0.45035696029663086
loss_pred:0.03067299909889698, decouple_loss:0.02307894080877304
loss_pred:0.03158356621861458, decouple_loss:0.023604219779372215
loss_pred:0.030055806040763855, decouple_loss:0.02360529638826847
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03194226324558258, avg_mse: 0.03553352877497673
current test mse: 0.035534
Iteration: 1201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487124979496002, gen p mean: -0.5857135057449341, mean p set: 0.4491928219795227
loss_pred:0.030347589403390884, decouple_loss:0.022305021062493324
The modified gen p mean: 0.4505953788757324, gen p mean: -0.5868610739707947, mean p set: 0.4510757029056549
loss_pred:0.03195677325129509, decouple_loss:0.023898880928754807
The modified gen p mean: 0.44947320222854614, gen p mean: -0.5803573727607727, mean p set: 0.44995349645614624
loss_pred:0.0311360415071249, decouple_loss:0.022731930017471313
Iteration: 1202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45044729113578796, gen p mean: -0.5735369324684143, mean p set: 0.45092761516571045
The modified gen p mean: 0.4491085708141327, gen p mean: -0.5682031512260437, mean p set: 0.4495888352394104
The modified gen p mean: 0.4506218135356903, gen p mean: -0.573853075504303, mean p set: 0.451102077960968
loss_pred:0.03140585869550705, decouple_loss:0.02343393862247467
loss_pred:0.031049245968461037, decouple_loss:0.02323974296450615
loss_pred:0.03063623234629631, decouple_loss:0.02366100810468197
Iteration: 1203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497264325618744, gen p mean: -0.5782352089881897, mean p set: 0.4502067267894745
The modified gen p mean: 0.449353963136673, gen p mean: -0.5737190246582031, mean p set: 0.4498342275619507
The modified gen p mean: 0.45123490691185, gen p mean: -0.5794368982315063, mean p set: 0.4517151713371277
loss_pred:0.030760599300265312, decouple_loss:0.02260611765086651
loss_pred:0.030731018632650375, decouple_loss:0.021693482995033264
loss_pred:0.031206250190734863, decouple_loss:0.022661060094833374
Iteration: 1204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44861218333244324, gen p mean: -0.5870752930641174, mean p set: 0.4490925073623657
The modified gen p mean: 0.4493504762649536, gen p mean: -0.5780370235443115, mean p set: 0.4498307704925537
The modified gen p mean: 0.4496612548828125, gen p mean: -0.5935185551643372, mean p set: 0.4501415491104126
loss_pred:0.031649425625801086, decouple_loss:0.022470595315098763
loss_pred:0.031339820474386215, decouple_loss:0.023199083283543587
loss_pred:0.03111039102077484, decouple_loss:0.02267220988869667
Iteration: 1205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904807209968567, gen p mean: -0.5847508907318115, mean p set: 0.44952836632728577
The modified gen p mean: 0.4504680633544922, gen p mean: -0.5882285237312317, mean p set: 0.4509483277797699
The modified gen p mean: 0.4492187201976776, gen p mean: -0.5809828042984009, mean p set: 0.4496990144252777
loss_pred:0.0302492193877697, decouple_loss:0.02244756929576397
loss_pred:0.03303006663918495, decouple_loss:0.02225162461400032
loss_pred:0.032102856785058975, decouple_loss:0.023280693218111992
Iteration: 1206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969967007637024, gen p mean: -0.5834435820579529, mean p set: 0.45017993450164795
The modified gen p mean: 0.4489012062549591, gen p mean: -0.5730308890342712, mean p set: 0.4493815302848816
The modified gen p mean: 0.45015162229537964, gen p mean: -0.5773177742958069, mean p set: 0.4506319463253021
loss_pred:0.030709145590662956, decouple_loss:0.022057505324482918
loss_pred:0.03104264661669731, decouple_loss:0.022938214242458344
loss_pred:0.031429558992385864, decouple_loss:0.021311338990926743
Iteration: 1207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507772922515869, gen p mean: -0.5743200778961182, mean p set: 0.4512575566768646
The modified gen p mean: 0.45068731904029846, gen p mean: -0.5774230360984802, mean p set: 0.45116761326789856
The modified gen p mean: 0.4498622715473175, gen p mean: -0.5755494832992554, mean p set: 0.4503425657749176
loss_pred:0.030527226626873016, decouple_loss:0.021671302616596222
loss_pred:0.03214578703045845, decouple_loss:0.021477367728948593
loss_pred:0.03063507005572319, decouple_loss:0.0219821035861969
Iteration: 1208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44868531823158264, gen p mean: -0.5779910087585449, mean p set: 0.4491656422615051
The modified gen p mean: 0.4507172703742981, gen p mean: -0.5796749591827393, mean p set: 0.4511975646018982
The modified gen p mean: 0.449248343706131, gen p mean: -0.5708194971084595, mean p set: 0.44972866773605347
loss_pred:0.031355924904346466, decouple_loss:0.021603796631097794
loss_pred:0.030897891148924828, decouple_loss:0.021841825917363167
loss_pred:0.031007958576083183, decouple_loss:0.02204691618680954
Iteration: 1209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505215585231781, gen p mean: -0.5793365836143494, mean p set: 0.4510018229484558
The modified gen p mean: 0.4503428041934967, gen p mean: -0.5819694399833679, mean p set: 0.4508230984210968
The modified gen p mean: 0.4487113654613495, gen p mean: -0.5809355974197388, mean p set: 0.4491916298866272
loss_pred:0.03284712880849838, decouple_loss:0.021501177921891212
loss_pred:0.031192034482955933, decouple_loss:0.021907633170485497
loss_pred:0.03057827427983284, decouple_loss:0.02153206244111061
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481290280818939, gen p mean: -0.5775986909866333, mean p set: 0.448609322309494
The modified gen p mean: 0.4507904052734375, gen p mean: -0.5759642720222473, mean p set: 0.45127072930336
The modified gen p mean: 0.4508281648159027, gen p mean: -0.5770624876022339, mean p set: 0.4513084292411804
loss_pred:0.031370509415864944, decouple_loss:0.02057310938835144
loss_pred:0.03163308650255203, decouple_loss:0.02127038687467575
loss_pred:0.0316585972905159, decouple_loss:0.021292168647050858
2023-05-02 22:17:07 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.5779614448547363, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5704151391983032, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5665454268455505, mean p set: 0.45035696029663086
loss_pred:0.03147256001830101, decouple_loss:0.02227136492729187
loss_pred:0.030666308477520943, decouple_loss:0.022327963262796402
loss_pred:0.030137984082102776, decouple_loss:0.023240666836500168
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03188961744308472, avg_mse: 0.03544188290834427
current test mse: 0.035442
Iteration: 1211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502379894256592, gen p mean: -0.5716062784194946, mean p set: 0.4507182538509369
loss_pred:0.0311269611120224, decouple_loss:0.02232307754456997
The modified gen p mean: 0.44925618171691895, gen p mean: -0.5680414438247681, mean p set: 0.44973650574684143
loss_pred:0.0313279926776886, decouple_loss:0.02164459228515625
The modified gen p mean: 0.4501035213470459, gen p mean: -0.5821647644042969, mean p set: 0.450583815574646
loss_pred:0.03118891641497612, decouple_loss:0.021485859528183937
Iteration: 1212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010730624198914, gen p mean: -0.5816665887832642, mean p set: 0.45058757066726685
The modified gen p mean: 0.4494032561779022, gen p mean: -0.579998791217804, mean p set: 0.44988352060317993
The modified gen p mean: 0.4494396448135376, gen p mean: -0.5783810019493103, mean p set: 0.4499199688434601
loss_pred:0.030552027747035027, decouple_loss:0.021583864465355873
loss_pred:0.030090101063251495, decouple_loss:0.021222293376922607
loss_pred:0.030509280040860176, decouple_loss:0.02153048850595951
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
NaN value num: 0
Iteration: 1213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45106908679008484, gen p mean: -0.5939345955848694, mean p set: 0.45154935121536255
The modified gen p mean: 0.44987475872039795, gen p mean: -0.5903661847114563, mean p set: 0.45035505294799805
The modified gen p mean: 0.45143359899520874, gen p mean: -0.588302493095398, mean p set: 0.45191389322280884
loss_pred:0.03158599138259888, decouple_loss:0.02667577564716339
loss_pred:0.03110378235578537, decouple_loss:0.025694940239191055
loss_pred:0.03195017948746681, decouple_loss:0.025990299880504608
Iteration: 1214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501219093799591, gen p mean: -0.5925019979476929, mean p set: 0.45060214400291443
The modified gen p mean: 0.4475768506526947, gen p mean: -0.5838332772254944, mean p set: 0.4480571150779724
The modified gen p mean: 0.44977468252182007, gen p mean: -0.5886905789375305, mean p set: 0.45025497674942017
loss_pred:0.031627360731363297, decouple_loss:0.02483200468122959
loss_pred:0.03117494471371174, decouple_loss:0.02440042234957218
loss_pred:0.0317775160074234, decouple_loss:0.0242847241461277
Iteration: 1215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493718445301056, gen p mean: -0.5861930847167969, mean p set: 0.4498521387577057
The modified gen p mean: 0.4509749114513397, gen p mean: -0.5873072743415833, mean p set: 0.4514552056789398
The modified gen p mean: 0.45021581649780273, gen p mean: -0.5991926193237305, mean p set: 0.45069611072540283
loss_pred:0.032410360872745514, decouple_loss:0.02505485899746418
loss_pred:0.03150308504700661, decouple_loss:0.023546813055872917
loss_pred:0.030549366027116776, decouple_loss:0.02474660612642765
Iteration: 1216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45071253180503845, gen p mean: -0.5911200046539307, mean p set: 0.45119279623031616
The modified gen p mean: 0.44862791895866394, gen p mean: -0.5834341645240784, mean p set: 0.44910821318626404
The modified gen p mean: 0.4502987563610077, gen p mean: -0.5861830115318298, mean p set: 0.4507790505886078
loss_pred:0.030728405341506004, decouple_loss:0.024321893230080605
loss_pred:0.03191409260034561, decouple_loss:0.023854795843362808
loss_pred:0.031876083463430405, decouple_loss:0.02420939691364765
Iteration: 1217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507966935634613, gen p mean: -0.5951486825942993, mean p set: 0.4512770175933838
The modified gen p mean: 0.4509217143058777, gen p mean: -0.5965235233306885, mean p set: 0.4514020085334778
The modified gen p mean: 0.4490281641483307, gen p mean: -0.5863398313522339, mean p set: 0.4495084881782532
loss_pred:0.031056484207510948, decouple_loss:0.02340618707239628
loss_pred:0.03127555549144745, decouple_loss:0.023532235994935036
loss_pred:0.031145745888352394, decouple_loss:0.023859655484557152
Iteration: 1218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506642520427704, gen p mean: -0.594616711139679, mean p set: 0.4511445164680481
The modified gen p mean: 0.4486290216445923, gen p mean: -0.5862122774124146, mean p set: 0.4491093158721924
The modified gen p mean: 0.4498560428619385, gen p mean: -0.5929726958274841, mean p set: 0.4503363370895386
loss_pred:0.03166433423757553, decouple_loss:0.023216567933559418
loss_pred:0.0319296196103096, decouple_loss:0.022903459146618843
loss_pred:0.031735919415950775, decouple_loss:0.022884909063577652
Iteration: 1219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491064250469208, gen p mean: -0.5861514210700989, mean p set: 0.44958674907684326
The modified gen p mean: 0.45036381483078003, gen p mean: -0.5830919146537781, mean p set: 0.45084407925605774
The modified gen p mean: 0.45061028003692627, gen p mean: -0.590432345867157, mean p set: 0.451090544462204
loss_pred:0.03152419999241829, decouple_loss:0.022806573659181595
loss_pred:0.031782764941453934, decouple_loss:0.023978376761078835
loss_pred:0.02985203079879284, decouple_loss:0.024829845875501633
Iteration: 1220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502499997615814, gen p mean: -0.5858551859855652, mean p set: 0.4507302939891815
The modified gen p mean: 0.45018118619918823, gen p mean: -0.5868889093399048, mean p set: 0.45066148042678833
The modified gen p mean: 0.4491533041000366, gen p mean: -0.5772380828857422, mean p set: 0.4496335983276367
loss_pred:0.031165199354290962, decouple_loss:0.024335062131285667
loss_pred:0.03040006197988987, decouple_loss:0.024269113317131996
loss_pred:0.030035221949219704, decouple_loss:0.02317541092634201
2023-05-02 22:21:24 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.5793231129646301, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.5868678092956543, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5752495527267456, mean p set: 0.45035696029663086
loss_pred:0.030625073239207268, decouple_loss:0.02539103664457798
loss_pred:0.031630389392375946, decouple_loss:0.026146914809942245
loss_pred:0.030134325847029686, decouple_loss:0.025547737255692482
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03208135813474655, avg_mse: 0.035712357610464096
current test mse: 0.035712
Iteration: 1221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506271183490753, gen p mean: -0.5868353843688965, mean p set: 0.451107382774353
loss_pred:0.029700087383389473, decouple_loss:0.022821642458438873
The modified gen p mean: 0.44914960861206055, gen p mean: -0.5813645124435425, mean p set: 0.44962990283966064
loss_pred:0.032363444566726685, decouple_loss:0.02365965209901333
The modified gen p mean: 0.45121094584465027, gen p mean: -0.5809168815612793, mean p set: 0.451691210269928
loss_pred:0.03067997470498085, decouple_loss:0.023379724472761154
Iteration: 1222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488906264305115, gen p mean: -0.5850088000297546, mean p set: 0.4493708908557892
The modified gen p mean: 0.44876593351364136, gen p mean: -0.5865235328674316, mean p set: 0.44924622774124146
The modified gen p mean: 0.4498402774333954, gen p mean: -0.5898268818855286, mean p set: 0.4503205716609955
loss_pred:0.0320732519030571, decouple_loss:0.021961189806461334
loss_pred:0.03082028217613697, decouple_loss:0.0227064061909914
loss_pred:0.031016357243061066, decouple_loss:0.02375936321914196
Iteration: 1223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44932565093040466, gen p mean: -0.5888381004333496, mean p set: 0.4498059153556824
The modified gen p mean: 0.45092812180519104, gen p mean: -0.5989798307418823, mean p set: 0.45140841603279114
The modified gen p mean: 0.45052289962768555, gen p mean: -0.5905023217201233, mean p set: 0.45100319385528564
loss_pred:0.0319620706140995, decouple_loss:0.02293355017900467
loss_pred:0.031242620199918747, decouple_loss:0.022963766008615494
loss_pred:0.03039395436644554, decouple_loss:0.023617642000317574
Iteration: 1224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45089563727378845, gen p mean: -0.6026631593704224, mean p set: 0.45137593150138855
The modified gen p mean: 0.44924396276474, gen p mean: -0.5941996574401855, mean p set: 0.4497242569923401
The modified gen p mean: 0.4507297873497009, gen p mean: -0.5984896421432495, mean p set: 0.451210081577301
loss_pred:0.03140586242079735, decouple_loss:0.02327117510139942
loss_pred:0.03181464225053787, decouple_loss:0.02214895747601986
loss_pred:0.030876725912094116, decouple_loss:0.022631218656897545
Iteration: 1225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486198127269745, gen p mean: -0.6007543802261353, mean p set: 0.4491001069545746
The modified gen p mean: 0.4498160481452942, gen p mean: -0.5892291069030762, mean p set: 0.4502963423728943
The modified gen p mean: 0.4504499137401581, gen p mean: -0.6044329404830933, mean p set: 0.4509302079677582
loss_pred:0.03046501986682415, decouple_loss:0.022475218400359154
loss_pred:0.029863575473427773, decouple_loss:0.02217918448150158
loss_pred:0.030304767191410065, decouple_loss:0.023350663483142853
Iteration: 1226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44930556416511536, gen p mean: -0.5928857326507568, mean p set: 0.44978588819503784
The modified gen p mean: 0.4497682750225067, gen p mean: -0.5856199264526367, mean p set: 0.4502485692501068
The modified gen p mean: 0.45012757182121277, gen p mean: -0.5947074890136719, mean p set: 0.45060789585113525
loss_pred:0.031950805336236954, decouple_loss:0.021737447008490562
loss_pred:0.03125564381480217, decouple_loss:0.022466182708740234
loss_pred:0.031059671193361282, decouple_loss:0.023050345480442047
Iteration: 1227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497581124305725, gen p mean: -0.5950717329978943, mean p set: 0.450238436460495
The modified gen p mean: 0.45086777210235596, gen p mean: -0.5966753959655762, mean p set: 0.45134806632995605
The modified gen p mean: 0.44861990213394165, gen p mean: -0.59946608543396, mean p set: 0.44910016655921936
loss_pred:0.030157847329974174, decouple_loss:0.022968338802456856loss_pred:0.031315505504608154, decouple_loss:0.023029154166579247
loss_pred:0.030814016237854958, decouple_loss:0.022620314732193947
Iteration: 1228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019635558128357, gen p mean: -0.6170293092727661, mean p set: 0.4506766200065613
The modified gen p mean: 0.4508362114429474, gen p mean: -0.5977975726127625, mean p set: 0.4513164758682251
The modified gen p mean: 0.4474261403083801, gen p mean: -0.6048133969306946, mean p set: 0.4479064345359802
loss_pred:0.03069894015789032, decouple_loss:0.021737027913331985loss_pred:0.03074321150779724, decouple_loss:0.022988254204392433
loss_pred:0.03059922531247139, decouple_loss:0.022746747359633446
Iteration: 1229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498802423477173, gen p mean: -0.608060896396637, mean p set: 0.4503605365753174
The modified gen p mean: 0.4492305815219879, gen p mean: -0.6017407774925232, mean p set: 0.449710875749588
The modified gen p mean: 0.4487893283367157, gen p mean: -0.6088249087333679, mean p set: 0.4492696523666382
loss_pred:0.030334332957863808, decouple_loss:0.02198280394077301
loss_pred:0.031378623098134995, decouple_loss:0.021810831502079964
loss_pred:0.030585171654820442, decouple_loss:0.022840501740574837
Iteration: 1230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503313899040222, gen p mean: -0.6031284332275391, mean p set: 0.4508116841316223
The modified gen p mean: 0.45046326518058777, gen p mean: -0.6108613610267639, mean p set: 0.4509435296058655
The modified gen p mean: 0.4502270221710205, gen p mean: -0.6142951250076294, mean p set: 0.4507073163986206
loss_pred:0.03121848776936531, decouple_loss:0.022970987483859062
loss_pred:0.030892806127667427, decouple_loss:0.022335903719067574
loss_pred:0.031056217849254608, decouple_loss:0.022377656772732735
2023-05-02 22:25:04 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.5927742123603821, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6003063321113586, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5884642004966736, mean p set: 0.45035696029663086
loss_pred:0.03048786148428917, decouple_loss:0.02439381554722786
loss_pred:0.031585488468408585, decouple_loss:0.025143379345536232
loss_pred:0.03002525120973587, decouple_loss:0.02418540045619011
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03192824870347977, avg_mse: 0.03563455864787102
current test mse: 0.035635
Iteration: 1231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45072245597839355, gen p mean: -0.6050747036933899, mean p set: 0.45120275020599365
loss_pred:0.029755430296063423, decouple_loss:0.02293267473578453
The modified gen p mean: 0.4508408308029175, gen p mean: -0.6004629135131836, mean p set: 0.4513210952281952
loss_pred:0.029782583937048912, decouple_loss:0.022781699895858765
The modified gen p mean: 0.45033878087997437, gen p mean: -0.5988082885742188, mean p set: 0.45081907510757446
loss_pred:0.030504992231726646, decouple_loss:0.022043481469154358
Iteration: 1232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45064085721969604, gen p mean: -0.5949611663818359, mean p set: 0.45112112164497375
The modified gen p mean: 0.45054301619529724, gen p mean: -0.590899646282196, mean p set: 0.4510233402252197
The modified gen p mean: 0.4503541588783264, gen p mean: -0.5899427533149719, mean p set: 0.4508344829082489
loss_pred:0.02982938289642334, decouple_loss:0.022708041593432426
loss_pred:0.03076920099556446, decouple_loss:0.0213305801153183
loss_pred:0.030175745487213135, decouple_loss:0.0220912154763937
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
NaN value num: 0
Iteration: 1233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515188932418823, gen p mean: -0.5901113152503967, mean p set: 0.4519991874694824
The modified gen p mean: 0.45355042815208435, gen p mean: -0.5971564650535583, mean p set: 0.45403069257736206
The modified gen p mean: 0.45119166374206543, gen p mean: -0.5847273468971252, mean p set: 0.45167189836502075
loss_pred:0.029733749106526375, decouple_loss:0.02453295700252056
loss_pred:0.030855031684041023, decouple_loss:0.023564832285046577
loss_pred:0.029504356905817986, decouple_loss:0.024837374687194824
Iteration: 1234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45139172673225403, gen p mean: -0.6070929169654846, mean p set: 0.4518720209598541
The modified gen p mean: 0.45387494564056396, gen p mean: -0.6026822924613953, mean p set: 0.45435523986816406
The modified gen p mean: 0.45235347747802734, gen p mean: -0.6059188842773438, mean p set: 0.45283377170562744
loss_pred:0.031354598701000214, decouple_loss:0.024434108287096024
loss_pred:0.030606374144554138, decouple_loss:0.02430015429854393
loss_pred:0.030478669330477715, decouple_loss:0.02405858039855957
Iteration: 1235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516083300113678, gen p mean: -0.6154356002807617, mean p set: 0.4520886242389679
The modified gen p mean: 0.45025843381881714, gen p mean: -0.6210533380508423, mean p set: 0.45073869824409485
The modified gen p mean: 0.45354729890823364, gen p mean: -0.6105858087539673, mean p set: 0.45402759313583374
loss_pred:0.03205018490552902, decouple_loss:0.024121105670928955
loss_pred:0.029744628816843033, decouple_loss:0.022769751027226448
loss_pred:0.030476665124297142, decouple_loss:0.023383168503642082
Iteration: 1236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45391517877578735, gen p mean: -0.6125022768974304, mean p set: 0.45439544320106506
The modified gen p mean: 0.45173218846321106, gen p mean: -0.6093713045120239, mean p set: 0.45221248269081116
The modified gen p mean: 0.4510282874107361, gen p mean: -0.6093921065330505, mean p set: 0.4515085816383362
loss_pred:0.02911706641316414, decouple_loss:0.023887647315859795
loss_pred:0.029832275584340096, decouple_loss:0.023191217333078384
loss_pred:0.029845159500837326, decouple_loss:0.023665573447942734
Iteration: 1237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512805640697479, gen p mean: -0.5955269932746887, mean p set: 0.45176082849502563
The modified gen p mean: 0.45159703493118286, gen p mean: -0.5992783904075623, mean p set: 0.45207729935646057
The modified gen p mean: 0.4515922963619232, gen p mean: -0.6027634739875793, mean p set: 0.4520726501941681
loss_pred:0.029403379186987877, decouple_loss:0.02409607730805874
loss_pred:0.03037341497838497, decouple_loss:0.023264897987246513
loss_pred:0.03127405047416687, decouple_loss:0.02349221333861351
Iteration: 1238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45094460248947144, gen p mean: -0.5884135961532593, mean p set: 0.4514249265193939
The modified gen p mean: 0.45156797766685486, gen p mean: -0.5997252464294434, mean p set: 0.45204824209213257
The modified gen p mean: 0.45240339636802673, gen p mean: -0.5967645049095154, mean p set: 0.45288369059562683
loss_pred:0.030347196385264397, decouple_loss:0.023931186646223068
loss_pred:0.02949581667780876, decouple_loss:0.023346930742263794
loss_pred:0.030270254239439964, decouple_loss:0.02380429580807686
Iteration: 1239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452921062707901, gen p mean: -0.5997519493103027, mean p set: 0.4534013867378235
The modified gen p mean: 0.4516957104206085, gen p mean: -0.5929160118103027, mean p set: 0.45217597484588623
The modified gen p mean: 0.45087963342666626, gen p mean: -0.5952059626579285, mean p set: 0.45135995745658875
loss_pred:0.029080478474497795, decouple_loss:0.023543110117316246
loss_pred:0.031192732974886894, decouple_loss:0.02296423353254795
loss_pred:0.03011997975409031, decouple_loss:0.022553548216819763
Iteration: 1240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534086585044861, gen p mean: -0.5992615222930908, mean p set: 0.4538889527320862
The modified gen p mean: 0.45037102699279785, gen p mean: -0.6036573648452759, mean p set: 0.45085132122039795
The modified gen p mean: 0.4523889422416687, gen p mean: -0.6029483675956726, mean p set: 0.4528692364692688
loss_pred:0.029174547642469406, decouple_loss:0.02266629785299301
loss_pred:0.03079533576965332, decouple_loss:0.022757738828659058
loss_pred:0.030800938606262207, decouple_loss:0.021886305883526802
2023-05-02 22:29:25 testing...
The modified gen p mean: 0.4495830237865448, gen p mean: -0.585801899433136, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.5927298069000244, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5817163586616516, mean p set: 0.45035696029663086
loss_pred:0.030411195009946823, decouple_loss:0.02490130439400673
loss_pred:0.03161120414733887, decouple_loss:0.025595085695385933
loss_pred:0.029911963269114494, decouple_loss:0.025665471330285072
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03191415220499039, avg_mse: 0.03560277447104454
current test mse: 0.035603
Iteration: 1241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518401622772217, gen p mean: -0.5946422815322876, mean p set: 0.4523204565048218
The modified gen p mean: 0.4523914158344269, gen p mean: -0.5908412933349609, mean p set: 0.452871710062027
loss_pred:0.029709579423069954, decouple_loss:0.02307800203561783
loss_pred:0.030309682711958885, decouple_loss:0.021928949281573296
The modified gen p mean: 0.45415031909942627, gen p mean: -0.5919275879859924, mean p set: 0.45463061332702637
loss_pred:0.029391122981905937, decouple_loss:0.02252904698252678
Iteration: 1242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45161673426628113, gen p mean: -0.5854007601737976, mean p set: 0.45209699869155884
The modified gen p mean: 0.4525918662548065, gen p mean: -0.5923511385917664, mean p set: 0.4530721604824066
The modified gen p mean: 0.45204538106918335, gen p mean: -0.5888933539390564, mean p set: 0.45252567529678345
loss_pred:0.031915366649627686, decouple_loss:0.0227400753647089
loss_pred:0.03017411194741726, decouple_loss:0.02366875484585762
loss_pred:0.03010731376707554, decouple_loss:0.022663529962301254
Iteration: 1243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45227837562561035, gen p mean: -0.5958752632141113, mean p set: 0.45275866985321045
The modified gen p mean: 0.4531554579734802, gen p mean: -0.5905985832214355, mean p set: 0.4536357522010803
The modified gen p mean: 0.45232877135276794, gen p mean: -0.5914865136146545, mean p set: 0.45280906558036804
loss_pred:0.030116062611341476, decouple_loss:0.02240261808037758
loss_pred:0.02967013232409954, decouple_loss:0.02220935933291912
loss_pred:0.030120421200990677, decouple_loss:0.022177796810865402
Iteration: 1244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45282846689224243, gen p mean: -0.5990229845046997, mean p set: 0.45330876111984253
The modified gen p mean: 0.45244100689888, gen p mean: -0.596107006072998, mean p set: 0.4529213011264801
The modified gen p mean: 0.45355916023254395, gen p mean: -0.6036196351051331, mean p set: 0.45403948426246643
loss_pred:0.028707455843687057, decouple_loss:0.022437315434217453
loss_pred:0.03024142235517502, decouple_loss:0.023194417357444763
loss_pred:0.029163261875510216, decouple_loss:0.02211245708167553
Iteration: 1245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45137616991996765, gen p mean: -0.6001010537147522, mean p set: 0.45185646414756775
The modified gen p mean: 0.45200252532958984, gen p mean: -0.6103265285491943, mean p set: 0.45248281955718994
The modified gen p mean: 0.4517376720905304, gen p mean: -0.6046485304832458, mean p set: 0.4522179961204529
loss_pred:0.030591653659939766, decouple_loss:0.021766256541013718loss_pred:0.03031953237950802, decouple_loss:0.022048288956284523
loss_pred:0.03190916031599045, decouple_loss:0.022276556119322777
Iteration: 1246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523482918739319, gen p mean: -0.6065494418144226, mean p set: 0.4528285562992096
The modified gen p mean: 0.4513547122478485, gen p mean: -0.605823278427124, mean p set: 0.4518350064754486
The modified gen p mean: 0.451862633228302, gen p mean: -0.6069247722625732, mean p set: 0.4523428976535797
loss_pred:0.02972017042338848, decouple_loss:0.0220110435038805loss_pred:0.030598409473896027, decouple_loss:0.022411558777093887
loss_pred:0.030374078080058098, decouple_loss:0.022433094680309296
Iteration: 1247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45097583532333374, gen p mean: -0.605587899684906, mean p set: 0.45145612955093384
The modified gen p mean: 0.451071560382843, gen p mean: -0.606791079044342, mean p set: 0.4515518248081207
The modified gen p mean: 0.45155516266822815, gen p mean: -0.6041206121444702, mean p set: 0.45203545689582825
loss_pred:0.029446743428707123, decouple_loss:0.02259700372815132loss_pred:0.029741499572992325, decouple_loss:0.022255389019846916
loss_pred:0.031202781945466995, decouple_loss:0.022131573408842087
Iteration: 1248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525831937789917, gen p mean: -0.6132964491844177, mean p set: 0.4530635178089142
The modified gen p mean: 0.4513051211833954, gen p mean: -0.5999695062637329, mean p set: 0.45178544521331787
The modified gen p mean: 0.4517289102077484, gen p mean: -0.6120442748069763, mean p set: 0.4522091746330261
loss_pred:0.030558768659830093, decouple_loss:0.02133401483297348loss_pred:0.029305221512913704, decouple_loss:0.02249436266720295
loss_pred:0.0314660370349884, decouple_loss:0.022251274436712265
Iteration: 1249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516531229019165, gen p mean: -0.6029261946678162, mean p set: 0.4521334171295166
The modified gen p mean: 0.451813280582428, gen p mean: -0.61046302318573, mean p set: 0.45229360461235046
The modified gen p mean: 0.4518778920173645, gen p mean: -0.6163008213043213, mean p set: 0.4523581564426422
loss_pred:0.02871602401137352, decouple_loss:0.022008752450346947loss_pred:0.030054403468966484, decouple_loss:0.020827945321798325
loss_pred:0.029469186440110207, decouple_loss:0.022078808397054672
Iteration: 1250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525035321712494, gen p mean: -0.6071006059646606, mean p set: 0.4529838562011719
The modified gen p mean: 0.4518062174320221, gen p mean: -0.6080199480056763, mean p set: 0.4522865414619446
The modified gen p mean: 0.4520740807056427, gen p mean: -0.6028469800949097, mean p set: 0.4525543749332428
loss_pred:0.030379753559827805, decouple_loss:0.0211090799421072loss_pred:0.029219333082437515, decouple_loss:0.021816203370690346
loss_pred:0.030497675761580467, decouple_loss:0.02054351381957531
2023-05-02 22:33:06 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.6095284819602966, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6024777889251709, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5985010862350464, mean p set: 0.45035696029663086
loss_pred:0.03155135735869408, decouple_loss:0.025211023166775703
loss_pred:0.03043581172823906, decouple_loss:0.02434479258954525
loss_pred:0.029877919703722, decouple_loss:0.025014562532305717
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03186453506350517, avg_mse: 0.035609450191259384
current test mse: 0.035609
Iteration: 1251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452161580324173, gen p mean: -0.6026959419250488, mean p set: 0.45264187455177307
loss_pred:0.029368659481406212, decouple_loss:0.021640541031956673
The modified gen p mean: 0.45356109738349915, gen p mean: -0.603807270526886, mean p set: 0.45404139161109924
loss_pred:0.02935984544456005, decouple_loss:0.021964725106954575
The modified gen p mean: 0.4518677890300751, gen p mean: -0.6089751124382019, mean p set: 0.45234808325767517
loss_pred:0.030133746564388275, decouple_loss:0.021137183532118797
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
NaN value num: 0
Iteration: 1252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45199522376060486, gen p mean: -0.6014485955238342, mean p set: 0.45247551798820496
The modified gen p mean: 0.450093537569046, gen p mean: -0.6086777448654175, mean p set: 0.4505738615989685
The modified gen p mean: 0.4504455626010895, gen p mean: -0.5998014807701111, mean p set: 0.4509258568286896
loss_pred:0.029147466644644737, decouple_loss:0.023593800142407417
loss_pred:0.030158309265971184, decouple_loss:0.024252144619822502
loss_pred:0.0289157722145319, decouple_loss:0.023200098425149918
Iteration: 1253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514411389827728, gen p mean: -0.5910734534263611, mean p set: 0.4519214332103729
The modified gen p mean: 0.4514055550098419, gen p mean: -0.5955713391304016, mean p set: 0.451885849237442
The modified gen p mean: 0.4502885341644287, gen p mean: -0.5922704935073853, mean p set: 0.4507688283920288
loss_pred:0.028348533436655998, decouple_loss:0.02230716124176979
loss_pred:0.02986820973455906, decouple_loss:0.02331964485347271
loss_pred:0.030651891604065895, decouple_loss:0.023677535355091095
Iteration: 1254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860783219337463, gen p mean: -0.5948640704154968, mean p set: 0.44908812642097473
The modified gen p mean: 0.4505285620689392, gen p mean: -0.5875712037086487, mean p set: 0.4510088264942169
The modified gen p mean: 0.44928377866744995, gen p mean: -0.5913034081459045, mean p set: 0.44976404309272766
loss_pred:0.029272165149450302, decouple_loss:0.023348834365606308
loss_pred:0.029804294928908348, decouple_loss:0.022719332948327065
loss_pred:0.03022024966776371, decouple_loss:0.02233472652733326
Iteration: 1255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497230648994446, gen p mean: -0.5878548622131348, mean p set: 0.4502033293247223
The modified gen p mean: 0.4514023959636688, gen p mean: -0.5947083234786987, mean p set: 0.4518826901912689
The modified gen p mean: 0.4510818123817444, gen p mean: -0.5943735837936401, mean p set: 0.45156213641166687
loss_pred:0.029152244329452515, decouple_loss:0.02310388907790184
loss_pred:0.030208170413970947, decouple_loss:0.021539250388741493
loss_pred:0.030544111505150795, decouple_loss:0.021911311894655228
Iteration: 1256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44910693168640137, gen p mean: -0.5933899283409119, mean p set: 0.44958722591400146
The modified gen p mean: 0.4499203860759735, gen p mean: -0.5873306393623352, mean p set: 0.4504006803035736
The modified gen p mean: 0.45181918144226074, gen p mean: -0.597186267375946, mean p set: 0.4522995054721832
loss_pred:0.02957995794713497, decouple_loss:0.022813819348812103
loss_pred:0.029966797679662704, decouple_loss:0.021909568458795547
loss_pred:0.029232561588287354, decouple_loss:0.02275611087679863
Iteration: 1257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503028988838196, gen p mean: -0.6000406742095947, mean p set: 0.4507831633090973
The modified gen p mean: 0.4485812485218048, gen p mean: -0.6020333766937256, mean p set: 0.4490615427494049
The modified gen p mean: 0.44969338178634644, gen p mean: -0.6080787777900696, mean p set: 0.45017367601394653
loss_pred:0.029964450746774673, decouple_loss:0.021741241216659546
loss_pred:0.03087795153260231, decouple_loss:0.02326224371790886
loss_pred:0.029631569981575012, decouple_loss:0.02267598919570446
Iteration: 1258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513724446296692, gen p mean: -0.6138415336608887, mean p set: 0.4518527686595917
The modified gen p mean: 0.4490102231502533, gen p mean: -0.6125384569168091, mean p set: 0.4494905471801758
The modified gen p mean: 0.44978219270706177, gen p mean: -0.6228200197219849, mean p set: 0.45026248693466187
loss_pred:0.028940685093402863, decouple_loss:0.0227853711694479
loss_pred:0.030277997255325317, decouple_loss:0.02311989851295948
loss_pred:0.03028050810098648, decouple_loss:0.02229619398713112
Iteration: 1259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501246511936188, gen p mean: -0.6038802862167358, mean p set: 0.45060494542121887
The modified gen p mean: 0.4490276575088501, gen p mean: -0.6002687215805054, mean p set: 0.4495079815387726
The modified gen p mean: 0.4517676532268524, gen p mean: -0.607693612575531, mean p set: 0.4522479474544525
loss_pred:0.030798902735114098, decouple_loss:0.022309722378849983
loss_pred:0.030095363035798073, decouple_loss:0.02188270539045334
loss_pred:0.029256507754325867, decouple_loss:0.022420307621359825
Iteration: 1260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904351234436035, gen p mean: -0.5962356328964233, mean p set: 0.44952380657196045
The modified gen p mean: 0.4501555562019348, gen p mean: -0.5986818075180054, mean p set: 0.4506358802318573
The modified gen p mean: 0.4485863745212555, gen p mean: -0.5998221635818481, mean p set: 0.4490666687488556
loss_pred:0.029753757640719414, decouple_loss:0.02214139886200428
loss_pred:0.030325012281537056, decouple_loss:0.022008664906024933
loss_pred:0.029417531564831734, decouple_loss:0.022012345492839813
2023-05-02 22:37:30 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.599154531955719, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5917676091194153, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5874761343002319, mean p set: 0.45035696029663086
loss_pred:0.03139432892203331, decouple_loss:0.024665463715791702
loss_pred:0.030421379953622818, decouple_loss:0.023988084867596626
loss_pred:0.0298328697681427, decouple_loss:0.02408335730433464
WV_0_PC_1_EH_0_PS_40_6, loss: 0.031761810183525085, avg_mse: 0.035634174942970276
current test mse: 0.035634
Iteration: 1261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45017823576927185, gen p mean: -0.5991600751876831, mean p set: 0.45065850019454956
loss_pred:0.028862474486231804, decouple_loss:0.02262319065630436
The modified gen p mean: 0.44976598024368286, gen p mean: -0.5942083597183228, mean p set: 0.45024624466896057
loss_pred:0.02944403514266014, decouple_loss:0.02219664864242077
The modified gen p mean: 0.4524897634983063, gen p mean: -0.5953179001808167, mean p set: 0.45297008752822876
loss_pred:0.028731346130371094, decouple_loss:0.021973226219415665
Iteration: 1262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45104700326919556, gen p mean: -0.5949638485908508, mean p set: 0.45152729749679565
The modified gen p mean: 0.4476179778575897, gen p mean: -0.6033285856246948, mean p set: 0.44809824228286743
The modified gen p mean: 0.4500126242637634, gen p mean: -0.6041707396507263, mean p set: 0.4504929184913635
loss_pred:0.02906769886612892, decouple_loss:0.021675927564501762
loss_pred:0.028822796419262886, decouple_loss:0.021373027935624123
loss_pred:0.029522398486733437, decouple_loss:0.02178095281124115
Iteration: 1263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478794038295746, gen p mean: -0.5953232049942017, mean p set: 0.4483596682548523
The modified gen p mean: 0.45145854353904724, gen p mean: -0.5995748043060303, mean p set: 0.45193883776664734
The modified gen p mean: 0.4521656930446625, gen p mean: -0.5963314175605774, mean p set: 0.4526459276676178
loss_pred:0.030991923063993454, decouple_loss:0.021961556747555733
loss_pred:0.029199419543147087, decouple_loss:0.02160884626209736
loss_pred:0.029241440817713737, decouple_loss:0.02081887237727642
Iteration: 1264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500461518764496, gen p mean: -0.6086500287055969, mean p set: 0.4505264163017273
The modified gen p mean: 0.4493713080883026, gen p mean: -0.6016367673873901, mean p set: 0.4498515725135803
The modified gen p mean: 0.44945916533470154, gen p mean: -0.6077557802200317, mean p set: 0.44993945956230164
loss_pred:0.02850915491580963, decouple_loss:0.021671419963240623
loss_pred:0.029024727642536163, decouple_loss:0.02146804705262184
loss_pred:0.028564617037773132, decouple_loss:0.020949652418494225
Iteration: 1265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45216304063796997, gen p mean: -0.604867696762085, mean p set: 0.45264333486557007
The modified gen p mean: 0.4489016532897949, gen p mean: -0.6048409342765808, mean p set: 0.449381947517395
The modified gen p mean: 0.45227620005607605, gen p mean: -0.6012905240058899, mean p set: 0.45275649428367615
loss_pred:0.02884626016020775, decouple_loss:0.021339401602745056
loss_pred:0.030066093429923058, decouple_loss:0.021981535479426384
loss_pred:0.029166102409362793, decouple_loss:0.021714266389608383
Iteration: 1266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44852709770202637, gen p mean: -0.6097304224967957, mean p set: 0.44900739192962646
The modified gen p mean: 0.44949978590011597, gen p mean: -0.6100677251815796, mean p set: 0.4499800503253937
The modified gen p mean: 0.44863754510879517, gen p mean: -0.608090877532959, mean p set: 0.44911783933639526
loss_pred:0.030630815774202347, decouple_loss:0.022126691415905952
loss_pred:0.030209079384803772, decouple_loss:0.021144311875104904
loss_pred:0.029889000579714775, decouple_loss:0.021919121965765953
Iteration: 1267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493011236190796, gen p mean: -0.6086661219596863, mean p set: 0.4497814178466797
The modified gen p mean: 0.4504621624946594, gen p mean: -0.6172801852226257, mean p set: 0.4509424567222595
The modified gen p mean: 0.44915929436683655, gen p mean: -0.6061561107635498, mean p set: 0.44963955879211426
loss_pred:0.03043159283697605, decouple_loss:0.02133065089583397
loss_pred:0.029340682551264763, decouple_loss:0.021790049970149994
loss_pred:0.030511483550071716, decouple_loss:0.021563153713941574
Iteration: 1268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490024149417877, gen p mean: -0.6229661107063293, mean p set: 0.4494827091693878
The modified gen p mean: 0.44893309473991394, gen p mean: -0.623285174369812, mean p set: 0.44941338896751404
The modified gen p mean: 0.44982659816741943, gen p mean: -0.6169667840003967, mean p set: 0.45030689239501953
loss_pred:0.029883291572332382, decouple_loss:0.02175956219434738
loss_pred:0.029299499467015266, decouple_loss:0.022798290476202965
loss_pred:0.02924712561070919, decouple_loss:0.021501503884792328
Iteration: 1269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45141148567199707, gen p mean: -0.6251319646835327, mean p set: 0.4518917500972748
The modified gen p mean: 0.4477841854095459, gen p mean: -0.6208081841468811, mean p set: 0.4482645094394684
The modified gen p mean: 0.4505431652069092, gen p mean: -0.6170798540115356, mean p set: 0.4510234594345093
loss_pred:0.028514603152871132, decouple_loss:0.021756330505013466
loss_pred:0.03100639395415783, decouple_loss:0.021320268511772156
loss_pred:0.030613364651799202, decouple_loss:0.021315181627869606
Iteration: 1270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500269293785095, gen p mean: -0.6057331562042236, mean p set: 0.4505072236061096
The modified gen p mean: 0.45092496275901794, gen p mean: -0.6152345538139343, mean p set: 0.45140528678894043
The modified gen p mean: 0.4513234794139862, gen p mean: -0.6112619638442993, mean p set: 0.4518038034439087
loss_pred:0.028909774497151375, decouple_loss:0.020146744325757027
loss_pred:0.028534894809126854, decouple_loss:0.021372590214014053
loss_pred:0.028334083035588264, decouple_loss:0.02186291292309761
2023-05-02 22:41:11 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5972694158554077, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.604424774646759, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5923413634300232, mean p set: 0.45035696029663086
loss_pred:0.03032097779214382, decouple_loss:0.02372618578374386
loss_pred:0.03129976615309715, decouple_loss:0.024302737787365913
loss_pred:0.02977985329926014, decouple_loss:0.023956527933478355
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03166662156581879, avg_mse: 0.035559359937906265
current test mse: 0.035559
Iteration: 1271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528353810310364, gen p mean: -0.5961043238639832, mean p set: 0.4533156752586365
The modified gen p mean: 0.44997966289520264, gen p mean: -0.6068649291992188, mean p set: 0.45045995712280273
loss_pred:0.030024100095033646, decouple_loss:0.021471722051501274
loss_pred:0.02900608442723751, decouple_loss:0.02143489196896553
The modified gen p mean: 0.44975754618644714, gen p mean: -0.608718991279602, mean p set: 0.45023781061172485
loss_pred:0.02949676476418972, decouple_loss:0.021401870995759964
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
NaN value num: 0
Iteration: 1272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45067405700683594, gen p mean: -0.5975498557090759, mean p set: 0.45115435123443604
The modified gen p mean: 0.4498848617076874, gen p mean: -0.5950621366500854, mean p set: 0.4503651261329651
The modified gen p mean: 0.4497023820877075, gen p mean: -0.5927594304084778, mean p set: 0.4501826763153076
loss_pred:0.030632121488451958, decouple_loss:0.022692237049341202
loss_pred:0.02849550172686577, decouple_loss:0.025169817730784416
loss_pred:0.031336840242147446, decouple_loss:0.023182246834039688
Iteration: 1273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473849833011627, gen p mean: -0.6012658476829529, mean p set: 0.4478653073310852
The modified gen p mean: 0.4506209194660187, gen p mean: -0.6152164340019226, mean p set: 0.4511011838912964
The modified gen p mean: 0.449121356010437, gen p mean: -0.6152423620223999, mean p set: 0.4496016502380371
loss_pred:0.031100286170840263, decouple_loss:0.023436671122908592
loss_pred:0.029695086181163788, decouple_loss:0.023661062121391296
loss_pred:0.03153838962316513, decouple_loss:0.024023765698075294
Iteration: 1274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900307059288025, gen p mean: -0.6239957809448242, mean p set: 0.44948336482048035
The modified gen p mean: 0.45013856887817383, gen p mean: -0.6290277242660522, mean p set: 0.4506188929080963
The modified gen p mean: 0.4477819502353668, gen p mean: -0.6236399412155151, mean p set: 0.44826221466064453
loss_pred:0.03181503713130951, decouple_loss:0.02303575538098812
loss_pred:0.030370837077498436, decouple_loss:0.024588067084550858
loss_pred:0.031691934913396835, decouple_loss:0.023668603971600533
Iteration: 1275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44726619124412537, gen p mean: -0.6098006367683411, mean p set: 0.44774648547172546
The modified gen p mean: 0.45001158118247986, gen p mean: -0.6270728707313538, mean p set: 0.45049184560775757
The modified gen p mean: 0.44734182953834534, gen p mean: -0.6161843538284302, mean p set: 0.44782212376594543
loss_pred:0.02941046841442585, decouple_loss:0.02366875857114792
loss_pred:0.030674677342176437, decouple_loss:0.021760236471891403
loss_pred:0.030704719945788383, decouple_loss:0.022354958578944206
Iteration: 1276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45023879408836365, gen p mean: -0.6092669367790222, mean p set: 0.45071908831596375
The modified gen p mean: 0.45063212513923645, gen p mean: -0.6068990230560303, mean p set: 0.45111238956451416
The modified gen p mean: 0.4497668147087097, gen p mean: -0.6006938815116882, mean p set: 0.4502470791339874
loss_pred:0.030154844745993614, decouple_loss:0.022432290017604828
loss_pred:0.031063392758369446, decouple_loss:0.022431213408708572
loss_pred:0.03143301606178284, decouple_loss:0.02152591571211815
Iteration: 1277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484219253063202, gen p mean: -0.5898103713989258, mean p set: 0.4489021897315979
The modified gen p mean: 0.44839754700660706, gen p mean: -0.5957614183425903, mean p set: 0.44887787103652954
The modified gen p mean: 0.4483879804611206, gen p mean: -0.5892881155014038, mean p set: 0.4488682746887207
loss_pred:0.0314222052693367, decouple_loss:0.021906131878495216loss_pred:0.030420176684856415, decouple_loss:0.02228270098567009
loss_pred:0.02938840165734291, decouple_loss:0.022290542721748352
Iteration: 1278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485941231250763, gen p mean: -0.5988195538520813, mean p set: 0.4490744471549988
The modified gen p mean: 0.45010942220687866, gen p mean: -0.6048049926757812, mean p set: 0.45058971643447876
The modified gen p mean: 0.4478377103805542, gen p mean: -0.5912248492240906, mean p set: 0.4483179748058319
loss_pred:0.030973372980952263, decouple_loss:0.021322404965758324
loss_pred:0.02867518737912178, decouple_loss:0.022278176620602608
loss_pred:0.031118396669626236, decouple_loss:0.021729184314608574
Iteration: 1279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498942792415619, gen p mean: -0.599238395690918, mean p set: 0.4503746032714844
The modified gen p mean: 0.44965454936027527, gen p mean: -0.5977945923805237, mean p set: 0.45013487339019775
The modified gen p mean: 0.44791412353515625, gen p mean: -0.5957934260368347, mean p set: 0.44839444756507874
loss_pred:0.02987593784928322, decouple_loss:0.0213430467993021
loss_pred:0.03010706789791584, decouple_loss:0.021714502945542336
loss_pred:0.02953091263771057, decouple_loss:0.021012792363762856
Iteration: 1280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44859281182289124, gen p mean: -0.5939553380012512, mean p set: 0.44907310605049133
The modified gen p mean: 0.4500086307525635, gen p mean: -0.5945090651512146, mean p set: 0.4504888951778412
The modified gen p mean: 0.4502868950366974, gen p mean: -0.6001546382904053, mean p set: 0.4507671892642975
loss_pred:0.03106900490820408, decouple_loss:0.02161635085940361
loss_pred:0.028602562844753265, decouple_loss:0.02201274409890175
loss_pred:0.029861323535442352, decouple_loss:0.0216822549700737
2023-05-02 22:45:27 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6093776822090149, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6023575067520142, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987669587135315, gen p mean: -0.5975772142410278, mean p set: 0.45035696029663086
loss_pred:0.03019413724541664, decouple_loss:0.02333940751850605
loss_pred:0.03128131479024887, decouple_loss:0.02448188327252865
loss_pred:0.02958730235695839, decouple_loss:0.023820910602808
WV_0_PC_1_EH_0_PS_40_6, loss: 0.031548287719488144, avg_mse: 0.035406991839408875
current test mse: 0.035407
Iteration: 1281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44747990369796753, gen p mean: -0.5932904481887817, mean p set: 0.4479601979255676
The modified gen p mean: 0.45033779740333557, gen p mean: -0.606030285358429, mean p set: 0.45081809163093567
loss_pred:0.02904519811272621, decouple_loss:0.02189319208264351
loss_pred:0.028964746743440628, decouple_loss:0.02142610214650631
The modified gen p mean: 0.44817742705345154, gen p mean: -0.590833842754364, mean p set: 0.44865772128105164
loss_pred:0.030152255669236183, decouple_loss:0.021021045744419098
Iteration: 1282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500276744365692, gen p mean: -0.6005558371543884, mean p set: 0.4505079984664917
The modified gen p mean: 0.4481814205646515, gen p mean: -0.5977941155433655, mean p set: 0.4486616849899292
The modified gen p mean: 0.44778764247894287, gen p mean: -0.5935348272323608, mean p set: 0.4482679069042206
loss_pred:0.029493991285562515, decouple_loss:0.02144896611571312
loss_pred:0.031461697071790695, decouple_loss:0.02251388132572174
loss_pred:0.029945481568574905, decouple_loss:0.020739777013659477
Iteration: 1283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498419165611267, gen p mean: -0.6004744172096252, mean p set: 0.4503222107887268
The modified gen p mean: 0.44774147868156433, gen p mean: -0.5928487181663513, mean p set: 0.44822174310684204
The modified gen p mean: 0.45040223002433777, gen p mean: -0.6001015901565552, mean p set: 0.45088252425193787
loss_pred:0.03059392049908638, decouple_loss:0.022064287215471268
loss_pred:0.031856831163167953, decouple_loss:0.021430183202028275
loss_pred:0.0305652879178524, decouple_loss:0.02237038128077984
Iteration: 1284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486122727394104, gen p mean: -0.5876555442810059, mean p set: 0.4490925371646881
The modified gen p mean: 0.44752296805381775, gen p mean: -0.5909228324890137, mean p set: 0.44800323247909546
The modified gen p mean: 0.45007216930389404, gen p mean: -0.5980665683746338, mean p set: 0.45055249333381653
loss_pred:0.030620882287621498, decouple_loss:0.0210436824709177
loss_pred:0.030419383198022842, decouple_loss:0.020982416346669197
loss_pred:0.028443215414881706, decouple_loss:0.021313432604074478
Iteration: 1285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481180012226105, gen p mean: -0.5889974236488342, mean p set: 0.4485982656478882
The modified gen p mean: 0.44850990176200867, gen p mean: -0.5886544585227966, mean p set: 0.44899022579193115
The modified gen p mean: 0.450177401304245, gen p mean: -0.5975098013877869, mean p set: 0.4506576955318451
loss_pred:0.031019778922200203, decouple_loss:0.020991483703255653
loss_pred:0.030103234574198723, decouple_loss:0.020742293447256088
loss_pred:0.029344657436013222, decouple_loss:0.021407144144177437
Iteration: 1286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740962982177734, gen p mean: -0.5902745723724365, mean p set: 0.44788995385169983
The modified gen p mean: 0.4489588439464569, gen p mean: -0.5969970226287842, mean p set: 0.449439138174057
The modified gen p mean: 0.45012199878692627, gen p mean: -0.6053438782691956, mean p set: 0.45060229301452637
loss_pred:0.029573138803243637, decouple_loss:0.020599400624632835
loss_pred:0.030831720679998398, decouple_loss:0.02056947909295559
loss_pred:0.029783835634589195, decouple_loss:0.02167872153222561
Iteration: 1287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818419218063354, gen p mean: -0.5976052284240723, mean p set: 0.44866451621055603
The modified gen p mean: 0.44968751072883606, gen p mean: -0.5976003408432007, mean p set: 0.45016783475875854
The modified gen p mean: 0.4507506787776947, gen p mean: -0.6042748689651489, mean p set: 0.4512310028076172
loss_pred:0.029722021892666817, decouple_loss:0.020273897796869278
loss_pred:0.028531456366181374, decouple_loss:0.02113068662583828
loss_pred:0.028020324185490608, decouple_loss:0.020695367828011513
Iteration: 1288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483886659145355, gen p mean: -0.5914491415023804, mean p set: 0.44886893033981323
The modified gen p mean: 0.44746989011764526, gen p mean: -0.5929256081581116, mean p set: 0.447950154542923
The modified gen p mean: 0.447441041469574, gen p mean: -0.5914604067802429, mean p set: 0.4479213356971741
loss_pred:0.03099173866212368, decouple_loss:0.01981459930539131
loss_pred:0.03066088631749153, decouple_loss:0.02060016617178917
loss_pred:0.02965502254664898, decouple_loss:0.02069059945642948
Iteration: 1289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447834849357605, gen p mean: -0.5930180549621582, mean p set: 0.4483151137828827
The modified gen p mean: 0.44847986102104187, gen p mean: -0.6008808612823486, mean p set: 0.44896015524864197
The modified gen p mean: 0.44833797216415405, gen p mean: -0.5940412282943726, mean p set: 0.44881829619407654
loss_pred:0.030853137373924255, decouple_loss:0.020763427019119263
loss_pred:0.03151259198784828, decouple_loss:0.021467670798301697
loss_pred:0.03129085898399353, decouple_loss:0.021183250471949577
Iteration: 1290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447145938873291, gen p mean: -0.5963214635848999, mean p set: 0.4476262331008911
The modified gen p mean: 0.4498549699783325, gen p mean: -0.6018221974372864, mean p set: 0.45033523440361023
The modified gen p mean: 0.4505457878112793, gen p mean: -0.6045675277709961, mean p set: 0.4510261118412018
loss_pred:0.02908661775290966, decouple_loss:0.02022523619234562
loss_pred:0.029565846547484398, decouple_loss:0.020943598821759224
loss_pred:0.028198430314660072, decouple_loss:0.020346209406852722
2023-05-02 22:49:09 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6080887317657471, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.615537166595459, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6030564904212952, mean p set: 0.45035696029663086
loss_pred:0.030507976189255714, decouple_loss:0.022850053384900093
loss_pred:0.031629450619220734, decouple_loss:0.024102510884404182
loss_pred:0.029776431620121002, decouple_loss:0.023023052141070366
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03180421516299248, avg_mse: 0.03577283397316933
current test mse: 0.035773
Iteration: 1291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44942229986190796, gen p mean: -0.6114842891693115, mean p set: 0.44990259408950806
The modified gen p mean: 0.4502808153629303, gen p mean: -0.611604630947113, mean p set: 0.4507611393928528
loss_pred:0.03031039424240589, decouple_loss:0.021502245217561722
loss_pred:0.03004644811153412, decouple_loss:0.02131415158510208
The modified gen p mean: 0.45031341910362244, gen p mean: -0.6062369346618652, mean p set: 0.4507937431335449
loss_pred:0.02881145291030407, decouple_loss:0.02093973383307457
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
NaN value num: 0
Iteration: 1292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45267388224601746, gen p mean: -0.6018401980400085, mean p set: 0.45315417647361755
The modified gen p mean: 0.45180171728134155, gen p mean: -0.6028162837028503, mean p set: 0.45228198170661926
The modified gen p mean: 0.45245376229286194, gen p mean: -0.6039596199989319, mean p set: 0.4529340863227844
loss_pred:0.03060443513095379, decouple_loss:0.023013580590486526
loss_pred:0.030472690239548683, decouple_loss:0.023214267566800117
loss_pred:0.030151106417179108, decouple_loss:0.021802887320518494
Iteration: 1293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451018363237381, gen p mean: -0.6012948155403137, mean p set: 0.4514986276626587
The modified gen p mean: 0.45076799392700195, gen p mean: -0.6059420704841614, mean p set: 0.45124828815460205
The modified gen p mean: 0.4508955180644989, gen p mean: -0.5973570942878723, mean p set: 0.451375812292099
loss_pred:0.030168160796165466, decouple_loss:0.022642480209469795
loss_pred:0.030043821781873703, decouple_loss:0.022868767380714417
loss_pred:0.030696000903844833, decouple_loss:0.02147127315402031
Iteration: 1294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513908624649048, gen p mean: -0.6027097105979919, mean p set: 0.4518711566925049
The modified gen p mean: 0.45041078329086304, gen p mean: -0.5960654020309448, mean p set: 0.45089107751846313
The modified gen p mean: 0.4523821473121643, gen p mean: -0.6033239960670471, mean p set: 0.452862411737442
loss_pred:0.02969261072576046, decouple_loss:0.021735304966568947
loss_pred:0.029990848153829575, decouple_loss:0.020497916266322136
loss_pred:0.029922502115368843, decouple_loss:0.022273724898695946
Iteration: 1295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518972635269165, gen p mean: -0.6028910279273987, mean p set: 0.4523775279521942
The modified gen p mean: 0.45124709606170654, gen p mean: -0.5965337753295898, mean p set: 0.45172739028930664
The modified gen p mean: 0.4518945515155792, gen p mean: -0.6001748442649841, mean p set: 0.45237478613853455
loss_pred:0.029599234461784363, decouple_loss:0.0208981242030859
loss_pred:0.02955513447523117, decouple_loss:0.020702604204416275
loss_pred:0.030935969203710556, decouple_loss:0.021097933873534203
Iteration: 1296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45312532782554626, gen p mean: -0.6061493158340454, mean p set: 0.45360562205314636
The modified gen p mean: 0.45251381397247314, gen p mean: -0.6074685454368591, mean p set: 0.45299410820007324
The modified gen p mean: 0.45308157801628113, gen p mean: -0.5960397124290466, mean p set: 0.4535618722438812
loss_pred:0.03055247850716114, decouple_loss:0.021964799612760544
loss_pred:0.03028903901576996, decouple_loss:0.021947313100099564
loss_pred:0.029255907982587814, decouple_loss:0.02134169451892376
Iteration: 1297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525606632232666, gen p mean: -0.6182214021682739, mean p set: 0.4530409872531891
The modified gen p mean: 0.4513874650001526, gen p mean: -0.6215306520462036, mean p set: 0.4518677592277527
The modified gen p mean: 0.45296192169189453, gen p mean: -0.605237603187561, mean p set: 0.45344221591949463
loss_pred:0.030548449605703354, decouple_loss:0.02158731408417225
loss_pred:0.030203478410840034, decouple_loss:0.020841699093580246
loss_pred:0.03132705017924309, decouple_loss:0.021471157670021057
Iteration: 1298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45122694969177246, gen p mean: -0.6130355596542358, mean p set: 0.45170727372169495
The modified gen p mean: 0.450235515832901, gen p mean: -0.6122469902038574, mean p set: 0.4507158100605011
The modified gen p mean: 0.4520900845527649, gen p mean: -0.6149843335151672, mean p set: 0.4525703489780426
loss_pred:0.028496595099568367, decouple_loss:0.02195529080927372
loss_pred:0.028466302901506424, decouple_loss:0.022323476150631905
loss_pred:0.029117463156580925, decouple_loss:0.021984046325087547
Iteration: 1299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529753029346466, gen p mean: -0.6088714599609375, mean p set: 0.4534555673599243
The modified gen p mean: 0.4515746533870697, gen p mean: -0.6041746735572815, mean p set: 0.4520549178123474
The modified gen p mean: 0.45076045393943787, gen p mean: -0.6082755923271179, mean p set: 0.45124077796936035
loss_pred:0.03016292117536068, decouple_loss:0.020921524614095688
loss_pred:0.031414490193128586, decouple_loss:0.02157326228916645
loss_pred:0.02842503786087036, decouple_loss:0.02125946246087551
Iteration: 1300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45364052057266235, gen p mean: -0.5949772000312805, mean p set: 0.45412078499794006
The modified gen p mean: 0.4514777958393097, gen p mean: -0.6136465072631836, mean p set: 0.4519580900669098
The modified gen p mean: 0.45061159133911133, gen p mean: -0.6042615175247192, mean p set: 0.4510918855667114
loss_pred:0.029874136671423912, decouple_loss:0.020872298628091812
loss_pred:0.030013572424650192, decouple_loss:0.021446693688631058
loss_pred:0.029086243361234665, decouple_loss:0.021087581291794777
2023-05-02 22:53:33 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6135569214820862, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.621118426322937, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.60899817943573, mean p set: 0.45035696029663086
loss_pred:0.0304383784532547, decouple_loss:0.02350141480565071
loss_pred:0.03140658140182495, decouple_loss:0.024724343791604042
loss_pred:0.029735110700130463, decouple_loss:0.02394999749958515
WV_0_PC_1_EH_0_PS_40_6, loss: 0.031729619950056076, avg_mse: 0.035720691084861755
current test mse: 0.035721
Iteration: 1301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45342588424682617, gen p mean: -0.613900899887085, mean p set: 0.45390620827674866
loss_pred:0.030697006732225418, decouple_loss:0.020727254450321198
The modified gen p mean: 0.45206183195114136, gen p mean: -0.6146727800369263, mean p set: 0.45254209637641907
loss_pred:0.030276844277977943, decouple_loss:0.020518913865089417
The modified gen p mean: 0.45216771960258484, gen p mean: -0.6146432161331177, mean p set: 0.4526480436325073
loss_pred:0.029880492016673088, decouple_loss:0.02076655440032482
Iteration: 1302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452274888753891, gen p mean: -0.6199833154678345, mean p set: 0.4527551829814911
The modified gen p mean: 0.4513090252876282, gen p mean: -0.6205995678901672, mean p set: 0.4517892897129059
The modified gen p mean: 0.45140978693962097, gen p mean: -0.6164860129356384, mean p set: 0.45189008116722107
loss_pred:0.030188633129000664, decouple_loss:0.020713021978735924
loss_pred:0.02925703302025795, decouple_loss:0.020607518032193184
loss_pred:0.0300988107919693, decouple_loss:0.0207121130079031
Iteration: 1303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45210132002830505, gen p mean: -0.617807149887085, mean p set: 0.45258164405822754
The modified gen p mean: 0.45094770193099976, gen p mean: -0.6161254048347473, mean p set: 0.45142796635627747
The modified gen p mean: 0.4511535167694092, gen p mean: -0.614208459854126, mean p set: 0.4516338109970093
loss_pred:0.02999045141041279, decouple_loss:0.0217970609664917
loss_pred:0.028765931725502014, decouple_loss:0.020490804687142372
loss_pred:0.029383432120084763, decouple_loss:0.020604148507118225
Iteration: 1304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510819911956787, gen p mean: -0.6109612584114075, mean p set: 0.4515622556209564
The modified gen p mean: 0.45143890380859375, gen p mean: -0.6227923035621643, mean p set: 0.45191919803619385
The modified gen p mean: 0.45252203941345215, gen p mean: -0.6165876984596252, mean p set: 0.45300236344337463
loss_pred:0.029966335743665695, decouple_loss:0.020488884299993515
loss_pred:0.02892906405031681, decouple_loss:0.02143780328333378
loss_pred:0.029608547687530518, decouple_loss:0.021372174844145775
Iteration: 1305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45095396041870117, gen p mean: -0.6217763423919678, mean p set: 0.45143428444862366
The modified gen p mean: 0.4503174424171448, gen p mean: -0.6259427070617676, mean p set: 0.4507977068424225
The modified gen p mean: 0.45273759961128235, gen p mean: -0.6240389943122864, mean p set: 0.45321789383888245
loss_pred:0.028506368398666382, decouple_loss:0.02025650441646576
loss_pred:0.029391951858997345, decouple_loss:0.021589508280158043
loss_pred:0.029579797759652138, decouple_loss:0.02082739770412445
Iteration: 1306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45073312520980835, gen p mean: -0.6156100630760193, mean p set: 0.45121341943740845
The modified gen p mean: 0.4508211314678192, gen p mean: -0.6184082627296448, mean p set: 0.4513013958930969
The modified gen p mean: 0.45320776104927063, gen p mean: -0.6218432784080505, mean p set: 0.45368802547454834
loss_pred:0.028623485937714577, decouple_loss:0.019662031903862953
loss_pred:0.02913828007876873, decouple_loss:0.020175283774733543
loss_pred:0.0303135197609663, decouple_loss:0.021623356267809868
Iteration: 1307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45261576771736145, gen p mean: -0.6083571314811707, mean p set: 0.45309609174728394
The modified gen p mean: 0.45103585720062256, gen p mean: -0.6066306829452515, mean p set: 0.45151615142822266
The modified gen p mean: 0.45335400104522705, gen p mean: -0.6056013703346252, mean p set: 0.45383426547050476
loss_pred:0.03022594563663006, decouple_loss:0.02036283351480961
loss_pred:0.028779353946447372, decouple_loss:0.019704367965459824
loss_pred:0.031016645953059196, decouple_loss:0.020990047603845596
Iteration: 1308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45237088203430176, gen p mean: -0.6098206639289856, mean p set: 0.45285117626190186
The modified gen p mean: 0.4527921676635742, gen p mean: -0.6116259098052979, mean p set: 0.4532724618911743
The modified gen p mean: 0.4531868100166321, gen p mean: -0.6118478775024414, mean p set: 0.4536671042442322
loss_pred:0.029728639870882034, decouple_loss:0.02050458826124668
loss_pred:0.029955828562378883, decouple_loss:0.01983196847140789
loss_pred:0.0292222797870636, decouple_loss:0.020166795700788498
Iteration: 1309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521215856075287, gen p mean: -0.6257341504096985, mean p set: 0.4526018798351288
The modified gen p mean: 0.4532085657119751, gen p mean: -0.6229676008224487, mean p set: 0.4536888301372528
The modified gen p mean: 0.4520992636680603, gen p mean: -0.6247766017913818, mean p set: 0.4525795578956604
loss_pred:0.02940312959253788, decouple_loss:0.02045883610844612
loss_pred:0.03070841357111931, decouple_loss:0.02060994692146778
loss_pred:0.029855037108063698, decouple_loss:0.020434202626347542
Iteration: 1310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45133817195892334, gen p mean: -0.6275337934494019, mean p set: 0.45181846618652344
The modified gen p mean: 0.45333120226860046, gen p mean: -0.6237869262695312, mean p set: 0.45381149649620056
The modified gen p mean: 0.4524152874946594, gen p mean: -0.6252365112304688, mean p set: 0.4528955817222595
loss_pred:0.028903046622872353, decouple_loss:0.020592523738741875
loss_pred:0.02999892644584179, decouple_loss:0.01993522234261036
loss_pred:0.029856344684958458, decouple_loss:0.02143540233373642
2023-05-02 22:57:17 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6168635487556458, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.6234701871871948, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6127120852470398, mean p set: 0.45035696029663086
loss_pred:0.03024335950613022, decouple_loss:0.023169036954641342
loss_pred:0.031312245875597, decouple_loss:0.02405858039855957
loss_pred:0.029559383168816566, decouple_loss:0.023573828861117363
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03155168890953064, avg_mse: 0.03562460094690323
current test mse: 0.035625
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 1311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466777741909027, gen p mean: -0.6125061511993408, mean p set: 0.44715800881385803
loss_pred:0.02883044444024563, decouple_loss:0.02263135090470314
The modified gen p mean: 0.4466248154640198, gen p mean: -0.6099064946174622, mean p set: 0.4471050798892975
loss_pred:0.030337700620293617, decouple_loss:0.022906005382537842
The modified gen p mean: 0.4467073082923889, gen p mean: -0.6163105368614197, mean p set: 0.4471876323223114
loss_pred:0.030769985169172287, decouple_loss:0.022883016616106033
Iteration: 1312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784802198410034, gen p mean: -0.6185550689697266, mean p set: 0.44832831621170044
The modified gen p mean: 0.44719359278678894, gen p mean: -0.6113390326499939, mean p set: 0.4476739168167114
The modified gen p mean: 0.4473174214363098, gen p mean: -0.6133170127868652, mean p set: 0.4477977156639099
loss_pred:0.030377492308616638, decouple_loss:0.023360775783658028
loss_pred:0.03104967437684536, decouple_loss:0.022565808147192
loss_pred:0.030326291918754578, decouple_loss:0.02221076749265194
Iteration: 1313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476661682128906, gen p mean: -0.6204128265380859, mean p set: 0.44814640283584595
The modified gen p mean: 0.44812071323394775, gen p mean: -0.6214016675949097, mean p set: 0.44860100746154785
The modified gen p mean: 0.44665172696113586, gen p mean: -0.6104281544685364, mean p set: 0.44713205099105835
loss_pred:0.03070230595767498, decouple_loss:0.021262366324663162
loss_pred:0.030128827318549156, decouple_loss:0.02162780426442623
loss_pred:0.030085017904639244, decouple_loss:0.02303830161690712
Iteration: 1314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717469811439514, gen p mean: -0.626541256904602, mean p set: 0.44765499234199524
The modified gen p mean: 0.44716647267341614, gen p mean: -0.6237918138504028, mean p set: 0.44764676690101624
The modified gen p mean: 0.4482123553752899, gen p mean: -0.6189724206924438, mean p set: 0.44869264960289
loss_pred:0.03070543147623539, decouple_loss:0.021675437688827515
loss_pred:0.030417118221521378, decouple_loss:0.021069133654236794
loss_pred:0.03004203550517559, decouple_loss:0.021123718470335007
Iteration: 1315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466235935688019, gen p mean: -0.6253954768180847, mean p set: 0.4471038579940796
The modified gen p mean: 0.44609716534614563, gen p mean: -0.6241914629936218, mean p set: 0.4465774595737457
The modified gen p mean: 0.4471668303012848, gen p mean: -0.6283718347549438, mean p set: 0.4476470947265625
loss_pred:0.03231597691774368, decouple_loss:0.0211048386991024
loss_pred:0.031061146408319473, decouple_loss:0.021104348823428154
loss_pred:0.029653506353497505, decouple_loss:0.021316105499863625
Iteration: 1316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482124447822571, gen p mean: -0.6143531203269958, mean p set: 0.4486927390098572
The modified gen p mean: 0.4474543333053589, gen p mean: -0.6247718930244446, mean p set: 0.447934627532959
The modified gen p mean: 0.44715994596481323, gen p mean: -0.6180352568626404, mean p set: 0.44764021039009094
loss_pred:0.030472293496131897, decouple_loss:0.02115941047668457
loss_pred:0.030872421339154243, decouple_loss:0.021286210045218468
loss_pred:0.031229952350258827, decouple_loss:0.0215128306299448
Iteration: 1317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44614535570144653, gen p mean: -0.6111041903495789, mean p set: 0.44662564992904663
The modified gen p mean: 0.44818082451820374, gen p mean: -0.6242509484291077, mean p set: 0.4486611485481262
The modified gen p mean: 0.446893572807312, gen p mean: -0.6178518533706665, mean p set: 0.4473738372325897
loss_pred:0.03031959757208824, decouple_loss:0.021987613290548325
loss_pred:0.029713081195950508, decouple_loss:0.020672598853707314
loss_pred:0.029250100255012512, decouple_loss:0.02144906297326088
Iteration: 1318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482475817203522, gen p mean: -0.6093719601631165, mean p set: 0.44872787594795227
The modified gen p mean: 0.44695717096328735, gen p mean: -0.594077467918396, mean p set: 0.44743743538856506
The modified gen p mean: 0.44794780015945435, gen p mean: -0.6089063286781311, mean p set: 0.44842812418937683
loss_pred:0.029511844739317894, decouple_loss:0.02133874036371708
loss_pred:0.030271116644144058, decouple_loss:0.022268790751695633
loss_pred:0.030348489060997963, decouple_loss:0.020926158875226974
Iteration: 1319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44640475511550903, gen p mean: -0.6028213500976562, mean p set: 0.44688504934310913
The modified gen p mean: 0.44814738631248474, gen p mean: -0.5992271304130554, mean p set: 0.44862768054008484
The modified gen p mean: 0.448147714138031, gen p mean: -0.6084058880805969, mean p set: 0.4486280083656311
loss_pred:0.029616203159093857, decouple_loss:0.021344810724258423
loss_pred:0.029700374230742455, decouple_loss:0.02083432488143444
loss_pred:0.030071282759308815, decouple_loss:0.020706094801425934
Iteration: 1320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44703614711761475, gen p mean: -0.6058608889579773, mean p set: 0.44751641154289246
The modified gen p mean: 0.44660329818725586, gen p mean: -0.6039785146713257, mean p set: 0.44708362221717834
loss_pred:0.029831301420927048, decouple_loss:0.01997738517820835
loss_pred:0.029669400304555893, decouple_loss:0.020743686705827713
The modified gen p mean: 0.447307288646698, gen p mean: -0.6089092493057251, mean p set: 0.4477875828742981
loss_pred:0.030318239703774452, decouple_loss:0.020556528121232986
2023-05-02 23:01:42 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6038309931755066, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6103543043136597, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.600470781326294, mean p set: 0.45035696029663086
loss_pred:0.030113929882645607, decouple_loss:0.021536018699407578
loss_pred:0.03119194321334362, decouple_loss:0.021878035739064217
loss_pred:0.029575495049357414, decouple_loss:0.021454857662320137
WV_0_PC_1_EH_0_PS_40_6, loss: 0.031374938786029816, avg_mse: 0.03547960892319679
current test mse: 0.03548
Iteration: 1321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478078782558441, gen p mean: -0.6099132299423218, mean p set: 0.4482881724834442
loss_pred:0.03034522570669651, decouple_loss:0.021220630034804344
The modified gen p mean: 0.44753628969192505, gen p mean: -0.6043329238891602, mean p set: 0.44801655411720276
loss_pred:0.029000574722886086, decouple_loss:0.020010344684123993
The modified gen p mean: 0.44738903641700745, gen p mean: -0.5997994542121887, mean p set: 0.44786933064460754
loss_pred:0.030240269377827644, decouple_loss:0.020643243566155434
Iteration: 1322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769904017448425, gen p mean: -0.5990203619003296, mean p set: 0.44817930459976196
The modified gen p mean: 0.4463751018047333, gen p mean: -0.5978107452392578, mean p set: 0.4468553960323334
The modified gen p mean: 0.4471932649612427, gen p mean: -0.597071647644043, mean p set: 0.4476735293865204
loss_pred:0.03036729246377945, decouple_loss:0.019884806126356125
loss_pred:0.0304208192974329, decouple_loss:0.02036423049867153
loss_pred:0.030503323301672935, decouple_loss:0.02009555883705616
Iteration: 1323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472956657409668, gen p mean: -0.5984630584716797, mean p set: 0.4477759599685669
The modified gen p mean: 0.4460698068141937, gen p mean: -0.5846786499023438, mean p set: 0.4465501010417938
The modified gen p mean: 0.4472036063671112, gen p mean: -0.5954195857048035, mean p set: 0.4476839005947113
loss_pred:0.03041679784655571, decouple_loss:0.0206803847104311
loss_pred:0.029857438057661057, decouple_loss:0.021086258813738823
loss_pred:0.028746867552399635, decouple_loss:0.02077368088066578
Iteration: 1324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446856826543808, gen p mean: -0.5945910811424255, mean p set: 0.4473371207714081
The modified gen p mean: 0.4487560987472534, gen p mean: -0.6003634929656982, mean p set: 0.44923636317253113
The modified gen p mean: 0.4469364583492279, gen p mean: -0.5972189903259277, mean p set: 0.447416752576828
loss_pred:0.02884090691804886, decouple_loss:0.020501622930169106
loss_pred:0.030049577355384827, decouple_loss:0.020209798589348793
loss_pred:0.030208943411707878, decouple_loss:0.019874703139066696
Iteration: 1325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480387568473816, gen p mean: -0.6024332046508789, mean p set: 0.4485190510749817
The modified gen p mean: 0.4466308355331421, gen p mean: -0.5930848717689514, mean p set: 0.4471111297607422
The modified gen p mean: 0.446791410446167, gen p mean: -0.5925825834274292, mean p set: 0.4472716748714447
loss_pred:0.030673068016767502, decouple_loss:0.02061913162469864
loss_pred:0.029441973194479942, decouple_loss:0.019767744466662407
loss_pred:0.030848074704408646, decouple_loss:0.021003948524594307
Iteration: 1326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465309977531433, gen p mean: -0.5832233428955078, mean p set: 0.4470112919807434
The modified gen p mean: 0.4484021067619324, gen p mean: -0.5777089595794678, mean p set: 0.44888240098953247
The modified gen p mean: 0.44737738370895386, gen p mean: -0.5893736481666565, mean p set: 0.44785767793655396
loss_pred:0.02886306680738926, decouple_loss:0.019994590431451797
loss_pred:0.02968011237680912, decouple_loss:0.02143191359937191
loss_pred:0.03146931529045105, decouple_loss:0.02015753462910652
Iteration: 1327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472768306732178, gen p mean: -0.5768190622329712, mean p set: 0.4477570950984955
The modified gen p mean: 0.4475524127483368, gen p mean: -0.5860854983329773, mean p set: 0.4480327367782593
The modified gen p mean: 0.44720712304115295, gen p mean: -0.5822615623474121, mean p set: 0.44768741726875305
loss_pred:0.0300531554967165, decouple_loss:0.021116722375154495
loss_pred:0.030019110068678856, decouple_loss:0.02053728513419628
loss_pred:0.029721699655056, decouple_loss:0.02035163901746273
Iteration: 1328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474722146987915, gen p mean: -0.5985313653945923, mean p set: 0.4479525089263916
The modified gen p mean: 0.44684138894081116, gen p mean: -0.5956023931503296, mean p set: 0.44732168316841125
The modified gen p mean: 0.446953147649765, gen p mean: -0.596065104007721, mean p set: 0.4474334716796875
loss_pred:0.029854970052838326, decouple_loss:0.01999107003211975
loss_pred:0.029189733788371086, decouple_loss:0.02021777629852295
loss_pred:0.029919521883130074, decouple_loss:0.01960638538002968
Iteration: 1329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447295606136322, gen p mean: -0.5943644046783447, mean p set: 0.4477759003639221
The modified gen p mean: 0.4473952651023865, gen p mean: -0.602137565612793, mean p set: 0.4478755593299866
The modified gen p mean: 0.4470263123512268, gen p mean: -0.6033582091331482, mean p set: 0.4475066065788269
loss_pred:0.03040391393005848, decouple_loss:0.019920341670513153
loss_pred:0.03013320453464985, decouple_loss:0.019636573269963264
loss_pred:0.028173185884952545, decouple_loss:0.019622767344117165
Iteration: 1330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669535756111145, gen p mean: -0.5972530245780945, mean p set: 0.44717565178871155
The modified gen p mean: 0.4465223252773285, gen p mean: -0.5931066870689392, mean p set: 0.4470026195049286
The modified gen p mean: 0.44691500067710876, gen p mean: -0.5990923047065735, mean p set: 0.44739529490470886
loss_pred:0.030875690281391144, decouple_loss:0.019701527431607246
loss_pred:0.030007943511009216, decouple_loss:0.020073020830750465
loss_pred:0.02916376106441021, decouple_loss:0.019839156419038773
2023-05-02 23:05:28 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.5998871922492981, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.592673122882843, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5890761017799377, mean p set: 0.45035696029663086
loss_pred:0.03087039664387703, decouple_loss:0.02085256390273571
loss_pred:0.029928231611847878, decouple_loss:0.020590562373399734
loss_pred:0.029340194538235664, decouple_loss:0.020502807572484016
WV_0_PC_1_EH_0_PS_40_6, loss: 0.031078707426786423, avg_mse: 0.03511397913098335
current test mse: 0.035114
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
NaN value num: 0
Iteration: 1331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45327383279800415, gen p mean: -0.5868453979492188, mean p set: 0.45375412702560425
The modified gen p mean: 0.45428934693336487, gen p mean: -0.5866091251373291, mean p set: 0.45476964116096497
loss_pred:0.029643455520272255, decouple_loss:0.022332701832056046
loss_pred:0.030086109414696693, decouple_loss:0.022073006257414818
The modified gen p mean: 0.4525827467441559, gen p mean: -0.5929980278015137, mean p set: 0.45306307077407837
loss_pred:0.030621502548456192, decouple_loss:0.024131469428539276
Iteration: 1332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533141255378723, gen p mean: -0.5948516726493835, mean p set: 0.4537944197654724
The modified gen p mean: 0.45212581753730774, gen p mean: -0.5958304405212402, mean p set: 0.45260608196258545
The modified gen p mean: 0.45216554403305054, gen p mean: -0.5973314642906189, mean p set: 0.45264583826065063
loss_pred:0.030232269316911697, decouple_loss:0.022093206644058228
loss_pred:0.03089398518204689, decouple_loss:0.022153159603476524
loss_pred:0.030004480853676796, decouple_loss:0.02232564240694046
Iteration: 1333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45392748713493347, gen p mean: -0.6042926907539368, mean p set: 0.45440778136253357
The modified gen p mean: 0.45172128081321716, gen p mean: -0.6134979128837585, mean p set: 0.4522015452384949
The modified gen p mean: 0.452735036611557, gen p mean: -0.6055629849433899, mean p set: 0.4532153010368347
loss_pred:0.02933148853480816, decouple_loss:0.022236164659261703
loss_pred:0.030426757410168648, decouple_loss:0.021860944107174873
loss_pred:0.030945679172873497, decouple_loss:0.022295629605650902
Iteration: 1334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45269808173179626, gen p mean: -0.5987595319747925, mean p set: 0.45317837595939636
The modified gen p mean: 0.4539887309074402, gen p mean: -0.6026028394699097, mean p set: 0.4544689953327179
The modified gen p mean: 0.45371976494789124, gen p mean: -0.5949181318283081, mean p set: 0.45420005917549133
loss_pred:0.029810691252350807, decouple_loss:0.021692832931876183
loss_pred:0.029506037011742592, decouple_loss:0.022043436765670776
loss_pred:0.02897111140191555, decouple_loss:0.02160174399614334
Iteration: 1335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45424720644950867, gen p mean: -0.5936446189880371, mean p set: 0.45472750067710876
The modified gen p mean: 0.45374631881713867, gen p mean: -0.585503339767456, mean p set: 0.4542265832424164
The modified gen p mean: 0.4528195261955261, gen p mean: -0.5984131097793579, mean p set: 0.4532998204231262
loss_pred:0.028948716819286346, decouple_loss:0.02074987255036831
loss_pred:0.029895855113863945, decouple_loss:0.02145201340317726
loss_pred:0.029612092301249504, decouple_loss:0.022041654214262962
Iteration: 1336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529957175254822, gen p mean: -0.5984785556793213, mean p set: 0.4534760117530823
The modified gen p mean: 0.4533783197402954, gen p mean: -0.598344624042511, mean p set: 0.4538586437702179
The modified gen p mean: 0.45326536893844604, gen p mean: -0.603317141532898, mean p set: 0.45374566316604614
loss_pred:0.02940780483186245, decouple_loss:0.021167177706956863
loss_pred:0.02964160218834877, decouple_loss:0.02129034698009491
loss_pred:0.029744181782007217, decouple_loss:0.02147049270570278
Iteration: 1337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509071409702301, gen p mean: -0.6108978390693665, mean p set: 0.4513874351978302
The modified gen p mean: 0.452231228351593, gen p mean: -0.609946608543396, mean p set: 0.4527115225791931
The modified gen p mean: 0.45152685046195984, gen p mean: -0.6115097403526306, mean p set: 0.45200714468955994
loss_pred:0.030545596033334732, decouple_loss:0.021915914490818977
loss_pred:0.030022546648979187, decouple_loss:0.02119138278067112
loss_pred:0.03080596588551998, decouple_loss:0.021945025771856308
Iteration: 1338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526059925556183, gen p mean: -0.6192094683647156, mean p set: 0.453086256980896
The modified gen p mean: 0.4521391689777374, gen p mean: -0.6189538240432739, mean p set: 0.45261943340301514
The modified gen p mean: 0.4511503279209137, gen p mean: -0.6209842562675476, mean p set: 0.4516305923461914
loss_pred:0.030073123052716255, decouple_loss:0.020926186814904213
loss_pred:0.030429355800151825, decouple_loss:0.021272365003824234
loss_pred:0.031016772612929344, decouple_loss:0.021574776619672775
Iteration: 1339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45457717776298523, gen p mean: -0.6237572431564331, mean p set: 0.4550575017929077
The modified gen p mean: 0.4520069658756256, gen p mean: -0.6211205124855042, mean p set: 0.4524872601032257
The modified gen p mean: 0.4542848467826843, gen p mean: -0.6135214567184448, mean p set: 0.4547651410102844
loss_pred:0.029313357546925545, decouple_loss:0.021842431277036667
loss_pred:0.029523158445954323, decouple_loss:0.021685389801859856
loss_pred:0.029420435428619385, decouple_loss:0.021303562447428703
Iteration: 1340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45358502864837646, gen p mean: -0.6138181090354919, mean p set: 0.45406532287597656
The modified gen p mean: 0.4526360332965851, gen p mean: -0.6235384345054626, mean p set: 0.4531163275241852
The modified gen p mean: 0.4523431360721588, gen p mean: -0.6042779088020325, mean p set: 0.4528234302997589
loss_pred:0.028795165941119194, decouple_loss:0.020472049713134766
loss_pred:0.029819166287779808, decouple_loss:0.022065607830882072
loss_pred:0.03039529174566269, decouple_loss:0.021179672330617905
2023-05-02 23:09:50 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6194295883178711, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.6276348829269409, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6152418255805969, mean p set: 0.45035696029663086
loss_pred:0.03004940040409565, decouple_loss:0.023810451850295067
loss_pred:0.03126740828156471, decouple_loss:0.024400919675827026
loss_pred:0.029518472030758858, decouple_loss:0.023999521508812904
WV_0_PC_1_EH_0_PS_40_6, loss: 0.031481944024562836, avg_mse: 0.035534169524908066
current test mse: 0.035534
Iteration: 1341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45330193638801575, gen p mean: -0.6179592609405518, mean p set: 0.45378226041793823
loss_pred:0.029489414766430855, decouple_loss:0.020536895841360092
The modified gen p mean: 0.4537821114063263, gen p mean: -0.6133430004119873, mean p set: 0.4542624056339264
loss_pred:0.030802428722381592, decouple_loss:0.02122853323817253
The modified gen p mean: 0.4510023295879364, gen p mean: -0.6151621341705322, mean p set: 0.4514826238155365
loss_pred:0.03021862916648388, decouple_loss:0.020480306819081306
Iteration: 1342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45353007316589355, gen p mean: -0.6169184446334839, mean p set: 0.45401036739349365
The modified gen p mean: 0.45335814356803894, gen p mean: -0.6163364052772522, mean p set: 0.45383843779563904
The modified gen p mean: 0.45215287804603577, gen p mean: -0.6228939890861511, mean p set: 0.45263317227363586
loss_pred:0.02949056401848793, decouple_loss:0.02026016265153885
loss_pred:0.030011773109436035, decouple_loss:0.019860057160258293
loss_pred:0.029567399993538857, decouple_loss:0.020738516002893448
Iteration: 1343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521203637123108, gen p mean: -0.6159752011299133, mean p set: 0.4526006579399109
The modified gen p mean: 0.4530980587005615, gen p mean: -0.6163694262504578, mean p set: 0.4535783529281616
The modified gen p mean: 0.4526561498641968, gen p mean: -0.620330810546875, mean p set: 0.4531364440917969
loss_pred:0.03015175648033619, decouple_loss:0.0205947607755661
loss_pred:0.02876277267932892, decouple_loss:0.020917586982250214
loss_pred:0.030470803380012512, decouple_loss:0.02152339369058609
Iteration: 1344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45295488834381104, gen p mean: -0.6269102096557617, mean p set: 0.4534352123737335
The modified gen p mean: 0.45294082164764404, gen p mean: -0.6230304837226868, mean p set: 0.45342111587524414
The modified gen p mean: 0.45247185230255127, gen p mean: -0.6234241127967834, mean p set: 0.452952116727829
loss_pred:0.030616456642746925, decouple_loss:0.02055191434919834
loss_pred:0.028759656473994255, decouple_loss:0.020030712708830833
loss_pred:0.03038018010556698, decouple_loss:0.02037365548312664
Iteration: 1345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531184434890747, gen p mean: -0.632132887840271, mean p set: 0.4535987377166748
The modified gen p mean: 0.45320481061935425, gen p mean: -0.6395015716552734, mean p set: 0.45368504524230957
The modified gen p mean: 0.45453310012817383, gen p mean: -0.636698305606842, mean p set: 0.45501336455345154
loss_pred:0.028919946402311325, decouple_loss:0.020275602117180824
loss_pred:0.030686846002936363, decouple_loss:0.020891431719064713
loss_pred:0.029584942385554314, decouple_loss:0.020666034892201424
Iteration: 1346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522591829299927, gen p mean: -0.6381290555000305, mean p set: 0.4527394771575928
The modified gen p mean: 0.45379146933555603, gen p mean: -0.6309409737586975, mean p set: 0.45427173376083374
The modified gen p mean: 0.45180827379226685, gen p mean: -0.6308301687240601, mean p set: 0.45228859782218933
loss_pred:0.029748914763331413, decouple_loss:0.02000631019473076
loss_pred:0.028858428820967674, decouple_loss:0.020197797566652298
loss_pred:0.03008091263473034, decouple_loss:0.021632282063364983
Iteration: 1347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45208877325057983, gen p mean: -0.6159936189651489, mean p set: 0.45256906747817993
The modified gen p mean: 0.45306912064552307, gen p mean: -0.6203637719154358, mean p set: 0.4535493850708008
The modified gen p mean: 0.4539163112640381, gen p mean: -0.6143984794616699, mean p set: 0.45439663529396057
loss_pred:0.029737815260887146, decouple_loss:0.019938981160521507
loss_pred:0.028889533132314682, decouple_loss:0.02047993801534176
loss_pred:0.028930531814694405, decouple_loss:0.02057235687971115
Iteration: 1348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453517884016037, gen p mean: -0.5985394716262817, mean p set: 0.4539981782436371
The modified gen p mean: 0.45242059230804443, gen p mean: -0.6020781397819519, mean p set: 0.45290088653564453
The modified gen p mean: 0.45377692580223083, gen p mean: -0.5986654758453369, mean p set: 0.45425722002983093
loss_pred:0.028881104663014412, decouple_loss:0.02017158828675747
loss_pred:0.0301923006772995, decouple_loss:0.020243864506483078
loss_pred:0.029512949287891388, decouple_loss:0.020218797028064728
Iteration: 1349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514142572879791, gen p mean: -0.5968980193138123, mean p set: 0.4518945813179016
The modified gen p mean: 0.45162105560302734, gen p mean: -0.5924091935157776, mean p set: 0.45210132002830505
The modified gen p mean: 0.4526146352291107, gen p mean: -0.5958792567253113, mean p set: 0.4530949294567108
loss_pred:0.030462950468063354, decouple_loss:0.020623566582798958
loss_pred:0.029895443469285965, decouple_loss:0.02036626823246479
loss_pred:0.02968575619161129, decouple_loss:0.0201841052621603
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
NaN value num: 0
Iteration: 1350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44998079538345337, gen p mean: -0.6105384826660156, mean p set: 0.4504610598087311
The modified gen p mean: 0.4512881934642792, gen p mean: -0.6031386852264404, mean p set: 0.4517684876918793
The modified gen p mean: 0.45071345567703247, gen p mean: -0.6019050478935242, mean p set: 0.45119374990463257
loss_pred:0.028978055343031883, decouple_loss:0.02127225324511528
loss_pred:0.029219893738627434, decouple_loss:0.021067507565021515
loss_pred:0.02933880127966404, decouple_loss:0.022314952686429024
2023-05-02 23:14:14 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6328343152999878, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6245023608207703, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6201277375221252, mean p set: 0.45035696029663086
loss_pred:0.031084753572940826, decouple_loss:0.02383876033127308
loss_pred:0.029952405020594597, decouple_loss:0.02296219952404499
loss_pred:0.029389316216111183, decouple_loss:0.023255394771695137
WV_0_PC_1_EH_0_PS_40_6, loss: 0.031309764832258224, avg_mse: 0.03538542985916138
current test mse: 0.035385
Iteration: 1351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511168599128723, gen p mean: -0.6153564453125, mean p set: 0.4515971541404724
The modified gen p mean: 0.4492376148700714, gen p mean: -0.6279520392417908, mean p set: 0.4497178792953491
loss_pred:0.02858453057706356, decouple_loss:0.020138533785939217
loss_pred:0.029522474855184555, decouple_loss:0.022192755714058876
The modified gen p mean: 0.45159855484962463, gen p mean: -0.6182243227958679, mean p set: 0.45207884907722473
loss_pred:0.027694569900631905, decouple_loss:0.020760586485266685
Iteration: 1352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44807469844818115, gen p mean: -0.6344304084777832, mean p set: 0.44855502247810364
The modified gen p mean: 0.4490896165370941, gen p mean: -0.6275871396064758, mean p set: 0.4495699107646942
The modified gen p mean: 0.4518933892250061, gen p mean: -0.6233502626419067, mean p set: 0.4523736536502838
loss_pred:0.028505755588412285, decouple_loss:0.022265737876296043
loss_pred:0.03020191751420498, decouple_loss:0.02217070758342743
loss_pred:0.0278274267911911, decouple_loss:0.02014377899467945
Iteration: 1353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45163416862487793, gen p mean: -0.6159440875053406, mean p set: 0.452114462852478
The modified gen p mean: 0.44951415061950684, gen p mean: -0.6207743287086487, mean p set: 0.44999441504478455
The modified gen p mean: 0.4516366422176361, gen p mean: -0.6240649223327637, mean p set: 0.4521169364452362
loss_pred:0.028668196871876717, decouple_loss:0.0195638295263052
loss_pred:0.030527004972100258, decouple_loss:0.021370531991124153
loss_pred:0.027729365974664688, decouple_loss:0.020732615143060684
Iteration: 1354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515303373336792, gen p mean: -0.6193042397499084, mean p set: 0.4520106315612793
The modified gen p mean: 0.44879651069641113, gen p mean: -0.6176193356513977, mean p set: 0.44927680492401123
The modified gen p mean: 0.451058030128479, gen p mean: -0.621622622013092, mean p set: 0.4515382945537567
loss_pred:0.02773333340883255, decouple_loss:0.020355163142085075
loss_pred:0.030760889872908592, decouple_loss:0.020498646423220634
loss_pred:0.02827761508524418, decouple_loss:0.01992398127913475
Iteration: 1355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522525370121002, gen p mean: -0.6168262958526611, mean p set: 0.4527328312397003
The modified gen p mean: 0.44800442457199097, gen p mean: -0.6186853647232056, mean p set: 0.44848471879959106
The modified gen p mean: 0.4514516294002533, gen p mean: -0.6111229658126831, mean p set: 0.4519319236278534
loss_pred:0.027970708906650543, decouple_loss:0.019430849701166153
loss_pred:0.028882069513201714, decouple_loss:0.020583687350153923
loss_pred:0.028136515989899635, decouple_loss:0.019870173186063766
Iteration: 1356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451703816652298, gen p mean: -0.6139610409736633, mean p set: 0.45218411087989807
The modified gen p mean: 0.45113927125930786, gen p mean: -0.6079732775688171, mean p set: 0.45161959528923035
The modified gen p mean: 0.4493281841278076, gen p mean: -0.6083894371986389, mean p set: 0.4498084783554077
loss_pred:0.02787989377975464, decouple_loss:0.019358249381184578
loss_pred:0.02893519215285778, decouple_loss:0.0201362706720829
loss_pred:0.02950982004404068, decouple_loss:0.020329833030700684
Iteration: 1357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44935938715934753, gen p mean: -0.6258655786514282, mean p set: 0.44983968138694763
The modified gen p mean: 0.4493485689163208, gen p mean: -0.6139081120491028, mean p set: 0.4498288631439209
The modified gen p mean: 0.45043498277664185, gen p mean: -0.6135655045509338, mean p set: 0.45091530680656433
loss_pred:0.027552742511034012, decouple_loss:0.02050040476024151
loss_pred:0.028975646942853928, decouple_loss:0.020192204043269157
loss_pred:0.027751894667744637, decouple_loss:0.019558027386665344
Iteration: 1358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486517608165741, gen p mean: -0.6249748468399048, mean p set: 0.4491320550441742
The modified gen p mean: 0.45155611634254456, gen p mean: -0.6220527291297913, mean p set: 0.45203638076782227
The modified gen p mean: 0.4482744038105011, gen p mean: -0.6249805688858032, mean p set: 0.4487546980381012
loss_pred:0.029457323253154755, decouple_loss:0.019811229780316353
loss_pred:0.027368810027837753, decouple_loss:0.018744761124253273
loss_pred:0.028720395639538765, decouple_loss:0.020400971174240112
Iteration: 1359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45048773288726807, gen p mean: -0.6108866930007935, mean p set: 0.4509679973125458
The modified gen p mean: 0.4501021206378937, gen p mean: -0.6101712584495544, mean p set: 0.4505823850631714
The modified gen p mean: 0.45136773586273193, gen p mean: -0.6190921664237976, mean p set: 0.45184803009033203
loss_pred:0.02961711212992668, decouple_loss:0.02009762078523636
loss_pred:0.029381223022937775, decouple_loss:0.019416524097323418
loss_pred:0.02773052640259266, decouple_loss:0.01973261684179306
Iteration: 1360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500167667865753, gen p mean: -0.6120142936706543, mean p set: 0.4504970610141754
The modified gen p mean: 0.4508572220802307, gen p mean: -0.6097877621650696, mean p set: 0.4513375163078308
The modified gen p mean: 0.44799914956092834, gen p mean: -0.616666316986084, mean p set: 0.44847941398620605
loss_pred:0.0294924508780241, decouple_loss:0.019974179565906525
loss_pred:0.02908378839492798, decouple_loss:0.020171163603663445
loss_pred:0.02834993414580822, decouple_loss:0.01927975006401539
2023-05-02 23:17:56 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.6223897933959961, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6149609684944153, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6110280156135559, mean p set: 0.45035696029663086
loss_pred:0.030777981504797935, decouple_loss:0.02240113355219364
loss_pred:0.02973787486553192, decouple_loss:0.021449251100420952
loss_pred:0.02909238450229168, decouple_loss:0.021649949252605438
WV_0_PC_1_EH_0_PS_40_6, loss: 0.030961086973547935, avg_mse: 0.03506475314497948
current test mse: 0.035065
Iteration: 1361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494708776473999, gen p mean: -0.6181503534317017, mean p set: 0.449951171875
loss_pred:0.030183393508195877, decouple_loss:0.020693430677056313
The modified gen p mean: 0.45150136947631836, gen p mean: -0.6108353137969971, mean p set: 0.45198163390159607
loss_pred:0.028614245355129242, decouple_loss:0.018983742222189903
The modified gen p mean: 0.44996964931488037, gen p mean: -0.6204078197479248, mean p set: 0.45044994354248047
loss_pred:0.02719987742602825, decouple_loss:0.018699584528803825
Iteration: 1362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517773687839508, gen p mean: -0.6233599781990051, mean p set: 0.4522576630115509
The modified gen p mean: 0.45187094807624817, gen p mean: -0.61625736951828, mean p set: 0.45235124230384827
The modified gen p mean: 0.4509750306606293, gen p mean: -0.611421525478363, mean p set: 0.451455295085907
loss_pred:0.028076041489839554, decouple_loss:0.01890517771244049
loss_pred:0.02811589278280735, decouple_loss:0.018320998176932335
loss_pred:0.028569528833031654, decouple_loss:0.01913018524646759
Iteration: 1363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490474462509155, gen p mean: -0.6153956055641174, mean p set: 0.4495277404785156
The modified gen p mean: 0.4511788487434387, gen p mean: -0.616144597530365, mean p set: 0.45165911316871643
The modified gen p mean: 0.45097821950912476, gen p mean: -0.6145485043525696, mean p set: 0.45145851373672485
loss_pred:0.028882771730422974, decouple_loss:0.018936747685074806
loss_pred:0.02885374426841736, decouple_loss:0.019491437822580338
loss_pred:0.02862424962222576, decouple_loss:0.01915806159377098
Iteration: 1364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45100703835487366, gen p mean: -0.618751049041748, mean p set: 0.45148730278015137
The modified gen p mean: 0.4517100155353546, gen p mean: -0.627720296382904, mean p set: 0.4521903395652771
The modified gen p mean: 0.45099201798439026, gen p mean: -0.6254609823226929, mean p set: 0.45147234201431274
loss_pred:0.028720730915665627, decouple_loss:0.018922358751296997
loss_pred:0.028305280953645706, decouple_loss:0.018734632059931755
loss_pred:0.027438253164291382, decouple_loss:0.019170302897691727
Iteration: 1365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44980132579803467, gen p mean: -0.6295309662818909, mean p set: 0.45028162002563477
The modified gen p mean: 0.4514239430427551, gen p mean: -0.6281357407569885, mean p set: 0.4519042372703552
The modified gen p mean: 0.4508605897426605, gen p mean: -0.6311542391777039, mean p set: 0.4513408839702606
loss_pred:0.029757188633084297, decouple_loss:0.02010180801153183
loss_pred:0.02791060134768486, decouple_loss:0.018579475581645966
loss_pred:0.027381880208849907, decouple_loss:0.01905016042292118
Iteration: 1366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44896504282951355, gen p mean: -0.633830189704895, mean p set: 0.44944530725479126
The modified gen p mean: 0.4519844055175781, gen p mean: -0.6318866610527039, mean p set: 0.45246466994285583
The modified gen p mean: 0.45063233375549316, gen p mean: -0.6239860653877258, mean p set: 0.45111262798309326
loss_pred:0.028259480372071266, decouple_loss:0.019972050562500954
loss_pred:0.02695293352007866, decouple_loss:0.01812893897294998
loss_pred:0.027247702702879906, decouple_loss:0.019417667761445045
Iteration: 1367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499015808105469, gen p mean: -0.6215438842773438, mean p set: 0.45038190484046936
The modified gen p mean: 0.4513588547706604, gen p mean: -0.624717652797699, mean p set: 0.4518391489982605
loss_pred:0.028602618724107742, decouple_loss:0.019828859716653824
The modified gen p mean: 0.45170459151268005, gen p mean: -0.6207154393196106, mean p set: 0.45218491554260254
loss_pred:0.027896039187908173, decouple_loss:0.0187576524913311
loss_pred:0.028275327757000923, decouple_loss:0.01865033246576786
Iteration: 1368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492574632167816, gen p mean: -0.629638671875, mean p set: 0.4497377276420593
The modified gen p mean: 0.45030251145362854, gen p mean: -0.618603527545929, mean p set: 0.45078280568122864
The modified gen p mean: 0.451710969209671, gen p mean: -0.6184279322624207, mean p set: 0.4521912932395935
loss_pred:0.028262890875339508, decouple_loss:0.019209621474146843
loss_pred:0.028604011982679367, decouple_loss:0.01898038759827614
loss_pred:0.028918543830513954, decouple_loss:0.01934255287051201
Iteration: 1369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509863257408142, gen p mean: -0.6228352785110474, mean p set: 0.4514666199684143
The modified gen p mean: 0.4516501724720001, gen p mean: -0.624104917049408, mean p set: 0.4521304666996002
The modified gen p mean: 0.44951415061950684, gen p mean: -0.624504566192627, mean p set: 0.4499944746494293
loss_pred:0.028863340616226196, decouple_loss:0.019243329763412476
loss_pred:0.02852022647857666, decouple_loss:0.01752193458378315
loss_pred:0.029058409854769707, decouple_loss:0.01860777474939823
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
NaN value num: 0
Iteration: 1370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45178964734077454, gen p mean: -0.6347813606262207, mean p set: 0.45226994156837463
The modified gen p mean: 0.452554315328598, gen p mean: -0.6317561864852905, mean p set: 0.4530346095561981
The modified gen p mean: 0.4522475302219391, gen p mean: -0.6246027946472168, mean p set: 0.4527277946472168
loss_pred:0.029235174879431725, decouple_loss:0.020595865324139595
loss_pred:0.0311193335801363, decouple_loss:0.02006983570754528
loss_pred:0.028586333617568016, decouple_loss:0.020436203107237816
2023-05-02 23:22:17 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6351916193962097, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6271998286247253, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6227574348449707, mean p set: 0.45035696029663086
loss_pred:0.030859841033816338, decouple_loss:0.02221505157649517
loss_pred:0.029873544350266457, decouple_loss:0.02141837775707245
loss_pred:0.029193231835961342, decouple_loss:0.02169344387948513
WV_0_PC_1_EH_0_PS_40_6, loss: 0.031064322218298912, avg_mse: 0.03526923060417175
current test mse: 0.035269
Iteration: 1371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516121447086334, gen p mean: -0.6257228851318359, mean p set: 0.45209240913391113
The modified gen p mean: 0.4506746232509613, gen p mean: -0.6291568279266357, mean p set: 0.4511549472808838
loss_pred:0.02907172217965126, decouple_loss:0.019380146637558937
loss_pred:0.03056912124156952, decouple_loss:0.019775589928030968
The modified gen p mean: 0.4514193832874298, gen p mean: -0.6187971830368042, mean p set: 0.4518997073173523
loss_pred:0.030708465725183487, decouple_loss:0.02037833444774151
Iteration: 1372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507308900356293, gen p mean: -0.6218478083610535, mean p set: 0.45121118426322937
The modified gen p mean: 0.45111456513404846, gen p mean: -0.6314544677734375, mean p set: 0.45159485936164856
The modified gen p mean: 0.45160067081451416, gen p mean: -0.6208526492118835, mean p set: 0.45208099484443665
loss_pred:0.029756862670183182, decouple_loss:0.020297924056649208
loss_pred:0.028489980846643448, decouple_loss:0.019215205684304237
loss_pred:0.029931945726275444, decouple_loss:0.019993944093585014
Iteration: 1373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45244091749191284, gen p mean: -0.6328430771827698, mean p set: 0.45292118191719055
The modified gen p mean: 0.45016083121299744, gen p mean: -0.6382836699485779, mean p set: 0.45064112544059753
The modified gen p mean: 0.45174503326416016, gen p mean: -0.6327219009399414, mean p set: 0.45222529768943787
loss_pred:0.03054138645529747, decouple_loss:0.019796298816800117
loss_pred:0.03011683002114296, decouple_loss:0.019320111721754074
loss_pred:0.030729742720723152, decouple_loss:0.019071165472269058
Iteration: 1374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45239225029945374, gen p mean: -0.6516469120979309, mean p set: 0.45287254452705383
The modified gen p mean: 0.4538593888282776, gen p mean: -0.6476395726203918, mean p set: 0.4543396830558777
The modified gen p mean: 0.45178744196891785, gen p mean: -0.6495690941810608, mean p set: 0.45226770639419556
loss_pred:0.030172616243362427, decouple_loss:0.020264022052288055
loss_pred:0.02933623641729355, decouple_loss:0.020314017310738564
loss_pred:0.02859865128993988, decouple_loss:0.019664263352751732
Iteration: 1375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45147013664245605, gen p mean: -0.6441449522972107, mean p set: 0.45195040106773376
The modified gen p mean: 0.4513148069381714, gen p mean: -0.6458297371864319, mean p set: 0.4517951011657715
The modified gen p mean: 0.4507935047149658, gen p mean: -0.6386151909828186, mean p set: 0.45127376914024353
loss_pred:0.028900649398565292, decouple_loss:0.019491756334900856
loss_pred:0.03023567982017994, decouple_loss:0.019730903208255768
loss_pred:0.030511196702718735, decouple_loss:0.019107824191451073
Iteration: 1376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512425363063812, gen p mean: -0.6521844267845154, mean p set: 0.4517228305339813
The modified gen p mean: 0.45201635360717773, gen p mean: -0.634671151638031, mean p set: 0.4524966776371002
The modified gen p mean: 0.4514394700527191, gen p mean: -0.6352030038833618, mean p set: 0.4519197940826416
loss_pred:0.029911065474152565, decouple_loss:0.01966312900185585
loss_pred:0.030145449563860893, decouple_loss:0.019537577405571938
loss_pred:0.029530733823776245, decouple_loss:0.019838320091366768
Iteration: 1377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45160356163978577, gen p mean: -0.6456876397132874, mean p set: 0.4520838260650635
The modified gen p mean: 0.4511711001396179, gen p mean: -0.639501690864563, mean p set: 0.45165136456489563
The modified gen p mean: 0.4534396529197693, gen p mean: -0.6443242430686951, mean p set: 0.4539199471473694
loss_pred:0.029708750545978546, decouple_loss:0.01901431940495968
loss_pred:0.029472997412085533, decouple_loss:0.019108548760414124
loss_pred:0.028098072856664658, decouple_loss:0.019039278849959373
Iteration: 1378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506503641605377, gen p mean: -0.6257458925247192, mean p set: 0.4511306881904602
The modified gen p mean: 0.4516027867794037, gen p mean: -0.627017080783844, mean p set: 0.4520830810070038
The modified gen p mean: 0.4532153904438019, gen p mean: -0.6337448358535767, mean p set: 0.453695684671402
loss_pred:0.02860158309340477, decouple_loss:0.019108427688479424
loss_pred:0.03020591288805008, decouple_loss:0.01892782934010029
loss_pred:0.028650399297475815, decouple_loss:0.0191628597676754
Iteration: 1379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514593183994293, gen p mean: -0.6225075721740723, mean p set: 0.45193958282470703
The modified gen p mean: 0.4519716203212738, gen p mean: -0.6185542345046997, mean p set: 0.4524519443511963
The modified gen p mean: 0.452044278383255, gen p mean: -0.6263014674186707, mean p set: 0.4525245428085327
loss_pred:0.028719814494252205, decouple_loss:0.018977317959070206
loss_pred:0.030363455414772034, decouple_loss:0.019348876550793648
loss_pred:0.02817174419760704, decouple_loss:0.019401168450713158
Iteration: 1380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505658447742462, gen p mean: -0.6380348205566406, mean p set: 0.4510461390018463
The modified gen p mean: 0.4539720416069031, gen p mean: -0.6367059350013733, mean p set: 0.45445236563682556
The modified gen p mean: 0.45226433873176575, gen p mean: -0.6383700966835022, mean p set: 0.45274466276168823
loss_pred:0.030513286590576172, decouple_loss:0.01920594461262226
loss_pred:0.029207170009613037, decouple_loss:0.018556766211986542
loss_pred:0.030308431014418602, decouple_loss:0.019217077642679214
2023-05-02 23:25:57 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.6496562361717224, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6419777870178223, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6373425722122192, mean p set: 0.45035696029663086
loss_pred:0.03078056313097477, decouple_loss:0.022492045536637306
loss_pred:0.029695695266127586, decouple_loss:0.021910103037953377
loss_pred:0.02907031774520874, decouple_loss:0.02190961129963398
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03095405548810959, avg_mse: 0.035112980753183365
current test mse: 0.035113
Iteration: 1381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45226389169692993, gen p mean: -0.6397754549980164, mean p set: 0.45274418592453003
loss_pred:0.028025483712553978, decouple_loss:0.018126673996448517
The modified gen p mean: 0.45156583189964294, gen p mean: -0.647992730140686, mean p set: 0.45204612612724304
loss_pred:0.028362726792693138, decouple_loss:0.018364349380135536
The modified gen p mean: 0.4514380693435669, gen p mean: -0.639117419719696, mean p set: 0.451918363571167
loss_pred:0.02912643924355507, decouple_loss:0.019428586587309837
Iteration: 1382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45206695795059204, gen p mean: -0.632692813873291, mean p set: 0.45254722237586975
The modified gen p mean: 0.4512234926223755, gen p mean: -0.64165198802948, mean p set: 0.4517037868499756
The modified gen p mean: 0.44989460706710815, gen p mean: -0.6353711485862732, mean p set: 0.45037490129470825
loss_pred:0.02831081859767437, decouple_loss:0.018171172589063644
loss_pred:0.03058946505188942, decouple_loss:0.018880710005760193
loss_pred:0.030130013823509216, decouple_loss:0.019137859344482422
Iteration: 1383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45270445942878723, gen p mean: -0.6335722804069519, mean p set: 0.45318475365638733
The modified gen p mean: 0.4502146542072296, gen p mean: -0.6273735165596008, mean p set: 0.4506949186325073
The modified gen p mean: 0.45070749521255493, gen p mean: -0.6257842183113098, mean p set: 0.45118778944015503
loss_pred:0.02758372761309147, decouple_loss:0.018031472340226173
loss_pred:0.03049590066075325, decouple_loss:0.018418869003653526
loss_pred:0.029049308970570564, decouple_loss:0.019445126876235008
Iteration: 1384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522682726383209, gen p mean: -0.6284798979759216, mean p set: 0.4527485966682434
The modified gen p mean: 0.4513789713382721, gen p mean: -0.6217377781867981, mean p set: 0.4518592655658722
The modified gen p mean: 0.4511440396308899, gen p mean: -0.6372655034065247, mean p set: 0.45162433385849
loss_pred:0.02893095090985298, decouple_loss:0.019179973751306534
loss_pred:0.030250441282987595, decouple_loss:0.019260380417108536
loss_pred:0.030344948172569275, decouple_loss:0.019438069313764572
Iteration: 1385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525368809700012, gen p mean: -0.6351878643035889, mean p set: 0.45301714539527893
The modified gen p mean: 0.45327654480934143, gen p mean: -0.631269633769989, mean p set: 0.4537568688392639
The modified gen p mean: 0.45021769404411316, gen p mean: -0.6256402134895325, mean p set: 0.45069798827171326
loss_pred:0.02994888834655285, decouple_loss:0.019327569752931595
loss_pred:0.028187474235892296, decouple_loss:0.018287293612957
loss_pred:0.027867330238223076, decouple_loss:0.0180964358150959
Iteration: 1386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511578679084778, gen p mean: -0.6321938037872314, mean p set: 0.4516381621360779
The modified gen p mean: 0.45175790786743164, gen p mean: -0.6278297305107117, mean p set: 0.45223820209503174
The modified gen p mean: 0.4510784447193146, gen p mean: -0.6306222081184387, mean p set: 0.4515587389469147
loss_pred:0.02979980781674385, decouple_loss:0.01827588677406311
loss_pred:0.029006676748394966, decouple_loss:0.018353058025240898
loss_pred:0.029282299801707268, decouple_loss:0.018631914630532265
Iteration: 1387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45154112577438354, gen p mean: -0.6299203634262085, mean p set: 0.45202142000198364
The modified gen p mean: 0.45112621784210205, gen p mean: -0.6393954753875732, mean p set: 0.45160651206970215
The modified gen p mean: 0.4532906711101532, gen p mean: -0.6369415521621704, mean p set: 0.4537709653377533
loss_pred:0.030058391392230988, decouple_loss:0.018585484474897385
loss_pred:0.030149249359965324, decouple_loss:0.01811542734503746
loss_pred:0.029074115678668022, decouple_loss:0.018840953707695007
Iteration: 1388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506472647190094, gen p mean: -0.6399297118186951, mean p set: 0.4511275291442871
The modified gen p mean: 0.4505062401294708, gen p mean: -0.6432575583457947, mean p set: 0.45098650455474854
The modified gen p mean: 0.45079416036605835, gen p mean: -0.6394331455230713, mean p set: 0.45127442479133606
loss_pred:0.029780538752675056, decouple_loss:0.018805885687470436
loss_pred:0.027775708585977554, decouple_loss:0.017955845221877098
loss_pred:0.029382361099123955, decouple_loss:0.01894770935177803
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
NaN value num: 0
Iteration: 1389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527862071990967, gen p mean: -0.6347116827964783, mean p set: 0.4532664716243744
The modified gen p mean: 0.4505113959312439, gen p mean: -0.6358000040054321, mean p set: 0.4509917199611664
The modified gen p mean: 0.45369693636894226, gen p mean: -0.6344541907310486, mean p set: 0.45417720079421997
loss_pred:0.028578048571944237, decouple_loss:0.02037064917385578
loss_pred:0.030577972531318665, decouple_loss:0.019971562549471855
loss_pred:0.02865608222782612, decouple_loss:0.01981516368687153
Iteration: 1390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484826624393463, gen p mean: -0.6412267088890076, mean p set: 0.4489629566669464
The modified gen p mean: 0.45263221859931946, gen p mean: -0.6333019137382507, mean p set: 0.45311251282691956
The modified gen p mean: 0.45109039545059204, gen p mean: -0.6307889223098755, mean p set: 0.45157068967819214
loss_pred:0.030137620866298676, decouple_loss:0.020340757444500923loss_pred:0.028049174696207047, decouple_loss:0.020964162424206734
loss_pred:0.02923143282532692, decouple_loss:0.020988138392567635
2023-05-02 23:30:18 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.6392279267311096, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6318747997283936, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6274697780609131, mean p set: 0.45035696029663086
loss_pred:0.03080788068473339, decouple_loss:0.02186802588403225
loss_pred:0.0297304205596447, decouple_loss:0.02135746367275715
loss_pred:0.029083525761961937, decouple_loss:0.021602913737297058
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03095441684126854, avg_mse: 0.03511882945895195
current test mse: 0.035119
Iteration: 1391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45138782262802124, gen p mean: -0.6356227993965149, mean p set: 0.45186808705329895
The modified gen p mean: 0.44947129487991333, gen p mean: -0.6305145025253296, mean p set: 0.4499515891075134
loss_pred:0.027777379378676414, decouple_loss:0.020206809043884277
loss_pred:0.029701722785830498, decouple_loss:0.01979769580066204
The modified gen p mean: 0.4534391462802887, gen p mean: -0.6238100528717041, mean p set: 0.4539194405078888
loss_pred:0.028408093377947807, decouple_loss:0.02080073021352291
Iteration: 1392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449347585439682, gen p mean: -0.6384565830230713, mean p set: 0.4498278796672821
The modified gen p mean: 0.45214831829071045, gen p mean: -0.6332305669784546, mean p set: 0.45262858271598816
The modified gen p mean: 0.4503602981567383, gen p mean: -0.6362364888191223, mean p set: 0.4508405923843384
loss_pred:0.030546842142939568, decouple_loss:0.019643988460302353
loss_pred:0.02970019355416298, decouple_loss:0.019630886614322662
loss_pred:0.028812022879719734, decouple_loss:0.019976304844021797
Iteration: 1393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45353665947914124, gen p mean: -0.6490980386734009, mean p set: 0.4540169835090637
The modified gen p mean: 0.4513629674911499, gen p mean: -0.6481825709342957, mean p set: 0.4518432915210724
The modified gen p mean: 0.4479731023311615, gen p mean: -0.6489821076393127, mean p set: 0.448453426361084
loss_pred:0.02919944003224373, decouple_loss:0.019582023844122887
loss_pred:0.0292290598154068, decouple_loss:0.019820192828774452
loss_pred:0.03077811188995838, decouple_loss:0.0196096021682024
Iteration: 1394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45277470350265503, gen p mean: -0.6413567662239075, mean p set: 0.4532550275325775
The modified gen p mean: 0.4522474408149719, gen p mean: -0.6427363157272339, mean p set: 0.452727735042572
The modified gen p mean: 0.4527755677700043, gen p mean: -0.6405993103981018, mean p set: 0.45325586199760437
loss_pred:0.028320563957095146, decouple_loss:0.020356133580207825
loss_pred:0.02810426987707615, decouple_loss:0.020442085340619087
loss_pred:0.028890367597341537, decouple_loss:0.01957879215478897
Iteration: 1395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835197925567627, gen p mean: -0.6467257142066956, mean p set: 0.44883227348327637
The modified gen p mean: 0.4501210153102875, gen p mean: -0.6418824195861816, mean p set: 0.45060133934020996
The modified gen p mean: 0.44776785373687744, gen p mean: -0.6414594650268555, mean p set: 0.4482481777667999
loss_pred:0.03055325150489807, decouple_loss:0.019313767552375793
loss_pred:0.028138941153883934, decouple_loss:0.019693847745656967
loss_pred:0.030008427798748016, decouple_loss:0.020132118836045265
Iteration: 1396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515826106071472, gen p mean: -0.6369956731796265, mean p set: 0.4520629048347473
The modified gen p mean: 0.4490574300289154, gen p mean: -0.6352940797805786, mean p set: 0.4495377540588379
The modified gen p mean: 0.44961437582969666, gen p mean: -0.6416376233100891, mean p set: 0.45009464025497437
loss_pred:0.028915854170918465, decouple_loss:0.019198153167963028
loss_pred:0.029916927218437195, decouple_loss:0.019565574824810028
loss_pred:0.029745057225227356, decouple_loss:0.01961122639477253
Iteration: 1397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502444267272949, gen p mean: -0.6265258193016052, mean p set: 0.450724720954895
The modified gen p mean: 0.4502754211425781, gen p mean: -0.6275594830513, mean p set: 0.45075568556785583
The modified gen p mean: 0.4496348202228546, gen p mean: -0.6328410506248474, mean p set: 0.4501151144504547
loss_pred:0.028769342228770256, decouple_loss:0.01997942477464676
loss_pred:0.028938062489032745, decouple_loss:0.019331539049744606
loss_pred:0.02998054027557373, decouple_loss:0.019023733213543892
Iteration: 1398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45114830136299133, gen p mean: -0.6313491463661194, mean p set: 0.45162856578826904
The modified gen p mean: 0.4502812325954437, gen p mean: -0.6260625123977661, mean p set: 0.4507615268230438
The modified gen p mean: 0.44902503490448, gen p mean: -0.6293041110038757, mean p set: 0.4495052993297577
loss_pred:0.027608241885900497, decouple_loss:0.019417673349380493
loss_pred:0.03004421480000019, decouple_loss:0.01983998343348503
loss_pred:0.02992011047899723, decouple_loss:0.019389431923627853
Iteration: 1399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802626967430115, gen p mean: -0.6367271542549133, mean p set: 0.44850653409957886
The modified gen p mean: 0.4514996409416199, gen p mean: -0.6332291960716248, mean p set: 0.45197993516921997
The modified gen p mean: 0.44808685779571533, gen p mean: -0.6402425765991211, mean p set: 0.44856709241867065
loss_pred:0.02991291508078575, decouple_loss:0.018847612664103508
loss_pred:0.029321758076548576, decouple_loss:0.01943470537662506
loss_pred:0.030302951112389565, decouple_loss:0.019783075898885727
Iteration: 1400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529041349887848, gen p mean: -0.6310088634490967, mean p set: 0.4533843994140625
The modified gen p mean: 0.4505225718021393, gen p mean: -0.635613739490509, mean p set: 0.4510028660297394
The modified gen p mean: 0.44904935359954834, gen p mean: -0.6374427080154419, mean p set: 0.44952961802482605
loss_pred:0.02992377057671547, decouple_loss:0.019430367276072502
loss_pred:0.027820313349366188, decouple_loss:0.01883082278072834
loss_pred:0.029955821111798286, decouple_loss:0.01842343807220459
2023-05-02 23:34:02 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6410771608352661, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.64841628074646, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6366972327232361, mean p set: 0.45035696029663086
loss_pred:0.030067238956689835, decouple_loss:0.021575413644313812
loss_pred:0.0310713779181242, decouple_loss:0.021597588434815407
loss_pred:0.029370777308940887, decouple_loss:0.021542029455304146
WV_0_PC_1_EH_0_PS_40_6, loss: 0.031248383224010468, avg_mse: 0.0355963408946991
current test mse: 0.035596
Iteration: 1401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45039984583854675, gen p mean: -0.6385701298713684, mean p set: 0.45088011026382446
The modified gen p mean: 0.4538688063621521, gen p mean: -0.6408146023750305, mean p set: 0.4543490707874298
loss_pred:0.028634127229452133, decouple_loss:0.018884843215346336
loss_pred:0.028659392148256302, decouple_loss:0.01961335353553295
The modified gen p mean: 0.4490417540073395, gen p mean: -0.6401975154876709, mean p set: 0.4495220482349396
loss_pred:0.0297981109470129, decouple_loss:0.018739603459835052
Iteration: 1402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44970130920410156, gen p mean: -0.6339491009712219, mean p set: 0.45018160343170166
The modified gen p mean: 0.45116496086120605, gen p mean: -0.6349133849143982, mean p set: 0.45164522528648376
The modified gen p mean: 0.45128703117370605, gen p mean: -0.6356014609336853, mean p set: 0.45176732540130615
loss_pred:0.02983989007771015, decouple_loss:0.01836092583835125
loss_pred:0.029621511697769165, decouple_loss:0.01912129484117031
loss_pred:0.029727524146437645, decouple_loss:0.019339563325047493
Iteration: 1403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45189160108566284, gen p mean: -0.6236592531204224, mean p set: 0.45237189531326294
The modified gen p mean: 0.4519825875759125, gen p mean: -0.6277737021446228, mean p set: 0.4524628818035126
The modified gen p mean: 0.4523581564426422, gen p mean: -0.6228636503219604, mean p set: 0.4528384804725647
loss_pred:0.028850268572568893, decouple_loss:0.0203238558024168
loss_pred:0.02890785224735737, decouple_loss:0.01915176771581173
loss_pred:0.0283119585365057, decouple_loss:0.020334025844931602
Iteration: 1404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496529996395111, gen p mean: -0.6285560131072998, mean p set: 0.4501332640647888
The modified gen p mean: 0.45147180557250977, gen p mean: -0.6200181245803833, mean p set: 0.45195209980010986
The modified gen p mean: 0.45214441418647766, gen p mean: -0.6263218522071838, mean p set: 0.45262470841407776
loss_pred:0.0296137984842062, decouple_loss:0.018967648968100548
loss_pred:0.028706584125757217, decouple_loss:0.01998194120824337
loss_pred:0.028582237660884857, decouple_loss:0.01881474256515503
Iteration: 1405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511868357658386, gen p mean: -0.625145673751831, mean p set: 0.4516671597957611
The modified gen p mean: 0.45187386870384216, gen p mean: -0.6298774480819702, mean p set: 0.4523541033267975
The modified gen p mean: 0.45065250992774963, gen p mean: -0.6308867335319519, mean p set: 0.45113280415534973
loss_pred:0.029902523383498192, decouple_loss:0.018465008586645126
loss_pred:0.028717266395688057, decouple_loss:0.01852278597652912
loss_pred:0.02762371301651001, decouple_loss:0.018696710467338562
Iteration: 1406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521077275276184, gen p mean: -0.6328760981559753, mean p set: 0.4525880217552185
The modified gen p mean: 0.4525482952594757, gen p mean: -0.628466010093689, mean p set: 0.4530285596847534
The modified gen p mean: 0.45162874460220337, gen p mean: -0.6330230236053467, mean p set: 0.45210903882980347
loss_pred:0.028174713253974915, decouple_loss:0.018171776086091995
loss_pred:0.028402263298630714, decouple_loss:0.018722156062722206
loss_pred:0.02888127602636814, decouple_loss:0.018391704186797142
Iteration: 1407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44893988966941833, gen p mean: -0.6340465545654297, mean p set: 0.44942015409469604
The modified gen p mean: 0.4494574964046478, gen p mean: -0.6326014399528503, mean p set: 0.4499378204345703
The modified gen p mean: 0.4533402919769287, gen p mean: -0.6301599144935608, mean p set: 0.4538205564022064
loss_pred:0.029145803302526474, decouple_loss:0.019389504566788673
loss_pred:0.02889685146510601, decouple_loss:0.01872723177075386
loss_pred:0.03015328198671341, decouple_loss:0.019545888528227806
Iteration: 1408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44916778802871704, gen p mean: -0.6311805844306946, mean p set: 0.44964808225631714
The modified gen p mean: 0.44795286655426025, gen p mean: -0.6349708437919617, mean p set: 0.44843316078186035
The modified gen p mean: 0.4536885619163513, gen p mean: -0.6262531280517578, mean p set: 0.4541688859462738
loss_pred:0.029751446098089218, decouple_loss:0.019095491617918015
loss_pred:0.029729969799518585, decouple_loss:0.018464772030711174
loss_pred:0.028266558423638344, decouple_loss:0.019255347549915314
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 1409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461469054222107, gen p mean: -0.6377686262130737, mean p set: 0.4466271698474884
The modified gen p mean: 0.4475928843021393, gen p mean: -0.6514714360237122, mean p set: 0.448073148727417
The modified gen p mean: 0.448574036359787, gen p mean: -0.6569201350212097, mean p set: 0.4490543007850647
loss_pred:0.03019122965633869, decouple_loss:0.022803759202361107
loss_pred:0.030537471175193787, decouple_loss:0.02451949380338192
loss_pred:0.030057772994041443, decouple_loss:0.021952612325549126
Iteration: 1410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473477303981781, gen p mean: -0.6633924841880798, mean p set: 0.4478280544281006
The modified gen p mean: 0.44647496938705444, gen p mean: -0.6557658910751343, mean p set: 0.44695523381233215
The modified gen p mean: 0.4452894926071167, gen p mean: -0.6518183946609497, mean p set: 0.4457697868347168
loss_pred:0.02903103455901146, decouple_loss:0.021993674337863922
loss_pred:0.02880948595702648, decouple_loss:0.02167927473783493
loss_pred:0.028681401163339615, decouple_loss:0.022462282329797745
2023-05-02 23:38:28 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.6553067564964294, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6480705738067627, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.643508791923523, mean p set: 0.45035696029663086
loss_pred:0.03041491098701954, decouple_loss:0.020177165046334267
loss_pred:0.029466211795806885, decouple_loss:0.020086217671632767
loss_pred:0.028843576088547707, decouple_loss:0.020387012511491776
WV_0_PC_1_EH_0_PS_40_6, loss: 0.030585739761590958, avg_mse: 0.03474138677120209
current test mse: 0.034741
Iteration: 1411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459937512874603, gen p mean: -0.6499329209327698, mean p set: 0.44647401571273804
loss_pred:0.030461527407169342, decouple_loss:0.02118019200861454
The modified gen p mean: 0.44582533836364746, gen p mean: -0.6536868810653687, mean p set: 0.44630563259124756
loss_pred:0.029249409213662148, decouple_loss:0.0209285169839859
The modified gen p mean: 0.4468235969543457, gen p mean: -0.6517107486724854, mean p set: 0.4473038911819458
loss_pred:0.028981687501072884, decouple_loss:0.02095368131995201
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474707841873169, gen p mean: -0.6414813995361328, mean p set: 0.447951078414917
The modified gen p mean: 0.4467659294605255, gen p mean: -0.6410305500030518, mean p set: 0.447246253490448
The modified gen p mean: 0.4478110074996948, gen p mean: -0.647131085395813, mean p set: 0.4482913017272949
loss_pred:0.029563037678599358, decouple_loss:0.02030055597424507
loss_pred:0.02930670604109764, decouple_loss:0.019572142511606216
loss_pred:0.029292281717061996, decouple_loss:0.02068263851106167
Iteration: 1413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44746023416519165, gen p mean: -0.6389103531837463, mean p set: 0.44794052839279175
The modified gen p mean: 0.44810670614242554, gen p mean: -0.6498602032661438, mean p set: 0.44858697056770325
The modified gen p mean: 0.44609498977661133, gen p mean: -0.6439322829246521, mean p set: 0.4465752840042114
loss_pred:0.02858073078095913, decouple_loss:0.020553121343255043
loss_pred:0.029240000993013382, decouple_loss:0.020193854346871376
loss_pred:0.029989248141646385, decouple_loss:0.019903698936104774
Iteration: 1414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472138285636902, gen p mean: -0.6444708704948425, mean p set: 0.4476941227912903
The modified gen p mean: 0.44662079215049744, gen p mean: -0.651828408241272, mean p set: 0.4471011161804199
The modified gen p mean: 0.4463035464286804, gen p mean: -0.6407337188720703, mean p set: 0.4467838406562805
loss_pred:0.03014838509261608, decouple_loss:0.02053751051425934
loss_pred:0.029282154515385628, decouple_loss:0.020249532535672188
loss_pred:0.029249943792819977, decouple_loss:0.01935766637325287
Iteration: 1415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44620752334594727, gen p mean: -0.6472208499908447, mean p set: 0.44668781757354736
The modified gen p mean: 0.4481782019138336, gen p mean: -0.6535114049911499, mean p set: 0.4486584961414337
The modified gen p mean: 0.4462599754333496, gen p mean: -0.6495492458343506, mean p set: 0.4467402696609497
loss_pred:0.030329739674925804, decouple_loss:0.020100535824894905
loss_pred:0.028956033289432526, decouple_loss:0.019935306161642075
loss_pred:0.030219893902540207, decouple_loss:0.01943584717810154
Iteration: 1416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468763768672943, gen p mean: -0.6495910882949829, mean p set: 0.4473566710948944
The modified gen p mean: 0.44627127051353455, gen p mean: -0.6495112776756287, mean p set: 0.44675159454345703
The modified gen p mean: 0.44883668422698975, gen p mean: -0.6581727266311646, mean p set: 0.44931700825691223
loss_pred:0.029134633019566536, decouple_loss:0.019474323838949203
loss_pred:0.02921869233250618, decouple_loss:0.019393006339669228
loss_pred:0.02894277125597, decouple_loss:0.021289046853780746
Iteration: 1417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459315240383148, gen p mean: -0.6393789052963257, mean p set: 0.4464118480682373
The modified gen p mean: 0.44760069251060486, gen p mean: -0.6412094235420227, mean p set: 0.44808098673820496
The modified gen p mean: 0.4474453032016754, gen p mean: -0.6424421072006226, mean p set: 0.4479255974292755
loss_pred:0.029975874349474907, decouple_loss:0.018583813682198524
loss_pred:0.02949068695306778, decouple_loss:0.019247666001319885
loss_pred:0.030177708715200424, decouple_loss:0.019240355119109154
Iteration: 1418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483022391796112, gen p mean: -0.6449933052062988, mean p set: 0.4487825632095337
The modified gen p mean: 0.44525769352912903, gen p mean: -0.6409286856651306, mean p set: 0.44573795795440674
The modified gen p mean: 0.44664016366004944, gen p mean: -0.6392773389816284, mean p set: 0.44712045788764954
loss_pred:0.029108455404639244, decouple_loss:0.020782873034477234
loss_pred:0.028879443183541298, decouple_loss:0.020108675584197044
loss_pred:0.028920872136950493, decouple_loss:0.019632896408438683
Iteration: 1419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460310637950897, gen p mean: -0.64085453748703, mean p set: 0.44651132822036743
The modified gen p mean: 0.44625359773635864, gen p mean: -0.640097439289093, mean p set: 0.44673389196395874
The modified gen p mean: 0.4464486539363861, gen p mean: -0.6479504704475403, mean p set: 0.4469289183616638
loss_pred:0.03008996695280075, decouple_loss:0.018149156123399734
loss_pred:0.029361354187130928, decouple_loss:0.01923810876905918
loss_pred:0.028424879536032677, decouple_loss:0.019075941294431686
Iteration: 1420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472636878490448, gen p mean: -0.6400318145751953, mean p set: 0.4477439522743225
The modified gen p mean: 0.4467123746871948, gen p mean: -0.6359057426452637, mean p set: 0.4471926689147949
The modified gen p mean: 0.445679634809494, gen p mean: -0.640635073184967, mean p set: 0.4461599588394165
loss_pred:0.029075661674141884, decouple_loss:0.019658755511045456
loss_pred:0.030095050111413002, decouple_loss:0.019614743068814278
loss_pred:0.029019247740507126, decouple_loss:0.019306186586618423
2023-05-02 23:42:08 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6322855949401855, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.638755738735199, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6278514862060547, mean p set: 0.45035696029663086
loss_pred:0.02928381785750389, decouple_loss:0.019002661108970642
loss_pred:0.030160460621118546, decouple_loss:0.01931913197040558
loss_pred:0.028813906013965607, decouple_loss:0.01979617215692997
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03038802742958069, avg_mse: 0.034570347517728806
current test mse: 0.03457
Iteration: 1421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468863010406494, gen p mean: -0.6367430090904236, mean p set: 0.4473665952682495
loss_pred:0.029470816254615784, decouple_loss:0.01848645694553852
The modified gen p mean: 0.44641295075416565, gen p mean: -0.6379781365394592, mean p set: 0.44689324498176575
loss_pred:0.030650433152914047, decouple_loss:0.01817169412970543
The modified gen p mean: 0.4466908872127533, gen p mean: -0.6415439248085022, mean p set: 0.4471711814403534
loss_pred:0.02929816208779812, decouple_loss:0.01871904544532299
Iteration: 1422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44667911529541016, gen p mean: -0.628284215927124, mean p set: 0.44715940952301025
The modified gen p mean: 0.44859594106674194, gen p mean: -0.6479290127754211, mean p set: 0.44907623529434204
The modified gen p mean: 0.44577547907829285, gen p mean: -0.6279943585395813, mean p set: 0.44625577330589294
loss_pred:0.02949974313378334, decouple_loss:0.018543260172009468
loss_pred:0.030169323086738586, decouple_loss:0.021213926374912262
loss_pred:0.030110692605376244, decouple_loss:0.01863536797463894
Iteration: 1423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44739651679992676, gen p mean: -0.6323903203010559, mean p set: 0.44787678122520447
The modified gen p mean: 0.44710493087768555, gen p mean: -0.6340997219085693, mean p set: 0.44758522510528564
The modified gen p mean: 0.44568493962287903, gen p mean: -0.6344115734100342, mean p set: 0.4461652636528015
loss_pred:0.029816314578056335, decouple_loss:0.019187239930033684
loss_pred:0.02916974574327469, decouple_loss:0.019002893939614296
loss_pred:0.02953137829899788, decouple_loss:0.018705496564507484
Iteration: 1424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473292827606201, gen p mean: -0.6366608738899231, mean p set: 0.4478095471858978
The modified gen p mean: 0.4479667842388153, gen p mean: -0.6445104479789734, mean p set: 0.4484470784664154
The modified gen p mean: 0.44646894931793213, gen p mean: -0.6442697048187256, mean p set: 0.44694921374320984
loss_pred:0.028615465387701988, decouple_loss:0.01902765780687332
loss_pred:0.028803568333387375, decouple_loss:0.018231898546218872
loss_pred:0.02900332398712635, decouple_loss:0.018158797174692154
Iteration: 1425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879674911499023, gen p mean: -0.6485711932182312, mean p set: 0.44927704334259033
The modified gen p mean: 0.44904762506484985, gen p mean: -0.6472798585891724, mean p set: 0.44952791929244995
The modified gen p mean: 0.44677528738975525, gen p mean: -0.6391001343727112, mean p set: 0.44725558161735535
loss_pred:0.029027409851551056, decouple_loss:0.019817017018795013
loss_pred:0.028762061148881912, decouple_loss:0.019784195348620415
loss_pred:0.02910367026925087, decouple_loss:0.018135828897356987
Iteration: 1426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751569628715515, gen p mean: -0.6315048933029175, mean p set: 0.44799599051475525
The modified gen p mean: 0.44704753160476685, gen p mean: -0.6373969912528992, mean p set: 0.44752782583236694
The modified gen p mean: 0.44582653045654297, gen p mean: -0.6325863599777222, mean p set: 0.44630685448646545
loss_pred:0.028352418914437294, decouple_loss:0.01816174015402794
loss_pred:0.03010205365717411, decouple_loss:0.017613254487514496
loss_pred:0.029830724000930786, decouple_loss:0.018885353580117226
Iteration: 1427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44734594225883484, gen p mean: -0.636694073677063, mean p set: 0.44782623648643494
The modified gen p mean: 0.4469195306301117, gen p mean: -0.6375243067741394, mean p set: 0.4473998546600342
The modified gen p mean: 0.44885823130607605, gen p mean: -0.6489098072052002, mean p set: 0.44933852553367615
loss_pred:0.028948193415999413, decouple_loss:0.01804366149008274
loss_pred:0.02924155630171299, decouple_loss:0.017883194610476494
loss_pred:0.02977992594242096, decouple_loss:0.01889464072883129
Iteration: 1428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463250935077667, gen p mean: -0.6365207433700562, mean p set: 0.44680535793304443
The modified gen p mean: 0.44817230105400085, gen p mean: -0.6464201807975769, mean p set: 0.44865259528160095
The modified gen p mean: 0.44820311665534973, gen p mean: -0.6436803340911865, mean p set: 0.44868341088294983
loss_pred:0.028689054772257805, decouple_loss:0.017941119149327278
loss_pred:0.02834770642220974, decouple_loss:0.018646160140633583
loss_pred:0.0286627896130085, decouple_loss:0.018862228840589523
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
NaN value num: 0
Iteration: 1429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45276185870170593, gen p mean: -0.6274369359016418, mean p set: 0.45324212312698364
The modified gen p mean: 0.4507342576980591, gen p mean: -0.6367210745811462, mean p set: 0.4512145519256592
The modified gen p mean: 0.4500288963317871, gen p mean: -0.6304575204849243, mean p set: 0.4505091905593872
loss_pred:0.02918514423072338, decouple_loss:0.022000977769494057
loss_pred:0.02975608967244625, decouple_loss:0.02237367071211338
loss_pred:0.02727326937019825, decouple_loss:0.0226583369076252
Iteration: 1430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45394575595855713, gen p mean: -0.6318928599357605, mean p set: 0.4544260501861572
The modified gen p mean: 0.45113781094551086, gen p mean: -0.6453697085380554, mean p set: 0.4516180753707886
The modified gen p mean: 0.45268043875694275, gen p mean: -0.6322777271270752, mean p set: 0.45316070318222046
loss_pred:0.0287781972438097, decouple_loss:0.020832888782024384
loss_pred:0.028056947514414787, decouple_loss:0.022075090557336807
loss_pred:0.027782276272773743, decouple_loss:0.02198903076350689
2023-05-02 23:46:31 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6280516982078552, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.634843647480011, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6236443519592285, mean p set: 0.45035696029663086
loss_pred:0.02918436750769615, decouple_loss:0.019768977537751198
loss_pred:0.030190231278538704, decouple_loss:0.019769061356782913
loss_pred:0.028887063264846802, decouple_loss:0.02039501629769802
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03041943907737732, avg_mse: 0.03458169475197792
current test mse: 0.034582
Iteration: 1431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516836702823639, gen p mean: -0.6251661777496338, mean p set: 0.4521639347076416
The modified gen p mean: 0.45232534408569336, gen p mean: -0.635553240776062, mean p set: 0.45280560851097107
loss_pred:0.02859814278781414, decouple_loss:0.02105443924665451
loss_pred:0.027619702741503716, decouple_loss:0.0206062663346529
The modified gen p mean: 0.45280054211616516, gen p mean: -0.6271237134933472, mean p set: 0.45328083634376526
loss_pred:0.028108341619372368, decouple_loss:0.020012442022562027
Iteration: 1432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509032368659973, gen p mean: -0.6384955644607544, mean p set: 0.4513835310935974
The modified gen p mean: 0.4516717791557312, gen p mean: -0.633695125579834, mean p set: 0.4521520435810089
The modified gen p mean: 0.4506045877933502, gen p mean: -0.6350017786026001, mean p set: 0.45108485221862793
loss_pred:0.02832632139325142, decouple_loss:0.019864249974489212
loss_pred:0.02782510221004486, decouple_loss:0.0202175360172987
loss_pred:0.028145235031843185, decouple_loss:0.02027427777647972
Iteration: 1433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522540867328644, gen p mean: -0.6218239068984985, mean p set: 0.4527343511581421
The modified gen p mean: 0.450872540473938, gen p mean: -0.6293160915374756, mean p set: 0.4513528347015381
The modified gen p mean: 0.4535921514034271, gen p mean: -0.6307327747344971, mean p set: 0.4540724456310272
loss_pred:0.027634676545858383, decouple_loss:0.02089276909828186
loss_pred:0.029541196301579475, decouple_loss:0.020292174071073532
loss_pred:0.028430329635739326, decouple_loss:0.0194618571549654
Iteration: 1434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526134431362152, gen p mean: -0.6316647529602051, mean p set: 0.4530937969684601
The modified gen p mean: 0.451174795627594, gen p mean: -0.6422826051712036, mean p set: 0.4516550898551941
The modified gen p mean: 0.4528537690639496, gen p mean: -0.6330042481422424, mean p set: 0.4533340632915497
loss_pred:0.028052279725670815, decouple_loss:0.020362714305520058
loss_pred:0.02844974212348461, decouple_loss:0.019840240478515625
loss_pred:0.028218630701303482, decouple_loss:0.018825946375727654
Iteration: 1435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45209187269210815, gen p mean: -0.6290872097015381, mean p set: 0.45257216691970825
The modified gen p mean: 0.4516910910606384, gen p mean: -0.6484959125518799, mean p set: 0.4521713852882385
The modified gen p mean: 0.4496479630470276, gen p mean: -0.626786470413208, mean p set: 0.4501282274723053
loss_pred:0.027960799634456635, decouple_loss:0.019987447187304497
loss_pred:0.027710342779755592, decouple_loss:0.019818637520074844
loss_pred:0.02924349717795849, decouple_loss:0.020491642877459526
Iteration: 1436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515306353569031, gen p mean: -0.6532099843025208, mean p set: 0.4520109295845032
The modified gen p mean: 0.4520549774169922, gen p mean: -0.6377114653587341, mean p set: 0.4525352716445923
The modified gen p mean: 0.4519517719745636, gen p mean: -0.6310863494873047, mean p set: 0.4524320662021637
loss_pred:0.02782656066119671, decouple_loss:0.020123565569519997
loss_pred:0.029394082725048065, decouple_loss:0.01993120089173317
loss_pred:0.027764838188886642, decouple_loss:0.0195483211427927
Iteration: 1437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514251947402954, gen p mean: -0.6358460187911987, mean p set: 0.4519054889678955
The modified gen p mean: 0.4501611590385437, gen p mean: -0.6381680965423584, mean p set: 0.4506414532661438
The modified gen p mean: 0.4532754719257355, gen p mean: -0.6373795866966248, mean p set: 0.45375576615333557
loss_pred:0.027724968269467354, decouple_loss:0.019831685349345207
loss_pred:0.028291363269090652, decouple_loss:0.02003338187932968
loss_pred:0.027502281591296196, decouple_loss:0.01927567832171917
Iteration: 1438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519859254360199, gen p mean: -0.6472681760787964, mean p set: 0.45246621966362
The modified gen p mean: 0.44926100969314575, gen p mean: -0.6451787948608398, mean p set: 0.44974127411842346
The modified gen p mean: 0.450425922870636, gen p mean: -0.6483502984046936, mean p set: 0.4509062170982361
loss_pred:0.026977375149726868, decouple_loss:0.0189712792634964
loss_pred:0.028128787875175476, decouple_loss:0.01943133771419525
loss_pred:0.028680426999926567, decouple_loss:0.01917211338877678
Iteration: 1439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495428800582886, gen p mean: -0.6452982425689697, mean p set: 0.4500231444835663
The modified gen p mean: 0.44949814677238464, gen p mean: -0.654191255569458, mean p set: 0.44997847080230713
The modified gen p mean: 0.45258569717407227, gen p mean: -0.6393268704414368, mean p set: 0.45306602120399475
loss_pred:0.029303038492798805, decouple_loss:0.01906099170446396
loss_pred:0.028527110815048218, decouple_loss:0.01900242082774639
loss_pred:0.02809111401438713, decouple_loss:0.019202876836061478
Iteration: 1440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45255064964294434, gen p mean: -0.6425164341926575, mean p set: 0.4530309736728668
The modified gen p mean: 0.4524647891521454, gen p mean: -0.6506272554397583, mean p set: 0.45294511318206787
loss_pred:0.02808133140206337, decouple_loss:0.019731944426894188
The modified gen p mean: 0.45259106159210205, gen p mean: -0.6536026000976562, mean p set: 0.4530712962150574
loss_pred:0.026614977046847343, decouple_loss:0.019183099269866943
loss_pred:0.02687988616526127, decouple_loss:0.019127126783132553
2023-05-02 23:50:11 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6531274318695068, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.660122275352478, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.648604691028595, mean p set: 0.45035696029663086
loss_pred:0.029232075437903404, decouple_loss:0.020660849288105965
loss_pred:0.03031032532453537, decouple_loss:0.021280156448483467
loss_pred:0.02880866453051567, decouple_loss:0.021138448268175125
WV_0_PC_1_EH_0_PS_40_6, loss: 0.030501678586006165, avg_mse: 0.03471957519650459
current test mse: 0.03472
Iteration: 1441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510084390640259, gen p mean: -0.6544324159622192, mean p set: 0.45148876309394836
The modified gen p mean: 0.45212826132774353, gen p mean: -0.6645472049713135, mean p set: 0.45260855555534363
loss_pred:0.028414832428097725, decouple_loss:0.01909959688782692
loss_pred:0.027640309184789658, decouple_loss:0.01953849382698536
The modified gen p mean: 0.45247066020965576, gen p mean: -0.6425656676292419, mean p set: 0.45295095443725586
loss_pred:0.027246110141277313, decouple_loss:0.01973097026348114
Iteration: 1442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45114395022392273, gen p mean: -0.6487919092178345, mean p set: 0.4516242742538452
The modified gen p mean: 0.45263397693634033, gen p mean: -0.6331281661987305, mean p set: 0.45311427116394043
The modified gen p mean: 0.4513115882873535, gen p mean: -0.6434659361839294, mean p set: 0.4517918825149536
loss_pred:0.028055384755134583, decouple_loss:0.019232112914323807
loss_pred:0.027346976101398468, decouple_loss:0.019236046820878983
loss_pred:0.027863219380378723, decouple_loss:0.018712608143687248
Iteration: 1443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45269447565078735, gen p mean: -0.6458340883255005, mean p set: 0.45317476987838745
The modified gen p mean: 0.4503200948238373, gen p mean: -0.6355974674224854, mean p set: 0.45080041885375977
The modified gen p mean: 0.4509732723236084, gen p mean: -0.6453215479850769, mean p set: 0.4514535665512085
loss_pred:0.027419747784733772, decouple_loss:0.019122224301099777
loss_pred:0.028697500005364418, decouple_loss:0.019246168434619904
loss_pred:0.027991389855742455, decouple_loss:0.01815510354936123
Iteration: 1444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500044584274292, gen p mean: -0.6515454053878784, mean p set: 0.4504847228527069
The modified gen p mean: 0.45118024945259094, gen p mean: -0.6478995084762573, mean p set: 0.45166051387786865
The modified gen p mean: 0.45123565196990967, gen p mean: -0.6445066928863525, mean p set: 0.4517159163951874
loss_pred:0.02817682921886444, decouple_loss:0.01882854849100113
loss_pred:0.02752261981368065, decouple_loss:0.018637368455529213
loss_pred:0.029323546215891838, decouple_loss:0.019579779356718063
Iteration: 1445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44975900650024414, gen p mean: -0.6520770788192749, mean p set: 0.45023927092552185
The modified gen p mean: 0.45129072666168213, gen p mean: -0.6389797329902649, mean p set: 0.45177099108695984
The modified gen p mean: 0.4508156180381775, gen p mean: -0.6601337194442749, mean p set: 0.4512959122657776
loss_pred:0.028729848563671112, decouple_loss:0.018755897879600525
loss_pred:0.027779802680015564, decouple_loss:0.019160298630595207
loss_pred:0.027177389711141586, decouple_loss:0.01920676976442337
Iteration: 1446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45326367020606995, gen p mean: -0.6476141214370728, mean p set: 0.45374393463134766
The modified gen p mean: 0.45117953419685364, gen p mean: -0.6472942233085632, mean p set: 0.45165982842445374
The modified gen p mean: 0.4517531096935272, gen p mean: -0.6430705785751343, mean p set: 0.4522334337234497
loss_pred:0.02746056206524372, decouple_loss:0.01826920174062252
loss_pred:0.028266577050089836, decouple_loss:0.018118802458047867
loss_pred:0.027896001935005188, decouple_loss:0.018597915768623352
Iteration: 1447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45204970240592957, gen p mean: -0.6430906653404236, mean p set: 0.45252999663352966
The modified gen p mean: 0.455077588558197, gen p mean: -0.6474698185920715, mean p set: 0.4555578827857971
The modified gen p mean: 0.45206841826438904, gen p mean: -0.6474721431732178, mean p set: 0.45254871249198914
loss_pred:0.027471452951431274, decouple_loss:0.018376491963863373
loss_pred:0.028658835217356682, decouple_loss:0.018284140154719353
loss_pred:0.028677256777882576, decouple_loss:0.017557278275489807
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
NaN value num: 0
Iteration: 1448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45023342967033386, gen p mean: -0.638020932674408, mean p set: 0.45071372389793396
The modified gen p mean: 0.45069873332977295, gen p mean: -0.6421515345573425, mean p set: 0.45117899775505066
The modified gen p mean: 0.44963744282722473, gen p mean: -0.6403968930244446, mean p set: 0.45011773705482483
loss_pred:0.028822386637330055, decouple_loss:0.01868578977882862
loss_pred:0.030460001900792122, decouple_loss:0.019978612661361694
loss_pred:0.02874019555747509, decouple_loss:0.01950506679713726
Iteration: 1449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508685767650604, gen p mean: -0.643073558807373, mean p set: 0.4513488709926605
The modified gen p mean: 0.45175960659980774, gen p mean: -0.6447687745094299, mean p set: 0.45223987102508545
The modified gen p mean: 0.44825175404548645, gen p mean: -0.636866569519043, mean p set: 0.44873207807540894
loss_pred:0.02921024151146412, decouple_loss:0.018645545467734337
loss_pred:0.028106937184929848, decouple_loss:0.019722748547792435
loss_pred:0.029131336137652397, decouple_loss:0.020118888467550278
Iteration: 1450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494656026363373, gen p mean: -0.6504600644111633, mean p set: 0.4499458968639374
The modified gen p mean: 0.44838154315948486, gen p mean: -0.6539441347122192, mean p set: 0.44886186718940735
The modified gen p mean: 0.452470064163208, gen p mean: -0.6565223932266235, mean p set: 0.4529503583908081
loss_pred:0.030068008229136467, decouple_loss:0.018683675676584244
loss_pred:0.029904767870903015, decouple_loss:0.01933673955500126
loss_pred:0.029585817828774452, decouple_loss:0.018195055425167084
2023-05-02 23:54:32 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6586956977844238, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.6656847596168518, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6539397835731506, mean p set: 0.45035696029663086
loss_pred:0.029255447909235954, decouple_loss:0.020839344710111618
loss_pred:0.03033602237701416, decouple_loss:0.02127954736351967
loss_pred:0.0287674218416214, decouple_loss:0.02092490904033184
WV_0_PC_1_EH_0_PS_40_6, loss: 0.030503693968057632, avg_mse: 0.03478504717350006
current test mse: 0.034785
Iteration: 1451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506288170814514, gen p mean: -0.6569535732269287, mean p set: 0.4511091411113739
loss_pred:0.028831511735916138, decouple_loss:0.019069837406277657
The modified gen p mean: 0.4487544596195221, gen p mean: -0.6537358164787292, mean p set: 0.4492347836494446
loss_pred:0.029092462733387947, decouple_loss:0.018941691145300865
The modified gen p mean: 0.448906809091568, gen p mean: -0.6603510975837708, mean p set: 0.4493871033191681
loss_pred:0.029537858441472054, decouple_loss:0.019036471843719482
Iteration: 1452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513009190559387, gen p mean: -0.6533793210983276, mean p set: 0.4517812132835388
The modified gen p mean: 0.4484897255897522, gen p mean: -0.6498557925224304, mean p set: 0.4489700198173523
The modified gen p mean: 0.4494486451148987, gen p mean: -0.6562854647636414, mean p set: 0.4499289393424988
loss_pred:0.0294170081615448, decouple_loss:0.018261820077896118
loss_pred:0.0295003242790699, decouple_loss:0.01904274895787239
loss_pred:0.029452694579958916, decouple_loss:0.018682045862078667
Iteration: 1453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509003162384033, gen p mean: -0.6632413268089294, mean p set: 0.4513806104660034
The modified gen p mean: 0.4494289457798004, gen p mean: -0.6576928496360779, mean p set: 0.4499092102050781
The modified gen p mean: 0.4510181248188019, gen p mean: -0.6559452414512634, mean p set: 0.45149844884872437
loss_pred:0.02829796075820923, decouple_loss:0.018307365477085114
loss_pred:0.028395934030413628, decouple_loss:0.018341053277254105
loss_pred:0.028841232880949974, decouple_loss:0.01824292726814747
Iteration: 1454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490962624549866, gen p mean: -0.6571085453033447, mean p set: 0.4495765268802643
The modified gen p mean: 0.449733167886734, gen p mean: -0.6601251363754272, mean p set: 0.4502134323120117
The modified gen p mean: 0.44969624280929565, gen p mean: -0.6505084037780762, mean p set: 0.45017653703689575
loss_pred:0.029684873297810555, decouple_loss:0.018258322030305862
loss_pred:0.02868787571787834, decouple_loss:0.017782483249902725
loss_pred:0.02984958328306675, decouple_loss:0.01873786374926567
Iteration: 1455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44966378808021545, gen p mean: -0.6434333920478821, mean p set: 0.45014408230781555
The modified gen p mean: 0.45149093866348267, gen p mean: -0.6563986539840698, mean p set: 0.45197123289108276
The modified gen p mean: 0.4486936330795288, gen p mean: -0.6522311568260193, mean p set: 0.4491738975048065
loss_pred:0.030471274629235268, decouple_loss:0.018670959398150444
loss_pred:0.030309781432151794, decouple_loss:0.01805584505200386
loss_pred:0.031130628660321236, decouple_loss:0.01840878464281559
Iteration: 1456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495541751384735, gen p mean: -0.6525477766990662, mean p set: 0.4500344693660736
The modified gen p mean: 0.44812560081481934, gen p mean: -0.6587638854980469, mean p set: 0.44860586524009705
The modified gen p mean: 0.44875380396842957, gen p mean: -0.6550012826919556, mean p set: 0.4492340683937073
loss_pred:0.03013841062784195, decouple_loss:0.01816433295607567
loss_pred:0.030503029003739357, decouple_loss:0.018557585775852203
loss_pred:0.030654650181531906, decouple_loss:0.01837184838950634
Iteration: 1457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484437108039856, gen p mean: -0.6432362794876099, mean p set: 0.4489240050315857
The modified gen p mean: 0.45051509141921997, gen p mean: -0.6528133749961853, mean p set: 0.45099538564682007
The modified gen p mean: 0.4518488347530365, gen p mean: -0.6586018204689026, mean p set: 0.4523291289806366
loss_pred:0.02930840477347374, decouple_loss:0.018566986545920372
loss_pred:0.02824564091861248, decouple_loss:0.018584327772259712
loss_pred:0.028516849502921104, decouple_loss:0.01772686280310154
Iteration: 1458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490300416946411, gen p mean: -0.6374871730804443, mean p set: 0.4495103359222412
The modified gen p mean: 0.44814273715019226, gen p mean: -0.656524121761322, mean p set: 0.44862303137779236
The modified gen p mean: 0.44990232586860657, gen p mean: -0.6434568762779236, mean p set: 0.45038262009620667
loss_pred:0.030815070495009422, decouple_loss:0.018066389486193657
loss_pred:0.029228826984763145, decouple_loss:0.01849924959242344
loss_pred:0.029167672619223595, decouple_loss:0.01815279759466648
Iteration: 1459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494033455848694, gen p mean: -0.6441757082939148, mean p set: 0.4498836100101471
The modified gen p mean: 0.44900038838386536, gen p mean: -0.6548479795455933, mean p set: 0.44948065280914307
The modified gen p mean: 0.4500284194946289, gen p mean: -0.6499850749969482, mean p set: 0.450508713722229
loss_pred:0.029899662360548973, decouple_loss:0.017629314213991165
loss_pred:0.029720602557063103, decouple_loss:0.017978107556700706
loss_pred:0.027496326714754105, decouple_loss:0.017531342804431915
Iteration: 1460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502730369567871, gen p mean: -0.6461535692214966, mean p set: 0.4507533609867096
The modified gen p mean: 0.45019152760505676, gen p mean: -0.6513660550117493, mean p set: 0.45067182183265686
The modified gen p mean: 0.4501833915710449, gen p mean: -0.6481266617774963, mean p set: 0.450663685798645
loss_pred:0.02842077985405922, decouple_loss:0.017308048903942108
loss_pred:0.02832796797156334, decouple_loss:0.018188336864113808
loss_pred:0.027977854013442993, decouple_loss:0.017104849219322205
2023-05-02 23:58:12 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6560484170913696, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6485974788665771, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6441988945007324, mean p set: 0.45035696029663086
loss_pred:0.03021337278187275, decouple_loss:0.021355995908379555
loss_pred:0.02922065742313862, decouple_loss:0.020880840718746185
loss_pred:0.028794139623641968, decouple_loss:0.020857997238636017
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03046097233891487, avg_mse: 0.0347432903945446
current test mse: 0.034743
Iteration: 1461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483394920825958, gen p mean: -0.6439675688743591, mean p set: 0.4488198161125183
loss_pred:0.031097153201699257, decouple_loss:0.017946185544133186
The modified gen p mean: 0.449812114238739, gen p mean: -0.6452465653419495, mean p set: 0.4502924084663391
loss_pred:0.02845923975110054, decouple_loss:0.017769701778888702
The modified gen p mean: 0.4493236243724823, gen p mean: -0.6438960433006287, mean p set: 0.4498039484024048
loss_pred:0.02954396791756153, decouple_loss:0.017966151237487793
Iteration: 1462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44902458786964417, gen p mean: -0.6432380676269531, mean p set: 0.4495048522949219
The modified gen p mean: 0.44897106289863586, gen p mean: -0.6490746140480042, mean p set: 0.4494513273239136
The modified gen p mean: 0.4490131437778473, gen p mean: -0.6516678929328918, mean p set: 0.4494934380054474
loss_pred:0.03026294894516468, decouple_loss:0.017468905076384544
loss_pred:0.030151331797242165, decouple_loss:0.01816401071846485
loss_pred:0.028706619516015053, decouple_loss:0.017826808616518974
Iteration: 1463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490867555141449, gen p mean: -0.6502910852432251, mean p set: 0.449567049741745
The modified gen p mean: 0.4482707679271698, gen p mean: -0.6565902233123779, mean p set: 0.4487510621547699
The modified gen p mean: 0.44933462142944336, gen p mean: -0.6517267823219299, mean p set: 0.44981491565704346
loss_pred:0.030162978917360306, decouple_loss:0.01795005425810814
loss_pred:0.029823653399944305, decouple_loss:0.01804082654416561
loss_pred:0.030221782624721527, decouple_loss:0.017951343208551407
Iteration: 1464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44789403676986694, gen p mean: -0.6573315858840942, mean p set: 0.44837433099746704
The modified gen p mean: 0.45081618428230286, gen p mean: -0.6465513110160828, mean p set: 0.45129647850990295
The modified gen p mean: 0.44875484704971313, gen p mean: -0.6410924196243286, mean p set: 0.44923514127731323
loss_pred:0.02964782528579235, decouple_loss:0.018010301515460014
loss_pred:0.0288701169192791, decouple_loss:0.017921190708875656
loss_pred:0.030364735051989555, decouple_loss:0.01796765998005867
Iteration: 1465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45186716318130493, gen p mean: -0.6490821838378906, mean p set: 0.45234742760658264
The modified gen p mean: 0.44906073808670044, gen p mean: -0.6511700749397278, mean p set: 0.44954103231430054
The modified gen p mean: 0.4523509442806244, gen p mean: -0.6487265825271606, mean p set: 0.4528312385082245
loss_pred:0.027870507910847664, decouple_loss:0.01786479540169239
loss_pred:0.028958721086382866, decouple_loss:0.018001651391386986
loss_pred:0.027662502601742744, decouple_loss:0.01819952018558979
Iteration: 1466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497763216495514, gen p mean: -0.6492162346839905, mean p set: 0.4502566158771515
The modified gen p mean: 0.450116902589798, gen p mean: -0.6529927253723145, mean p set: 0.45059719681739807
The modified gen p mean: 0.4476169943809509, gen p mean: -0.6571256518363953, mean p set: 0.44809725880622864
loss_pred:0.029564619064331055, decouple_loss:0.01727634109556675
loss_pred:0.02793954871594906, decouple_loss:0.01773037016391754
loss_pred:0.029255686327815056, decouple_loss:0.017625128850340843
Iteration: 1467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489809572696686, gen p mean: -0.6480368375778198, mean p set: 0.4494612514972687
The modified gen p mean: 0.448974609375, gen p mean: -0.6509043574333191, mean p set: 0.4494549334049225
loss_pred:0.029564550146460533, decouple_loss:0.017722629010677338
The modified gen p mean: 0.4522463381290436, gen p mean: -0.6504220962524414, mean p set: 0.4527266025543213
loss_pred:0.02961547113955021, decouple_loss:0.017424698919057846
loss_pred:0.029482204467058182, decouple_loss:0.01789535954594612
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 1468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477875232696533, gen p mean: -0.6573156118392944, mean p set: 0.4482678174972534
The modified gen p mean: 0.44791844487190247, gen p mean: -0.6560710072517395, mean p set: 0.44839873909950256
The modified gen p mean: 0.44733431935310364, gen p mean: -0.6544138789176941, mean p set: 0.44781461358070374
loss_pred:0.030135605484247208, decouple_loss:0.02059103548526764
loss_pred:0.03011052869260311, decouple_loss:0.02076984941959381
loss_pred:0.02925337664783001, decouple_loss:0.020611926913261414
Iteration: 1469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479690492153168, gen p mean: -0.6557822823524475, mean p set: 0.4484493136405945
The modified gen p mean: 0.44800901412963867, gen p mean: -0.6540858149528503, mean p set: 0.44848933815956116
The modified gen p mean: 0.44676509499549866, gen p mean: -0.6567881107330322, mean p set: 0.44724538922309875
loss_pred:0.0286245234310627, decouple_loss:0.01985684037208557
loss_pred:0.02829357236623764, decouple_loss:0.019765792414546013
loss_pred:0.02997666783630848, decouple_loss:0.019536690786480904
Iteration: 1470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44657102227211, gen p mean: -0.6472153663635254, mean p set: 0.4470512866973877
The modified gen p mean: 0.44783008098602295, gen p mean: -0.6543684601783752, mean p set: 0.44831034541130066
The modified gen p mean: 0.44616711139678955, gen p mean: -0.6453471183776855, mean p set: 0.44664737582206726
loss_pred:0.030152667313814163, decouple_loss:0.018386514857411385
loss_pred:0.030084077268838882, decouple_loss:0.01915017142891884
loss_pred:0.030027691274881363, decouple_loss:0.018572181463241577
2023-05-03 00:02:40 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6399604678153992, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.6471595764160156, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6351985335350037, mean p set: 0.45035696029663086
loss_pred:0.02900347299873829, decouple_loss:0.019433867186307907
loss_pred:0.02987605705857277, decouple_loss:0.0196552574634552
loss_pred:0.02851637452840805, decouple_loss:0.01961859129369259
WV_0_PC_1_EH_0_PS_40_6, loss: 0.03011043183505535, avg_mse: 0.034268107265233994
current test mse: 0.034268
Iteration: 1471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479132294654846, gen p mean: -0.639438271522522, mean p set: 0.4483935534954071
loss_pred:0.028295373544096947, decouple_loss:0.01913559064269066
The modified gen p mean: 0.448091596364975, gen p mean: -0.6355873942375183, mean p set: 0.44857192039489746
loss_pred:0.03008352965116501, decouple_loss:0.018453270196914673
The modified gen p mean: 0.4477509558200836, gen p mean: -0.6362102627754211, mean p set: 0.44823122024536133
loss_pred:0.029677141457796097, decouple_loss:0.018877258524298668
Iteration: 1472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797733426094055, gen p mean: -0.6327646970748901, mean p set: 0.44845762848854065
The modified gen p mean: 0.44715163111686707, gen p mean: -0.6343346834182739, mean p set: 0.4476318955421448
The modified gen p mean: 0.44762372970581055, gen p mean: -0.6413241028785706, mean p set: 0.44810402393341064
loss_pred:0.027885515242815018, decouple_loss:0.018952403217554092
loss_pred:0.030099881812930107, decouple_loss:0.018735066056251526
loss_pred:0.02812355011701584, decouple_loss:0.01893298141658306
Iteration: 1473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473022222518921, gen p mean: -0.6435890197753906, mean p set: 0.4477825164794922
The modified gen p mean: 0.44890785217285156, gen p mean: -0.6411063075065613, mean p set: 0.44938814640045166
The modified gen p mean: 0.447857141494751, gen p mean: -0.6470704674720764, mean p set: 0.4483374059200287
loss_pred:0.029419327154755592, decouple_loss:0.0187818743288517
loss_pred:0.029902523383498192, decouple_loss:0.018356435000896454
loss_pred:0.027983957901597023, decouple_loss:0.01825106516480446
Iteration: 1474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478135406970978, gen p mean: -0.6413102746009827, mean p set: 0.4482938349246979
The modified gen p mean: 0.44822442531585693, gen p mean: -0.6377020478248596, mean p set: 0.44870471954345703
The modified gen p mean: 0.4474121034145355, gen p mean: -0.64357590675354, mean p set: 0.447892427444458
loss_pred:0.02921125292778015, decouple_loss:0.018679719418287277
loss_pred:0.029443200677633286, decouple_loss:0.01875176653265953
loss_pred:0.02983999252319336, decouple_loss:0.01858810894191265
Iteration: 1475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473591446876526, gen p mean: -0.6487678289413452, mean p set: 0.4478394687175751
The modified gen p mean: 0.44752660393714905, gen p mean: -0.6516883373260498, mean p set: 0.44800689816474915
The modified gen p mean: 0.44810551404953003, gen p mean: -0.6498784422874451, mean p set: 0.44858577847480774
loss_pred:0.029886579141020775, decouple_loss:0.018052810803055763
loss_pred:0.028766479343175888, decouple_loss:0.018861455842852592
loss_pred:0.02886080928146839, decouple_loss:0.018633462488651276
Iteration: 1476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44816482067108154, gen p mean: -0.6460098624229431, mean p set: 0.44864511489868164
The modified gen p mean: 0.4482780992984772, gen p mean: -0.6389933228492737, mean p set: 0.4487583637237549
The modified gen p mean: 0.4474068880081177, gen p mean: -0.6405160427093506, mean p set: 0.4478871822357178
loss_pred:0.028690865263342857, decouple_loss:0.018162958323955536
loss_pred:0.02975182794034481, decouple_loss:0.017433535307645798
loss_pred:0.029859604313969612, decouple_loss:0.017392264679074287
Iteration: 1477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478549063205719, gen p mean: -0.6439279913902283, mean p set: 0.448335200548172
The modified gen p mean: 0.4482062757015228, gen p mean: -0.6437881588935852, mean p set: 0.4486865699291229
The modified gen p mean: 0.44802403450012207, gen p mean: -0.6489242315292358, mean p set: 0.44850432872772217
loss_pred:0.02763587050139904, decouple_loss:0.017861492931842804
loss_pred:0.02888074703514576, decouple_loss:0.01790768839418888
loss_pred:0.02816024050116539, decouple_loss:0.018027789890766144
Iteration: 1478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745364785194397, gen p mean: -0.6446688771247864, mean p set: 0.4479339122772217
The modified gen p mean: 0.4479553699493408, gen p mean: -0.6430001854896545, mean p set: 0.4484356641769409
The modified gen p mean: 0.44824522733688354, gen p mean: -0.6465743780136108, mean p set: 0.44872552156448364
loss_pred:0.02967483177781105, decouple_loss:0.017135733738541603loss_pred:0.029399584978818893, decouple_loss:0.017556095495820045
loss_pred:0.02959521673619747, decouple_loss:0.018187031149864197
Iteration: 1479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480619728565216, gen p mean: -0.6341601014137268, mean p set: 0.4485422670841217
The modified gen p mean: 0.4478556215763092, gen p mean: -0.6342180967330933, mean p set: 0.4483359158039093
The modified gen p mean: 0.4481227993965149, gen p mean: -0.6387847661972046, mean p set: 0.448603093624115
loss_pred:0.02859104983508587, decouple_loss:0.017032474279403687
loss_pred:0.028355710208415985, decouple_loss:0.017562977969646454
loss_pred:0.028842240571975708, decouple_loss:0.017189230769872665
Iteration: 1480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472324848175049, gen p mean: -0.6366205811500549, mean p set: 0.447712779045105
The modified gen p mean: 0.44816285371780396, gen p mean: -0.6321848630905151, mean p set: 0.44864311814308167
The modified gen p mean: 0.4480210840702057, gen p mean: -0.636374294757843, mean p set: 0.4485013484954834
loss_pred:0.028777804225683212, decouple_loss:0.0176949892193079
loss_pred:0.028356468304991722, decouple_loss:0.016757579520344734
loss_pred:0.028627032414078712, decouple_loss:0.01765700802206993
2023-05-03 00:06:19 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6444767117500305, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6372412443161011, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6320602297782898, mean p set: 0.45035696029663086
loss_pred:0.029721569269895554, decouple_loss:0.018184885382652283
loss_pred:0.02879275754094124, decouple_loss:0.018074238672852516
loss_pred:0.028421182185411453, decouple_loss:0.018407730385661125
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02988961897790432, avg_mse: 0.03407031670212746
current test mse: 0.03407
Iteration: 1481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448758602142334, gen p mean: -0.6367102861404419, mean p set: 0.4492388963699341
The modified gen p mean: 0.44783854484558105, gen p mean: -0.6396101713180542, mean p set: 0.44831880927085876
loss_pred:0.02842569351196289, decouple_loss:0.01677638292312622
loss_pred:0.028843222185969353, decouple_loss:0.01702246628701687
The modified gen p mean: 0.4478228688240051, gen p mean: -0.6332228183746338, mean p set: 0.4483031630516052
loss_pred:0.0291832834482193, decouple_loss:0.017457593232393265
Iteration: 1482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447463721036911, gen p mean: -0.6363221406936646, mean p set: 0.4479440450668335
The modified gen p mean: 0.44832268357276917, gen p mean: -0.6441856026649475, mean p set: 0.4488029479980469
The modified gen p mean: 0.44781047105789185, gen p mean: -0.6403125524520874, mean p set: 0.44829073548316956
loss_pred:0.028733979910612106, decouple_loss:0.01674550585448742
loss_pred:0.02786230854690075, decouple_loss:0.01755438931286335
loss_pred:0.02946080081164837, decouple_loss:0.016417531296610832
Iteration: 1483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811657071113586, gen p mean: -0.6483367085456848, mean p set: 0.4485968351364136
The modified gen p mean: 0.4463730454444885, gen p mean: -0.639367938041687, mean p set: 0.44685330986976624
The modified gen p mean: 0.44888073205947876, gen p mean: -0.64850252866745, mean p set: 0.44936102628707886
loss_pred:0.027972036972641945, decouple_loss:0.017170671373605728
loss_pred:0.02926771156489849, decouple_loss:0.017155705019831657
loss_pred:0.028168916702270508, decouple_loss:0.017684398218989372
Iteration: 1484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476214647293091, gen p mean: -0.6410518884658813, mean p set: 0.4481017291545868
The modified gen p mean: 0.44863346219062805, gen p mean: -0.6452299952507019, mean p set: 0.44911372661590576
The modified gen p mean: 0.4487875998020172, gen p mean: -0.6425289511680603, mean p set: 0.4492678940296173
loss_pred:0.028502626344561577, decouple_loss:0.016919083893299103
loss_pred:0.028074538335204124, decouple_loss:0.017052048817276955
loss_pred:0.02814028225839138, decouple_loss:0.01667848974466324
Iteration: 1485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44692254066467285, gen p mean: -0.6352245211601257, mean p set: 0.44740280508995056
The modified gen p mean: 0.4482143223285675, gen p mean: -0.6376374363899231, mean p set: 0.44869464635849
The modified gen p mean: 0.4484468698501587, gen p mean: -0.6342597007751465, mean p set: 0.4489271342754364
loss_pred:0.02860119752585888, decouple_loss:0.017140325158834457
loss_pred:0.028581740334630013, decouple_loss:0.01687607727944851
loss_pred:0.027708731591701508, decouple_loss:0.017658516764640808
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823944568634033, gen p mean: -0.6327066421508789, mean p set: 0.44871973991394043
The modified gen p mean: 0.44879159331321716, gen p mean: -0.6379691958427429, mean p set: 0.44927188754081726
The modified gen p mean: 0.4487228989601135, gen p mean: -0.6455723643302917, mean p set: 0.44920313358306885
loss_pred:0.028595231473445892, decouple_loss:0.01698126271367073
loss_pred:0.028398439288139343, decouple_loss:0.016462907195091248
loss_pred:0.027714082971215248, decouple_loss:0.016795072704553604
Iteration: 1487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44830819964408875, gen p mean: -0.6284626126289368, mean p set: 0.44878846406936646
The modified gen p mean: 0.4470321238040924, gen p mean: -0.6285329461097717, mean p set: 0.4475124180316925
The modified gen p mean: 0.44700318574905396, gen p mean: -0.6319622993469238, mean p set: 0.44748347997665405
loss_pred:0.028034204617142677, decouple_loss:0.016174765303730965
loss_pred:0.028901901096105576, decouple_loss:0.01607995666563511
loss_pred:0.028820279985666275, decouple_loss:0.016879310831427574
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
NaN value num: 0
Iteration: 1488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483610987663269, gen p mean: -0.644295334815979, mean p set: 0.4488413631916046
The modified gen p mean: 0.4475308656692505, gen p mean: -0.6394689083099365, mean p set: 0.4480111598968506
The modified gen p mean: 0.4476396441459656, gen p mean: -0.6377010941505432, mean p set: 0.4481199383735657
loss_pred:0.030589550733566284, decouple_loss:0.018879856914281845
loss_pred:0.029427187517285347, decouple_loss:0.01806771382689476
loss_pred:0.030129743739962578, decouple_loss:0.019913790747523308
Iteration: 1489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44816645979881287, gen p mean: -0.6551627516746521, mean p set: 0.4486467242240906
The modified gen p mean: 0.44655275344848633, gen p mean: -0.64687180519104, mean p set: 0.4470330774784088
The modified gen p mean: 0.4457978904247284, gen p mean: -0.6471002101898193, mean p set: 0.4462781846523285
loss_pred:0.029290219768881798, decouple_loss:0.01937967725098133
loss_pred:0.02847708947956562, decouple_loss:0.01870320737361908
loss_pred:0.02934204414486885, decouple_loss:0.017624279484152794
Iteration: 1490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793251156806946, gen p mean: -0.64933842420578, mean p set: 0.44841283559799194
The modified gen p mean: 0.4458322525024414, gen p mean: -0.6486018896102905, mean p set: 0.4463125169277191
The modified gen p mean: 0.4454835057258606, gen p mean: -0.6564157605171204, mean p set: 0.4459638297557831
loss_pred:0.029691338539123535, decouple_loss:0.018350768834352493
loss_pred:0.029072856530547142, decouple_loss:0.01721988059580326
loss_pred:0.02967960759997368, decouple_loss:0.017346547916531563
2023-05-03 00:10:45 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6413825750350952, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.648675799369812, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6370419263839722, mean p set: 0.45035696029663086
loss_pred:0.02873261459171772, decouple_loss:0.0180517565459013
loss_pred:0.029661811888217926, decouple_loss:0.018359988927841187
loss_pred:0.0283597894012928, decouple_loss:0.018013834953308105
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02982516586780548, avg_mse: 0.034052006900310516
current test mse: 0.034052
Iteration: 1491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44611889123916626, gen p mean: -0.6487851142883301, mean p set: 0.44659915566444397
loss_pred:0.02934880182147026, decouple_loss:0.017655007541179657
The modified gen p mean: 0.44853475689888, gen p mean: -0.6503633856773376, mean p set: 0.4490150213241577
loss_pred:0.030980244278907776, decouple_loss:0.019411800429224968
The modified gen p mean: 0.44670698046684265, gen p mean: -0.6500880122184753, mean p set: 0.44718730449676514
loss_pred:0.02926369197666645, decouple_loss:0.017680607736110687
Iteration: 1492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470677375793457, gen p mean: -0.651941180229187, mean p set: 0.4475480318069458
The modified gen p mean: 0.44767454266548157, gen p mean: -0.6499361395835876, mean p set: 0.44815483689308167
The modified gen p mean: 0.4495728015899658, gen p mean: -0.6506428718566895, mean p set: 0.4500530958175659
loss_pred:0.029214605689048767, decouple_loss:0.017746446654200554
loss_pred:0.029508749023079872, decouple_loss:0.017956817522644997
loss_pred:0.02735697478055954, decouple_loss:0.018504511564970016
Iteration: 1493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452667832374573, gen p mean: -0.6570947766304016, mean p set: 0.4457470774650574
The modified gen p mean: 0.44679969549179077, gen p mean: -0.6530564427375793, mean p set: 0.44727998971939087
The modified gen p mean: 0.44722214341163635, gen p mean: -0.651544451713562, mean p set: 0.44770243763923645
loss_pred:0.028695663437247276, decouple_loss:0.01744670979678631
loss_pred:0.030405322089791298, decouple_loss:0.017753342166543007
loss_pred:0.030109664425253868, decouple_loss:0.017876796424388885
Iteration: 1494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492434859275818, gen p mean: -0.6561495065689087, mean p set: 0.4497237801551819
The modified gen p mean: 0.4473022222518921, gen p mean: -0.6579955220222473, mean p set: 0.4477825164794922
The modified gen p mean: 0.44656050205230713, gen p mean: -0.6550198793411255, mean p set: 0.4470408260822296
loss_pred:0.029045358300209045, decouple_loss:0.01762501895427704
loss_pred:0.029501399025321007, decouple_loss:0.017019322142004967
loss_pred:0.029017798602581024, decouple_loss:0.016730977222323418
Iteration: 1495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467148780822754, gen p mean: -0.6546914577484131, mean p set: 0.4471952021121979
The modified gen p mean: 0.4468501806259155, gen p mean: -0.6578481197357178, mean p set: 0.4473304748535156
The modified gen p mean: 0.4447520673274994, gen p mean: -0.6602776050567627, mean p set: 0.4452323615550995
loss_pred:0.028359534218907356, decouple_loss:0.016986731439828873
loss_pred:0.02900269441306591, decouple_loss:0.01700783520936966
loss_pred:0.028648557141423225, decouple_loss:0.017708808183670044
Iteration: 1496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44638705253601074, gen p mean: -0.6561045050621033, mean p set: 0.4468673765659332
The modified gen p mean: 0.44529515504837036, gen p mean: -0.6542510390281677, mean p set: 0.44577544927597046
The modified gen p mean: 0.44663769006729126, gen p mean: -0.6539735198020935, mean p set: 0.44711804389953613
loss_pred:0.029694586992263794, decouple_loss:0.017215128988027573
loss_pred:0.02830469235777855, decouple_loss:0.01692585088312626
loss_pred:0.028902536258101463, decouple_loss:0.016604067757725716
Iteration: 1497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44610947370529175, gen p mean: -0.6412727236747742, mean p set: 0.44658976793289185
The modified gen p mean: 0.44594669342041016, gen p mean: -0.649145245552063, mean p set: 0.44642698764801025
The modified gen p mean: 0.4451453983783722, gen p mean: -0.6502620577812195, mean p set: 0.4456256330013275
loss_pred:0.028559261932969093, decouple_loss:0.017115578055381775
loss_pred:0.02875628136098385, decouple_loss:0.016624005511403084
loss_pred:0.02939688041806221, decouple_loss:0.01673956774175167
Iteration: 1498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486224055290222, gen p mean: -0.6434713006019592, mean p set: 0.4491027295589447
The modified gen p mean: 0.44864144921302795, gen p mean: -0.6494036316871643, mean p set: 0.44912174344062805
The modified gen p mean: 0.4469650089740753, gen p mean: -0.6469598412513733, mean p set: 0.4474453032016754
loss_pred:0.029677530750632286, decouple_loss:0.017414823174476624
loss_pred:0.02881726250052452, decouple_loss:0.017846226692199707
loss_pred:0.028636476024985313, decouple_loss:0.016292870044708252
Iteration: 1499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499937891960144, gen p mean: -0.654926598072052, mean p set: 0.4504740536212921
The modified gen p mean: 0.4464915096759796, gen p mean: -0.6542887687683105, mean p set: 0.4469718039035797
The modified gen p mean: 0.4481375217437744, gen p mean: -0.6591272354125977, mean p set: 0.4486178159713745
loss_pred:0.028339793905615807, decouple_loss:0.018573425710201263
loss_pred:0.028772594407200813, decouple_loss:0.017996225506067276
loss_pred:0.030673647299408913, decouple_loss:0.01907256618142128
Iteration: 1500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471828043460846, gen p mean: -0.6610441207885742, mean p set: 0.4476630687713623
The modified gen p mean: 0.4474874436855316, gen p mean: -0.6618810892105103, mean p set: 0.4479677379131317
The modified gen p mean: 0.44540050625801086, gen p mean: -0.6635088920593262, mean p set: 0.44588083028793335
loss_pred:0.030359234660863876, decouple_loss:0.018042510375380516loss_pred:0.028450794517993927, decouple_loss:0.017139749601483345
loss_pred:0.028510713949799538, decouple_loss:0.016842568293213844
2023-05-03 00:14:27 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6544667482376099, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.6616195440292358, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6505377292633057, mean p set: 0.45035696029663086
loss_pred:0.028795745223760605, decouple_loss:0.017887651920318604
loss_pred:0.0297150369733572, decouple_loss:0.018256474286317825
loss_pred:0.02837529592216015, decouple_loss:0.017946254462003708
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02986353263258934, avg_mse: 0.03417755663394928
current test mse: 0.034178
Iteration: 1501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44419869780540466, gen p mean: -0.6654107570648193, mean p set: 0.44467902183532715
The modified gen p mean: 0.44702309370040894, gen p mean: -0.6607037782669067, mean p set: 0.44750338792800903
loss_pred:0.029802735894918442, decouple_loss:0.016609011217951775
loss_pred:0.028672650456428528, decouple_loss:0.016700929030776024
The modified gen p mean: 0.4480064809322357, gen p mean: -0.6635401248931885, mean p set: 0.4484868049621582
loss_pred:0.030954677611589432, decouple_loss:0.01778094656765461
Iteration: 1502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447672039270401, gen p mean: -0.6582086682319641, mean p set: 0.4481523334980011
The modified gen p mean: 0.44580167531967163, gen p mean: -0.6551480889320374, mean p set: 0.44628193974494934
The modified gen p mean: 0.4480220079421997, gen p mean: -0.6572901010513306, mean p set: 0.4485023021697998
loss_pred:0.02942780964076519, decouple_loss:0.01660901866853237
loss_pred:0.02855048142373562, decouple_loss:0.017100756987929344
loss_pred:0.02950221672654152, decouple_loss:0.01737404055893421
Iteration: 1503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44909387826919556, gen p mean: -0.6641150712966919, mean p set: 0.44957417249679565
The modified gen p mean: 0.4492722749710083, gen p mean: -0.6625881195068359, mean p set: 0.449752539396286
The modified gen p mean: 0.44626855850219727, gen p mean: -0.6625954508781433, mean p set: 0.44674885272979736
loss_pred:0.027134746313095093, decouple_loss:0.01731206104159355
loss_pred:0.027715949341654778, decouple_loss:0.017144884914159775
loss_pred:0.028705038130283356, decouple_loss:0.016935354098677635
Iteration: 1504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472947120666504, gen p mean: -0.6501177549362183, mean p set: 0.4477749764919281
The modified gen p mean: 0.4481680393218994, gen p mean: -0.659603476524353, mean p set: 0.4486483037471771
The modified gen p mean: 0.44763484597206116, gen p mean: -0.6561034917831421, mean p set: 0.44811511039733887
loss_pred:0.031063886359333992, decouple_loss:0.01704421080648899
loss_pred:0.03038070723414421, decouple_loss:0.01723259873688221
loss_pred:0.03066984750330448, decouple_loss:0.01744634099304676
Iteration: 1505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483136534690857, gen p mean: -0.6586833000183105, mean p set: 0.4487939476966858
The modified gen p mean: 0.44679737091064453, gen p mean: -0.6521915197372437, mean p set: 0.447277694940567
The modified gen p mean: 0.4503893554210663, gen p mean: -0.6525134444236755, mean p set: 0.450869619846344
loss_pred:0.029806271195411682, decouple_loss:0.016856977716088295
loss_pred:0.030596958473324776, decouple_loss:0.01668722555041313
loss_pred:0.027782976627349854, decouple_loss:0.016900796443223953
Iteration: 1506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475797712802887, gen p mean: -0.6540582180023193, mean p set: 0.4480600357055664
The modified gen p mean: 0.4479103684425354, gen p mean: -0.6590756773948669, mean p set: 0.4483906924724579
The modified gen p mean: 0.44587594270706177, gen p mean: -0.6510769128799438, mean p set: 0.44635626673698425
loss_pred:0.030513107776641846, decouple_loss:0.01680886745452881
loss_pred:0.03016008250415325, decouple_loss:0.016359932720661163
loss_pred:0.028289953246712685, decouple_loss:0.017397606745362282
Iteration: 1507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4444916844367981, gen p mean: -0.6636884212493896, mean p set: 0.4449720084667206
The modified gen p mean: 0.4483027160167694, gen p mean: -0.657433807849884, mean p set: 0.4487829804420471
The modified gen p mean: 0.44976040720939636, gen p mean: -0.659442126750946, mean p set: 0.4502406716346741
loss_pred:0.029829252511262894, decouple_loss:0.017129044979810715
loss_pred:0.028486324474215508, decouple_loss:0.01737665943801403
loss_pred:0.028321636840701103, decouple_loss:0.017044033855199814
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
NaN value num: 0
Iteration: 1508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489962160587311, gen p mean: -0.6489171385765076, mean p set: 0.4494765102863312
The modified gen p mean: 0.44918811321258545, gen p mean: -0.6459499597549438, mean p set: 0.44966837763786316
The modified gen p mean: 0.44787687063217163, gen p mean: -0.6430251002311707, mean p set: 0.44835713505744934
loss_pred:0.029008371755480766, decouple_loss:0.01766730099916458
loss_pred:0.029617762193083763, decouple_loss:0.017909249290823936
loss_pred:0.026875000447034836, decouple_loss:0.017741557210683823
Iteration: 1509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44984591007232666, gen p mean: -0.6484205722808838, mean p set: 0.45032617449760437
The modified gen p mean: 0.44741857051849365, gen p mean: -0.6431288719177246, mean p set: 0.44789883494377136
The modified gen p mean: 0.4469221830368042, gen p mean: -0.6442017555236816, mean p set: 0.4474024772644043
loss_pred:0.028899991884827614, decouple_loss:0.01748431660234928
loss_pred:0.03091069683432579, decouple_loss:0.018034115433692932
loss_pred:0.0295345988124609, decouple_loss:0.016847310587763786
Iteration: 1510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447294145822525, gen p mean: -0.6517114043235779, mean p set: 0.4477744400501251
The modified gen p mean: 0.44909271597862244, gen p mean: -0.6566919684410095, mean p set: 0.44957301020622253
The modified gen p mean: 0.44772279262542725, gen p mean: -0.6503069400787354, mean p set: 0.44820311665534973
loss_pred:0.028251418843865395, decouple_loss:0.017624802887439728
loss_pred:0.02893305942416191, decouple_loss:0.017207611352205276
loss_pred:0.029557904228568077, decouple_loss:0.017564067617058754
2023-05-03 00:18:46 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6558156609535217, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6489323973655701, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6448197960853577, mean p set: 0.45035696029663086
loss_pred:0.029775822535157204, decouple_loss:0.01874116063117981
loss_pred:0.028716642409563065, decouple_loss:0.018289146944880486
loss_pred:0.02833312191069126, decouple_loss:0.01829192228615284
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02986389957368374, avg_mse: 0.034183062613010406
current test mse: 0.034183
Iteration: 1511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449148952960968, gen p mean: -0.6500429511070251, mean p set: 0.4496292173862457
The modified gen p mean: 0.44792255759239197, gen p mean: -0.6473256945610046, mean p set: 0.44840285181999207
loss_pred:0.02912016585469246, decouple_loss:0.01702430099248886
loss_pred:0.02968795970082283, decouple_loss:0.016876578330993652
The modified gen p mean: 0.44916045665740967, gen p mean: -0.6492411494255066, mean p set: 0.44964075088500977
loss_pred:0.028800496831536293, decouple_loss:0.016853079199790955
Iteration: 1512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487018287181854, gen p mean: -0.6514848470687866, mean p set: 0.4491821527481079
The modified gen p mean: 0.44835197925567627, gen p mean: -0.6500082612037659, mean p set: 0.448832243680954
The modified gen p mean: 0.44830429553985596, gen p mean: -0.6531594395637512, mean p set: 0.44878458976745605
loss_pred:0.027041448280215263, decouple_loss:0.017440157011151314
loss_pred:0.03095182776451111, decouple_loss:0.01731589436531067
loss_pred:0.026974255219101906, decouple_loss:0.017665304243564606
Iteration: 1513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44807925820350647, gen p mean: -0.6449835896492004, mean p set: 0.44855955243110657
The modified gen p mean: 0.447998970746994, gen p mean: -0.647369921207428, mean p set: 0.4484792649745941
The modified gen p mean: 0.44697391986846924, gen p mean: -0.6463862657546997, mean p set: 0.44745421409606934
loss_pred:0.02906114049255848, decouple_loss:0.017587466165423393
loss_pred:0.02975606918334961, decouple_loss:0.017644912004470825
loss_pred:0.028697790578007698, decouple_loss:0.017809942364692688
Iteration: 1514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486241638660431, gen p mean: -0.6485296487808228, mean p set: 0.4491044282913208
The modified gen p mean: 0.4470460116863251, gen p mean: -0.6514884829521179, mean p set: 0.4475262761116028
The modified gen p mean: 0.447347491979599, gen p mean: -0.6537966728210449, mean p set: 0.4478277862071991
loss_pred:0.028563234955072403, decouple_loss:0.01713852770626545
loss_pred:0.030189864337444305, decouple_loss:0.018278997391462326
loss_pred:0.030089501291513443, decouple_loss:0.017584262415766716
Iteration: 1515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44813400506973267, gen p mean: -0.6545276641845703, mean p set: 0.44861429929733276
The modified gen p mean: 0.447256863117218, gen p mean: -0.6528382897377014, mean p set: 0.4477371573448181
The modified gen p mean: 0.44967159628868103, gen p mean: -0.6562828421592712, mean p set: 0.45015189051628113
loss_pred:0.027800481766462326, decouple_loss:0.01759229600429535
loss_pred:0.02839631401002407, decouple_loss:0.01675129495561123
loss_pred:0.029611308127641678, decouple_loss:0.01711396314203739
Iteration: 1516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44660404324531555, gen p mean: -0.6463584899902344, mean p set: 0.44708430767059326
The modified gen p mean: 0.44811558723449707, gen p mean: -0.6516711115837097, mean p set: 0.44859588146209717
The modified gen p mean: 0.4493914246559143, gen p mean: -0.6472136974334717, mean p set: 0.4498717188835144
loss_pred:0.02862956002354622, decouple_loss:0.01770813949406147
loss_pred:0.02958524227142334, decouple_loss:0.01661049760878086
loss_pred:0.029485434293746948, decouple_loss:0.01696663722395897
Iteration: 1517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44713181257247925, gen p mean: -0.6384933590888977, mean p set: 0.44761213660240173
The modified gen p mean: 0.4471716582775116, gen p mean: -0.6422212719917297, mean p set: 0.4476519823074341
The modified gen p mean: 0.447129487991333, gen p mean: -0.6388548016548157, mean p set: 0.4476097822189331
loss_pred:0.030532486736774445, decouple_loss:0.017029263079166412
loss_pred:0.02819744125008583, decouple_loss:0.01652068831026554
loss_pred:0.03046170249581337, decouple_loss:0.018004540354013443
Iteration: 1518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447747141122818, gen p mean: -0.6529366970062256, mean p set: 0.4482274651527405
The modified gen p mean: 0.4474940299987793, gen p mean: -0.6502456665039062, mean p set: 0.447974294424057
The modified gen p mean: 0.44830405712127686, gen p mean: -0.6521140933036804, mean p set: 0.4487842917442322
loss_pred:0.030303731560707092, decouple_loss:0.01705990359187126
loss_pred:0.028571320697665215, decouple_loss:0.016404742375016212
loss_pred:0.029402922838926315, decouple_loss:0.01668381690979004
Iteration: 1519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44647037982940674, gen p mean: -0.6589882373809814, mean p set: 0.44695067405700684
The modified gen p mean: 0.4501868486404419, gen p mean: -0.654284656047821, mean p set: 0.450667142868042
The modified gen p mean: 0.44772812724113464, gen p mean: -0.656693696975708, mean p set: 0.44820842146873474
loss_pred:0.02978634648025036, decouple_loss:0.018344076350331306
loss_pred:0.029008543118834496, decouple_loss:0.01771731860935688
loss_pred:0.029398970305919647, decouple_loss:0.017455387860536575
Iteration: 1520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465521275997162, gen p mean: -0.6551274061203003, mean p set: 0.4470324218273163
The modified gen p mean: 0.4469103515148163, gen p mean: -0.6545931696891785, mean p set: 0.447390615940094
The modified gen p mean: 0.4474138915538788, gen p mean: -0.6564795970916748, mean p set: 0.44789421558380127
loss_pred:0.02861180156469345, decouple_loss:0.01768670417368412
loss_pred:0.030530612915754318, decouple_loss:0.017971867695450783
loss_pred:0.028780050575733185, decouple_loss:0.017314206808805466
2023-05-03 00:22:32 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.6556655764579773, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6481509804725647, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6438757181167603, mean p set: 0.45035696029663086
loss_pred:0.029714634642004967, decouple_loss:0.01835339330136776
loss_pred:0.02886802889406681, decouple_loss:0.017800213769078255
loss_pred:0.02840385213494301, decouple_loss:0.017731327563524246
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02989358827471733, avg_mse: 0.034295111894607544
current test mse: 0.034295
Iteration: 1521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485129117965698, gen p mean: -0.6499850153923035, mean p set: 0.44899317622184753
The modified gen p mean: 0.44786950945854187, gen p mean: -0.6461362242698669, mean p set: 0.44834980368614197
loss_pred:0.027242064476013184, decouple_loss:0.017144985496997833
loss_pred:0.030846891924738884, decouple_loss:0.016127021983265877
The modified gen p mean: 0.44690951704978943, gen p mean: -0.6471560597419739, mean p set: 0.4473898112773895
loss_pred:0.027789391577243805, decouple_loss:0.01589135453104973
Iteration: 1522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491839110851288, gen p mean: -0.6554216742515564, mean p set: 0.4496642053127289
The modified gen p mean: 0.44717299938201904, gen p mean: -0.6466064453125, mean p set: 0.44765329360961914
The modified gen p mean: 0.44690850377082825, gen p mean: -0.6521526575088501, mean p set: 0.44738876819610596
loss_pred:0.028325039893388748, decouple_loss:0.017271647229790688loss_pred:0.02991659566760063, decouple_loss:0.016502825543284416
loss_pred:0.030373264104127884, decouple_loss:0.016932129859924316
Iteration: 1523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832825660705566, gen p mean: -0.6598334908485413, mean p set: 0.44880858063697815
The modified gen p mean: 0.4483188986778259, gen p mean: -0.6585661768913269, mean p set: 0.44879916310310364
The modified gen p mean: 0.44814762473106384, gen p mean: -0.6559911370277405, mean p set: 0.44862788915634155
loss_pred:0.02782931923866272, decouple_loss:0.017670443281531334
loss_pred:0.029150284826755524, decouple_loss:0.017178384587168694
loss_pred:0.028251733630895615, decouple_loss:0.01719871163368225
Iteration: 1524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44698938727378845, gen p mean: -0.6559441685676575, mean p set: 0.44746968150138855
The modified gen p mean: 0.44778746366500854, gen p mean: -0.6552005410194397, mean p set: 0.44826775789260864
The modified gen p mean: 0.4497276246547699, gen p mean: -0.6605416536331177, mean p set: 0.45020791888237
loss_pred:0.028463518247008324, decouple_loss:0.01580071449279785
loss_pred:0.030214032158255577, decouple_loss:0.016393112018704414
loss_pred:0.028959080576896667, decouple_loss:0.016695182770490646
Iteration: 1525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469853341579437, gen p mean: -0.6512544751167297, mean p set: 0.4474656283855438
The modified gen p mean: 0.44879695773124695, gen p mean: -0.6518527865409851, mean p set: 0.44927728176116943
The modified gen p mean: 0.44731876254081726, gen p mean: -0.6503782868385315, mean p set: 0.44779905676841736
loss_pred:0.02725064940750599, decouple_loss:0.017320778220891953
loss_pred:0.027753323316574097, decouple_loss:0.016096793115139008
loss_pred:0.02928398922085762, decouple_loss:0.016392510384321213
Iteration: 1526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474733769893646, gen p mean: -0.6583751440048218, mean p set: 0.4479536712169647
The modified gen p mean: 0.4493010640144348, gen p mean: -0.6552451848983765, mean p set: 0.4497813284397125
The modified gen p mean: 0.4487006664276123, gen p mean: -0.6546291708946228, mean p set: 0.4491809606552124
loss_pred:0.029400557279586792, decouple_loss:0.01677638851106167
loss_pred:0.02913496270775795, decouple_loss:0.016449639573693275
loss_pred:0.028417693451046944, decouple_loss:0.01655185967683792
Iteration: 1527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750362634658813, gen p mean: -0.6559717059135437, mean p set: 0.4479839503765106
The modified gen p mean: 0.44750964641571045, gen p mean: -0.659936249256134, mean p set: 0.44798994064331055
The modified gen p mean: 0.4485624432563782, gen p mean: -0.663904070854187, mean p set: 0.44904273748397827
loss_pred:0.030128238722682, decouple_loss:0.01652483083307743
loss_pred:0.028988083824515343, decouple_loss:0.016475791111588478
loss_pred:0.027307862415909767, decouple_loss:0.015789903700351715
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
Iteration: 1528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476493299007416, gen p mean: -0.6683086156845093, mean p set: 0.44812965393066406
The modified gen p mean: 0.4459589421749115, gen p mean: -0.6644973754882812, mean p set: 0.4464392364025116
The modified gen p mean: 0.4460996687412262, gen p mean: -0.668212354183197, mean p set: 0.4465799629688263
loss_pred:0.02879711426794529, decouple_loss:0.017857320606708527
loss_pred:0.02898854948580265, decouple_loss:0.017254743725061417
loss_pred:0.03060825914144516, decouple_loss:0.016750460490584373
Iteration: 1529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44704344868659973, gen p mean: -0.6584725975990295, mean p set: 0.44752374291419983
The modified gen p mean: 0.44717806577682495, gen p mean: -0.6650527119636536, mean p set: 0.44765836000442505
The modified gen p mean: 0.44618159532546997, gen p mean: -0.6546225547790527, mean p set: 0.44666188955307007
loss_pred:0.028695112094283104, decouple_loss:0.017344815656542778
loss_pred:0.030837349593639374, decouple_loss:0.01716741919517517
loss_pred:0.02964230254292488, decouple_loss:0.017078056931495667
Iteration: 1530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44665977358818054, gen p mean: -0.6491363644599915, mean p set: 0.44714006781578064
The modified gen p mean: 0.4449184238910675, gen p mean: -0.6467107534408569, mean p set: 0.4453986883163452
The modified gen p mean: 0.4456939995288849, gen p mean: -0.6516368985176086, mean p set: 0.446174293756485
loss_pred:0.029407355934381485, decouple_loss:0.01780301332473755
loss_pred:0.031151991337537766, decouple_loss:0.018038839101791382
loss_pred:0.029673844575881958, decouple_loss:0.01725599355995655
2023-05-03 00:26:54 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.6600443720817566, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6523985862731934, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987669587135315, gen p mean: -0.6482462882995605, mean p set: 0.45035696029663086
loss_pred:0.029520917683839798, decouple_loss:0.017859289422631264
loss_pred:0.028575193136930466, decouple_loss:0.01731095276772976
loss_pred:0.02808680385351181, decouple_loss:0.017389358952641487
WV_0_PC_1_EH_0_PS_40_6, loss: 0.029603630304336548, avg_mse: 0.033896200358867645
current test mse: 0.033896
Iteration: 1531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461767077445984, gen p mean: -0.6511279940605164, mean p set: 0.4466569721698761
loss_pred:0.030403636395931244, decouple_loss:0.01701919361948967
The modified gen p mean: 0.44683507084846497, gen p mean: -0.652167558670044, mean p set: 0.44731536507606506
loss_pred:0.030190426856279373, decouple_loss:0.0168874841183424
The modified gen p mean: 0.4457947313785553, gen p mean: -0.6490697264671326, mean p set: 0.446274995803833
loss_pred:0.030284594744443893, decouple_loss:0.017391027882695198
Iteration: 1532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470646381378174, gen p mean: -0.6631859540939331, mean p set: 0.4475449025630951
The modified gen p mean: 0.44599515199661255, gen p mean: -0.6551199555397034, mean p set: 0.44647544622421265
The modified gen p mean: 0.44725629687309265, gen p mean: -0.6665952205657959, mean p set: 0.44773659110069275
loss_pred:0.02971826307475567, decouple_loss:0.017173320055007935
loss_pred:0.03136879950761795, decouple_loss:0.01674550212919712
loss_pred:0.02869497612118721, decouple_loss:0.017176758497953415
Iteration: 1533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473857581615448, gen p mean: -0.6567360162734985, mean p set: 0.4478660225868225
The modified gen p mean: 0.44418957829475403, gen p mean: -0.653788149356842, mean p set: 0.44466984272003174
The modified gen p mean: 0.44701579213142395, gen p mean: -0.6591314673423767, mean p set: 0.44749611616134644
loss_pred:0.03111007995903492, decouple_loss:0.016832323744893074
loss_pred:0.03001043014228344, decouple_loss:0.016712889075279236
loss_pred:0.02926671877503395, decouple_loss:0.017113303765654564
Iteration: 1534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479641616344452, gen p mean: -0.6490556001663208, mean p set: 0.4484444558620453
The modified gen p mean: 0.44587963819503784, gen p mean: -0.6481360793113708, mean p set: 0.4463599622249603
The modified gen p mean: 0.4476238787174225, gen p mean: -0.6451194286346436, mean p set: 0.4481041729450226
loss_pred:0.030468959361314774, decouple_loss:0.016691798344254494
loss_pred:0.030336247757077217, decouple_loss:0.01714153401553631
loss_pred:0.030199270695447922, decouple_loss:0.016840238124132156
Iteration: 1535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44665905833244324, gen p mean: -0.6439977288246155, mean p set: 0.44713932275772095
The modified gen p mean: 0.44547614455223083, gen p mean: -0.6461812257766724, mean p set: 0.44595643877983093
The modified gen p mean: 0.4471549987792969, gen p mean: -0.6470484733581543, mean p set: 0.44763532280921936
loss_pred:0.02948174625635147, decouple_loss:0.016240108758211136
loss_pred:0.029024310410022736, decouple_loss:0.01711277849972248
loss_pred:0.02996378019452095, decouple_loss:0.01676076464354992
Iteration: 1536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44630181789398193, gen p mean: -0.6502775549888611, mean p set: 0.44678211212158203
The modified gen p mean: 0.44716018438339233, gen p mean: -0.6547679901123047, mean p set: 0.4476405084133148
The modified gen p mean: 0.4470517337322235, gen p mean: -0.6518442630767822, mean p set: 0.4475320279598236
loss_pred:0.029090560972690582, decouple_loss:0.017036456614732742
loss_pred:0.02882981300354004, decouple_loss:0.01567120850086212
loss_pred:0.028306877240538597, decouple_loss:0.01653609238564968
Iteration: 1537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44647130370140076, gen p mean: -0.6624298095703125, mean p set: 0.44695156812667847
The modified gen p mean: 0.4471542239189148, gen p mean: -0.6625611186027527, mean p set: 0.4476345181465149
The modified gen p mean: 0.44692474603652954, gen p mean: -0.666653037071228, mean p set: 0.447405070066452
loss_pred:0.028857193887233734, decouple_loss:0.016913289204239845
loss_pred:0.029031574726104736, decouple_loss:0.01695980504155159
loss_pred:0.028613680973649025, decouple_loss:0.01677793636918068
Iteration: 1538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463682174682617, gen p mean: -0.6553528308868408, mean p set: 0.4468485414981842
The modified gen p mean: 0.44675591588020325, gen p mean: -0.652022659778595, mean p set: 0.44723621010780334
The modified gen p mean: 0.44592511653900146, gen p mean: -0.6549915075302124, mean p set: 0.44640541076660156
loss_pred:0.029018646106123924, decouple_loss:0.015028396621346474
loss_pred:0.029137929901480675, decouple_loss:0.01618655025959015
loss_pred:0.029003147035837173, decouple_loss:0.016234617680311203
Iteration: 1539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445172518491745, gen p mean: -0.6502816677093506, mean p set: 0.4456527829170227
The modified gen p mean: 0.4464186728000641, gen p mean: -0.6455742716789246, mean p set: 0.4468989372253418
The modified gen p mean: 0.44659748673439026, gen p mean: -0.6483145356178284, mean p set: 0.44707778096199036
loss_pred:0.028297999873757362, decouple_loss:0.016222484409809113
loss_pred:0.029492678120732307, decouple_loss:0.01642218977212906
loss_pred:0.029110165312886238, decouple_loss:0.016068359836935997
Iteration: 1540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44583046436309814, gen p mean: -0.645064651966095, mean p set: 0.44631072878837585
The modified gen p mean: 0.4458606541156769, gen p mean: -0.6443067789077759, mean p set: 0.4463409185409546
The modified gen p mean: 0.44546782970428467, gen p mean: -0.6423635482788086, mean p set: 0.4459480941295624
loss_pred:0.028384976089000702, decouple_loss:0.01615471951663494
loss_pred:0.028457803651690483, decouple_loss:0.01593720354139805
loss_pred:0.02821199968457222, decouple_loss:0.01638226956129074
2023-05-03 00:30:41 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6457564234733582, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.6529988050460815, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6415969729423523, mean p set: 0.45035696029663086
loss_pred:0.028414351865649223, decouple_loss:0.017694830894470215
loss_pred:0.029443606734275818, decouple_loss:0.01722484640777111
loss_pred:0.02806498110294342, decouple_loss:0.01769358664751053
WV_0_PC_1_EH_0_PS_40_6, loss: 0.029517870396375656, avg_mse: 0.03377942368388176
current test mse: 0.033779
Iteration: 1541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465024173259735, gen p mean: -0.6447914242744446, mean p set: 0.446982741355896
The modified gen p mean: 0.4464435279369354, gen p mean: -0.6455501914024353, mean p set: 0.4469238221645355
loss_pred:0.029404394328594208, decouple_loss:0.015553876757621765
loss_pred:0.03028005361557007, decouple_loss:0.016841690987348557
The modified gen p mean: 0.4465557038784027, gen p mean: -0.6478407382965088, mean p set: 0.4470359981060028
loss_pred:0.028201276436448097, decouple_loss:0.015695389360189438
Iteration: 1542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447144091129303, gen p mean: -0.6452733874320984, mean p set: 0.4476243555545807
The modified gen p mean: 0.4465615153312683, gen p mean: -0.6485264897346497, mean p set: 0.4470418095588684
The modified gen p mean: 0.44563719630241394, gen p mean: -0.6517983675003052, mean p set: 0.44611749053001404
loss_pred:0.02880258299410343, decouple_loss:0.016262177377939224
loss_pred:0.029344510287046432, decouple_loss:0.016396278515458107
loss_pred:0.028242530301213264, decouple_loss:0.015675092115998268
Iteration: 1543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470544159412384, gen p mean: -0.6471027731895447, mean p set: 0.4475346803665161
The modified gen p mean: 0.4463280737400055, gen p mean: -0.6543492674827576, mean p set: 0.4468083381652832
The modified gen p mean: 0.44591376185417175, gen p mean: -0.6492418646812439, mean p set: 0.44639402627944946
loss_pred:0.03113805688917637, decouple_loss:0.0170851219445467
loss_pred:0.028820771723985672, decouple_loss:0.016719898208975792
loss_pred:0.027983946725726128, decouple_loss:0.014998743310570717
Iteration: 1544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466024339199066, gen p mean: -0.6454219818115234, mean p set: 0.4470827281475067
The modified gen p mean: 0.4467942416667938, gen p mean: -0.6447460055351257, mean p set: 0.4472745358943939
The modified gen p mean: 0.44706955552101135, gen p mean: -0.644885241985321, mean p set: 0.44754984974861145
loss_pred:0.028418995440006256, decouple_loss:0.01575244963169098
loss_pred:0.028673458844423294, decouple_loss:0.015678633004426956
loss_pred:0.028929436579346657, decouple_loss:0.016630439087748528
Iteration: 1545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44681504368782043, gen p mean: -0.6399297118186951, mean p set: 0.44729533791542053
The modified gen p mean: 0.44671282172203064, gen p mean: -0.6400129199028015, mean p set: 0.44719311594963074
The modified gen p mean: 0.44647565484046936, gen p mean: -0.6462369561195374, mean p set: 0.44695594906806946
loss_pred:0.028467996045947075, decouple_loss:0.015201463364064693
loss_pred:0.028725331649184227, decouple_loss:0.015642227604985237
loss_pred:0.02801842987537384, decouple_loss:0.016057176515460014
Iteration: 1546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44556576013565063, gen p mean: -0.642159104347229, mean p set: 0.44604605436325073
The modified gen p mean: 0.44565340876579285, gen p mean: -0.6425667405128479, mean p set: 0.44613370299339294
The modified gen p mean: 0.4465227723121643, gen p mean: -0.636070966720581, mean p set: 0.447003036737442
loss_pred:0.028856271877884865, decouple_loss:0.015663741156458855
loss_pred:0.02803669683635235, decouple_loss:0.015157874673604965
loss_pred:0.029138604179024696, decouple_loss:0.015909790992736816
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44558170437812805, gen p mean: -0.6458290815353394, mean p set: 0.44606199860572815
The modified gen p mean: 0.44722801446914673, gen p mean: -0.6425198912620544, mean p set: 0.44770827889442444
The modified gen p mean: 0.44696277379989624, gen p mean: -0.6395732760429382, mean p set: 0.44744303822517395
loss_pred:0.028675265610218048, decouple_loss:0.015771007165312767
loss_pred:0.02999737486243248, decouple_loss:0.015694385394454002
loss_pred:0.030145812779664993, decouple_loss:0.016151487827301025
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
NaN value num: 0
Iteration: 1548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44861724972724915, gen p mean: -0.6500163674354553, mean p set: 0.44909751415252686
The modified gen p mean: 0.44754356145858765, gen p mean: -0.6481098532676697, mean p set: 0.44802385568618774
The modified gen p mean: 0.449124813079834, gen p mean: -0.6500149965286255, mean p set: 0.4496051073074341
loss_pred:0.03048725798726082, decouple_loss:0.017939090728759766
loss_pred:0.028391849249601364, decouple_loss:0.01651325635612011
loss_pred:0.03003722056746483, decouple_loss:0.01767384447157383
Iteration: 1549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44820448756217957, gen p mean: -0.6647317409515381, mean p set: 0.44868478178977966
The modified gen p mean: 0.4468842148780823, gen p mean: -0.6528368592262268, mean p set: 0.44736447930336
The modified gen p mean: 0.448591947555542, gen p mean: -0.6572337746620178, mean p set: 0.4490722715854645
loss_pred:0.03069978766143322, decouple_loss:0.017299428582191467
loss_pred:0.03024040162563324, decouple_loss:0.01667572557926178
loss_pred:0.02942056581377983, decouple_loss:0.017045721411705017
Iteration: 1550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495101273059845, gen p mean: -0.6677999496459961, mean p set: 0.4499904215335846
The modified gen p mean: 0.44802042841911316, gen p mean: -0.6673138737678528, mean p set: 0.44850072264671326
The modified gen p mean: 0.4497392177581787, gen p mean: -0.6654728055000305, mean p set: 0.4502195119857788
loss_pred:0.027691369876265526, decouple_loss:0.017721200361847878
loss_pred:0.029658176004886627, decouple_loss:0.016974886879324913
loss_pred:0.028690174221992493, decouple_loss:0.017609380185604095
2023-05-03 00:35:18 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.6599353551864624, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.652825653553009, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6486063599586487, mean p set: 0.45035696029663086
loss_pred:0.02954840660095215, decouple_loss:0.01771480031311512
loss_pred:0.028518158942461014, decouple_loss:0.017704131081700325
loss_pred:0.02809392847120762, decouple_loss:0.017771724611520767
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02960667572915554, avg_mse: 0.03390440344810486
current test mse: 0.033904
Iteration: 1551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44961830973625183, gen p mean: -0.6535618305206299, mean p set: 0.4500986337661743
loss_pred:0.029102304950356483, decouple_loss:0.01764334738254547
The modified gen p mean: 0.44936156272888184, gen p mean: -0.6551943421363831, mean p set: 0.44984182715415955
loss_pred:0.02929401397705078, decouple_loss:0.017351502552628517
The modified gen p mean: 0.4492662847042084, gen p mean: -0.6491986513137817, mean p set: 0.44974657893180847
loss_pred:0.0299136471003294, decouple_loss:0.016827130690217018
Iteration: 1552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476093649864197, gen p mean: -0.652563214302063, mean p set: 0.4480896592140198
The modified gen p mean: 0.4486355185508728, gen p mean: -0.6573431491851807, mean p set: 0.4491157829761505
The modified gen p mean: 0.4479466378688812, gen p mean: -0.641788899898529, mean p set: 0.44842690229415894
loss_pred:0.03010835312306881, decouple_loss:0.01793292537331581
loss_pred:0.028152618557214737, decouple_loss:0.01779535971581936
loss_pred:0.028239034116268158, decouple_loss:0.01742628403007984
Iteration: 1553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487381875514984, gen p mean: -0.6532503962516785, mean p set: 0.4492185115814209
The modified gen p mean: 0.44711536169052124, gen p mean: -0.6499133706092834, mean p set: 0.44759565591812134
The modified gen p mean: 0.44883784651756287, gen p mean: -0.646007239818573, mean p set: 0.44931817054748535
loss_pred:0.02912513166666031, decouple_loss:0.017903441563248634
loss_pred:0.029609303921461105, decouple_loss:0.017056100070476532
loss_pred:0.029676740989089012, decouple_loss:0.01678718440234661
Iteration: 1554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485088884830475, gen p mean: -0.6604292392730713, mean p set: 0.4489891827106476
The modified gen p mean: 0.44786274433135986, gen p mean: -0.6601459383964539, mean p set: 0.44834303855895996
The modified gen p mean: 0.4483537971973419, gen p mean: -0.6528140902519226, mean p set: 0.44883406162261963
loss_pred:0.030152836814522743, decouple_loss:0.017066646367311478
loss_pred:0.02886982448399067, decouple_loss:0.01673360913991928
loss_pred:0.02900022827088833, decouple_loss:0.015773814171552658
Iteration: 1555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494950771331787, gen p mean: -0.6698164343833923, mean p set: 0.4499753415584564
The modified gen p mean: 0.44783735275268555, gen p mean: -0.666377067565918, mean p set: 0.44831764698028564
The modified gen p mean: 0.44802820682525635, gen p mean: -0.6659010648727417, mean p set: 0.44850850105285645
loss_pred:0.028437823057174683, decouple_loss:0.01712385006248951
loss_pred:0.02970084734261036, decouple_loss:0.018181350082159042
loss_pred:0.030043695122003555, decouple_loss:0.017740624025464058
Iteration: 1556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823139905929565, gen p mean: -0.6666473150253296, mean p set: 0.44871172308921814
The modified gen p mean: 0.4481610059738159, gen p mean: -0.6717355251312256, mean p set: 0.448641300201416
The modified gen p mean: 0.447353333234787, gen p mean: -0.6646747589111328, mean p set: 0.4478336274623871
loss_pred:0.03066934086382389, decouple_loss:0.016453638672828674
loss_pred:0.028254222124814987, decouple_loss:0.016146406531333923
loss_pred:0.030872970819473267, decouple_loss:0.016566185280680656
Iteration: 1557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44792941212654114, gen p mean: -0.6550617814064026, mean p set: 0.44840967655181885
The modified gen p mean: 0.4482074975967407, gen p mean: -0.6670207977294922, mean p set: 0.4486878216266632
The modified gen p mean: 0.44767630100250244, gen p mean: -0.668499231338501, mean p set: 0.44815659523010254
loss_pred:0.028490891680121422, decouple_loss:0.017275802791118622
loss_pred:0.02979162707924843, decouple_loss:0.01683579757809639
loss_pred:0.02996107190847397, decouple_loss:0.016573047265410423
Iteration: 1558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488072991371155, gen p mean: -0.6637616157531738, mean p set: 0.4492875933647156
The modified gen p mean: 0.4501098394393921, gen p mean: -0.6603410243988037, mean p set: 0.4505901634693146
The modified gen p mean: 0.44731342792510986, gen p mean: -0.6603540182113647, mean p set: 0.44779375195503235
loss_pred:0.028364524245262146, decouple_loss:0.016551736742258072
loss_pred:0.02834835648536682, decouple_loss:0.017500590533018112
loss_pred:0.03027706779539585, decouple_loss:0.016086699441075325
Iteration: 1559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44844934344291687, gen p mean: -0.6513225436210632, mean p set: 0.44892963767051697
The modified gen p mean: 0.4477972388267517, gen p mean: -0.6551016569137573, mean p set: 0.4482775628566742
The modified gen p mean: 0.44758614897727966, gen p mean: -0.6435234546661377, mean p set: 0.44806647300720215
loss_pred:0.03019188903272152, decouple_loss:0.01738690212368965
loss_pred:0.0295098889619112, decouple_loss:0.01623399183154106
loss_pred:0.0280854944139719, decouple_loss:0.017671547830104828
Iteration: 1560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477604329586029, gen p mean: -0.6438125967979431, mean p set: 0.448240727186203
The modified gen p mean: 0.4480515420436859, gen p mean: -0.644622266292572, mean p set: 0.4485318660736084
The modified gen p mean: 0.44782301783561707, gen p mean: -0.6595472693443298, mean p set: 0.44830331206321716
loss_pred:0.028488529846072197, decouple_loss:0.017214978113770485
loss_pred:0.028600746765732765, decouple_loss:0.017034675925970078
loss_pred:0.029811909422278404, decouple_loss:0.015956752002239227
2023-05-03 00:39:00 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6506417989730835, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6578416228294373, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6468623280525208, mean p set: 0.45035696029663086
loss_pred:0.028562325984239578, decouple_loss:0.017261376604437828
loss_pred:0.029513077810406685, decouple_loss:0.01763184741139412
loss_pred:0.028121786192059517, decouple_loss:0.017523713409900665
WV_0_PC_1_EH_0_PS_40_6, loss: 0.029606012627482414, avg_mse: 0.034023717045784
current test mse: 0.034024
Iteration: 1561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478890895843506, gen p mean: -0.6546133756637573, mean p set: 0.4483693838119507
The modified gen p mean: 0.4480273425579071, gen p mean: -0.6563998460769653, mean p set: 0.4485076069831848
loss_pred:0.029184041544795036, decouple_loss:0.016098294407129288
loss_pred:0.030017279088497162, decouple_loss:0.016012242063879967
The modified gen p mean: 0.446767657995224, gen p mean: -0.6489246487617493, mean p set: 0.4472479820251465
loss_pred:0.029907329007983208, decouple_loss:0.016287323087453842
Iteration: 1562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801104068756104, gen p mean: -0.6638489365577698, mean p set: 0.44849133491516113
The modified gen p mean: 0.448249876499176, gen p mean: -0.6631653308868408, mean p set: 0.4487301707267761
The modified gen p mean: 0.44992712140083313, gen p mean: -0.6656433343887329, mean p set: 0.4504074156284332
loss_pred:0.02963080070912838, decouple_loss:0.015878716483712196
loss_pred:0.029716990888118744, decouple_loss:0.01594684273004532
loss_pred:0.028680162504315376, decouple_loss:0.016667399555444717
Iteration: 1563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480580687522888, gen p mean: -0.6644130349159241, mean p set: 0.4485383629798889
The modified gen p mean: 0.44783344864845276, gen p mean: -0.6649888753890991, mean p set: 0.44831374287605286
The modified gen p mean: 0.4483759105205536, gen p mean: -0.665136992931366, mean p set: 0.4488562047481537
loss_pred:0.02822841890156269, decouple_loss:0.016700493171811104
loss_pred:0.028799593448638916, decouple_loss:0.016444187611341476
loss_pred:0.02979586087167263, decouple_loss:0.015432696789503098
Iteration: 1564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481784403324127, gen p mean: -0.6627352237701416, mean p set: 0.4486587643623352
The modified gen p mean: 0.4483935832977295, gen p mean: -0.6541962027549744, mean p set: 0.4488738775253296
The modified gen p mean: 0.4490705728530884, gen p mean: -0.6571849584579468, mean p set: 0.4495508372783661
loss_pred:0.02922046184539795, decouple_loss:0.01654204912483692
loss_pred:0.0281843114644289, decouple_loss:0.016056083142757416
loss_pred:0.029464781284332275, decouple_loss:0.016625884920358658
Iteration: 1565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483061730861664, gen p mean: -0.6575144529342651, mean p set: 0.4487864673137665
The modified gen p mean: 0.4486146867275238, gen p mean: -0.651733934879303, mean p set: 0.4490949809551239
The modified gen p mean: 0.44775399565696716, gen p mean: -0.6570932269096375, mean p set: 0.4482342600822449
loss_pred:0.02919936552643776, decouple_loss:0.015282395295798779
loss_pred:0.027842318639159203, decouple_loss:0.016647513955831528
loss_pred:0.029420549049973488, decouple_loss:0.01600521244108677
Iteration: 1566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493980407714844, gen p mean: -0.6517908573150635, mean p set: 0.4498783349990845
The modified gen p mean: 0.4494318962097168, gen p mean: -0.6542965173721313, mean p set: 0.4499121904373169
The modified gen p mean: 0.44803908467292786, gen p mean: -0.6585334539413452, mean p set: 0.44851937890052795
loss_pred:0.028272805735468864, decouple_loss:0.01650243252515793
loss_pred:0.02871825359761715, decouple_loss:0.016733665019273758
loss_pred:0.029861215502023697, decouple_loss:0.015714501962065697
Iteration: 1567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791704416275024, gen p mean: -0.6640243530273438, mean p set: 0.44839733839035034
The modified gen p mean: 0.4479117691516876, gen p mean: -0.6660597920417786, mean p set: 0.44839203357696533
The modified gen p mean: 0.44805678725242615, gen p mean: -0.6664537787437439, mean p set: 0.44853708148002625
loss_pred:0.02955080009996891, decouple_loss:0.016262585297226906
loss_pred:0.029567593708634377, decouple_loss:0.015502768568694592
loss_pred:0.03017900325357914, decouple_loss:0.01594516634941101
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
NaN value num: 0
Iteration: 1568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518018662929535, gen p mean: -0.6671953201293945, mean p set: 0.452282190322876
The modified gen p mean: 0.4506078064441681, gen p mean: -0.6622344851493835, mean p set: 0.4510881304740906
The modified gen p mean: 0.4523985683917999, gen p mean: -0.6780102252960205, mean p set: 0.45287883281707764
loss_pred:0.028599880635738373, decouple_loss:0.019249318167567253
loss_pred:0.0273398719727993, decouple_loss:0.0191024336963892
loss_pred:0.028520869091153145, decouple_loss:0.01930828206241131
Iteration: 1569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530724287033081, gen p mean: -0.6765126585960388, mean p set: 0.4535527229309082
The modified gen p mean: 0.4525775909423828, gen p mean: -0.6741428971290588, mean p set: 0.4530578553676605
The modified gen p mean: 0.4531858265399933, gen p mean: -0.6726499795913696, mean p set: 0.45366615056991577
loss_pred:0.030437350273132324, decouple_loss:0.019328154623508453
loss_pred:0.030416663736104965, decouple_loss:0.01932189241051674
loss_pred:0.03079673834145069, decouple_loss:0.018606306985020638
Iteration: 1570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501402974128723, gen p mean: -0.6622717380523682, mean p set: 0.4506206214427948
The modified gen p mean: 0.451791375875473, gen p mean: -0.6601444482803345, mean p set: 0.45227164030075073
The modified gen p mean: 0.4532029628753662, gen p mean: -0.6541609168052673, mean p set: 0.4536832273006439
loss_pred:0.02671351283788681, decouple_loss:0.01960870996117592
loss_pred:0.03081795945763588, decouple_loss:0.018875231966376305
loss_pred:0.02794385887682438, decouple_loss:0.019775228574872017

2023-05-03 00:43:24 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6563897728919983, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.648635745048523, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6446486115455627, mean p set: 0.45035696029663086
loss_pred:0.029699774459004402, decouple_loss:0.01867610402405262
loss_pred:0.028752531856298447, decouple_loss:0.018427172675728798
loss_pred:0.028338000178337097, decouple_loss:0.01867726631462574
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02985977940261364, avg_mse: 0.034343164414167404
current test mse: 0.034343
Iteration: 1571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45127907395362854, gen p mean: -0.6585109233856201, mean p set: 0.45175933837890625
loss_pred:0.027214178815484047, decouple_loss:0.018683530390262604
The modified gen p mean: 0.45300745964050293, gen p mean: -0.6550813317298889, mean p set: 0.453487753868103
loss_pred:0.028857087716460228, decouple_loss:0.018815575167536736
The modified gen p mean: 0.44963768124580383, gen p mean: -0.6547629237174988, mean p set: 0.45011797547340393
loss_pred:0.026318298652768135, decouple_loss:0.019077541306614876
Iteration: 1572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521256983280182, gen p mean: -0.6546285152435303, mean p set: 0.4526059925556183
The modified gen p mean: 0.4533480405807495, gen p mean: -0.6576777696609497, mean p set: 0.4538283348083496
The modified gen p mean: 0.4507195055484772, gen p mean: -0.6512008905410767, mean p set: 0.4511997699737549
loss_pred:0.029977809637784958, decouple_loss:0.017891377210617065
loss_pred:0.029973860830068588, decouple_loss:0.017748000100255013
loss_pred:0.027595771476626396, decouple_loss:0.018464509397745132
Iteration: 1573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45238861441612244, gen p mean: -0.6698316931724548, mean p set: 0.45286890864372253
The modified gen p mean: 0.4519538879394531, gen p mean: -0.6667596101760864, mean p set: 0.4524341821670532
The modified gen p mean: 0.452873170375824, gen p mean: -0.661588191986084, mean p set: 0.4533534646034241
loss_pred:0.030682682991027832, decouple_loss:0.018089499324560165
loss_pred:0.027955973520874977, decouple_loss:0.018779953941702843
loss_pred:0.028936421498656273, decouple_loss:0.018374158069491386
Iteration: 1574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502507448196411, gen p mean: -0.660959780216217, mean p set: 0.4507310390472412
The modified gen p mean: 0.4527311623096466, gen p mean: -0.6596280932426453, mean p set: 0.4532114863395691
The modified gen p mean: 0.45211803913116455, gen p mean: -0.6576758027076721, mean p set: 0.45259830355644226
loss_pred:0.028868969529867172, decouple_loss:0.018742995336651802
loss_pred:0.028581127524375916, decouple_loss:0.01823529414832592
loss_pred:0.028717990964651108, decouple_loss:0.01888386346399784
Iteration: 1575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514514207839966, gen p mean: -0.6593185663223267, mean p set: 0.4519317150115967
The modified gen p mean: 0.45307889580726624, gen p mean: -0.6646058559417725, mean p set: 0.45355919003486633
The modified gen p mean: 0.45206931233406067, gen p mean: -0.649044394493103, mean p set: 0.45254963636398315
loss_pred:0.030384518206119537, decouple_loss:0.018210988491773605
loss_pred:0.029720988124608994, decouple_loss:0.017964694648981094
loss_pred:0.028918970376253128, decouple_loss:0.017860954627394676
Iteration: 1576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529379904270172, gen p mean: -0.6629311442375183, mean p set: 0.4534182846546173
The modified gen p mean: 0.45120471715927124, gen p mean: -0.6567657589912415, mean p set: 0.45168498158454895
The modified gen p mean: 0.45329105854034424, gen p mean: -0.6687040328979492, mean p set: 0.4537713825702667
loss_pred:0.03019101358950138, decouple_loss:0.017156539484858513
loss_pred:0.02938036434352398, decouple_loss:0.017640231177210808
loss_pred:0.028778478503227234, decouple_loss:0.01878434605896473
Iteration: 1577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534457325935364, gen p mean: -0.6591874957084656, mean p set: 0.4539260268211365
The modified gen p mean: 0.4499393105506897, gen p mean: -0.6669263243675232, mean p set: 0.4504196047782898
The modified gen p mean: 0.4498823583126068, gen p mean: -0.6602862477302551, mean p set: 0.4503626525402069
loss_pred:0.02749125473201275, decouple_loss:0.017661437392234802
loss_pred:0.025869833305478096, decouple_loss:0.01814868114888668
loss_pred:0.027584826573729515, decouple_loss:0.018103785812854767
Iteration: 1578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45042166113853455, gen p mean: -0.6525649428367615, mean p set: 0.45090195536613464
The modified gen p mean: 0.45041540265083313, gen p mean: -0.6490659713745117, mean p set: 0.4508957266807556
The modified gen p mean: 0.45349958539009094, gen p mean: -0.6613749265670776, mean p set: 0.45397984981536865
loss_pred:0.028175873681902885, decouple_loss:0.018392711877822876
loss_pred:0.027322659268975258, decouple_loss:0.017743714153766632
loss_pred:0.026946036145091057, decouple_loss:0.018328575417399406
Iteration: 1579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450214147567749, gen p mean: -0.6492750644683838, mean p set: 0.4506944417953491
The modified gen p mean: 0.4533970057964325, gen p mean: -0.6540798544883728, mean p set: 0.4538773000240326
The modified gen p mean: 0.45099908113479614, gen p mean: -0.6478601098060608, mean p set: 0.45147937536239624
loss_pred:0.02802347205579281, decouple_loss:0.017211711034178734
loss_pred:0.030182866379618645, decouple_loss:0.017238670960068703
loss_pred:0.027604885399341583, decouple_loss:0.017758412286639214
Iteration: 1580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514559805393219, gen p mean: -0.6494659781455994, mean p set: 0.451936274766922
The modified gen p mean: 0.45496630668640137, gen p mean: -0.6615309119224548, mean p set: 0.45544660091400146
The modified gen p mean: 0.4508505165576935, gen p mean: -0.6536933779716492, mean p set: 0.4513308107852936
loss_pred:0.028513265773653984, decouple_loss:0.017244361340999603
loss_pred:0.027892721816897392, decouple_loss:0.017589708790183067
loss_pred:0.027679666876792908, decouple_loss:0.017112789675593376
2023-05-03 00:47:09 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6616201400756836, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6692512631416321, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6576462388038635, mean p set: 0.45035696029663086
loss_pred:0.02863803133368492, decouple_loss:0.018961381167173386
loss_pred:0.029697826132178307, decouple_loss:0.019492223858833313
loss_pred:0.028211692348122597, decouple_loss:0.01901622861623764
WV_0_PC_1_EH_0_PS_40_6, loss: 0.029807014390826225, avg_mse: 0.03422609344124794
current test mse: 0.034226
Iteration: 1581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4537471532821655, gen p mean: -0.6629675030708313, mean p set: 0.45422741770744324
The modified gen p mean: 0.4540480971336365, gen p mean: -0.6693167686462402, mean p set: 0.4545283913612366
loss_pred:0.028238613158464432, decouple_loss:0.01711045578122139
loss_pred:0.026756061241030693, decouple_loss:0.017520781606435776
The modified gen p mean: 0.4496065676212311, gen p mean: -0.6668443083763123, mean p set: 0.4500868618488312
loss_pred:0.025577489286661148, decouple_loss:0.017198575660586357
Iteration: 1582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531592130661011, gen p mean: -0.672368586063385, mean p set: 0.45363950729370117
The modified gen p mean: 0.4495961666107178, gen p mean: -0.6536543965339661, mean p set: 0.4500764310359955
The modified gen p mean: 0.4504041075706482, gen p mean: -0.6665492653846741, mean p set: 0.4508844316005707
loss_pred:0.028147153556346893, decouple_loss:0.017361504957079887
loss_pred:0.027889980003237724, decouple_loss:0.017044587060809135
loss_pred:0.026522377505898476, decouple_loss:0.016999853774905205
Iteration: 1583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518965482711792, gen p mean: -0.6736781001091003, mean p set: 0.4523768723011017
The modified gen p mean: 0.4537576138973236, gen p mean: -0.6667537093162537, mean p set: 0.4542378783226013
The modified gen p mean: 0.4508812725543976, gen p mean: -0.6625003814697266, mean p set: 0.45136159658432007
loss_pred:0.0266271885484457, decouple_loss:0.016915185377001762
loss_pred:0.028339002281427383, decouple_loss:0.016701864078640938
loss_pred:0.027388624846935272, decouple_loss:0.016519971191883087
Iteration: 1584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45113590359687805, gen p mean: -0.6616490483283997, mean p set: 0.45161619782447815
The modified gen p mean: 0.4548652172088623, gen p mean: -0.6712890863418579, mean p set: 0.45534548163414
The modified gen p mean: 0.4505513906478882, gen p mean: -0.6669344305992126, mean p set: 0.4510316848754883
loss_pred:0.02857210300862789, decouple_loss:0.016990093514323235
loss_pred:0.026788834482431412, decouple_loss:0.016591455787420273
loss_pred:0.027450045570731163, decouple_loss:0.016774309799075127
Iteration: 1585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45190173387527466, gen p mean: -0.6748319864273071, mean p set: 0.45238202810287476
The modified gen p mean: 0.4541676640510559, gen p mean: -0.6684311628341675, mean p set: 0.454647958278656
The modified gen p mean: 0.4529207944869995, gen p mean: -0.657992422580719, mean p set: 0.4534010887145996
loss_pred:0.02637150138616562, decouple_loss:0.016309747472405434
loss_pred:0.027537662535905838, decouple_loss:0.01636609062552452
loss_pred:0.027968797832727432, decouple_loss:0.017405441030859947
Iteration: 1586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515368342399597, gen p mean: -0.6608783602714539, mean p set: 0.4520170986652374
The modified gen p mean: 0.4519626498222351, gen p mean: -0.6703383326530457, mean p set: 0.4524429440498352
The modified gen p mean: 0.4521728754043579, gen p mean: -0.6696181893348694, mean p set: 0.452653169631958
loss_pred:0.028777314350008965, decouple_loss:0.016685061156749725
loss_pred:0.02731752023100853, decouple_loss:0.01689685508608818
loss_pred:0.029334956780076027, decouple_loss:0.017405357211828232
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
NaN value num: 0
Iteration: 1587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45159173011779785, gen p mean: -0.6714001297950745, mean p set: 0.45207199454307556
The modified gen p mean: 0.4501641094684601, gen p mean: -0.6725751757621765, mean p set: 0.4506444036960602
The modified gen p mean: 0.44981470704078674, gen p mean: -0.671542763710022, mean p set: 0.45029497146606445
loss_pred:0.027189094573259354, decouple_loss:0.016960715875029564
loss_pred:0.02726737968623638, decouple_loss:0.016806067898869514
loss_pred:0.027939733117818832, decouple_loss:0.017058802768588066
Iteration: 1588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493039548397064, gen p mean: -0.6646476984024048, mean p set: 0.4497842490673065
The modified gen p mean: 0.44979918003082275, gen p mean: -0.6683436036109924, mean p set: 0.45027947425842285
The modified gen p mean: 0.450730562210083, gen p mean: -0.6696042418479919, mean p set: 0.4512108564376831
loss_pred:0.027739282697439194, decouple_loss:0.017391810193657875
loss_pred:0.027735959738492966, decouple_loss:0.01820157654583454
loss_pred:0.027534103021025658, decouple_loss:0.016739143058657646
Iteration: 1589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491910934448242, gen p mean: -0.6581801176071167, mean p set: 0.4496713876724243
The modified gen p mean: 0.45020654797554016, gen p mean: -0.6606494784355164, mean p set: 0.45068684220314026
The modified gen p mean: 0.4491015076637268, gen p mean: -0.6502854228019714, mean p set: 0.4495818316936493
loss_pred:0.026760155335068703, decouple_loss:0.017517605796456337loss_pred:0.02809797041118145, decouple_loss:0.018292414024472237
loss_pred:0.02837146818637848, decouple_loss:0.017213420942425728
Iteration: 1590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499325454235077, gen p mean: -0.653875470161438, mean p set: 0.4504128098487854
The modified gen p mean: 0.44895103573799133, gen p mean: -0.6473349332809448, mean p set: 0.44943130016326904
The modified gen p mean: 0.450371652841568, gen p mean: -0.6574290990829468, mean p set: 0.4508519768714905
loss_pred:0.02761908248066902, decouple_loss:0.016835246235132217
loss_pred:0.027754299342632294, decouple_loss:0.01645115204155445
loss_pred:0.026207195594906807, decouple_loss:0.016064228489995003
2023-05-03 00:51:32 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6620016694068909, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.6691375374794006, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6577464938163757, mean p set: 0.45035696029663086
loss_pred:0.028542501851916313, decouple_loss:0.018233170732855797
loss_pred:0.02961859665811062, decouple_loss:0.01879030093550682
loss_pred:0.028134167194366455, decouple_loss:0.018369315192103386
WV_0_PC_1_EH_0_PS_40_6, loss: 0.029688304290175438, avg_mse: 0.03418295085430145
current test mse: 0.034183
Iteration: 1591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45103469491004944, gen p mean: -0.671633780002594, mean p set: 0.45151498913764954
The modified gen p mean: 0.4494132697582245, gen p mean: -0.6581068634986877, mean p set: 0.4498935639858246
loss_pred:0.028837785124778748, decouple_loss:0.01857784204185009
loss_pred:0.02784356288611889, decouple_loss:0.017196204513311386
The modified gen p mean: 0.45135101675987244, gen p mean: -0.6609105467796326, mean p set: 0.45183131098747253
loss_pred:0.02582451142370701, decouple_loss:0.015795361250638962
Iteration: 1592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45021852850914, gen p mean: -0.6589035987854004, mean p set: 0.4506988525390625
The modified gen p mean: 0.4511227011680603, gen p mean: -0.6642779111862183, mean p set: 0.4516029953956604
The modified gen p mean: 0.45075684785842896, gen p mean: -0.6720283627510071, mean p set: 0.45123711228370667
loss_pred:0.02706749550998211, decouple_loss:0.016760490834712982
loss_pred:0.027452390640974045, decouple_loss:0.016556115821003914
loss_pred:0.02879319153726101, decouple_loss:0.018687903881072998
Iteration: 1593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45062196254730225, gen p mean: -0.6682553291320801, mean p set: 0.45110228657722473
The modified gen p mean: 0.4498765468597412, gen p mean: -0.6684069633483887, mean p set: 0.4503568708896637
The modified gen p mean: 0.45003724098205566, gen p mean: -0.6756622195243835, mean p set: 0.45051753520965576
loss_pred:0.02929048426449299, decouple_loss:0.01690993644297123
loss_pred:0.027572160586714745, decouple_loss:0.01586754247546196
loss_pred:0.027698103338479996, decouple_loss:0.016743747517466545
Iteration: 1594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495488703250885, gen p mean: -0.6816467046737671, mean p set: 0.4500291645526886
The modified gen p mean: 0.4495244026184082, gen p mean: -0.6788017153739929, mean p set: 0.4500047266483307
The modified gen p mean: 0.45033037662506104, gen p mean: -0.6730002760887146, mean p set: 0.45081067085266113
loss_pred:0.027382733300328255, decouple_loss:0.016701769083738327
loss_pred:0.027896955609321594, decouple_loss:0.016766736283898354
loss_pred:0.026926368474960327, decouple_loss:0.017030857503414154
Iteration: 1595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499701261520386, gen p mean: -0.6884720921516418, mean p set: 0.45045042037963867
The modified gen p mean: 0.4500882625579834, gen p mean: -0.6861007213592529, mean p set: 0.4505685865879059
The modified gen p mean: 0.44926661252975464, gen p mean: -0.6777817606925964, mean p set: 0.4497469365596771
loss_pred:0.02760014310479164, decouple_loss:0.01602916046977043
loss_pred:0.028896475210785866, decouple_loss:0.017368532717227936
loss_pred:0.027531085535883904, decouple_loss:0.016106128692626953
Iteration: 1596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504880905151367, gen p mean: -0.6717555522918701, mean p set: 0.4509684145450592
The modified gen p mean: 0.4500886797904968, gen p mean: -0.6775624752044678, mean p set: 0.4505689740180969
The modified gen p mean: 0.45027145743370056, gen p mean: -0.6786216497421265, mean p set: 0.45075175166130066
loss_pred:0.027809906750917435, decouple_loss:0.01699111796915531
loss_pred:0.027483774349093437, decouple_loss:0.01616237498819828
loss_pred:0.02900550700724125, decouple_loss:0.016714105382561684
Iteration: 1597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510660469532013, gen p mean: -0.6635611653327942, mean p set: 0.4515463411808014
The modified gen p mean: 0.4491123855113983, gen p mean: -0.6649075746536255, mean p set: 0.449592649936676
The modified gen p mean: 0.4499249756336212, gen p mean: -0.6629320383071899, mean p set: 0.4504052996635437
loss_pred:0.027423353865742683, decouple_loss:0.017139561474323273
loss_pred:0.027117207646369934, decouple_loss:0.01684577949345112
loss_pred:0.027399079874157906, decouple_loss:0.017218202352523804
Iteration: 1598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44990256428718567, gen p mean: -0.6539117693901062, mean p set: 0.45038288831710815
The modified gen p mean: 0.4500146210193634, gen p mean: -0.667786717414856, mean p set: 0.4504949152469635
The modified gen p mean: 0.45193353295326233, gen p mean: -0.6581270694732666, mean p set: 0.45241379737854004
loss_pred:0.02770458161830902, decouple_loss:0.01712166704237461
loss_pred:0.027226997539401054, decouple_loss:0.0154425585642457
loss_pred:0.0272109005600214, decouple_loss:0.01667146570980549
Iteration: 1599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45067375898361206, gen p mean: -0.6702564358711243, mean p set: 0.45115405321121216
The modified gen p mean: 0.44988730549812317, gen p mean: -0.6720320582389832, mean p set: 0.45036759972572327
The modified gen p mean: 0.4501987099647522, gen p mean: -0.6626887321472168, mean p set: 0.4506790041923523
loss_pred:0.026023123413324356, decouple_loss:0.016365785151720047
loss_pred:0.027735091745853424, decouple_loss:0.015527460724115372
loss_pred:0.027046125382184982, decouple_loss:0.016720453277230263
Iteration: 1600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45033109188079834, gen p mean: -0.674914538860321, mean p set: 0.45081138610839844
The modified gen p mean: 0.4490172863006592, gen p mean: -0.6610496044158936, mean p set: 0.4494975507259369
The modified gen p mean: 0.4497401714324951, gen p mean: -0.6598241925239563, mean p set: 0.4502204656600952
loss_pred:0.027936628088355064, decouple_loss:0.017158538103103638
loss_pred:0.027259215712547302, decouple_loss:0.015963388606905937
loss_pred:0.02749931998550892, decouple_loss:0.01591721549630165
2023-05-03 00:55:14 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6609894633293152, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.6681707501411438, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6565476059913635, mean p set: 0.45035696029663086
loss_pred:0.02861154079437256, decouple_loss:0.017899516969919205
loss_pred:0.029535183683037758, decouple_loss:0.018510308116674423
loss_pred:0.028119487687945366, decouple_loss:0.018196674063801765
WV_0_PC_1_EH_0_PS_40_6, loss: 0.0296655111014843, avg_mse: 0.034180447459220886
current test mse: 0.03418
Iteration: 1601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483855068683624, gen p mean: -0.6509817242622375, mean p set: 0.4488658010959625
loss_pred:0.027485523372888565, decouple_loss:0.015988238155841827
The modified gen p mean: 0.4506820738315582, gen p mean: -0.658576250076294, mean p set: 0.45116233825683594
loss_pred:0.02718333899974823, decouple_loss:0.015869570896029472
The modified gen p mean: 0.4502076208591461, gen p mean: -0.6568392515182495, mean p set: 0.4506879150867462
loss_pred:0.02825610153377056, decouple_loss:0.01583659090101719
Iteration: 1602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45183154940605164, gen p mean: -0.6640901565551758, mean p set: 0.4523118734359741
The modified gen p mean: 0.449672669172287, gen p mean: -0.6603310704231262, mean p set: 0.4501529335975647
The modified gen p mean: 0.45050114393234253, gen p mean: -0.6601589918136597, mean p set: 0.45098140835762024
loss_pred:0.02793399803340435, decouple_loss:0.015520453453063965
loss_pred:0.02713164873421192, decouple_loss:0.015185468830168247
loss_pred:0.027323251590132713, decouple_loss:0.01558993011713028
Iteration: 1603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45027074217796326, gen p mean: -0.6614525318145752, mean p set: 0.45075103640556335
The modified gen p mean: 0.4505167007446289, gen p mean: -0.6661291122436523, mean p set: 0.450996994972229
The modified gen p mean: 0.4509523808956146, gen p mean: -0.6632363796234131, mean p set: 0.4514326751232147
loss_pred:0.027098393067717552, decouple_loss:0.01580122672021389
loss_pred:0.026807986199855804, decouple_loss:0.015594563446938992
loss_pred:0.02653324045240879, decouple_loss:0.01586795784533024
Iteration: 1604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45214927196502686, gen p mean: -0.6682212352752686, mean p set: 0.45262953639030457
The modified gen p mean: 0.44838088750839233, gen p mean: -0.6584348082542419, mean p set: 0.44886115193367004
The modified gen p mean: 0.4492405652999878, gen p mean: -0.6633619070053101, mean p set: 0.4497208595275879
loss_pred:0.027170948684215546, decouple_loss:0.01542524341493845
loss_pred:0.027413399890065193, decouple_loss:0.015397068113088608
loss_pred:0.028082937002182007, decouple_loss:0.015784209594130516
Iteration: 1605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44896262884140015, gen p mean: -0.6578997373580933, mean p set: 0.44944292306900024
The modified gen p mean: 0.44981926679611206, gen p mean: -0.6712230443954468, mean p set: 0.45029953122138977
The modified gen p mean: 0.44908952713012695, gen p mean: -0.6690906286239624, mean p set: 0.44956985116004944
loss_pred:0.027248675003647804, decouple_loss:0.015338266268372536
loss_pred:0.027629459276795387, decouple_loss:0.016734765842556953
loss_pred:0.027236275374889374, decouple_loss:0.016526520252227783
Iteration: 1606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490228295326233, gen p mean: -0.6646171808242798, mean p set: 0.4495031237602234
The modified gen p mean: 0.4513145387172699, gen p mean: -0.6620259284973145, mean p set: 0.45179483294487
The modified gen p mean: 0.45185530185699463, gen p mean: -0.6636168956756592, mean p set: 0.4523356258869171
loss_pred:0.02693074382841587, decouple_loss:0.01595110446214676
loss_pred:0.027136176824569702, decouple_loss:0.017119884490966797
loss_pred:0.02668784372508526, decouple_loss:0.01580413058400154
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 1607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482540488243103, gen p mean: -0.6659756898880005, mean p set: 0.4487343728542328
The modified gen p mean: 0.44782358407974243, gen p mean: -0.6654825806617737, mean p set: 0.44830387830734253
The modified gen p mean: 0.4465106725692749, gen p mean: -0.6650995016098022, mean p set: 0.446990966796875
loss_pred:0.029569879174232483, decouple_loss:0.018533771857619286
loss_pred:0.027882013469934464, decouple_loss:0.018690573051571846
loss_pred:0.029576117172837257, decouple_loss:0.018493523821234703
Iteration: 1608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492338299751282, gen p mean: -0.6681464910507202, mean p set: 0.44971415400505066
The modified gen p mean: 0.4508858025074005, gen p mean: -0.6652154326438904, mean p set: 0.4513660967350006
The modified gen p mean: 0.4490843415260315, gen p mean: -0.6675348281860352, mean p set: 0.4495646357536316
loss_pred:0.028566252440214157, decouple_loss:0.017956998199224472
loss_pred:0.0286069568246603, decouple_loss:0.016776379197835922
loss_pred:0.027992606163024902, decouple_loss:0.01716434210538864
Iteration: 1609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486162066459656, gen p mean: -0.6650399565696716, mean p set: 0.4490965008735657
The modified gen p mean: 0.4473828077316284, gen p mean: -0.6628352999687195, mean p set: 0.4478631317615509
The modified gen p mean: 0.44879150390625, gen p mean: -0.6638425588607788, mean p set: 0.4492718279361725
loss_pred:0.028769489377737045, decouple_loss:0.017119217664003372
loss_pred:0.027625739574432373, decouple_loss:0.016384130343794823
loss_pred:0.02802431955933571, decouple_loss:0.016669202595949173
Iteration: 1610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475911259651184, gen p mean: -0.6681821346282959, mean p set: 0.4480714499950409
The modified gen p mean: 0.448636531829834, gen p mean: -0.6691229939460754, mean p set: 0.4491168260574341
The modified gen p mean: 0.4478696584701538, gen p mean: -0.673894464969635, mean p set: 0.4483499228954315
loss_pred:0.026788190007209778, decouple_loss:0.016311757266521454
loss_pred:0.028812304139137268, decouple_loss:0.01665510982275009
loss_pred:0.027077127248048782, decouple_loss:0.017224276438355446
2023-05-03 00:59:35 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6879459023475647, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6811599731445312, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6766669154167175, mean p set: 0.45035696029663086
loss_pred:0.029378244653344154, decouple_loss:0.017113517969846725
loss_pred:0.02829524129629135, decouple_loss:0.01699785515666008
loss_pred:0.02780434489250183, decouple_loss:0.016772834584116936
WV_0_PC_1_EH_0_PS_40_6, loss: 0.029340680688619614, avg_mse: 0.033733293414115906
current test mse: 0.033733
Iteration: 1611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732072949409485, gen p mean: -0.6769624352455139, mean p set: 0.44780102372169495
The modified gen p mean: 0.4475422203540802, gen p mean: -0.6795894503593445, mean p set: 0.4480225145816803
loss_pred:0.028462346643209457, decouple_loss:0.01664920523762703
loss_pred:0.02843823842704296, decouple_loss:0.016599951311945915
The modified gen p mean: 0.4476674795150757, gen p mean: -0.6797484755516052, mean p set: 0.4481477439403534
loss_pred:0.028960885480046272, decouple_loss:0.01691575162112713
Iteration: 1612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796425104141235, gen p mean: -0.6817286014556885, mean p set: 0.44844454526901245
The modified gen p mean: 0.4483461380004883, gen p mean: -0.6841409206390381, mean p set: 0.4488264322280884
The modified gen p mean: 0.4494085907936096, gen p mean: -0.6793051958084106, mean p set: 0.44988885521888733
loss_pred:0.027532225474715233, decouple_loss:0.016667883843183517
loss_pred:0.027483664453029633, decouple_loss:0.016343317925930023
loss_pred:0.028605589643120766, decouple_loss:0.016537286341190338
Iteration: 1613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44872066378593445, gen p mean: -0.6695578098297119, mean p set: 0.44920095801353455
The modified gen p mean: 0.44656041264533997, gen p mean: -0.6635634303092957, mean p set: 0.44704070687294006
The modified gen p mean: 0.4483340084552765, gen p mean: -0.6691224575042725, mean p set: 0.4488143026828766
loss_pred:0.02815423160791397, decouple_loss:0.016757823526859283
loss_pred:0.0271065142005682, decouple_loss:0.016535667702555656
loss_pred:0.027903936803340912, decouple_loss:0.016641825437545776
Iteration: 1614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467921853065491, gen p mean: -0.6658056974411011, mean p set: 0.4472724497318268
The modified gen p mean: 0.4480462074279785, gen p mean: -0.6623702645301819, mean p set: 0.4485265016555786
The modified gen p mean: 0.44727641344070435, gen p mean: -0.6646867990493774, mean p set: 0.44775673747062683
loss_pred:0.02791929803788662, decouple_loss:0.01684139482676983
loss_pred:0.027074936777353287, decouple_loss:0.016810016706585884
loss_pred:0.027587130665779114, decouple_loss:0.016700277104973793
Iteration: 1615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481023848056793, gen p mean: -0.666210412979126, mean p set: 0.4485826790332794
The modified gen p mean: 0.4479285478591919, gen p mean: -0.6624163389205933, mean p set: 0.448408842086792
The modified gen p mean: 0.44806262850761414, gen p mean: -0.6641858220100403, mean p set: 0.44854292273521423
loss_pred:0.027713002637028694, decouple_loss:0.015593504533171654
loss_pred:0.028206275776028633, decouple_loss:0.015941059216856956
loss_pred:0.027546068653464317, decouple_loss:0.015606998465955257
Iteration: 1616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756534695625305, gen p mean: -0.6629193425178528, mean p set: 0.44804564118385315The modified gen p mean: 0.4488388001918793, gen p mean: -0.6674814820289612, mean p set: 0.449319064617157
The modified gen p mean: 0.4482864737510681, gen p mean: -0.6683229804039001, mean p set: 0.4487667679786682
loss_pred:0.028208499774336815, decouple_loss:0.015237110666930676
loss_pred:0.0277947336435318, decouple_loss:0.016164788976311684
loss_pred:0.027710342779755592, decouple_loss:0.015460869297385216
Iteration: 1617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481866657733917, gen p mean: -0.663957953453064, mean p set: 0.44866693019866943
The modified gen p mean: 0.4482608139514923, gen p mean: -0.6628723740577698, mean p set: 0.4487411379814148
The modified gen p mean: 0.4481053054332733, gen p mean: -0.6588025093078613, mean p set: 0.4485855996608734
loss_pred:0.027788907289505005, decouple_loss:0.015307358466088772
loss_pred:0.026622185483574867, decouple_loss:0.01602894440293312
loss_pred:0.028153620660305023, decouple_loss:0.01583220809698105
Iteration: 1618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484059512615204, gen p mean: -0.6537457704544067, mean p set: 0.4488862454891205
The modified gen p mean: 0.44835537672042847, gen p mean: -0.6527628302574158, mean p set: 0.44883567094802856
The modified gen p mean: 0.4487585425376892, gen p mean: -0.6534115672111511, mean p set: 0.4492388665676117
loss_pred:0.028570853173732758, decouple_loss:0.014881499111652374
loss_pred:0.028824234381318092, decouple_loss:0.015614613890647888
loss_pred:0.02718409337103367, decouple_loss:0.015861693769693375
Iteration: 1619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788697361946106, gen p mean: -0.6602198481559753, mean p set: 0.44836726784706116
The modified gen p mean: 0.44935524463653564, gen p mean: -0.6529693603515625, mean p set: 0.44983553886413574
The modified gen p mean: 0.44847527146339417, gen p mean: -0.6570426821708679, mean p set: 0.44895556569099426
loss_pred:0.026926571503281593, decouple_loss:0.015032704919576645
loss_pred:0.027743693441152573, decouple_loss:0.015947656705975533
loss_pred:0.02845669910311699, decouple_loss:0.01600874401628971
Iteration: 1620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477776288986206, gen p mean: -0.6576112508773804, mean p set: 0.4482579529285431
The modified gen p mean: 0.4487621486186981, gen p mean: -0.6524226069450378, mean p set: 0.4492424428462982
The modified gen p mean: 0.4477505087852478, gen p mean: -0.6571819186210632, mean p set: 0.4482307732105255
loss_pred:0.027839958667755127, decouple_loss:0.015316913835704327
loss_pred:0.02745727449655533, decouple_loss:0.0157275702804327
loss_pred:0.027095865458250046, decouple_loss:0.015380287542939186
2023-05-03 01:03:20 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6642819046974182, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6572893261909485, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6530080437660217, mean p set: 0.45035696029663086
loss_pred:0.029101530089974403, decouple_loss:0.01621786504983902
loss_pred:0.028046883642673492, decouple_loss:0.016078820452094078
loss_pred:0.027682645246386528, decouple_loss:0.016136037185788155
WV_0_PC_1_EH_0_PS_40_6, loss: 0.029084231704473495, avg_mse: 0.033434487879276276
current test mse: 0.033434
Iteration: 1621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44615504145622253, gen p mean: -0.6502084732055664, mean p set: 0.44663533568382263
loss_pred:0.02739628590643406, decouple_loss:0.015959950163960457
The modified gen p mean: 0.44865861535072327, gen p mean: -0.6535375714302063, mean p set: 0.44913890957832336
loss_pred:0.027118001133203506, decouple_loss:0.015351349487900734
The modified gen p mean: 0.4483143091201782, gen p mean: -0.6558935642242432, mean p set: 0.44879457354545593
loss_pred:0.027719490230083466, decouple_loss:0.015379565767943859
Iteration: 1622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828712940216064, gen p mean: -0.6570228338241577, mean p set: 0.44876742362976074
The modified gen p mean: 0.4470710754394531, gen p mean: -0.6603336930274963, mean p set: 0.44755133986473083
The modified gen p mean: 0.4487472176551819, gen p mean: -0.659760057926178, mean p set: 0.4492274820804596
loss_pred:0.028014492243528366, decouple_loss:0.016292864456772804
loss_pred:0.026969771832227707, decouple_loss:0.015227479860186577
loss_pred:0.027844268828630447, decouple_loss:0.015474931336939335
Iteration: 1623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44962185621261597, gen p mean: -0.6643781661987305, mean p set: 0.4501021206378937
The modified gen p mean: 0.45018261671066284, gen p mean: -0.6638919115066528, mean p set: 0.45066288113594055
The modified gen p mean: 0.44837528467178345, gen p mean: -0.665610671043396, mean p set: 0.44885557889938354
loss_pred:0.02756642922759056, decouple_loss:0.015823643654584885
loss_pred:0.028012655675411224, decouple_loss:0.015329407528042793
loss_pred:0.027194863185286522, decouple_loss:0.01486920565366745
Iteration: 1624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44871824979782104, gen p mean: -0.6692554354667664, mean p set: 0.44919851422309875
The modified gen p mean: 0.4463944733142853, gen p mean: -0.6618092060089111, mean p set: 0.4468747675418854
The modified gen p mean: 0.44761234521865845, gen p mean: -0.6668276190757751, mean p set: 0.44809263944625854
loss_pred:0.028275204822421074, decouple_loss:0.014758054167032242
loss_pred:0.02791994996368885, decouple_loss:0.015245869755744934
loss_pred:0.02773704007267952, decouple_loss:0.015828406438231468
Iteration: 1625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44850486516952515, gen p mean: -0.6607197523117065, mean p set: 0.44898515939712524
The modified gen p mean: 0.4502047896385193, gen p mean: -0.6625945568084717, mean p set: 0.450685054063797
The modified gen p mean: 0.44748514890670776, gen p mean: -0.6643044948577881, mean p set: 0.44796544313430786
loss_pred:0.02732439897954464, decouple_loss:0.014868397265672684
loss_pred:0.028028149157762527, decouple_loss:0.015320848673582077
loss_pred:0.027972759678959846, decouple_loss:0.015699127689003944
Iteration: 1626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477931559085846, gen p mean: -0.6615182161331177, mean p set: 0.4482734203338623
The modified gen p mean: 0.44648703932762146, gen p mean: -0.6598595976829529, mean p set: 0.44696733355522156
The modified gen p mean: 0.4481760859489441, gen p mean: -0.6659346222877502, mean p set: 0.4486563205718994
loss_pred:0.027074990794062614, decouple_loss:0.014701705425977707
loss_pred:0.02687183953821659, decouple_loss:0.014919565990567207
loss_pred:0.027686448767781258, decouple_loss:0.014679490588605404
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
NaN value num: 0
Iteration: 1627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451200932264328, gen p mean: -0.6602728962898254, mean p set: 0.4516811966896057
The modified gen p mean: 0.45136839151382446, gen p mean: -0.6681795716285706, mean p set: 0.4518486559391022
The modified gen p mean: 0.4503021836280823, gen p mean: -0.6727640628814697, mean p set: 0.45078244805336
loss_pred:0.027582243084907532, decouple_loss:0.01757785864174366
loss_pred:0.028536545112729073, decouple_loss:0.017274927347898483
loss_pred:0.028694182634353638, decouple_loss:0.01732160709798336
Iteration: 1628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508442282676697, gen p mean: -0.6704488396644592, mean p set: 0.4513244926929474
The modified gen p mean: 0.45091626048088074, gen p mean: -0.6642051935195923, mean p set: 0.45139649510383606
The modified gen p mean: 0.4500894844532013, gen p mean: -0.6728743314743042, mean p set: 0.4505697786808014
loss_pred:0.029109925031661987, decouple_loss:0.01741521991789341
loss_pred:0.03022073581814766, decouple_loss:0.016391614452004433
loss_pred:0.030333789065480232, decouple_loss:0.016564341261982918
Iteration: 1629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45091500878334045, gen p mean: -0.67058265209198, mean p set: 0.45139533281326294
The modified gen p mean: 0.451437383890152, gen p mean: -0.6620975732803345, mean p set: 0.4519176781177521
The modified gen p mean: 0.4510484039783478, gen p mean: -0.677787721157074, mean p set: 0.45152872800827026
loss_pred:0.028363162651658058, decouple_loss:0.01626921258866787
loss_pred:0.028337568044662476, decouple_loss:0.01632336899638176
loss_pred:0.02821393497288227, decouple_loss:0.01686151511967182
Iteration: 1630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45128583908081055, gen p mean: -0.6691756844520569, mean p set: 0.45176616311073303
The modified gen p mean: 0.449104905128479, gen p mean: -0.669208288192749, mean p set: 0.4495851993560791
The modified gen p mean: 0.4513743817806244, gen p mean: -0.6753290891647339, mean p set: 0.4518546462059021
loss_pred:0.028698645532131195, decouple_loss:0.016386138275265694
loss_pred:0.02896239422261715, decouple_loss:0.016215665265917778
loss_pred:0.028476769104599953, decouple_loss:0.01730109192430973
2023-05-03 01:07:41 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6760976314544678, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.6831322908401489, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6714389324188232, mean p set: 0.45035696029663086
loss_pred:0.028268808498978615, decouple_loss:0.017480049282312393
loss_pred:0.029331084340810776, decouple_loss:0.01788647659122944
loss_pred:0.027937110513448715, decouple_loss:0.01738589257001877
WV_0_PC_1_EH_0_PS_40_6, loss: 0.029391542077064514, avg_mse: 0.03377147391438484
current test mse: 0.033771
Iteration: 1631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508809447288513, gen p mean: -0.668744683265686, mean p set: 0.4513612687587738
The modified gen p mean: 0.4504493772983551, gen p mean: -0.6774152517318726, mean p set: 0.4509296715259552
loss_pred:0.028540991246700287, decouple_loss:0.016036799177527428
loss_pred:0.03026486746966839, decouple_loss:0.016036516055464745
The modified gen p mean: 0.45011213421821594, gen p mean: -0.683911919593811, mean p set: 0.4505924582481384
loss_pred:0.028080321848392487, decouple_loss:0.016688905656337738
Iteration: 1632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505902826786041, gen p mean: -0.6741012930870056, mean p set: 0.4510705769062042
The modified gen p mean: 0.45113706588745117, gen p mean: -0.6709787845611572, mean p set: 0.45161738991737366
The modified gen p mean: 0.4500940144062042, gen p mean: -0.6813591122627258, mean p set: 0.4505743086338043
loss_pred:0.02795952558517456, decouple_loss:0.016211824491620064
loss_pred:0.02716844342648983, decouple_loss:0.01617366634309292
loss_pred:0.029017869383096695, decouple_loss:0.015755001455545425
Iteration: 1633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498027265071869, gen p mean: -0.6787545084953308, mean p set: 0.450283020734787
The modified gen p mean: 0.4497884511947632, gen p mean: -0.6821045279502869, mean p set: 0.4502687156200409
The modified gen p mean: 0.45087429881095886, gen p mean: -0.6787199974060059, mean p set: 0.45135459303855896
loss_pred:0.027627944946289062, decouple_loss:0.016389643773436546
loss_pred:0.02792300097644329, decouple_loss:0.015769999474287033
loss_pred:0.027702897787094116, decouple_loss:0.015769686549901962
Iteration: 1634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45126527547836304, gen p mean: -0.6682907938957214, mean p set: 0.45174556970596313
The modified gen p mean: 0.45096108317375183, gen p mean: -0.6684496402740479, mean p set: 0.45144134759902954
The modified gen p mean: 0.45015034079551697, gen p mean: -0.6695092916488647, mean p set: 0.45063063502311707
loss_pred:0.029385056346654892, decouple_loss:0.016247093677520752
loss_pred:0.02842455543577671, decouple_loss:0.01594134420156479
loss_pred:0.02817382849752903, decouple_loss:0.015928542241454124
Iteration: 1635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45102566480636597, gen p mean: -0.6730120778083801, mean p set: 0.45150595903396606
The modified gen p mean: 0.4511512517929077, gen p mean: -0.6658788323402405, mean p set: 0.4516315758228302
The modified gen p mean: 0.45211338996887207, gen p mean: -0.667401134967804, mean p set: 0.45259371399879456
loss_pred:0.028106819838285446, decouple_loss:0.015769880264997482
loss_pred:0.02918648160994053, decouple_loss:0.017057595774531364
loss_pred:0.02814325876533985, decouple_loss:0.017239658161997795
Iteration: 1636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45252034068107605, gen p mean: -0.6747150421142578, mean p set: 0.45300063490867615
The modified gen p mean: 0.45080429315567017, gen p mean: -0.6670471429824829, mean p set: 0.45128458738327026
The modified gen p mean: 0.4505552351474762, gen p mean: -0.6635688543319702, mean p set: 0.4510355293750763
loss_pred:0.0272354893386364, decouple_loss:0.01585356891155243
loss_pred:0.02964022010564804, decouple_loss:0.016027553007006645
loss_pred:0.02802574262022972, decouple_loss:0.016103604808449745
Iteration: 1637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503532648086548, gen p mean: -0.6723155975341797, mean p set: 0.4508335292339325
The modified gen p mean: 0.4487875998020172, gen p mean: -0.6705448031425476, mean p set: 0.4492678940296173
The modified gen p mean: 0.4501175284385681, gen p mean: -0.6724724173545837, mean p set: 0.4505978226661682
loss_pred:0.028628533706068993, decouple_loss:0.016231082379817963
loss_pred:0.028714971616864204, decouple_loss:0.0161458570510149
loss_pred:0.027869516983628273, decouple_loss:0.01567419432103634
Iteration: 1638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45000413060188293, gen p mean: -0.6766741871833801, mean p set: 0.45048442482948303
The modified gen p mean: 0.4500954747200012, gen p mean: -0.6766557097434998, mean p set: 0.4505757987499237
The modified gen p mean: 0.44879794120788574, gen p mean: -0.6744880676269531, mean p set: 0.44927823543548584
loss_pred:0.028780527412891388, decouple_loss:0.01620957814157009
loss_pred:0.02775849588215351, decouple_loss:0.015591245144605637
loss_pred:0.029006067663431168, decouple_loss:0.015377619303762913
Iteration: 1639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498886168003082, gen p mean: -0.6696831583976746, mean p set: 0.4503689110279083
The modified gen p mean: 0.45150989294052124, gen p mean: -0.6725653409957886, mean p set: 0.45199018716812134
The modified gen p mean: 0.4503122568130493, gen p mean: -0.6744645237922668, mean p set: 0.4507925808429718
loss_pred:0.029090765863656998, decouple_loss:0.015206921845674515
loss_pred:0.028308605775237083, decouple_loss:0.01570773683488369
loss_pred:0.028063565492630005, decouple_loss:0.015266950242221355
Iteration: 1640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45070645213127136, gen p mean: -0.6747344732284546, mean p set: 0.4511867165565491
The modified gen p mean: 0.45217272639274597, gen p mean: -0.6759828329086304, mean p set: 0.45265302062034607
The modified gen p mean: 0.45170944929122925, gen p mean: -0.6745747923851013, mean p set: 0.45218974351882935
loss_pred:0.029623353853821754, decouple_loss:0.015555266290903091
loss_pred:0.02735316753387451, decouple_loss:0.015336347743868828
loss_pred:0.028688911348581314, decouple_loss:0.01513760071247816
2023-05-03 01:11:25 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6731380820274353, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6806812286376953, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6681193709373474, mean p set: 0.45035696029663086
loss_pred:0.028153834864497185, decouple_loss:0.016799138858914375
loss_pred:0.02921311929821968, decouple_loss:0.017015717923641205
loss_pred:0.027765749022364616, decouple_loss:0.01684090867638588
WV_0_PC_1_EH_0_PS_40_6, loss: 0.029221830889582634, avg_mse: 0.03370298817753792
current test mse: 0.033703
Iteration: 1641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503536522388458, gen p mean: -0.6781364679336548, mean p set: 0.45083388686180115
loss_pred:0.028739802539348602, decouple_loss:0.015274833887815475
The modified gen p mean: 0.4503781795501709, gen p mean: -0.6783382892608643, mean p set: 0.450858473777771
loss_pred:0.02872491627931595, decouple_loss:0.01510399580001831
The modified gen p mean: 0.4505714178085327, gen p mean: -0.6797699332237244, mean p set: 0.4510516822338104
loss_pred:0.027432799339294434, decouple_loss:0.014567060396075249
Iteration: 1642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45093023777008057, gen p mean: -0.6707211136817932, mean p set: 0.45141053199768066
The modified gen p mean: 0.4508250951766968, gen p mean: -0.6843968629837036, mean p set: 0.4513053894042969
The modified gen p mean: 0.45091378688812256, gen p mean: -0.682354211807251, mean p set: 0.45139408111572266
loss_pred:0.02945864014327526, decouple_loss:0.015412230044603348
loss_pred:0.02744978480041027, decouple_loss:0.015232148580253124
loss_pred:0.028480475768446922, decouple_loss:0.014817916788160801
Iteration: 1643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450673371553421, gen p mean: -0.6821945309638977, mean p set: 0.4511536657810211
The modified gen p mean: 0.45181915163993835, gen p mean: -0.6861175894737244, mean p set: 0.45229944586753845
The modified gen p mean: 0.4503456652164459, gen p mean: -0.685603678226471, mean p set: 0.4508259892463684
loss_pred:0.027981190010905266, decouple_loss:0.014528955332934856loss_pred:0.028040811419487, decouple_loss:0.01569034904241562
loss_pred:0.02720107138156891, decouple_loss:0.014996888116002083
Iteration: 1644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515972435474396, gen p mean: -0.6766539216041565, mean p set: 0.4520775377750397
The modified gen p mean: 0.4508654773235321, gen p mean: -0.6672701239585876, mean p set: 0.4513457417488098
The modified gen p mean: 0.4504936635494232, gen p mean: -0.6736289858818054, mean p set: 0.4509739875793457
loss_pred:0.02958221174776554, decouple_loss:0.015164421871304512
loss_pred:0.02737629972398281, decouple_loss:0.015339629724621773
loss_pred:0.028270797803997993, decouple_loss:0.014703481458127499
Iteration: 1645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506233036518097, gen p mean: -0.6682050228118896, mean p set: 0.4511035680770874
The modified gen p mean: 0.450674831867218, gen p mean: -0.6647441387176514, mean p set: 0.4511551260948181
The modified gen p mean: 0.450306236743927, gen p mean: -0.6725485324859619, mean p set: 0.4507865309715271
loss_pred:0.028818124905228615, decouple_loss:0.014850284904241562
loss_pred:0.02962513640522957, decouple_loss:0.014976740814745426
loss_pred:0.02712559886276722, decouple_loss:0.014163226820528507
Iteration: 1646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45160576701164246, gen p mean: -0.661625862121582, mean p set: 0.45208606123924255
The modified gen p mean: 0.4508184790611267, gen p mean: -0.6634811162948608, mean p set: 0.4512987732887268
The modified gen p mean: 0.45182347297668457, gen p mean: -0.6638541221618652, mean p set: 0.4523037374019623
loss_pred:0.028798941522836685, decouple_loss:0.014988932758569717
loss_pred:0.02801738679409027, decouple_loss:0.015081518329679966
loss_pred:0.028375010937452316, decouple_loss:0.01500308234244585
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
NaN value num: 0
Iteration: 1647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45150044560432434, gen p mean: -0.6740576028823853, mean p set: 0.45198073983192444
The modified gen p mean: 0.4504871368408203, gen p mean: -0.6811090707778931, mean p set: 0.4509674608707428
The modified gen p mean: 0.4493529200553894, gen p mean: -0.6675325036048889, mean p set: 0.4498332440853119
loss_pred:0.027142299339175224, decouple_loss:0.01498070452362299
loss_pred:0.02698386088013649, decouple_loss:0.015044364146888256
loss_pred:0.027500730007886887, decouple_loss:0.016001615673303604
Iteration: 1648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45285388827323914, gen p mean: -0.6825999021530151, mean p set: 0.45333418250083923
The modified gen p mean: 0.4528367221355438, gen p mean: -0.6832758784294128, mean p set: 0.4533170461654663
The modified gen p mean: 0.45027345418930054, gen p mean: -0.6881638765335083, mean p set: 0.45075374841690063
loss_pred:0.026573535054922104, decouple_loss:0.015748431906104088
loss_pred:0.02645290270447731, decouple_loss:0.0158532727509737
loss_pred:0.028105782344937325, decouple_loss:0.015192181803286076
Iteration: 1649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45214930176734924, gen p mean: -0.6828291416168213, mean p set: 0.45262959599494934
The modified gen p mean: 0.4515511989593506, gen p mean: -0.6868908405303955, mean p set: 0.4520314931869507
The modified gen p mean: 0.44981178641319275, gen p mean: -0.6801363825798035, mean p set: 0.45029211044311523
loss_pred:0.02652973122894764, decouple_loss:0.015631897374987602
loss_pred:0.02686304785311222, decouple_loss:0.015448378399014473
loss_pred:0.027527976781129837, decouple_loss:0.014152364805340767
Iteration: 1650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511222541332245, gen p mean: -0.68910151720047, mean p set: 0.4516025483608246
The modified gen p mean: 0.45127806067466736, gen p mean: -0.6814488172531128, mean p set: 0.45175832509994507
The modified gen p mean: 0.45160701870918274, gen p mean: -0.6813947558403015, mean p set: 0.45208731293678284
loss_pred:0.02800672873854637, decouple_loss:0.015275352634489536
loss_pred:0.027421457692980766, decouple_loss:0.014481957070529461
loss_pred:0.02764163911342621, decouple_loss:0.015506532974541187
2023-05-03 01:15:45 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6724119782447815, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.6798405647277832, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6676507592201233, mean p set: 0.45035696029663086
loss_pred:0.028065545484423637, decouple_loss:0.0171921718865633
loss_pred:0.029141416773200035, decouple_loss:0.017360206693410873
loss_pred:0.027683300897479057, decouple_loss:0.017249884083867073
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02916012704372406, avg_mse: 0.033658094704151154
current test mse: 0.033658
Iteration: 1651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496949315071106, gen p mean: -0.6683570742607117, mean p set: 0.4501752555370331
loss_pred:0.02726556360721588, decouple_loss:0.014467555098235607
The modified gen p mean: 0.44903847575187683, gen p mean: -0.6705708503723145, mean p set: 0.44951876997947693
loss_pred:0.026377219706773758, decouple_loss:0.01592717133462429
The modified gen p mean: 0.44813987612724304, gen p mean: -0.6785338521003723, mean p set: 0.44862014055252075
loss_pred:0.027220644056797028, decouple_loss:0.015444636344909668
Iteration: 1652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44996708631515503, gen p mean: -0.6843818426132202, mean p set: 0.4504474103450775
The modified gen p mean: 0.44978779554367065, gen p mean: -0.6872367858886719, mean p set: 0.45026808977127075
The modified gen p mean: 0.45058420300483704, gen p mean: -0.6861916780471802, mean p set: 0.4510645270347595
loss_pred:0.02692882902920246, decouple_loss:0.015489999204874039
loss_pred:0.027603408321738243, decouple_loss:0.014852955937385559
loss_pred:0.027213210240006447, decouple_loss:0.014675362966954708
Iteration: 1653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509528577327728, gen p mean: -0.6799175143241882, mean p set: 0.4514331519603729
The modified gen p mean: 0.45277976989746094, gen p mean: -0.6814340949058533, mean p set: 0.45326003432273865
The modified gen p mean: 0.4518389105796814, gen p mean: -0.6800854802131653, mean p set: 0.4523191750049591
loss_pred:0.026469960808753967, decouple_loss:0.015335408970713615
loss_pred:0.026735030114650726, decouple_loss:0.015446075238287449
loss_pred:0.02763967216014862, decouple_loss:0.015614914707839489
Iteration: 1654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448850154876709, gen p mean: -0.6852684020996094, mean p set: 0.4493304491043091
The modified gen p mean: 0.4507520794868469, gen p mean: -0.678295910358429, mean p set: 0.4512324035167694
The modified gen p mean: 0.44892239570617676, gen p mean: -0.6820069551467896, mean p set: 0.44940266013145447
loss_pred:0.027192560955882072, decouple_loss:0.014910636469721794
loss_pred:0.02653176710009575, decouple_loss:0.014967680908739567
loss_pred:0.026435470208525658, decouple_loss:0.014955328777432442
Iteration: 1655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512248933315277, gen p mean: -0.6813177466392517, mean p set: 0.4517051577568054
The modified gen p mean: 0.451507031917572, gen p mean: -0.6888695955276489, mean p set: 0.4519873261451721
The modified gen p mean: 0.4514136016368866, gen p mean: -0.6813621520996094, mean p set: 0.4518939256668091
loss_pred:0.02622871659696102, decouple_loss:0.014827782288193703
loss_pred:0.02809356525540352, decouple_loss:0.015135656110942364
loss_pred:0.02695298381149769, decouple_loss:0.015469943173229694
Iteration: 1656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512796401977539, gen p mean: -0.6823252439498901, mean p set: 0.4517599642276764
The modified gen p mean: 0.450160413980484, gen p mean: -0.6801638007164001, mean p set: 0.4506407380104065
The modified gen p mean: 0.4490898847579956, gen p mean: -0.6923269629478455, mean p set: 0.4495701789855957
loss_pred:0.025937044993042946, decouple_loss:0.015280093997716904
loss_pred:0.02641620673239231, decouple_loss:0.015121817588806152
loss_pred:0.027855312451720238, decouple_loss:0.014827420003712177
Iteration: 1657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514739513397217, gen p mean: -0.6924799680709839, mean p set: 0.45195427536964417
The modified gen p mean: 0.45166492462158203, gen p mean: -0.6925379633903503, mean p set: 0.4521452486515045
The modified gen p mean: 0.44874751567840576, gen p mean: -0.6942040324211121, mean p set: 0.44922778010368347
loss_pred:0.025914834812283516, decouple_loss:0.014575132168829441
loss_pred:0.026794208213686943, decouple_loss:0.014426572248339653
loss_pred:0.027171051129698753, decouple_loss:0.014831696636974812
Iteration: 1658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493926763534546, gen p mean: -0.6873142719268799, mean p set: 0.4498729407787323
The modified gen p mean: 0.45118170976638794, gen p mean: -0.6861255764961243, mean p set: 0.4516620337963104
The modified gen p mean: 0.4499928653240204, gen p mean: -0.700567901134491, mean p set: 0.4504731595516205
loss_pred:0.027831321582198143, decouple_loss:0.0146701755002141
loss_pred:0.026108046993613243, decouple_loss:0.01469810213893652
loss_pred:0.027466019615530968, decouple_loss:0.0151700833812356
Iteration: 1659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45082294940948486, gen p mean: -0.6878007054328918, mean p set: 0.45130327343940735
The modified gen p mean: 0.4476620852947235, gen p mean: -0.6895346641540527, mean p set: 0.448142409324646
The modified gen p mean: 0.45145177841186523, gen p mean: -0.6886794567108154, mean p set: 0.4519321024417877
loss_pred:0.027241934090852737, decouple_loss:0.014546818099915981loss_pred:0.02676301822066307, decouple_loss:0.014426441863179207
loss_pred:0.02686939388513565, decouple_loss:0.01474912092089653
Iteration: 1660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493885636329651, gen p mean: -0.6862149834632874, mean p set: 0.4498688280582428
The modified gen p mean: 0.44950807094573975, gen p mean: -0.6811876893043518, mean p set: 0.44998836517333984
The modified gen p mean: 0.4513486325740814, gen p mean: -0.6805854439735413, mean p set: 0.4518289566040039
loss_pred:0.026982642710208893, decouple_loss:0.01448104903101921
loss_pred:0.02710028737783432, decouple_loss:0.014701876789331436
loss_pred:0.02578866295516491, decouple_loss:0.014547822996973991
2023-05-03 01:19:27 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6852637529373169, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.6929721236228943, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6804187297821045, mean p set: 0.45035696029663086
loss_pred:0.028141239657998085, decouple_loss:0.01684197597205639
loss_pred:0.029212184250354767, decouple_loss:0.016682397574186325
loss_pred:0.02775651402771473, decouple_loss:0.016959136351943016
WV_0_PC_1_EH_0_PS_40_6, loss: 0.029211372137069702, avg_mse: 0.033736586570739746
current test mse: 0.033737
Iteration: 1661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449867308139801, gen p mean: -0.6821640133857727, mean p set: 0.4503476321697235
loss_pred:0.02625557966530323, decouple_loss:0.01471995934844017
The modified gen p mean: 0.45039647817611694, gen p mean: -0.6946881413459778, mean p set: 0.45087674260139465
loss_pred:0.028360635042190552, decouple_loss:0.014719955623149872
The modified gen p mean: 0.4511565864086151, gen p mean: -0.6941640377044678, mean p set: 0.4516368806362152
loss_pred:0.028065893799066544, decouple_loss:0.014848415739834309
Iteration: 1662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44905152916908264, gen p mean: -0.6923328638076782, mean p set: 0.44953182339668274
The modified gen p mean: 0.45149609446525574, gen p mean: -0.6949355602264404, mean p set: 0.45197638869285583
The modified gen p mean: 0.4492553770542145, gen p mean: -0.685060441493988, mean p set: 0.4497356712818146
loss_pred:0.02648114040493965, decouple_loss:0.014700035564601421
loss_pred:0.02614007145166397, decouple_loss:0.014172232709825039
loss_pred:0.026256289333105087, decouple_loss:0.01414331141859293
Iteration: 1663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44980132579803467, gen p mean: -0.7024202942848206, mean p set: 0.45028162002563477
The modified gen p mean: 0.44974350929260254, gen p mean: -0.7052605748176575, mean p set: 0.45022377371788025
The modified gen p mean: 0.45197880268096924, gen p mean: -0.6976205110549927, mean p set: 0.4524591267108917
loss_pred:0.027665961533784866, decouple_loss:0.013952188193798065
loss_pred:0.02701708674430847, decouple_loss:0.01454211212694645
loss_pred:0.026669934391975403, decouple_loss:0.014280336908996105
Iteration: 1664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513408839702606, gen p mean: -0.6895047426223755, mean p set: 0.4518211781978607
The modified gen p mean: 0.45114535093307495, gen p mean: -0.6992987394332886, mean p set: 0.45162567496299744
The modified gen p mean: 0.44974252581596375, gen p mean: -0.7001090049743652, mean p set: 0.45022279024124146
loss_pred:0.027297424152493477, decouple_loss:0.01494272705167532
loss_pred:0.027829043567180634, decouple_loss:0.01450340449810028
loss_pred:0.02700614370405674, decouple_loss:0.013807771727442741
Iteration: 1665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496873617172241, gen p mean: -0.7009356021881104, mean p set: 0.4501676559448242
The modified gen p mean: 0.4528837502002716, gen p mean: -0.6950973868370056, mean p set: 0.4533640444278717
The modified gen p mean: 0.4512358009815216, gen p mean: -0.6913524270057678, mean p set: 0.4517160654067993
loss_pred:0.027608642354607582, decouple_loss:0.014650731347501278
loss_pred:0.02656869776546955, decouple_loss:0.014893447048962116
loss_pred:0.026954038068652153, decouple_loss:0.013978119939565659
Iteration: 1666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44991931319236755, gen p mean: -0.6947944164276123, mean p set: 0.45039960741996765
The modified gen p mean: 0.44943609833717346, gen p mean: -0.6894289255142212, mean p set: 0.4499163329601288
The modified gen p mean: 0.4494718015193939, gen p mean: -0.6878536343574524, mean p set: 0.449952095746994
loss_pred:0.027423713356256485, decouple_loss:0.014214478433132172
loss_pred:0.028200458735227585, decouple_loss:0.014247401617467403
loss_pred:0.026165824383497238, decouple_loss:0.014561432413756847
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
NaN value num: 0
Iteration: 1667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45115718245506287, gen p mean: -0.6831338405609131, mean p set: 0.45163747668266296
The modified gen p mean: 0.44897037744522095, gen p mean: -0.6657403707504272, mean p set: 0.44945064187049866
The modified gen p mean: 0.44946759939193726, gen p mean: -0.6666101813316345, mean p set: 0.44994789361953735
loss_pred:0.028007078915834427, decouple_loss:0.018237853422760963
loss_pred:0.02883731573820114, decouple_loss:0.018303928896784782
loss_pred:0.02617518976330757, decouple_loss:0.016042714938521385
Iteration: 1668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449858158826828, gen p mean: -0.680282711982727, mean p set: 0.4503384232521057
The modified gen p mean: 0.4503400921821594, gen p mean: -0.6750683784484863, mean p set: 0.4508203864097595
The modified gen p mean: 0.4513459801673889, gen p mean: -0.677706241607666, mean p set: 0.451826274394989
loss_pred:0.026757273823022842, decouple_loss:0.016182316467165947
loss_pred:0.02699723280966282, decouple_loss:0.015217019245028496
loss_pred:0.02746189385652542, decouple_loss:0.015464731492102146
Iteration: 1669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449162095785141, gen p mean: -0.6807841062545776, mean p set: 0.4496423602104187
The modified gen p mean: 0.45066478848457336, gen p mean: -0.6940529942512512, mean p set: 0.4511450529098511
The modified gen p mean: 0.45023593306541443, gen p mean: -0.693731427192688, mean p set: 0.4507162272930145
loss_pred:0.02818644605576992, decouple_loss:0.0168563611805439
loss_pred:0.02587471902370453, decouple_loss:0.01566147990524769
loss_pred:0.02655167318880558, decouple_loss:0.015970399603247643
Iteration: 1670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45100221037864685, gen p mean: -0.6981503963470459, mean p set: 0.4514824450016022
The modified gen p mean: 0.4498558044433594, gen p mean: -0.6955206394195557, mean p set: 0.4503360688686371
The modified gen p mean: 0.4499132037162781, gen p mean: -0.6974974870681763, mean p set: 0.4503934979438782
loss_pred:0.027041025459766388, decouple_loss:0.01589524745941162
loss_pred:0.02795853465795517, decouple_loss:0.016961000859737396
loss_pred:0.027399616315960884, decouple_loss:0.016304995864629745
2023-05-03 01:23:48 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6933763027191162, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7006730437278748, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6888570189476013, mean p set: 0.45035696029663086
loss_pred:0.028326822444796562, decouple_loss:0.017487281933426857
loss_pred:0.029355354607105255, decouple_loss:0.017468830570578575
loss_pred:0.027850277721881866, decouple_loss:0.017585378140211105
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02938651107251644, avg_mse: 0.03406314551830292
current test mse: 0.034063
Iteration: 1671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45188191533088684, gen p mean: -0.6894471049308777, mean p set: 0.4523622393608093
The modified gen p mean: 0.4502314031124115, gen p mean: -0.6926617622375488, mean p set: 0.4507116973400116
loss_pred:0.026986705139279366, decouple_loss:0.014971739612519741
loss_pred:0.028309354558587074, decouple_loss:0.01626775972545147
The modified gen p mean: 0.45049548149108887, gen p mean: -0.6821721196174622, mean p set: 0.45097577571868896
loss_pred:0.027502713724970818, decouple_loss:0.015151256695389748
Iteration: 1672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450458288192749, gen p mean: -0.6857471466064453, mean p set: 0.4509385824203491
The modified gen p mean: 0.44900110363960266, gen p mean: -0.6808064579963684, mean p set: 0.44948139786720276
The modified gen p mean: 0.44920992851257324, gen p mean: -0.689565122127533, mean p set: 0.44969022274017334
loss_pred:0.02689000591635704, decouple_loss:0.015181057155132294
loss_pred:0.027354011312127113, decouple_loss:0.016809867694973946
loss_pred:0.02705802582204342, decouple_loss:0.015566855669021606
Iteration: 1673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507354199886322, gen p mean: -0.6875117421150208, mean p set: 0.4512156844139099The modified gen p mean: 0.45046085119247437, gen p mean: -0.6905252933502197, mean p set: 0.45094114542007446
The modified gen p mean: 0.4520038962364197, gen p mean: -0.6895486116409302, mean p set: 0.4524841606616974
loss_pred:0.0261553842574358, decouple_loss:0.015382367186248302
loss_pred:0.02596540004014969, decouple_loss:0.015734970569610596
loss_pred:0.027052761986851692, decouple_loss:0.015494481660425663
Iteration: 1674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44874173402786255, gen p mean: -0.6771641969680786, mean p set: 0.44922199845314026
The modified gen p mean: 0.4508376121520996, gen p mean: -0.6880470514297485, mean p set: 0.4513179361820221
The modified gen p mean: 0.4511900544166565, gen p mean: -0.6903058290481567, mean p set: 0.4516703188419342
loss_pred:0.028433946892619133, decouple_loss:0.016835913062095642
loss_pred:0.025347895920276642, decouple_loss:0.01535245031118393
loss_pred:0.028058331459760666, decouple_loss:0.015818770974874496
Iteration: 1675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44984209537506104, gen p mean: -0.6828563809394836, mean p set: 0.45032238960266113
The modified gen p mean: 0.4493979215621948, gen p mean: -0.6774083375930786, mean p set: 0.44987818598747253
The modified gen p mean: 0.45114797353744507, gen p mean: -0.6899308562278748, mean p set: 0.45162826776504517
loss_pred:0.027818674221634865, decouple_loss:0.015379155986011028
loss_pred:0.028092900291085243, decouple_loss:0.016229946166276932
loss_pred:0.02528935670852661, decouple_loss:0.014957074075937271
Iteration: 1676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506933391094208, gen p mean: -0.6794663071632385, mean p set: 0.4511736333370209
The modified gen p mean: 0.45141905546188354, gen p mean: -0.6887156367301941, mean p set: 0.45189934968948364
The modified gen p mean: 0.45038580894470215, gen p mean: -0.6785658001899719, mean p set: 0.45086607336997986
loss_pred:0.026405032724142075, decouple_loss:0.01586175337433815
loss_pred:0.025399411097168922, decouple_loss:0.015054103918373585
loss_pred:0.028072340413928032, decouple_loss:0.015812473371624947
Iteration: 1677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018303394317627, gen p mean: -0.6799418330192566, mean p set: 0.450663298368454
The modified gen p mean: 0.4519405663013458, gen p mean: -0.6837993264198303, mean p set: 0.4524208605289459
The modified gen p mean: 0.45126938819885254, gen p mean: -0.6798354983329773, mean p set: 0.45174965262413025
loss_pred:0.027903808280825615, decouple_loss:0.015368388034403324
loss_pred:0.028019022196531296, decouple_loss:0.015855567529797554
loss_pred:0.025767825543880463, decouple_loss:0.015479660592973232
Iteration: 1678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513176381587982, gen p mean: -0.6842595934867859, mean p set: 0.4517979323863983
The modified gen p mean: 0.4514671266078949, gen p mean: -0.6846067309379578, mean p set: 0.4519474506378174
The modified gen p mean: 0.45063912868499756, gen p mean: -0.6784251928329468, mean p set: 0.45111945271492004
loss_pred:0.02512342855334282, decouple_loss:0.014486139640212059
loss_pred:0.025518156588077545, decouple_loss:0.014955966733396053
loss_pred:0.026980815455317497, decouple_loss:0.015048160217702389
Iteration: 1679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44925788044929504, gen p mean: -0.6723969578742981, mean p set: 0.44973814487457275
The modified gen p mean: 0.45023900270462036, gen p mean: -0.6753033399581909, mean p set: 0.45071932673454285
The modified gen p mean: 0.451149046421051, gen p mean: -0.678956925868988, mean p set: 0.4516293406486511
loss_pred:0.028330177068710327, decouple_loss:0.01747261919081211
loss_pred:0.027089513838291168, decouple_loss:0.015009304508566856
loss_pred:0.026391154155135155, decouple_loss:0.01442263275384903
Iteration: 1680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504604637622833, gen p mean: -0.6899107098579407, mean p set: 0.4509407579898834
The modified gen p mean: 0.45059841871261597, gen p mean: -0.691669762134552, mean p set: 0.4510786831378937
The modified gen p mean: 0.45053473114967346, gen p mean: -0.6872908473014832, mean p set: 0.45101502537727356
loss_pred:0.025569086894392967, decouple_loss:0.015553991310298443
loss_pred:0.025844471529126167, decouple_loss:0.015029298141598701
loss_pred:0.02710907533764839, decouple_loss:0.01549465861171484
2023-05-03 01:27:31 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6935486793518066, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6857573390007019, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6809458136558533, mean p set: 0.45035696029663086
loss_pred:0.02949630469083786, decouple_loss:0.017402872443199158
loss_pred:0.028405485674738884, decouple_loss:0.01738898828625679
loss_pred:0.02798713557422161, decouple_loss:0.017405947670340538
WV_0_PC_1_EH_0_PS_40_6, loss: 0.029499605298042297, avg_mse: 0.034225963056087494
current test mse: 0.034226
Iteration: 1681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508954584598541, gen p mean: -0.6837587952613831, mean p set: 0.4513757526874542
The modified gen p mean: 0.4522475600242615, gen p mean: -0.6871573328971863, mean p set: 0.45272788405418396
loss_pred:0.025888383388519287, decouple_loss:0.014699764549732208
loss_pred:0.028018178418278694, decouple_loss:0.01555109303444624
The modified gen p mean: 0.448184609413147, gen p mean: -0.6797470450401306, mean p set: 0.4486648738384247
loss_pred:0.02806725911796093, decouple_loss:0.01593717746436596
Iteration: 1682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506831169128418, gen p mean: -0.6745092868804932, mean p set: 0.4511634409427643
The modified gen p mean: 0.45038190484046936, gen p mean: -0.682189404964447, mean p set: 0.45086219906806946
The modified gen p mean: 0.450633704662323, gen p mean: -0.6815574169158936, mean p set: 0.4511139988899231
loss_pred:0.026839133352041245, decouple_loss:0.014458992518484592
loss_pred:0.027463313192129135, decouple_loss:0.014825431630015373
loss_pred:0.02755647525191307, decouple_loss:0.01498562190681696
Iteration: 1683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45125365257263184, gen p mean: -0.6742510199546814, mean p set: 0.45173394680023193
The modified gen p mean: 0.44835230708122253, gen p mean: -0.6674565076828003, mean p set: 0.448832631111145
The modified gen p mean: 0.4517821669578552, gen p mean: -0.677208662033081, mean p set: 0.4522624611854553
loss_pred:0.026352163404226303, decouple_loss:0.015028394758701324
loss_pred:0.02741856500506401, decouple_loss:0.01660105399787426
loss_pred:0.026935940608382225, decouple_loss:0.015218554995954037
Iteration: 1684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519505202770233, gen p mean: -0.6653843522071838, mean p set: 0.4524308443069458
The modified gen p mean: 0.45182275772094727, gen p mean: -0.6639454364776611, mean p set: 0.45230305194854736
The modified gen p mean: 0.448119193315506, gen p mean: -0.6592984199523926, mean p set: 0.4485994875431061
loss_pred:0.026414865627884865, decouple_loss:0.014392809942364693
loss_pred:0.026538142934441566, decouple_loss:0.01458433922380209
loss_pred:0.027281824499368668, decouple_loss:0.015874018892645836
Iteration: 1685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45099693536758423, gen p mean: -0.6778777241706848, mean p set: 0.4514772295951843
The modified gen p mean: 0.448144793510437, gen p mean: -0.6671041250228882, mean p set: 0.4486250877380371
The modified gen p mean: 0.4511793255805969, gen p mean: -0.6750324964523315, mean p set: 0.451659619808197
loss_pred:0.02621985413134098, decouple_loss:0.014215230941772461
loss_pred:0.027421588078141212, decouple_loss:0.015844110399484634
loss_pred:0.02574898861348629, decouple_loss:0.014570902101695538
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
NaN value num: 0
Iteration: 1686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449298232793808, gen p mean: -0.6797772645950317, mean p set: 0.4497784972190857
The modified gen p mean: 0.4487052857875824, gen p mean: -0.6915991306304932, mean p set: 0.4491855800151825
The modified gen p mean: 0.44877374172210693, gen p mean: -0.6818473935127258, mean p set: 0.44925400614738464
loss_pred:0.029102442786097527, decouple_loss:0.017260141670703888
loss_pred:0.02936640940606594, decouple_loss:0.01753886416554451
loss_pred:0.03167108818888664, decouple_loss:0.016839655116200447
Iteration: 1687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44816696643829346, gen p mean: -0.6916529536247253, mean p set: 0.44864723086357117
The modified gen p mean: 0.44849124550819397, gen p mean: -0.6883918642997742, mean p set: 0.44897153973579407
The modified gen p mean: 0.4499937891960144, gen p mean: -0.6863289475440979, mean p set: 0.4504740536212921
loss_pred:0.029920527711510658, decouple_loss:0.016718901693820953
loss_pred:0.028983287513256073, decouple_loss:0.01616889238357544
loss_pred:0.029151638969779015, decouple_loss:0.016067365184426308
Iteration: 1688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819748401641846, gen p mean: -0.6849634647369385, mean p set: 0.44867777824401855
The modified gen p mean: 0.45013242959976196, gen p mean: -0.679193377494812, mean p set: 0.45061272382736206
The modified gen p mean: 0.44825479388237, gen p mean: -0.6847836971282959, mean p set: 0.4487350583076477
loss_pred:0.029119474813342094, decouple_loss:0.016008751466870308
loss_pred:0.030145196244120598, decouple_loss:0.016532737761735916
loss_pred:0.029193386435508728, decouple_loss:0.01636696420609951
Iteration: 1689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790875911712646, gen p mean: -0.6753420233726501, mean p set: 0.4483890235424042The modified gen p mean: 0.44922593235969543, gen p mean: -0.6804490685462952, mean p set: 0.4497062563896179
The modified gen p mean: 0.44872575998306274, gen p mean: -0.6927313804626465, mean p set: 0.44920605421066284
loss_pred:0.029264988377690315, decouple_loss:0.015889447182416916loss_pred:0.028868133202195168, decouple_loss:0.015549639239907265
loss_pred:0.029065333306789398, decouple_loss:0.016846733167767525
Iteration: 1690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486444890499115, gen p mean: -0.6868090033531189, mean p set: 0.4491247832775116
The modified gen p mean: 0.4495718479156494, gen p mean: -0.6740421652793884, mean p set: 0.4500521421432495
The modified gen p mean: 0.44972896575927734, gen p mean: -0.6769365072250366, mean p set: 0.45020923018455505
loss_pred:0.02893374301493168, decouple_loss:0.016129449009895325
loss_pred:0.028247462585568428, decouple_loss:0.016011470928788185
loss_pred:0.029873192310333252, decouple_loss:0.015560956671833992
2023-05-03 01:31:52 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6815468072891235, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.6890312433242798, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6771366000175476, mean p set: 0.45035696029663086
loss_pred:0.028082234784960747, decouple_loss:0.01646455004811287
loss_pred:0.028938109055161476, decouple_loss:0.016581937670707703
loss_pred:0.027655979618430138, decouple_loss:0.01655604876577854
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02905214950442314, avg_mse: 0.033637505024671555
current test mse: 0.033638
Iteration: 1691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497492015361786, gen p mean: -0.6825711727142334, mean p set: 0.4502294957637787
The modified gen p mean: 0.4497009813785553, gen p mean: -0.6888346076011658, mean p set: 0.4501812756061554
loss_pred:0.02986549586057663, decouple_loss:0.015918107703328133
loss_pred:0.02979310043156147, decouple_loss:0.016828715801239014
The modified gen p mean: 0.4489402174949646, gen p mean: -0.6727266907691956, mean p set: 0.4494204819202423
loss_pred:0.030592413619160652, decouple_loss:0.01585143432021141
Iteration: 1692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44963371753692627, gen p mean: -0.691299557685852, mean p set: 0.450113981962204
The modified gen p mean: 0.4490707218647003, gen p mean: -0.681792676448822, mean p set: 0.4495510160923004
The modified gen p mean: 0.44904962182044983, gen p mean: -0.6930522322654724, mean p set: 0.4495299160480499
loss_pred:0.029704377055168152, decouple_loss:0.01632525958120823
loss_pred:0.031176000833511353, decouple_loss:0.01572117768228054
loss_pred:0.029477180913090706, decouple_loss:0.015747390687465668
Iteration: 1693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877657294273376, gen p mean: -0.6870056390762329, mean p set: 0.44925686717033386
The modified gen p mean: 0.44881120324134827, gen p mean: -0.6801872849464417, mean p set: 0.44929149746894836
The modified gen p mean: 0.4481431543827057, gen p mean: -0.6782799959182739, mean p set: 0.4486234188079834
loss_pred:0.02936091274023056, decouple_loss:0.016039470210671425
loss_pred:0.030123068019747734, decouple_loss:0.01584678143262863
loss_pred:0.02907755598425865, decouple_loss:0.0157916359603405
Iteration: 1694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44987934827804565, gen p mean: -0.6846648454666138, mean p set: 0.45035961270332336
The modified gen p mean: 0.4495932459831238, gen p mean: -0.7005589604377747, mean p set: 0.4500735104084015
The modified gen p mean: 0.4491937756538391, gen p mean: -0.6831732392311096, mean p set: 0.44967401027679443
loss_pred:0.030222497880458832, decouple_loss:0.015245229005813599
loss_pred:0.028819192200899124, decouple_loss:0.016705112531781197
loss_pred:0.029079914093017578, decouple_loss:0.015739142894744873
Iteration: 1695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494662582874298, gen p mean: -0.6730183362960815, mean p set: 0.4499465525150299The modified gen p mean: 0.4496510624885559, gen p mean: -0.6794516444206238, mean p set: 0.4501313269138336
The modified gen p mean: 0.44935736060142517, gen p mean: -0.6724675893783569, mean p set: 0.44983765482902527
loss_pred:0.028525453060865402, decouple_loss:0.015635797753930092
loss_pred:0.027945557609200478, decouple_loss:0.015391144901514053
loss_pred:0.02783140540122986, decouple_loss:0.015394899994134903
Iteration: 1696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44985103607177734, gen p mean: -0.6768942475318909, mean p set: 0.45033130049705505
The modified gen p mean: 0.4502822160720825, gen p mean: -0.6701552271842957, mean p set: 0.4507625102996826
The modified gen p mean: 0.44895657896995544, gen p mean: -0.6648277044296265, mean p set: 0.44943687319755554
loss_pred:0.029715266078710556, decouple_loss:0.015079768374562263
loss_pred:0.029892373830080032, decouple_loss:0.015409219078719616
loss_pred:0.029617590829730034, decouple_loss:0.015153113752603531
Iteration: 1697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44917985796928406, gen p mean: -0.6715202927589417, mean p set: 0.44966015219688416
The modified gen p mean: 0.4486953318119049, gen p mean: -0.676080048084259, mean p set: 0.449175626039505
The modified gen p mean: 0.4496626853942871, gen p mean: -0.6705595850944519, mean p set: 0.4501429796218872
loss_pred:0.028626862913370132, decouple_loss:0.014972970820963383
loss_pred:0.02900840900838375, decouple_loss:0.015099192038178444
loss_pred:0.0285017229616642, decouple_loss:0.01486384216696024
Iteration: 1698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492073953151703, gen p mean: -0.6736544370651245, mean p set: 0.4496876895427704
The modified gen p mean: 0.45037806034088135, gen p mean: -0.6775778532028198, mean p set: 0.45085832476615906
The modified gen p mean: 0.4484509229660034, gen p mean: -0.6729554533958435, mean p set: 0.4489312171936035
loss_pred:0.029336534440517426, decouple_loss:0.01543089933693409
loss_pred:0.02909880317747593, decouple_loss:0.014804471284151077
loss_pred:0.029130300506949425, decouple_loss:0.014958311803638935
Iteration: 1699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494567811489105, gen p mean: -0.6780075430870056, mean p set: 0.4499370753765106
The modified gen p mean: 0.4488782286643982, gen p mean: -0.6746910214424133, mean p set: 0.4493584930896759
The modified gen p mean: 0.44854292273521423, gen p mean: -0.6821063160896301, mean p set: 0.44902318716049194
loss_pred:0.029209379106760025, decouple_loss:0.0142592191696167
loss_pred:0.030203646048903465, decouple_loss:0.014709512703120708
loss_pred:0.028466960415244102, decouple_loss:0.015528177842497826
Iteration: 1700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498935341835022, gen p mean: -0.6895535588264465, mean p set: 0.4503738284111023
The modified gen p mean: 0.4489961862564087, gen p mean: -0.6831374168395996, mean p set: 0.4494764804840088
The modified gen p mean: 0.4497392177581787, gen p mean: -0.6868956089019775, mean p set: 0.4502195417881012
loss_pred:0.028767963871359825, decouple_loss:0.01469586044549942
loss_pred:0.028764499351382256, decouple_loss:0.014486431144177914
loss_pred:0.029335644096136093, decouple_loss:0.015027975663542747
2023-05-03 01:35:36 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.684556245803833, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.691436767578125, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6798082590103149, mean p set: 0.45035696029663086
loss_pred:0.027854278683662415, decouple_loss:0.015480108559131622
loss_pred:0.02889445424079895, decouple_loss:0.01625470630824566
loss_pred:0.027512867003679276, decouple_loss:0.015671534463763237
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02887730672955513, avg_mse: 0.03342806547880173
current test mse: 0.033428
Iteration: 1701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501723051071167, gen p mean: -0.6835551857948303, mean p set: 0.4506526291370392
The modified gen p mean: 0.4485275149345398, gen p mean: -0.6846679449081421, mean p set: 0.4490078091621399
loss_pred:0.029936784878373146, decouple_loss:0.015140065923333168
loss_pred:0.02851041778922081, decouple_loss:0.01450929045677185
The modified gen p mean: 0.44877201318740845, gen p mean: -0.6857059597969055, mean p set: 0.44925227761268616
loss_pred:0.029137732461094856, decouple_loss:0.014309079386293888
Iteration: 1702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44995805621147156, gen p mean: -0.6876536011695862, mean p set: 0.45043838024139404
The modified gen p mean: 0.44961872696876526, gen p mean: -0.6857620477676392, mean p set: 0.45009905099868774
The modified gen p mean: 0.4499053955078125, gen p mean: -0.689807116985321, mean p set: 0.450385719537735
loss_pred:0.029001470655202866, decouple_loss:0.015277682803571224
loss_pred:0.02915097214281559, decouple_loss:0.014948679134249687
loss_pred:0.029263753443956375, decouple_loss:0.015322576276957989
Iteration: 1703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489441514015198, gen p mean: -0.6733595132827759, mean p set: 0.4494244158267975
The modified gen p mean: 0.4494793117046356, gen p mean: -0.6783238053321838, mean p set: 0.44995957612991333
The modified gen p mean: 0.4486680030822754, gen p mean: -0.6818671226501465, mean p set: 0.4491483271121979
loss_pred:0.02767239697277546, decouple_loss:0.01465380098670721
loss_pred:0.02889721468091011, decouple_loss:0.014567019417881966
loss_pred:0.028644360601902008, decouple_loss:0.015248765237629414
Iteration: 1704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44971853494644165, gen p mean: -0.6734297275543213, mean p set: 0.45019885897636414
The modified gen p mean: 0.44948074221611023, gen p mean: -0.6731230616569519, mean p set: 0.4499610364437103
The modified gen p mean: 0.4497183859348297, gen p mean: -0.6793797612190247, mean p set: 0.4501986801624298
loss_pred:0.029713204130530357, decouple_loss:0.014815855771303177
loss_pred:0.028987757861614227, decouple_loss:0.014082314446568489
loss_pred:0.02886148728430271, decouple_loss:0.014154159463942051
Iteration: 1705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969406723976135, gen p mean: -0.6843975186347961, mean p set: 0.45017439126968384
The modified gen p mean: 0.44827064871788025, gen p mean: -0.6806625127792358, mean p set: 0.44875091314315796
The modified gen p mean: 0.4492141306400299, gen p mean: -0.6808158159255981, mean p set: 0.44969442486763
loss_pred:0.02956063114106655, decouple_loss:0.014877158217132092
loss_pred:0.02907390706241131, decouple_loss:0.014502372592687607
loss_pred:0.029963472858071327, decouple_loss:0.014242351055145264
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
NaN value num: 0
Iteration: 1706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45230787992477417, gen p mean: -0.6874470710754395, mean p set: 0.45278817415237427
The modified gen p mean: 0.4503227770328522, gen p mean: -0.6812006831169128, mean p set: 0.45080307126045227
The modified gen p mean: 0.4515998959541321, gen p mean: -0.6891705989837646, mean p set: 0.4520801901817322
loss_pred:0.02806386537849903, decouple_loss:0.016667017713189125
loss_pred:0.02765507809817791, decouple_loss:0.01724855974316597
loss_pred:0.030155649408698082, decouple_loss:0.016606507822871208
Iteration: 1707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45034295320510864, gen p mean: -0.6855947971343994, mean p set: 0.45082327723503113
The modified gen p mean: 0.4510738253593445, gen p mean: -0.6794767379760742, mean p set: 0.4515541195869446
The modified gen p mean: 0.4503142237663269, gen p mean: -0.6787830591201782, mean p set: 0.450794517993927
loss_pred:0.028121471405029297, decouple_loss:0.016854524612426758
loss_pred:0.027537504211068153, decouple_loss:0.01643986441195011
loss_pred:0.02764357626438141, decouple_loss:0.016345463693141937
Iteration: 1708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44912317395210266, gen p mean: -0.6772894263267517, mean p set: 0.44960349798202515
The modified gen p mean: 0.45151910185813904, gen p mean: -0.69114089012146, mean p set: 0.45199936628341675
The modified gen p mean: 0.4501095116138458, gen p mean: -0.694455087184906, mean p set: 0.4505898058414459
loss_pred:0.02727493830025196, decouple_loss:0.015385792590677738
loss_pred:0.029253752902150154, decouple_loss:0.017234385013580322
loss_pred:0.02819322980940342, decouple_loss:0.01723877154290676
Iteration: 1709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511418342590332, gen p mean: -0.6772640347480774, mean p set: 0.4516221284866333
The modified gen p mean: 0.45162829756736755, gen p mean: -0.6839932799339294, mean p set: 0.45210859179496765
The modified gen p mean: 0.4519680142402649, gen p mean: -0.6766151189804077, mean p set: 0.4524483382701874
loss_pred:0.027689294889569283, decouple_loss:0.016234248876571655
loss_pred:0.02786419168114662, decouple_loss:0.015691982582211494
loss_pred:0.02910584956407547, decouple_loss:0.015555599704384804
Iteration: 1710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45093315839767456, gen p mean: -0.671157956123352, mean p set: 0.45141345262527466
The modified gen p mean: 0.45129847526550293, gen p mean: -0.6781831979751587, mean p set: 0.4517787992954254
The modified gen p mean: 0.4483846127986908, gen p mean: -0.6789077520370483, mean p set: 0.4488649070262909
loss_pred:0.028627820312976837, decouple_loss:0.015253590419888496
loss_pred:0.027353748679161072, decouple_loss:0.015624397434294224
loss_pred:0.02760966308414936, decouple_loss:0.016853801906108856
2023-05-03 01:39:54 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6834059357643127, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6906985640525818, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6788298487663269, mean p set: 0.45035696029663086
loss_pred:0.02807379700243473, decouple_loss:0.01703719235956669
loss_pred:0.029160715639591217, decouple_loss:0.0172349214553833
loss_pred:0.02765132114291191, decouple_loss:0.017299087718129158
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02915479801595211, avg_mse: 0.03379309922456741
current test mse: 0.033793
Iteration: 1711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494178593158722, gen p mean: -0.6873392462730408, mean p set: 0.4498981535434723
The modified gen p mean: 0.4496452510356903, gen p mean: -0.676125705242157, mean p set: 0.4501255452632904
loss_pred:0.027142930775880814, decouple_loss:0.0159428883343935
loss_pred:0.02677188627421856, decouple_loss:0.01541188359260559
The modified gen p mean: 0.45201241970062256, gen p mean: -0.6935567259788513, mean p set: 0.45249274373054504
loss_pred:0.028883030638098717, decouple_loss:0.01608681119978428
Iteration: 1712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45080244541168213, gen p mean: -0.6879858374595642, mean p set: 0.4512827396392822
The modified gen p mean: 0.45069530606269836, gen p mean: -0.6836045384407043, mean p set: 0.45117560029029846
The modified gen p mean: 0.45115208625793457, gen p mean: -0.6858503222465515, mean p set: 0.4516323506832123
loss_pred:0.027978146448731422, decouple_loss:0.015773853287100792
loss_pred:0.02678312361240387, decouple_loss:0.015352671034634113
loss_pred:0.027647141367197037, decouple_loss:0.016429465264081955
Iteration: 1713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44991496205329895, gen p mean: -0.6896091103553772, mean p set: 0.45039525628089905
The modified gen p mean: 0.4519338309764862, gen p mean: -0.6924414038658142, mean p set: 0.4524140954017639
The modified gen p mean: 0.44851183891296387, gen p mean: -0.6844943165779114, mean p set: 0.44899213314056396
loss_pred:0.027995070442557335, decouple_loss:0.015078858472406864
loss_pred:0.027421770617365837, decouple_loss:0.016095152124762535
loss_pred:0.027514763176441193, decouple_loss:0.015946494415402412
Iteration: 1714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45125114917755127, gen p mean: -0.698575496673584, mean p set: 0.451731413602829
The modified gen p mean: 0.45130401849746704, gen p mean: -0.696240246295929, mean p set: 0.4517843425273895
The modified gen p mean: 0.45340844988822937, gen p mean: -0.7033812999725342, mean p set: 0.45388877391815186
loss_pred:0.02941891923546791, decouple_loss:0.01620442420244217
loss_pred:0.03027973510324955, decouple_loss:0.0160862784832716
loss_pred:0.027881253510713577, decouple_loss:0.016624538227915764
Iteration: 1715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45115697383880615, gen p mean: -0.7000116109848022, mean p set: 0.45163723826408386
The modified gen p mean: 0.45139601826667786, gen p mean: -0.6873470544815063, mean p set: 0.45187628269195557
The modified gen p mean: 0.45144620537757874, gen p mean: -0.7041848301887512, mean p set: 0.4519265294075012
loss_pred:0.02784288115799427, decouple_loss:0.016036029905080795
loss_pred:0.02757362648844719, decouple_loss:0.01629248447716236
loss_pred:0.02829134464263916, decouple_loss:0.016920991241931915
Iteration: 1716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45256802439689636, gen p mean: -0.6973908543586731, mean p set: 0.45304831862449646
The modified gen p mean: 0.45078417658805847, gen p mean: -0.6854937076568604, mean p set: 0.45126447081565857
The modified gen p mean: 0.4502854347229004, gen p mean: -0.7014269232749939, mean p set: 0.4507656991481781
loss_pred:0.028120800852775574, decouple_loss:0.015497803688049316
loss_pred:0.02785913273692131, decouple_loss:0.014790697023272514
loss_pred:0.02835160493850708, decouple_loss:0.01601129211485386
Iteration: 1717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45188799500465393, gen p mean: -0.6920267343521118, mean p set: 0.45236828923225403
The modified gen p mean: 0.4499053955078125, gen p mean: -0.681914210319519, mean p set: 0.4503856897354126
The modified gen p mean: 0.45242762565612793, gen p mean: -0.6977126002311707, mean p set: 0.452907919883728
loss_pred:0.03004654310643673, decouple_loss:0.015144603326916695
loss_pred:0.028251470997929573, decouple_loss:0.01626243256032467
loss_pred:0.02797405607998371, decouple_loss:0.015382353216409683
Iteration: 1718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45186030864715576, gen p mean: -0.6853715181350708, mean p set: 0.45234063267707825
The modified gen p mean: 0.44956016540527344, gen p mean: -0.6827786564826965, mean p set: 0.45004045963287354
The modified gen p mean: 0.45097994804382324, gen p mean: -0.6783015131950378, mean p set: 0.45146021246910095
loss_pred:0.02840735763311386, decouple_loss:0.015311699360609055
loss_pred:0.027502428740262985, decouple_loss:0.015286085195839405
loss_pred:0.02758253924548626, decouple_loss:0.015453135594725609
Iteration: 1719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506705701351166, gen p mean: -0.6859553456306458, mean p set: 0.4511508643627167
The modified gen p mean: 0.4520045518875122, gen p mean: -0.6916182041168213, mean p set: 0.4524848163127899
The modified gen p mean: 0.44942525029182434, gen p mean: -0.6869695782661438, mean p set: 0.44990551471710205
loss_pred:0.027445444837212563, decouple_loss:0.016209222376346588
loss_pred:0.0275358147919178, decouple_loss:0.016348857432603836
loss_pred:0.027097363024950027, decouple_loss:0.01474449597299099
Iteration: 1720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515032470226288, gen p mean: -0.6855291724205017, mean p set: 0.4519835412502289
The modified gen p mean: 0.4514826536178589, gen p mean: -0.6843027472496033, mean p set: 0.4519629180431366
The modified gen p mean: 0.4512023627758026, gen p mean: -0.677801251411438, mean p set: 0.4516826570034027
loss_pred:0.026964686810970306, decouple_loss:0.016116958111524582
loss_pred:0.026834025979042053, decouple_loss:0.015612629242241383
loss_pred:0.02854200080037117, decouple_loss:0.014762233942747116
2023-05-03 01:43:33 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6893770694732666, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6970181465148926, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6848385334014893, mean p set: 0.45035696029663086
loss_pred:0.028264667838811874, decouple_loss:0.016598070040345192
loss_pred:0.029294010251760483, decouple_loss:0.016986487433314323
loss_pred:0.027796952053904533, decouple_loss:0.016933085396885872
WV_0_PC_1_EH_0_PS_40_6, loss: 0.029293838888406754, avg_mse: 0.034195318818092346
current test mse: 0.034195
Iteration: 1721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45245257019996643, gen p mean: -0.6979749202728271, mean p set: 0.45293283462524414
loss_pred:0.02775300107896328, decouple_loss:0.015636609867215157
The modified gen p mean: 0.45360514521598816, gen p mean: -0.7015763521194458, mean p set: 0.45408543944358826
loss_pred:0.027691401541233063, decouple_loss:0.015576808713376522
The modified gen p mean: 0.451077401638031, gen p mean: -0.6937604546546936, mean p set: 0.4515576958656311
loss_pred:0.027841078117489815, decouple_loss:0.015548438765108585
Iteration: 1722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505951404571533, gen p mean: -0.6973220109939575, mean p set: 0.4510754346847534
The modified gen p mean: 0.44933655858039856, gen p mean: -0.6947987675666809, mean p set: 0.44981685280799866
The modified gen p mean: 0.45090216398239136, gen p mean: -0.6989286541938782, mean p set: 0.45138245820999146
loss_pred:0.026843002066016197, decouple_loss:0.014857406727969646
loss_pred:0.026814254000782967, decouple_loss:0.01502080075442791
loss_pred:0.027949249371886253, decouple_loss:0.014921491965651512
Iteration: 1723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516259729862213, gen p mean: -0.6945858001708984, mean p set: 0.452106237411499
The modified gen p mean: 0.45071613788604736, gen p mean: -0.7100855112075806, mean p set: 0.4511964023113251
The modified gen p mean: 0.45069780945777893, gen p mean: -0.6930686235427856, mean p set: 0.45117807388305664
loss_pred:0.027236826717853546, decouple_loss:0.015176576562225819
loss_pred:0.027267230674624443, decouple_loss:0.01528739184141159
loss_pred:0.028000131249427795, decouple_loss:0.014178845100104809
Iteration: 1724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510691463947296, gen p mean: -0.7030956745147705, mean p set: 0.4515494108200073
The modified gen p mean: 0.4505295157432556, gen p mean: -0.6949824094772339, mean p set: 0.4510097801685333
The modified gen p mean: 0.4507061541080475, gen p mean: -0.7059710621833801, mean p set: 0.4511864483356476
loss_pred:0.027259379625320435, decouple_loss:0.015375235117971897
loss_pred:0.027272744104266167, decouple_loss:0.014318511821329594
loss_pred:0.027704274281859398, decouple_loss:0.01481823530048132
Iteration: 1725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514698386192322, gen p mean: -0.7072855830192566, mean p set: 0.4519501030445099
The modified gen p mean: 0.45307883620262146, gen p mean: -0.7141183018684387, mean p set: 0.45355916023254395
The modified gen p mean: 0.4498218894004822, gen p mean: -0.698436975479126, mean p set: 0.4503021836280823
loss_pred:0.027162721380591393, decouple_loss:0.015837403014302254
loss_pred:0.027584485709667206, decouple_loss:0.014899196103215218
loss_pred:0.02710908278822899, decouple_loss:0.014265645295381546
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
NaN value num: 0
Iteration: 1726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45053184032440186, gen p mean: -0.7015194892883301, mean p set: 0.45101216435432434
The modified gen p mean: 0.4482678472995758, gen p mean: -0.7007542848587036, mean p set: 0.4487481415271759
The modified gen p mean: 0.4491286873817444, gen p mean: -0.7050584554672241, mean p set: 0.4496089518070221
loss_pred:0.028453106060624123, decouple_loss:0.01661822758615017
loss_pred:0.028642768040299416, decouple_loss:0.016918374225497246
loss_pred:0.027161067351698875, decouple_loss:0.016089195385575294
Iteration: 1727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502372443675995, gen p mean: -0.6864259243011475, mean p set: 0.4507175385951996
The modified gen p mean: 0.4524902403354645, gen p mean: -0.6833088397979736, mean p set: 0.4529705345630646
The modified gen p mean: 0.4495984613895416, gen p mean: -0.6889529824256897, mean p set: 0.4500787556171417
loss_pred:0.02781805954873562, decouple_loss:0.015850314870476723
loss_pred:0.02768287993967533, decouple_loss:0.01641673780977726
loss_pred:0.028533393517136574, decouple_loss:0.015282275155186653
Iteration: 1728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44982486963272095, gen p mean: -0.6653963923454285, mean p set: 0.45030519366264343
The modified gen p mean: 0.45058462023735046, gen p mean: -0.6700870394706726, mean p set: 0.45106494426727295
The modified gen p mean: 0.449856698513031, gen p mean: -0.660894513130188, mean p set: 0.4503369629383087
loss_pred:0.0274489838629961, decouple_loss:0.01597515307366848
loss_pred:0.02781304158270359, decouple_loss:0.0154895493760705
loss_pred:0.027227360755205154, decouple_loss:0.016194788739085197
Iteration: 1729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486089050769806, gen p mean: -0.6580783724784851, mean p set: 0.4490891993045807
The modified gen p mean: 0.45101234316825867, gen p mean: -0.6537712812423706, mean p set: 0.45149263739585876
The modified gen p mean: 0.4490912854671478, gen p mean: -0.6511051654815674, mean p set: 0.4495715796947479
loss_pred:0.02867564558982849, decouple_loss:0.015197149477899075
loss_pred:0.027394115924835205, decouple_loss:0.015240905806422234
loss_pred:0.02793603204190731, decouple_loss:0.016205472871661186
Iteration: 1730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45079654455184937, gen p mean: -0.6665195822715759, mean p set: 0.45127683877944946
The modified gen p mean: 0.44832563400268555, gen p mean: -0.6713462471961975, mean p set: 0.44880592823028564
The modified gen p mean: 0.4528255760669708, gen p mean: -0.6656723618507385, mean p set: 0.45330584049224854
loss_pred:0.02701408974826336, decouple_loss:0.01574634201824665
loss_pred:0.02724537067115307, decouple_loss:0.015754692256450653
loss_pred:0.02868654951453209, decouple_loss:0.016259871423244476
2023-05-03 01:48:03 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6940182447433472, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6861828565597534, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6818338632583618, mean p set: 0.45035696029663086
loss_pred:0.02925233170390129, decouple_loss:0.017351701855659485
loss_pred:0.028218209743499756, decouple_loss:0.01720542646944523
loss_pred:0.027725033462047577, decouple_loss:0.017193708568811417
WV_0_PC_1_EH_0_PS_40_6, loss: 0.029261041432619095, avg_mse: 0.03400079160928726
current test mse: 0.034001
Iteration: 1731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45174381136894226, gen p mean: -0.680850625038147, mean p set: 0.45222410559654236
The modified gen p mean: 0.44978469610214233, gen p mean: -0.6782640218734741, mean p set: 0.45026499032974243
loss_pred:0.028483416885137558, decouple_loss:0.01623273640871048
loss_pred:0.026227673515677452, decouple_loss:0.01544747781008482
The modified gen p mean: 0.44956886768341064, gen p mean: -0.6858352422714233, mean p set: 0.45004913210868835
loss_pred:0.02828708291053772, decouple_loss:0.01632384955883026
Iteration: 1732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45107409358024597, gen p mean: -0.6878536939620972, mean p set: 0.4515543580055237
The modified gen p mean: 0.45146024227142334, gen p mean: -0.683664083480835, mean p set: 0.45194050669670105
The modified gen p mean: 0.44845959544181824, gen p mean: -0.6874946355819702, mean p set: 0.4489399194717407
loss_pred:0.028770392760634422, decouple_loss:0.016324134543538094
loss_pred:0.028587423264980316, decouple_loss:0.015911290422081947
loss_pred:0.026329325512051582, decouple_loss:0.0158469807356596
Iteration: 1733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44951194524765015, gen p mean: -0.683143675327301, mean p set: 0.44999220967292786
The modified gen p mean: 0.4491327106952667, gen p mean: -0.6786055564880371, mean p set: 0.44961294531822205
The modified gen p mean: 0.4486515522003174, gen p mean: -0.6896358728408813, mean p set: 0.4491318166255951
loss_pred:0.027609411627054214, decouple_loss:0.015861814841628075
loss_pred:0.027831967920064926, decouple_loss:0.015190765261650085
loss_pred:0.02600128762423992, decouple_loss:0.015468304045498371
Iteration: 1734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890713691711426, gen p mean: -0.6863657832145691, mean p set: 0.44938743114471436
The modified gen p mean: 0.4492291510105133, gen p mean: -0.6721389889717102, mean p set: 0.4497094452381134
The modified gen p mean: 0.4502503275871277, gen p mean: -0.6758105754852295, mean p set: 0.4507306218147278
loss_pred:0.02680826745927334, decouple_loss:0.014778769575059414
loss_pred:0.027415098622441292, decouple_loss:0.015572067350149155
loss_pred:0.027891172096133232, decouple_loss:0.015888173133134842
Iteration: 1735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508938491344452, gen p mean: -0.6725503206253052, mean p set: 0.4513741731643677
The modified gen p mean: 0.45325762033462524, gen p mean: -0.6688040494918823, mean p set: 0.45373791456222534
The modified gen p mean: 0.45049893856048584, gen p mean: -0.6744464635848999, mean p set: 0.45097923278808594
loss_pred:0.027394216507673264, decouple_loss:0.014955438673496246
loss_pred:0.028960496187210083, decouple_loss:0.015801047906279564
loss_pred:0.026555880904197693, decouple_loss:0.015305474400520325
Iteration: 1736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491983652114868, gen p mean: -0.6739680767059326, mean p set: 0.4496786296367645
The modified gen p mean: 0.45019111037254333, gen p mean: -0.6773973107337952, mean p set: 0.45067140460014343
The modified gen p mean: 0.4488903284072876, gen p mean: -0.6751726865768433, mean p set: 0.4493706524372101
loss_pred:0.02668287791311741, decouple_loss:0.015272826887667179
loss_pred:0.027150271460413933, decouple_loss:0.014939319342374802
loss_pred:0.027149615809321404, decouple_loss:0.015105328522622585
Iteration: 1737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489806294441223, gen p mean: -0.6716806888580322, mean p set: 0.4494609236717224
The modified gen p mean: 0.4497857689857483, gen p mean: -0.6729254126548767, mean p set: 0.4502660930156708
The modified gen p mean: 0.4497118890285492, gen p mean: -0.6771722435951233, mean p set: 0.4501922130584717
loss_pred:0.02745702676475048, decouple_loss:0.014803165569901466
loss_pred:0.027244461700320244, decouple_loss:0.014484080485999584
loss_pred:0.027501055970788002, decouple_loss:0.014722911641001701
Iteration: 1738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497421085834503, gen p mean: -0.6857469081878662, mean p set: 0.450222373008728
The modified gen p mean: 0.4501086175441742, gen p mean: -0.6762059330940247, mean p set: 0.4505888819694519
The modified gen p mean: 0.45114290714263916, gen p mean: -0.6742159128189087, mean p set: 0.45162320137023926
loss_pred:0.02719961479306221, decouple_loss:0.014123169705271721
loss_pred:0.02813069522380829, decouple_loss:0.014985478483140469
loss_pred:0.027286574244499207, decouple_loss:0.01537442859262228
Iteration: 1739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492603838443756, gen p mean: -0.6839990615844727, mean p set: 0.4497406780719757
The modified gen p mean: 0.44866570830345154, gen p mean: -0.6869388222694397, mean p set: 0.44914600253105164
The modified gen p mean: 0.45077428221702576, gen p mean: -0.6794352531433105, mean p set: 0.45125457644462585
loss_pred:0.026148803532123566, decouple_loss:0.014247115701436996
loss_pred:0.027740033343434334, decouple_loss:0.01532396487891674
loss_pred:0.02706252597272396, decouple_loss:0.014602476730942726
Iteration: 1740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517269432544708, gen p mean: -0.6812441945075989, mean p set: 0.45220720767974854
The modified gen p mean: 0.45099177956581116, gen p mean: -0.68791264295578, mean p set: 0.45147207379341125
The modified gen p mean: 0.4490293562412262, gen p mean: -0.681121289730072, mean p set: 0.4495096802711487
loss_pred:0.028633205220103264, decouple_loss:0.015627315267920494
loss_pred:0.0278740506619215, decouple_loss:0.01470967661589384
loss_pred:0.027880264446139336, decouple_loss:0.014800472185015678
2023-05-03 01:51:43 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6866534948348999, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.6943970322608948, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6820572018623352, mean p set: 0.45035696029663086
loss_pred:0.028060903772711754, decouple_loss:0.016457445919513702
loss_pred:0.029228705912828445, decouple_loss:0.016724005341529846
loss_pred:0.027583492919802666, decouple_loss:0.016624094918370247
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02912112884223461, avg_mse: 0.033899351954460144
current test mse: 0.033899
Iteration: 1741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484226107597351, gen p mean: -0.6849634647369385, mean p set: 0.4489029347896576
loss_pred:0.026083219796419144, decouple_loss:0.014754930511116982
The modified gen p mean: 0.4488146901130676, gen p mean: -0.679463267326355, mean p set: 0.44929495453834534
loss_pred:0.026977714151144028, decouple_loss:0.01439899392426014
The modified gen p mean: 0.44994911551475525, gen p mean: -0.6820773482322693, mean p set: 0.45042943954467773
loss_pred:0.027431705966591835, decouple_loss:0.014504381455481052
Iteration: 1742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493042528629303, gen p mean: -0.6801433563232422, mean p set: 0.4497845768928528
The modified gen p mean: 0.4484413266181946, gen p mean: -0.6740219593048096, mean p set: 0.44892165064811707
The modified gen p mean: 0.45100584626197815, gen p mean: -0.6735504865646362, mean p set: 0.45148617029190063
loss_pred:0.028503835201263428, decouple_loss:0.014044887386262417
loss_pred:0.027814645320177078, decouple_loss:0.015067567117512226
loss_pred:0.027419066056609154, decouple_loss:0.014430579729378223
Iteration: 1743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504856467247009, gen p mean: -0.6843920350074768, mean p set: 0.450965940952301
The modified gen p mean: 0.4512256383895874, gen p mean: -0.6755799651145935, mean p set: 0.4517059326171875
The modified gen p mean: 0.4490956664085388, gen p mean: -0.6807000637054443, mean p set: 0.4495759904384613
loss_pred:0.02819935418665409, decouple_loss:0.015225555747747421
loss_pred:0.028178701177239418, decouple_loss:0.015534625388681889
loss_pred:0.028144020587205887, decouple_loss:0.013878446072340012
Iteration: 1744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520019292831421, gen p mean: -0.678039014339447, mean p set: 0.4524822235107422
The modified gen p mean: 0.45288676023483276, gen p mean: -0.6797206401824951, mean p set: 0.4533670246601105
The modified gen p mean: 0.4511185884475708, gen p mean: -0.6820728778839111, mean p set: 0.4515989124774933
loss_pred:0.027136607095599174, decouple_loss:0.014977267012000084
loss_pred:0.027758173644542694, decouple_loss:0.01503661647439003
loss_pred:0.028195412829518318, decouple_loss:0.01470878254622221
Iteration: 1745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504956901073456, gen p mean: -0.6841457486152649, mean p set: 0.45097601413726807
The modified gen p mean: 0.44957685470581055, gen p mean: -0.692785382270813, mean p set: 0.45005717873573303
The modified gen p mean: 0.449121356010437, gen p mean: -0.6878244876861572, mean p set: 0.4496016502380371
loss_pred:0.02784562297165394, decouple_loss:0.0142341498285532
loss_pred:0.027418227866292, decouple_loss:0.01489370595663786
loss_pred:0.02730785869061947, decouple_loss:0.013771019876003265
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
NaN value num: 0
Iteration: 1746, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45145392417907715, gen p mean: -0.6960862278938293, mean p set: 0.45193424820899963
The modified gen p mean: 0.4491751790046692, gen p mean: -0.688764214515686, mean p set: 0.4496554732322693
The modified gen p mean: 0.4502578377723694, gen p mean: -0.6867964267730713, mean p set: 0.4507381319999695
loss_pred:0.02782314084470272, decouple_loss:0.014865079894661903
loss_pred:0.02744322456419468, decouple_loss:0.014650434255599976
loss_pred:0.028274156153202057, decouple_loss:0.01558916550129652
Iteration: 1747, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485391080379486, gen p mean: -0.6940222382545471, mean p set: 0.4490193724632263
The modified gen p mean: 0.44925758242607117, gen p mean: -0.6929473876953125, mean p set: 0.44973790645599365
The modified gen p mean: 0.4503800570964813, gen p mean: -0.7000324130058289, mean p set: 0.4508603513240814
loss_pred:0.027151411399245262, decouple_loss:0.014941245317459106
loss_pred:0.026914088055491447, decouple_loss:0.014554028399288654
loss_pred:0.028430616483092308, decouple_loss:0.015309429727494717
Iteration: 1748, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497430920600891, gen p mean: -0.7005568146705627, mean p set: 0.4502233564853668
The modified gen p mean: 0.4498869776725769, gen p mean: -0.6938794255256653, mean p set: 0.4503673017024994
The modified gen p mean: 0.44951504468917847, gen p mean: -0.6978444457054138, mean p set: 0.44999533891677856
loss_pred:0.02768881805241108, decouple_loss:0.01482110284268856
loss_pred:0.026808686554431915, decouple_loss:0.014024844393134117
loss_pred:0.027819214388728142, decouple_loss:0.01480282936245203
Iteration: 1749, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503837525844574, gen p mean: -0.6939491629600525, mean p set: 0.4508640468120575
The modified gen p mean: 0.4488760232925415, gen p mean: -0.6886740922927856, mean p set: 0.4493563175201416
The modified gen p mean: 0.44999271631240845, gen p mean: -0.7018744945526123, mean p set: 0.45047301054000854
loss_pred:0.02757374569773674, decouple_loss:0.013520815409719944
loss_pred:0.028609266504645348, decouple_loss:0.014959598891437054
loss_pred:0.02860240265727043, decouple_loss:0.014875512570142746
Iteration: 1750, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45023173093795776, gen p mean: -0.6986914277076721, mean p set: 0.45071205496788025
The modified gen p mean: 0.4522729516029358, gen p mean: -0.6951456069946289, mean p set: 0.4527532756328583
The modified gen p mean: 0.44931164383888245, gen p mean: -0.696638286113739, mean p set: 0.44979190826416016
loss_pred:0.027548139914870262, decouple_loss:0.014908969402313232
loss_pred:0.027571316808462143, decouple_loss:0.015395219437777996
loss_pred:0.0282435342669487, decouple_loss:0.014401335269212723
2023-05-03 01:56:04 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6933494806289673, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7004489898681641, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6890015006065369, mean p set: 0.45035696029663086
loss_pred:0.0279904343187809, decouple_loss:0.01576688326895237
loss_pred:0.029115930199623108, decouple_loss:0.01633344031870365
loss_pred:0.027543511241674423, decouple_loss:0.01619979366660118
WV_0_PC_1_EH_0_PS_40_6, loss: 0.029021626338362694, avg_mse: 0.03383701294660568
current test mse: 0.033837
Iteration: 1751, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452571302652359, gen p mean: -0.6985859870910645, mean p set: 0.4530515968799591
loss_pred:0.027037616819143295, decouple_loss:0.015009341761469841
The modified gen p mean: 0.45121529698371887, gen p mean: -0.6994761228561401, mean p set: 0.45169559121131897
loss_pred:0.028283512219786644, decouple_loss:0.014940677210688591
The modified gen p mean: 0.44909605383872986, gen p mean: -0.6876470446586609, mean p set: 0.44957631826400757
loss_pred:0.02784779667854309, decouple_loss:0.014512010850012302
Iteration: 1752, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499151408672333, gen p mean: -0.6964020729064941, mean p set: 0.450395405292511
The modified gen p mean: 0.45040807127952576, gen p mean: -0.6947583556175232, mean p set: 0.45088836550712585
The modified gen p mean: 0.4493119716644287, gen p mean: -0.7039928436279297, mean p set: 0.4497922658920288
loss_pred:0.026802908629179, decouple_loss:0.014956940896809101
loss_pred:0.027307232841849327, decouple_loss:0.014581361785531044
loss_pred:0.02780274674296379, decouple_loss:0.014393494464457035
Iteration: 1753, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019587874412537, gen p mean: -0.6951276063919067, mean p set: 0.45067617297172546
The modified gen p mean: 0.4494835436344147, gen p mean: -0.707018256187439, mean p set: 0.44996383786201477
The modified gen p mean: 0.4502831995487213, gen p mean: -0.7016857862472534, mean p set: 0.4507634937763214
loss_pred:0.026687612757086754, decouple_loss:0.013842546381056309
loss_pred:0.02858319692313671, decouple_loss:0.014248489402234554
loss_pred:0.027839597314596176, decouple_loss:0.015233664773404598
Iteration: 1754, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452386736869812, gen p mean: -0.7014150023460388, mean p set: 0.4528670310974121
The modified gen p mean: 0.4497844874858856, gen p mean: -0.69815993309021, mean p set: 0.4502647817134857
The modified gen p mean: 0.4498424530029297, gen p mean: -0.7022400498390198, mean p set: 0.4503227472305298
loss_pred:0.026678169146180153, decouple_loss:0.015264125540852547
loss_pred:0.02766953594982624, decouple_loss:0.013806585222482681
loss_pred:0.027712907642126083, decouple_loss:0.013692760840058327
Iteration: 1755, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508315324783325, gen p mean: -0.695084810256958, mean p set: 0.4513118267059326
The modified gen p mean: 0.4533083140850067, gen p mean: -0.6977905631065369, mean p set: 0.4537885785102844
The modified gen p mean: 0.4481469690799713, gen p mean: -0.7052650451660156, mean p set: 0.4486272633075714
loss_pred:0.027017861604690552, decouple_loss:0.013856479898095131
loss_pred:0.025982320308685303, decouple_loss:0.013944451697170734
loss_pred:0.02769690938293934, decouple_loss:0.014938659965991974
Iteration: 1756, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500104486942291, gen p mean: -0.6925367712974548, mean p set: 0.4504907429218292
The modified gen p mean: 0.44950199127197266, gen p mean: -0.6875499486923218, mean p set: 0.44998228549957275
The modified gen p mean: 0.45056042075157166, gen p mean: -0.6943041086196899, mean p set: 0.45104068517684937
loss_pred:0.028672950342297554, decouple_loss:0.014279378578066826
loss_pred:0.0278619434684515, decouple_loss:0.014696492813527584
loss_pred:0.02731160633265972, decouple_loss:0.014312987215816975
Iteration: 1757, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501749873161316, gen p mean: -0.6910616159439087, mean p set: 0.4506552517414093
The modified gen p mean: 0.45165199041366577, gen p mean: -0.6949203014373779, mean p set: 0.45213228464126587
The modified gen p mean: 0.4490496814250946, gen p mean: -0.6932950019836426, mean p set: 0.4495299756526947
loss_pred:0.028848011046648026, decouple_loss:0.014209992252290249
loss_pred:0.02702406235039234, decouple_loss:0.014664308167994022
loss_pred:0.028150850906968117, decouple_loss:0.013413108885288239
Iteration: 1758, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45089876651763916, gen p mean: -0.6928123831748962, mean p set: 0.45137903094291687
The modified gen p mean: 0.45147770643234253, gen p mean: -0.6908243894577026, mean p set: 0.4519580006599426
The modified gen p mean: 0.4498305916786194, gen p mean: -0.6893922090530396, mean p set: 0.4503108859062195
loss_pred:0.027930332347750664, decouple_loss:0.013899624347686768
loss_pred:0.027780018746852875, decouple_loss:0.014566769823431969
loss_pred:0.027677513659000397, decouple_loss:0.013685481622815132
Iteration: 1759, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45002520084381104, gen p mean: -0.7029798626899719, mean p set: 0.4505055248737335
The modified gen p mean: 0.44941961765289307, gen p mean: -0.7001144289970398, mean p set: 0.44989991188049316
The modified gen p mean: 0.452502965927124, gen p mean: -0.7013691663742065, mean p set: 0.4529832601547241
loss_pred:0.027379799634218216, decouple_loss:0.014080657623708248
loss_pred:0.027655648067593575, decouple_loss:0.013608694076538086
loss_pred:0.02597993239760399, decouple_loss:0.013687997125089169
Iteration: 1760, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45253437757492065, gen p mean: -0.7070476412773132, mean p set: 0.45301464200019836
The modified gen p mean: 0.4496683180332184, gen p mean: -0.7033191323280334, mean p set: 0.4501486122608185
The modified gen p mean: 0.4486159384250641, gen p mean: -0.6978775858879089, mean p set: 0.4490962028503418
loss_pred:0.027081884443759918, decouple_loss:0.013988730497658253
loss_pred:0.02726520411670208, decouple_loss:0.013907619751989841
loss_pred:0.027489932253956795, decouple_loss:0.01332379411906004
2023-05-03 01:59:45 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.714562177658081, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7073273062705994, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7029967904090881, mean p set: 0.45035696029663086
loss_pred:0.029162423685193062, decouple_loss:0.015940871089696884
loss_pred:0.028050197288393974, decouple_loss:0.015576416626572609
loss_pred:0.02771695703268051, decouple_loss:0.01600034162402153
WV_0_PC_1_EH_0_PS_40_6, loss: 0.029101818799972534, avg_mse: 0.03395158052444458
current test mse: 0.033952
Iteration: 1761, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502045810222626, gen p mean: -0.7156451940536499, mean p set: 0.45068490505218506
The modified gen p mean: 0.4500272572040558, gen p mean: -0.7149986028671265, mean p set: 0.4505075514316559
loss_pred:0.027791520580649376, decouple_loss:0.013870496302843094
loss_pred:0.02869419939815998, decouple_loss:0.013969581574201584
The modified gen p mean: 0.45096728205680847, gen p mean: -0.7089524269104004, mean p set: 0.4514475464820862
loss_pred:0.02789384499192238, decouple_loss:0.013823896646499634
Iteration: 1762, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494783282279968, gen p mean: -0.7062307000160217, mean p set: 0.4499586224555969
The modified gen p mean: 0.4493556320667267, gen p mean: -0.7122299075126648, mean p set: 0.4498359262943268
The modified gen p mean: 0.44869571924209595, gen p mean: -0.696749746799469, mean p set: 0.44917601346969604
loss_pred:0.027311254292726517, decouple_loss:0.013450315222144127
loss_pred:0.027379916980862617, decouple_loss:0.013500919565558434
loss_pred:0.02718084491789341, decouple_loss:0.012663244269788265
Iteration: 1763, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45037806034088135, gen p mean: -0.7083190679550171, mean p set: 0.45085835456848145
The modified gen p mean: 0.4521687924861908, gen p mean: -0.7033698558807373, mean p set: 0.4526490569114685
The modified gen p mean: 0.45013538002967834, gen p mean: -0.6948076486587524, mean p set: 0.45061564445495605
loss_pred:0.027342330664396286, decouple_loss:0.013871237635612488
loss_pred:0.026649316772818565, decouple_loss:0.013136004097759724
loss_pred:0.027081647887825966, decouple_loss:0.01306195929646492
Iteration: 1764, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45172998309135437, gen p mean: -0.6964362859725952, mean p set: 0.45221027731895447
The modified gen p mean: 0.44954437017440796, gen p mean: -0.6909464597702026, mean p set: 0.45002463459968567
The modified gen p mean: 0.4519721269607544, gen p mean: -0.6969004273414612, mean p set: 0.4524524509906769
loss_pred:0.027375368401408195, decouple_loss:0.014173614792525768
loss_pred:0.026941439136862755, decouple_loss:0.013111948035657406
loss_pred:0.026140879839658737, decouple_loss:0.013485399074852467
Iteration: 1765, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44874173402786255, gen p mean: -0.6881673336029053, mean p set: 0.44922199845314026
The modified gen p mean: 0.4503077566623688, gen p mean: -0.6959978342056274, mean p set: 0.45078805088996887
The modified gen p mean: 0.4495808780193329, gen p mean: -0.6971963047981262, mean p set: 0.450061172246933
loss_pred:0.027232429012656212, decouple_loss:0.013724317774176598
loss_pred:0.02736765146255493, decouple_loss:0.01346070971339941
loss_pred:0.028474463149905205, decouple_loss:0.01346377469599247
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
NaN value num: 0
Iteration: 1766, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486994445323944, gen p mean: -0.7027786374092102, mean p set: 0.4491797089576721
The modified gen p mean: 0.4498950242996216, gen p mean: -0.7019063234329224, mean p set: 0.4503753185272217
The modified gen p mean: 0.44945579767227173, gen p mean: -0.6954948306083679, mean p set: 0.44993606209754944
loss_pred:0.02864241786301136, decouple_loss:0.014970999211072922
loss_pred:0.02903129532933235, decouple_loss:0.015162099152803421
loss_pred:0.029525669291615486, decouple_loss:0.01568487472832203
Iteration: 1767, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487926661968231, gen p mean: -0.70832359790802, mean p set: 0.44927293062210083
The modified gen p mean: 0.44830837845802307, gen p mean: -0.7081003189086914, mean p set: 0.4487886428833008
The modified gen p mean: 0.44869494438171387, gen p mean: -0.7186971306800842, mean p set: 0.44917523860931396
loss_pred:0.02918453887104988, decouple_loss:0.015261679887771606
loss_pred:0.029252830892801285, decouple_loss:0.014908534474670887
loss_pred:0.028999242931604385, decouple_loss:0.016835900023579597
Iteration: 1768, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497113525867462, gen p mean: -0.7134264707565308, mean p set: 0.4501916468143463
The modified gen p mean: 0.4490582346916199, gen p mean: -0.7127580642700195, mean p set: 0.44953852891921997
The modified gen p mean: 0.44820013642311096, gen p mean: -0.7142679691314697, mean p set: 0.44868043065071106
loss_pred:0.02984461560845375, decouple_loss:0.01502408366650343
loss_pred:0.03015259839594364, decouple_loss:0.015258507803082466
loss_pred:0.02886921726167202, decouple_loss:0.014640677720308304
Iteration: 1769, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447918564081192, gen p mean: -0.71157306432724, mean p set: 0.4483988583087921
The modified gen p mean: 0.4496042728424072, gen p mean: -0.7113097906112671, mean p set: 0.4500845670700073
The modified gen p mean: 0.44862014055252075, gen p mean: -0.7146041989326477, mean p set: 0.44910046458244324
loss_pred:0.02878931351006031, decouple_loss:0.014793439768254757
loss_pred:0.027859659865498543, decouple_loss:0.01481725089251995
loss_pred:0.02940366230905056, decouple_loss:0.01607418991625309
Iteration: 1770, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45030322670936584, gen p mean: -0.7135149836540222, mean p set: 0.45078352093696594
The modified gen p mean: 0.45032787322998047, gen p mean: -0.7108679413795471, mean p set: 0.45080816745758057
The modified gen p mean: 0.4498195946216583, gen p mean: -0.7137969732284546, mean p set: 0.4502998888492584
loss_pred:0.028362177312374115, decouple_loss:0.014351540245115757
loss_pred:0.028945330530405045, decouple_loss:0.014124966226518154
loss_pred:0.02801595628261566, decouple_loss:0.01443540770560503
2023-05-03 02:04:04 testing...
The modified gen p mean: 0.4495830237865448, gen p mean: -0.7083680629730225, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.715724527835846, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7037949562072754, mean p set: 0.45035696029663086
loss_pred:0.027912460267543793, decouple_loss:0.015228032134473324
loss_pred:0.028972623869776726, decouple_loss:0.015684543177485466
loss_pred:0.02749619074165821, decouple_loss:0.015436992049217224
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02889958582818508, avg_mse: 0.03371277078986168
current test mse: 0.033713
Iteration: 1771, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499596357345581, gen p mean: -0.7177867293357849, mean p set: 0.4504399299621582
The modified gen p mean: 0.45045018196105957, gen p mean: -0.7183541655540466, mean p set: 0.4509304463863373
loss_pred:0.028033582493662834, decouple_loss:0.014093132689595222
loss_pred:0.028474509716033936, decouple_loss:0.014645890332758427
The modified gen p mean: 0.4487854838371277, gen p mean: -0.7101646065711975, mean p set: 0.4492657780647278
loss_pred:0.029081853106617928, decouple_loss:0.014137706719338894
Iteration: 1772, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493016302585602, gen p mean: -0.7074148058891296, mean p set: 0.4497818946838379
The modified gen p mean: 0.4496310353279114, gen p mean: -0.7174330353736877, mean p set: 0.4501113295555115
The modified gen p mean: 0.4502228796482086, gen p mean: -0.7114939093589783, mean p set: 0.4507031738758087
loss_pred:0.029804212972521782, decouple_loss:0.014524669386446476
loss_pred:0.02852828986942768, decouple_loss:0.014074484817683697
loss_pred:0.028739668428897858, decouple_loss:0.014416935853660107
Iteration: 1773, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492219388484955, gen p mean: -0.7017432451248169, mean p set: 0.4497022032737732
The modified gen p mean: 0.44840115308761597, gen p mean: -0.7054814696311951, mean p set: 0.44888144731521606
The modified gen p mean: 0.44858092069625854, gen p mean: -0.7137496471405029, mean p set: 0.44906121492385864
loss_pred:0.030251627787947655, decouple_loss:0.014694448560476303
loss_pred:0.02866343781352043, decouple_loss:0.014022496528923512
loss_pred:0.029727941378951073, decouple_loss:0.01585918664932251
Iteration: 1774, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487479627132416, gen p mean: -0.6974790692329407, mean p set: 0.4492282271385193
The modified gen p mean: 0.44807255268096924, gen p mean: -0.7061797976493835, mean p set: 0.44855284690856934
The modified gen p mean: 0.44838595390319824, gen p mean: -0.6998962163925171, mean p set: 0.4488662779331207
loss_pred:0.029159294441342354, decouple_loss:0.01430787704885006
loss_pred:0.028573229908943176, decouple_loss:0.015309141017496586
loss_pred:0.028829261660575867, decouple_loss:0.01404394768178463
Iteration: 1775, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479649066925049, gen p mean: -0.7120150327682495, mean p set: 0.44844523072242737
The modified gen p mean: 0.4502217173576355, gen p mean: -0.7077115178108215, mean p set: 0.4507019817829132
The modified gen p mean: 0.44845178723335266, gen p mean: -0.7120188474655151, mean p set: 0.44893211126327515
loss_pred:0.02913345769047737, decouple_loss:0.015914583578705788
loss_pred:0.02829674631357193, decouple_loss:0.01480802707374096
loss_pred:0.02927350252866745, decouple_loss:0.014403443783521652
Iteration: 1776, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44978079199790955, gen p mean: -0.7050492167472839, mean p set: 0.45026108622550964
The modified gen p mean: 0.4484393894672394, gen p mean: -0.7095332741737366, mean p set: 0.4489196836948395
The modified gen p mean: 0.4480952024459839, gen p mean: -0.707368791103363, mean p set: 0.448575496673584
loss_pred:0.029079411178827286, decouple_loss:0.014599809423089027
loss_pred:0.027781454846262932, decouple_loss:0.01537948939949274
loss_pred:0.02923479862511158, decouple_loss:0.014855675399303436
Iteration: 1777, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44896429777145386, gen p mean: -0.6978621482849121, mean p set: 0.44944456219673157
The modified gen p mean: 0.4479368329048157, gen p mean: -0.7037123441696167, mean p set: 0.4484170973300934
The modified gen p mean: 0.4484138786792755, gen p mean: -0.695958137512207, mean p set: 0.4488941431045532
loss_pred:0.02877902425825596, decouple_loss:0.014125330373644829
loss_pred:0.02926027961075306, decouple_loss:0.014610521495342255
loss_pred:0.02800552360713482, decouple_loss:0.014038540422916412
Iteration: 1778, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486786723136902, gen p mean: -0.693253219127655, mean p set: 0.4491589367389679
The modified gen p mean: 0.4489072561264038, gen p mean: -0.7081204652786255, mean p set: 0.4493875503540039
The modified gen p mean: 0.44973480701446533, gen p mean: -0.6944964528083801, mean p set: 0.45021507143974304
loss_pred:0.028553353622555733, decouple_loss:0.013827000744640827
loss_pred:0.02944660745561123, decouple_loss:0.014641642570495605
loss_pred:0.029377039521932602, decouple_loss:0.014984226785600185
Iteration: 1779, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44958382844924927, gen p mean: -0.7044970393180847, mean p set: 0.450064092874527
The modified gen p mean: 0.45035356283187866, gen p mean: -0.7038032412528992, mean p set: 0.45083382725715637
The modified gen p mean: 0.44969338178634644, gen p mean: -0.7116710543632507, mean p set: 0.45017367601394653
loss_pred:0.028791071847081184, decouple_loss:0.014642035588622093
loss_pred:0.028127839788794518, decouple_loss:0.014346378855407238
loss_pred:0.028304647654294968, decouple_loss:0.01389610767364502
Iteration: 1780, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44978612661361694, gen p mean: -0.7079821228981018, mean p set: 0.45026645064353943
The modified gen p mean: 0.4486227035522461, gen p mean: -0.7119215726852417, mean p set: 0.4491029977798462
The modified gen p mean: 0.4498697817325592, gen p mean: -0.7101467847824097, mean p set: 0.4503500759601593
loss_pred:0.02770415134727955, decouple_loss:0.014184881933033466
loss_pred:0.029417935758829117, decouple_loss:0.014676861464977264
loss_pred:0.02796218916773796, decouple_loss:0.014158440753817558
2023-05-03 02:07:48 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7018964886665344, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7092801928520203, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6976105570793152, mean p set: 0.45035696029663086
loss_pred:0.02791142463684082, decouple_loss:0.014565215446054935
loss_pred:0.029119232669472694, decouple_loss:0.015179097652435303
loss_pred:0.0275126900523901, decouple_loss:0.015083718113601208
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028928250074386597, avg_mse: 0.033827830106019974
current test mse: 0.033828
Iteration: 1781, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494518041610718, gen p mean: -0.7056066989898682, mean p set: 0.4499320983886719
The modified gen p mean: 0.4482744038105011, gen p mean: -0.7088058590888977, mean p set: 0.4487546980381012
loss_pred:0.028228702023625374, decouple_loss:0.013914212584495544
loss_pred:0.028525637462735176, decouple_loss:0.014412492513656616
The modified gen p mean: 0.44764408469200134, gen p mean: -0.7079921364784241, mean p set: 0.44812440872192383
loss_pred:0.028172548860311508, decouple_loss:0.014424324035644531
Iteration: 1782, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799548387527466, gen p mean: -0.7004081606864929, mean p set: 0.44847577810287476
The modified gen p mean: 0.4474796950817108, gen p mean: -0.7026450037956238, mean p set: 0.4479599893093109
The modified gen p mean: 0.4473685026168823, gen p mean: -0.7012821435928345, mean p set: 0.4478487968444824
loss_pred:0.028868738561868668, decouple_loss:0.013753141276538372
loss_pred:0.028908710926771164, decouple_loss:0.013845983892679214
loss_pred:0.028819790109992027, decouple_loss:0.014238177798688412
Iteration: 1783, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815149903297424, gen p mean: -0.6915083527565002, mean p set: 0.44863176345825195
The modified gen p mean: 0.4509904682636261, gen p mean: -0.6923620104789734, mean p set: 0.4514707326889038
The modified gen p mean: 0.44886526465415955, gen p mean: -0.698000967502594, mean p set: 0.44934555888175964
loss_pred:0.027772873640060425, decouple_loss:0.013768435455858707loss_pred:0.029085809364914894, decouple_loss:0.014246358536183834
loss_pred:0.029021382331848145, decouple_loss:0.014964881353080273
Iteration: 1784, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476453363895416, gen p mean: -0.6860573887825012, mean p set: 0.4481256306171417
The modified gen p mean: 0.4489058256149292, gen p mean: -0.6964238286018372, mean p set: 0.4493860900402069
The modified gen p mean: 0.44749295711517334, gen p mean: -0.6881825923919678, mean p set: 0.44797325134277344
loss_pred:0.028623683378100395, decouple_loss:0.013710219413042068
loss_pred:0.028686922043561935, decouple_loss:0.014476324431598186
loss_pred:0.02919422835111618, decouple_loss:0.01388488058000803
Iteration: 1785, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500262141227722, gen p mean: -0.6964291334152222, mean p set: 0.4505065083503723
The modified gen p mean: 0.4489375054836273, gen p mean: -0.7000263929367065, mean p set: 0.4494177997112274
loss_pred:0.028304006904363632, decouple_loss:0.014016753062605858
The modified gen p mean: 0.4491669237613678, gen p mean: -0.695675790309906, mean p set: 0.4496472179889679
loss_pred:0.02881672978401184, decouple_loss:0.013653405010700226
loss_pred:0.029343226924538612, decouple_loss:0.013794650323688984
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
NaN value num: 0
Iteration: 1786, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515930414199829, gen p mean: -0.697348952293396, mean p set: 0.452073335647583
The modified gen p mean: 0.4514670968055725, gen p mean: -0.6939998269081116, mean p set: 0.4519473612308502
The modified gen p mean: 0.4518786370754242, gen p mean: -0.701931893825531, mean p set: 0.4523589313030243
loss_pred:0.028621641919016838, decouple_loss:0.01684289053082466
loss_pred:0.027437081560492516, decouple_loss:0.01664823479950428
loss_pred:0.027826698496937752, decouple_loss:0.01607513055205345
Iteration: 1787, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516814053058624, gen p mean: -0.6947686076164246, mean p set: 0.4521616995334625
The modified gen p mean: 0.4506165683269501, gen p mean: -0.7039258480072021, mean p set: 0.4510968327522278
The modified gen p mean: 0.451937735080719, gen p mean: -0.7029422521591187, mean p set: 0.4524179995059967
loss_pred:0.02828354574739933, decouple_loss:0.016381189227104187
loss_pred:0.028128622099757195, decouple_loss:0.016045890748500824
loss_pred:0.027585100382566452, decouple_loss:0.017053376883268356
Iteration: 1788, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517934322357178, gen p mean: -0.7093498110771179, mean p set: 0.4522736966609955
The modified gen p mean: 0.4507963955402374, gen p mean: -0.7043325304985046, mean p set: 0.4512766897678375
The modified gen p mean: 0.45107710361480713, gen p mean: -0.7106810808181763, mean p set: 0.4515573978424072
loss_pred:0.02698441594839096, decouple_loss:0.015575614757835865
loss_pred:0.02807249315083027, decouple_loss:0.01562511920928955
loss_pred:0.02670963853597641, decouple_loss:0.016077855601906776
Iteration: 1789, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010122656822205, gen p mean: -0.7095349431037903, mean p set: 0.45058155059814453
The modified gen p mean: 0.45177724957466125, gen p mean: -0.7045218348503113, mean p set: 0.45225754380226135
The modified gen p mean: 0.45111170411109924, gen p mean: -0.706739604473114, mean p set: 0.45159196853637695
loss_pred:0.02697053924202919, decouple_loss:0.015803690999746323
loss_pred:0.027849197387695312, decouple_loss:0.015409528277814388
loss_pred:0.02788632921874523, decouple_loss:0.015257966704666615
Iteration: 1790, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510782063007355, gen p mean: -0.6960076689720154, mean p set: 0.4515584707260132
The modified gen p mean: 0.4496847987174988, gen p mean: -0.6965141296386719, mean p set: 0.45016512274742126
The modified gen p mean: 0.452144593000412, gen p mean: -0.7022826671600342, mean p set: 0.4526248872280121
loss_pred:0.028198113664984703, decouple_loss:0.015530215576291084
loss_pred:0.027826396748423576, decouple_loss:0.015051676891744137
loss_pred:0.027925606817007065, decouple_loss:0.014749445021152496
2023-05-03 02:12:15 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.6992129683494568, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6920938491821289, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6878948211669922, mean p set: 0.45035696029663086
loss_pred:0.028857778757810593, decouple_loss:0.01644560508430004
loss_pred:0.027834804728627205, decouple_loss:0.015919867902994156
loss_pred:0.027466317638754845, decouple_loss:0.016446826979517937
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02886650525033474, avg_mse: 0.03368033468723297
current test mse: 0.03368
Iteration: 1791, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45237085223197937, gen p mean: -0.6956287026405334, mean p set: 0.45285114645957947
loss_pred:0.026881525292992592, decouple_loss:0.014319851994514465
The modified gen p mean: 0.4497269093990326, gen p mean: -0.6919739842414856, mean p set: 0.4502072036266327
loss_pred:0.02758730761706829, decouple_loss:0.014679196290671825
The modified gen p mean: 0.4502018690109253, gen p mean: -0.691832423210144, mean p set: 0.450682133436203
loss_pred:0.02802027016878128, decouple_loss:0.01467810571193695
Iteration: 1792, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45081135630607605, gen p mean: -0.6909846663475037, mean p set: 0.45129165053367615
The modified gen p mean: 0.45063239336013794, gen p mean: -0.6959631443023682, mean p set: 0.45111268758773804
The modified gen p mean: 0.4516752064228058, gen p mean: -0.6899403929710388, mean p set: 0.4521554708480835
loss_pred:0.02690940350294113, decouple_loss:0.015170133672654629
loss_pred:0.026296071708202362, decouple_loss:0.014680139720439911
loss_pred:0.027755610644817352, decouple_loss:0.014486102387309074
Iteration: 1793, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509282410144806, gen p mean: -0.6966801881790161, mean p set: 0.4514085352420807
The modified gen p mean: 0.451133668422699, gen p mean: -0.6882248520851135, mean p set: 0.4516139328479767
The modified gen p mean: 0.4507935643196106, gen p mean: -0.6927369832992554, mean p set: 0.4512738585472107
loss_pred:0.02666964940726757, decouple_loss:0.014258447103202343
loss_pred:0.027212010696530342, decouple_loss:0.015185697004199028
loss_pred:0.027579965069890022, decouple_loss:0.0154697485268116
Iteration: 1794, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524185061454773, gen p mean: -0.6882044672966003, mean p set: 0.452898770570755
The modified gen p mean: 0.45015791058540344, gen p mean: -0.7020434141159058, mean p set: 0.45063820481300354
The modified gen p mean: 0.4507906138896942, gen p mean: -0.7033362984657288, mean p set: 0.4512709379196167
loss_pred:0.027159588411450386, decouple_loss:0.015382050536572933
loss_pred:0.02743357978761196, decouple_loss:0.014545354060828686
loss_pred:0.027234366163611412, decouple_loss:0.014394624158740044
Iteration: 1795, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529097378253937, gen p mean: -0.7143030166625977, mean p set: 0.4533900320529938
The modified gen p mean: 0.451174259185791, gen p mean: -0.7066193222999573, mean p set: 0.4516545534133911
The modified gen p mean: 0.4517216682434082, gen p mean: -0.7098408937454224, mean p set: 0.4522019624710083
loss_pred:0.026327023282647133, decouple_loss:0.014601767994463444
loss_pred:0.027790039777755737, decouple_loss:0.014824988320469856
loss_pred:0.027535362169146538, decouple_loss:0.014711747877299786
Iteration: 1796, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505321681499481, gen p mean: -0.7110360264778137, mean p set: 0.4510124921798706
The modified gen p mean: 0.4512689709663391, gen p mean: -0.7167399525642395, mean p set: 0.4517492651939392
The modified gen p mean: 0.4505290687084198, gen p mean: -0.7165289521217346, mean p set: 0.4510093629360199
loss_pred:0.026936400681734085, decouple_loss:0.013871174305677414
loss_pred:0.02627677097916603, decouple_loss:0.014302720315754414
loss_pred:0.026830390095710754, decouple_loss:0.014092057943344116
Iteration: 1797, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44992560148239136, gen p mean: -0.7121154069900513, mean p set: 0.45040586590766907
The modified gen p mean: 0.4504019320011139, gen p mean: -0.71490478515625, mean p set: 0.450882226228714
The modified gen p mean: 0.45158693194389343, gen p mean: -0.709044873714447, mean p set: 0.45206722617149353
loss_pred:0.0266960971057415, decouple_loss:0.0150800421833992
loss_pred:0.02662094123661518, decouple_loss:0.013955170288681984
loss_pred:0.02790670096874237, decouple_loss:0.014460218138992786
Iteration: 1798, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514962434768677, gen p mean: -0.7027080655097961, mean p set: 0.451976478099823
The modified gen p mean: 0.4505757689476013, gen p mean: -0.7033471465110779, mean p set: 0.4510560631752014
The modified gen p mean: 0.45102861523628235, gen p mean: -0.7074871063232422, mean p set: 0.45150890946388245
loss_pred:0.02737652324140072, decouple_loss:0.014296531677246094
loss_pred:0.0266297347843647, decouple_loss:0.01373907458037138
loss_pred:0.026416566222906113, decouple_loss:0.013650470413267612
Iteration: 1799, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508490264415741, gen p mean: -0.7030465602874756, mean p set: 0.4513293206691742
The modified gen p mean: 0.45027273893356323, gen p mean: -0.7041871547698975, mean p set: 0.45075303316116333
The modified gen p mean: 0.45018839836120605, gen p mean: -0.7034721374511719, mean p set: 0.45066869258880615
loss_pred:0.027042482048273087, decouple_loss:0.013905206695199013
loss_pred:0.026384491473436356, decouple_loss:0.014265152625739574
loss_pred:0.027468718588352203, decouple_loss:0.013751091435551643
Iteration: 1800, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504564106464386, gen p mean: -0.7061324119567871, mean p set: 0.4509367048740387
The modified gen p mean: 0.45152682065963745, gen p mean: -0.7030724883079529, mean p set: 0.45200711488723755
The modified gen p mean: 0.4501418471336365, gen p mean: -0.7004280686378479, mean p set: 0.4506221413612366
loss_pred:0.02602297253906727, decouple_loss:0.013985257595777512
loss_pred:0.02786099724471569, decouple_loss:0.014008215628564358
loss_pred:0.027413541451096535, decouple_loss:0.014128762297332287
2023-05-03 02:15:58 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7087653875350952, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.71625816822052, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7042194604873657, mean p set: 0.45035696029663086
loss_pred:0.027857661247253418, decouple_loss:0.015417841263115406
loss_pred:0.028918514028191566, decouple_loss:0.01585276611149311
loss_pred:0.027433060109615326, decouple_loss:0.015947088599205017
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028856705874204636, avg_mse: 0.033740147948265076
current test mse: 0.03374
Iteration: 1801, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45073381066322327, gen p mean: -0.7120480537414551, mean p set: 0.45121413469314575
The modified gen p mean: 0.45139825344085693, gen p mean: -0.7141522765159607, mean p set: 0.45187854766845703
loss_pred:0.02666405774652958, decouple_loss:0.013718705624341965
loss_pred:0.02789231948554516, decouple_loss:0.0139949731528759
The modified gen p mean: 0.4510427415370941, gen p mean: -0.7154276371002197, mean p set: 0.4515230059623718
loss_pred:0.02667948789894581, decouple_loss:0.013659522868692875
Iteration: 1802, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45241662859916687, gen p mean: -0.7190978527069092, mean p set: 0.4528968930244446
The modified gen p mean: 0.4509287178516388, gen p mean: -0.7137803435325623, mean p set: 0.4514089822769165
The modified gen p mean: 0.45123547315597534, gen p mean: -0.7182698249816895, mean p set: 0.4517157971858978
loss_pred:0.02616964839398861, decouple_loss:0.01435088086873293
loss_pred:0.02694541960954666, decouple_loss:0.013970645144581795
loss_pred:0.028053294867277145, decouple_loss:0.013606559485197067
Iteration: 1803, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45104214549064636, gen p mean: -0.7095350623130798, mean p set: 0.45152246952056885
The modified gen p mean: 0.45307403802871704, gen p mean: -0.7200084924697876, mean p set: 0.4535543620586395
The modified gen p mean: 0.45098811388015747, gen p mean: -0.719810962677002, mean p set: 0.45146840810775757
loss_pred:0.028345296159386635, decouple_loss:0.014181459322571754
loss_pred:0.02622363343834877, decouple_loss:0.013727426528930664
loss_pred:0.027504824101924896, decouple_loss:0.013508094474673271
Iteration: 1804, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513534903526306, gen p mean: -0.7103445529937744, mean p set: 0.4518337547779083
The modified gen p mean: 0.4519047439098358, gen p mean: -0.7068592309951782, mean p set: 0.4523850381374359
The modified gen p mean: 0.45051705837249756, gen p mean: -0.7132323980331421, mean p set: 0.45099735260009766
loss_pred:0.027297645807266235, decouple_loss:0.014055082574486732
loss_pred:0.0277812909334898, decouple_loss:0.014093018136918545
loss_pred:0.026387399062514305, decouple_loss:0.013442575931549072
Iteration: 1805, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502286911010742, gen p mean: -0.7101378440856934, mean p set: 0.4507089853286743
The modified gen p mean: 0.45099154114723206, gen p mean: -0.7110165953636169, mean p set: 0.45147183537483215
The modified gen p mean: 0.45110297203063965, gen p mean: -0.7062519788742065, mean p set: 0.45158323645591736
loss_pred:0.02663089893758297, decouple_loss:0.013003467582166195
loss_pred:0.026485634967684746, decouple_loss:0.012637889012694359
loss_pred:0.0280030257999897, decouple_loss:0.013770939782261848
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
NaN value num: 0
Iteration: 1806, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45156458020210266, gen p mean: -0.7051753997802734, mean p set: 0.45204487442970276
The modified gen p mean: 0.45136523246765137, gen p mean: -0.7145316004753113, mean p set: 0.4518454968929291
The modified gen p mean: 0.4520479142665863, gen p mean: -0.7136822938919067, mean p set: 0.4525282084941864
loss_pred:0.02787582017481327, decouple_loss:0.014419933781027794
loss_pred:0.026592783629894257, decouple_loss:0.01568486914038658
loss_pred:0.0272873193025589, decouple_loss:0.014073324389755726
Iteration: 1807, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45151031017303467, gen p mean: -0.6943649053573608, mean p set: 0.4519905745983124
The modified gen p mean: 0.45214134454727173, gen p mean: -0.7020434141159058, mean p set: 0.4526216387748718
The modified gen p mean: 0.45000511407852173, gen p mean: -0.7010937929153442, mean p set: 0.4504854083061218
loss_pred:0.027212467044591904, decouple_loss:0.014644402079284191
loss_pred:0.027762211859226227, decouple_loss:0.014583938755095005
loss_pred:0.028352148830890656, decouple_loss:0.015088392421603203
Iteration: 1808, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500552713871002, gen p mean: -0.7002916932106018, mean p set: 0.45053553581237793
The modified gen p mean: 0.45196521282196045, gen p mean: -0.6999269723892212, mean p set: 0.45244550704956055
The modified gen p mean: 0.45214730501174927, gen p mean: -0.6928765773773193, mean p set: 0.452627569437027
loss_pred:0.02831260673701763, decouple_loss:0.01433177012950182
loss_pred:0.026474080979824066, decouple_loss:0.014735877513885498
loss_pred:0.027858344838023186, decouple_loss:0.014900894835591316
Iteration: 1809, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505527913570404, gen p mean: -0.6980220675468445, mean p set: 0.4510330855846405
The modified gen p mean: 0.45230716466903687, gen p mean: -0.6958953142166138, mean p set: 0.4527874290943146
The modified gen p mean: 0.4520340859889984, gen p mean: -0.6959392428398132, mean p set: 0.4525144100189209
loss_pred:0.02757444605231285, decouple_loss:0.01413002796471119
loss_pred:0.028312627226114273, decouple_loss:0.014666563831269741
loss_pred:0.027651896700263023, decouple_loss:0.014797124080359936
Iteration: 1810, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45119529962539673, gen p mean: -0.6996135115623474, mean p set: 0.4516755938529968
The modified gen p mean: 0.45109444856643677, gen p mean: -0.701149046421051, mean p set: 0.45157474279403687
The modified gen p mean: 0.4508665204048157, gen p mean: -0.708383321762085, mean p set: 0.45134681463241577
loss_pred:0.0273226760327816, decouple_loss:0.014624339528381824
loss_pred:0.026827408000826836, decouple_loss:0.01356526929885149
loss_pred:0.02745751477777958, decouple_loss:0.014165973290801048
2023-05-03 02:20:14 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.7179455757141113, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7103806734085083, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7054852843284607, mean p set: 0.45035696029663086
loss_pred:0.028861939907073975, decouple_loss:0.01578310690820217
loss_pred:0.02778621017932892, decouple_loss:0.015541676431894302
loss_pred:0.027382750064134598, decouple_loss:0.015595249831676483
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028792303055524826, avg_mse: 0.033681247383356094
current test mse: 0.033681
Iteration: 1811, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515194892883301, gen p mean: -0.7011721730232239, mean p set: 0.45199981331825256
The modified gen p mean: 0.45171889662742615, gen p mean: -0.7047439217567444, mean p set: 0.45219916105270386
loss_pred:0.026855984702706337, decouple_loss:0.013714971952140331
loss_pred:0.027820931747555733, decouple_loss:0.014005639590322971
The modified gen p mean: 0.45214712619781494, gen p mean: -0.7131561040878296, mean p set: 0.45262742042541504
loss_pred:0.0275388453155756, decouple_loss:0.014165959320962429
Iteration: 1812, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496256113052368, gen p mean: -0.7115607261657715, mean p set: 0.4501059055328369
The modified gen p mean: 0.4511058032512665, gen p mean: -0.7171934843063354, mean p set: 0.4515860676765442
The modified gen p mean: 0.4525078535079956, gen p mean: -0.7055063247680664, mean p set: 0.4529881477355957
loss_pred:0.028051897883415222, decouple_loss:0.014361470937728882
loss_pred:0.026575153693556786, decouple_loss:0.013383287936449051
loss_pred:0.027527447789907455, decouple_loss:0.014299117960035801
Iteration: 1813, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45213308930397034, gen p mean: -0.7162125706672668, mean p set: 0.45261338353157043
The modified gen p mean: 0.4519518315792084, gen p mean: -0.7200605273246765, mean p set: 0.45243212580680847
The modified gen p mean: 0.45223817229270935, gen p mean: -0.717278778553009, mean p set: 0.4527184069156647
loss_pred:0.02796882577240467, decouple_loss:0.013375477865338326
loss_pred:0.02671469748020172, decouple_loss:0.013743545860052109
loss_pred:0.027576010674238205, decouple_loss:0.013551026582717896
Iteration: 1814, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512491226196289, gen p mean: -0.7156610488891602, mean p set: 0.451729416847229
The modified gen p mean: 0.45201826095581055, gen p mean: -0.7241913676261902, mean p set: 0.45249855518341064
The modified gen p mean: 0.45159995555877686, gen p mean: -0.71741783618927, mean p set: 0.45208021998405457
loss_pred:0.02783145196735859, decouple_loss:0.013126250356435776
loss_pred:0.027547135949134827, decouple_loss:0.01420642901211977
loss_pred:0.02654072642326355, decouple_loss:0.013415887020528316
Iteration: 1815, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512441158294678, gen p mean: -0.7087028622627258, mean p set: 0.45172441005706787
The modified gen p mean: 0.45151078701019287, gen p mean: -0.7212460041046143, mean p set: 0.4519910514354706
The modified gen p mean: 0.45138177275657654, gen p mean: -0.7172893285751343, mean p set: 0.45186206698417664
loss_pred:0.028429917991161346, decouple_loss:0.014439993537962437loss_pred:0.02705366723239422, decouple_loss:0.014130097813904285
loss_pred:0.027946097776293755, decouple_loss:0.013818860054016113
Iteration: 1816, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505446255207062, gen p mean: -0.7121456265449524, mean p set: 0.4510248601436615
The modified gen p mean: 0.450133353471756, gen p mean: -0.7095997929573059, mean p set: 0.45061367750167847
The modified gen p mean: 0.45116686820983887, gen p mean: -0.7054603695869446, mean p set: 0.45164716243743896
loss_pred:0.027723873034119606, decouple_loss:0.01432028878480196
loss_pred:0.027707146480679512, decouple_loss:0.01366409845650196
loss_pred:0.02729593589901924, decouple_loss:0.013526136986911297
Iteration: 1817, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518471956253052, gen p mean: -0.7182590365409851, mean p set: 0.4523274898529053
The modified gen p mean: 0.4527052640914917, gen p mean: -0.7181698083877563, mean p set: 0.4531855285167694
The modified gen p mean: 0.4505493640899658, gen p mean: -0.7161585092544556, mean p set: 0.4510296881198883
loss_pred:0.027068015187978745, decouple_loss:0.013942780904471874
loss_pred:0.02763223648071289, decouple_loss:0.013979350216686726
loss_pred:0.028129680082201958, decouple_loss:0.013834446668624878
Iteration: 1818, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45138242840766907, gen p mean: -0.7066794633865356, mean p set: 0.4518626928329468
The modified gen p mean: 0.45209887623786926, gen p mean: -0.7131727337837219, mean p set: 0.452579140663147
The modified gen p mean: 0.4510997235774994, gen p mean: -0.7028371691703796, mean p set: 0.4515799880027771
loss_pred:0.027355171740055084, decouple_loss:0.013719572685658932
loss_pred:0.027959462255239487, decouple_loss:0.01318056508898735
loss_pred:0.027613548561930656, decouple_loss:0.013593991287052631
Iteration: 1819, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45157450437545776, gen p mean: -0.7086303234100342, mean p set: 0.45205479860305786
The modified gen p mean: 0.452153742313385, gen p mean: -0.7015697360038757, mean p set: 0.4526340067386627
The modified gen p mean: 0.45163699984550476, gen p mean: -0.708512544631958, mean p set: 0.45211732387542725
loss_pred:0.026296384632587433, decouple_loss:0.012893867678940296
loss_pred:0.027272215113043785, decouple_loss:0.013987323269248009
loss_pred:0.027749907225370407, decouple_loss:0.013324608094990253
Iteration: 1820, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516157805919647, gen p mean: -0.701297402381897, mean p set: 0.45209604501724243
The modified gen p mean: 0.4515809118747711, gen p mean: -0.707676887512207, mean p set: 0.4520612061023712
The modified gen p mean: 0.4494275450706482, gen p mean: -0.7023190259933472, mean p set: 0.4499078094959259
loss_pred:0.02775874361395836, decouple_loss:0.013844422996044159
loss_pred:0.027380190789699554, decouple_loss:0.01353275217115879
loss_pred:0.027926616370677948, decouple_loss:0.013191516511142254

2023-05-03 02:23:58 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7130638957023621, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.72084641456604, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7082965970039368, mean p set: 0.45035696029663086
loss_pred:0.0276932530105114, decouple_loss:0.014904267154633999
loss_pred:0.028769688680768013, decouple_loss:0.0152451666072011
loss_pred:0.027283504605293274, decouple_loss:0.01494602020829916
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02866707369685173, avg_mse: 0.03351947292685509
current test mse: 0.033519
Iteration: 1821, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515424966812134, gen p mean: -0.7101643681526184, mean p set: 0.4520227611064911
loss_pred:0.027142364531755447, decouple_loss:0.01320707332342863
The modified gen p mean: 0.452606737613678, gen p mean: -0.7180948257446289, mean p set: 0.4530870020389557
loss_pred:0.02724851854145527, decouple_loss:0.013384317979216576
The modified gen p mean: 0.45136353373527527, gen p mean: -0.7043308019638062, mean p set: 0.45184382796287537
loss_pred:0.026558902114629745, decouple_loss:0.013770487159490585
Iteration: 1822, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518470764160156, gen p mean: -0.7029842138290405, mean p set: 0.4523273706436157
The modified gen p mean: 0.452006995677948, gen p mean: -0.7093905210494995, mean p set: 0.4524872899055481
The modified gen p mean: 0.4521905481815338, gen p mean: -0.7116356492042542, mean p set: 0.4526708424091339
loss_pred:0.027316685765981674, decouple_loss:0.013436419889330864
loss_pred:0.02696029469370842, decouple_loss:0.013307110406458378
loss_pred:0.027482222765684128, decouple_loss:0.013204528018832207
Iteration: 1823, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44973111152648926, gen p mean: -0.7131307721138, mean p set: 0.45021140575408936
The modified gen p mean: 0.4515676498413086, gen p mean: -0.7167940735816956, mean p set: 0.4520479440689087
The modified gen p mean: 0.4513913691043854, gen p mean: -0.70502769947052, mean p set: 0.4518716335296631
loss_pred:0.027890538796782494, decouple_loss:0.013287956826388836
loss_pred:0.02614269033074379, decouple_loss:0.012878826819360256
loss_pred:0.02733711153268814, decouple_loss:0.013393768109381199
Iteration: 1824, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520275294780731, gen p mean: -0.726828396320343, mean p set: 0.4525078237056732
The modified gen p mean: 0.4516770541667938, gen p mean: -0.7183584570884705, mean p set: 0.4521573483943939
The modified gen p mean: 0.45160794258117676, gen p mean: -0.7247698903083801, mean p set: 0.45208823680877686
loss_pred:0.027071071788668633, decouple_loss:0.013394977897405624
loss_pred:0.027707668021321297, decouple_loss:0.013532154262065887
loss_pred:0.026767658069729805, decouple_loss:0.012927290983498096
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
NaN value num: 0
Iteration: 1825, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45004430413246155, gen p mean: -0.7190137505531311, mean p set: 0.45052459836006165
The modified gen p mean: 0.45085182785987854, gen p mean: -0.708759605884552, mean p set: 0.45133206248283386
The modified gen p mean: 0.45006638765335083, gen p mean: -0.7152665853500366, mean p set: 0.4505466818809509
loss_pred:0.028561385348439217, decouple_loss:0.014166932553052902
loss_pred:0.029231881722807884, decouple_loss:0.01399183738976717
loss_pred:0.028221435844898224, decouple_loss:0.014102468267083168
Iteration: 1826, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45078355073928833, gen p mean: -0.7108224034309387, mean p set: 0.4512638449668884
The modified gen p mean: 0.45153141021728516, gen p mean: -0.709459662437439, mean p set: 0.45201170444488525
The modified gen p mean: 0.44944486021995544, gen p mean: -0.7144532203674316, mean p set: 0.44992515444755554
loss_pred:0.02818385511636734, decouple_loss:0.013253457844257355
loss_pred:0.026808103546500206, decouple_loss:0.013378538191318512
loss_pred:0.029107816517353058, decouple_loss:0.013715085573494434
Iteration: 1827, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45115041732788086, gen p mean: -0.7123926877975464, mean p set: 0.45163068175315857
The modified gen p mean: 0.4525505304336548, gen p mean: -0.7165057063102722, mean p set: 0.45303085446357727
The modified gen p mean: 0.45012736320495605, gen p mean: -0.7190558910369873, mean p set: 0.45060768723487854
loss_pred:0.027656780555844307, decouple_loss:0.013416974805295467
loss_pred:0.02781025879085064, decouple_loss:0.013446512632071972
loss_pred:0.028660861775279045, decouple_loss:0.013374071568250656
Iteration: 1828, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496115744113922, gen p mean: -0.7158671021461487, mean p set: 0.4500918984413147
The modified gen p mean: 0.4507615566253662, gen p mean: -0.7069391012191772, mean p set: 0.4512418508529663
The modified gen p mean: 0.4514373242855072, gen p mean: -0.7117887139320374, mean p set: 0.4519175887107849
loss_pred:0.028352875262498856, decouple_loss:0.013406208716332912
loss_pred:0.027735883370041847, decouple_loss:0.012905714102089405
loss_pred:0.027929477393627167, decouple_loss:0.01331895962357521
Iteration: 1829, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496927261352539, gen p mean: -0.7160536646842957, mean p set: 0.450173020362854
The modified gen p mean: 0.45130670070648193, gen p mean: -0.7060447335243225, mean p set: 0.45178699493408203
The modified gen p mean: 0.4518773555755615, gen p mean: -0.7100039124488831, mean p set: 0.452357679605484
loss_pred:0.028521673753857613, decouple_loss:0.013337853364646435
loss_pred:0.029155630618333817, decouple_loss:0.01299882959574461
loss_pred:0.02698894962668419, decouple_loss:0.012977578677237034
Iteration: 1830, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523179829120636, gen p mean: -0.7093794345855713, mean p set: 0.4527982771396637
The modified gen p mean: 0.45209649205207825, gen p mean: -0.715554416179657, mean p set: 0.45257672667503357
The modified gen p mean: 0.45083531737327576, gen p mean: -0.7106037139892578, mean p set: 0.45131561160087585
loss_pred:0.029512576758861542, decouple_loss:0.01300351694226265
loss_pred:0.0266214981675148, decouple_loss:0.013120334595441818
loss_pred:0.027288345620036125, decouple_loss:0.012789107859134674
2023-05-03 02:28:20 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7254073023796082, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7175278067588806, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7125135064125061, mean p set: 0.45035696029663086
loss_pred:0.02873959019780159, decouple_loss:0.014880812726914883
loss_pred:0.02763034775853157, decouple_loss:0.014817671850323677
loss_pred:0.02727731131017208, decouple_loss:0.01473070029169321
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028622902929782867, avg_mse: 0.03353340923786163
current test mse: 0.033533
Iteration: 1831, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451535165309906, gen p mean: -0.703513503074646, mean p set: 0.4520154595375061
loss_pred:0.02884216234087944, decouple_loss:0.012881356291472912
The modified gen p mean: 0.4502672851085663, gen p mean: -0.7163575291633606, mean p set: 0.45074760913848877
loss_pred:0.028730567544698715, decouple_loss:0.012757997959852219
The modified gen p mean: 0.45084184408187866, gen p mean: -0.7040682435035706, mean p set: 0.45132210850715637
loss_pred:0.028847292065620422, decouple_loss:0.013180797919631004
Iteration: 1832, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517497420310974, gen p mean: -0.7049000263214111, mean p set: 0.4522300362586975
The modified gen p mean: 0.44965270161628723, gen p mean: -0.7209755778312683, mean p set: 0.45013299584388733
The modified gen p mean: 0.44983214139938354, gen p mean: -0.7179179787635803, mean p set: 0.45031243562698364
loss_pred:0.028002241626381874, decouple_loss:0.013687875121831894loss_pred:0.029454857110977173, decouple_loss:0.012679670937359333
loss_pred:0.02766105905175209, decouple_loss:0.013170013204216957
Iteration: 1833, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509640336036682, gen p mean: -0.7092905640602112, mean p set: 0.4514442980289459
The modified gen p mean: 0.45269033312797546, gen p mean: -0.7110562324523926, mean p set: 0.45317062735557556
The modified gen p mean: 0.4519239068031311, gen p mean: -0.7088471055030823, mean p set: 0.4524042010307312
loss_pred:0.027543161064386368, decouple_loss:0.01317315548658371
loss_pred:0.0282912440598011, decouple_loss:0.012616747058928013
loss_pred:0.02651199698448181, decouple_loss:0.012760519050061703
Iteration: 1834, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506399631500244, gen p mean: -0.715091347694397, mean p set: 0.4511202275753021
The modified gen p mean: 0.44982588291168213, gen p mean: -0.7099959850311279, mean p set: 0.45030614733695984
The modified gen p mean: 0.45038220286369324, gen p mean: -0.7137023210525513, mean p set: 0.45086249709129333
loss_pred:0.028007227927446365, decouple_loss:0.013195707462728024
loss_pred:0.02838536910712719, decouple_loss:0.012609248980879784
loss_pred:0.02776716835796833, decouple_loss:0.013177678920328617
Iteration: 1835, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45096662640571594, gen p mean: -0.7120539546012878, mean p set: 0.45144689083099365
The modified gen p mean: 0.45233821868896484, gen p mean: -0.7023453712463379, mean p set: 0.45281848311424255
The modified gen p mean: 0.4512347877025604, gen p mean: -0.6985436081886292, mean p set: 0.4517151117324829
loss_pred:0.02953331731259823, decouple_loss:0.012976326048374176
loss_pred:0.026351526379585266, decouple_loss:0.013165310025215149
loss_pred:0.027479110285639763, decouple_loss:0.012797567993402481
Iteration: 1836, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503616392612457, gen p mean: -0.7162973880767822, mean p set: 0.4508419334888458
The modified gen p mean: 0.4514906108379364, gen p mean: -0.7123041152954102, mean p set: 0.4519709050655365
The modified gen p mean: 0.4505957067012787, gen p mean: -0.7103061079978943, mean p set: 0.4510760009288788
loss_pred:0.02852889709174633, decouple_loss:0.012781033292412758
loss_pred:0.027751795947551727, decouple_loss:0.012894101440906525
loss_pred:0.02815474383533001, decouple_loss:0.012633957900106907
Iteration: 1837, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010125637054443, gen p mean: -0.7099488973617554, mean p set: 0.45058155059814453
The modified gen p mean: 0.4497206211090088, gen p mean: -0.7138362526893616, mean p set: 0.4502009153366089
The modified gen p mean: 0.451214998960495, gen p mean: -0.7085298895835876, mean p set: 0.4516952931880951
loss_pred:0.028949858620762825, decouple_loss:0.01215021125972271
loss_pred:0.028262922540307045, decouple_loss:0.012945964001119137
loss_pred:0.026727065443992615, decouple_loss:0.012683995068073273
Iteration: 1838, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449715793132782, gen p mean: -0.7084171175956726, mean p set: 0.4501960873603821
The modified gen p mean: 0.4494195580482483, gen p mean: -0.7087872624397278, mean p set: 0.449899822473526
The modified gen p mean: 0.4517272710800171, gen p mean: -0.7077681422233582, mean p set: 0.4522075653076172
loss_pred:0.028413811698555946, decouple_loss:0.012140670791268349
loss_pred:0.02782840095460415, decouple_loss:0.012373942881822586
loss_pred:0.026536688208580017, decouple_loss:0.012566407211124897
Iteration: 1839, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508074223995209, gen p mean: -0.7107306718826294, mean p set: 0.4512876868247986
The modified gen p mean: 0.45082083344459534, gen p mean: -0.6972867250442505, mean p set: 0.45130112767219543
The modified gen p mean: 0.44943222403526306, gen p mean: -0.7074577212333679, mean p set: 0.44991254806518555
loss_pred:0.029095014557242393, decouple_loss:0.012873325496912003
loss_pred:0.027711352333426476, decouple_loss:0.01290059369057417
loss_pred:0.027893029153347015, decouple_loss:0.012723439373075962
Iteration: 1840, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45183250308036804, gen p mean: -0.7054423093795776, mean p set: 0.45231279730796814
The modified gen p mean: 0.4509578347206116, gen p mean: -0.7021492123603821, mean p set: 0.45143812894821167
loss_pred:0.02930338867008686, decouple_loss:0.012401442043483257
The modified gen p mean: 0.4507334530353546, gen p mean: -0.709134042263031, mean p set: 0.4512137174606323
loss_pred:0.028485268354415894, decouple_loss:0.012489796616137028
loss_pred:0.02871822752058506, decouple_loss:0.012593905441462994
2023-05-03 02:32:02 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7221229076385498, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7144153714179993, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7092958688735962, mean p set: 0.45035696029663086
loss_pred:0.028750378638505936, decouple_loss:0.0144278509542346
loss_pred:0.02759435400366783, decouple_loss:0.01432171743363142
loss_pred:0.027235975489020348, decouple_loss:0.01420953031629324
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02857622131705284, avg_mse: 0.033532530069351196
current test mse: 0.033533
Iteration: 1841, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45210567116737366, gen p mean: -0.7058343291282654, mean p set: 0.45258599519729614
The modified gen p mean: 0.4508119225502014, gen p mean: -0.7124319672584534, mean p set: 0.4512922167778015
loss_pred:0.029214907437562943, decouple_loss:0.012663161382079124
loss_pred:0.028847046196460724, decouple_loss:0.012724172323942184
The modified gen p mean: 0.4508407413959503, gen p mean: -0.7055419683456421, mean p set: 0.451321005821228
loss_pred:0.027392882853746414, decouple_loss:0.012549853883683681
Iteration: 1842, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519759714603424, gen p mean: -0.7068011164665222, mean p set: 0.4524562954902649
The modified gen p mean: 0.44986769556999207, gen p mean: -0.7156603336334229, mean p set: 0.45034801959991455
The modified gen p mean: 0.4493287205696106, gen p mean: -0.715978741645813, mean p set: 0.4498090147972107
loss_pred:0.02658974751830101, decouple_loss:0.012523632496595383
loss_pred:0.02847600169479847, decouple_loss:0.012875505723059177
loss_pred:0.029081175103783607, decouple_loss:0.012744387611746788
Iteration: 1843, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497329592704773, gen p mean: -0.7206394672393799, mean p set: 0.4502132534980774
The modified gen p mean: 0.4503265619277954, gen p mean: -0.7215614914894104, mean p set: 0.4508068561553955
The modified gen p mean: 0.45141705870628357, gen p mean: -0.7100460529327393, mean p set: 0.45189735293388367
loss_pred:0.027804892510175705, decouple_loss:0.01221268530935049
loss_pred:0.02886277250945568, decouple_loss:0.01223616860806942
loss_pred:0.02946229837834835, decouple_loss:0.01251436211168766
Iteration: 1844, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518752694129944, gen p mean: -0.7129483819007874, mean p set: 0.4523555636405945
The modified gen p mean: 0.4512809216976166, gen p mean: -0.7168904542922974, mean p set: 0.4517611861228943
The modified gen p mean: 0.45010021328926086, gen p mean: -0.722313404083252, mean p set: 0.45058050751686096
loss_pred:0.026574423536658287, decouple_loss:0.012442029081285
loss_pred:0.02769378200173378, decouple_loss:0.013411009684205055
loss_pred:0.02890864759683609, decouple_loss:0.013043218292295933
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
NaN value num: 0
Iteration: 1845, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490267336368561, gen p mean: -0.7011427879333496, mean p set: 0.4495069682598114
The modified gen p mean: 0.45025137066841125, gen p mean: -0.7122330069541931, mean p set: 0.45073163509368896
The modified gen p mean: 0.44912129640579224, gen p mean: -0.7080882787704468, mean p set: 0.44960159063339233
loss_pred:0.028560170903801918, decouple_loss:0.013285563327372074loss_pred:0.027845900505781174, decouple_loss:0.013165182434022427
loss_pred:0.029543355107307434, decouple_loss:0.014099488966166973
Iteration: 1846, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769158959388733, gen p mean: -0.6927350163459778, mean p set: 0.44817185401916504
The modified gen p mean: 0.44710466265678406, gen p mean: -0.709698498249054, mean p set: 0.44758492708206177
The modified gen p mean: 0.4485575556755066, gen p mean: -0.6949673891067505, mean p set: 0.4490378499031067
loss_pred:0.029089035466313362, decouple_loss:0.01332476269453764
loss_pred:0.027462808415293694, decouple_loss:0.01315256953239441
loss_pred:0.028089478611946106, decouple_loss:0.0136497151106596
Iteration: 1847, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45105379819869995, gen p mean: -0.6965288519859314, mean p set: 0.45153409242630005
The modified gen p mean: 0.44673821330070496, gen p mean: -0.7094552516937256, mean p set: 0.44721853733062744
The modified gen p mean: 0.44873711466789246, gen p mean: -0.70309978723526, mean p set: 0.44921740889549255
loss_pred:0.026485444977879524, decouple_loss:0.01389280240982771
loss_pred:0.027096660807728767, decouple_loss:0.013159532099962234
loss_pred:0.028823314234614372, decouple_loss:0.012781375087797642
Iteration: 1848, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45003271102905273, gen p mean: -0.7002224922180176, mean p set: 0.45051300525665283
The modified gen p mean: 0.4505627155303955, gen p mean: -0.69729083776474, mean p set: 0.4510430097579956
The modified gen p mean: 0.44797125458717346, gen p mean: -0.6909608244895935, mean p set: 0.44845154881477356
loss_pred:0.027773965150117874, decouple_loss:0.012708676047623158
loss_pred:0.02715994045138359, decouple_loss:0.013284724205732346
loss_pred:0.02860970050096512, decouple_loss:0.012876396998763084
Iteration: 1849, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485870599746704, gen p mean: -0.6926252245903015, mean p set: 0.4490673840045929
The modified gen p mean: 0.4501286447048187, gen p mean: -0.7084521651268005, mean p set: 0.4506089687347412
The modified gen p mean: 0.44841670989990234, gen p mean: -0.696899950504303, mean p set: 0.44889700412750244
loss_pred:0.02830127254128456, decouple_loss:0.012964767403900623
loss_pred:0.028357528150081635, decouple_loss:0.01310502178966999
loss_pred:0.028786009177565575, decouple_loss:0.013062718324363232
Iteration: 1850, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45026329159736633, gen p mean: -0.7179175615310669, mean p set: 0.45074358582496643
The modified gen p mean: 0.4507928490638733, gen p mean: -0.7112472057342529, mean p set: 0.4512731432914734
The modified gen p mean: 0.4493923783302307, gen p mean: -0.7148783206939697, mean p set: 0.4498726725578308
loss_pred:0.027934111654758453, decouple_loss:0.012740721926093102
loss_pred:0.026811961084604263, decouple_loss:0.01311727985739708
loss_pred:0.029374897480010986, decouple_loss:0.012641927227377892
2023-05-03 02:36:16 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7230721116065979, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7152549624443054, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7098305821418762, mean p set: 0.45035696029663086
loss_pred:0.02878345549106598, decouple_loss:0.014601345174014568
loss_pred:0.027612905949354172, decouple_loss:0.014378191903233528loss_pred:0.027310017496347427, decouple_loss:0.01429707556962967
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02862340211868286, avg_mse: 0.03356962278485298
current test mse: 0.03357
Iteration: 1851, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44911545515060425, gen p mean: -0.7032606601715088, mean p set: 0.44959574937820435
The modified gen p mean: 0.4482898414134979, gen p mean: -0.7102340459823608, mean p set: 0.448770135641098
loss_pred:0.02825016714632511, decouple_loss:0.012724661268293858
loss_pred:0.028192365542054176, decouple_loss:0.012577838264405727
The modified gen p mean: 0.4497939646244049, gen p mean: -0.7125371098518372, mean p set: 0.4502742886543274
loss_pred:0.02834251895546913, decouple_loss:0.01307692937552929
Iteration: 1852, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500325322151184, gen p mean: -0.7086317539215088, mean p set: 0.4505128264427185
The modified gen p mean: 0.4502987563610077, gen p mean: -0.7187288999557495, mean p set: 0.4507790505886078
The modified gen p mean: 0.44806352257728577, gen p mean: -0.706575334072113, mean p set: 0.4485437870025635
loss_pred:0.027395078912377357, decouple_loss:0.01274732407182455
loss_pred:0.027345454320311546, decouple_loss:0.012704807333648205
loss_pred:0.02834407053887844, decouple_loss:0.012907834723591805
Iteration: 1853, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44914600253105164, gen p mean: -0.7003518342971802, mean p set: 0.44962626695632935
The modified gen p mean: 0.4517248272895813, gen p mean: -0.7078030109405518, mean p set: 0.4522051215171814
The modified gen p mean: 0.448410302400589, gen p mean: -0.701649010181427, mean p set: 0.4488905668258667
loss_pred:0.028636865317821503, decouple_loss:0.012339615263044834
loss_pred:0.026274988427758217, decouple_loss:0.013272511772811413
loss_pred:0.028084207326173782, decouple_loss:0.012948193587362766
Iteration: 1854, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471445083618164, gen p mean: -0.6954007744789124, mean p set: 0.4476247727870941
The modified gen p mean: 0.45115989446640015, gen p mean: -0.6973971724510193, mean p set: 0.45164018869400024
loss_pred:0.02895769104361534, decouple_loss:0.012936490587890148
The modified gen p mean: 0.4480366110801697, gen p mean: -0.6979952454566956, mean p set: 0.4485168755054474
loss_pred:0.025966644287109375, decouple_loss:0.012998743914067745
loss_pred:0.027907844632864, decouple_loss:0.012870050966739655
Iteration: 1855, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44995397329330444, gen p mean: -0.6967731714248657, mean p set: 0.45043426752090454
The modified gen p mean: 0.44963181018829346, gen p mean: -0.7003452181816101, mean p set: 0.45011213421821594
The modified gen p mean: 0.44947007298469543, gen p mean: -0.6912053227424622, mean p set: 0.44995033740997314
loss_pred:0.02739332616329193, decouple_loss:0.013010499067604542
loss_pred:0.028259266167879105, decouple_loss:0.013229788281023502
loss_pred:0.028466133400797844, decouple_loss:0.013507260009646416
Iteration: 1856, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45077434182167053, gen p mean: -0.7013431191444397, mean p set: 0.45125463604927063
The modified gen p mean: 0.4496336281299591, gen p mean: -0.7072868943214417, mean p set: 0.4501139223575592
The modified gen p mean: 0.4507257342338562, gen p mean: -0.7080003023147583, mean p set: 0.4512060284614563
loss_pred:0.02577129378914833, decouple_loss:0.013059879653155804
loss_pred:0.027946991845965385, decouple_loss:0.013243998400866985
loss_pred:0.026746639981865883, decouple_loss:0.012715799733996391
Iteration: 1857, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44674256443977356, gen p mean: -0.709015429019928, mean p set: 0.44722285866737366
The modified gen p mean: 0.4490819573402405, gen p mean: -0.7013872861862183, mean p set: 0.4495622515678406
The modified gen p mean: 0.4507363736629486, gen p mean: -0.7038590312004089, mean p set: 0.4512166678905487
loss_pred:0.026789933443069458, decouple_loss:0.012985399924218655
loss_pred:0.028487760573625565, decouple_loss:0.01319023035466671
loss_pred:0.026722125709056854, decouple_loss:0.012245255522429943
Iteration: 1858, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507047235965729, gen p mean: -0.7016652226448059, mean p set: 0.4511849880218506
The modified gen p mean: 0.44794589281082153, gen p mean: -0.7065735459327698, mean p set: 0.44842615723609924
The modified gen p mean: 0.4507276117801666, gen p mean: -0.6999694108963013, mean p set: 0.4512079358100891
loss_pred:0.02668721415102482, decouple_loss:0.0128095718100667
loss_pred:0.027671590447425842, decouple_loss:0.012728171423077583
loss_pred:0.026553483679890633, decouple_loss:0.012781145051121712
Iteration: 1859, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494977295398712, gen p mean: -0.7022577524185181, mean p set: 0.4499780237674713
The modified gen p mean: 0.44891270995140076, gen p mean: -0.6989668011665344, mean p set: 0.44939300417900085
The modified gen p mean: 0.44984105229377747, gen p mean: -0.7106550335884094, mean p set: 0.45032137632369995
loss_pred:0.028797531500458717, decouple_loss:0.013681173324584961
loss_pred:0.027516130357980728, decouple_loss:0.012951958924531937
loss_pred:0.02855575829744339, decouple_loss:0.013224082067608833
Iteration: 1860, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839614629745483, gen p mean: -0.7136841416358948, mean p set: 0.44887641072273254
The modified gen p mean: 0.4505574107170105, gen p mean: -0.7044246792793274, mean p set: 0.4510376751422882
The modified gen p mean: 0.4486439526081085, gen p mean: -0.7005878686904907, mean p set: 0.449124276638031
loss_pred:0.02786945179104805, decouple_loss:0.013064657337963581
loss_pred:0.028226444497704506, decouple_loss:0.013246304355561733
loss_pred:0.027301961556077003, decouple_loss:0.01298526395112276
2023-05-03 02:39:59 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7235123515129089, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.715961754322052, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7108141779899597, mean p set: 0.45035696029663086
loss_pred:0.02857617475092411, decouple_loss:0.014427502639591694
loss_pred:0.027519116178154945, decouple_loss:0.014047980308532715
loss_pred:0.0270637609064579, decouple_loss:0.013934088870882988
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028426511213183403, avg_mse: 0.03333131968975067
current test mse: 0.033331
Iteration: 1861, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477318227291107, gen p mean: -0.7174797058105469, mean p set: 0.4482121169567108
The modified gen p mean: 0.4476175904273987, gen p mean: -0.7039910554885864, mean p set: 0.4480978846549988
loss_pred:0.027554312720894814, decouple_loss:0.012318620458245277
loss_pred:0.028427233919501305, decouple_loss:0.012702598236501217
The modified gen p mean: 0.44933387637138367, gen p mean: -0.7150961756706238, mean p set: 0.4498141407966614
loss_pred:0.02881680428981781, decouple_loss:0.012856933288276196
Iteration: 1862, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473506510257721, gen p mean: -0.702674925327301, mean p set: 0.4478309452533722
The modified gen p mean: 0.44786569476127625, gen p mean: -0.7176306247711182, mean p set: 0.44834598898887634
The modified gen p mean: 0.4487427771091461, gen p mean: -0.7185032367706299, mean p set: 0.4492231011390686
loss_pred:0.02868189476430416, decouple_loss:0.012222249060869217
loss_pred:0.027566924691200256, decouple_loss:0.012961000204086304
loss_pred:0.028439825400710106, decouple_loss:0.01258341409265995
Iteration: 1863, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819462299346924, gen p mean: -0.7169879674911499, mean p set: 0.44867488741874695
The modified gen p mean: 0.44949010014533997, gen p mean: -0.7121594548225403, mean p set: 0.44997039437294006
The modified gen p mean: 0.4476284086704254, gen p mean: -0.7003327012062073, mean p set: 0.4481086730957031
loss_pred:0.027723293751478195, decouple_loss:0.012151874601840973
loss_pred:0.028195643797516823, decouple_loss:0.012936780229210854
loss_pred:0.028985021635890007, decouple_loss:0.013127840124070644
Iteration: 1864, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45086023211479187, gen p mean: -0.7063942551612854, mean p set: 0.45134055614471436
The modified gen p mean: 0.4501079022884369, gen p mean: -0.7135275602340698, mean p set: 0.4505882263183594
The modified gen p mean: 0.4507609009742737, gen p mean: -0.7059423923492432, mean p set: 0.4512411952018738
loss_pred:0.028867650777101517, decouple_loss:0.012763254344463348
loss_pred:0.028143657371401787, decouple_loss:0.012767369858920574
loss_pred:0.0259017925709486, decouple_loss:0.01335887797176838
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 1865, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490792453289032, gen p mean: -0.7111395001411438, mean p set: 0.4495595097541809
The modified gen p mean: 0.4495813846588135, gen p mean: -0.7117438316345215, mean p set: 0.4500616788864136
The modified gen p mean: 0.4491323232650757, gen p mean: -0.709381639957428, mean p set: 0.4496126174926758
loss_pred:0.028744466602802277, decouple_loss:0.013668278232216835loss_pred:0.027427764609456062, decouple_loss:0.013609454967081547
loss_pred:0.027972396463155746, decouple_loss:0.013538532890379429
Iteration: 1866, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504079818725586, gen p mean: -0.7062068581581116, mean p set: 0.4508882462978363
The modified gen p mean: 0.44935810565948486, gen p mean: -0.7086427211761475, mean p set: 0.44983842968940735
loss_pred:0.027467763051390648, decouple_loss:0.013576219789683819
The modified gen p mean: 0.44897758960723877, gen p mean: -0.7069693803787231, mean p set: 0.44945788383483887
loss_pred:0.02848963811993599, decouple_loss:0.014582589268684387
loss_pred:0.0272773876786232, decouple_loss:0.013864913024008274
Iteration: 1867, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485054016113281, gen p mean: -0.7002425193786621, mean p set: 0.44898566603660583
The modified gen p mean: 0.4486571252346039, gen p mean: -0.7038543224334717, mean p set: 0.449137419462204
The modified gen p mean: 0.4472452700138092, gen p mean: -0.7083327770233154, mean p set: 0.4477255642414093
loss_pred:0.027746226638555527, decouple_loss:0.01358618400990963
loss_pred:0.028511961922049522, decouple_loss:0.013466743752360344
loss_pred:0.02736816182732582, decouple_loss:0.01306855957955122
Iteration: 1868, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44901949167251587, gen p mean: -0.7020268440246582, mean p set: 0.44949984550476074
The modified gen p mean: 0.44939926266670227, gen p mean: -0.7096941471099854, mean p set: 0.44987955689430237
The modified gen p mean: 0.44927430152893066, gen p mean: -0.7039459347724915, mean p set: 0.44975459575653076
loss_pred:0.02782326191663742, decouple_loss:0.013741736300289631
loss_pred:0.027726443484425545, decouple_loss:0.014494004659354687
loss_pred:0.0281512551009655, decouple_loss:0.013156706467270851
Iteration: 1869, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44888004660606384, gen p mean: -0.700758159160614, mean p set: 0.44936034083366394
The modified gen p mean: 0.44738608598709106, gen p mean: -0.7000115513801575, mean p set: 0.4478663504123688
The modified gen p mean: 0.44880861043930054, gen p mean: -0.7090093493461609, mean p set: 0.449288934469223
loss_pred:0.02733682654798031, decouple_loss:0.013484334573149681
loss_pred:0.02758309245109558, decouple_loss:0.013456976972520351
loss_pred:0.027983926236629486, decouple_loss:0.013255122117698193
Iteration: 1870, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480966031551361, gen p mean: -0.704790472984314, mean p set: 0.4485769271850586
The modified gen p mean: 0.4487566351890564, gen p mean: -0.6895420551300049, mean p set: 0.4492368996143341
The modified gen p mean: 0.4494432210922241, gen p mean: -0.6931727528572083, mean p set: 0.4499235153198242
loss_pred:0.027971038594841957, decouple_loss:0.013835223391652107
loss_pred:0.028561443090438843, decouple_loss:0.014159084297716618
loss_pred:0.0290895476937294, decouple_loss:0.014179101213812828
2023-05-03 02:44:24 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7115243077278137, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7198706269264221, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7067041993141174, mean p set: 0.45035696029663086
loss_pred:0.027404749765992165, decouple_loss:0.013723606243729591
loss_pred:0.028502285480499268, decouple_loss:0.01396949402987957
loss_pred:0.026860475540161133, decouple_loss:0.01361079141497612
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028277568519115448, avg_mse: 0.03312184289097786
current test mse: 0.033122
Iteration: 1871, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491627514362335, gen p mean: -0.70572829246521, mean p set: 0.44964301586151123
loss_pred:0.028797375038266182, decouple_loss:0.013284498825669289
The modified gen p mean: 0.4484628736972809, gen p mean: -0.7145370841026306, mean p set: 0.448943167924881
loss_pred:0.02736772410571575, decouple_loss:0.013436987064778805
The modified gen p mean: 0.44772836565971375, gen p mean: -0.7091839909553528, mean p set: 0.44820865988731384
loss_pred:0.027924804016947746, decouple_loss:0.014156313613057137
Iteration: 1872, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492068290710449, gen p mean: -0.714636504650116, mean p set: 0.449687123298645
The modified gen p mean: 0.4478687345981598, gen p mean: -0.7233099937438965, mean p set: 0.4483490288257599
The modified gen p mean: 0.4484816789627075, gen p mean: -0.7194976806640625, mean p set: 0.44896194338798523
loss_pred:0.02852591872215271, decouple_loss:0.012948905117809772
loss_pred:0.027923250570893288, decouple_loss:0.013841244392096996
loss_pred:0.0281166210770607, decouple_loss:0.013995310291647911
Iteration: 1873, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44854825735092163, gen p mean: -0.7203013300895691, mean p set: 0.44902855157852173
The modified gen p mean: 0.45015114545822144, gen p mean: -0.7201058268547058, mean p set: 0.45063140988349915
The modified gen p mean: 0.4481542706489563, gen p mean: -0.7215363383293152, mean p set: 0.448634535074234
loss_pred:0.027841325849294662, decouple_loss:0.013526481576263905
loss_pred:0.028056548908352852, decouple_loss:0.013946915045380592
loss_pred:0.027473362162709236, decouple_loss:0.013358842581510544
Iteration: 1874, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447726845741272, gen p mean: -0.714796245098114, mean p set: 0.44820713996887207
The modified gen p mean: 0.4499039351940155, gen p mean: -0.7203538417816162, mean p set: 0.4503842294216156
The modified gen p mean: 0.44981876015663147, gen p mean: -0.720532238483429, mean p set: 0.45029905438423157
loss_pred:0.028429388999938965, decouple_loss:0.013066468760371208
loss_pred:0.028265053406357765, decouple_loss:0.013271068222820759
loss_pred:0.027608202770352364, decouple_loss:0.012940937653183937
Iteration: 1875, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501529932022095, gen p mean: -0.7192237377166748, mean p set: 0.4506332576274872
The modified gen p mean: 0.4493882358074188, gen p mean: -0.7188475131988525, mean p set: 0.4498685300350189
The modified gen p mean: 0.4478866457939148, gen p mean: -0.7152906060218811, mean p set: 0.4483669102191925
loss_pred:0.02661142311990261, decouple_loss:0.013453087769448757
loss_pred:0.028062820434570312, decouple_loss:0.012470586225390434
loss_pred:0.02795674465596676, decouple_loss:0.012391352094709873
Iteration: 1876, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44884318113327026, gen p mean: -0.7146288752555847, mean p set: 0.44932347536087036
The modified gen p mean: 0.44852960109710693, gen p mean: -0.7143144011497498, mean p set: 0.44900989532470703
The modified gen p mean: 0.4481092393398285, gen p mean: -0.7054987549781799, mean p set: 0.4485895335674286
loss_pred:0.027949631214141846, decouple_loss:0.013143658638000488loss_pred:0.02719205617904663, decouple_loss:0.012358945794403553
loss_pred:0.027419202029705048, decouple_loss:0.012901896610856056
Iteration: 1877, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44662222266197205, gen p mean: -0.7001069188117981, mean p set: 0.44710251688957214
The modified gen p mean: 0.44998177886009216, gen p mean: -0.709963858127594, mean p set: 0.45046207308769226
The modified gen p mean: 0.4491191506385803, gen p mean: -0.701073169708252, mean p set: 0.4495994448661804
loss_pred:0.027036959305405617, decouple_loss:0.013290957547724247loss_pred:0.027700642123818398, decouple_loss:0.013680119067430496
loss_pred:0.028490472584962845, decouple_loss:0.013131551444530487
Iteration: 1878, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481106400489807, gen p mean: -0.698573648929596, mean p set: 0.4485909342765808
The modified gen p mean: 0.4484004080295563, gen p mean: -0.6900863647460938, mean p set: 0.44888070225715637
The modified gen p mean: 0.448865681886673, gen p mean: -0.6972120404243469, mean p set: 0.4493459463119507
loss_pred:0.028046535328030586, decouple_loss:0.013011978007853031
loss_pred:0.027600828558206558, decouple_loss:0.012907454743981361
loss_pred:0.028130674734711647, decouple_loss:0.013189034536480904
Iteration: 1879, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493604302406311, gen p mean: -0.7000547051429749, mean p set: 0.4498407244682312
The modified gen p mean: 0.44979003071784973, gen p mean: -0.7066900730133057, mean p set: 0.4502703547477722
The modified gen p mean: 0.44856056571006775, gen p mean: -0.7086759209632874, mean p set: 0.44904085993766785
loss_pred:0.027883440256118774, decouple_loss:0.012727409601211548
loss_pred:0.028022022917866707, decouple_loss:0.013424020260572433
loss_pred:0.027783414348959923, decouple_loss:0.012788400053977966
Iteration: 1880, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487477242946625, gen p mean: -0.7073372006416321, mean p set: 0.4492279887199402
The modified gen p mean: 0.4475763440132141, gen p mean: -0.7095481157302856, mean p set: 0.448056697845459
The modified gen p mean: 0.4483877718448639, gen p mean: -0.708210289478302, mean p set: 0.4488680362701416
loss_pred:0.027253946289420128, decouple_loss:0.013024586252868176
loss_pred:0.02697022072970867, decouple_loss:0.012916574254631996
loss_pred:0.02786363661289215, decouple_loss:0.012743205763399601
2023-05-03 02:48:09 testing...
The modified gen p mean: 0.4495830237865448, gen p mean: -0.7003723382949829, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7076429724693298, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6959173679351807, mean p set: 0.45035696029663086
loss_pred:0.027170732617378235, decouple_loss:0.013140368275344372
loss_pred:0.028269676491618156, decouple_loss:0.013494071550667286
loss_pred:0.02681601792573929, decouple_loss:0.013189508579671383
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02808254025876522, avg_mse: 0.03288182616233826
current test mse: 0.032882
Iteration: 1881, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796690344810486, gen p mean: -0.6999860405921936, mean p set: 0.44844722747802734
loss_pred:0.02763643115758896, decouple_loss:0.012884446419775486
The modified gen p mean: 0.4497470557689667, gen p mean: -0.6993335485458374, mean p set: 0.45022737979888916
loss_pred:0.028720121830701828, decouple_loss:0.012804125435650349
The modified gen p mean: 0.44882893562316895, gen p mean: -0.698076605796814, mean p set: 0.44930922985076904
loss_pred:0.027402212843298912, decouple_loss:0.013080990873277187
Iteration: 1882, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44813576340675354, gen p mean: -0.697897732257843, mean p set: 0.44861605763435364
The modified gen p mean: 0.44869935512542725, gen p mean: -0.6964744925498962, mean p set: 0.44917967915534973
The modified gen p mean: 0.4494730532169342, gen p mean: -0.6941580176353455, mean p set: 0.4499533474445343
loss_pred:0.027317821979522705, decouple_loss:0.013017366640269756
loss_pred:0.027409065514802933, decouple_loss:0.012617319822311401
loss_pred:0.02736515738070011, decouple_loss:0.012905741110444069
Iteration: 1883, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464896321296692, gen p mean: -0.6946449279785156, mean p set: 0.4469698667526245
The modified gen p mean: 0.44910913705825806, gen p mean: -0.6948795318603516, mean p set: 0.44958946108818054
The modified gen p mean: 0.4502018690109253, gen p mean: -0.6951180696487427, mean p set: 0.450682133436203
loss_pred:0.02750197798013687, decouple_loss:0.01295187883079052
loss_pred:0.027725661173462868, decouple_loss:0.012650815770030022
loss_pred:0.02801249921321869, decouple_loss:0.012903447262942791
Iteration: 1884, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44952392578125, gen p mean: -0.693227231502533, mean p set: 0.4500042200088501
The modified gen p mean: 0.4476395547389984, gen p mean: -0.7006612420082092, mean p set: 0.4481198489665985
The modified gen p mean: 0.44789427518844604, gen p mean: -0.6940222978591919, mean p set: 0.44837456941604614
loss_pred:0.027755217626690865, decouple_loss:0.013242154382169247
loss_pred:0.027169590815901756, decouple_loss:0.012396282516419888
loss_pred:0.02762221172451973, decouple_loss:0.01239948719739914
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
NaN value num: 0
Iteration: 1885, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536208212375641, gen p mean: -0.7026930451393127, mean p set: 0.4541010856628418
The modified gen p mean: 0.4523594081401825, gen p mean: -0.6996834874153137, mean p set: 0.4528396725654602
The modified gen p mean: 0.45216047763824463, gen p mean: -0.6989443898200989, mean p set: 0.45264074206352234
loss_pred:0.025942962616682053, decouple_loss:0.01465429738163948
loss_pred:0.0270805973559618, decouple_loss:0.013957565650343895
loss_pred:0.02574259415268898, decouple_loss:0.01515172515064478
Iteration: 1886, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450270414352417, gen p mean: -0.6993951201438904, mean p set: 0.4507507383823395
The modified gen p mean: 0.45321089029312134, gen p mean: -0.6990547180175781, mean p set: 0.45369112491607666
The modified gen p mean: 0.45256632566452026, gen p mean: -0.6986506581306458, mean p set: 0.453046590089798
loss_pred:0.026157598942518234, decouple_loss:0.0138021195307374
loss_pred:0.027717547491192818, decouple_loss:0.01416335441172123
loss_pred:0.027236834168434143, decouple_loss:0.013721244409680367
Iteration: 1887, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453023225069046, gen p mean: -0.7056915163993835, mean p set: 0.4535035192966461
The modified gen p mean: 0.45288416743278503, gen p mean: -0.7061129212379456, mean p set: 0.45336446166038513
The modified gen p mean: 0.4530491232872009, gen p mean: -0.7067429423332214, mean p set: 0.453529417514801
loss_pred:0.026624081656336784, decouple_loss:0.013351958245038986
loss_pred:0.026501638814806938, decouple_loss:0.013464188203215599
loss_pred:0.02642017975449562, decouple_loss:0.013395089656114578
Iteration: 1888, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4538981318473816, gen p mean: -0.717266321182251, mean p set: 0.4543784260749817
The modified gen p mean: 0.45255032181739807, gen p mean: -0.7246536612510681, mean p set: 0.4530305862426758
The modified gen p mean: 0.45374584197998047, gen p mean: -0.7293904423713684, mean p set: 0.4542261064052582
loss_pred:0.026791252195835114, decouple_loss:0.013770145364105701
loss_pred:0.025899574160575867, decouple_loss:0.01352853886783123
loss_pred:0.026925887912511826, decouple_loss:0.013537919148802757
Iteration: 1889, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45277315378189087, gen p mean: -0.7109636068344116, mean p set: 0.45325344800949097
The modified gen p mean: 0.45275554060935974, gen p mean: -0.7033818364143372, mean p set: 0.45323580503463745
The modified gen p mean: 0.4543045461177826, gen p mean: -0.7187157273292542, mean p set: 0.4547848105430603
loss_pred:0.02572883479297161, decouple_loss:0.013258152641355991
loss_pred:0.025631872937083244, decouple_loss:0.013572766445577145
loss_pred:0.027042206376791, decouple_loss:0.014333024621009827
Iteration: 1890, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530012309551239, gen p mean: -0.7034446001052856, mean p set: 0.453481525182724
The modified gen p mean: 0.45317336916923523, gen p mean: -0.7056110501289368, mean p set: 0.4536536633968353
The modified gen p mean: 0.45313799381256104, gen p mean: -0.7037334442138672, mean p set: 0.45361828804016113
loss_pred:0.026803122833371162, decouple_loss:0.013632302172482014
loss_pred:0.026205943897366524, decouple_loss:0.013352669775485992
loss_pred:0.02598007582128048, decouple_loss:0.012942571192979813
2023-05-03 02:52:29 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7128669619560242, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7055730223655701, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7012572288513184, mean p set: 0.45035696029663086
loss_pred:0.0285433828830719, decouple_loss:0.015019906684756279
loss_pred:0.027096353471279144, decouple_loss:0.01464525144547224loss_pred:0.027416501194238663, decouple_loss:0.014475996606051922
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028421100229024887, avg_mse: 0.033394597470760345
current test mse: 0.033395
Iteration: 1891, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45443862676620483, gen p mean: -0.7054899334907532, mean p set: 0.45491892099380493
The modified gen p mean: 0.4518917500972748, gen p mean: -0.701574981212616, mean p set: 0.45237207412719727
loss_pred:0.027023879811167717, decouple_loss:0.013555722311139107
loss_pred:0.02648162469267845, decouple_loss:0.013012317940592766
The modified gen p mean: 0.4534859359264374, gen p mean: -0.7065725922584534, mean p set: 0.45396625995635986
loss_pred:0.026395125314593315, decouple_loss:0.013331489637494087
Iteration: 1892, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45436426997184753, gen p mean: -0.7136931419372559, mean p set: 0.45484453439712524
The modified gen p mean: 0.45244985818862915, gen p mean: -0.7155539393424988, mean p set: 0.45293015241622925
The modified gen p mean: 0.45251429080963135, gen p mean: -0.7108895778656006, mean p set: 0.45299461483955383
loss_pred:0.026257939636707306, decouple_loss:0.013073783367872238
loss_pred:0.02542165480554104, decouple_loss:0.01306369248777628
loss_pred:0.02664482593536377, decouple_loss:0.013099786825478077
Iteration: 1893, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45329082012176514, gen p mean: -0.7177364826202393, mean p set: 0.4537711441516876
The modified gen p mean: 0.45247045159339905, gen p mean: -0.7176101803779602, mean p set: 0.45295077562332153
The modified gen p mean: 0.4534195065498352, gen p mean: -0.7251089811325073, mean p set: 0.4538998007774353
loss_pred:0.0266669150441885, decouple_loss:0.012746460735797882
loss_pred:0.025450948625802994, decouple_loss:0.012992219999432564
loss_pred:0.02523220330476761, decouple_loss:0.013043335638940334
Iteration: 1894, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4537653923034668, gen p mean: -0.7209174633026123, mean p set: 0.4542456865310669
The modified gen p mean: 0.4530271291732788, gen p mean: -0.7228497266769409, mean p set: 0.4535074532032013
The modified gen p mean: 0.4535242021083832, gen p mean: -0.7136704325675964, mean p set: 0.4540044963359833
loss_pred:0.02663278579711914, decouple_loss:0.012981300242245197
loss_pred:0.025332849472761154, decouple_loss:0.012537414208054543
loss_pred:0.028339620679616928, decouple_loss:0.013622598722577095
Iteration: 1895, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45344677567481995, gen p mean: -0.7236447930335999, mean p set: 0.45392709970474243
The modified gen p mean: 0.45297107100486755, gen p mean: -0.7274550199508667, mean p set: 0.45345136523246765
The modified gen p mean: 0.4540155529975891, gen p mean: -0.7206549644470215, mean p set: 0.4544958472251892
loss_pred:0.02654169127345085, decouple_loss:0.012878932058811188
loss_pred:0.026339057832956314, decouple_loss:0.013019554316997528
loss_pred:0.026316165924072266, decouple_loss:0.012608681805431843
Iteration: 1896, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45459312200546265, gen p mean: -0.7148640155792236, mean p set: 0.45507341623306274
The modified gen p mean: 0.45303255319595337, gen p mean: -0.7117674350738525, mean p set: 0.45351284742355347
The modified gen p mean: 0.4523785710334778, gen p mean: -0.7120838165283203, mean p set: 0.4528588652610779
loss_pred:0.02698589488863945, decouple_loss:0.012625311501324177
loss_pred:0.026607627049088478, decouple_loss:0.012596487998962402
loss_pred:0.026421066373586655, decouple_loss:0.013057833537459373
Iteration: 1897, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532182514667511, gen p mean: -0.7164327502250671, mean p set: 0.4536985456943512
The modified gen p mean: 0.4524284303188324, gen p mean: -0.7141668796539307, mean p set: 0.4529087543487549
The modified gen p mean: 0.45026296377182007, gen p mean: -0.7154175639152527, mean p set: 0.45074325799942017
loss_pred:0.026512833312153816, decouple_loss:0.012721903622150421
loss_pred:0.02660108171403408, decouple_loss:0.012700564227998257
loss_pred:0.026580095291137695, decouple_loss:0.013181173242628574
Iteration: 1898, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45335716009140015, gen p mean: -0.7219545841217041, mean p set: 0.45383745431900024
The modified gen p mean: 0.45377469062805176, gen p mean: -0.7347506880760193, mean p set: 0.45425495505332947
The modified gen p mean: 0.45412731170654297, gen p mean: -0.7251508235931396, mean p set: 0.45460760593414307
loss_pred:0.026647266000509262, decouple_loss:0.012561190873384476
loss_pred:0.026896700263023376, decouple_loss:0.012751922011375427
loss_pred:0.027406584471464157, decouple_loss:0.013018235564231873
Iteration: 1899, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528639018535614, gen p mean: -0.722088634967804, mean p set: 0.4533441960811615
The modified gen p mean: 0.4528730809688568, gen p mean: -0.7248116135597229, mean p set: 0.4533534049987793
The modified gen p mean: 0.453561395406723, gen p mean: -0.7241889238357544, mean p set: 0.4540416896343231
loss_pred:0.026607083156704903, decouple_loss:0.012284860014915466
loss_pred:0.026249220594763756, decouple_loss:0.012849286198616028
loss_pred:0.025911619886755943, decouple_loss:0.012402856722474098
Iteration: 1900, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453091025352478, gen p mean: -0.7171176075935364, mean p set: 0.4535713493824005
The modified gen p mean: 0.4529658854007721, gen p mean: -0.7161545753479004, mean p set: 0.4534461498260498
The modified gen p mean: 0.4506906270980835, gen p mean: -0.7155344486236572, mean p set: 0.451170951128006
loss_pred:0.025869566947221756, decouple_loss:0.012021532282233238
loss_pred:0.026514586061239243, decouple_loss:0.012707817368209362
loss_pred:0.025617443025112152, decouple_loss:0.012689133174717426
2023-05-03 02:56:14 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7239290475845337, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7163016200065613, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7118014097213745, mean p set: 0.45035696029663086
loss_pred:0.028627987951040268, decouple_loss:0.014278989285230637
loss_pred:0.027480045333504677, decouple_loss:0.014010113663971424
loss_pred:0.026964079588651657, decouple_loss:0.01419285498559475
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02839873731136322, avg_mse: 0.0334097258746624
current test mse: 0.03341
Iteration: 1901, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453432559967041, gen p mean: -0.7163516879081726, mean p set: 0.4539128243923187
The modified gen p mean: 0.4524138271808624, gen p mean: -0.7137317657470703, mean p set: 0.4528941214084625
loss_pred:0.025911714881658554, decouple_loss:0.012192079797387123
loss_pred:0.025966985151171684, decouple_loss:0.012377964332699776
The modified gen p mean: 0.4521952271461487, gen p mean: -0.7111225128173828, mean p set: 0.4526754915714264
loss_pred:0.025884434580802917, decouple_loss:0.012606306001543999
Iteration: 1902, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45182642340660095, gen p mean: -0.7116760015487671, mean p set: 0.45230671763420105
The modified gen p mean: 0.4535083472728729, gen p mean: -0.7105817198753357, mean p set: 0.453988641500473
The modified gen p mean: 0.4523913264274597, gen p mean: -0.7097047567367554, mean p set: 0.4528715908527374
loss_pred:0.026509609073400497, decouple_loss:0.012168985791504383
loss_pred:0.02779255248606205, decouple_loss:0.012909737415611744
loss_pred:0.02470972202718258, decouple_loss:0.012538990937173367
Iteration: 1903, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45387405157089233, gen p mean: -0.720824122428894, mean p set: 0.45435431599617004
The modified gen p mean: 0.4529619812965393, gen p mean: -0.7232419848442078, mean p set: 0.4534422755241394
The modified gen p mean: 0.4539237916469574, gen p mean: -0.7189368009567261, mean p set: 0.4544040560722351
loss_pred:0.026353763416409492, decouple_loss:0.012501371093094349
loss_pred:0.02593097649514675, decouple_loss:0.012036512605845928
loss_pred:0.02798030525445938, decouple_loss:0.012804517522454262
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
NaN value num: 0
Iteration: 1904, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473279118537903, gen p mean: -0.7339044809341431, mean p set: 0.44780823588371277
The modified gen p mean: 0.44721081852912903, gen p mean: -0.738065242767334, mean p set: 0.4476911425590515
The modified gen p mean: 0.44799524545669556, gen p mean: -0.7386383414268494, mean p set: 0.44847550988197327
loss_pred:0.027995910495519638, decouple_loss:0.013489694334566593
loss_pred:0.02812878042459488, decouple_loss:0.013582237996160984
loss_pred:0.027316460385918617, decouple_loss:0.013734533451497555
Iteration: 1905, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724640250205994, gen p mean: -0.7469768524169922, mean p set: 0.44772669672966003
The modified gen p mean: 0.44686490297317505, gen p mean: -0.7425767183303833, mean p set: 0.44734519720077515
The modified gen p mean: 0.4484882354736328, gen p mean: -0.7435632944107056, mean p set: 0.4489684998989105
loss_pred:0.02731388621032238, decouple_loss:0.013165455311536789
loss_pred:0.028267761692404747, decouple_loss:0.014033973217010498
loss_pred:0.02738156169652939, decouple_loss:0.013515136204659939
Iteration: 1906, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474271237850189, gen p mean: -0.7431305050849915, mean p set: 0.44790738821029663
The modified gen p mean: 0.4461824595928192, gen p mean: -0.7414785027503967, mean p set: 0.4466627538204193
The modified gen p mean: 0.44822707772254944, gen p mean: -0.7366505861282349, mean p set: 0.44870737195014954
loss_pred:0.027126643806695938, decouple_loss:0.013062153942883015
loss_pred:0.029144996777176857, decouple_loss:0.014607623219490051
loss_pred:0.027454186230897903, decouple_loss:0.012965147383511066
Iteration: 1907, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480557441711426, gen p mean: -0.7436398863792419, mean p set: 0.44853606820106506
The modified gen p mean: 0.4471440613269806, gen p mean: -0.7362294793128967, mean p set: 0.4476243257522583
The modified gen p mean: 0.44835320115089417, gen p mean: -0.7342233657836914, mean p set: 0.44883349537849426
loss_pred:0.02760038524866104, decouple_loss:0.013434750027954578
loss_pred:0.028475742787122726, decouple_loss:0.01324398536235094
loss_pred:0.027232158929109573, decouple_loss:0.013729146681725979
Iteration: 1908, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466222822666168, gen p mean: -0.733115553855896, mean p set: 0.44710254669189453
The modified gen p mean: 0.4484856128692627, gen p mean: -0.7415006160736084, mean p set: 0.4489658772945404
The modified gen p mean: 0.4468170702457428, gen p mean: -0.7393327951431274, mean p set: 0.4472973346710205
loss_pred:0.029067326337099075, decouple_loss:0.01364969927817583
loss_pred:0.02859782986342907, decouple_loss:0.014474674127995968
loss_pred:0.027783436700701714, decouple_loss:0.013996537774801254
Iteration: 1909, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467247426509857, gen p mean: -0.7404355406761169, mean p set: 0.4472050368785858
The modified gen p mean: 0.44837939739227295, gen p mean: -0.7394153475761414, mean p set: 0.44885969161987305
The modified gen p mean: 0.4475243091583252, gen p mean: -0.74085932970047, mean p set: 0.4480046033859253
loss_pred:0.028499433770775795, decouple_loss:0.013562756590545177
loss_pred:0.027844641357660294, decouple_loss:0.013318842276930809
loss_pred:0.02727990411221981, decouple_loss:0.013143288902938366
Iteration: 1910, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44690123200416565, gen p mean: -0.73640376329422, mean p set: 0.44738152623176575
The modified gen p mean: 0.4478841722011566, gen p mean: -0.748715877532959, mean p set: 0.4483644366264343
The modified gen p mean: 0.4471151828765869, gen p mean: -0.7462462186813354, mean p set: 0.4475955367088318
loss_pred:0.028114482760429382, decouple_loss:0.0134191969409585
loss_pred:0.027276646345853806, decouple_loss:0.013411631807684898
loss_pred:0.026636237278580666, decouple_loss:0.013604420237243176
2023-05-03 03:00:32 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7308768033981323, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7390586733818054, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7261319160461426, mean p set: 0.45035696029663086
loss_pred:0.02745305746793747, decouple_loss:0.0140415970236063
loss_pred:0.02844906970858574, decouple_loss:0.014182861894369125
loss_pred:0.02695082500576973, decouple_loss:0.014169727452099323
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028324222192168236, avg_mse: 0.033287517726421356
current test mse: 0.033288
Iteration: 1911, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469181001186371, gen p mean: -0.741005539894104, mean p set: 0.4473983943462372
The modified gen p mean: 0.44743624329566956, gen p mean: -0.7311980128288269, mean p set: 0.44791650772094727
loss_pred:0.02713765762746334, decouple_loss:0.013173259794712067
loss_pred:0.02783462032675743, decouple_loss:0.013400380499660969
The modified gen p mean: 0.4474489986896515, gen p mean: -0.7467432618141174, mean p set: 0.4479292929172516
loss_pred:0.027642615139484406, decouple_loss:0.013910997658967972
Iteration: 1912, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743895530700684, gen p mean: -0.7185153365135193, mean p set: 0.44791924953460693
The modified gen p mean: 0.44554173946380615, gen p mean: -0.7198262810707092, mean p set: 0.44602203369140625
The modified gen p mean: 0.4476079046726227, gen p mean: -0.7276996374130249, mean p set: 0.4480881989002228
loss_pred:0.027290688827633858, decouple_loss:0.013235029764473438
loss_pred:0.02814597822725773, decouple_loss:0.013924594968557358
loss_pred:0.026640499010682106, decouple_loss:0.012998633086681366
Iteration: 1913, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471989572048187, gen p mean: -0.7170866131782532, mean p set: 0.4476792514324188
The modified gen p mean: 0.44697442650794983, gen p mean: -0.7235372066497803, mean p set: 0.4474547207355499
The modified gen p mean: 0.4471791088581085, gen p mean: -0.7066704630851746, mean p set: 0.44765937328338623
loss_pred:0.028472287580370903, decouple_loss:0.01297930721193552
loss_pred:0.027662675827741623, decouple_loss:0.013134698383510113
loss_pred:0.026743248105049133, decouple_loss:0.012913374230265617
Iteration: 1914, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44496357440948486, gen p mean: -0.7100314497947693, mean p set: 0.4454438388347626
The modified gen p mean: 0.44696685671806335, gen p mean: -0.7170422673225403, mean p set: 0.44744715094566345
The modified gen p mean: 0.44665148854255676, gen p mean: -0.7120469212532043, mean p set: 0.4471317529678345
loss_pred:0.028474897146224976, decouple_loss:0.013154642656445503
loss_pred:0.02884298376739025, decouple_loss:0.012944487854838371
loss_pred:0.028831854462623596, decouple_loss:0.01305948942899704
Iteration: 1915, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472615420818329, gen p mean: -0.7277804017066956, mean p set: 0.447741836309433
The modified gen p mean: 0.44686359167099, gen p mean: -0.722197413444519, mean p set: 0.4473438560962677
The modified gen p mean: 0.44812196493148804, gen p mean: -0.7278167009353638, mean p set: 0.44860225915908813
loss_pred:0.028015224263072014, decouple_loss:0.01298889983445406
loss_pred:0.027935108169913292, decouple_loss:0.01309433113783598
loss_pred:0.028382863849401474, decouple_loss:0.012813745066523552
Iteration: 1916, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44602862000465393, gen p mean: -0.7196665406227112, mean p set: 0.44650891423225403
The modified gen p mean: 0.448246568441391, gen p mean: -0.7277719974517822, mean p set: 0.4487268626689911
The modified gen p mean: 0.4473952651023865, gen p mean: -0.7263427376747131, mean p set: 0.4478755593299866
loss_pred:0.02755294181406498, decouple_loss:0.013082602061331272
loss_pred:0.02741323783993721, decouple_loss:0.013542640022933483
loss_pred:0.027161715552210808, decouple_loss:0.012795544229447842
Iteration: 1917, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729796051979065, gen p mean: -0.727378249168396, mean p set: 0.44777825474739075
The modified gen p mean: 0.4468848705291748, gen p mean: -0.7279495000839233, mean p set: 0.4473651349544525
The modified gen p mean: 0.44767695665359497, gen p mean: -0.728893518447876, mean p set: 0.4481572210788727
loss_pred:0.02838081680238247, decouple_loss:0.01339018251746893
loss_pred:0.02728237770497799, decouple_loss:0.012716718949377537
loss_pred:0.028055109083652496, decouple_loss:0.012082705274224281
Iteration: 1918, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44804710149765015, gen p mean: -0.7260485291481018, mean p set: 0.44852742552757263
The modified gen p mean: 0.44681254029273987, gen p mean: -0.7178208231925964, mean p set: 0.4472928047180176
The modified gen p mean: 0.4465027153491974, gen p mean: -0.711949348449707, mean p set: 0.4469830095767975
loss_pred:0.028521662577986717, decouple_loss:0.012552392669022083loss_pred:0.02853301726281643, decouple_loss:0.01261111069470644
loss_pred:0.027683038264513016, decouple_loss:0.012552527710795403
Iteration: 1919, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44446447491645813, gen p mean: -0.7028011083602905, mean p set: 0.4449447691440582
The modified gen p mean: 0.4448032081127167, gen p mean: -0.7018210887908936, mean p set: 0.4452835023403168
The modified gen p mean: 0.4467393755912781, gen p mean: -0.7153705358505249, mean p set: 0.4472196698188782
loss_pred:0.028680164366960526, decouple_loss:0.012730930000543594
loss_pred:0.028041010722517967, decouple_loss:0.01294020190834999
loss_pred:0.027370506897568703, decouple_loss:0.012484317645430565
Iteration: 1920, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44757914543151855, gen p mean: -0.7054028511047363, mean p set: 0.44805940985679626
The modified gen p mean: 0.44820907711982727, gen p mean: -0.7102009057998657, mean p set: 0.448689341545105
The modified gen p mean: 0.4472980797290802, gen p mean: -0.7084421515464783, mean p set: 0.4477783739566803
loss_pred:0.027024801820516586, decouple_loss:0.012877858243882656
loss_pred:0.026831895112991333, decouple_loss:0.012667229399085045
loss_pred:0.0287481639534235, decouple_loss:0.012270564213395119
2023-05-03 03:04:13 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.707034170627594, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.714272677898407, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7026289701461792, mean p set: 0.45035696029663086
loss_pred:0.027257690206170082, decouple_loss:0.012851350009441376
loss_pred:0.028279103338718414, decouple_loss:0.013350415974855423
loss_pred:0.026711413636803627, decouple_loss:0.013021442107856274
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028069790452718735, avg_mse: 0.03299277275800705
current test mse: 0.032993
Iteration: 1921, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798991084098816, gen p mean: -0.7136911153793335, mean p set: 0.44847017526626587
loss_pred:0.027428193017840385, decouple_loss:0.012427971698343754
The modified gen p mean: 0.4477062225341797, gen p mean: -0.7116785645484924, mean p set: 0.4481865465641022
loss_pred:0.02647896483540535, decouple_loss:0.012357430532574654
The modified gen p mean: 0.447712779045105, gen p mean: -0.7155857086181641, mean p set: 0.4481930732727051
loss_pred:0.028133809566497803, decouple_loss:0.012245995923876762
Iteration: 1922, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474976360797882, gen p mean: -0.7156040668487549, mean p set: 0.4479779005050659
The modified gen p mean: 0.4481102526187897, gen p mean: -0.7121749520301819, mean p set: 0.44859054684638977
The modified gen p mean: 0.44450643658638, gen p mean: -0.7057830095291138, mean p set: 0.4449867010116577
loss_pred:0.02886001020669937, decouple_loss:0.012102662585675716
loss_pred:0.027266576886177063, decouple_loss:0.012344716116786003
loss_pred:0.028515039011836052, decouple_loss:0.011977636255323887
Iteration: 1923, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447120726108551, gen p mean: -0.7161829471588135, mean p set: 0.4476010203361511
The modified gen p mean: 0.4483972489833832, gen p mean: -0.7119665741920471, mean p set: 0.4488775134086609
The modified gen p mean: 0.44801080226898193, gen p mean: -0.7215702533721924, mean p set: 0.44849109649658203
loss_pred:0.027123836800456047, decouple_loss:0.01186082512140274
loss_pred:0.02700047194957733, decouple_loss:0.01192349661141634
loss_pred:0.026950642466545105, decouple_loss:0.012235080823302269
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
NaN value num: 0
Iteration: 1924, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496047794818878, gen p mean: -0.7106764316558838, mean p set: 0.4500850439071655
The modified gen p mean: 0.4496050179004669, gen p mean: -0.7094754576683044, mean p set: 0.450085312128067
The modified gen p mean: 0.44855111837387085, gen p mean: -0.7131410837173462, mean p set: 0.44903138279914856
loss_pred:0.026828870177268982, decouple_loss:0.014294941909611225
loss_pred:0.027388541027903557, decouple_loss:0.013896419666707516
loss_pred:0.027570683509111404, decouple_loss:0.013711526058614254
Iteration: 1925, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488838016986847, gen p mean: -0.7033990025520325, mean p set: 0.4493641257286072
The modified gen p mean: 0.4471310079097748, gen p mean: -0.7074273228645325, mean p set: 0.4476113021373749
The modified gen p mean: 0.45015621185302734, gen p mean: -0.7103766202926636, mean p set: 0.45063650608062744
loss_pred:0.026519056409597397, decouple_loss:0.014077182859182358
loss_pred:0.028041427955031395, decouple_loss:0.014008105732500553
loss_pred:0.02746029570698738, decouple_loss:0.01343393512070179
Iteration: 1926, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519200921058655, gen p mean: -0.7152559757232666, mean p set: 0.4524003565311432
The modified gen p mean: 0.4481624960899353, gen p mean: -0.7126439213752747, mean p set: 0.448642760515213
The modified gen p mean: 0.4481627643108368, gen p mean: -0.7105323076248169, mean p set: 0.4486430585384369
loss_pred:0.026821164414286613, decouple_loss:0.014025721698999405
loss_pred:0.02806830406188965, decouple_loss:0.014087468385696411
loss_pred:0.026639031246304512, decouple_loss:0.01402331329882145
Iteration: 1927, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512498378753662, gen p mean: -0.7190231680870056, mean p set: 0.4517301619052887
The modified gen p mean: 0.44952043890953064, gen p mean: -0.7163811922073364, mean p set: 0.45000073313713074
The modified gen p mean: 0.4477386474609375, gen p mean: -0.711513876914978, mean p set: 0.4482189118862152
loss_pred:0.02667928673326969, decouple_loss:0.013477563858032227
loss_pred:0.02701377309858799, decouple_loss:0.013004270382225513
loss_pred:0.027832482010126114, decouple_loss:0.01330097671598196
Iteration: 1928, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450179785490036, gen p mean: -0.7168431878089905, mean p set: 0.4506600499153137
The modified gen p mean: 0.4481504261493683, gen p mean: -0.7243127226829529, mean p set: 0.448630690574646
The modified gen p mean: 0.44977957010269165, gen p mean: -0.7221722602844238, mean p set: 0.45025986433029175
loss_pred:0.02738451398909092, decouple_loss:0.012600480578839779
loss_pred:0.02653280645608902, decouple_loss:0.013161438517272472
loss_pred:0.02693592570722103, decouple_loss:0.013294870965182781
Iteration: 1929, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44888025522232056, gen p mean: -0.729783296585083, mean p set: 0.44936051964759827
The modified gen p mean: 0.45013538002967834, gen p mean: -0.7304877042770386, mean p set: 0.45061561465263367
The modified gen p mean: 0.4493057429790497, gen p mean: -0.7310318946838379, mean p set: 0.4497860372066498
loss_pred:0.026544982567429543, decouple_loss:0.012485614977777004
loss_pred:0.02653859555721283, decouple_loss:0.01270231232047081
loss_pred:0.027787070721387863, decouple_loss:0.012714667245745659
Iteration: 1930, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793641567230225, gen p mean: -0.7303290963172913, mean p set: 0.44841670989990234
The modified gen p mean: 0.4484577775001526, gen p mean: -0.7390790581703186, mean p set: 0.4489381015300751
The modified gen p mean: 0.4503604471683502, gen p mean: -0.7364878058433533, mean p set: 0.45084071159362793
loss_pred:0.02684406191110611, decouple_loss:0.013256886042654514
loss_pred:0.027262303978204727, decouple_loss:0.01347162202000618
loss_pred:0.026028109714388847, decouple_loss:0.013022386468946934
2023-05-03 03:08:38 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7222962379455566, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7293746471405029, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7177556157112122, mean p set: 0.45035696029663086
loss_pred:0.027382273226976395, decouple_loss:0.014576698653399944
loss_pred:0.028370413929224014, decouple_loss:0.014988022856414318
loss_pred:0.026948032900691032, decouple_loss:0.014807788655161858
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028306450694799423, avg_mse: 0.03328878805041313
current test mse: 0.033289
Iteration: 1931, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44959649443626404, gen p mean: -0.7239528298377991, mean p set: 0.45007678866386414
The modified gen p mean: 0.45000165700912476, gen p mean: -0.7238761186599731, mean p set: 0.45048198103904724
loss_pred:0.027963144704699516, decouple_loss:0.012877225875854492
loss_pred:0.026674512773752213, decouple_loss:0.012935588136315346
The modified gen p mean: 0.44891878962516785, gen p mean: -0.7197017669677734, mean p set: 0.44939908385276794
loss_pred:0.026128778234124184, decouple_loss:0.013578813523054123
Iteration: 1932, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523296058177948, gen p mean: -0.7121570706367493, mean p set: 0.4528099000453949
The modified gen p mean: 0.4502809941768646, gen p mean: -0.7162553071975708, mean p set: 0.45076125860214233
The modified gen p mean: 0.44890159368515015, gen p mean: -0.7130011320114136, mean p set: 0.44938188791275024
loss_pred:0.02633519284427166, decouple_loss:0.013602984137833118
loss_pred:0.026688581332564354, decouple_loss:0.012348550371825695
loss_pred:0.026492886245250702, decouple_loss:0.012674394063651562
Iteration: 1933, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812336564064026, gen p mean: -0.7107475399971008, mean p set: 0.44860365986824036
The modified gen p mean: 0.4502689242362976, gen p mean: -0.704091489315033, mean p set: 0.4507491886615753
The modified gen p mean: 0.4506303071975708, gen p mean: -0.7064307928085327, mean p set: 0.4511106312274933
loss_pred:0.02677900344133377, decouple_loss:0.01266605406999588
loss_pred:0.026896493509411812, decouple_loss:0.013494465500116348
loss_pred:0.02715042233467102, decouple_loss:0.013624770566821098
Iteration: 1934, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449876070022583, gen p mean: -0.719323456287384, mean p set: 0.4503563344478607The modified gen p mean: 0.44817909598350525, gen p mean: -0.7229990363121033, mean p set: 0.44865939021110535
The modified gen p mean: 0.449848473072052, gen p mean: -0.7231860756874084, mean p set: 0.4503287672996521
loss_pred:0.027079029008746147, decouple_loss:0.012373729608952999
loss_pred:0.02631494589149952, decouple_loss:0.012493010610342026
loss_pred:0.027490567415952682, decouple_loss:0.012339571490883827
Iteration: 1935, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494688808917999, gen p mean: -0.7213422656059265, mean p set: 0.4499492049217224
The modified gen p mean: 0.4492427706718445, gen p mean: -0.7185134887695312, mean p set: 0.4497230648994446
The modified gen p mean: 0.44779255986213684, gen p mean: -0.7189967036247253, mean p set: 0.44827285408973694
loss_pred:0.02617056667804718, decouple_loss:0.012252550572156906
loss_pred:0.027226993814110756, decouple_loss:0.012642753310501575
loss_pred:0.027424225583672523, decouple_loss:0.013244789093732834
Iteration: 1936, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44886690378189087, gen p mean: -0.7160124182701111, mean p set: 0.44934722781181335
The modified gen p mean: 0.4479113519191742, gen p mean: -0.708041250705719, mean p set: 0.4483916759490967
The modified gen p mean: 0.45097795128822327, gen p mean: -0.7126442790031433, mean p set: 0.451458215713501
loss_pred:0.026920625939965248, decouple_loss:0.012701408006250858
loss_pred:0.02732156030833721, decouple_loss:0.012731553055346012
loss_pred:0.02672341838479042, decouple_loss:0.0127583472058177
Iteration: 1937, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503643810749054, gen p mean: -0.7020941972732544, mean p set: 0.4508446753025055
The modified gen p mean: 0.4498252868652344, gen p mean: -0.7085161805152893, mean p set: 0.4503055810928345
The modified gen p mean: 0.45044204592704773, gen p mean: -0.7064029574394226, mean p set: 0.4509223401546478
loss_pred:0.02654573880136013, decouple_loss:0.012843205593526363
loss_pred:0.027187123894691467, decouple_loss:0.01222838182002306
loss_pred:0.02652021497488022, decouple_loss:0.012840433046221733
Iteration: 1938, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44882020354270935, gen p mean: -0.7250140905380249, mean p set: 0.44930049777030945
The modified gen p mean: 0.44792619347572327, gen p mean: -0.7052298784255981, mean p set: 0.44840651750564575
The modified gen p mean: 0.4485177993774414, gen p mean: -0.7123673558235168, mean p set: 0.4489981234073639
loss_pred:0.026591582223773003, decouple_loss:0.012940150685608387
loss_pred:0.02749880589544773, decouple_loss:0.01252737920731306
loss_pred:0.026486128568649292, decouple_loss:0.012470167130231857
Iteration: 1939, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504495859146118, gen p mean: -0.7184613347053528, mean p set: 0.4509299099445343
The modified gen p mean: 0.44996973872184753, gen p mean: -0.7268387675285339, mean p set: 0.45045000314712524
The modified gen p mean: 0.450557142496109, gen p mean: -0.7208815813064575, mean p set: 0.4510374367237091
loss_pred:0.026575583964586258, decouple_loss:0.012426536530256271
loss_pred:0.027118897065520287, decouple_loss:0.012318556196987629
loss_pred:0.026450207456946373, decouple_loss:0.012536791153252125
Iteration: 1940, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44883424043655396, gen p mean: -0.7175816893577576, mean p set: 0.44931453466415405
The modified gen p mean: 0.44997620582580566, gen p mean: -0.719658374786377, mean p set: 0.45045650005340576
The modified gen p mean: 0.45012331008911133, gen p mean: -0.7162376046180725, mean p set: 0.4506036043167114
loss_pred:0.02746821753680706, decouple_loss:0.011742683127522469
loss_pred:0.02627561427652836, decouple_loss:0.012520004995167255
loss_pred:0.02696865424513817, decouple_loss:0.012369738891720772
2023-05-03 03:12:21 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7203881740570068, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7282699346542358, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7160146832466125, mean p set: 0.45035696029663086
loss_pred:0.027402417734265327, decouple_loss:0.013965782709419727
loss_pred:0.02855183556675911, decouple_loss:0.014200976118445396
loss_pred:0.027009394019842148, decouple_loss:0.014133863151073456
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028359560295939445, avg_mse: 0.03350545093417168
current test mse: 0.033505
Iteration: 1941, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476385712623596, gen p mean: -0.7216724157333374, mean p set: 0.44811883568763733
The modified gen p mean: 0.4497251808643341, gen p mean: -0.7245419025421143, mean p set: 0.4502054452896118
loss_pred:0.026755936443805695, decouple_loss:0.012708992697298527
loss_pred:0.026957163587212563, decouple_loss:0.011732405051589012
The modified gen p mean: 0.44958481192588806, gen p mean: -0.7219405770301819, mean p set: 0.45006507635116577
loss_pred:0.027866844087839127, decouple_loss:0.012002349831163883
Iteration: 1942, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45057055354118347, gen p mean: -0.7180236577987671, mean p set: 0.45105084776878357
The modified gen p mean: 0.44957196712493896, gen p mean: -0.7248845100402832, mean p set: 0.45005226135253906
The modified gen p mean: 0.45041823387145996, gen p mean: -0.7161657810211182, mean p set: 0.45089852809906006
loss_pred:0.026948798447847366, decouple_loss:0.012618588283658028
loss_pred:0.027159618213772774, decouple_loss:0.011967193335294724
loss_pred:0.02701694145798683, decouple_loss:0.012736250646412373
Iteration: 1943, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45065709948539734, gen p mean: -0.7261204719543457, mean p set: 0.45113739371299744
The modified gen p mean: 0.44906988739967346, gen p mean: -0.7275789976119995, mean p set: 0.44955018162727356
The modified gen p mean: 0.44871675968170166, gen p mean: -0.7268041968345642, mean p set: 0.44919705390930176
loss_pred:0.026229050010442734, decouple_loss:0.012649236246943474
loss_pred:0.026823874562978745, decouple_loss:0.01171775534749031
loss_pred:0.026364969089627266, decouple_loss:0.012051273137331009
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
NaN value num: 0
Iteration: 1944, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44604259729385376, gen p mean: -0.7260825037956238, mean p set: 0.44652286171913147
The modified gen p mean: 0.44672924280166626, gen p mean: -0.7248793244361877, mean p set: 0.4472094774246216
The modified gen p mean: 0.4482938349246979, gen p mean: -0.7360060214996338, mean p set: 0.448774129152298
loss_pred:0.026338260620832443, decouple_loss:0.014223366975784302
loss_pred:0.028242161497473717, decouple_loss:0.015360909514129162
loss_pred:0.028227970004081726, decouple_loss:0.014673244208097458
Iteration: 1945, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877082109451294, gen p mean: -0.7148537039756775, mean p set: 0.44925111532211304
The modified gen p mean: 0.4464953541755676, gen p mean: -0.7295882105827332, mean p set: 0.44697561860084534
The modified gen p mean: 0.44660159945487976, gen p mean: -0.7260680794715881, mean p set: 0.44708189368247986
loss_pred:0.02758910320699215, decouple_loss:0.013503311201930046
loss_pred:0.027114752680063248, decouple_loss:0.0140113839879632
loss_pred:0.027923744171857834, decouple_loss:0.013579102233052254
Iteration: 1946, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44690144062042236, gen p mean: -0.7263980507850647, mean p set: 0.44738173484802246
The modified gen p mean: 0.44721418619155884, gen p mean: -0.7417248487472534, mean p set: 0.44769448041915894
The modified gen p mean: 0.44563642144203186, gen p mean: -0.7154067754745483, mean p set: 0.44611674547195435
loss_pred:0.028025120496749878, decouple_loss:0.013186943717300892
loss_pred:0.027511078864336014, decouple_loss:0.014854095876216888
loss_pred:0.027289191260933876, decouple_loss:0.013629567809402943
Iteration: 1947, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44691088795661926, gen p mean: -0.7343103885650635, mean p set: 0.44739121198654175
The modified gen p mean: 0.4461938142776489, gen p mean: -0.730951189994812, mean p set: 0.446674108505249
The modified gen p mean: 0.4462195932865143, gen p mean: -0.7341863512992859, mean p set: 0.4466998875141144
loss_pred:0.028353022411465645, decouple_loss:0.013425052165985107
loss_pred:0.02705225721001625, decouple_loss:0.013006950728595257
loss_pred:0.027622396126389503, decouple_loss:0.012947941198945045
Iteration: 1948, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44630497694015503, gen p mean: -0.7306714057922363, mean p set: 0.44678524136543274
The modified gen p mean: 0.4463620185852051, gen p mean: -0.725269615650177, mean p set: 0.4468423128128052
The modified gen p mean: 0.44711974263191223, gen p mean: -0.7387983202934265, mean p set: 0.44760003685951233
loss_pred:0.026739241555333138, decouple_loss:0.012793553993105888
loss_pred:0.02744102291762829, decouple_loss:0.012894521467387676
loss_pred:0.027243005111813545, decouple_loss:0.012699341401457787
Iteration: 1949, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44663169980049133, gen p mean: -0.733937680721283, mean p set: 0.44711199402809143
The modified gen p mean: 0.44580018520355225, gen p mean: -0.7265986800193787, mean p set: 0.44628050923347473
The modified gen p mean: 0.4461633265018463, gen p mean: -0.7257852554321289, mean p set: 0.446643590927124
loss_pred:0.028014177456498146, decouple_loss:0.012316020205616951
loss_pred:0.02715999446809292, decouple_loss:0.012903506867587566
loss_pred:0.02709069289267063, decouple_loss:0.013077525421977043
Iteration: 1950, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44608253240585327, gen p mean: -0.7288677096366882, mean p set: 0.446562796831131
The modified gen p mean: 0.447218656539917, gen p mean: -0.7294962406158447, mean p set: 0.4476989805698395
The modified gen p mean: 0.44654712080955505, gen p mean: -0.7252585291862488, mean p set: 0.44702741503715515
loss_pred:0.027648942545056343, decouple_loss:0.01273691188544035
loss_pred:0.028076784685254097, decouple_loss:0.01275908574461937
loss_pred:0.025878364220261574, decouple_loss:0.01229417696595192
2023-05-03 03:16:47 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7284283638000488, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7209039926528931, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7164593935012817, mean p set: 0.45035696029663086
loss_pred:0.028262590989470482, decouple_loss:0.013848094269633293
loss_pred:0.027198513969779015, decouple_loss:0.013400719501078129
loss_pred:0.026866495609283447, decouple_loss:0.01347122248262167
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02812120132148266, avg_mse: 0.03306998312473297
current test mse: 0.03307
Iteration: 1951, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780677556991577, gen p mean: -0.7332335710525513, mean p set: 0.4482870399951935
The modified gen p mean: 0.4479316174983978, gen p mean: -0.72642582654953, mean p set: 0.44841188192367554
loss_pred:0.02641286700963974, decouple_loss:0.01274886354804039
loss_pred:0.02740282379090786, decouple_loss:0.01328666415065527
The modified gen p mean: 0.44751742482185364, gen p mean: -0.7322087287902832, mean p set: 0.4479977488517761
loss_pred:0.027008524164557457, decouple_loss:0.012523814104497433
Iteration: 1952, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906169176101685, gen p mean: -0.7285562753677368, mean p set: 0.44954198598861694
The modified gen p mean: 0.44631487131118774, gen p mean: -0.7288042306900024, mean p set: 0.44679519534111023
The modified gen p mean: 0.4470807611942291, gen p mean: -0.7326951026916504, mean p set: 0.4475610554218292
loss_pred:0.027519825845956802, decouple_loss:0.01311302650719881
loss_pred:0.026476405560970306, decouple_loss:0.012608510442078114
loss_pred:0.026887809857726097, decouple_loss:0.012832357548177242
Iteration: 1953, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44687435030937195, gen p mean: -0.7335856556892395, mean p set: 0.44735464453697205
The modified gen p mean: 0.44606515765190125, gen p mean: -0.7216718196868896, mean p set: 0.44654545187950134
The modified gen p mean: 0.44560837745666504, gen p mean: -0.7233381867408752, mean p set: 0.44608867168426514
loss_pred:0.02660967782139778, decouple_loss:0.012837553396821022
loss_pred:0.02824908308684826, decouple_loss:0.013278907164931297
loss_pred:0.027903910726308823, decouple_loss:0.01342657208442688
Iteration: 1954, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44848331809043884, gen p mean: -0.7342017889022827, mean p set: 0.44896358251571655
The modified gen p mean: 0.44659224152565, gen p mean: -0.7282989025115967, mean p set: 0.4470725357532501
The modified gen p mean: 0.4469551742076874, gen p mean: -0.7297286987304688, mean p set: 0.44743549823760986
loss_pred:0.026874585077166557, decouple_loss:0.012378457002341747
loss_pred:0.028344467282295227, decouple_loss:0.012560131028294563
loss_pred:0.027782222256064415, decouple_loss:0.012738652527332306
Iteration: 1955, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478932023048401, gen p mean: -0.7270898222923279, mean p set: 0.4483734667301178
The modified gen p mean: 0.4459373354911804, gen p mean: -0.7356661558151245, mean p set: 0.4464176893234253
The modified gen p mean: 0.4487651586532593, gen p mean: -0.7362334132194519, mean p set: 0.4492454528808594
loss_pred:0.027186207473278046, decouple_loss:0.012497683987021446
loss_pred:0.026658400893211365, decouple_loss:0.012267809361219406
loss_pred:0.02740900032222271, decouple_loss:0.012284650467336178
Iteration: 1956, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447654664516449, gen p mean: -0.7330284714698792, mean p set: 0.4481349289417267
The modified gen p mean: 0.4457029104232788, gen p mean: -0.7131954431533813, mean p set: 0.4461832046508789
The modified gen p mean: 0.44585978984832764, gen p mean: -0.7230685949325562, mean p set: 0.44634005427360535
loss_pred:0.027665361762046814, decouple_loss:0.013179533183574677
loss_pred:0.027126925066113472, decouple_loss:0.012787749990820885
loss_pred:0.027762051671743393, decouple_loss:0.01246253214776516
Iteration: 1957, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467082917690277, gen p mean: -0.7149361968040466, mean p set: 0.4471885859966278
The modified gen p mean: 0.44681331515312195, gen p mean: -0.7163515686988831, mean p set: 0.44729360938072205
The modified gen p mean: 0.4473472237586975, gen p mean: -0.7177445292472839, mean p set: 0.4478275179862976
loss_pred:0.027623672038316727, decouple_loss:0.01258938293904066
loss_pred:0.027507074177265167, decouple_loss:0.01208602637052536
loss_pred:0.02722466178238392, decouple_loss:0.011913992464542389
Iteration: 1958, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467898905277252, gen p mean: -0.7210907340049744, mean p set: 0.44727015495300293
The modified gen p mean: 0.4496762752532959, gen p mean: -0.7127717137336731, mean p set: 0.4501565396785736
The modified gen p mean: 0.447207510471344, gen p mean: -0.7124441862106323, mean p set: 0.4476877748966217
loss_pred:0.026706239208579063, decouple_loss:0.012089740484952927
loss_pred:0.02713671512901783, decouple_loss:0.012282761745154858
loss_pred:0.027229279279708862, decouple_loss:0.011780344881117344
Iteration: 1959, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463766813278198, gen p mean: -0.7110609412193298, mean p set: 0.4468569755554199
The modified gen p mean: 0.44587406516075134, gen p mean: -0.7221664786338806, mean p set: 0.44635435938835144
The modified gen p mean: 0.44572097063064575, gen p mean: -0.7120633721351624, mean p set: 0.44620129466056824
loss_pred:0.027044637128710747, decouple_loss:0.01266960334032774
loss_pred:0.025892537087202072, decouple_loss:0.011863143183290958
loss_pred:0.026480792090296745, decouple_loss:0.012703988701105118
Iteration: 1960, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471961259841919, gen p mean: -0.7193145751953125, mean p set: 0.447676420211792
The modified gen p mean: 0.44767045974731445, gen p mean: -0.7275610566139221, mean p set: 0.44815075397491455
The modified gen p mean: 0.44572705030441284, gen p mean: -0.720207929611206, mean p set: 0.44620731472969055
loss_pred:0.028253918513655663, decouple_loss:0.012895584106445312
loss_pred:0.026479747146368027, decouple_loss:0.01208772324025631
loss_pred:0.027821162715554237, decouple_loss:0.01196142379194498
2023-05-03 03:20:27 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.707869827747345, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7151041030883789, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7036454677581787, mean p set: 0.45035696029663086
loss_pred:0.0271308571100235, decouple_loss:0.01261231116950512
loss_pred:0.028242187574505806, decouple_loss:0.0132233751937747
loss_pred:0.02680402807891369, decouple_loss:0.013069625943899155
WV_0_PC_1_EH_0_PS_40_6, loss: 0.028040779754519463, avg_mse: 0.03308464214205742
current test mse: 0.033085
Iteration: 1961, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44861605763435364, gen p mean: -0.716999351978302, mean p set: 0.44909629225730896
The modified gen p mean: 0.4463137090206146, gen p mean: -0.7046847939491272, mean p set: 0.44679397344589233
loss_pred:0.028081800788640976, decouple_loss:0.012468784116208553
loss_pred:0.028688140213489532, decouple_loss:0.012200447730720043
The modified gen p mean: 0.4457554519176483, gen p mean: -0.7008209228515625, mean p set: 0.4462357461452484
loss_pred:0.027239959686994553, decouple_loss:0.012550088576972485
Iteration: 1962, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694721698760986, gen p mean: -0.7246424555778503, mean p set: 0.4474274814128876
The modified gen p mean: 0.44694703817367554, gen p mean: -0.7141480445861816, mean p set: 0.44742733240127563
The modified gen p mean: 0.44953835010528564, gen p mean: -0.716629147529602, mean p set: 0.45001867413520813
loss_pred:0.02649824135005474, decouple_loss:0.012930192984640598
loss_pred:0.027443522587418556, decouple_loss:0.012403150089085102
loss_pred:0.027301793918013573, decouple_loss:0.01266825757920742
Iteration: 1963, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488300383090973, gen p mean: -0.7265288829803467, mean p set: 0.4493103623390198
The modified gen p mean: 0.4464660584926605, gen p mean: -0.7108679413795471, mean p set: 0.446946382522583
The modified gen p mean: 0.4477980136871338, gen p mean: -0.7209863066673279, mean p set: 0.4482783079147339
loss_pred:0.026805557310581207, decouple_loss:0.012328761629760265
loss_pred:0.027363188564777374, decouple_loss:0.012176704593002796
loss_pred:0.02630714513361454, decouple_loss:0.012360939756035805
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 1964, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45075008273124695, gen p mean: -0.7260023951530457, mean p set: 0.45123034715652466
The modified gen p mean: 0.447856068611145, gen p mean: -0.7224122285842896, mean p set: 0.4483363628387451
The modified gen p mean: 0.44915971159935, gen p mean: -0.7340930700302124, mean p set: 0.4496400058269501
loss_pred:0.0276312455534935, decouple_loss:0.012734301388263702
loss_pred:0.026738541200757027, decouple_loss:0.013282687403261662
loss_pred:0.026341577991843224, decouple_loss:0.01315346173942089
Iteration: 1965, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491240084171295, gen p mean: -0.7378798127174377, mean p set: 0.4496042728424072
The modified gen p mean: 0.4472677409648895, gen p mean: -0.7190041542053223, mean p set: 0.447748064994812
The modified gen p mean: 0.44669434428215027, gen p mean: -0.7128123641014099, mean p set: 0.447174608707428
loss_pred:0.024852614849805832, decouple_loss:0.013592783361673355
loss_pred:0.02639796771109104, decouple_loss:0.012850616127252579
loss_pred:0.028291242197155952, decouple_loss:0.01306043192744255
Iteration: 1966, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474261701107025, gen p mean: -0.712285578250885, mean p set: 0.4479064643383026
The modified gen p mean: 0.44961124658584595, gen p mean: -0.724653422832489, mean p set: 0.45009157061576843
The modified gen p mean: 0.44875746965408325, gen p mean: -0.7192071080207825, mean p set: 0.44923779368400574
loss_pred:0.027483409270644188, decouple_loss:0.012851860374212265
loss_pred:0.026277732104063034, decouple_loss:0.012760595418512821
loss_pred:0.028081875294446945, decouple_loss:0.012325548566877842
Iteration: 1967, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488906264305115, gen p mean: -0.7226659059524536, mean p set: 0.4493709206581116
The modified gen p mean: 0.44840124249458313, gen p mean: -0.7181631922721863, mean p set: 0.4488815367221832
The modified gen p mean: 0.4489346146583557, gen p mean: -0.7195818424224854, mean p set: 0.4494149386882782
loss_pred:0.026696881279349327, decouple_loss:0.012842373922467232
loss_pred:0.02859586849808693, decouple_loss:0.012674923054873943
loss_pred:0.0266261026263237, decouple_loss:0.012931007891893387
Iteration: 1968, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472696781158447, gen p mean: -0.7169930338859558, mean p set: 0.4477499723434448
The modified gen p mean: 0.4493548274040222, gen p mean: -0.724492073059082, mean p set: 0.4498351216316223
The modified gen p mean: 0.4476599097251892, gen p mean: -0.7176038026809692, mean p set: 0.4481402039527893
loss_pred:0.027689918875694275, decouple_loss:0.012628004886209965
loss_pred:0.02616368606686592, decouple_loss:0.013148777186870575
loss_pred:0.026959944516420364, decouple_loss:0.012288597412407398
Iteration: 1969, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516567587852478, gen p mean: -0.7247487902641296, mean p set: 0.4521370232105255
The modified gen p mean: 0.44975507259368896, gen p mean: -0.7174431681632996, mean p set: 0.4502353370189667
The modified gen p mean: 0.44819745421409607, gen p mean: -0.7154569029808044, mean p set: 0.44867774844169617
loss_pred:0.026431797072291374, decouple_loss:0.012958941981196404
loss_pred:0.026240136474370956, decouple_loss:0.012596143409609795
loss_pred:0.02724086120724678, decouple_loss:0.012657391838729382
Iteration: 1970, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972044229507446, gen p mean: -0.7353758215904236, mean p set: 0.45020073652267456
The modified gen p mean: 0.4487262964248657, gen p mean: -0.7261799573898315, mean p set: 0.44920656085014343
The modified gen p mean: 0.4490068554878235, gen p mean: -0.7387568354606628, mean p set: 0.4494871497154236
loss_pred:0.026705387979745865, decouple_loss:0.01223638653755188
loss_pred:0.025667333975434303, decouple_loss:0.011949185281991959
loss_pred:0.024505039677023888, decouple_loss:0.012661030516028404
2023-05-03 03:24:50 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7270241379737854, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7191893458366394, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7147011756896973, mean p set: 0.45035696029663086
loss_pred:0.028087474405765533, decouple_loss:0.012833592481911182
loss_pred:0.026983724907040596, decouple_loss:0.012507878243923187
loss_pred:0.026600126177072525, decouple_loss:0.01274376641958952
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02785852923989296, avg_mse: 0.03273291885852814
current test mse: 0.032733
Iteration: 1971, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474325478076935, gen p mean: -0.7218074798583984, mean p set: 0.4479128420352936
loss_pred:0.026413023471832275, decouple_loss:0.012056193314492702
The modified gen p mean: 0.4501930773258209, gen p mean: -0.7168106436729431, mean p set: 0.45067334175109863
loss_pred:0.026227369904518127, decouple_loss:0.012105803936719894
The modified gen p mean: 0.4500373601913452, gen p mean: -0.720405638217926, mean p set: 0.4505176842212677
loss_pred:0.025761444121599197, decouple_loss:0.012254268862307072
Iteration: 1972, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755735993385315, gen p mean: -0.7268543243408203, mean p set: 0.44803765416145325
The modified gen p mean: 0.4469147026538849, gen p mean: -0.7298006415367126, mean p set: 0.447394996881485
The modified gen p mean: 0.44785284996032715, gen p mean: -0.7295397520065308, mean p set: 0.44833314418792725
loss_pred:0.0269414521753788, decouple_loss:0.012193188071250916
loss_pred:0.025831367820501328, decouple_loss:0.012031864374876022
loss_pred:0.027589282020926476, decouple_loss:0.012399307452142239
Iteration: 1973, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839346408843994, gen p mean: -0.7313451170921326, mean p set: 0.44887375831604004
The modified gen p mean: 0.4488476812839508, gen p mean: -0.7470455169677734, mean p set: 0.4493279755115509
The modified gen p mean: 0.44837766885757446, gen p mean: -0.7334588766098022, mean p set: 0.44885799288749695
loss_pred:0.02506103552877903, decouple_loss:0.01195195410400629loss_pred:0.02881978079676628, decouple_loss:0.01214517094194889
loss_pred:0.02752627804875374, decouple_loss:0.011999663896858692
Iteration: 1974, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856277108192444, gen p mean: -0.7276071906089783, mean p set: 0.44904303550720215
The modified gen p mean: 0.4473476707935333, gen p mean: -0.7251877188682556, mean p set: 0.44782793521881104
The modified gen p mean: 0.44975852966308594, gen p mean: -0.7271139621734619, mean p set: 0.45023879408836365
loss_pred:0.027009012177586555, decouple_loss:0.012016164138913155
loss_pred:0.02709248661994934, decouple_loss:0.011575436219573021
loss_pred:0.027334969490766525, decouple_loss:0.01251022145152092
Iteration: 1975, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448194295167923, gen p mean: -0.7198356986045837, mean p set: 0.44867458939552307
The modified gen p mean: 0.4489430785179138, gen p mean: -0.7158008813858032, mean p set: 0.4494233727455139
The modified gen p mean: 0.4486274719238281, gen p mean: -0.7248406410217285, mean p set: 0.44910773634910583
loss_pred:0.027844958007335663, decouple_loss:0.012053737416863441
loss_pred:0.026945266872644424, decouple_loss:0.012532543390989304
loss_pred:0.025739096105098724, decouple_loss:0.012031794525682926
Iteration: 1976, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811615347862244, gen p mean: -0.7135491371154785, mean p set: 0.44859644770622253
The modified gen p mean: 0.44841739535331726, gen p mean: -0.7140322327613831, mean p set: 0.44889771938323975
The modified gen p mean: 0.4475485384464264, gen p mean: -0.7129510641098022, mean p set: 0.4480287730693817
loss_pred:0.02662654221057892, decouple_loss:0.011758727952837944
loss_pred:0.027671322226524353, decouple_loss:0.01151740737259388
loss_pred:0.02804345265030861, decouple_loss:0.011524117551743984
Iteration: 1977, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490821361541748, gen p mean: -0.7256871461868286, mean p set: 0.4495624303817749
The modified gen p mean: 0.4471129775047302, gen p mean: -0.7175865769386292, mean p set: 0.4475933015346527
The modified gen p mean: 0.4499562680721283, gen p mean: -0.7215579152107239, mean p set: 0.4504365622997284
loss_pred:0.02649509534239769, decouple_loss:0.012644782662391663
loss_pred:0.02775616943836212, decouple_loss:0.01215601246803999
loss_pred:0.025308363139629364, decouple_loss:0.012154911644756794
Iteration: 1978, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474162757396698, gen p mean: -0.7225074768066406, mean p set: 0.4478965699672699
The modified gen p mean: 0.44798243045806885, gen p mean: -0.7334546446800232, mean p set: 0.44846272468566895
The modified gen p mean: 0.449799120426178, gen p mean: -0.7219215035438538, mean p set: 0.4502794146537781
loss_pred:0.02701990306377411, decouple_loss:0.012006783857941628
loss_pred:0.02499053068459034, decouple_loss:0.012201063334941864
loss_pred:0.02709941752254963, decouple_loss:0.011925116181373596
Iteration: 1979, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483661353588104, gen p mean: -0.7214804291725159, mean p set: 0.44884639978408813
The modified gen p mean: 0.44766318798065186, gen p mean: -0.7151750326156616, mean p set: 0.44814345240592957
The modified gen p mean: 0.4476977586746216, gen p mean: -0.7150738835334778, mean p set: 0.4481779932975769
loss_pred:0.025961004197597504, decouple_loss:0.011979121714830399
loss_pred:0.027407346293330193, decouple_loss:0.011367682367563248
loss_pred:0.027950763702392578, decouple_loss:0.011040556244552135
Iteration: 1980, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448076993227005, gen p mean: -0.7139090299606323, mean p set: 0.4485572874546051
The modified gen p mean: 0.4490741789340973, gen p mean: -0.7126582264900208, mean p set: 0.449554443359375
The modified gen p mean: 0.4486962556838989, gen p mean: -0.7152420878410339, mean p set: 0.449176549911499
loss_pred:0.02736322581768036, decouple_loss:0.011347210966050625
loss_pred:0.02679881453514099, decouple_loss:0.01193144079297781
loss_pred:0.02710881270468235, decouple_loss:0.011565456166863441
2023-05-03 03:28:35 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7265447974205017, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7185123562812805, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7139922380447388, mean p set: 0.45035696029663086
loss_pred:0.028038742020726204, decouple_loss:0.012462825514376163
loss_pred:0.0265122689306736, decouple_loss:0.01214461401104927
loss_pred:0.026911763474345207, decouple_loss:0.01188621111214161
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027762485668063164, avg_mse: 0.03271006792783737
current test mse: 0.03271
Iteration: 1981, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44738543033599854, gen p mean: -0.7197738289833069, mean p set: 0.44786569476127625
The modified gen p mean: 0.4472569227218628, gen p mean: -0.7187042832374573, mean p set: 0.4477371871471405
loss_pred:0.026497259736061096, decouple_loss:0.011401871219277382
loss_pred:0.026718128472566605, decouple_loss:0.011264856904745102
The modified gen p mean: 0.4467901885509491, gen p mean: -0.7169144749641418, mean p set: 0.4472704529762268
loss_pred:0.027539176866412163, decouple_loss:0.012093502096831799
Iteration: 1982, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795358180999756, gen p mean: -0.7225570678710938, mean p set: 0.44843384623527527
The modified gen p mean: 0.4489038288593292, gen p mean: -0.720209538936615, mean p set: 0.4493841528892517
The modified gen p mean: 0.4486277103424072, gen p mean: -0.7288837432861328, mean p set: 0.44910797476768494
loss_pred:0.02676413394510746, decouple_loss:0.011659493669867516loss_pred:0.027481356635689735, decouple_loss:0.01126707624644041
loss_pred:0.025679122656583786, decouple_loss:0.011424981988966465
Iteration: 1983, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488057494163513, gen p mean: -0.7165805697441101, mean p set: 0.4492860734462738
The modified gen p mean: 0.44819360971450806, gen p mean: -0.7176698446273804, mean p set: 0.44867387413978577
The modified gen p mean: 0.4474972188472748, gen p mean: -0.7166873812675476, mean p set: 0.4479774832725525
loss_pred:0.026621831580996513, decouple_loss:0.011609210632741451
loss_pred:0.026401003822684288, decouple_loss:0.011565596796572208
loss_pred:0.026487741619348526, decouple_loss:0.01159895583987236
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 1984, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478497803211212, gen p mean: -0.719860851764679, mean p set: 0.4483300447463989
The modified gen p mean: 0.44677555561065674, gen p mean: -0.7142425179481506, mean p set: 0.44725584983825684
The modified gen p mean: 0.44624581933021545, gen p mean: -0.7120276093482971, mean p set: 0.44672611355781555
loss_pred:0.02738470397889614, decouple_loss:0.013272088952362537
loss_pred:0.027809549123048782, decouple_loss:0.012933180667459965
loss_pred:0.02758524939417839, decouple_loss:0.012800936587154865
Iteration: 1985, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472186267375946, gen p mean: -0.7045688033103943, mean p set: 0.4476989209651947
The modified gen p mean: 0.44701576232910156, gen p mean: -0.7150213718414307, mean p set: 0.44749605655670166
The modified gen p mean: 0.44650182127952576, gen p mean: -0.7034346461296082, mean p set: 0.44698208570480347
loss_pred:0.027659853920340538, decouple_loss:0.01264165062457323
loss_pred:0.026918509975075722, decouple_loss:0.012559978291392326
loss_pred:0.02808675728738308, decouple_loss:0.012449203059077263
Iteration: 1986, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44697147607803345, gen p mean: -0.7069406509399414, mean p set: 0.44745174050331116
The modified gen p mean: 0.4475902318954468, gen p mean: -0.7141895294189453, mean p set: 0.4480704963207245
The modified gen p mean: 0.44771623611450195, gen p mean: -0.7050339579582214, mean p set: 0.44819650053977966
loss_pred:0.02754785679280758, decouple_loss:0.012071068398654461
loss_pred:0.027408424764871597, decouple_loss:0.012827211990952492
loss_pred:0.026581494137644768, decouple_loss:0.011885481886565685
Iteration: 1987, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473629593849182, gen p mean: -0.7141634821891785, mean p set: 0.4478432536125183
The modified gen p mean: 0.44658491015434265, gen p mean: -0.7119255065917969, mean p set: 0.44706523418426514
The modified gen p mean: 0.4459882080554962, gen p mean: -0.711919903755188, mean p set: 0.4464685022830963
loss_pred:0.02781383879482746, decouple_loss:0.012310356833040714
loss_pred:0.027199555188417435, decouple_loss:0.012551944702863693
loss_pred:0.027697687968611717, decouple_loss:0.012297531589865685
Iteration: 1988, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465397000312805, gen p mean: -0.7126748561859131, mean p set: 0.4470199644565582
The modified gen p mean: 0.44720005989074707, gen p mean: -0.7176478505134583, mean p set: 0.44768035411834717
The modified gen p mean: 0.44724833965301514, gen p mean: -0.7176100611686707, mean p set: 0.44772863388061523
loss_pred:0.02797195129096508, decouple_loss:0.0129409059882164
loss_pred:0.026216981932520866, decouple_loss:0.012377146631479263
loss_pred:0.026736093685030937, decouple_loss:0.01243556197732687
Iteration: 1989, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44626617431640625, gen p mean: -0.7254307270050049, mean p set: 0.44674646854400635
The modified gen p mean: 0.44611862301826477, gen p mean: -0.7227885127067566, mean p set: 0.44659891724586487
The modified gen p mean: 0.44661709666252136, gen p mean: -0.7268940210342407, mean p set: 0.44709739089012146
loss_pred:0.02653675340116024, decouple_loss:0.012105950154364109
loss_pred:0.027263132855296135, decouple_loss:0.012083466164767742
loss_pred:0.027821112424135208, decouple_loss:0.01245118211954832
Iteration: 1990, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44654765725135803, gen p mean: -0.715911328792572, mean p set: 0.44702792167663574
The modified gen p mean: 0.4474034011363983, gen p mean: -0.7211146950721741, mean p set: 0.447883665561676
The modified gen p mean: 0.44622835516929626, gen p mean: -0.714116096496582, mean p set: 0.446708619594574
loss_pred:0.02694554254412651, decouple_loss:0.011668834835290909
loss_pred:0.02779616229236126, decouple_loss:0.012016205117106438
loss_pred:0.02812477946281433, decouple_loss:0.012181293219327927
2023-05-03 03:32:58 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7222983241081238, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7142395973205566, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7100412845611572, mean p set: 0.45035696029663086
loss_pred:0.027809498831629753, decouple_loss:0.012422938831150532
loss_pred:0.026820817962288857, decouple_loss:0.012169398367404938
loss_pred:0.026510851457715034, decouple_loss:0.012290013954043388
WV_0_PC_1_EH_0_PS_40_6, loss: 0.0276617631316185, avg_mse: 0.03250556066632271
current test mse: 0.032506
Iteration: 1991, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44695645570755005, gen p mean: -0.7181570529937744, mean p set: 0.44743674993515015
The modified gen p mean: 0.44697561860084534, gen p mean: -0.716681182384491, mean p set: 0.44745591282844543
loss_pred:0.02674461156129837, decouple_loss:0.01239077840000391
loss_pred:0.027041960507631302, decouple_loss:0.011772943660616875
The modified gen p mean: 0.44773462414741516, gen p mean: -0.717929482460022, mean p set: 0.44821488857269287
loss_pred:0.026690147817134857, decouple_loss:0.011799829080700874
Iteration: 1992, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456627666950226, gen p mean: -0.7101430296897888, mean p set: 0.4461430609226227
The modified gen p mean: 0.44710981845855713, gen p mean: -0.7163984775543213, mean p set: 0.4475901126861572
The modified gen p mean: 0.446078360080719, gen p mean: -0.7116280794143677, mean p set: 0.4465586841106415
loss_pred:0.02718879096210003, decouple_loss:0.01188761554658413
loss_pred:0.02748577669262886, decouple_loss:0.012499944306910038
loss_pred:0.026880476623773575, decouple_loss:0.012219591066241264
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1993, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466501772403717, gen p mean: -0.7122812867164612, mean p set: 0.4471304714679718
The modified gen p mean: 0.44666650891304016, gen p mean: -0.7080267667770386, mean p set: 0.44714680314064026
The modified gen p mean: 0.4467221796512604, gen p mean: -0.708490252494812, mean p set: 0.4472024440765381
loss_pred:0.026996295899152756, decouple_loss:0.011909198947250843
loss_pred:0.02766423486173153, decouple_loss:0.01226737629622221
loss_pred:0.02781861089169979, decouple_loss:0.011783499270677567
Iteration: 1994, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445743203163147, gen p mean: -0.7122125625610352, mean p set: 0.44622352719306946
The modified gen p mean: 0.4474562704563141, gen p mean: -0.7154595255851746, mean p set: 0.4479365348815918
The modified gen p mean: 0.4475697875022888, gen p mean: -0.7076862454414368, mean p set: 0.4480500817298889
loss_pred:0.02668623812496662, decouple_loss:0.01188664324581623
loss_pred:0.02746221050620079, decouple_loss:0.012091326527297497
loss_pred:0.02599778212606907, decouple_loss:0.011548379436135292
Iteration: 1995, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476061463356018, gen p mean: -0.7114621996879578, mean p set: 0.4480864405632019
The modified gen p mean: 0.4465055763721466, gen p mean: -0.7095292806625366, mean p set: 0.4469858705997467
The modified gen p mean: 0.4455907940864563, gen p mean: -0.7084912657737732, mean p set: 0.4460710883140564
loss_pred:0.02699434943497181, decouple_loss:0.012279463931918144
loss_pred:0.026994291692972183, decouple_loss:0.01215707790106535
loss_pred:0.026663359254598618, decouple_loss:0.011492161080241203
Iteration: 1996, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44674399495124817, gen p mean: -0.7071434855461121, mean p set: 0.44722431898117065
The modified gen p mean: 0.4463469684123993, gen p mean: -0.7137764096260071, mean p set: 0.4468272626399994
The modified gen p mean: 0.447532594203949, gen p mean: -0.7047901153564453, mean p set: 0.4480128884315491
loss_pred:0.02705216407775879, decouple_loss:0.01175033487379551
loss_pred:0.02644878812134266, decouple_loss:0.011808648705482483
loss_pred:0.027993932366371155, decouple_loss:0.011492736637592316
Iteration: 1997, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469921588897705, gen p mean: -0.7025524377822876, mean p set: 0.4474724233150482
The modified gen p mean: 0.4474700093269348, gen p mean: -0.7017467617988586, mean p set: 0.4479503035545349
The modified gen p mean: 0.4463847279548645, gen p mean: -0.703985333442688, mean p set: 0.4468649923801422
loss_pred:0.027104949578642845, decouple_loss:0.011781315319240093
loss_pred:0.025622829794883728, decouple_loss:0.010982667095959187
loss_pred:0.027066482231020927, decouple_loss:0.011837518773972988
Iteration: 1998, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472411572933197, gen p mean: -0.7073445916175842, mean p set: 0.4477214217185974
The modified gen p mean: 0.44725653529167175, gen p mean: -0.7058379054069519, mean p set: 0.44773682951927185
The modified gen p mean: 0.4467817544937134, gen p mean: -0.7093755006790161, mean p set: 0.44726207852363586
loss_pred:0.026740025728940964, decouple_loss:0.011264083907008171
loss_pred:0.026914082467556, decouple_loss:0.011757900007069111
loss_pred:0.02695266343653202, decouple_loss:0.011138834059238434
Iteration: 1999, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476163983345032, gen p mean: -0.7127679586410522, mean p set: 0.4480966627597809
The modified gen p mean: 0.44704368710517883, gen p mean: -0.7090163230895996, mean p set: 0.44752398133277893
The modified gen p mean: 0.44795098900794983, gen p mean: -0.7185491919517517, mean p set: 0.4484312832355499
loss_pred:0.026991939172148705, decouple_loss:0.011350669898092747
loss_pred:0.026301255449652672, decouple_loss:0.011399798095226288
loss_pred:0.026757869869470596, decouple_loss:0.012417105957865715
Iteration: 2000, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708752632141113, gen p mean: -0.7137397527694702, mean p set: 0.44756782054901123
The modified gen p mean: 0.4475097954273224, gen p mean: -0.718185544013977, mean p set: 0.4479900598526001
The modified gen p mean: 0.44651859998703003, gen p mean: -0.7141850590705872, mean p set: 0.4469989240169525
loss_pred:0.02598273940384388, decouple_loss:0.011024650186300278
loss_pred:0.02773316204547882, decouple_loss:0.011505264788866043
loss_pred:0.027283592149615288, decouple_loss:0.01147652417421341
2023-05-03 03:36:40 itr: 2000
training loss: [0.02785742 0.02653397 0.02830843]
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40_6/model_2000.ckpt
2023-05-03 03:36:45 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.7220683693885803, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7152289152145386, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7113712430000305, mean p set: 0.45035696029663086
loss_pred:0.02774835005402565, decouple_loss:0.0119022773578763
loss_pred:0.02673248201608658, decouple_loss:0.01155706774443388
loss_pred:0.026393987238407135, decouple_loss:0.011674989014863968
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027543846517801285, avg_mse: 0.03241292014718056
current test mse: 0.032413
Iteration: 2001, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458150565624237, gen p mean: -0.7195407748222351, mean p set: 0.4462953209877014
The modified gen p mean: 0.44590479135513306, gen p mean: -0.7185963988304138, mean p set: 0.44638508558273315
loss_pred:0.026687750592827797, decouple_loss:0.011242619715631008
loss_pred:0.02680119127035141, decouple_loss:0.011233605444431305
The modified gen p mean: 0.4465286433696747, gen p mean: -0.7193289995193481, mean p set: 0.44700896739959717
loss_pred:0.025825506076216698, decouple_loss:0.01128159649670124
Iteration: 2002, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466029405593872, gen p mean: -0.7143908143043518, mean p set: 0.4470832645893097
The modified gen p mean: 0.4462556838989258, gen p mean: -0.7129390835762024, mean p set: 0.4467359483242035
The modified gen p mean: 0.44697442650794983, gen p mean: -0.7130240201950073, mean p set: 0.44745466113090515
loss_pred:0.02624782919883728, decouple_loss:0.01172117330133915
loss_pred:0.02660849317908287, decouple_loss:0.011222343891859055
loss_pred:0.026112474501132965, decouple_loss:0.010755621828138828
Iteration: 2003, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464870095252991, gen p mean: -0.7076029181480408, mean p set: 0.44696730375289917
The modified gen p mean: 0.44630759954452515, gen p mean: -0.7107189893722534, mean p set: 0.44678789377212524
The modified gen p mean: 0.44668835401535034, gen p mean: -0.7118709683418274, mean p set: 0.44716861844062805
loss_pred:0.026476508006453514, decouple_loss:0.011203895322978497
loss_pred:0.026090241968631744, decouple_loss:0.011013362556695938
loss_pred:0.026648515835404396, decouple_loss:0.010898741893470287
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 2004, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473111629486084, gen p mean: -0.7199353575706482, mean p set: 0.4477914571762085
The modified gen p mean: 0.4474707543849945, gen p mean: -0.712846040725708, mean p set: 0.4479510188102722
The modified gen p mean: 0.4471854269504547, gen p mean: -0.7094830274581909, mean p set: 0.4476657211780548
loss_pred:0.027552442625164986, decouple_loss:0.010995330289006233
loss_pred:0.026534777134656906, decouple_loss:0.011441417038440704
loss_pred:0.02656087838113308, decouple_loss:0.011743905022740364
Iteration: 2005, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44761157035827637, gen p mean: -0.7165140509605408, mean p set: 0.4480918347835541
The modified gen p mean: 0.44794487953186035, gen p mean: -0.7165291905403137, mean p set: 0.44842514395713806
The modified gen p mean: 0.44820713996887207, gen p mean: -0.7195827960968018, mean p set: 0.44868743419647217
loss_pred:0.02843143418431282, decouple_loss:0.010850820690393448
loss_pred:0.0274681206792593, decouple_loss:0.01084872242063284
loss_pred:0.02637120895087719, decouple_loss:0.011189467273652554
Iteration: 2006, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480040967464447, gen p mean: -0.7331254482269287, mean p set: 0.4484843611717224
The modified gen p mean: 0.4468086063861847, gen p mean: -0.7251017093658447, mean p set: 0.4472888708114624
The modified gen p mean: 0.44660720229148865, gen p mean: -0.7272886633872986, mean p set: 0.44708749651908875
loss_pred:0.026852574199438095, decouple_loss:0.011727296747267246
loss_pred:0.026871392503380775, decouple_loss:0.011283481493592262
loss_pred:0.027850359678268433, decouple_loss:0.011820354498922825
Iteration: 2007, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44622576236724854, gen p mean: -0.7152072787284851, mean p set: 0.44670602679252625
The modified gen p mean: 0.4479466378688812, gen p mean: -0.7281386256217957, mean p set: 0.4484269320964813
The modified gen p mean: 0.44754335284233093, gen p mean: -0.7188613414764404, mean p set: 0.44802361726760864
loss_pred:0.028068745508790016, decouple_loss:0.011241430416703224
loss_pred:0.02635221928358078, decouple_loss:0.011370022781193256
loss_pred:0.026632143184542656, decouple_loss:0.010594112798571587
Iteration: 2008, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44693994522094727, gen p mean: -0.7223156690597534, mean p set: 0.44742023944854736
The modified gen p mean: 0.4472962021827698, gen p mean: -0.7339342832565308, mean p set: 0.4477764964103699
The modified gen p mean: 0.446816623210907, gen p mean: -0.7281005382537842, mean p set: 0.4472969174385071
loss_pred:0.02686060033738613, decouple_loss:0.01052053365856409
loss_pred:0.02654911018908024, decouple_loss:0.011676055379211903
loss_pred:0.02616759203374386, decouple_loss:0.01141311414539814
Iteration: 2009, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467688798904419, gen p mean: -0.7208481431007385, mean p set: 0.4472491443157196
The modified gen p mean: 0.44732606410980225, gen p mean: -0.7150022387504578, mean p set: 0.44780635833740234
loss_pred:0.02703975699841976, decouple_loss:0.011089271865785122
The modified gen p mean: 0.4472901225090027, gen p mean: -0.718471109867096, mean p set: 0.4477703869342804
loss_pred:0.027963286265730858, decouple_loss:0.011357838287949562
loss_pred:0.02753496542572975, decouple_loss:0.011125811375677586
Iteration: 2010, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485522210597992, gen p mean: -0.720812976360321, mean p set: 0.4490325152873993
The modified gen p mean: 0.4473397731781006, gen p mean: -0.7062843441963196, mean p set: 0.4478200376033783
The modified gen p mean: 0.44680526852607727, gen p mean: -0.7106671333312988, mean p set: 0.44728556275367737
loss_pred:0.02556183561682701, decouple_loss:0.011513243429362774
loss_pred:0.02768455632030964, decouple_loss:0.010785936377942562
loss_pred:0.027728155255317688, decouple_loss:0.011014788411557674
2023-05-03 03:41:10 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7068398594856262, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7138412594795227, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7025138735771179, mean p set: 0.45035696029663086
loss_pred:0.026697590947151184, decouple_loss:0.011380000971257687
loss_pred:0.027647823095321655, decouple_loss:0.011527583934366703
loss_pred:0.026400551199913025, decouple_loss:0.011640668846666813
WV_0_PC_1_EH_0_PS_40_6, loss: 0.0274911280721426, avg_mse: 0.032406266778707504
current test mse: 0.032406
Iteration: 2011, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465304911136627, gen p mean: -0.7119473814964294, mean p set: 0.44701075553894043
The modified gen p mean: 0.44688400626182556, gen p mean: -0.7176653146743774, mean p set: 0.44736430048942566
loss_pred:0.027006465941667557, decouple_loss:0.010694807395339012
loss_pred:0.02695768140256405, decouple_loss:0.011833470314741135
The modified gen p mean: 0.446754515171051, gen p mean: -0.7101625204086304, mean p set: 0.44723477959632874
loss_pred:0.02746548131108284, decouple_loss:0.010773582383990288
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2012, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823771715164185, gen p mean: -0.7122198939323425, mean p set: 0.44871804118156433
The modified gen p mean: 0.4471207857131958, gen p mean: -0.7164263129234314, mean p set: 0.4476010799407959
The modified gen p mean: 0.44814372062683105, gen p mean: -0.711853563785553, mean p set: 0.44862401485443115
loss_pred:0.027671394869685173, decouple_loss:0.01180694717913866
loss_pred:0.02700718306005001, decouple_loss:0.011678265407681465
loss_pred:0.027850262820720673, decouple_loss:0.011685233563184738
Iteration: 2013, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482698440551758, gen p mean: -0.7272567749023438, mean p set: 0.4487501382827759
The modified gen p mean: 0.44930851459503174, gen p mean: -0.7311592698097229, mean p set: 0.4497888684272766
The modified gen p mean: 0.4488238990306854, gen p mean: -0.7279384732246399, mean p set: 0.44930416345596313
loss_pred:0.02635761722922325, decouple_loss:0.011595678515732288
loss_pred:0.025500958785414696, decouple_loss:0.011786998249590397
loss_pred:0.02634933404624462, decouple_loss:0.011664550751447678
Iteration: 2014, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773998856544495, gen p mean: -0.72164386510849, mean p set: 0.44822028279304504
The modified gen p mean: 0.4483228921890259, gen p mean: -0.7243815064430237, mean p set: 0.44880321621894836
The modified gen p mean: 0.4473671317100525, gen p mean: -0.7115908265113831, mean p set: 0.4478473961353302
loss_pred:0.02617724984884262, decouple_loss:0.011297952383756638
loss_pred:0.0269506573677063, decouple_loss:0.011200307868421078
loss_pred:0.027873734012246132, decouple_loss:0.011286655440926552
Iteration: 2015, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447831928730011, gen p mean: -0.7163186073303223, mean p set: 0.4483122229576111
The modified gen p mean: 0.44660675525665283, gen p mean: -0.7057114243507385, mean p set: 0.4470870792865753
The modified gen p mean: 0.44742700457572937, gen p mean: -0.7247273921966553, mean p set: 0.4479072690010071
loss_pred:0.026803046464920044, decouple_loss:0.01110392902046442
loss_pred:0.027955180034041405, decouple_loss:0.011577194556593895
loss_pred:0.026129547506570816, decouple_loss:0.011484969407320023
Iteration: 2016, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44688132405281067, gen p mean: -0.7210949063301086, mean p set: 0.44736161828041077
The modified gen p mean: 0.44862890243530273, gen p mean: -0.7138144969940186, mean p set: 0.44910916686058044
The modified gen p mean: 0.447664350271225, gen p mean: -0.7170809507369995, mean p set: 0.4481446444988251
loss_pred:0.025813350453972816, decouple_loss:0.011405425146222115
loss_pred:0.02791358157992363, decouple_loss:0.011149334721267223
loss_pred:0.028049012646079063, decouple_loss:0.010873549617826939
Iteration: 2017, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472196400165558, gen p mean: -0.7175105810165405, mean p set: 0.4476999342441559
The modified gen p mean: 0.4473554193973541, gen p mean: -0.7233960628509521, mean p set: 0.4478357136249542
The modified gen p mean: 0.4466507136821747, gen p mean: -0.7238128781318665, mean p set: 0.4471310079097748
loss_pred:0.02715568244457245, decouple_loss:0.011463222093880177
loss_pred:0.026316674426198006, decouple_loss:0.011180945672094822
loss_pred:0.026112735271453857, decouple_loss:0.011273170821368694
Iteration: 2018, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44699323177337646, gen p mean: -0.7113311290740967, mean p set: 0.44747352600097656
The modified gen p mean: 0.4474377930164337, gen p mean: -0.7172518372535706, mean p set: 0.4479181170463562
The modified gen p mean: 0.44745659828186035, gen p mean: -0.7154972553253174, mean p set: 0.44793686270713806
loss_pred:0.027371929958462715, decouple_loss:0.01154333632439375
loss_pred:0.02677612565457821, decouple_loss:0.010765430517494678
loss_pred:0.026773884892463684, decouple_loss:0.011424818076193333
Iteration: 2019, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481146037578583, gen p mean: -0.7199260592460632, mean p set: 0.4485948383808136
The modified gen p mean: 0.447663813829422, gen p mean: -0.7198526859283447, mean p set: 0.4481441080570221
The modified gen p mean: 0.44682765007019043, gen p mean: -0.7292798161506653, mean p set: 0.4473079442977905
loss_pred:0.02704828791320324, decouple_loss:0.010707855224609375
loss_pred:0.02651394158601761, decouple_loss:0.01069245021790266
loss_pred:0.026476550847291946, decouple_loss:0.011781775392591953
Iteration: 2020, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472491145133972, gen p mean: -0.7245956063270569, mean p set: 0.4477294087409973
The modified gen p mean: 0.4481635093688965, gen p mean: -0.7288830876350403, mean p set: 0.4486437737941742
The modified gen p mean: 0.4470902979373932, gen p mean: -0.7244755029678345, mean p set: 0.4475705623626709
loss_pred:0.027590341866016388, decouple_loss:0.010799802839756012
loss_pred:0.02653013914823532, decouple_loss:0.010466299951076508
loss_pred:0.026154298335313797, decouple_loss:0.010523505508899689
2023-05-03 03:44:56 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7296651005744934, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7366783022880554, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7250636219978333, mean p set: 0.45035696029663086
loss_pred:0.026642683893442154, decouple_loss:0.011106651276350021
loss_pred:0.027710162103176117, decouple_loss:0.01132130715996027
loss_pred:0.02644392102956772, decouple_loss:0.011271508410573006
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02749391458928585, avg_mse: 0.03243552893400192
current test mse: 0.032436
Iteration: 2021, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477618634700775, gen p mean: -0.7331050038337708, mean p set: 0.4482421875
loss_pred:0.026530582457780838, decouple_loss:0.01093169953674078
The modified gen p mean: 0.44795045256614685, gen p mean: -0.732977032661438, mean p set: 0.44843074679374695
loss_pred:0.02765008620917797, decouple_loss:0.01086603756994009
The modified gen p mean: 0.44723573327064514, gen p mean: -0.7334061861038208, mean p set: 0.44771599769592285
loss_pred:0.025851907208561897, decouple_loss:0.011130568571388721
Iteration: 2022, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472769796848297, gen p mean: -0.717282772064209, mean p set: 0.4477572739124298
The modified gen p mean: 0.44815999269485474, gen p mean: -0.7233867049217224, mean p set: 0.44864028692245483
The modified gen p mean: 0.4484044313430786, gen p mean: -0.7313048839569092, mean p set: 0.4488847255706787
loss_pred:0.027950743213295937, decouple_loss:0.011177586391568184
loss_pred:0.027511218562722206, decouple_loss:0.011045313440263271
loss_pred:0.026305103674530983, decouple_loss:0.011154413223266602
Iteration: 2023, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769397377967834, gen p mean: -0.7227855324745178, mean p set: 0.44817429780960083
The modified gen p mean: 0.44689297676086426, gen p mean: -0.7260221838951111, mean p set: 0.44737330079078674
The modified gen p mean: 0.4478028416633606, gen p mean: -0.7260509729385376, mean p set: 0.4482831358909607
loss_pred:0.026594853028655052, decouple_loss:0.010576295666396618
loss_pred:0.02629803493618965, decouple_loss:0.010719805024564266
loss_pred:0.0265961941331625, decouple_loss:0.010655573569238186
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
NaN value num: 0
Iteration: 2024, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524238407611847, gen p mean: -0.7227144837379456, mean p set: 0.4529041349887848
The modified gen p mean: 0.4508257210254669, gen p mean: -0.718136727809906, mean p set: 0.451306015253067
The modified gen p mean: 0.45218440890312195, gen p mean: -0.7191140651702881, mean p set: 0.45266470313072205
loss_pred:0.028023017570376396, decouple_loss:0.013402416370809078
loss_pred:0.026574786752462387, decouple_loss:0.012833009473979473
loss_pred:0.02605808712542057, decouple_loss:0.013482438400387764
Iteration: 2025, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45218974351882935, gen p mean: -0.7363106608390808, mean p set: 0.45267003774642944
The modified gen p mean: 0.451555460691452, gen p mean: -0.7332004308700562, mean p set: 0.4520357549190521
The modified gen p mean: 0.45151811838150024, gen p mean: -0.7249284982681274, mean p set: 0.45199838280677795
loss_pred:0.026991134509444237, decouple_loss:0.013221066445112228
loss_pred:0.02663414366543293, decouple_loss:0.012940016575157642
loss_pred:0.02748415246605873, decouple_loss:0.013180197216570377
Iteration: 2026, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45007583498954773, gen p mean: -0.7384132146835327, mean p set: 0.45055609941482544
The modified gen p mean: 0.4513852596282959, gen p mean: -0.7402819991111755, mean p set: 0.451865553855896
The modified gen p mean: 0.45250239968299866, gen p mean: -0.7370266914367676, mean p set: 0.45298269391059875
loss_pred:0.027941834181547165, decouple_loss:0.012452961876988411
loss_pred:0.027019601315259933, decouple_loss:0.012515658512711525
loss_pred:0.02692972496151924, decouple_loss:0.012555322609841824
Iteration: 2027, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517342746257782, gen p mean: -0.7336297035217285, mean p set: 0.4522145688533783
The modified gen p mean: 0.45133569836616516, gen p mean: -0.741115391254425, mean p set: 0.45181599259376526
The modified gen p mean: 0.4516814053058624, gen p mean: -0.7433750033378601, mean p set: 0.4521616995334625
loss_pred:0.02776491828262806, decouple_loss:0.012429428286850452
loss_pred:0.025962019339203835, decouple_loss:0.013046281412243843
loss_pred:0.026424916461110115, decouple_loss:0.01300188060849905
Iteration: 2028, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509037733078003, gen p mean: -0.7237197160720825, mean p set: 0.451384037733078
The modified gen p mean: 0.4518425166606903, gen p mean: -0.7189463973045349, mean p set: 0.452322781085968
The modified gen p mean: 0.450979620218277, gen p mean: -0.7206868529319763, mean p set: 0.4514599144458771
loss_pred:0.024842679500579834, decouple_loss:0.012446963228285313
loss_pred:0.027630148455500603, decouple_loss:0.012471845373511314
loss_pred:0.027173707261681557, decouple_loss:0.012663617730140686
Iteration: 2029, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45103371143341064, gen p mean: -0.7117984890937805, mean p set: 0.45151403546333313
The modified gen p mean: 0.451744019985199, gen p mean: -0.714277446269989, mean p set: 0.4522242546081543
The modified gen p mean: 0.4512692093849182, gen p mean: -0.7132629156112671, mean p set: 0.4517495334148407
loss_pred:0.02620849199593067, decouple_loss:0.012117085047066212
loss_pred:0.02529236115515232, decouple_loss:0.012482144869863987
loss_pred:0.026615669950842857, decouple_loss:0.012390004470944405
Iteration: 2030, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518498182296753, gen p mean: -0.7105466723442078, mean p set: 0.4523301124572754
The modified gen p mean: 0.4515415132045746, gen p mean: -0.7026035785675049, mean p set: 0.4520217776298523
The modified gen p mean: 0.45280566811561584, gen p mean: -0.7073317170143127, mean p set: 0.45328596234321594
loss_pred:0.02665543183684349, decouple_loss:0.01232192199677229
loss_pred:0.02642722800374031, decouple_loss:0.0123871099203825
loss_pred:0.027818255126476288, decouple_loss:0.01224663108587265
2023-05-03 03:49:14 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7215664982795715, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.714320957660675, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7098499536514282, mean p set: 0.45035696029663086
loss_pred:0.028063315898180008, decouple_loss:0.013415130786597729
loss_pred:0.026992205530405045, decouple_loss:0.013561507686972618
loss_pred:0.02662670612335205, decouple_loss:0.013837381266057491
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02790764346718788, avg_mse: 0.03302387893199921
current test mse: 0.033024
Iteration: 2031, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523261487483978, gen p mean: -0.7143648862838745, mean p set: 0.4528064429759979
The modified gen p mean: 0.45145028829574585, gen p mean: -0.7170717716217041, mean p set: 0.45193058252334595
loss_pred:0.025780552998185158, decouple_loss:0.012479370459914207
loss_pred:0.025708915665745735, decouple_loss:0.012401757761836052
The modified gen p mean: 0.451695054769516, gen p mean: -0.720245897769928, mean p set: 0.4521753489971161
loss_pred:0.02672639861702919, decouple_loss:0.012266486883163452
Iteration: 2032, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45049622654914856, gen p mean: -0.7134056687355042, mean p set: 0.4509764611721039
The modified gen p mean: 0.45289239287376404, gen p mean: -0.7253968119621277, mean p set: 0.45337265729904175
The modified gen p mean: 0.4513266086578369, gen p mean: -0.7233967781066895, mean p set: 0.4518068730831146
loss_pred:0.025408999994397163, decouple_loss:0.01204580720514059
loss_pred:0.025625018402934074, decouple_loss:0.011903304606676102
loss_pred:0.026603220030665398, decouple_loss:0.012121631763875484
Iteration: 2033, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516414701938629, gen p mean: -0.7293885946273804, mean p set: 0.4521217942237854
The modified gen p mean: 0.4519060552120209, gen p mean: -0.7360743880271912, mean p set: 0.4523863196372986
The modified gen p mean: 0.45319268107414246, gen p mean: -0.7348393201828003, mean p set: 0.45367300510406494
loss_pred:0.027797456830739975, decouple_loss:0.012318299151957035
loss_pred:0.025100067257881165, decouple_loss:0.011738855391740799
loss_pred:0.027977777644991875, decouple_loss:0.012358657084405422
Iteration: 2034, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509216845035553, gen p mean: -0.7291910648345947, mean p set: 0.4514019787311554
The modified gen p mean: 0.45141056180000305, gen p mean: -0.7243630886077881, mean p set: 0.45189085602760315
The modified gen p mean: 0.4508942663669586, gen p mean: -0.7293750643730164, mean p set: 0.45137453079223633
loss_pred:0.025102443993091583, decouple_loss:0.011778603307902813
loss_pred:0.026248713955283165, decouple_loss:0.011874700896441936
loss_pred:0.02695840783417225, decouple_loss:0.0121289798989892
Iteration: 2035, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510509669780731, gen p mean: -0.7255503535270691, mean p set: 0.45153123140335083
The modified gen p mean: 0.44988471269607544, gen p mean: -0.7245998382568359, mean p set: 0.45036500692367554
The modified gen p mean: 0.4525472819805145, gen p mean: -0.7221322059631348, mean p set: 0.453027606010437
loss_pred:0.02523801103234291, decouple_loss:0.011586801148951054
loss_pred:0.024787085130810738, decouple_loss:0.011978876776993275
loss_pred:0.025369280949234962, decouple_loss:0.011675303801894188
Iteration: 2036, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502457082271576, gen p mean: -0.7226484417915344, mean p set: 0.4507259726524353
The modified gen p mean: 0.45027273893356323, gen p mean: -0.7199764251708984, mean p set: 0.45075303316116333
The modified gen p mean: 0.4524010121822357, gen p mean: -0.7257120609283447, mean p set: 0.4528812766075134
loss_pred:0.025789130479097366, decouple_loss:0.01205518376082182
loss_pred:0.02532416395843029, decouple_loss:0.011665061116218567
loss_pred:0.027152614668011665, decouple_loss:0.012159372679889202
Iteration: 2037, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45001766085624695, gen p mean: -0.7231910228729248, mean p set: 0.45049792528152466
The modified gen p mean: 0.4512156546115875, gen p mean: -0.7317438125610352, mean p set: 0.4516959488391876
The modified gen p mean: 0.45166030526161194, gen p mean: -0.7259250283241272, mean p set: 0.45214059948921204
loss_pred:0.02554601989686489, decouple_loss:0.011744839139282703
loss_pred:0.025225883349776268, decouple_loss:0.011497247032821178
loss_pred:0.02634565159678459, decouple_loss:0.011587638407945633
Iteration: 2038, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531148672103882, gen p mean: -0.7343280911445618, mean p set: 0.45359519124031067
The modified gen p mean: 0.45141056180000305, gen p mean: -0.733063280582428, mean p set: 0.45189085602760315
The modified gen p mean: 0.44988885521888733, gen p mean: -0.7300485372543335, mean p set: 0.4503691494464874
loss_pred:0.025874178856611252, decouple_loss:0.011425681412220001
loss_pred:0.0257192924618721, decouple_loss:0.011433678679168224
loss_pred:0.025257492437958717, decouple_loss:0.011138927191495895
Iteration: 2039, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510553181171417, gen p mean: -0.7302864193916321, mean p set: 0.4515356123447418
The modified gen p mean: 0.45105841755867004, gen p mean: -0.7300768494606018, mean p set: 0.45153874158859253
The modified gen p mean: 0.45345067977905273, gen p mean: -0.7301397919654846, mean p set: 0.4539310038089752
loss_pred:0.026860373094677925, decouple_loss:0.011713515967130661loss_pred:0.025381894782185555, decouple_loss:0.011257480829954147
loss_pred:0.02586027793586254, decouple_loss:0.011543317697942257
Iteration: 2040, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45245376229286194, gen p mean: -0.7385320067405701, mean p set: 0.45293402671813965
The modified gen p mean: 0.45231252908706665, gen p mean: -0.7371324896812439, mean p set: 0.45279279351234436
The modified gen p mean: 0.4518781304359436, gen p mean: -0.7449213266372681, mean p set: 0.4523584544658661
loss_pred:0.027548285201191902, decouple_loss:0.01243575755506754
loss_pred:0.027200855314731598, decouple_loss:0.011832321994006634
loss_pred:0.026379529386758804, decouple_loss:0.012061293236911297
2023-05-03 03:52:59 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7427057027816772, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.734713077545166, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.729620099067688, mean p set: 0.45035696029663086
loss_pred:0.02833464741706848, decouple_loss:0.01304433960467577
loss_pred:0.027253150939941406, decouple_loss:0.01292066927999258
loss_pred:0.026843298226594925, decouple_loss:0.013176077976822853
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02812938392162323, avg_mse: 0.0334114246070385
current test mse: 0.033411
Iteration: 2041, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513300359249115, gen p mean: -0.7344634532928467, mean p set: 0.4518103301525116
loss_pred:0.02532324567437172, decouple_loss:0.010948209092020988
The modified gen p mean: 0.45317938923835754, gen p mean: -0.7345658540725708, mean p set: 0.45365968346595764
loss_pred:0.026309026405215263, decouple_loss:0.011347183957695961
The modified gen p mean: 0.4519972503185272, gen p mean: -0.747731626033783, mean p set: 0.45247751474380493
loss_pred:0.02673383802175522, decouple_loss:0.011927458457648754
Iteration: 2042, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495593011379242, gen p mean: -0.7297034859657288, mean p set: 0.4500395953655243
The modified gen p mean: 0.4516810476779938, gen p mean: -0.7317989468574524, mean p set: 0.45216134190559387
The modified gen p mean: 0.45357760787010193, gen p mean: -0.7319533228874207, mean p set: 0.45405787229537964
loss_pred:0.02489154227077961, decouple_loss:0.01136618573218584
loss_pred:0.02691117487847805, decouple_loss:0.011728075332939625
loss_pred:0.02621854841709137, decouple_loss:0.011195722036063671
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 2043, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677507877349854, gen p mean: -0.7342103123664856, mean p set: 0.44725537300109863
The modified gen p mean: 0.44607147574424744, gen p mean: -0.7344096302986145, mean p set: 0.44655176997184753
The modified gen p mean: 0.4464617967605591, gen p mean: -0.7275880575180054, mean p set: 0.4469420909881592
loss_pred:0.02824930101633072, decouple_loss:0.013144854456186295
loss_pred:0.02913459576666355, decouple_loss:0.013555568642914295
loss_pred:0.027290433645248413, decouple_loss:0.013683651573956013
Iteration: 2044, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44689762592315674, gen p mean: -0.7364156246185303, mean p set: 0.44737792015075684
The modified gen p mean: 0.4464503824710846, gen p mean: -0.7293903231620789, mean p set: 0.4469307065010071
The modified gen p mean: 0.4473945200443268, gen p mean: -0.7316240668296814, mean p set: 0.44787484407424927
loss_pred:0.02721383608877659, decouple_loss:0.013537636026740074
loss_pred:0.027958383783698082, decouple_loss:0.012921363115310669
loss_pred:0.027706604450941086, decouple_loss:0.01272059977054596
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2045, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467596411705017, gen p mean: -0.7259953022003174, mean p set: 0.4472399353981018
The modified gen p mean: 0.44703683257102966, gen p mean: -0.7280601263046265, mean p set: 0.44751712679862976
The modified gen p mean: 0.4464920163154602, gen p mean: -0.7251233458518982, mean p set: 0.4469722807407379
loss_pred:0.02827773615717888, decouple_loss:0.012548498809337616
loss_pred:0.02779756858944893, decouple_loss:0.012096558697521687
loss_pred:0.027473323047161102, decouple_loss:0.011957315728068352
Iteration: 2046, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459228217601776, gen p mean: -0.7258965373039246, mean p set: 0.4464031159877777
The modified gen p mean: 0.4459005892276764, gen p mean: -0.7271444201469421, mean p set: 0.4463808834552765
The modified gen p mean: 0.44696760177612305, gen p mean: -0.7266703248023987, mean p set: 0.44744786620140076
loss_pred:0.02762116678059101, decouple_loss:0.012003283016383648
loss_pred:0.027178192511200905, decouple_loss:0.012097643688321114
loss_pred:0.02769741415977478, decouple_loss:0.01208253763616085
Iteration: 2047, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44583743810653687, gen p mean: -0.7371413111686707, mean p set: 0.44631776213645935
The modified gen p mean: 0.44665443897247314, gen p mean: -0.7336208820343018, mean p set: 0.44713470339775085
The modified gen p mean: 0.4480520784854889, gen p mean: -0.7374679446220398, mean p set: 0.448532372713089
loss_pred:0.02712683193385601, decouple_loss:0.012343763373792171
loss_pred:0.027842797338962555, decouple_loss:0.01185911800712347
loss_pred:0.02762238308787346, decouple_loss:0.012397336773574352
Iteration: 2048, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475046992301941, gen p mean: -0.7280222177505493, mean p set: 0.4479850232601166
The modified gen p mean: 0.4465695321559906, gen p mean: -0.7374716997146606, mean p set: 0.4470498263835907
The modified gen p mean: 0.44803181290626526, gen p mean: -0.7344832420349121, mean p set: 0.44851207733154297
loss_pred:0.02774301916360855, decouple_loss:0.01184710394591093
loss_pred:0.02645138092339039, decouple_loss:0.011571312323212624
loss_pred:0.026616478338837624, decouple_loss:0.0126021234318614
Iteration: 2049, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740718603134155, gen p mean: -0.7290775179862976, mean p set: 0.44788745045661926
The modified gen p mean: 0.4478432238101959, gen p mean: -0.7310107946395874, mean p set: 0.448323518037796
The modified gen p mean: 0.44631731510162354, gen p mean: -0.7261999845504761, mean p set: 0.44679760932922363
loss_pred:0.02794444002211094, decouple_loss:0.012170049361884594loss_pred:0.027767114341259003, decouple_loss:0.011615540832281113
loss_pred:0.02778739482164383, decouple_loss:0.011844742111861706
Iteration: 2050, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44644829630851746, gen p mean: -0.7297738790512085, mean p set: 0.44692856073379517
The modified gen p mean: 0.44622841477394104, gen p mean: -0.7235605716705322, mean p set: 0.4467087388038635
The modified gen p mean: 0.4480176568031311, gen p mean: -0.7262872457504272, mean p set: 0.4484979510307312
loss_pred:0.026660744100809097, decouple_loss:0.011825332418084145
loss_pred:0.028194917365908623, decouple_loss:0.01164742186665535
loss_pred:0.027654414996504784, decouple_loss:0.011241752654314041
2023-05-03 03:57:23 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.720879852771759, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.728356659412384, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7162109017372131, mean p set: 0.45035696029663086
loss_pred:0.02682303823530674, decouple_loss:0.011720020323991776
loss_pred:0.02779402956366539, decouple_loss:0.011835101060569286
loss_pred:0.026420246809720993, decouple_loss:0.011702442541718483
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027600064873695374, avg_mse: 0.03260795399546623
current test mse: 0.032608
Iteration: 2051, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465339481830597, gen p mean: -0.7257814407348633, mean p set: 0.4470142424106598
The modified gen p mean: 0.4469756484031677, gen p mean: -0.7249163389205933, mean p set: 0.4474559724330902
loss_pred:0.0267220139503479, decouple_loss:0.011594998650252819
loss_pred:0.026954801753163338, decouple_loss:0.011888891458511353
The modified gen p mean: 0.4476187825202942, gen p mean: -0.725013792514801, mean p set: 0.4480991065502167
loss_pred:0.027410786598920822, decouple_loss:0.011689456179738045
Iteration: 2052, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840914011001587, gen p mean: -0.7166174054145813, mean p set: 0.44888943433761597
The modified gen p mean: 0.44619378447532654, gen p mean: -0.7227762937545776, mean p set: 0.44667407870292664
The modified gen p mean: 0.44750991463661194, gen p mean: -0.7173013091087341, mean p set: 0.44799020886421204
loss_pred:0.027800580486655235, decouple_loss:0.011793880723416805
loss_pred:0.02775769680738449, decouple_loss:0.011542140506207943
loss_pred:0.026605119928717613, decouple_loss:0.011465479619801044
Iteration: 2053, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474382996559143, gen p mean: -0.7116195559501648, mean p set: 0.447918564081192
The modified gen p mean: 0.44656628370285034, gen p mean: -0.7110647559165955, mean p set: 0.44704657793045044
The modified gen p mean: 0.44759777188301086, gen p mean: -0.713284432888031, mean p set: 0.44807806611061096
loss_pred:0.026682427152991295, decouple_loss:0.012108827009797096
loss_pred:0.027441812679171562, decouple_loss:0.01135263778269291
loss_pred:0.027834776788949966, decouple_loss:0.01105932705104351
Iteration: 2054, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479432702064514, gen p mean: -0.7164354920387268, mean p set: 0.4484235644340515
The modified gen p mean: 0.44718873500823975, gen p mean: -0.711263120174408, mean p set: 0.44766902923583984
The modified gen p mean: 0.4462399184703827, gen p mean: -0.71461021900177, mean p set: 0.4467202425003052
loss_pred:0.026535751298069954, decouple_loss:0.01150366198271513
loss_pred:0.027572302147746086, decouple_loss:0.011699060909450054
loss_pred:0.027422819286584854, decouple_loss:0.011395609937608242
Iteration: 2055, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44605615735054016, gen p mean: -0.7285710573196411, mean p set: 0.44653645157814026
The modified gen p mean: 0.44529393315315247, gen p mean: -0.7208961844444275, mean p set: 0.4457741975784302
The modified gen p mean: 0.4468311667442322, gen p mean: -0.7241339087486267, mean p set: 0.4473114311695099
loss_pred:0.026510968804359436, decouple_loss:0.011238554492592812
loss_pred:0.026898205280303955, decouple_loss:0.011941704899072647
loss_pred:0.02643902599811554, decouple_loss:0.01127493567764759
Iteration: 2056, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472518563270569, gen p mean: -0.7273750305175781, mean p set: 0.447732150554657
The modified gen p mean: 0.44727882742881775, gen p mean: -0.7296298146247864, mean p set: 0.44775912165641785
The modified gen p mean: 0.44595468044281006, gen p mean: -0.723262369632721, mean p set: 0.44643494486808777
loss_pred:0.02715739980340004, decouple_loss:0.011703905649483204
loss_pred:0.027751673012971878, decouple_loss:0.011276471428573132
loss_pred:0.026936640962958336, decouple_loss:0.010971042327582836
Iteration: 2057, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44601970911026, gen p mean: -0.7159953713417053, mean p set: 0.4465000033378601
The modified gen p mean: 0.4477819502353668, gen p mean: -0.7240065336227417, mean p set: 0.4482622444629669
The modified gen p mean: 0.44761812686920166, gen p mean: -0.7198137044906616, mean p set: 0.44809842109680176
loss_pred:0.02670338749885559, decouple_loss:0.01087530143558979
loss_pred:0.027891522273421288, decouple_loss:0.010908713564276695
loss_pred:0.027061529457569122, decouple_loss:0.011215677484869957
Iteration: 2058, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44654616713523865, gen p mean: -0.7168304324150085, mean p set: 0.44702646136283875
The modified gen p mean: 0.44647157192230225, gen p mean: -0.714506983757019, mean p set: 0.44695183634757996
The modified gen p mean: 0.4466250538825989, gen p mean: -0.7147774696350098, mean p set: 0.447105348110199
loss_pred:0.02697579562664032, decouple_loss:0.011059622280299664
loss_pred:0.027364954352378845, decouple_loss:0.010827495716512203
loss_pred:0.027644775807857513, decouple_loss:0.010688173584640026
Iteration: 2059, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44592297077178955, gen p mean: -0.7234322428703308, mean p set: 0.44640329480171204
The modified gen p mean: 0.4455997347831726, gen p mean: -0.7203930616378784, mean p set: 0.4460800588130951
The modified gen p mean: 0.447651743888855, gen p mean: -0.7177003622055054, mean p set: 0.44813206791877747
loss_pred:0.026893548667430878, decouple_loss:0.010889550670981407
loss_pred:0.027086807414889336, decouple_loss:0.011322129517793655
loss_pred:0.027566760778427124, decouple_loss:0.010865811258554459
Iteration: 2060, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44621577858924866, gen p mean: -0.7281043529510498, mean p set: 0.44669607281684875
The modified gen p mean: 0.4467129409313202, gen p mean: -0.7244788408279419, mean p set: 0.4471932351589203
The modified gen p mean: 0.446699857711792, gen p mean: -0.7238705158233643, mean p set: 0.4471801817417145
loss_pred:0.026479586958885193, decouple_loss:0.010534357279539108
loss_pred:0.027843354269862175, decouple_loss:0.010632370598614216
loss_pred:0.0280266422778368, decouple_loss:0.010651799850165844
2023-05-03 04:01:04 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7286058664321899, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888386249542, gen p mean: -0.735517680644989, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7236161231994629, mean p set: 0.45035696029663086
loss_pred:0.026562336832284927, decouple_loss:0.0112232631072402
loss_pred:0.027598712593317032, decouple_loss:0.011249063536524773
loss_pred:0.026264915242791176, decouple_loss:0.011206241324543953
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027369966730475426, avg_mse: 0.03235885500907898
current test mse: 0.032359
Iteration: 2061, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457560181617737, gen p mean: -0.7269386053085327, mean p set: 0.4462362825870514
The modified gen p mean: 0.44623327255249023, gen p mean: -0.7250874042510986, mean p set: 0.44671353697776794
loss_pred:0.026437491178512573, decouple_loss:0.010550742037594318
loss_pred:0.027185901999473572, decouple_loss:0.010362542234361172
The modified gen p mean: 0.4465370178222656, gen p mean: -0.7280893325805664, mean p set: 0.4470173120498657
loss_pred:0.02702009119093418, decouple_loss:0.010632581077516079
Iteration: 2062, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456821382045746, gen p mean: -0.7212336659431458, mean p set: 0.44616246223449707
The modified gen p mean: 0.4458337724208832, gen p mean: -0.7249854803085327, mean p set: 0.4463140368461609
The modified gen p mean: 0.44548192620277405, gen p mean: -0.7269451022148132, mean p set: 0.44596222043037415
loss_pred:0.0281699076294899, decouple_loss:0.010661301203072071
loss_pred:0.02729581668972969, decouple_loss:0.010952582582831383
loss_pred:0.026899628341197968, decouple_loss:0.01078423298895359
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 2063, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799748063087463, gen p mean: -0.7273603081703186, mean p set: 0.44847777485847473
The modified gen p mean: 0.44778385758399963, gen p mean: -0.7349604964256287, mean p set: 0.44826412200927734
The modified gen p mean: 0.4484274089336395, gen p mean: -0.7332322597503662, mean p set: 0.4489077031612396
loss_pred:0.02633560635149479, decouple_loss:0.011072797700762749
loss_pred:0.02578611858189106, decouple_loss:0.011330695822834969
loss_pred:0.02613082341849804, decouple_loss:0.010688792914152145
Iteration: 2064, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841691851615906, gen p mean: -0.7177310585975647, mean p set: 0.44889721274375916
The modified gen p mean: 0.4477713406085968, gen p mean: -0.724770724773407, mean p set: 0.4482516348361969
The modified gen p mean: 0.44751855731010437, gen p mean: -0.7177225351333618, mean p set: 0.44799885153770447
loss_pred:0.0256185382604599, decouple_loss:0.01118868961930275
loss_pred:0.027266569435596466, decouple_loss:0.011267289519309998
loss_pred:0.026238316670060158, decouple_loss:0.010537383146584034
Iteration: 2065, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44787734746932983, gen p mean: -0.7193005084991455, mean p set: 0.4483576714992523
The modified gen p mean: 0.44811728596687317, gen p mean: -0.7162769436836243, mean p set: 0.44859760999679565
The modified gen p mean: 0.44811609387397766, gen p mean: -0.7218069434165955, mean p set: 0.44859638810157776
loss_pred:0.02695833519101143, decouple_loss:0.011397227644920349
loss_pred:0.027650099247694016, decouple_loss:0.011118284426629543
loss_pred:0.02739667147397995, decouple_loss:0.011186471208930016
Iteration: 2066, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795531034469604, gen p mean: -0.7196802496910095, mean p set: 0.44843557476997375
The modified gen p mean: 0.44799932837486267, gen p mean: -0.724564254283905, mean p set: 0.44847962260246277
The modified gen p mean: 0.44798144698143005, gen p mean: -0.7199327945709229, mean p set: 0.44846177101135254
loss_pred:0.0266837477684021, decouple_loss:0.010316666215658188
loss_pred:0.0278246458619833, decouple_loss:0.010599500499665737
loss_pred:0.0261765755712986, decouple_loss:0.010563183575868607
Iteration: 2067, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478335976600647, gen p mean: -0.7197842597961426, mean p set: 0.4483139216899872
The modified gen p mean: 0.4472784698009491, gen p mean: -0.720206081867218, mean p set: 0.4477587640285492
The modified gen p mean: 0.4479043781757355, gen p mean: -0.7153292298316956, mean p set: 0.44838467240333557
loss_pred:0.02656461112201214, decouple_loss:0.010285571217536926
loss_pred:0.02611411362886429, decouple_loss:0.010804335586726665
loss_pred:0.02546696551144123, decouple_loss:0.01037949975579977
Iteration: 2068, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485604763031006, gen p mean: -0.7170127630233765, mean p set: 0.44904080033302307
The modified gen p mean: 0.44806525111198425, gen p mean: -0.7218644022941589, mean p set: 0.44854554533958435
The modified gen p mean: 0.44806358218193054, gen p mean: -0.7232313752174377, mean p set: 0.44854387640953064
loss_pred:0.025416919961571693, decouple_loss:0.010731463320553303
loss_pred:0.02518879994750023, decouple_loss:0.01083768717944622
loss_pred:0.02666749805212021, decouple_loss:0.010488553903996944
Iteration: 2069, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483509063720703, gen p mean: -0.7176303267478943, mean p set: 0.4488312005996704
The modified gen p mean: 0.44773542881011963, gen p mean: -0.7278956174850464, mean p set: 0.4482157230377197
The modified gen p mean: 0.44780224561691284, gen p mean: -0.7320866584777832, mean p set: 0.44828253984451294
loss_pred:0.025550026446580887, decouple_loss:0.01022675447165966
loss_pred:0.02625204436480999, decouple_loss:0.010074169375002384
loss_pred:0.026859285309910774, decouple_loss:0.010373667813837528
Iteration: 2070, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477216899394989, gen p mean: -0.7232697606086731, mean p set: 0.448201984167099
The modified gen p mean: 0.4477950632572174, gen p mean: -0.7360312342643738, mean p set: 0.4482753276824951
The modified gen p mean: 0.4478616714477539, gen p mean: -0.7296259999275208, mean p set: 0.448341965675354
loss_pred:0.025340545922517776, decouple_loss:0.00993323139846325
loss_pred:0.027323538437485695, decouple_loss:0.010830464772880077
loss_pred:0.026663051918148994, decouple_loss:0.010044002905488014
2023-05-03 04:05:19 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7301775217056274, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7229589819908142, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.718141496181488, mean p set: 0.45035696029663086
loss_pred:0.027340417727828026, decouple_loss:0.010975394397974014
loss_pred:0.02641044557094574, decouple_loss:0.010838279500603676
loss_pred:0.026159236207604408, decouple_loss:0.01071805041283369
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027178894728422165, avg_mse: 0.03207140415906906
current test mse: 0.032071
Iteration: 2071, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474197328090668, gen p mean: -0.7259912490844727, mean p set: 0.4478999972343445
loss_pred:0.02662048675119877, decouple_loss:0.010246241465210915
The modified gen p mean: 0.44771623611450195, gen p mean: -0.7263718247413635, mean p set: 0.44819650053977966
loss_pred:0.02577832154929638, decouple_loss:0.010637988336384296
The modified gen p mean: 0.4482947587966919, gen p mean: -0.7292274236679077, mean p set: 0.448775053024292
loss_pred:0.027651362121105194, decouple_loss:0.010413861833512783
Iteration: 2072, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475034475326538, gen p mean: -0.7317066192626953, mean p set: 0.4479837417602539
The modified gen p mean: 0.4478529691696167, gen p mean: -0.7311508059501648, mean p set: 0.4483332633972168
The modified gen p mean: 0.448133647441864, gen p mean: -0.7315598726272583, mean p set: 0.4486139416694641
loss_pred:0.02696622535586357, decouple_loss:0.009956286288797855
loss_pred:0.02646155282855034, decouple_loss:0.010297776199877262
loss_pred:0.026059728115797043, decouple_loss:0.010260537266731262
Iteration: 2073, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744616746902466, gen p mean: -0.7252843379974365, mean p set: 0.44792643189430237
The modified gen p mean: 0.4481147527694702, gen p mean: -0.7361515760421753, mean p set: 0.4485950171947479
The modified gen p mean: 0.44754910469055176, gen p mean: -0.7279842495918274, mean p set: 0.44802939891815186
loss_pred:0.027245720848441124, decouple_loss:0.0100173968821764
loss_pred:0.027083363384008408, decouple_loss:0.010246217250823975
loss_pred:0.026596907526254654, decouple_loss:0.009894583374261856
Iteration: 2074, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790560007095337, gen p mean: -0.7368355393409729, mean p set: 0.44838589429855347
The modified gen p mean: 0.44832858443260193, gen p mean: -0.7198413610458374, mean p set: 0.4488089084625244
The modified gen p mean: 0.44780266284942627, gen p mean: -0.7268880009651184, mean p set: 0.44828298687934875
loss_pred:0.026428943499922752, decouple_loss:0.01001596637070179
loss_pred:0.02720407396554947, decouple_loss:0.01043497584760189
loss_pred:0.02720068395137787, decouple_loss:0.009988648816943169
Iteration: 2075, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44844841957092285, gen p mean: -0.7254825234413147, mean p set: 0.44892874360084534
The modified gen p mean: 0.44822627305984497, gen p mean: -0.7252015471458435, mean p set: 0.4487065374851227
The modified gen p mean: 0.4476363956928253, gen p mean: -0.7282946109771729, mean p set: 0.4481166899204254
loss_pred:0.026477254927158356, decouple_loss:0.009984331205487251
loss_pred:0.025938736274838448, decouple_loss:0.010139452293515205
loss_pred:0.02677670679986477, decouple_loss:0.010070297867059708
Iteration: 2076, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791802763938904, gen p mean: -0.7201096415519714, mean p set: 0.44839832186698914
The modified gen p mean: 0.4480688273906708, gen p mean: -0.7292997241020203, mean p set: 0.4485490918159485
The modified gen p mean: 0.44811341166496277, gen p mean: -0.7218870520591736, mean p set: 0.44859370589256287
loss_pred:0.025471055880188942, decouple_loss:0.010331124998629093
loss_pred:0.027289148420095444, decouple_loss:0.010158750228583813
loss_pred:0.026792334392666817, decouple_loss:0.010412913747131824
Iteration: 2077, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719934463500977, gen p mean: -0.7288554906845093, mean p set: 0.4476796090602875
The modified gen p mean: 0.44788503646850586, gen p mean: -0.733389675617218, mean p set: 0.44836533069610596
The modified gen p mean: 0.448762446641922, gen p mean: -0.7267802953720093, mean p set: 0.4492427408695221
loss_pred:0.02644549496471882, decouple_loss:0.010223399847745895
loss_pred:0.026836667209863663, decouple_loss:0.01026561576873064
loss_pred:0.02650378830730915, decouple_loss:0.009863849729299545
Iteration: 2078, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480019807815552, gen p mean: -0.7257834672927856, mean p set: 0.4484822154045105
The modified gen p mean: 0.4471258223056793, gen p mean: -0.7269731760025024, mean p set: 0.4476061165332794
The modified gen p mean: 0.44868525862693787, gen p mean: -0.726991593837738, mean p set: 0.4491655230522156
loss_pred:0.026541758328676224, decouple_loss:0.00970633514225483
loss_pred:0.026095617562532425, decouple_loss:0.010174380615353584
loss_pred:0.026396334171295166, decouple_loss:0.009531746618449688
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2079, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749870896339417, gen p mean: -0.727081298828125, mean p set: 0.44797900319099426
The modified gen p mean: 0.44771313667297363, gen p mean: -0.7267857789993286, mean p set: 0.44819343090057373
The modified gen p mean: 0.44880369305610657, gen p mean: -0.7153279781341553, mean p set: 0.44928398728370667
loss_pred:0.026588045060634613, decouple_loss:0.010047436691820621
loss_pred:0.026313703507184982, decouple_loss:0.010241890326142311
loss_pred:0.026905691251158714, decouple_loss:0.009843123145401478
Iteration: 2080, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481903612613678, gen p mean: -0.7151263952255249, mean p set: 0.4486706554889679
The modified gen p mean: 0.4491630792617798, gen p mean: -0.7232256531715393, mean p set: 0.4496433436870575
The modified gen p mean: 0.44878119230270386, gen p mean: -0.7308714389801025, mean p set: 0.44926151633262634
loss_pred:0.02521349862217903, decouple_loss:0.010154145769774914
loss_pred:0.02650512382388115, decouple_loss:0.009413106366991997
loss_pred:0.0257080290466547, decouple_loss:0.010417996905744076
2023-05-03 04:09:03 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7206695675849915, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7280458807945251, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.715694010257721, mean p set: 0.45035696029663086
loss_pred:0.02643846534192562, decouple_loss:0.010275612585246563
loss_pred:0.027354151010513306, decouple_loss:0.010605186223983765
loss_pred:0.02606053836643696, decouple_loss:0.010215030051767826
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027135983109474182, avg_mse: 0.032070960849523544
current test mse: 0.032071
Iteration: 2081, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762691855430603, gen p mean: -0.7194399237632751, mean p set: 0.44810721278190613
The modified gen p mean: 0.44794991612434387, gen p mean: -0.7228043675422668, mean p set: 0.44843021035194397
loss_pred:0.026293938979506493, decouple_loss:0.009760535322129726
loss_pred:0.02594587951898575, decouple_loss:0.01002053264528513
The modified gen p mean: 0.44741693139076233, gen p mean: -0.7189161777496338, mean p set: 0.44789719581604004
loss_pred:0.026248499751091003, decouple_loss:0.00950990617275238
Iteration: 2082, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728925824165344, gen p mean: -0.7274689674377441, mean p set: 0.44776955246925354
The modified gen p mean: 0.4476151466369629, gen p mean: -0.7244057059288025, mean p set: 0.448095440864563
The modified gen p mean: 0.4475157856941223, gen p mean: -0.7316364049911499, mean p set: 0.4479960799217224
loss_pred:0.026093540713191032, decouple_loss:0.009739622473716736
loss_pred:0.025170350447297096, decouple_loss:0.00975035410374403
loss_pred:0.026640618219971657, decouple_loss:0.010183291509747505
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
NaN value num: 0
Iteration: 2083, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45036405324935913, gen p mean: -0.7277211546897888, mean p set: 0.4508443772792816
The modified gen p mean: 0.45010191202163696, gen p mean: -0.732617199420929, mean p set: 0.45058220624923706
The modified gen p mean: 0.4495129883289337, gen p mean: -0.7264528870582581, mean p set: 0.4499933123588562
loss_pred:0.026884211227297783, decouple_loss:0.01213717833161354
loss_pred:0.026494892314076424, decouple_loss:0.011992565356194973
loss_pred:0.02635318972170353, decouple_loss:0.012763284146785736
Iteration: 2084, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44882988929748535, gen p mean: -0.7221951484680176, mean p set: 0.44931018352508545
The modified gen p mean: 0.45019635558128357, gen p mean: -0.7345091700553894, mean p set: 0.45067667961120605
The modified gen p mean: 0.44883403182029724, gen p mean: -0.7223513126373291, mean p set: 0.44931429624557495
loss_pred:0.027448439970612526, decouple_loss:0.012211289256811142
loss_pred:0.026167241856455803, decouple_loss:0.012467898428440094
loss_pred:0.027970224618911743, decouple_loss:0.011674784123897552
Iteration: 2085, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451181560754776, gen p mean: -0.7331494092941284, mean p set: 0.4516618549823761
The modified gen p mean: 0.45033618807792664, gen p mean: -0.7203408479690552, mean p set: 0.4508165121078491
The modified gen p mean: 0.4508385956287384, gen p mean: -0.7291543483734131, mean p set: 0.4513188898563385
loss_pred:0.026727240532636642, decouple_loss:0.011995935812592506
loss_pred:0.025976775214076042, decouple_loss:0.01176344696432352
loss_pred:0.026765167713165283, decouple_loss:0.011656148359179497
Iteration: 2086, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44992145895957947, gen p mean: -0.7311495542526245, mean p set: 0.45040175318717957
The modified gen p mean: 0.4511813223361969, gen p mean: -0.7290420532226562, mean p set: 0.451661616563797
The modified gen p mean: 0.4501436948776245, gen p mean: -0.7324950098991394, mean p set: 0.4506239891052246
loss_pred:0.026235604658722878, decouple_loss:0.012004829943180084
loss_pred:0.026725701987743378, decouple_loss:0.011382212862372398
loss_pred:0.02601364627480507, decouple_loss:0.011320056393742561
Iteration: 2087, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45004984736442566, gen p mean: -0.7333876490592957, mean p set: 0.45053014159202576
The modified gen p mean: 0.450148344039917, gen p mean: -0.7290056943893433, mean p set: 0.4506286382675171
The modified gen p mean: 0.44860315322875977, gen p mean: -0.7297370433807373, mean p set: 0.44908347725868225
loss_pred:0.025857919827103615, decouple_loss:0.011509533040225506
loss_pred:0.02575354091823101, decouple_loss:0.011328062042593956
loss_pred:0.026437580585479736, decouple_loss:0.011676776222884655
Iteration: 2088, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44957005977630615, gen p mean: -0.7295094728469849, mean p set: 0.45005032420158386
The modified gen p mean: 0.44959476590156555, gen p mean: -0.7303615808486938, mean p set: 0.4500750005245209
The modified gen p mean: 0.44897353649139404, gen p mean: -0.7230907082557678, mean p set: 0.44945380091667175
loss_pred:0.026048945263028145, decouple_loss:0.011631508357822895
loss_pred:0.02661896124482155, decouple_loss:0.011298216879367828
loss_pred:0.026679599657654762, decouple_loss:0.0114508755505085
Iteration: 2089, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44935667514801025, gen p mean: -0.7229546904563904, mean p set: 0.44983693957328796
The modified gen p mean: 0.45017290115356445, gen p mean: -0.7216560244560242, mean p set: 0.4506531357765198
The modified gen p mean: 0.4502236843109131, gen p mean: -0.7312237024307251, mean p set: 0.4507039785385132
loss_pred:0.026927517727017403, decouple_loss:0.012183106504380703
loss_pred:0.026372868567705154, decouple_loss:0.011235404759645462
loss_pred:0.02617454156279564, decouple_loss:0.011142527684569359
Iteration: 2090, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44824227690696716, gen p mean: -0.7172147631645203, mean p set: 0.4487225413322449
The modified gen p mean: 0.44987753033638, gen p mean: -0.7210394740104675, mean p set: 0.4503578245639801
The modified gen p mean: 0.44997742772102356, gen p mean: -0.7163010835647583, mean p set: 0.45045775175094604
loss_pred:0.025901250541210175, decouple_loss:0.011477640829980373
loss_pred:0.027183322235941887, decouple_loss:0.01220586709678173
loss_pred:0.025665326043963432, decouple_loss:0.011450161226093769
2023-05-03 04:13:22 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7261896729469299, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7195340991020203, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7150617241859436, mean p set: 0.45035696029663086
loss_pred:0.027834534645080566, decouple_loss:0.012859860435128212
loss_pred:0.026779530569911003, decouple_loss:0.012650914490222931
loss_pred:0.026307953521609306, decouple_loss:0.01274945866316557
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02761167846620083, avg_mse: 0.032741036266088486
current test mse: 0.032741
Iteration: 2091, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44983842968940735, gen p mean: -0.7187119126319885, mean p set: 0.45031872391700745
The modified gen p mean: 0.45031073689460754, gen p mean: -0.7248710989952087, mean p set: 0.45079106092453003
loss_pred:0.02646310068666935, decouple_loss:0.011094200424849987
loss_pred:0.025651568546891212, decouple_loss:0.01138526014983654
The modified gen p mean: 0.4502759873867035, gen p mean: -0.7150556445121765, mean p set: 0.4507562518119812
loss_pred:0.026429295539855957, decouple_loss:0.011992610059678555
Iteration: 2092, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860729575157166, gen p mean: -0.7226834297180176, mean p set: 0.44908758997917175
The modified gen p mean: 0.4488689601421356, gen p mean: -0.7258380055427551, mean p set: 0.4493492543697357
The modified gen p mean: 0.45019397139549255, gen p mean: -0.7182685136795044, mean p set: 0.45067429542541504
loss_pred:0.027469119057059288, decouple_loss:0.011462613940238953
loss_pred:0.02695491537451744, decouple_loss:0.011332163587212563
loss_pred:0.02638273686170578, decouple_loss:0.011321297846734524
Iteration: 2093, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45103394985198975, gen p mean: -0.7314123511314392, mean p set: 0.45151427388191223
The modified gen p mean: 0.4498046636581421, gen p mean: -0.7230135798454285, mean p set: 0.4502848982810974
The modified gen p mean: 0.450810045003891, gen p mean: -0.7228843569755554, mean p set: 0.4512903094291687
loss_pred:0.027254503220319748, decouple_loss:0.011439871042966843
loss_pred:0.026471344754099846, decouple_loss:0.01155019924044609
loss_pred:0.027050722390413284, decouple_loss:0.011396409012377262
Iteration: 2094, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483577311038971, gen p mean: -0.7261693477630615, mean p set: 0.4488380551338196
The modified gen p mean: 0.45013922452926636, gen p mean: -0.7294020652770996, mean p set: 0.45061951875686646
The modified gen p mean: 0.44998282194137573, gen p mean: -0.7333117127418518, mean p set: 0.45046308636665344
loss_pred:0.026656674221158028, decouple_loss:0.011919965967535973
loss_pred:0.026101714000105858, decouple_loss:0.010946919210255146
loss_pred:0.025780020281672478, decouple_loss:0.012020465917885303
Iteration: 2095, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822803139686584, gen p mean: -0.7163309454917908, mean p set: 0.44870832562446594
The modified gen p mean: 0.4490130841732025, gen p mean: -0.7251860499382019, mean p set: 0.449493408203125
The modified gen p mean: 0.45056435465812683, gen p mean: -0.7351126074790955, mean p set: 0.45104461908340454
loss_pred:0.02747209370136261, decouple_loss:0.011834868229925632
loss_pred:0.026566199958324432, decouple_loss:0.011314802803099155
loss_pred:0.02640625089406967, decouple_loss:0.011524198576807976
Iteration: 2096, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488946199417114, gen p mean: -0.7259694337844849, mean p set: 0.44937488436698914
The modified gen p mean: 0.4499850869178772, gen p mean: -0.7240245938301086, mean p set: 0.4504653811454773
The modified gen p mean: 0.4509267508983612, gen p mean: -0.7294036746025085, mean p set: 0.4514070451259613
loss_pred:0.026324208825826645, decouple_loss:0.011464769951999187
loss_pred:0.025579823181033134, decouple_loss:0.011081613600254059
loss_pred:0.026822632178664207, decouple_loss:0.01209191232919693
Iteration: 2097, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501136541366577, gen p mean: -0.7124571204185486, mean p set: 0.4505939483642578
The modified gen p mean: 0.44861555099487305, gen p mean: -0.7172254920005798, mean p set: 0.44909584522247314
The modified gen p mean: 0.44940176606178284, gen p mean: -0.7248453497886658, mean p set: 0.4498820900917053
loss_pred:0.026317737996578217, decouple_loss:0.011445651762187481
loss_pred:0.025998122990131378, decouple_loss:0.01094076782464981
loss_pred:0.025558067485690117, decouple_loss:0.01103848684579134
Iteration: 2098, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44986429810523987, gen p mean: -0.7255710363388062, mean p set: 0.4503445625305176
The modified gen p mean: 0.4485201835632324, gen p mean: -0.7193387150764465, mean p set: 0.4490005075931549
The modified gen p mean: 0.4488926827907562, gen p mean: -0.7200822234153748, mean p set: 0.44937294721603394
loss_pred:0.026502026244997978, decouple_loss:0.01110166311264038
loss_pred:0.02615661360323429, decouple_loss:0.011315552517771721
loss_pred:0.025118205696344376, decouple_loss:0.010652239434421062
Iteration: 2099, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507595896720886, gen p mean: -0.726920485496521, mean p set: 0.4512398838996887
The modified gen p mean: 0.44985517859458923, gen p mean: -0.729577898979187, mean p set: 0.45033547282218933
The modified gen p mean: 0.45051079988479614, gen p mean: -0.7255014777183533, mean p set: 0.45099109411239624
loss_pred:0.027096694335341454, decouple_loss:0.011378223076462746
loss_pred:0.026373783126473427, decouple_loss:0.011705555953085423
loss_pred:0.02601928450167179, decouple_loss:0.011050032451748848
Iteration: 2100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485991299152374, gen p mean: -0.7228752970695496, mean p set: 0.4490794241428375
The modified gen p mean: 0.45127686858177185, gen p mean: -0.7225962281227112, mean p set: 0.45175716280937195
The modified gen p mean: 0.44945964217185974, gen p mean: -0.7206190824508667, mean p set: 0.44993993639945984
loss_pred:0.02628794126212597, decouple_loss:0.010984539054334164
loss_pred:0.026556655764579773, decouple_loss:0.011136994697153568
loss_pred:0.026540478691458702, decouple_loss:0.010744571685791016
2023-05-03 04:17:02 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.730363130569458, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7373175621032715, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7259324789047241, mean p set: 0.45035696029663086
loss_pred:0.02681076154112816, decouple_loss:0.012187663465738297
loss_pred:0.02793208137154579, decouple_loss:0.0124091487377882
loss_pred:0.02647710032761097, decouple_loss:0.012098794803023338
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027684908360242844, avg_mse: 0.03287390619516373
current test mse: 0.032874
Iteration: 2101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482896029949188, gen p mean: -0.7283088564872742, mean p set: 0.4487698972225189
The modified gen p mean: 0.4509466290473938, gen p mean: -0.7308392524719238, mean p set: 0.4514269232749939
loss_pred:0.027111588045954704, decouple_loss:0.011710614897310734
loss_pred:0.02642706409096718, decouple_loss:0.011045895516872406
The modified gen p mean: 0.4504992961883545, gen p mean: -0.7357178330421448, mean p set: 0.4509795904159546
loss_pred:0.026136668398976326, decouple_loss:0.010968264192342758
Iteration: 2102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45033571124076843, gen p mean: -0.7363315224647522, mean p set: 0.45081597566604614
The modified gen p mean: 0.4508129358291626, gen p mean: -0.7395366430282593, mean p set: 0.4512932300567627
The modified gen p mean: 0.45016372203826904, gen p mean: -0.7421125769615173, mean p set: 0.45064401626586914
loss_pred:0.025513987988233566, decouple_loss:0.011141790077090263
loss_pred:0.02550426684319973, decouple_loss:0.010946492664515972
loss_pred:0.02591528557240963, decouple_loss:0.011467854492366314
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
NaN value num: 0
Iteration: 2103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479115903377533, gen p mean: -0.7382241487503052, mean p set: 0.448391854763031
The modified gen p mean: 0.4469698369503021, gen p mean: -0.7375908493995667, mean p set: 0.44745010137557983
The modified gen p mean: 0.44806918501853943, gen p mean: -0.737908124923706, mean p set: 0.4485495090484619
loss_pred:0.030097326263785362, decouple_loss:0.011963431723415852
loss_pred:0.029906386509537697, decouple_loss:0.012493515387177467
loss_pred:0.028854817152023315, decouple_loss:0.01200917735695839
Iteration: 2104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465983808040619, gen p mean: -0.7319210767745972, mean p set: 0.4470786452293396
The modified gen p mean: 0.4499262869358063, gen p mean: -0.7445212006568909, mean p set: 0.45040658116340637
The modified gen p mean: 0.44722700119018555, gen p mean: -0.7318019866943359, mean p set: 0.44770732522010803
loss_pred:0.02828698232769966, decouple_loss:0.011950250715017319
loss_pred:0.027797803282737732, decouple_loss:0.012760013341903687
loss_pred:0.026900531724095345, decouple_loss:0.012185555882751942
Iteration: 2105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44706299901008606, gen p mean: -0.7228121161460876, mean p set: 0.44754326343536377
The modified gen p mean: 0.4474947154521942, gen p mean: -0.725125789642334, mean p set: 0.4479750096797943
The modified gen p mean: 0.4469059705734253, gen p mean: -0.7272074222564697, mean p set: 0.447386234998703
loss_pred:0.027672678232192993, decouple_loss:0.01205485314130783
loss_pred:0.0287487655878067, decouple_loss:0.012063567526638508
loss_pred:0.027152452617883682, decouple_loss:0.012323308736085892
Iteration: 2106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446316123008728, gen p mean: -0.7245894074440002, mean p set: 0.4467964172363281
The modified gen p mean: 0.44738319516181946, gen p mean: -0.7382615804672241, mean p set: 0.44786348938941956
The modified gen p mean: 0.44763433933258057, gen p mean: -0.7264901399612427, mean p set: 0.44811463356018066
loss_pred:0.027565717697143555, decouple_loss:0.011678569950163364
loss_pred:0.027736306190490723, decouple_loss:0.011935624293982983
loss_pred:0.02922580949962139, decouple_loss:0.011567949317395687
Iteration: 2107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463266134262085, gen p mean: -0.7400183081626892, mean p set: 0.4468069076538086
The modified gen p mean: 0.44746389985084534, gen p mean: -0.7427406907081604, mean p set: 0.4479442238807678
The modified gen p mean: 0.4462946653366089, gen p mean: -0.7363204956054688, mean p set: 0.446774959564209
loss_pred:0.026484224945306778, decouple_loss:0.011370810680091381
loss_pred:0.02686159685254097, decouple_loss:0.011409485712647438
loss_pred:0.027738438919186592, decouple_loss:0.011251128278672695
Iteration: 2108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475124478340149, gen p mean: -0.7461005449295044, mean p set: 0.447992742061615
The modified gen p mean: 0.4465072751045227, gen p mean: -0.7364820837974548, mean p set: 0.4469875395298004
The modified gen p mean: 0.4472706615924835, gen p mean: -0.7502173185348511, mean p set: 0.4477509558200836
loss_pred:0.028946856036782265, decouple_loss:0.011685388162732124
loss_pred:0.027590859681367874, decouple_loss:0.011237550526857376
loss_pred:0.0298114363104105, decouple_loss:0.011428632773458958
Iteration: 2109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479468762874603, gen p mean: -0.7460370063781738, mean p set: 0.4484272003173828
The modified gen p mean: 0.44697925448417664, gen p mean: -0.748184084892273, mean p set: 0.4474595785140991
The modified gen p mean: 0.4477812349796295, gen p mean: -0.7403866052627563, mean p set: 0.4482615292072296
loss_pred:0.028943035751581192, decouple_loss:0.011666001752018929
loss_pred:0.02586265839636326, decouple_loss:0.01138598658144474
loss_pred:0.027739640325307846, decouple_loss:0.010868445970118046
Iteration: 2110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771096110343933, gen p mean: -0.7449199557304382, mean p set: 0.44819125533103943
The modified gen p mean: 0.4466245174407959, gen p mean: -0.7407804131507874, mean p set: 0.447104811668396
The modified gen p mean: 0.448029100894928, gen p mean: -0.739639937877655, mean p set: 0.4485093653202057
loss_pred:0.02598198875784874, decouple_loss:0.011493652127683163
loss_pred:0.026787783950567245, decouple_loss:0.01119349617511034
loss_pred:0.02901340089738369, decouple_loss:0.011236379854381084
2023-05-03 04:21:22 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7272775173187256, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7344255447387695, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.722830057144165, mean p set: 0.45035696029663086
loss_pred:0.026574769988656044, decouple_loss:0.011723007075488567
loss_pred:0.027488896623253822, decouple_loss:0.011984025128185749
loss_pred:0.026204001158475876, decouple_loss:0.011726324446499348
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027346445247530937, avg_mse: 0.032350391149520874
current test mse: 0.03235
Iteration: 2111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768568873405457, gen p mean: -0.727885365486145, mean p set: 0.44816598296165466
The modified gen p mean: 0.44698894023895264, gen p mean: -0.728069543838501, mean p set: 0.4474692642688751
loss_pred:0.028667166829109192, decouple_loss:0.010714881122112274
loss_pred:0.02875687927007675, decouple_loss:0.011455333791673183
The modified gen p mean: 0.4474125802516937, gen p mean: -0.7270106673240662, mean p set: 0.4478928744792938
loss_pred:0.028344538062810898, decouple_loss:0.01107908133417368
Iteration: 2112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476429224014282, gen p mean: -0.7355527281761169, mean p set: 0.4481232166290283
The modified gen p mean: 0.44730210304260254, gen p mean: -0.7312501072883606, mean p set: 0.44778236746788025
The modified gen p mean: 0.4468787908554077, gen p mean: -0.7363490462303162, mean p set: 0.4473590552806854
loss_pred:0.026432670652866364, decouple_loss:0.011235023848712444
loss_pred:0.027855901047587395, decouple_loss:0.011050350032746792
loss_pred:0.026908008381724358, decouple_loss:0.011356026865541935
Iteration: 2113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793370366096497, gen p mean: -0.7314797639846802, mean p set: 0.44841399788856506
The modified gen p mean: 0.44926369190216064, gen p mean: -0.7400782704353333, mean p set: 0.44974398612976074
The modified gen p mean: 0.4468501806259155, gen p mean: -0.727838933467865, mean p set: 0.4473304748535156
loss_pred:0.028221407905220985, decouple_loss:0.011318480595946312
loss_pred:0.027332868427038193, decouple_loss:0.012598774395883083
loss_pred:0.02760482206940651, decouple_loss:0.011193954385817051
Iteration: 2114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495382308959961, gen p mean: -0.7396846413612366, mean p set: 0.4500185549259186
The modified gen p mean: 0.44860216975212097, gen p mean: -0.7347010374069214, mean p set: 0.44908249378204346
The modified gen p mean: 0.44757428765296936, gen p mean: -0.7324879765510559, mean p set: 0.44805458188056946
loss_pred:0.027367040514945984, decouple_loss:0.011825324036180973
loss_pred:0.027410494163632393, decouple_loss:0.01215476356446743
loss_pred:0.02611883170902729, decouple_loss:0.010445677675306797
Iteration: 2115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478965699672699, gen p mean: -0.7231564521789551, mean p set: 0.44837686419487
The modified gen p mean: 0.4479251205921173, gen p mean: -0.7240985631942749, mean p set: 0.4484054148197174
The modified gen p mean: 0.44795939326286316, gen p mean: -0.7215260863304138, mean p set: 0.44843971729278564
loss_pred:0.028505396097898483, decouple_loss:0.010950403288006783
loss_pred:0.028409937396645546, decouple_loss:0.011029347777366638
loss_pred:0.027725983411073685, decouple_loss:0.011003524996340275
Iteration: 2116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44634950160980225, gen p mean: -0.7272476553916931, mean p set: 0.44682982563972473
The modified gen p mean: 0.4478977918624878, gen p mean: -0.7270210385322571, mean p set: 0.4483780562877655
The modified gen p mean: 0.44859179854393005, gen p mean: -0.7277100682258606, mean p set: 0.44907209277153015
loss_pred:0.02617095224559307, decouple_loss:0.010984635911881924
loss_pred:0.026799099519848824, decouple_loss:0.011574874632060528
loss_pred:0.027795733883976936, decouple_loss:0.01100990455597639
Iteration: 2117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44866013526916504, gen p mean: -0.7329780459403992, mean p set: 0.44914042949676514
The modified gen p mean: 0.4468751847743988, gen p mean: -0.7319802641868591, mean p set: 0.4473554790019989
The modified gen p mean: 0.4468447268009186, gen p mean: -0.7326317429542542, mean p set: 0.44732505083084106
loss_pred:0.028276538476347923, decouple_loss:0.010429449379444122
loss_pred:0.026004424318671227, decouple_loss:0.010897106491029263
loss_pred:0.027434051036834717, decouple_loss:0.01100415363907814
Iteration: 2118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469502866268158, gen p mean: -0.7225788831710815, mean p set: 0.4474305510520935
The modified gen p mean: 0.44886574149131775, gen p mean: -0.7324991822242737, mean p set: 0.44934606552124023
The modified gen p mean: 0.44776150584220886, gen p mean: -0.7308341264724731, mean p set: 0.4482417702674866
loss_pred:0.027136478573083878, decouple_loss:0.011020181700587273
loss_pred:0.02819402515888214, decouple_loss:0.011197512969374657
loss_pred:0.02755400352180004, decouple_loss:0.01099673192948103
Iteration: 2119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447808176279068, gen p mean: -0.7364291548728943, mean p set: 0.4482884109020233
The modified gen p mean: 0.44669780135154724, gen p mean: -0.729766309261322, mean p set: 0.44717806577682495
The modified gen p mean: 0.4490974545478821, gen p mean: -0.7370184063911438, mean p set: 0.4495777189731598
loss_pred:0.026625672355294228, decouple_loss:0.010926793329417706
loss_pred:0.027840005233883858, decouple_loss:0.01042952947318554
loss_pred:0.028281573206186295, decouple_loss:0.010998701676726341
Iteration: 2120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862693548202515, gen p mean: -0.7466099858283997, mean p set: 0.44910722970962524
The modified gen p mean: 0.4465520977973938, gen p mean: -0.73145991563797, mean p set: 0.4470323920249939
The modified gen p mean: 0.44763636589050293, gen p mean: -0.7310487031936646, mean p set: 0.448116660118103
loss_pred:0.026906227692961693, decouple_loss:0.010847686789929867
loss_pred:0.027439938858151436, decouple_loss:0.010707832872867584
loss_pred:0.028416238725185394, decouple_loss:0.010903087444603443
2023-05-03 04:25:06 testing...
The modified gen p mean: 0.4495830237865448, gen p mean: -0.7352306246757507, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7421244978904724, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7307039499282837, mean p set: 0.45035696029663086
loss_pred:0.0265749990940094, decouple_loss:0.011198597960174084
loss_pred:0.027546556666493416, decouple_loss:0.011417826637625694
loss_pred:0.026146724820137024, decouple_loss:0.011320692487061024
WV_0_PC_1_EH_0_PS_40_6, loss: 0.0273217111825943, avg_mse: 0.03241175413131714
current test mse: 0.032412
Iteration: 2121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797375798225403, gen p mean: -0.7377527952194214, mean p set: 0.4484540522098541
The modified gen p mean: 0.44695374369621277, gen p mean: -0.7391058802604675, mean p set: 0.44743403792381287
loss_pred:0.026873409748077393, decouple_loss:0.010612991638481617
loss_pred:0.02887839637696743, decouple_loss:0.010750273242592812
The modified gen p mean: 0.44677734375, gen p mean: -0.7345712184906006, mean p set: 0.4472576081752777
loss_pred:0.026555202901363373, decouple_loss:0.010534065775573254
Iteration: 2122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485020637512207, gen p mean: -0.7353518009185791, mean p set: 0.4489823877811432
The modified gen p mean: 0.44661229848861694, gen p mean: -0.7304485440254211, mean p set: 0.44709256291389465
The modified gen p mean: 0.4475911557674408, gen p mean: -0.7328070402145386, mean p set: 0.4480714499950409
loss_pred:0.02723868563771248, decouple_loss:0.010538275353610516
loss_pred:0.02729206345975399, decouple_loss:0.010442659258842468
loss_pred:0.02737477794289589, decouple_loss:0.010634290054440498
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
NaN value num: 0
Iteration: 2123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44580334424972534, gen p mean: -0.7423848509788513, mean p set: 0.44628363847732544
The modified gen p mean: 0.44686856865882874, gen p mean: -0.7345956563949585, mean p set: 0.44734886288642883
The modified gen p mean: 0.4475669860839844, gen p mean: -0.7367039918899536, mean p set: 0.4480472505092621
loss_pred:0.027907634153962135, decouple_loss:0.01155128888785839
loss_pred:0.02789243310689926, decouple_loss:0.011917313560843468
loss_pred:0.027737542986869812, decouple_loss:0.011213972233235836
Iteration: 2124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786545634269714, gen p mean: -0.7541840672492981, mean p set: 0.44834578037261963
The modified gen p mean: 0.44656434655189514, gen p mean: -0.7527934908866882, mean p set: 0.44704464077949524
The modified gen p mean: 0.44796591997146606, gen p mean: -0.7500752806663513, mean p set: 0.44844627380371094
loss_pred:0.027443809434771538, decouple_loss:0.011387214995920658
loss_pred:0.026998095214366913, decouple_loss:0.010874394327402115
loss_pred:0.02782777138054371, decouple_loss:0.011328417807817459
Iteration: 2125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464051425457001, gen p mean: -0.7497043013572693, mean p set: 0.44688549637794495
The modified gen p mean: 0.44708743691444397, gen p mean: -0.7539864182472229, mean p set: 0.44756776094436646
The modified gen p mean: 0.4477560818195343, gen p mean: -0.7683875560760498, mean p set: 0.4482364058494568
loss_pred:0.029631847515702248, decouple_loss:0.010890648700296879
loss_pred:0.02774972841143608, decouple_loss:0.010977467522025108
loss_pred:0.027433788403868675, decouple_loss:0.011675519868731499
Iteration: 2126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856974482536316, gen p mean: -0.751839816570282, mean p set: 0.44905006885528564
The modified gen p mean: 0.44664111733436584, gen p mean: -0.7525144815444946, mean p set: 0.44712138175964355
The modified gen p mean: 0.4484080970287323, gen p mean: -0.7658036947250366, mean p set: 0.4488883912563324
loss_pred:0.02737131342291832, decouple_loss:0.010901455767452717
loss_pred:0.028485767543315887, decouple_loss:0.011186187155544758
loss_pred:0.02780137211084366, decouple_loss:0.011630072258412838
Iteration: 2127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465080201625824, gen p mean: -0.747694194316864, mean p set: 0.4469883143901825
The modified gen p mean: 0.44652819633483887, gen p mean: -0.7472321391105652, mean p set: 0.44700849056243896
The modified gen p mean: 0.44827449321746826, gen p mean: -0.7479676604270935, mean p set: 0.44875475764274597
loss_pred:0.02778741344809532, decouple_loss:0.010350853204727173
loss_pred:0.02788395620882511, decouple_loss:0.01092030480504036
loss_pred:0.027622947469353676, decouple_loss:0.010786316357553005
Iteration: 2128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44571542739868164, gen p mean: -0.7469844818115234, mean p set: 0.4461957514286041
The modified gen p mean: 0.4469072222709656, gen p mean: -0.7433721423149109, mean p set: 0.4473875164985657
The modified gen p mean: 0.4482972025871277, gen p mean: -0.7408499717712402, mean p set: 0.4487774670124054
loss_pred:0.027268072590231895, decouple_loss:0.010875490494072437
loss_pred:0.028727712109684944, decouple_loss:0.010574051178991795
loss_pred:0.0267953984439373, decouple_loss:0.010523301549255848
Iteration: 2129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475644826889038, gen p mean: -0.7413420677185059, mean p set: 0.4480447769165039
The modified gen p mean: 0.44672462344169617, gen p mean: -0.7453691959381104, mean p set: 0.44720491766929626
The modified gen p mean: 0.4474196135997772, gen p mean: -0.7441509366035461, mean p set: 0.4478999078273773
loss_pred:0.027220023795962334, decouple_loss:0.010966191999614239
loss_pred:0.028471125289797783, decouple_loss:0.010515743866562843
loss_pred:0.028371285647153854, decouple_loss:0.010537100955843925
Iteration: 2130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800689816474915, gen p mean: -0.747456967830658, mean p set: 0.44848722219467163
The modified gen p mean: 0.44688674807548523, gen p mean: -0.744640588760376, mean p set: 0.44736701250076294
The modified gen p mean: 0.446500301361084, gen p mean: -0.7435804605484009, mean p set: 0.44698062539100647
loss_pred:0.02693270705640316, decouple_loss:0.010674314573407173
loss_pred:0.028116146102547646, decouple_loss:0.010454329662024975
loss_pred:0.028136713430285454, decouple_loss:0.010659824125468731
2023-05-03 04:29:31 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7431508302688599, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7503490447998047, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7387705445289612, mean p set: 0.45035696029663086
loss_pred:0.02665819227695465, decouple_loss:0.011070900596678257
loss_pred:0.02761934883892536, decouple_loss:0.011431052349507809
loss_pred:0.02618016116321087, decouple_loss:0.011292537674307823
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02738247625529766, avg_mse: 0.032523900270462036
current test mse: 0.032524
Iteration: 2131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741904735565186, gen p mean: -0.7418437600135803, mean p set: 0.44789931178092957
loss_pred:0.02720441110432148, decouple_loss:0.010439575649797916
The modified gen p mean: 0.44762352108955383, gen p mean: -0.7428970336914062, mean p set: 0.44810381531715393
loss_pred:0.028265606611967087, decouple_loss:0.010184535756707191
The modified gen p mean: 0.4488506019115448, gen p mean: -0.7598798871040344, mean p set: 0.4493309259414673
loss_pred:0.027233602479100227, decouple_loss:0.011590140871703625
Iteration: 2132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732263684272766, gen p mean: -0.7485803961753845, mean p set: 0.44780290126800537
The modified gen p mean: 0.4468706548213959, gen p mean: -0.7426549792289734, mean p set: 0.4473509192466736
The modified gen p mean: 0.4460969567298889, gen p mean: -0.7405664920806885, mean p set: 0.446577250957489
loss_pred:0.028249409049749374, decouple_loss:0.01030966080725193
loss_pred:0.02833470143377781, decouple_loss:0.0101265674456954
loss_pred:0.027390364557504654, decouple_loss:0.01060546189546585
Iteration: 2133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661030173301697, gen p mean: -0.7484530806541443, mean p set: 0.4470905661582947
The modified gen p mean: 0.4486321806907654, gen p mean: -0.7474007606506348, mean p set: 0.4491124749183655
The modified gen p mean: 0.4471374452114105, gen p mean: -0.7430132627487183, mean p set: 0.4476177394390106
loss_pred:0.02798103541135788, decouple_loss:0.010384080931544304
loss_pred:0.027316149324178696, decouple_loss:0.010427545756101608
loss_pred:0.027537493035197258, decouple_loss:0.010329405777156353
Iteration: 2134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470256268978119, gen p mean: -0.7445756196975708, mean p set: 0.4475059509277344
The modified gen p mean: 0.4494776129722595, gen p mean: -0.7503809332847595, mean p set: 0.449957937002182
The modified gen p mean: 0.44708481431007385, gen p mean: -0.7551472187042236, mean p set: 0.44756510853767395
loss_pred:0.027953868731856346, decouple_loss:0.0101435836404562
loss_pred:0.0269670020788908, decouple_loss:0.010880379006266594
loss_pred:0.0268278606235981, decouple_loss:0.010645505040884018
Iteration: 2135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481431543827057, gen p mean: -0.7432121634483337, mean p set: 0.4486234486103058
The modified gen p mean: 0.4462997615337372, gen p mean: -0.7433806657791138, mean p set: 0.4467800557613373
The modified gen p mean: 0.4491763710975647, gen p mean: -0.7459187507629395, mean p set: 0.4496566355228424
loss_pred:0.028221817687153816, decouple_loss:0.009937906637787819
loss_pred:0.02742229774594307, decouple_loss:0.010591547004878521
loss_pred:0.028129804879426956, decouple_loss:0.009944922290742397
Iteration: 2136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480510652065277, gen p mean: -0.7428810000419617, mean p set: 0.4485313296318054
The modified gen p mean: 0.4470927119255066, gen p mean: -0.734378457069397, mean p set: 0.4475730061531067
The modified gen p mean: 0.4485849440097809, gen p mean: -0.7552152872085571, mean p set: 0.449065238237381
loss_pred:0.02693285420536995, decouple_loss:0.010405476205050945
loss_pred:0.027403060346841812, decouple_loss:0.010357212275266647
loss_pred:0.02766389213502407, decouple_loss:0.011014006100594997
Iteration: 2137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471818208694458, gen p mean: -0.738757848739624, mean p set: 0.4476620852947235
The modified gen p mean: 0.4492040276527405, gen p mean: -0.7388681769371033, mean p set: 0.4496842920780182
The modified gen p mean: 0.4472569227218628, gen p mean: -0.7459995150566101, mean p set: 0.4477372169494629
loss_pred:0.02754891663789749, decouple_loss:0.010018309578299522
loss_pred:0.026745246723294258, decouple_loss:0.010157971642911434
loss_pred:0.027835743501782417, decouple_loss:0.00991098489612341
Iteration: 2138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769012928009033, gen p mean: -0.737204372882843, mean p set: 0.44817039370536804
The modified gen p mean: 0.44779491424560547, gen p mean: -0.7383444309234619, mean p set: 0.44827520847320557
The modified gen p mean: 0.4474089741706848, gen p mean: -0.7346239686012268, mean p set: 0.4478892683982849
loss_pred:0.02690943144261837, decouple_loss:0.010441651567816734
loss_pred:0.028157444670796394, decouple_loss:0.010026897303760052
loss_pred:0.027133818715810776, decouple_loss:0.010117817670106888
Iteration: 2139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475695490837097, gen p mean: -0.7317171096801758, mean p set: 0.4480498135089874
The modified gen p mean: 0.44842782616615295, gen p mean: -0.7364314198493958, mean p set: 0.44890812039375305
The modified gen p mean: 0.4472668766975403, gen p mean: -0.747871458530426, mean p set: 0.447747141122818
loss_pred:0.02796405740082264, decouple_loss:0.009679755195975304
loss_pred:0.026526421308517456, decouple_loss:0.010222907178103924
loss_pred:0.02704293467104435, decouple_loss:0.010555962100625038
Iteration: 2140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678249955177307, gen p mean: -0.7325747609138489, mean p set: 0.44726279377937317
The modified gen p mean: 0.4465142488479614, gen p mean: -0.7382833957672119, mean p set: 0.4469945430755615
The modified gen p mean: 0.44692352414131165, gen p mean: -0.739730954170227, mean p set: 0.44740378856658936
loss_pred:0.028648650273680687, decouple_loss:0.009597494266927242
loss_pred:0.027763597667217255, decouple_loss:0.01041268277913332
loss_pred:0.027446983382105827, decouple_loss:0.010096472688019276
2023-05-03 04:33:15 testing...
The modified gen p mean: 0.4495830237865448, gen p mean: -0.7345269918441772, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.742102324962616, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7301574349403381, mean p set: 0.45035696029663086
loss_pred:0.026510152965784073, decouple_loss:0.01050889864563942
loss_pred:0.027469050139188766, decouple_loss:0.01076451689004898
loss_pred:0.026083266362547874, decouple_loss:0.01072314940392971
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027220766991376877, avg_mse: 0.032399509102106094
current test mse: 0.0324
Iteration: 2141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476662278175354, gen p mean: -0.7347477078437805, mean p set: 0.4481465220451355
loss_pred:0.027189230546355247, decouple_loss:0.010007180273532867
The modified gen p mean: 0.45010483264923096, gen p mean: -0.7425907254219055, mean p set: 0.45058512687683105
loss_pred:0.02711513638496399, decouple_loss:0.009922177530825138
The modified gen p mean: 0.44827577471733093, gen p mean: -0.7347031831741333, mean p set: 0.44875606894493103
loss_pred:0.026845838874578476, decouple_loss:0.010084539651870728
Iteration: 2142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448119193315506, gen p mean: -0.7573761343955994, mean p set: 0.4485994875431061
The modified gen p mean: 0.4473632276058197, gen p mean: -0.740416944026947, mean p set: 0.4478435218334198
The modified gen p mean: 0.44676363468170166, gen p mean: -0.744492769241333, mean p set: 0.44724392890930176
loss_pred:0.027305075898766518, decouple_loss:0.010675654746592045
loss_pred:0.027640819549560547, decouple_loss:0.009826427325606346
loss_pred:0.027995280921459198, decouple_loss:0.009441998787224293
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
NaN value num: 0
Iteration: 2143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45108649134635925, gen p mean: -0.735420286655426, mean p set: 0.45156678557395935
The modified gen p mean: 0.45225897431373596, gen p mean: -0.7445015907287598, mean p set: 0.45273926854133606
The modified gen p mean: 0.45232123136520386, gen p mean: -0.7306954264640808, mean p set: 0.45280152559280396
loss_pred:0.026460595428943634, decouple_loss:0.011413582600653172
loss_pred:0.027427781373262405, decouple_loss:0.011204402893781662
loss_pred:0.02753540873527527, decouple_loss:0.010996985249221325
Iteration: 2144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453336626291275, gen p mean: -0.7396485209465027, mean p set: 0.4538169205188751
The modified gen p mean: 0.45283907651901245, gen p mean: -0.7402205467224121, mean p set: 0.45331934094429016
The modified gen p mean: 0.4539492726325989, gen p mean: -0.7364327907562256, mean p set: 0.454429566860199
loss_pred:0.025681274011731148, decouple_loss:0.011431108228862286
loss_pred:0.027005856856703758, decouple_loss:0.011611729860305786
loss_pred:0.027025286108255386, decouple_loss:0.011776508763432503
Iteration: 2145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4543944001197815, gen p mean: -0.7290288209915161, mean p set: 0.4548746943473816
The modified gen p mean: 0.4536791741847992, gen p mean: -0.7303488254547119, mean p set: 0.4541594386100769
The modified gen p mean: 0.4531635046005249, gen p mean: -0.7261977195739746, mean p set: 0.4536438286304474
loss_pred:0.027074960991740227, decouple_loss:0.011262252926826477
loss_pred:0.02670757845044136, decouple_loss:0.011378987692296505
loss_pred:0.027438923716545105, decouple_loss:0.011971398256719112
Iteration: 2146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519352316856384, gen p mean: -0.7376501560211182, mean p set: 0.4524155259132385
The modified gen p mean: 0.45258578658103943, gen p mean: -0.7448777556419373, mean p set: 0.4530661106109619
The modified gen p mean: 0.45224201679229736, gen p mean: -0.740093469619751, mean p set: 0.45272231101989746
loss_pred:0.026727233082056046, decouple_loss:0.011233546771109104
loss_pred:0.02626805566251278, decouple_loss:0.010811340063810349
loss_pred:0.02601691521704197, decouple_loss:0.01069252472370863
Iteration: 2147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45178577303886414, gen p mean: -0.7342808842658997, mean p set: 0.4522660970687866
The modified gen p mean: 0.4526750147342682, gen p mean: -0.7364094853401184, mean p set: 0.4531553387641907
The modified gen p mean: 0.45171183347702026, gen p mean: -0.7429845929145813, mean p set: 0.45219212770462036
loss_pred:0.028026210144162178, decouple_loss:0.011448606848716736
loss_pred:0.026603780686855316, decouple_loss:0.01083743292838335
loss_pred:0.026376986876130104, decouple_loss:0.010782716795802116
Iteration: 2148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45203307271003723, gen p mean: -0.7373875379562378, mean p set: 0.45251336693763733
The modified gen p mean: 0.4536444842815399, gen p mean: -0.7375227808952332, mean p set: 0.45412477850914
The modified gen p mean: 0.4515564441680908, gen p mean: -0.7309104800224304, mean p set: 0.45203670859336853
loss_pred:0.027837252244353294, decouple_loss:0.01112908311188221
loss_pred:0.02686614729464054, decouple_loss:0.01130649819970131
loss_pred:0.027363233268260956, decouple_loss:0.011017928831279278
Iteration: 2149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526388645172119, gen p mean: -0.7397511005401611, mean p set: 0.453119158744812
The modified gen p mean: 0.45258262753486633, gen p mean: -0.7433868050575256, mean p set: 0.45306292176246643
The modified gen p mean: 0.45458200573921204, gen p mean: -0.7328134775161743, mean p set: 0.45506227016448975
loss_pred:0.02723243460059166, decouple_loss:0.011491171084344387
loss_pred:0.02725401148200035, decouple_loss:0.011494187638163567
loss_pred:0.02682858519256115, decouple_loss:0.010897853411734104
Iteration: 2150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45329633355140686, gen p mean: -0.7444477081298828, mean p set: 0.45377665758132935
The modified gen p mean: 0.45436638593673706, gen p mean: -0.7367372512817383, mean p set: 0.45484670996665955
The modified gen p mean: 0.45474690198898315, gen p mean: -0.7342128753662109, mean p set: 0.45522719621658325
loss_pred:0.02609904482960701, decouple_loss:0.011285322718322277
loss_pred:0.026580769568681717, decouple_loss:0.011349024251103401
loss_pred:0.027238896116614342, decouple_loss:0.010670602321624756
2023-05-03 04:37:34 testing...
The modified gen p mean: 0.4495830237865448, gen p mean: -0.7340395450592041, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7415841221809387, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7290957570075989, mean p set: 0.45035696029663086
loss_pred:0.02677510306239128, decouple_loss:0.011982287280261517
loss_pred:0.027876414358615875, decouple_loss:0.012266027741134167
loss_pred:0.02626851573586464, decouple_loss:0.012134448625147343
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02757972478866577, avg_mse: 0.03287813067436218
current test mse: 0.032878
Iteration: 2151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45250242948532104, gen p mean: -0.7267671823501587, mean p set: 0.45298275351524353
loss_pred:0.027486031875014305, decouple_loss:0.011483866721391678
The modified gen p mean: 0.4538276195526123, gen p mean: -0.7342843413352966, mean p set: 0.4543079137802124
loss_pred:0.026968400925397873, decouple_loss:0.011217099614441395
The modified gen p mean: 0.4527120292186737, gen p mean: -0.7372518181800842, mean p set: 0.4531923532485962
loss_pred:0.026277557015419006, decouple_loss:0.01126943714916706
Iteration: 2152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45110735297203064, gen p mean: -0.729134738445282, mean p set: 0.45158764719963074
The modified gen p mean: 0.4519207775592804, gen p mean: -0.7265979647636414, mean p set: 0.4524010717868805
The modified gen p mean: 0.45176437497138977, gen p mean: -0.7290364503860474, mean p set: 0.4522446393966675
loss_pred:0.027392704039812088, decouple_loss:0.010859630070626736
loss_pred:0.027454832568764687, decouple_loss:0.011249389499425888
loss_pred:0.02760416455566883, decouple_loss:0.011200441047549248
Iteration: 2153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515621066093445, gen p mean: -0.7307785153388977, mean p set: 0.4520424008369446
The modified gen p mean: 0.45314478874206543, gen p mean: -0.7344950437545776, mean p set: 0.45362505316734314
The modified gen p mean: 0.45166417956352234, gen p mean: -0.7364650368690491, mean p set: 0.45214447379112244
loss_pred:0.027552127838134766, decouple_loss:0.0112869031727314
loss_pred:0.027562903240323067, decouple_loss:0.010796740651130676
loss_pred:0.027485646307468414, decouple_loss:0.010877370834350586
Iteration: 2154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509492516517639, gen p mean: -0.7408106923103333, mean p set: 0.4514295160770416
The modified gen p mean: 0.45128047466278076, gen p mean: -0.7488549947738647, mean p set: 0.45176076889038086
The modified gen p mean: 0.45303648710250854, gen p mean: -0.7444543242454529, mean p set: 0.45351678133010864
loss_pred:0.026654012501239777, decouple_loss:0.011362324468791485
loss_pred:0.024811789393424988, decouple_loss:0.010844324715435505
loss_pred:0.02669925056397915, decouple_loss:0.011077946051955223
Iteration: 2155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503503441810608, gen p mean: -0.740145742893219, mean p set: 0.4508306682109833
The modified gen p mean: 0.45200395584106445, gen p mean: -0.7462894916534424, mean p set: 0.45248425006866455
The modified gen p mean: 0.4533623158931732, gen p mean: -0.746126115322113, mean p set: 0.4538425803184509
loss_pred:0.026988066732883453, decouple_loss:0.010802045464515686
loss_pred:0.02682049199938774, decouple_loss:0.011022246442735195
loss_pred:0.02775597758591175, decouple_loss:0.010701842606067657
Iteration: 2156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518929421901703, gen p mean: -0.7323170900344849, mean p set: 0.4523732364177704
The modified gen p mean: 0.45290395617485046, gen p mean: -0.7403081059455872, mean p set: 0.4533842206001282
The modified gen p mean: 0.45369771122932434, gen p mean: -0.74446040391922, mean p set: 0.45417800545692444
loss_pred:0.027684876695275307, decouple_loss:0.011429606936872005
loss_pred:0.027485355734825134, decouple_loss:0.011735356412827969
loss_pred:0.02665708400309086, decouple_loss:0.011605974286794662
Iteration: 2157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530549943447113, gen p mean: -0.7451311945915222, mean p set: 0.4535352885723114
The modified gen p mean: 0.45173004269599915, gen p mean: -0.7428030371665955, mean p set: 0.45221033692359924
The modified gen p mean: 0.45353955030441284, gen p mean: -0.7410905361175537, mean p set: 0.4540198743343353
loss_pred:0.026673240587115288, decouple_loss:0.012268378399312496
loss_pred:0.0258694589138031, decouple_loss:0.011220644228160381
loss_pred:0.02664317935705185, decouple_loss:0.011093548499047756
Iteration: 2158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45184895396232605, gen p mean: -0.7356323599815369, mean p set: 0.45232921838760376
The modified gen p mean: 0.45230743288993835, gen p mean: -0.7279872298240662, mean p set: 0.45278772711753845
The modified gen p mean: 0.4545176327228546, gen p mean: -0.7374395728111267, mean p set: 0.4549979567527771
loss_pred:0.026507211849093437, decouple_loss:0.010807889513671398
loss_pred:0.027839647606015205, decouple_loss:0.011574235744774342
loss_pred:0.02700216881930828, decouple_loss:0.011132922023534775
Iteration: 2159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527387320995331, gen p mean: -0.7424712181091309, mean p set: 0.4532190263271332
The modified gen p mean: 0.4535723030567169, gen p mean: -0.7419544458389282, mean p set: 0.45405256748199463
The modified gen p mean: 0.4519190490245819, gen p mean: -0.733427882194519, mean p set: 0.452399343252182
loss_pred:0.026036076247692108, decouple_loss:0.011521433480083942
loss_pred:0.02675461955368519, decouple_loss:0.011408635415136814
loss_pred:0.026610247790813446, decouple_loss:0.011416386812925339
Iteration: 2160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519031345844269, gen p mean: -0.7362571358680725, mean p set: 0.452383428812027
The modified gen p mean: 0.4523218870162964, gen p mean: -0.7402259111404419, mean p set: 0.4528021812438965
The modified gen p mean: 0.4524392783641815, gen p mean: -0.7385156154632568, mean p set: 0.4529195725917816
loss_pred:0.02727653458714485, decouple_loss:0.01155701931566
loss_pred:0.027958709746599197, decouple_loss:0.01179016288369894
loss_pred:0.026919769123196602, decouple_loss:0.011183533817529678
2023-05-03 04:41:15 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7377173900604248, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7457152009010315, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7329115867614746, mean p set: 0.45035696029663086
loss_pred:0.026992004364728928, decouple_loss:0.012271334417164326
loss_pred:0.028118688613176346, decouple_loss:0.012456388212740421
loss_pred:0.026669291779398918, decouple_loss:0.012384112924337387
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027878526598215103, avg_mse: 0.03332914412021637
current test mse: 0.033329
Iteration: 2161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45160800218582153, gen p mean: -0.7341452836990356, mean p set: 0.45208826661109924
The modified gen p mean: 0.4518159031867981, gen p mean: -0.7370664477348328, mean p set: 0.4522961974143982
loss_pred:0.025250975042581558, decouple_loss:0.011148601770401001
loss_pred:0.027403539046645164, decouple_loss:0.010930080898106098
The modified gen p mean: 0.4525487720966339, gen p mean: -0.7316967248916626, mean p set: 0.4530290365219116
loss_pred:0.026206571608781815, decouple_loss:0.01105866115540266
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 2162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494702219963074, gen p mean: -0.7441636323928833, mean p set: 0.44995051622390747
The modified gen p mean: 0.44756248593330383, gen p mean: -0.7386534214019775, mean p set: 0.44804278016090393
The modified gen p mean: 0.4487855136394501, gen p mean: -0.7360934019088745, mean p set: 0.44926580786705017
loss_pred:0.026934372261166573, decouple_loss:0.012569432146847248
loss_pred:0.027007434517145157, decouple_loss:0.012379959225654602
loss_pred:0.027001481503248215, decouple_loss:0.013003578409552574
Iteration: 2163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486353397369385, gen p mean: -0.7343513369560242, mean p set: 0.4491156041622162
The modified gen p mean: 0.448984295129776, gen p mean: -0.7325043082237244, mean p set: 0.4494645595550537
The modified gen p mean: 0.4483334422111511, gen p mean: -0.7394629120826721, mean p set: 0.4488137364387512
loss_pred:0.026968326419591904, decouple_loss:0.011918231844902039
loss_pred:0.026982177048921585, decouple_loss:0.012087728828191757
loss_pred:0.026364989578723907, decouple_loss:0.01245557889342308
Iteration: 2164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44858911633491516, gen p mean: -0.7383622527122498, mean p set: 0.44906941056251526
The modified gen p mean: 0.4477235674858093, gen p mean: -0.7317469716072083, mean p set: 0.4482038617134094
The modified gen p mean: 0.44855940341949463, gen p mean: -0.7403590083122253, mean p set: 0.4490397274494171
loss_pred:0.027169041335582733, decouple_loss:0.011249113827943802
loss_pred:0.026958737522363663, decouple_loss:0.011416605673730373
loss_pred:0.026525888592004776, decouple_loss:0.011511750519275665
Iteration: 2165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488264322280884, gen p mean: -0.7419431209564209, mean p set: 0.44930675625801086
The modified gen p mean: 0.4477488100528717, gen p mean: -0.7300907373428345, mean p set: 0.4482291042804718
The modified gen p mean: 0.4485745131969452, gen p mean: -0.7407135963439941, mean p set: 0.4490547776222229
loss_pred:0.026406947523355484, decouple_loss:0.011368921957910061
loss_pred:0.027140185236930847, decouple_loss:0.011325882747769356
loss_pred:0.026349222287535667, decouple_loss:0.011498954147100449
Iteration: 2166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482080042362213, gen p mean: -0.7441088557243347, mean p set: 0.4486883282661438
The modified gen p mean: 0.44876736402511597, gen p mean: -0.7524601221084595, mean p set: 0.44924765825271606
The modified gen p mean: 0.4480448067188263, gen p mean: -0.741907000541687, mean p set: 0.4485251009464264
loss_pred:0.02662196196615696, decouple_loss:0.01118242833763361
loss_pred:0.025482160970568657, decouple_loss:0.011995079927146435
loss_pred:0.026560934260487556, decouple_loss:0.011291366070508957
Iteration: 2167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473928213119507, gen p mean: -0.7320353388786316, mean p set: 0.447873055934906
The modified gen p mean: 0.44823095202445984, gen p mean: -0.7342004179954529, mean p set: 0.44871124625205994
loss_pred:0.0270114503800869, decouple_loss:0.011313121765851974
The modified gen p mean: 0.4474312961101532, gen p mean: -0.7383894920349121, mean p set: 0.4479115903377533loss_pred:0.026977429166436195, decouple_loss:0.011231041513383389
loss_pred:0.026339219883084297, decouple_loss:0.011109163984656334
Iteration: 2168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487271010875702, gen p mean: -0.7563309669494629, mean p set: 0.4492073655128479
The modified gen p mean: 0.4478801488876343, gen p mean: -0.7439790964126587, mean p set: 0.4483604431152344
The modified gen p mean: 0.4481388032436371, gen p mean: -0.744353711605072, mean p set: 0.44861912727355957
loss_pred:0.02517290972173214, decouple_loss:0.011644184589385986
loss_pred:0.026151208207011223, decouple_loss:0.011389368213713169
loss_pred:0.026250377297401428, decouple_loss:0.011125442571938038
Iteration: 2169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492049813270569, gen p mean: -0.755387544631958, mean p set: 0.449685275554657
The modified gen p mean: 0.44737279415130615, gen p mean: -0.750485360622406, mean p set: 0.44785305857658386
The modified gen p mean: 0.44877079129219055, gen p mean: -0.7520785927772522, mean p set: 0.44925105571746826
loss_pred:0.02595594897866249, decouple_loss:0.010882459580898285
loss_pred:0.026758473366498947, decouple_loss:0.010894575156271458
loss_pred:0.026073193177580833, decouple_loss:0.011191951110959053
Iteration: 2170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44635310769081116, gen p mean: -0.7376716732978821, mean p set: 0.44683340191841125
The modified gen p mean: 0.4481961727142334, gen p mean: -0.7398470640182495, mean p set: 0.4486764669418335
The modified gen p mean: 0.4487454891204834, gen p mean: -0.7380026578903198, mean p set: 0.4492258131504059
loss_pred:0.026930809020996094, decouple_loss:0.011250321753323078
loss_pred:0.026399163529276848, decouple_loss:0.010946664027869701
loss_pred:0.02612721361219883, decouple_loss:0.010917260311543941
2023-05-03 04:45:35 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7277961373329163, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7350068092346191, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7228425741195679, mean p set: 0.45035696029663086
loss_pred:0.026394935324788094, decouple_loss:0.011109894141554832
loss_pred:0.027323411777615547, decouple_loss:0.011391662992537022
loss_pred:0.026023684069514275, decouple_loss:0.011379197239875793
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027145355939865112, avg_mse: 0.03224286064505577
current test mse: 0.032243
Iteration: 2171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475170075893402, gen p mean: -0.7218631505966187, mean p set: 0.4479973018169403
loss_pred:0.026547372341156006, decouple_loss:0.010887524113059044
The modified gen p mean: 0.44869402050971985, gen p mean: -0.7308540344238281, mean p set: 0.44917428493499756
loss_pred:0.026159435510635376, decouple_loss:0.010554012842476368
The modified gen p mean: 0.4482963979244232, gen p mean: -0.7346194982528687, mean p set: 0.4487766921520233
loss_pred:0.027037188410758972, decouple_loss:0.011023037135601044
Iteration: 2172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495489001274109, gen p mean: -0.7325699925422668, mean p set: 0.450029194355011
The modified gen p mean: 0.44903212785720825, gen p mean: -0.7391875982284546, mean p set: 0.44951245188713074
The modified gen p mean: 0.44868943095207214, gen p mean: -0.7297799587249756, mean p set: 0.44916975498199463
loss_pred:0.026121368631720543, decouple_loss:0.010427462868392467
loss_pred:0.02517053112387657, decouple_loss:0.010935054160654545
loss_pred:0.026749981567263603, decouple_loss:0.010042508132755756
Iteration: 2173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44870543479919434, gen p mean: -0.7311420440673828, mean p set: 0.4491857588291168
The modified gen p mean: 0.4488902688026428, gen p mean: -0.7211676239967346, mean p set: 0.44937053322792053
The modified gen p mean: 0.44863730669021606, gen p mean: -0.7245759963989258, mean p set: 0.44911760091781616
loss_pred:0.026661887764930725, decouple_loss:0.010373985394835472
loss_pred:0.026798801496624947, decouple_loss:0.01072488259524107
loss_pred:0.026959490031003952, decouple_loss:0.010615292005240917
Iteration: 2174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480121433734894, gen p mean: -0.7292553186416626, mean p set: 0.4484924077987671
The modified gen p mean: 0.44805780053138733, gen p mean: -0.7282612919807434, mean p set: 0.44853806495666504
The modified gen p mean: 0.4480783939361572, gen p mean: -0.7241842150688171, mean p set: 0.44855865836143494
loss_pred:0.02614947408437729, decouple_loss:0.010470570996403694
loss_pred:0.02564326301217079, decouple_loss:0.010595493949949741
loss_pred:0.026694247499108315, decouple_loss:0.010267249308526516
Iteration: 2175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44933339953422546, gen p mean: -0.7231931090354919, mean p set: 0.44981372356414795
The modified gen p mean: 0.44808676838874817, gen p mean: -0.7313913106918335, mean p set: 0.44856706261634827
The modified gen p mean: 0.4484032988548279, gen p mean: -0.7353941798210144, mean p set: 0.4488835632801056
loss_pred:0.02578151226043701, decouple_loss:0.0108664995059371
loss_pred:0.02651999332010746, decouple_loss:0.010302687995135784
loss_pred:0.02578405663371086, decouple_loss:0.01013951376080513
Iteration: 2176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472561478614807, gen p mean: -0.7419226169586182, mean p set: 0.4477364122867584
The modified gen p mean: 0.44862884283065796, gen p mean: -0.7356162667274475, mean p set: 0.44910916686058044
The modified gen p mean: 0.44799625873565674, gen p mean: -0.7373476624488831, mean p set: 0.4484765827655792
loss_pred:0.02667643316090107, decouple_loss:0.010186944156885147
loss_pred:0.02627551183104515, decouple_loss:0.009987852536141872
loss_pred:0.02619265578687191, decouple_loss:0.010025851428508759
Iteration: 2177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489459991455078, gen p mean: -0.7380160689353943, mean p set: 0.4494262933731079
The modified gen p mean: 0.44847413897514343, gen p mean: -0.7401289343833923, mean p set: 0.44895440340042114
The modified gen p mean: 0.44955793023109436, gen p mean: -0.7417469024658203, mean p set: 0.45003825426101685
loss_pred:0.026048261672258377, decouple_loss:0.010874282568693161
loss_pred:0.025992950424551964, decouple_loss:0.010261059738695621
loss_pred:0.025848396122455597, decouple_loss:0.010354547761380672
Iteration: 2178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477640688419342, gen p mean: -0.7389278411865234, mean p set: 0.4482443630695343
The modified gen p mean: 0.4482119381427765, gen p mean: -0.7362839579582214, mean p set: 0.4486922323703766
The modified gen p mean: 0.4491446018218994, gen p mean: -0.7383958101272583, mean p set: 0.4496248662471771
loss_pred:0.026253370568156242, decouple_loss:0.010044760070741177
loss_pred:0.026337211951613426, decouple_loss:0.010054709389805794
loss_pred:0.025942161679267883, decouple_loss:0.010239954106509686
Iteration: 2179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478552043437958, gen p mean: -0.7364341616630554, mean p set: 0.4483354985713959
The modified gen p mean: 0.44862377643585205, gen p mean: -0.7396975159645081, mean p set: 0.44910410046577454
The modified gen p mean: 0.4475848078727722, gen p mean: -0.7307997345924377, mean p set: 0.4480650722980499
loss_pred:0.026707883924245834, decouple_loss:0.009801821783185005
loss_pred:0.02682100608944893, decouple_loss:0.009593070484697819
loss_pred:0.026505466550588608, decouple_loss:0.009734504856169224
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485089182853699, gen p mean: -0.7440505027770996, mean p set: 0.44898921251296997
The modified gen p mean: 0.447951078414917, gen p mean: -0.7395542860031128, mean p set: 0.4484313726425171
The modified gen p mean: 0.44871985912323, gen p mean: -0.7355183959007263, mean p set: 0.4492001235485077
loss_pred:0.02536196820437908, decouple_loss:0.0100163659080863
loss_pred:0.026138391345739365, decouple_loss:0.010120249353349209
loss_pred:0.02569255232810974, decouple_loss:0.010295304469764233
2023-05-03 04:49:17 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7372926473617554, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7443554997444153, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987669587135315, gen p mean: -0.7324641942977905, mean p set: 0.45035696029663086
loss_pred:0.026247287169098854, decouple_loss:0.01026590820401907
loss_pred:0.027204813435673714, decouple_loss:0.010547644458711147
loss_pred:0.025898313149809837, decouple_loss:0.01039715576916933
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02697031758725643, avg_mse: 0.03202909976243973
current test mse: 0.032029
Iteration: 2181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471951425075531, gen p mean: -0.7391715049743652, mean p set: 0.4476754069328308
loss_pred:0.0259908027946949, decouple_loss:0.009760298766195774
The modified gen p mean: 0.448775053024292, gen p mean: -0.7394697070121765, mean p set: 0.4492553174495697
loss_pred:0.025370730087161064, decouple_loss:0.010053586214780807
The modified gen p mean: 0.44839170575141907, gen p mean: -0.7382911443710327, mean p set: 0.44887199997901917
loss_pred:0.026054851710796356, decouple_loss:0.009777785278856754
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
NaN value num: 0
Iteration: 2182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45106467604637146, gen p mean: -0.7307127714157104, mean p set: 0.45154494047164917
The modified gen p mean: 0.450015127658844, gen p mean: -0.7261144518852234, mean p set: 0.4504954218864441
The modified gen p mean: 0.451595664024353, gen p mean: -0.7356511950492859, mean p set: 0.4520759880542755
loss_pred:0.026456529274582863, decouple_loss:0.012160691432654858
loss_pred:0.02557971328496933, decouple_loss:0.011727169156074524
loss_pred:0.025119412690401077, decouple_loss:0.012687897309660912
Iteration: 2183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504963755607605, gen p mean: -0.7310733795166016, mean p set: 0.4509766697883606
The modified gen p mean: 0.451369047164917, gen p mean: -0.7297375798225403, mean p set: 0.4518493115901947
The modified gen p mean: 0.4519435465335846, gen p mean: -0.7327440977096558, mean p set: 0.4524238109588623
loss_pred:0.026868276298046112, decouple_loss:0.012345106340944767
loss_pred:0.026939721778035164, decouple_loss:0.01183375995606184
loss_pred:0.025377830490469933, decouple_loss:0.011896200478076935
Iteration: 2184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509691596031189, gen p mean: -0.7245270609855652, mean p set: 0.451449453830719
The modified gen p mean: 0.452606201171875, gen p mean: -0.73311847448349, mean p set: 0.4530864953994751
The modified gen p mean: 0.4517036974430084, gen p mean: -0.7397782206535339, mean p set: 0.45218396186828613
loss_pred:0.025134539231657982, decouple_loss:0.011589836329221725
loss_pred:0.02611909620463848, decouple_loss:0.01092881616204977
loss_pred:0.027263915166258812, decouple_loss:0.012042192742228508
Iteration: 2185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45121335983276367, gen p mean: -0.7465077638626099, mean p set: 0.4516936242580414
The modified gen p mean: 0.45092010498046875, gen p mean: -0.7386437058448792, mean p set: 0.45140039920806885
The modified gen p mean: 0.45108503103256226, gen p mean: -0.7396795749664307, mean p set: 0.45156532526016235
loss_pred:0.026692096143960953, decouple_loss:0.011173979379236698
loss_pred:0.02593696117401123, decouple_loss:0.010794946923851967
loss_pred:0.025046419352293015, decouple_loss:0.011104111559689045
Iteration: 2186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44944626092910767, gen p mean: -0.7390090227127075, mean p set: 0.44992655515670776
The modified gen p mean: 0.45068854093551636, gen p mean: -0.7390078902244568, mean p set: 0.45116883516311646
The modified gen p mean: 0.4501487612724304, gen p mean: -0.7367585897445679, mean p set: 0.45062902569770813
loss_pred:0.026486098766326904, decouple_loss:0.010983237996697426
loss_pred:0.0270705409348011, decouple_loss:0.011332910507917404
loss_pred:0.025844847783446312, decouple_loss:0.010770831257104874
Iteration: 2187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45031309127807617, gen p mean: -0.7360499501228333, mean p set: 0.4507933557033539
The modified gen p mean: 0.45124179124832153, gen p mean: -0.7385299801826477, mean p set: 0.451722115278244
The modified gen p mean: 0.4498280882835388, gen p mean: -0.7349604368209839, mean p set: 0.4503083825111389
loss_pred:0.025568179786205292, decouple_loss:0.010782554745674133
loss_pred:0.026729624718427658, decouple_loss:0.011552882380783558
loss_pred:0.026571568101644516, decouple_loss:0.01098679006099701
Iteration: 2188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517829120159149, gen p mean: -0.7342193126678467, mean p set: 0.452263206243515
The modified gen p mean: 0.45170968770980835, gen p mean: -0.7355623245239258, mean p set: 0.45218998193740845
The modified gen p mean: 0.4530012309551239, gen p mean: -0.736492931842804, mean p set: 0.453481525182724
loss_pred:0.025652611628174782, decouple_loss:0.011245566420257092
loss_pred:0.0264894962310791, decouple_loss:0.01136108860373497
loss_pred:0.024896852672100067, decouple_loss:0.010975306853652
Iteration: 2189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45127439498901367, gen p mean: -0.7296018004417419, mean p set: 0.45175471901893616
The modified gen p mean: 0.45107388496398926, gen p mean: -0.7272660732269287, mean p set: 0.45155417919158936
The modified gen p mean: 0.4509936571121216, gen p mean: -0.7266029119491577, mean p set: 0.4514739513397217
loss_pred:0.025621561333537102, decouple_loss:0.01124389749020338
loss_pred:0.026508163660764694, decouple_loss:0.0116166602820158
loss_pred:0.02600107528269291, decouple_loss:0.011426291428506374
Iteration: 2190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45241865515708923, gen p mean: -0.7293832302093506, mean p set: 0.45289894938468933
The modified gen p mean: 0.4510103166103363, gen p mean: -0.726240336894989, mean p set: 0.451490581035614
The modified gen p mean: 0.450273722410202, gen p mean: -0.7265028357505798, mean p set: 0.4507540166378021
loss_pred:0.025571705773472786, decouple_loss:0.011501687578856945
loss_pred:0.025708282366394997, decouple_loss:0.010929027572274208
loss_pred:0.026229001581668854, decouple_loss:0.010981597006320953
2023-05-03 04:53:50 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7291803956031799, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7364076972007751, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7246302962303162, mean p set: 0.45035696029663086
loss_pred:0.02650810033082962, decouple_loss:0.012356349267065525
loss_pred:0.02760460041463375, decouple_loss:0.012625611387193203
loss_pred:0.02623097598552704, decouple_loss:0.012605920433998108
WV_0_PC_1_EH_0_PS_40_6, loss: 0.0274076908826828, avg_mse: 0.032670967280864716
current test mse: 0.032671
Iteration: 2191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45086175203323364, gen p mean: -0.7302334904670715, mean p set: 0.45134201645851135
The modified gen p mean: 0.4504777491092682, gen p mean: -0.7245053648948669, mean p set: 0.4509580433368683
loss_pred:0.0261274091899395, decouple_loss:0.011118271388113499
loss_pred:0.025458097457885742, decouple_loss:0.01107004377990961
The modified gen p mean: 0.45045387744903564, gen p mean: -0.7265824675559998, mean p set: 0.45093417167663574
loss_pred:0.025800278410315514, decouple_loss:0.010980257764458656
Iteration: 2192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502072036266327, gen p mean: -0.7292018532752991, mean p set: 0.4506874978542328
The modified gen p mean: 0.4513470530509949, gen p mean: -0.7319621443748474, mean p set: 0.45182737708091736
The modified gen p mean: 0.45014965534210205, gen p mean: -0.7356521487236023, mean p set: 0.45062994956970215
loss_pred:0.026736881583929062, decouple_loss:0.010785127989947796
loss_pred:0.025379903614521027, decouple_loss:0.011261742562055588
loss_pred:0.026599254459142685, decouple_loss:0.010820938274264336
Iteration: 2193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494660496711731, gen p mean: -0.7378110289573669, mean p set: 0.4499463438987732
The modified gen p mean: 0.4516170918941498, gen p mean: -0.7418628334999084, mean p set: 0.4520973861217499
The modified gen p mean: 0.4506543278694153, gen p mean: -0.7428196668624878, mean p set: 0.4511346220970154
loss_pred:0.026319831609725952, decouple_loss:0.010565678589046001
loss_pred:0.02625073306262493, decouple_loss:0.010631667450070381
loss_pred:0.026012852787971497, decouple_loss:0.01093151792883873
Iteration: 2194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517129063606262, gen p mean: -0.7462003827095032, mean p set: 0.4521932005882263
The modified gen p mean: 0.45239830017089844, gen p mean: -0.7420622110366821, mean p set: 0.4528786242008209
The modified gen p mean: 0.451759397983551, gen p mean: -0.7397587299346924, mean p set: 0.4522396922111511
loss_pred:0.025865254923701286, decouple_loss:0.010437306948006153
loss_pred:0.02574639394879341, decouple_loss:0.010627181269228458
loss_pred:0.025502843782305717, decouple_loss:0.010447686538100243
Iteration: 2195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513828158378601, gen p mean: -0.7498441338539124, mean p set: 0.4518631398677826
The modified gen p mean: 0.4499052166938782, gen p mean: -0.7391300201416016, mean p set: 0.45038551092147827
The modified gen p mean: 0.4522620439529419, gen p mean: -0.7506059408187866, mean p set: 0.452742338180542
loss_pred:0.026757443323731422, decouple_loss:0.011536039412021637
loss_pred:0.02503778040409088, decouple_loss:0.010322999209165573
loss_pred:0.024552257731556892, decouple_loss:0.010716473683714867
Iteration: 2196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506767988204956, gen p mean: -0.7331143617630005, mean p set: 0.4511570930480957
The modified gen p mean: 0.45175155997276306, gen p mean: -0.7409067749977112, mean p set: 0.45223185420036316
The modified gen p mean: 0.45241329073905945, gen p mean: -0.7409062385559082, mean p set: 0.45289358496665955
loss_pred:0.026308398693799973, decouple_loss:0.010418226942420006
loss_pred:0.025130687281489372, decouple_loss:0.011145344004034996
loss_pred:0.02492927387356758, decouple_loss:0.010705817490816116
Iteration: 2197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44963377714157104, gen p mean: -0.7378466725349426, mean p set: 0.45011407136917114
The modified gen p mean: 0.4520995318889618, gen p mean: -0.738900363445282, mean p set: 0.4525797963142395
The modified gen p mean: 0.4509449005126953, gen p mean: -0.7294049263000488, mean p set: 0.4514252245426178
loss_pred:0.025899579748511314, decouple_loss:0.010647269897162914
loss_pred:0.025329167023301125, decouple_loss:0.010752449743449688
loss_pred:0.025796115398406982, decouple_loss:0.010214949026703835
Iteration: 2198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45029664039611816, gen p mean: -0.7341377139091492, mean p set: 0.45077693462371826
The modified gen p mean: 0.4500358998775482, gen p mean: -0.7325450778007507, mean p set: 0.4505161941051483
The modified gen p mean: 0.45130977034568787, gen p mean: -0.7333157658576965, mean p set: 0.45179006457328796
loss_pred:0.024813205003738403, decouple_loss:0.010792989283800125
loss_pred:0.025437388569116592, decouple_loss:0.010646958835422993
loss_pred:0.02552865445613861, decouple_loss:0.010526048950850964
Iteration: 2199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505440890789032, gen p mean: -0.75112384557724, mean p set: 0.4510243833065033
The modified gen p mean: 0.4523888826370239, gen p mean: -0.7499457001686096, mean p set: 0.45286911725997925
The modified gen p mean: 0.4508785307407379, gen p mean: -0.7513973712921143, mean p set: 0.451358824968338
loss_pred:0.0260839331895113, decouple_loss:0.010245765559375286
loss_pred:0.02556242048740387, decouple_loss:0.010941802524030209
loss_pred:0.02534063532948494, decouple_loss:0.010285982862114906
Iteration: 2200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503312408924103, gen p mean: -0.7447479367256165, mean p set: 0.4508115351200104
The modified gen p mean: 0.45153576135635376, gen p mean: -0.739962637424469, mean p set: 0.45201605558395386
The modified gen p mean: 0.45306819677352905, gen p mean: -0.7518481612205505, mean p set: 0.45354846119880676
loss_pred:0.024900570511817932, decouple_loss:0.009767992421984673
loss_pred:0.025708911940455437, decouple_loss:0.010757530108094215
loss_pred:0.0244622640311718, decouple_loss:0.009973563253879547
2023-05-03 04:57:32 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7504472136497498, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7426321506500244, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.737611711025238, mean p set: 0.45035696029663086
loss_pred:0.027538107708096504, decouple_loss:0.011981574818491936
loss_pred:0.02617647312581539, decouple_loss:0.011641179211437702
loss_pred:0.0265493206679821, decouple_loss:0.011482080444693565
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027339717373251915, avg_mse: 0.03260556235909462
current test mse: 0.032606
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 2201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44639065861701965, gen p mean: -0.743081271648407, mean p set: 0.44687098264694214
loss_pred:0.02586941048502922, decouple_loss:0.012001117691397667
The modified gen p mean: 0.4468749761581421, gen p mean: -0.7556259036064148, mean p set: 0.4473552703857422
loss_pred:0.026228079572319984, decouple_loss:0.012610289268195629
The modified gen p mean: 0.44574248790740967, gen p mean: -0.7389926910400391, mean p set: 0.4462227523326874
loss_pred:0.025021685287356377, decouple_loss:0.012249322608113289
Iteration: 2202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465906322002411, gen p mean: -0.7626745700836182, mean p set: 0.4470709264278412
The modified gen p mean: 0.4475003480911255, gen p mean: -0.7511560916900635, mean p set: 0.4479806125164032
The modified gen p mean: 0.4466317892074585, gen p mean: -0.7456064820289612, mean p set: 0.4471120834350586
loss_pred:0.026908844709396362, decouple_loss:0.012567601166665554
loss_pred:0.02594408206641674, decouple_loss:0.011219481006264687
loss_pred:0.027045395225286484, decouple_loss:0.011097040958702564
Iteration: 2203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44653376936912537, gen p mean: -0.7712851762771606, mean p set: 0.44701406359672546
The modified gen p mean: 0.4482642710208893, gen p mean: -0.7715759873390198, mean p set: 0.4487445652484894
The modified gen p mean: 0.4470854103565216, gen p mean: -0.768552303314209, mean p set: 0.4475656747817993
loss_pred:0.026861291378736496, decouple_loss:0.011995316483080387
loss_pred:0.02585725113749504, decouple_loss:0.011274377815425396
loss_pred:0.025517012923955917, decouple_loss:0.011270248331129551
Iteration: 2204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44603416323661804, gen p mean: -0.7554246187210083, mean p set: 0.44651445746421814
The modified gen p mean: 0.4478665292263031, gen p mean: -0.7573398351669312, mean p set: 0.4483468234539032
The modified gen p mean: 0.44881632924079895, gen p mean: -0.7635233998298645, mean p set: 0.44929662346839905
loss_pred:0.025240860879421234, decouple_loss:0.010631506331264973
loss_pred:0.02565757744014263, decouple_loss:0.01059945859014988
loss_pred:0.026040522381663322, decouple_loss:0.010728675872087479
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483518600463867, gen p mean: -0.7541894316673279, mean p set: 0.4488321542739868
The modified gen p mean: 0.4478265047073364, gen p mean: -0.757964015007019, mean p set: 0.4483067989349365
The modified gen p mean: 0.4470219612121582, gen p mean: -0.7553758025169373, mean p set: 0.4475022256374359
loss_pred:0.025642815977334976, decouple_loss:0.010114967823028564
loss_pred:0.027524461969733238, decouple_loss:0.010575641877949238
loss_pred:0.02533559501171112, decouple_loss:0.010426064021885395
Iteration: 2206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476628601551056, gen p mean: -0.7561208009719849, mean p set: 0.4481431543827057
The modified gen p mean: 0.4473060071468353, gen p mean: -0.7618091702461243, mean p set: 0.44778627157211304
The modified gen p mean: 0.44729161262512207, gen p mean: -0.7495288252830505, mean p set: 0.44777190685272217
loss_pred:0.02550099417567253, decouple_loss:0.010291713289916515
loss_pred:0.025936437770724297, decouple_loss:0.010080083273351192
loss_pred:0.024860335513949394, decouple_loss:0.010210558772087097
Iteration: 2207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44523462653160095, gen p mean: -0.7506982088088989, mean p set: 0.44571492075920105
The modified gen p mean: 0.4475573003292084, gen p mean: -0.7660998106002808, mean p set: 0.44803762435913086
The modified gen p mean: 0.446228951215744, gen p mean: -0.7655349373817444, mean p set: 0.4467092752456665
loss_pred:0.025061771273612976, decouple_loss:0.010482283309102058
loss_pred:0.02615210972726345, decouple_loss:0.010450460948050022
loss_pred:0.02709277719259262, decouple_loss:0.010761348530650139
Iteration: 2208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815337657928467, gen p mean: -0.7546544075012207, mean p set: 0.4486336410045624
The modified gen p mean: 0.4474366307258606, gen p mean: -0.7488835453987122, mean p set: 0.4479168951511383
The modified gen p mean: 0.4479551315307617, gen p mean: -0.7632004618644714, mean p set: 0.44843539595603943
loss_pred:0.025990935042500496, decouple_loss:0.010146202519536018
loss_pred:0.024950731545686722, decouple_loss:0.009831197559833527
loss_pred:0.024957293644547462, decouple_loss:0.010450371541082859
Iteration: 2209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44865885376930237, gen p mean: -0.7415951490402222, mean p set: 0.44913914799690247
The modified gen p mean: 0.44720178842544556, gen p mean: -0.739736795425415, mean p set: 0.44768208265304565
The modified gen p mean: 0.44825175404548645, gen p mean: -0.7471471428871155, mean p set: 0.44873204827308655
loss_pred:0.026350295171141624, decouple_loss:0.010548005811870098
loss_pred:0.025118423625826836, decouple_loss:0.009794038720428944
loss_pred:0.024584094062447548, decouple_loss:0.010587911121547222
Iteration: 2210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44699421525001526, gen p mean: -0.7352703809738159, mean p set: 0.44747447967529297
The modified gen p mean: 0.4486105442047119, gen p mean: -0.7428387403488159, mean p set: 0.449090838432312
The modified gen p mean: 0.44706714153289795, gen p mean: -0.7475093007087708, mean p set: 0.44754740595817566
loss_pred:0.026067767292261124, decouple_loss:0.010649377480149269
loss_pred:0.025234412401914597, decouple_loss:0.010698709636926651
loss_pred:0.026328053325414658, decouple_loss:0.011250101961195469
2023-05-03 05:01:58 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7438841462135315, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7364497780799866, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7320606708526611, mean p set: 0.45035696029663086
loss_pred:0.027174528688192368, decouple_loss:0.01057555340230465
loss_pred:0.026226095855236053, decouple_loss:0.010490710847079754
loss_pred:0.025945918634533882, decouple_loss:0.010566269047558308
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026976056396961212, avg_mse: 0.03206268697977066
current test mse: 0.032063
Iteration: 2211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480348825454712, gen p mean: -0.7345947623252869, mean p set: 0.4485151767730713
The modified gen p mean: 0.4481727182865143, gen p mean: -0.7388960719108582, mean p set: 0.4486530125141144
loss_pred:0.025129038840532303, decouple_loss:0.009741207584738731
loss_pred:0.027769308537244797, decouple_loss:0.010655706748366356
The modified gen p mean: 0.4466207027435303, gen p mean: -0.7360634803771973, mean p set: 0.44710099697113037
loss_pred:0.024705378338694572, decouple_loss:0.009940319694578648
Iteration: 2212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447226345539093, gen p mean: -0.7475378513336182, mean p set: 0.4477066397666931
The modified gen p mean: 0.4479070007801056, gen p mean: -0.7417092323303223, mean p set: 0.4483872950077057
The modified gen p mean: 0.44694459438323975, gen p mean: -0.7493839263916016, mean p set: 0.44742488861083984
loss_pred:0.02664317563176155, decouple_loss:0.010601034387946129
loss_pred:0.025787174701690674, decouple_loss:0.010792027227580547
loss_pred:0.02722942642867565, decouple_loss:0.010701206512749195
Iteration: 2213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879624247550964, gen p mean: -0.7458685636520386, mean p set: 0.44927650690078735
The modified gen p mean: 0.44767576456069946, gen p mean: -0.7481706142425537, mean p set: 0.44815605878829956
The modified gen p mean: 0.4464447498321533, gen p mean: -0.7544631958007812, mean p set: 0.4469250440597534
loss_pred:0.025280723348259926, decouple_loss:0.010331081226468086
loss_pred:0.02521277219057083, decouple_loss:0.010004987940192223
loss_pred:0.0270390622317791, decouple_loss:0.01097202766686678
Iteration: 2214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467603862285614, gen p mean: -0.7353522777557373, mean p set: 0.4472406804561615
The modified gen p mean: 0.448044091463089, gen p mean: -0.7384101152420044, mean p set: 0.4485243558883667
The modified gen p mean: 0.4477525055408478, gen p mean: -0.7430528998374939, mean p set: 0.44823282957077026
loss_pred:0.026677975431084633, decouple_loss:0.009996755979955196
loss_pred:0.02481035515666008, decouple_loss:0.01001701969653368
loss_pred:0.026534175500273705, decouple_loss:0.010469241067767143
Iteration: 2215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44601142406463623, gen p mean: -0.7261013984680176, mean p set: 0.44649171829223633
The modified gen p mean: 0.44811418652534485, gen p mean: -0.7333149909973145, mean p set: 0.44859448075294495
The modified gen p mean: 0.4455767571926117, gen p mean: -0.7255664467811584, mean p set: 0.4460570514202118
loss_pred:0.026626812294125557, decouple_loss:0.00988051574677229
loss_pred:0.0277078989893198, decouple_loss:0.009838738478720188
loss_pred:0.024355173110961914, decouple_loss:0.010620766319334507
Iteration: 2216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481518268585205, gen p mean: -0.7329704165458679, mean p set: 0.4486321210861206
The modified gen p mean: 0.44723355770111084, gen p mean: -0.736447274684906, mean p set: 0.4477138817310333
The modified gen p mean: 0.447291761636734, gen p mean: -0.7341055274009705, mean p set: 0.4477720260620117
loss_pred:0.025730326771736145, decouple_loss:0.00986524485051632
loss_pred:0.02598007209599018, decouple_loss:0.009737933985888958
loss_pred:0.026214584708213806, decouple_loss:0.010047733783721924
Iteration: 2217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44648081064224243, gen p mean: -0.7415540814399719, mean p set: 0.44696107506752014
The modified gen p mean: 0.4490118622779846, gen p mean: -0.7396323680877686, mean p set: 0.44949212670326233
The modified gen p mean: 0.4470917880535126, gen p mean: -0.7359996438026428, mean p set: 0.44757208228111267
loss_pred:0.026029925793409348, decouple_loss:0.009596393443644047
loss_pred:0.025469550862908363, decouple_loss:0.010572687722742558
loss_pred:0.02476803958415985, decouple_loss:0.009567497298121452
Iteration: 2218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44666460156440735, gen p mean: -0.7337266206741333, mean p set: 0.44714486598968506
The modified gen p mean: 0.44880780577659607, gen p mean: -0.7362027168273926, mean p set: 0.44928810000419617
The modified gen p mean: 0.44669008255004883, gen p mean: -0.7498974800109863, mean p set: 0.44717034697532654
loss_pred:0.026404155418276787, decouple_loss:0.009434507228434086
loss_pred:0.026161864399909973, decouple_loss:0.0100262351334095
loss_pred:0.026504594832658768, decouple_loss:0.010854685679078102
Iteration: 2219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459710121154785, gen p mean: -0.7393130660057068, mean p set: 0.4464513063430786
The modified gen p mean: 0.44639313220977783, gen p mean: -0.73598313331604, mean p set: 0.44687342643737793
The modified gen p mean: 0.4484339952468872, gen p mean: -0.7374104261398315, mean p set: 0.4489142596721649
loss_pred:0.026984797790646553, decouple_loss:0.009988413192331791
loss_pred:0.02689548395574093, decouple_loss:0.009904589504003525
loss_pred:0.02574460208415985, decouple_loss:0.009873170405626297
Iteration: 2220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472421705722809, gen p mean: -0.736193060874939, mean p set: 0.44772249460220337
The modified gen p mean: 0.44770726561546326, gen p mean: -0.7369533181190491, mean p set: 0.44818755984306335
The modified gen p mean: 0.44615438580513, gen p mean: -0.7295259833335876, mean p set: 0.4466347098350525
loss_pred:0.025736818090081215, decouple_loss:0.009600325487554073
loss_pred:0.02542661689221859, decouple_loss:0.009545291773974895
loss_pred:0.025555429980158806, decouple_loss:0.009210634976625443
2023-05-03 05:05:41 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7362398505210876, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7289124131202698, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7249099612236023, mean p set: 0.45035696029663086
loss_pred:0.02716747671365738, decouple_loss:0.00984999816864729
loss_pred:0.026162732392549515, decouple_loss:0.01005552802234888
loss_pred:0.025877218693494797, decouple_loss:0.010130508802831173
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026903077960014343, avg_mse: 0.03201049193739891
current test mse: 0.03201
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
NaN value num: 0
Iteration: 2221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44863197207450867, gen p mean: -0.7267313003540039, mean p set: 0.44911229610443115
The modified gen p mean: 0.45010000467300415, gen p mean: -0.7328020930290222, mean p set: 0.45058029890060425
loss_pred:0.0255526602268219, decouple_loss:0.011468065902590752
loss_pred:0.027225874364376068, decouple_loss:0.0119270458817482
The modified gen p mean: 0.44960451126098633, gen p mean: -0.7336170077323914, mean p set: 0.4500848054885864
loss_pred:0.027152474969625473, decouple_loss:0.01125267893075943
Iteration: 2222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482998549938202, gen p mean: -0.7308058142662048, mean p set: 0.4487801790237427
The modified gen p mean: 0.45034605264663696, gen p mean: -0.7273672819137573, mean p set: 0.45082634687423706
The modified gen p mean: 0.4482399821281433, gen p mean: -0.7332901358604431, mean p set: 0.4487202763557434
loss_pred:0.0250362828373909, decouple_loss:0.010909435339272022
loss_pred:0.02563030831515789, decouple_loss:0.010881957598030567
loss_pred:0.025035660713911057, decouple_loss:0.010715399868786335
Iteration: 2223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890132546424866, gen p mean: -0.7367565631866455, mean p set: 0.44938161969184875
The modified gen p mean: 0.4498811662197113, gen p mean: -0.7410622239112854, mean p set: 0.4503614604473114
The modified gen p mean: 0.44962725043296814, gen p mean: -0.735924243927002, mean p set: 0.45010754466056824
loss_pred:0.024898942559957504, decouple_loss:0.010489733889698982
loss_pred:0.02566489763557911, decouple_loss:0.011145194061100483
loss_pred:0.025931665673851967, decouple_loss:0.010641525499522686
Iteration: 2224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900333881378174, gen p mean: -0.74625563621521, mean p set: 0.44948363304138184
The modified gen p mean: 0.4485498368740082, gen p mean: -0.7331045866012573, mean p set: 0.4490301311016083
The modified gen p mean: 0.44907835125923157, gen p mean: -0.7379737496376038, mean p set: 0.4495586156845093
loss_pred:0.025713641196489334, decouple_loss:0.010642940178513527
loss_pred:0.0252549909055233, decouple_loss:0.010159658268094063
loss_pred:0.027009112760424614, decouple_loss:0.01045476458966732
Iteration: 2225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488687217235565, gen p mean: -0.7489215731620789, mean p set: 0.449349045753479
The modified gen p mean: 0.44963711500167847, gen p mean: -0.7381938695907593, mean p set: 0.4501173794269562
The modified gen p mean: 0.4496261477470398, gen p mean: -0.7484374642372131, mean p set: 0.4501064419746399
loss_pred:0.02626951038837433, decouple_loss:0.010411843657493591
loss_pred:0.026250619441270828, decouple_loss:0.010411811992526054
loss_pred:0.025705518200993538, decouple_loss:0.010794194415211678
Iteration: 2226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502198398113251, gen p mean: -0.73736172914505, mean p set: 0.45070016384124756
The modified gen p mean: 0.4500763416290283, gen p mean: -0.7412042617797852, mean p set: 0.4505566358566284
The modified gen p mean: 0.44999992847442627, gen p mean: -0.7421432137489319, mean p set: 0.450480192899704
loss_pred:0.025729047134518623, decouple_loss:0.01005266048014164
loss_pred:0.02553139254450798, decouple_loss:0.010323336347937584
loss_pred:0.026138165965676308, decouple_loss:0.01027071662247181
Iteration: 2227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44967159628868103, gen p mean: -0.7256699204444885, mean p set: 0.45015186071395874
The modified gen p mean: 0.44940653443336487, gen p mean: -0.739520788192749, mean p set: 0.44988682866096497
The modified gen p mean: 0.4476298689842224, gen p mean: -0.7264083623886108, mean p set: 0.4481101632118225
loss_pred:0.026857640594244003, decouple_loss:0.010231814347207546
loss_pred:0.025327851995825768, decouple_loss:0.010012278333306313
loss_pred:0.024742094799876213, decouple_loss:0.010022304020822048
Iteration: 2228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483415484428406, gen p mean: -0.722064197063446, mean p set: 0.4488218426704407
The modified gen p mean: 0.45083022117614746, gen p mean: -0.7295945286750793, mean p set: 0.45131051540374756
The modified gen p mean: 0.4495903253555298, gen p mean: -0.7302948832511902, mean p set: 0.4500705897808075
loss_pred:0.027112670242786407, decouple_loss:0.01033870130777359
loss_pred:0.02730965055525303, decouple_loss:0.010472448542714119
loss_pred:0.025318428874015808, decouple_loss:0.01033986359834671
Iteration: 2229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495692551136017, gen p mean: -0.7281174659729004, mean p set: 0.4500495493412018
The modified gen p mean: 0.44797059893608093, gen p mean: -0.7331238389015198, mean p set: 0.44845086336135864
The modified gen p mean: 0.4491945803165436, gen p mean: -0.7235152721405029, mean p set: 0.44967490434646606
loss_pred:0.02590348571538925, decouple_loss:0.010212353430688381
loss_pred:0.026504959911108017, decouple_loss:0.01019306667149067
loss_pred:0.024914734065532684, decouple_loss:0.010321928188204765
Iteration: 2230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44993531703948975, gen p mean: -0.7286477088928223, mean p set: 0.45041564106941223
The modified gen p mean: 0.44854944944381714, gen p mean: -0.7412413358688354, mean p set: 0.44902974367141724
The modified gen p mean: 0.4493008852005005, gen p mean: -0.7337086796760559, mean p set: 0.4497811496257782
loss_pred:0.025592179968953133, decouple_loss:0.010193247348070145
loss_pred:0.025910768657922745, decouple_loss:0.01044728048145771
loss_pred:0.026657171547412872, decouple_loss:0.01008620671927929
2023-05-03 05:10:13 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7301034331321716, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7370960116386414, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7265620827674866, mean p set: 0.45035696029663086
loss_pred:0.02664286643266678, decouple_loss:0.010998030193150043
loss_pred:0.027644198387861252, decouple_loss:0.010944284498691559
loss_pred:0.02647075615823269, decouple_loss:0.01107292715460062
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02746952697634697, avg_mse: 0.03294014930725098
current test mse: 0.03294
Iteration: 2231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490787386894226, gen p mean: -0.7427738308906555, mean p set: 0.4495590031147003
loss_pred:0.02603750303387642, decouple_loss:0.01017765887081623
The modified gen p mean: 0.44868695735931396, gen p mean: -0.7346125245094299, mean p set: 0.44916728138923645
loss_pred:0.02527095377445221, decouple_loss:0.009867459535598755
The modified gen p mean: 0.4507077932357788, gen p mean: -0.737898051738739, mean p set: 0.4511880874633789
loss_pred:0.026736799627542496, decouple_loss:0.010462125763297081
Iteration: 2232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488604962825775, gen p mean: -0.7449016571044922, mean p set: 0.4493407607078552
The modified gen p mean: 0.4490615725517273, gen p mean: -0.7397201657295227, mean p set: 0.4495418667793274
The modified gen p mean: 0.45029187202453613, gen p mean: -0.733206570148468, mean p set: 0.4507721960544586
loss_pred:0.026296358555555344, decouple_loss:0.010020527988672256loss_pred:0.025245891883969307, decouple_loss:0.010201029479503632
loss_pred:0.026086749508976936, decouple_loss:0.010206123813986778
Iteration: 2233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498796761035919, gen p mean: -0.7254576086997986, mean p set: 0.450359970331192
The modified gen p mean: 0.44768422842025757, gen p mean: -0.7452500462532043, mean p set: 0.44816452264785767
The modified gen p mean: 0.45041942596435547, gen p mean: -0.738028347492218, mean p set: 0.45089972019195557
loss_pred:0.02502889558672905, decouple_loss:0.010378183797001839
loss_pred:0.026119070127606392, decouple_loss:0.009953041560947895
loss_pred:0.025435835123062134, decouple_loss:0.010134956799447536
Iteration: 2234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44924744963645935, gen p mean: -0.7299849390983582, mean p set: 0.44972777366638184
The modified gen p mean: 0.45033302903175354, gen p mean: -0.7437376976013184, mean p set: 0.450813353061676
The modified gen p mean: 0.44914504885673523, gen p mean: -0.732760488986969, mean p set: 0.4496253430843353
loss_pred:0.025520673021674156, decouple_loss:0.009977301582694054
loss_pred:0.02529202774167061, decouple_loss:0.010270512662827969
loss_pred:0.02500431053340435, decouple_loss:0.010372782126069069
Iteration: 2235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449398398399353, gen p mean: -0.7314550876617432, mean p set: 0.4498787224292755
The modified gen p mean: 0.44904953241348267, gen p mean: -0.7306106686592102, mean p set: 0.44952985644340515
The modified gen p mean: 0.4493899941444397, gen p mean: -0.7491942048072815, mean p set: 0.4498702585697174
loss_pred:0.025095725432038307, decouple_loss:0.010250302031636238
loss_pred:0.025768538936972618, decouple_loss:0.009758933447301388
loss_pred:0.025822484865784645, decouple_loss:0.01040908694267273
Iteration: 2236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492672085762024, gen p mean: -0.7369017601013184, mean p set: 0.4497474730014801
The modified gen p mean: 0.45030975341796875, gen p mean: -0.7491691708564758, mean p set: 0.45079004764556885
The modified gen p mean: 0.4499967396259308, gen p mean: -0.7439818382263184, mean p set: 0.4504770338535309
loss_pred:0.02542516402900219, decouple_loss:0.010417088866233826
loss_pred:0.025622863322496414, decouple_loss:0.010791782289743423
loss_pred:0.025027787312865257, decouple_loss:0.010134551674127579
Iteration: 2237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500834047794342, gen p mean: -0.733509361743927, mean p set: 0.4505636692047119
The modified gen p mean: 0.44773152470588684, gen p mean: -0.7327286601066589, mean p set: 0.44821181893348694
The modified gen p mean: 0.4510635435581207, gen p mean: -0.736625075340271, mean p set: 0.4515438675880432
loss_pred:0.025575708597898483, decouple_loss:0.009807578288018703
loss_pred:0.025239111855626106, decouple_loss:0.010250693187117577
loss_pred:0.02685036137700081, decouple_loss:0.010386277921497822
Iteration: 2238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496113657951355, gen p mean: -0.7449234127998352, mean p set: 0.4500916600227356
The modified gen p mean: 0.44783836603164673, gen p mean: -0.7373366951942444, mean p set: 0.44831863045692444
The modified gen p mean: 0.44802236557006836, gen p mean: -0.73893803358078, mean p set: 0.44850265979766846
loss_pred:0.025189734995365143, decouple_loss:0.010291746817529202
loss_pred:0.02684345655143261, decouple_loss:0.010719895362854004
loss_pred:0.02534673549234867, decouple_loss:0.010789421387016773
Iteration: 2239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480888843536377, gen p mean: -0.744204044342041, mean p set: 0.4485691785812378
The modified gen p mean: 0.45019569993019104, gen p mean: -0.7530482411384583, mean p set: 0.45067599415779114
The modified gen p mean: 0.4479730725288391, gen p mean: -0.7482863664627075, mean p set: 0.4484533667564392
loss_pred:0.02544986456632614, decouple_loss:0.010073240846395493
loss_pred:0.024929311126470566, decouple_loss:0.009991065599024296
loss_pred:0.026494348421692848, decouple_loss:0.010479185730218887
Iteration: 2240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499788284301758, gen p mean: -0.754224956035614, mean p set: 0.4504591226577759
The modified gen p mean: 0.44935885071754456, gen p mean: -0.7468932867050171, mean p set: 0.44983911514282227
The modified gen p mean: 0.44915708899497986, gen p mean: -0.7681418061256409, mean p set: 0.44963738322257996
loss_pred:0.02568863146007061, decouple_loss:0.010841351002454758
loss_pred:0.025689389556646347, decouple_loss:0.00997891929000616
loss_pred:0.02505640685558319, decouple_loss:0.010741607286036015
2023-05-03 05:13:59 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7524573802947998, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.759673535823822, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.747934103012085, mean p set: 0.45035696029663086
loss_pred:0.026664141565561295, decouple_loss:0.011461146175861359
loss_pred:0.027655836194753647, decouple_loss:0.011458531953394413
loss_pred:0.026466215029358864, decouple_loss:0.011547695845365524
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02750318869948387, avg_mse: 0.03293059393763542
current test mse: 0.032931
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 2241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960030913352966, gen p mean: -0.7526232600212097, mean p set: 0.45008060336112976
The modified gen p mean: 0.44822725653648376, gen p mean: -0.7431619167327881, mean p set: 0.44870755076408386
loss_pred:0.026728583499789238, decouple_loss:0.011035623960196972
loss_pred:0.02605482190847397, decouple_loss:0.011661084368824959
The modified gen p mean: 0.4483799636363983, gen p mean: -0.7522876858711243, mean p set: 0.4488602578639984
loss_pred:0.026405462995171547, decouple_loss:0.011526064947247505
Iteration: 2242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494490623474121, gen p mean: -0.7490784525871277, mean p set: 0.4499293565750122
The modified gen p mean: 0.4472748041152954, gen p mean: -0.7446504831314087, mean p set: 0.4477550983428955
The modified gen p mean: 0.448723167181015, gen p mean: -0.7492966651916504, mean p set: 0.4492034912109375
loss_pred:0.027421731501817703, decouple_loss:0.01126741711050272
loss_pred:0.026815207675099373, decouple_loss:0.01112743467092514
loss_pred:0.027432605624198914, decouple_loss:0.01080569438636303
Iteration: 2243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44720131158828735, gen p mean: -0.7363848090171814, mean p set: 0.44768157601356506
The modified gen p mean: 0.44753146171569824, gen p mean: -0.7418305277824402, mean p set: 0.4480117857456207
The modified gen p mean: 0.4495009481906891, gen p mean: -0.7444373965263367, mean p set: 0.4499812126159668
loss_pred:0.027093492448329926, decouple_loss:0.010858939960598946
loss_pred:0.0264345221221447, decouple_loss:0.011001008562743664
loss_pred:0.02600942552089691, decouple_loss:0.011618860065937042
Iteration: 2244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475981593132019, gen p mean: -0.7373759150505066, mean p set: 0.4480784237384796
The modified gen p mean: 0.44836118817329407, gen p mean: -0.7348047494888306, mean p set: 0.44884148240089417
The modified gen p mean: 0.44782891869544983, gen p mean: -0.7297708988189697, mean p set: 0.4483092129230499
loss_pred:0.027103399857878685, decouple_loss:0.011122784577310085
loss_pred:0.025932958349585533, decouple_loss:0.01111743412911892
loss_pred:0.02644309401512146, decouple_loss:0.010795662179589272
Iteration: 2245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714072346687317, gen p mean: -0.7341495752334595, mean p set: 0.44762104749679565
The modified gen p mean: 0.4471893906593323, gen p mean: -0.735582709312439, mean p set: 0.44766971468925476
The modified gen p mean: 0.4494127631187439, gen p mean: -0.7472346425056458, mean p set: 0.449893057346344
loss_pred:0.026768403127789497, decouple_loss:0.010905589908361435
loss_pred:0.027294734492897987, decouple_loss:0.010852696374058723
loss_pred:0.02638116478919983, decouple_loss:0.01096230186522007
Iteration: 2246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788235425949097, gen p mean: -0.7435265183448792, mean p set: 0.44836267828941345
The modified gen p mean: 0.44984617829322815, gen p mean: -0.7483914494514465, mean p set: 0.45032650232315063
The modified gen p mean: 0.44900357723236084, gen p mean: -0.743800938129425, mean p set: 0.44948384165763855
loss_pred:0.026553170755505562, decouple_loss:0.010892602615058422
loss_pred:0.026291105896234512, decouple_loss:0.01084363553673029
loss_pred:0.027320759370923042, decouple_loss:0.010690857656300068
Iteration: 2247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490025043487549, gen p mean: -0.7429747581481934, mean p set: 0.449482798576355
The modified gen p mean: 0.4487559199333191, gen p mean: -0.7458122372627258, mean p set: 0.4492361843585968
The modified gen p mean: 0.4484681785106659, gen p mean: -0.7455130815505981, mean p set: 0.448948472738266
loss_pred:0.027100559324026108, decouple_loss:0.011025205254554749
loss_pred:0.026146596297621727, decouple_loss:0.011306879110634327
loss_pred:0.026778865605592728, decouple_loss:0.01072164811193943
Iteration: 2248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488871693611145, gen p mean: -0.7382243871688843, mean p set: 0.4493674635887146
The modified gen p mean: 0.4483950734138489, gen p mean: -0.7432013750076294, mean p set: 0.44887539744377136
The modified gen p mean: 0.44725847244262695, gen p mean: -0.7376354932785034, mean p set: 0.44773876667022705
loss_pred:0.026697218418121338, decouple_loss:0.010760385543107986
loss_pred:0.025634942576289177, decouple_loss:0.010548860765993595
loss_pred:0.026269545778632164, decouple_loss:0.010329648852348328
Iteration: 2249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762134552001953, gen p mean: -0.7412460446357727, mean p set: 0.44810163974761963
The modified gen p mean: 0.4479621946811676, gen p mean: -0.7352309823036194, mean p set: 0.4484424889087677
loss_pred:0.02599136345088482, decouple_loss:0.010871794074773788
The modified gen p mean: 0.4483802318572998, gen p mean: -0.7363467812538147, mean p set: 0.4488604962825775
loss_pred:0.026465002447366714, decouple_loss:0.010278011672198772
loss_pred:0.02560095302760601, decouple_loss:0.010867621749639511
Iteration: 2250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494132995605469, gen p mean: -0.7403124570846558, mean p set: 0.449893593788147
The modified gen p mean: 0.4492121636867523, gen p mean: -0.7342155575752258, mean p set: 0.4496924579143524
The modified gen p mean: 0.4497976005077362, gen p mean: -0.7343591451644897, mean p set: 0.4502778649330139
loss_pred:0.02633577771484852, decouple_loss:0.010553836822509766
loss_pred:0.025675779208540916, decouple_loss:0.0113195376470685
loss_pred:0.02759968489408493, decouple_loss:0.010867352597415447
2023-05-03 05:18:24 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7347155213356018, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7414759993553162, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7298352718353271, mean p set: 0.45035696029663086
loss_pred:0.026309700682759285, decouple_loss:0.010708438232541084
loss_pred:0.027264269068837166, decouple_loss:0.010755090042948723
loss_pred:0.025991398841142654, decouple_loss:0.010558496229350567
WV_0_PC_1_EH_0_PS_40_6, loss: 0.027055490761995316, avg_mse: 0.03215503320097923
current test mse: 0.032155
Iteration: 2251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44893336296081543, gen p mean: -0.7330111265182495, mean p set: 0.4494136571884155
loss_pred:0.025118248537182808, decouple_loss:0.010970535688102245
The modified gen p mean: 0.4492904543876648, gen p mean: -0.7356438636779785, mean p set: 0.4497707486152649
loss_pred:0.02644832618534565, decouple_loss:0.010380560532212257
The modified gen p mean: 0.44893890619277954, gen p mean: -0.7313145995140076, mean p set: 0.44941920042037964
loss_pred:0.02729327604174614, decouple_loss:0.01050645112991333
Iteration: 2252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481375217437744, gen p mean: -0.7269801497459412, mean p set: 0.4486178159713745
The modified gen p mean: 0.4493180811405182, gen p mean: -0.7321501970291138, mean p set: 0.4497983753681183
The modified gen p mean: 0.44782161712646484, gen p mean: -0.7254868149757385, mean p set: 0.44830194115638733
loss_pred:0.026166807860136032, decouple_loss:0.010278335772454739
loss_pred:0.026417233049869537, decouple_loss:0.010635105893015862
loss_pred:0.026600906625390053, decouple_loss:0.010042891837656498
Iteration: 2253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480086863040924, gen p mean: -0.7268181443214417, mean p set: 0.4484889805316925
The modified gen p mean: 0.4478338658809662, gen p mean: -0.7368808388710022, mean p set: 0.4483141601085663
The modified gen p mean: 0.44861671328544617, gen p mean: -0.7343289852142334, mean p set: 0.44909700751304626
loss_pred:0.026526661589741707, decouple_loss:0.009876320138573647
loss_pred:0.026082230731844902, decouple_loss:0.010340205393731594
loss_pred:0.025609895586967468, decouple_loss:0.010370869189500809
Iteration: 2254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486769139766693, gen p mean: -0.7297667264938354, mean p set: 0.4491572082042694
The modified gen p mean: 0.4482285976409912, gen p mean: -0.7246751189231873, mean p set: 0.4487088918685913
The modified gen p mean: 0.448118656873703, gen p mean: -0.7290104031562805, mean p set: 0.4485989212989807
loss_pred:0.025929506868124008, decouple_loss:0.01078054029494524
loss_pred:0.025852015241980553, decouple_loss:0.010678473860025406
loss_pred:0.02758331410586834, decouple_loss:0.011023743078112602
Iteration: 2255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44885778427124023, gen p mean: -0.7373760938644409, mean p set: 0.44933804869651794
The modified gen p mean: 0.4487735331058502, gen p mean: -0.729962170124054, mean p set: 0.4492538273334503
The modified gen p mean: 0.4486500322818756, gen p mean: -0.7341843843460083, mean p set: 0.4491303265094757
loss_pred:0.025141002610325813, decouple_loss:0.010071054100990295
loss_pred:0.025971228256821632, decouple_loss:0.009964922443032265
loss_pred:0.026106588542461395, decouple_loss:0.010207599960267544
Iteration: 2256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853904843330383, gen p mean: -0.7285184264183044, mean p set: 0.44901934266090393
The modified gen p mean: 0.44741275906562805, gen p mean: -0.7166264057159424, mean p set: 0.44789305329322815
The modified gen p mean: 0.4476511776447296, gen p mean: -0.7211535573005676, mean p set: 0.4481314718723297
loss_pred:0.02613641880452633, decouple_loss:0.009796710684895515
loss_pred:0.026897182688117027, decouple_loss:0.010586071759462357
loss_pred:0.027428368106484413, decouple_loss:0.01009452436119318
Iteration: 2257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477007985115051, gen p mean: -0.7200095057487488, mean p set: 0.4481810927391052
The modified gen p mean: 0.44756242632865906, gen p mean: -0.716843843460083, mean p set: 0.44804272055625916
The modified gen p mean: 0.44885721802711487, gen p mean: -0.7245543003082275, mean p set: 0.44933751225471497
loss_pred:0.027126815170049667, decouple_loss:0.01043577492237091
loss_pred:0.02594420127570629, decouple_loss:0.010394067503511906
loss_pred:0.026733988896012306, decouple_loss:0.00991266593337059
Iteration: 2258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44864314794540405, gen p mean: -0.742536723613739, mean p set: 0.44912344217300415
The modified gen p mean: 0.44753071665763855, gen p mean: -0.7381181716918945, mean p set: 0.44801095128059387
The modified gen p mean: 0.44799745082855225, gen p mean: -0.7394542694091797, mean p set: 0.44847777485847473
loss_pred:0.024408388882875443, decouple_loss:0.010256029665470123
loss_pred:0.026167431846261024, decouple_loss:0.00996722187846899
loss_pred:0.02712036296725273, decouple_loss:0.009757437743246555
Iteration: 2259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44869518280029297, gen p mean: -0.7445411682128906, mean p set: 0.44917547702789307
The modified gen p mean: 0.44682613015174866, gen p mean: -0.7406886219978333, mean p set: 0.44730639457702637
The modified gen p mean: 0.4488367736339569, gen p mean: -0.7473620176315308, mean p set: 0.449317067861557
loss_pred:0.026779618114233017, decouple_loss:0.010019628331065178
loss_pred:0.026193156838417053, decouple_loss:0.009848466143012047
loss_pred:0.025973528623580933, decouple_loss:0.009921019896864891
Iteration: 2260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480818510055542, gen p mean: -0.7302818894386292, mean p set: 0.4485621154308319
The modified gen p mean: 0.44853323698043823, gen p mean: -0.7402436137199402, mean p set: 0.44901350140571594
The modified gen p mean: 0.4478819668292999, gen p mean: -0.7332757115364075, mean p set: 0.44836223125457764
loss_pred:0.02595597133040428, decouple_loss:0.009923960082232952
loss_pred:0.025494104251265526, decouple_loss:0.009515607729554176
loss_pred:0.026398951187729836, decouple_loss:0.009641491807997227
2023-05-03 05:22:05 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7412227392196655, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830237865448, gen p mean: -0.7343598008155823, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7299497723579407, mean p set: 0.45035696029663086
loss_pred:0.02710076980292797, decouple_loss:0.009955613873898983
loss_pred:0.026150379329919815, decouple_loss:0.009874784387648106
loss_pred:0.025781337171792984, decouple_loss:0.009645597077906132
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026835430413484573, avg_mse: 0.03198043629527092
current test mse: 0.03198
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 2261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476286470890045, gen p mean: -0.7486301064491272, mean p set: 0.4481089115142822
loss_pred:0.02693711221218109, decouple_loss:0.011315557174384594
The modified gen p mean: 0.4483945965766907, gen p mean: -0.7494393587112427, mean p set: 0.4488748610019684
loss_pred:0.026445524767041206, decouple_loss:0.01142678502947092
The modified gen p mean: 0.44793441891670227, gen p mean: -0.7438517212867737, mean p set: 0.44841471314430237
loss_pred:0.026985926553606987, decouple_loss:0.010212059132754803
Iteration: 2262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44970178604125977, gen p mean: -0.7440769076347351, mean p set: 0.45018208026885986
The modified gen p mean: 0.4471322298049927, gen p mean: -0.7320312261581421, mean p set: 0.4476125240325928
The modified gen p mean: 0.4468289613723755, gen p mean: -0.7335142493247986, mean p set: 0.447309285402298
loss_pred:0.024322235956788063, decouple_loss:0.009735209867358208
loss_pred:0.026207156479358673, decouple_loss:0.010032729245722294
loss_pred:0.02512250654399395, decouple_loss:0.009986631572246552
Iteration: 2263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483294188976288, gen p mean: -0.7278631329536438, mean p set: 0.4488097131252289
The modified gen p mean: 0.4485396146774292, gen p mean: -0.7273901700973511, mean p set: 0.4490198791027069
The modified gen p mean: 0.44678202271461487, gen p mean: -0.73265141248703, mean p set: 0.44726231694221497
loss_pred:0.02629394270479679, decouple_loss:0.009920845739543438
loss_pred:0.02646784670650959, decouple_loss:0.009962634183466434
loss_pred:0.027634259313344955, decouple_loss:0.010456543415784836
Iteration: 2264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482189118862152, gen p mean: -0.7377829551696777, mean p set: 0.4486992359161377
The modified gen p mean: 0.44823968410491943, gen p mean: -0.7269222736358643, mean p set: 0.44871997833251953
The modified gen p mean: 0.4480352997779846, gen p mean: -0.7315909266471863, mean p set: 0.4485156238079071
loss_pred:0.0263266172260046, decouple_loss:0.011717306450009346
loss_pred:0.025310000404715538, decouple_loss:0.010148726403713226
loss_pred:0.02520993910729885, decouple_loss:0.010696635581552982
Iteration: 2265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474222660064697, gen p mean: -0.7312443256378174, mean p set: 0.4479025602340698
The modified gen p mean: 0.4482154846191406, gen p mean: -0.7413032650947571, mean p set: 0.44869574904441833
The modified gen p mean: 0.4485644996166229, gen p mean: -0.7230079770088196, mean p set: 0.44904476404190063
loss_pred:0.025498585775494576, decouple_loss:0.009673239663243294
loss_pred:0.026613030582666397, decouple_loss:0.011125867255032063
loss_pred:0.02620577998459339, decouple_loss:0.00977460015565157
Iteration: 2266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475352168083191, gen p mean: -0.7368043661117554, mean p set: 0.4480155408382416
The modified gen p mean: 0.44812512397766113, gen p mean: -0.7298684120178223, mean p set: 0.44860541820526123
The modified gen p mean: 0.4474042057991028, gen p mean: -0.7314249277114868, mean p set: 0.4478845000267029
loss_pred:0.02763909474015236, decouple_loss:0.010521229356527328
loss_pred:0.026435310021042824, decouple_loss:0.009759768843650818
loss_pred:0.025122838094830513, decouple_loss:0.01020948588848114
Iteration: 2267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475904703140259, gen p mean: -0.7478840947151184, mean p set: 0.4480707347393036
The modified gen p mean: 0.44881513714790344, gen p mean: -0.7561384439468384, mean p set: 0.44929543137550354
The modified gen p mean: 0.44617778062820435, gen p mean: -0.7350996732711792, mean p set: 0.44665804505348206
loss_pred:0.026787595823407173, decouple_loss:0.010725396685302258
loss_pred:0.02595129795372486, decouple_loss:0.010591997765004635
loss_pred:0.025527508929371834, decouple_loss:0.010138781741261482
Iteration: 2268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468880593776703, gen p mean: -0.7427961230278015, mean p set: 0.447368323802948
The modified gen p mean: 0.4478377103805542, gen p mean: -0.7539867162704468, mean p set: 0.4483180344104767
The modified gen p mean: 0.4482479691505432, gen p mean: -0.7403681874275208, mean p set: 0.4487282633781433
loss_pred:0.026192976161837578, decouple_loss:0.01012448687106371
loss_pred:0.02611585147678852, decouple_loss:0.009485364891588688
loss_pred:0.02664903551340103, decouple_loss:0.010361483320593834
Iteration: 2269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469155967235565, gen p mean: -0.7405291199684143, mean p set: 0.4473958909511566
The modified gen p mean: 0.4482412338256836, gen p mean: -0.7445468902587891, mean p set: 0.4487214982509613
The modified gen p mean: 0.448089063167572, gen p mean: -0.7359777092933655, mean p set: 0.4485693573951721
loss_pred:0.02577505260705948, decouple_loss:0.009952818043529987
loss_pred:0.025771208107471466, decouple_loss:0.0100020756945014
loss_pred:0.024762354791164398, decouple_loss:0.009645994752645493
Iteration: 2270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472527801990509, gen p mean: -0.7370951175689697, mean p set: 0.4477330446243286
The modified gen p mean: 0.44904136657714844, gen p mean: -0.7453707456588745, mean p set: 0.44952166080474854
The modified gen p mean: 0.4476761221885681, gen p mean: -0.7396228909492493, mean p set: 0.4481564164161682
loss_pred:0.02567002736032009, decouple_loss:0.009695972315967083
loss_pred:0.025511614978313446, decouple_loss:0.01007501408457756
loss_pred:0.025767825543880463, decouple_loss:0.009800772182643414
2023-05-03 05:26:29 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7423450350761414, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7345512509346008, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987669587135315, gen p mean: -0.7308103442192078, mean p set: 0.45035696029663086
loss_pred:0.026798240840435028, decouple_loss:0.010161262936890125
loss_pred:0.025844085961580276, decouple_loss:0.010070491582155228
loss_pred:0.025701742619276047, decouple_loss:0.010205301456153393
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026621973142027855, avg_mse: 0.0316317193210125
current test mse: 0.031632
Iteration: 2271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447710245847702, gen p mean: -0.7414101958274841, mean p set: 0.4481905400753021
The modified gen p mean: 0.4492429792881012, gen p mean: -0.7504000067710876, mean p set: 0.4497232735157013
loss_pred:0.025871263816952705, decouple_loss:0.009651736356317997
loss_pred:0.02481846697628498, decouple_loss:0.010225240141153336
The modified gen p mean: 0.4495560824871063, gen p mean: -0.7424595952033997, mean p set: 0.4500364065170288
loss_pred:0.0249166302382946, decouple_loss:0.009943526238203049
Iteration: 2272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471646249294281, gen p mean: -0.7486287355422974, mean p set: 0.4476448595523834
The modified gen p mean: 0.4480734169483185, gen p mean: -0.7486565709114075, mean p set: 0.4485537111759186
The modified gen p mean: 0.44891947507858276, gen p mean: -0.7558172345161438, mean p set: 0.44939976930618286
loss_pred:0.026112712919712067, decouple_loss:0.009503304027020931
loss_pred:0.02673642337322235, decouple_loss:0.010456636548042297
loss_pred:0.02525435760617256, decouple_loss:0.011202311143279076
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44852304458618164, gen p mean: -0.7400870323181152, mean p set: 0.44900330901145935
The modified gen p mean: 0.4466460049152374, gen p mean: -0.7362543344497681, mean p set: 0.4471263289451599
The modified gen p mean: 0.44702863693237305, gen p mean: -0.7400080561637878, mean p set: 0.44750893115997314
loss_pred:0.024873461574316025, decouple_loss:0.009468873031437397
loss_pred:0.024949021637439728, decouple_loss:0.009546755813062191
loss_pred:0.0254987645894289, decouple_loss:0.009537412784993649
Iteration: 2274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44588345289230347, gen p mean: -0.7239372134208679, mean p set: 0.44636374711990356
The modified gen p mean: 0.4500880539417267, gen p mean: -0.7383443117141724, mean p set: 0.4505683481693268
The modified gen p mean: 0.4470553696155548, gen p mean: -0.7342227101325989, mean p set: 0.4475356340408325
loss_pred:0.025449611246585846, decouple_loss:0.010389258153736591
loss_pred:0.02454441599547863, decouple_loss:0.009194552898406982
loss_pred:0.025168990716338158, decouple_loss:0.009473614394664764
Iteration: 2275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784075021743774, gen p mean: -0.7428235411643982, mean p set: 0.44832107424736023
The modified gen p mean: 0.4483628273010254, gen p mean: -0.7448630928993225, mean p set: 0.4488431215286255
The modified gen p mean: 0.44795143604278564, gen p mean: -0.7290281653404236, mean p set: 0.44843170046806335
loss_pred:0.02638852410018444, decouple_loss:0.009743856266140938
loss_pred:0.025102896615862846, decouple_loss:0.009706802666187286
loss_pred:0.024838954210281372, decouple_loss:0.009079469367861748
Iteration: 2276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475768506526947, gen p mean: -0.7413424253463745, mean p set: 0.4480571746826172
The modified gen p mean: 0.4468555152416229, gen p mean: -0.7408297657966614, mean p set: 0.4473358392715454
The modified gen p mean: 0.44707077741622925, gen p mean: -0.7497676014900208, mean p set: 0.44755110144615173
loss_pred:0.025930585339665413, decouple_loss:0.008981220424175262
loss_pred:0.025175396353006363, decouple_loss:0.00922693032771349
loss_pred:0.026041120290756226, decouple_loss:0.009018778800964355
Iteration: 2277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464145600795746, gen p mean: -0.7329714298248291, mean p set: 0.4468948543071747
The modified gen p mean: 0.4466298222541809, gen p mean: -0.7402370572090149, mean p set: 0.447110116481781
The modified gen p mean: 0.4494439661502838, gen p mean: -0.7562813758850098, mean p set: 0.4499242305755615
loss_pred:0.024782270193099976, decouple_loss:0.009574763476848602
loss_pred:0.026646319776773453, decouple_loss:0.009516744874417782
loss_pred:0.024554399773478508, decouple_loss:0.010143382474780083
Iteration: 2278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501623511314392, gen p mean: -0.7542224526405334, mean p set: 0.4506426155567169
The modified gen p mean: 0.4461434781551361, gen p mean: -0.7283710241317749, mean p set: 0.4466237425804138
The modified gen p mean: 0.44700509309768677, gen p mean: -0.7377851605415344, mean p set: 0.4474853575229645
loss_pred:0.02418528124690056, decouple_loss:0.010056788101792336
loss_pred:0.02513769641518593, decouple_loss:0.0093843974173069
loss_pred:0.024530548602342606, decouple_loss:0.009087898768484592
Iteration: 2279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477846324443817, gen p mean: -0.7355726957321167, mean p set: 0.4482649564743042
The modified gen p mean: 0.44918563961982727, gen p mean: -0.7386501431465149, mean p set: 0.449665904045105
The modified gen p mean: 0.4477677047252655, gen p mean: -0.7370802760124207, mean p set: 0.4482479691505432
loss_pred:0.02556641586124897, decouple_loss:0.009295339696109295
loss_pred:0.02436218410730362, decouple_loss:0.00916277151554823
loss_pred:0.025721464306116104, decouple_loss:0.009461303241550922
Iteration: 2280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484304189682007, gen p mean: -0.7496988773345947, mean p set: 0.4489106833934784
The modified gen p mean: 0.4479919672012329, gen p mean: -0.7483435273170471, mean p set: 0.448472261428833
The modified gen p mean: 0.44800320267677307, gen p mean: -0.7339942455291748, mean p set: 0.4484834671020508
loss_pred:0.025752360001206398, decouple_loss:0.01004632655531168
loss_pred:0.024674154818058014, decouple_loss:0.009269041940569878
loss_pred:0.02531665377318859, decouple_loss:0.008850890211760998
2023-05-03 05:30:10 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7398229241371155, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7475065588951111, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7358860969543457, mean p set: 0.45035696029663086
loss_pred:0.02581700310111046, decouple_loss:0.009269976057112217
loss_pred:0.026762457564473152, decouple_loss:0.00930102076381445
loss_pred:0.0255536250770092, decouple_loss:0.009441870264708996
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026511242613196373, avg_mse: 0.03155013546347618
current test mse: 0.03155
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
NaN value num: 0
Iteration: 2281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45050284266471863, gen p mean: -0.7407713532447815, mean p set: 0.4509831368923187
loss_pred:0.02685423009097576, decouple_loss:0.010002265684306622
The modified gen p mean: 0.4533883035182953, gen p mean: -0.74476158618927, mean p set: 0.453868567943573
loss_pred:0.02591201290488243, decouple_loss:0.011431054212152958
The modified gen p mean: 0.4517233073711395, gen p mean: -0.7513733506202698, mean p set: 0.452203631401062
loss_pred:0.02636280283331871, decouple_loss:0.010337834246456623
Iteration: 2282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516680836677551, gen p mean: -0.7493906617164612, mean p set: 0.4521483778953552
The modified gen p mean: 0.4510711431503296, gen p mean: -0.7437477707862854, mean p set: 0.4515514075756073
The modified gen p mean: 0.45251035690307617, gen p mean: -0.7494618892669678, mean p set: 0.4529906213283539
loss_pred:0.026741623878479004, decouple_loss:0.010243718512356281
loss_pred:0.02665896527469158, decouple_loss:0.010132329538464546
loss_pred:0.02560601383447647, decouple_loss:0.010547642596065998
Iteration: 2283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45034050941467285, gen p mean: -0.7404990792274475, mean p set: 0.45082080364227295
The modified gen p mean: 0.44945889711380005, gen p mean: -0.7440868020057678, mean p set: 0.44993916153907776
The modified gen p mean: 0.45179039239883423, gen p mean: -0.7536720633506775, mean p set: 0.4522706866264343
loss_pred:0.025070559233427048, decouple_loss:0.010245190933346748
loss_pred:0.025517171248793602, decouple_loss:0.010562874376773834
loss_pred:0.026499958708882332, decouple_loss:0.009802546352148056
Iteration: 2284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510924220085144, gen p mean: -0.7564422488212585, mean p set: 0.4515727162361145
The modified gen p mean: 0.45154207944869995, gen p mean: -0.7509177923202515, mean p set: 0.4520223140716553
The modified gen p mean: 0.45203572511672974, gen p mean: -0.7536765933036804, mean p set: 0.45251601934432983
loss_pred:0.025537097826600075, decouple_loss:0.00976624432951212
loss_pred:0.0261353999376297, decouple_loss:0.00997135415673256
loss_pred:0.02547980472445488, decouple_loss:0.00965272169560194
Iteration: 2285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527937173843384, gen p mean: -0.746726393699646, mean p set: 0.4532740116119385
The modified gen p mean: 0.4494033455848694, gen p mean: -0.7461716532707214, mean p set: 0.4498836398124695
The modified gen p mean: 0.45086970925331116, gen p mean: -0.7521792054176331, mean p set: 0.45135000348091125
loss_pred:0.02540752664208412, decouple_loss:0.009988376870751381
loss_pred:0.026124121621251106, decouple_loss:0.00959444884210825
loss_pred:0.02552102506160736, decouple_loss:0.01009452436119318
Iteration: 2286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44968274235725403, gen p mean: -0.7476219534873962, mean p set: 0.4501630365848541
The modified gen p mean: 0.4494931399822235, gen p mean: -0.738502562046051, mean p set: 0.449973464012146
The modified gen p mean: 0.45370423793792725, gen p mean: -0.7384049892425537, mean p set: 0.45418456196784973
loss_pred:0.025248851627111435, decouple_loss:0.009886953979730606
loss_pred:0.02650703862309456, decouple_loss:0.009743050672113895
loss_pred:0.025797437876462936, decouple_loss:0.009880591183900833
Iteration: 2287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513101875782013, gen p mean: -0.7484721541404724, mean p set: 0.4517904818058014
The modified gen p mean: 0.452109694480896, gen p mean: -0.7460864186286926, mean p set: 0.4525899887084961
The modified gen p mean: 0.4499562680721283, gen p mean: -0.7474741339683533, mean p set: 0.4504365921020508
loss_pred:0.026632916182279587, decouple_loss:0.009707099758088589
loss_pred:0.025241883471608162, decouple_loss:0.00952396634966135
loss_pred:0.02516278624534607, decouple_loss:0.009750202298164368
Iteration: 2288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45193731784820557, gen p mean: -0.748424768447876, mean p set: 0.45241761207580566
The modified gen p mean: 0.4511794149875641, gen p mean: -0.7438918352127075, mean p set: 0.4516597390174866
The modified gen p mean: 0.4505032002925873, gen p mean: -0.738868772983551, mean p set: 0.4509834945201874
loss_pred:0.02576620876789093, decouple_loss:0.009674874134361744
loss_pred:0.025401875376701355, decouple_loss:0.009720862843096256
loss_pred:0.02583991549909115, decouple_loss:0.00985766015946865
Iteration: 2289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517621397972107, gen p mean: -0.7540891766548157, mean p set: 0.4522424042224884
The modified gen p mean: 0.45053043961524963, gen p mean: -0.7456250786781311, mean p set: 0.45101073384284973
The modified gen p mean: 0.45313549041748047, gen p mean: -0.7479899525642395, mean p set: 0.45361581444740295
loss_pred:0.025480573996901512, decouple_loss:0.009212275967001915
loss_pred:0.026728704571723938, decouple_loss:0.00962335616350174
loss_pred:0.02542547881603241, decouple_loss:0.009484727866947651
Iteration: 2290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497741162776947, gen p mean: -0.7443507313728333, mean p set: 0.4502543807029724
The modified gen p mean: 0.45151445269584656, gen p mean: -0.750618577003479, mean p set: 0.45199474692344666
The modified gen p mean: 0.45031842589378357, gen p mean: -0.7523113489151001, mean p set: 0.45079872012138367
loss_pred:0.02682274952530861, decouple_loss:0.009494664147496223
loss_pred:0.02498888410627842, decouple_loss:0.009196721017360687
loss_pred:0.02680576778948307, decouple_loss:0.009405522607266903
2023-05-03 05:34:36 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7432361245155334, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7503187656402588, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7390915751457214, mean p set: 0.45035696029663086
loss_pred:0.0260145366191864, decouple_loss:0.010131428018212318
loss_pred:0.027109770104289055, decouple_loss:0.010316909290850163
loss_pred:0.025731028988957405, decouple_loss:0.010114324279129505
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026794489473104477, avg_mse: 0.03203536942601204
current test mse: 0.032035
Iteration: 2291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517834484577179, gen p mean: -0.7444583773612976, mean p set: 0.452263742685318
The modified gen p mean: 0.4518151879310608, gen p mean: -0.7444503307342529, mean p set: 0.4522954225540161
loss_pred:0.025226062163710594, decouple_loss:0.009371044114232063
loss_pred:0.025220943614840508, decouple_loss:0.009796395897865295
The modified gen p mean: 0.4502943754196167, gen p mean: -0.746993362903595, mean p set: 0.4507746696472168
loss_pred:0.026825491338968277, decouple_loss:0.009347822517156601
Iteration: 2292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498800039291382, gen p mean: -0.7397253513336182, mean p set: 0.4503602981567383
The modified gen p mean: 0.4499293267726898, gen p mean: -0.7343850135803223, mean p set: 0.4504096210002899
The modified gen p mean: 0.4510827362537384, gen p mean: -0.7441743016242981, mean p set: 0.4515630006790161
loss_pred:0.025591682642698288, decouple_loss:0.009100726805627346
loss_pred:0.02637081779539585, decouple_loss:0.009370381012558937
loss_pred:0.025315962731838226, decouple_loss:0.009263684041798115
Iteration: 2293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45142197608947754, gen p mean: -0.7554776668548584, mean p set: 0.45190224051475525
The modified gen p mean: 0.45246824622154236, gen p mean: -0.7485374212265015, mean p set: 0.45294854044914246
The modified gen p mean: 0.45124033093452454, gen p mean: -0.7545680403709412, mean p set: 0.45172062516212463
loss_pred:0.026482319459319115, decouple_loss:0.009306812658905983
loss_pred:0.02524842880666256, decouple_loss:0.009898270480334759
loss_pred:0.02651960961520672, decouple_loss:0.008994494564831257
Iteration: 2294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502983093261719, gen p mean: -0.7464043498039246, mean p set: 0.450778603553772
The modified gen p mean: 0.4516625702381134, gen p mean: -0.7514384984970093, mean p set: 0.4521428644657135
The modified gen p mean: 0.4520491063594818, gen p mean: -0.7558375000953674, mean p set: 0.4525294005870819
loss_pred:0.025991469621658325, decouple_loss:0.009137976914644241
loss_pred:0.024898692965507507, decouple_loss:0.009096403606235981
loss_pred:0.02553478255867958, decouple_loss:0.009402872063219547
Iteration: 2295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500633776187897, gen p mean: -0.7507048845291138, mean p set: 0.45054367184638977
The modified gen p mean: 0.4504394233226776, gen p mean: -0.7491940259933472, mean p set: 0.4509196877479553
The modified gen p mean: 0.44928795099258423, gen p mean: -0.7473767399787903, mean p set: 0.4497682452201843
loss_pred:0.02484315074980259, decouple_loss:0.009005985222756863
loss_pred:0.026178346946835518, decouple_loss:0.009272754192352295
loss_pred:0.02596639283001423, decouple_loss:0.009310228750109673
Iteration: 2296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493976831436157, gen p mean: -0.7439510822296143, mean p set: 0.44987794756889343
The modified gen p mean: 0.45118770003318787, gen p mean: -0.754188597202301, mean p set: 0.45166799426078796
The modified gen p mean: 0.4511820375919342, gen p mean: -0.7526387572288513, mean p set: 0.4516623318195343
loss_pred:0.026152554899454117, decouple_loss:0.009169911034405231
loss_pred:0.025734486058354378, decouple_loss:0.009111817926168442
loss_pred:0.024870093911886215, decouple_loss:0.008951138705015182
Iteration: 2297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514254629611969, gen p mean: -0.7569085359573364, mean p set: 0.451905757188797
The modified gen p mean: 0.45180270075798035, gen p mean: -0.7580769062042236, mean p set: 0.45228299498558044
The modified gen p mean: 0.45172128081321716, gen p mean: -0.7540281414985657, mean p set: 0.45220157504081726
loss_pred:0.025777800008654594, decouple_loss:0.009201208129525185
loss_pred:0.02561075985431671, decouple_loss:0.009485805407166481
loss_pred:0.025149784982204437, decouple_loss:0.008803230710327625
Iteration: 2298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44981104135513306, gen p mean: -0.7450079321861267, mean p set: 0.45029133558273315
The modified gen p mean: 0.44959643483161926, gen p mean: -0.751710832118988, mean p set: 0.45007672905921936
The modified gen p mean: 0.4508695900440216, gen p mean: -0.7590738534927368, mean p set: 0.4513498842716217
loss_pred:0.02640882506966591, decouple_loss:0.009084363467991352
loss_pred:0.025689376518130302, decouple_loss:0.00873867329210043
loss_pred:0.024983922019600868, decouple_loss:0.009250021539628506
Iteration: 2299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498148560523987, gen p mean: -0.7576578855514526, mean p set: 0.4502951502799988
The modified gen p mean: 0.4508478045463562, gen p mean: -0.7521992921829224, mean p set: 0.4513280689716339
The modified gen p mean: 0.44962504506111145, gen p mean: -0.7534039616584778, mean p set: 0.45010536909103394
loss_pred:0.025201555341482162, decouple_loss:0.008931296877563
loss_pred:0.025027062743902206, decouple_loss:0.009337769821286201
loss_pred:0.025174813345074654, decouple_loss:0.00858171284198761
Iteration: 2300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493584632873535, gen p mean: -0.7439771294593811, mean p set: 0.4498387575149536
The modified gen p mean: 0.4508407413959503, gen p mean: -0.7550084590911865, mean p set: 0.4513210654258728
The modified gen p mean: 0.45099058747291565, gen p mean: -0.7490578293800354, mean p set: 0.45147088170051575
loss_pred:0.026166489347815514, decouple_loss:0.0090407095849514loss_pred:0.026018381118774414, decouple_loss:0.00943109579384327
loss_pred:0.024707669392228127, decouple_loss:0.009513482451438904
2023-05-03 05:38:20 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7472935914993286, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7399012446403503, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7361050844192505, mean p set: 0.45035696029663086
loss_pred:0.027080373838543892, decouple_loss:0.01010086014866829
loss_pred:0.02605867199599743, decouple_loss:0.010004520416259766
loss_pred:0.02565361186861992, decouple_loss:0.010137870907783508
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02676827274262905, avg_mse: 0.0319952666759491
current test mse: 0.031995
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 2301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483591914176941, gen p mean: -0.7399333715438843, mean p set: 0.4488394856452942
The modified gen p mean: 0.44847288727760315, gen p mean: -0.7367227077484131, mean p set: 0.44895321130752563
loss_pred:0.026350025087594986, decouple_loss:0.010487728752195835
loss_pred:0.025456512346863747, decouple_loss:0.010818131268024445
The modified gen p mean: 0.44874122738838196, gen p mean: -0.7381877303123474, mean p set: 0.44922152161598206
loss_pred:0.0267435684800148, decouple_loss:0.010086696594953537
Iteration: 2302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471077620983124, gen p mean: -0.7439624667167664, mean p set: 0.4475880563259125
The modified gen p mean: 0.44777509570121765, gen p mean: -0.7517974972724915, mean p set: 0.44825538992881775
The modified gen p mean: 0.4482533037662506, gen p mean: -0.7448804378509521, mean p set: 0.4487335979938507
loss_pred:0.02591816335916519, decouple_loss:0.010071045719087124
loss_pred:0.025469502434134483, decouple_loss:0.009998266585171223
loss_pred:0.02614644728600979, decouple_loss:0.00989464484155178
Iteration: 2303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494568407535553, gen p mean: -0.7719181180000305, mean p set: 0.4499371349811554
The modified gen p mean: 0.4486084580421448, gen p mean: -0.7666068077087402, mean p set: 0.4490887224674225
The modified gen p mean: 0.4491927921772003, gen p mean: -0.7648264169692993, mean p set: 0.4496730864048004
loss_pred:0.025632405653595924, decouple_loss:0.01067680586129427
loss_pred:0.025236032903194427, decouple_loss:0.010475645773112774
loss_pred:0.026287812739610672, decouple_loss:0.009791881777346134
Iteration: 2304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741371273994446, gen p mean: -0.7575410604476929, mean p set: 0.44789400696754456
The modified gen p mean: 0.4483295679092407, gen p mean: -0.7503978610038757, mean p set: 0.44880983233451843
The modified gen p mean: 0.4480414390563965, gen p mean: -0.760424792766571, mean p set: 0.44852176308631897
loss_pred:0.026774661615490913, decouple_loss:0.009526618756353855
loss_pred:0.02702529914677143, decouple_loss:0.009810399264097214
loss_pred:0.026340456679463387, decouple_loss:0.009329995140433311
Iteration: 2305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473778009414673, gen p mean: -0.7498443126678467, mean p set: 0.4478580951690674
The modified gen p mean: 0.44751811027526855, gen p mean: -0.7499674558639526, mean p set: 0.44799840450286865
The modified gen p mean: 0.4475441873073578, gen p mean: -0.7526059746742249, mean p set: 0.4480244815349579
loss_pred:0.025881411507725716, decouple_loss:0.009610502980649471
loss_pred:0.026568787172436714, decouple_loss:0.009545541368424892
loss_pred:0.025256047025322914, decouple_loss:0.0093450378626585
Iteration: 2306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44844356179237366, gen p mean: -0.7526811361312866, mean p set: 0.44892382621765137
The modified gen p mean: 0.4474125802516937, gen p mean: -0.7545014023780823, mean p set: 0.44789284467697144
The modified gen p mean: 0.4471968710422516, gen p mean: -0.7423304319381714, mean p set: 0.4476771950721741
loss_pred:0.02626626007258892, decouple_loss:0.009205340407788754
loss_pred:0.025819046422839165, decouple_loss:0.009140834212303162
loss_pred:0.027717608958482742, decouple_loss:0.009396456182003021
Iteration: 2307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784730672836304, gen p mean: -0.7513318061828613, mean p set: 0.44832760095596313
The modified gen p mean: 0.44813817739486694, gen p mean: -0.7479923367500305, mean p set: 0.44861847162246704
The modified gen p mean: 0.44771498441696167, gen p mean: -0.7505516409873962, mean p set: 0.44819530844688416
loss_pred:0.025969617068767548, decouple_loss:0.00946879480034113
loss_pred:0.02503427490592003, decouple_loss:0.009427427314221859
loss_pred:0.026401164010167122, decouple_loss:0.00941335130482912
Iteration: 2308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710564613342285, gen p mean: -0.7524130344390869, mean p set: 0.44758591055870056
The modified gen p mean: 0.4476041793823242, gen p mean: -0.7476871609687805, mean p set: 0.4480845034122467
The modified gen p mean: 0.44809481501579285, gen p mean: -0.7477895021438599, mean p set: 0.44857507944107056
loss_pred:0.025226669386029243, decouple_loss:0.009351197630167007
loss_pred:0.027202485129237175, decouple_loss:0.009522038511931896
loss_pred:0.024628423154354095, decouple_loss:0.009504956193268299
Iteration: 2309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841107726097107, gen p mean: -0.7506431937217712, mean p set: 0.4488913416862488
The modified gen p mean: 0.44841238856315613, gen p mean: -0.75019770860672, mean p set: 0.4488926827907562
The modified gen p mean: 0.447279691696167, gen p mean: -0.7537481784820557, mean p set: 0.4477599561214447
loss_pred:0.026911022141575813, decouple_loss:0.009151383303105831
loss_pred:0.026162084192037582, decouple_loss:0.009469914250075817
loss_pred:0.024563251063227654, decouple_loss:0.009294291026890278
Iteration: 2310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44870465993881226, gen p mean: -0.748782217502594, mean p set: 0.44918495416641235
The modified gen p mean: 0.45037969946861267, gen p mean: -0.77140212059021, mean p set: 0.4508599638938904
The modified gen p mean: 0.44714847207069397, gen p mean: -0.7492234110832214, mean p set: 0.44762876629829407
loss_pred:0.02506229281425476, decouple_loss:0.009328660555183887
loss_pred:0.0254202913492918, decouple_loss:0.010095806792378426
loss_pred:0.027617428451776505, decouple_loss:0.009038425981998444
2023-05-03 05:42:44 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7510265111923218, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7587394714355469, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7470048069953918, mean p set: 0.45035696029663086
loss_pred:0.025877168402075768, decouple_loss:0.00953455176204443
loss_pred:0.026787839829921722, decouple_loss:0.009799642488360405
loss_pred:0.02561899460852146, decouple_loss:0.009510144591331482
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02657540701329708, avg_mse: 0.031708698719739914
current test mse: 0.031709
Iteration: 2311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484139084815979, gen p mean: -0.7526761293411255, mean p set: 0.448894202709198
loss_pred:0.026571277529001236, decouple_loss:0.008793621324002743
The modified gen p mean: 0.4486619234085083, gen p mean: -0.7475815415382385, mean p set: 0.4491422176361084
loss_pred:0.026025351136922836, decouple_loss:0.009400450624525547
The modified gen p mean: 0.44995635747909546, gen p mean: -0.7495958805084229, mean p set: 0.45043665170669556
loss_pred:0.02583392523229122, decouple_loss:0.009361186996102333
Iteration: 2312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44824665784835815, gen p mean: -0.7439537644386292, mean p set: 0.44872695207595825
The modified gen p mean: 0.44768255949020386, gen p mean: -0.749331533908844, mean p set: 0.44816285371780396
The modified gen p mean: 0.4478241801261902, gen p mean: -0.7387756109237671, mean p set: 0.4483044445514679
loss_pred:0.02433914691209793, decouple_loss:0.008933828212320805loss_pred:0.026542598381638527, decouple_loss:0.008792302571237087
loss_pred:0.026401327922940254, decouple_loss:0.00910206139087677
Iteration: 2313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473952651023865, gen p mean: -0.7476773858070374, mean p set: 0.4478755593299866
The modified gen p mean: 0.4480275809764862, gen p mean: -0.7458153367042542, mean p set: 0.4485079050064087
The modified gen p mean: 0.447377473115921, gen p mean: -0.7521359920501709, mean p set: 0.44785773754119873
loss_pred:0.02436911128461361, decouple_loss:0.008884372189640999
loss_pred:0.025720324367284775, decouple_loss:0.008825227618217468
loss_pred:0.025320200249552727, decouple_loss:0.009076184593141079
Iteration: 2314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479374587535858, gen p mean: -0.7535321712493896, mean p set: 0.4484177529811859
The modified gen p mean: 0.4476287364959717, gen p mean: -0.7528676390647888, mean p set: 0.4481090009212494
The modified gen p mean: 0.4472081959247589, gen p mean: -0.7494109869003296, mean p set: 0.447688490152359
loss_pred:0.02675524912774563, decouple_loss:0.008907685987651348
loss_pred:0.025438357144594193, decouple_loss:0.00856843963265419
loss_pred:0.02576095424592495, decouple_loss:0.008832959458231926
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785621762275696, gen p mean: -0.7499974370002747, mean p set: 0.44833654165267944
The modified gen p mean: 0.44756534695625305, gen p mean: -0.7459394931793213, mean p set: 0.44804567098617554
The modified gen p mean: 0.4481653571128845, gen p mean: -0.7473911046981812, mean p set: 0.4486456513404846
loss_pred:0.026009606197476387, decouple_loss:0.0087113743647933
loss_pred:0.025489680469036102, decouple_loss:0.008651629090309143
loss_pred:0.02692294307053089, decouple_loss:0.009244699031114578
Iteration: 2316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481275677680969, gen p mean: -0.7478832006454468, mean p set: 0.44860783219337463
The modified gen p mean: 0.44828885793685913, gen p mean: -0.7444102168083191, mean p set: 0.44876912236213684
The modified gen p mean: 0.44823116064071655, gen p mean: -0.7427833676338196, mean p set: 0.44871145486831665
loss_pred:0.024952583014965057, decouple_loss:0.008658645674586296
loss_pred:0.026816582307219505, decouple_loss:0.008480696938931942
loss_pred:0.02684335596859455, decouple_loss:0.008787116967141628
Iteration: 2317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495103657245636, gen p mean: -0.7510495185852051, mean p set: 0.4499906599521637
The modified gen p mean: 0.44772955775260925, gen p mean: -0.7530480623245239, mean p set: 0.44820985198020935
The modified gen p mean: 0.4497060775756836, gen p mean: -0.7626763582229614, mean p set: 0.4501863420009613
loss_pred:0.025882024317979813, decouple_loss:0.00834723375737667
loss_pred:0.02624274045228958, decouple_loss:0.0085369274020195
loss_pred:0.02540680766105652, decouple_loss:0.009290388785302639
Iteration: 2318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750773906707764, gen p mean: -0.7457243204116821, mean p set: 0.44798803329467773
The modified gen p mean: 0.44851943850517273, gen p mean: -0.7456569671630859, mean p set: 0.4489997327327728
The modified gen p mean: 0.44860878586769104, gen p mean: -0.7468424439430237, mean p set: 0.44908908009529114
loss_pred:0.024766912683844566, decouple_loss:0.008971945382654667
loss_pred:0.024954218417406082, decouple_loss:0.008793477900326252
loss_pred:0.026499798521399498, decouple_loss:0.008851030841469765
Iteration: 2319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477750062942505, gen p mean: -0.7424414157867432, mean p set: 0.4482552707195282
The modified gen p mean: 0.4491872787475586, gen p mean: -0.7395742535591125, mean p set: 0.4496676027774811
The modified gen p mean: 0.4482789933681488, gen p mean: -0.7405325770378113, mean p set: 0.4487592875957489
loss_pred:0.027081066742539406, decouple_loss:0.008782957680523396
loss_pred:0.02609851397573948, decouple_loss:0.00890354160219431
loss_pred:0.026805873960256577, decouple_loss:0.008548117242753506
Iteration: 2320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473389685153961, gen p mean: -0.7476146817207336, mean p set: 0.4478192627429962
The modified gen p mean: 0.4485880732536316, gen p mean: -0.7440226674079895, mean p set: 0.4490683674812317
The modified gen p mean: 0.44821539521217346, gen p mean: -0.7394353151321411, mean p set: 0.44869568943977356
loss_pred:0.023834113031625748, decouple_loss:0.008432290516793728
loss_pred:0.02525930292904377, decouple_loss:0.008135773241519928
loss_pred:0.026247084140777588, decouple_loss:0.008710145018994808
2023-05-03 05:46:25 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7452844977378845, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7523821592330933, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7407979369163513, mean p set: 0.45035696029663086
loss_pred:0.025778505951166153, decouple_loss:0.009143522009253502
loss_pred:0.026741379871964455, decouple_loss:0.009228271432220936
loss_pred:0.025506021454930305, decouple_loss:0.00892900675535202
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026463650166988373, avg_mse: 0.03162856772542
current test mse: 0.031629
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
NaN value num: 0
Iteration: 2321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486970007419586, gen p mean: -0.7486186623573303, mean p set: 0.44917726516723633
The modified gen p mean: 0.4479564130306244, gen p mean: -0.7398170828819275, mean p set: 0.4484367072582245
loss_pred:0.026991769671440125, decouple_loss:0.009127028286457062
loss_pred:0.027419619262218475, decouple_loss:0.009028046391904354
The modified gen p mean: 0.44962507486343384, gen p mean: -0.753433346748352, mean p set: 0.45010536909103394
loss_pred:0.02791045606136322, decouple_loss:0.00967473816126585
Iteration: 2322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877147674560547, gen p mean: -0.7621906399726868, mean p set: 0.44925177097320557
The modified gen p mean: 0.4475134313106537, gen p mean: -0.7546255588531494, mean p set: 0.4479937255382538
The modified gen p mean: 0.4489491581916809, gen p mean: -0.7600088715553284, mean p set: 0.4494294226169586
loss_pred:0.027573194354772568, decouple_loss:0.009466544725000858
loss_pred:0.027052829042077065, decouple_loss:0.008912630379199982
loss_pred:0.028077583760023117, decouple_loss:0.00990639440715313
Iteration: 2323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491023123264313, gen p mean: -0.7671092748641968, mean p set: 0.44958263635635376
The modified gen p mean: 0.4507370591163635, gen p mean: -0.7791702151298523, mean p set: 0.451217383146286
The modified gen p mean: 0.4501849412918091, gen p mean: -0.77003413438797, mean p set: 0.4506652057170868
loss_pred:0.02706046774983406, decouple_loss:0.009389523416757584
loss_pred:0.02671840228140354, decouple_loss:0.009318416938185692
loss_pred:0.02625533752143383, decouple_loss:0.008829879574477673
Iteration: 2324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45038357377052307, gen p mean: -0.7695654630661011, mean p set: 0.4508638381958008
The modified gen p mean: 0.447001188993454, gen p mean: -0.7636952996253967, mean p set: 0.4474814832210541
The modified gen p mean: 0.44922003149986267, gen p mean: -0.7693163752555847, mean p set: 0.44970032572746277
loss_pred:0.025847073644399643, decouple_loss:0.008852336555719376
loss_pred:0.027339134365320206, decouple_loss:0.008927165530622005
loss_pred:0.027050023898482323, decouple_loss:0.009082311764359474
Iteration: 2325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856566190719604, gen p mean: -0.7601251602172852, mean p set: 0.44904592633247375
The modified gen p mean: 0.44730865955352783, gen p mean: -0.7495079040527344, mean p set: 0.44778892397880554
The modified gen p mean: 0.4497879445552826, gen p mean: -0.7649660706520081, mean p set: 0.4502682387828827
loss_pred:0.02819846011698246, decouple_loss:0.00874432735145092
loss_pred:0.027043238282203674, decouple_loss:0.008958246558904648
loss_pred:0.027348699048161507, decouple_loss:0.009136524051427841
Iteration: 2326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840848445892334, gen p mean: -0.7540403604507446, mean p set: 0.44888877868652344
The modified gen p mean: 0.4484054744243622, gen p mean: -0.7548068761825562, mean p set: 0.4488857388496399
The modified gen p mean: 0.44869565963745117, gen p mean: -0.7556126117706299, mean p set: 0.44917601346969604
loss_pred:0.02652369625866413, decouple_loss:0.00891081802546978
loss_pred:0.027198737487196922, decouple_loss:0.00906220730394125
loss_pred:0.028245095163583755, decouple_loss:0.008738186210393906
Iteration: 2327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948771595954895, gen p mean: -0.7501376271247864, mean p set: 0.44996798038482666
The modified gen p mean: 0.4486750662326813, gen p mean: -0.7508850693702698, mean p set: 0.44915536046028137
The modified gen p mean: 0.4476543366909027, gen p mean: -0.7389524579048157, mean p set: 0.4481346309185028
loss_pred:0.027508828788995743, decouple_loss:0.0088612399995327
loss_pred:0.027719072997570038, decouple_loss:0.008872182108461857
loss_pred:0.027838971465826035, decouple_loss:0.009080788120627403
Iteration: 2328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44981130957603455, gen p mean: -0.7528442740440369, mean p set: 0.45029157400131226
The modified gen p mean: 0.44855383038520813, gen p mean: -0.7453240752220154, mean p set: 0.4490341246128082
The modified gen p mean: 0.45018404722213745, gen p mean: -0.7585633397102356, mean p set: 0.45066434144973755
loss_pred:0.027458781376481056, decouple_loss:0.00875559076666832loss_pred:0.025984812527894974, decouple_loss:0.0090576047077775
loss_pred:0.027352452278137207, decouple_loss:0.009332445450127125
Iteration: 2329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799813628196716, gen p mean: -0.7379226684570312, mean p set: 0.44847843050956726
The modified gen p mean: 0.4482823610305786, gen p mean: -0.7472296357154846, mean p set: 0.4487626254558563
The modified gen p mean: 0.4484270215034485, gen p mean: -0.7455679178237915, mean p set: 0.4489073157310486
loss_pred:0.027073659002780914, decouple_loss:0.009050902910530567
loss_pred:0.026339512318372726, decouple_loss:0.008610713295638561
loss_pred:0.027233492583036423, decouple_loss:0.00845490861684084
Iteration: 2330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485194683074951, gen p mean: -0.7426246404647827, mean p set: 0.4489997923374176
The modified gen p mean: 0.4478062689304352, gen p mean: -0.7314274907112122, mean p set: 0.4482865631580353
The modified gen p mean: 0.4493502676486969, gen p mean: -0.7439371943473816, mean p set: 0.449830561876297
loss_pred:0.027122369036078453, decouple_loss:0.0084496159106493
loss_pred:0.027644403278827667, decouple_loss:0.008640249259769917
loss_pred:0.02693869173526764, decouple_loss:0.00843899417668581
2023-05-03 05:50:51 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7374097108840942, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7447924017906189, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7329345345497131, mean p set: 0.45035696029663086
loss_pred:0.025879452005028725, decouple_loss:0.009129598736763
loss_pred:0.02674013003706932, decouple_loss:0.009395207278430462
loss_pred:0.025602245703339577, decouple_loss:0.00908401794731617
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02653409168124199, avg_mse: 0.03178262338042259
current test mse: 0.031783
Iteration: 2331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474480450153351, gen p mean: -0.7393729090690613, mean p set: 0.4479283094406128
The modified gen p mean: 0.44943666458129883, gen p mean: -0.7338188290596008, mean p set: 0.44991692900657654
loss_pred:0.027079487219452858, decouple_loss:0.008625900372862816
loss_pred:0.028717443346977234, decouple_loss:0.009120448492467403
The modified gen p mean: 0.44901084899902344, gen p mean: -0.7433665990829468, mean p set: 0.44949114322662354
loss_pred:0.02684520184993744, decouple_loss:0.008842852897942066
Iteration: 2332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487094581127167, gen p mean: -0.7458407282829285, mean p set: 0.4491897523403168
The modified gen p mean: 0.4491068422794342, gen p mean: -0.7447950839996338, mean p set: 0.4495871365070343
The modified gen p mean: 0.45032188296318054, gen p mean: -0.7520543336868286, mean p set: 0.45080211758613586
loss_pred:0.0270833820104599, decouple_loss:0.008734256029129028
loss_pred:0.027766292914748192, decouple_loss:0.008752766996622086
loss_pred:0.026960495859384537, decouple_loss:0.00932406634092331
Iteration: 2333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490993618965149, gen p mean: -0.7534905076026917, mean p set: 0.449579656124115
The modified gen p mean: 0.4469609558582306, gen p mean: -0.7467554807662964, mean p set: 0.4474412202835083
The modified gen p mean: 0.449436753988266, gen p mean: -0.7570234537124634, mean p set: 0.4499170780181885
loss_pred:0.027582164853811264, decouple_loss:0.00869719497859478
loss_pred:0.027392396703362465, decouple_loss:0.00850487407296896
loss_pred:0.026437360793352127, decouple_loss:0.008638476021587849
Iteration: 2334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45001980662345886, gen p mean: -0.7554528117179871, mean p set: 0.4505000710487366
The modified gen p mean: 0.4490557014942169, gen p mean: -0.7549484372138977, mean p set: 0.44953596591949463
The modified gen p mean: 0.4493815302848816, gen p mean: -0.7561143636703491, mean p set: 0.4498618543148041
loss_pred:0.027328073978424072, decouple_loss:0.009034178219735622
loss_pred:0.027212858200073242, decouple_loss:0.008779543451964855
loss_pred:0.02610670030117035, decouple_loss:0.008715851232409477
Iteration: 2335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487400949001312, gen p mean: -0.7426628470420837, mean p set: 0.4492203891277313
The modified gen p mean: 0.447456419467926, gen p mean: -0.7430161833763123, mean p set: 0.4479367434978485
The modified gen p mean: 0.44697052240371704, gen p mean: -0.7432569861412048, mean p set: 0.44745081663131714
loss_pred:0.02658720687031746, decouple_loss:0.008793311193585396
loss_pred:0.02625320479273796, decouple_loss:0.008641188964247704
loss_pred:0.02694076858460903, decouple_loss:0.008669066242873669
Iteration: 2336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495875835418701, gen p mean: -0.7450577616691589, mean p set: 0.4500678777694702
The modified gen p mean: 0.4491044878959656, gen p mean: -0.7507721781730652, mean p set: 0.4495847821235657
The modified gen p mean: 0.44899827241897583, gen p mean: -0.7370742559432983, mean p set: 0.4494785666465759
loss_pred:0.026530761271715164, decouple_loss:0.009020334109663963
loss_pred:0.02652961201965809, decouple_loss:0.008544659242033958
loss_pred:0.02791176550090313, decouple_loss:0.008778316900134087
Iteration: 2337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44958388805389404, gen p mean: -0.7360044121742249, mean p set: 0.45006415247917175
The modified gen p mean: 0.447858601808548, gen p mean: -0.7291199564933777, mean p set: 0.44833892583847046
The modified gen p mean: 0.44989821314811707, gen p mean: -0.7458545565605164, mean p set: 0.45037850737571716
loss_pred:0.028357990086078644, decouple_loss:0.008853978477418423
loss_pred:0.027519838884472847, decouple_loss:0.00855704490095377
loss_pred:0.02713189087808132, decouple_loss:0.008762475103139877
Iteration: 2338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44954657554626465, gen p mean: -0.7452378273010254, mean p set: 0.45002689957618713
The modified gen p mean: 0.44789648056030273, gen p mean: -0.737794816493988, mean p set: 0.44837674498558044
The modified gen p mean: 0.4475889503955841, gen p mean: -0.7363057136535645, mean p set: 0.4480692446231842
loss_pred:0.027670681476593018, decouple_loss:0.0090304184705019
loss_pred:0.02571084164083004, decouple_loss:0.008899882435798645
loss_pred:0.026476796716451645, decouple_loss:0.008660309948027134
Iteration: 2339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487517476081848, gen p mean: -0.7450623512268066, mean p set: 0.4492320418357849
The modified gen p mean: 0.45017313957214355, gen p mean: -0.7609228491783142, mean p set: 0.45065340399742126
The modified gen p mean: 0.44915780425071716, gen p mean: -0.751834511756897, mean p set: 0.44963809847831726
loss_pred:0.026724889874458313, decouple_loss:0.008995136246085167
loss_pred:0.026659460738301277, decouple_loss:0.009100236929953098
loss_pred:0.026683637872338295, decouple_loss:0.008484944701194763
Iteration: 2340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495446979999542, gen p mean: -0.7533093690872192, mean p set: 0.45002496242523193
The modified gen p mean: 0.44812843203544617, gen p mean: -0.7445732951164246, mean p set: 0.44860872626304626
The modified gen p mean: 0.4493086040019989, gen p mean: -0.7454886436462402, mean p set: 0.449788898229599
loss_pred:0.027348361909389496, decouple_loss:0.00818254891782999
loss_pred:0.025779392570257187, decouple_loss:0.00881502777338028
loss_pred:0.02754058688879013, decouple_loss:0.008672078140079975
2023-05-03 05:54:33 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7482529282569885, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7555209994316101, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7439602017402649, mean p set: 0.45035696029663086
loss_pred:0.025968143716454506, decouple_loss:0.009206718765199184
loss_pred:0.02702947147190571, decouple_loss:0.009533359669148922
loss_pred:0.025641467422246933, decouple_loss:0.009212696924805641
WV_0_PC_1_EH_0_PS_40_6, loss: 0.0266789048910141, avg_mse: 0.032053373754024506
current test mse: 0.032053
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
NaN value num: 0
Iteration: 2341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45209985971450806, gen p mean: -0.7523275017738342, mean p set: 0.45258012413978577
loss_pred:0.026917660608887672, decouple_loss:0.009732844308018684
The modified gen p mean: 0.4509027898311615, gen p mean: -0.7652498483657837, mean p set: 0.4513830542564392
loss_pred:0.027452265843749046, decouple_loss:0.009391538798809052
The modified gen p mean: 0.4513819217681885, gen p mean: -0.7497242093086243, mean p set: 0.4518622159957886
loss_pred:0.026078375056385994, decouple_loss:0.00924009270966053
Iteration: 2342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510059058666229, gen p mean: -0.7504943609237671, mean p set: 0.45148617029190063
The modified gen p mean: 0.4512471556663513, gen p mean: -0.7584751844406128, mean p set: 0.45172742009162903
The modified gen p mean: 0.4513143301010132, gen p mean: -0.7458994388580322, mean p set: 0.4517945945262909
loss_pred:0.02588086947798729, decouple_loss:0.009373042732477188
loss_pred:0.026777606457471848, decouple_loss:0.009506896138191223
loss_pred:0.024607857689261436, decouple_loss:0.00910400040447712
Iteration: 2343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511990249156952, gen p mean: -0.7452949285507202, mean p set: 0.4516793489456177
The modified gen p mean: 0.45028239488601685, gen p mean: -0.7504581212997437, mean p set: 0.45076268911361694
The modified gen p mean: 0.45221850275993347, gen p mean: -0.7496464252471924, mean p set: 0.45269879698753357
loss_pred:0.02708417922258377, decouple_loss:0.008974937722086906
loss_pred:0.027206452563405037, decouple_loss:0.008838058449327946
loss_pred:0.025135651230812073, decouple_loss:0.008952847681939602
Iteration: 2344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45191705226898193, gen p mean: -0.7524811625480652, mean p set: 0.45239734649658203
The modified gen p mean: 0.45155471563339233, gen p mean: -0.7553713917732239, mean p set: 0.45203498005867004
The modified gen p mean: 0.45116761326789856, gen p mean: -0.7471515536308289, mean p set: 0.45164790749549866
loss_pred:0.024860933423042297, decouple_loss:0.008936531841754913
loss_pred:0.02720974013209343, decouple_loss:0.009723473340272903
loss_pred:0.026220053434371948, decouple_loss:0.008894580416381359
Iteration: 2345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45060622692108154, gen p mean: -0.7491190433502197, mean p set: 0.45108652114868164
The modified gen p mean: 0.4510226845741272, gen p mean: -0.7538195252418518, mean p set: 0.4515029489994049
The modified gen p mean: 0.45155277848243713, gen p mean: -0.7565734386444092, mean p set: 0.4520331025123596
loss_pred:0.027879435569047928, decouple_loss:0.009517897851765156
loss_pred:0.024510866031050682, decouple_loss:0.008683892898261547
loss_pred:0.02715190313756466, decouple_loss:0.009137645363807678
Iteration: 2346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527597725391388, gen p mean: -0.7566425800323486, mean p set: 0.4532400667667389
The modified gen p mean: 0.45191532373428345, gen p mean: -0.7603868842124939, mean p set: 0.45239561796188354
The modified gen p mean: 0.45036372542381287, gen p mean: -0.7521656155586243, mean p set: 0.4508439898490906
loss_pred:0.02771443873643875, decouple_loss:0.009563744999468327
loss_pred:0.025322306901216507, decouple_loss:0.008645692840218544
loss_pred:0.02441457472741604, decouple_loss:0.00919180829077959
Iteration: 2347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45133718848228455, gen p mean: -0.7505963444709778, mean p set: 0.45181748270988464
The modified gen p mean: 0.450927734375, gen p mean: -0.7521533370018005, mean p set: 0.4514080286026001
The modified gen p mean: 0.45139768719673157, gen p mean: -0.7581733465194702, mean p set: 0.45187801122665405
loss_pred:0.027195565402507782, decouple_loss:0.008975197561085224
loss_pred:0.027670787647366524, decouple_loss:0.00896771065890789
loss_pred:0.02728213556110859, decouple_loss:0.009667357429862022
Iteration: 2348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507334530353546, gen p mean: -0.7629137635231018, mean p set: 0.4512137174606323
The modified gen p mean: 0.4509143531322479, gen p mean: -0.7709730267524719, mean p set: 0.4513946771621704
The modified gen p mean: 0.45057252049446106, gen p mean: -0.7628366947174072, mean p set: 0.45105281472206116
loss_pred:0.02470136620104313, decouple_loss:0.00966937281191349
loss_pred:0.026048341765999794, decouple_loss:0.009230095893144608
loss_pred:0.02430497296154499, decouple_loss:0.009203799068927765
Iteration: 2349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45290446281433105, gen p mean: -0.7789961099624634, mean p set: 0.45338475704193115
The modified gen p mean: 0.4506426155567169, gen p mean: -0.7733641862869263, mean p set: 0.4511229395866394
The modified gen p mean: 0.4512058198451996, gen p mean: -0.7719087600708008, mean p set: 0.4516860842704773
loss_pred:0.026781098917126656, decouple_loss:0.009465704672038555
loss_pred:0.026555361226201057, decouple_loss:0.00938783586025238
loss_pred:0.026430783793330193, decouple_loss:0.009098262526094913
Iteration: 2350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518135190010071, gen p mean: -0.7605925798416138, mean p set: 0.4522937834262848
The modified gen p mean: 0.4523986279964447, gen p mean: -0.7626646161079407, mean p set: 0.4528789222240448
The modified gen p mean: 0.45093539357185364, gen p mean: -0.7686277627944946, mean p set: 0.45141565799713135
loss_pred:0.024247918277978897, decouple_loss:0.00919977854937315
loss_pred:0.025023164227604866, decouple_loss:0.00934133306145668
loss_pred:0.02742151916027069, decouple_loss:0.009506997652351856
2023-05-03 05:58:54 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7620621919631958, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7543728947639465, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.749481201171875, mean p set: 0.45035696029663086
loss_pred:0.02721918746829033, decouple_loss:0.01014257688075304
loss_pred:0.02617068774998188, decouple_loss:0.010001657530665398
loss_pred:0.02586074359714985, decouple_loss:0.010021001100540161
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02691962569952011, avg_mse: 0.03221940994262695
current test mse: 0.032219
Iteration: 2351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517457187175751, gen p mean: -0.7501885890960693, mean p set: 0.45222604274749756
loss_pred:0.027921872213482857, decouple_loss:0.009621545672416687
The modified gen p mean: 0.4524074196815491, gen p mean: -0.7505572438240051, mean p set: 0.45288771390914917
loss_pred:0.0280456505715847, decouple_loss:0.009192030876874924
The modified gen p mean: 0.4500422775745392, gen p mean: -0.7478757500648499, mean p set: 0.45052260160446167
loss_pred:0.02565748803317547, decouple_loss:0.00915476307272911
Iteration: 2352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45163244009017944, gen p mean: -0.7542736530303955, mean p set: 0.45211273431777954
The modified gen p mean: 0.45039984583854675, gen p mean: -0.7518997192382812, mean p set: 0.45088016986846924
The modified gen p mean: 0.4509257674217224, gen p mean: -0.7500232458114624, mean p set: 0.4514060616493225
loss_pred:0.02760903723537922, decouple_loss:0.009636183269321918
loss_pred:0.02645079791545868, decouple_loss:0.009425526484847069
loss_pred:0.027829794213175774, decouple_loss:0.00987717229872942
Iteration: 2353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510725140571594, gen p mean: -0.7552580833435059, mean p set: 0.4515528082847595
The modified gen p mean: 0.45118051767349243, gen p mean: -0.7492902874946594, mean p set: 0.45166081190109253
The modified gen p mean: 0.45149075984954834, gen p mean: -0.7548918724060059, mean p set: 0.45197105407714844
loss_pred:0.027763396501541138, decouple_loss:0.009482748806476593
loss_pred:0.025446606799960136, decouple_loss:0.009186837822198868
loss_pred:0.025894228368997574, decouple_loss:0.009324556216597557
Iteration: 2354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45133134722709656, gen p mean: -0.7545303106307983, mean p set: 0.45181164145469666
The modified gen p mean: 0.4510252773761749, gen p mean: -0.7501593232154846, mean p set: 0.451505571603775
The modified gen p mean: 0.45149368047714233, gen p mean: -0.7508614659309387, mean p set: 0.45197397470474243
loss_pred:0.027483301237225533, decouple_loss:0.009290066547691822
loss_pred:0.026284655556082726, decouple_loss:0.00883403792977333
loss_pred:0.024112852290272713, decouple_loss:0.008944311179220676
Iteration: 2355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45230168104171753, gen p mean: -0.7461715340614319, mean p set: 0.45278200507164
The modified gen p mean: 0.4528945982456207, gen p mean: -0.7476600408554077, mean p set: 0.45337486267089844
The modified gen p mean: 0.45126789808273315, gen p mean: -0.7472761273384094, mean p set: 0.45174819231033325
loss_pred:0.02623167634010315, decouple_loss:0.009380004368722439
loss_pred:0.025320295244455338, decouple_loss:0.009133574552834034
loss_pred:0.02699810266494751, decouple_loss:0.009717458859086037
Iteration: 2356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510195255279541, gen p mean: -0.7444508075714111, mean p set: 0.4514998197555542
The modified gen p mean: 0.45060819387435913, gen p mean: -0.7465572357177734, mean p set: 0.45108845829963684
The modified gen p mean: 0.4494110643863678, gen p mean: -0.7372153997421265, mean p set: 0.4498913586139679
loss_pred:0.027425890788435936, decouple_loss:0.00965818390250206
loss_pred:0.02595389448106289, decouple_loss:0.009408712387084961
loss_pred:0.02458290569484234, decouple_loss:0.009386807680130005
Iteration: 2357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452442467212677, gen p mean: -0.7471769452095032, mean p set: 0.4529227614402771
The modified gen p mean: 0.4514378607273102, gen p mean: -0.741634726524353, mean p set: 0.4519181549549103
The modified gen p mean: 0.45097115635871887, gen p mean: -0.7392774224281311, mean p set: 0.45145145058631897
loss_pred:0.02651352807879448, decouple_loss:0.00935328472405672
loss_pred:0.02449648827314377, decouple_loss:0.008990257047116756
loss_pred:0.025953371077775955, decouple_loss:0.009043127298355103
Iteration: 2358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506296217441559, gen p mean: -0.7485626339912415, mean p set: 0.4511098861694336
The modified gen p mean: 0.4515439569950104, gen p mean: -0.7394400238990784, mean p set: 0.4520242512226105
The modified gen p mean: 0.450290709733963, gen p mean: -0.7573079466819763, mean p set: 0.4507710039615631
loss_pred:0.027416490018367767, decouple_loss:0.009778178296983242
loss_pred:0.02508845552802086, decouple_loss:0.00914033129811287
loss_pred:0.027021463960409164, decouple_loss:0.009496388956904411
Iteration: 2359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508022367954254, gen p mean: -0.7433797121047974, mean p set: 0.4512825310230255
The modified gen p mean: 0.451057106256485, gen p mean: -0.7437331676483154, mean p set: 0.4515374004840851
The modified gen p mean: 0.45053577423095703, gen p mean: -0.7494574189186096, mean p set: 0.4510160982608795
loss_pred:0.025284327566623688, decouple_loss:0.009448578581213951
loss_pred:0.02703293040394783, decouple_loss:0.009376456029713154
loss_pred:0.026953142136335373, decouple_loss:0.009118241257965565
Iteration: 2360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523831307888031, gen p mean: -0.7450613975524902, mean p set: 0.4528633952140808
The modified gen p mean: 0.45110514760017395, gen p mean: -0.7498034834861755, mean p set: 0.45158541202545166
The modified gen p mean: 0.45106038451194763, gen p mean: -0.7655506134033203, mean p set: 0.45154067873954773
loss_pred:0.025666505098342896, decouple_loss:0.008935313671827316
loss_pred:0.026832107454538345, decouple_loss:0.009348807856440544
loss_pred:0.027200959622859955, decouple_loss:0.00944247655570507
2023-05-03 06:02:37 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7617964744567871, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7540919184684753, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7491397857666016, mean p set: 0.45035696029663086
loss_pred:0.02728266827762127, decouple_loss:0.010191598907113075
loss_pred:0.026161452755331993, decouple_loss:0.010131916962563992
loss_pred:0.025886373594403267, decouple_loss:0.010090736672282219
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026950404047966003, avg_mse: 0.03234795480966568
current test mse: 0.032348
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
NaN value num: 0
Iteration: 2361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45170649886131287, gen p mean: -0.7629251480102539, mean p set: 0.4521867632865906
loss_pred:0.025473538786172867, decouple_loss:0.009606736712157726
The modified gen p mean: 0.45251893997192383, gen p mean: -0.7604649662971497, mean p set: 0.45299920439720154
loss_pred:0.026016436517238617, decouple_loss:0.009982706047594547
The modified gen p mean: 0.45001882314682007, gen p mean: -0.7650856375694275, mean p set: 0.45049911737442017
loss_pred:0.025584813207387924, decouple_loss:0.009867559187114239
Iteration: 2362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496087431907654, gen p mean: -0.7581509351730347, mean p set: 0.4500890374183655
The modified gen p mean: 0.4501040279865265, gen p mean: -0.7462520003318787, mean p set: 0.4505843222141266
The modified gen p mean: 0.4512324929237366, gen p mean: -0.7567970156669617, mean p set: 0.45171278715133667
loss_pred:0.025985319167375565, decouple_loss:0.009097580797970295
loss_pred:0.026783382520079613, decouple_loss:0.009398144669830799
loss_pred:0.026429004967212677, decouple_loss:0.009529365226626396
Iteration: 2363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45448148250579834, gen p mean: -0.7438123822212219, mean p set: 0.45496177673339844
The modified gen p mean: 0.45285338163375854, gen p mean: -0.7515215277671814, mean p set: 0.45333370566368103
The modified gen p mean: 0.4511910676956177, gen p mean: -0.7391953468322754, mean p set: 0.4516713619232178
loss_pred:0.025322025641798973, decouple_loss:0.010517451912164688
loss_pred:0.0257817842066288, decouple_loss:0.00991229061037302
loss_pred:0.025878282263875008, decouple_loss:0.010053448379039764
Iteration: 2364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948065280914307, gen p mean: -0.7451050877571106, mean p set: 0.44996097683906555
The modified gen p mean: 0.45046982169151306, gen p mean: -0.7394670844078064, mean p set: 0.45095011591911316
The modified gen p mean: 0.44939470291137695, gen p mean: -0.7418979406356812, mean p set: 0.44987502694129944
loss_pred:0.02577291987836361, decouple_loss:0.009190059266984463
loss_pred:0.0255093052983284, decouple_loss:0.009642367251217365
loss_pred:0.02571621723473072, decouple_loss:0.009088147431612015
Iteration: 2365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45516249537467957, gen p mean: -0.7422017455101013, mean p set: 0.45564278960227966
The modified gen p mean: 0.4531993865966797, gen p mean: -0.7358906269073486, mean p set: 0.4536796808242798
The modified gen p mean: 0.45038843154907227, gen p mean: -0.7389506101608276, mean p set: 0.45086869597435
loss_pred:0.024985605850815773, decouple_loss:0.009639176540076733
loss_pred:0.02592954784631729, decouple_loss:0.009749775752425194
loss_pred:0.026899540796875954, decouple_loss:0.00926904659718275
Iteration: 2366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508230984210968, gen p mean: -0.7396106719970703, mean p set: 0.4513033628463745
The modified gen p mean: 0.4500962197780609, gen p mean: -0.7481831312179565, mean p set: 0.450576514005661
The modified gen p mean: 0.45125308632850647, gen p mean: -0.730212926864624, mean p set: 0.45173338055610657
loss_pred:0.02569066733121872, decouple_loss:0.009546253830194473
loss_pred:0.02540014311671257, decouple_loss:0.009641146287322044
loss_pred:0.026249464601278305, decouple_loss:0.010085956193506718
Iteration: 2367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45218247175216675, gen p mean: -0.7434342503547668, mean p set: 0.45266276597976685
The modified gen p mean: 0.45065465569496155, gen p mean: -0.7476227879524231, mean p set: 0.45113492012023926
The modified gen p mean: 0.4513186514377594, gen p mean: -0.7460733652114868, mean p set: 0.4517989158630371
loss_pred:0.02535790391266346, decouple_loss:0.009664686396718025
loss_pred:0.026036106050014496, decouple_loss:0.009009482339024544
loss_pred:0.025738567113876343, decouple_loss:0.008935637772083282
Iteration: 2368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45081084966659546, gen p mean: -0.7504281401634216, mean p set: 0.45129111409187317
The modified gen p mean: 0.4523911774158478, gen p mean: -0.74690842628479, mean p set: 0.4528714418411255
The modified gen p mean: 0.451825886964798, gen p mean: -0.7558782696723938, mean p set: 0.45230618119239807
loss_pred:0.02598610706627369, decouple_loss:0.008963429369032383
loss_pred:0.025127315893769264, decouple_loss:0.009254933334887028
loss_pred:0.026737350970506668, decouple_loss:0.009009215980768204
Iteration: 2369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45101702213287354, gen p mean: -0.7483036518096924, mean p set: 0.45149728655815125
The modified gen p mean: 0.4534832239151001, gen p mean: -0.7565407752990723, mean p set: 0.4539635181427002
The modified gen p mean: 0.4515712857246399, gen p mean: -0.7539418339729309, mean p set: 0.4520516097545624
loss_pred:0.026709213852882385, decouple_loss:0.008968106471002102
loss_pred:0.025067346170544624, decouple_loss:0.009571965783834457
loss_pred:0.024562962353229523, decouple_loss:0.008985309861600399
Iteration: 2370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45146384835243225, gen p mean: -0.7515010237693787, mean p set: 0.45194417238235474
The modified gen p mean: 0.4518057405948639, gen p mean: -0.758782148361206, mean p set: 0.4522860050201416
The modified gen p mean: 0.45008569955825806, gen p mean: -0.7475907802581787, mean p set: 0.45056599378585815
loss_pred:0.025323282927274704, decouple_loss:0.008751786313951015
loss_pred:0.024772752076387405, decouple_loss:0.00909044686704874
loss_pred:0.026924002915620804, decouple_loss:0.009349132888019085
2023-05-03 06:07:03 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7683206796646118, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7603192925453186, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987669587135315, gen p mean: -0.7554134130477905, mean p set: 0.45035696029663086
loss_pred:0.027157200500369072, decouple_loss:0.00997568666934967
loss_pred:0.026069490239024162, decouple_loss:0.009901871904730797
loss_pred:0.02579982578754425, decouple_loss:0.00974809005856514
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026835933327674866, avg_mse: 0.032313790172338486
current test mse: 0.032314
Iteration: 2371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4545752704143524, gen p mean: -0.7651385068893433, mean p set: 0.4550555646419525
The modified gen p mean: 0.45161172747612, gen p mean: -0.7637811899185181, mean p set: 0.4520919919013977
loss_pred:0.024668993428349495, decouple_loss:0.009320057928562164
loss_pred:0.02520194835960865, decouple_loss:0.00902621541172266
The modified gen p mean: 0.4498804211616516, gen p mean: -0.7517916560173035, mean p set: 0.4503606855869293
loss_pred:0.026677219197154045, decouple_loss:0.009147901087999344
Iteration: 2372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448466032743454, gen p mean: -0.7591329216957092, mean p set: 0.4489463269710541
The modified gen p mean: 0.45053309202194214, gen p mean: -0.7581311464309692, mean p set: 0.45101335644721985
The modified gen p mean: 0.4517209529876709, gen p mean: -0.7518477439880371, mean p set: 0.452201247215271
loss_pred:0.025693709030747414, decouple_loss:0.008910383097827435
loss_pred:0.026002857834100723, decouple_loss:0.008901787921786308
loss_pred:0.02611401677131653, decouple_loss:0.008865954354405403
Iteration: 2373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45173612236976624, gen p mean: -0.7567321062088013, mean p set: 0.45221641659736633
The modified gen p mean: 0.4534813165664673, gen p mean: -0.7592215538024902, mean p set: 0.4539616107940674
The modified gen p mean: 0.4497041702270508, gen p mean: -0.7447111010551453, mean p set: 0.4501844644546509
loss_pred:0.025095466524362564, decouple_loss:0.008624207228422165
loss_pred:0.02651210129261017, decouple_loss:0.008705897256731987
loss_pred:0.02620701491832733, decouple_loss:0.008625412359833717
Iteration: 2374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518858790397644, gen p mean: -0.7546255588531494, mean p set: 0.4523661732673645
The modified gen p mean: 0.45196688175201416, gen p mean: -0.757146954536438, mean p set: 0.45244714617729187
The modified gen p mean: 0.45178931951522827, gen p mean: -0.7537935972213745, mean p set: 0.452269583940506
loss_pred:0.02603243663907051, decouple_loss:0.008800654672086239
loss_pred:0.02553367428481579, decouple_loss:0.00897369347512722
loss_pred:0.024895725771784782, decouple_loss:0.008830985054373741
Iteration: 2375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44842663407325745, gen p mean: -0.7501495480537415, mean p set: 0.44890692830085754
The modified gen p mean: 0.4494204521179199, gen p mean: -0.7527825236320496, mean p set: 0.44990074634552
The modified gen p mean: 0.45036694407463074, gen p mean: -0.750262975692749, mean p set: 0.45084720849990845
loss_pred:0.02615736983716488, decouple_loss:0.00846836343407631
loss_pred:0.02572927623987198, decouple_loss:0.00850438792258501
loss_pred:0.025684276595711708, decouple_loss:0.008921555243432522
Iteration: 2376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516300559043884, gen p mean: -0.7600152492523193, mean p set: 0.4521104097366333
The modified gen p mean: 0.450214147567749, gen p mean: -0.762691080570221, mean p set: 0.4506944417953491
The modified gen p mean: 0.45147705078125, gen p mean: -0.7576303482055664, mean p set: 0.4519573748111725
loss_pred:0.024242982268333435, decouple_loss:0.008512617088854313
loss_pred:0.025667034089565277, decouple_loss:0.0085726547986269
loss_pred:0.02478708326816559, decouple_loss:0.008688351139426231
Iteration: 2377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45197051763534546, gen p mean: -0.7684087157249451, mean p set: 0.45245081186294556
The modified gen p mean: 0.45048457384109497, gen p mean: -0.7515838742256165, mean p set: 0.45096486806869507
The modified gen p mean: 0.4512470066547394, gen p mean: -0.7553390860557556, mean p set: 0.4517273008823395
loss_pred:0.025522181764245033, decouple_loss:0.008828514255583286
loss_pred:0.026447921991348267, decouple_loss:0.008721631951630116
loss_pred:0.025427794083952904, decouple_loss:0.008914247155189514
Iteration: 2378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45176780223846436, gen p mean: -0.765692412853241, mean p set: 0.45224812626838684
The modified gen p mean: 0.4530189633369446, gen p mean: -0.7686678171157837, mean p set: 0.4534992575645447
The modified gen p mean: 0.4503123462200165, gen p mean: -0.7660534381866455, mean p set: 0.45079267024993896
loss_pred:0.024409383535385132, decouple_loss:0.008301494643092155
loss_pred:0.025582872331142426, decouple_loss:0.008543628267943859
loss_pred:0.025550955906510353, decouple_loss:0.008395792916417122
Iteration: 2379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45149412751197815, gen p mean: -0.7689478397369385, mean p set: 0.45197439193725586
The modified gen p mean: 0.45007914304733276, gen p mean: -0.7692476511001587, mean p set: 0.4505594074726105
The modified gen p mean: 0.4499392807483673, gen p mean: -0.7554721236228943, mean p set: 0.450419545173645
loss_pred:0.025499437004327774, decouple_loss:0.008359629660844803
loss_pred:0.024775249883532524, decouple_loss:0.009058349765837193
loss_pred:0.02703055739402771, decouple_loss:0.008245048113167286
Iteration: 2380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44957560300827026, gen p mean: -0.7662333250045776, mean p set: 0.45005589723587036
The modified gen p mean: 0.45131629705429077, gen p mean: -0.7544495463371277, mean p set: 0.45179659128189087
The modified gen p mean: 0.4509778320789337, gen p mean: -0.7587575316429138, mean p set: 0.4514580965042114
loss_pred:0.02561430260539055, decouple_loss:0.008139864541590214
loss_pred:0.025793014094233513, decouple_loss:0.008846858516335487
loss_pred:0.025418292731046677, decouple_loss:0.008760020136833191
2023-05-03 06:10:43 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7654457092285156, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7733579874038696, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7610206604003906, mean p set: 0.45035696029663086
loss_pred:0.025928707793354988, decouple_loss:0.009248876944184303
loss_pred:0.026907632127404213, decouple_loss:0.009411812759935856
loss_pred:0.02561112865805626, decouple_loss:0.009254997596144676
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026614418253302574, avg_mse: 0.03198567032814026
current test mse: 0.031986
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 2381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44937464594841003, gen p mean: -0.7628827691078186, mean p set: 0.44985491037368774
The modified gen p mean: 0.4472803473472595, gen p mean: -0.7621772885322571, mean p set: 0.447760671377182
loss_pred:0.02644316852092743, decouple_loss:0.008973655290901661
loss_pred:0.026664888486266136, decouple_loss:0.009310043416917324
The modified gen p mean: 0.4483198821544647, gen p mean: -0.7661787271499634, mean p set: 0.44880014657974243
loss_pred:0.024824488908052444, decouple_loss:0.009174905717372894
Iteration: 2382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473456144332886, gen p mean: -0.7647901177406311, mean p set: 0.44782590866088867
The modified gen p mean: 0.4500364065170288, gen p mean: -0.7649697661399841, mean p set: 0.4505167305469513
The modified gen p mean: 0.4461825489997864, gen p mean: -0.7616660594940186, mean p set: 0.4466628134250641
loss_pred:0.02673286944627762, decouple_loss:0.009206866845488548
loss_pred:0.026270292699337006, decouple_loss:0.009047618135809898
loss_pred:0.02656959556043148, decouple_loss:0.00902746431529522
Iteration: 2383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491988718509674, gen p mean: -0.7735458016395569, mean p set: 0.4496791362762451
The modified gen p mean: 0.4474087357521057, gen p mean: -0.7709335088729858, mean p set: 0.4478890001773834
The modified gen p mean: 0.44793716073036194, gen p mean: -0.7676664590835571, mean p set: 0.44841745495796204
loss_pred:0.02559158392250538, decouple_loss:0.008907264098525047
loss_pred:0.025721823796629906, decouple_loss:0.00923297181725502
loss_pred:0.025048909708857536, decouple_loss:0.009262410923838615
Iteration: 2384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469315707683563, gen p mean: -0.7630008459091187, mean p set: 0.44741183519363403
The modified gen p mean: 0.4487685561180115, gen p mean: -0.7635453939437866, mean p set: 0.44924888014793396
The modified gen p mean: 0.4485984742641449, gen p mean: -0.7674214839935303, mean p set: 0.449078768491745
loss_pred:0.025013837963342667, decouple_loss:0.008785868063569069
loss_pred:0.026273129507899284, decouple_loss:0.009294122457504272
loss_pred:0.02527516521513462, decouple_loss:0.008551903069019318
Iteration: 2385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476581811904907, gen p mean: -0.7492449879646301, mean p set: 0.4481384754180908
The modified gen p mean: 0.4460190236568451, gen p mean: -0.748137891292572, mean p set: 0.4464992880821228
loss_pred:0.024800356477499008, decouple_loss:0.008921648375689983
The modified gen p mean: 0.4488774240016937, gen p mean: -0.7619122862815857, mean p set: 0.4493577182292938loss_pred:0.026882071048021317, decouple_loss:0.00864326860755682
loss_pred:0.02460777573287487, decouple_loss:0.010025997646152973
Iteration: 2386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44858020544052124, gen p mean: -0.7445728778839111, mean p set: 0.44906049966812134
The modified gen p mean: 0.44705814123153687, gen p mean: -0.7476904392242432, mean p set: 0.44753846526145935
The modified gen p mean: 0.44823944568634033, gen p mean: -0.7635831236839294, mean p set: 0.4487197697162628
loss_pred:0.025376910343766212, decouple_loss:0.009051047265529633
loss_pred:0.025877119973301888, decouple_loss:0.008850841782987118
loss_pred:0.025908999145030975, decouple_loss:0.010957321152091026
Iteration: 2387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661128520965576, gen p mean: -0.7484683394432068, mean p set: 0.44709157943725586
The modified gen p mean: 0.4484160542488098, gen p mean: -0.748340904712677, mean p set: 0.4488963484764099
The modified gen p mean: 0.4468690752983093, gen p mean: -0.7459445595741272, mean p set: 0.4473493695259094
loss_pred:0.024995526298880577, decouple_loss:0.008818788453936577
loss_pred:0.025574874132871628, decouple_loss:0.009684573858976364
loss_pred:0.025639081373810768, decouple_loss:0.00866096094250679
Iteration: 2388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736945629119873, gen p mean: -0.7455057501792908, mean p set: 0.44784975051879883
The modified gen p mean: 0.44719547033309937, gen p mean: -0.7489532828330994, mean p set: 0.4476757347583771
The modified gen p mean: 0.4471632242202759, gen p mean: -0.7538672685623169, mean p set: 0.4476434886455536
loss_pred:0.024656690657138824, decouple_loss:0.008802362717688084
loss_pred:0.02507258579134941, decouple_loss:0.008959393016994
loss_pred:0.02508576400578022, decouple_loss:0.008667023852467537
Iteration: 2389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44775643944740295, gen p mean: -0.7498041391372681, mean p set: 0.44823670387268066
The modified gen p mean: 0.4487161636352539, gen p mean: -0.7511097192764282, mean p set: 0.4491964280605316
The modified gen p mean: 0.44726017117500305, gen p mean: -0.7606569528579712, mean p set: 0.4477404057979584
loss_pred:0.02536929026246071, decouple_loss:0.008954399265348911
loss_pred:0.024843331426382065, decouple_loss:0.009044503793120384
loss_pred:0.025489073246717453, decouple_loss:0.010422362945973873
Iteration: 2390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474874436855316, gen p mean: -0.751836895942688, mean p set: 0.4479677379131317
The modified gen p mean: 0.44921785593032837, gen p mean: -0.7491344213485718, mean p set: 0.44969815015792847
The modified gen p mean: 0.4492894113063812, gen p mean: -0.7493224740028381, mean p set: 0.44976967573165894
loss_pred:0.024208782240748405, decouple_loss:0.008669337257742882
loss_pred:0.02564968727529049, decouple_loss:0.008797096088528633
loss_pred:0.02520894631743431, decouple_loss:0.00859860610216856
2023-05-03 06:15:06 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.764926016330719, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7569239735603333, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987669587135315, gen p mean: -0.7524551153182983, mean p set: 0.45035696029663086
loss_pred:0.02671053074300289, decouple_loss:0.009074670262634754
loss_pred:0.02567772939801216, decouple_loss:0.008743518963456154
loss_pred:0.025332842022180557, decouple_loss:0.008832802064716816
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026351217180490494, avg_mse: 0.031584691256284714
current test mse: 0.031585
Iteration: 2391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701385498046875, gen p mean: -0.7665311694145203, mean p set: 0.44749414920806885
The modified gen p mean: 0.4480293095111847, gen p mean: -0.7707764506340027, mean p set: 0.4485096037387848
loss_pred:0.025739086791872978, decouple_loss:0.010314997285604477
loss_pred:0.025376109406352043, decouple_loss:0.010155418887734413
The modified gen p mean: 0.4501919448375702, gen p mean: -0.7530125975608826, mean p set: 0.4506722390651703
loss_pred:0.025801390409469604, decouple_loss:0.008405644446611404
Iteration: 2392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900283217430115, gen p mean: -0.7594627141952515, mean p set: 0.44948315620422363
The modified gen p mean: 0.4464013874530792, gen p mean: -0.769661009311676, mean p set: 0.4468816816806793
The modified gen p mean: 0.44830477237701416, gen p mean: -0.7707829475402832, mean p set: 0.44878509640693665
loss_pred:0.025723028928041458, decouple_loss:0.008513793349266052
loss_pred:0.026066752150654793, decouple_loss:0.010696280747652054
loss_pred:0.0252835750579834, decouple_loss:0.009900251403450966
Iteration: 2393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488295614719391, gen p mean: -0.7685839533805847, mean p set: 0.4493098258972168
The modified gen p mean: 0.44876590371131897, gen p mean: -0.7570144534111023, mean p set: 0.44924619793891907
The modified gen p mean: 0.4476604163646698, gen p mean: -0.7649571895599365, mean p set: 0.4481406807899475
loss_pred:0.024669578298926353, decouple_loss:0.009639149531722069
loss_pred:0.02561582624912262, decouple_loss:0.008925112895667553
loss_pred:0.02507193200290203, decouple_loss:0.010018552653491497
Iteration: 2394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44704604148864746, gen p mean: -0.7536767721176147, mean p set: 0.44752633571624756
The modified gen p mean: 0.4473118782043457, gen p mean: -0.7538241744041443, mean p set: 0.4477921724319458
The modified gen p mean: 0.4478943645954132, gen p mean: -0.7656816840171814, mean p set: 0.4483746588230133
loss_pred:0.024128302931785583, decouple_loss:0.008597989566624165
loss_pred:0.02483058162033558, decouple_loss:0.009134912863373756
loss_pred:0.02529260702431202, decouple_loss:0.009223764762282372
Iteration: 2395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44923028349876404, gen p mean: -0.7519298195838928, mean p set: 0.4497106075286865
The modified gen p mean: 0.4491006135940552, gen p mean: -0.7494285702705383, mean p set: 0.4495809078216553
The modified gen p mean: 0.44783085584640503, gen p mean: -0.7428433895111084, mean p set: 0.4483111500740051
loss_pred:0.024980301037430763, decouple_loss:0.00908706896007061
loss_pred:0.025857532396912575, decouple_loss:0.008510563522577286
loss_pred:0.025812411680817604, decouple_loss:0.009569545276463032
Iteration: 2396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482327401638031, gen p mean: -0.7558618783950806, mean p set: 0.4487130343914032
The modified gen p mean: 0.4481538236141205, gen p mean: -0.7513414621353149, mean p set: 0.44863414764404297
The modified gen p mean: 0.44750961661338806, gen p mean: -0.7534200549125671, mean p set: 0.44798991084098816
loss_pred:0.025072721764445305, decouple_loss:0.009109333157539368
loss_pred:0.024690596386790276, decouple_loss:0.008577835746109486
loss_pred:0.0242923516780138, decouple_loss:0.00846097618341446
Iteration: 2397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449720174074173, gen p mean: -0.7492009401321411, mean p set: 0.45020049810409546
The modified gen p mean: 0.44693103432655334, gen p mean: -0.7581034302711487, mean p set: 0.44741132855415344
The modified gen p mean: 0.44738543033599854, gen p mean: -0.7502424716949463, mean p set: 0.44786572456359863
loss_pred:0.02562817931175232, decouple_loss:0.008321561850607395
loss_pred:0.025524664670228958, decouple_loss:0.009685521945357323
loss_pred:0.02454182878136635, decouple_loss:0.00840295571833849
Iteration: 2398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790494441986084, gen p mean: -0.7479048371315002, mean p set: 0.44838523864746094
The modified gen p mean: 0.4482777714729309, gen p mean: -0.7482855319976807, mean p set: 0.4487580358982086
The modified gen p mean: 0.4493301808834076, gen p mean: -0.7500734925270081, mean p set: 0.4498105049133301
loss_pred:0.02633451111614704, decouple_loss:0.008477626368403435
loss_pred:0.024143528193235397, decouple_loss:0.00866283942013979
loss_pred:0.0252662543207407, decouple_loss:0.008443471975624561
Iteration: 2399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488517940044403, gen p mean: -0.7501581907272339, mean p set: 0.4493320882320404
The modified gen p mean: 0.44902482628822327, gen p mean: -0.7530785799026489, mean p set: 0.44950512051582336
The modified gen p mean: 0.44818514585494995, gen p mean: -0.7502825856208801, mean p set: 0.44866541028022766
loss_pred:0.025432974100112915, decouple_loss:0.008873696438968182
loss_pred:0.025202050805091858, decouple_loss:0.008156218566000462
loss_pred:0.025547539815306664, decouple_loss:0.008151310496032238
Iteration: 2400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488963186740875, gen p mean: -0.7544668912887573, mean p set: 0.4493766129016876
The modified gen p mean: 0.4464574158191681, gen p mean: -0.7518073916435242, mean p set: 0.4469376802444458
The modified gen p mean: 0.44794389605522156, gen p mean: -0.7575763463973999, mean p set: 0.44842419028282166
loss_pred:0.02610829472541809, decouple_loss:0.008208832703530788
loss_pred:0.025764495134353638, decouple_loss:0.00830361433327198
loss_pred:0.025139180943369865, decouple_loss:0.008514991961419582
2023-05-03 06:18:50 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7656822204589844, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7586215734481812, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7543309330940247, mean p set: 0.45035696029663086
loss_pred:0.026594648137688637, decouple_loss:0.008887341246008873
loss_pred:0.025601869449019432, decouple_loss:0.008408084511756897
loss_pred:0.025175757706165314, decouple_loss:0.008542484603822231
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026221390813589096, avg_mse: 0.03140704333782196
current test mse: 0.031407
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
NaN value num: 0
Iteration: 2401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502771496772766, gen p mean: -0.7653588652610779, mean p set: 0.4507574439048767
loss_pred:0.0272738728672266, decouple_loss:0.009166348725557327
The modified gen p mean: 0.4499744772911072, gen p mean: -0.7646204233169556, mean p set: 0.4504547715187073
loss_pred:0.028091536834836006, decouple_loss:0.0090941796079278
The modified gen p mean: 0.4494694173336029, gen p mean: -0.7565844655036926, mean p set: 0.449949711561203
loss_pred:0.02488805167376995, decouple_loss:0.008986691944301128
Iteration: 2402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44973355531692505, gen p mean: -0.7563429474830627, mean p set: 0.45021387934684753
The modified gen p mean: 0.4528787434101105, gen p mean: -0.7586170434951782, mean p set: 0.45335903763771057
The modified gen p mean: 0.4500156044960022, gen p mean: -0.7623561024665833, mean p set: 0.4504959285259247
loss_pred:0.02648090198636055, decouple_loss:0.008724234066903591
loss_pred:0.025817036628723145, decouple_loss:0.009078789502382278
loss_pred:0.026843341067433357, decouple_loss:0.00881871022284031
Iteration: 2403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44993525743484497, gen p mean: -0.766674816608429, mean p set: 0.4504155218601227
The modified gen p mean: 0.45123687386512756, gen p mean: -0.7534298896789551, mean p set: 0.45171716809272766
The modified gen p mean: 0.45142993330955505, gen p mean: -0.7570704817771912, mean p set: 0.45191019773483276
loss_pred:0.02822650969028473, decouple_loss:0.008636287413537502
loss_pred:0.027097538113594055, decouple_loss:0.00933792069554329
loss_pred:0.025870438665151596, decouple_loss:0.009119334630668163
Iteration: 2404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519214630126953, gen p mean: -0.7547329664230347, mean p set: 0.4524017870426178
The modified gen p mean: 0.4521124064922333, gen p mean: -0.7560890316963196, mean p set: 0.4525927007198334
The modified gen p mean: 0.4516439735889435, gen p mean: -0.7572392225265503, mean p set: 0.4521242678165436
loss_pred:0.025166181847453117, decouple_loss:0.009118402376770973
loss_pred:0.025039363652467728, decouple_loss:0.008960315957665443
loss_pred:0.026846885681152344, decouple_loss:0.008900636807084084
Iteration: 2405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488823413848877, gen p mean: -0.7579160928726196, mean p set: 0.4493626356124878
The modified gen p mean: 0.4516895115375519, gen p mean: -0.7593998908996582, mean p set: 0.4521697759628296
The modified gen p mean: 0.45226559042930603, gen p mean: -0.7561599016189575, mean p set: 0.45274588465690613
loss_pred:0.025257421657443047, decouple_loss:0.009004559367895126
loss_pred:0.02536880038678646, decouple_loss:0.00871953833848238
loss_pred:0.024543095380067825, decouple_loss:0.008962330408394337
Iteration: 2406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497663080692291, gen p mean: -0.7666546106338501, mean p set: 0.4502466022968292
The modified gen p mean: 0.44949042797088623, gen p mean: -0.7720279693603516, mean p set: 0.44997072219848633
The modified gen p mean: 0.4519834518432617, gen p mean: -0.7580174803733826, mean p set: 0.4524637460708618
loss_pred:0.026968246325850487, decouple_loss:0.008704958483576775
loss_pred:0.02639826014637947, decouple_loss:0.009137079119682312
loss_pred:0.026361702010035515, decouple_loss:0.008364195935428143
Iteration: 2407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45140281319618225, gen p mean: -0.7625567317008972, mean p set: 0.45188307762145996
The modified gen p mean: 0.45203524827957153, gen p mean: -0.7615224719047546, mean p set: 0.452515572309494
The modified gen p mean: 0.451761931180954, gen p mean: -0.762656033039093, mean p set: 0.4522422254085541
loss_pred:0.02696734108030796, decouple_loss:0.008634918369352818
loss_pred:0.02611612342298031, decouple_loss:0.008590452373027802
loss_pred:0.025343680754303932, decouple_loss:0.008529096841812134
Iteration: 2408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44944971799850464, gen p mean: -0.7675435543060303, mean p set: 0.44993001222610474
The modified gen p mean: 0.44881120324134827, gen p mean: -0.7686158418655396, mean p set: 0.44929152727127075
The modified gen p mean: 0.45030316710472107, gen p mean: -0.7633410096168518, mean p set: 0.4507834315299988
loss_pred:0.025184733793139458, decouple_loss:0.008622274734079838
loss_pred:0.026027370244264603, decouple_loss:0.008571631275117397
loss_pred:0.024895546957850456, decouple_loss:0.008292309939861298
Iteration: 2409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501321017742157, gen p mean: -0.769803524017334, mean p set: 0.4506123960018158
The modified gen p mean: 0.4486709535121918, gen p mean: -0.7647687196731567, mean p set: 0.44915124773979187
The modified gen p mean: 0.450868159532547, gen p mean: -0.7647454738616943, mean p set: 0.4513484537601471
loss_pred:0.025712547823786736, decouple_loss:0.008714012801647186
loss_pred:0.025012316182255745, decouple_loss:0.00845066737383604
loss_pred:0.025375304743647575, decouple_loss:0.00823888462036848
Iteration: 2410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498441219329834, gen p mean: -0.7705235481262207, mean p set: 0.4503243863582611
The modified gen p mean: 0.4489927887916565, gen p mean: -0.7725944519042969, mean p set: 0.4494730830192566
The modified gen p mean: 0.4492368698120117, gen p mean: -0.7676634192466736, mean p set: 0.4497171640396118
loss_pred:0.025334468111395836, decouple_loss:0.00866056326776743
loss_pred:0.02617233619093895, decouple_loss:0.008655942976474762
loss_pred:0.02471560798585415, decouple_loss:0.008108959533274174
2023-05-03 06:23:12 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7651435136795044, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888386249542, gen p mean: -0.7724953293800354, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7608680725097656, mean p set: 0.45035696029663086
loss_pred:0.02569212019443512, decouple_loss:0.00937536358833313
loss_pred:0.02668040245771408, decouple_loss:0.009558393619954586
loss_pred:0.02539570815861225, decouple_loss:0.00925099290907383
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026392489671707153, avg_mse: 0.0316649004817009
current test mse: 0.031665
Iteration: 2411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520311951637268, gen p mean: -0.7688212990760803, mean p set: 0.4525114893913269
The modified gen p mean: 0.44986066222190857, gen p mean: -0.768295407295227, mean p set: 0.45034095644950867
loss_pred:0.026208508759737015, decouple_loss:0.008932357653975487
loss_pred:0.026839466765522957, decouple_loss:0.008592923171818256
The modified gen p mean: 0.4487507939338684, gen p mean: -0.7657513618469238, mean p set: 0.4492310881614685
loss_pred:0.02613871917128563, decouple_loss:0.00817466527223587
Iteration: 2412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45169976353645325, gen p mean: -0.770079493522644, mean p set: 0.45218008756637573
The modified gen p mean: 0.4504345655441284, gen p mean: -0.7600718140602112, mean p set: 0.4509148597717285
The modified gen p mean: 0.4502570629119873, gen p mean: -0.768939197063446, mean p set: 0.450737327337265
loss_pred:0.02633187361061573, decouple_loss:0.00937982089817524
loss_pred:0.02472294308245182, decouple_loss:0.008152378723025322
loss_pred:0.02633722312748432, decouple_loss:0.008546140976250172
Iteration: 2413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45227017998695374, gen p mean: -0.7676475048065186, mean p set: 0.45275044441223145
The modified gen p mean: 0.4494214653968811, gen p mean: -0.7697381973266602, mean p set: 0.4499017596244812
The modified gen p mean: 0.44941064715385437, gen p mean: -0.7614637017250061, mean p set: 0.44989094138145447
loss_pred:0.025712884962558746, decouple_loss:0.009246304631233215
loss_pred:0.026485148817300797, decouple_loss:0.008630717173218727
loss_pred:0.025122759863734245, decouple_loss:0.008313017897307873
Iteration: 2414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522644281387329, gen p mean: -0.7571355700492859, mean p set: 0.452744722366333
The modified gen p mean: 0.44988295435905457, gen p mean: -0.755641758441925, mean p set: 0.45036324858665466
The modified gen p mean: 0.451952189207077, gen p mean: -0.7564884424209595, mean p set: 0.4524324834346771
loss_pred:0.02485085465013981, decouple_loss:0.008836586028337479
loss_pred:0.02466605231165886, decouple_loss:0.008371955715119839
loss_pred:0.025435758754611015, decouple_loss:0.008927959017455578
Iteration: 2415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517098665237427, gen p mean: -0.7626895904541016, mean p set: 0.45219019055366516
The modified gen p mean: 0.45233818888664246, gen p mean: -0.7728505730628967, mean p set: 0.45281848311424255
The modified gen p mean: 0.45026251673698425, gen p mean: -0.7734336853027344, mean p set: 0.45074281096458435
loss_pred:0.02558988146483898, decouple_loss:0.00834294967353344
loss_pred:0.025218235328793526, decouple_loss:0.008788364008069038
loss_pred:0.026725511997938156, decouple_loss:0.008300636895000935
Iteration: 2416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45021703839302063, gen p mean: -0.7636538147926331, mean p set: 0.4506973326206207
The modified gen p mean: 0.4489936828613281, gen p mean: -0.7724264860153198, mean p set: 0.4494739770889282
The modified gen p mean: 0.4498410224914551, gen p mean: -0.7626092433929443, mean p set: 0.4503213167190552
loss_pred:0.02533118613064289, decouple_loss:0.00813808012753725
loss_pred:0.02618972770869732, decouple_loss:0.008198363706469536
loss_pred:0.02465338073670864, decouple_loss:0.008285973221063614
Iteration: 2417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493335485458374, gen p mean: -0.7616263628005981, mean p set: 0.4498138427734375
The modified gen p mean: 0.4523078501224518, gen p mean: -0.7593606114387512, mean p set: 0.4527881443500519
The modified gen p mean: 0.4514210820198059, gen p mean: -0.7601272463798523, mean p set: 0.4519013464450836
loss_pred:0.024432342499494553, decouple_loss:0.008442476391792297
loss_pred:0.02645670622587204, decouple_loss:0.008549912832677364
loss_pred:0.025523528456687927, decouple_loss:0.008052026852965355
Iteration: 2418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45204418897628784, gen p mean: -0.7533987164497375, mean p set: 0.4525245130062103
The modified gen p mean: 0.4499061107635498, gen p mean: -0.7666933536529541, mean p set: 0.4503864049911499
The modified gen p mean: 0.45222026109695435, gen p mean: -0.767971396446228, mean p set: 0.45270055532455444
loss_pred:0.024982262402772903, decouple_loss:0.008421896025538445
loss_pred:0.027471419423818588, decouple_loss:0.008306856267154217
loss_pred:0.025629039853811264, decouple_loss:0.008752751164138317
Iteration: 2419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524064362049103, gen p mean: -0.7608122229576111, mean p set: 0.45288676023483276
The modified gen p mean: 0.4491058588027954, gen p mean: -0.7689144611358643, mean p set: 0.4495861530303955
The modified gen p mean: 0.4522947072982788, gen p mean: -0.7663610577583313, mean p set: 0.4527750313282013
loss_pred:0.026544786989688873, decouple_loss:0.008291638456285
loss_pred:0.0263631921261549, decouple_loss:0.00843969639390707
loss_pred:0.025467706844210625, decouple_loss:0.008400256745517254
Iteration: 2420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451712042093277, gen p mean: -0.7679771184921265, mean p set: 0.4521923363208771
The modified gen p mean: 0.4518701732158661, gen p mean: -0.7817199230194092, mean p set: 0.4523504674434662
The modified gen p mean: 0.45147889852523804, gen p mean: -0.7681690454483032, mean p set: 0.45195919275283813
loss_pred:0.025926264002919197, decouple_loss:0.007842203602194786
loss_pred:0.02609097771346569, decouple_loss:0.008707680739462376
loss_pred:0.025668269023299217, decouple_loss:0.008266001008450985
2023-05-03 06:26:56 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7703361511230469, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7775239944458008, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7655117511749268, mean p set: 0.45035696029663086
loss_pred:0.02571505308151245, decouple_loss:0.00919167511165142
loss_pred:0.026748698204755783, decouple_loss:0.009448776952922344
loss_pred:0.025425296276807785, decouple_loss:0.00912648905068636
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02642579935491085, avg_mse: 0.03176751732826233
current test mse: 0.031768
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
NaN value num: 0
Iteration: 2421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44668063521385193, gen p mean: -0.7747493982315063, mean p set: 0.44716089963912964
The modified gen p mean: 0.44680675864219666, gen p mean: -0.7784027457237244, mean p set: 0.44728702306747437
loss_pred:0.02538551576435566, decouple_loss:0.008576487191021442
loss_pred:0.026328789070248604, decouple_loss:0.009306545369327068
The modified gen p mean: 0.44586387276649475, gen p mean: -0.7743476629257202, mean p set: 0.44634416699409485
loss_pred:0.026385726407170296, decouple_loss:0.00914496835321188
Iteration: 2422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44588515162467957, gen p mean: -0.7702736258506775, mean p set: 0.44636544585227966
The modified gen p mean: 0.4461958110332489, gen p mean: -0.7689276933670044, mean p set: 0.4466760754585266
The modified gen p mean: 0.44793447852134705, gen p mean: -0.7863666415214539, mean p set: 0.44841480255126953
loss_pred:0.026024457067251205, decouple_loss:0.00884321704506874
loss_pred:0.02638600580394268, decouple_loss:0.00923911016434431
loss_pred:0.025146275758743286, decouple_loss:0.009385106153786182
Iteration: 2423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469824731349945, gen p mean: -0.7694168090820312, mean p set: 0.4474627375602722
The modified gen p mean: 0.44649001955986023, gen p mean: -0.7604429125785828, mean p set: 0.4469703137874603
The modified gen p mean: 0.4472256004810333, gen p mean: -0.7683680653572083, mean p set: 0.44770586490631104
loss_pred:0.02700769156217575, decouple_loss:0.008534690365195274
loss_pred:0.026611855253577232, decouple_loss:0.008600919507443905
loss_pred:0.025802534073591232, decouple_loss:0.0084307249635458
Iteration: 2424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446490615606308, gen p mean: -0.7707239389419556, mean p set: 0.4469709098339081
The modified gen p mean: 0.4469478130340576, gen p mean: -0.7726804614067078, mean p set: 0.4474280774593353
The modified gen p mean: 0.44619181752204895, gen p mean: -0.7676685452461243, mean p set: 0.44667208194732666
loss_pred:0.025376541540026665, decouple_loss:0.008599762804806232
loss_pred:0.026238638907670975, decouple_loss:0.008480576798319817
loss_pred:0.026042453944683075, decouple_loss:0.008796471171081066
Iteration: 2425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44637051224708557, gen p mean: -0.7714871168136597, mean p set: 0.4468507766723633
The modified gen p mean: 0.4463377594947815, gen p mean: -0.7807314395904541, mean p set: 0.4468180239200592
The modified gen p mean: 0.44696301221847534, gen p mean: -0.7786082029342651, mean p set: 0.44744330644607544
loss_pred:0.02530982904136181, decouple_loss:0.008482477627694607
loss_pred:0.0268825963139534, decouple_loss:0.008536113426089287
loss_pred:0.025382105261087418, decouple_loss:0.008375472389161587
Iteration: 2426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468720257282257, gen p mean: -0.7649406790733337, mean p set: 0.4473523199558258
The modified gen p mean: 0.4465961754322052, gen p mean: -0.7626360654830933, mean p set: 0.4470764696598053
The modified gen p mean: 0.44659650325775146, gen p mean: -0.7651498317718506, mean p set: 0.44707679748535156
loss_pred:0.025759518146514893, decouple_loss:0.008220628835260868
loss_pred:0.026634130626916885, decouple_loss:0.008208169601857662
loss_pred:0.026523271575570107, decouple_loss:0.008574866689741611
Iteration: 2427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469850957393646, gen p mean: -0.7696757912635803, mean p set: 0.4474653899669647
The modified gen p mean: 0.44864821434020996, gen p mean: -0.7810866832733154, mean p set: 0.44912847876548767
The modified gen p mean: 0.4461541473865509, gen p mean: -0.760064959526062, mean p set: 0.4466344118118286
loss_pred:0.026468556374311447, decouple_loss:0.008720232173800468
loss_pred:0.025149226188659668, decouple_loss:0.00903865322470665
loss_pred:0.026325885206460953, decouple_loss:0.008407107554376125
Iteration: 2428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456685483455658, gen p mean: -0.7662800550460815, mean p set: 0.4461488425731659
The modified gen p mean: 0.4488474428653717, gen p mean: -0.7818486094474792, mean p set: 0.4493277370929718
The modified gen p mean: 0.4464409351348877, gen p mean: -0.783702552318573, mean p set: 0.4469212293624878
loss_pred:0.026601091027259827, decouple_loss:0.008335738442838192
loss_pred:0.024990804493427277, decouple_loss:0.00877565611153841
loss_pred:0.025411885231733322, decouple_loss:0.008818069472908974
Iteration: 2429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44646114110946655, gen p mean: -0.7741664052009583, mean p set: 0.44694146513938904
The modified gen p mean: 0.44643568992614746, gen p mean: -0.7754358053207397, mean p set: 0.44691601395606995
The modified gen p mean: 0.4459577202796936, gen p mean: -0.7748868465423584, mean p set: 0.4464380145072937
loss_pred:0.02606704831123352, decouple_loss:0.00819450058043003
loss_pred:0.02697899378836155, decouple_loss:0.008468168787658215
loss_pred:0.025024136528372765, decouple_loss:0.008214900270104408
Iteration: 2430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475557506084442, gen p mean: -0.7891199588775635, mean p set: 0.4480360448360443
The modified gen p mean: 0.4466509222984314, gen p mean: -0.7676602602005005, mean p set: 0.4471311867237091
The modified gen p mean: 0.4463348984718323, gen p mean: -0.7712628841400146, mean p set: 0.4468151926994324
loss_pred:0.025876615196466446, decouple_loss:0.00807544682174921
loss_pred:0.025036657229065895, decouple_loss:0.008629129268229008
loss_pred:0.02591797523200512, decouple_loss:0.007904363796114922
2023-05-03 06:31:12 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7617237567901611, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7686518430709839, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7567022442817688, mean p set: 0.45035696029663086
loss_pred:0.02585410140454769, decouple_loss:0.008607737720012665
loss_pred:0.026972733438014984, decouple_loss:0.008900186978280544
loss_pred:0.025633960962295532, decouple_loss:0.008656504563987255
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02658967301249504, avg_mse: 0.03211795166134834
current test mse: 0.032118
Iteration: 2431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469037353992462, gen p mean: -0.7647965550422668, mean p set: 0.4473839998245239
loss_pred:0.025426248088479042, decouple_loss:0.007869341410696507
The modified gen p mean: 0.448067307472229, gen p mean: -0.7718919515609741, mean p set: 0.4485476016998291
loss_pred:0.02499164454638958, decouple_loss:0.008275160565972328
The modified gen p mean: 0.44824230670928955, gen p mean: -0.7826482057571411, mean p set: 0.44872260093688965
loss_pred:0.025111982598900795, decouple_loss:0.008316094055771828
Iteration: 2432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462442994117737, gen p mean: -0.7681917548179626, mean p set: 0.4467245936393738
The modified gen p mean: 0.4475141763687134, gen p mean: -0.7813770771026611, mean p set: 0.4479944705963135
The modified gen p mean: 0.4459913671016693, gen p mean: -0.7645595669746399, mean p set: 0.4464716613292694
loss_pred:0.0260729119181633, decouple_loss:0.008020283654332161
loss_pred:0.025815390050411224, decouple_loss:0.00830796081572771
loss_pred:0.025043606758117676, decouple_loss:0.007719902787357569
Iteration: 2433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474466145038605, gen p mean: -0.7651998400688171, mean p set: 0.44792690873146057
The modified gen p mean: 0.4458196759223938, gen p mean: -0.7628232836723328, mean p set: 0.4462999701499939
The modified gen p mean: 0.4468127191066742, gen p mean: -0.7687207460403442, mean p set: 0.4472929835319519
loss_pred:0.026173636317253113, decouple_loss:0.007898409850895405
loss_pred:0.026661928743124008, decouple_loss:0.007963134907186031
loss_pred:0.025120621547102928, decouple_loss:0.007845298387110233
Iteration: 2434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44609305262565613, gen p mean: -0.7590079307556152, mean p set: 0.4465733468532562
The modified gen p mean: 0.4462193548679352, gen p mean: -0.7591798305511475, mean p set: 0.4466996490955353
The modified gen p mean: 0.4454819858074188, gen p mean: -0.7557538151741028, mean p set: 0.4459622800350189
loss_pred:0.02627832256257534, decouple_loss:0.007882759906351566
loss_pred:0.026564067229628563, decouple_loss:0.007977817207574844
loss_pred:0.025897420942783356, decouple_loss:0.008141730912029743
Iteration: 2435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44582054018974304, gen p mean: -0.7571448087692261, mean p set: 0.44630083441734314
The modified gen p mean: 0.4471279978752136, gen p mean: -0.7642346620559692, mean p set: 0.44760826230049133
The modified gen p mean: 0.44762691855430603, gen p mean: -0.7723828554153442, mean p set: 0.44810721278190613
loss_pred:0.026198577135801315, decouple_loss:0.008232085034251213
loss_pred:0.026189612224698067, decouple_loss:0.008213209919631481
loss_pred:0.02521415241062641, decouple_loss:0.007973662577569485
Iteration: 2436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463740587234497, gen p mean: -0.7565563917160034, mean p set: 0.4468543529510498
The modified gen p mean: 0.4456903040409088, gen p mean: -0.7517405152320862, mean p set: 0.4461705982685089
The modified gen p mean: 0.445596843957901, gen p mean: -0.7532975077629089, mean p set: 0.4460771083831787
loss_pred:0.026551224291324615, decouple_loss:0.0077967033721506596
loss_pred:0.026915092021226883, decouple_loss:0.008012739010155201
loss_pred:0.026136714965105057, decouple_loss:0.008049788884818554
Iteration: 2437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811761379241943, gen p mean: -0.7773882150650024, mean p set: 0.44859790802001953
The modified gen p mean: 0.4474918842315674, gen p mean: -0.7637949585914612, mean p set: 0.4479721784591675
The modified gen p mean: 0.4456860423088074, gen p mean: -0.7606390714645386, mean p set: 0.4461663067340851
loss_pred:0.025383515283465385, decouple_loss:0.008608866482973099
loss_pred:0.024960419163107872, decouple_loss:0.008322393521666527
loss_pred:0.026462465524673462, decouple_loss:0.007913409732282162
Iteration: 2438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44573476910591125, gen p mean: -0.7686310410499573, mean p set: 0.44621503353118896
The modified gen p mean: 0.44628211855888367, gen p mean: -0.7665076851844788, mean p set: 0.4467623829841614
The modified gen p mean: 0.44701701402664185, gen p mean: -0.7731200456619263, mean p set: 0.44749733805656433
loss_pred:0.02567027509212494, decouple_loss:0.007828490808606148
loss_pred:0.027064723894000053, decouple_loss:0.008358138613402843
loss_pred:0.02659241482615471, decouple_loss:0.008419288322329521
Iteration: 2439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44563257694244385, gen p mean: -0.7576030492782593, mean p set: 0.44611287117004395
The modified gen p mean: 0.4467600882053375, gen p mean: -0.7586370706558228, mean p set: 0.4472403824329376
The modified gen p mean: 0.44600096344947815, gen p mean: -0.7635316252708435, mean p set: 0.44648122787475586
loss_pred:0.0266520194709301, decouple_loss:0.007943717762827873
loss_pred:0.026472559198737144, decouple_loss:0.007885020226240158
loss_pred:0.025891050696372986, decouple_loss:0.007960442453622818
Iteration: 2440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44629257917404175, gen p mean: -0.7616816163063049, mean p set: 0.44677287340164185
The modified gen p mean: 0.44685351848602295, gen p mean: -0.7645067572593689, mean p set: 0.44733378291130066
The modified gen p mean: 0.44578954577445984, gen p mean: -0.7574378848075867, mean p set: 0.44626984000205994
loss_pred:0.026467667892575264, decouple_loss:0.007871180772781372
loss_pred:0.02683831937611103, decouple_loss:0.007829082198441029
loss_pred:0.026375843212008476, decouple_loss:0.00796023290604353
2023-05-03 06:34:53 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7537714242935181, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7605438232421875, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7494072318077087, mean p set: 0.45035696029663086
loss_pred:0.025691969320178032, decouple_loss:0.008357742801308632
loss_pred:0.026711052283644676, decouple_loss:0.008590636774897575
loss_pred:0.02553219348192215, decouple_loss:0.008430363610386848
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02640138566493988, avg_mse: 0.03182355314493179
current test mse: 0.031824
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 2441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478999376296997, gen p mean: -0.7478383183479309, mean p set: 0.4483802020549774
The modified gen p mean: 0.44724032282829285, gen p mean: -0.7618873119354248, mean p set: 0.44772061705589294
loss_pred:0.02627996914088726, decouple_loss:0.008838383480906487
loss_pred:0.026222674176096916, decouple_loss:0.008743484504520893
The modified gen p mean: 0.4479955732822418, gen p mean: -0.7657110095024109, mean p set: 0.4484758675098419
loss_pred:0.025891663506627083, decouple_loss:0.008805624209344387
Iteration: 2442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721120595932007, gen p mean: -0.757930338382721, mean p set: 0.4476914703845978
The modified gen p mean: 0.44889259338378906, gen p mean: -0.7545016407966614, mean p set: 0.44937291741371155
The modified gen p mean: 0.4462844133377075, gen p mean: -0.7544814348220825, mean p set: 0.44676467776298523
loss_pred:0.026067383587360382, decouple_loss:0.008457520045340061
loss_pred:0.025983206927776337, decouple_loss:0.00850426871329546
loss_pred:0.025282159447669983, decouple_loss:0.009012026712298393
Iteration: 2443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474093019962311, gen p mean: -0.7589940428733826, mean p set: 0.4478895962238312
The modified gen p mean: 0.44691383838653564, gen p mean: -0.7561083436012268, mean p set: 0.44739410281181335
The modified gen p mean: 0.4468412697315216, gen p mean: -0.7695597410202026, mean p set: 0.4473215639591217
loss_pred:0.025298789143562317, decouple_loss:0.008805100806057453
loss_pred:0.026515895500779152, decouple_loss:0.008679506368935108
loss_pred:0.025879137217998505, decouple_loss:0.008215025067329407
Iteration: 2444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470464587211609, gen p mean: -0.7596975564956665, mean p set: 0.4475267231464386
The modified gen p mean: 0.4478975832462311, gen p mean: -0.7510465979576111, mean p set: 0.4483778774738312
The modified gen p mean: 0.44652217626571655, gen p mean: -0.7560481429100037, mean p set: 0.44700247049331665
loss_pred:0.02614392153918743, decouple_loss:0.008165783248841763
loss_pred:0.025747662410140038, decouple_loss:0.008359275758266449
loss_pred:0.026200680062174797, decouple_loss:0.008774143643677235
Iteration: 2445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742703437805176, gen p mean: -0.7458007335662842, mean p set: 0.44790735840797424
The modified gen p mean: 0.44752824306488037, gen p mean: -0.7466843724250793, mean p set: 0.44800853729248047
The modified gen p mean: 0.44708889722824097, gen p mean: -0.7449537515640259, mean p set: 0.44756919145584106
loss_pred:0.025745432823896408, decouple_loss:0.008065792731940746
loss_pred:0.025545699521899223, decouple_loss:0.008673357777297497
loss_pred:0.027020925655961037, decouple_loss:0.008195114322006702
Iteration: 2446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44747141003608704, gen p mean: -0.7546320557594299, mean p set: 0.44795170426368713The modified gen p mean: 0.4467009902000427, gen p mean: -0.7515230178833008, mean p set: 0.4471812844276428
The modified gen p mean: 0.4466283321380615, gen p mean: -0.7449417114257812, mean p set: 0.447108656167984
loss_pred:0.025963474065065384, decouple_loss:0.008659487590193748
loss_pred:0.02570817433297634, decouple_loss:0.008399078622460365
loss_pred:0.024958215653896332, decouple_loss:0.008167069405317307
Iteration: 2447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750797748565674, gen p mean: -0.7533861398696899, mean p set: 0.44798827171325684
The modified gen p mean: 0.4480471909046173, gen p mean: -0.7480220794677734, mean p set: 0.4485274851322174
The modified gen p mean: 0.4485374093055725, gen p mean: -0.7479135990142822, mean p set: 0.4490176737308502
loss_pred:0.02463020198047161, decouple_loss:0.008009996265172958
loss_pred:0.026263244450092316, decouple_loss:0.008258488029241562
loss_pred:0.02582511119544506, decouple_loss:0.008020755834877491
Iteration: 2448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788146018981934, gen p mean: -0.7640194892883301, mean p set: 0.44836175441741943
The modified gen p mean: 0.44779109954833984, gen p mean: -0.7615541815757751, mean p set: 0.44827136397361755
The modified gen p mean: 0.4481365978717804, gen p mean: -0.7535020112991333, mean p set: 0.4486168920993805
loss_pred:0.025464385747909546, decouple_loss:0.008801321499049664
loss_pred:0.02535560168325901, decouple_loss:0.008588968776166439
loss_pred:0.025702418759465218, decouple_loss:0.00832182727754116
Iteration: 2449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708651304244995, gen p mean: -0.7587271332740784, mean p set: 0.44756677746772766
The modified gen p mean: 0.4469221234321594, gen p mean: -0.7458056211471558, mean p set: 0.4474024176597595
The modified gen p mean: 0.4474581182003021, gen p mean: -0.7627420425415039, mean p set: 0.44793838262557983
loss_pred:0.02552049234509468, decouple_loss:0.008470687083899975
loss_pred:0.02571622096002102, decouple_loss:0.008405637927353382
loss_pred:0.025304773822426796, decouple_loss:0.008332278579473495
Iteration: 2450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470941126346588, gen p mean: -0.753389835357666, mean p set: 0.4475743770599365
The modified gen p mean: 0.4474667012691498, gen p mean: -0.7557387948036194, mean p set: 0.4479469656944275
The modified gen p mean: 0.4487799406051636, gen p mean: -0.7554512619972229, mean p set: 0.44926023483276367
loss_pred:0.026764608919620514, decouple_loss:0.008032003417611122
loss_pred:0.02539816126227379, decouple_loss:0.008257820270955563
loss_pred:0.025744233280420303, decouple_loss:0.007864664308726788
2023-05-03 06:39:11 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7637369632720947, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7708266973495483, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7591853737831116, mean p set: 0.45035696029663086
loss_pred:0.025412341579794884, decouple_loss:0.008270184509456158
loss_pred:0.026497958227992058, decouple_loss:0.008329925127327442
loss_pred:0.02517126128077507, decouple_loss:0.008431046269834042
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026111040264368057, avg_mse: 0.03133116662502289
current test mse: 0.031331
Iteration: 2451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677913188934326, gen p mean: -0.7688843607902527, mean p set: 0.44725939631462097
The modified gen p mean: 0.44776856899261475, gen p mean: -0.7737324833869934, mean p set: 0.44824886322021484
loss_pred:0.025528855621814728, decouple_loss:0.00834127888083458
loss_pred:0.025380266830325127, decouple_loss:0.008243484422564507
The modified gen p mean: 0.4465150237083435, gen p mean: -0.7561870813369751, mean p set: 0.4469953179359436
loss_pred:0.025210609659552574, decouple_loss:0.008489206433296204
Iteration: 2452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44629597663879395, gen p mean: -0.7641639709472656, mean p set: 0.44677630066871643
The modified gen p mean: 0.448162704706192, gen p mean: -0.755529522895813, mean p set: 0.4486429989337921
The modified gen p mean: 0.4474468231201172, gen p mean: -0.7615780830383301, mean p set: 0.4479270875453949
loss_pred:0.026109497994184494, decouple_loss:0.008115435019135475
loss_pred:0.02613191306591034, decouple_loss:0.008813039399683475
loss_pred:0.024751096963882446, decouple_loss:0.00806263368576765
Iteration: 2453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472711682319641, gen p mean: -0.7593954801559448, mean p set: 0.4477514624595642
The modified gen p mean: 0.44799885153770447, gen p mean: -0.770564615726471, mean p set: 0.4484791159629822
The modified gen p mean: 0.4473112225532532, gen p mean: -0.7528570294380188, mean p set: 0.44779151678085327
loss_pred:0.024699436500668526, decouple_loss:0.0075204200111329556
loss_pred:0.02514565922319889, decouple_loss:0.008058838546276093
loss_pred:0.025817682966589928, decouple_loss:0.00792456790804863
Iteration: 2454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480850398540497, gen p mean: -0.7511717081069946, mean p set: 0.4485653042793274
The modified gen p mean: 0.44681647419929504, gen p mean: -0.7572697997093201, mean p set: 0.44729676842689514
The modified gen p mean: 0.44717198610305786, gen p mean: -0.753301203250885, mean p set: 0.44765228033065796
loss_pred:0.024495955556631088, decouple_loss:0.008099667727947235
loss_pred:0.025466276332736015, decouple_loss:0.008103037253022194
loss_pred:0.025448814034461975, decouple_loss:0.00805775634944439
Iteration: 2455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448482483625412, gen p mean: -0.7501826882362366, mean p set: 0.4489628076553345
The modified gen p mean: 0.44711393117904663, gen p mean: -0.7570466995239258, mean p set: 0.44759422540664673
The modified gen p mean: 0.4477558732032776, gen p mean: -0.7506885528564453, mean p set: 0.4482361972332001
loss_pred:0.025379659608006477, decouple_loss:0.007590807043015957
loss_pred:0.024794386699795723, decouple_loss:0.007828371599316597
loss_pred:0.025391310453414917, decouple_loss:0.007671262137591839
Iteration: 2456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819068908691406, gen p mean: -0.753075897693634, mean p set: 0.4486709535121918
The modified gen p mean: 0.447258323431015, gen p mean: -0.7574827671051025, mean p set: 0.4477385878562927
The modified gen p mean: 0.44763094186782837, gen p mean: -0.7517714500427246, mean p set: 0.4481112062931061
loss_pred:0.024492453783750534, decouple_loss:0.00788481067866087
loss_pred:0.025004032999277115, decouple_loss:0.008105939254164696
loss_pred:0.026432709768414497, decouple_loss:0.007969191297888756
Iteration: 2457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732221961021423, gen p mean: -0.7702864408493042, mean p set: 0.4478025436401367
The modified gen p mean: 0.44876283407211304, gen p mean: -0.7511975765228271, mean p set: 0.44924309849739075
The modified gen p mean: 0.4487040936946869, gen p mean: -0.7519643306732178, mean p set: 0.449184387922287
loss_pred:0.024901244789361954, decouple_loss:0.00768188526853919
loss_pred:0.02660924568772316, decouple_loss:0.008282236754894257
loss_pred:0.0255845058709383, decouple_loss:0.007911916822195053
Iteration: 2458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44891631603240967, gen p mean: -0.7573655247688293, mean p set: 0.4493965804576874
The modified gen p mean: 0.44627127051353455, gen p mean: -0.7596783638000488, mean p set: 0.44675159454345703
The modified gen p mean: 0.4465497136116028, gen p mean: -0.7621020674705505, mean p set: 0.4470299780368805
loss_pred:0.025179723277688026, decouple_loss:0.008169113658368587
loss_pred:0.02633831463754177, decouple_loss:0.008343387395143509
loss_pred:0.02602767013013363, decouple_loss:0.00834533479064703
Iteration: 2459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44692462682724, gen p mean: -0.7656756043434143, mean p set: 0.4474049210548401
The modified gen p mean: 0.4482991695404053, gen p mean: -0.7656058073043823, mean p set: 0.44877946376800537
The modified gen p mean: 0.44799256324768066, gen p mean: -0.762184739112854, mean p set: 0.44847285747528076
loss_pred:0.02573564276099205, decouple_loss:0.007694705855101347
loss_pred:0.024451693519949913, decouple_loss:0.007860219106078148
loss_pred:0.025922540575265884, decouple_loss:0.007786543574184179
Iteration: 2460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446719229221344, gen p mean: -0.7718018889427185, mean p set: 0.4471994936466217
The modified gen p mean: 0.4483894109725952, gen p mean: -0.7601562142372131, mean p set: 0.4488696753978729
The modified gen p mean: 0.44784659147262573, gen p mean: -0.7663906812667847, mean p set: 0.44832685589790344
loss_pred:0.02589743584394455, decouple_loss:0.008065593428909779
loss_pred:0.02527553401887417, decouple_loss:0.007889661006629467
loss_pred:0.02543475106358528, decouple_loss:0.008134661242365837
2023-05-03 06:42:52 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7694602012634277, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830237865448, gen p mean: -0.7627119421958923, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7586208581924438, mean p set: 0.45035696029663086
loss_pred:0.026528403162956238, decouple_loss:0.008212491869926453
loss_pred:0.02549416571855545, decouple_loss:0.0079621197655797
loss_pred:0.02517157793045044, decouple_loss:0.00802264641970396
WV_0_PC_1_EH_0_PS_40_6, loss: 0.0261346697807312, avg_mse: 0.031492929905653
current test mse: 0.031493
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
NaN value num: 0
Iteration: 2461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45205259323120117, gen p mean: -0.7634836435317993, mean p set: 0.45253291726112366
loss_pred:0.025647293776273727, decouple_loss:0.00931617897003889
The modified gen p mean: 0.44979164004325867, gen p mean: -0.7532632350921631, mean p set: 0.45027193427085876
loss_pred:0.026257449761033058, decouple_loss:0.008806667290627956
The modified gen p mean: 0.44940727949142456, gen p mean: -0.7632253766059875, mean p set: 0.44988757371902466
loss_pred:0.024790223687887192, decouple_loss:0.009243139997124672
Iteration: 2462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496085047721863, gen p mean: -0.7537930011749268, mean p set: 0.4500887989997864
The modified gen p mean: 0.45152488350868225, gen p mean: -0.7585489749908447, mean p set: 0.45200514793395996
The modified gen p mean: 0.44939979910850525, gen p mean: -0.7591984868049622, mean p set: 0.44988009333610535
loss_pred:0.025920260697603226, decouple_loss:0.008011013269424438
loss_pred:0.02582557499408722, decouple_loss:0.008622932247817516
loss_pred:0.02421877346932888, decouple_loss:0.008004972711205482
Iteration: 2463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45016688108444214, gen p mean: -0.7548866271972656, mean p set: 0.450647234916687
The modified gen p mean: 0.4505055844783783, gen p mean: -0.7580149173736572, mean p set: 0.450985848903656
The modified gen p mean: 0.44975170493125916, gen p mean: -0.7599642872810364, mean p set: 0.45023199915885925
loss_pred:0.02584400586783886, decouple_loss:0.00818718783557415
loss_pred:0.025508388876914978, decouple_loss:0.00821263249963522
loss_pred:0.024894623085856438, decouple_loss:0.008115984499454498
Iteration: 2464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496305584907532, gen p mean: -0.7488735914230347, mean p set: 0.45011085271835327
The modified gen p mean: 0.45184165239334106, gen p mean: -0.7468724250793457, mean p set: 0.45232194662094116
The modified gen p mean: 0.44924798607826233, gen p mean: -0.7445271015167236, mean p set: 0.4497282803058624
loss_pred:0.026071179658174515, decouple_loss:0.008620410226285458
loss_pred:0.026405997574329376, decouple_loss:0.008613048121333122
loss_pred:0.025318892672657967, decouple_loss:0.008174457587301731
Iteration: 2465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44958770275115967, gen p mean: -0.7539997100830078, mean p set: 0.45006799697875977
The modified gen p mean: 0.4490223824977875, gen p mean: -0.7450920939445496, mean p set: 0.4495026767253876
The modified gen p mean: 0.44886985421180725, gen p mean: -0.7443170547485352, mean p set: 0.44935014843940735
loss_pred:0.02471364475786686, decouple_loss:0.007866733707487583
loss_pred:0.024459844455122948, decouple_loss:0.008273658342659473
loss_pred:0.02404063381254673, decouple_loss:0.007936916314065456
Iteration: 2466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45036736130714417, gen p mean: -0.7554299831390381, mean p set: 0.45084765553474426
The modified gen p mean: 0.45300352573394775, gen p mean: -0.7500854134559631, mean p set: 0.45348381996154785
The modified gen p mean: 0.4503987729549408, gen p mean: -0.7480531930923462, mean p set: 0.4508790671825409
loss_pred:0.024996064603328705, decouple_loss:0.007900644093751907
loss_pred:0.026479436084628105, decouple_loss:0.008389893919229507
loss_pred:0.02598395012319088, decouple_loss:0.007971230894327164
Iteration: 2467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45104214549064636, gen p mean: -0.7615440487861633, mean p set: 0.4515224099159241
The modified gen p mean: 0.450987309217453, gen p mean: -0.7582600712776184, mean p set: 0.4514676034450531
The modified gen p mean: 0.4495670199394226, gen p mean: -0.7500346899032593, mean p set: 0.4500472843647003
loss_pred:0.0263639148324728, decouple_loss:0.008334939368069172
loss_pred:0.026643740013241768, decouple_loss:0.008518046699464321
loss_pred:0.025866271927952766, decouple_loss:0.008450083434581757
Iteration: 2468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906169176101685, gen p mean: -0.7629928588867188, mean p set: 0.44954198598861694
The modified gen p mean: 0.4485670328140259, gen p mean: -0.7576825618743896, mean p set: 0.44904735684394836
The modified gen p mean: 0.452693909406662, gen p mean: -0.7584116458892822, mean p set: 0.4531742036342621
loss_pred:0.02564135380089283, decouple_loss:0.008181926794350147
loss_pred:0.024187184870243073, decouple_loss:0.00816858746111393
loss_pred:0.026348715648055077, decouple_loss:0.008529489859938622
Iteration: 2469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44990274310112, gen p mean: -0.7611719369888306, mean p set: 0.4503830373287201
The modified gen p mean: 0.45040997862815857, gen p mean: -0.7538878917694092, mean p set: 0.45089030265808105
The modified gen p mean: 0.44859984517097473, gen p mean: -0.7583690881729126, mean p set: 0.44908010959625244
loss_pred:0.024293873459100723, decouple_loss:0.008960715495049953
loss_pred:0.026764392852783203, decouple_loss:0.008204949088394642
loss_pred:0.025704851374030113, decouple_loss:0.00841586571186781
Iteration: 2470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44874706864356995, gen p mean: -0.7532537579536438, mean p set: 0.44922736287117004
The modified gen p mean: 0.4505070447921753, gen p mean: -0.7579652070999146, mean p set: 0.4509873688220978
The modified gen p mean: 0.4522383213043213, gen p mean: -0.7578284740447998, mean p set: 0.4527186155319214
loss_pred:0.025959746912121773, decouple_loss:0.008484045043587685
loss_pred:0.025025922805070877, decouple_loss:0.008068333379924297
loss_pred:0.025377804413437843, decouple_loss:0.009229117073118687
2023-05-03 06:47:12 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7565591335296631, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7638161778450012, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7521594762802124, mean p set: 0.45035696029663086
loss_pred:0.025640927255153656, decouple_loss:0.008867457509040833
loss_pred:0.026656048372387886, decouple_loss:0.009051679633557796
loss_pred:0.025232069194316864, decouple_loss:0.008948968723416328
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02629081718623638, avg_mse: 0.03168124333024025
current test mse: 0.031681
Iteration: 2471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514771103858948, gen p mean: -0.7546935081481934, mean p set: 0.4519574046134949
loss_pred:0.025629866868257523, decouple_loss:0.008443226106464863
The modified gen p mean: 0.45179152488708496, gen p mean: -0.7506988644599915, mean p set: 0.45227181911468506
loss_pred:0.025968026369810104, decouple_loss:0.008917639963328838
The modified gen p mean: 0.45123112201690674, gen p mean: -0.7581855654716492, mean p set: 0.45171138644218445
loss_pred:0.025809017941355705, decouple_loss:0.008497485890984535
Iteration: 2472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504109025001526, gen p mean: -0.75806725025177, mean p set: 0.4508911669254303
The modified gen p mean: 0.44922390580177307, gen p mean: -0.7581724524497986, mean p set: 0.4497041702270508
The modified gen p mean: 0.4493679106235504, gen p mean: -0.7546127438545227, mean p set: 0.4498482048511505
loss_pred:0.02563408762216568, decouple_loss:0.008338752202689648
loss_pred:0.024567076936364174, decouple_loss:0.008118979632854462
loss_pred:0.02578010782599449, decouple_loss:0.007996147498488426
Iteration: 2473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45234429836273193, gen p mean: -0.7482704520225525, mean p set: 0.45282456278800964
The modified gen p mean: 0.4518088102340698, gen p mean: -0.7494984865188599, mean p set: 0.45228907465934753
The modified gen p mean: 0.4496549963951111, gen p mean: -0.7464414834976196, mean p set: 0.45013532042503357
loss_pred:0.025958651676774025, decouple_loss:0.008329487405717373
loss_pred:0.025513773784041405, decouple_loss:0.00869706179946661
loss_pred:0.0266712736338377, decouple_loss:0.008471077308058739
Iteration: 2474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45179903507232666, gen p mean: -0.7489471435546875, mean p set: 0.45227932929992676
The modified gen p mean: 0.45146384835243225, gen p mean: -0.7561687231063843, mean p set: 0.45194414258003235
The modified gen p mean: 0.44940486550331116, gen p mean: -0.7581128478050232, mean p set: 0.44988515973091125
loss_pred:0.025833019986748695, decouple_loss:0.00846518762409687
loss_pred:0.025558751076459885, decouple_loss:0.00823994167149067
loss_pred:0.02537052519619465, decouple_loss:0.008491341955959797
Iteration: 2475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45046067237854004, gen p mean: -0.7629963159561157, mean p set: 0.45094096660614014
The modified gen p mean: 0.4521111845970154, gen p mean: -0.7494094967842102, mean p set: 0.4525914490222931
The modified gen p mean: 0.4499739408493042, gen p mean: -0.7592861652374268, mean p set: 0.4504542350769043
loss_pred:0.02465934120118618, decouple_loss:0.00821971520781517
loss_pred:0.02574160508811474, decouple_loss:0.007976856082677841
loss_pred:0.02545245550572872, decouple_loss:0.008065749891102314
Iteration: 2476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452014684677124, gen p mean: -0.7666810750961304, mean p set: 0.4524949789047241
The modified gen p mean: 0.4519024193286896, gen p mean: -0.7601147890090942, mean p set: 0.4523826837539673
The modified gen p mean: 0.4489685595035553, gen p mean: -0.7624185085296631, mean p set: 0.4494488537311554
loss_pred:0.025026267394423485, decouple_loss:0.008698142133653164
loss_pred:0.024852154776453972, decouple_loss:0.008553734980523586
loss_pred:0.02447815239429474, decouple_loss:0.008199604228138924
Iteration: 2477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960302114486694, gen p mean: -0.7582371830940247, mean p set: 0.45008331537246704
The modified gen p mean: 0.4486233592033386, gen p mean: -0.7654703855514526, mean p set: 0.44910362362861633
The modified gen p mean: 0.4495231807231903, gen p mean: -0.7661952376365662, mean p set: 0.4500034749507904
loss_pred:0.02512529492378235, decouple_loss:0.008290513418614864
loss_pred:0.024660412222146988, decouple_loss:0.007963873445987701
loss_pred:0.02599877119064331, decouple_loss:0.0077812583185732365
Iteration: 2478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499431252479553, gen p mean: -0.7563241124153137, mean p set: 0.4504234194755554
The modified gen p mean: 0.45238861441612244, gen p mean: -0.766623318195343, mean p set: 0.45286887884140015
The modified gen p mean: 0.4500294327735901, gen p mean: -0.7672813534736633, mean p set: 0.4505097270011902
loss_pred:0.02691970020532608, decouple_loss:0.008119704201817513
loss_pred:0.024620773270726204, decouple_loss:0.008699621073901653
loss_pred:0.025228817015886307, decouple_loss:0.008319568820297718
Iteration: 2479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45059144496917725, gen p mean: -0.767098605632782, mean p set: 0.45107173919677734
The modified gen p mean: 0.45020562410354614, gen p mean: -0.7632181644439697, mean p set: 0.45068594813346863
The modified gen p mean: 0.45141664147377014, gen p mean: -0.7695303559303284, mean p set: 0.45189690589904785
loss_pred:0.025525234639644623, decouple_loss:0.007936498150229454
loss_pred:0.024469900876283646, decouple_loss:0.008152653463184834
loss_pred:0.02543971687555313, decouple_loss:0.007954226806759834
Iteration: 2480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510831832885742, gen p mean: -0.7721185088157654, mean p set: 0.45156344771385193
The modified gen p mean: 0.44902458786964417, gen p mean: -0.7705568671226501, mean p set: 0.4495048522949219
The modified gen p mean: 0.4488661289215088, gen p mean: -0.761638879776001, mean p set: 0.4493463933467865
loss_pred:0.025026371702551842, decouple_loss:0.008020439185202122
loss_pred:0.025538329035043716, decouple_loss:0.008124730549752712
loss_pred:0.026878785341978073, decouple_loss:0.00798027403652668
2023-05-03 06:50:54 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7764018774032593, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.769198477268219, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7646795511245728, mean p set: 0.45035696029663086
loss_pred:0.026524804532527924, decouple_loss:0.008840287104249
loss_pred:0.025454094633460045, decouple_loss:0.008621325716376305
loss_pred:0.025150949135422707, decouple_loss:0.008699137717485428
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02614596299827099, avg_mse: 0.03143942728638649
current test mse: 0.031439
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
NaN value num: 0
Iteration: 2481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45003461837768555, gen p mean: -0.774684727191925, mean p set: 0.45051491260528564
loss_pred:0.024292679503560066, decouple_loss:0.008412213064730167
The modified gen p mean: 0.44913122057914734, gen p mean: -0.7688787579536438, mean p set: 0.44961148500442505
loss_pred:0.024214528501033783, decouple_loss:0.008214638568460941
The modified gen p mean: 0.44900307059288025, gen p mean: -0.7640554308891296, mean p set: 0.44948339462280273
loss_pred:0.024566950276494026, decouple_loss:0.008398114703595638
Iteration: 2482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44930359721183777, gen p mean: -0.7645861506462097, mean p set: 0.44978389143943787
The modified gen p mean: 0.45139554142951965, gen p mean: -0.7730091214179993, mean p set: 0.45187583565711975
The modified gen p mean: 0.4492533504962921, gen p mean: -0.7626749277114868, mean p set: 0.4497336745262146
loss_pred:0.023481005802750587, decouple_loss:0.008523785509169102
loss_pred:0.025749446824193, decouple_loss:0.008534515276551247
loss_pred:0.024760039523243904, decouple_loss:0.008394453674554825
Iteration: 2483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45121854543685913, gen p mean: -0.7722457647323608, mean p set: 0.45169880986213684
The modified gen p mean: 0.4503209590911865, gen p mean: -0.7681429982185364, mean p set: 0.45080122351646423
The modified gen p mean: 0.4504595994949341, gen p mean: -0.7730445861816406, mean p set: 0.45093992352485657
loss_pred:0.024964844807982445, decouple_loss:0.008454580791294575
loss_pred:0.02516629919409752, decouple_loss:0.008522754535079002
loss_pred:0.0258705522865057, decouple_loss:0.008484946563839912
Iteration: 2484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449188768863678, gen p mean: -0.7818537354469299, mean p set: 0.4496690630912781
The modified gen p mean: 0.4514003098011017, gen p mean: -0.7712876200675964, mean p set: 0.4518806040287018
The modified gen p mean: 0.4518599212169647, gen p mean: -0.7764089107513428, mean p set: 0.4523402154445648
loss_pred:0.024100275710225105, decouple_loss:0.00834723562002182
loss_pred:0.025118842720985413, decouple_loss:0.008786255493760109
loss_pred:0.02616599015891552, decouple_loss:0.008409256115555763
Iteration: 2485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497600793838501, gen p mean: -0.7840559482574463, mean p set: 0.4502403438091278
The modified gen p mean: 0.44988110661506653, gen p mean: -0.7922635674476624, mean p set: 0.4503614008426666
The modified gen p mean: 0.45158401131629944, gen p mean: -0.7854310274124146, mean p set: 0.45206427574157715
loss_pred:0.024219345301389694, decouple_loss:0.008251642808318138
loss_pred:0.024877117946743965, decouple_loss:0.008187521249055862
loss_pred:0.0253293514251709, decouple_loss:0.008475245907902718
Iteration: 2486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972214102745056, gen p mean: -0.7870702147483826, mean p set: 0.45020246505737305
The modified gen p mean: 0.44958746433258057, gen p mean: -0.7864198088645935, mean p set: 0.45006775856018066
The modified gen p mean: 0.44895821809768677, gen p mean: -0.7855178713798523, mean p set: 0.4494384825229645
loss_pred:0.025214409455657005, decouple_loss:0.008448041044175625
loss_pred:0.02414115145802498, decouple_loss:0.008167972788214684
loss_pred:0.023567982017993927, decouple_loss:0.00837149191647768
Iteration: 2487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495278596878052, gen p mean: -0.7874715924263, mean p set: 0.4500081539154053
The modified gen p mean: 0.45019733905792236, gen p mean: -0.7874529957771301, mean p set: 0.45067763328552246
The modified gen p mean: 0.4511968493461609, gen p mean: -0.7912084460258484, mean p set: 0.451677143573761
loss_pred:0.024872606620192528, decouple_loss:0.008255104534327984
loss_pred:0.024930689483880997, decouple_loss:0.008011306636035442
loss_pred:0.024907682090997696, decouple_loss:0.008232994936406612
Iteration: 2488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490774869918823, gen p mean: -0.7866005301475525, mean p set: 0.4495577812194824
The modified gen p mean: 0.44948163628578186, gen p mean: -0.7733981013298035, mean p set: 0.44996196031570435
The modified gen p mean: 0.44943127036094666, gen p mean: -0.7775005102157593, mean p set: 0.44991159439086914
loss_pred:0.0244450680911541, decouple_loss:0.007823587395250797
loss_pred:0.02539772354066372, decouple_loss:0.008364125154912472
loss_pred:0.023555928841233253, decouple_loss:0.007939278148114681
Iteration: 2489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44922783970832825, gen p mean: -0.7883086204528809, mean p set: 0.44970813393592834
The modified gen p mean: 0.45023706555366516, gen p mean: -0.7811407446861267, mean p set: 0.45071735978126526
The modified gen p mean: 0.44934192299842834, gen p mean: -0.7721822261810303, mean p set: 0.44982221722602844
loss_pred:0.024435825645923615, decouple_loss:0.00831414945423603
loss_pred:0.0236617773771286, decouple_loss:0.007887574844062328
loss_pred:0.025520503520965576, decouple_loss:0.008085809648036957
Iteration: 2490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45017534494400024, gen p mean: -0.7798576354980469, mean p set: 0.45065566897392273
The modified gen p mean: 0.45159292221069336, gen p mean: -0.779518187046051, mean p set: 0.45207321643829346
The modified gen p mean: 0.4491424560546875, gen p mean: -0.7844215035438538, mean p set: 0.4496227502822876
loss_pred:0.024845706298947334, decouple_loss:0.008151798509061337
loss_pred:0.0256792102009058, decouple_loss:0.008415648713707924
loss_pred:0.023146485909819603, decouple_loss:0.00824942346662283
2023-05-03 06:55:11 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7768799662590027, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7840931415557861, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7723526358604431, mean p set: 0.45035696029663086
loss_pred:0.025593694299459457, decouple_loss:0.008834652602672577
loss_pred:0.026645302772521973, decouple_loss:0.009087573736906052
loss_pred:0.02523117884993553, decouple_loss:0.008906685747206211
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026270542293787003, avg_mse: 0.03168831393122673
current test mse: 0.031688
Iteration: 2491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45126524567604065, gen p mean: -0.7753379344940186, mean p set: 0.45174553990364075
loss_pred:0.025530444458127022, decouple_loss:0.008651692420244217
The modified gen p mean: 0.4498962461948395, gen p mean: -0.7763875126838684, mean p set: 0.4503765404224396
loss_pred:0.02501489780843258, decouple_loss:0.008065060712397099
The modified gen p mean: 0.44972312450408936, gen p mean: -0.7746763825416565, mean p set: 0.45020341873168945
loss_pred:0.02498057298362255, decouple_loss:0.008055069483816624
Iteration: 2492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493320882320404, gen p mean: -0.7799376249313354, mean p set: 0.4498123526573181
The modified gen p mean: 0.4490998685359955, gen p mean: -0.7808382511138916, mean p set: 0.44958019256591797
The modified gen p mean: 0.44964835047721863, gen p mean: -0.7804849147796631, mean p set: 0.4501286447048187
loss_pred:0.024779653176665306, decouple_loss:0.007681431248784065
loss_pred:0.023662155494093895, decouple_loss:0.008008422330021858
loss_pred:0.02337382361292839, decouple_loss:0.008340640924870968
Iteration: 2493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511414170265198, gen p mean: -0.7797901034355164, mean p set: 0.4516216814517975
The modified gen p mean: 0.4506269693374634, gen p mean: -0.777348518371582, mean p set: 0.4511072635650635
The modified gen p mean: 0.44990983605384827, gen p mean: -0.7705236077308655, mean p set: 0.45039013028144836
loss_pred:0.02555839531123638, decouple_loss:0.008060228079557419
loss_pred:0.02510742098093033, decouple_loss:0.007968436926603317
loss_pred:0.02496478520333767, decouple_loss:0.00785110518336296
Iteration: 2494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495282769203186, gen p mean: -0.773675799369812, mean p set: 0.4500085711479187
The modified gen p mean: 0.44946151971817017, gen p mean: -0.7852651476860046, mean p set: 0.44994187355041504
The modified gen p mean: 0.4498801827430725, gen p mean: -0.7806280255317688, mean p set: 0.4503604471683502
loss_pred:0.024791283532977104, decouple_loss:0.0078117819502949715
loss_pred:0.023926911875605583, decouple_loss:0.007941920310258865
loss_pred:0.02352076582610607, decouple_loss:0.008000925183296204
Iteration: 2495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493030309677124, gen p mean: -0.7682356834411621, mean p set: 0.4497832953929901
The modified gen p mean: 0.45185160636901855, gen p mean: -0.7710425853729248, mean p set: 0.45233187079429626
The modified gen p mean: 0.45152056217193604, gen p mean: -0.7720504403114319, mean p set: 0.45200085639953613
loss_pred:0.02509777806699276, decouple_loss:0.007771110627800226
loss_pred:0.025487259030342102, decouple_loss:0.008108324371278286
loss_pred:0.024674013257026672, decouple_loss:0.008003749884665012
Iteration: 2496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45259803533554077, gen p mean: -0.7575998306274414, mean p set: 0.4530782699584961
The modified gen p mean: 0.4504971206188202, gen p mean: -0.767889142036438, mean p set: 0.4509774148464203
The modified gen p mean: 0.4511229395866394, gen p mean: -0.7662224769592285, mean p set: 0.4516032636165619
loss_pred:0.025490816682577133, decouple_loss:0.008500959724187851
loss_pred:0.025155816227197647, decouple_loss:0.007830758579075336
loss_pred:0.024162739515304565, decouple_loss:0.008235707879066467
Iteration: 2497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491126239299774, gen p mean: -0.7690712809562683, mean p set: 0.4495929181575775
The modified gen p mean: 0.4493807256221771, gen p mean: -0.7665185928344727, mean p set: 0.4498610198497772
The modified gen p mean: 0.4497816562652588, gen p mean: -0.7747964859008789, mean p set: 0.4502619802951813
loss_pred:0.024466687813401222, decouple_loss:0.007995967753231525loss_pred:0.025285935029387474, decouple_loss:0.007898050360381603
loss_pred:0.024683229625225067, decouple_loss:0.0077124289236962795
Iteration: 2498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512721002101898, gen p mean: -0.7676017880439758, mean p set: 0.45175236463546753
The modified gen p mean: 0.44902923703193665, gen p mean: -0.7689819931983948, mean p set: 0.44950950145721436
The modified gen p mean: 0.450796902179718, gen p mean: -0.777586817741394, mean p set: 0.4512771964073181
loss_pred:0.02599966526031494, decouple_loss:0.00792679749429226
loss_pred:0.025019938126206398, decouple_loss:0.008092007599771023
loss_pred:0.02524995431303978, decouple_loss:0.008052008226513863
Iteration: 2499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497954547405243, gen p mean: -0.7815900444984436, mean p set: 0.450275719165802
The modified gen p mean: 0.452171266078949, gen p mean: -0.7701293230056763, mean p set: 0.45265159010887146
The modified gen p mean: 0.4499051570892334, gen p mean: -0.7716983556747437, mean p set: 0.4503854513168335
loss_pred:0.022610392421483994, decouple_loss:0.00833031628280878
loss_pred:0.02494964189827442, decouple_loss:0.008221683092415333
loss_pred:0.0231563001871109, decouple_loss:0.007828336209058762
Iteration: 2500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496801793575287, gen p mean: -0.7760005593299866, mean p set: 0.4501604735851288
The modified gen p mean: 0.4490946829319, gen p mean: -0.7623639702796936, mean p set: 0.44957494735717773
The modified gen p mean: 0.4500953257083893, gen p mean: -0.7605319619178772, mean p set: 0.4505756199359894
loss_pred:0.023318588733673096, decouple_loss:0.007852276787161827
loss_pred:0.0229850634932518, decouple_loss:0.00774737074971199
loss_pred:0.025875570252537727, decouple_loss:0.00766780087724328
2023-05-03 06:58:53 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7661566734313965, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7738015055656433, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7619237303733826, mean p set: 0.45035696029663086
loss_pred:0.025569181889295578, decouple_loss:0.008453032933175564
loss_pred:0.026577595621347427, decouple_loss:0.008824525400996208
loss_pred:0.02518376335501671, decouple_loss:0.00851123034954071
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026206661015748978, avg_mse: 0.031622860580682755
current test mse: 0.031623
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
NaN value num: 0
Iteration: 2501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45282161235809326, gen p mean: -0.771694004535675, mean p set: 0.45330190658569336
The modified gen p mean: 0.4501267969608307, gen p mean: -0.7661376595497131, mean p set: 0.4506070911884308
loss_pred:0.02554475888609886, decouple_loss:0.00880834087729454
loss_pred:0.026433123275637627, decouple_loss:0.008710849098861217
The modified gen p mean: 0.4495389461517334, gen p mean: -0.7612559199333191, mean p set: 0.4500192403793335
loss_pred:0.026626715436577797, decouple_loss:0.008406395092606544
Iteration: 2502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523540735244751, gen p mean: -0.7769585847854614, mean p set: 0.4528343677520752
The modified gen p mean: 0.4506075978279114, gen p mean: -0.7607828378677368, mean p set: 0.4510878920555115
The modified gen p mean: 0.44992244243621826, gen p mean: -0.765180766582489, mean p set: 0.45040273666381836
loss_pred:0.026805873960256577, decouple_loss:0.008670656010508537
loss_pred:0.025540243834257126, decouple_loss:0.00894637405872345
loss_pred:0.026330970227718353, decouple_loss:0.008641221560537815
Iteration: 2503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44892454147338867, gen p mean: -0.7848114371299744, mean p set: 0.4494048058986664
The modified gen p mean: 0.4497276842594147, gen p mean: -0.7735257148742676, mean p set: 0.45020797848701477
The modified gen p mean: 0.45256519317626953, gen p mean: -0.7723764181137085, mean p set: 0.45304545760154724
loss_pred:0.025209708139300346, decouple_loss:0.008310366421937943
loss_pred:0.026524415239691734, decouple_loss:0.00867379643023014
loss_pred:0.025704631581902504, decouple_loss:0.009073902852833271
Iteration: 2504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45358121395111084, gen p mean: -0.7829228639602661, mean p set: 0.45406150817871094
The modified gen p mean: 0.449763685464859, gen p mean: -0.7767570614814758, mean p set: 0.4502440094947815
The modified gen p mean: 0.44983574748039246, gen p mean: -0.7668823599815369, mean p set: 0.45031604170799255
loss_pred:0.02495892345905304, decouple_loss:0.00863491091877222
loss_pred:0.027392324060201645, decouple_loss:0.008442587219178677
loss_pred:0.026663031429052353, decouple_loss:0.008706717751920223
Iteration: 2505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44934508204460144, gen p mean: -0.7634965181350708, mean p set: 0.44982537627220154
The modified gen p mean: 0.44953402876853943, gen p mean: -0.7673856019973755, mean p set: 0.4500143229961395
The modified gen p mean: 0.4511922299861908, gen p mean: -0.7728357315063477, mean p set: 0.4516725242137909
loss_pred:0.026478318497538567, decouple_loss:0.00848396960645914
loss_pred:0.026041731238365173, decouple_loss:0.00817425549030304
loss_pred:0.026621438562870026, decouple_loss:0.008314508013427258
Iteration: 2506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876691699028015, gen p mean: -0.7711926698684692, mean p set: 0.44924721121788025
The modified gen p mean: 0.45126333832740784, gen p mean: -0.7700851559638977, mean p set: 0.4517436623573303
The modified gen p mean: 0.44918400049209595, gen p mean: -0.7689292430877686, mean p set: 0.44966429471969604
loss_pred:0.02594071254134178, decouple_loss:0.008149776607751846
loss_pred:0.026602141559123993, decouple_loss:0.008320732042193413
loss_pred:0.026980020105838776, decouple_loss:0.00817425362765789
Iteration: 2507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500858783721924, gen p mean: -0.7743344902992249, mean p set: 0.4505661725997925
The modified gen p mean: 0.44972240924835205, gen p mean: -0.7672595977783203, mean p set: 0.45020267367362976
The modified gen p mean: 0.45007792115211487, gen p mean: -0.767400860786438, mean p set: 0.4505581855773926
loss_pred:0.02483559027314186, decouple_loss:0.008230648003518581
loss_pred:0.027149122208356857, decouple_loss:0.008305521681904793
loss_pred:0.025698676705360413, decouple_loss:0.008659240789711475
Iteration: 2508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013394951820374, gen p mean: -0.768591046333313, mean p set: 0.45061424374580383
The modified gen p mean: 0.45304596424102783, gen p mean: -0.772717297077179, mean p set: 0.45352625846862793
The modified gen p mean: 0.45070335268974304, gen p mean: -0.7649429440498352, mean p set: 0.4511836767196655
loss_pred:0.025268325582146645, decouple_loss:0.008032150566577911
loss_pred:0.025404980406165123, decouple_loss:0.00873095914721489
loss_pred:0.0263740886002779, decouple_loss:0.008415771648287773
Iteration: 2509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472643733024597, gen p mean: -0.7812723517417908, mean p set: 0.4477446675300598
The modified gen p mean: 0.44890356063842773, gen p mean: -0.7669535279273987, mean p set: 0.4493838846683502
The modified gen p mean: 0.44997432827949524, gen p mean: -0.7687438726425171, mean p set: 0.45045459270477295
loss_pred:0.025315754115581512, decouple_loss:0.008663670159876347
loss_pred:0.026207059621810913, decouple_loss:0.008628319017589092
loss_pred:0.024889402091503143, decouple_loss:0.007981711998581886
Iteration: 2510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530010223388672, gen p mean: -0.7671119570732117, mean p set: 0.4534813165664673
The modified gen p mean: 0.45039212703704834, gen p mean: -0.7699853181838989, mean p set: 0.45087239146232605
The modified gen p mean: 0.44970133900642395, gen p mean: -0.7606515288352966, mean p set: 0.45018163323402405
loss_pred:0.02636316977441311, decouple_loss:0.008850090205669403
loss_pred:0.025799596682190895, decouple_loss:0.008303863927721977
loss_pred:0.025749219581484795, decouple_loss:0.008403202518820763

2023-05-03 07:03:11 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7856728434562683, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7779659032821655, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7735564708709717, mean p set: 0.45035696029663086
loss_pred:0.02670133486390114, decouple_loss:0.008983142673969269
loss_pred:0.02561434544622898, decouple_loss:0.008767230436205864
loss_pred:0.025262173265218735, decouple_loss:0.008731488138437271
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026300650089979172, avg_mse: 0.03170790150761604
current test mse: 0.031708
Iteration: 2511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44980499148368835, gen p mean: -0.7717147469520569, mean p set: 0.45028528571128845
The modified gen p mean: 0.45171698927879333, gen p mean: -0.784416675567627, mean p set: 0.45219725370407104
loss_pred:0.025119446218013763, decouple_loss:0.007917170412838459
loss_pred:0.02521219104528427, decouple_loss:0.00888584554195404
The modified gen p mean: 0.44933873414993286, gen p mean: -0.790479838848114, mean p set: 0.44981902837753296
loss_pred:0.02558840438723564, decouple_loss:0.008383704349398613
Iteration: 2512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526509642601013, gen p mean: -0.7696138620376587, mean p set: 0.4531312584877014
The modified gen p mean: 0.4502222537994385, gen p mean: -0.7635785937309265, mean p set: 0.4507025480270386
The modified gen p mean: 0.4488403797149658, gen p mean: -0.7803235650062561, mean p set: 0.4493206739425659
loss_pred:0.025936618447303772, decouple_loss:0.008657282218337059
loss_pred:0.02684035710990429, decouple_loss:0.00824760366231203
loss_pred:0.025479432195425034, decouple_loss:0.008149651810526848
Iteration: 2513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502153992652893, gen p mean: -0.7606971859931946, mean p set: 0.450695663690567
The modified gen p mean: 0.45316675305366516, gen p mean: -0.7778506875038147, mean p set: 0.45364704728126526
The modified gen p mean: 0.4496876001358032, gen p mean: -0.7656124234199524, mean p set: 0.45016786456108093
loss_pred:0.026182644069194794, decouple_loss:0.008080040104687214
loss_pred:0.02532370202243328, decouple_loss:0.008253751322627068
loss_pred:0.026762057095766068, decouple_loss:0.008406410925090313
Iteration: 2514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498523473739624, gen p mean: -0.768258273601532, mean p set: 0.4503326416015625
The modified gen p mean: 0.44949871301651, gen p mean: -0.7552847862243652, mean p set: 0.4499790072441101
The modified gen p mean: 0.44873303174972534, gen p mean: -0.7635148763656616, mean p set: 0.44921332597732544
loss_pred:0.026773745194077492, decouple_loss:0.00830889493227005
loss_pred:0.025852175429463387, decouple_loss:0.007868419401347637
loss_pred:0.02598501183092594, decouple_loss:0.008187701925635338
Iteration: 2515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527396261692047, gen p mean: -0.7630515694618225, mean p set: 0.4532198905944824
The modified gen p mean: 0.44869181513786316, gen p mean: -0.7716805934906006, mean p set: 0.44917213916778564
The modified gen p mean: 0.4496884047985077, gen p mean: -0.76291424036026, mean p set: 0.4501686692237854
loss_pred:0.02608243003487587, decouple_loss:0.008582324720919132
loss_pred:0.025583986192941666, decouple_loss:0.007910855114459991
loss_pred:0.02573728747665882, decouple_loss:0.007999940775334835
Iteration: 2516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846272468566895, gen p mean: -0.7866126894950867, mean p set: 0.44894298911094666
The modified gen p mean: 0.4505919814109802, gen p mean: -0.78544020652771, mean p set: 0.4510722756385803
The modified gen p mean: 0.4498113691806793, gen p mean: -0.772894024848938, mean p set: 0.4502916932106018
loss_pred:0.024939503520727158, decouple_loss:0.00817492138594389
loss_pred:0.02574910782277584, decouple_loss:0.008113633841276169
loss_pred:0.026877259835600853, decouple_loss:0.008226749487221241
Iteration: 2517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44984570145606995, gen p mean: -0.7763653993606567, mean p set: 0.45032599568367004
The modified gen p mean: 0.45217224955558777, gen p mean: -0.791210412979126, mean p set: 0.45265257358551025
The modified gen p mean: 0.45048782229423523, gen p mean: -0.785042941570282, mean p set: 0.45096808671951294
loss_pred:0.02546522580087185, decouple_loss:0.007743684574961662
loss_pred:0.025668054819107056, decouple_loss:0.008723528124392033
loss_pred:0.02534426748752594, decouple_loss:0.007838856428861618
Iteration: 2518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451625794172287, gen p mean: -0.773067057132721, mean p set: 0.4521060883998871
The modified gen p mean: 0.45297864079475403, gen p mean: -0.783728301525116, mean p set: 0.4534589648246765
The modified gen p mean: 0.45271623134613037, gen p mean: -0.7651548981666565, mean p set: 0.4531964957714081
loss_pred:0.02626713737845421, decouple_loss:0.008411282673478127
loss_pred:0.02598268911242485, decouple_loss:0.008520418778061867
loss_pred:0.02650938183069229, decouple_loss:0.008333118632435799
Iteration: 2519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503084421157837, gen p mean: -0.7709818482398987, mean p set: 0.4507887363433838
The modified gen p mean: 0.451553612947464, gen p mean: -0.777738094329834, mean p set: 0.4520338773727417
The modified gen p mean: 0.4491724371910095, gen p mean: -0.7564858794212341, mean p set: 0.4496527314186096
loss_pred:0.02526223659515381, decouple_loss:0.008185889571905136
loss_pred:0.02610636129975319, decouple_loss:0.008605480194091797
loss_pred:0.02603970840573311, decouple_loss:0.008212488144636154
Iteration: 2520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485595226287842, gen p mean: -0.7776346802711487, mean p set: 0.44903984665870667
The modified gen p mean: 0.4514254629611969, gen p mean: -0.7678982019424438, mean p set: 0.451905757188797
loss_pred:0.025559574365615845, decouple_loss:0.008655092678964138
The modified gen p mean: 0.4492345154285431, gen p mean: -0.7587099075317383, mean p set: 0.4497148096561432
loss_pred:0.025591570883989334, decouple_loss:0.008422935381531715
loss_pred:0.02619984745979309, decouple_loss:0.008550476282835007
2023-05-03 07:06:55 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7665013074874878, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7734143733978271, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.761737048625946, mean p set: 0.45035696029663086
loss_pred:0.025666462257504463, decouple_loss:0.00918316375464201
loss_pred:0.02668178081512451, decouple_loss:0.009376343339681625
loss_pred:0.025338608771562576, decouple_loss:0.009173053316771984
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026357825845479965, avg_mse: 0.031740736216306686
current test mse: 0.031741
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
NaN value num: 0
Iteration: 2521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44757845997810364, gen p mean: -0.7641434073448181, mean p set: 0.44805875420570374
The modified gen p mean: 0.4463564455509186, gen p mean: -0.769109845161438, mean p set: 0.4468367099761963
loss_pred:0.025080278515815735, decouple_loss:0.008474944159388542
loss_pred:0.025554431602358818, decouple_loss:0.009062408469617367
The modified gen p mean: 0.44731464982032776, gen p mean: -0.767349362373352, mean p set: 0.44779494404792786
loss_pred:0.02621825411915779, decouple_loss:0.008791111409664154
Iteration: 2522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772693514823914, gen p mean: -0.765102744102478, mean p set: 0.44820722937583923
The modified gen p mean: 0.4475298523902893, gen p mean: -0.7709712982177734, mean p set: 0.4480101466178894
The modified gen p mean: 0.4464568793773651, gen p mean: -0.7760546803474426, mean p set: 0.4469371736049652
loss_pred:0.026842178776860237, decouple_loss:0.008417627774178982
loss_pred:0.02573179081082344, decouple_loss:0.008187617175281048
loss_pred:0.025467371568083763, decouple_loss:0.008694881573319435
Iteration: 2523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473946988582611, gen p mean: -0.7759943008422852, mean p set: 0.4478749632835388
The modified gen p mean: 0.4484093189239502, gen p mean: -0.793766975402832, mean p set: 0.4488895833492279
The modified gen p mean: 0.44694972038269043, gen p mean: -0.776707649230957, mean p set: 0.44742998480796814
loss_pred:0.025485089048743248, decouple_loss:0.008712171576917171
loss_pred:0.026323026046156883, decouple_loss:0.00975553598254919
loss_pred:0.027730826288461685, decouple_loss:0.008767514489591122
Iteration: 2524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446189284324646, gen p mean: -0.7875750064849854, mean p set: 0.4466695487499237
The modified gen p mean: 0.4473939538002014, gen p mean: -0.7920398116111755, mean p set: 0.4478742182254791
The modified gen p mean: 0.4463949501514435, gen p mean: -0.7858951687812805, mean p set: 0.4468752145767212
loss_pred:0.025684623047709465, decouple_loss:0.00842257309705019
loss_pred:0.026349997147917747, decouple_loss:0.008557635359466076
loss_pred:0.024902015924453735, decouple_loss:0.008324592374265194
Iteration: 2525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471362829208374, gen p mean: -0.7776453495025635, mean p set: 0.4476166069507599
The modified gen p mean: 0.4461573362350464, gen p mean: -0.7863622903823853, mean p set: 0.44663766026496887
The modified gen p mean: 0.44732072949409485, gen p mean: -0.7874835133552551, mean p set: 0.44780099391937256
loss_pred:0.025634214282035828, decouple_loss:0.00824263971298933
loss_pred:0.025348033756017685, decouple_loss:0.008283012546598911
loss_pred:0.02528953365981579, decouple_loss:0.008352166973054409
Iteration: 2526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44848692417144775, gen p mean: -0.7905247807502747, mean p set: 0.44896718859672546
The modified gen p mean: 0.4472602307796478, gen p mean: -0.7776951789855957, mean p set: 0.4477405250072479
The modified gen p mean: 0.44661176204681396, gen p mean: -0.7789210677146912, mean p set: 0.44709208607673645
loss_pred:0.0258388202637434, decouple_loss:0.009115194901823997
loss_pred:0.025178629904985428, decouple_loss:0.008368329145014286
loss_pred:0.025516431778669357, decouple_loss:0.008633404038846493
Iteration: 2527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714874029159546, gen p mean: -0.772236168384552, mean p set: 0.44762900471687317
The modified gen p mean: 0.4480491578578949, gen p mean: -0.768254280090332, mean p set: 0.4485294818878174
The modified gen p mean: 0.44698768854141235, gen p mean: -0.7776255011558533, mean p set: 0.44746798276901245
loss_pred:0.02532161958515644, decouple_loss:0.008104560896754265
loss_pred:0.02676740288734436, decouple_loss:0.008200162090361118
loss_pred:0.02553904987871647, decouple_loss:0.008160785771906376
Iteration: 2528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469406008720398, gen p mean: -0.7807220816612244, mean p set: 0.4474208950996399
The modified gen p mean: 0.4476805627346039, gen p mean: -0.7714546322822571, mean p set: 0.448160856962204
The modified gen p mean: 0.4465195834636688, gen p mean: -0.7768663167953491, mean p set: 0.44699984788894653
loss_pred:0.02526824176311493, decouple_loss:0.008262163028120995
loss_pred:0.025825826451182365, decouple_loss:0.008258707821369171
loss_pred:0.025631222873926163, decouple_loss:0.008135576732456684
Iteration: 2529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494279623031616, gen p mean: -0.7845867872238159, mean p set: 0.44990822672843933
The modified gen p mean: 0.4478931128978729, gen p mean: -0.7618986368179321, mean p set: 0.448373407125473
The modified gen p mean: 0.4474177360534668, gen p mean: -0.7669059038162231, mean p set: 0.4478980302810669
loss_pred:0.02586522325873375, decouple_loss:0.009465306997299194
loss_pred:0.025780579075217247, decouple_loss:0.008186869323253632
loss_pred:0.025122428312897682, decouple_loss:0.008403405547142029
Iteration: 2530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721201062202454, gen p mean: -0.769264280796051, mean p set: 0.44769227504730225
The modified gen p mean: 0.44681090116500854, gen p mean: -0.7698977589607239, mean p set: 0.44729119539260864
The modified gen p mean: 0.44735077023506165, gen p mean: -0.7655535340309143, mean p set: 0.44783106446266174
loss_pred:0.025113128125667572, decouple_loss:0.00864535290747881
loss_pred:0.02507076971232891, decouple_loss:0.008259234018623829
loss_pred:0.025305835530161858, decouple_loss:0.008194457739591599
2023-05-03 07:11:19 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7667028307914734, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7739078998565674, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7621119618415833, mean p set: 0.45035696029663086
loss_pred:0.02574555203318596, decouple_loss:0.008650983683764935
loss_pred:0.02681421861052513, decouple_loss:0.008995109237730503
loss_pred:0.025485273450613022, decouple_loss:0.008819973096251488
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026456115767359734, avg_mse: 0.03201419860124588
current test mse: 0.032014
Iteration: 2531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472357928752899, gen p mean: -0.7680539488792419, mean p set: 0.4477160573005676
The modified gen p mean: 0.4473946988582611, gen p mean: -0.766812801361084, mean p set: 0.4478749930858612
loss_pred:0.025076132267713547, decouple_loss:0.008346263319253922
loss_pred:0.02554944157600403, decouple_loss:0.008238024078309536
The modified gen p mean: 0.4470658600330353, gen p mean: -0.76389080286026, mean p set: 0.447546124458313
loss_pred:0.02725093998014927, decouple_loss:0.00841063354164362
Iteration: 2532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459533095359802, gen p mean: -0.7820053696632385, mean p set: 0.4464336037635803
The modified gen p mean: 0.4484701454639435, gen p mean: -0.7722980380058289, mean p set: 0.4489504396915436
The modified gen p mean: 0.44760653376579285, gen p mean: -0.7821218371391296, mean p set: 0.44808676838874817
loss_pred:0.02538948506116867, decouple_loss:0.008401402272284031
loss_pred:0.026184281334280968, decouple_loss:0.00803476944565773
loss_pred:0.025033341720700264, decouple_loss:0.008192270994186401
Iteration: 2533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472832977771759, gen p mean: -0.7814283967018127, mean p set: 0.4477635622024536
The modified gen p mean: 0.44622308015823364, gen p mean: -0.778020977973938, mean p set: 0.44670340418815613
The modified gen p mean: 0.4472377598285675, gen p mean: -0.7788912653923035, mean p set: 0.4477180242538452
loss_pred:0.024968072772026062, decouple_loss:0.008026518858969212
loss_pred:0.024970902130007744, decouple_loss:0.008252963423728943
loss_pred:0.026614923030138016, decouple_loss:0.00820726528763771
Iteration: 2534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729548692703247, gen p mean: -0.7785586714744568, mean p set: 0.44777578115463257
The modified gen p mean: 0.446159690618515, gen p mean: -0.7816259860992432, mean p set: 0.4466399550437927
The modified gen p mean: 0.44772329926490784, gen p mean: -0.7781732082366943, mean p set: 0.44820359349250793
loss_pred:0.025063814595341682, decouple_loss:0.008251171559095383
loss_pred:0.02546781115233898, decouple_loss:0.008247802034020424
loss_pred:0.025294579565525055, decouple_loss:0.008103849366307259
Iteration: 2535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469488859176636, gen p mean: -0.7654129862785339, mean p set: 0.44742920994758606
The modified gen p mean: 0.4470890462398529, gen p mean: -0.7754279971122742, mean p set: 0.447569340467453
The modified gen p mean: 0.446994811296463, gen p mean: -0.7640558481216431, mean p set: 0.4474751055240631
loss_pred:0.025531325489282608, decouple_loss:0.008560615591704845
loss_pred:0.02541116066277027, decouple_loss:0.008302658796310425
loss_pred:0.02482851967215538, decouple_loss:0.008020180277526379
Iteration: 2536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471409320831299, gen p mean: -0.7579829096794128, mean p set: 0.44762122631073
The modified gen p mean: 0.44786348938941956, gen p mean: -0.7613970637321472, mean p set: 0.44834375381469727
The modified gen p mean: 0.44754984974861145, gen p mean: -0.7610582113265991, mean p set: 0.44803011417388916
loss_pred:0.025454966351389885, decouple_loss:0.007981035858392715
loss_pred:0.027126645669341087, decouple_loss:0.008459442295134068
loss_pred:0.02729346975684166, decouple_loss:0.00837777927517891
Iteration: 2537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44558024406433105, gen p mean: -0.7643862366676331, mean p set: 0.44606053829193115
The modified gen p mean: 0.4476718306541443, gen p mean: -0.7707517743110657, mean p set: 0.448152095079422
The modified gen p mean: 0.4474044740200043, gen p mean: -0.7693431973457336, mean p set: 0.44788476824760437
loss_pred:0.02466358244419098, decouple_loss:0.008008750155568123
loss_pred:0.025209179148077965, decouple_loss:0.007937576621770859
loss_pred:0.024560876190662384, decouple_loss:0.008455236442387104
Iteration: 2538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717586040496826, gen p mean: -0.7711775302886963, mean p set: 0.44765612483024597
The modified gen p mean: 0.4456823468208313, gen p mean: -0.7741310000419617, mean p set: 0.4461626410484314
The modified gen p mean: 0.44675570726394653, gen p mean: -0.7781096696853638, mean p set: 0.44723597168922424
loss_pred:0.02517400123178959, decouple_loss:0.0077725485898554325
loss_pred:0.02409166842699051, decouple_loss:0.007789631839841604
loss_pred:0.025488588958978653, decouple_loss:0.007900322787463665
Iteration: 2539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758981466293335, gen p mean: -0.7709598541259766, mean p set: 0.44807007908821106
The modified gen p mean: 0.44671186804771423, gen p mean: -0.7686445116996765, mean p set: 0.44719216227531433
The modified gen p mean: 0.44653427600860596, gen p mean: -0.77663654088974, mean p set: 0.44701457023620605
loss_pred:0.025423437356948853, decouple_loss:0.007666504941880703
loss_pred:0.02472413145005703, decouple_loss:0.0076162973418831825
loss_pred:0.02542750909924507, decouple_loss:0.007963400334119797
Iteration: 2540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477144181728363, gen p mean: -0.7671486735343933, mean p set: 0.4481947124004364
The modified gen p mean: 0.4470345973968506, gen p mean: -0.7685785889625549, mean p set: 0.4475148916244507
The modified gen p mean: 0.44905394315719604, gen p mean: -0.7845369577407837, mean p set: 0.44953420758247375
loss_pred:0.026480501517653465, decouple_loss:0.007540236692875624
loss_pred:0.02474019303917885, decouple_loss:0.00760891567915678
loss_pred:0.02565181255340576, decouple_loss:0.009097601287066936
2023-05-03 07:15:02 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7610618472099304, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7677069306373596, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7564935684204102, mean p set: 0.45035696029663086
loss_pred:0.0256817489862442, decouple_loss:0.0083314785733819
loss_pred:0.026776475831866264, decouple_loss:0.008457781746983528
loss_pred:0.025483762845396996, decouple_loss:0.008292830549180508
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02639869973063469, avg_mse: 0.03199557960033417
current test mse: 0.031996
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
NaN value num: 0
Iteration: 2541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44946858286857605, gen p mean: -0.7646788358688354, mean p set: 0.44994887709617615
The modified gen p mean: 0.44699928164482117, gen p mean: -0.7679311633110046, mean p set: 0.44747960567474365
loss_pred:0.025538276880979538, decouple_loss:0.00813769269734621
loss_pred:0.025020359084010124, decouple_loss:0.007979374378919601
The modified gen p mean: 0.44752398133277893, gen p mean: -0.7664133310317993, mean p set: 0.44800424575805664
loss_pred:0.024820905178785324, decouple_loss:0.008148050867021084
Iteration: 2542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490186870098114, gen p mean: -0.7591312527656555, mean p set: 0.4494989514350891
The modified gen p mean: 0.4479266107082367, gen p mean: -0.7517114877700806, mean p set: 0.4484068751335144
The modified gen p mean: 0.4484110474586487, gen p mean: -0.75672847032547, mean p set: 0.4488913118839264
loss_pred:0.02584197372198105, decouple_loss:0.008073396049439907loss_pred:0.02572721056640148, decouple_loss:0.008177057839930058
loss_pred:0.025603845715522766, decouple_loss:0.008097203448414803
Iteration: 2543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44700634479522705, gen p mean: -0.758700430393219, mean p set: 0.44748660922050476
The modified gen p mean: 0.4481637179851532, gen p mean: -0.7546568512916565, mean p set: 0.4486440122127533
The modified gen p mean: 0.44881823658943176, gen p mean: -0.7575774192810059, mean p set: 0.4492984712123871
loss_pred:0.02487565018236637, decouple_loss:0.008006677031517029
loss_pred:0.026133684441447258, decouple_loss:0.008279279805719852
loss_pred:0.024494361132383347, decouple_loss:0.008023865520954132
Iteration: 2544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478825628757477, gen p mean: -0.7632887363433838, mean p set: 0.4483628571033478
The modified gen p mean: 0.4468826949596405, gen p mean: -0.7598466277122498, mean p set: 0.4473629891872406
The modified gen p mean: 0.4475351572036743, gen p mean: -0.7752004861831665, mean p set: 0.448015421628952
loss_pred:0.02717304602265358, decouple_loss:0.008300329558551311
loss_pred:0.025177350267767906, decouple_loss:0.007937038317322731
loss_pred:0.024669166654348373, decouple_loss:0.008433811366558075
Iteration: 2545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484071135520935, gen p mean: -0.7638314366340637, mean p set: 0.4488873779773712
The modified gen p mean: 0.44756072759628296, gen p mean: -0.7673718929290771, mean p set: 0.44804099202156067
The modified gen p mean: 0.4482695758342743, gen p mean: -0.7694979310035706, mean p set: 0.4487498700618744
loss_pred:0.02596820518374443, decouple_loss:0.007940618321299553
loss_pred:0.02600453607738018, decouple_loss:0.00782030075788498
loss_pred:0.02473943494260311, decouple_loss:0.0076253218576312065
Iteration: 2546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710037112236023, gen p mean: -0.7728252410888672, mean p set: 0.4475806653499603
The modified gen p mean: 0.4477567672729492, gen p mean: -0.7776665091514587, mean p set: 0.44823703169822693
The modified gen p mean: 0.4481664299964905, gen p mean: -0.7699412107467651, mean p set: 0.4486467242240906
loss_pred:0.025595465674996376, decouple_loss:0.00795078370720148
loss_pred:0.02770410291850567, decouple_loss:0.007837751880288124
loss_pred:0.02594663016498089, decouple_loss:0.007976698689162731
Iteration: 2547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749295711517334, gen p mean: -0.778793215751648, mean p set: 0.44797322154045105
The modified gen p mean: 0.44687747955322266, gen p mean: -0.7690954804420471, mean p set: 0.44735774397850037
The modified gen p mean: 0.44786784052848816, gen p mean: -0.7887929081916809, mean p set: 0.44834810495376587
loss_pred:0.026309784501791, decouple_loss:0.007914082147181034
loss_pred:0.025368228554725647, decouple_loss:0.007846187800168991
loss_pred:0.02568666823208332, decouple_loss:0.008145881816744804
Iteration: 2548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468431770801544, gen p mean: -0.7740643620491028, mean p set: 0.4473235011100769
The modified gen p mean: 0.4472469985485077, gen p mean: -0.7767637968063354, mean p set: 0.4477272629737854
The modified gen p mean: 0.44754984974861145, gen p mean: -0.7745179533958435, mean p set: 0.4480300843715668
loss_pred:0.02770150639116764, decouple_loss:0.007655479945242405
loss_pred:0.025546958670020103, decouple_loss:0.00789347942918539
loss_pred:0.024927519261837006, decouple_loss:0.007718977052718401
Iteration: 2549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469091296195984, gen p mean: -0.7742202877998352, mean p set: 0.4473893940448761
The modified gen p mean: 0.4484841525554657, gen p mean: -0.7693877816200256, mean p set: 0.4489644169807434
The modified gen p mean: 0.44846656918525696, gen p mean: -0.7705984711647034, mean p set: 0.44894686341285706
loss_pred:0.02602643333375454, decouple_loss:0.007718727923929691
loss_pred:0.024835262447595596, decouple_loss:0.007441693916916847
loss_pred:0.025454923510551453, decouple_loss:0.00753455376252532
Iteration: 2550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458010792732239, gen p mean: -0.7710435390472412, mean p set: 0.44628140330314636
The modified gen p mean: 0.44798776507377625, gen p mean: -0.7718851566314697, mean p set: 0.44846805930137634
The modified gen p mean: 0.4477536678314209, gen p mean: -0.7753123044967651, mean p set: 0.4482339918613434
loss_pred:0.026082152500748634, decouple_loss:0.00812647957354784
loss_pred:0.026265891268849373, decouple_loss:0.007685741409659386
loss_pred:0.02516208589076996, decouple_loss:0.007552096154540777
2023-05-03 07:19:24 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7748464941978455, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7823744416236877, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7696675658226013, mean p set: 0.45035696029663086
loss_pred:0.025529611855745316, decouple_loss:0.007867934182286263
loss_pred:0.026602618396282196, decouple_loss:0.008141602389514446
loss_pred:0.025222815573215485, decouple_loss:0.007897415198385715
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026183463633060455, avg_mse: 0.03170812129974365
current test mse: 0.031708
Iteration: 2551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788849353790283, gen p mean: -0.7718939185142517, mean p set: 0.44836878776550293
loss_pred:0.025365186855196953, decouple_loss:0.007357001770287752
The modified gen p mean: 0.4480271637439728, gen p mean: -0.7751737236976624, mean p set: 0.4485074579715729
loss_pred:0.025375070050358772, decouple_loss:0.0075548975728452206
The modified gen p mean: 0.4475783109664917, gen p mean: -0.7860761284828186, mean p set: 0.4480586349964142
loss_pred:0.025799104943871498, decouple_loss:0.007538938894867897
Iteration: 2552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474712014198303, gen p mean: -0.775481104850769, mean p set: 0.44795146584510803
The modified gen p mean: 0.44728729128837585, gen p mean: -0.781981885433197, mean p set: 0.44776758551597595
The modified gen p mean: 0.44786718487739563, gen p mean: -0.7687841653823853, mean p set: 0.44834744930267334
loss_pred:0.02592417411506176, decouple_loss:0.007622355129569769
loss_pred:0.025814959779381752, decouple_loss:0.00735975056886673
loss_pred:0.025865688920021057, decouple_loss:0.00792716071009636
Iteration: 2553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482854902744293, gen p mean: -0.7694721221923828, mean p set: 0.44876575469970703
The modified gen p mean: 0.44763243198394775, gen p mean: -0.7627905011177063, mean p set: 0.44811269640922546
The modified gen p mean: 0.4475327730178833, gen p mean: -0.7813308238983154, mean p set: 0.4480130672454834
loss_pred:0.025442777201533318, decouple_loss:0.007993939332664013
loss_pred:0.025819363072514534, decouple_loss:0.007657358422875404
loss_pred:0.025484196841716766, decouple_loss:0.007945789024233818
Iteration: 2554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449051171541214, gen p mean: -0.7647162079811096, mean p set: 0.4495314955711365
The modified gen p mean: 0.44796356558799744, gen p mean: -0.7564430832862854, mean p set: 0.44844383001327515
The modified gen p mean: 0.447560578584671, gen p mean: -0.767571210861206, mean p set: 0.4480408728122711
loss_pred:0.024772947654128075, decouple_loss:0.007566520944237709loss_pred:0.02575060911476612, decouple_loss:0.007511189207434654
loss_pred:0.026763062924146652, decouple_loss:0.008073349483311176
Iteration: 2555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483993351459503, gen p mean: -0.7648939490318298, mean p set: 0.448879599571228
The modified gen p mean: 0.44696488976478577, gen p mean: -0.7695152163505554, mean p set: 0.44744521379470825
The modified gen p mean: 0.44762560725212097, gen p mean: -0.7633553743362427, mean p set: 0.4481058716773987
loss_pred:0.024930620566010475, decouple_loss:0.007733468897640705
loss_pred:0.025533759966492653, decouple_loss:0.00774481100961566
loss_pred:0.025116363540291786, decouple_loss:0.007503904867917299
Iteration: 2556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835206866264343, gen p mean: -0.7700797319412231, mean p set: 0.44883236289024353
The modified gen p mean: 0.4461074769496918, gen p mean: -0.7640666365623474, mean p set: 0.4465877413749695
The modified gen p mean: 0.44791364669799805, gen p mean: -0.7821647524833679, mean p set: 0.44839391112327576
loss_pred:0.025683199986815453, decouple_loss:0.007759766187518835
loss_pred:0.02577187307178974, decouple_loss:0.007804599590599537
loss_pred:0.024688446894288063, decouple_loss:0.008078192360699177
Iteration: 2557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470180869102478, gen p mean: -0.7672645449638367, mean p set: 0.4474983811378479
The modified gen p mean: 0.4464336335659027, gen p mean: -0.7692972421646118, mean p set: 0.4469138979911804
The modified gen p mean: 0.4474649727344513, gen p mean: -0.7814697027206421, mean p set: 0.4479452073574066
loss_pred:0.025944368913769722, decouple_loss:0.007562241517007351
loss_pred:0.027781233191490173, decouple_loss:0.007690925616770983
loss_pred:0.024477507919073105, decouple_loss:0.008010885678231716
Iteration: 2558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478951692581177, gen p mean: -0.7645384073257446, mean p set: 0.4483754336833954
The modified gen p mean: 0.44760170578956604, gen p mean: -0.7727359533309937, mean p set: 0.4480820298194885
The modified gen p mean: 0.44651171565055847, gen p mean: -0.7667496800422668, mean p set: 0.4469919800758362
loss_pred:0.026000097393989563, decouple_loss:0.007195750717073679
loss_pred:0.025845032185316086, decouple_loss:0.007513394579291344
loss_pred:0.027342554181814194, decouple_loss:0.007305209059268236
Iteration: 2559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960349798202515, gen p mean: -0.7747817039489746, mean p set: 0.45008379220962524
The modified gen p mean: 0.4475826621055603, gen p mean: -0.7805227637290955, mean p set: 0.4480629861354828
The modified gen p mean: 0.4455285668373108, gen p mean: -0.7705581784248352, mean p set: 0.4460088610649109
loss_pred:0.024414343759417534, decouple_loss:0.007534447126090527
loss_pred:0.025723930448293686, decouple_loss:0.007200049702078104
loss_pred:0.025774994865059853, decouple_loss:0.008004254661500454
Iteration: 2560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476946294307709, gen p mean: -0.7957183122634888, mean p set: 0.44817492365837097
The modified gen p mean: 0.4471080005168915, gen p mean: -0.7809407711029053, mean p set: 0.44758832454681396
The modified gen p mean: 0.44843438267707825, gen p mean: -0.7771658897399902, mean p set: 0.44891470670700073
loss_pred:0.02414092607796192, decouple_loss:0.007803159300237894
loss_pred:0.027607383206486702, decouple_loss:0.007492841221392155
loss_pred:0.02453683316707611, decouple_loss:0.007261800114065409
2023-05-03 07:23:05 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7725211977958679, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7797917723655701, mean p set: 0.4502691626548767
The modified gen p mean: 0.4498766362667084, gen p mean: -0.767501711845398, mean p set: 0.45035696029663086
loss_pred:0.025419946759939194, decouple_loss:0.007870006375014782
loss_pred:0.026373686268925667, decouple_loss:0.008040618151426315
loss_pred:0.025170346722006798, decouple_loss:0.007847663946449757
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026050632819533348, avg_mse: 0.0315413735806942
current test mse: 0.031541
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 2561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485422968864441, gen p mean: -0.766110360622406, mean p set: 0.4490225911140442
loss_pred:0.025627413764595985, decouple_loss:0.007860439829528332
The modified gen p mean: 0.4476868510246277, gen p mean: -0.7657175064086914, mean p set: 0.4481671154499054
loss_pred:0.026104889810085297, decouple_loss:0.008288457989692688
The modified gen p mean: 0.44945159554481506, gen p mean: -0.7654953598976135, mean p set: 0.44993188977241516
loss_pred:0.025210220366716385, decouple_loss:0.007940026931464672
Iteration: 2562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44882193207740784, gen p mean: -0.769311249256134, mean p set: 0.44930222630500793
The modified gen p mean: 0.44782355427742004, gen p mean: -0.7761602997779846, mean p set: 0.44830384850502014
The modified gen p mean: 0.44897907972335815, gen p mean: -0.7765346765518188, mean p set: 0.44945937395095825
loss_pred:0.02587590552866459, decouple_loss:0.008361841551959515
loss_pred:0.024886729195713997, decouple_loss:0.008046716451644897
loss_pred:0.024962520226836205, decouple_loss:0.008135543204843998
Iteration: 2563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783222675323486, gen p mean: -0.7781367897987366, mean p set: 0.4483124613761902
The modified gen p mean: 0.4488055408000946, gen p mean: -0.7778220176696777, mean p set: 0.4492858350276947
The modified gen p mean: 0.4485201835632324, gen p mean: -0.7788397073745728, mean p set: 0.44900044798851013
loss_pred:0.024540269747376442, decouple_loss:0.00796045083552599
loss_pred:0.02533860132098198, decouple_loss:0.007982837036252022
loss_pred:0.02519737370312214, decouple_loss:0.008241022936999798
Iteration: 2564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835829734802246, gen p mean: -0.7722334265708923, mean p set: 0.44883859157562256
The modified gen p mean: 0.4477083384990692, gen p mean: -0.7709822654724121, mean p set: 0.4481886029243469
The modified gen p mean: 0.44849711656570435, gen p mean: -0.7730110287666321, mean p set: 0.44897738099098206
loss_pred:0.02534249611198902, decouple_loss:0.008101968094706535
loss_pred:0.025151783600449562, decouple_loss:0.008197080343961716
loss_pred:0.025267666205763817, decouple_loss:0.008154075592756271
Iteration: 2565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484025537967682, gen p mean: -0.7702018618583679, mean p set: 0.4488828480243683
The modified gen p mean: 0.44792136549949646, gen p mean: -0.7678820490837097, mean p set: 0.44840162992477417
The modified gen p mean: 0.4473377764225006, gen p mean: -0.7669366002082825, mean p set: 0.4478180706501007
loss_pred:0.025656808167696, decouple_loss:0.008512984029948711
loss_pred:0.025283319875597954, decouple_loss:0.007973121479153633
loss_pred:0.025910915806889534, decouple_loss:0.00871257483959198
Iteration: 2566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44917917251586914, gen p mean: -0.7676966190338135, mean p set: 0.44965940713882446
The modified gen p mean: 0.44761672616004944, gen p mean: -0.7710148096084595, mean p set: 0.4480970501899719
The modified gen p mean: 0.44881996512413025, gen p mean: -0.7689328193664551, mean p set: 0.44930025935173035
loss_pred:0.024943191558122635, decouple_loss:0.00830133818089962
loss_pred:0.02498583495616913, decouple_loss:0.008123290725052357
loss_pred:0.025052251294255257, decouple_loss:0.007924310863018036
Iteration: 2567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808340072631836, gen p mean: -0.7681531310081482, mean p set: 0.44856372475624084
The modified gen p mean: 0.44793662428855896, gen p mean: -0.766655445098877, mean p set: 0.44841691851615906
The modified gen p mean: 0.4484231472015381, gen p mean: -0.761807918548584, mean p set: 0.4489034116268158
loss_pred:0.02519121766090393, decouple_loss:0.008081082254648209
loss_pred:0.024530310183763504, decouple_loss:0.00806798879057169
loss_pred:0.02502656914293766, decouple_loss:0.008001528680324554
Iteration: 2568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479890763759613, gen p mean: -0.7554789185523987, mean p set: 0.448469340801239
The modified gen p mean: 0.4474453926086426, gen p mean: -0.7550649046897888, mean p set: 0.4479256868362427
The modified gen p mean: 0.44884926080703735, gen p mean: -0.76580810546875, mean p set: 0.44932955503463745
loss_pred:0.025500940158963203, decouple_loss:0.008188030682504177
loss_pred:0.025432640686631203, decouple_loss:0.008192036300897598
loss_pred:0.025931725278496742, decouple_loss:0.007824170403182507
Iteration: 2569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486697316169739, gen p mean: -0.7617472410202026, mean p set: 0.449150025844574
The modified gen p mean: 0.4485749304294586, gen p mean: -0.7606425881385803, mean p set: 0.44905519485473633
The modified gen p mean: 0.44944050908088684, gen p mean: -0.7484508752822876, mean p set: 0.44992080330848694
loss_pred:0.025233199819922447, decouple_loss:0.008243992924690247
loss_pred:0.025694116950035095, decouple_loss:0.008540518581867218
loss_pred:0.026336539536714554, decouple_loss:0.008286445401608944
Iteration: 2570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44868409633636475, gen p mean: -0.7608011960983276, mean p set: 0.44916436076164246
The modified gen p mean: 0.4497270882129669, gen p mean: -0.7540008425712585, mean p set: 0.450207382440567
The modified gen p mean: 0.44923079013824463, gen p mean: -0.7577099800109863, mean p set: 0.44971105456352234
loss_pred:0.024864692240953445, decouple_loss:0.007755653001368046
loss_pred:0.024895939975976944, decouple_loss:0.008267452009022236
loss_pred:0.025579120963811874, decouple_loss:0.008230594918131828
2023-05-03 07:27:36 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7636642456054688, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7708576917648315, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.759438157081604, mean p set: 0.45035696029663086
loss_pred:0.025405490770936012, decouple_loss:0.007905587553977966
loss_pred:0.02636888064444065, decouple_loss:0.008268683217465878
loss_pred:0.0251902025192976, decouple_loss:0.008114876225590706
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026059677824378014, avg_mse: 0.03151440620422363
current test mse: 0.031514
Iteration: 2571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840681552886963, gen p mean: -0.7671486735343933, mean p set: 0.4488871097564697
The modified gen p mean: 0.4484126567840576, gen p mean: -0.760338306427002, mean p set: 0.4488929510116577
loss_pred:0.02540922351181507, decouple_loss:0.008240588009357452
loss_pred:0.025519654154777527, decouple_loss:0.007985535077750683
The modified gen p mean: 0.4480079710483551, gen p mean: -0.7635809183120728, mean p set: 0.4484882652759552
loss_pred:0.025272835046052933, decouple_loss:0.007822412066161633
Iteration: 2572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877612590789795, gen p mean: -0.7672536373138428, mean p set: 0.44925642013549805
The modified gen p mean: 0.4481750428676605, gen p mean: -0.7645565271377563, mean p set: 0.4486553370952606
The modified gen p mean: 0.4499695599079132, gen p mean: -0.7675581574440002, mean p set: 0.4504498541355133
loss_pred:0.02581675909459591, decouple_loss:0.007542141713202
loss_pred:0.025541119277477264, decouple_loss:0.007667636964470148
loss_pred:0.025806719437241554, decouple_loss:0.007769174408167601
Iteration: 2573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448650598526001, gen p mean: -0.761538028717041, mean p set: 0.44913092255592346
The modified gen p mean: 0.4474776089191437, gen p mean: -0.760942816734314, mean p set: 0.4479579031467438
The modified gen p mean: 0.4491414427757263, gen p mean: -0.7727487087249756, mean p set: 0.4496217370033264
loss_pred:0.025098534300923347, decouple_loss:0.007584197912365198
loss_pred:0.025248868390917778, decouple_loss:0.007867109030485153
loss_pred:0.02507917210459709, decouple_loss:0.007575374562293291
Iteration: 2574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786936044692993, gen p mean: -0.76553875207901, mean p set: 0.44834965467453003
The modified gen p mean: 0.4483506977558136, gen p mean: -0.7654767632484436, mean p set: 0.4488309919834137
The modified gen p mean: 0.4471559226512909, gen p mean: -0.768377959728241, mean p set: 0.4476362466812134
loss_pred:0.02585347555577755, decouple_loss:0.007967047393321991
loss_pred:0.02603520266711712, decouple_loss:0.007763972505927086
loss_pred:0.02616690658032894, decouple_loss:0.008283136412501335
Iteration: 2575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492274224758148, gen p mean: -0.7593480348587036, mean p set: 0.4497077465057373
The modified gen p mean: 0.4489496946334839, gen p mean: -0.755470335483551, mean p set: 0.449429988861084
The modified gen p mean: 0.4480856955051422, gen p mean: -0.7648096084594727, mean p set: 0.4485659599304199
loss_pred:0.024733735248446465, decouple_loss:0.007624361198395491
loss_pred:0.025584135204553604, decouple_loss:0.007930445484817028
loss_pred:0.025224436074495316, decouple_loss:0.007949922233819962
Iteration: 2576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44895660877227783, gen p mean: -0.758421778678894, mean p set: 0.44943690299987793
The modified gen p mean: 0.4485860764980316, gen p mean: -0.7630616426467896, mean p set: 0.4490663409233093
The modified gen p mean: 0.4494444727897644, gen p mean: -0.7646709084510803, mean p set: 0.4499247372150421
loss_pred:0.02453411929309368, decouple_loss:0.00761129567399621
loss_pred:0.025339582934975624, decouple_loss:0.007958643138408661
loss_pred:0.02473253570497036, decouple_loss:0.007976863533258438
Iteration: 2577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487764537334442, gen p mean: -0.7556719183921814, mean p set: 0.4492567181587219
The modified gen p mean: 0.4487597942352295, gen p mean: -0.7596654295921326, mean p set: 0.4492400586605072
The modified gen p mean: 0.4487152397632599, gen p mean: -0.7617020010948181, mean p set: 0.44919553399086
loss_pred:0.025340789929032326, decouple_loss:0.007693510968238115
loss_pred:0.025878306478261948, decouple_loss:0.007662638556212187
loss_pred:0.025982635095715523, decouple_loss:0.008086683228611946
Iteration: 2578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448161780834198, gen p mean: -0.766891598701477, mean p set: 0.4486420452594757
The modified gen p mean: 0.4479454457759857, gen p mean: -0.7641575932502747, mean p set: 0.4484257698059082
The modified gen p mean: 0.4485883116722107, gen p mean: -0.7699502110481262, mean p set: 0.4490686058998108
loss_pred:0.02600090205669403, decouple_loss:0.007525324355810881
loss_pred:0.025140903890132904, decouple_loss:0.007455227896571159
loss_pred:0.026043035089969635, decouple_loss:0.007772109936922789
Iteration: 2579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501950442790985, gen p mean: -0.7645301818847656, mean p set: 0.4506753385066986
The modified gen p mean: 0.44784513115882874, gen p mean: -0.7645408511161804, mean p set: 0.44832542538642883
The modified gen p mean: 0.44971179962158203, gen p mean: -0.7593658566474915, mean p set: 0.45019209384918213
loss_pred:0.02539471723139286, decouple_loss:0.007766077294945717
loss_pred:0.025279827415943146, decouple_loss:0.007912173867225647
loss_pred:0.02582668513059616, decouple_loss:0.007635725196450949
Iteration: 2580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447609543800354, gen p mean: -0.7612977027893066, mean p set: 0.4480898678302765
The modified gen p mean: 0.4481826424598694, gen p mean: -0.7709797620773315, mean p set: 0.44866296648979187
The modified gen p mean: 0.4491707384586334, gen p mean: -0.7662928104400635, mean p set: 0.4496510326862335
loss_pred:0.025490734726190567, decouple_loss:0.007735203020274639
loss_pred:0.025952797383069992, decouple_loss:0.008262515999376774
loss_pred:0.025387367233633995, decouple_loss:0.007963540032505989
2023-05-03 07:31:16 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7792145609855652, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.77173912525177, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7676264047622681, mean p set: 0.45035696029663086
loss_pred:0.026235248893499374, decouple_loss:0.007923105731606483
loss_pred:0.025227351114153862, decouple_loss:0.007781319320201874
loss_pred:0.025023266673088074, decouple_loss:0.007658021524548531
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025884663686156273, avg_mse: 0.031252965331077576
current test mse: 0.031253
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
NaN value num: 0
Iteration: 2581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44642043113708496, gen p mean: -0.7695472836494446, mean p set: 0.44690072536468506
The modified gen p mean: 0.4464641809463501, gen p mean: -0.7781552672386169, mean p set: 0.4469445049762726
loss_pred:0.02633216232061386, decouple_loss:0.007652421947568655
loss_pred:0.026053402572870255, decouple_loss:0.008151456713676453
The modified gen p mean: 0.44760680198669434, gen p mean: -0.769321084022522, mean p set: 0.4480871260166168
loss_pred:0.02614259161055088, decouple_loss:0.007815368473529816
Iteration: 2582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461911916732788, gen p mean: -0.7700333595275879, mean p set: 0.4466714859008789
The modified gen p mean: 0.447870135307312, gen p mean: -0.7735331654548645, mean p set: 0.4483503997325897
The modified gen p mean: 0.44695407152175903, gen p mean: -0.7650753259658813, mean p set: 0.44743436574935913
loss_pred:0.02617603912949562, decouple_loss:0.007432382088154554
loss_pred:0.025703394785523415, decouple_loss:0.008211834356188774
loss_pred:0.02533164992928505, decouple_loss:0.008169683627784252
Iteration: 2583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471263587474823, gen p mean: -0.7613039612770081, mean p set: 0.4476066827774048
The modified gen p mean: 0.4478020966053009, gen p mean: -0.7629413604736328, mean p set: 0.4482823610305786
The modified gen p mean: 0.44673311710357666, gen p mean: -0.7675824165344238, mean p set: 0.44721341133117676
loss_pred:0.025676937773823738, decouple_loss:0.008143223822116852
loss_pred:0.02608233131468296, decouple_loss:0.007911371998488903
loss_pred:0.026175500825047493, decouple_loss:0.007555654272437096
Iteration: 2584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464631974697113, gen p mean: -0.7669642567634583, mean p set: 0.4469434916973114
The modified gen p mean: 0.4477238655090332, gen p mean: -0.7680671811103821, mean p set: 0.4482041299343109
The modified gen p mean: 0.4464389681816101, gen p mean: -0.7640900015830994, mean p set: 0.4469192922115326
loss_pred:0.0267005767673254, decouple_loss:0.008118832483887672
loss_pred:0.0254705548286438, decouple_loss:0.007917415350675583
loss_pred:0.02752985619008541, decouple_loss:0.008256964385509491
Iteration: 2585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459565579891205, gen p mean: -0.7699063420295715, mean p set: 0.4464368224143982
The modified gen p mean: 0.44770678877830505, gen p mean: -0.7631336450576782, mean p set: 0.44818708300590515
The modified gen p mean: 0.4473395347595215, gen p mean: -0.7706341743469238, mean p set: 0.4478198289871216
loss_pred:0.026276201009750366, decouple_loss:0.008129719644784927
loss_pred:0.026198605075478554, decouple_loss:0.007688525598496199
loss_pred:0.02517165243625641, decouple_loss:0.007488110102713108
Iteration: 2586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462970495223999, gen p mean: -0.7731367349624634, mean p set: 0.44677734375
The modified gen p mean: 0.44800689816474915, gen p mean: -0.7704672813415527, mean p set: 0.44848719239234924
The modified gen p mean: 0.44780197739601135, gen p mean: -0.7769603133201599, mean p set: 0.44828227162361145
loss_pred:0.02587682567536831, decouple_loss:0.008023668080568314
loss_pred:0.025957804173231125, decouple_loss:0.007848246954381466
loss_pred:0.027255751192569733, decouple_loss:0.008160565048456192
Iteration: 2587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484342038631439, gen p mean: -0.7747675180435181, mean p set: 0.448914498090744
The modified gen p mean: 0.4472595155239105, gen p mean: -0.7805038094520569, mean p set: 0.4477398097515106
The modified gen p mean: 0.4469386339187622, gen p mean: -0.774527370929718, mean p set: 0.4474189281463623
loss_pred:0.02616865374147892, decouple_loss:0.007890034466981888
loss_pred:0.026842135936021805, decouple_loss:0.007493407931178808
loss_pred:0.026148445904254913, decouple_loss:0.00752117158845067
Iteration: 2588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460814893245697, gen p mean: -0.7779480814933777, mean p set: 0.4465617835521698
The modified gen p mean: 0.44679510593414307, gen p mean: -0.7793334722518921, mean p set: 0.44727540016174316
The modified gen p mean: 0.4469863176345825, gen p mean: -0.7867432832717896, mean p set: 0.44746658205986023
loss_pred:0.025798119604587555, decouple_loss:0.007466101087629795
loss_pred:0.025700699537992477, decouple_loss:0.007746640592813492
loss_pred:0.026576608419418335, decouple_loss:0.008349225856363773
Iteration: 2589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471038281917572, gen p mean: -0.7818029522895813, mean p set: 0.4475840926170349
The modified gen p mean: 0.4461131691932678, gen p mean: -0.7721940279006958, mean p set: 0.4465934634208679
The modified gen p mean: 0.4480953514575958, gen p mean: -0.7763454914093018, mean p set: 0.44857561588287354
loss_pred:0.025256125256419182, decouple_loss:0.007518982049077749
loss_pred:0.025512346997857094, decouple_loss:0.007544794585555792
loss_pred:0.02583939954638481, decouple_loss:0.007761615328490734
Iteration: 2590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456440508365631, gen p mean: -0.7705657482147217, mean p set: 0.4461243748664856
The modified gen p mean: 0.4479556977748871, gen p mean: -0.7713971138000488, mean p set: 0.4484359920024872
The modified gen p mean: 0.446698933839798, gen p mean: -0.7716138958930969, mean p set: 0.44717922806739807
loss_pred:0.025883708149194717, decouple_loss:0.00759388692677021
loss_pred:0.025485534220933914, decouple_loss:0.007932143285870552
loss_pred:0.026645665988326073, decouple_loss:0.007581243757158518
2023-05-03 07:35:35 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7734262943267822, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7805286049842834, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7696428298950195, mean p set: 0.45035696029663086
loss_pred:0.02531256712973118, decouple_loss:0.00802383292466402
loss_pred:0.026340177282691002, decouple_loss:0.008122476749122143
loss_pred:0.025033477693796158, decouple_loss:0.00797279179096222
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025964058935642242, avg_mse: 0.031385574489831924
current test mse: 0.031386
Iteration: 2591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470159113407135, gen p mean: -0.7773448824882507, mean p set: 0.4474962055683136
loss_pred:0.026489758864045143, decouple_loss:0.007743387017399073
The modified gen p mean: 0.4454883337020874, gen p mean: -0.7736499905586243, mean p set: 0.4459685981273651
loss_pred:0.0257133599370718, decouple_loss:0.007722928654402494
The modified gen p mean: 0.4465689957141876, gen p mean: -0.7746602296829224, mean p set: 0.44704926013946533
loss_pred:0.02670891210436821, decouple_loss:0.007460123859345913
Iteration: 2592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781437516212463, gen p mean: -0.7815346121788025, mean p set: 0.44829463958740234
The modified gen p mean: 0.4456179440021515, gen p mean: -0.7714682221412659, mean p set: 0.446098268032074
The modified gen p mean: 0.44728416204452515, gen p mean: -0.7744603157043457, mean p set: 0.44776445627212524
loss_pred:0.026766473427414894, decouple_loss:0.008153715170919895
loss_pred:0.025863680988550186, decouple_loss:0.007589814253151417
loss_pred:0.027036497369408607, decouple_loss:0.007535550277680159
Iteration: 2593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44664090871810913, gen p mean: -0.7745648622512817, mean p set: 0.44712120294570923
The modified gen p mean: 0.44826653599739075, gen p mean: -0.7760912179946899, mean p set: 0.44874683022499084
The modified gen p mean: 0.4463731050491333, gen p mean: -0.7776811122894287, mean p set: 0.446853369474411
loss_pred:0.026995757594704628, decouple_loss:0.007599939592182636
loss_pred:0.025928933173418045, decouple_loss:0.007664556615054607
loss_pred:0.026562217622995377, decouple_loss:0.008223159238696098
Iteration: 2594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479420483112335, gen p mean: -0.7712401151657104, mean p set: 0.44842231273651123
The modified gen p mean: 0.4469752311706543, gen p mean: -0.7667096257209778, mean p set: 0.4474555552005768
The modified gen p mean: 0.4464874863624573, gen p mean: -0.7747744917869568, mean p set: 0.4469677805900574
loss_pred:0.027037546038627625, decouple_loss:0.007766682654619217
loss_pred:0.026759298518300056, decouple_loss:0.0074946098029613495
loss_pred:0.02646193839609623, decouple_loss:0.008175321854650974
Iteration: 2595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801345467567444, gen p mean: -0.7763046026229858, mean p set: 0.44849371910095215
The modified gen p mean: 0.44674113392829895, gen p mean: -0.7664329409599304, mean p set: 0.44722142815589905
The modified gen p mean: 0.44687533378601074, gen p mean: -0.7685743570327759, mean p set: 0.44735562801361084
loss_pred:0.0260330718010664, decouple_loss:0.007418322842568159
loss_pred:0.026990646496415138, decouple_loss:0.007818862795829773
loss_pred:0.025303950533270836, decouple_loss:0.007625432685017586
Iteration: 2596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477015733718872, gen p mean: -0.7642279267311096, mean p set: 0.4481818377971649
The modified gen p mean: 0.4473837912082672, gen p mean: -0.7694321870803833, mean p set: 0.4478640854358673
The modified gen p mean: 0.4470379650592804, gen p mean: -0.7725403904914856, mean p set: 0.4475182592868805
loss_pred:0.026199273765087128, decouple_loss:0.007551143877208233
loss_pred:0.02647489123046398, decouple_loss:0.007324714679270983
loss_pred:0.026724353432655334, decouple_loss:0.007799122948199511
Iteration: 2597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473097324371338, gen p mean: -0.7592660188674927, mean p set: 0.4477900266647339
The modified gen p mean: 0.44699329137802124, gen p mean: -0.7589545845985413, mean p set: 0.44747358560562134
The modified gen p mean: 0.4478501081466675, gen p mean: -0.7659916877746582, mean p set: 0.4483303725719452
loss_pred:0.025931525975465775, decouple_loss:0.007839716970920563
loss_pred:0.025883089751005173, decouple_loss:0.007742042187601328
loss_pred:0.026133697479963303, decouple_loss:0.007364211138337851
Iteration: 2598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476120173931122, gen p mean: -0.7588809132575989, mean p set: 0.4480923116207123
The modified gen p mean: 0.44791150093078613, gen p mean: -0.7607827186584473, mean p set: 0.44839179515838623
The modified gen p mean: 0.44741547107696533, gen p mean: -0.7622817754745483, mean p set: 0.44789573550224304
loss_pred:0.02578797936439514, decouple_loss:0.007838059216737747
loss_pred:0.025703441351652145, decouple_loss:0.007771709002554417
loss_pred:0.02632879465818405, decouple_loss:0.007442524656653404
Iteration: 2599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486715495586395, gen p mean: -0.7629644274711609, mean p set: 0.44915181398391724
The modified gen p mean: 0.44726109504699707, gen p mean: -0.7627460360527039, mean p set: 0.44774138927459717
The modified gen p mean: 0.4468676745891571, gen p mean: -0.7641158103942871, mean p set: 0.4473479390144348
loss_pred:0.026331834495067596, decouple_loss:0.007773172575980425
loss_pred:0.026514932513237, decouple_loss:0.007842625491321087
loss_pred:0.026195481419563293, decouple_loss:0.008027561940252781
Iteration: 2600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737508893013, gen p mean: -0.7688114047050476, mean p set: 0.4478553533554077
The modified gen p mean: 0.4460989236831665, gen p mean: -0.7631322741508484, mean p set: 0.4465792179107666
The modified gen p mean: 0.44815316796302795, gen p mean: -0.7648246884346008, mean p set: 0.44863349199295044
loss_pred:0.02669336646795273, decouple_loss:0.0078043257817626
loss_pred:0.02593509666621685, decouple_loss:0.007630671840161085
loss_pred:0.025820795446634293, decouple_loss:0.007703079376369715
2023-05-03 07:39:19 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7756324410438538, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7689306139945984, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7654529809951782, mean p set: 0.45035696029663086
loss_pred:0.026350244879722595, decouple_loss:0.008272374048829079
loss_pred:0.025370918214321136, decouple_loss:0.008019384928047657
loss_pred:0.025224760174751282, decouple_loss:0.007883293554186821
WV_0_PC_1_EH_0_PS_40_6, loss: 0.026051558554172516, avg_mse: 0.03155950829386711
current test mse: 0.03156
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 2601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483543634414673, gen p mean: -0.7622219324111938, mean p set: 0.4488346576690674
The modified gen p mean: 0.4476199448108673, gen p mean: -0.7734025716781616, mean p set: 0.4481002688407898
loss_pred:0.02572323940694332, decouple_loss:0.008390316739678383
loss_pred:0.02551906928420067, decouple_loss:0.008116515353322029
The modified gen p mean: 0.4468684494495392, gen p mean: -0.7715808749198914, mean p set: 0.4473487436771393
loss_pred:0.025598905980587006, decouple_loss:0.008259665220975876
Iteration: 2602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466054439544678, gen p mean: -0.7652336955070496, mean p set: 0.4470857083797455
The modified gen p mean: 0.4489873945713043, gen p mean: -0.7508590221405029, mean p set: 0.4494676887989044
The modified gen p mean: 0.44690239429473877, gen p mean: -0.761711835861206, mean p set: 0.44738268852233887
loss_pred:0.026253554970026016, decouple_loss:0.007933120243251324
loss_pred:0.02526748925447464, decouple_loss:0.00831338670104742
loss_pred:0.025778917595744133, decouple_loss:0.007956704124808311
Iteration: 2603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471588730812073, gen p mean: -0.7579216361045837, mean p set: 0.4476391673088074
The modified gen p mean: 0.4479162395000458, gen p mean: -0.7637062668800354, mean p set: 0.4483965039253235
The modified gen p mean: 0.44762831926345825, gen p mean: -0.7619741559028625, mean p set: 0.44810861349105835
loss_pred:0.025141296908259392, decouple_loss:0.007988537661731243
loss_pred:0.02523481845855713, decouple_loss:0.008146757259964943
loss_pred:0.024945061653852463, decouple_loss:0.00769506860524416
Iteration: 2604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485139846801758, gen p mean: -0.7638394832611084, mean p set: 0.4489942789077759
The modified gen p mean: 0.44811391830444336, gen p mean: -0.7669636011123657, mean p set: 0.44859424233436584
The modified gen p mean: 0.44828876852989197, gen p mean: -0.7633588314056396, mean p set: 0.44876906275749207
loss_pred:0.025169875472784042, decouple_loss:0.00818262156099081
loss_pred:0.026278233155608177, decouple_loss:0.0078081609681248665
loss_pred:0.024215662851929665, decouple_loss:0.008022497408092022
Iteration: 2605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44857513904571533, gen p mean: -0.7765860557556152, mean p set: 0.44905540347099304
The modified gen p mean: 0.44802576303482056, gen p mean: -0.7638824582099915, mean p set: 0.44850608706474304
The modified gen p mean: 0.4473857581615448, gen p mean: -0.7673383951187134, mean p set: 0.4478660821914673
loss_pred:0.02538381516933441, decouple_loss:0.008225866593420506
loss_pred:0.02418585866689682, decouple_loss:0.007582532241940498
loss_pred:0.025146199390292168, decouple_loss:0.007840587757527828
Iteration: 2606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44645360112190247, gen p mean: -0.7644486427307129, mean p set: 0.44693389534950256
The modified gen p mean: 0.4484352171421051, gen p mean: -0.7558852434158325, mean p set: 0.4489155113697052
The modified gen p mean: 0.44781965017318726, gen p mean: -0.7634567618370056, mean p set: 0.44829997420310974
loss_pred:0.025222545489668846, decouple_loss:0.00775991752743721
loss_pred:0.025217240676283836, decouple_loss:0.00789308175444603
loss_pred:0.025489674881100655, decouple_loss:0.007901374250650406
Iteration: 2607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44617441296577454, gen p mean: -0.7669498324394226, mean p set: 0.44665467739105225
The modified gen p mean: 0.44798722863197327, gen p mean: -0.7604328393936157, mean p set: 0.44846752285957336
The modified gen p mean: 0.4476766884326935, gen p mean: -0.7639317512512207, mean p set: 0.44815701246261597
loss_pred:0.025749552994966507, decouple_loss:0.0075535899959504604
loss_pred:0.024516403675079346, decouple_loss:0.007761151995509863
loss_pred:0.025704210624098778, decouple_loss:0.007717953994870186
Iteration: 2608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44826123118400574, gen p mean: -0.7589472532272339, mean p set: 0.44874149560928345
The modified gen p mean: 0.4477499723434448, gen p mean: -0.7560939192771912, mean p set: 0.4482302665710449
The modified gen p mean: 0.4469151496887207, gen p mean: -0.7637031078338623, mean p set: 0.4473954439163208
loss_pred:0.02425481006503105, decouple_loss:0.00786606129258871
loss_pred:0.024556651711463928, decouple_loss:0.007810845039784908
loss_pred:0.02592618018388748, decouple_loss:0.007733152247965336
Iteration: 2609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44643887877464294, gen p mean: -0.7718304991722107, mean p set: 0.44691917300224304
The modified gen p mean: 0.44713106751441956, gen p mean: -0.7719283103942871, mean p set: 0.44761136174201965
The modified gen p mean: 0.4473644196987152, gen p mean: -0.7669591307640076, mean p set: 0.4478446841239929
loss_pred:0.025531504303216934, decouple_loss:0.007823525927960873
loss_pred:0.024751121178269386, decouple_loss:0.0076935323886573315
loss_pred:0.025731109082698822, decouple_loss:0.0076262205839157104
Iteration: 2610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44668376445770264, gen p mean: -0.7696226239204407, mean p set: 0.44716405868530273
The modified gen p mean: 0.44793081283569336, gen p mean: -0.7678881287574768, mean p set: 0.44841110706329346
The modified gen p mean: 0.449179083108902, gen p mean: -0.7621799111366272, mean p set: 0.4496593773365021
loss_pred:0.02451452426612377, decouple_loss:0.0072997272945940495
loss_pred:0.025894004851579666, decouple_loss:0.007558700628578663
loss_pred:0.024554328992962837, decouple_loss:0.007400095462799072
2023-05-03 07:43:43 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7670996189117432, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7745516896247864, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7631679773330688, mean p set: 0.45035696029663086
loss_pred:0.02514532580971718, decouple_loss:0.0078003318049013615
loss_pred:0.026127874851226807, decouple_loss:0.00809360109269619
loss_pred:0.02494281530380249, decouple_loss:0.007695497013628483
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02579849772155285, avg_mse: 0.031160060316324234
current test mse: 0.03116
Iteration: 2611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482094943523407, gen p mean: -0.7656360864639282, mean p set: 0.4486897885799408
loss_pred:0.025057969614863396, decouple_loss:0.007493787445127964
The modified gen p mean: 0.44765836000442505, gen p mean: -0.7668556571006775, mean p set: 0.44813862442970276
loss_pred:0.02605842985212803, decouple_loss:0.0075802868232131
The modified gen p mean: 0.4483950734138489, gen p mean: -0.7574914693832397, mean p set: 0.448875367641449
loss_pred:0.025065584108233452, decouple_loss:0.007817053236067295
Iteration: 2612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475749433040619, gen p mean: -0.7642291188240051, mean p set: 0.4480552673339844
The modified gen p mean: 0.44847428798675537, gen p mean: -0.75844407081604, mean p set: 0.44895458221435547
The modified gen p mean: 0.44692468643188477, gen p mean: -0.7665913105010986, mean p set: 0.44740498065948486
loss_pred:0.024953335523605347, decouple_loss:0.007180221378803253
loss_pred:0.024770786985754967, decouple_loss:0.007621977012604475
loss_pred:0.024982592090964317, decouple_loss:0.007452149409800768
Iteration: 2613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977760314941406, gen p mean: -0.7587680220603943, mean p set: 0.45025789737701416
The modified gen p mean: 0.449349045753479, gen p mean: -0.7622971534729004, mean p set: 0.4498293101787567
The modified gen p mean: 0.4494810402393341, gen p mean: -0.7575908303260803, mean p set: 0.4499613046646118
loss_pred:0.024725137278437614, decouple_loss:0.0075777252204716206
loss_pred:0.025082143023610115, decouple_loss:0.007520867977291346
loss_pred:0.024982543662190437, decouple_loss:0.007762661669403315
Iteration: 2614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472023844718933, gen p mean: -0.761614203453064, mean p set: 0.4476827085018158
The modified gen p mean: 0.44743579626083374, gen p mean: -0.7632074356079102, mean p set: 0.44791606068611145
The modified gen p mean: 0.4472668766975403, gen p mean: -0.7620383501052856, mean p set: 0.447747141122818
loss_pred:0.02523009292781353, decouple_loss:0.0075281341560184956
loss_pred:0.02532735839486122, decouple_loss:0.007271145936101675
loss_pred:0.024628598242998123, decouple_loss:0.007332580164074898
Iteration: 2615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477563798427582, gen p mean: -0.754260778427124, mean p set: 0.4482366442680359
The modified gen p mean: 0.44751372933387756, gen p mean: -0.7600191831588745, mean p set: 0.4479939937591553
The modified gen p mean: 0.44778189063072205, gen p mean: -0.7501091361045837, mean p set: 0.44826218485832214
loss_pred:0.02443545311689377, decouple_loss:0.007407777477055788
loss_pred:0.02487638220191002, decouple_loss:0.007119196932762861
loss_pred:0.024990878999233246, decouple_loss:0.007511260453611612
Iteration: 2616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44687357544898987, gen p mean: -0.7594153881072998, mean p set: 0.44735386967658997
The modified gen p mean: 0.4467870593070984, gen p mean: -0.7645551562309265, mean p set: 0.4472673535346985
The modified gen p mean: 0.4486221969127655, gen p mean: -0.7554756999015808, mean p set: 0.4491024613380432
loss_pred:0.02570129930973053, decouple_loss:0.0076734693720936775
loss_pred:0.02529401145875454, decouple_loss:0.007283276412636042
loss_pred:0.024406710639595985, decouple_loss:0.007254669442772865
Iteration: 2617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469769597053528, gen p mean: -0.7515347003936768, mean p set: 0.4474572539329529
The modified gen p mean: 0.4479721784591675, gen p mean: -0.7543444037437439, mean p set: 0.4484524726867676
loss_pred:0.02467639185488224, decouple_loss:0.007660688832402229
The modified gen p mean: 0.44797995686531067, gen p mean: -0.7458574771881104, mean p set: 0.44846025109291077
loss_pred:0.025241849943995476, decouple_loss:0.007396718021482229
loss_pred:0.024327203631401062, decouple_loss:0.007618906442075968
Iteration: 2618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479478597640991, gen p mean: -0.7554048895835876, mean p set: 0.4484281837940216
The modified gen p mean: 0.4479027986526489, gen p mean: -0.755220353603363, mean p set: 0.4483831226825714
The modified gen p mean: 0.4481048285961151, gen p mean: -0.7506221532821655, mean p set: 0.4485850930213928
loss_pred:0.026049258187413216, decouple_loss:0.007363584823906422
loss_pred:0.024688834324479103, decouple_loss:0.00723464647307992
loss_pred:0.02393442578613758, decouple_loss:0.007362327538430691
Iteration: 2619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900399446487427, gen p mean: -0.7577369213104248, mean p set: 0.449484258890152
The modified gen p mean: 0.448159396648407, gen p mean: -0.7583872675895691, mean p set: 0.4486396908760071
The modified gen p mean: 0.4483236074447632, gen p mean: -0.7570403814315796, mean p set: 0.4488039016723633
loss_pred:0.02486354298889637, decouple_loss:0.00727854436263442
loss_pred:0.025429707020521164, decouple_loss:0.00737494183704257
loss_pred:0.023603148758411407, decouple_loss:0.00705275172367692
Iteration: 2620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779494404792786, gen p mean: -0.7638561129570007, mean p set: 0.44827526807785034
The modified gen p mean: 0.4480445384979248, gen p mean: -0.7564473152160645, mean p set: 0.4485248327255249
The modified gen p mean: 0.4472697675228119, gen p mean: -0.763660728931427, mean p set: 0.4477500915527344
loss_pred:0.02548116259276867, decouple_loss:0.007225953508168459
loss_pred:0.024473225697875023, decouple_loss:0.0071794441901147366
loss_pred:0.025456322357058525, decouple_loss:0.007331485860049725
2023-05-03 07:47:25 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7765182852745056, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7836418747901917, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7723006010055542, mean p set: 0.45035696029663086
loss_pred:0.025082405656576157, decouple_loss:0.0076088630594313145
loss_pred:0.026036713272333145, decouple_loss:0.007772310171276331
loss_pred:0.024865983054041862, decouple_loss:0.007414942607283592
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025708302855491638, avg_mse: 0.03104856237769127
current test mse: 0.031049
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 2621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44947436451911926, gen p mean: -0.7809338569641113, mean p set: 0.44995465874671936
The modified gen p mean: 0.4501873850822449, gen p mean: -0.7784318923950195, mean p set: 0.45066767930984497
loss_pred:0.025212783366441727, decouple_loss:0.007907649502158165
loss_pred:0.02634134143590927, decouple_loss:0.007670924998819828
The modified gen p mean: 0.4480578601360321, gen p mean: -0.7665337920188904, mean p set: 0.4485381245613098
loss_pred:0.02635716274380684, decouple_loss:0.007908794097602367
Iteration: 2622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822654128074646, gen p mean: -0.7718682289123535, mean p set: 0.44870686531066895
The modified gen p mean: 0.4496931731700897, gen p mean: -0.7757809162139893, mean p set: 0.4501734673976898
The modified gen p mean: 0.44858768582344055, gen p mean: -0.7685990333557129, mean p set: 0.44906798005104065
loss_pred:0.026733698323369026, decouple_loss:0.00743990670889616
loss_pred:0.025759203359484673, decouple_loss:0.007369029335677624
loss_pred:0.025656500831246376, decouple_loss:0.007412244100123644
Iteration: 2623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501243233680725, gen p mean: -0.7647367119789124, mean p set: 0.4506046175956726
The modified gen p mean: 0.44836920499801636, gen p mean: -0.7661873698234558, mean p set: 0.44884949922561646
The modified gen p mean: 0.44911807775497437, gen p mean: -0.7675135135650635, mean p set: 0.44959837198257446
loss_pred:0.0258928332477808, decouple_loss:0.0075220465660095215
loss_pred:0.026520319283008575, decouple_loss:0.00723944790661335
loss_pred:0.026382874697446823, decouple_loss:0.0074784946627914906
Iteration: 2624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480297267436981, gen p mean: -0.7644312977790833, mean p set: 0.44850999116897583
The modified gen p mean: 0.4491842985153198, gen p mean: -0.7717667818069458, mean p set: 0.4496645927429199
The modified gen p mean: 0.4489181935787201, gen p mean: -0.765583336353302, mean p set: 0.4493984878063202
loss_pred:0.026014309376478195, decouple_loss:0.0077195665799081326
loss_pred:0.025723809376358986, decouple_loss:0.007063352037221193
loss_pred:0.025850849226117134, decouple_loss:0.007191034033894539
Iteration: 2625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45080986618995667, gen p mean: -0.7637558579444885, mean p set: 0.45129016041755676
The modified gen p mean: 0.4503858983516693, gen p mean: -0.7755827307701111, mean p set: 0.4508661925792694
The modified gen p mean: 0.45082464814186096, gen p mean: -0.7759013772010803, mean p set: 0.45130491256713867
loss_pred:0.025746233761310577, decouple_loss:0.007143169175833464
loss_pred:0.0253964364528656, decouple_loss:0.007719368673861027
loss_pred:0.02551703155040741, decouple_loss:0.0077001540921628475
Iteration: 2626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450296014547348, gen p mean: -0.7764861583709717, mean p set: 0.4507763385772705
The modified gen p mean: 0.4506630599498749, gen p mean: -0.7668235898017883, mean p set: 0.451143354177475
The modified gen p mean: 0.4490286111831665, gen p mean: -0.7687807083129883, mean p set: 0.4495089054107666
loss_pred:0.025154465809464455, decouple_loss:0.007713489234447479
loss_pred:0.025902114808559418, decouple_loss:0.007238524965941906
loss_pred:0.02564416639506817, decouple_loss:0.007688949815928936
Iteration: 2627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969239830970764, gen p mean: -0.7724169492721558, mean p set: 0.45017269253730774
The modified gen p mean: 0.4500035047531128, gen p mean: -0.7726535201072693, mean p set: 0.4504837691783905
The modified gen p mean: 0.44948598742485046, gen p mean: -0.7725754380226135, mean p set: 0.44996631145477295
loss_pred:0.02513287402689457, decouple_loss:0.007613809313625097
loss_pred:0.025727160274982452, decouple_loss:0.007599987555295229
loss_pred:0.02506588213145733, decouple_loss:0.007407134864479303
Iteration: 2628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501386880874634, gen p mean: -0.7738969326019287, mean p set: 0.4506189823150635
The modified gen p mean: 0.449203222990036, gen p mean: -0.7628554105758667, mean p set: 0.4496835172176361
The modified gen p mean: 0.4502295255661011, gen p mean: -0.7743640542030334, mean p set: 0.45070981979370117
loss_pred:0.025257937610149384, decouple_loss:0.007457300089299679
loss_pred:0.025122420862317085, decouple_loss:0.0073643457144498825
loss_pred:0.02530742436647415, decouple_loss:0.007465114817023277
Iteration: 2629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488588571548462, gen p mean: -0.7680848240852356, mean p set: 0.4493391215801239
The modified gen p mean: 0.4485132098197937, gen p mean: -0.7623757719993591, mean p set: 0.448993444442749
The modified gen p mean: 0.44846558570861816, gen p mean: -0.765365719795227, mean p set: 0.4489458501338959
loss_pred:0.02541957050561905, decouple_loss:0.007212196476757526
loss_pred:0.02581128478050232, decouple_loss:0.007440340239554644
loss_pred:0.025293203070759773, decouple_loss:0.007732132449746132
Iteration: 2630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44943392276763916, gen p mean: -0.7653301954269409, mean p set: 0.44991418719291687
The modified gen p mean: 0.44926688075065613, gen p mean: -0.7700659036636353, mean p set: 0.4497471749782562
The modified gen p mean: 0.4496731460094452, gen p mean: -0.7657248973846436, mean p set: 0.4501534700393677
loss_pred:0.025491829961538315, decouple_loss:0.007361470256000757
loss_pred:0.024085095152258873, decouple_loss:0.007641684729605913
loss_pred:0.02546803280711174, decouple_loss:0.007468127179890871
2023-05-03 07:51:48 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7695698738098145, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.776802122592926, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7655711770057678, mean p set: 0.45035696029663086
loss_pred:0.025030801072716713, decouple_loss:0.007651577237993479
loss_pred:0.026085639372467995, decouple_loss:0.00787526834756136
loss_pred:0.024726351723074913, decouple_loss:0.007441241294145584
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02566373161971569, avg_mse: 0.031008081510663033
current test mse: 0.031008
Iteration: 2631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490380585193634, gen p mean: -0.7657138705253601, mean p set: 0.4495182931423187
The modified gen p mean: 0.44837287068367004, gen p mean: -0.7645049095153809, mean p set: 0.44885316491127014
loss_pred:0.02557268738746643, decouple_loss:0.0073616900481283665
loss_pred:0.026102177798748016, decouple_loss:0.007088945712894201
The modified gen p mean: 0.44874081015586853, gen p mean: -0.7667611837387085, mean p set: 0.449221134185791
loss_pred:0.025357812643051147, decouple_loss:0.007307938300073147
Iteration: 2632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45090633630752563, gen p mean: -0.764318585395813, mean p set: 0.45138660073280334
The modified gen p mean: 0.4498368203639984, gen p mean: -0.7589531540870667, mean p set: 0.4503171145915985
The modified gen p mean: 0.44893956184387207, gen p mean: -0.7630773782730103, mean p set: 0.4494198262691498
loss_pred:0.025283467024564743, decouple_loss:0.007272590883076191
loss_pred:0.025230607017874718, decouple_loss:0.0073215775191783905
loss_pred:0.02577473782002926, decouple_loss:0.007740932982414961
Iteration: 2633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44901034235954285, gen p mean: -0.7730177044868469, mean p set: 0.44949063658714294
The modified gen p mean: 0.44765859842300415, gen p mean: -0.7627052664756775, mean p set: 0.44813892245292664
The modified gen p mean: 0.4500710964202881, gen p mean: -0.7744612693786621, mean p set: 0.4505513906478882
loss_pred:0.02499145269393921, decouple_loss:0.0073429886251688
loss_pred:0.026427552103996277, decouple_loss:0.007575616706162691
loss_pred:0.025249896571040154, decouple_loss:0.007404354866594076
Iteration: 2634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44965627789497375, gen p mean: -0.771483302116394, mean p set: 0.45013657212257385
The modified gen p mean: 0.4492861032485962, gen p mean: -0.7726874947547913, mean p set: 0.4497663974761963
The modified gen p mean: 0.45058590173721313, gen p mean: -0.7754077911376953, mean p set: 0.45106619596481323
loss_pred:0.025324752554297447, decouple_loss:0.007012221030890942
loss_pred:0.02491164393723011, decouple_loss:0.0072127520106732845
loss_pred:0.024364257231354713, decouple_loss:0.007123027928173542
Iteration: 2635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44965097308158875, gen p mean: -0.7801509499549866, mean p set: 0.45013123750686646
The modified gen p mean: 0.4492708444595337, gen p mean: -0.7713753581047058, mean p set: 0.4497511684894562
The modified gen p mean: 0.4497798681259155, gen p mean: -0.7834275960922241, mean p set: 0.45026013255119324
loss_pred:0.02553374134004116, decouple_loss:0.007160960230976343
loss_pred:0.02591455914080143, decouple_loss:0.007693307474255562
loss_pred:0.025626756250858307, decouple_loss:0.0072633447125554085
Iteration: 2636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501102566719055, gen p mean: -0.7734034061431885, mean p set: 0.4505905210971832
The modified gen p mean: 0.44919705390930176, gen p mean: -0.7708094716072083, mean p set: 0.44967731833457947
The modified gen p mean: 0.449287086725235, gen p mean: -0.7716199159622192, mean p set: 0.4497673809528351
loss_pred:0.025567997246980667, decouple_loss:0.007161400746554136
loss_pred:0.025134047493338585, decouple_loss:0.007248115725815296
loss_pred:0.025460561737418175, decouple_loss:0.007452900521457195
Iteration: 2637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44863173365592957, gen p mean: -0.7633180022239685, mean p set: 0.4491119980812073
The modified gen p mean: 0.4497874081134796, gen p mean: -0.7691776752471924, mean p set: 0.4502677023410797
The modified gen p mean: 0.4492749571800232, gen p mean: -0.775488555431366, mean p set: 0.4497552812099457
loss_pred:0.0262165404856205, decouple_loss:0.0074838912114501
loss_pred:0.025768328458070755, decouple_loss:0.0071880207397043705
loss_pred:0.02530536614358425, decouple_loss:0.007332768756896257
Iteration: 2638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860759377479553, gen p mean: -0.767494797706604, mean p set: 0.44908788800239563
The modified gen p mean: 0.4488612115383148, gen p mean: -0.7718954682350159, mean p set: 0.44934147596359253
The modified gen p mean: 0.44919630885124207, gen p mean: -0.7736527919769287, mean p set: 0.4496765732765198
loss_pred:0.026213841512799263, decouple_loss:0.007152657024562359
loss_pred:0.026031916961073875, decouple_loss:0.007327346596866846
loss_pred:0.025397805497050285, decouple_loss:0.007587366737425327
Iteration: 2639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483937919139862, gen p mean: -0.7783030271530151, mean p set: 0.4488740861415863
The modified gen p mean: 0.44803234934806824, gen p mean: -0.7736668586730957, mean p set: 0.44851261377334595
The modified gen p mean: 0.4493621587753296, gen p mean: -0.772194504737854, mean p set: 0.4498424530029297
loss_pred:0.025585569441318512, decouple_loss:0.007322291843593121
loss_pred:0.02461700513958931, decouple_loss:0.007467577233910561
loss_pred:0.02606337144970894, decouple_loss:0.007323508150875568
Iteration: 2640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488268494606018, gen p mean: -0.773320198059082, mean p set: 0.4493071436882019
The modified gen p mean: 0.4492380917072296, gen p mean: -0.7770146727561951, mean p set: 0.4497183561325073
The modified gen p mean: 0.44797298312187195, gen p mean: -0.7712225914001465, mean p set: 0.44845327734947205
loss_pred:0.02574126049876213, decouple_loss:0.007215898483991623
loss_pred:0.02617482654750347, decouple_loss:0.007120393682271242
loss_pred:0.024825727567076683, decouple_loss:0.007190580479800701
2023-05-03 07:55:34 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7751285433769226, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7820955514907837, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7713194489479065, mean p set: 0.45035696029663086
loss_pred:0.02500317059457302, decouple_loss:0.007391558960080147
loss_pred:0.02607548236846924, decouple_loss:0.007697458378970623
loss_pred:0.02476896531879902, decouple_loss:0.007428417447954416
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025657830759882927, avg_mse: 0.03104361705482006
current test mse: 0.031044
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
NaN value num: 0
Iteration: 2641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481066167354584, gen p mean: -0.7708204984664917, mean p set: 0.44858694076538086
The modified gen p mean: 0.44984227418899536, gen p mean: -0.7741274237632751, mean p set: 0.45032259821891785
loss_pred:0.02786308526992798, decouple_loss:0.008218023926019669
loss_pred:0.0270649716258049, decouple_loss:0.00795760564506054
The modified gen p mean: 0.44933876395225525, gen p mean: -0.7660347819328308, mean p set: 0.44981908798217773
loss_pred:0.026579638943076134, decouple_loss:0.00797451101243496
Iteration: 2642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505566358566284, gen p mean: -0.7709415555000305, mean p set: 0.4510369300842285
The modified gen p mean: 0.44978150725364685, gen p mean: -0.7694225311279297, mean p set: 0.45026183128356934
The modified gen p mean: 0.44919729232788086, gen p mean: -0.7696810364723206, mean p set: 0.44967761635780334
loss_pred:0.027333388105034828, decouple_loss:0.008303039707243443
loss_pred:0.027052326127886772, decouple_loss:0.007703498471528292
loss_pred:0.026913488283753395, decouple_loss:0.007770363707095385
Iteration: 2643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492623209953308, gen p mean: -0.7709651589393616, mean p set: 0.4497425854206085
The modified gen p mean: 0.45207497477531433, gen p mean: -0.7724291682243347, mean p set: 0.45255526900291443
The modified gen p mean: 0.45060786604881287, gen p mean: -0.7758662104606628, mean p set: 0.45108816027641296
loss_pred:0.026188550516963005, decouple_loss:0.007751324214041233
loss_pred:0.027093464508652687, decouple_loss:0.007919631898403168
loss_pred:0.025510624051094055, decouple_loss:0.007528261747211218
Iteration: 2644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497734606266022, gen p mean: -0.7784963250160217, mean p set: 0.4502537250518799
The modified gen p mean: 0.4490238428115845, gen p mean: -0.7698560953140259, mean p set: 0.44950413703918457
The modified gen p mean: 0.44940537214279175, gen p mean: -0.7690147161483765, mean p set: 0.44988563656806946
loss_pred:0.026345398277044296, decouple_loss:0.007610713131725788
loss_pred:0.02759944088757038, decouple_loss:0.00827339943498373
loss_pred:0.026270832866430283, decouple_loss:0.0078776516020298
Iteration: 2645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489773213863373, gen p mean: -0.7721129655838013, mean p set: 0.449457585811615
The modified gen p mean: 0.448740154504776, gen p mean: -0.7798327207565308, mean p set: 0.4492204785346985
The modified gen p mean: 0.4502265155315399, gen p mean: -0.7737269997596741, mean p set: 0.45070680975914
loss_pred:0.027089355513453484, decouple_loss:0.007786223199218512
loss_pred:0.02675233781337738, decouple_loss:0.007840776816010475
loss_pred:0.026929406449198723, decouple_loss:0.007611053064465523
Iteration: 2646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502841830253601, gen p mean: -0.7779162526130676, mean p set: 0.4507644772529602
The modified gen p mean: 0.4502299427986145, gen p mean: -0.7744511961936951, mean p set: 0.4507102370262146
The modified gen p mean: 0.4502740204334259, gen p mean: -0.7738162875175476, mean p set: 0.450754314661026
loss_pred:0.027235405519604683, decouple_loss:0.00800024438649416
loss_pred:0.026732873171567917, decouple_loss:0.00757778761908412
loss_pred:0.027082400396466255, decouple_loss:0.007944758981466293
Iteration: 2647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498051404953003, gen p mean: -0.7945295572280884, mean p set: 0.450285404920578
The modified gen p mean: 0.449506014585495, gen p mean: -0.7798576951026917, mean p set: 0.4499862790107727
The modified gen p mean: 0.44992658495903015, gen p mean: -0.7743396162986755, mean p set: 0.45040687918663025
loss_pred:0.026289233937859535, decouple_loss:0.007981542497873306
loss_pred:0.026206940412521362, decouple_loss:0.007463231682777405
loss_pred:0.026444211602211, decouple_loss:0.0072914594784379005
Iteration: 2648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506334364414215, gen p mean: -0.7756243348121643, mean p set: 0.4511137008666992
The modified gen p mean: 0.44998836517333984, gen p mean: -0.7798372507095337, mean p set: 0.45046865940093994
The modified gen p mean: 0.44977572560310364, gen p mean: -0.7712759971618652, mean p set: 0.45025599002838135
loss_pred:0.02611628733575344, decouple_loss:0.0069649238139390945
loss_pred:0.026056187227368355, decouple_loss:0.0073453872464597225
loss_pred:0.026316622272133827, decouple_loss:0.007570726331323385
Iteration: 2649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490357041358948, gen p mean: -0.7871144413948059, mean p set: 0.4495159983634949
The modified gen p mean: 0.45045435428619385, gen p mean: -0.7853108644485474, mean p set: 0.45093461871147156
The modified gen p mean: 0.4495851397514343, gen p mean: -0.7925384044647217, mean p set: 0.4500654339790344
loss_pred:0.026971954852342606, decouple_loss:0.007596767973154783
loss_pred:0.026963386684656143, decouple_loss:0.007833198644220829
loss_pred:0.02621931955218315, decouple_loss:0.007812286727130413
Iteration: 2650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496327340602875, gen p mean: -0.7809951305389404, mean p set: 0.4501130282878876
The modified gen p mean: 0.44938403367996216, gen p mean: -0.7816123962402344, mean p set: 0.44986429810523987
The modified gen p mean: 0.44985246658325195, gen p mean: -0.7952567338943481, mean p set: 0.45033276081085205
loss_pred:0.02633517235517502, decouple_loss:0.007454569451510906
loss_pred:0.026053890585899353, decouple_loss:0.007595318369567394
loss_pred:0.026263194158673286, decouple_loss:0.007667131256312132
2023-05-03 08:00:12 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7801370620727539, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7873520255088806, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987669587135315, gen p mean: -0.7760436534881592, mean p set: 0.45035696029663086
loss_pred:0.025134867057204247, decouple_loss:0.008088725619018078
loss_pred:0.0261844415217638, decouple_loss:0.008357647806406021
loss_pred:0.024892771616578102, decouple_loss:0.008094854652881622
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02581304870545864, avg_mse: 0.031307853758335114
current test mse: 0.031308
Iteration: 2651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862550497055054, gen p mean: -0.779655933380127, mean p set: 0.44910579919815063
The modified gen p mean: 0.44942376017570496, gen p mean: -0.784206748008728, mean p set: 0.44990405440330505
loss_pred:0.027104604989290237, decouple_loss:0.007321623619645834
loss_pred:0.026203500106930733, decouple_loss:0.007515997625887394
The modified gen p mean: 0.450111985206604, gen p mean: -0.7777313590049744, mean p set: 0.4505922794342041
loss_pred:0.025897355750203133, decouple_loss:0.00735265389084816
Iteration: 2652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497458040714264, gen p mean: -0.7725530862808228, mean p set: 0.4502260982990265
The modified gen p mean: 0.44938376545906067, gen p mean: -0.7752948999404907, mean p set: 0.44986405968666077
The modified gen p mean: 0.4496156871318817, gen p mean: -0.7686333060264587, mean p set: 0.4500959813594818
loss_pred:0.026529906317591667, decouple_loss:0.0075181941501796246
loss_pred:0.026140248402953148, decouple_loss:0.0073964339680969715
loss_pred:0.02654881216585636, decouple_loss:0.0076241628266870975
Iteration: 2653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45044082403182983, gen p mean: -0.7810156345367432, mean p set: 0.45092108845710754
The modified gen p mean: 0.44877001643180847, gen p mean: -0.7843803763389587, mean p set: 0.4492502808570862
The modified gen p mean: 0.44959181547164917, gen p mean: -0.7735271453857422, mean p set: 0.45007210969924927
loss_pred:0.027327928692102432, decouple_loss:0.00796535611152649
loss_pred:0.026344018056988716, decouple_loss:0.007540753111243248
loss_pred:0.025324298068881035, decouple_loss:0.007588114123791456
Iteration: 2654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44944414496421814, gen p mean: -0.7849686741828918, mean p set: 0.44992440938949585
The modified gen p mean: 0.449023574590683, gen p mean: -0.786607027053833, mean p set: 0.4495038390159607
The modified gen p mean: 0.4503733515739441, gen p mean: -0.772975742816925, mean p set: 0.4508536458015442
loss_pred:0.025805264711380005, decouple_loss:0.007580872625112534
loss_pred:0.026105646044015884, decouple_loss:0.007656317204236984
loss_pred:0.02585236169397831, decouple_loss:0.00745820626616478
Iteration: 2655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489370882511139, gen p mean: -0.7786533236503601, mean p set: 0.4494173526763916
The modified gen p mean: 0.45172709226608276, gen p mean: -0.7671595215797424, mean p set: 0.45220738649368286
The modified gen p mean: 0.4501861035823822, gen p mean: -0.7665226459503174, mean p set: 0.4506663978099823
loss_pred:0.026505939662456512, decouple_loss:0.007485170383006334
loss_pred:0.02635851874947548, decouple_loss:0.007405267097055912
loss_pred:0.02631389908492565, decouple_loss:0.007420600391924381
Iteration: 2656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498112201690674, gen p mean: -0.7749745845794678, mean p set: 0.4502915143966675
The modified gen p mean: 0.44960206747055054, gen p mean: -0.7660059332847595, mean p set: 0.45008236169815063
The modified gen p mean: 0.45142218470573425, gen p mean: -0.7740851640701294, mean p set: 0.45190247893333435
loss_pred:0.026222560554742813, decouple_loss:0.007278179284185171
loss_pred:0.027035389095544815, decouple_loss:0.007570895366370678
loss_pred:0.02682924084365368, decouple_loss:0.007223106920719147
Iteration: 2657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489953815937042, gen p mean: -0.7817549109458923, mean p set: 0.4494756758213043
The modified gen p mean: 0.4486215114593506, gen p mean: -0.7745294570922852, mean p set: 0.4491018056869507
The modified gen p mean: 0.44956380128860474, gen p mean: -0.7693361639976501, mean p set: 0.4500441253185272
loss_pred:0.025880660861730576, decouple_loss:0.007695280015468597
loss_pred:0.026552049443125725, decouple_loss:0.007181717548519373
loss_pred:0.02645665407180786, decouple_loss:0.00743080535903573
Iteration: 2658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45003122091293335, gen p mean: -0.7611666321754456, mean p set: 0.45051151514053345
The modified gen p mean: 0.4495774507522583, gen p mean: -0.7686603665351868, mean p set: 0.4500577449798584
The modified gen p mean: 0.44864264130592346, gen p mean: -0.7571561932563782, mean p set: 0.44912293553352356
loss_pred:0.025947917252779007, decouple_loss:0.00721687963232398
loss_pred:0.025523535907268524, decouple_loss:0.0072839707136154175
loss_pred:0.02784322202205658, decouple_loss:0.007777839433401823
Iteration: 2659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44921568036079407, gen p mean: -0.7612854838371277, mean p set: 0.4496959447860718
The modified gen p mean: 0.4480375647544861, gen p mean: -0.7677043676376343, mean p set: 0.4485178589820862
The modified gen p mean: 0.450320839881897, gen p mean: -0.7634432911872864, mean p set: 0.4508011043071747
loss_pred:0.026835951954126358, decouple_loss:0.00733413128182292
loss_pred:0.02593766711652279, decouple_loss:0.00712981540709734
loss_pred:0.02628198266029358, decouple_loss:0.00721338763833046
Iteration: 2660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44968053698539734, gen p mean: -0.7768626809120178, mean p set: 0.45016080141067505
The modified gen p mean: 0.44964757561683655, gen p mean: -0.7788342833518982, mean p set: 0.45012786984443665
The modified gen p mean: 0.4492329955101013, gen p mean: -0.7799451947212219, mean p set: 0.4497132897377014
loss_pred:0.026132766157388687, decouple_loss:0.00705542741343379
loss_pred:0.025517499074339867, decouple_loss:0.007027130573987961
loss_pred:0.026018604636192322, decouple_loss:0.007631318643689156
2023-05-03 08:03:55 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.774795413017273, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7817044258117676, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7711496949195862, mean p set: 0.45035696029663086
loss_pred:0.025252819061279297, decouple_loss:0.007987281307578087
loss_pred:0.026250796392560005, decouple_loss:0.008097507059574127
loss_pred:0.024892466142773628, decouple_loss:0.007933435961604118
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025865664705634117, avg_mse: 0.03136568143963814
current test mse: 0.031366
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 2661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479655921459198, gen p mean: -0.769473135471344, mean p set: 0.4484458863735199
loss_pred:0.02578202448785305, decouple_loss:0.007841327227652073
The modified gen p mean: 0.4490712583065033, gen p mean: -0.7742665410041809, mean p set: 0.4495515525341034
loss_pred:0.02527698501944542, decouple_loss:0.0076791755855083466
The modified gen p mean: 0.4490082561969757, gen p mean: -0.7750197052955627, mean p set: 0.4494885504245758
loss_pred:0.027650263160467148, decouple_loss:0.007902096025645733
Iteration: 2662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490033984184265, gen p mean: -0.7673652768135071, mean p set: 0.4494836926460266
The modified gen p mean: 0.4493091106414795, gen p mean: -0.7744041085243225, mean p set: 0.4497894048690796
The modified gen p mean: 0.4488582909107208, gen p mean: -0.7678278684616089, mean p set: 0.44933852553367615
loss_pred:0.025073213502764702, decouple_loss:0.007884860970079899
loss_pred:0.025737835094332695, decouple_loss:0.007386874407529831
loss_pred:0.024947695434093475, decouple_loss:0.007657711859792471
Iteration: 2663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483445882797241, gen p mean: -0.7584054470062256, mean p set: 0.4488248825073242
The modified gen p mean: 0.44943419098854065, gen p mean: -0.7691543698310852, mean p set: 0.44991445541381836
The modified gen p mean: 0.44861987233161926, gen p mean: -0.7586842775344849, mean p set: 0.44910016655921936
loss_pred:0.02640327624976635, decouple_loss:0.007753769401460886
loss_pred:0.02567824348807335, decouple_loss:0.007548308465629816
loss_pred:0.026826156303286552, decouple_loss:0.0077811661176383495
Iteration: 2664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499236047267914, gen p mean: -0.7720835208892822, mean p set: 0.4504038989543915
The modified gen p mean: 0.44823217391967773, gen p mean: -0.7676235437393188, mean p set: 0.44871246814727783
The modified gen p mean: 0.44955405592918396, gen p mean: -0.7726200222969055, mean p set: 0.45003435015678406
loss_pred:0.02588282898068428, decouple_loss:0.0073686810210347176
loss_pred:0.02594566158950329, decouple_loss:0.007634114474058151
loss_pred:0.02530202455818653, decouple_loss:0.0073952097445726395
Iteration: 2665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495351314544678, gen p mean: -0.7740882635116577, mean p set: 0.4500153958797455
The modified gen p mean: 0.4500401020050049, gen p mean: -0.7669431567192078, mean p set: 0.450520396232605
The modified gen p mean: 0.44823339581489563, gen p mean: -0.7639606595039368, mean p set: 0.4487136900424957
loss_pred:0.025328997522592545, decouple_loss:0.007762409746646881
loss_pred:0.026479393243789673, decouple_loss:0.007882052101194859
loss_pred:0.027744414284825325, decouple_loss:0.007769386749714613
Iteration: 2666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890040159225464, gen p mean: -0.7707794308662415, mean p set: 0.4493807256221771
The modified gen p mean: 0.4510590434074402, gen p mean: -0.7677974700927734, mean p set: 0.4515393376350403
The modified gen p mean: 0.4483950436115265, gen p mean: -0.7645580768585205, mean p set: 0.4488753378391266
loss_pred:0.025978708639740944, decouple_loss:0.007967822253704071
loss_pred:0.0267088133841753, decouple_loss:0.00785440020263195
loss_pred:0.026559701189398766, decouple_loss:0.007727223914116621
Iteration: 2667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491003453731537, gen p mean: -0.7841650247573853, mean p set: 0.4495806396007538
The modified gen p mean: 0.44802820682525635, gen p mean: -0.7805371880531311, mean p set: 0.44850850105285645
The modified gen p mean: 0.4487936794757843, gen p mean: -0.7747446298599243, mean p set: 0.4492739737033844
loss_pred:0.02520340122282505, decouple_loss:0.007847953587770462
loss_pred:0.0256974920630455, decouple_loss:0.007558370009064674
loss_pred:0.02647421695291996, decouple_loss:0.0076722800731658936
Iteration: 2668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44956347346305847, gen p mean: -0.7812480926513672, mean p set: 0.45004376769065857
The modified gen p mean: 0.4475609362125397, gen p mean: -0.7744307518005371, mean p set: 0.4480412006378174
The modified gen p mean: 0.44893208146095276, gen p mean: -0.7680823802947998, mean p set: 0.44941237568855286
loss_pred:0.024681128561496735, decouple_loss:0.007744434755295515
loss_pred:0.025751767680048943, decouple_loss:0.00811992958188057
loss_pred:0.026557350531220436, decouple_loss:0.007739396765828133
Iteration: 2669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485279321670532, gen p mean: -0.7758100628852844, mean p set: 0.4490082263946533
The modified gen p mean: 0.44879260659217834, gen p mean: -0.7688392400741577, mean p set: 0.44927287101745605
The modified gen p mean: 0.4498298168182373, gen p mean: -0.7814439535140991, mean p set: 0.450310081243515
loss_pred:0.024925844743847847, decouple_loss:0.007831561379134655
loss_pred:0.02672870084643364, decouple_loss:0.007887575775384903
loss_pred:0.026375727728009224, decouple_loss:0.008100243285298347
Iteration: 2670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784533977508545, gen p mean: -0.770708441734314, mean p set: 0.44832560420036316
The modified gen p mean: 0.44945028424263, gen p mean: -0.779929518699646, mean p set: 0.4499305486679077
The modified gen p mean: 0.44853317737579346, gen p mean: -0.7734205722808838, mean p set: 0.44901344180107117
loss_pred:0.024752561002969742, decouple_loss:0.0079030841588974
loss_pred:0.025174185633659363, decouple_loss:0.0075013586319983006
loss_pred:0.026239650323987007, decouple_loss:0.0076606678776443005
2023-05-03 08:08:25 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7802028059959412, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7734653353691101, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7692871689796448, mean p set: 0.45035696029663086
loss_pred:0.0260278582572937, decouple_loss:0.008299506269395351
loss_pred:0.02498559094965458, decouple_loss:0.007820941507816315
loss_pred:0.024702176451683044, decouple_loss:0.007601265795528889
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025633905082941055, avg_mse: 0.030986791476607323
current test mse: 0.030987
Iteration: 2671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479248821735382, gen p mean: -0.7658097743988037, mean p set: 0.4484051764011383
loss_pred:0.026378147304058075, decouple_loss:0.0077292416244745255
The modified gen p mean: 0.4488747715950012, gen p mean: -0.777658224105835, mean p set: 0.4493550956249237
loss_pred:0.02581275813281536, decouple_loss:0.007709349039942026
The modified gen p mean: 0.44851556420326233, gen p mean: -0.7659077644348145, mean p set: 0.4489958584308624
loss_pred:0.026560349389910698, decouple_loss:0.007878722622990608
Iteration: 2672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794365763664246, gen p mean: -0.7734091281890869, mean p set: 0.44842392206192017
The modified gen p mean: 0.44827431440353394, gen p mean: -0.761328399181366, mean p set: 0.4487546384334564
The modified gen p mean: 0.44851455092430115, gen p mean: -0.77119380235672, mean p set: 0.44899484515190125
loss_pred:0.025305375456809998, decouple_loss:0.007475231308490038
loss_pred:0.02695181965827942, decouple_loss:0.007426089141517878
loss_pred:0.026854118332266808, decouple_loss:0.007494040299206972
Iteration: 2673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449282169342041, gen p mean: -0.7622723579406738, mean p set: 0.4497624933719635
The modified gen p mean: 0.45011135935783386, gen p mean: -0.7778636813163757, mean p set: 0.45059165358543396
The modified gen p mean: 0.449035108089447, gen p mean: -0.7719690799713135, mean p set: 0.4495154023170471
loss_pred:0.026172949001193047, decouple_loss:0.007449964992702007
loss_pred:0.02564750611782074, decouple_loss:0.0072856261394917965
loss_pred:0.02541423961520195, decouple_loss:0.007318930234760046
Iteration: 2674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490126371383667, gen p mean: -0.773442804813385, mean p set: 0.4494929015636444
The modified gen p mean: 0.4480951428413391, gen p mean: -0.7680960893630981, mean p set: 0.4485754370689392
The modified gen p mean: 0.4486910402774811, gen p mean: -0.7748849391937256, mean p set: 0.4491713047027588
loss_pred:0.026161691173911095, decouple_loss:0.0073998537845909595
loss_pred:0.026827171444892883, decouple_loss:0.007423602510243654
loss_pred:0.026241958141326904, decouple_loss:0.007327750790864229
Iteration: 2675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862130284309387, gen p mean: -0.7773886919021606, mean p set: 0.44910159707069397
The modified gen p mean: 0.4506921172142029, gen p mean: -0.7681670188903809, mean p set: 0.451172411441803
The modified gen p mean: 0.4484918415546417, gen p mean: -0.774007260799408, mean p set: 0.44897210597991943
loss_pred:0.025950266048312187, decouple_loss:0.007265172898769379
loss_pred:0.026176748797297478, decouple_loss:0.007374126464128494
loss_pred:0.026496250182390213, decouple_loss:0.007578115910291672
Iteration: 2676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492180645465851, gen p mean: -0.7632560729980469, mean p set: 0.4496983587741852
The modified gen p mean: 0.44800862669944763, gen p mean: -0.7675867676734924, mean p set: 0.44848892092704773
The modified gen p mean: 0.44875583052635193, gen p mean: -0.7776452302932739, mean p set: 0.449236124753952
loss_pred:0.026754455640912056, decouple_loss:0.007370979059487581
loss_pred:0.026712991297245026, decouple_loss:0.007445435039699078
loss_pred:0.024725792929530144, decouple_loss:0.007417455315589905
Iteration: 2677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492394030094147, gen p mean: -0.7699518799781799, mean p set: 0.44971972703933716
The modified gen p mean: 0.44786709547042847, gen p mean: -0.7694712281227112, mean p set: 0.44834738969802856
The modified gen p mean: 0.45006632804870605, gen p mean: -0.7637397050857544, mean p set: 0.45054665207862854
loss_pred:0.025580020621418953, decouple_loss:0.007097653113305569
loss_pred:0.025294918566942215, decouple_loss:0.007297157309949398
loss_pred:0.025901557877659798, decouple_loss:0.007373225409537554
Iteration: 2678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498286247253418, gen p mean: -0.7797932624816895, mean p set: 0.4503089487552643
The modified gen p mean: 0.44961708784103394, gen p mean: -0.7750884294509888, mean p set: 0.4500974118709564
The modified gen p mean: 0.4494500756263733, gen p mean: -0.7795442938804626, mean p set: 0.4499303698539734
loss_pred:0.024554546922445297, decouple_loss:0.007035021670162678
loss_pred:0.02577832341194153, decouple_loss:0.007077748887240887
loss_pred:0.026895279064774513, decouple_loss:0.007222762797027826
Iteration: 2679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478776156902313, gen p mean: -0.7770806550979614, mean p set: 0.4483579099178314
The modified gen p mean: 0.44937968254089355, gen p mean: -0.7683761715888977, mean p set: 0.44986000657081604
The modified gen p mean: 0.4478103518486023, gen p mean: -0.7775733470916748, mean p set: 0.44829061627388
loss_pred:0.024963632225990295, decouple_loss:0.007049018982797861
loss_pred:0.02604900673031807, decouple_loss:0.006942271254956722
loss_pred:0.025608094409108162, decouple_loss:0.007196119986474514
Iteration: 2680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492962062358856, gen p mean: -0.7634850740432739, mean p set: 0.44977647066116333
The modified gen p mean: 0.44916248321533203, gen p mean: -0.7696523070335388, mean p set: 0.44964277744293213
The modified gen p mean: 0.44948530197143555, gen p mean: -0.7672027349472046, mean p set: 0.44996556639671326
loss_pred:0.025711320340633392, decouple_loss:0.006887407973408699
loss_pred:0.026524962857365608, decouple_loss:0.007263022009283304
loss_pred:0.02613922767341137, decouple_loss:0.007857496850192547
2023-05-03 08:12:05 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.77876877784729, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7861629724502563, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.774768054485321, mean p set: 0.45035696029663086
loss_pred:0.024925878271460533, decouple_loss:0.007286229636520147
loss_pred:0.025894584134221077, decouple_loss:0.007590225897729397
loss_pred:0.024550287052989006, decouple_loss:0.007187008857727051
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02549130842089653, avg_mse: 0.030795976519584656
current test mse: 0.030796
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
NaN value num: 0
Iteration: 2681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45086991786956787, gen p mean: -0.7938604950904846, mean p set: 0.4513501822948456
loss_pred:0.026027614250779152, decouple_loss:0.008385337889194489
The modified gen p mean: 0.4502318203449249, gen p mean: -0.7802869081497192, mean p set: 0.4507121443748474
loss_pred:0.024820717051625252, decouple_loss:0.007893764413893223
The modified gen p mean: 0.4511845111846924, gen p mean: -0.7861602902412415, mean p set: 0.4516648054122925
loss_pred:0.024169571697711945, decouple_loss:0.007946252822875977
Iteration: 2682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44866201281547546, gen p mean: -0.779201090335846, mean p set: 0.44914230704307556
The modified gen p mean: 0.4515189230442047, gen p mean: -0.7989406585693359, mean p set: 0.4519991874694824
The modified gen p mean: 0.4509352445602417, gen p mean: -0.7821087837219238, mean p set: 0.4514155387878418loss_pred:0.024990443140268326, decouple_loss:0.007512207143008709
loss_pred:0.026234127581119537, decouple_loss:0.008078587241470814
loss_pred:0.025144008919596672, decouple_loss:0.007956449873745441
Iteration: 2683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45249879360198975, gen p mean: -0.7999902963638306, mean p set: 0.45297905802726746
The modified gen p mean: 0.4512171447277069, gen p mean: -0.7925256490707397, mean p set: 0.451697438955307
The modified gen p mean: 0.4496780037879944, gen p mean: -0.7919709086418152, mean p set: 0.4501582682132721
loss_pred:0.02643623575568199, decouple_loss:0.007931784726679325
loss_pred:0.026347238570451736, decouple_loss:0.007635395508259535
loss_pred:0.024688858538866043, decouple_loss:0.00751623697578907
Iteration: 2684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499867856502533, gen p mean: -0.7885760068893433, mean p set: 0.4504671096801758
The modified gen p mean: 0.4486974775791168, gen p mean: -0.7950457334518433, mean p set: 0.4491777718067169
The modified gen p mean: 0.4507633149623871, gen p mean: -0.7873468995094299, mean p set: 0.4512436091899872
loss_pred:0.025180663913488388, decouple_loss:0.007781841792166233
loss_pred:0.024727124720811844, decouple_loss:0.007528509479016066
loss_pred:0.025167372077703476, decouple_loss:0.007680458016693592
Iteration: 2685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45244041085243225, gen p mean: -0.7916628122329712, mean p set: 0.45292070508003235
The modified gen p mean: 0.4492751657962799, gen p mean: -0.7903831005096436, mean p set: 0.4497554302215576
The modified gen p mean: 0.4483364522457123, gen p mean: -0.7799737453460693, mean p set: 0.44881677627563477
loss_pred:0.026638567447662354, decouple_loss:0.007506782189011574
loss_pred:0.02502473257482052, decouple_loss:0.007444437127560377
loss_pred:0.0254356786608696, decouple_loss:0.007437316235154867
Iteration: 2686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45089441537857056, gen p mean: -0.7892752885818481, mean p set: 0.45137470960617065
The modified gen p mean: 0.452468603849411, gen p mean: -0.8032907843589783, mean p set: 0.4529488980770111
The modified gen p mean: 0.4500799775123596, gen p mean: -0.7846973538398743, mean p set: 0.45056024193763733
loss_pred:0.026609713211655617, decouple_loss:0.007481925655156374
loss_pred:0.024977724999189377, decouple_loss:0.007824335247278214
loss_pred:0.02552136778831482, decouple_loss:0.007706435397267342
Iteration: 2687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45174968242645264, gen p mean: -0.8003035187721252, mean p set: 0.45222997665405273
The modified gen p mean: 0.4487243592739105, gen p mean: -0.7789451479911804, mean p set: 0.4492046535015106
The modified gen p mean: 0.4512278139591217, gen p mean: -0.7981597185134888, mean p set: 0.4517081081867218
loss_pred:0.02560192346572876, decouple_loss:0.007921766489744186
loss_pred:0.025979027152061462, decouple_loss:0.007522394880652428
loss_pred:0.026079051196575165, decouple_loss:0.007874257862567902
Iteration: 2688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45148998498916626, gen p mean: -0.7784388661384583, mean p set: 0.45197030901908875
The modified gen p mean: 0.4501558840274811, gen p mean: -0.773953914642334, mean p set: 0.4506361782550812
The modified gen p mean: 0.45035824179649353, gen p mean: -0.7733314633369446, mean p set: 0.450838565826416
loss_pred:0.025380996987223625, decouple_loss:0.007587708067148924
loss_pred:0.025084275752305984, decouple_loss:0.007528763264417648
loss_pred:0.026179606094956398, decouple_loss:0.007787848822772503
Iteration: 2689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507479667663574, gen p mean: -0.7698136568069458, mean p set: 0.45122823119163513
The modified gen p mean: 0.45324617624282837, gen p mean: -0.7814071774482727, mean p set: 0.45372650027275085
The modified gen p mean: 0.4514182209968567, gen p mean: -0.7821477055549622, mean p set: 0.4518985152244568
loss_pred:0.026390021666884422, decouple_loss:0.00774352066218853
loss_pred:0.02358347363770008, decouple_loss:0.008003548718988895
loss_pred:0.024501381441950798, decouple_loss:0.0077828005887568
Iteration: 2690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494902193546295, gen p mean: -0.7690073251724243, mean p set: 0.4499705135822296
The modified gen p mean: 0.45008793473243713, gen p mean: -0.7711893320083618, mean p set: 0.45056816935539246
The modified gen p mean: 0.44840550422668457, gen p mean: -0.7632702589035034, mean p set: 0.4488857686519623
loss_pred:0.0247440654784441, decouple_loss:0.007226806599646807
loss_pred:0.02546987682580948, decouple_loss:0.00765661196783185
loss_pred:0.026385653764009476, decouple_loss:0.007322728633880615
2023-05-03 08:16:56 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.780944287776947, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7882872819900513, mean p set: 0.4502691626548767
The modified gen p mean: 0.4498766362667084, gen p mean: -0.7769295573234558, mean p set: 0.45035696029663086
loss_pred:0.025176439434289932, decouple_loss:0.00806128978729248
loss_pred:0.026217477396130562, decouple_loss:0.00834615807980299
loss_pred:0.02486651949584484, decouple_loss:0.008252034895122051
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025831138715147972, avg_mse: 0.031350284814834595
current test mse: 0.03135
Iteration: 2691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518306851387024, gen p mean: -0.7941800951957703, mean p set: 0.4523109793663025
loss_pred:0.02602364867925644, decouple_loss:0.00795791856944561
The modified gen p mean: 0.45077523589134216, gen p mean: -0.7865850925445557, mean p set: 0.4512555003166199
loss_pred:0.026463693007826805, decouple_loss:0.007639557588845491
The modified gen p mean: 0.448230504989624, gen p mean: -0.7784039974212646, mean p set: 0.4487107992172241
loss_pred:0.025650110095739365, decouple_loss:0.007554622367024422
Iteration: 2692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514327645301819, gen p mean: -0.7968238592147827, mean p set: 0.45191308856010437
The modified gen p mean: 0.4508529603481293, gen p mean: -0.8011416792869568, mean p set: 0.451333224773407
The modified gen p mean: 0.4513773024082184, gen p mean: -0.8000859022140503, mean p set: 0.4518575668334961
loss_pred:0.024354523047804832, decouple_loss:0.007533944211900234
loss_pred:0.02419278584420681, decouple_loss:0.007628568913787603
loss_pred:0.025872185826301575, decouple_loss:0.0079152537509799
Iteration: 2693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501718580722809, gen p mean: -0.7851272225379944, mean p set: 0.4506521224975586
The modified gen p mean: 0.44968530535697937, gen p mean: -0.788026750087738, mean p set: 0.45016559958457947
The modified gen p mean: 0.45285534858703613, gen p mean: -0.7989652752876282, mean p set: 0.45333564281463623
loss_pred:0.02482816018164158, decouple_loss:0.007422997150570154
loss_pred:0.02432551048696041, decouple_loss:0.007207593880593777
loss_pred:0.02372789941728115, decouple_loss:0.00766370864585042
Iteration: 2694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45195165276527405, gen p mean: -0.794493556022644, mean p set: 0.45243194699287415
The modified gen p mean: 0.4490574598312378, gen p mean: -0.7824526429176331, mean p set: 0.4495377540588379
The modified gen p mean: 0.4517655074596405, gen p mean: -0.7837597131729126, mean p set: 0.4522458016872406
loss_pred:0.02643117494881153, decouple_loss:0.007682157680392265
loss_pred:0.0248626209795475, decouple_loss:0.007657434791326523
loss_pred:0.02640414424240589, decouple_loss:0.007545880042016506
Iteration: 2695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506523609161377, gen p mean: -0.7918661832809448, mean p set: 0.4511326253414154
The modified gen p mean: 0.4498998820781708, gen p mean: -0.7826343178749084, mean p set: 0.4503801465034485
The modified gen p mean: 0.45277726650238037, gen p mean: -0.7968137860298157, mean p set: 0.45325756072998047
loss_pred:0.02608720026910305, decouple_loss:0.007241610903292894
loss_pred:0.024469755589962006, decouple_loss:0.00762567576020956
loss_pred:0.024569308385252953, decouple_loss:0.007409961894154549
Iteration: 2696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45093393325805664, gen p mean: -0.7824867367744446, mean p set: 0.45141419768333435
The modified gen p mean: 0.4526841342449188, gen p mean: -0.789314329624176, mean p set: 0.4531644284725189
The modified gen p mean: 0.4507392644882202, gen p mean: -0.7817150354385376, mean p set: 0.4512195587158203
loss_pred:0.025609660893678665, decouple_loss:0.007460951339453459
loss_pred:0.023592527955770493, decouple_loss:0.007485819049179554
loss_pred:0.025943472981452942, decouple_loss:0.007078615948557854
Iteration: 2697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44935181736946106, gen p mean: -0.772438108921051, mean p set: 0.44983211159706116
The modified gen p mean: 0.450303316116333, gen p mean: -0.7696125507354736, mean p set: 0.4507836401462555
The modified gen p mean: 0.4496941566467285, gen p mean: -0.7739450931549072, mean p set: 0.4501744508743286
loss_pred:0.02461790107190609, decouple_loss:0.00711995642632246
loss_pred:0.02588375099003315, decouple_loss:0.00741463853046298
loss_pred:0.024743327870965004, decouple_loss:0.007666260469704866
Iteration: 2698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44804269075393677, gen p mean: -0.7663304805755615, mean p set: 0.44852298498153687
The modified gen p mean: 0.4513542950153351, gen p mean: -0.7818636298179626, mean p set: 0.4518345892429352
The modified gen p mean: 0.4501711130142212, gen p mean: -0.7757782936096191, mean p set: 0.4506514370441437
loss_pred:0.025723299011588097, decouple_loss:0.007140058092772961
loss_pred:0.02539370395243168, decouple_loss:0.007157875224947929
loss_pred:0.024664588272571564, decouple_loss:0.007229203823953867
Iteration: 2699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45035216212272644, gen p mean: -0.7782722115516663, mean p set: 0.45083242654800415
The modified gen p mean: 0.45070233941078186, gen p mean: -0.7866657972335815, mean p set: 0.45118266344070435
The modified gen p mean: 0.45090606808662415, gen p mean: -0.7878056764602661, mean p set: 0.45138633251190186
loss_pred:0.02434895560145378, decouple_loss:0.007091977633535862
loss_pred:0.025575991719961166, decouple_loss:0.007085637655109167
loss_pred:0.024250829592347145, decouple_loss:0.007161970250308514
Iteration: 2700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495660960674286, gen p mean: -0.7849713563919067, mean p set: 0.4500464200973511
The modified gen p mean: 0.4497639238834381, gen p mean: -0.7874675393104553, mean p set: 0.4502442479133606
The modified gen p mean: 0.44978851079940796, gen p mean: -0.7798065543174744, mean p set: 0.45026880502700806
loss_pred:0.02453729137778282, decouple_loss:0.0074442909099161625
loss_pred:0.024992547929286957, decouple_loss:0.007241636980324984
loss_pred:0.025156205520033836, decouple_loss:0.007243547588586807
2023-05-03 08:20:36 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7759886384010315, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7834747433662415, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7720345854759216, mean p set: 0.45035696029663086
loss_pred:0.025073420256376266, decouple_loss:0.007894089445471764
loss_pred:0.025987660512328148, decouple_loss:0.00789437722414732
loss_pred:0.024908397346735, decouple_loss:0.00794718973338604
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025718754157423973, avg_mse: 0.031141089275479317
current test mse: 0.031141
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 2701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470789432525635, gen p mean: -0.7736911177635193, mean p set: 0.44755926728248596
loss_pred:0.026910187676548958, decouple_loss:0.008188934065401554
The modified gen p mean: 0.44720011949539185, gen p mean: -0.7784262299537659, mean p set: 0.44768041372299194
loss_pred:0.02509908750653267, decouple_loss:0.008078324608504772
The modified gen p mean: 0.4476320445537567, gen p mean: -0.7809935808181763, mean p set: 0.4481123387813568
loss_pred:0.0250548142939806, decouple_loss:0.008090149611234665
Iteration: 2702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463063180446625, gen p mean: -0.775580108165741, mean p set: 0.44678664207458496
The modified gen p mean: 0.44733738899230957, gen p mean: -0.7689014673233032, mean p set: 0.44781771302223206
The modified gen p mean: 0.44723114371299744, gen p mean: -0.7652449607849121, mean p set: 0.44771143794059753
loss_pred:0.025586264207959175, decouple_loss:0.007764563895761967
loss_pred:0.026461182162165642, decouple_loss:0.00827920250594616
loss_pred:0.026395851746201515, decouple_loss:0.008020879700779915
Iteration: 2703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462769329547882, gen p mean: -0.7790399789810181, mean p set: 0.4467572569847107
The modified gen p mean: 0.44758734107017517, gen p mean: -0.7677279114723206, mean p set: 0.44806763529777527
The modified gen p mean: 0.4471803605556488, gen p mean: -0.7746658325195312, mean p set: 0.4476606547832489
loss_pred:0.024846678599715233, decouple_loss:0.007465086877346039
loss_pred:0.025937452912330627, decouple_loss:0.00803791731595993
loss_pred:0.02678157202899456, decouple_loss:0.0076238117180764675
Iteration: 2704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475558400154114, gen p mean: -0.7814826965332031, mean p set: 0.4480361342430115
The modified gen p mean: 0.4469631016254425, gen p mean: -0.7849359512329102, mean p set: 0.447443425655365
The modified gen p mean: 0.44665277004241943, gen p mean: -0.7864753007888794, mean p set: 0.44713303446769714
loss_pred:0.026546567678451538, decouple_loss:0.007392845116555691
loss_pred:0.025588663294911385, decouple_loss:0.007201774511486292
loss_pred:0.024994269013404846, decouple_loss:0.0070475502870976925
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485866129398346, gen p mean: -0.7934435606002808, mean p set: 0.4490669369697571
The modified gen p mean: 0.4475800395011902, gen p mean: -0.7828711271286011, mean p set: 0.4480603337287903
The modified gen p mean: 0.44785478711128235, gen p mean: -0.7864728569984436, mean p set: 0.44833505153656006
loss_pred:0.025394529104232788, decouple_loss:0.007644928526133299
loss_pred:0.02566465735435486, decouple_loss:0.0073555526323616505
loss_pred:0.02560708485543728, decouple_loss:0.007942679338157177
Iteration: 2706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471185505390167, gen p mean: -0.7778448462486267, mean p set: 0.4475988745689392
The modified gen p mean: 0.44719043374061584, gen p mean: -0.7878814339637756, mean p set: 0.44767072796821594
The modified gen p mean: 0.4476197361946106, gen p mean: -0.7792403697967529, mean p set: 0.4481000304222107
loss_pred:0.02581418678164482, decouple_loss:0.007333735004067421
loss_pred:0.02632322907447815, decouple_loss:0.007238736841827631
loss_pred:0.0260622575879097, decouple_loss:0.007311866618692875
Iteration: 2707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44654354453086853, gen p mean: -0.7804171442985535, mean p set: 0.44702383875846863
The modified gen p mean: 0.44719046354293823, gen p mean: -0.7700750231742859, mean p set: 0.44767072796821594
The modified gen p mean: 0.4473910927772522, gen p mean: -0.7744622230529785, mean p set: 0.4478713572025299
loss_pred:0.025395076721906662, decouple_loss:0.007065682206302881
loss_pred:0.02700689807534218, decouple_loss:0.007386606186628342
loss_pred:0.026910141110420227, decouple_loss:0.007302539423108101
Iteration: 2708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477905035018921, gen p mean: -0.7791398763656616, mean p set: 0.4482708275318146
The modified gen p mean: 0.4476642608642578, gen p mean: -0.7797462344169617, mean p set: 0.4481445848941803
The modified gen p mean: 0.44691622257232666, gen p mean: -0.7688390612602234, mean p set: 0.44739648699760437
loss_pred:0.026961764320731163, decouple_loss:0.007111756131052971
loss_pred:0.02550143003463745, decouple_loss:0.007111302111297846
loss_pred:0.026893172413110733, decouple_loss:0.007212925236672163
Iteration: 2709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475373327732086, gen p mean: -0.7809711694717407, mean p set: 0.4480176270008087
The modified gen p mean: 0.4477413594722748, gen p mean: -0.7766923904418945, mean p set: 0.4482216238975525
The modified gen p mean: 0.4471006393432617, gen p mean: -0.7791860103607178, mean p set: 0.44758090376853943
loss_pred:0.026025472208857536, decouple_loss:0.007246916648000479
loss_pred:0.026400964707136154, decouple_loss:0.0069177220575511456
loss_pred:0.026121437549591064, decouple_loss:0.0069868359714746475
Iteration: 2710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752684235572815, gen p mean: -0.7826060652732849, mean p set: 0.44800713658332825
The modified gen p mean: 0.44735562801361084, gen p mean: -0.783594012260437, mean p set: 0.44783589243888855
The modified gen p mean: 0.44772130250930786, gen p mean: -0.7824516296386719, mean p set: 0.44820162653923035
loss_pred:0.025627903640270233, decouple_loss:0.007152433507144451
loss_pred:0.025042088702321053, decouple_loss:0.006856667343527079
loss_pred:0.026636481285095215, decouple_loss:0.006764122284948826
2023-05-03 08:25:29 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7809981107711792, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7873380780220032, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7773025035858154, mean p set: 0.45035696029663086
loss_pred:0.025068100541830063, decouple_loss:0.0071117267943918705
loss_pred:0.025957666337490082, decouple_loss:0.0074042207561433315
loss_pred:0.024769499897956848, decouple_loss:0.00718219019472599
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02562672458589077, avg_mse: 0.03117017075419426
current test mse: 0.03117
Iteration: 2711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776326417922974, gen p mean: -0.7842127084732056, mean p set: 0.44824355840682983
The modified gen p mean: 0.44715288281440735, gen p mean: -0.7841657996177673, mean p set: 0.44763314723968506
loss_pred:0.026254812255501747, decouple_loss:0.0073018306866288185
loss_pred:0.02650793455541134, decouple_loss:0.007545347325503826
The modified gen p mean: 0.44681569933891296, gen p mean: -0.7817863821983337, mean p set: 0.44729599356651306
loss_pred:0.0249167513102293, decouple_loss:0.007008574437350035
Iteration: 2712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701892137527466, gen p mean: -0.781758725643158, mean p set: 0.44749921560287476
The modified gen p mean: 0.448035329580307, gen p mean: -0.7953951954841614, mean p set: 0.4485156238079071
The modified gen p mean: 0.44800668954849243, gen p mean: -0.7935246825218201, mean p set: 0.44848695397377014
loss_pred:0.02664470486342907, decouple_loss:0.007035441696643829
loss_pred:0.02419188804924488, decouple_loss:0.007104779593646526
loss_pred:0.025717107579112053, decouple_loss:0.0070768422447144985
Iteration: 2713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472668766975403, gen p mean: -0.7939164638519287, mean p set: 0.44774720072746277
The modified gen p mean: 0.44744566082954407, gen p mean: -0.791492760181427, mean p set: 0.44792598485946655
The modified gen p mean: 0.44748654961586, gen p mean: -0.7815978527069092, mean p set: 0.4479668438434601
loss_pred:0.024833280593156815, decouple_loss:0.007200229912996292
loss_pred:0.02588391676545143, decouple_loss:0.0073283459059894085
loss_pred:0.026998387649655342, decouple_loss:0.007501393090933561
Iteration: 2714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477626085281372, gen p mean: -0.7845824956893921, mean p set: 0.4482428729534149
The modified gen p mean: 0.44760948419570923, gen p mean: -0.794955313205719, mean p set: 0.4480897784233093
The modified gen p mean: 0.4485894441604614, gen p mean: -0.7973043322563171, mean p set: 0.4490697383880615
loss_pred:0.02554313838481903, decouple_loss:0.007687636185437441
loss_pred:0.025858158245682716, decouple_loss:0.007391787134110928
loss_pred:0.02497456967830658, decouple_loss:0.007425161078572273
Iteration: 2715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44814151525497437, gen p mean: -0.7896685004234314, mean p set: 0.4486217796802521
The modified gen p mean: 0.4472975432872772, gen p mean: -0.7926474809646606, mean p set: 0.4477778375148773
The modified gen p mean: 0.4476644992828369, gen p mean: -0.78376704454422, mean p set: 0.4481448233127594
loss_pred:0.025704380124807358, decouple_loss:0.007018332369625568
loss_pred:0.024935610592365265, decouple_loss:0.007243619300425053
loss_pred:0.02608579583466053, decouple_loss:0.007005526218563318
Iteration: 2716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481312930583954, gen p mean: -0.7921722531318665, mean p set: 0.4486115872859955
The modified gen p mean: 0.4473235309123993, gen p mean: -0.7901143431663513, mean p set: 0.4478038251399994
The modified gen p mean: 0.44698387384414673, gen p mean: -0.7802186012268066, mean p set: 0.4474641680717468
loss_pred:0.026183847337961197, decouple_loss:0.007084179203957319
loss_pred:0.025486016646027565, decouple_loss:0.007496691308915615
loss_pred:0.02699155919253826, decouple_loss:0.007206654641777277
Iteration: 2717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44759687781333923, gen p mean: -0.787422776222229, mean p set: 0.44807714223861694
The modified gen p mean: 0.44601359963417053, gen p mean: -0.7879053950309753, mean p set: 0.44649389386177063
The modified gen p mean: 0.4479086399078369, gen p mean: -0.7880887389183044, mean p set: 0.4483889639377594
loss_pred:0.02559618279337883, decouple_loss:0.0070966980420053005
loss_pred:0.024709895253181458, decouple_loss:0.006945061031728983
loss_pred:0.025313669815659523, decouple_loss:0.006926284171640873
Iteration: 2718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745901226997375, gen p mean: -0.780648410320282, mean p set: 0.44793930649757385
The modified gen p mean: 0.4483295977115631, gen p mean: -0.790514349937439, mean p set: 0.4488099217414856
The modified gen p mean: 0.4475240707397461, gen p mean: -0.7878372073173523, mean p set: 0.4480043649673462
loss_pred:0.02603108435869217, decouple_loss:0.00707973213866353
loss_pred:0.02670072577893734, decouple_loss:0.007016546558588743
loss_pred:0.02618846483528614, decouple_loss:0.007003018632531166
Iteration: 2719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474899172782898, gen p mean: -0.7841801643371582, mean p set: 0.4479702413082123
The modified gen p mean: 0.4478148818016052, gen p mean: -0.7851176857948303, mean p set: 0.4482952058315277
The modified gen p mean: 0.4475264549255371, gen p mean: -0.7870151996612549, mean p set: 0.4480067491531372
loss_pred:0.025026386603713036, decouple_loss:0.007502521853893995
loss_pred:0.02579643204808235, decouple_loss:0.006969303824007511
loss_pred:0.025783956050872803, decouple_loss:0.007182204630225897
Iteration: 2720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477926790714264, gen p mean: -0.7839282155036926, mean p set: 0.4482730031013489
The modified gen p mean: 0.4471842646598816, gen p mean: -0.7787262797355652, mean p set: 0.4476645588874817
The modified gen p mean: 0.44677072763442993, gen p mean: -0.7821359634399414, mean p set: 0.44725102186203003
loss_pred:0.02515582926571369, decouple_loss:0.00697867339476943
loss_pred:0.02629360556602478, decouple_loss:0.007109279744327068
loss_pred:0.025100234895944595, decouple_loss:0.0068485490046441555
2023-05-03 08:29:09 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7896765470504761, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7820927500724792, mean p set: 0.4500633478164673
The modified gen p mean: 0.4498766362667084, gen p mean: -0.7784987688064575, mean p set: 0.45035696029663086
loss_pred:0.02581218257546425, decouple_loss:0.007179724983870983
loss_pred:0.0248683150857687, decouple_loss:0.007054610177874565
loss_pred:0.02463477849960327, decouple_loss:0.0071238125674426556
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025461062788963318, avg_mse: 0.03085733950138092
current test mse: 0.030857
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 2721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44625115394592285, gen p mean: -0.7789807915687561, mean p set: 0.44673141837120056
loss_pred:0.025654001161456108, decouple_loss:0.006759542040526867
The modified gen p mean: 0.4469147026538849, gen p mean: -0.7834444642066956, mean p set: 0.447394996881485
loss_pred:0.02461307868361473, decouple_loss:0.006865046452730894
The modified gen p mean: 0.4484224021434784, gen p mean: -0.7929298281669617, mean p set: 0.4489026963710785
loss_pred:0.02434980683028698, decouple_loss:0.0071720341220498085
Iteration: 2722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719481468200684, gen p mean: -0.7808322310447693, mean p set: 0.44767507910728455
The modified gen p mean: 0.4471133351325989, gen p mean: -0.7853511571884155, mean p set: 0.447593629360199
The modified gen p mean: 0.44724735617637634, gen p mean: -0.7833050489425659, mean p set: 0.44772762060165405
loss_pred:0.0237942673265934, decouple_loss:0.007081330753862858
loss_pred:0.02438976615667343, decouple_loss:0.006870177574455738
loss_pred:0.02380373887717724, decouple_loss:0.006989248562604189
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446443647146225, gen p mean: -0.773958146572113, mean p set: 0.44692397117614746
The modified gen p mean: 0.4471958875656128, gen p mean: -0.7772495150566101, mean p set: 0.4476762115955353
The modified gen p mean: 0.44808536767959595, gen p mean: -0.785190224647522, mean p set: 0.44856566190719604
loss_pred:0.02486628107726574, decouple_loss:0.00674513028934598
loss_pred:0.024223148822784424, decouple_loss:0.007003290578722954
loss_pred:0.02427874505519867, decouple_loss:0.0071288421750068665
Iteration: 2724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686564803123474, gen p mean: -0.7835927605628967, mean p set: 0.4473459720611572
The modified gen p mean: 0.4461408853530884, gen p mean: -0.7745934128761292, mean p set: 0.4466211497783661
The modified gen p mean: 0.4467621445655823, gen p mean: -0.7752116322517395, mean p set: 0.44724246859550476
loss_pred:0.024938290938735008, decouple_loss:0.007355323061347008
loss_pred:0.02504715509712696, decouple_loss:0.006813109386712313
loss_pred:0.024633290246129036, decouple_loss:0.006829261314123869
Iteration: 2725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733890891075134, gen p mean: -0.7906990051269531, mean p set: 0.44781920313835144
The modified gen p mean: 0.4473579227924347, gen p mean: -0.7915807366371155, mean p set: 0.4478381872177124
The modified gen p mean: 0.44882553815841675, gen p mean: -0.7946270704269409, mean p set: 0.44930580258369446
loss_pred:0.02501201257109642, decouple_loss:0.00681405421346426
loss_pred:0.02443716861307621, decouple_loss:0.006892106961458921
loss_pred:0.024393033236265182, decouple_loss:0.0068146721459925175
Iteration: 2726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785261154174805, gen p mean: -0.7831411957740784, mean p set: 0.44833290576934814
The modified gen p mean: 0.4469868242740631, gen p mean: -0.7865004539489746, mean p set: 0.4474670886993408
The modified gen p mean: 0.4460422694683075, gen p mean: -0.7788993716239929, mean p set: 0.4465225338935852
loss_pred:0.024714896455407143, decouple_loss:0.0066190455108881
loss_pred:0.024203075096011162, decouple_loss:0.006759213283658028
loss_pred:0.024901842698454857, decouple_loss:0.006704669911414385
Iteration: 2727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470779299736023, gen p mean: -0.7740803956985474, mean p set: 0.4475582242012024
The modified gen p mean: 0.44708251953125, gen p mean: -0.7782649993896484, mean p set: 0.4475627839565277
The modified gen p mean: 0.4473233222961426, gen p mean: -0.7849245071411133, mean p set: 0.4478035867214203
loss_pred:0.023542609065771103, decouple_loss:0.007135144900530577
loss_pred:0.023054171353578568, decouple_loss:0.006696127820760012
loss_pred:0.02463422156870365, decouple_loss:0.0069841183722019196
Iteration: 2728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465855360031128, gen p mean: -0.7691593170166016, mean p set: 0.4470658302307129
The modified gen p mean: 0.44654273986816406, gen p mean: -0.7695223689079285, mean p set: 0.44702303409576416
The modified gen p mean: 0.4458526074886322, gen p mean: -0.7701583504676819, mean p set: 0.4463328719139099
loss_pred:0.02564479038119316, decouple_loss:0.00655180960893631
loss_pred:0.024972613900899887, decouple_loss:0.0067270053550601006
loss_pred:0.02508280798792839, decouple_loss:0.006786828860640526
Iteration: 2729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44609978795051575, gen p mean: -0.7708897590637207, mean p set: 0.44658011198043823
The modified gen p mean: 0.44688859581947327, gen p mean: -0.7697350382804871, mean p set: 0.447368860244751
The modified gen p mean: 0.4468006491661072, gen p mean: -0.7708556652069092, mean p set: 0.4472809433937073
loss_pred:0.025546567514538765, decouple_loss:0.006781329866498709
loss_pred:0.025010008364915848, decouple_loss:0.006621230393648148
loss_pred:0.0249473936855793, decouple_loss:0.006674488075077534
Iteration: 2730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470537006855011, gen p mean: -0.7802665829658508, mean p set: 0.4475339949131012
The modified gen p mean: 0.4465208947658539, gen p mean: -0.7779965400695801, mean p set: 0.44700121879577637
The modified gen p mean: 0.4459840655326843, gen p mean: -0.775093138217926, mean p set: 0.4464643895626068
loss_pred:0.02469201385974884, decouple_loss:0.0067950086668133736
loss_pred:0.02448323927819729, decouple_loss:0.006895555183291435
loss_pred:0.02532717026770115, decouple_loss:0.006541627924889326
2023-05-03 08:33:45 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7737532258033752, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7817320823669434, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7699059844017029, mean p set: 0.45035696029663086
loss_pred:0.024803195148706436, decouple_loss:0.0070718820206820965
loss_pred:0.02572501450777054, decouple_loss:0.007273816037923098
loss_pred:0.024522021412849426, decouple_loss:0.006935623940080404
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025371432304382324, avg_mse: 0.03073553554713726
current test mse: 0.030736
Iteration: 2731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802191853523254, gen p mean: -0.7842459082603455, mean p set: 0.44850221276283264
The modified gen p mean: 0.44676193594932556, gen p mean: -0.7720891833305359, mean p set: 0.44724223017692566
loss_pred:0.024193916469812393, decouple_loss:0.006784113124012947
loss_pred:0.02472137100994587, decouple_loss:0.006669077090919018
The modified gen p mean: 0.44735148549079895, gen p mean: -0.7713013291358948, mean p set: 0.44783177971839905
loss_pred:0.02551513910293579, decouple_loss:0.0067454744130373
Iteration: 2732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476472735404968, gen p mean: -0.7667028903961182, mean p set: 0.4481275677680969
The modified gen p mean: 0.4468706548213959, gen p mean: -0.7637487649917603, mean p set: 0.44735097885131836
The modified gen p mean: 0.44771742820739746, gen p mean: -0.7703003883361816, mean p set: 0.44819772243499756
loss_pred:0.02480178326368332, decouple_loss:0.006529294420033693
loss_pred:0.024343544617295265, decouple_loss:0.006619494408369064
loss_pred:0.025815006345510483, decouple_loss:0.006731427740305662
Iteration: 2733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469716250896454, gen p mean: -0.7633025646209717, mean p set: 0.4474518895149231
The modified gen p mean: 0.4467068910598755, gen p mean: -0.7729361057281494, mean p set: 0.44718724489212036
The modified gen p mean: 0.4462994635105133, gen p mean: -0.766229510307312, mean p set: 0.4467797577381134
loss_pred:0.024951593950390816, decouple_loss:0.006705342326313257
loss_pred:0.02542729675769806, decouple_loss:0.006610151380300522
loss_pred:0.024457765743136406, decouple_loss:0.006885712035000324
Iteration: 2734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469561278820038, gen p mean: -0.7905157804489136, mean p set: 0.4474363923072815
The modified gen p mean: 0.4461709260940552, gen p mean: -0.7784294486045837, mean p set: 0.4466512203216553
The modified gen p mean: 0.44683948159217834, gen p mean: -0.7773334980010986, mean p set: 0.44731974601745605
loss_pred:0.024502575397491455, decouple_loss:0.0071461815387010574
loss_pred:0.025811467319726944, decouple_loss:0.006735872942954302
loss_pred:0.02415286935865879, decouple_loss:0.0067085023038089275
Iteration: 2735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468630850315094, gen p mean: -0.7814912796020508, mean p set: 0.4473433792591095
The modified gen p mean: 0.4478234350681305, gen p mean: -0.797712504863739, mean p set: 0.4483036994934082
The modified gen p mean: 0.44653886556625366, gen p mean: -0.7842350006103516, mean p set: 0.44701918959617615
loss_pred:0.024540191516280174, decouple_loss:0.006430381443351507
loss_pred:0.02375209331512451, decouple_loss:0.006849491037428379
loss_pred:0.024736272171139717, decouple_loss:0.006569198332726955
Iteration: 2736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475893974304199, gen p mean: -0.7803115844726562, mean p set: 0.44806966185569763
The modified gen p mean: 0.44696149230003357, gen p mean: -0.7791464328765869, mean p set: 0.4474417567253113
The modified gen p mean: 0.44670340418815613, gen p mean: -0.7757261991500854, mean p set: 0.4471836984157562
loss_pred:0.024276915937662125, decouple_loss:0.006522784009575844
loss_pred:0.0245733093470335, decouple_loss:0.006537880282849073
loss_pred:0.02472836524248123, decouple_loss:0.006597532890737057
Iteration: 2737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471782445907593, gen p mean: -0.7834702134132385, mean p set: 0.4476585388183594
The modified gen p mean: 0.44709211587905884, gen p mean: -0.7880158424377441, mean p set: 0.4475724399089813
The modified gen p mean: 0.44808992743492126, gen p mean: -0.780963122844696, mean p set: 0.448570191860199
loss_pred:0.024613993242383003, decouple_loss:0.006452629342675209
loss_pred:0.023813141509890556, decouple_loss:0.006590357515960932
loss_pred:0.025144478306174278, decouple_loss:0.0064339907839894295
Iteration: 2738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470162093639374, gen p mean: -0.777370810508728, mean p set: 0.4474965035915375
The modified gen p mean: 0.4472261667251587, gen p mean: -0.7783724665641785, mean p set: 0.4477064609527588
The modified gen p mean: 0.4460238814353943, gen p mean: -0.778617262840271, mean p set: 0.446504145860672
loss_pred:0.024087198078632355, decouple_loss:0.006470590364187956
loss_pred:0.0244008619338274, decouple_loss:0.0064144437201321125
loss_pred:0.02490878291428089, decouple_loss:0.006605315022170544
Iteration: 2739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471054971218109, gen p mean: -0.7856371402740479, mean p set: 0.447585791349411
The modified gen p mean: 0.4460639953613281, gen p mean: -0.7817997932434082, mean p set: 0.4465442895889282
The modified gen p mean: 0.4478108584880829, gen p mean: -0.7857691645622253, mean p set: 0.44829118251800537
loss_pred:0.024191712960600853, decouple_loss:0.0062910402193665504
loss_pred:0.024531934410333633, decouple_loss:0.006678164005279541
loss_pred:0.024881813675165176, decouple_loss:0.006359259132295847
Iteration: 2740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447511225938797, gen p mean: -0.7992817759513855, mean p set: 0.4479915201663971
The modified gen p mean: 0.44603610038757324, gen p mean: -0.7797563076019287, mean p set: 0.44651639461517334
The modified gen p mean: 0.44798219203948975, gen p mean: -0.793834388256073, mean p set: 0.44846251606941223
loss_pred:0.024075955152511597, decouple_loss:0.006862279027700424
loss_pred:0.025016531348228455, decouple_loss:0.006543389987200499
loss_pred:0.023765938356518745, decouple_loss:0.006451269146054983
2023-05-03 08:37:28 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7879810333251953, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7806116938591003, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7761668562889099, mean p set: 0.45035696029663086
loss_pred:0.025701185688376427, decouple_loss:0.007233539130538702
loss_pred:0.024673618376255035, decouple_loss:0.007022007368505001
loss_pred:0.02454065904021263, decouple_loss:0.007061189506202936
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025327101349830627, avg_mse: 0.03073447197675705
current test mse: 0.030734
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 2741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479922950267792, gen p mean: -0.77973473072052, mean p set: 0.4484725892543793
loss_pred:0.024075401946902275, decouple_loss:0.006889652460813522
The modified gen p mean: 0.44763290882110596, gen p mean: -0.7860909700393677, mean p set: 0.44811320304870605
loss_pred:0.024489520117640495, decouple_loss:0.0067853559739887714
The modified gen p mean: 0.44809389114379883, gen p mean: -0.7782476544380188, mean p set: 0.4485742151737213
loss_pred:0.02429814450442791, decouple_loss:0.006750766653567553
Iteration: 2742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468432366847992, gen p mean: -0.7802614569664001, mean p set: 0.4473235309123993
The modified gen p mean: 0.4470152258872986, gen p mean: -0.7783381342887878, mean p set: 0.4474954903125763
The modified gen p mean: 0.447194367647171, gen p mean: -0.7782244086265564, mean p set: 0.4476746618747711
loss_pred:0.02510826848447323, decouple_loss:0.0068190209567546844
loss_pred:0.025812771171331406, decouple_loss:0.006943338084965944
loss_pred:0.025047406554222107, decouple_loss:0.006835059262812138
Iteration: 2743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772395491600037, gen p mean: -0.7811874747276306, mean p set: 0.44820424914360046
The modified gen p mean: 0.4473423361778259, gen p mean: -0.7846474051475525, mean p set: 0.447822630405426
The modified gen p mean: 0.44716647267341614, gen p mean: -0.7852232456207275, mean p set: 0.44764673709869385
loss_pred:0.0248348880559206, decouple_loss:0.0067670345306396484
loss_pred:0.02424793690443039, decouple_loss:0.006410444155335426
loss_pred:0.024963537231087685, decouple_loss:0.0066146934404969215
Iteration: 2744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483368694782257, gen p mean: -0.787442684173584, mean p set: 0.4488171935081482
The modified gen p mean: 0.44769224524497986, gen p mean: -0.7907202243804932, mean p set: 0.44817250967025757
The modified gen p mean: 0.4481734335422516, gen p mean: -0.7853040099143982, mean p set: 0.4486536979675293
loss_pred:0.02436172030866146, decouple_loss:0.006300155073404312
loss_pred:0.02519175596535206, decouple_loss:0.006909247953444719
loss_pred:0.024035833775997162, decouple_loss:0.006414059083908796
Iteration: 2745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476580023765564, gen p mean: -0.7821964025497437, mean p set: 0.4481382668018341
The modified gen p mean: 0.4481970965862274, gen p mean: -0.7842849493026733, mean p set: 0.4486773908138275
The modified gen p mean: 0.4480590224266052, gen p mean: -0.7881232500076294, mean p set: 0.4485393166542053
loss_pred:0.02422114461660385, decouple_loss:0.00648414297029376
loss_pred:0.02437165193259716, decouple_loss:0.00647670729085803
loss_pred:0.024549363180994987, decouple_loss:0.006952688097953796
Iteration: 2746, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44809916615486145, gen p mean: -0.7805795669555664, mean p set: 0.44857946038246155
The modified gen p mean: 0.4473298490047455, gen p mean: -0.7808264493942261, mean p set: 0.4478101134300232
The modified gen p mean: 0.4464249908924103, gen p mean: -0.7758154273033142, mean p set: 0.4469052851200104
loss_pred:0.024173690006136894, decouple_loss:0.006270585115998983
loss_pred:0.024919113144278526, decouple_loss:0.006631520576775074
loss_pred:0.02458546869456768, decouple_loss:0.006770503241568804
Iteration: 2747, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473123550415039, gen p mean: -0.7796267867088318, mean p set: 0.4477926790714264
The modified gen p mean: 0.4466927945613861, gen p mean: -0.7792655825614929, mean p set: 0.4471730887889862
The modified gen p mean: 0.44827932119369507, gen p mean: -0.7804027795791626, mean p set: 0.44875964522361755
loss_pred:0.024562669917941093, decouple_loss:0.0066312020644545555
loss_pred:0.025368819013237953, decouple_loss:0.006782689597457647
loss_pred:0.023925570771098137, decouple_loss:0.006631588097661734
Iteration: 2748, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458563029766083, gen p mean: -0.7727454900741577, mean p set: 0.446336567401886
The modified gen p mean: 0.4467616081237793, gen p mean: -0.7782942056655884, mean p set: 0.447241872549057
The modified gen p mean: 0.44619259238243103, gen p mean: -0.7765426635742188, mean p set: 0.44667288661003113
loss_pred:0.02420753240585327, decouple_loss:0.006472801323980093
loss_pred:0.024915270507335663, decouple_loss:0.006645786575973034
loss_pred:0.024455657228827477, decouple_loss:0.006541380658745766
Iteration: 2749, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44606471061706543, gen p mean: -0.7708789706230164, mean p set: 0.4465450048446655
The modified gen p mean: 0.44762375950813293, gen p mean: -0.7766398191452026, mean p set: 0.44810402393341064
The modified gen p mean: 0.44795340299606323, gen p mean: -0.7732338905334473, mean p set: 0.44843369722366333
loss_pred:0.024779818952083588, decouple_loss:0.006415050011128187
loss_pred:0.02374545857310295, decouple_loss:0.006286881398409605
loss_pred:0.02424817532300949, decouple_loss:0.006355364806950092
Iteration: 2750, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486333727836609, gen p mean: -0.7761473059654236, mean p set: 0.449113667011261
The modified gen p mean: 0.44733962416648865, gen p mean: -0.7806987762451172, mean p set: 0.44781988859176636
The modified gen p mean: 0.44667744636535645, gen p mean: -0.7792345285415649, mean p set: 0.44715774059295654
loss_pred:0.025264644995331764, decouple_loss:0.006843488663434982
loss_pred:0.025398772209882736, decouple_loss:0.006608552765101194
loss_pred:0.024825582280755043, decouple_loss:0.00646836357191205
2023-05-03 08:42:14 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7774261832237244, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7843093872070312, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7736311554908752, mean p set: 0.45035696029663086
loss_pred:0.024698007851839066, decouple_loss:0.00676838681101799
loss_pred:0.02573244459927082, decouple_loss:0.006957267411053181
loss_pred:0.02448614500463009, decouple_loss:0.006820759270340204
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025314640253782272, avg_mse: 0.03075147233903408
current test mse: 0.030751
Iteration: 2751, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44777384400367737, gen p mean: -0.7792870998382568, mean p set: 0.4482541084289551
loss_pred:0.024787699803709984, decouple_loss:0.006127570290118456
The modified gen p mean: 0.4476127028465271, gen p mean: -0.7765731811523438, mean p set: 0.4480930268764496
loss_pred:0.02566528506577015, decouple_loss:0.0064981309697031975
The modified gen p mean: 0.4460369944572449, gen p mean: -0.7787314057350159, mean p set: 0.44651728868484497
loss_pred:0.024339569732546806, decouple_loss:0.006975891999900341
Iteration: 2752, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466818571090698, gen p mean: -0.78238844871521, mean p set: 0.4471621811389923
The modified gen p mean: 0.44784215092658997, gen p mean: -0.7841004729270935, mean p set: 0.44832247495651245
The modified gen p mean: 0.44786500930786133, gen p mean: -0.7844213843345642, mean p set: 0.44834527373313904
loss_pred:0.024967709556221962, decouple_loss:0.006812114734202623
loss_pred:0.025443093851208687, decouple_loss:0.006593178957700729
loss_pred:0.025252386927604675, decouple_loss:0.006746695376932621
Iteration: 2753, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448651522397995, gen p mean: -0.7806206941604614, mean p set: 0.4491317868232727
The modified gen p mean: 0.44792696833610535, gen p mean: -0.7846837639808655, mean p set: 0.44840726256370544
The modified gen p mean: 0.44665244221687317, gen p mean: -0.7802774906158447, mean p set: 0.44713273644447327
loss_pred:0.024368859827518463, decouple_loss:0.006340492516756058
loss_pred:0.02479270100593567, decouple_loss:0.006431990303099155
loss_pred:0.02474013715982437, decouple_loss:0.006377452984452248
Iteration: 2754, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733601808547974, gen p mean: -0.7831650972366333, mean p set: 0.44781628251075745
The modified gen p mean: 0.44732123613357544, gen p mean: -0.7828035354614258, mean p set: 0.44780153036117554
The modified gen p mean: 0.4462664723396301, gen p mean: -0.7741127610206604, mean p set: 0.4467467665672302
loss_pred:0.02548391744494438, decouple_loss:0.00646078959107399
loss_pred:0.025712667033076286, decouple_loss:0.006551404483616352
loss_pred:0.02456059120595455, decouple_loss:0.006558792665600777
Iteration: 2755, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480447471141815, gen p mean: -0.7808235287666321, mean p set: 0.44852498173713684
The modified gen p mean: 0.44782301783561707, gen p mean: -0.785028338432312, mean p set: 0.44830334186553955
The modified gen p mean: 0.4466976225376129, gen p mean: -0.7782696485519409, mean p set: 0.447177916765213
loss_pred:0.02510051056742668, decouple_loss:0.006227588746696711
loss_pred:0.02455131709575653, decouple_loss:0.006748370826244354
loss_pred:0.024374887347221375, decouple_loss:0.006569550838321447
Iteration: 2756, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466300308704376, gen p mean: -0.7822739481925964, mean p set: 0.4471103250980377
The modified gen p mean: 0.44786536693573, gen p mean: -0.7793174386024475, mean p set: 0.4483456313610077
The modified gen p mean: 0.44744789600372314, gen p mean: -0.7853316068649292, mean p set: 0.44792816042900085
loss_pred:0.025848422199487686, decouple_loss:0.0064099919982254505
loss_pred:0.024831976741552353, decouple_loss:0.006582754198461771
loss_pred:0.024282895028591156, decouple_loss:0.0065889726392924786
Iteration: 2757, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751405715942383, gen p mean: -0.7870096564292908, mean p set: 0.44799429178237915
The modified gen p mean: 0.44727715849876404, gen p mean: -0.7918527126312256, mean p set: 0.44775745272636414
The modified gen p mean: 0.4475368559360504, gen p mean: -0.7897679209709167, mean p set: 0.4480171501636505
loss_pred:0.024142425507307053, decouple_loss:0.006267469376325607
loss_pred:0.02454202063381672, decouple_loss:0.006367137655615807
loss_pred:0.024981172755360603, decouple_loss:0.00630187289789319
Iteration: 2758, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472848176956177, gen p mean: -0.7953175902366638, mean p set: 0.4477651119232178
The modified gen p mean: 0.44812795519828796, gen p mean: -0.7926890254020691, mean p set: 0.44860827922821045
The modified gen p mean: 0.4463234841823578, gen p mean: -0.7895604968070984, mean p set: 0.4468037486076355
loss_pred:0.02473425306379795, decouple_loss:0.006531174294650555
loss_pred:0.02457127347588539, decouple_loss:0.006499492563307285
loss_pred:0.024983981624245644, decouple_loss:0.0063387867994606495
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2759, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725462794303894, gen p mean: -0.7895161509513855, mean p set: 0.44773492217063904
The modified gen p mean: 0.4455784261226654, gen p mean: -0.7820168733596802, mean p set: 0.4460587203502655
The modified gen p mean: 0.44784584641456604, gen p mean: -0.7884294986724854, mean p set: 0.44832614064216614
loss_pred:0.024486146867275238, decouple_loss:0.006219868082553148
loss_pred:0.024332107976078987, decouple_loss:0.006838735658675432
loss_pred:0.02384905330836773, decouple_loss:0.006410369649529457
Iteration: 2760, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474705159664154, gen p mean: -0.7878098487854004, mean p set: 0.4479508101940155
The modified gen p mean: 0.44811680912971497, gen p mean: -0.7845666408538818, mean p set: 0.4485970735549927
The modified gen p mean: 0.4481574296951294, gen p mean: -0.7907682061195374, mean p set: 0.4486377537250519
loss_pred:0.02481132745742798, decouple_loss:0.006586385425180197
loss_pred:0.023924294859170914, decouple_loss:0.006383297499269247
loss_pred:0.024653319269418716, decouple_loss:0.006414255127310753
2023-05-03 08:45:55 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7816191911697388, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7889281511306763, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7772717475891113, mean p set: 0.45035696029663086
loss_pred:0.024710092693567276, decouple_loss:0.006727336905896664
loss_pred:0.025682253763079643, decouple_loss:0.006982638034969568
loss_pred:0.02440345101058483, decouple_loss:0.0067574987187981606
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02527305856347084, avg_mse: 0.030688012018799782
current test mse: 0.030688
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
NaN value num: 0
Iteration: 2761, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527490735054016, gen p mean: -0.7893834114074707, mean p set: 0.4532293677330017
loss_pred:0.02331964112818241, decouple_loss:0.008082264102995396
The modified gen p mean: 0.4515265226364136, gen p mean: -0.7761358618736267, mean p set: 0.45200681686401367
loss_pred:0.023522475734353065, decouple_loss:0.007839368656277657
The modified gen p mean: 0.45079857110977173, gen p mean: -0.7843663096427917, mean p set: 0.4512788653373718
loss_pred:0.024459900334477425, decouple_loss:0.008093218319118023
Iteration: 2762, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45083943009376526, gen p mean: -0.7790333032608032, mean p set: 0.45131972432136536
The modified gen p mean: 0.45123812556266785, gen p mean: -0.7751893997192383, mean p set: 0.45171838998794556
The modified gen p mean: 0.45133915543556213, gen p mean: -0.7820371985435486, mean p set: 0.45181941986083984
loss_pred:0.024250056594610214, decouple_loss:0.007459357846528292
loss_pred:0.02401977777481079, decouple_loss:0.007339015603065491
loss_pred:0.0243031308054924, decouple_loss:0.00782980490475893
Iteration: 2763, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45123663544654846, gen p mean: -0.7730635404586792, mean p set: 0.45171689987182617
The modified gen p mean: 0.4521564841270447, gen p mean: -0.7772582769393921, mean p set: 0.4526367783546448
The modified gen p mean: 0.4515971541404724, gen p mean: -0.7978656888008118, mean p set: 0.4520774185657501
loss_pred:0.024703247472643852, decouple_loss:0.007728263735771179
loss_pred:0.023511389270424843, decouple_loss:0.007894325070083141
loss_pred:0.023975688964128494, decouple_loss:0.008385657332837582
Iteration: 2764, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514846205711365, gen p mean: -0.7925994992256165, mean p set: 0.4519648849964142
The modified gen p mean: 0.4526425898075104, gen p mean: -0.7888377904891968, mean p set: 0.4531228840351105
The modified gen p mean: 0.4521265923976898, gen p mean: -0.7786376476287842, mean p set: 0.4526068866252899
loss_pred:0.02432183362543583, decouple_loss:0.007687295321375132
loss_pred:0.02397131733596325, decouple_loss:0.007772502955049276
loss_pred:0.024003980681300163, decouple_loss:0.007674872875213623
Iteration: 2765, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516814053058624, gen p mean: -0.7773025631904602, mean p set: 0.4521616995334625
The modified gen p mean: 0.4519748389720917, gen p mean: -0.7739751935005188, mean p set: 0.4524551033973694
The modified gen p mean: 0.45076414942741394, gen p mean: -0.7790184617042542, mean p set: 0.45124444365501404
loss_pred:0.02363819070160389, decouple_loss:0.007495046127587557
loss_pred:0.02369791828095913, decouple_loss:0.007937599904835224
loss_pred:0.024718396365642548, decouple_loss:0.00795752927660942
Iteration: 2766, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513283371925354, gen p mean: -0.7825290560722351, mean p set: 0.4518086314201355
The modified gen p mean: 0.4515432119369507, gen p mean: -0.76795494556427, mean p set: 0.4520235061645508
The modified gen p mean: 0.45164602994918823, gen p mean: -0.7696006298065186, mean p set: 0.45212632417678833
loss_pred:0.024506542831659317, decouple_loss:0.008009260520339012
loss_pred:0.022948499768972397, decouple_loss:0.0076088979840278625
loss_pred:0.022666065022349358, decouple_loss:0.007509442046284676
Iteration: 2767, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521545469760895, gen p mean: -0.7855620980262756, mean p set: 0.4526348412036896
The modified gen p mean: 0.45261451601982117, gen p mean: -0.78080153465271, mean p set: 0.45309484004974365
The modified gen p mean: 0.45115646719932556, gen p mean: -0.7792778015136719, mean p set: 0.45163676142692566
loss_pred:0.024216894060373306, decouple_loss:0.007747024297714233
loss_pred:0.02321174554526806, decouple_loss:0.0075087458826601505
loss_pred:0.023509178310632706, decouple_loss:0.007535356096923351
Iteration: 2768, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505007266998291, gen p mean: -0.7874622344970703, mean p set: 0.4509810209274292The modified gen p mean: 0.45091116428375244, gen p mean: -0.7749066352844238, mean p set: 0.4513914883136749
The modified gen p mean: 0.4523485600948334, gen p mean: -0.770971953868866, mean p set: 0.45282885432243347
loss_pred:0.023296380415558815, decouple_loss:0.007534078322350979loss_pred:0.024525877088308334, decouple_loss:0.007369013968855143
loss_pred:0.023123756051063538, decouple_loss:0.007331268861889839
Iteration: 2769, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45112499594688416, gen p mean: -0.7806255221366882, mean p set: 0.45160529017448425
The modified gen p mean: 0.45130497217178345, gen p mean: -0.7915331125259399, mean p set: 0.45178526639938354
The modified gen p mean: 0.451076865196228, gen p mean: -0.7831473350524902, mean p set: 0.45155712962150574
loss_pred:0.023681391030550003, decouple_loss:0.007372230291366577
loss_pred:0.02423691190779209, decouple_loss:0.007494073826819658
loss_pred:0.023273315280675888, decouple_loss:0.00738838454708457
Iteration: 2770, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45120954513549805, gen p mean: -0.7862975597381592, mean p set: 0.45168986916542053
The modified gen p mean: 0.4516487717628479, gen p mean: -0.7940506935119629, mean p set: 0.4521290957927704
The modified gen p mean: 0.4500911235809326, gen p mean: -0.7923440337181091, mean p set: 0.4505713880062103
loss_pred:0.023378655314445496, decouple_loss:0.007299245335161686
loss_pred:0.022897569462656975, decouple_loss:0.007049784995615482
loss_pred:0.023702014237642288, decouple_loss:0.007321991492062807
2023-05-03 08:50:37 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7968259453773499, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.8048650622367859, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7923008799552917, mean p set: 0.45035696029663086
loss_pred:0.025058431550860405, decouple_loss:0.007994396612048149
loss_pred:0.02616361528635025, decouple_loss:0.008156195282936096
loss_pred:0.02471284009516239, decouple_loss:0.008013635873794556
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025714365765452385, avg_mse: 0.03129293769598007
current test mse: 0.031293
Iteration: 2771, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45202162861824036, gen p mean: -0.8003154397010803, mean p set: 0.45250189304351807
The modified gen p mean: 0.4511992931365967, gen p mean: -0.7953704595565796, mean p set: 0.4516795575618744
loss_pred:0.023215848952531815, decouple_loss:0.007537395227700472
loss_pred:0.02379670739173889, decouple_loss:0.007092997431755066
The modified gen p mean: 0.45068275928497314, gen p mean: -0.798691987991333, mean p set: 0.45116302371025085
loss_pred:0.024555377662181854, decouple_loss:0.007327905390411615
Iteration: 2772, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533770978450775, gen p mean: -0.8000128269195557, mean p set: 0.453857421875
The modified gen p mean: 0.4529801309108734, gen p mean: -0.8054978251457214, mean p set: 0.4534603953361511
The modified gen p mean: 0.4518086910247803, gen p mean: -0.7980788946151733, mean p set: 0.452288955450058
loss_pred:0.022961441427469254, decouple_loss:0.007629845757037401
loss_pred:0.023027602583169937, decouple_loss:0.007482850458472967
loss_pred:0.023156320676207542, decouple_loss:0.007661321200430393
Iteration: 2773, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45352527499198914, gen p mean: -0.7810512781143188, mean p set: 0.45400553941726685
The modified gen p mean: 0.45081254839897156, gen p mean: -0.7878608703613281, mean p set: 0.45129284262657166
The modified gen p mean: 0.45055311918258667, gen p mean: -0.8030533194541931, mean p set: 0.45103341341018677
loss_pred:0.02313353680074215, decouple_loss:0.007360889110714197
loss_pred:0.023624567314982414, decouple_loss:0.006940709426999092
loss_pred:0.02363414503633976, decouple_loss:0.007063386961817741
Iteration: 2774, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45144495368003845, gen p mean: -0.8060066103935242, mean p set: 0.45192527770996094
The modified gen p mean: 0.45398658514022827, gen p mean: -0.7788318395614624, mean p set: 0.45446687936782837
The modified gen p mean: 0.45059406757354736, gen p mean: -0.7857468724250793, mean p set: 0.45107436180114746
loss_pred:0.02407173626124859, decouple_loss:0.007928340695798397
loss_pred:0.023174801841378212, decouple_loss:0.007238427642732859
loss_pred:0.023475874215364456, decouple_loss:0.007060952018946409
Iteration: 2775, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508376121520996, gen p mean: -0.7888258099555969, mean p set: 0.4513179063796997
The modified gen p mean: 0.4513355493545532, gen p mean: -0.7872599959373474, mean p set: 0.4518158733844757
The modified gen p mean: 0.45086491107940674, gen p mean: -0.7840989232063293, mean p set: 0.45134520530700684
loss_pred:0.024381492286920547, decouple_loss:0.007141204550862312
loss_pred:0.023953549563884735, decouple_loss:0.007249174173921347
loss_pred:0.023849936202168465, decouple_loss:0.006964769680052996
Iteration: 2776, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45036500692367554, gen p mean: -0.7951083779335022, mean p set: 0.45084527134895325
The modified gen p mean: 0.45364895462989807, gen p mean: -0.7889994978904724, mean p set: 0.45412924885749817
The modified gen p mean: 0.45128318667411804, gen p mean: -0.7901319861412048, mean p set: 0.4517635107040405
loss_pred:0.02446935512125492, decouple_loss:0.0068929134868085384
loss_pred:0.023248523473739624, decouple_loss:0.0070733241736888885
loss_pred:0.023104406893253326, decouple_loss:0.007042359560728073
Iteration: 2777, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503172039985657, gen p mean: -0.798458456993103, mean p set: 0.45079749822616577
The modified gen p mean: 0.45170262455940247, gen p mean: -0.7980250716209412, mean p set: 0.45218291878700256
The modified gen p mean: 0.4534478485584259, gen p mean: -0.7883036136627197, mean p set: 0.4539281725883484
loss_pred:0.023853469640016556, decouple_loss:0.007393605075776577
loss_pred:0.024067364633083344, decouple_loss:0.0070541659370064735
loss_pred:0.023196572437882423, decouple_loss:0.0071833510883152485
Iteration: 2778, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45175886154174805, gen p mean: -0.7847563028335571, mean p set: 0.45223915576934814
The modified gen p mean: 0.4528735876083374, gen p mean: -0.7905927896499634, mean p set: 0.4533538818359375
The modified gen p mean: 0.45204201340675354, gen p mean: -0.8135693669319153, mean p set: 0.45252230763435364
loss_pred:0.023706398904323578, decouple_loss:0.0071324934251606464
loss_pred:0.0230129212141037, decouple_loss:0.007164370734244585
loss_pred:0.023824209347367287, decouple_loss:0.007572669070214033
Iteration: 2779, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516104459762573, gen p mean: -0.7884677052497864, mean p set: 0.4520907402038574
The modified gen p mean: 0.4532676935195923, gen p mean: -0.7859094142913818, mean p set: 0.45374795794487
The modified gen p mean: 0.45145851373672485, gen p mean: -0.7871175408363342, mean p set: 0.45193883776664734
loss_pred:0.023391634225845337, decouple_loss:0.00712501211091876
loss_pred:0.023318668827414513, decouple_loss:0.007337227463722229
loss_pred:0.024076156318187714, decouple_loss:0.00704469857737422
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 2780, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794172048568726, gen p mean: -0.7903931736946106, mean p set: 0.4484219551086426
The modified gen p mean: 0.4495750963687897, gen p mean: -0.8034132122993469, mean p set: 0.45005539059638977
The modified gen p mean: 0.44894957542419434, gen p mean: -0.8078504800796509, mean p set: 0.44942986965179443
loss_pred:0.02512689307332039, decouple_loss:0.008013877086341381
loss_pred:0.026283031329512596, decouple_loss:0.00799938477575779
loss_pred:0.026073534041643143, decouple_loss:0.007739285007119179
2023-05-03 08:55:21 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7974012494087219, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.8048577308654785, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987669587135315, gen p mean: -0.7932472229003906, mean p set: 0.45035696029663086
loss_pred:0.024901967495679855, decouple_loss:0.0075425636023283005
loss_pred:0.02600608393549919, decouple_loss:0.007580494042485952
loss_pred:0.02460552379488945, decouple_loss:0.007482179440557957
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025547947734594345, avg_mse: 0.031116606667637825
current test mse: 0.031117
Iteration: 2781, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491555094718933, gen p mean: -0.8052989840507507, mean p set: 0.4496358335018158
The modified gen p mean: 0.4489286243915558, gen p mean: -0.8026866316795349, mean p set: 0.4494089186191559
loss_pred:0.02534639462828636, decouple_loss:0.0076407091692090034
loss_pred:0.025452814996242523, decouple_loss:0.00785215012729168
The modified gen p mean: 0.4478198289871216, gen p mean: -0.8021512031555176, mean p set: 0.4483001232147217
loss_pred:0.025979384779930115, decouple_loss:0.0077058421447873116
Iteration: 2782, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44782623648643494, gen p mean: -0.8092329502105713, mean p set: 0.44830653071403503
The modified gen p mean: 0.4486387073993683, gen p mean: -0.8068332672119141, mean p set: 0.44911903142929077
The modified gen p mean: 0.4483850598335266, gen p mean: -0.8050640225410461, mean p set: 0.4488653242588043
loss_pred:0.02547553926706314, decouple_loss:0.00756608322262764
loss_pred:0.025816820561885834, decouple_loss:0.007428521756082773
loss_pred:0.025022584944963455, decouple_loss:0.0072393896989524364
Iteration: 2783, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492451846599579, gen p mean: -0.8110736012458801, mean p set: 0.44972550868988037
The modified gen p mean: 0.4485247731208801, gen p mean: -0.8155385851860046, mean p set: 0.4490050673484802
The modified gen p mean: 0.4479732811450958, gen p mean: -0.8159807920455933, mean p set: 0.4484536051750183
loss_pred:0.025487694889307022, decouple_loss:0.007222755346447229
loss_pred:0.026005655527114868, decouple_loss:0.007588095497339964
loss_pred:0.0262516587972641, decouple_loss:0.007522988598793745
Iteration: 2784, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488207697868347, gen p mean: -0.8142989873886108, mean p set: 0.4493010640144348
The modified gen p mean: 0.44952592253685, gen p mean: -0.8230695128440857, mean p set: 0.4500062167644501
The modified gen p mean: 0.4477930963039398, gen p mean: -0.8052435517311096, mean p set: 0.4482733905315399
loss_pred:0.025420039892196655, decouple_loss:0.007434075232595205
loss_pred:0.02573053538799286, decouple_loss:0.007432227022945881
loss_pred:0.025803016498684883, decouple_loss:0.007261162623763084
Iteration: 2785, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493986666202545, gen p mean: -0.8086846470832825, mean p set: 0.4498789310455322
The modified gen p mean: 0.4484134316444397, gen p mean: -0.8158285617828369, mean p set: 0.4488937258720398
The modified gen p mean: 0.4486866891384125, gen p mean: -0.8004915714263916, mean p set: 0.4491669833660126
loss_pred:0.025349318981170654, decouple_loss:0.007569082081317902
loss_pred:0.026100991293787956, decouple_loss:0.007792073767632246
loss_pred:0.024911468848586082, decouple_loss:0.0072577218525111675
Iteration: 2786, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491564631462097, gen p mean: -0.80372154712677, mean p set: 0.4496367573738098
The modified gen p mean: 0.4494485557079315, gen p mean: -0.7997681498527527, mean p set: 0.449928879737854
The modified gen p mean: 0.44908517599105835, gen p mean: -0.8013162612915039, mean p set: 0.44956550002098083
loss_pred:0.02449122443795204, decouple_loss:0.007090417202562094
loss_pred:0.02516154572367668, decouple_loss:0.007160328794270754
loss_pred:0.025458576157689095, decouple_loss:0.0072257379069924355
Iteration: 2787, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490557909011841, gen p mean: -0.8031570315361023, mean p set: 0.4495360851287842
The modified gen p mean: 0.449418306350708, gen p mean: -0.7956668734550476, mean p set: 0.4498986005783081
The modified gen p mean: 0.4489731192588806, gen p mean: -0.7954230308532715, mean p set: 0.4494534134864807
loss_pred:0.025871554389595985, decouple_loss:0.0073879617266356945
loss_pred:0.025487631559371948, decouple_loss:0.007288645021617413
loss_pred:0.024409757927060127, decouple_loss:0.007265603169798851
Iteration: 2788, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493795335292816, gen p mean: -0.7951754927635193, mean p set: 0.4498598277568817
The modified gen p mean: 0.4481603503227234, gen p mean: -0.7974261045455933, mean p set: 0.4486406445503235
The modified gen p mean: 0.4491133987903595, gen p mean: -0.7901602387428284, mean p set: 0.4495936930179596
loss_pred:0.024256180971860886, decouple_loss:0.007241204846650362
loss_pred:0.02610810473561287, decouple_loss:0.007294018752872944
loss_pred:0.024886058643460274, decouple_loss:0.007211131975054741
Iteration: 2789, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797804951667786, gen p mean: -0.7902920246124268, mean p set: 0.44845834374427795
The modified gen p mean: 0.4486974775791168, gen p mean: -0.7910344004631042, mean p set: 0.44917774200439453
The modified gen p mean: 0.4491598606109619, gen p mean: -0.7900651097297668, mean p set: 0.4496401250362396
loss_pred:0.025125151500105858, decouple_loss:0.0070448024198412895
loss_pred:0.025571556761860847, decouple_loss:0.007009168155491352
loss_pred:0.0250959862023592, decouple_loss:0.007052872329950333
Iteration: 2790, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484595060348511, gen p mean: -0.7845253944396973, mean p set: 0.4489397704601288
The modified gen p mean: 0.4489569664001465, gen p mean: -0.7891097664833069, mean p set: 0.4494372606277466
The modified gen p mean: 0.44877132773399353, gen p mean: -0.7899325489997864, mean p set: 0.44925159215927124
loss_pred:0.024547357112169266, decouple_loss:0.007075469940900803
loss_pred:0.025051089003682137, decouple_loss:0.007172520738095045
loss_pred:0.02485363744199276, decouple_loss:0.007141261827200651
2023-05-03 08:59:04 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7847151160240173, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7772942185401917, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7737472653388977, mean p set: 0.45035696029663086
loss_pred:0.02566884271800518, decouple_loss:0.007417040411382914
loss_pred:0.024741481989622116, decouple_loss:0.0070260860957205296
loss_pred:0.024507490918040276, decouple_loss:0.007198844105005264
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025333305820822716, avg_mse: 0.030760178342461586
current test mse: 0.03076
Iteration: 2791, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475438594818115, gen p mean: -0.781339168548584, mean p set: 0.4480241537094116
loss_pred:0.025829924270510674, decouple_loss:0.0070015015080571175
The modified gen p mean: 0.449386328458786, gen p mean: -0.7837446928024292, mean p set: 0.4498666524887085
loss_pred:0.02551979571580887, decouple_loss:0.006989454384893179
The modified gen p mean: 0.4482795000076294, gen p mean: -0.7781150341033936, mean p set: 0.4487597644329071
loss_pred:0.025691790506243706, decouple_loss:0.0068659596145153046
Iteration: 2792, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788870215415955, gen p mean: -0.7733266949653625, mean p set: 0.44836896657943726
The modified gen p mean: 0.4480970501899719, gen p mean: -0.7829206585884094, mean p set: 0.448577344417572
The modified gen p mean: 0.4492949843406677, gen p mean: -0.782256543636322, mean p set: 0.4497752785682678
loss_pred:0.02602488175034523, decouple_loss:0.006945817265659571
loss_pred:0.024623608216643333, decouple_loss:0.006891258992254734
loss_pred:0.024052323773503304, decouple_loss:0.007202577777206898
Iteration: 2793, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481983184814453, gen p mean: -0.7940181493759155, mean p set: 0.4486786425113678
The modified gen p mean: 0.4488867223262787, gen p mean: -0.7886006236076355, mean p set: 0.4493670165538788
The modified gen p mean: 0.4473295211791992, gen p mean: -0.7869020700454712, mean p set: 0.4478098452091217
loss_pred:0.02605169266462326, decouple_loss:0.007158869411796331
loss_pred:0.0240226611495018, decouple_loss:0.0067237066105008125
loss_pred:0.02596447244286537, decouple_loss:0.006794324144721031
Iteration: 2794, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44903847575187683, gen p mean: -0.7877714037895203, mean p set: 0.44951876997947693
The modified gen p mean: 0.44813117384910583, gen p mean: -0.7807758450508118, mean p set: 0.4486114978790283
The modified gen p mean: 0.44899260997772217, gen p mean: -0.7914469242095947, mean p set: 0.44947290420532227
loss_pred:0.02508310228586197, decouple_loss:0.00683086970821023
loss_pred:0.025520844385027885, decouple_loss:0.006908278446644545
loss_pred:0.024430381134152412, decouple_loss:0.006895467638969421
Iteration: 2795, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494834542274475, gen p mean: -0.797111988067627, mean p set: 0.4499637186527252
The modified gen p mean: 0.44853857159614563, gen p mean: -0.7896828651428223, mean p set: 0.44901883602142334
The modified gen p mean: 0.44856327772140503, gen p mean: -0.7966458201408386, mean p set: 0.4490435719490051
loss_pred:0.024787483736872673, decouple_loss:0.006831776816397905
loss_pred:0.024233363568782806, decouple_loss:0.006787244696170092
loss_pred:0.024749157950282097, decouple_loss:0.006850721780210733
Iteration: 2796, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819584488868713, gen p mean: -0.7898755073547363, mean p set: 0.4486761689186096
The modified gen p mean: 0.44886156916618347, gen p mean: -0.7902269959449768, mean p set: 0.44934189319610596
The modified gen p mean: 0.4490394592285156, gen p mean: -0.7939037084579468, mean p set: 0.44951972365379333
loss_pred:0.024801062420010567, decouple_loss:0.006546869874000549
loss_pred:0.025029823184013367, decouple_loss:0.006453126203268766
loss_pred:0.024600310251116753, decouple_loss:0.006643269676715136
Iteration: 2797, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489580988883972, gen p mean: -0.7850415110588074, mean p set: 0.4494384229183197
The modified gen p mean: 0.4483930170536041, gen p mean: -0.7906874418258667, mean p set: 0.4488733410835266
The modified gen p mean: 0.4475499987602234, gen p mean: -0.7914431691169739, mean p set: 0.4480302929878235
loss_pred:0.024159297347068787, decouple_loss:0.006643733009696007
loss_pred:0.02509572170674801, decouple_loss:0.006703753490000963
loss_pred:0.02520541287958622, decouple_loss:0.006797684822231531
Iteration: 2798, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751986861228943, gen p mean: -0.7900719046592712, mean p set: 0.4480001628398895
The modified gen p mean: 0.44813087582588196, gen p mean: -0.789228618144989, mean p set: 0.44861117005348206
The modified gen p mean: 0.4486227035522461, gen p mean: -0.7930024862289429, mean p set: 0.4491029977798462
loss_pred:0.025736739858984947, decouple_loss:0.006535401102155447
loss_pred:0.024921689182519913, decouple_loss:0.006569925229996443
loss_pred:0.024998988956212997, decouple_loss:0.006709021516144276
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2799, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487845003604889, gen p mean: -0.79231196641922, mean p set: 0.4492647647857666
The modified gen p mean: 0.4494735300540924, gen p mean: -0.7913645505905151, mean p set: 0.4499538242816925
The modified gen p mean: 0.4480119049549103, gen p mean: -0.7928619384765625, mean p set: 0.448492169380188
loss_pred:0.02397824265062809, decouple_loss:0.006404590327292681
loss_pred:0.02496892772614956, decouple_loss:0.0066454652696847916
loss_pred:0.02576264552772045, decouple_loss:0.006789863109588623
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 2800, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493885040283203, gen p mean: -0.7868071794509888, mean p set: 0.4498688280582428
The modified gen p mean: 0.44821345806121826, gen p mean: -0.7907640933990479, mean p set: 0.44869375228881836
The modified gen p mean: 0.4488052427768707, gen p mean: -0.7929025888442993, mean p set: 0.4492855668067932
loss_pred:0.02479712851345539, decouple_loss:0.006703611463308334
loss_pred:0.02450413815677166, decouple_loss:0.007195213809609413
loss_pred:0.024919738993048668, decouple_loss:0.0073319426737725735
2023-05-03 09:03:42 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7869506478309631, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7936294674873352, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7828425765037537, mean p set: 0.45035696029663086
loss_pred:0.024549013003706932, decouple_loss:0.006683834828436375
loss_pred:0.02560587041079998, decouple_loss:0.006949417758733034
loss_pred:0.02440178580582142, decouple_loss:0.006762727629393339
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025192156434059143, avg_mse: 0.030581751838326454
current test mse: 0.030582
Iteration: 2801, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480617344379425, gen p mean: -0.7880573272705078, mean p set: 0.4485420286655426
loss_pred:0.025611381977796555, decouple_loss:0.007332340814173222
The modified gen p mean: 0.4497413635253906, gen p mean: -0.7815078496932983, mean p set: 0.4502216577529907
loss_pred:0.02581724151968956, decouple_loss:0.006914656609296799
The modified gen p mean: 0.44889312982559204, gen p mean: -0.7875775098800659, mean p set: 0.44937342405319214
loss_pred:0.02462906204164028, decouple_loss:0.006929021328687668
Iteration: 2802, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745132327079773, gen p mean: -0.7807585000991821, mean p set: 0.4479316174983978
The modified gen p mean: 0.44853872060775757, gen p mean: -0.7857808470726013, mean p set: 0.44901901483535767
The modified gen p mean: 0.44679591059684753, gen p mean: -0.7829943299293518, mean p set: 0.44727620482444763
loss_pred:0.025011766701936722, decouple_loss:0.006814989726990461
loss_pred:0.025600923225283623, decouple_loss:0.007236040662974119
loss_pred:0.02438350021839142, decouple_loss:0.006616233382374048
Iteration: 2803, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702979922294617, gen p mean: -0.7935975193977356, mean p set: 0.4475100636482239
The modified gen p mean: 0.447870135307312, gen p mean: -0.7951048016548157, mean p set: 0.4483504593372345
The modified gen p mean: 0.44872400164604187, gen p mean: -0.7987659573554993, mean p set: 0.4492042660713196
loss_pred:0.024304717779159546, decouple_loss:0.006861288566142321
loss_pred:0.02540876716375351, decouple_loss:0.007228891830891371
loss_pred:0.023997027426958084, decouple_loss:0.007086186204105616
Iteration: 2804, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486349821090698, gen p mean: -0.7959112524986267, mean p set: 0.4491152763366699
The modified gen p mean: 0.4489864110946655, gen p mean: -0.7948032021522522, mean p set: 0.4494667053222656
The modified gen p mean: 0.4481697380542755, gen p mean: -0.7896183133125305, mean p set: 0.448650062084198
loss_pred:0.023893119767308235, decouple_loss:0.006717412732541561
loss_pred:0.024605287238955498, decouple_loss:0.007112589199095964
loss_pred:0.025553176179528236, decouple_loss:0.0069946469739079475
Iteration: 2805, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44936540722846985, gen p mean: -0.791863203048706, mean p set: 0.44984567165374756
The modified gen p mean: 0.447664350271225, gen p mean: -0.7817067503929138, mean p set: 0.4481446146965027
The modified gen p mean: 0.44682058691978455, gen p mean: -0.7820228934288025, mean p set: 0.44730088114738464
loss_pred:0.025236500427126884, decouple_loss:0.007102638017386198
loss_pred:0.025434089824557304, decouple_loss:0.00677094142884016
loss_pred:0.02446112595498562, decouple_loss:0.006897584535181522
Iteration: 2806, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480254054069519, gen p mean: -0.780680775642395, mean p set: 0.448505699634552
The modified gen p mean: 0.4481566250324249, gen p mean: -0.781912624835968, mean p set: 0.44863688945770264
The modified gen p mean: 0.44846776127815247, gen p mean: -0.7818613648414612, mean p set: 0.44894805550575256
loss_pred:0.02458839863538742, decouple_loss:0.006516206543892622
loss_pred:0.02422790601849556, decouple_loss:0.0066869002766907215
loss_pred:0.025491533800959587, decouple_loss:0.006781584117561579
Iteration: 2807, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44843611121177673, gen p mean: -0.7822585701942444, mean p set: 0.44891637563705444
The modified gen p mean: 0.44832900166511536, gen p mean: -0.7767994999885559, mean p set: 0.44880932569503784
The modified gen p mean: 0.4482167959213257, gen p mean: -0.7825786471366882, mean p set: 0.4486970603466034
loss_pred:0.02430579997599125, decouple_loss:0.006731689441949129
loss_pred:0.024738285690546036, decouple_loss:0.006617904175072908
loss_pred:0.025282200425863266, decouple_loss:0.006955952383577824
Iteration: 2808, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44690391421318054, gen p mean: -0.7736955881118774, mean p set: 0.44738414883613586
The modified gen p mean: 0.4488731920719147, gen p mean: -0.7824099659919739, mean p set: 0.44935348629951477
The modified gen p mean: 0.448375940322876, gen p mean: -0.7812888622283936, mean p set: 0.4488562345504761
loss_pred:0.02478468045592308, decouple_loss:0.006558653898537159
loss_pred:0.02511117234826088, decouple_loss:0.006750002037733793
loss_pred:0.024695370346307755, decouple_loss:0.006598830223083496
Iteration: 2809, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481416642665863, gen p mean: -0.7791048884391785, mean p set: 0.448621928691864
The modified gen p mean: 0.45050033926963806, gen p mean: -0.783933162689209, mean p set: 0.45098060369491577
The modified gen p mean: 0.4477349817752838, gen p mean: -0.7746925354003906, mean p set: 0.4482152760028839
loss_pred:0.025470025837421417, decouple_loss:0.006934681907296181
loss_pred:0.024789560586214066, decouple_loss:0.007236473727971315
loss_pred:0.025646595284342766, decouple_loss:0.0070076510310173035
Iteration: 2810, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815993309020996, gen p mean: -0.7749223113059998, mean p set: 0.44864022731781006
The modified gen p mean: 0.44841331243515015, gen p mean: -0.7842537760734558, mean p set: 0.44889357686042786
The modified gen p mean: 0.44761529564857483, gen p mean: -0.7730398774147034, mean p set: 0.4480955898761749
loss_pred:0.025435779243707657, decouple_loss:0.0068941800855100155
loss_pred:0.024122050032019615, decouple_loss:0.006483261473476887
loss_pred:0.025550222024321556, decouple_loss:0.006695258896797895
2023-05-03 09:07:23 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7824123501777649, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.7890800833702087, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7784630656242371, mean p set: 0.45035696029663086
loss_pred:0.024690696969628334, decouple_loss:0.006720372941344976
loss_pred:0.02578614093363285, decouple_loss:0.006941653788089752
loss_pred:0.024523038417100906, decouple_loss:0.006721885409206152
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02533969096839428, avg_mse: 0.030886489897966385
current test mse: 0.030886
Iteration: 2811, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505738615989685, gen p mean: -0.7816562056541443, mean p set: 0.4510541558265686
The modified gen p mean: 0.44824090600013733, gen p mean: -0.7762234807014465, mean p set: 0.44872117042541504
loss_pred:0.025030946359038353, decouple_loss:0.00684145325794816
loss_pred:0.025472231209278107, decouple_loss:0.006457621231675148
The modified gen p mean: 0.4477507472038269, gen p mean: -0.7732816934585571, mean p set: 0.448231041431427
loss_pred:0.025142867118120193, decouple_loss:0.006902893073856831
Iteration: 2812, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449165403842926, gen p mean: -0.7894301414489746, mean p set: 0.4496456980705261
The modified gen p mean: 0.4490513205528259, gen p mean: -0.7853537201881409, mean p set: 0.449531614780426
The modified gen p mean: 0.4493597447872162, gen p mean: -0.7777005434036255, mean p set: 0.44984006881713867
loss_pred:0.024423062801361084, decouple_loss:0.007246092427521944
loss_pred:0.025167107582092285, decouple_loss:0.006841560360044241
loss_pred:0.026018012315034866, decouple_loss:0.006840711459517479
Iteration: 2813, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44833943247795105, gen p mean: -0.7809369564056396, mean p set: 0.44881969690322876
The modified gen p mean: 0.44884786009788513, gen p mean: -0.7877673506736755, mean p set: 0.44932815432548523
The modified gen p mean: 0.4480161666870117, gen p mean: -0.7838209271430969, mean p set: 0.4484964609146118
loss_pred:0.025468505918979645, decouple_loss:0.006629468407481909
loss_pred:0.024118946865200996, decouple_loss:0.006650532595813274
loss_pred:0.024012653157114983, decouple_loss:0.00680572958663106
Iteration: 2814, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474274516105652, gen p mean: -0.7818372845649719, mean p set: 0.4479077458381653
The modified gen p mean: 0.4490232765674591, gen p mean: -0.7876175045967102, mean p set: 0.4495035707950592
The modified gen p mean: 0.4476427733898163, gen p mean: -0.7882716059684753, mean p set: 0.4481230676174164
loss_pred:0.0252985879778862, decouple_loss:0.007195684593170881
loss_pred:0.02438773401081562, decouple_loss:0.006830951198935509
loss_pred:0.025777729228138924, decouple_loss:0.007239433005452156
Iteration: 2815, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795912504196167, gen p mean: -0.7847719192504883, mean p set: 0.44843941926956177
The modified gen p mean: 0.4476039409637451, gen p mean: -0.7843644618988037, mean p set: 0.4480842351913452
The modified gen p mean: 0.4489331543445587, gen p mean: -0.7917528748512268, mean p set: 0.4494134187698364
loss_pred:0.024691488593816757, decouple_loss:0.0069350325502455235
loss_pred:0.024007325991988182, decouple_loss:0.006840309128165245
loss_pred:0.02360583283007145, decouple_loss:0.007049298845231533
Iteration: 2816, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481634199619293, gen p mean: -0.7817503213882446, mean p set: 0.4486437141895294
The modified gen p mean: 0.44854143261909485, gen p mean: -0.7743059396743774, mean p set: 0.44902175664901733
The modified gen p mean: 0.4489436149597168, gen p mean: -0.7766474485397339, mean p set: 0.4494239091873169
loss_pred:0.024476533755660057, decouple_loss:0.007203205022960901
loss_pred:0.02535455860197544, decouple_loss:0.007082252763211727
loss_pred:0.024601608514785767, decouple_loss:0.006863565184175968
Iteration: 2817, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484662711620331, gen p mean: -0.7755866646766663, mean p set: 0.4489465653896332
The modified gen p mean: 0.44775041937828064, gen p mean: -0.7763170003890991, mean p set: 0.44823071360588074
The modified gen p mean: 0.44823938608169556, gen p mean: -0.7821224331855774, mean p set: 0.44871968030929565
loss_pred:0.024088747799396515, decouple_loss:0.006697311066091061
loss_pred:0.02523862011730671, decouple_loss:0.007022611331194639
loss_pred:0.024429399520158768, decouple_loss:0.006609442178159952
Iteration: 2818, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474150538444519, gen p mean: -0.7803295850753784, mean p set: 0.4478953182697296
The modified gen p mean: 0.4484531581401825, gen p mean: -0.7813572883605957, mean p set: 0.4489334523677826
The modified gen p mean: 0.44844579696655273, gen p mean: -0.7777603268623352, mean p set: 0.44892609119415283
loss_pred:0.024232899770140648, decouple_loss:0.006640396546572447
loss_pred:0.02454991824924946, decouple_loss:0.006797734647989273
loss_pred:0.02423432096838951, decouple_loss:0.006607938092201948
Iteration: 2819, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44861480593681335, gen p mean: -0.7816770672798157, mean p set: 0.44909510016441345
The modified gen p mean: 0.4472508430480957, gen p mean: -0.7882224321365356, mean p set: 0.4477311074733734
The modified gen p mean: 0.4472561478614807, gen p mean: -0.7929579019546509, mean p set: 0.4477364122867584
loss_pred:0.02486833557486534, decouple_loss:0.006652322132140398
loss_pred:0.02463037520647049, decouple_loss:0.006424791179597378
loss_pred:0.02548281103372574, decouple_loss:0.006667068228125572
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
NaN value num: 0
Iteration: 2820, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527140259742737, gen p mean: -0.7942608594894409, mean p set: 0.4531942903995514
The modified gen p mean: 0.4522453546524048, gen p mean: -0.7959566116333008, mean p set: 0.4527256488800049
The modified gen p mean: 0.4510827362537384, gen p mean: -0.7955495715141296, mean p set: 0.4515630006790161
loss_pred:0.024215757846832275, decouple_loss:0.00733586959540844
loss_pred:0.025564730167388916, decouple_loss:0.007865216583013535
loss_pred:0.024312041699886322, decouple_loss:0.00803069956600666

2023-05-03 09:11:59 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7998364567756653, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7934938669204712, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7897168397903442, mean p set: 0.45035696029663086
loss_pred:0.025764256715774536, decouple_loss:0.0071242935955524445
loss_pred:0.02464209869503975, decouple_loss:0.006865723058581352
loss_pred:0.024520210921764374, decouple_loss:0.006861268077045679
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025323044508695602, avg_mse: 0.030857698991894722
current test mse: 0.030858
Iteration: 2821, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45220547914505005, gen p mean: -0.793792724609375, mean p set: 0.45268580317497253
The modified gen p mean: 0.45104166865348816, gen p mean: -0.7931949496269226, mean p set: 0.45152196288108826
loss_pred:0.02528599090874195, decouple_loss:0.007667397614568472
loss_pred:0.024946242570877075, decouple_loss:0.008023872040212154
The modified gen p mean: 0.45249706506729126, gen p mean: -0.7872873544692993, mean p set: 0.45297735929489136
loss_pred:0.023487521335482597, decouple_loss:0.007824353873729706
Iteration: 2822, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45246726274490356, gen p mean: -0.7974866032600403, mean p set: 0.45294755697250366
The modified gen p mean: 0.45180991291999817, gen p mean: -0.7917588949203491, mean p set: 0.45229020714759827
The modified gen p mean: 0.45097970962524414, gen p mean: -0.778030514717102, mean p set: 0.45146000385284424
loss_pred:0.02362624555826187, decouple_loss:0.007414253428578377
loss_pred:0.025168294087052345, decouple_loss:0.007396364584565163
loss_pred:0.023742083460092545, decouple_loss:0.008097236044704914
Iteration: 2823, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521506130695343, gen p mean: -0.7952755689620972, mean p set: 0.4526309072971344
The modified gen p mean: 0.4543343782424927, gen p mean: -0.7930085062980652, mean p set: 0.4548146724700928
The modified gen p mean: 0.45271334052085876, gen p mean: -0.7870373725891113, mean p set: 0.45319366455078125
loss_pred:0.02438480034470558, decouple_loss:0.007710738107562065
loss_pred:0.023879170417785645, decouple_loss:0.007844972424209118
loss_pred:0.022542981430888176, decouple_loss:0.007281702011823654
Iteration: 2824, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515138268470764, gen p mean: -0.79114830493927, mean p set: 0.4519941210746765
The modified gen p mean: 0.4536548852920532, gen p mean: -0.7877101898193359, mean p set: 0.4541351795196533
The modified gen p mean: 0.4505383372306824, gen p mean: -0.7877276539802551, mean p set: 0.4510186016559601
loss_pred:0.024152128025889397, decouple_loss:0.0071317520923912525
loss_pred:0.02332351543009281, decouple_loss:0.007523554842919111
loss_pred:0.024642271921038628, decouple_loss:0.007329385261982679
Iteration: 2825, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528239965438843, gen p mean: -0.779137134552002, mean p set: 0.4533042907714844
The modified gen p mean: 0.4529424011707306, gen p mean: -0.7869980931282043, mean p set: 0.4534226953983307
The modified gen p mean: 0.453058660030365, gen p mean: -0.786058783531189, mean p set: 0.4535389542579651
loss_pred:0.023585040122270584, decouple_loss:0.007557273376733065
loss_pred:0.02346290647983551, decouple_loss:0.007228443399071693
loss_pred:0.023914119228720665, decouple_loss:0.007402313407510519
Iteration: 2826, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514199197292328, gen p mean: -0.7703251838684082, mean p set: 0.4519002437591553
The modified gen p mean: 0.4513583779335022, gen p mean: -0.7803794145584106, mean p set: 0.4518386423587799
The modified gen p mean: 0.4508441686630249, gen p mean: -0.7799704074859619, mean p set: 0.4513244330883026
loss_pred:0.023087188601493835, decouple_loss:0.007485328707844019
loss_pred:0.024778511375188828, decouple_loss:0.007259108126163483
loss_pred:0.025046898052096367, decouple_loss:0.007441828027367592
Iteration: 2827, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513258635997772, gen p mean: -0.7773618102073669, mean p set: 0.45180612802505493
The modified gen p mean: 0.4510240852832794, gen p mean: -0.7759569883346558, mean p set: 0.4515043795108795
The modified gen p mean: 0.4508156180381775, gen p mean: -0.7671599388122559, mean p set: 0.4512959122657776
loss_pred:0.024959228932857513, decouple_loss:0.007246040739119053
loss_pred:0.02499423734843731, decouple_loss:0.007611624430865049
loss_pred:0.02342277206480503, decouple_loss:0.0073352172039449215
Iteration: 2828, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45096471905708313, gen p mean: -0.7744932770729065, mean p set: 0.4514450132846832
The modified gen p mean: 0.45347917079925537, gen p mean: -0.7727231383323669, mean p set: 0.45395946502685547
The modified gen p mean: 0.45048320293426514, gen p mean: -0.7810565829277039, mean p set: 0.45096346735954285
loss_pred:0.024729734286665916, decouple_loss:0.00738900899887085
loss_pred:0.02356000430881977, decouple_loss:0.007311573717743158
loss_pred:0.025228170678019524, decouple_loss:0.0073507423512637615
Iteration: 2829, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511546194553375, gen p mean: -0.7849733829498291, mean p set: 0.4516349136829376
The modified gen p mean: 0.4506838619709015, gen p mean: -0.7682228684425354, mean p set: 0.4511641561985016
The modified gen p mean: 0.45134875178337097, gen p mean: -0.7759191393852234, mean p set: 0.45182904601097107
loss_pred:0.024920199066400528, decouple_loss:0.007045484147965908
loss_pred:0.02328835241496563, decouple_loss:0.007611458655446768
loss_pred:0.025710497051477432, decouple_loss:0.007346438709646463
Iteration: 2830, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45276230573654175, gen p mean: -0.7836605310440063, mean p set: 0.45324259996414185
The modified gen p mean: 0.4527190923690796, gen p mean: -0.7925904393196106, mean p set: 0.4531993865966797
The modified gen p mean: 0.4522641897201538, gen p mean: -0.7886168956756592, mean p set: 0.4527444541454315
loss_pred:0.022727301344275475, decouple_loss:0.0071801780723035336
loss_pred:0.023470895364880562, decouple_loss:0.007132259663194418
loss_pred:0.024281449615955353, decouple_loss:0.00684820581227541
2023-05-03 09:15:39 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7962874174118042, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7895022034645081, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.785641074180603, mean p set: 0.45035696029663086
loss_pred:0.025969894602894783, decouple_loss:0.008078478276729584
loss_pred:0.024749284610152245, decouple_loss:0.007746594026684761
loss_pred:0.024601787328720093, decouple_loss:0.007910966873168945
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025502590462565422, avg_mse: 0.031142324209213257
current test mse: 0.031142
Iteration: 2831, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516957700252533, gen p mean: -0.7932475805282593, mean p set: 0.4521760940551758
loss_pred:0.024526109918951988, decouple_loss:0.007473355159163475
The modified gen p mean: 0.4539129436016083, gen p mean: -0.7856799960136414, mean p set: 0.45439326763153076
loss_pred:0.023680193349719048, decouple_loss:0.007324622478336096
The modified gen p mean: 0.4522281885147095, gen p mean: -0.7871836423873901, mean p set: 0.45270848274230957
loss_pred:0.02455323375761509, decouple_loss:0.007395043969154358
Iteration: 2832, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513101279735565, gen p mean: -0.7802688479423523, mean p set: 0.4517904222011566
The modified gen p mean: 0.4511820375919342, gen p mean: -0.7838408946990967, mean p set: 0.4516623318195343
The modified gen p mean: 0.45169728994369507, gen p mean: -0.7861340641975403, mean p set: 0.4521775543689728
loss_pred:0.025778165087103844, decouple_loss:0.007332240231335163
loss_pred:0.024966593831777573, decouple_loss:0.0073693059384822845
loss_pred:0.024810636416077614, decouple_loss:0.006865174043923616
Iteration: 2833, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528367221355438, gen p mean: -0.7918352484703064, mean p set: 0.4533170461654663
The modified gen p mean: 0.4513746201992035, gen p mean: -0.7912060618400574, mean p set: 0.4518548846244812
The modified gen p mean: 0.4498565196990967, gen p mean: -0.7922254800796509, mean p set: 0.4503368139266968
loss_pred:0.02342855930328369, decouple_loss:0.007281867787241936
loss_pred:0.02478831447660923, decouple_loss:0.0070561994798481464
loss_pred:0.024563338607549667, decouple_loss:0.007135817315429449
Iteration: 2834, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45233041048049927, gen p mean: -0.7867895364761353, mean p set: 0.45281070470809937
The modified gen p mean: 0.4521689713001251, gen p mean: -0.7937747836112976, mean p set: 0.45264923572540283
The modified gen p mean: 0.45082202553749084, gen p mean: -0.7777106761932373, mean p set: 0.45130228996276855
loss_pred:0.02419700101017952, decouple_loss:0.007191997021436691
loss_pred:0.023729737848043442, decouple_loss:0.007243666797876358
loss_pred:0.023022864013910294, decouple_loss:0.007302450481802225
Iteration: 2835, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45056912302970886, gen p mean: -0.7772465944290161, mean p set: 0.4510493874549866
The modified gen p mean: 0.45270633697509766, gen p mean: -0.7917478680610657, mean p set: 0.45318663120269775
The modified gen p mean: 0.450749009847641, gen p mean: -0.7803720235824585, mean p set: 0.4512292742729187
loss_pred:0.026377461850643158, decouple_loss:0.007031026761978865
loss_pred:0.023285875096917152, decouple_loss:0.007120352238416672
loss_pred:0.02621123567223549, decouple_loss:0.00701500941067934
Iteration: 2836, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45227065682411194, gen p mean: -0.7791779637336731, mean p set: 0.45275095105171204
The modified gen p mean: 0.4539802670478821, gen p mean: -0.7872440218925476, mean p set: 0.45446059107780457
The modified gen p mean: 0.45211371779441833, gen p mean: -0.794246256351471, mean p set: 0.4525940418243408
loss_pred:0.022894330322742462, decouple_loss:0.007052320521324873
loss_pred:0.023070363327860832, decouple_loss:0.007157300133258104
loss_pred:0.02407355234026909, decouple_loss:0.0069612907245755196
Iteration: 2837, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524080753326416, gen p mean: -0.8003342747688293, mean p set: 0.4528883397579193
The modified gen p mean: 0.4520118534564972, gen p mean: -0.7951055765151978, mean p set: 0.4524921178817749
The modified gen p mean: 0.4522090256214142, gen p mean: -0.7938477396965027, mean p set: 0.4526892900466919
loss_pred:0.02397126331925392, decouple_loss:0.006857690401375294
loss_pred:0.023634212091565132, decouple_loss:0.007013382390141487
loss_pred:0.02427598647773266, decouple_loss:0.006649939343333244
Iteration: 2838, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509720802307129, gen p mean: -0.8009361624717712, mean p set: 0.451452374458313The modified gen p mean: 0.45221829414367676, gen p mean: -0.7979068756103516, mean p set: 0.45269855856895447
The modified gen p mean: 0.4508700668811798, gen p mean: -0.7947678565979004, mean p set: 0.4513503611087799
loss_pred:0.0232864897698164, decouple_loss:0.006791828665882349
loss_pred:0.02479393593966961, decouple_loss:0.006877799518406391
loss_pred:0.0253733079880476, decouple_loss:0.006874079816043377
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
NaN value num: 0
Iteration: 2839, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476652443408966, gen p mean: -0.8074195384979248, mean p set: 0.4481455683708191
The modified gen p mean: 0.4470103681087494, gen p mean: -0.8000596165657043, mean p set: 0.4474906623363495
The modified gen p mean: 0.4455741345882416, gen p mean: -0.8019205927848816, mean p set: 0.4460543990135193
loss_pred:0.02774595469236374, decouple_loss:0.007744398433715105
loss_pred:0.027408290654420853, decouple_loss:0.007904392667114735
loss_pred:0.025175100192427635, decouple_loss:0.007834535092115402
Iteration: 2840, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483351409435272, gen p mean: -0.8129735589027405, mean p set: 0.44881540536880493
The modified gen p mean: 0.44669753313064575, gen p mean: -0.8084381222724915, mean p set: 0.44717782735824585
The modified gen p mean: 0.4470619559288025, gen p mean: -0.8068163990974426, mean p set: 0.4475422501564026
loss_pred:0.026495492085814476, decouple_loss:0.00714602367952466
loss_pred:0.026081159710884094, decouple_loss:0.007398713380098343
loss_pred:0.026531141251325607, decouple_loss:0.0075947982259094715
2023-05-03 09:20:22 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.8126070499420166, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.8055084347724915, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.8008127808570862, mean p set: 0.45035696029663086
loss_pred:0.026031507179141045, decouple_loss:0.00757311237975955
loss_pred:0.024805676192045212, decouple_loss:0.00731416093185544
loss_pred:0.024644646793603897, decouple_loss:0.007342788856476545
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025531111285090446, avg_mse: 0.031081587076187134
current test mse: 0.031082
Iteration: 2841, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716793298721313, gen p mean: -0.809558093547821, mean p set: 0.44764822721481323
loss_pred:0.026018142700195312, decouple_loss:0.0073501537553966045
The modified gen p mean: 0.44806668162345886, gen p mean: -0.8121891021728516, mean p set: 0.44854697585105896
loss_pred:0.026890182867646217, decouple_loss:0.007408114615827799
The modified gen p mean: 0.4465456008911133, gen p mean: -0.8004019260406494, mean p set: 0.447025865316391
loss_pred:0.025189366191625595, decouple_loss:0.007145162671804428
Iteration: 2842, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474598467350006, gen p mean: -0.8033528327941895, mean p set: 0.4479401111602783
The modified gen p mean: 0.44908756017684937, gen p mean: -0.7959709763526917, mean p set: 0.44956785440444946
The modified gen p mean: 0.4472391903400421, gen p mean: -0.7949360013008118, mean p set: 0.4477194845676422
loss_pred:0.027588047087192535, decouple_loss:0.007422145921736956
loss_pred:0.02661188133060932, decouple_loss:0.007282000035047531
loss_pred:0.02565312571823597, decouple_loss:0.007405995856970549
Iteration: 2843, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475862383842468, gen p mean: -0.7939651608467102, mean p set: 0.4480665326118469
The modified gen p mean: 0.44831234216690063, gen p mean: -0.7912546396255493, mean p set: 0.44879260659217834
The modified gen p mean: 0.4472741186618805, gen p mean: -0.7971335053443909, mean p set: 0.4477544128894806
loss_pred:0.025197502225637436, decouple_loss:0.007068114820867777
loss_pred:0.02695818431675434, decouple_loss:0.007392544765025377
loss_pred:0.026431988924741745, decouple_loss:0.007295903284102678
Iteration: 2844, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44747617840766907, gen p mean: -0.805151104927063, mean p set: 0.4479564428329468
The modified gen p mean: 0.44743454456329346, gen p mean: -0.802334189414978, mean p set: 0.44791483879089355
The modified gen p mean: 0.4487350285053253, gen p mean: -0.7956476807594299, mean p set: 0.4492153227329254
loss_pred:0.026911409571766853, decouple_loss:0.00735446298494935
loss_pred:0.027711743488907814, decouple_loss:0.00721052335575223
loss_pred:0.027126412838697433, decouple_loss:0.007070724852383137
Iteration: 2845, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44929271936416626, gen p mean: -0.8037279844284058, mean p set: 0.44977301359176636
The modified gen p mean: 0.44838374853134155, gen p mean: -0.8016396164894104, mean p set: 0.44886404275894165
The modified gen p mean: 0.4478066861629486, gen p mean: -0.8056838512420654, mean p set: 0.4482869803905487
loss_pred:0.026106176897883415, decouple_loss:0.0073759411461651325
loss_pred:0.026649607345461845, decouple_loss:0.007522092200815678
loss_pred:0.026308836415410042, decouple_loss:0.0075087216682732105
Iteration: 2846, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474543035030365, gen p mean: -0.8098414540290833, mean p set: 0.4479345977306366
The modified gen p mean: 0.44814085960388184, gen p mean: -0.8004148602485657, mean p set: 0.44862115383148193
The modified gen p mean: 0.4470826983451843, gen p mean: -0.8112508058547974, mean p set: 0.4475629925727844
loss_pred:0.026687534525990486, decouple_loss:0.007200624793767929
loss_pred:0.02644880674779415, decouple_loss:0.007101808674633503
loss_pred:0.025869596749544144, decouple_loss:0.006974229123443365
Iteration: 2847, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708651304244995, gen p mean: -0.8059659004211426, mean p set: 0.44756677746772766
The modified gen p mean: 0.4481871426105499, gen p mean: -0.8091471791267395, mean p set: 0.44866740703582764
The modified gen p mean: 0.44829297065734863, gen p mean: -0.7978119254112244, mean p set: 0.44877323508262634
loss_pred:0.026821501553058624, decouple_loss:0.0071061113849282265
loss_pred:0.026180176064372063, decouple_loss:0.007023993413895369
loss_pred:0.026331501081585884, decouple_loss:0.00705626979470253
Iteration: 2848, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44712480902671814, gen p mean: -0.791195273399353, mean p set: 0.44760507345199585
The modified gen p mean: 0.44760578870773315, gen p mean: -0.796707034111023, mean p set: 0.44808605313301086
The modified gen p mean: 0.44771137833595276, gen p mean: -0.8002093434333801, mean p set: 0.44819167256355286
loss_pred:0.024866407737135887, decouple_loss:0.007080999668687582
loss_pred:0.027010783553123474, decouple_loss:0.007377739064395428
loss_pred:0.027097007259726524, decouple_loss:0.0071758669801056385
Iteration: 2849, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44618886709213257, gen p mean: -0.7828439474105835, mean p set: 0.4466691315174103
The modified gen p mean: 0.44649919867515564, gen p mean: -0.789696216583252, mean p set: 0.44697946310043335
The modified gen p mean: 0.44587671756744385, gen p mean: -0.7846225500106812, mean p set: 0.44635701179504395
loss_pred:0.0264911986887455, decouple_loss:0.007001860532909632loss_pred:0.026539472863078117, decouple_loss:0.007085236720740795
loss_pred:0.02652602829039097, decouple_loss:0.0072090765461325645
Iteration: 2850, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44888201355934143, gen p mean: -0.7865342497825623, mean p set: 0.4493623375892639
The modified gen p mean: 0.4474444091320038, gen p mean: -0.787917971611023, mean p set: 0.4479246735572815
The modified gen p mean: 0.4468608498573303, gen p mean: -0.7813898921012878, mean p set: 0.4473411440849304
loss_pred:0.025499366223812103, decouple_loss:0.007073596585541964
loss_pred:0.027087965980172157, decouple_loss:0.006896844133734703
loss_pred:0.025911949574947357, decouple_loss:0.0072949472814798355
2023-05-03 09:24:02 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.792691707611084, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7859330177307129, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.781939685344696, mean p set: 0.45035696029663086
loss_pred:0.0247948095202446, decouple_loss:0.007308483589440584
loss_pred:0.02583893947303295, decouple_loss:0.007493253797292709
loss_pred:0.02452855370938778, decouple_loss:0.007259255275130272
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025421783328056335, avg_mse: 0.03108549304306507
current test mse: 0.031085
Iteration: 2851, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484826624393463, gen p mean: -0.7848647832870483, mean p set: 0.448962926864624
loss_pred:0.02679605223238468, decouple_loss:0.006910184398293495
The modified gen p mean: 0.4467546343803406, gen p mean: -0.7859704494476318, mean p set: 0.4472349286079407
loss_pred:0.02630147524178028, decouple_loss:0.00694104190915823
The modified gen p mean: 0.4464946985244751, gen p mean: -0.7897205352783203, mean p set: 0.4469749927520752
loss_pred:0.026961231604218483, decouple_loss:0.007076398469507694
Iteration: 2852, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815248250961304, gen p mean: -0.8003987669944763, mean p set: 0.44863274693489075
The modified gen p mean: 0.448380708694458, gen p mean: -0.785075843334198, mean p set: 0.4488610029220581
The modified gen p mean: 0.44731447100639343, gen p mean: -0.7924960255622864, mean p set: 0.44779476523399353
loss_pred:0.02617262862622738, decouple_loss:0.006810714956372976
loss_pred:0.02722076140344143, decouple_loss:0.006895615719258785
loss_pred:0.024152256548404694, decouple_loss:0.006861744914203882
Iteration: 2853, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723373651504517, gen p mean: -0.7912841439247131, mean p set: 0.44771403074264526
The modified gen p mean: 0.44696423411369324, gen p mean: -0.7938286662101746, mean p set: 0.44744452834129333
The modified gen p mean: 0.4474298655986786, gen p mean: -0.7853962779045105, mean p set: 0.4479101598262787
loss_pred:0.026189446449279785, decouple_loss:0.0069297016598284245
loss_pred:0.02616812288761139, decouple_loss:0.006714844610542059
loss_pred:0.02696852758526802, decouple_loss:0.006885348353534937
Iteration: 2854, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44613587856292725, gen p mean: -0.7845322489738464, mean p set: 0.44661614298820496
The modified gen p mean: 0.4475901424884796, gen p mean: -0.7881433963775635, mean p set: 0.4480704367160797
The modified gen p mean: 0.4473735988140106, gen p mean: -0.788455605506897, mean p set: 0.4478538930416107
loss_pred:0.027046672999858856, decouple_loss:0.006850609090179205
loss_pred:0.025425905361771584, decouple_loss:0.007036477327346802
loss_pred:0.0254877507686615, decouple_loss:0.007088578771799803
Iteration: 2855, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44718053936958313, gen p mean: -0.7798424959182739, mean p set: 0.4476608335971832
The modified gen p mean: 0.44667738676071167, gen p mean: -0.7801281213760376, mean p set: 0.4471576511859894
The modified gen p mean: 0.4467078745365143, gen p mean: -0.7777248620986938, mean p set: 0.4471881687641144
loss_pred:0.024221910163760185, decouple_loss:0.006820096168667078
loss_pred:0.026067690923810005, decouple_loss:0.006624063476920128
loss_pred:0.026162171736359596, decouple_loss:0.006648555863648653
Iteration: 2856, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470779597759247, gen p mean: -0.7856634259223938, mean p set: 0.4475582540035248
The modified gen p mean: 0.44564110040664673, gen p mean: -0.7769092321395874, mean p set: 0.44612136483192444
The modified gen p mean: 0.4483150839805603, gen p mean: -0.7785592079162598, mean p set: 0.448795348405838
loss_pred:0.02674751542508602, decouple_loss:0.006621494423598051
loss_pred:0.026706261560320854, decouple_loss:0.006565353367477655
loss_pred:0.025731733068823814, decouple_loss:0.006938342470675707
Iteration: 2857, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447206974029541, gen p mean: -0.7877954244613647, mean p set: 0.4476872384548187
The modified gen p mean: 0.4475539028644562, gen p mean: -0.7888489961624146, mean p set: 0.4480341970920563
The modified gen p mean: 0.44809791445732117, gen p mean: -0.795443058013916, mean p set: 0.44857820868492126
loss_pred:0.02594710886478424, decouple_loss:0.006822453811764717
loss_pred:0.027604728937149048, decouple_loss:0.0070387995801866055
loss_pred:0.026243330910801888, decouple_loss:0.006843282375484705
Iteration: 2858, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465150833129883, gen p mean: -0.7932016849517822, mean p set: 0.4469953775405884
The modified gen p mean: 0.446166068315506, gen p mean: -0.7889714241027832, mean p set: 0.4466463625431061
The modified gen p mean: 0.4469808340072632, gen p mean: -0.7822995185852051, mean p set: 0.4474611282348633
loss_pred:0.027014434337615967, decouple_loss:0.006710993591696024
loss_pred:0.02663850225508213, decouple_loss:0.006595590617507696
loss_pred:0.025595873594284058, decouple_loss:0.006439748220145702
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
NaN value num: 0
Iteration: 2859, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44994911551475525, gen p mean: -0.7884588837623596, mean p set: 0.45042940974235535
The modified gen p mean: 0.4511999487876892, gen p mean: -0.7907576560974121, mean p set: 0.4516802132129669
The modified gen p mean: 0.45170214772224426, gen p mean: -0.7910227179527283, mean p set: 0.45218244194984436
loss_pred:0.023600952699780464, decouple_loss:0.007890143431723118
loss_pred:0.024921298027038574, decouple_loss:0.007912908680737019
loss_pred:0.025733409449458122, decouple_loss:0.00732986256480217
Iteration: 2860, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531958997249603, gen p mean: -0.7862809300422668, mean p set: 0.45367616415023804
The modified gen p mean: 0.45181411504745483, gen p mean: -0.7850109934806824, mean p set: 0.45229440927505493
The modified gen p mean: 0.44996023178100586, gen p mean: -0.792579710483551, mean p set: 0.45044055581092834
loss_pred:0.025222066789865494, decouple_loss:0.007820883765816689
loss_pred:0.025743983685970306, decouple_loss:0.00779329938814044
loss_pred:0.025257660076022148, decouple_loss:0.0071981255896389484
2023-05-03 09:28:44 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7919572591781616, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7994581460952759, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7884753942489624, mean p set: 0.45035696029663086
loss_pred:0.024806862697005272, decouple_loss:0.007070762570947409
loss_pred:0.025748014450073242, decouple_loss:0.007575662340968847
loss_pred:0.024523349478840828, decouple_loss:0.007012117654085159
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025387052446603775, avg_mse: 0.031000172719359398
current test mse: 0.031
Iteration: 2861, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514724612236023, gen p mean: -0.7893260717391968, mean p set: 0.4519527554512024
The modified gen p mean: 0.44927978515625, gen p mean: -0.7881216406822205, mean p set: 0.4497600495815277
loss_pred:0.023418080061674118, decouple_loss:0.008082236163318157
loss_pred:0.024944543838500977, decouple_loss:0.007180656772106886
The modified gen p mean: 0.45046862959861755, gen p mean: -0.7933189272880554, mean p set: 0.45094895362854004
loss_pred:0.02455868199467659, decouple_loss:0.007187965791672468
Iteration: 2862, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45102256536483765, gen p mean: -0.7882285118103027, mean p set: 0.45150282979011536
The modified gen p mean: 0.4504478871822357, gen p mean: -0.8039270639419556, mean p set: 0.4509281814098358
The modified gen p mean: 0.4515930414199829, gen p mean: -0.790545642375946, mean p set: 0.4520733654499054
loss_pred:0.024033600464463234, decouple_loss:0.008151184767484665
loss_pred:0.024580135941505432, decouple_loss:0.007326092105358839
loss_pred:0.024507839232683182, decouple_loss:0.007651678752154112
Iteration: 2863, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45187821984291077, gen p mean: -0.7853455543518066, mean p set: 0.45235851407051086
The modified gen p mean: 0.4510365128517151, gen p mean: -0.7936033606529236, mean p set: 0.4515168070793152
The modified gen p mean: 0.4496269226074219, gen p mean: -0.7939767837524414, mean p set: 0.45010724663734436
loss_pred:0.0248258039355278, decouple_loss:0.007535063195973635
loss_pred:0.024211762472987175, decouple_loss:0.007405497133731842
loss_pred:0.024248240515589714, decouple_loss:0.007382348645478487
Iteration: 2864, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45057961344718933, gen p mean: -0.7811537384986877, mean p set: 0.4510599374771118
The modified gen p mean: 0.44978272914886475, gen p mean: -0.7870383262634277, mean p set: 0.45026299357414246
The modified gen p mean: 0.4525086283683777, gen p mean: -0.7873130440711975, mean p set: 0.4529889225959778
loss_pred:0.024330472573637962, decouple_loss:0.007457423489540815
loss_pred:0.024636754766106606, decouple_loss:0.007311417255550623
loss_pred:0.02350514940917492, decouple_loss:0.008767211809754372
Iteration: 2865, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511013925075531, gen p mean: -0.7759556770324707, mean p set: 0.4515817165374756
The modified gen p mean: 0.4518909454345703, gen p mean: -0.7739902138710022, mean p set: 0.4523712396621704
The modified gen p mean: 0.45107418298721313, gen p mean: -0.7808188199996948, mean p set: 0.45155444741249084
loss_pred:0.024759428575634956, decouple_loss:0.007263918872922659
loss_pred:0.025210505351424217, decouple_loss:0.007247918751090765
loss_pred:0.023656856268644333, decouple_loss:0.007481680251657963
Iteration: 2866, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520137310028076, gen p mean: -0.7831196784973145, mean p set: 0.4524940252304077
The modified gen p mean: 0.45282426476478577, gen p mean: -0.785180926322937, mean p set: 0.4533045291900635
The modified gen p mean: 0.451941579580307, gen p mean: -0.7827938199043274, mean p set: 0.4524218738079071
loss_pred:0.0228655356913805, decouple_loss:0.008305461145937443
loss_pred:0.023629924282431602, decouple_loss:0.007425400894135237
loss_pred:0.023491183295845985, decouple_loss:0.00752120278775692
Iteration: 2867, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503079950809479, gen p mean: -0.7950603365898132, mean p set: 0.450788289308548
The modified gen p mean: 0.45129311084747314, gen p mean: -0.7830373048782349, mean p set: 0.45177337527275085
The modified gen p mean: 0.4521043598651886, gen p mean: -0.788881778717041, mean p set: 0.4525846242904663
loss_pred:0.02392551675438881, decouple_loss:0.0074889943934977055
loss_pred:0.024187671020627022, decouple_loss:0.007225127890706062
loss_pred:0.023723797872662544, decouple_loss:0.007507817819714546
Iteration: 2868, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518243670463562, gen p mean: -0.7890579104423523, mean p set: 0.4523046314716339
The modified gen p mean: 0.45056816935539246, gen p mean: -0.7905862331390381, mean p set: 0.45104846358299255
The modified gen p mean: 0.4514588415622711, gen p mean: -0.7882959842681885, mean p set: 0.4519391357898712
loss_pred:0.02413073182106018, decouple_loss:0.0075963642448186874
loss_pred:0.023995453491806984, decouple_loss:0.007116236258298159
loss_pred:0.022772686555981636, decouple_loss:0.0076941982842981815
Iteration: 2869, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506170451641083, gen p mean: -0.7918484210968018, mean p set: 0.45109736919403076
The modified gen p mean: 0.45172634720802307, gen p mean: -0.7911175489425659, mean p set: 0.45220664143562317
The modified gen p mean: 0.45116060972213745, gen p mean: -0.7868505716323853, mean p set: 0.45164093375205994
loss_pred:0.02392355352640152, decouple_loss:0.0070753092877566814
loss_pred:0.023416422307491302, decouple_loss:0.006963860243558884
loss_pred:0.02332557737827301, decouple_loss:0.006942675448954105
Iteration: 2870, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522086977958679, gen p mean: -0.7926334142684937, mean p set: 0.45268896222114563
The modified gen p mean: 0.45287275314331055, gen p mean: -0.7832628488540649, mean p set: 0.45335304737091064
The modified gen p mean: 0.45255526900291443, gen p mean: -0.793892502784729, mean p set: 0.45303553342819214
loss_pred:0.02341270260512829, decouple_loss:0.007933704182505608
loss_pred:0.02527577057480812, decouple_loss:0.007212085649371147
loss_pred:0.023674629628658295, decouple_loss:0.0074003105983138084
2023-05-03 09:32:24 testing...
The modified gen p mean: 0.4495830237865448, gen p mean: -0.7868099212646484, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.794459879398346, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7829390168190002, mean p set: 0.45035696029663086
loss_pred:0.0249211173504591, decouple_loss:0.007632767781615257
loss_pred:0.02594192512333393, decouple_loss:0.008013876155018806
loss_pred:0.024619977921247482, decouple_loss:0.007792479358613491
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025551659986376762, avg_mse: 0.031299591064453125
current test mse: 0.0313
Iteration: 2871, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518289566040039, gen p mean: -0.788665771484375, mean p set: 0.4523092210292816
The modified gen p mean: 0.45068731904029846, gen p mean: -0.7826663851737976, mean p set: 0.45116758346557617
loss_pred:0.023804087191820145, decouple_loss:0.007281806319952011
loss_pred:0.02372579649090767, decouple_loss:0.007075131870806217
The modified gen p mean: 0.45262861251831055, gen p mean: -0.7866220474243164, mean p set: 0.45310890674591064
loss_pred:0.023398639634251595, decouple_loss:0.0072106714360415936
Iteration: 2872, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504152834415436, gen p mean: -0.7819859385490417, mean p set: 0.4508955478668213
The modified gen p mean: 0.45076966285705566, gen p mean: -0.7830389738082886, mean p set: 0.45124995708465576
The modified gen p mean: 0.45068761706352234, gen p mean: -0.7830427289009094, mean p set: 0.45116788148880005
loss_pred:0.023778192698955536, decouple_loss:0.00706517556682229
loss_pred:0.023742686957120895, decouple_loss:0.007586228661239147
loss_pred:0.02440331131219864, decouple_loss:0.007516069337725639
Iteration: 2873, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518912732601166, gen p mean: -0.7904723882675171, mean p set: 0.4523715376853943
The modified gen p mean: 0.4533810317516327, gen p mean: -0.7824371457099915, mean p set: 0.4538613259792328
The modified gen p mean: 0.4518422484397888, gen p mean: -0.7884521484375, mean p set: 0.4523225724697113
loss_pred:0.023143982514739037, decouple_loss:0.007981779053807259
loss_pred:0.023870334029197693, decouple_loss:0.006984116043895483
loss_pred:0.022960858419537544, decouple_loss:0.00753284664824605
Iteration: 2874, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45080626010894775, gen p mean: -0.7857611179351807, mean p set: 0.45128652453422546
The modified gen p mean: 0.44986605644226074, gen p mean: -0.7931858897209167, mean p set: 0.45034632086753845
The modified gen p mean: 0.4522443115711212, gen p mean: -0.7909069061279297, mean p set: 0.4527246057987213
loss_pred:0.02374880015850067, decouple_loss:0.007318750023841858
loss_pred:0.023846697062253952, decouple_loss:0.007318798918277025
loss_pred:0.02332313545048237, decouple_loss:0.00714910589158535
Iteration: 2875, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45121800899505615, gen p mean: -0.7862043976783752, mean p set: 0.45169830322265625
The modified gen p mean: 0.4500848352909088, gen p mean: -0.792568027973175, mean p set: 0.4505651295185089
The modified gen p mean: 0.4502285420894623, gen p mean: -0.7952321171760559, mean p set: 0.4507088363170624
loss_pred:0.02350567653775215, decouple_loss:0.0069907368160784245
loss_pred:0.023837558925151825, decouple_loss:0.006726258434355259
loss_pred:0.02400316670536995, decouple_loss:0.007150004617869854
Iteration: 2876, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45126569271087646, gen p mean: -0.8000167608261108, mean p set: 0.4517459571361542
The modified gen p mean: 0.45086026191711426, gen p mean: -0.8011376857757568, mean p set: 0.45134058594703674
The modified gen p mean: 0.45082539319992065, gen p mean: -0.8019434213638306, mean p set: 0.45130568742752075
loss_pred:0.02348567359149456, decouple_loss:0.007042726036161184
loss_pred:0.023684365674853325, decouple_loss:0.006963550113141537
loss_pred:0.02392849139869213, decouple_loss:0.006844616960734129
Iteration: 2877, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45045846700668335, gen p mean: -0.8006168007850647, mean p set: 0.45093876123428345
The modified gen p mean: 0.4512845575809479, gen p mean: -0.7943975925445557, mean p set: 0.45176488161087036
The modified gen p mean: 0.4497283101081848, gen p mean: -0.8081066608428955, mean p set: 0.4502086043357849
loss_pred:0.023500191047787666, decouple_loss:0.007254133466631174
loss_pred:0.023961974307894707, decouple_loss:0.00692387018352747
loss_pred:0.023877643048763275, decouple_loss:0.006660162005573511
Iteration: 2878, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520318806171417, gen p mean: -0.7987514734268188, mean p set: 0.45251214504241943
The modified gen p mean: 0.4519196152687073, gen p mean: -0.800739586353302, mean p set: 0.45239993929862976
The modified gen p mean: 0.4513220489025116, gen p mean: -0.8025703430175781, mean p set: 0.4518023431301117
loss_pred:0.024361690506339073, decouple_loss:0.006751521956175566
loss_pred:0.024224640801548958, decouple_loss:0.006670456379652023
loss_pred:0.023027515038847923, decouple_loss:0.006978120654821396
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 2879, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44705930352211, gen p mean: -0.8083914518356323, mean p set: 0.44753962755203247
The modified gen p mean: 0.44776225090026855, gen p mean: -0.7967397570610046, mean p set: 0.44824254512786865
The modified gen p mean: 0.4481104910373688, gen p mean: -0.8025662302970886, mean p set: 0.44859078526496887
loss_pred:0.025761686265468597, decouple_loss:0.007384127471596003
loss_pred:0.023473192006349564, decouple_loss:0.007213105447590351
loss_pred:0.0242803692817688, decouple_loss:0.007502431981265545
Iteration: 2880, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44774556159973145, gen p mean: -0.7963013648986816, mean p set: 0.44822585582733154
The modified gen p mean: 0.447274774312973, gen p mean: -0.7992894053459167, mean p set: 0.44775503873825073
The modified gen p mean: 0.4473233222961426, gen p mean: -0.8059623837471008, mean p set: 0.44780364632606506
loss_pred:0.02581004612147808, decouple_loss:0.0069062961265444756
loss_pred:0.024265430867671967, decouple_loss:0.007169500924646854
loss_pred:0.024456484243273735, decouple_loss:0.007220560684800148
2023-05-03 09:37:06 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.8089922666549683, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.8002501130104065, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7960882782936096, mean p set: 0.45035696029663086
loss_pred:0.02570880576968193, decouple_loss:0.007170772645622492
loss_pred:0.024658242240548134, decouple_loss:0.006901524495333433
loss_pred:0.024402476847171783, decouple_loss:0.0069788238033652306
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02527402900159359, avg_mse: 0.030884306877851486
current test mse: 0.030884
Iteration: 2881, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494800865650177, gen p mean: -0.7913066744804382, mean p set: 0.4499603509902954
The modified gen p mean: 0.44773584604263306, gen p mean: -0.7949957847595215, mean p set: 0.44821614027023315
loss_pred:0.023757634684443474, decouple_loss:0.006946347653865814
loss_pred:0.02533331699669361, decouple_loss:0.007174892351031303
The modified gen p mean: 0.44750165939331055, gen p mean: -0.7989872694015503, mean p set: 0.44798195362091064
loss_pred:0.024664390832185745, decouple_loss:0.006845507770776749
Iteration: 2882, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473133385181427, gen p mean: -0.8056654334068298, mean p set: 0.4477936327457428
The modified gen p mean: 0.44857919216156006, gen p mean: -0.7963455319404602, mean p set: 0.44905948638916016
The modified gen p mean: 0.44764891266822815, gen p mean: -0.8033975958824158, mean p set: 0.44812917709350586
loss_pred:0.0236495453864336, decouple_loss:0.006955020595341921
loss_pred:0.025341849774122238, decouple_loss:0.007107734680175781
loss_pred:0.02505568414926529, decouple_loss:0.006952060852199793
Iteration: 2883, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470285475254059, gen p mean: -0.8003085851669312, mean p set: 0.4475088119506836
The modified gen p mean: 0.44757816195487976, gen p mean: -0.8016902804374695, mean p set: 0.44805845618247986
The modified gen p mean: 0.4471130669116974, gen p mean: -0.793131947517395, mean p set: 0.4475933611392975
loss_pred:0.025123633444309235, decouple_loss:0.006790807005017996
loss_pred:0.023911675438284874, decouple_loss:0.006714088376611471
loss_pred:0.025450685992836952, decouple_loss:0.006839437410235405
Iteration: 2884, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446834534406662, gen p mean: -0.8022921085357666, mean p set: 0.4473148286342621
The modified gen p mean: 0.4488285779953003, gen p mean: -0.7985939383506775, mean p set: 0.449308842420578
The modified gen p mean: 0.44668811559677124, gen p mean: -0.7907437682151794, mean p set: 0.4471684396266937
loss_pred:0.024259701371192932, decouple_loss:0.006783224642276764
loss_pred:0.0230850987136364, decouple_loss:0.006874320097267628
loss_pred:0.02588467486202717, decouple_loss:0.006836230866611004
Iteration: 2885, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486341178417206, gen p mean: -0.7924768924713135, mean p set: 0.4491144120693207
The modified gen p mean: 0.44797784090042114, gen p mean: -0.7934569120407104, mean p set: 0.44845813512802124
The modified gen p mean: 0.44720175862312317, gen p mean: -0.7897406220436096, mean p set: 0.44768205285072327
loss_pred:0.024594716727733612, decouple_loss:0.006920001469552517
loss_pred:0.023251637816429138, decouple_loss:0.006917170248925686
loss_pred:0.02601330168545246, decouple_loss:0.007152595091611147
Iteration: 2886, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44870510697364807, gen p mean: -0.8001652956008911, mean p set: 0.44918543100357056
The modified gen p mean: 0.44815152883529663, gen p mean: -0.7998568415641785, mean p set: 0.44863179326057434
The modified gen p mean: 0.4486345052719116, gen p mean: -0.7953258752822876, mean p set: 0.4491148293018341
loss_pred:0.023498758673667908, decouple_loss:0.006800541654229164
loss_pred:0.023445306345820427, decouple_loss:0.006803901866078377
loss_pred:0.024390961974859238, decouple_loss:0.0067649343982338905
Iteration: 2887, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468989074230194, gen p mean: -0.8072607517242432, mean p set: 0.4473792016506195
The modified gen p mean: 0.4482947289943695, gen p mean: -0.7978350520133972, mean p set: 0.4487749934196472
The modified gen p mean: 0.4474719762802124, gen p mean: -0.7938533425331116, mean p set: 0.4479523003101349
loss_pred:0.024240465834736824, decouple_loss:0.006375052034854889
loss_pred:0.02490774728357792, decouple_loss:0.006422016303986311
loss_pred:0.02547593228518963, decouple_loss:0.006678976584225893
Iteration: 2888, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44962751865386963, gen p mean: -0.7968643307685852, mean p set: 0.45010778307914734
The modified gen p mean: 0.4478502869606018, gen p mean: -0.7958141565322876, mean p set: 0.4483305513858795
The modified gen p mean: 0.4471355676651001, gen p mean: -0.7983804941177368, mean p set: 0.4476158618927002
loss_pred:0.023447340354323387, decouple_loss:0.007127720862627029
loss_pred:0.02520023100078106, decouple_loss:0.006847681012004614
loss_pred:0.025626255199313164, decouple_loss:0.006817270535975695
Iteration: 2889, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44739052653312683, gen p mean: -0.7915078401565552, mean p set: 0.4478708505630493
The modified gen p mean: 0.44720330834388733, gen p mean: -0.7917323708534241, mean p set: 0.4476836025714874
The modified gen p mean: 0.44780397415161133, gen p mean: -0.7935912609100342, mean p set: 0.4482842683792114
loss_pred:0.024381406605243683, decouple_loss:0.006676312070339918
loss_pred:0.023904679343104362, decouple_loss:0.006706055719405413
loss_pred:0.02587382309138775, decouple_loss:0.00661430275067687
Iteration: 2890, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478875398635864, gen p mean: -0.7888810634613037, mean p set: 0.44836780428886414
The modified gen p mean: 0.44766753911972046, gen p mean: -0.7943097949028015, mean p set: 0.44814783334732056
loss_pred:0.026059217751026154, decouple_loss:0.006933204829692841
The modified gen p mean: 0.4481607973575592, gen p mean: -0.7968770861625671, mean p set: 0.4486410617828369
loss_pred:0.024796012789011, decouple_loss:0.0066155618987977505
loss_pred:0.023931216448545456, decouple_loss:0.006837633904069662
2023-05-03 09:40:49 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7990696430206299, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.8073830604553223, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7954487800598145, mean p set: 0.45035696029663086
loss_pred:0.024467378854751587, decouple_loss:0.006663546431809664
loss_pred:0.025565454736351967, decouple_loss:0.006991625297814608
loss_pred:0.02428903616964817, decouple_loss:0.006643678992986679
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025112271308898926, avg_mse: 0.030694127082824707
current test mse: 0.030694
Iteration: 2891, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808363914489746, gen p mean: -0.7940812110900879, mean p set: 0.44856393337249756
The modified gen p mean: 0.44704321026802063, gen p mean: -0.795234739780426, mean p set: 0.4475235044956207
loss_pred:0.02521311305463314, decouple_loss:0.006692925002425909
loss_pred:0.024055736139416695, decouple_loss:0.006642982363700867
The modified gen p mean: 0.44794023036956787, gen p mean: -0.7976250052452087, mean p set: 0.44842052459716797
loss_pred:0.024604834616184235, decouple_loss:0.006395014468580484
Iteration: 2892, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467989206314087, gen p mean: -0.801075279712677, mean p set: 0.4472792148590088
The modified gen p mean: 0.44741091132164, gen p mean: -0.7946847081184387, mean p set: 0.4478912055492401
The modified gen p mean: 0.4485374093055725, gen p mean: -0.8011149764060974, mean p set: 0.4490176737308502
loss_pred:0.024179600179195404, decouple_loss:0.006562445778399706
loss_pred:0.025719355791807175, decouple_loss:0.006354071199893951
loss_pred:0.024789195507764816, decouple_loss:0.006269888952374458
Iteration: 2893, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812628626823425, gen p mean: -0.7993564009666443, mean p set: 0.44860655069351196
The modified gen p mean: 0.44765573740005493, gen p mean: -0.7990483045578003, mean p set: 0.44813597202301025
The modified gen p mean: 0.449092298746109, gen p mean: -0.797491192817688, mean p set: 0.4495725929737091
loss_pred:0.0239896010607481, decouple_loss:0.006257990840822458
loss_pred:0.025093872100114822, decouple_loss:0.006535309832543135
loss_pred:0.024133695289492607, decouple_loss:0.006453427020460367
Iteration: 2894, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715616106987, gen p mean: -0.794817328453064, mean p set: 0.4476364552974701
The modified gen p mean: 0.44735175371170044, gen p mean: -0.7922003269195557, mean p set: 0.44783204793930054
The modified gen p mean: 0.44653695821762085, gen p mean: -0.7958789467811584, mean p set: 0.44701725244522095
loss_pred:0.024978792294859886, decouple_loss:0.0064733028411865234
loss_pred:0.024935543537139893, decouple_loss:0.006380015518516302
loss_pred:0.025230735540390015, decouple_loss:0.00641292380169034
Iteration: 2895, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475812315940857, gen p mean: -0.7859312295913696, mean p set: 0.4480615258216858
The modified gen p mean: 0.447695255279541, gen p mean: -0.7927913665771484, mean p set: 0.4481755197048187
The modified gen p mean: 0.4481147527694702, gen p mean: -0.7916325926780701, mean p set: 0.4485950767993927
loss_pred:0.024029960855841637, decouple_loss:0.006122886668890715
loss_pred:0.023807140067219734, decouple_loss:0.006547141820192337
loss_pred:0.024000123143196106, decouple_loss:0.006430040113627911
Iteration: 2896, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797438383102417, gen p mean: -0.7866265177726746, mean p set: 0.44845467805862427
The modified gen p mean: 0.4490791857242584, gen p mean: -0.7818971872329712, mean p set: 0.4495594799518585
The modified gen p mean: 0.44768840074539185, gen p mean: -0.7945427298545837, mean p set: 0.44816869497299194
loss_pred:0.023735225200653076, decouple_loss:0.00629098666831851
loss_pred:0.02336299419403076, decouple_loss:0.0065764025785028934
loss_pred:0.02421766333281994, decouple_loss:0.006484402809292078
Iteration: 2897, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778740406036377, gen p mean: -0.7880695462226868, mean p set: 0.4482676684856415
The modified gen p mean: 0.4480414092540741, gen p mean: -0.7940481305122375, mean p set: 0.4485217034816742
The modified gen p mean: 0.4471811056137085, gen p mean: -0.7855429649353027, mean p set: 0.4476613700389862
loss_pred:0.024726422503590584, decouple_loss:0.0065057482570409775
loss_pred:0.023565543815493584, decouple_loss:0.0065488205291330814
loss_pred:0.02490580454468727, decouple_loss:0.006398023571819067
Iteration: 2898, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476890563964844, gen p mean: -0.7866950631141663, mean p set: 0.4481693506240845
The modified gen p mean: 0.4478897452354431, gen p mean: -0.794215738773346, mean p set: 0.4483700692653656
The modified gen p mean: 0.4475351870059967, gen p mean: -0.7890013456344604, mean p set: 0.4480154812335968
loss_pred:0.02372935228049755, decouple_loss:0.006507351528853178
loss_pred:0.023020844906568527, decouple_loss:0.0063405027613043785
loss_pred:0.023442702367901802, decouple_loss:0.006437113508582115
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 2899, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475215673446655, gen p mean: -0.7898758053779602, mean p set: 0.44800183176994324
The modified gen p mean: 0.4466698467731476, gen p mean: -0.7906094789505005, mean p set: 0.4471501410007477
The modified gen p mean: 0.4465717077255249, gen p mean: -0.7946290969848633, mean p set: 0.4470519721508026
loss_pred:0.024790771305561066, decouple_loss:0.006459486670792103
loss_pred:0.02485457994043827, decouple_loss:0.006290874443948269
loss_pred:0.024832241237163544, decouple_loss:0.006633754353970289
Iteration: 2900, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752365350723267, gen p mean: -0.7983008623123169, mean p set: 0.44800394773483276
The modified gen p mean: 0.44818034768104553, gen p mean: -0.7987809181213379, mean p set: 0.44866064190864563
The modified gen p mean: 0.44782304763793945, gen p mean: -0.7957771420478821, mean p set: 0.44830334186553955
loss_pred:0.02516215294599533, decouple_loss:0.006296494975686073
loss_pred:0.0245225690305233, decouple_loss:0.006590353325009346
loss_pred:0.025478791445493698, decouple_loss:0.006345790345221758
2023-05-03 09:45:33 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7977800369262695, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.8054285645484924, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7935313582420349, mean p set: 0.45035696029663086
loss_pred:0.02433839999139309, decouple_loss:0.00625475263223052
loss_pred:0.025515960529446602, decouple_loss:0.00655041029676795
loss_pred:0.024214472621679306, decouple_loss:0.00628812937065959
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025007834658026695, avg_mse: 0.030567875131964684
current test mse: 0.030568
Iteration: 2901, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446898490190506, gen p mean: -0.7998499274253845, mean p set: 0.4473787844181061
The modified gen p mean: 0.4480065703392029, gen p mean: -0.7949398756027222, mean p set: 0.448486864566803
loss_pred:0.02493017353117466, decouple_loss:0.006365471985191107
loss_pred:0.024284062907099724, decouple_loss:0.00618670554831624
The modified gen p mean: 0.4471721351146698, gen p mean: -0.7951235175132751, mean p set: 0.4476523995399475
loss_pred:0.02526979334652424, decouple_loss:0.006129530258476734
Iteration: 2902, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44848939776420593, gen p mean: -0.797122597694397, mean p set: 0.44896969199180603
The modified gen p mean: 0.4464516043663025, gen p mean: -0.7910662293434143, mean p set: 0.4469318985939026
The modified gen p mean: 0.4467315375804901, gen p mean: -0.7901013493537903, mean p set: 0.4472118318080902
loss_pred:0.024604856967926025, decouple_loss:0.006513661704957485
loss_pred:0.02589978091418743, decouple_loss:0.00646040728315711
loss_pred:0.0244089737534523, decouple_loss:0.0064774868078529835
Iteration: 2903, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832539558410645, gen p mean: -0.8069052696228027, mean p set: 0.44880568981170654
The modified gen p mean: 0.4477587044239044, gen p mean: -0.80037921667099, mean p set: 0.4482389986515045
The modified gen p mean: 0.4472211003303528, gen p mean: -0.802759051322937, mean p set: 0.4477013349533081
loss_pred:0.024522801861166954, decouple_loss:0.006292389240115881
loss_pred:0.02452152967453003, decouple_loss:0.006412188056856394
loss_pred:0.024904804304242134, decouple_loss:0.006192994304001331
Iteration: 2904, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480394423007965, gen p mean: -0.7883951663970947, mean p set: 0.4485197067260742
The modified gen p mean: 0.4473575949668884, gen p mean: -0.7927154302597046, mean p set: 0.4478378891944885
The modified gen p mean: 0.44840559363365173, gen p mean: -0.7937853932380676, mean p set: 0.44888588786125183
loss_pred:0.023765267804265022, decouple_loss:0.006380483973771334
loss_pred:0.023978594690561295, decouple_loss:0.0062254369258880615
loss_pred:0.024097837507724762, decouple_loss:0.006628022063523531
Iteration: 2905, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448211133480072, gen p mean: -0.7867766618728638, mean p set: 0.44869139790534973
The modified gen p mean: 0.4484303593635559, gen p mean: -0.7861829400062561, mean p set: 0.448910653591156
loss_pred:0.023699915036559105, decouple_loss:0.006333673372864723
The modified gen p mean: 0.44760164618492126, gen p mean: -0.7890894412994385, mean p set: 0.448081910610199
loss_pred:0.023881761357188225, decouple_loss:0.0061856587417423725
loss_pred:0.025446195155382156, decouple_loss:0.0060186563059687614
Iteration: 2906, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489342272281647, gen p mean: -0.7826021909713745, mean p set: 0.44941452145576477
The modified gen p mean: 0.44876834750175476, gen p mean: -0.7747423648834229, mean p set: 0.44924864172935486
The modified gen p mean: 0.44710662961006165, gen p mean: -0.7786085605621338, mean p set: 0.44758692383766174
loss_pred:0.0242140032351017, decouple_loss:0.006396930199116468
loss_pred:0.02395911142230034, decouple_loss:0.006505249068140984
loss_pred:0.02569621615111828, decouple_loss:0.006329721305519342
Iteration: 2907, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486684501171112, gen p mean: -0.777471661567688, mean p set: 0.4491487443447113
The modified gen p mean: 0.4469423294067383, gen p mean: -0.7772561311721802, mean p set: 0.447422593832016
The modified gen p mean: 0.44917985796928406, gen p mean: -0.7726441621780396, mean p set: 0.44966015219688416
loss_pred:0.024012459442019463, decouple_loss:0.0063960496336221695
loss_pred:0.024377627298235893, decouple_loss:0.006253311410546303
loss_pred:0.02418055385351181, decouple_loss:0.006459914613515139
Iteration: 2908, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478238523006439, gen p mean: -0.7832664847373962, mean p set: 0.448304146528244
The modified gen p mean: 0.4469960927963257, gen p mean: -0.7774063944816589, mean p set: 0.4474763870239258
The modified gen p mean: 0.4477115869522095, gen p mean: -0.7810433506965637, mean p set: 0.4481918513774872
loss_pred:0.024787383154034615, decouple_loss:0.006102085579186678
loss_pred:0.024914778769016266, decouple_loss:0.006335081998258829
loss_pred:0.02450539730489254, decouple_loss:0.00607765419408679
Iteration: 2909, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482623338699341, gen p mean: -0.7908380031585693, mean p set: 0.4487426280975342
The modified gen p mean: 0.44741079211235046, gen p mean: -0.7767401933670044, mean p set: 0.44789108633995056
The modified gen p mean: 0.4479084312915802, gen p mean: -0.7916049361228943, mean p set: 0.4483886957168579
loss_pred:0.02502220869064331, decouple_loss:0.006306987255811691
loss_pred:0.025459185242652893, decouple_loss:0.006875031627714634
loss_pred:0.02419780194759369, decouple_loss:0.0060129170306026936
Iteration: 2910, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44746914505958557, gen p mean: -0.7905130982398987, mean p set: 0.44794946908950806
The modified gen p mean: 0.44689860939979553, gen p mean: -0.7818694710731506, mean p set: 0.44737890362739563
The modified gen p mean: 0.44812914729118347, gen p mean: -0.795586109161377, mean p set: 0.44860947132110596
loss_pred:0.024363713338971138, decouple_loss:0.006403985433280468
loss_pred:0.02479076199233532, decouple_loss:0.006236151792109013
loss_pred:0.024635890498757362, decouple_loss:0.006095140241086483
2023-05-03 09:49:17 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7974836826324463, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7895718812942505, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.786266565322876, mean p set: 0.45035696029663086
loss_pred:0.025390366092324257, decouple_loss:0.0067264605313539505
loss_pred:0.024350574240088463, decouple_loss:0.006356045603752136
loss_pred:0.02421347238123417, decouple_loss:0.0064132497645914555
WV_0_PC_1_EH_0_PS_40_6, loss: 0.024976400658488274, avg_mse: 0.03046686388552189
current test mse: 0.030467
Iteration: 2911, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479628801345825, gen p mean: -0.7847544550895691, mean p set: 0.448443204164505
loss_pred:0.023872913792729378, decouple_loss:0.006383418571203947
The modified gen p mean: 0.4477773904800415, gen p mean: -0.7873207926750183, mean p set: 0.4482576549053192
loss_pred:0.02515733242034912, decouple_loss:0.006226188037544489
The modified gen p mean: 0.4472237229347229, gen p mean: -0.7834872007369995, mean p set: 0.4477039873600006
loss_pred:0.0233332309871912, decouple_loss:0.006210586056113243
Iteration: 2912, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44711413979530334, gen p mean: -0.7947143912315369, mean p set: 0.44759440422058105
The modified gen p mean: 0.4481261670589447, gen p mean: -0.7857111692428589, mean p set: 0.4486064314842224
The modified gen p mean: 0.447181761264801, gen p mean: -0.7864910960197449, mean p set: 0.4476620554924011
loss_pred:0.024234959855675697, decouple_loss:0.006147373933345079
loss_pred:0.02369958907365799, decouple_loss:0.00613177428022027
loss_pred:0.02509351260960102, decouple_loss:0.0060326713137328625
Iteration: 2913, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480511248111725, gen p mean: -0.7936453223228455, mean p set: 0.44853144884109497
The modified gen p mean: 0.447517991065979, gen p mean: -0.7846125960350037, mean p set: 0.4479982852935791
The modified gen p mean: 0.44714412093162537, gen p mean: -0.792557954788208, mean p set: 0.44762441515922546
loss_pred:0.02424200437963009, decouple_loss:0.00616839062422514
loss_pred:0.02349013276398182, decouple_loss:0.005967119708657265
loss_pred:0.024552039802074432, decouple_loss:0.0063167596235871315
Iteration: 2914, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446647047996521, gen p mean: -0.7821582555770874, mean p set: 0.4471273422241211
The modified gen p mean: 0.4472235441207886, gen p mean: -0.785897970199585, mean p set: 0.44770386815071106
The modified gen p mean: 0.4488455653190613, gen p mean: -0.7792133092880249, mean p set: 0.449325829744339
loss_pred:0.025320352986454964, decouple_loss:0.006157845724374056
loss_pred:0.024368299171328545, decouple_loss:0.0059477658942341805
loss_pred:0.023165741935372353, decouple_loss:0.006247432436794043
Iteration: 2915, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472044110298157, gen p mean: -0.78659987449646, mean p set: 0.44768473505973816
The modified gen p mean: 0.44715961813926697, gen p mean: -0.7854816317558289, mean p set: 0.4476398825645447
The modified gen p mean: 0.4485773742198944, gen p mean: -0.7820141315460205, mean p set: 0.4490576982498169
loss_pred:0.024994440376758575, decouple_loss:0.0060509610921144485
loss_pred:0.024581579491496086, decouple_loss:0.005753595847636461
loss_pred:0.02357443980872631, decouple_loss:0.006105374079197645
Iteration: 2916, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472287893295288, gen p mean: -0.7909998297691345, mean p set: 0.4477090537548065
The modified gen p mean: 0.44849157333374023, gen p mean: -0.7759637832641602, mean p set: 0.44897186756134033
The modified gen p mean: 0.4468585252761841, gen p mean: -0.7899125814437866, mean p set: 0.4473388195037842
loss_pred:0.024064576253294945, decouple_loss:0.005943481810390949
loss_pred:0.02481607161462307, decouple_loss:0.006119257770478725
loss_pred:0.024290408939123154, decouple_loss:0.006104768253862858
Iteration: 2917, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480859935283661, gen p mean: -0.7880898714065552, mean p set: 0.4485662877559662
The modified gen p mean: 0.4472768306732178, gen p mean: -0.7934728860855103, mean p set: 0.4477570950984955
The modified gen p mean: 0.4476369321346283, gen p mean: -0.7911078929901123, mean p set: 0.4481172263622284
loss_pred:0.023636743426322937, decouple_loss:0.006191862281411886
loss_pred:0.025283563882112503, decouple_loss:0.005929926410317421
loss_pred:0.024558711796998978, decouple_loss:0.005819466896355152
Iteration: 2918, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44735005497932434, gen p mean: -0.7896538376808167, mean p set: 0.44783034920692444
The modified gen p mean: 0.44812214374542236, gen p mean: -0.7885608673095703, mean p set: 0.4486024081707001
The modified gen p mean: 0.44782400131225586, gen p mean: -0.7914855480194092, mean p set: 0.44830429553985596
loss_pred:0.024569489061832428, decouple_loss:0.006065685302019119
loss_pred:0.024600407108664513, decouple_loss:0.00580863980576396
loss_pred:0.023976298049092293, decouple_loss:0.006006211042404175
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
NaN value num: 0
Iteration: 2919, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45261839032173157, gen p mean: -0.8014684915542603, mean p set: 0.4530986547470093
The modified gen p mean: 0.4506920874118805, gen p mean: -0.784111499786377, mean p set: 0.4511723518371582
The modified gen p mean: 0.4512758255004883, gen p mean: -0.7854683995246887, mean p set: 0.4517561197280884
loss_pred:0.023639541119337082, decouple_loss:0.007545351050794125
loss_pred:0.02518722042441368, decouple_loss:0.006698508281260729
loss_pred:0.024905674159526825, decouple_loss:0.007290607318282127
Iteration: 2920, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45063403248786926, gen p mean: -0.7840204238891602, mean p set: 0.451114296913147
The modified gen p mean: 0.45096996426582336, gen p mean: -0.7848814725875854, mean p set: 0.45145025849342346
The modified gen p mean: 0.4514908492565155, gen p mean: -0.7855104207992554, mean p set: 0.4519711136817932
loss_pred:0.024802066385746002, decouple_loss:0.006559350993484259
loss_pred:0.025136617943644524, decouple_loss:0.006814145017415285
loss_pred:0.025430461391806602, decouple_loss:0.00717815849930048
2023-05-03 09:53:57 testing...
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7922289967536926, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.8001658320426941, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7889530062675476, mean p set: 0.45035696029663086
loss_pred:0.024406302720308304, decouple_loss:0.006367177236825228
loss_pred:0.02540373057126999, decouple_loss:0.006554099265486002
loss_pred:0.02414005436003208, decouple_loss:0.006389870308339596
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02497188374400139, avg_mse: 0.030518461018800735
current test mse: 0.030518
Iteration: 2921, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517366290092468, gen p mean: -0.7874760627746582, mean p set: 0.4522169232368469
The modified gen p mean: 0.45258286595344543, gen p mean: -0.7930046916007996, mean p set: 0.45306316018104553
loss_pred:0.024525536224246025, decouple_loss:0.006554940715432167
loss_pred:0.02444623038172722, decouple_loss:0.006996932439506054
The modified gen p mean: 0.4535418748855591, gen p mean: -0.7970868349075317, mean p set: 0.4540221691131592
loss_pred:0.023429617285728455, decouple_loss:0.007723938208073378
Iteration: 2922, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45338529348373413, gen p mean: -0.7987987995147705, mean p set: 0.45386558771133423
The modified gen p mean: 0.45133957266807556, gen p mean: -0.7919585704803467, mean p set: 0.45181983709335327
The modified gen p mean: 0.45123928785324097, gen p mean: -0.7976109385490417, mean p set: 0.45171958208084106
loss_pred:0.023455195128917694, decouple_loss:0.006981968879699707
loss_pred:0.025369878858327866, decouple_loss:0.00690279109403491
loss_pred:0.024247869849205017, decouple_loss:0.006444999948143959
Iteration: 2923, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45150279998779297, gen p mean: -0.7916803956031799, mean p set: 0.45198309421539307
The modified gen p mean: 0.4520377218723297, gen p mean: -0.7924169898033142, mean p set: 0.4525179862976074
The modified gen p mean: 0.452045738697052, gen p mean: -0.7982128262519836, mean p set: 0.4525260329246521
loss_pred:0.024572622030973434, decouple_loss:0.006756243761628866
loss_pred:0.02362455427646637, decouple_loss:0.006886386312544346
loss_pred:0.02498694509267807, decouple_loss:0.006952241994440556
Iteration: 2924, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45155200362205505, gen p mean: -0.7784072160720825, mean p set: 0.45203232765197754
The modified gen p mean: 0.45192667841911316, gen p mean: -0.780464231967926, mean p set: 0.45240697264671326
The modified gen p mean: 0.4523658752441406, gen p mean: -0.7822481393814087, mean p set: 0.4528461992740631
loss_pred:0.024979112669825554, decouple_loss:0.006914723198860884
loss_pred:0.02340010739862919, decouple_loss:0.006319708656519651
loss_pred:0.024273423478007317, decouple_loss:0.0065350909717381
Iteration: 2925, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507414400577545, gen p mean: -0.7792305946350098, mean p set: 0.4512217342853546
The modified gen p mean: 0.45326095819473267, gen p mean: -0.7833963632583618, mean p set: 0.453741192817688
The modified gen p mean: 0.4513983428478241, gen p mean: -0.7756040096282959, mean p set: 0.4518786072731018
loss_pred:0.023702310398221016, decouple_loss:0.0065905689261853695
loss_pred:0.024235768243670464, decouple_loss:0.007328566629439592
loss_pred:0.024993151426315308, decouple_loss:0.006740455515682697
Iteration: 2926, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522055387496948, gen p mean: -0.7913642525672913, mean p set: 0.4526858329772949
The modified gen p mean: 0.45239338278770447, gen p mean: -0.8023669123649597, mean p set: 0.45287367701530457
The modified gen p mean: 0.4518750011920929, gen p mean: -0.7831979990005493, mean p set: 0.452355295419693
loss_pred:0.024563979357481003, decouple_loss:0.006520098075270653
loss_pred:0.02377202920615673, decouple_loss:0.006767910905182362
loss_pred:0.02385249175131321, decouple_loss:0.006580590270459652
Iteration: 2927, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45173466205596924, gen p mean: -0.8006195425987244, mean p set: 0.45221495628356934
The modified gen p mean: 0.45193371176719666, gen p mean: -0.7877681851387024, mean p set: 0.45241400599479675
The modified gen p mean: 0.45310261845588684, gen p mean: -0.8008378744125366, mean p set: 0.45358291268348694
loss_pred:0.02453574165701866, decouple_loss:0.006646299734711647
loss_pred:0.024045901373028755, decouple_loss:0.006525158882141113
loss_pred:0.02277228981256485, decouple_loss:0.007154902443289757
Iteration: 2928, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45147210359573364, gen p mean: -0.7955965399742126, mean p set: 0.45195239782333374
The modified gen p mean: 0.45124924182891846, gen p mean: -0.7909169793128967, mean p set: 0.45172953605651855
The modified gen p mean: 0.4518676996231079, gen p mean: -0.8066502809524536, mean p set: 0.4523479640483856
loss_pred:0.024563878774642944, decouple_loss:0.006428833585232496
loss_pred:0.02354322373867035, decouple_loss:0.006289114244282246
loss_pred:0.023688163608312607, decouple_loss:0.006495578680187464
Iteration: 2929, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521476924419403, gen p mean: -0.7898228168487549, mean p set: 0.4526279866695404
The modified gen p mean: 0.4524117708206177, gen p mean: -0.7964819669723511, mean p set: 0.4528920352458954
The modified gen p mean: 0.4527105689048767, gen p mean: -0.7885886430740356, mean p set: 0.4531908929347992
loss_pred:0.025029821321368217, decouple_loss:0.0066306693479418755
loss_pred:0.024502092972397804, decouple_loss:0.006495308596640825
loss_pred:0.023617997765541077, decouple_loss:0.006290464196354151
Iteration: 2930, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518061578273773, gen p mean: -0.7950992584228516, mean p set: 0.45228642225265503
The modified gen p mean: 0.45035693049430847, gen p mean: -0.7895548939704895, mean p set: 0.4508371949195862
The modified gen p mean: 0.4510209262371063, gen p mean: -0.790465772151947, mean p set: 0.45150119066238403
loss_pred:0.02400735579431057, decouple_loss:0.006684552412480116
loss_pred:0.02450803481042385, decouple_loss:0.00668251421302557
loss_pred:0.025187239050865173, decouple_loss:0.007002430502325296
2023-05-03 09:57:39 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7965074777603149, mean p set: 0.4500633478164673
The modified gen p mean: 0.449788898229599, gen p mean: -0.8048123121261597, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7929814457893372, mean p set: 0.45035696029663086
loss_pred:0.024555770680308342, decouple_loss:0.0069073764607310295
loss_pred:0.025632064789533615, decouple_loss:0.007180674467235804
loss_pred:0.024299198761582375, decouple_loss:0.0070106531493365765
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02518065646290779, avg_mse: 0.030884141102433205
current test mse: 0.030884
Iteration: 2931, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524240493774414, gen p mean: -0.7973548769950867, mean p set: 0.4529043138027191
The modified gen p mean: 0.45091700553894043, gen p mean: -0.799144983291626, mean p set: 0.4513972997665405
loss_pred:0.023395981639623642, decouple_loss:0.0064855171367526054
loss_pred:0.024111943319439888, decouple_loss:0.006451185327023268
The modified gen p mean: 0.45180779695510864, gen p mean: -0.8010530471801758, mean p set: 0.45228806138038635
loss_pred:0.02370002679526806, decouple_loss:0.006571256089955568
Iteration: 2932, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45355185866355896, gen p mean: -0.8016780018806458, mean p set: 0.45403215289115906
The modified gen p mean: 0.4533820152282715, gen p mean: -0.8019303679466248, mean p set: 0.4538623094558716
The modified gen p mean: 0.45208415389060974, gen p mean: -0.7975742220878601, mean p set: 0.45256444811820984
loss_pred:0.023067530244588852, decouple_loss:0.006882932037115097
loss_pred:0.024284832179546356, decouple_loss:0.0071087065152823925
loss_pred:0.023581596091389656, decouple_loss:0.0064038001000881195
Iteration: 2933, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45086798071861267, gen p mean: -0.7991355657577515, mean p set: 0.4513482451438904
The modified gen p mean: 0.45209452509880066, gen p mean: -0.7971788644790649, mean p set: 0.452574759721756
The modified gen p mean: 0.4532967507839203, gen p mean: -0.8168243169784546, mean p set: 0.453777015209198
loss_pred:0.02364981174468994, decouple_loss:0.006495063193142414
loss_pred:0.023835930973291397, decouple_loss:0.006590253207832575
loss_pred:0.023876512423157692, decouple_loss:0.006978004239499569
Iteration: 2934, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532409608364105, gen p mean: -0.814396858215332, mean p set: 0.4537212550640106
The modified gen p mean: 0.4527018666267395, gen p mean: -0.8127171397209167, mean p set: 0.4531821608543396
The modified gen p mean: 0.4515133798122406, gen p mean: -0.7977474331855774, mean p set: 0.4519937038421631
loss_pred:0.023959901183843613, decouple_loss:0.006689233705401421
loss_pred:0.023347176611423492, decouple_loss:0.006880486849695444
loss_pred:0.02383534237742424, decouple_loss:0.006412772927433252
Iteration: 2935, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45191672444343567, gen p mean: -0.7923682928085327, mean p set: 0.4523969888687134
The modified gen p mean: 0.4531414210796356, gen p mean: -0.796372652053833, mean p set: 0.45362168550491333
The modified gen p mean: 0.45241695642471313, gen p mean: -0.7892546057701111, mean p set: 0.45289722084999084
loss_pred:0.024023156613111496, decouple_loss:0.0065381177701056
loss_pred:0.022907447069883347, decouple_loss:0.007179958280175924
loss_pred:0.023745985701680183, decouple_loss:0.006249279715120792
Iteration: 2936, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45345139503479004, gen p mean: -0.8053482174873352, mean p set: 0.45393162965774536
The modified gen p mean: 0.4521663784980774, gen p mean: -0.7926133275032043, mean p set: 0.4526466727256775
The modified gen p mean: 0.4521658420562744, gen p mean: -0.7956997752189636, mean p set: 0.4526461064815521
loss_pred:0.023952316492795944, decouple_loss:0.006787566002458334
loss_pred:0.024383213371038437, decouple_loss:0.006475596688687801
loss_pred:0.02413119561970234, decouple_loss:0.006386284716427326
Iteration: 2937, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45265108346939087, gen p mean: -0.7937847971916199, mean p set: 0.4531313478946686
The modified gen p mean: 0.45066335797309875, gen p mean: -0.7932456731796265, mean p set: 0.45114362239837646
The modified gen p mean: 0.4526793658733368, gen p mean: -0.8117182850837708, mean p set: 0.4531596302986145
loss_pred:0.023991521447896957, decouple_loss:0.006509833037853241
loss_pred:0.023248843848705292, decouple_loss:0.0063613043166697025
loss_pred:0.023701217025518417, decouple_loss:0.006288346368819475
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 2938, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44746753573417664, gen p mean: -0.7960688471794128, mean p set: 0.44794782996177673
The modified gen p mean: 0.44860637187957764, gen p mean: -0.7867576479911804, mean p set: 0.44908660650253296
The modified gen p mean: 0.4484391510486603, gen p mean: -0.7942253947257996, mean p set: 0.448919415473938
loss_pred:0.02566780149936676, decouple_loss:0.007729525212198496
loss_pred:0.025453176349401474, decouple_loss:0.0073658437468111515
loss_pred:0.025995565578341484, decouple_loss:0.007102225441485643
Iteration: 2939, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484703838825226, gen p mean: -0.7986130714416504, mean p set: 0.4489506781101227
The modified gen p mean: 0.44729092717170715, gen p mean: -0.7978798747062683, mean p set: 0.44777119159698486
The modified gen p mean: 0.4474680721759796, gen p mean: -0.8034876585006714, mean p set: 0.4479483664035797
loss_pred:0.02557300217449665, decouple_loss:0.007076859008520842
loss_pred:0.025901377201080322, decouple_loss:0.007039717398583889
loss_pred:0.02506778948009014, decouple_loss:0.006712356116622686
Iteration: 2940, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793835282325745, gen p mean: -0.8141084909439087, mean p set: 0.44841864705085754
The modified gen p mean: 0.445667028427124, gen p mean: -0.8018620014190674, mean p set: 0.4461473524570465
The modified gen p mean: 0.44821879267692566, gen p mean: -0.8033448457717896, mean p set: 0.44869908690452576
loss_pred:0.025201112031936646, decouple_loss:0.007054047659039497
loss_pred:0.02567177265882492, decouple_loss:0.0071593658067286015
loss_pred:0.02563832513988018, decouple_loss:0.007082996424287558
2023-05-03 10:02:28 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.8216426372528076, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.8131197690963745, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.8091088533401489, mean p set: 0.45035696029663086
loss_pred:0.025492871180176735, decouple_loss:0.007223485969007015
loss_pred:0.0244608074426651, decouple_loss:0.0067266011610627174
loss_pred:0.02421238087117672, decouple_loss:0.006829802878201008
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02506835386157036, avg_mse: 0.030680185183882713
current test mse: 0.03068
Iteration: 2941, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475211799144745, gen p mean: -0.8090038299560547, mean p set: 0.4480014741420746
loss_pred:0.025362839922308922, decouple_loss:0.0069776419550180435
The modified gen p mean: 0.44903576374053955, gen p mean: -0.8116132020950317, mean p set: 0.44951605796813965
loss_pred:0.02461315505206585, decouple_loss:0.007165343035012484
The modified gen p mean: 0.4487364590167999, gen p mean: -0.804051399230957, mean p set: 0.4492167532444
loss_pred:0.02701514959335327, decouple_loss:0.0069598061963915825
Iteration: 2942, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490233063697815, gen p mean: -0.7989762425422668, mean p set: 0.4495036005973816
The modified gen p mean: 0.44597384333610535, gen p mean: -0.803805947303772, mean p set: 0.44645413756370544
The modified gen p mean: 0.4471625089645386, gen p mean: -0.8043833374977112, mean p set: 0.44764280319213867
loss_pred:0.026703966781497, decouple_loss:0.006864157505333424
loss_pred:0.02516661025583744, decouple_loss:0.007019856013357639
loss_pred:0.02591267041862011, decouple_loss:0.006925072055310011
Iteration: 2943, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485549032688141, gen p mean: -0.8047253489494324, mean p set: 0.4490351974964142
The modified gen p mean: 0.447562575340271, gen p mean: -0.8038149476051331, mean p set: 0.4480428397655487
The modified gen p mean: 0.4453616142272949, gen p mean: -0.808758556842804, mean p set: 0.44584187865257263
loss_pred:0.024287816137075424, decouple_loss:0.006499975919723511
loss_pred:0.02456377074122429, decouple_loss:0.00664700148627162
loss_pred:0.025720126926898956, decouple_loss:0.006791715510189533
Iteration: 2944, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44597190618515015, gen p mean: -0.8016824722290039, mean p set: 0.44645223021507263
The modified gen p mean: 0.44896137714385986, gen p mean: -0.8058146834373474, mean p set: 0.44944167137145996
The modified gen p mean: 0.4476211369037628, gen p mean: -0.8077337145805359, mean p set: 0.4481014013290405
loss_pred:0.02546205371618271, decouple_loss:0.006947654299438
loss_pred:0.026168109849095345, decouple_loss:0.006755211856216192
loss_pred:0.02497875690460205, decouple_loss:0.006781752686947584
Iteration: 2945, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474603533744812, gen p mean: -0.8054069876670837, mean p set: 0.4479406476020813
The modified gen p mean: 0.4489551782608032, gen p mean: -0.8050976991653442, mean p set: 0.4494354724884033
The modified gen p mean: 0.4459594190120697, gen p mean: -0.8172980546951294, mean p set: 0.4464397132396698
loss_pred:0.024985481053590775, decouple_loss:0.006415573880076408
loss_pred:0.025280635803937912, decouple_loss:0.006628004368394613
loss_pred:0.025745077058672905, decouple_loss:0.0064302231185138226
Iteration: 2946, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475595951080322, gen p mean: -0.8127544522285461, mean p set: 0.4480399191379547
The modified gen p mean: 0.44818437099456787, gen p mean: -0.8110958337783813, mean p set: 0.4486646354198456
The modified gen p mean: 0.4482795298099518, gen p mean: -0.8107700347900391, mean p set: 0.4487598240375519
loss_pred:0.02414022572338581, decouple_loss:0.0062828524969518185
loss_pred:0.0247981958091259, decouple_loss:0.006476467475295067
loss_pred:0.025553585961461067, decouple_loss:0.006512211170047522
Iteration: 2947, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44919610023498535, gen p mean: -0.8116987943649292, mean p set: 0.44967639446258545
The modified gen p mean: 0.44779133796691895, gen p mean: -0.8169082999229431, mean p set: 0.44827160239219666
The modified gen p mean: 0.4472449719905853, gen p mean: -0.8193739652633667, mean p set: 0.4477252662181854
loss_pred:0.025409111753106117, decouple_loss:0.006606352981179953
loss_pred:0.02652079239487648, decouple_loss:0.006894066464155912
loss_pred:0.025972481817007065, decouple_loss:0.006711508147418499
Iteration: 2948, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44770383834838867, gen p mean: -0.8173130750656128, mean p set: 0.448184072971344
The modified gen p mean: 0.44716429710388184, gen p mean: -0.8137285709381104, mean p set: 0.44764459133148193
The modified gen p mean: 0.4481883943080902, gen p mean: -0.8090670108795166, mean p set: 0.4486686885356903
loss_pred:0.02514633908867836, decouple_loss:0.006724077742546797
loss_pred:0.02486897073686123, decouple_loss:0.006392122246325016
loss_pred:0.025742344558238983, decouple_loss:0.006756397429853678
Iteration: 2949, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477511942386627, gen p mean: -0.8172411322593689, mean p set: 0.4482314884662628
The modified gen p mean: 0.44882652163505554, gen p mean: -0.806965172290802, mean p set: 0.44930681586265564
The modified gen p mean: 0.44764211773872375, gen p mean: -0.811457097530365, mean p set: 0.44812238216400146
loss_pred:0.024536747485399246, decouple_loss:0.006622913293540478
loss_pred:0.026063431054353714, decouple_loss:0.006389803718775511
loss_pred:0.025410572066903114, decouple_loss:0.006514247041195631
Iteration: 2950, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732344150543213, gen p mean: -0.7993131279945374, mean p set: 0.44780370593070984
The modified gen p mean: 0.4483566880226135, gen p mean: -0.8056443333625793, mean p set: 0.4488369822502136
The modified gen p mean: 0.446358859539032, gen p mean: -0.8057162165641785, mean p set: 0.4468391239643097
loss_pred:0.025977563112974167, decouple_loss:0.0069231693632900715
loss_pred:0.02487773820757866, decouple_loss:0.006501990836113691
loss_pred:0.02550528198480606, decouple_loss:0.006519489921629429
2023-05-03 10:06:14 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.8168954849243164, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.8094297647476196, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.8060420155525208, mean p set: 0.45035696029663086
loss_pred:0.025354735553264618, decouple_loss:0.006658938247710466
loss_pred:0.024307042360305786, decouple_loss:0.006427950691431761
loss_pred:0.024039197713136673, decouple_loss:0.006406350992619991
WV_0_PC_1_EH_0_PS_40_6, loss: 0.02489187940955162, avg_mse: 0.030402544885873795
current test mse: 0.030403
Iteration: 2951, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796302914619446, gen p mean: -0.8021911382675171, mean p set: 0.44844329357147217
The modified gen p mean: 0.4463062286376953, gen p mean: -0.7935407757759094, mean p set: 0.4467865526676178
loss_pred:0.02551376260817051, decouple_loss:0.0064918906427919865
loss_pred:0.026054952293634415, decouple_loss:0.006665691267699003
The modified gen p mean: 0.4485762417316437, gen p mean: -0.8072690367698669, mean p set: 0.4490565061569214
loss_pred:0.024508710950613022, decouple_loss:0.006560038775205612
Iteration: 2952, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483889937400818, gen p mean: -0.8012272119522095, mean p set: 0.4488692581653595
The modified gen p mean: 0.4484618008136749, gen p mean: -0.8076911568641663, mean p set: 0.4489421248435974
The modified gen p mean: 0.4471014738082886, gen p mean: -0.8058227896690369, mean p set: 0.4475817382335663
loss_pred:0.02537883259356022, decouple_loss:0.006283051334321499
loss_pred:0.024532096460461617, decouple_loss:0.006498993374407291
loss_pred:0.02529885433614254, decouple_loss:0.006315131671726704
Iteration: 2953, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841551780700684, gen p mean: -0.7937420606613159, mean p set: 0.44889581203460693
The modified gen p mean: 0.4482066035270691, gen p mean: -0.7992413640022278, mean p set: 0.4486868679523468
The modified gen p mean: 0.448258638381958, gen p mean: -0.7976343631744385, mean p set: 0.4487389624118805
loss_pred:0.02564186602830887, decouple_loss:0.006585401948541403
loss_pred:0.02482880838215351, decouple_loss:0.0063917008228600025
loss_pred:0.026716385036706924, decouple_loss:0.006163312587887049
Iteration: 2954, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715234637260437, gen p mean: -0.8001943826675415, mean p set: 0.4476326107978821
The modified gen p mean: 0.4468974173069, gen p mean: -0.8025826811790466, mean p set: 0.4473777115345001
The modified gen p mean: 0.44803106784820557, gen p mean: -0.8003981113433838, mean p set: 0.4485113322734833
loss_pred:0.024561500176787376, decouple_loss:0.00634789327159524
loss_pred:0.026153722777962685, decouple_loss:0.006139152217656374
loss_pred:0.024402132257819176, decouple_loss:0.006136147305369377
Iteration: 2955, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719797372817993, gen p mean: -0.8093199133872986, mean p set: 0.44767823815345764
The modified gen p mean: 0.44798973202705383, gen p mean: -0.802426815032959, mean p set: 0.44847002625465393
The modified gen p mean: 0.447185218334198, gen p mean: -0.8048985600471497, mean p set: 0.4476655125617981
loss_pred:0.02483588457107544, decouple_loss:0.006157297641038895
loss_pred:0.025569066405296326, decouple_loss:0.006027710158377886
loss_pred:0.023790908977389336, decouple_loss:0.006054732948541641
Iteration: 2956, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479886591434479, gen p mean: -0.8025813698768616, mean p set: 0.448468953371048
The modified gen p mean: 0.4493710398674011, gen p mean: -0.802847146987915, mean p set: 0.44985130429267883
The modified gen p mean: 0.44641435146331787, gen p mean: -0.7954544425010681, mean p set: 0.44689464569091797
loss_pred:0.025156350806355476, decouple_loss:0.006108674220740795
loss_pred:0.025634853169322014, decouple_loss:0.006342114880681038
loss_pred:0.025688547641038895, decouple_loss:0.006462795194238424
Iteration: 2957, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480283856391907, gen p mean: -0.795434296131134, mean p set: 0.44850867986679077
The modified gen p mean: 0.44778892397880554, gen p mean: -0.7947449684143066, mean p set: 0.44826918840408325
The modified gen p mean: 0.4474125802516937, gen p mean: -0.7968688011169434, mean p set: 0.4478928744792938
loss_pred:0.025151284411549568, decouple_loss:0.006242264062166214
loss_pred:0.02490135096013546, decouple_loss:0.0061038825660943985
loss_pred:0.02457866258919239, decouple_loss:0.00628668162971735
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
NaN value num: 0
Iteration: 2958, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856002926826477, gen p mean: -0.7979115843772888, mean p set: 0.44904032349586487
The modified gen p mean: 0.4525958001613617, gen p mean: -0.7967873215675354, mean p set: 0.4530760943889618
The modified gen p mean: 0.449384868144989, gen p mean: -0.7990500926971436, mean p set: 0.4498651623725891
loss_pred:0.02263997495174408, decouple_loss:0.0072436523623764515
loss_pred:0.025535445660352707, decouple_loss:0.006671979557722807
loss_pred:0.02535443753004074, decouple_loss:0.006542271468788385
Iteration: 2959, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45028501749038696, gen p mean: -0.8011099100112915, mean p set: 0.4507652819156647
The modified gen p mean: 0.4524904489517212, gen p mean: -0.7939817905426025, mean p set: 0.4529707729816437
The modified gen p mean: 0.4510343670845032, gen p mean: -0.8036546111106873, mean p set: 0.45151469111442566
loss_pred:0.024732956662774086, decouple_loss:0.0070066372863948345
loss_pred:0.023587871342897415, decouple_loss:0.006959318649023771
loss_pred:0.024871472269296646, decouple_loss:0.006927309557795525
Iteration: 2960, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45110011100769043, gen p mean: -0.798043966293335, mean p set: 0.4515804052352905
The modified gen p mean: 0.4500119090080261, gen p mean: -0.8046316504478455, mean p set: 0.4504922032356262
The modified gen p mean: 0.4493253827095032, gen p mean: -0.8076830506324768, mean p set: 0.44980570673942566
loss_pred:0.024061372503638268, decouple_loss:0.006775850895792246
loss_pred:0.025004444643855095, decouple_loss:0.0064826481975615025
loss_pred:0.02417098730802536, decouple_loss:0.0067489128559827805
2023-05-03 10:10:38 testing...
The modified gen p mean: 0.4495830833911896, gen p mean: -0.8086981773376465, mean p set: 0.4500633478164673
The modified gen p mean: 0.4497888684272766, gen p mean: -0.8151589632034302, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.8054891228675842, mean p set: 0.45035696029663086
loss_pred:0.025407010689377785, decouple_loss:0.006666327826678753
loss_pred:0.02636190690100193, decouple_loss:0.006911862641572952
loss_pred:0.024919897317886353, decouple_loss:0.006616075057536364
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025899510830640793, avg_mse: 0.032295238226652145
current test mse: 0.032295
Iteration: 2961, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45071595907211304, gen p mean: -0.8111682534217834, mean p set: 0.45119625329971313
loss_pred:0.026279093697667122, decouple_loss:0.006866477895528078
The modified gen p mean: 0.4504432678222656, gen p mean: -0.8068272471427917, mean p set: 0.4509235620498657
loss_pred:0.02544286660850048, decouple_loss:0.006551824044436216
The modified gen p mean: 0.4488624632358551, gen p mean: -0.8079048991203308, mean p set: 0.4493427276611328
loss_pred:0.02599259652197361, decouple_loss:0.006575847044587135
Iteration: 2962, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45289772748947144, gen p mean: -0.7989415526390076, mean p set: 0.45337799191474915
The modified gen p mean: 0.4495698809623718, gen p mean: -0.7983665466308594, mean p set: 0.4500502049922943
The modified gen p mean: 0.4519697427749634, gen p mean: -0.7939637899398804, mean p set: 0.45245006680488586
loss_pred:0.024830976501107216, decouple_loss:0.007119926158338785
loss_pred:0.02608354389667511, decouple_loss:0.006920214742422104
loss_pred:0.025064488872885704, decouple_loss:0.007321223150938749
Iteration: 2963, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45188701152801514, gen p mean: -0.7914516925811768, mean p set: 0.45236724615097046
The modified gen p mean: 0.45025256276130676, gen p mean: -0.7985135912895203, mean p set: 0.4507328271865845
The modified gen p mean: 0.4493483006954193, gen p mean: -0.7929602861404419, mean p set: 0.449828565120697
loss_pred:0.02463933452963829, decouple_loss:0.006927843205630779
loss_pred:0.02491474151611328, decouple_loss:0.006931249517947435
loss_pred:0.025649121031165123, decouple_loss:0.0068571181036531925
Iteration: 2964, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45041948556900024, gen p mean: -0.7855255007743835, mean p set: 0.45089974999427795
The modified gen p mean: 0.44972747564315796, gen p mean: -0.7935926914215088, mean p set: 0.45020779967308044
The modified gen p mean: 0.45096859335899353, gen p mean: -0.7950354218482971, mean p set: 0.45144885778427124
loss_pred:0.02459551952779293, decouple_loss:0.007434060797095299
loss_pred:0.025505168363451958, decouple_loss:0.007427058182656765
loss_pred:0.02641279250383377, decouple_loss:0.007375437766313553
Iteration: 2965, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493951201438904, gen p mean: -0.7809996604919434, mean p set: 0.4498754143714905
The modified gen p mean: 0.4528330862522125, gen p mean: -0.7757948637008667, mean p set: 0.45331335067749023
The modified gen p mean: 0.4503566026687622, gen p mean: -0.7746223211288452, mean p set: 0.4508368670940399
loss_pred:0.026231825351715088, decouple_loss:0.007481994107365608
loss_pred:0.023318715393543243, decouple_loss:0.007917740382254124
loss_pred:0.024084266275167465, decouple_loss:0.007820874452590942
Iteration: 2966, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499675929546356, gen p mean: -0.775655210018158, mean p set: 0.4504478871822357
The modified gen p mean: 0.45197778940200806, gen p mean: -0.7753081917762756, mean p set: 0.45245808362960815
The modified gen p mean: 0.4490213990211487, gen p mean: -0.7821108102798462, mean p set: 0.4495016634464264
loss_pred:0.025965888053178787, decouple_loss:0.007534504402428865
loss_pred:0.02327149547636509, decouple_loss:0.0076416959054768085
loss_pred:0.02663598023355007, decouple_loss:0.007800304796546698
Iteration: 2967, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506535828113556, gen p mean: -0.7738560438156128, mean p set: 0.4511338472366333
The modified gen p mean: 0.4501342177391052, gen p mean: -0.7781590223312378, mean p set: 0.45061448216438293
The modified gen p mean: 0.4496776759624481, gen p mean: -0.7796446084976196, mean p set: 0.45015794038772583
loss_pred:0.024376478046178818, decouple_loss:0.007622590288519859
loss_pred:0.024777134880423546, decouple_loss:0.007387096993625164
loss_pred:0.025745540857315063, decouple_loss:0.007344616111367941
Iteration: 2968, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45049503445625305, gen p mean: -0.783043622970581, mean p set: 0.45097532868385315
The modified gen p mean: 0.4501848816871643, gen p mean: -0.7843716144561768, mean p set: 0.450665146112442
The modified gen p mean: 0.44852250814437866, gen p mean: -0.7832534313201904, mean p set: 0.44900277256965637
loss_pred:0.024586671963334084, decouple_loss:0.007756916806101799
loss_pred:0.02450033277273178, decouple_loss:0.007614355534315109
loss_pred:0.026511702686548233, decouple_loss:0.007608500309288502
Iteration: 2969, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45086923241615295, gen p mean: -0.7867569327354431, mean p set: 0.45134952664375305
The modified gen p mean: 0.4494932293891907, gen p mean: -0.7838425636291504, mean p set: 0.4499734938144684
The modified gen p mean: 0.45101550221443176, gen p mean: -0.7909207940101624, mean p set: 0.45149579644203186
loss_pred:0.02613404206931591, decouple_loss:0.008219710551202297
loss_pred:0.02600080519914627, decouple_loss:0.008064824156463146
loss_pred:0.024808993563055992, decouple_loss:0.00826736818999052
Iteration: 2970, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509352147579193, gen p mean: -0.7741318941116333, mean p set: 0.4514155089855194
The modified gen p mean: 0.4500581622123718, gen p mean: -0.7791436314582825, mean p set: 0.4505384862422943
The modified gen p mean: 0.4481806755065918, gen p mean: -0.7771342396736145, mean p set: 0.4486609697341919
loss_pred:0.02352943643927574, decouple_loss:0.00806253682821989
loss_pred:0.024376992136240005, decouple_loss:0.007885926403105259
loss_pred:0.0254216305911541, decouple_loss:0.008108767680823803
2023-05-03 10:14:19 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7801458835601807, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7723703384399414, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7688683867454529, mean p set: 0.45035696029663086
loss_pred:0.025963660329580307, decouple_loss:0.008404690772294998
loss_pred:0.025047680363059044, decouple_loss:0.008221641182899475
loss_pred:0.0248282290995121, decouple_loss:0.008110351860523224
WV_0_PC_1_EH_0_PS_40_6, loss: 0.025692135095596313, avg_mse: 0.03126539662480354
current test mse: 0.031265
Iteration: 2971, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533085525035858, gen p mean: -0.7743874192237854, mean p set: 0.4537888467311859
loss_pred:0.02377442456781864, decouple_loss:0.008025928400456905
The modified gen p mean: 0.45205241441726685, gen p mean: -0.7785879373550415, mean p set: 0.45253270864486694
loss_pred:0.024510877206921577, decouple_loss:0.008059819228947163
The modified gen p mean: 0.4498934745788574, gen p mean: -0.7792013883590698, mean p set: 0.45037373900413513
loss_pred:0.02412424050271511, decouple_loss:0.00774774607270956
Iteration: 2972, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485822021961212, gen p mean: -0.7784038186073303, mean p set: 0.4490624964237213
The modified gen p mean: 0.4495936632156372, gen p mean: -0.7667195796966553, mean p set: 0.4500739574432373
The modified gen p mean: 0.4527561664581299, gen p mean: -0.7759504914283752, mean p set: 0.45323646068573
loss_pred:0.025199120864272118, decouple_loss:0.007963879965245724
loss_pred:0.02416796050965786, decouple_loss:0.007515799719840288
loss_pred:0.023386197164654732, decouple_loss:0.007956861518323421
Iteration: 2973, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500754475593567, gen p mean: -0.7742099165916443, mean p set: 0.4505557417869568
The modified gen p mean: 0.44955775141716003, gen p mean: -0.7812089323997498, mean p set: 0.45003804564476013
The modified gen p mean: 0.4483599066734314, gen p mean: -0.7811369895935059, mean p set: 0.4488401710987091
loss_pred:0.02447609230875969, decouple_loss:0.007600932847708464
loss_pred:0.024120863527059555, decouple_loss:0.007460675202310085
loss_pred:0.024806443601846695, decouple_loss:0.007770168595016003
Traceback (most recent call last):
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/run1.py", line 349, in <module>
    if args.is_training:
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/run1.py", line 277, in train_wrapper
    #     eta, real_input_flag = schedule_sampling(eta, itr)
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/trainer.py", line 25, in train
    cost = model.train(ims, real_input_flag)
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/models/model_factory_multiGPU.py", line 68, in train
    loss.mean().backward()
  File "/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/_tensor.py", line 396, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/autograd/__init__.py", line 173, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt